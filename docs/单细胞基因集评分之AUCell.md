---
title: "单细胞基因集评分之AUCell"
date: 2022-09-01T02:40:37Z
draft: ["false"]
tags: [
  "fetched",
  "Biomamba 生信基地"
]
categories: ["Acdemic"]
---
单细胞基因集评分之AUCell by Biomamba 生信基地
------
<div><section data-support="96编辑器" data-style-id="35163"><section><section data-support="96编辑器" data-style-id="35163"><section><h1><span><strong>一、写在前面：</strong></span></h1><section><img data-ratio="0.6349206349206349" data-src="https://mmbiz.qpic.cn/mmbiz_gif/Ljib4So7yuWgEPt6jo0gEwibQzFX4zmOqqiaM9bZyTy3bIjLJcicVlkUFwFvyicJx8wR2ZslWiaBicM4nw9AtyQ7k7ugA/640?wx_fmt=gif&amp;wxfrom=5&amp;wx_lazy=1" data-type="gif" data-w="63" data-width="100%" src="https://mmbiz.qpic.cn/mmbiz_gif/Ljib4So7yuWgEPt6jo0gEwibQzFX4zmOqqiaM9bZyTy3bIjLJcicVlkUFwFvyicJx8wR2ZslWiaBicM4nw9AtyQ7k7ugA/640?wx_fmt=gif&amp;wxfrom=5&amp;wx_lazy=1"></section><section><section><p>此前已经给大家简单介绍过了五种单细胞基因集打分方法，包含<span></span><code>AddModuleScore</code><span>、</span><code>ssGSEA</code><span>、</span><code>GSVA</code><span>、</span><code>PercentageFeatureSet</code><span>、</span><code>AUCell</code>：<a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247490658&amp;idx=1&amp;sn=3460a09ef4ad2916aabfaa13e195c7b1&amp;chksm=9b3f6532ac48ec249e974aa5bfcca2f5d441e64bbd353fe9dd45a50b47599663bf0334def7d4&amp;scene=21#wechat_redirect" textvalue="一文搞定单细胞基因集评分" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2"><strong><span>一文搞定单细胞基因集评分</span></strong></a>。但最近在做SCENIC(用于单细胞转录因子调控网络预测)的教程，其中用到了<span>AUCell</span>这一R包/算法来计算<strong>regulon</strong>的活性，本以为<span>AUCell</span>是其他的哪位大佬开发的，没想到是作者在设计<span>SCENIC</span>时顺手写的基因集打分方法，看来硬生信和软生信之间的鸿沟是真实存在的，<span>AUCell</span>值得我们用单独的版面来介绍。</p><section>考虑节省时间我们先将<strong><span>图文</span></strong>教程更新出来，不知诸位是否需要<strong><span>视频</span></strong>教程（真的还蛮花时间的），老规矩，上票:<br></section><section><span><iframe scrolling="no" frameborder="0" data-display-style="height: 147px;" data-display-src="/cgi-bin/readtemplate?t=vote/vote-new_tmpl&amp;__biz=MzAwMzIzOTk5OQ==&amp;supervoteid=453230025&amp;token=1736887680&amp;lang=zh_CN" data-src="/mp/newappmsgvote?action=show&amp;__biz=MzAwMzIzOTk5OQ==&amp;supervoteid=453230025#wechat_redirect" data-supervoteid="453230025" allowfullscreen=""></iframe><span></span><span></span></span></section><section><br></section></section></section><h1><span><strong><br></strong></span></h1><h1><span><strong>二、教程：</strong></span></h1><section><img data-ratio="0.6349206349206349" data-src="https://mmbiz.qpic.cn/mmbiz_gif/Ljib4So7yuWgEPt6jo0gEwibQzFX4zmOqqiaM9bZyTy3bIjLJcicVlkUFwFvyicJx8wR2ZslWiaBicM4nw9AtyQ7k7ugA/640?wx_fmt=gif&amp;wxfrom=5&amp;wx_lazy=1" data-type="gif" data-w="63" data-width="100%" src="https://mmbiz.qpic.cn/mmbiz_gif/Ljib4So7yuWgEPt6jo0gEwibQzFX4zmOqqiaM9bZyTy3bIjLJcicVlkUFwFvyicJx8wR2ZslWiaBicM4nw9AtyQ7k7ugA/640?wx_fmt=gif&amp;wxfrom=5&amp;wx_lazy=1"></section><section><section><section><span>1.0 AUCell简介</span></section><section><span>AUCell</span>可以在单细胞测序数据种鉴定/识别激活的基因集，主要实现方式是通过曲线下面积(Area Under the Curve, AUC)去计算每个细胞中是否存在富集的关键基因集(signature)。输出的<strong>AUC scores</strong>类似于GSVA score，可以用于反应<strong>signature</strong>的相对表达量。值得一提的是，由于GSVA score的计算方式基于排序和AUC，因此计算过程并不受基因表达量的<strong>单位</strong>以及<strong>normalization</strong>的影响；并且AUC scores是以<strong>每一个细胞为单位</strong>进行计算的，因此处理大数据内存吃紧时，对每个子集计算AUC score再合并也无妨。</section><p><br></p><h2><span>2.0. 分析前准备</span></h2><h3><span>2.0.1 版本信息</span></h3><p><span>大家软件装不上时第一件事就应该检查环境的版本信息：</span></p><pre><code><span><span>sessionInfo</span>()</span></code></pre><p><br></p><pre><code><span>R version <span>4</span>.<span>2.1</span> (<span>2022-06-23</span> ucrt)</span><span>Platform<span>:</span> x86_64<span>-</span>w64<span>-</span>mingw32<span>/</span><span>x64</span> (<span>64</span><span>-</span>bit)</span><span>Running under<span>:</span> Windows <span>10</span> <span>x64</span> (build <span>19044</span>)</span><span>Matrix products<span>:</span> default</span><span>locale<span>:</span></span><span>[<span>1</span>] LC_COLLATE<span>=</span><span>Chinese</span> (Simplified)_China.utf8 </span><span>[<span>2</span>] LC_CTYPE<span>=</span><span>Chinese</span> (Simplified)_China.utf8   </span><span>[<span>3</span>] LC_MONETARY<span>=</span><span>Chinese</span> (Simplified)_China.utf8</span><span>[<span>4</span>] LC_NUMERIC<span>=</span>C                               </span><span>[<span>5</span>] LC_TIME<span>=</span><span>Chinese</span> (Simplified)_China.utf8    </span><span>attached base packages<span>:</span></span><span>[<span>1</span>] stats4    stats     graphics  grDevices utils     datasets  methods   base     </span><span>other attached packages<span>:</span></span><span> [<span>1</span>] rbokeh_0.<span>5.2</span>         shiny_1.<span>7.2</span>          RColorBrewer_1<span>.1</span><span>-3</span>  </span><span> [<span>4</span>] NMF_0.<span>24.0</span>           cluster_2.<span>1.3</span>        rngtools_1.<span>5.2</span>      </span><span> [<span>7</span>] pkgmaker_0.<span>32.2</span>      registry_0<span>.5</span><span>-1</span>       DT_0<span>.24</span>             </span><span>[<span>10</span>] Rtsne_0<span>.16</span>           dplyr_1.<span>0.9</span>          BiocParallel_1.<span>30.3</span> </span><span>[<span>13</span>] GSEABase_1.<span>58.0</span>      graph_1.<span>74.0</span>         annotate_1.<span>74.0</span>     </span><span>[<span>16</span>] XML_3<span>.99-0.10</span>        AnnotationDbi_1.<span>58.0</span> IRanges_2.<span>30.0</span>      </span><span>[<span>19</span>] S4Vectors_0.<span>34.0</span>     Biobase_2.<span>56.0</span>       BiocGenerics_0.<span>42.0</span> </span><span>[<span>22</span>] AUCell_1.<span>18.1</span>        Matrix_1<span>.4</span><span>-1</span>         data.table_1.<span>14.2</span>   </span><span>loaded via a <span>namespace</span> (and not attached)<span>:</span></span><span>  [<span>1</span>] plyr_1.<span>8.7</span>                  lazyeval_0.<span>2.2</span>             </span><span>  [<span>3</span>] splines_4.<span>2.1</span>               crosstalk_1.<span>2.0</span>            </span><span>  [<span>5</span>] GenomeInfoDb_1.<span>32.3</span>         ggplot2_3.<span>3.6</span>              </span><span>  [<span>7</span>] gridBase_0<span>.4</span><span>-7</span>              pryr_0.<span>1.5</span>                 </span><span>  [<span>9</span>] digest_0.<span>6.29</span>               foreach_1.<span>5.2</span>              </span><span> [<span>11</span>] htmltools_0.<span>5.3</span>             fansi_1.<span>0.3</span>                </span><span> [<span>13</span>] magrittr_2.<span>0.3</span>              memoise_2.<span>0.1</span>              </span><span> [<span>15</span>] doParallel_1.<span>0.17</span>           mixtools_1.<span>2.0</span>             </span><span> [<span>17</span>] tzdb_0.<span>3.0</span>                  limma_3.<span>52.2</span>               </span><span> [<span>19</span>] Biostrings_2.<span>64.0</span>           readr_2.<span>1.2</span>                </span><span> [<span>21</span>] matrixStats_0.<span>62.0</span>          R.utils_2.<span>12.0</span>             </span><span> [<span>23</span>] colorspace_2<span>.0</span><span>-3</span>            blob_1.<span>2.3</span>                 </span><span> [<span>25</span>] usdata_0.<span>2.0</span>                xfun_0<span>.32</span>                  </span><span> [<span>27</span>] crayon_1.<span>5.1</span>                RCurl_1<span>.98-1.8</span>             </span><span> [<span>29</span>] jsonlite_1.<span>8.0</span>              hexbin_1.<span>28.2</span>              </span><span> [<span>31</span>] GEOquery_2.<span>64.2</span>             survival_3<span>.3</span><span>-1</span>             </span><span> [<span>33</span>] iterators_1.<span>0.14</span>            glue_1.<span>6.2</span>                 </span><span> [<span>35</span>] gtable_0.<span>3.0</span>                zlibbioc_1.<span>42.0</span>            </span><span> [<span>37</span>] XVector_0.<span>36.0</span>              DelayedArray_0.<span>22.0</span>        </span><span> [<span>39</span>] kernlab_0<span>.9</span><span>-31</span>              maps_3.<span>4.0</span>                 </span><span> [<span>41</span>] scales_1.<span>2.1</span>                DBI_1.<span>1.3</span>                  </span><span> [<span>43</span>] Rcpp_1.<span>0.9</span>                  xtable_1<span>.8</span><span>-4</span>               </span><span> [<span>45</span>] bit_4.<span>0.4</span>                   htmlwidgets_1.<span>5.4</span>          </span><span> [<span>47</span>] httr_1.<span>4.4</span>                  ellipsis_0.<span>3.2</span>             </span><span> [<span>49</span>] pkgconfig_2.<span>0.3</span>             R.methodsS3_1.<span>8.2</span>          </span><span> [<span>51</span>] sass_0.<span>4.2</span>                  utf8_1.<span>2.2</span>                 </span><span> [<span>53</span>] crul_1.<span>2.0</span>                  tidyselect_1.<span>1.2</span>           </span><span> [<span>55</span>] rlang_1.<span>0.4</span>                 reshape2_1.<span>4.4</span>             </span><span> [<span>57</span>] later_1.<span>3.0</span>                 munsell_0.<span>5.0</span>              </span><span> [<span>59</span>] tools_4.<span>2.1</span>                 cachem_1.<span>0.6</span>               </span><span> [<span>61</span>] cli_3.<span>3.0</span>                   generics_0.<span>1.3</span>             </span><span> [<span>63</span>] RSQLite_2.<span>2.16</span>              evaluate_0<span>.16</span>              </span><span> [<span>65</span>] stringr_1.<span>4.1</span>               fastmap_1.<span>1.0</span>              </span><span> [<span>67</span>] yaml_2.<span>3.5</span>                  knitr_1<span>.39</span>                 </span><span> [<span>69</span>] bit64_4.<span>0.5</span>                 airports_0.<span>1.0</span>             </span><span> [<span>71</span>] cherryblossom_0.<span>1.0</span>         purrr_0.<span>3.4</span>                </span><span> [<span>73</span>] KEGGREST_1.<span>36.3</span>             nlme_3<span>.1</span><span>-157</span>               </span><span> [<span>75</span>] sparseMatrixStats_1.<span>8.0</span>     mime_0<span>.12</span>                  </span><span> [<span>77</span>] R.oo_1.<span>25.0</span>                 xml2_1.<span>3.3</span>                 </span><span> [<span>79</span>] compiler_4.<span>2.1</span>              curl_4.<span>3.2</span>                 </span><span> [<span>81</span>] png_0<span>.1</span><span>-7</span>                   tibble_3.<span>1.8</span>               </span><span> [<span>83</span>] bslib_0.<span>4.0</span>                 stringi_1.<span>7.8</span>              </span><span> [<span>85</span>] gistr_0.<span>9.0</span>                 lattice_0<span>.20</span><span>-45</span>            </span><span> [<span>87</span>] vctrs_0.<span>4.1</span>                 pillar_1.<span>8.1</span>               </span><span> [<span>89</span>] lifecycle_1.<span>0.1</span>             BiocManager_1.<span>30.18</span>        </span><span> [<span>91</span>] jquerylib_0.<span>1.4</span>             bitops_1<span>.0</span><span>-7</span>               </span><span> [<span>93</span>] httpuv_1.<span>6.5</span>                GenomicRanges_1.<span>48.0</span>       </span><span> [<span>95</span>] R6_2.<span>5.1</span>                    promises_1.<span>2</span>.<span>0.1</span>           </span><span> [<span>97</span>] codetools_0<span>.2</span><span>-18</span>            MASS_7<span>.3</span><span>-57</span>                </span><span> [<span>99</span>] assertthat_0.<span>2.1</span>            SummarizedExperiment_1.<span>26.1</span></span><span>[<span>101</span>] withr_2.<span>5.0</span>                 httpcode_0.<span>3.0</span>             </span><span>[<span>103</span>] openintro_2.<span>3.0</span>             GenomeInfoDbData_1.<span>2.8</span>     </span><span>[<span>105</span>] parallel_4.<span>2.1</span>              hms_1.<span>1.2</span>                  </span><span>[<span>107</span>] grid_4.<span>2.1</span>                  tidyr_1.<span>2.0</span>                </span><span>[<span>109</span>] rmarkdown_2<span>.15</span>              DelayedMatrixStats_1.<span>18.0</span>  </span><span>[<span>111</span>] segmented_1<span>.6</span><span>-0</span>             MatrixGenerics_1.<span>8.1</span> </span></code></pre><h3><span>2.0.2 安装</span></h3><p><br></p><pre><code><span><span>if</span> (<span>!</span><span>requireNamespace</span>(<span>"BiocManager"</span>, <span>quietly=</span><span>TRUE</span>))</span><span>    <span>install.packages</span>(<span>"BiocManager"</span>)</span><span><span># To support paralell execution:</span></span><span>BiocManager<span>::</span><span>install</span>(<span>c</span>(<span>"doMC"</span>, <span>"doRNG"</span>,<span>"doSNOW"</span>))</span><span><span># For the main example:</span></span><span>BiocManager<span>::</span><span>install</span>(<span>c</span>(<span>"mixtools"</span>, <span>"SummarizedExperiment"</span>))</span><span><span># For the examples in the follow-up section of the tutorial:</span></span><span>BiocManager<span>::</span><span>install</span>(<span>c</span>(<span>"DT"</span>, <span>"plotly"</span>, <span>"NMF"</span>, <span>"d3heatmap"</span>, <span>"shiny"</span>, <span>"rbokeh"</span>,</span><span>                       <span>"dynamicTreeCut"</span>,<span>"R2HTML"</span>,<span>"Rtsne"</span>, <span>"zoo"</span>))</span><span>BiocManager<span>::</span><span>install</span>(<span>'AUCell'</span>)</span></code></pre><h3><span>2.0.3 获取帮助文档</span></h3><p><span>大部分的包都可以这样调用帮助文档</span></p><p><br></p><pre><code><span><span>#在浏览器中查看</span></span><span><span>browseVignettes</span>(<span>package=</span><span>"AUCell"</span>) </span><span><span>#命令行中查看</span></span><span><span>vignette</span>(<span>package=</span><span>"AUCell"</span>) <span># list</span></span><span><span>vignette</span>(<span>"AUCell"</span>) <span># zoom中打开</span></span></code></pre><h3><span>2.0.4</span></h3><p><span>作者贴心的给了一个Rmarkdown的模板，大家可以这样调用，使用AUCell的时候就不用重复写报告啦</span></p><p><br></p><pre><code><span>vignetteFile <span>&lt;-</span> <span>paste</span>(<span>file.path</span>(<span>system.file</span>(<span>'doc'</span>, <span>package=</span><span>'AUCell'</span>)), <span>"AUCell.Rmd"</span>, <span>sep=</span><span>"/"</span>)</span><span><span># Copy to edit as markdown</span></span><span><span>file.copy</span>(vignetteFile, <span>"."</span>)</span><span><span># Alternative: extract R code</span></span><span><span>Stangle</span>(vignetteFile)</span></code></pre><h2><span>2.1. 最简单的用法</span></h2><p><br></p><pre><code><span><span>library</span>(AUCell)</span><span><span>#给定一个基因集</span></span><span>geneSets <span>&lt;-</span> <span>list</span>(<span>geneSet1=</span><span>c</span>(<span>"gene1"</span>, <span>"gene2"</span>, <span>"gene3"</span>))</span><span><span>#计算富集分数：</span></span><span>cells_AUC <span>&lt;-</span> <span>AUCell_run</span>(exprMatrix, geneSets,</span><span>                        <span>aucMaxRank=</span><span>nrow</span>(cells_rankings)<span>*</span><span>0.05</span>)<span>#这一步其实就可以得到AUC score</span></span><span><span>#可选：通过设定阈值将AUC score转换为二元矩阵(判断基因集是否激活，用于在SCENIC中判断regulon是否激活)</span></span><span><span>par</span>(<span>mfrow=</span><span>c</span>(<span>3</span>,<span>3</span>))</span><span><span>set.seed</span>(<span>123</span>)</span><span>cells_assignment <span>&lt;-</span> <span>AUCell_exploreThresholds</span>(cells_AUC, </span><span>                                             <span>plotHist=</span><span>TRUE</span>, </span><span>                                             <span>nCores=</span><span>1</span>, <span>assign=</span><span>TRUE</span>)</span></code></pre><h2><span>2.2. 测试数据</span></h2><h3><span>2.2.1 表达矩阵</span></h3><p>数据来源为GSE60361，该数据集中包含3005个细胞，物种为mouse，组织来源为<strong>cortex</strong>和<strong>hippocampus</strong>。</p><p><br></p><pre><code><span><span>#下载数据：</span></span><span><span>if</span> (<span>!</span><span>requireNamespace</span>(<span>"GEOquery"</span>, <span>quietly =</span> <span>TRUE</span>)) BiocManager<span>::</span><span>install</span>(<span>"GEOquery"</span>)</span><span>geoFile <span>&lt;-</span> <span>"GSE60361_C1-3005-Expression.txt.gz"</span></span><span><span># download.file("https://ftp.ncbi.nlm.nih.gov/geo/series/GSE60nnn/GSE60361/suppl/GSE60361_C1-3005-Expression.txt.gz", destfile = geoFile)</span></span><span><span>library</span>(data.table)</span><span>exprMatrix <span>&lt;-</span> <span>fread</span>(geoFile, <span>sep=</span><span>"</span><span>\t</span><span>"</span>)</span><span>exprMatrix[<span>1</span><span>:</span><span>5</span>,<span>1</span><span>:</span><span>5</span>]<span>#第一列是基因名，需要将其转换为行名</span></span></code></pre><pre><code>##     cell_id 1772071015_C02 1772071017_G12 1772071017_A05 1772071014_B06<br>## 1:  Tspan12              0              0              0              3<br>## 2:    Tshz1              3              1              0              2<br>## 3:   Fnbp1l              3              1              6              4<br>## 4: Adamts15              0              0              0              0<br>## 5:   Cldn12              1              1              1              0</code></pre><p><span>Hide</span></p><pre><code><span>geneNames <span>&lt;-</span> <span>unname</span>(<span>unlist</span>(exprMatrix[,<span>1</span>, <span>with=</span><span>FALSE</span>]))</span><span>geneNames[<span>1</span><span>:</span><span>5</span>]</span></code></pre><pre><code>## [1] "Tspan12"  "Tshz1"    "Fnbp1l"   "Adamts15" "Cldn12"</code></pre><p><br></p><pre><code><span>exprMatrix <span>&lt;-</span> <span>as.matrix</span>(exprMatrix[,<span>-</span><span>1</span>, <span>with=</span><span>FALSE</span>])</span><span><span>rownames</span>(exprMatrix) <span>&lt;-</span> geneNames</span><span>exprMatrix <span>&lt;-</span> exprMatrix[<span>unique</span>(<span>rownames</span>(exprMatrix)),]</span><span><span>dim</span>(exprMatrix)</span></code></pre><pre><code>## [1] 19970  3005</code></pre><p><br></p><pre><code><span>exprMatrix[<span>1</span><span>:</span><span>5</span>,<span>1</span><span>:</span><span>4</span>]</span></code></pre><pre><code>##          1772071015_C02 1772071017_G12 1772071017_A05 1772071014_B06<br>## Tspan12               0              0              0              3<br>## Tshz1                 3              1              0              2<br>## Fnbp1l                3              1              6              4<br>## Adamts15              0              0              0              0<br>## Cldn12                1              1              1              0</code></pre><p><br></p><pre><code><span><span>#将矩阵转换为稀疏矩阵</span></span><span><span>library</span>(Matrix)</span><span>exprMatrix <span>&lt;-</span> <span>as</span>(exprMatrix, <span>"dgCMatrix"</span>)</span><span><span>#保存成Rdata</span></span><span>mouseBrainExprMatrix <span>&lt;-</span> exprMatrix</span><span><span>save</span>(mouseBrainExprMatrix, <span>file=</span><span>"exprMatrix_MouseBrain.RData"</span>)</span></code></pre><p>这里为了加速演示过程并节省计算资源，做一个抽样，随机抽取表达矩阵中的5000个基因</p><pre><code><span><span>set.seed</span>(<span>333</span>)<span>#设定随机数一定程度上保证结果的可重复性</span></span><span><span>load</span>(<span>'exprMatrix_MouseBrain.RData'</span>)</span><span>exprMatrix <span>&lt;-</span> mouseBrainExprMatrix[<span>sample</span>(<span>rownames</span>(mouseBrainExprMatrix), <span>5000</span>),]</span><span><span>dim</span>(exprMatrix)</span></code></pre><pre><code>## [1] 5000 3005</code></pre><h3><span>2.2.2 测试基因集</span></h3><pre><code><span><span>library</span>(AUCell)</span><span><span>library</span>(GSEABase)</span><span>gmtFile <span>&lt;-</span> <span>paste</span>(<span>file.path</span>(<span>system.file</span>(<span>'examples'</span>,</span><span>                                       <span>package=</span><span>'AUCell'</span>)), </span><span>                 <span>"geneSignatures.gmt"</span>, <span>sep=</span><span>"/"</span>)</span><span>geneSets <span>&lt;-</span> <span>getGmt</span>(gmtFile)</span></code></pre><p><br></p><p>这个数据的结构大概是这样: </p><p><img data-ratio="0.5836298932384342" data-src="https://mmbiz.qpic.cn/mmbiz_png/ImlBFVOwwpwTOdQWfZIn0UGffHPhHXZpscMLggdicz8A3obcHHQk2ds6C7KqKDYcVnDJEPia9SpNYT2eswBswBuQ/640?wx_fmt=png" data-type="jpeg" data-w="843" src="https://mmbiz.qpic.cn/mmbiz_png/ImlBFVOwwpwTOdQWfZIn0UGffHPhHXZpscMLggdicz8A3obcHHQk2ds6C7KqKDYcVnDJEPia9SpNYT2eswBswBuQ/640?wx_fmt=png"></p><p><br></p><pre><code><span><span>rownames</span>(exprMatrix)[<span>1</span><span>:</span><span>5</span>]</span></code></pre><pre><code>## [1] "Gm5833"   "Gm16119"  "Arhgap44" "Snord99"  "Ccl5"</code></pre><p><br></p><pre><code><span><span>#取出表达矩阵中包含的</span></span><span>geneSets <span>&lt;-</span> <span>subsetGeneSets</span>(geneSets, <span>rownames</span>(exprMatrix))</span><span><span>#查看每个基因集中包含在表达矩阵中的基因数量</span></span><span><span>nGenes</span>(geneSets)</span></code></pre><pre><code>##       Astrocyte_Cahoy          Neuron_Cahoy Oligodendrocyte_Cahoy <br>##                   526                   404                   469 <br>##        Astrocyte_Lein           Neuron_Lein       Microglia_lavin <br>##                     7                    15                   159</code></pre><p><br></p><pre><code><span><span>#把每个基因集包含的基因数量加在基因集名称后面：</span></span><span>geneSets <span>&lt;-</span> <span>setGeneSetNames</span>(geneSets, <span>newNames=</span><span>paste</span>(<span>names</span>(geneSets), <span>" ("</span>, <span>nGenes</span>(geneSets) ,<span>"g)"</span>, <span>sep=</span><span>""</span>))</span><span><span>names</span>(geneSets)</span></code></pre><pre><code>## [1] "Astrocyte_Cahoy (526g)"       "Neuron_Cahoy (404g)"         <br>## [3] "Oligodendrocyte_Cahoy (469g)" "Astrocyte_Lein (7g)"         <br>## [5] "Neuron_Lein (15g)"            "Microglia_lavin (159g)"</code></pre><p>为了确定上述基因集结果的真实性，这里掺入一些<strong>随机抽取</strong>的<strong>模拟</strong>基因集</p><p><br></p><pre><code><span><span>set.seed</span>(<span>321</span>)</span><span>extraGeneSets <span>&lt;-</span> <span>c</span>(</span><span>  <span>GeneSet</span>(<span>sample</span>(<span>rownames</span>(exprMatrix), <span>50</span>), <span>setName=</span><span>"Random (50g)"</span>),</span><span>  <span>GeneSet</span>(<span>sample</span>(<span>rownames</span>(exprMatrix), <span>500</span>), <span>setName=</span><span>"Random (500g)"</span>))</span><span><span>#统计count大于0的基因：</span></span><span>countsPerGene <span>&lt;-</span> <span>apply</span>(exprMatrix, <span>1</span>, <span>function</span>(x) <span>sum</span>(x<span>&gt;</span><span>0</span>))</span><span>gene4use <span>&lt;-</span> <span>sample</span>(<span>names</span>(countsPerGene)[<span>which</span>(countsPerGene<span>&gt;</span><span>quantile</span>(countsPerGene, <span>probs=</span>.<span>95</span>))], <span>100</span>)<span>#从表达量前5%的函数中随机抽取一百个基因</span></span><span><span>#构建基因集：</span></span><span>extraGeneSets <span>&lt;-</span> <span>c</span>(extraGeneSets,</span><span>                   <span>GeneSet</span>(gene4use, <span>setName=</span><span>"HK-like (100g)"</span>))<span>#这些基因的表达量比较高，这里可以初步命名为house-keeping like Gene</span></span><span><span>#合并测试基因集与模拟基因集</span></span><span>geneSets <span>&lt;-</span> <span>GeneSetCollection</span>(<span>c</span>(geneSets,extraGeneSets))</span><span><span>names</span>(geneSets)</span></code></pre><pre><code>## [1] "Astrocyte_Cahoy (526g)"       "Neuron_Cahoy (404g)"         <br>## [3] "Oligodendrocyte_Cahoy (469g)" "Astrocyte_Lein (7g)"         <br>## [5] "Neuron_Lein (15g)"            "Microglia_lavin (159g)"      <br>## [7] "Random (50g)"                 "Random (500g)"               <br>## [9] "HK-like (100g)"</code></pre><h2><span>2.3 AUCell流程</span></h2><p>与<code>GSVA</code>不同的是，<code>GSVA</code>需要输入完整的表达矩阵(样本数、基因数以及表达矩阵的单位都会影响GSVA score的计算)。但是由于AUCell有一步<code>rank</code>的过程，因此输入矩阵的完整性要求没有那么严格。</p><h3><span>2.3.1 一步法计算基因集的富集分数(AUC)</span></h3><p><br></p><pre><code><span><span>if</span>(<span>!</span><span>require</span>(BiocParallel))BiocManager<span>::</span><span>install</span>(<span>'BiocParallel'</span>)</span></code></pre><pre><code>## 载入需要的程辑包：BiocParallel</code></pre><p><br></p><pre><code><span>BPPARAM<span>=</span>BiocParallel<span>::</span><span>MulticoreParam</span>(<span>5</span>)<span>#开5个核并行计算</span></span></code></pre><pre><code>## Warning in BiocParallel::MulticoreParam(5): MulticoreParam() not supported on<br>## Windows, use SnowParam()</code></pre><p><br></p><pre><code><span>cells_AUC <span>&lt;-</span> <span>AUCell_run</span>(exprMatrix, geneSets)<span>#1.16.0版本的AUCell没有AUCell_run这个函数，推荐在R4.2.1目录下安装AUCell的1.18.1版本</span></span><span><span>#AUCell score的矩阵存在:</span></span><span>cells_AUC<span>@</span>assays<span>@</span>data<span>$</span>AUC[<span>1</span><span>:</span><span>4</span>,<span>1</span><span>:</span><span>4</span>]</span></code></pre><pre><code>##                               cells<br>## gene sets                      1772071015_C02 1772071017_G12 1772071017_A05<br>##   Astrocyte_Cahoy (526g)            0.1463133      0.1372851      0.1588755<br>##   Neuron_Cahoy (404g)               0.2775261      0.2978313      0.2960964<br>##   Oligodendrocyte_Cahoy (469g)      0.1507791      0.1219598      0.1357430<br>##   Astrocyte_Lein (7g)               0.1509872      0.1399535      0.2166086<br>##                               cells<br>## gene sets                      1772071014_B06<br>##   Astrocyte_Cahoy (526g)            0.1650442<br>##   Neuron_Cahoy (404g)               0.3202570<br>##   Oligodendrocyte_Cahoy (469g)      0.1296386<br>##   Astrocyte_Lein (7g)               0.2485482</code></pre><p><br></p><pre><code><span><span>save</span>(cells_AUC, <span>file=</span><span>"cells_AUC.RData"</span>)</span><span><span>#画个热图看一下：</span></span><span><span>suppressMessages</span>(<span>if</span>(<span>!</span><span>require</span>(pheatmap))<span>install.packages</span>(<span>'pheatmap'</span>))</span><span><span>pheatmap</span>(cells_AUC<span>@</span>assays<span>@</span>data<span>$</span>AUC,<span>show_colnames =</span> F)<span>#没错，确实是连续性数值，因为AUCell score是一个积分，所以也不会像GSVA那样有负值啦。</span></span></code></pre><p><img data-ratio="0.7142857142857143" data-src="https://mmbiz.qpic.cn/mmbiz_png/ImlBFVOwwpwTOdQWfZIn0UGffHPhHXZprMIBlxibM9OQg5cPCYwVWTGOhxopjGuv2MjSkWaxKoTticzHvUsic8Pkg/640?wx_fmt=png" data-type="png" data-w="1344" width="672" src="https://mmbiz.qpic.cn/mmbiz_png/ImlBFVOwwpwTOdQWfZIn0UGffHPhHXZprMIBlxibM9OQg5cPCYwVWTGOhxopjGuv2MjSkWaxKoTticzHvUsic8Pkg/640?wx_fmt=png"></p><h3><span>2.3.2 拆解计算步骤</span></h3><p><code>AUCell_run</code>等同于下面的<code>AUCell_buildRankings</code><strong>+</strong><code>AUCell_calcAUC</code>，拆分出来有利于大家理解AUCell的计算过程</p><p><br></p><pre><code><span><span>plotGeneCount</span>(<span>as.matrix</span>(exprMatrix))<span>#可以先看一下每个细胞中表达的基因数量,这组细胞表达基因数量中位数不足一千个</span></span></code></pre><pre><code>## Quantiles for the number of genes detected by cell: <br>## (Non-detected genes are shuffled at the end of the ranking. Keep it in mind when choosing the threshold for calculating the AUC).</code></pre><p><img data-ratio="0.7142857142857143" data-src="https://mmbiz.qpic.cn/mmbiz_png/ImlBFVOwwpwTOdQWfZIn0UGffHPhHXZprUk5SrKgYl0H7KFJgS2cJN6xZVoGx0UztylCKNVej9FJX6ghPokXQw/640?wx_fmt=png" data-type="png" data-w="1344" width="672" src="https://mmbiz.qpic.cn/mmbiz_png/ImlBFVOwwpwTOdQWfZIn0UGffHPhHXZprUk5SrKgYl0H7KFJgS2cJN6xZVoGx0UztylCKNVej9FJX6ghPokXQw/640?wx_fmt=png"></p><pre><code>##     min      1%      5%     10%     50%    100% <br>##  193.00  271.08  364.20  447.40  921.00 2056.00</code></pre><p><br></p><pre><code><span>cells_rankings <span>&lt;-</span> <span>AUCell_buildRankings</span>(exprMatrix, <span>plotStats=</span><span>FALSE</span>, <span>splitByBlocks=</span><span>TRUE</span>)<span>#把每一个细胞的基因从表达量由高向低排列</span></span><span>cells_rankings<span>#由于这步ranking，大家合并不同的数据集时需要保证数据集里每个细胞检测到的基因数量相近</span></span></code></pre><pre><code>## Ranking for 5000 genes (rows) and 3005 cells (columns).<br>## <br>## Top-left corner of the ranking:<br>##           cells<br>## genes      1772071015_C02 1772071017_G12 1772071017_A05 1772071014_B06<br>##   Gm5833             4904           3305           4028           3895<br>##   Gm16119            2327           1596           1794           2610<br>##   Arhgap44            182           2937            330            296<br>##   Snord99            4021           2865           4514           4628<br>##   Ccl5               3794           4095           3332           3794<br>##   Sox18              4807           3052           3126           3365<br>##           cells<br>## genes      1772067065_H06<br>##   Gm5833             3028<br>##   Gm16119            2588<br>##   Arhgap44            157<br>##   Snord99            2932<br>##   Ccl5               2774<br>##   Sox18              4918</code></pre><p><br></p><pre><code><span>cells_AUC <span>&lt;-</span> <span>AUCell_calcAUC</span>(geneSets, cells_rankings)</span></code></pre><pre><code>## Warning in .AUCell_calcAUC(geneSets = geneSets, rankings = rankings, nCores =<br>## nCores, : Using only the first 250 genes (aucMaxRank) to calculate the AUC.</code></pre><p><br></p><pre><code><span><span>#为了应对大数据的计算以及去噪，只有每个细胞表达量最高的前5%的基因参与计算</span></span><span><span>#这一比例可以通过'aucMaxRank'参数调整，比如：</span></span><span>cells_AUC <span>&lt;-</span> <span>AUCell_calcAUC</span>(geneSets, cells_rankings,</span><span>                   <span>aucMaxRank =</span> <span>ceiling</span>(<span>0.05</span> <span>*</span> <span>nrow</span>(cells_rankings)))</span></code></pre><pre><code>## Warning in .AUCell_calcAUC(geneSets = geneSets, rankings = rankings, nCores =<br>## nCores, : Using only the first 250 genes (aucMaxRank) to calculate the AUC.</code></pre><section>按照我个人的理解，AUCell的过程类似于对每个细胞的基因排序后进行GSEA分析(GSEA的教程可以<a href="https://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247484175&amp;idx=1&amp;sn=3e45ad62b045a541874e5ae7ca03f849&amp;chksm=9b3f7a5fac48f349f8893500825d2c6b4ff581fbb0816c1074d88a0dbbb4a612c1e1bb3740bb&amp;scene=21#wechat_redirect" data-linktype="2">点这里</a>)，然后把基因的排序作为一个<strong>连续值</strong>，<strong>求积分</strong>。</section><section><code>AUC</code>一定程度上反应了signature基因表达的比例，并且可以代表它们相对于细胞内其他基因的相对表达值。换句话说，我们可以使用AUC来探索数据集中存在的细胞种群。AUC也会考虑到每个细胞中高度表达的基因在基因集中的比例。从基因集中表达很多基因的细胞将比表达较少的细胞拥有更高的AUC值，也就是说AUC的值在不同的基因集之间也是可以相互比较的。由于AUC一定程度上代表了signature中表达基因的比例，因此细胞间的相对AUC来根据基因集的表达来探索数据集中存在的细胞群体(根据SCENIC的文献报道利用AUCell score进行细胞分群的效果甚至要比大多数去除批次效用的方法都好)。</section><section>但是由于AUCell score并不是一个绝对表达值，以及考虑到细胞大小、选择的基因集的大小(越大的基因集AUCell score越大，并且越容易呈现正态分布)和表达情况、单细胞测序矩阵的稀疏性，通过AUCell score来判断一个基因集的表达是激活还是沉默需要进一步的探索。</section><section>这个问题实质上需要解决如何将AUCell score这一连续性矩阵转换为二项分布的矩阵。这时可以用<code>AUCell_exploreThresholds()</code>自动绘制直方图，并自动计算数个阈值，可以用来考虑一个基因集是on或off“(在<code>$aucThr</code>中返回)。对应的阈值用匹配颜色的竖条表示，较粗的竖线表示软件默认选择的阈值($aucThr$selected)，这一阈值能够最大限度的减少假阳性。</section><p><br></p><pre><code><span><span>if</span> (<span>!</span><span>requireNamespace</span>(<span>"mixtools"</span>, <span>quietly=</span><span>TRUE</span>))BiocManager<span>::</span><span>install</span>(<span>"mixtools"</span>) </span><span><span>set.seed</span>(<span>123</span>)</span><span><span>par</span>(<span>mfrow=</span><span>c</span>(<span>3</span>,<span>3</span>)) </span><span>cells_assignment <span>&lt;-</span> <span>AUCell_exploreThresholds</span>(cells_AUC, <span>plotHist=</span><span>TRUE</span>, <span>assign=</span><span>TRUE</span>)<span>#计算阈值并绘制柱状图</span></span></code></pre><p><img data-ratio="0.7142857142857143" data-src="https://mmbiz.qpic.cn/mmbiz_png/ImlBFVOwwpwTOdQWfZIn0UGffHPhHXZpqmVmq845TsrECEWMjpTYeYFZAX6LIFsFzJSHyuWCrhcRQLwPZovlzA/640?wx_fmt=png" data-type="png" data-w="1344" width="672" src="https://mmbiz.qpic.cn/mmbiz_png/ImlBFVOwwpwTOdQWfZIn0UGffHPhHXZpqmVmq845TsrECEWMjpTYeYFZAX6LIFsFzJSHyuWCrhcRQLwPZovlzA/640?wx_fmt=png"></p><p><br></p><pre><code><span><span>#返回的数据结构包含软件选择的最佳阈值，其他阈值的返回结果(阈值参数与当前阈值下"on"的细胞数量)，软件返回的comment</span></span><span>cells_assignment<span>$</span><span>`</span><span>Astrocyte_Cahoy (526g)</span><span>`</span><span>$</span>aucThr</span></code></pre><pre><code>## $selected<br>##      L_k2 <br>## 0.2384452 <br>## <br>## $thresholds<br>##            threshold nCells<br>## Global_k1 0.18579694    375<br>## L_k2      0.23844518    220<br>## R_k3      0.09762972   2629<br>## <br>## $comment<br>## [1] ""</code></pre><p><br></p><pre><code><span>warningMsg <span>&lt;-</span> <span>sapply</span>(cells_assignment, <span>function</span>(x) x<span>$</span>aucThr<span>$</span>comment)<span>#把comment循环取出</span></span><span>warningMsg[<span>which</span>(warningMsg<span>!=</span><span>""</span>)]<span>#查看非空的comment</span></span></code></pre><pre><code>##                                                                                                                  Random (500g) <br>## "The AUC might follow a normal distribution (random gene-set?).  The global distribution overlaps the partial distributions. "</code></pre><p><br></p><pre><code><span><span>#之间混入的随机选取的基因集被发现了，判定为正态分布的矩阵</span></span><span><span>#同样的代码我们可以得到每个geneset的最佳阈值：</span></span><span><span>sapply</span>(cells_assignment, <span>function</span>(x) x<span>$</span>aucThr<span>$</span>selected)</span></code></pre><pre><code>##              Astrocyte_Cahoy (526g).L_k2 <br>##                               0.23844518 <br>##          Neuron_Cahoy (404g).minimumDens <br>##                               0.14918986 <br>## Oligodendrocyte_Cahoy (469g).minimumDens <br>##                               0.23828191 <br>##          Astrocyte_Lein (7g).minimumDens <br>##                               0.03079067 <br>##            Neuron_Lein (15g).minimumDens <br>##                               0.18279180 <br>##              Microglia_lavin (159g).L_k2 <br>##                               0.13368241 <br>##                   Random (50g).Global_k1 <br>##                               0.01883846 <br>##            Random (500g).outlierOfGlobal <br>##                               0.15682484 <br>##                      HK-like (100g).L_k2 <br>##                               0.69133962</code></pre><p><br></p><pre><code><span><span>#在默认最佳阈值下获得的处于"on"状态下的细胞barcode名称(这里只展示前五个)</span></span><span><span>suppressMessages</span>(<span>library</span>(dplyr))</span><span><span>sapply</span>(cells_assignment, <span>function</span>(x) x<span>$</span>assignment <span>%&gt;%</span> .[<span>1</span><span>:</span><span>5</span>])</span></code></pre><pre><code>##      Astrocyte_Cahoy (526g) Neuron_Cahoy (404g) Oligodendrocyte_Cahoy (469g)<br>## [1,] "1772071015_A01"       "1772071015_C02"    "1772067069_B02"            <br>## [2,] "1772066080_D10"       "1772071017_G12"    "1772071041_A02"            <br>## [3,] "1772066099_C03"       "1772071017_A05"    "1772066077_G03"            <br>## [4,] "1772071036_B05"       "1772071014_B06"    "1772066070_D08"            <br>## [5,] "1772067060_G06"       "1772067065_H06"    "1772067076_A07"            <br>##      Astrocyte_Lein (7g) Neuron_Lein (15g) Microglia_lavin (159g)<br>## [1,] "1772071015_C02"    "1772071015_C02"  "1772062116_E04"      <br>## [2,] "1772071017_G12"    "1772071017_G12"  "1772060225_F12"      <br>## [3,] "1772071017_A05"    "1772071017_A05"  "1772062118_B06"      <br>## [4,] "1772071014_B06"    "1772071014_B06"  "1772066077_B04"      <br>## [5,] "1772067065_H06"    "1772067065_H06"  "1772058171_F04"      <br>##      Random (50g)     Random (500g) HK-like (100g)<br>## [1,] "1772071017_A05" NA            NA            <br>## [2,] "1772071014_E04" NA            NA            <br>## [3,] "1772071017_F09" NA            NA            <br>## [4,] "1772071017_A09" NA            NA            <br>## [5,] "1772067094_C05" NA            NA</code></pre><p><br></p><pre><code><span><span>#在默认最佳阈值下获得的处于"on"状态下的细胞数量</span></span><span><span>sapply</span>(cells_assignment, <span>function</span>(x) x<span>$</span>assignment <span>%&gt;%</span> length)</span></code></pre><pre><code>##       Astrocyte_Cahoy (526g)          Neuron_Cahoy (404g) <br>##                          220                         1777 <br>## Oligodendrocyte_Cahoy (469g)          Astrocyte_Lein (7g) <br>##                          741                         2633 <br>##            Neuron_Lein (15g)       Microglia_lavin (159g) <br>##                         1794                           35 <br>##                 Random (50g)                Random (500g) <br>##                          657                            0 <br>##               HK-like (100g) <br>##                            0</code></pre><p><br></p><pre><code><span><span>#画出对应geneset处于on状态下的细胞</span></span><span>geneSetName <span>&lt;-</span> <span>rownames</span>(cells_AUC)[<span>grep</span>(<span>"Oligodendrocyte_Cahoy"</span>, <span>rownames</span>(cells_AUC))]</span><span><span>par</span>(<span>mfrow=</span><span>c</span>(<span>1</span>,<span>1</span>)) </span><span><span>AUCell_plotHist</span>(cells_AUC[geneSetName,], <span>aucThr=</span>cells_assignment<span>$</span><span>`</span><span>Oligodendrocyte_Cahoy (469g)</span><span>`</span><span>$</span>aucThr<span>$</span>selected)</span><span><span>abline</span>(<span>v=</span>cells_assignment<span>$</span><span>`</span><span>Oligodendrocyte_Cahoy (469g)</span><span>`</span><span>$</span>aucThr<span>$</span>selected)</span></code></pre><p><img data-ratio="0.7142857142857143" data-src="https://mmbiz.qpic.cn/mmbiz_png/ImlBFVOwwpwTOdQWfZIn0UGffHPhHXZpUelcQJiaiamiazWOEC8cQa3DFp39eSND909QT8NetPJzhQl6lOD8JIATA/640?wx_fmt=png" data-type="png" data-w="1344" width="672" src="https://mmbiz.qpic.cn/mmbiz_png/ImlBFVOwwpwTOdQWfZIn0UGffHPhHXZpUelcQJiaiamiazWOEC8cQa3DFp39eSND909QT8NetPJzhQl6lOD8JIATA/640?wx_fmt=png"></p><p><br></p><pre><code><span><span>#解放劳动力，还是得靠写循环展示出所有geneset的情况</span></span><span><span>par</span>(<span>mfrow=</span><span>c</span>(<span>3</span>,<span>3</span>)) </span><span><span>for</span>(i <span>in</span> <span>1</span><span>:</span><span>length</span>(cells_assignment)){</span><span>  temp.name <span>&lt;-</span> <span>gsub</span>(<span>' (.*)'</span>,<span>''</span>,<span>names</span>(cells_assignment)[i])</span><span>  temp.cellname <span>&lt;-</span> <span>rownames</span>(cells_AUC)[<span>grep</span>(temp.name, <span>rownames</span>(cells_AUC))]</span><span>  <span>AUCell_plotHist</span>(cells_AUC[temp.cellname,], <span>aucThr=</span>cells_assignment[[i]]<span>$</span>aucThr<span>$</span>selected)</span><span>  <span>abline</span>(<span>v=</span>cells_assignment[[i]]<span>$</span>aucThr<span>$</span>selected)</span><span>}</span></code></pre><p><img data-ratio="0.7142857142857143" data-src="https://mmbiz.qpic.cn/mmbiz_png/ImlBFVOwwpwTOdQWfZIn0UGffHPhHXZpN7hbAKS4zjq0nicyBicV4LsJbiaiaAtxGzdEXSa6cvB4uKIVZH4wBxBdWw/640?wx_fmt=png" data-type="png" data-w="1344" width="672" src="https://mmbiz.qpic.cn/mmbiz_png/ImlBFVOwwpwTOdQWfZIn0UGffHPhHXZpN7hbAKS4zjq0nicyBicV4LsJbiaiaAtxGzdEXSa6cvB4uKIVZH4wBxBdWw/640?wx_fmt=png"><img data-ratio="0.7142857142857143" data-src="https://mmbiz.qpic.cn/mmbiz_png/ImlBFVOwwpwTOdQWfZIn0UGffHPhHXZpKm6cpicXGibCRtUWsMjLWh2dbez1WOHW5TAGzfsp67QhyicO8hlWKpb5Q/640?wx_fmt=png" data-type="png" data-w="1344" width="672" src="https://mmbiz.qpic.cn/mmbiz_png/ImlBFVOwwpwTOdQWfZIn0UGffHPhHXZpKm6cpicXGibCRtUWsMjLWh2dbez1WOHW5TAGzfsp67QhyicO8hlWKpb5Q/640?wx_fmt=png"></p><h3><span>2.3.3 进一步分析</span></h3><pre><code><span>cellsAssigned <span>&lt;-</span> <span>lapply</span>(cells_assignment, <span>function</span>(x) x<span>$</span>assignment)<span>#去除assignment，即'on'的barcode</span></span><span>assignmentTable <span>&lt;-</span> reshape2<span>::</span><span>melt</span>(cellsAssigned, <span>value.name=</span><span>"cell"</span>)<span>#转换成长格式的table</span></span><span><span>colnames</span>(assignmentTable)[<span>2</span>] <span>&lt;-</span> <span>"geneSet"</span></span><span><span>head</span>(assignmentTable)</span></code></pre><pre><code>##             cell                geneSet<br>## 1 1772071015_A01 Astrocyte_Cahoy (526g)<br>## 2 1772066080_D10 Astrocyte_Cahoy (526g)<br>## 3 1772066099_C03 Astrocyte_Cahoy (526g)<br>## 4 1772071036_B05 Astrocyte_Cahoy (526g)<br>## 5 1772067060_G06 Astrocyte_Cahoy (526g)<br>## 6 1772058148_A03 Astrocyte_Cahoy (526g)</code></pre><p><br></p><pre><code><span>assignmentMat <span>&lt;-</span> <span>table</span>(assignmentTable[,<span>"geneSet"</span>], assignmentTable[,<span>"cell"</span>])</span><span>assignmentMat[<span>1</span><span>:</span><span>4</span>,<span>1</span><span>:</span><span>4</span>]<span>#统计，table到的就是1(on)，不存在的就是0(off),也就是说geneset从这一步变成了二项分布的矩阵</span></span></code></pre><pre><code>##                         <br>##                          1772058148_A01 1772058148_A03 1772058148_A04<br>##   Astrocyte_Cahoy (526g)              0              1              0<br>##   Astrocyte_Lein (7g)                 1              1              1<br>##   Microglia_lavin (159g)              0              0              0<br>##   Neuron_Cahoy (404g)                 0              0              0<br>##                         <br>##                          1772058148_A05<br>##   Astrocyte_Cahoy (526g)              0<br>##   Astrocyte_Lein (7g)                 1<br>##   Microglia_lavin (159g)              1<br>##   Neuron_Cahoy (404g)                 0</code></pre><p><br></p><p>可以通过热图的形式展示这个二元的矩阵</p><pre><code><span><span>set.seed</span>(<span>123</span>)</span><span><span>suppressMessages</span>(<span>library</span>(NMF))</span><span><span>aheatmap</span>(assignmentMat, <span>scale=</span><span>"none"</span>, <span>color=</span><span>"black"</span>, <span>legend=</span><span>FALSE</span>)</span></code></pre><p><img data-ratio="0.7142857142857143" data-src="https://mmbiz.qpic.cn/mmbiz_png/ImlBFVOwwpwTOdQWfZIn0UGffHPhHXZpR3tKo1BwlXwuQJNlOflBzWarTu1qz8MDnQ7hIbdOMYhIh08tEDdgZw/640?wx_fmt=png" data-type="png" data-w="1344" width="672" src="https://mmbiz.qpic.cn/mmbiz_png/ImlBFVOwwpwTOdQWfZIn0UGffHPhHXZpR3tKo1BwlXwuQJNlOflBzWarTu1qz8MDnQ7hIbdOMYhIh08tEDdgZw/640?wx_fmt=png"></p><h3><span>2.3.4 实测一下AUCell score对单细胞分群的帮助</span></h3><p>读取原始表达矩阵并进行<code>tsne</code>分析</p><p><br></p><pre><code><span>mouseBrainExprMatrix[<span>1</span><span>:</span><span>4</span>,<span>1</span><span>:</span><span>4</span>]<span>#表达矩阵</span></span><span>sumByGene <span>&lt;-</span> <span>apply</span>(mouseBrainExprMatrix, <span>1</span>, sum)<span>#对每个基因的count求和</span></span><span>exprMatSubset <span>&lt;-</span> mouseBrainExprMatrix[<span>which</span>(sumByGene<span>&gt;</span><span>0</span>),]<span>#从矩阵中删除不表达的基因</span></span><span>logMatrix <span>&lt;-</span> <span>log2</span>(exprMatSubset<span>+</span><span>1</span>)</span><span>logMatrix <span>&lt;-</span> <span>as.matrix</span>(logMatrix)</span><span><span>library</span>(Rtsne)</span><span><span>set.seed</span>(<span>123</span>)</span><span>cellsTsne <span>&lt;-</span> <span>Rtsne</span>(<span>t</span>(logMatrix))<span>#运行TSNE</span></span><span><span>rownames</span>(cellsTsne<span>$</span>Y) <span>&lt;-</span> <span>colnames</span>(logMatrix)</span><span><span>colnames</span>(cellsTsne<span>$</span>Y) <span>&lt;-</span> <span>c</span>(<span>"tsne1"</span>, <span>"tsne2"</span>)</span><span><span>save</span>(cellsTsne, <span>file=</span><span>"cellsTsne.RData"</span>)</span></code></pre><p><br></p><pre><code><span><span>load</span>(<span>'cellsTsne.RData'</span>)</span><span>cellsTsne <span>&lt;-</span> cellsTsne<span>$</span>Y</span><span><span>plot</span>(cellsTsne, <span>pch=</span><span>16</span>, <span>cex=</span>.<span>3</span>)</span></code></pre><p><img data-ratio="0.7142857142857143" data-src="https://mmbiz.qpic.cn/mmbiz_png/ImlBFVOwwpwTOdQWfZIn0UGffHPhHXZpEy4mWrM3HPibrAzQUicZ05OT04Diaj9WExh4XLLHey3rHtacALt0ibyiamw/640?wx_fmt=png" data-type="png" data-w="1344" width="672" src="https://mmbiz.qpic.cn/mmbiz_png/ImlBFVOwwpwTOdQWfZIn0UGffHPhHXZpEy4mWrM3HPibrAzQUicZ05OT04Diaj9WExh4XLLHey3rHtacALt0ibyiamw/640?wx_fmt=png"></p><p><br></p><pre><code><span><span>library</span>(DT)</span><span><span>datatable</span>(assignmentTable, <span>options =</span> <span>list</span>(<span>pageLength =</span> <span>10</span>), <span>filter=</span><span>"top"</span>)</span></code></pre><p><br></p><table aria-describedby="DataTables_Table_0_info" width="557"><thead><tr><th rowspan="1" colspan="1" aria-label=" "><br></th><th rowspan="1" colspan="1" aria-label=" "><br></th><th rowspan="1" colspan="1" aria-label=" "><br></th></tr><tr><td rowspan="1" colspan="1"><br></td><td data-type="character" rowspan="1" colspan="1"><br></td><td data-type="character" rowspan="1" colspan="1"><br></td></tr></thead><tbody><tr><td>1</td><td>1772071015_A01</td><td>Astrocyte_Cahoy (526g)</td></tr><tr><td>2</td><td>1772066080_D10</td><td>Astrocyte_Cahoy (526g)</td></tr><tr><td>3</td><td>1772066099_C03</td><td>Astrocyte_Cahoy (526g)</td></tr><tr><td>4</td><td>1772071036_B05</td><td>Astrocyte_Cahoy (526g)</td></tr><tr><td>5</td><td>1772067060_G06</td><td>Astrocyte_Cahoy (526g)</td></tr><tr><td>6</td><td>1772058148_A03</td><td>Astrocyte_Cahoy (526g)</td></tr><tr><td>7</td><td>1772060240_H04</td><td>Astrocyte_Cahoy (526g)</td></tr><tr><td>8</td><td>1772063063_B11</td><td>Astrocyte_Cahoy (526g)</td></tr><tr><td>9</td><td>1772060225_B12</td><td>Astrocyte_Cahoy (526g)</td></tr><tr><td>10</td><td>1772063074_E01</td><td>Astrocyte_Cahoy (526g)</td></tr></tbody></table><span><br></span></section><section><ul><li></ul><pre data-lang="css"><code><span><span>assignmentTable</span><span>[1:4,]</span></span></code></pre></section><section><span></span><pre><code>##             cell                geneSet<br>## 1 1772071015_A01 Astrocyte_Cahoy (526g)<br>## 2 1772066080_D10 Astrocyte_Cahoy (526g)<br>## 3 1772066099_C03 Astrocyte_Cahoy (526g)<br>## 4 1772071036_B05 Astrocyte_Cahoy (526g)</code></pre><p><br></p><p>在TSNE图中原位把AUCell score画出来看看，类似于Seurat::FeaturePlot()</p><pre><code><span>selectedThresholds <span>&lt;-</span> <span>getThresholdSelected</span>(cells_assignment)<span>#好吧，原来有直接获得selectedThr的方法，不需要写循环</span></span><span>selectedThresholds[<span>1</span><span>:</span><span>5</span>]</span></code></pre><pre><code>##       Astrocyte_Cahoy (526g)          Neuron_Cahoy (404g) <br>##                   0.23844518                   0.14918986 <br>## Oligodendrocyte_Cahoy (469g)          Astrocyte_Lein (7g) <br>##                   0.23828191                   0.03079067 <br>##            Neuron_Lein (15g) <br>##                   0.18279180</code></pre><p><br></p><pre><code><span><span>par</span>(<span>mfrow=</span><span>c</span>(<span>2</span>,<span>3</span>)) <span># Splits the plot into two rows and three columns</span></span><span><span>for</span>(geneSetName <span>in</span> <span>names</span>(selectedThresholds))</span><span>{</span><span>  <span>#处于off状态下的物种颜色：</span></span><span>  colorPal_Neg <span>&lt;-</span> grDevices<span>::</span><span>colorRampPalette</span>(<span>c</span>(<span>"black"</span>,<span>"blue"</span>, <span>"skyblue"</span>))(<span>5</span>)</span><span>  <span>#处于on状态下的物种颜色：</span></span><span>  colorPal_Pos <span>&lt;-</span> grDevices<span>::</span><span>colorRampPalette</span>(<span>c</span>(<span>"pink"</span>, <span>"magenta"</span>, <span>"red"</span>))(<span>5</span>)</span><span>  </span><span>  <span># 将细胞按照on和off拆开</span></span><span>  passThreshold <span>&lt;-</span> <span>getAUC</span>(cells_AUC)[geneSetName,] <span>&gt;</span>  selectedThresholds[geneSetName]</span><span>  <span>if</span>(<span>sum</span>(passThreshold) <span>&gt;</span><span>0</span> )</span><span>  {</span><span>    aucSplit <span>&lt;-</span> <span>split</span>(<span>getAUC</span>(cells_AUC)[geneSetName,], passThreshold)</span><span>    </span><span>    <span># Assign cell color</span></span><span>    cellColor <span>&lt;-</span> <span>c</span>(<span>setNames</span>(colorPal_Neg[<span>cut</span>(aucSplit[[<span>1</span>]], <span>breaks=</span><span>5</span>)], <span>names</span>(aucSplit[[<span>1</span>]])), </span><span>    <span>setNames</span>(colorPal_Pos[<span>cut</span>(aucSplit[[<span>2</span>]], <span>breaks=</span><span>5</span>)], <span>names</span>(aucSplit[[<span>2</span>]])))</span><span>    </span><span>    <span>plot</span>(cellsTsne, <span>main=</span>geneSetName,</span><span>    <span>sub=</span><span>"Pink/red cells pass the threshold"</span>,</span><span>    <span>col=</span>cellColor[<span>rownames</span>(cellsTsne)], <span>pch=</span><span>16</span>) </span><span>    <span>#这里的绘图方式其实也给我们DIY featurePlot提供了思路</span></span><span>  }</span><span>}</span></code></pre><p><img data-ratio="0.7142857142857143" data-src="https://mmbiz.qpic.cn/mmbiz_png/ImlBFVOwwpwTOdQWfZIn0UGffHPhHXZpLAZyCibfKKWSvYcdUtpBqNNYOaKVT37IbCSRzPFNrBBDNW9fVlDt0hA/640?wx_fmt=png" data-type="png" data-w="1344" width="672" src="https://mmbiz.qpic.cn/mmbiz_png/ImlBFVOwwpwTOdQWfZIn0UGffHPhHXZpLAZyCibfKKWSvYcdUtpBqNNYOaKVT37IbCSRzPFNrBBDNW9fVlDt0hA/640?wx_fmt=png"></p><p><br></p><pre><code><span><span>#还有一个更简单的方法：</span></span><span><span>par</span>(<span>mfrow=</span><span>c</span>(<span>2</span>,<span>3</span>))</span></code></pre><p><img data-ratio="0.7142857142857143" data-src="https://mmbiz.qpic.cn/mmbiz_png/ImlBFVOwwpwTOdQWfZIn0UGffHPhHXZpANClpM6R1Y1oxT2q6HUpoiammKQtMygIEMibribYkiavia8TbMSyHicVzRhA/640?wx_fmt=png" data-type="png" data-w="1344" width="672" src="https://mmbiz.qpic.cn/mmbiz_png/ImlBFVOwwpwTOdQWfZIn0UGffHPhHXZpANClpM6R1Y1oxT2q6HUpoiammKQtMygIEMibribYkiavia8TbMSyHicVzRhA/640?wx_fmt=png"></p><p><br></p><pre><code><span><span>AUCell_plotTSNE</span>(<span>tSNE=</span>cellsTsne, <span>exprMat=</span>exprMatrix, </span><span><span>cellsAUC=</span>cells_AUC[<span>1</span><span>:</span><span>2</span>,], <span>thresholds=</span>selectedThresholds[<span>1</span><span>:</span><span>2</span>])</span></code></pre><p><img data-ratio="0.7142857142857143" data-src="https://mmbiz.qpic.cn/mmbiz_png/ImlBFVOwwpwTOdQWfZIn0UGffHPhHXZpooMR44uE6tzBpqsRHJV5bBAKjlFHYmK6GuRPqzYwT6AfCW732zS2VQ/640?wx_fmt=png" data-type="png" data-w="1344" width="672" src="https://mmbiz.qpic.cn/mmbiz_png/ImlBFVOwwpwTOdQWfZIn0UGffHPhHXZpooMR44uE6tzBpqsRHJV5bBAKjlFHYmK6GuRPqzYwT6AfCW732zS2VQ/640?wx_fmt=png"></p><p><br></p><pre><code><span><span>#AUCell_plotTSNE三联分布展示了AUCell score的分布柱状图、TSNE原位展示通过阈值筛选的点、TSNE原位展示AUCell score</span></span></code></pre><p><br></p><p>作者这里还给了一个自动创建shinyApp的函数，再次让我叹为观止，我来好好学一学，下次给大家写个类似的</p><p><br></p><pre><code><span><span>library</span>(shiny); <span>library</span>(rbokeh)</span><span>exprMat <span>&lt;-</span> <span>log2</span>(mouseBrainExprMatrix<span>+</span><span>1</span>) <span># (back to the full matrix)</span></span><span><span># Create app </span></span><span>aucellApp <span>&lt;-</span> <span>AUCell_createViewerApp</span>(<span>auc=</span>cells_AUC, <span>thresholds=</span>selectedThresholds, </span><span>                                    <span>tSNE=</span>cellsTsne, <span>exprMat=</span>exprMat)</span><span><span># Run (the exact commands depend on the R settings, see Shiny's doc for help)</span></span><span><span>options</span>(<span>shiny.host=</span><span>"0.0.0.0"</span>) </span><span>savedSelections <span>&lt;-</span> <span>runApp</span>(aucellApp) </span><span><span># Other common settings:</span></span><span><span># host = getOption("shiny.host", "127.0.0.1") </span></span><span><span># shinyApp(ui=aucellApp$ui, server=aucellApp$server)</span></span><span><span># Optional: Visualize extra information about the cells (categorical variable)</span></span><span>cellInfoFile <span>&lt;-</span> <span>paste</span>(<span>file.path</span>(<span>system.file</span>(<span>'examples'</span>, <span>package=</span><span>'AUCell'</span>)), </span><span>                      <span>"mouseBrain_cellLabels.tsv"</span>, <span>sep=</span><span>"/"</span>)</span><span>cellInfo <span>&lt;-</span> <span>read.table</span>(cellInfoFile, <span>row.names=</span><span>1</span>, <span>header=</span><span>TRUE</span>, <span>sep=</span><span>"</span><span>\t</span><span>"</span>)</span><span><span>head</span>(cellInfo)</span><span>Another example <span>for</span> interactive <span>plot</span> (e.g. to save as html, no need to keep the server running)<span>:</span></span><span>  </span><span>  geneSetName <span>&lt;-</span> <span>"Astrocyte_Cahoy (555g)"</span></span><span><span>library</span>(rbokeh)</span><span>tSNE.df <span>&lt;-</span> <span>data.frame</span>(cellsTsne, <span>cell=</span><span>rownames</span>(cellsTsne))</span><span><span>figure</span>() <span>%&gt;%</span></span><span>  <span>ly_points</span>(tsne1, tsne2, <span>data=</span>tSNE.df, <span>size=</span><span>1</span>, <span>legend =</span> <span>FALSE</span>,</span><span>            <span>hover=</span>cell, <span>color=</span><span>getAUC</span>(cells_AUC)[geneSetName,<span>rownames</span>(tSNE.df)]) <span>%&gt;%</span></span><span>  <span>set_palette</span>(<span>continuous_color =</span> <span>pal_gradient</span>(<span>c</span>(<span>"lightgrey"</span>, <span>"pink"</span>, <span>"red"</span>)))</span></code></pre><h2><span>2.4 为什么选择AUCell?</span></h2><p>其实这个问题上文也解释过，最简单的评价基因集表达量的方法是算平均值，但是平均值容易受到基因表达量、测序文库大小的影响(这也就无法考虑到批次效应等非生物学问题)。而AUCell是对每个细胞的矩阵rank后做富集打分，可以回避这些问题，并且对每个细胞独立分析的策略可以回避normalization的方式(即<code>raw counts</code>, <code>TPM</code>, <code>UMI counts</code>等均可以作为输入数据)</p><p>做个简单的对比<br>这是基因集均值的展示:</p><p><br></p><pre><code><span>logMat <span>&lt;-</span> <span>log2</span>(exprMatrix<span>+</span><span>2</span>)</span><span>meanByGs <span>&lt;-</span> <span>t</span>(<span>sapply</span>(geneSets, <span>function</span>(gs) <span>colMeans</span>(logMat[<span>geneIds</span>(gs),])))</span><span><span>rownames</span>(meanByGs) <span>&lt;-</span> <span>names</span>(geneSets)</span><span>colorPal <span>&lt;-</span> grDevices<span>::</span><span>colorRampPalette</span>(<span>c</span>(<span>"white"</span>, <span>"red"</span>))(<span>5</span>)</span><span><span>par</span>(<span>mfrow=</span><span>c</span>(<span>3</span>,<span>3</span>))</span><span><span>for</span>(geneSetName <span>in</span> <span>names</span>(geneSets))</span><span>{</span><span>  cellColor <span>&lt;-</span> <span>setNames</span>(colorPal[<span>cut</span>(meanByGs[geneSetName,], <span>breaks=</span><span>5</span>)], <span>names</span>(meanByGs[geneSetName,]))</span><span>  <span>plot</span>(cellsTsne, <span>main=</span>geneSetName, <span>axes=</span><span>FALSE</span>, <span>xlab=</span><span>""</span>, <span>ylab=</span><span>""</span>,</span><span>  <span>sub=</span><span>"Expression mean"</span>,</span><span>  <span>col=</span>cellColor[<span>rownames</span>(cellsTsne)], <span>pch=</span><span>16</span>)</span><span>}</span></code></pre><p><img data-ratio="0.7142857142857143" data-src="https://mmbiz.qpic.cn/mmbiz_png/ImlBFVOwwpwTOdQWfZIn0UGffHPhHXZpEw1Z7Dw5yUT0aMhoK8NhMF8B1TFY4AGDjniaF4l0Rdlcx3VHfemKZPg/640?wx_fmt=png" data-type="png" data-w="1344" width="672" src="https://mmbiz.qpic.cn/mmbiz_png/ImlBFVOwwpwTOdQWfZIn0UGffHPhHXZpEw1Z7Dw5yUT0aMhoK8NhMF8B1TFY4AGDjniaF4l0Rdlcx3VHfemKZPg/640?wx_fmt=png"></p><p><br></p><p>这是AUCell score的展示:</p><pre><code><span><span>par</span>(<span>mfrow=</span><span>c</span>(<span>3</span>,<span>3</span>))</span><span><span>AUCell_plotTSNE</span>(<span>tSNE=</span>cellsTsne, <span>exprMat=</span>exprMatrix, <span>plots =</span> <span>"AUC"</span>,</span><span><span>cellsAUC=</span>cells_AUC[<span>1</span><span>:</span><span>9</span>,], <span>thresholds=</span>selectedThresholds)</span></code></pre><p><img data-ratio="0.7142857142857143" data-src="https://mmbiz.qpic.cn/mmbiz_png/ImlBFVOwwpwTOdQWfZIn0UGffHPhHXZp9czjjgLmwHzA3dIkPg4yD4ajrianwku4NPYv53xXI5IMo0aG3NlKRZg/640?wx_fmt=png" data-type="png" data-w="1344" width="672" src="https://mmbiz.qpic.cn/mmbiz_png/ImlBFVOwwpwTOdQWfZIn0UGffHPhHXZp9czjjgLmwHzA3dIkPg4yD4ajrianwku4NPYv53xXI5IMo0aG3NlKRZg/640?wx_fmt=png"></p><section>还有一个点是，这类基因集打分的软件大都是打个分即完事，而不仅AUCell自己创立了一套判断<code>on/off</code>的方法，可以帮助大家判断基因集是否被激活；还会为基因集的治疗做出评估，例如上面随机抽样的基因集就被<strong>AUCell</strong>发现符合正态分布，不适用于<code>on/off</code>的评价体系。</section></section></section></section></section><h1><br></h1><h1><br></h1><h1><span><strong>最后、单细胞教程全收录：</strong></span></h1><p><br></p><section data-support="96编辑器" data-style-id="35163"><section><section><img data-ratio="0.6349206349206349" data-src="https://mmbiz.qpic.cn/mmbiz_gif/Ljib4So7yuWgEPt6jo0gEwibQzFX4zmOqqiaM9bZyTy3bIjLJcicVlkUFwFvyicJx8wR2ZslWiaBicM4nw9AtyQ7k7ugA/640?wx_fmt=gif&amp;wxfrom=5&amp;wx_lazy=1" data-type="gif" data-w="63" data-width="100%" src="https://mmbiz.qpic.cn/mmbiz_gif/Ljib4So7yuWgEPt6jo0gEwibQzFX4zmOqqiaM9bZyTy3bIjLJcicVlkUFwFvyicJx8wR2ZslWiaBicM4nw9AtyQ7k7ugA/640?wx_fmt=gif&amp;wxfrom=5&amp;wx_lazy=1"></section><section><section><p><span>单细胞数据分析系列教程：</span></p><section><span>B站视频，先看一遍视频再去看推送操作，建议至少看三遍：</span></section><section><span>https://www.bilibili.com/video/BV1S44y1b76Z/</span></section><section><span>以下的资料都可以在这里订阅：</span></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247491618&amp;idx=1&amp;sn=ebd55322b512225ed1834bd307fc0baa&amp;chksm=9b3c9972ac4b1064bf1ec24f5c547cec831625db80da2f77e55ea56f8a326ca0cb715a0bff3d&amp;scene=21#wechat_redirect" textvalue="2022资料合辑" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2"><span>2022资料合辑</span></a><br></section><section><br></section><section><span>单细胞测序基础数据分析保姆级教程，代码部分整理在往期推送之中：</span></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247484077&amp;idx=1&amp;sn=e329bf865493d46308985f4c111370ae&amp;chksm=9b3f7bfdac48f2eb7e903510338bd772c6be34ccbcb681806d288e62a05eee28fa209d2f33b9&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1" wah-hotarea="click"><span>手把手教你做单细胞测序数据分析（一）——绪论</span></a><br></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247484086&amp;idx=1&amp;sn=7346a09ba350d6fb7c806dcb7509a1ef&amp;chksm=9b3f7be6ac48f2f02cb948140381ad2a0e3818cc0eefc53cb7a1ad7459aacdc1e90a1ce0af8b&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1" wah-hotarea="click"><span>手把手教你做单细胞测序数据分析（二）——各类输入文件读取</span></a><br></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247487976&amp;idx=1&amp;sn=8edd929256e609e4210a40df63fc1427&amp;chksm=9b3f68b8ac48e1aefd3ff38dd5744c485cde5d7f28d79745b66863928d4614fafb2928b3f617&amp;scene=21#wechat_redirect" textvalue="‍手把手教你做单细胞测序数据分析（三）——单样本分析‍" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1"><span>手把手教你做单细胞测序数据分析（三）——单样本分析</span></a><br></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247488539&amp;idx=1&amp;sn=73c538e31907b8d82437cc063b2a2a15&amp;chksm=9b3f6d4bac48e45dcc737ee5a7529f58803fdbaa9ef49aca3c76af0f2e7e374247266b0d16cb&amp;scene=21#wechat_redirect" textvalue="手把手教你做单细胞测序数据分析（四）——多样本整合" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1"><span>手把手教你做单细胞测序数据分析（四）——多样本整合</span></a></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247488597&amp;idx=1&amp;sn=6123d348db245774d4a0db4134a839d4&amp;chksm=9b3f6d05ac48e4132f92ca6c32dab29d2a4e1eb00d1db3b6e10eba7ffc7154e8554a70938583&amp;scene=21#wechat_redirect" textvalue="手把手教你做单细胞测序数据分析（五）——细胞类型注释" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1"><span>手把手教你做单细胞测序数据分析（五）——细胞类型注释</span></a><br></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247488675&amp;idx=1&amp;sn=c1f4ac08b87baf625c7aafa8f073ed79&amp;chksm=9b3f6df3ac48e4e53ef11776bda8a5f75f1d465e4e2d6cccd5e4e1aff5f26eaa34cdea3aabb8&amp;scene=21#wechat_redirect" textvalue="手把手教你做单细胞测序数据分析（六）——组间差异分析及可视化" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1"><span>手把手教你做单细胞测序数据分析（六）——组间差异分析及可视化</span></a></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247488717&amp;idx=1&amp;sn=6ba02599dda33eb6cff751c1d92055d9&amp;chksm=9b3f6d9dac48e48ba334f031ce7874b4383a45be271acc9f0e6a714934ab7c7d945a513efdec&amp;scene=21#wechat_redirect" textvalue="‍手把手教你做单细胞测序数据分析（七）——基因集富集分析‍" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1"><span>手把手教你做单细胞测序数据分析（七）——基因集富集分析</span><span></span></a><br></section><section><br></section><section><span><span>上游fastq文件处理</span><span>：</span></span><br></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247484923&amp;idx=1&amp;sn=b5876af14fbee68d1e9db4b0f70cd1c8&amp;chksm=9b3f7cabac48f5bdb3aac7d20201d89121a83720b41a10017564fedbb8c4a13df0da92daffd7&amp;scene=21#wechat_redirect" textvalue="单细胞分析的最上游——处理Fastq文件：cellranger" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" wah-hotarea="click" hasload="1"><span>单细胞分析的最上游——处理Fastq文件：cellranger</span></a><br></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247484937&amp;idx=1&amp;sn=4fe1fa518202bdaf462bb93a2614ed32&amp;chksm=9b3f7f59ac48f64fafaf34bac2c80f06d3a86b6a84ccf12566c7eac25bb71c7edd3d74004cf7&amp;scene=21#wechat_redirect" textvalue="单细胞分析的最上游——处理Fastq文件：dropseqRunner" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" wah-hotarea="click" hasload="1"><span>单细胞分析的最上游——处理Fastq文件：dropseqRunner</span></a></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247488441&amp;idx=1&amp;sn=dac4efc4a8901a4abb133f9e5c80831e&amp;chksm=9b3f6ae9ac48e3fff5a7112a0127726441ccb9dc2c3369d4a0fe98a2120df991954ff0567732&amp;scene=21#wechat_redirect" textvalue="有奖提问,这个smart-Seq2数据实战的比对率为何如此低？" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1"><span>有奖提问,这个smart-Seq2数据实战的比对率为何如此低？</span></a><br></section><section><br></section><section><span>细胞通讯</span></section><section><span>B站连续播放起来比较方便：<br></span></section><section><span>https://www.bilibili.com/video/BV1Ab4y1W7qx?p=1</span></section><section><span><strong>往期推送</strong></span></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247485403&amp;idx=1&amp;sn=e148e2d09556a85333cd9c212a880aaa&amp;chksm=9b3f7e8bac48f79d6288977f3a67ebed5813dfe92e4a227a2e304eb68321771b3511fdaf5ba5&amp;scene=21#wechat_redirect" textvalue="单细胞测序数据进阶分析—《细胞通讯》1.概论" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" wah-hotarea="click" hasload="1"><span>单细胞测序数据进阶分析—《细胞通讯》1.概论</span></a><br></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247485680&amp;idx=1&amp;sn=8168685ab9bbf772dce24e8673994033&amp;chksm=9b3f71a0ac48f8b6554aa6f30a81f7e622fd8bf2f6a83701839290b7dd8f1c90343592603413&amp;scene=21#wechat_redirect" textvalue="单细胞测序数据进阶分析—《细胞通讯》2.1CellChat基础分析教程" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" wah-hotarea="click" hasload="1"><span>单细胞测序数据进阶分析—《细胞通讯》2.1CellChat基础分析教程</span></a><br></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247485706&amp;idx=1&amp;sn=2d39360b41733b0be6f88d2922388507&amp;chksm=9b3f705aac48f94cc478210f7f11d37294156517c489dedb333d8647ca287134a29944f39a3d&amp;scene=21#wechat_redirect" textvalue="单细胞测序数据进阶分析—《细胞通讯》2.2CellChat多组别分析" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" wah-hotarea="click" hasload="1"><span>单细胞测序数据进阶分析—《细胞通讯》2.2CellChat多组别分析</span></a><br></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247485734&amp;idx=1&amp;sn=32c75f6d07b49084e518af6d18099e8b&amp;chksm=9b3f7076ac48f9600593b319d2e0b36bf5a62399a9835caa5783ad36fbdec6004e04cb656db9&amp;scene=21#wechat_redirect" textvalue="给你们申请到了免费的128GB云服务器" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" wah-hotarea="click" hasload="1"><span>给你们申请到了免费的128GB云服务器</span></a></section><section><br></section><section><span>拟时序分析</span></section><section><span>B站连续播放起来比较方便：<br></span></section><section><span>https://www.bilibili.com/video/BV1br4y1x7Hf?p=1</span></section><section><strong><span>往期推送</span></strong></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247486553&amp;idx=1&amp;sn=b689ec962a17ca1a1ada29ae8ff8c019&amp;chksm=9b3f7509ac48fc1f0f81e288de8f15c86548215a1cd9d5c740dc63f2421371d13890398ab1df&amp;scene=21#wechat_redirect" textvalue="单细胞测序数据进阶分析—《拟时序分析》1.概论" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" wah-hotarea="click" hasload="1"><span>单细胞测序数据进阶分析—《拟时序分析》1.概论</span></a><br></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247487001&amp;idx=1&amp;sn=329129e75f703e3f332e76af9c66871e&amp;chksm=9b3f7749ac48fe5f081248c2a48c56685e3915015036c73f8f67ec3e6acc246ddf815daedb22&amp;scene=21#wechat_redirect" textvalue="单细胞测序数据进阶分析—《拟时序分析》2.monocle概论" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1"><span>单细胞测序数据进阶分析—《拟时序分析》2.monocle概论</span></a></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247487400&amp;idx=1&amp;sn=223a96a245c408c31e2c3c16afac88fc&amp;chksm=9b3f76f8ac48ffee769dc76870e15bbd0275647dcfb9bf21bf499b7eaee86121b254e4b2da54&amp;scene=21#wechat_redirect" textvalue="单细胞测序数据进阶分析—《拟时序分析》3.monocle2实操：完整版" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1"><span>单细胞测序数据进阶分析—《拟时序分析》3.monocle2实操：完整版</span></a><br></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247489044&amp;idx=1&amp;sn=061dbfc34d200b73a8227d0bb28a1d27&amp;chksm=9b3f6f44ac48e65251f7e5ecce84637c05d50ecb92769e8386f221f8e7b9bfeb719232def863&amp;scene=21#wechat_redirect" textvalue="单细胞测序数据进阶分析—《拟时序分析》4.初识monocle3" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1"><span>单细胞测序数据进阶分析—《拟时序分析》4.初识monocle3</span></a><br></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247489494&amp;idx=1&amp;sn=44f0a44857c12fcf9a1ab84e4f2cbebf&amp;chksm=9b3f6e86ac48e79026321de2fdca81a139d104d655884ffe87a68e0a1551ddffa5af7919d19e&amp;scene=21#wechat_redirect" textvalue="单细胞测序数据进阶分析《拟时序分析》5.monocle3的降维、分群、聚类" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1"><span>单细胞测序数据进阶分析—《拟时序分析》5.monocle3的降维、分群、聚类</span></a></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247490418&amp;idx=1&amp;sn=18ae0b6139fe1a2436dcf6cc47850297&amp;chksm=9b3f6222ac48eb3450de0b02a34eb5fff2db89ab8f155460d554cbb23be0cd27fd349079e7b2&amp;scene=21#wechat_redirect" textvalue="单细胞测序数据进阶分析—《拟时序分析》6.monocle3的拟时序分析" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1"><span>单细胞测序数据进阶分析—《拟时序分析》6.monocle3的拟时序分析</span></a><br></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247491083&amp;idx=1&amp;sn=c5697ab024193cb6595d27e4f4d3bfaf&amp;chksm=9b3f675bac48ee4d7244d9819e14fe210f7e42e40fc7a6a8df7b95bfd92f06334d60d226cb93&amp;scene=21#wechat_redirect" textvalue="解决monocle2的orderCells报错的两种方法" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2"><span>解决monocle2的orderCells报错的两种方法</span></a><br></section><section><br></section><section><span>其他单细胞相关技术贴也在这里：</span></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247484056&amp;idx=1&amp;sn=4967a054f5241ff3a1bd4a6fe9a502b1&amp;chksm=9b3f7bc8ac48f2deca3141461be035deb8658be184d78597af28f8ba2092d12f020768275248&amp;scene=21#wechat_redirect" textvalue="细胞的数量由誰决定？" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" wah-hotarea="click" hasload="1"><span>细胞的数量由誰决定？</span></a></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247484701&amp;idx=1&amp;sn=ad90680f252d092a2e21f349c8f32cab&amp;chksm=9b3f7c4dac48f55bf1d11337406ab0e1295e8e1731dbac0715eedc99d11beff7f380e42dd49b&amp;scene=21#wechat_redirect" textvalue="单细胞中应该如何做GSVA？" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1" wah-hotarea="click"><span>单细胞中应该如何做GSVA？</span></a></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247484280&amp;idx=2&amp;sn=844af02070012a1c2681880596ba51a2&amp;chksm=9b3f7a28ac48f33e95eb906121be8953410ca4c572c8035cb801609a56caf9dcff57fa989602&amp;scene=21#wechat_redirect" textvalue="答读者问（三）单细胞测序前景" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1" wah-hotarea="click"><span>答读者问（三）：单细胞测序前景</span></a></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247484316&amp;idx=2&amp;sn=e8d02fddc80d1137bb64c55541f1651d&amp;chksm=9b3f7accac48f3da7df7fcad9c996291bc66967c04d16dde92ed391c56e610a7298ac8fb7dbb&amp;scene=21#wechat_redirect" textvalue="答读者问 （四）：如何分析细胞亚群" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" wah-hotarea="click" hasload="1"><span>答读者问（四）：如何分析细胞亚群</span></a></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247484376&amp;idx=2&amp;sn=9fda8a5261e86f889a58d607163ce0fd&amp;chksm=9b3f7a88ac48f39ea9c19e256a513c9ae80c6f6dc1724b7783884e23981e2061c78fa67071c9&amp;scene=21#wechat_redirect" textvalue="答读者问（六）、Seurat中如何让细胞听你指挥" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1" wah-hotarea="click"><span>答读者问（六）：Seurat中如何让细胞听你指挥</span></a></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247485012&amp;idx=1&amp;sn=6007c8d7cb2a236dd7240a678dac0391&amp;chksm=9b3f7f04ac48f612f811c1df9e9450dc8112d343e4bf245be5149c2e2a073d3e339cd0e3ff61&amp;scene=21#wechat_redirect" textvalue="答读者问（八）为什么Read10X也会报错?" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" wah-hotarea="click" hasload="1"><span>答读者问（八）：为什么Read10X也会报错?</span></a><br></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247485134&amp;idx=1&amp;sn=13f5f8c47d8af2beeca4e103a5f5e26d&amp;chksm=9b3f7f9eac48f688b454a1062ee4e41f7072ac9d58e5466fa7ed4bb05018adbfe167bb3a445a&amp;scene=21#wechat_redirect" textvalue="答读者问（十）整合后的表达矩阵，如何拆分出分组信息？" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" wah-hotarea="click" hasload="1"><span>答读者问（十）整合后的表达矩阵，如何拆分出分组信息？</span></a><br></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247485145&amp;idx=1&amp;sn=402cb28c16aba0dc647037c9b7aba8f7&amp;chksm=9b3f7f89ac48f69fe27cd427df3eff2e88c240bf20dfe92d8b522eecd7302d132d880bf29047&amp;scene=21#wechat_redirect" textvalue="答读者问 （十一）如何一次性读取一个目录下的cellranger输出文件？" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" wah-hotarea="click" hasload="1"><span>答读者问（十一）如何一次性读取一个目录下的cellranger输出文件？</span></a><br></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247485730&amp;idx=1&amp;sn=42b9b35026bec5359ac34750dea3bf44&amp;chksm=9b3f7072ac48f964970f673a86e27ecd453a80b953168dc110e0ea6bfa4110eeed3350c9601a&amp;scene=21#wechat_redirect" textvalue="给你安排一个懂生信的工具人（十）：不学编程 零代码完成单细胞测序数据分析： Loupe Browser" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" wah-hotarea="click" hasload="1"><span>给你安排一个懂生信的工具人（十）：不学编程 零代码完成单细胞测序数据分析：Loupe Browser</span></a><br></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247485798&amp;idx=1&amp;sn=c849bc7a0093af92fc99e13b55842bb2&amp;chksm=9b3f7036ac48f92048d726b38f2dd978d0b0cce779c1a4090aa4da5cb2df3ad30a5c5dbed27e&amp;scene=21#wechat_redirect" textvalue="什么？不做单细胞也能分析细胞类群和免疫浸润？" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" wah-hotarea="click" hasload="1"><span>什么？不做单细胞也能分析细胞类群和免疫浸润？</span></a><br></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247485859&amp;idx=1&amp;sn=a014c4cb6034551e57c70820c7781e49&amp;chksm=9b3f70f3ac48f9e52620e3ff197eb98e58836e8bb6baad634387a521fdda1e4a194356517c73&amp;scene=21#wechat_redirect" textvalue="答读者问 （十三）查看Seurat对象时的ERROR：type='text'" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" wah-hotarea="click" hasload="1"><span>答读者问 （十三）查看Seurat对象时的ERROR：type='text'</span></a><br></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247485925&amp;idx=1&amp;sn=14e08440200f0f5cb4dcc2dc615efeb8&amp;chksm=9b3f70b5ac48f9a37a43cc2a8b2a5e485a3f84b4ef87949dfe99056bc6301b110e80800f6bb1&amp;scene=21#wechat_redirect" textvalue="各类单细胞对象（数据格式）转换大全（一）" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" wah-hotarea="click" hasload="1"><span>各类单细胞对象（数据格式）转换大全（一）</span></a></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247486045&amp;idx=1&amp;sn=0b6874bcffc8abafb505cabce4c4fc0e&amp;chksm=9b3f730dac48fa1b140ef01c07a7749e69df4fa7d2056deeed0673c668b6246724cd85741125&amp;scene=21#wechat_redirect" textvalue="批量整理好GEO中下载的单细胞数据" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" wah-hotarea="click" hasload="1"><span>批量整理好GEO中下载的单细胞数据</span></a><br></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247486134&amp;idx=1&amp;sn=e581b8ac20bbc968aeef3f9cf56f3a0f&amp;chksm=9b3f73e6ac48faf0f1c81752b0190abc617eb720a71806950e7851c7d19b7e3e092aa97bd005&amp;scene=21#wechat_redirect" textvalue="答读者问 （十四）Seurat中分类变量处理技巧" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" wah-hotarea="click" hasload="1"><span>答读者问 （十四）Seurat中分类变量处理技巧</span></a><br></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247486259&amp;idx=1&amp;sn=97de5c9e15e48cb62c8a680376a4ee0d&amp;chksm=9b3f7263ac48fb75a91b40416826fe35b340284cf38255925ac447443a62cdc1df082d20fb61&amp;scene=21#wechat_redirect" textvalue="答读者问 （十五）稀疏矩阵转matrix, as.matrix函数是下下策" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" wah-hotarea="click" hasload="1"><span>答读者问 （十五）稀疏矩阵转matrix, as.matrix函数是下下策</span></a><br></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247487923&amp;idx=1&amp;sn=15043c6d729b0d5493ab875b0e54a259&amp;chksm=9b3f68e3ac48e1f5dae514a01c857f9a56a90e2977dd7862db28d06fe55888cd9bb4afbb14e0&amp;scene=21#wechat_redirect" textvalue="答读者问 （十六）做单细胞测序到底需要多少内存" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1"><span>答读者问 （十六）做单细胞测序到底需要多少内存</span></a></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247488995&amp;idx=1&amp;sn=7140e0d037671542fb37dff3a3c94b28&amp;chksm=9b3f6cb3ac48e5a5f54a02be9e6af9f5a4cf8da1de1770f9035130c84dedf059a024964fc15a&amp;scene=21#wechat_redirect" textvalue="答读者问 （十七）调用的线程越多就算的越快嘛?" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1"><span>答读者问 （十七）调用的线程越多就算的越快嘛?</span></a><br></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247490010&amp;idx=1&amp;sn=24c55fa4bd5d7d829625cb67dbaf321a&amp;chksm=9b3f608aac48e99c9f27e3423c8398034a1819d0ccebbf21170b955461d2c335132d6f3cce25&amp;scene=21#wechat_redirect" textvalue="答读者问（十八）、一个我至少被问过30遍的monocle报错" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1"><span>答读者问（十八）、一个我至少被问过30遍的monocle报错</span></a><br></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247490658&amp;idx=1&amp;sn=3460a09ef4ad2916aabfaa13e195c7b1&amp;chksm=9b3f6532ac48ec249e974aa5bfcca2f5d441e64bbd353fe9dd45a50b47599663bf0334def7d4&amp;scene=21#wechat_redirect" textvalue="一文搞定单细胞基因集评分" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1"><span>一文搞定单细胞基因集评分</span></a></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247490949&amp;idx=1&amp;sn=b8dbe07d901f7c24f82d078be7a2fc77&amp;chksm=9b3f64d5ac48edc33980363c7bc862a9f6283b78dac407e9c082d80bd7d9669215eecac62347&amp;scene=21#wechat_redirect" textvalue="沉浸式统计细胞比例" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1"><span>沉浸式统计细胞比例</span></a></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247490952&amp;idx=1&amp;sn=364a3941e59e45234795c906a42fc9ab&amp;chksm=9b3f64d8ac48edcec70384cf5c6a91224d0f7841ce3a7cfcade6513500c13673a6695d6f0299&amp;scene=21#wechat_redirect" textvalue="没有barcode文件的单细胞数据要怎么读取" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1"><span>没有barcode文件的单细胞数据要怎么读取</span></a><br></section><section><br></section><section><span>单细胞文献阅读：</span></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247489823&amp;idx=1&amp;sn=6a5dddd53870395316d2b2e904c6ce72&amp;chksm=9b3f604fac48e959e97e4b0317643efdcf117da7f8b75f1edbcd64dd8e2f07149e6031a94dd4&amp;scene=21#wechat_redirect" textvalue="Biomamba助推的第二篇文章!发表了！" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1"><span>Biomamba助推的第二篇文章!发表了！</span></a></section><section><span>文献阅读（三）、<span>单细胞测序解析糖尿病肾病中肾小球的动态变化<br></span></span></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247484204&amp;idx=1&amp;sn=ee2119c172e6e917998f3781ed20f550&amp;chksm=9b3f7a7cac48f36a97e3bd13660c34f8001032a87a17e98cccb835de3583bbf2d928128a277e&amp;scene=21#wechat_redirect" textvalue="文献阅读系列（八）——不会吧不会吧，Nature都能白嫖？" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1" wah-hotarea="click"><span>文献阅读（四）、</span></a><span>单细胞测序技术解析健康人与T2D患者的胰岛差异</span></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247484204&amp;idx=1&amp;sn=ee2119c172e6e917998f3781ed20f550&amp;chksm=9b3f7a7cac48f36a97e3bd13660c34f8001032a87a17e98cccb835de3583bbf2d928128a277e&amp;scene=21#wechat_redirect" textvalue="文献阅读系列（八）——不会吧不会吧，Nature都能白嫖？" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1" wah-hotarea="click"><span>文献阅读（六）、</span></a><span>小鼠全肾单细胞测序开篇之作</span></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247484204&amp;idx=1&amp;sn=ee2119c172e6e917998f3781ed20f550&amp;chksm=9b3f7a7cac48f36a97e3bd13660c34f8001032a87a17e98cccb835de3583bbf2d928128a277e&amp;scene=21#wechat_redirect" textvalue="文献阅读系列（八）——不会吧不会吧，Nature都能白嫖？" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1" wah-hotarea="click"><span>文献阅读（七）、</span></a><span>一篇不花钱就能白嫖的文章</span></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247484204&amp;idx=1&amp;sn=ee2119c172e6e917998f3781ed20f550&amp;chksm=9b3f7a7cac48f36a97e3bd13660c34f8001032a87a17e98cccb835de3583bbf2d928128a277e&amp;scene=21#wechat_redirect" textvalue="文献阅读系列（八）——不会吧不会吧，Nature都能白嫖？" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1" wah-hotarea="click"><span>文献阅读（八）、不会吧不会吧，Nature都能白嫖？</span></a></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247485097&amp;idx=1&amp;sn=6e3e63fff6f26332b6a8b393608686d9&amp;chksm=9b3f7ff9ac48f6efc5477c57f3ab38e6c7dbd48b503a731cb08ac5f430fdab98d0d7e21da11a&amp;scene=21#wechat_redirect" textvalue="文献阅读系列（十一）、高氧下小鼠肺发育损伤的ScRNA图谱" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1" wah-hotarea="click"><span>文献阅读（十一）、高氧下小鼠肺发育损伤的ScRNA图谱</span></a></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247485376&amp;idx=1&amp;sn=02e228d0993d8a653c8bb1d531021cdb&amp;chksm=9b3f7e90ac48f78686d6d5953aeb192db4f28bf577dbebd76d9fabbe797f135b7fb08fb42867&amp;scene=21#wechat_redirect" textvalue="文献阅读系列（十二）、IgAN &amp; STRT-Seq" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" wah-hotarea="click" hasload="1"><span>文献阅读（十二）、IgAN &amp; STRT-Seq</span></a><br></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247486192&amp;idx=1&amp;sn=6b40bb3bb1ef590a477514a4400f4642&amp;chksm=9b3f73a0ac48fab6044850ae09b4e340f08b1b19e2c180ae1c25808104886fc544311d167396&amp;scene=21#wechat_redirect" textvalue="文献阅读系列（十三）、老树开新花——EGFR、肿瘤、免疫+scRNA-Seq" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" wah-hotarea="click" hasload="1"><span>文献阅读（十三）、老树开新花——EGFR、肿瘤、免疫+scRNA-Seq</span></a><br></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247486417&amp;idx=1&amp;sn=5dfa5b46e7626a1d3e327cb4fc3df3d5&amp;chksm=9b3f7281ac48fb9721b5ac0b8fd323a44018ba9d3ff3a872be2c36f141c2e02f9761df95708e&amp;scene=21#wechat_redirect" textvalue="文献阅读（十五）、癌前基质细胞驱动BRCA1肿瘤发生" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" wah-hotarea="click" hasload="1"><span>文献阅读（十五）、癌前基质细胞驱动BRCA1肿瘤发生</span></a></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247489045&amp;idx=1&amp;sn=29feb00f094a9a7e20418b22aa54dd8c&amp;chksm=9b3f6f45ac48e653d4223838eb1d96e65e5ee51ac3f7782841d9b33013bdb67b5e22e9599fac&amp;scene=21#wechat_redirect" textvalue='文献阅读（十八）、紧跟生信"钱"沿,胰腺癌&amp;免疫多模态图谱' linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1"><span>文献阅读（十八）、紧跟生信"钱"沿,胰腺癌&amp;免疫多模态图谱</span></a><br></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247489511&amp;idx=1&amp;sn=76ec706ebd97e3edd08687f5cf3b6816&amp;chksm=9b3f6eb7ac48e7a10bb81aec5332ecc0544a683f576ea680c8baa621e504816bf65c7d331bdf&amp;scene=21#wechat_redirect" textvalue="文献阅读（十九）、原发头颈癌和肿瘤转移微生态" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1"><span>文献阅读（十九）、原发头颈癌和肿瘤转移微生态</span></a><br></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247490575&amp;idx=1&amp;sn=b931a1d50ddcfc4e34999763139695a0&amp;chksm=9b3f655fac48ec49eb2fb01ce8acb15e230091ab3c29ce1471747850be5dae54dbe97fd103b0&amp;scene=21#wechat_redirect" textvalue="文献阅读（二十一）、" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1"><span>文献阅读（二十一）、肾脏疾病&amp;代谢&amp;核受体ESRRA</span></a></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247490929&amp;idx=1&amp;sn=82bf93ccbd9dd906caad8ec709c86153&amp;chksm=9b3f6421ac48ed37117794e7c5b878fa78760627e8bced9c37a2c7c67fd8afd58d0cf0add17e&amp;scene=21#wechat_redirect" textvalue="文献阅读（二十二）、PD-1&amp;急性髓细胞性白血病&amp;T Cell" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1"><span>文献阅读（二十二）、PD-1&amp;急性髓细胞性白血病&amp;T Cell</span></a><br></section><section><br></section><section><span>单细胞注释复写</span></section><section><span><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247490504&amp;idx=1&amp;sn=0066b2b33067cedb9d1c28689a53faab&amp;chksm=9b3f6298ac48eb8e12cdc7bdd6263e5feb9039f549f7b9dbf4e258854ee61476d09f702f1447&amp;scene=21#wechat_redirect" textvalue="单细胞注释复写(一):Human Fetal Kidney" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1">单细胞注释复写(一):Human Fetal Kidney</a></span></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247491642&amp;idx=1&amp;sn=2246fb702277ddc690f056fc8854142e&amp;chksm=9b3c996aac4b107c059a403978eca7be1ae7987659626272c58430910ad75892ad470517aefb&amp;scene=21#wechat_redirect" textvalue="单细胞注释复写（二）: human colorectal" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2"><span>单细胞注释复写（二）: human colorectal</span></a><br></section><section><br></section><section><span>非技术帖：</span></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247484798&amp;idx=1&amp;sn=120eada9b02ea2f81f93cd4cfa5eb964&amp;chksm=9b3f7c2eac48f538e2f95166dbe576b029dcb3ad7d321a4d9f346c9a51416d777f4cffb9aa84&amp;scene=21#wechat_redirect" textvalue="关于单细胞的事 谈谈后面的计划" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" wah-hotarea="click" hasload="1"><span>关于单细胞的事 谈谈后面的计划</span></a></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247485614&amp;idx=1&amp;sn=f63ab5d759bdcb933f334be6333f9493&amp;chksm=9b3f71feac48f8e8cece92812e0c26d7c03130359451a89ce7db22b7022506371269e1fc2af0&amp;scene=21#wechat_redirect" textvalue="趁机预告一波" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" wah-hotarea="click" hasload="1"><span>趁机预告一波</span></a></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247486435&amp;idx=1&amp;sn=c61124eb7c0fd6cc0eaefb639b551092&amp;chksm=9b3f72b3ac48fba5c0091fd843c98d504d4aefe0ba01a2fed966f897f58d8924ace8df07955e&amp;scene=21#wechat_redirect" textvalue='有关提高"Biomamba 生信基地"运行效率事宜' linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" wah-hotarea="click" hasload="1"><span>有关提高"Biomamba 生信基地"运行效率事宜</span></a><br></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247489314&amp;idx=1&amp;sn=fe66765836fe0d7b3450b30117415ce8&amp;chksm=9b3f6e72ac48e7642725b22bafbece9c37277f56e3958be57d9702240c3b63dbeb1aedf61cf9&amp;scene=21#wechat_redirect" textvalue="生信分析为什么要使用服务器？" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1"><span>生信分析为什么要使用服务器？</span></a><br></section></section></section></section></section><section><p><br></p><section data-support="96编辑器" data-style-id="35167"><section><section><section><section><br></section></section></section></section></section></section><section><section><section><section><section><section data-support="96编辑器" data-style-id="27326"><section><section><section><section><section><section><section data-support="96编辑器" data-style-id="34887"><section><section><section><img data-ratio="0.8372093023255814" data-src="https://mmbiz.qpic.cn/mmbiz_png/Ljib4So7yuWjsU2VMXgI8TRjfwVeo0Aj4EiaLjQXteia730VKnC0j8Tkgu6hkTs7ZO0JRFyw8riaczdNlQQKsOnfIQ/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" data-type="png" data-w="86" data-width="100%" src="https://mmbiz.qpic.cn/mmbiz_png/Ljib4So7yuWjsU2VMXgI8TRjfwVeo0Aj4EiaLjQXteia730VKnC0j8Tkgu6hkTs7ZO0JRFyw8riaczdNlQQKsOnfIQ/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"></section><section><section><section><p>如何联系我们</p></section></section></section></section></section></section><p><br></p></section><section data-support="96编辑器" data-style-id="34892"><section><section><section><section><img data-ratio="1.1627906976744187" data-src="https://mmbiz.qpic.cn/mmbiz_gif/Ljib4So7yuWjsU2VMXgI8TRjfwVeo0Aj4z284kwxMryKUBLBbNicjxYMDvWxmosNGHmIW66jtmJuia0pe51q8hFzQ/640?wx_fmt=gif&amp;wxfrom=5&amp;wx_lazy=1" data-type="gif" data-w="43" src="https://mmbiz.qpic.cn/mmbiz_gif/Ljib4So7yuWjsU2VMXgI8TRjfwVeo0Aj4z284kwxMryKUBLBbNicjxYMDvWxmosNGHmIW66jtmJuia0pe51q8hFzQ/640?wx_fmt=gif&amp;wxfrom=5&amp;wx_lazy=1"></section></section></section><section><section><section><section>公众号后台中消息更新不及时，超过48h后便不允许回复读者消息，这里给大家留一下领取资料、免费服务器的<span><strong>微信号</strong></span>，方便大家随时交流、提建议（由助理接待）。此外呼声一直很高的<span>交流群</span>也建好了，欢迎大家入群讨论：</section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247490936&amp;idx=1&amp;sn=850dfc45b10a6bd538c81cfbf1d7af37&amp;chksm=9b3f6428ac48ed3e4199dbfdec2fce4324d3226af19e335b8e5c0143cf8f0881667e36074d83&amp;scene=21#wechat_redirect" textvalue="永久免费的千人生信、科研交流群" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1">永久免费的千人生信、科研交流群</a><br></section><section><br></section><section><span>大家可以阅读完这几篇之后添加</span></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247484685&amp;idx=1&amp;sn=3b47c0bcad97a265650b5f34c00a6a3c&amp;chksm=9b3f7c5dac48f54be9cde50ab7a1147c55a36b980ffa0e721c02c05cbb88fef41a8fbc13d599&amp;scene=21#wechat_redirect" textvalue="笑一笑也就算了" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" wah-hotarea="click" hasload="1">笑一笑也就算了</a></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247488966&amp;idx=1&amp;sn=9e9e7659b4cf00ac3173d21e88e1602b&amp;chksm=9b3f6c96ac48e580efe53f966430f6598785e5c5c6bcc20f5eef019e723e49baaaea6d73fb7b&amp;scene=21#wechat_redirect" textvalue="如何搜索公众号过往发布内容" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1">如何搜索公众号过往发布内容</a><br></section><p><img data-galleryid="" data-ratio="1.2464962901896126" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/ImlBFVOwwpyUNnHOn8es4zIE8EU8PJ0wRtpDqO03bR2TecVjskmGmoY0DVzyDjOycE4xHrfx7dw4HFSO7JhEgQ/640?wx_fmt=jpeg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" data-type="jpeg" data-w="1213" src="https://mmbiz.qpic.cn/mmbiz_jpg/ImlBFVOwwpyUNnHOn8es4zIE8EU8PJ0wRtpDqO03bR2TecVjskmGmoY0DVzyDjOycE4xHrfx7dw4HFSO7JhEgQ/640?wx_fmt=jpeg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"></p></section></section></section></section></section></section></section></section></section></section></section></section></section><section><br></section></section></section></section></section></section></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/eNfr0W1TY94k_0llh19BEg",target="_blank" rel="noopener noreferrer">原文链接</a>
