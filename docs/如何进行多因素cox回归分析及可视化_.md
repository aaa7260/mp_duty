---
title: "如何进行多因素cox回归分析及可视化？"
date: 2022-08-31T22:59:22Z
draft: ["false"]
tags: [
  "fetched",
  "SCIPainter"
]
categories: ["Acdemic"]
---
如何进行多因素cox回归分析及可视化？ by SCIPainter
------
<div><section data-mpa-powered-by="yiban.io"><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><section><section powered-by="xiumi.us"><section><section><svg viewbox="0 0 1 1"></svg></section></section></section><section powered-by="xiumi.us"><section><section><svg viewbox="0 0 1 1"></svg></section></section></section></section><section><section powered-by="xiumi.us"><section><section><svg viewbox="0 0 1 1"></svg></section></section></section></section><section><section powered-by="xiumi.us"><section><p><strong>点击蓝字 关注我们</strong></p></section></section></section><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><section><svg viewbox="0 0 1 1"></svg></section></section></section></section><section><section powered-by="xiumi.us"><section><section><svg viewbox="0 0 1 1"></svg></section></section></section></section></section></section></section><section powered-by="xiumi.us"><section><section><svg viewbox="0 0 1 1"></svg></section></section></section></section></section></section></section></section></section><p><span>在临床中绕不开生存分析，通过探究癌症死亡等终点事件的发生时间和临床信息、表达矩阵之间的关系来研究不同患者预后效果，从而改进治疗策略，由于需要大样本，公共数据的挖掘是主要来源之一。我们先进行一下往期回顾：</span></p><p><span>首先学习了基于TCGA临床数据和表达矩阵的处理：</span></p><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzIyOTY3MDA3MA==&amp;mid=2247486314&amp;idx=1&amp;sn=c1843c148b713f4efc793b477ff2b72c&amp;chksm=e8be66b3dfc9efa591a6138d2a9acc3d86025a00d2644d4784b9b114be1d54650fe343f09dad&amp;scene=21#wechat_redirect" textvalue="《一文拿捏住TCGA临床和基因表达量数据处理！》" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2"><span>《一文拿捏住TCGA临床和基因表达量数据处理！》</span></a><span></span></p><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzIyOTY3MDA3MA==&amp;mid=2247490588&amp;idx=1&amp;sn=660d401d7de1aa9a82ee35eb38bcb5e6&amp;chksm=e8be71c5dfc9f8d35d11849de563c303bdbdf8476b724f4042a65b0d0c6ebefec1deabf19c6e&amp;scene=21#wechat_redirect" textvalue="《TCGA更新了？！最新数据处理拿捏住！》" linktype="text" imgurl="" imgdata="null" data-itemshowtype="11" tab="innerlink" data-linktype="2"><span>《TCGA更新了？！最新数据处理拿捏住！》</span></a><span></span></p><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzIyOTY3MDA3MA==&amp;mid=2247489870&amp;idx=1&amp;sn=d990d98ad070bf78396179d4d4d112b5&amp;chksm=e8be7497dfc9fd8118e1c7f68218cdc0ff6263d62dd4a09793a6678cba96df6477389df7ba4d&amp;scene=21#wechat_redirect" textvalue="《重要的生存分析前，你必须做好这个准备！》" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2"><span>《重要的生存分析前，你必须做好这个准备！》</span></a><span></span></p><p><br></p><p><span>为了探究哪些特征（基因？身高？年龄？饮酒？种族……）影响生存结局，可以将需要探究的特征（自变量）进行单因素分析。通过Kaplan-Meier法绘制生存生存曲线，引入Log rank检验进行统计学上的组间差异比较，判断哪些特征能够显著影响生存率；还可以通过构建单因素Cox比例风险回归模型，判断哪些特征是生存的影响因素以及计算95%C和HR：</span></p><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzIyOTY3MDA3MA==&amp;mid=2247490128&amp;idx=1&amp;sn=21454e41d29ca8b11cf7f006900633e9&amp;chksm=e8be7789dfc9fe9f7e991c44bf79c79773a5811afa1e6b8514dab769bcb6bbaa54ab3262d0b7&amp;scene=21#wechat_redirect" textvalue="《真香！被自己做的生存分析美丽住了！》" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2"><span>《真香！被自己做的生存分析美丽住了！》</span></a><span></span></p><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzIyOTY3MDA3MA==&amp;mid=2247490583&amp;idx=1&amp;sn=64d6dceed96169def24f81e71a3b5a9c&amp;chksm=e8be71cedfc9f8d8313be8642914dba29c365b94c674205b2b571e21ebd59e44844f42dafc9e&amp;scene=21#wechat_redirect" textvalue="《真香！被自己炫酷的批量生存分析操作厉害住了！》" linktype="text" imgurl="" imgdata="null" data-itemshowtype="11" tab="innerlink" data-linktype="2"><span>《真香！被自己炫酷的批量生存分析操作厉害住了！》</span></a><span></span></p><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzIyOTY3MDA3MA==&amp;mid=2247490159&amp;idx=1&amp;sn=4d15ac2375cd38b03db1fc3742fb156c&amp;chksm=e8be77b6dfc9fea0fbe68e62b361ac1de34b274fbd47b843cf20260e1b2f6f45d3fbc8c284f8&amp;scene=21#wechat_redirect" textvalue="《嘿！高端的单因素Cox回归，往往只需要朴素的烹饪！！》" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2"><span>《嘿！高端的单因素Cox回归，往往只需要朴素的烹饪！！》</span></a><span></span></p><p><br></p><p><span>在进行cox回归分析前，为了保证结果的可靠性（特别是样本较少，自变量较多时），可以先通过Log rank检验排除无意义自变量后，再纳入cox。</span></p><p><br></p><p><span>在cox回归中，我们会筛选到在统计学上影响生存的较多特征（特别是纳入表达矩阵后），但很多特征（基因）的表达模式相近，在癌症预后相关性上起到的作用也非常相似，因此，我们还会将cox获得的特征构建lasso回归模型，通过增大惩罚系数（λ值）来约束参数防止过度拟合，从而获得一个精简模型（剔掉了表达模式非常相近的那一部分特征）：</span></p><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzIyOTY3MDA3MA==&amp;mid=2247491243&amp;idx=1&amp;sn=1db5cee9a0b41a0aee522af17449c08c&amp;chksm=e8be7372dfc9fa64cb34d226a511174ea0b7a0776c111fa22f4513dd7bc7b35788b4b3cd21e7&amp;scene=21#wechat_redirect" textvalue="《如何使用lasso回归筛选重要特征变量？》" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2"><span>《如何使用lasso回归筛选重要特征变量？》</span></a><span></span></p><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzIyOTY3MDA3MA==&amp;mid=2247491774&amp;idx=1&amp;sn=4c693ccd18dd4d59ebea4cf7a913ed17&amp;chksm=e8bd8d67dfca04711fb2345e48ef28e0b4082008906cc220c8c29b79104e1014908fc2c3b4d1&amp;scene=21#wechat_redirect" textvalue="《如何进行数据切割并使用ROC评估lasso建模好坏？》" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2"><span>《如何进行数据切割并使用ROC评估lasso建模好坏？》</span></a><span></span></p><p><br></p><section><section powered-by="xiumi.us"><section><section><section powered-by="xiumi.us"><section><section><svg viewbox="0 0 1 1"></svg></section></section></section></section><section><section powered-by="xiumi.us"><section><section><svg viewbox="0 0 1 1"></svg></section></section></section></section><section><section powered-by="xiumi.us"><section><section><svg viewbox="0 0 1 1"></svg></section></section></section></section><section><section powered-by="xiumi.us"><section><section><svg viewbox="0 0 1 1"></svg></section></section></section></section></section></section></section><p><br></p><p><span>通过单因素cox找出了和生存显著相关的特征后，基于这些特征一般还会进行多因素cox，即同时将多个特征纳入cox回归分析。</span></p><p><br></p><section><span>如何进行多因素cox？和单因素cox有什么区别？怎么可视化？下面开始今天的学习！</span></section><section data-role="title" data-tools="135编辑器" data-id="114153"><section><section><section><section><section><img data-ratio="1.34375" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6no5LydZeNe32bb3qCQSGb2GcufZTcYYKaiaicJXic8VxkcLEibAJtwsaW5ibn13YjKAQuoRZkrLp3viaFg/640?wx_fmt=png" data-type="png" data-w="32" data-width="100%" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6no5LydZeNe32bb3qCQSGb2GcufZTcYYKaiaicJXic8VxkcLEibAJtwsaW5ibn13YjKAQuoRZkrLp3viaFg/640?wx_fmt=png"></section></section><section><section><section><span><br><strong data-original-title="" title=""></strong></span></section><section><span><strong data-brushtype="text" hm_fix="320:318">多因素cox回归模型构建</strong></span></section></section></section></section></section></section></section><p><br></p><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>#多因素cox回归模型构建：</span><br mpa-from-tpl="t"><span>library</span>(survival)<br mpa-from-tpl="t"><span>library</span>(survminer)</code></pre></section><section><br></section><p><span>首先，我们载入往期处理好的KIRC的临床信息（cl）、表达矩阵（exp2），具体的整理方法见往期文章。</span></p><p><br mpa-from-tpl="t"></p><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><p><span>load</span>(<span>"KIRC_cox_forest.Rdata"</span>)<br mpa-from-tpl="t"><span>View</span>(exp2)</p></pre></section><p><img data-ratio="0.47678018575851394" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6no5LydZeNe32bb3qCQSGb2DbkFe9JoiaPlKs0lO7bcmSgia2gD5HkYOCz9wHx7oMHQhOLoQ4NPibI2w/640?wx_fmt=png" data-type="png" data-w="1292" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6no5LydZeNe32bb3qCQSGb2DbkFe9JoiaPlKs0lO7bcmSgia2gD5HkYOCz9wHx7oMHQhOLoQ4NPibI2w/640?wx_fmt=png"></p><p><br></p><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><p><span>View</span>(cl)</p></pre></section><section><span></span></section><p><img data-ratio="0.4425287356321839" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6no5LydZeNe32bb3qCQSGb2MkowDKZxfoVf9mcvhsuViaeaX6Cfxp1rKPibkdRWe2WsClaJialGkATJQ/640?wx_fmt=png" data-type="png" data-w="1392" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6no5LydZeNe32bb3qCQSGb2MkowDKZxfoVf9mcvhsuViaeaX6Cfxp1rKPibkdRWe2WsClaJialGkATJQ/640?wx_fmt=png"></p><p><br></p><p><span>表达矩阵和临床矩阵都完成了数据清洗，表达矩阵列名和临床信息行名一一对应。</span></p><p><br></p><p><span>根据前几期的学习，通过logrank-test + 单因素cox回归 + lasso回归，我们能够筛选显著影响癌症患者生存的特征因素（基因等），现在把筛选出的这些因素纳入多因素cox，方法基本和单因素cox相同。</span></p><p><br></p><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><p><span>#构建纳入多因素cox的基因集(根据前期背景知识获取/单因素cox/lasso筛选等途径)：</span><br mpa-from-tpl="t"><span>interest_gene</span> &lt;- c(<span>"SLC16A12"</span>,<span>"IL20RB"</span>,<span>"AJAP1"</span>,<span>"SAA1"</span>,<span>"SPDEF"</span>,<span>"CHAC1"</span>,<span>"HOXA2"</span>)</p></pre></section><p><span>这里我们拿出的7个示范基因，都是在logrank检验和单因素cox中p＜0.01，且被lasso回归筛选出的基因（在实际运用中，显著性阈值不要设定那么高，避免漏掉重要特征）。</span></p><p><br></p><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><p><span>#重新构建表达矩阵（只留下所需基因集）：</span><br mpa-from-tpl="t"><span>exp</span> &lt;- exp2[interest_gene,]<br mpa-from-tpl="t"><span>exp</span> &lt;- t(exp)#转置,行名样本名，列名基因名；<br mpa-from-tpl="t"><span>head</span>(exp)</p></pre></section><p><img data-ratio="0.1658069270449521" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6no5LydZeNe32bb3qCQSGb29wyM7zK1WVO2qFXfQHVIBJaqlWmPRVQcqAUZtU5fQCicIQe7Vt49D2A/640?wx_fmt=png" data-type="png" data-w="1357" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6no5LydZeNe32bb3qCQSGb29wyM7zK1WVO2qFXfQHVIBJaqlWmPRVQcqAUZtU5fQCicIQe7Vt49D2A/640?wx_fmt=png"></p><p><br></p><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><p><span>#将基因列合并到临床信息中：</span><br mpa-from-tpl="t"><span>dt</span> &lt;- cbind(cl,exp)<br mpa-from-tpl="t"><span>colnames</span>(dt)</p></pre></section><p><img data-ratio="0.2728719172633254" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6no5LydZeNe32bb3qCQSGb2R3c7JXmjicHOibPxdcnYejBNQO5MZYj6rk9InbBY17NXDGNTibwmUZMNg/640?wx_fmt=png" data-type="png" data-w="1257" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6no5LydZeNe32bb3qCQSGb2R3c7JXmjicHOibPxdcnYejBNQO5MZYj6rk9InbBY17NXDGNTibwmUZMNg/640?wx_fmt=png"></p><p><br></p><p><span>上述就是临床矩阵中包含的所有列，包含刚纳入的7个基因。</span></p><p><br></p><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><p><span>#查看一下所需数据列：</span><br mpa-from-tpl="t"><span>head</span>(dt$OS_time)<br mpa-from-tpl="t"><span>head</span>(dt$event)<br mpa-from-tpl="t"><span>head</span>(dt$tumor_stage)<br mpa-from-tpl="t"><span>head</span>(dt$age)<br mpa-from-tpl="t"><span>head</span>(dt$gender)<br mpa-from-tpl="t"><span>head</span>(dt$SLC16A12)</p></pre></section><p><img data-ratio="0.2728719172633254" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6no5LydZeNe32bb3qCQSGb2ySHeTDVvyQq5oHJjQgh849Nwc7G8hB6KnuGcOiaYOaRjDjuTVuKPWUQ/640?wx_fmt=png" data-type="png" data-w="1257" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6no5LydZeNe32bb3qCQSGb2ySHeTDVvyQq5oHJjQgh849Nwc7G8hB6KnuGcOiaYOaRjDjuTVuKPWUQ/640?wx_fmt=png"></p><p><br></p><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><p><span>#临床特征构建多因素cox回归模型：</span><br mpa-from-tpl="t"><span>model1</span> &lt;- coxph(Surv(OS_time, event) ~ tumor_stage + gender + age, data = dt)<br mpa-from-tpl="t"><span>#时间变量：OS_time</span><br mpa-from-tpl="t"><span>#结局变量：event</span><br mpa-from-tpl="t"><span>#自变量：tumor_stage、gender、age</span><br mpa-from-tpl="t"><span>model1</span></p></pre></section><p><img data-ratio="0.3420843277645187" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6no5LydZeNe32bb3qCQSGb2pY9bWqzyxFfn7gKpz7VaoDYJFhtZHE344wacQa0fmSjNfylqUX6N6A/640?wx_fmt=png" data-type="png" data-w="1257" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6no5LydZeNe32bb3qCQSGb2pY9bWqzyxFfn7gKpz7VaoDYJFhtZHE344wacQa0fmSjNfylqUX6N6A/640?wx_fmt=png"></p><p><br></p><p><span>和单因素cox一样，主要关注exp（coef），也就是HR值和p值。</span></p><p><br></p><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>#多因素cox森林图绘制：</span><br mpa-from-tpl="t"><span><span>options</span></span>(scipen=1)<br mpa-from-tpl="t"><span>#ggforest函数绘制森林图（来自survminer包）：</span><br mpa-from-tpl="t"><span>ggforest</span>(model1,<br mpa-from-tpl="t"><span>data</span> = dt,<br mpa-from-tpl="t"><span>main</span> = <span>"Hazard ratio"</span>, #标题<br mpa-from-tpl="t"><span>cpositions</span> = c(0.02, 0.22, 0.4), #前三列距离<br mpa-from-tpl="t"><span>fontsize</span> = 1, #字体相对大小<br mpa-from-tpl="t"><span>refLabel</span> = <span>"1"</span>, #相对变量的数值标签<br mpa-from-tpl="t"><span>noDigits</span> = 3) #95%CI、p值、HR值等保留小数点后位数</code></pre></section><p><img data-ratio="0.5015142337976983" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6no5LydZeNe32bb3qCQSGb2PfwSM14gT5m5YnoMT938T4eFM1e57tdMBENcn9BnGqSOwbcI811lWw/640?wx_fmt=png" data-type="png" data-w="1651" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6no5LydZeNe32bb3qCQSGb2PfwSM14gT5m5YnoMT938T4eFM1e57tdMBENcn9BnGqSOwbcI811lWw/640?wx_fmt=png"></p><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>#七个基因构建多因素cox：</span><br mpa-from-tpl="t"><span>colnames</span>(dt)<br mpa-from-tpl="t"><span>model2</span> &lt;- coxph(Surv(OS_time, event) ~ SLC16A12 + IL20RB + AJAP1 + SAA1 + SPDEF + CHAC1 + HOXA2, data = dt)<br mpa-from-tpl="t"><span>model2</span><span></span></code></pre></section><section><img data-ratio="0.4022887323943662" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6no5LydZeNe32bb3qCQSGb2CiaunD4LsWIIFqkXN95BZ44EcaByAQVenc8d6piaMCfvbF4n9iaAasGNA/640?wx_fmt=png" data-type="png" data-w="1136" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6no5LydZeNe32bb3qCQSGb2CiaunD4LsWIIFqkXN95BZ44EcaByAQVenc8d6piaMCfvbF4n9iaAasGNA/640?wx_fmt=png"></section><p><br></p><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><p><span>#多因素cox森林图：</span><br mpa-from-tpl="t"><span><span>options</span></span>(scipen=1)<br mpa-from-tpl="t"><span>ggforest</span>(model3,<br mpa-from-tpl="t"><span>data</span> = dt,<br mpa-from-tpl="t"><span>main</span> = <span>"Hazard ratio"</span>,<br mpa-from-tpl="t"><span>cpositions</span> = c(0.02, 0.22, 0.4),<br mpa-from-tpl="t"><span>fontsize</span> = 1,<br mpa-from-tpl="t"><span>refLabel</span> = <span>"1"</span>,<br mpa-from-tpl="t"><span>noDigits</span> = 3)</p></pre></section><p><img data-ratio="0.522264631043257" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6no5LydZeNe32bb3qCQSGb2FodlpZ5xDdML1QoicRgROR5ZKebExSg5UW0Ab5ClHicOicSuaV1VhX1Ig/640?wx_fmt=png" data-type="png" data-w="1572" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6no5LydZeNe32bb3qCQSGb2FodlpZ5xDdML1QoicRgROR5ZKebExSg5UW0Ab5ClHicOicSuaV1VhX1Ig/640?wx_fmt=png"></p><p><br></p><p><span>从结果森林图看，有一个基因（SAA1）没有显著性标记，但是在单因素cox中，在统计学意义上是显著的：</span></p><p><br></p><p><img data-ratio="0.3390441839495041" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6no5LydZeNe32bb3qCQSGb2S5Cw0IVr3qSCa7PBrEDlF5mcUbxkNzyhtsj7ap9yialZFNjJ5aU9P8g/640?wx_fmt=png" data-type="png" data-w="1109" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6no5LydZeNe32bb3qCQSGb2S5Cw0IVr3qSCa7PBrEDlF5mcUbxkNzyhtsj7ap9yialZFNjJ5aU9P8g/640?wx_fmt=png"></p><p><br></p><p><span>这种情况比较常见，一般来说，如果单因素和多因素cox分析</span><span>同时</span><span>具有显著性差异时，无疑结果非常符合预期，我们认为这个自变量是因变量的</span><span>独立影响因素</span><span>；</span></p><p><br></p><p><span>但当</span><span>单因素cox</span><span>结果</span><span>有显著差异</span><span>，但纳入</span><span>多因素cox</span><span>分析中结果</span><span>无显著差异</span><span>时，一般认为这个自变量</span><span>不是</span><span>因变量的独立影响因素，可能是一个</span><span>间接影响因素</span><span>。</span></p><p><br></p><p><span>以这7个基因为例，通过logrank检验和单因素cox我们确定了这7个基因都和患者生存显著相关，除了SAA1基因以外的基因都能够作为影响癌症生死的独立因素（不需要依靠其它特征），2个保护因子（HR&lt;1）和4个风险因子（HR&gt;1），而SAA1可能是一个间接影响生存的风险因子。</span></p><p><br></p><p><span>除了常用森林图可视化多因素cox结果，还可以使用诺莫图/列线图（Nomogram）进行生存率预测，我们先简单学习一下。</span></p><p><br></p><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><p><span>#诺莫图：</span><br mpa-from-tpl="t"><span>library</span>(survival)<br mpa-from-tpl="t"><span>library</span>(rms)<br mpa-from-tpl="t"><br mpa-from-tpl="t"><span>#打包数据</span><br mpa-from-tpl="t"><span>dd</span>&lt;-datadist(dt)<br mpa-from-tpl="t"><span><span>options</span></span>(datadist=<span>"dd"</span>)<br mpa-from-tpl="t"><br mpa-from-tpl="t"><span>#构建cox回归模型：</span><br mpa-from-tpl="t"><span>f</span> &lt;- cph(Surv(OS_time, event) ~ tumor_stage + gender + age+pathologic_T+pathologic_N, data = dt, #这里纳入了几个临床特征<br mpa-from-tpl="t"><span>x</span> = T,y = T,surv = T)<br mpa-from-tpl="t"><span>surv</span> &lt;- Survival(f)#预测生存概率<br mpa-from-tpl="t"><br mpa-from-tpl="t"><span>nom</span> &lt;- nomogram(f,<br mpa-from-tpl="t"><span>fun</span> = list(function(x) surv(365,x), #一年生存率<br mpa-from-tpl="t"><span>function</span>(x) surv(1095,x), #三年生存率<br mpa-from-tpl="t"><span>function</span>(x) surv(1825,x), #五年生存率<br mpa-from-tpl="t"><span>function</span>(x) surv(3650,x)), #十年生存率<br mpa-from-tpl="t"><span>#fun：将预测的生存概率转化为线性，用于绘制新的生存概率坐标轴；</span><br mpa-from-tpl="t"><span>#list：链接多条生存概率坐标轴；</span><br mpa-from-tpl="t"><span>lp</span> = F,<br mpa-from-tpl="t"><span>funlabel</span> = c(<span>"1-year survival"</span>,<span>"3-year survival"</span>,<span>"5-year survival"</span>,<span>"10-year survival"</span>),#生存概率坐标轴名称<br mpa-from-tpl="t"><span>maxscale</span> = 100,<br mpa-from-tpl="t"><span>fun</span>.at = c(0.5,seq(0.1,0.9,by = 0.1),1))#生存概率坐标轴步长和范围<br mpa-from-tpl="t"><span>plot</span>(nom)</p></pre></section><p><img data-ratio="0.5942122186495177" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6no5LydZeNe32bb3qCQSGb2IxxZ9ysLMHXOwhjh8ricqnJSaLaasGDibcTrKAfiahD9XxGwt30fCOaMQ/640?wx_fmt=png" data-type="png" data-w="1555" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6no5LydZeNe32bb3qCQSGb2IxxZ9ysLMHXOwhjh8ricqnJSaLaasGDibcTrKAfiahD9XxGwt30fCOaMQ/640?wx_fmt=png"></p><p><br></p><p><span>诺莫图根据所有自变量回归系数的大小制定评分标准，给每个自变量的每个取值一个分数。在临床上可以运用于患者的生存概率预测。对于一个患者，计算每一个特征对应的分数（Points）并相加，可以得到得到一个总分（Total Points），将总分往下垂直对应，可以预测这个患者对应年份的生存概率。</span></p><p><br></p><p><span>好啦，今天的分享就到这里！</span></p><p><br></p><section data-role="outer" label="Powered by 135editor.com"><section data-tools="135编辑器" data-id="105648"><section><section data-role="outer" label="Powered by 135editor.com"><section data-role="paragraph"><section data-role="outer" label="Powered by 135editor.com"><section data-tools="135编辑器" data-id="105648"><section><section><img data-ratio="0.8928571428571429" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6kCKJYcEqEIfoJYG621mPJE8VibmibGU0Jxic9iabARVRH0FT6BNE8VAglWFXBPibFAU7a6tWGibSs8wyUg/640?wx_fmt=png" data-type="png" data-w="41" data-width="100%" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6kCKJYcEqEIfoJYG621mPJE8VibmibGU0Jxic9iabARVRH0FT6BNE8VAglWFXBPibFAU7a6tWGibSs8wyUg/640?wx_fmt=png"></section><section><section><section data-width="35%"><section><section data-width="100%"><img data-ratio="1" data-src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/tgUVxVRjT6kCKJYcEqEIfoJYG621mPJEv5etCBwHicqbEPwnVrkpaasxqaVibM4mT2JdIuN6yTlYWDD4mL5A427A/640?wx_fmt=jpeg" data-type="jpeg" data-w="860" data-width="100%" title="SCIPainter 30cm二维码.jpg" src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/tgUVxVRjT6kCKJYcEqEIfoJYG621mPJEv5etCBwHicqbEPwnVrkpaasxqaVibM4mT2JdIuN6yTlYWDD4mL5A427A/640?wx_fmt=jpeg"></section></section></section><section data-width="50%"><section><section data-brushtype="text"><strong># SCIPainter</strong></section><section data-brushtype="text" hm_fix="361:593"><p>基迪奥旗下绘图公众号</p><p>分享科研绘图技能与工具</p><p>欢迎关注与转发~</p></section></section></section></section></section></section></section></section></section></section><section><br></section></section></section><section data-role="paragraph"><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><img data-ratio="1" data-src="https://mmbiz.qpic.cn/sz_mmbiz_gif/tgUVxVRjT6kCKJYcEqEIfoJYG621mPJEgMd0aMPtmrDjiaX8sBhfhicVteeHf1JicexSpUbS3fdS9SiboUVN7guaPw/640?wx_fmt=gif" data-type="gif" data-w="400" src="https://mmbiz.qpic.cn/sz_mmbiz_gif/tgUVxVRjT6kCKJYcEqEIfoJYG621mPJEgMd0aMPtmrDjiaX8sBhfhicVteeHf1JicexSpUbS3fdS9SiboUVN7guaPw/640?wx_fmt=gif"></section></section></section><section><section powered-by="xiumi.us"><section><p><span><strong>你的好友拍了拍你</strong></span></p><p><span><strong>并请你帮她点一下</strong></span><span><strong><span>“分享”</span></strong></span><span><strong><span>~</span></strong></span></p></section></section></section></section></section><p><br></p></section></section></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/_fziMAOTLxit-WObsUeLGQ",target="_blank" rel="noopener noreferrer">原文链接</a>
