---
title: "【单细胞高级绘图】08.细胞通讯_两组比较_气泡图"
date: 2022-08-30T13:04:09Z
draft: ["false"]
tags: [
  "fetched",
  "TOP生物信息"
]
categories: ["Acdemic"]
---
【单细胞高级绘图】08.细胞通讯_两组比较_气泡图 by TOP生物信息
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><p data-tool="mdnice编辑器">细胞通讯分析，我很早之前就写过，当时详细介绍了<code>CellPhoneDB</code>的<code>原理</code>、<code>实操</code>、<code>可视化</code>。 </p><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzkzMzE5NTM4NA==&amp;mid=2247484358&amp;idx=1&amp;sn=073e2b32918e9c7e28dc56e62077335c&amp;chksm=c25178d1f526f1c75e29e559a38c667d4ada6368d48c40dd056617e4fa540c85a6c28d95ce5a&amp;scene=21#wechat_redirect" textvalue="单细胞分析实录(18): 基于CellPhoneDB的细胞通讯分析及可视化 (上篇)" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2"><span>单细胞分析实录(18): 基于CellPhoneDB的细胞通讯分析及可视化 (上篇)</span></a></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzkzMzE5NTM4NA==&amp;mid=2247485237&amp;idx=2&amp;sn=4ff9e9093e22cff4c3a11502cf1c465d&amp;chksm=c2517c22f526f5340416e855d5edc6013b37d030e2f40a594c10075620939bf61fc5a15afb4e&amp;scene=21#wechat_redirect" textvalue="单细胞分析实录(19): 基于CellPhoneDB的细胞通讯分析及可视化 (下篇)" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2"><span>单细胞分析实录(19): 基于CellPhoneDB的细胞通讯分析及可视化 (下篇)</span></a></section><p data-tool="mdnice编辑器">今天说的这个问题还是很常见的：<strong>「在进行细胞通讯分析之后，如何比较两组的受配体对的差异？」</strong> 如果你的数据包含两个以上的组别，大概率是要做这个事情的。</p><p data-tool="mdnice编辑器">CellPhoneDB这个软件很简单(这也是用得多的原因)，在几组数据<code>分别</code>运行之后，是不能直接比较的。我之前的做法是电脑打开两个图，对照着看，有些费时费力。</p><p data-tool="mdnice编辑器">所以后来，想了一种方法，就是把两张图重叠起来，计算一个"图一相较于图二差异大小的指标"，就只用看一张图了。</p><figure data-tool="mdnice编辑器"><img data-ratio="1.231060606060606" data-src="https://mmbiz.qpic.cn/mmbiz_png/WThoCmvVu2ZJvibandCGiaZW81mnGnAy0tG4iajIgF1rOY43oGRRwDyibUemCRh9Pahickvcd7FkpibznvichwjHy4Dtw/640?wx_fmt=png" data-type="png" data-w="528" src="https://mmbiz.qpic.cn/mmbiz_png/WThoCmvVu2ZJvibandCGiaZW81mnGnAy0tG4iajIgF1rOY43oGRRwDyibUemCRh9Pahickvcd7FkpibznvichwjHy4Dtw/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">就比如这张图，在<code>Old</code>组做完cellphonedb之后，能得到表示受配体表达的<code>mean</code>；同样地，<code>Young</code>组也能得到表示受配体表达的<code>mean</code>。（在对应的两个p值满足一定条件下）这两个值相除，就能表示两组的差异了。</p><pre data-tool="mdnice编辑器"><code><span>#这一个代码仿照cellphonedb的图，即气泡图</span><br><span>#我之前讲cellphonedb的帖子，也采用了这种图，见：</span><br><span>#单细胞分析实录(19): 基于CellPhoneDB的细胞通讯分析及可视化 (下篇)</span><br><span>source</span>(<span>"CCC_compare.R"</span>)<br><span>### 必要参数</span><br>CCC_compare(group1.name = <span>"Old"</span>,group2.name = <span>"Young"</span>,<br>            group1.pfile = <span>"cellphonedb/Old/pvalues.txt"</span>,group1.mfile=<span>"cellphonedb/Old/means.txt"</span>,<br>            group2.pfile=<span>"cellphonedb/Young/pvalues.txt"</span>,group2.mfile=<span>"cellphonedb/Young/means.txt"</span>,<br>            p.threshold = 0.01,thre=1,<br>            plot.width=105,plot.height=110,filename = <span>"test1_"</span><br>)<br><br><span>### 额外参数</span><br><span># 比如，这里我想展示EC细胞分别充当cellA和cellB的图</span><br><span># 也可以指定gene pair</span><br>CCC_compare(group1.name = <span>"Old"</span>,group2.name = <span>"Young"</span>,<br>            group1.pfile = <span>"cellphonedb/Old/pvalues.txt"</span>,group1.mfile=<span>"cellphonedb/Old/means.txt"</span>,<br>            group2.pfile=<span>"cellphonedb/Young/pvalues.txt"</span>,group2.mfile=<span>"cellphonedb/Young/means.txt"</span>,<br>            p.threshold = 0.05,thre=1,<br>            <span>#gene.pair = NULL,</span><br>            cell.pair=c(<br>              paste0(<span>"EC|"</span>,c(<span>"APC"</span>,<span>"SMC"</span>,<span>"Mac"</span>,<span>"DC"</span>,<span>"Neutrophil"</span>)),<br>              paste0(c(<span>"APC"</span>,<span>"SMC"</span>,<span>"Mac"</span>,<span>"DC"</span>,<span>"Neutrophil"</span>),<span>"|EC"</span>)<br>            ),<br>            plot.width=18,plot.height=30,filename = <span>"test2_"</span><br>            )<br></code></pre><h2 data-tool="mdnice编辑器"><span>获取代码</span></h2><p data-tool="mdnice编辑器">这个系列都会采取<strong>「限时公开」</strong>的方式共享代码，<code>24小时</code>内是免费的。超过这个时间如何获取，后台回复<code>2022A</code>可知。</p><p data-tool="mdnice编辑器">代码和测试数据的网盘链接如下:链接：https://pan.baidu.com/s/1fTP-HGgusjdPTxtYtrqb4A提取码：zv7n</p><p data-tool="mdnice编辑器">觉得代码有用的话，可以给个三/二/一连（文末<code>点赞</code>、<code>分享</code>、<code>点下小广告</code>）</p><h2 data-tool="mdnice编辑器"><span>预告</span></h2><p data-tool="mdnice编辑器">下一期代码还是两组比较，还是基于CellPhoneDB，可以用<code>连线</code>清晰展示<code>ligand-receptor</code>的关系，敬请期待。</p><figure data-tool="mdnice编辑器"><img data-ratio="0.8060879368658399" data-src="https://mmbiz.qpic.cn/mmbiz_png/WThoCmvVu2ZJvibandCGiaZW81mnGnAy0tAkhfM6HuLxg7aLoN3VmO9tsFw8z5yuVvmWJ64ztsJJ7mAiaef5AoicRA/640?wx_fmt=png" data-type="png" data-w="887" src="https://mmbiz.qpic.cn/mmbiz_png/WThoCmvVu2ZJvibandCGiaZW81mnGnAy0tAkhfM6HuLxg7aLoN3VmO9tsFw8z5yuVvmWJ64ztsJJ7mAiaef5AoicRA/640?wx_fmt=png"></figure><figure data-tool="mdnice编辑器"><img data-ratio="0.8060879368658399" data-src="https://mmbiz.qpic.cn/mmbiz_png/WThoCmvVu2ZJvibandCGiaZW81mnGnAy0tCFw37ZfWtOIJ5rxTWHZp554lKQjf6lvYHIjic10sMSgYq7UU5sJmCFQ/640?wx_fmt=png" data-type="png" data-w="887" src="https://mmbiz.qpic.cn/mmbiz_png/WThoCmvVu2ZJvibandCGiaZW81mnGnAy0tCFw37ZfWtOIJ5rxTWHZp554lKQjf6lvYHIjic10sMSgYq7UU5sJmCFQ/640?wx_fmt=png"></figure></section><p><img data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/WThoCmvVu2axZjuhcBMEdia3TJv1r062wlx6iccn76qHGArtic86bicFB2rzGyGmBalQnmXobKOcmlq7KVf9ZLhtUg/640?wx_fmt=png" data-type="png" data-ratio="0.3426666666666667" data-w="750" src="https://mmbiz.qpic.cn/mmbiz_png/WThoCmvVu2axZjuhcBMEdia3TJv1r062wlx6iccn76qHGArtic86bicFB2rzGyGmBalQnmXobKOcmlq7KVf9ZLhtUg/640?wx_fmt=png"></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/Wtbfb2UEaId73iHGPW_FnQ",target="_blank" rel="noopener noreferrer">原文链接</a>
