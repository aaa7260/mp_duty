---
title: "SingCellaR代码实操（三）：多样本单细胞数据整合上游分析"
date: 2022-09-27T04:51:28Z
draft: ["false"]
tags: [
  "fetched",
  "生信宝库"
]
categories: ["Acdemic"]
---
SingCellaR代码实操（三）：多样本单细胞数据整合上游分析 by 生信宝库
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><h2 data-tool="mdnice编辑器"><span></span><span>前言</span></h2><p data-tool="mdnice编辑器">在上一期推文：<a href="https://mp.weixin.qq.com/s?__biz=MzI4MjY5ODI1Nw==&amp;mid=2247486431&amp;idx=1&amp;sn=49f11015b5401f2ea8a1f1f47c91bcba&amp;chksm=eb94bca1dce335b76cc0ed25238bf133501689330c28888cd0f8f402f006ec507e32e3bce8ef&amp;token=823935757&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">SingCellaR代码实操（二）：单个骨髓纤维化患者的标准分析流程</a>中，Immugent展示了如何使用SingCellaR对单个患者的样本数据进行分析。而在实际应用中，我们为了对比不同分组或者处理的样本，需要整合多个样本的单细胞数据，因此就需要将不同来源的单细胞数据进行整合。SingCellaR内置了很多强大的去批次工具，可以直接对不同来源的数据进行整合分析，由于内容较多，Immugent将通过两期推文分别对整合分析的上游和下游进行讲解。</p><p data-tool="mdnice编辑器">本期推文将先展示如何使用SingCellaR进行整合多个来源的单细胞数据，以及其上游分析流程的代码。</p><p data-tool="mdnice编辑器"><br></p><hr data-tool="mdnice编辑器"><h2 data-tool="mdnice编辑器"><span></span><span>代码展示</span></h2><pre data-tool="mdnice编辑器"><code>library(SingCellaR)<br><br>human_HSPCs &lt;- new(<span>"SingCellaR"</span>)<br>human_HSPCs@dir_path_SingCellR_object_files&lt;-<span>"../SingCellaR_example_datasets/Psaila_et_al/SingCellaR_objects/"</span><br>human_HSPCs@SingCellR_object_files=c(<span>"Sample1.SingCellaR.rdata"</span>,<br>                                     <span>"Sample6.SingCellaR.rdata"</span>,<br>                                     <span>"Sample11.SingCellaR.rdata"</span>,<br>                                     <span>"Sample20.SingCellaR.rdata"</span>,<br>                                     <span>"Sample21.SingCellaR.rdata"</span>)<br><br>preprocess_integration(human_HSPCs)<br>human_HSPCs<br><span>## An object of class SingCellaR with a matrix of : 33538 genes across 35892 samples.</span><br><br></code></pre><p data-tool="mdnice编辑器">To speed up the integration, we downsample the number of cells to 5,000.</p><pre data-tool="mdnice编辑器"><code>subsample_cells(human_HSPCs,n.subsample = 5000,n.seed = 42)<br>filter_cells_and_genes(human_HSPCs,<br>                       min_UMIs=1000,<br>                       max_UMIs=80000,<br>                       min_detected_genes=500,<br>                       max_detected_genes=8000,<br>                       max_percent_mito=15,<br>                       genes_with_expressing_cells = 10,isRemovedDoublets = FALSE)<br><br>cell_anno.info&lt;-get_cells_annotation(human_HSPCs)<br>head(cell_anno.info)<br>table(cell_anno.info<span>$sampleID</span>)<br><span>##  1_Sample1 1_Sample11 1_Sample20 1_Sample21  1_Sample6 </span><br><span>##        469        818       1448       1479        786</span><br></code></pre><pre data-tool="mdnice编辑器"><code>human_HSPCs@meta.data<span>$status</span>[human_HSPCs@meta.data<span>$sampleID</span>==<span>"1_Sample1"</span>]&lt;-<span>"healthy"</span><br>human_HSPCs@meta.data<span>$status</span>[human_HSPCs@meta.data<span>$sampleID</span>==<span>"1_Sample6"</span>]&lt;-<span>"healthy"</span><br>human_HSPCs@meta.data<span>$status</span>[human_HSPCs@meta.data<span>$sampleID</span>==<span>"1_Sample11"</span>]&lt;-<span>"MF"</span><br>human_HSPCs@meta.data<span>$status</span>[human_HSPCs@meta.data<span>$sampleID</span>==<span>"1_Sample20"</span>]&lt;-<span>"MF"</span><br>human_HSPCs@meta.data<span>$status</span>[human_HSPCs@meta.data<span>$sampleID</span>==<span>"1_Sample21"</span>]&lt;-<span>"MF"</span><br><br>cell_anno.info&lt;-get_cells_annotation(human_HSPCs)<br>head(cell_anno.info)<br><br>normalize_UMIs(human_HSPCs,use.scaled.factor = T)<br>get_variable_genes_by_fitting_GLM_model(human_HSPCs,mean_expr_cutoff = 0.1,disp_zscore_cutoff = 0.1)<br>remove_unwanted_genes_from_variable_gene_set(human_HSPCs,gmt.file = <span>"../SingCellaR_example_datasets/Human_genesets/human.ribosomal-mitocondrial.genes.gmt"</span>,<br>                                             removed_gene_sets=c(<span>"Ribosomal_gene"</span>,<span>"Mitocondrial_gene"</span>))<br>plot_variable_genes(human_HSPCs)                                             <br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.7142857142857143" data-src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7cUreA6y9MaNmqCua0ByJqPwTrGcibkz5iburkJPdqMicPZDFcDlhk7ZPR0d3moww2t1kWl1Tn0e1iazg/640?wx_fmt=png" data-type="png" data-w="1344" src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7cUreA6y9MaNmqCua0ByJqPwTrGcibkz5iburkJPdqMicPZDFcDlhk7ZPR0d3moww2t1kWl1Tn0e1iazg/640?wx_fmt=png"></figure><pre data-tool="mdnice编辑器"><code>runPCA(human_HSPCs,use.components=50,use.regressout.data = F)<br>plot_PCA_Elbowplot(human_HSPCs)<br>SingCellaR::runUMAP(human_HSPCs,dim_reduction_method = <span>"pca"</span>,n.dims.use = 20,n.neighbors = 30,<br>        uwot.metric = <span>"euclidean"</span>)<br>plot_umap_label_by_a_feature_of_interest(human_HSPCs,feature = <span>"sampleID"</span>,point.size = 0.5)<br>plot_umap_label_by_a_feature_of_interest(human_HSPCs,feature = <span>"status"</span>,point.size = 0.5)<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.7142857142857143" data-src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7cUreA6y9MaNmqCua0ByJqP865dkpHib9muHDvhY2kAUkZxb28P7tb84Ltk89Yb50fY6RDxPH31gSw/640?wx_fmt=png" data-type="png" data-w="1344" src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7cUreA6y9MaNmqCua0ByJqP865dkpHib9muHDvhY2kAUkZxb28P7tb84Ltk89Yb50fY6RDxPH31gSw/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器"><img data-ratio="0.7142857142857143" data-src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7cUreA6y9MaNmqCua0ByJqPE4tRFceWuNaPJkqibJOIjvEBEBFzLbt4w2fzZicDVHESrnK0Nfrnq90w/640?wx_fmt=png" data-type="png" data-w="1344" src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7cUreA6y9MaNmqCua0ByJqPE4tRFceWuNaPJkqibJOIjvEBEBFzLbt4w2fzZicDVHESrnK0Nfrnq90w/640?wx_fmt=png">Supervised harmony integration</p><pre data-tool="mdnice编辑器"><code>library(harmony)<br>runSupervised_Harmony(human_HSPCs,covariates = c(<span>"sampleID"</span>),n.dims.use = 20,<br>                      hcl.height.cutoff = 0.25,harmony.max.iter = 20,n.seed = 1)<br>SingCellaR::runUMAP(human_HSPCs,useIntegrativeEmbeddings = T, integrative_method = <span>"supervised_harmony"</span>,n.dims.use = 20,<br>        n.neighbors = 30,uwot.metric = <span>"euclidean"</span>)           plot_umap_label_by_a_feature_of_interest(human_HSPCs,feature = <span>"sampleID"</span>,point.size = 0.5)   <br>plot_umap_label_by_a_feature_of_interest(human_HSPCs,feature = <span>"status"</span>,point.size = 0.5)        <br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.7142857142857143" data-src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7cUreA6y9MaNmqCua0ByJqPVd87mgYlASYFgSparonx0FvBSiaeDdpnYlotIbRDQE69rnaTTvicpnVw/640?wx_fmt=png" data-type="png" data-w="1344" src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7cUreA6y9MaNmqCua0ByJqPVd87mgYlASYFgSparonx0FvBSiaeDdpnYlotIbRDQE69rnaTTvicpnVw/640?wx_fmt=png"></figure><figure data-tool="mdnice编辑器"><img data-ratio="0.7142857142857143" data-src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7cUreA6y9MaNmqCua0ByJqP4cFmhPlspzIb0KZt1jrhRE6B2KBW84VQdic5c2EVjV9fyCiagoPiaDcpw/640?wx_fmt=png" data-type="png" data-w="1344" src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7cUreA6y9MaNmqCua0ByJqP4cFmhPlspzIb0KZt1jrhRE6B2KBW84VQdic5c2EVjV9fyCiagoPiaDcpw/640?wx_fmt=png"></figure><pre data-tool="mdnice编辑器"><code>plot_umap_label_by_multiple_gene_sets(human_HSPCs,gmt.file = <span>"../SingCellaR_example_datasets/Human_genesets/human.signature.genes.v1.gmt"</span>,<br>                                      show_gene_sets = c(<span>"Erythroid"</span>,<span>"Lymphoid"</span>,<span>"Myeloid"</span>,<span>"Megakaryocyte"</span>),<br>                                      custom_color = c(<span>"red"</span>,<span>"orange"</span>,<span>"cyan"</span>,<span>"purple"</span>),<br>                                      isNormalizedByHouseKeeping = T,point.size = 1,background.color = <span>"black"</span>)<br></code></pre><p data-tool="mdnice编辑器"><img data-ratio="0.7142857142857143" data-src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7cUreA6y9MaNmqCua0ByJqPjQJIfOHNVTicM9p0KlFxX6yNb41g34v6Nq9q8iaqhoeiakCWCqemFia5sg/640?wx_fmt=png" data-type="png" data-w="1344" src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7cUreA6y9MaNmqCua0ByJqPjQJIfOHNVTicM9p0KlFxX6yNb41g34v6Nq9q8iaqhoeiakCWCqemFia5sg/640?wx_fmt=png">Seurat integration</p><pre data-tool="mdnice编辑器"><code>library(Seurat)<br><br>meta.data&lt;-get_cells_annotation(human_HSPCs)<br>rownames(meta.data)&lt;-meta.data<span>$Cell</span><br><br>runSeuratIntegration(human_HSPCs,Seurat.metadata=meta.data,n.dims.use = 20,<br>                     Seurat.split.by = <span>"data_set"</span>,use.SingCellaR.varGenes = FALSE)<br>SingCellaR::runUMAP(human_HSPCs,useIntegrativeEmbeddings = T, integrative_method = <span>"seurat"</span>,n.dims.use = 20,<br>        n.neighbors = 30,uwot.metric = <span>"euclidean"</span>)           plot_umap_label_by_a_feature_of_interest(human_HSPCs,feature = <span>"sampleID"</span>,point.size = 0.5)   <br>plot_umap_label_by_a_feature_of_interest(human_HSPCs,feature = <span>"status"</span>,point.size = 0.5)        <br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.7142857142857143" data-src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7cUreA6y9MaNmqCua0ByJqPTSRphf8SMg5Omdj8HdapukeXvFNLUQC76WhfhuVRiaJzIIXVoWYc3hQ/640?wx_fmt=png" data-type="png" data-w="1344" src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7cUreA6y9MaNmqCua0ByJqPTSRphf8SMg5Omdj8HdapukeXvFNLUQC76WhfhuVRiaJzIIXVoWYc3hQ/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器"><img data-ratio="0.7142857142857143" data-src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7cUreA6y9MaNmqCua0ByJqP6ROZyIbCzn6ESKD1gctlX8p8egPiaKhyLICQUHzWv27J9YomO1f6FyQ/640?wx_fmt=png" data-type="png" data-w="1344" src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7cUreA6y9MaNmqCua0ByJqP6ROZyIbCzn6ESKD1gctlX8p8egPiaKhyLICQUHzWv27J9YomO1f6FyQ/640?wx_fmt=png">Liger integration</p><pre data-tool="mdnice编辑器"><code>library(rliger)<br>runLiger_online_iNMF(human_HSPCs,liger.k = 20)<br><br>SingCellaR::runUMAP(human_HSPCs,useIntegrativeEmbeddings = T, integrative_method = <span>"liger"</span>,n.dims.use = 20,<br>        n.neighbors = 30,uwot.metric = <span>"euclidean"</span>)<br>plot_umap_label_by_a_feature_of_interest(human_HSPCs,feature = <span>"sampleID"</span>,point.size = 0.5)<br><br>plot_umap_label_by_a_feature_of_interest(human_HSPCs,feature = <span>"status"</span>,point.size = 0.5)<br>plot_umap_label_by_multiple_gene_sets(human_HSPCs,gmt.file = <span>"../SingCellaR_example_datasets/Human_genesets/human.signature.genes.v1.gmt"</span>,<br>                                      show_gene_sets = c(<span>"Erythroid"</span>,<span>"Lymphoid"</span>,<span>"Myeloid"</span>,<span>"Megakaryocyte"</span>),<br>                                      custom_color = c(<span>"red"</span>,<span>"orange"</span>,<span>"cyan"</span>,<span>"purple"</span>),<br>                                      isNormalizedByHouseKeeping = T,point.size = 1,background.color = <span>"black"</span>)<br></code></pre><p data-tool="mdnice编辑器"><img data-ratio="0.7142857142857143" data-src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7cUreA6y9MaNmqCua0ByJqPRjR4WsYYEafBLIxWuzRniaqbpNSak5m5JcFy72ibOmX2dnKovxvLglyg/640?wx_fmt=png" data-type="png" data-w="1344" src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7cUreA6y9MaNmqCua0ByJqPRjR4WsYYEafBLIxWuzRniaqbpNSak5m5JcFy72ibOmX2dnKovxvLglyg/640?wx_fmt=png">Scanorama integration</p><pre data-tool="mdnice编辑器"><code>runScanorama(human_HSPCs)<br>runPCA(human_HSPCs,use.scanorama.integrative.matrix = T,use.components = 50)<br>SingCellaR::runUMAP(human_HSPCs,dim_reduction_method = <span>"pca"</span>,<br>        n.dims.use = 20,n.neighbors = 30,uwot.metric = <span>"euclidean"</span>)<br>        <br>plot_umap_label_by_a_feature_of_interest(human_HSPCs,feature = <span>"sampleID"</span>,point.size = 0.5)<br>plot_umap_label_by_a_feature_of_interest(human_HSPCs,feature = <span>"status"</span>,point.size = 0.5)<br>plot_umap_label_by_multiple_gene_sets(human_HSPCs,gmt.file = <span>"../SingCellaR_example_datasets/Human_genesets/human.signature.genes.v1.gmt"</span>,<br>                                      show_gene_sets = c(<span>"Erythroid"</span>,<span>"Lymphoid"</span>,<span>"Myeloid"</span>,<span>"Megakaryocyte"</span>),<br>                                      custom_color = c(<span>"red"</span>,<span>"orange"</span>,<span>"cyan"</span>,<span>"purple"</span>),<br>                                      isNormalizedByHouseKeeping = T,point.size = 1,background.color = <span>"black"</span>)<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.7142857142857143" data-src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7cUreA6y9MaNmqCua0ByJqPrJTcLh3zibAibwVbLc1ag8M2xhXB3aMbC4iaU0yviclpvxvtCFeEEkUk5g/640?wx_fmt=png" data-type="png" data-w="1344" src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7cUreA6y9MaNmqCua0ByJqPrJTcLh3zibAibwVbLc1ag8M2xhXB3aMbC4iaU0yviclpvxvtCFeEEkUk5g/640?wx_fmt=png"></figure><figure data-tool="mdnice编辑器"><img data-ratio="0.7142857142857143" data-src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7cUreA6y9MaNmqCua0ByJqPke1iciaaUD01z3dmxXyYiaKPlgWdonFGPf68s9e4x6se0N3yk6gC1uhOQ/640?wx_fmt=png" data-type="png" data-w="1344" src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7cUreA6y9MaNmqCua0ByJqPke1iciaaUD01z3dmxXyYiaKPlgWdonFGPf68s9e4x6se0N3yk6gC1uhOQ/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器"><img data-ratio="0.7142857142857143" data-src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7cUreA6y9MaNmqCua0ByJqPmaKzlBrRFOUHTRL3ScPqahL0ibAXb3wG48IKN7KbfJictX0CsDodtgQg/640?wx_fmt=png" data-type="png" data-w="1344" src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7cUreA6y9MaNmqCua0ByJqPmaKzlBrRFOUHTRL3ScPqahL0ibAXb3wG48IKN7KbfJictX0CsDodtgQg/640?wx_fmt=png">Combat</p><pre data-tool="mdnice编辑器"><code>library(sva)<br>runCombat(human_HSPCs,use.reduced_dim = F,batch_identifier = <span>"sampleID"</span>)<br>runPCA(human_HSPCs,use.regressout.data = T)<br>SingCellaR::runUMAP(human_HSPCs,dim_reduction_method = <span>"pca"</span>,n.dims.use = 20, n.neighbors = 20,uwot.metric = <span>"euclidean"</span>)<br>plot_umap_label_by_a_feature_of_interest(human_HSPCs,feature = <span>"sampleID"</span>,point.size = 0.5)<br>plot_umap_label_by_a_feature_of_interest(human_HSPCs,feature = <span>"status"</span>,point.size = 0.5)<br>plot_umap_label_by_multiple_gene_sets(human_HSPCs,gmt.file = <span>"../SingCellaR_example_datasets/Human_genesets/human.signature.genes.v1.gmt"</span>,<br>                                      show_gene_sets = c(<span>"Erythroid"</span>,<span>"Lymphoid"</span>,<span>"Myeloid"</span>,<span>"Megakaryocyte"</span>),<br>                                      custom_color = c(<span>"red"</span>,<span>"orange"</span>,<span>"cyan"</span>,<span>"purple"</span>),<br>                                      isNormalizedByHouseKeeping = T,point.size = 1,background.color = <span>"black"</span>)<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.7142857142857143" data-src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7cUreA6y9MaNmqCua0ByJqPJ0LjpPgicrtcIfqADUU0mib6ibKQShnt841lzOCNrVBZx8rVrgUWgjF3Q/640?wx_fmt=png" data-type="png" data-w="1344" src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7cUreA6y9MaNmqCua0ByJqPJ0LjpPgicrtcIfqADUU0mib6ibKQShnt841lzOCNrVBZx8rVrgUWgjF3Q/640?wx_fmt=png"></figure><figure data-tool="mdnice编辑器"><img data-ratio="0.7142857142857143" data-src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7cUreA6y9MaNmqCua0ByJqP2nIYGjic2ngNyLicE1JQlN0coPHPVEMIqoicicdKyJ7Cd46paPzdgDpCfA/640?wx_fmt=png" data-type="png" data-w="1344" src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7cUreA6y9MaNmqCua0ByJqP2nIYGjic2ngNyLicE1JQlN0coPHPVEMIqoicicdKyJ7Cd46paPzdgDpCfA/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器"><img data-ratio="0.7142857142857143" data-src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7cUreA6y9MaNmqCua0ByJqPBXzZ7VjWFo4FTUSlv7MArklvhw5ic3VDJiaaia0d2RicZpdicSwAKm3w8HA/640?wx_fmt=png" data-type="png" data-w="1344" src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7cUreA6y9MaNmqCua0ByJqPBXzZ7VjWFo4FTUSlv7MArklvhw5ic3VDJiaaia0d2RicZpdicSwAKm3w8HA/640?wx_fmt=png">Limma</p><pre data-tool="mdnice编辑器"><code>remove_unwanted_confounders(human_HSPCs,residualModelFormulaStr=<span>"~UMI_count+percent_mito+sampleID"</span>)<br>runPCA(human_HSPCs,use.regressout.data = T)<br>SingCellaR::runUMAP(human_HSPCs,dim_reduction_method = <span>"pca"</span>,n.dims.use = 20, n.neighbors = 20,uwot.metric = <span>"euclidean"</span>)<br>plot_umap_label_by_a_feature_of_interest(human_HSPCs,feature = <span>"sampleID"</span>,point.size = 0.5)<br>plot_umap_label_by_a_feature_of_interest(human_HSPCs,feature = <span>"status"</span>,point.size = 0.5)<br><br>plot_umap_label_by_multiple_gene_sets(human_HSPCs,gmt.file = <span>"../SingCellaR_example_datasets/Human_genesets/human.signature.genes.v1.gmt"</span>,<br>                                      show_gene_sets = c(<span>"Erythroid"</span>,<span>"Lymphoid"</span>,<span>"Myeloid"</span>,<span>"Megakaryocyte"</span>),<br>                                      custom_color = c(<span>"red"</span>,<span>"orange"</span>,<span>"cyan"</span>,<span>"purple"</span>),<br>                                      isNormalizedByHouseKeeping = T,point.size = 1,background.color = <span>"black"</span>)<br>save(human_HSPCs,file=<span>"../SingCellaR_example_datasets/Psaila_et_al/SingCellaR_objects/human_HSPCs_v0.1.SingCellaR.rdata"</span>)                                      <br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.7142857142857143" data-src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7cUreA6y9MaNmqCua0ByJqP1iaKTrgwCS9n30aA0KedJS0iaeA9YvAXd5E1msLrgeabltOKVibeOcxGw/640?wx_fmt=png" data-type="png" data-w="1344" src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7cUreA6y9MaNmqCua0ByJqP1iaKTrgwCS9n30aA0KedJS0iaeA9YvAXd5E1msLrgeabltOKVibeOcxGw/640?wx_fmt=png"></figure><figure data-tool="mdnice编辑器"><img data-ratio="0.7142857142857143" data-src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7cUreA6y9MaNmqCua0ByJqPk3YQG55bPXBdfyX6Y5P7AeONFZayVxZOzFssXHMwUtsAsp0ia0aK3uw/640?wx_fmt=png" data-type="png" data-w="1344" src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7cUreA6y9MaNmqCua0ByJqPk3YQG55bPXBdfyX6Y5P7AeONFZayVxZOzFssXHMwUtsAsp0ia0aK3uw/640?wx_fmt=png"></figure><figure data-tool="mdnice编辑器"><img data-ratio="0.7142857142857143" data-src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7cUreA6y9MaNmqCua0ByJqPgwhu6ibV00V1QQwGILV8z50ibEqPljqiatmFwZubdewaN9GAA3YZ3ia2Uw/640?wx_fmt=png" data-type="png" data-w="1344" src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7cUreA6y9MaNmqCua0ByJqPgwhu6ibV00V1QQwGILV8z50ibEqPljqiatmFwZubdewaN9GAA3YZ3ia2Uw/640?wx_fmt=png"></figure><hr data-tool="mdnice编辑器"><h2 data-tool="mdnice编辑器"><span></span><span>说在最后</span></h2><p data-tool="mdnice编辑器">上面Immugent展示了6种进行单细胞数据整合的算法，分别是：harmony，Seurat，Liger，Scanorama，Combat，Limma；这些已经几乎涵盖了目前所有主流的单细胞数据整合算法。总体上看，这些算法整合出的结果大同小异；其次需要根据数据量的大小选择合适的整合工具，比如如果你的数据庞大（20w+），而你的电脑配置又低，那就不太适合选择耗时耗内存的一些算法如Seurat，而是应该选择轻便的算法如Harmony。此外，如果数据是跨平台的，或者批次效应很大，那就需要使用Seurat这类强力的整合工具了。</p><p data-tool="mdnice编辑器">好啦，本期分享到这就结束了，我们下期将会对整合数据后的下游分析流程进行展示，敬请期待！</p><p data-tool="mdnice编辑器"><br></p><hr data-tool="mdnice编辑器"></section><p><br></p></section><p><img data-galleryid="" data-ratio="1" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/GL6g5Y3aR7f28iaAPOSZyaVreHSWoQket3gNW3WtOGwutAMDGYKSk6ZBOdhDUyS95mNMn5INvyOIibBSfHgzI6sQ/640?wx_fmt=jpeg" data-type="jpeg" data-w="258" src="https://mmbiz.qpic.cn/mmbiz_jpg/GL6g5Y3aR7f28iaAPOSZyaVreHSWoQket3gNW3WtOGwutAMDGYKSk6ZBOdhDUyS95mNMn5INvyOIibBSfHgzI6sQ/640?wx_fmt=jpeg"></p><h3 data-tool="mdnice编辑器"><span>关注下方公众号下回更新不迷路</span></h3><section><mp-common-profile data-id="MzI4MjY5ODI1Nw==" data-pluginname="mpprofile" data-headimg="http://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7f28iaAPOSZyaVreHSWoQketIFUzNSiayMfvqbyCD0TNcBv06SGnkaO1gXRsN9icoQ23IjMJ5ta3Jia9w/0?wx_fmt=png" data-nickname="生信宝库" data-alias="sxbk2020" data-signature="用于生信知识的收集与传播，以及生信人之间学习交流。本公众号各小编平时忙于科研，更新文章较其它同类型公众号较慢，但保持宁缺毋滥的本心，只更新对大家有用的推文。" data-from="2" data-is_biz_ban="0"></mp-common-profile></section></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/zz5yDUrb_RffOIHvhrybng",target="_blank" rel="noopener noreferrer">原文链接</a>
