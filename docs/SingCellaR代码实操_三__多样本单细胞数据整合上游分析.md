---
title: "SingCellaR代码实操（三）：多样本单细胞数据整合上游分析"
date: 2022-12-09T16:32:23Z
draft: ["false"]
tags: [
  "fetched",
  "单细胞天地"
]
categories: ["Acdemic"]
---
SingCellaR代码实操（三）：多样本单细胞数据整合上游分析 by 单细胞天地
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><h2 data-tool="mdnice编辑器"><span>前言</span></h2><p data-tool="mdnice编辑器">在上一期推文：<a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247508579&amp;idx=1&amp;sn=17c89a9c4cf4b924dc5dbf94efa9be88&amp;chksm=ea1ca4e1dd6b2df7d2d0797cbe8719c2662f14e32be6f5b077661f77445692e1f69427fdcdc4&amp;scene=21#wechat_redirect" textvalue="SingCellaR代码实操（二）：单个骨髓纤维化患者的标准分析流程" linktype="text" imgurl="" imgdata="null" data-itemshowtype="11" tab="innerlink" data-linktype="2">SingCellaR代码实操（二）：单个骨髓纤维化患者的标准分析流程</a>中，Immugent展示了如何使用SingCellaR对单个患者的样本数据进行分析。而在实际应用中，我们为了对比不同分组或者处理的样本，需要整合多个样本的单细胞数据，因此就需要将不同来源的单细胞数据进行整合。SingCellaR内置了很多强大的去批次工具，可以直接对不同来源的数据进行整合分析，由于内容较多，Immugent将通过两期推文分别对整合分析的上游和下游进行讲解。</p><p data-tool="mdnice编辑器">本期推文将先展示如何使用SingCellaR进行整合多个来源的单细胞数据，以及其上游分析流程的代码。</p><p data-tool="mdnice编辑器"><br></p><hr data-tool="mdnice编辑器"><h2 data-tool="mdnice编辑器"><span></span><span>代码展示</span></h2><pre data-tool="mdnice编辑器"><code>library(SingCellaR)<br><br>human_HSPCs &lt;- new(<span>"SingCellaR"</span>)<br>human_HSPCs@dir_path_SingCellR_object_files&lt;-<span>"../SingCellaR_example_datasets/Psaila_et_al/SingCellaR_objects/"</span><br>human_HSPCs@SingCellR_object_files=c(<span>"Sample1.SingCellaR.rdata"</span>,<br>                                     <span>"Sample6.SingCellaR.rdata"</span>,<br>                                     <span>"Sample11.SingCellaR.rdata"</span>,<br>                                     <span>"Sample20.SingCellaR.rdata"</span>,<br>                                     <span>"Sample21.SingCellaR.rdata"</span>)<br><br>preprocess_integration(human_HSPCs)<br>human_HSPCs<br><span>## An object of class SingCellaR with a matrix of : 33538 genes across 35892 samples.</span><br><br></code></pre><p data-tool="mdnice编辑器">To speed up the integration, we downsample the number of cells to 5,000.</p><pre data-tool="mdnice编辑器"><code>subsample_cells(human_HSPCs,n.subsample = 5000,n.seed = 42)<br>filter_cells_and_genes(human_HSPCs,<br>                       min_UMIs=1000,<br>                       max_UMIs=80000,<br>                       min_detected_genes=500,<br>                       max_detected_genes=8000,<br>                       max_percent_mito=15,<br>                       genes_with_expressing_cells = 10,isRemovedDoublets = FALSE)<br><br>cell_anno.info&lt;-get_cells_annotation(human_HSPCs)<br>head(cell_anno.info)<br>table(cell_anno.info<span>$sampleID</span>)<br><span>##  1_Sample1 1_Sample11 1_Sample20 1_Sample21  1_Sample6 </span><br><span>##        469        818       1448       1479        786</span><br></code></pre><pre data-tool="mdnice编辑器"><code>human_HSPCs@meta.data<span>$status</span>[human_HSPCs@meta.data<span>$sampleID</span>==<span>"1_Sample1"</span>]&lt;-<span>"healthy"</span><br>human_HSPCs@meta.data<span>$status</span>[human_HSPCs@meta.data<span>$sampleID</span>==<span>"1_Sample6"</span>]&lt;-<span>"healthy"</span><br>human_HSPCs@meta.data<span>$status</span>[human_HSPCs@meta.data<span>$sampleID</span>==<span>"1_Sample11"</span>]&lt;-<span>"MF"</span><br>human_HSPCs@meta.data<span>$status</span>[human_HSPCs@meta.data<span>$sampleID</span>==<span>"1_Sample20"</span>]&lt;-<span>"MF"</span><br>human_HSPCs@meta.data<span>$status</span>[human_HSPCs@meta.data<span>$sampleID</span>==<span>"1_Sample21"</span>]&lt;-<span>"MF"</span><br><br>cell_anno.info&lt;-get_cells_annotation(human_HSPCs)<br>head(cell_anno.info)<br><br>normalize_UMIs(human_HSPCs,use.scaled.factor = T)<br>get_variable_genes_by_fitting_GLM_model(human_HSPCs,mean_expr_cutoff = 0.1,disp_zscore_cutoff = 0.1)<br>remove_unwanted_genes_from_variable_gene_set(human_HSPCs,gmt.file = <span>"../SingCellaR_example_datasets/Human_genesets/human.ribosomal-mitocondrial.genes.gmt"</span>,<br>                                             removed_gene_sets=c(<span>"Ribosomal_gene"</span>,<span>"Mitocondrial_gene"</span>))<br>plot_variable_genes(human_HSPCs)                                             <br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.7142857142857143" data-src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7cUreA6y9MaNmqCua0ByJqPwTrGcibkz5iburkJPdqMicPZDFcDlhk7ZPR0d3moww2t1kWl1Tn0e1iazg/640?wx_fmt=png" data-type="png" data-w="1344" src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7cUreA6y9MaNmqCua0ByJqPwTrGcibkz5iburkJPdqMicPZDFcDlhk7ZPR0d3moww2t1kWl1Tn0e1iazg/640?wx_fmt=png"></figure><pre data-tool="mdnice编辑器"><code>runPCA(human_HSPCs,use.components=50,use.regressout.data = F)<br>plot_PCA_Elbowplot(human_HSPCs)<br>SingCellaR::runUMAP(human_HSPCs,dim_reduction_method = <span>"pca"</span>,n.dims.use = 20,n.neighbors = 30,<br>        uwot.metric = <span>"euclidean"</span>)<br>plot_umap_label_by_a_feature_of_interest(human_HSPCs,feature = <span>"sampleID"</span>,point.size = 0.5)<br>plot_umap_label_by_a_feature_of_interest(human_HSPCs,feature = <span>"status"</span>,point.size = 0.5)<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.7142857142857143" data-src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7cUreA6y9MaNmqCua0ByJqP865dkpHib9muHDvhY2kAUkZxb28P7tb84Ltk89Yb50fY6RDxPH31gSw/640?wx_fmt=png" data-type="png" data-w="1344" src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7cUreA6y9MaNmqCua0ByJqP865dkpHib9muHDvhY2kAUkZxb28P7tb84Ltk89Yb50fY6RDxPH31gSw/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器"><img data-ratio="0.7142857142857143" data-src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7cUreA6y9MaNmqCua0ByJqPE4tRFceWuNaPJkqibJOIjvEBEBFzLbt4w2fzZicDVHESrnK0Nfrnq90w/640?wx_fmt=png" data-type="png" data-w="1344" src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7cUreA6y9MaNmqCua0ByJqPE4tRFceWuNaPJkqibJOIjvEBEBFzLbt4w2fzZicDVHESrnK0Nfrnq90w/640?wx_fmt=png">Supervised harmony integration</p><pre data-tool="mdnice编辑器"><code>library(harmony)<br>runSupervised_Harmony(human_HSPCs,covariates = c(<span>"sampleID"</span>),n.dims.use = 20,<br>                      hcl.height.cutoff = 0.25,harmony.max.iter = 20,n.seed = 1)<br>SingCellaR::runUMAP(human_HSPCs,useIntegrativeEmbeddings = T, integrative_method = <span>"supervised_harmony"</span>,n.dims.use = 20,<br>        n.neighbors = 30,uwot.metric = <span>"euclidean"</span>)           plot_umap_label_by_a_feature_of_interest(human_HSPCs,feature = <span>"sampleID"</span>,point.size = 0.5)   <br>plot_umap_label_by_a_feature_of_interest(human_HSPCs,feature = <span>"status"</span>,point.size = 0.5)        <br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.7142857142857143" data-src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7cUreA6y9MaNmqCua0ByJqPVd87mgYlASYFgSparonx0FvBSiaeDdpnYlotIbRDQE69rnaTTvicpnVw/640?wx_fmt=png" data-type="png" data-w="1344" src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7cUreA6y9MaNmqCua0ByJqPVd87mgYlASYFgSparonx0FvBSiaeDdpnYlotIbRDQE69rnaTTvicpnVw/640?wx_fmt=png"></figure><figure data-tool="mdnice编辑器"><img data-ratio="0.7142857142857143" data-src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7cUreA6y9MaNmqCua0ByJqP4cFmhPlspzIb0KZt1jrhRE6B2KBW84VQdic5c2EVjV9fyCiagoPiaDcpw/640?wx_fmt=png" data-type="png" data-w="1344" src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7cUreA6y9MaNmqCua0ByJqP4cFmhPlspzIb0KZt1jrhRE6B2KBW84VQdic5c2EVjV9fyCiagoPiaDcpw/640?wx_fmt=png"></figure><pre data-tool="mdnice编辑器"><code>plot_umap_label_by_multiple_gene_sets(human_HSPCs,gmt.file = <span>"../SingCellaR_example_datasets/Human_genesets/human.signature.genes.v1.gmt"</span>,<br>                                      show_gene_sets = c(<span>"Erythroid"</span>,<span>"Lymphoid"</span>,<span>"Myeloid"</span>,<span>"Megakaryocyte"</span>),<br>                                      custom_color = c(<span>"red"</span>,<span>"orange"</span>,<span>"cyan"</span>,<span>"purple"</span>),<br>                                      isNormalizedByHouseKeeping = T,point.size = 1,background.color = <span>"black"</span>)<br></code></pre><p data-tool="mdnice编辑器"><img data-ratio="0.7142857142857143" data-src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7cUreA6y9MaNmqCua0ByJqPjQJIfOHNVTicM9p0KlFxX6yNb41g34v6Nq9q8iaqhoeiakCWCqemFia5sg/640?wx_fmt=png" data-type="png" data-w="1344" src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7cUreA6y9MaNmqCua0ByJqPjQJIfOHNVTicM9p0KlFxX6yNb41g34v6Nq9q8iaqhoeiakCWCqemFia5sg/640?wx_fmt=png">Seurat integration</p><pre data-tool="mdnice编辑器"><code>library(Seurat)<br><br>meta.data&lt;-get_cells_annotation(human_HSPCs)<br>rownames(meta.data)&lt;-meta.data<span>$Cell</span><br><br>runSeuratIntegration(human_HSPCs,Seurat.metadata=meta.data,n.dims.use = 20,<br>                     Seurat.split.by = <span>"data_set"</span>,use.SingCellaR.varGenes = FALSE)<br>SingCellaR::runUMAP(human_HSPCs,useIntegrativeEmbeddings = T, integrative_method = <span>"seurat"</span>,n.dims.use = 20,<br>        n.neighbors = 30,uwot.metric = <span>"euclidean"</span>)           plot_umap_label_by_a_feature_of_interest(human_HSPCs,feature = <span>"sampleID"</span>,point.size = 0.5)   <br>plot_umap_label_by_a_feature_of_interest(human_HSPCs,feature = <span>"status"</span>,point.size = 0.5)        <br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.7142857142857143" data-src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7cUreA6y9MaNmqCua0ByJqPTSRphf8SMg5Omdj8HdapukeXvFNLUQC76WhfhuVRiaJzIIXVoWYc3hQ/640?wx_fmt=png" data-type="png" data-w="1344" src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7cUreA6y9MaNmqCua0ByJqPTSRphf8SMg5Omdj8HdapukeXvFNLUQC76WhfhuVRiaJzIIXVoWYc3hQ/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器"><img data-ratio="0.7142857142857143" data-src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7cUreA6y9MaNmqCua0ByJqP6ROZyIbCzn6ESKD1gctlX8p8egPiaKhyLICQUHzWv27J9YomO1f6FyQ/640?wx_fmt=png" data-type="png" data-w="1344" src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7cUreA6y9MaNmqCua0ByJqP6ROZyIbCzn6ESKD1gctlX8p8egPiaKhyLICQUHzWv27J9YomO1f6FyQ/640?wx_fmt=png">Liger integration</p><pre data-tool="mdnice编辑器"><code>library(rliger)<br>runLiger_online_iNMF(human_HSPCs,liger.k = 20)<br><br>SingCellaR::runUMAP(human_HSPCs,useIntegrativeEmbeddings = T, integrative_method = <span>"liger"</span>,n.dims.use = 20,<br>        n.neighbors = 30,uwot.metric = <span>"euclidean"</span>)<br>plot_umap_label_by_a_feature_of_interest(human_HSPCs,feature = <span>"sampleID"</span>,point.size = 0.5)<br><br>plot_umap_label_by_a_feature_of_interest(human_HSPCs,feature = <span>"status"</span>,point.size = 0.5)<br>plot_umap_label_by_multiple_gene_sets(human_HSPCs,gmt.file = <span>"../SingCellaR_example_datasets/Human_genesets/human.signature.genes.v1.gmt"</span>,<br>                                      show_gene_sets = c(<span>"Erythroid"</span>,<span>"Lymphoid"</span>,<span>"Myeloid"</span>,<span>"Megakaryocyte"</span>),<br>                                      custom_color = c(<span>"red"</span>,<span>"orange"</span>,<span>"cyan"</span>,<span>"purple"</span>),<br>                                      isNormalizedByHouseKeeping = T,point.size = 1,background.color = <span>"black"</span>)<br></code></pre><p data-tool="mdnice编辑器"><img data-ratio="0.7142857142857143" data-src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7cUreA6y9MaNmqCua0ByJqPRjR4WsYYEafBLIxWuzRniaqbpNSak5m5JcFy72ibOmX2dnKovxvLglyg/640?wx_fmt=png" data-type="png" data-w="1344" src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7cUreA6y9MaNmqCua0ByJqPRjR4WsYYEafBLIxWuzRniaqbpNSak5m5JcFy72ibOmX2dnKovxvLglyg/640?wx_fmt=png">Scanorama integration</p><pre data-tool="mdnice编辑器"><code>runScanorama(human_HSPCs)<br>runPCA(human_HSPCs,use.scanorama.integrative.matrix = T,use.components = 50)<br>SingCellaR::runUMAP(human_HSPCs,dim_reduction_method = <span>"pca"</span>,<br>        n.dims.use = 20,n.neighbors = 30,uwot.metric = <span>"euclidean"</span>)<br>        <br>plot_umap_label_by_a_feature_of_interest(human_HSPCs,feature = <span>"sampleID"</span>,point.size = 0.5)<br>plot_umap_label_by_a_feature_of_interest(human_HSPCs,feature = <span>"status"</span>,point.size = 0.5)<br>plot_umap_label_by_multiple_gene_sets(human_HSPCs,gmt.file = <span>"../SingCellaR_example_datasets/Human_genesets/human.signature.genes.v1.gmt"</span>,<br>                                      show_gene_sets = c(<span>"Erythroid"</span>,<span>"Lymphoid"</span>,<span>"Myeloid"</span>,<span>"Megakaryocyte"</span>),<br>                                      custom_color = c(<span>"red"</span>,<span>"orange"</span>,<span>"cyan"</span>,<span>"purple"</span>),<br>                                      isNormalizedByHouseKeeping = T,point.size = 1,background.color = <span>"black"</span>)<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.7142857142857143" data-src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7cUreA6y9MaNmqCua0ByJqPrJTcLh3zibAibwVbLc1ag8M2xhXB3aMbC4iaU0yviclpvxvtCFeEEkUk5g/640?wx_fmt=png" data-type="png" data-w="1344" src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7cUreA6y9MaNmqCua0ByJqPrJTcLh3zibAibwVbLc1ag8M2xhXB3aMbC4iaU0yviclpvxvtCFeEEkUk5g/640?wx_fmt=png"></figure><figure data-tool="mdnice编辑器"><img data-ratio="0.7142857142857143" data-src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7cUreA6y9MaNmqCua0ByJqPke1iciaaUD01z3dmxXyYiaKPlgWdonFGPf68s9e4x6se0N3yk6gC1uhOQ/640?wx_fmt=png" data-type="png" data-w="1344" src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7cUreA6y9MaNmqCua0ByJqPke1iciaaUD01z3dmxXyYiaKPlgWdonFGPf68s9e4x6se0N3yk6gC1uhOQ/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器"><img data-ratio="0.7142857142857143" data-src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7cUreA6y9MaNmqCua0ByJqPmaKzlBrRFOUHTRL3ScPqahL0ibAXb3wG48IKN7KbfJictX0CsDodtgQg/640?wx_fmt=png" data-type="png" data-w="1344" src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7cUreA6y9MaNmqCua0ByJqPmaKzlBrRFOUHTRL3ScPqahL0ibAXb3wG48IKN7KbfJictX0CsDodtgQg/640?wx_fmt=png">Combat</p><pre data-tool="mdnice编辑器"><code>library(sva)<br>runCombat(human_HSPCs,use.reduced_dim = F,batch_identifier = <span>"sampleID"</span>)<br>runPCA(human_HSPCs,use.regressout.data = T)<br>SingCellaR::runUMAP(human_HSPCs,dim_reduction_method = <span>"pca"</span>,n.dims.use = 20, n.neighbors = 20,uwot.metric = <span>"euclidean"</span>)<br>plot_umap_label_by_a_feature_of_interest(human_HSPCs,feature = <span>"sampleID"</span>,point.size = 0.5)<br>plot_umap_label_by_a_feature_of_interest(human_HSPCs,feature = <span>"status"</span>,point.size = 0.5)<br>plot_umap_label_by_multiple_gene_sets(human_HSPCs,gmt.file = <span>"../SingCellaR_example_datasets/Human_genesets/human.signature.genes.v1.gmt"</span>,<br>                                      show_gene_sets = c(<span>"Erythroid"</span>,<span>"Lymphoid"</span>,<span>"Myeloid"</span>,<span>"Megakaryocyte"</span>),<br>                                      custom_color = c(<span>"red"</span>,<span>"orange"</span>,<span>"cyan"</span>,<span>"purple"</span>),<br>                                      isNormalizedByHouseKeeping = T,point.size = 1,background.color = <span>"black"</span>)<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.7142857142857143" data-src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7cUreA6y9MaNmqCua0ByJqPJ0LjpPgicrtcIfqADUU0mib6ibKQShnt841lzOCNrVBZx8rVrgUWgjF3Q/640?wx_fmt=png" data-type="png" data-w="1344" src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7cUreA6y9MaNmqCua0ByJqPJ0LjpPgicrtcIfqADUU0mib6ibKQShnt841lzOCNrVBZx8rVrgUWgjF3Q/640?wx_fmt=png"></figure><figure data-tool="mdnice编辑器"><img data-ratio="0.7142857142857143" data-src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7cUreA6y9MaNmqCua0ByJqP2nIYGjic2ngNyLicE1JQlN0coPHPVEMIqoicicdKyJ7Cd46paPzdgDpCfA/640?wx_fmt=png" data-type="png" data-w="1344" src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7cUreA6y9MaNmqCua0ByJqP2nIYGjic2ngNyLicE1JQlN0coPHPVEMIqoicicdKyJ7Cd46paPzdgDpCfA/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器"><img data-ratio="0.7142857142857143" data-src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7cUreA6y9MaNmqCua0ByJqPBXzZ7VjWFo4FTUSlv7MArklvhw5ic3VDJiaaia0d2RicZpdicSwAKm3w8HA/640?wx_fmt=png" data-type="png" data-w="1344" src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7cUreA6y9MaNmqCua0ByJqPBXzZ7VjWFo4FTUSlv7MArklvhw5ic3VDJiaaia0d2RicZpdicSwAKm3w8HA/640?wx_fmt=png">Limma</p><pre data-tool="mdnice编辑器"><code>remove_unwanted_confounders(human_HSPCs,residualModelFormulaStr=<span>"~UMI_count+percent_mito+sampleID"</span>)<br>runPCA(human_HSPCs,use.regressout.data = T)<br>SingCellaR::runUMAP(human_HSPCs,dim_reduction_method = <span>"pca"</span>,n.dims.use = 20, n.neighbors = 20,uwot.metric = <span>"euclidean"</span>)<br>plot_umap_label_by_a_feature_of_interest(human_HSPCs,feature = <span>"sampleID"</span>,point.size = 0.5)<br>plot_umap_label_by_a_feature_of_interest(human_HSPCs,feature = <span>"status"</span>,point.size = 0.5)<br><br>plot_umap_label_by_multiple_gene_sets(human_HSPCs,gmt.file = <span>"../SingCellaR_example_datasets/Human_genesets/human.signature.genes.v1.gmt"</span>,<br>                                      show_gene_sets = c(<span>"Erythroid"</span>,<span>"Lymphoid"</span>,<span>"Myeloid"</span>,<span>"Megakaryocyte"</span>),<br>                                      custom_color = c(<span>"red"</span>,<span>"orange"</span>,<span>"cyan"</span>,<span>"purple"</span>),<br>                                      isNormalizedByHouseKeeping = T,point.size = 1,background.color = <span>"black"</span>)<br>save(human_HSPCs,file=<span>"../SingCellaR_example_datasets/Psaila_et_al/SingCellaR_objects/human_HSPCs_v0.1.SingCellaR.rdata"</span>)                                      <br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.7142857142857143" data-src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7cUreA6y9MaNmqCua0ByJqP1iaKTrgwCS9n30aA0KedJS0iaeA9YvAXd5E1msLrgeabltOKVibeOcxGw/640?wx_fmt=png" data-type="png" data-w="1344" src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7cUreA6y9MaNmqCua0ByJqP1iaKTrgwCS9n30aA0KedJS0iaeA9YvAXd5E1msLrgeabltOKVibeOcxGw/640?wx_fmt=png"></figure><figure data-tool="mdnice编辑器"><img data-ratio="0.7142857142857143" data-src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7cUreA6y9MaNmqCua0ByJqPk3YQG55bPXBdfyX6Y5P7AeONFZayVxZOzFssXHMwUtsAsp0ia0aK3uw/640?wx_fmt=png" data-type="png" data-w="1344" src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7cUreA6y9MaNmqCua0ByJqPk3YQG55bPXBdfyX6Y5P7AeONFZayVxZOzFssXHMwUtsAsp0ia0aK3uw/640?wx_fmt=png"></figure><figure data-tool="mdnice编辑器"><img data-ratio="0.7142857142857143" data-src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7cUreA6y9MaNmqCua0ByJqPgwhu6ibV00V1QQwGILV8z50ibEqPljqiatmFwZubdewaN9GAA3YZ3ia2Uw/640?wx_fmt=png" data-type="png" data-w="1344" src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7cUreA6y9MaNmqCua0ByJqPgwhu6ibV00V1QQwGILV8z50ibEqPljqiatmFwZubdewaN9GAA3YZ3ia2Uw/640?wx_fmt=png"></figure><hr data-tool="mdnice编辑器"><h2 data-tool="mdnice编辑器"><span></span><span>说在最后</span></h2><p data-tool="mdnice编辑器">上面Immugent展示了6种进行单细胞数据整合的算法，分别是：harmony，Seurat，Liger，Scanorama，Combat，Limma；这些已经几乎涵盖了目前所有主流的单细胞数据整合算法。总体上看，这些算法整合出的结果大同小异；其次需要根据数据量的大小选择合适的整合工具，比如如果你的数据庞大（20w+），而你的电脑配置又低，那就不太适合选择耗时耗内存的一些算法如Seurat，而是应该选择轻便的算法如Harmony。此外，如果数据是跨平台的，或者批次效应很大，那就需要使用Seurat这类强力的整合工具了。</p><p data-tool="mdnice编辑器">好啦，本期分享到这就结束了，我们下期将会对整合数据后的下游分析流程进行展示，敬请期待！</p><section><p><br></p><section data-style-type="5" data-tools="新媒体排版" data-id="2440476"><section><section><section><section><img data-ratio="0.9495798319327731" data-src="https://mmbiz.qpic.cn/mmbiz_gif/09gp6SvPE04j3m2v7Hr889icHUyibTOHs8YuUibicl7ibRD0ZwG5pDTjBluRreZvuib1o3BibvLkicYhnA4YW7dQsjn0cA/640?wx_fmt=gif" data-type="gif" data-w="119" data-width="100%" src="https://mmbiz.qpic.cn/mmbiz_gif/09gp6SvPE04j3m2v7Hr889icHUyibTOHs8YuUibicl7ibRD0ZwG5pDTjBluRreZvuib1o3BibvLkicYhnA4YW7dQsjn0cA/640?wx_fmt=gif"></section><section data-brushtype="text">往期回顾</section><section><br></section></section></section></section><section><section data-autoskip="1"><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247509226&amp;idx=1&amp;sn=4e89060da840234bf1b36089e439f149&amp;chksm=ea1ca268dd6b2b7e667ebc340d71721eb6eed5cd010c581a65e69ffed8f12429e90e6e60ef18&amp;scene=21#wechat_redirect" textvalue="免疫浸润显示CD103CD39 T细胞与结直肠癌预后和免疫治疗反应相关" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2"><span>免疫浸润显示CD103CD39 T细胞与结直肠癌预后和免疫治疗反应相关</span></a><br></p><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247509126&amp;idx=1&amp;sn=65dce0ad7bde1cf58296f40fb8733c8a&amp;chksm=ea1ca204dd6b2b12f4e23b41f630a3211c24f9cdccbcdda18d45f4e2431b30fd558a05519284&amp;scene=21#wechat_redirect" textvalue="成脂谱系前体细胞通过瞬时扩增和肌成纤维细胞转化介导骨髓放射修复" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2"><span>成脂谱系前体细胞通过瞬时扩增和肌成纤维细胞转化介导骨髓放射修复</span></a><br></p><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247509101&amp;idx=1&amp;sn=127d127c6d723fcd7f15ca727f475b7d&amp;chksm=ea1ca2efdd6b2bf95b83dba4698e0fac81784ab99f9835f01a8f06dd6bb98123f9e05d4a50fb&amp;scene=21#wechat_redirect" textvalue="接受抗原驱动的过敏性小鼠皮炎的的单细胞转录组对于特应性皮炎的研究" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2"><span>接受抗原驱动的过敏性小鼠皮炎的的单细胞转录组对于特应性皮炎的研究</span></a><br></p><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247509091&amp;idx=1&amp;sn=674e8e5d846c7c6b761771cc47a2d391&amp;chksm=ea1ca2e1dd6b2bf741a1f0d0d8060730b9529adcc05fa92565e45dc278b192f122af8f3dc0a5&amp;scene=21#wechat_redirect" textvalue="单细胞和WGCNA联合分析揭示影响CEP稳态的关键MSCs生态位和致病基因" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2"><span>单细胞和WGCNA联合分析揭示影响CEP稳态的关键MSCs生态位和致病基因</span></a></p><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247508984&amp;idx=1&amp;sn=56afa7e3b79d07859e6ed36431d6ec04&amp;chksm=ea1ca57add6b2c6c05e812bcf0ff6ff1c61f98b59476da973cdcbd39ae5b9347f4069ac78079&amp;scene=21#wechat_redirect" textvalue="单细胞python复现|| 01-文献解读：肺癌转移中的再生谱系和免疫介导的杀伤" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2"><span>单细胞python复现|| 01-文献解读：肺癌转移中的再生谱系和免疫介导的杀伤</span></a><br></p></section></section><hr><p><br></p></section><section data-style-type="5" data-tools="新媒体排版" data-id="2440475"><hr><p><br></p><hr><section><p>如果你对单细胞转录组研究感兴趣，但又不知道如何入门，也许你可以关注一下下面的课程<span></span></p><p><br></p><ul><li><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247505898&amp;idx=1&amp;sn=3caaa355db327f412fe27c969f20533c&amp;chksm=ea1cd168dd6b587e7c955c80a87b78248f4fe7cf88514caf7fdca580e98877d4e2d96e40dcb7&amp;scene=21#wechat_redirect" textvalue="提前锁定年后马拉松授课名额，赠送价值1600的单细胞数据分析一次" linktype="text" imgurl="" imgdata="null" data-itemshowtype="11" tab="innerlink" data-linktype="2" hasload="1">提前锁定年后马拉松授课名额，赠送价值1600的单细胞数据分析一次</a></p></li><li><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247518150&amp;idx=1&amp;sn=9e7764a48a43b4fe810bb7458c409fa4&amp;chksm=9b4bc77dac3c4e6b75ca910146ce96ff3c072914abfb7de3785a84769950863a3ac626f38b35&amp;scene=21#wechat_redirect" textvalue="96线程512G内存500G硬盘服务器一年仅需800" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1">96线程512G内存500G硬盘服务器一年仅需800</a><br></p></li><li><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247518195&amp;idx=1&amp;sn=d6d82ceda8531ebdc294dab0bf9d5519&amp;chksm=9b4bc748ac3c4e5e5c68748241e194638ed0ab33daac9dd6b6ec3fdb647ff782e6dd182b7c69&amp;scene=21#wechat_redirect" textvalue="在全新服务器配置转录组测序数据处理环境" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1">在全新服务器配置转录组测序数据处理环境</a></p></li></ul><p><img data-ratio="1" data-src="https://mmbiz.qpic.cn/mmbiz_gif/4TKeL1ZejtlKxOib5kmKX6ic6eX0w0WK5jvhtz9yBRsO3OI4yr6S5iaLNM7AbAeuPDHXMvDdur2DRz9wyiax4lEviag/640?wx_fmt=gif" data-type="gif" data-w="240" src="https://mmbiz.qpic.cn/mmbiz_gif/4TKeL1ZejtlKxOib5kmKX6ic6eX0w0WK5jvhtz9yBRsO3OI4yr6S5iaLNM7AbAeuPDHXMvDdur2DRz9wyiax4lEviag/640?wx_fmt=gif"><br></p><p><img data-ratio="0.05278592375366569" data-src="https://mmbiz.qpic.cn/mmbiz/4TKeL1Zejtlq03ZOSZiaTlic1MxgdKiaxTbOZ7ZSe0Xx1Ca8xF3L6Nyj1FYUajtYrSmRIHyZVSsAve0EAvEicZONpg/640?wx_fmt=jpeg" data-type="other" data-w="341" src="https://mmbiz.qpic.cn/mmbiz/4TKeL1Zejtlq03ZOSZiaTlic1MxgdKiaxTbOZ7ZSe0Xx1Ca8xF3L6Nyj1FYUajtYrSmRIHyZVSsAve0EAvEicZONpg/640?wx_fmt=jpeg"></p><p><strong><span>看完记得顺手点个</span></strong><span><strong><span>“在看”</span></strong></span><strong><span>哦！</span></strong></p></section><section><section data-id="93668"><section><section data-width="95%"><section><section><section data-width="38%"><section><section data-tools="135编辑器" data-id="93668"><section><section data-width="95%"><section><section><section data-width="61.8%"><section><section><section><p><br></p><span><strong data-burshtype="text"><img data-copyright="0" data-cropselx1="0" data-cropselx2="109" data-cropsely1="0" data-cropsely2="109" data-ratio="1" data-src="https://mmbiz.qpic.cn/mmbiz/siaia0BDGJdjRMGrkqo64BGKecYk4akuHpGHVQs7FeOpY7eWbIPGC1tRw5Tw0oEPmx053mR9FTVerWvhuZchIpZw/640?wx_fmt=jpeg" data-type="other" data-w="430" title="qrcode_for_gh_5a3c482ed99f_1280.jpg" src="https://mmbiz.qpic.cn/mmbiz/siaia0BDGJdjRMGrkqo64BGKecYk4akuHpGHVQs7FeOpY7eWbIPGC1tRw5Tw0oEPmx053mR9FTVerWvhuZchIpZw/640?wx_fmt=jpeg"><strong data-burshtype="text">生物</strong><strong data-burshtype="text"> | 单细胞 | 转录组丨资料</strong></strong></span></section><section><span><strong data-burshtype="text">每天都精彩</strong></span></section></section></section><section><section><section><section><section><section><p><span>长按扫码可关注</span></p></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section><section><br></section></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/8ZFvVgMeU8dL8u47_2KGCw",target="_blank" rel="noopener noreferrer">原文链接</a>
