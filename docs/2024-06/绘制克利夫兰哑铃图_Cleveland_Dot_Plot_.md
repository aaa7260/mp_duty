---
title: "绘制克利夫兰哑铃图（Cleveland Dot Plot）"
date: 2024-06-18T01:44:09Z
draft: ["false"]
tags: [
  "fetched",
  "科研七点半"
]
categories: ["Acdemic"]
---
绘制克利夫兰哑铃图（Cleveland Dot Plot） by 科研七点半
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><p data-tool="mdnice编辑器">克利夫兰哑铃图（Cleveland Dot Plot），或简称为哑铃图（Dot Plot），是一种用于数据可视化的图表，它在描述两个或多个组之间差异方面特别有效。这种图表由克利夫兰（William S. Cleveland）提出，以其简洁和表达清晰而著称。</p><h3 data-tool="mdnice编辑器"><span></span><span>哑铃图的结构</span><span></span></h3><p data-tool="mdnice编辑器">哑铃图主要由以下几部分构成：</p><ol data-tool="mdnice编辑器"><li><section><span>点</span>：每个点代表一个数据值。在克利夫兰哑铃图中，通常会在同一水平线上展示两个或更多组的点，用于比较。</section></li><li><section><span>线</span>：连接不同组中对应数据点的线，有助于直观显示两个数据点之间的差异。</section></li><li><section><span>轴</span>：通常哑铃图只有一个水平或垂直的数值轴，用来表示数据的量度。</section></li></ol><h3 data-tool="mdnice编辑器"><span></span><span>应用场景</span><span></span></h3><p data-tool="mdnice编辑器">哑铃图非常适用于比较两个或多个组在相同类别下的数值，例如：</p><ul data-tool="mdnice编辑器"><li><section>前后测量数据的比较。</section></li><li><section>不同时间点的指标比较。</section></li><li><section>不同组或条件下的实验结果对比。</section></li></ul><h3 data-tool="mdnice编辑器"><span></span><span>优势</span><span></span></h3><ul data-tool="mdnice编辑器"><li><section><span>直观</span>：通过点和线直接展示不同组别之间的比较，使得差异一目了然。</section></li><li><section><span>简洁</span>：避免了复杂的图表元素，聚焦于数据的比较，易于理解和解释。</section></li><li><section><span>灵活性</span>：可以轻松调整以适应不同的数据集和比较需求。</section></li></ul><h3 data-tool="mdnice编辑器"><span></span><span>在R语言中的实现</span><span></span></h3><p data-tool="mdnice编辑器">在R语言中，哑铃图可以通过多种方式实现，如使用 <code>ggplot2</code> 包中的 <code>geom_point()</code> 和 <code>geom_segment()</code> 函数。下面是一个简单的实现示例：</p><pre data-tool="mdnice编辑器"><span></span><code><span>library</span>(ggplot2)<br><br><span># 创建示例数据</span><br>data &lt;- data.frame(<br>  Category = c(<span>"A"</span>, <span>"B"</span>, <span>"C"</span>),<br>  Group1 = c(<span>20</span>, <span>30</span>, <span>25</span>),<br>  Group2 = c(<span>25</span>, <span>35</span>, <span>30</span>)<br>)<br><br><span># 生成点的位置数据，这将帮助在哑铃图中定位点</span><br>data_long &lt;- tidyr::pivot_longer(data, cols = c(Group1, Group2), names_to = <span>"Group"</span>, values_to = <span>"Value"</span>)<br><br><span># 绘制哑铃图</span><br>ggplot(data_long, aes(x = Value, y = Category, group = Category, color = Group)) +<br>  geom_point(size = <span>3</span>) +  <span># 添加点</span><br>  geom_line(aes(group = Category), size = <span>1</span>) +  <span># 添加连接线</span><br>  scale_color_manual(values = c(<span>"#FF5733"</span>, <span>"#33C1FF"</span>)) +  <span># 为不同组设置颜色</span><br>  labs(title = <span>"Advanced Dumbbell Plot"</span>, x = <span>"Value"</span>, y = <span>"Category"</span>) +  <span># 添加标题和轴标签</span><br>  theme_minimal()  <span># 使用简洁主题</span><br></code></pre><p><img data-galleryid="" data-imgfileid="100006943" data-ratio="0.6701461377870563" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/owuibmRdV9sibmWD15JiaCCBpF0icsyHtOWyd7AAskCic8FvicY78FvicAibaAhbbmnMqsJIXgtkfbr3laPlkgnE8RGkYw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="479" src="https://mmbiz.qpic.cn/mmbiz_png/owuibmRdV9sibmWD15JiaCCBpF0icsyHtOWyd7AAskCic8FvicY78FvicAibaAhbbmnMqsJIXgtkfbr3laPlkgnE8RGkYw/640?wx_fmt=png&amp;from=appmsg"></p><h3 data-tool="mdnice编辑器"><span></span><span>用实际数据</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code>mydata&lt;-read.csv(<span>"DotPlots_Data.csv"</span>,sep=<span>","</span>,na.strings=<span>"NA"</span>,stringsAsFactors=<span>FALSE</span>)<br>mydata$City &lt;- factor(mydata$City, levels = mydata$City[order(mydata$Female)])<br>mydata&lt;-melt(mydata,id.vars=<span>'City'</span>)<br><br>ggplot(mydata, aes(x=value,y=City,fill=variable)) +<br>  geom_line(aes(group = City)) +<br>  geom_point(shape=<span>21</span>,size=<span>3</span>,colour=<span>"black"</span>)+<br>  scale_fill_manual(values=c(<span>"#00AFBB"</span>, <span>"#FC4E07"</span>,<span>"#36BED9"</span>))+<br>  theme_classic()+<br>  theme(<br>    axis.title=element_text(size=<span>13</span>,face=<span>"plain"</span>,color=<span>"black"</span>),<br>    axis.text = element_text(size=<span>10</span>,face=<span>"plain"</span>,color=<span>"black"</span>),<br>    legend.title=element_text(size=<span>12</span>,face=<span>"plain"</span>,color=<span>"black"</span>),<br>    legend.background = element_blank(),<br>    legend.position = c(<span>0.85</span>,<span>0.12</span>)<br>  )<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100006932" data-ratio="1.1958955223880596" data-src="https://mmbiz.qpic.cn/mmbiz_png/owuibmRdV9sibmWD15JiaCCBpF0icsyHtOWyibmbzhTTLic3L4jBEq3Af075FDNKMSRIVWLaV6EzibpgJYP7vDlzwPTXA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1072" src="https://mmbiz.qpic.cn/mmbiz_png/owuibmRdV9sibmWD15JiaCCBpF0icsyHtOWyibmbzhTTLic3L4jBEq3Af075FDNKMSRIVWLaV6EzibpgJYP7vDlzwPTXA/640?wx_fmt=png&amp;from=appmsg"></figure><h3 data-tool="mdnice编辑器"><span></span><span>数据读取和处理</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code><span># 读取 CSV 文件为数据框</span><br>mydata &lt;- read.csv(<span>"DotPlots_Data.csv"</span>, sep=<span>","</span>, na.strings=<span>"NA"</span>, stringsAsFactors=<span>FALSE</span>)<br></code></pre><ul data-tool="mdnice编辑器"><li><section><span>"DotPlots_Data.csv"</span>: 指定要读取的 CSV 文件的路径和名称。</section></li><li><section><span>sep=","</span>: 指定字段分隔符为逗号（,），这是 CSV 文件的标准分隔符。</section></li><li><section><span>na.strings="NA"</span>: 指定将哪些字符串识别为 NA（缺失值）。这里将 "NA" 字符串转换为 R 中的 <code>NA</code>。</section></li><li><section><span>stringsAsFactors=FALSE</span>: 防止自动将字符串转换为因子（类别型数据）。这可以使数据处理更灵活。</section></li></ul><pre data-tool="mdnice编辑器"><span></span><code><span># 转换 'City' 列为因子，并按 'Female' 列的值对其水平进行排序</span><br>mydata$City &lt;- factor(mydata$City, levels = mydata$City[order(mydata$Female)])<br></code></pre><ul data-tool="mdnice编辑器"><li><section><span>factor</span>: 将 'City' 列转换为因子，这对于分类变量在图表中的展示很重要。</section></li><li><section><span>levels</span>: 指定因子的水平，这里使用 <code>order</code> 函数按 'Female' 列的值排序 'City'。</section></li></ul><pre data-tool="mdnice编辑器"><span></span><code><span># 使用 melt 函数从 'reshape2' 包将数据从宽格式转换为长格式，以便于 ggplot2 处理</span><br>mydata &lt;- melt(mydata, id.vars=<span>'City'</span>)<br></code></pre><ul data-tool="mdnice编辑器"><li><section><span>melt</span>: 转换数据框的格式，将多个列的测量值整理到两列中：一个变量名和一个值。</section></li><li><section><span>id.vars='City'</span>: 指定 'City' 列为 ID 变量，其他所有列将被转化为两个变量：variable 和 value。</section></li></ul><h3 data-tool="mdnice编辑器"><span></span><span>数据可视化</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code><span># 使用 ggplot2 绘制数据</span><br>ggplot(mydata, aes(x=value, y=City, fill=variable)) +<br></code></pre><ul data-tool="mdnice编辑器"><li><section><span>aes</span>: 设置图形的美学映射，<code>x=value</code> 和 <code>y=City</code> 表示横纵坐标，<code>fill=variable</code> 表示用不同的颜色填充点，颜色由变量类型决定。</section></li></ul><pre data-tool="mdnice编辑器"><span></span><code>  geom_line(aes(group = City)) +<br></code></pre><ul data-tool="mdnice编辑器"><li><section><span>geom_line</span>: 添加线图层，<code>group = City</code> 确保每个城市的数据点连接在一起。</section></li></ul><pre data-tool="mdnice编辑器"><span></span><code>  geom_point(shape=<span>21</span>, size=<span>3</span>, colour=<span>"black"</span>) +<br></code></pre><ul data-tool="mdnice编辑器"><li><section><span>geom_point</span>: 添加点图层，<code>shape=21</code> 是带有填充和边框的点的形状，<code>size=3</code> 设置点的大小，<code>colour="black"</code> 设置点的边框颜色。</section></li></ul><pre data-tool="mdnice编辑器"><span></span><code>  scale_fill_manual(values=c(<span>"#00AFBB"</span>, <span>"#FC4E07"</span>, <span>"#36BED9"</span>)) +<br></code></pre><ul data-tool="mdnice编辑器"><li><section><span>scale_fill_manual</span>: 手动设置填充颜色，这里为不同的变量类型提供特定的颜色代码。</section></li></ul><pre data-tool="mdnice编辑器"><span></span><code>  theme_classic() +<br></code></pre><ul data-tool="mdnice编辑器"><li><section><span>theme_classic</span>: 使用经典主题，具有简单和清晰的视觉风格。</section></li></ul><pre data-tool="mdnice编辑器"><span></span><code>  theme(<br>    axis.title=element_text(size=<span>13</span>, face=<span>"plain"</span>, color=<span>"black"</span>),<br>    axis.text = element_text(size=<span>10</span>, face=<span>"plain"</span>, color=<span>"black"</span>),<br>    legend.title=element_text(size=<span>12</span>, face=<span>"plain"</span>, color=<span>"black"</span>),<br>    legend.background = element_blank(),<br>    legend.position = c(<span>0.85</span>, <span>0.12</span>)<br>  )<br></code></pre><ul data-tool="mdnice编辑器"><li><section><span>theme</span>: 进一步定制图形的样式，包括坐标轴标题、坐标轴文本、图例标题和图例位置等。</section></li><li><section><span>element_text</span>: 定制文本元素的大小、字体和颜色。</section></li><li><section><span>element_blank()</span>: 移除图例背景。</section></li><li><section><span>legend.position</span>: 设定图例的位置</section></li></ul></section><p><br></p><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/dee7RUPsghz-2opT_SVnqw",target="_blank" rel="noopener noreferrer">原文链接</a>
