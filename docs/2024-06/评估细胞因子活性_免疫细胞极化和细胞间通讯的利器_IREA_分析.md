---
title: "评估细胞因子活性、免疫细胞极化和细胞间通讯的利器：IREA 分析"
date: 2024-06-19T05:01:34Z
draft: ["false"]
tags: [
  "fetched",
  "生信菜鸟团"
]
categories: ["Acdemic"]
---
评估细胞因子活性、免疫细胞极化和细胞间通讯的利器：IREA 分析 by 生信菜鸟团
------
<div><section><blockquote><span>❝</span><p>Immune Response Enrichment Analysis (IREA) is the companion software for the Immune Dictionary.</p><p>IREA assesses cytokine activities, immune cell polarization, and cell-cell communication from user transcriptomic data.<img data-backh="282" data-backw="562" data-imgfileid="100039944" data-ratio="0.5018518518518519" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicqlJOiaWkVgf5eeobKrJkNibPUlFlF9YGWhhgIQ44GsynEfFZXialjDWv1fs2tZpiaVkId2yGXmiaXqpQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicqlJOiaWkVgf5eeobKrJkNibPUlFlF9YGWhhgIQ44GsynEfFZXialjDWv1fs2tZpiaVkId2yGXmiaXqpQ/640?wx_fmt=png&amp;from=appmsg"></p><span>❞</span></blockquote><p><span>「从(<span>单细胞</span>)转录组数据中评估细胞因子活性、免疫细胞极化和细胞间通讯。」</span></p><p><img data-croporisrc="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicqlJOiaWkVgf5eeobKrJkNibcDhnu5ichfvwtOr9v6QXYC5mJQajiaUejX4EAO9Uj03objQxvkPicjQicw/0?wx_fmt=png&amp;from=appmsg" data-cropx1="0" data-cropx2="589" data-cropy1="16.768683274021353" data-cropy2="511.44483985765123" data-imgfileid="100039945" data-ratio="0.8404074702886248" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/iaRJcrq2LosicqlJOiaWkVgf5eeobKrJkNibbTujFFXK4EmSfAvicY96OhclicYMRTczRxWcP5IdwjAxeaow9jiaI6AJg/640?wx_fmt=jpeg" data-type="jpeg" data-w="589" src="https://mmbiz.qpic.cn/mmbiz_jpg/iaRJcrq2LosicqlJOiaWkVgf5eeobKrJkNibbTujFFXK4EmSfAvicY96OhclicYMRTczRxWcP5IdwjAxeaow9jiaI6AJg/640?wx_fmt=jpeg"></p><p><span></span></p><p><span></span></p><p>抗 PD-1 治疗后肿瘤微环境细胞相对于对照组治疗的 IREA 分析示例（基于 scRNA-seq 数据）</p><p><img data-imgfileid="100039947" data-ratio="0.506198347107438" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicqlJOiaWkVgf5eeobKrJkNibKibp6eeiaZRZuBkDxwIiatLicuua5XRkia7657I8JaFBUjKTATlR1tN44dg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="484" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicqlJOiaWkVgf5eeobKrJkNibKibp6eeiaZRZuBkDxwIiatLicuua5XRkia7657I8JaFBUjKTATlR1tN44dg/640?wx_fmt=png&amp;from=appmsg"></p><p>这是慢性病毒性肝炎治疗前后中性粒细胞亚群在干扰素影响下的极化趋势<a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzUzMTEwODk0Ng==&amp;mid=2247522381&amp;idx=1&amp;sn=58598923b99f0ec0961beed994d90de8&amp;chksm=fa455d70cd32d4667ec2b6106f48ac5b0a656cb59d198301f14b72a6d5b8bfdbdac25d7da39b&amp;scene=21#wechat_redirect" textvalue="慢性病毒性肝炎（二）中性粒细胞亚群细分策略" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2">慢性病毒性肝炎（二）中性粒细胞亚群细分策略</a></p><p>我们如何能获得这样的作图数据呢？</p><p>当我们拿到了中性粒细胞的seurat数据后：<br></p><pre><span></span><code>rm(<span>list</span> <span>=</span> ls())<br>source(<span>'scRNA_scripts/lib.R'</span>)<br><br>load(<span>"./check-by-celltype/after_harmony_neu.Rdata"</span>)<br><br><span># 假设数据已加载到Seurat对象中</span><br>seurat_obj <span>&lt;-</span> seuratObj <span># 替换为实际的Seurat对象</span><br><br><span># 选择细胞类型和条件</span><br>Neu_idx <span>&lt;-</span> WhichCells(seurat_obj, <span>expression</span> <span>=</span> celltype <span>==</span> <span>"Neutrophil"</span> <span>&amp;</span> treatment <span>%in%</span> <span>c</span>(<span>"Pre"</span>, <span>"Post"</span>))<br>tmp <span>&lt;-</span> subset(seurat_obj, cells <span>=</span> Neu_idx)<br><br><span># 确保 `tmp` 对象中有 `treatment` 列并将其设置为身份列</span><br>Idents(tmp) <span>&lt;-</span> tmp<span>@</span>meta.data<span>$</span>treatment<br><br><span># 进行差异表达分析</span><br>de_results <span>&lt;-</span> FindMarkers(tmp, ident.1 <span>=</span> <span>"Pre"</span>, ident.2 <span>=</span> <span>"Post"</span>, logfc.threshold <span>=</span> <span>0</span>, min.pct <span>=</span> <span>0</span>)<br><br><span># 筛选差异表达基因</span><br>fde_r <span>&lt;-</span> de_results <span>%&gt;%</span> filter(p_val_adj <span>&lt;</span> <span>0.05</span> <span>&amp;</span> <span>abs</span>(avg_log2FC) <span>&gt;</span> <span>0.05</span>) <span># 根据实际数据调整筛选条件</span><br><br><br><span># 加载polarization state数据框</span><br><span># https://static-content.springer.com/esm/art%3A10.1038%2Fs41586-023-06816-9/MediaObjects/41586_2023_6816_MOESM9_ESM.xlsx</span><br>polardat <span>&lt;-</span> read_xlsx(<span>"./S7.xlsx"</span>,sheet <span>=</span> <span>"Neutrophil"</span>)<br><br><span># ##鼠和人的基因转换</span><br><span># # mouse and human homologue gene conversion was based on the National Center for Biotechnology Information HomoloGene database (release 68)</span><br><span># # 加载biomaRt包</span><br><span># library(biomaRt)</span><br><span># </span><br><span># # 连接到Ensembl数据库</span><br><span># # 尝试使用不同的Ensembl镜像服务器</span><br><span># ensembl &lt;- useEnsembl(biomart = "genes",mirror = "www")</span><br><span># </span><br><span># # 选择小鼠基因数据集</span><br><span># ensembl_mouse &lt;- useDataset("mmusculus_gene_ensembl", mart = ensembl)</span><br><span># </span><br><span># # 选择人类基因数据集</span><br><span># ensembl_human &lt;- useDataset("hsapiens_gene_ensembl", mart = ensembl)</span><br><span># </span><br><span># # 示例小鼠基因列表</span><br><span># mouse_genes &lt;- polardat$Gene</span><br><span># </span><br><span># # 获取小鼠基因对应的人类基因</span><br><span># mouse_to_human &lt;- getLDS(attributes = c("mgi_symbol"), </span><br><span>#                          filters = "mgi_symbol", </span><br><span>#                          values = mouse_genes, </span><br><span>#                          mart = ensembl_mouse, </span><br><span>#                          attributesL = c("hgnc_symbol"), </span><br><span>#                          martL = ensembl_human)</span><br><span># </span><br><span># </span><br><span># # 提取转换后的人类基因列表</span><br><span># human_genes &lt;- mouse_to_human$HGNC.symbol</span><br><br><br><span>##简单粗暴的方法</span><br>polardat<span>$</span>GENE <span>&lt;-</span> toupper(polardat<span>$</span>Gene)<br><br>fde_r <span>&lt;-</span> fde_r <span>%&gt;%</span> mutate(polarization<span>=</span>polardat<span>$</span>Polarization[match(rownames(.),polardat<span>$</span>GENE)]) <span>%&gt;%</span> <br>  mutate(polarscore<span>=</span>polardat<span>$</span>Pct_polarstate[match(rownames(.),polardat<span>$</span>GENE)]) <span>%&gt;%</span> <br>  na.omit()<br><br><span>##</span><br>radat <span>&lt;-</span> fde_r <span>%&gt;%</span> dplyr<span>::</span>select(,<span>c</span>(<span>"polarization"</span>,<span>"polarscore"</span>)) <span>%&gt;%</span> <br>  mutate(gene<span>=</span>rownames(.)) <br><span>##后续挑出干扰素相关基因作图</span><br></code></pre></section><p><br></p><p><mp-style-type data-value="10000"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/pD3dKVYbDJjv4_W0Xtzy8w",target="_blank" rel="noopener noreferrer">原文链接</a>
