---
title: "作者仅提供了fpkm格式表达量矩阵的转录组测序数据集该如何重新分析呢"
date: 2024-06-07T00:17:46Z
draft: ["false"]
tags: [
  "fetched",
  "生信技能树"
]
categories: ["Acdemic"]
---
作者仅提供了fpkm格式表达量矩阵的转录组测序数据集该如何重新分析呢 by 生信技能树
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><blockquote data-tool="mdnice编辑器"><span></span><p>一个2021的糖尿病转录组文章：《Altered human alveolar bone gene expression in type 2 diabetes—A cross-sectional study》，在线链接是：https://onlinelibrary.wiley.com/doi/abs/10.1111/jre.12947</p></blockquote><p data-tool="mdnice编辑器">研究者们在GEO数据库是有数据分享：https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE182923</p><ul data-tool="mdnice编辑器"><li><section>RNA samples were further purified using ribosomal RNA depletion technique and processed for RNA sequencing and analysis.</section></li><li><section><strong>Expression levels for mRNAs were performed by calculating FPKM ([total_exon_fragments/mapped reads (millions) × exon length (kB)]),</strong></section></li><li><section>最后是差异分析后确定统计学阈值：differentially expressed mRNAs were selected with log2 (fold change) &gt;1 or log2 (fold change) ≤1 and with a parametric <em>F</em> test comparing nested linear models.</section></li></ul><p data-tool="mdnice编辑器">可以看到的是作者给出来的是57.5 Mb 的矩阵文件 ：</p><pre data-tool="mdnice编辑器"><span></span><code>GSE182923_genes_fpkm_expression.txt.gz<br></code></pre><p data-tool="mdnice编辑器">转录组测序数据的表达量矩阵可以有多种格式，每种格式都有其特定的用途和优势。以下是一些常见的格式：</p><ol data-tool="mdnice编辑器"><li><section><strong>计数矩阵（Count Matrix）</strong>：</section></li></ol><ul><li><section>这是最基本的格式，通常由比对到参考基因组的读段生成。</section></li><li><section>每一行代表一个基因或转录本，每一列代表一个样本。</section></li><li><section>单元格中的值表示该基因在该样本中的读段计数。</section></li></ul><li><section><strong>FPKM/FPKM-UQ（每千个碱基每百万片段的比率/未量化的FPKM）</strong>：</section></li><ul><li><section>FPKM是标准化的表达量指标，考虑了基因长度和测序深度。</section></li><li><section>FPKM-UQ是未量化的FPKM，它没有经过标准化处理，通常用于避免引入人为的表达量变化。</section></li></ul><li><section><strong>TPM（每千个转录本每百万片段的比率）</strong>：</section></li><ul><li><section>TPM是另一种标准化的表达量指标，它考虑了样本中的总转录本数。</section></li><li><section>TPM使得不同样本间的基因表达量可比。</section></li></ul><li><section><strong>CPM（每百万计数的比率）</strong>：</section></li><ul><li><section>CPM是一种简单的标准化方法，将计数除以样本的总计数乘以百万。</section></li><li><section>它用于归一化数据，使得不同样本间的表达量可比。</section></li></ul><li><section><strong>RSEM/Cufflinks输出</strong>：</section></li><ul><li><section>RSEM（RNA-Seq by Expectation-Maximization）和Cufflinks是两种软件工具，它们提供了一种估计基因和转录本表达量的方法。</section></li><li><section>输出通常包括每个基因的估计表达量（如FPKM）、表达量的不确定性和统计评估。</section></li></ul><li><section><strong>Salmon输出</strong>：</section></li><ul><li><section>Salmon是一种用于RNA-Seq数据的无需比对的定量工具，它使用轻量级比对和EM算法来估计表达量。</section></li><li><section>输出通常包括每个转录本的TPM和预期计数（expected count）。</section></li></ul><p data-tool="mdnice编辑器"><span><strong>我们通常是针对转录组测序使用DESeq2/edgeR进行差异分析，而DESeq2/edgeR要求的输入数据是计数矩阵（raw Count Matrix）格式，</strong></span>作者并没有提供，而且我们不可能依据作者提供的FPKM矩阵去反推出来原始的计数矩阵（raw Count Matrix）。</p><p data-tool="mdnice编辑器">这里我们推荐：https://www.ncbi.nlm.nih.gov/geo/geo2r/?acc=GSE182923</p><p data-tool="mdnice编辑器">而且这个geo2r网页工具还贴心的给出来了代码，如下所示：</p><pre data-tool="mdnice编辑器"><span></span><code><span># Version info: R 4.2.2, Biobase 2.58.0, GEOquery 2.66.0, limma 3.54.0</span><br><span>################################################################</span><br><span>#   Data plots for selected GEO samples</span><br><br><span># load counts table from GEO</span><br>urld &lt;- <span>"https://www.ncbi.nlm.nih.gov/geo/download/?format=file&amp;type=rnaseq_counts"</span><br>path &lt;- paste(urld, <span>"acc=GSE182923"</span>, <span>"file=GSE182923_raw_counts_GRCh38.p13_NCBI.tsv.gz"</span>, sep=<span>"&amp;"</span>);<br>tbl &lt;- as.matrix(data.table::fread(path, header=<span>T</span>, colClasses=<span>"integer"</span>), rownames=<span>1</span>)<br><br><span># pre-filter low count genes</span><br><span># keep genes with at least 2 counts &gt; 10</span><br>keep &lt;- rowSums( tbl &gt;= <span>10</span> ) &gt;= <span>2</span><br>tbl &lt;- tbl[keep, ]<br><br><span># log transform raw counts</span><br><span># instead of raw counts can display vst(as.matrix(tbl)) i.e. variance stabilized counts</span><br>dat &lt;- log10(tbl + <span>1</span>)<br><br><span># box-and-whisker plot</span><br>par(mar=c(<span>7</span>,<span>4</span>,<span>2</span>,<span>1</span>))<br>boxplot(dat, boxwex=<span>0.7</span>, notch=<span>T</span>, main=<span>"GSE182923"</span>, ylab=<span>"lg(cnt + 1)"</span>, outline=<span>F</span>, las=<span>2</span>)<br><br><span># UMAP plot (dimensionality reduction)</span><br><span>library</span>(umap)<br>dat &lt;- dat[!duplicated(dat), ] <span># first remove duplicates</span><br>ump &lt;- umap(t(dat), n_neighbors = <span>5</span>, random_state = <span>123</span>)<br>plot(ump$layout, main=<span>"GSE182923 UMAP plot, nbrs =5"</span>, xlab=<span>""</span>, ylab=<span>""</span>, pch=<span>20</span>, cex=<span>1.5</span>)<br><span>library</span>(car)<br>pointLabel(ump$layout, labels = rownames(ump$layout), method=<span>"SANN"</span>, cex=<span>0.6</span>)<br><br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span>值得注意的是表达量矩阵并不是每个样品会被纳入</span><span></span></h3><p data-tool="mdnice编辑器">可以看到的是作者虽然是 Cross-sectional, no replicates, 10 healthy, 8 diabetic，但是geo2r仅仅是纳入了4个疾病和7个对照哦，我推测应该是这个数据集的测序质量很差，有一些样品不满足前面的转录组定量要求就被暴力删除了，其实也是合理的选择样品 ：</p><p><img data-galleryid="" data-imgfileid="100047444" data-ratio="1.037962962962963" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wwrelMUfxPtpza7zYUiblFtajcszOrmClt3oIYoWvGBlBMU93FNQQcLqKiarQthxPAx2420JdicnbV4Q/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wwrelMUfxPtpza7zYUiblFtajcszOrmClt3oIYoWvGBlBMU93FNQQcLqKiarQthxPAx2420JdicnbV4Q/640?wx_fmt=png&amp;from=appmsg"></p><figure data-tool="mdnice编辑器"><figcaption>不满足前面的转录组定量要求就被暴力删除了</figcaption></figure><p data-tool="mdnice编辑器">当然了，就算是我们拿到了DESeq2/edgeR要求的输入数据是计数矩阵（raw Count Matrix）格式的文件，做后面的差异分析也很难，因为文章自己就一个很垃圾的差异分析结果，如下所示：</p><p><img data-galleryid="" data-imgfileid="100047446" data-ratio="0.8490740740740741" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wwrelMUfxPtpza7zYUiblFtauoic9Gfibk2Pia3ZZ773rOxe7XkSfZ0DUs1s9QQxr1nVYPicAORNcUTftg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wwrelMUfxPtpza7zYUiblFtauoic9Gfibk2Pia3ZZ773rOxe7XkSfZ0DUs1s9QQxr1nVYPicAORNcUTftg/640?wx_fmt=png&amp;from=appmsg"></p><figure data-tool="mdnice编辑器"><figcaption>很垃圾的差异分析结果</figcaption></figure><h3 data-tool="mdnice编辑器"><span></span><span>GEO数据库的任意转录组测序数据集均可获得count矩阵</span><span></span></h3><p data-tool="mdnice编辑器">虽然说上面的案例（糖尿病数据集GSE182923）是因为作者自己的原因导致我们虽然是获得count矩阵但是差异分析结果也丑爆了。但是这个解决方案是 通用的， 理论上GEO数据库的任意转录组测序数据集均可获得count矩阵。比如这个GSE148241-先兆子痫-数据集，是 placentae from 9 patients with early-onset severe preeclampsia (EOSPE) and 32 normal controls, 同样的方式获取count矩阵和分组信息 ：</p><pre data-tool="mdnice编辑器"><span></span><code><span># load counts table from GEO</span><br>urld &lt;- <span>"https://www.ncbi.nlm.nih.gov/geo/download/?format=file&amp;type=rnaseq_counts"</span><br>path &lt;- paste(urld, <span>"acc=GSE148241"</span>, <span>"file=GSE148241_raw_counts_GRCh38.p13_NCBI.tsv.gz"</span>, sep=<span>"&amp;"</span>);<br>path<br>tbl &lt;- as.matrix(data.table::fread(path, header=<span>T</span>, colClasses=<span>"integer"</span>), rownames=<span>1</span>)<br><br><span># data&lt;-data.table::fread("matrix.txt",</span><br><span>#                         data.table = F)</span><br>dim(tbl)<br>mat=as.data.frame(tbl) <br><span>library</span>(AnnoProbe)<br><span>library</span>(GEOquery) <br>gset = getGEO(<span>"GSE148241"</span>, destdir = <span>'.'</span>, getGPL = <span>F</span>) <br>pd = pData(gset[[<span>1</span>]]) <br>table(group_list)<br>group_list=ifelse(grepl(<span>'Normal'</span>,pd$source_name_ch1),<br>                        <span>'control'</span>,<span>'case'</span> )<br><br></code></pre><p data-tool="mdnice编辑器">就可以常规的差异分析，如下所示的火山图和热图：</p><p><img data-galleryid="" data-imgfileid="100047445" data-ratio="0.43333333333333335" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wwrelMUfxPtpza7zYUiblFtasSqPoeicKjQ7VRhzh8Y9605hwFePEzNbCQPq7Hy5PQ06TYRZQWowACg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wwrelMUfxPtpza7zYUiblFtasSqPoeicKjQ7VRhzh8Y9605hwFePEzNbCQPq7Hy5PQ06TYRZQWowACg/640?wx_fmt=png&amp;from=appmsg"></p><figure data-tool="mdnice编辑器"><figcaption>火山图和热图</figcaption></figure><p data-tool="mdnice编辑器">可以看到有两个样品是离群点， 其实这个GSE148241-先兆子痫-数据集页面也指出来了，<strong>但是数据集配套的文献并没有关心这个差异分析结果，反而是做了一个wgcna分析。如果你恰好是先兆子痫研究方向， 就可以把这个数据集更加细致的解读和挖掘一下，未必不是一个课题哦！</strong></p></section><h3 data-tool="mdnice编辑器">写在文末</h3><p data-tool="mdnice编辑器"><span>我在《</span>生信技能树<span>》，《生信菜鸟团》，《单细胞天地》的大量推文教程里面共享的代码都是复制粘贴即可使用的， </span><span><strong>有任何疑问欢迎留言讨论，也可以发邮件给我，详细描述你遇到的困难的前因后果给我，我的邮箱地址是 jmzeng1314@163.com</strong></span></p><p data-tool="mdnice编辑器">如果你确实觉得我的教程对你的科研课题有帮助，让你茅塞顿开，或者说你的课题大量使用我的技能，烦请日后在发表自己的成果的时候，加上一个简短的致谢，如下所示：</p><pre data-tool="mdnice编辑器"><span data-lazy-bgimg="https://mmbiz.qpic.cn/mmbiz_svg/GqIlejFTbNjwekMlGTsw0UdJEGMZheib7tFsVlfZwvFrSH5OIQEwKvRlPsu7tuHAEBibwBnOJbb0m7ibibx8vef24fOnFVpwlFicp/640?wx_fmt=svg" data-fail="0"></span><code>We thank Dr.Jianming Zeng(University of Macau), and all the members of his bioinformatics team, biotrainee, <span>for</span> generously sharing their experience and codes.<br></code></pre><p data-tool="mdnice编辑器">十年后我环游世界各地的高校以及科研院所（当然包括中国大陆）的时候，如果有这样的情谊，我会优先见你。</p><p><br></p><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/XrgUnJLlT1o15p_Wz2UVBA",target="_blank" rel="noopener noreferrer">原文链接</a>
