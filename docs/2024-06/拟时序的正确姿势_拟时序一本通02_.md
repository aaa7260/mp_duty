---
title: "拟时序的正确姿势（拟时序一本通02）"
date: 2024-06-13T05:37:09Z
draft: ["false"]
tags: [
  "fetched",
  "生信技能树"
]
categories: ["Acdemic"]
---
拟时序的正确姿势（拟时序一本通02） by 生信技能树
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><blockquote data-tool="mdnice编辑器"><span></span><p>前面我们在 <a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247528633&amp;idx=1&amp;sn=4a0b154bdc8ac4797c3d00f08f0eeeab&amp;scene=21#wechat_redirect" data-linktype="2">为什么做拟时序</a> 提到了其实可以把拟时序分析简化成为了主要是为了展示差异细节，比如CD14和CD16的两种单核细胞的差异细节，或者说说CD56和CD16这两种NK细胞的差异细节。</p></blockquote><p data-tool="mdnice编辑器">也就是说，我们做拟时序之前通常是要细分亚群到足够深入，需要确定被做拟时序分析的对象是有比较大生物学变化的可能性。但是也有很多文章在使用拟时序分析的时候其实忽略这个前提，就显得很“可笑”，接下来<strong>我们就用3个案例来说明一下拟时序的正确姿势，错误示范，还有创新型的应用场景。</strong></p><h3 data-tool="mdnice编辑器"><span></span><span>首先是正确的拟时序应用</span><span></span></h3><p data-tool="mdnice编辑器">可以看 2024发表在《Hepatology Communications.》杂志的单细胞转录组数据挖掘文章：《Single-cell landscape identifies the immunophenotypes and microenvironments of HBV-positive and HBV-negative  liver cancer》，文章做完了第一层次降维聚类分群后，再次提取里面的T细胞进行细分亚群就有CD4,CD8等完全不一样的子集，然后是针对CD8这个t细胞亚群继续细分成为了两个亚群，如下所示的GZMH高表达的效应（毒性）T细胞和PDCD1高表达的耗竭T细胞，在(D) T-SNE 可以看到两个亚群是有很清晰的界限的，所以在(E). Dot plot 可以看到这两个亚群的差异基因的可视化情况。但是前面我们在 <a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247528633&amp;idx=1&amp;sn=4a0b154bdc8ac4797c3d00f08f0eeeab&amp;scene=21#wechat_redirect" data-linktype="2">为什么做拟时序</a> 提到了其实可以把拟时序分析简化成为了主要是为了展示差异细节，这个文章里面也是如此，就有了图(F)的monocle2的拟时序结果，因为我们关心的是GZMH高表达的效应（毒性）T细胞和PDCD1高表达的耗竭T细胞两者的变迁关系，所以作者依据monocle2的拟时序结果把两个细胞亚群的具体的细胞排序后就可以展示了cytotoxic genes or exhausted genes</p><p><img data-galleryid="" data-imgfileid="100044987" data-ratio="0.6025943396226415" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wwVfibwul1PM4f0NDrt4X5giaUDib2AISGqMU9Vjqibxul0ptY7TCVmZE76jkwVb1SArJyQ4wm3Fgr4lw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1696" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wwVfibwul1PM4f0NDrt4X5giaUDib2AISGqMU9Vjqibxul0ptY7TCVmZE76jkwVb1SArJyQ4wm3Fgr4lw/640?wx_fmt=png&amp;from=appmsg"></p><figure data-tool="mdnice编辑器"><figcaption>GZMH高表达的效应（毒性）T细胞和PDCD1高表达的耗竭T细胞两者的变迁关系</figcaption></figure><p data-tool="mdnice编辑器">图例是：</p><ul data-tool="mdnice编辑器"><li><section>(D) T-SNE plot showing the annotation and color codes for two CD8+ T cell subclusters.</section></li><li><section>(E). Dot plot showing the expression of canonically expressed genes in two subclusters.</section></li><li><section>(F) Pseudotime-ordered analysis of CD8+ T cells from HBV+ HCC and HBV− samples. CD8+ T cell subtypes are labeled by colors.</section></li><li><section>(G) Heat map showing the dynamic of cytotoxic genes or exhausted genes</section></li></ul><p data-tool="mdnice编辑器">非常清晰明了，这个完整的数据分析我们在 <a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247528633&amp;idx=1&amp;sn=4a0b154bdc8ac4797c3d00f08f0eeeab&amp;scene=21#wechat_redirect" data-linktype="2">为什么做拟时序</a> 演示了一个简化版，后面也会继续更新完整版！</p><h3 data-tool="mdnice编辑器"><span></span><span>错误的拟时序分析例子</span><span></span></h3><p data-tool="mdnice编辑器">2024发表在《<em>Journal of Cancer</em> 》杂志的文章：《Integrated Bulk and Single-cell RNA Sequencing Data Constructs and Validates a Prognostic Model for Non-small Cell Lung Cancer》，文献进行了第一层次降维聚类分群后，并没有然后的生物学背景，就一股脑的把全部的肺癌肿瘤微环境里面的免疫细胞和间质细胞都拿去了拟时序，如下所示：</p><p><img data-galleryid="" data-imgfileid="100044988" data-ratio="1.0672963400236128" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wwVfibwul1PM4f0NDrt4X5giaBLB5BEgW4JGbia6INicv1wDwJ2FmHfwUQBCS9khbEoBqFS3QgMk1VSSg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1694" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wwVfibwul1PM4f0NDrt4X5giaBLB5BEgW4JGbia6INicv1wDwJ2FmHfwUQBCS9khbEoBqFS3QgMk1VSSg/640?wx_fmt=png&amp;from=appmsg"></p><figure data-tool="mdnice编辑器"><figcaption>全部的肺癌肿瘤微环境里面的免疫细胞和间质细胞都拿去了拟时序</figcaption></figure><p data-tool="mdnice编辑器">这样其实完全得不出什么结论，在肿瘤里面免疫细胞又不可能变迁成为恶性的上皮肿瘤细胞，就算是拿到了算法层面的每个细胞的拟时序分析后产生的  Pseudotime 和State，也很难去做生物学描述。</p><h3 data-tool="mdnice编辑器"><span></span><span>一些拟时序创新</span><span></span></h3><p data-tool="mdnice编辑器">因为单细胞转录组数据的流行才让大家都认识到了这个拟时序分析可以展示差异分析的细节，但其实展现 差异分析细节这个需求在单细胞之前就存在。只不过呢，我们常规的bulk转录组通常是少量的有限的三五个组别，每个组就三五个样品，所以差异分析拿到了变化倍数和统计学指标就足够了，后面主要是针对差异基因集去做各种生物学功能富集去编造生物学故事啦。但是，TCGA或者GTEX等计划里面的常规的bulk转录组样品数量其实已经是成百上千了，我们的单细胞转录组的各个亚群其实里面也就是成百上千个细胞，两者从表达量矩阵格式来说并没有本质区别，都是可以走拟时序分析算法的。</p><p data-tool="mdnice编辑器">比如2021的文章：《Preoperative immune landscape predisposes adverse outcomes in hepatocellular carcinoma patients with liver transplantation》就是一千多个样品，它们的两万多个基因构成了一个表达量矩阵，但是文章作者仅仅是关心那些5000个表达量比较高的蛋白质编码基因，然后就做了拟时序分析：</p><p><img data-galleryid="" data-imgfileid="100044990" data-ratio="0.5662824207492796" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wwVfibwul1PM4f0NDrt4X5gia8HdjwCIxEl0zgXc4y8dZrqXySdibhgJETgmsXiciaDmEQXUxpygLxKagw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1388" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wwVfibwul1PM4f0NDrt4X5gia8HdjwCIxEl0zgXc4y8dZrqXySdibhgJETgmsXiciaDmEQXUxpygLxKagw/640?wx_fmt=png&amp;from=appmsg"></p><figure data-tool="mdnice编辑器"><figcaption>拟时序分析</figcaption></figure><p data-tool="mdnice编辑器">其实就是肿瘤样品可以区分成为两个分子分型，上面的图例是 ：</p><ul data-tool="mdnice编辑器"><li><section>b t-SNE analysis using the 5000 most highly expressed protein-coding genes in the meta-dataset (n = 1179).</section></li><li><section>c Trajectory analysis of Korean HCC using Monocle 2.</section></li></ul><p data-tool="mdnice编辑器">而且可以很清晰的看到正常的乳腺组织跟两个分子分型的肿瘤样品的差异细节：</p><p><img data-galleryid="" data-imgfileid="100044989" data-ratio="0.6014234875444839" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wwVfibwul1PM4f0NDrt4X5giazGedrPOMfIEZdJ4EZasjqFU0H5wDGB6mZhGOibuRibK1s3gERCibiae6Hw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1124" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wwVfibwul1PM4f0NDrt4X5giazGedrPOMfIEZdJ4EZasjqFU0H5wDGB6mZhGOibuRibK1s3gERCibiae6Hw/640?wx_fmt=png&amp;from=appmsg"></p><figure data-tool="mdnice编辑器"><figcaption>差异细节</figcaption></figure><p data-tool="mdnice编辑器">值得一提的是拟时序一本通专辑的目录是：</p><ul data-tool="mdnice编辑器"><li><section><a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247528633&amp;idx=1&amp;sn=4a0b154bdc8ac4797c3d00f08f0eeeab&amp;scene=21#wechat_redirect" data-linktype="2">为什么做拟时序</a> （展示差异细节）</section></li><li><section>拟时序的正确姿势，错误示范，创新型拟时序</section></li><li><section>拟时序的多种算法大比拼</section></li><li><section>monocle2拟时序实战</section></li><ul><li><section>降维聚类分群</section></li><li><section>拟时序</section></li><li><section>多种基础可视化</section></li><li><section>正向特殊可视化（目标基因表达量，基因集打分）</section></li><li><section>反方向特殊可视化（5种可视化）</section></li></ul><li><section>monocle3拟时序实战</section></li><li><section>SCORPIUS实战</section></li><li><section>Slingshot实战</section></li><li><section>基于其它编程语言的拟时序分析</section></li></ul><p data-tool="mdnice编辑器">然而，本人的理解肯定是片面的，希望通过这10个推文的指引能让大家对单细胞转录组的明星分析方法拟时序有一个基础的认知。也欢迎大家提出来自己的不同的看法，或者自己对拟时序的疑惑之处，欢迎留言参与讨论哦！</p></section><p><br></p><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/QWWHbGy4QskucR4a7vVAQg",target="_blank" rel="noopener noreferrer">原文链接</a>
