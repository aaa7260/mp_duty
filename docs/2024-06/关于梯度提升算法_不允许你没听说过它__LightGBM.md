---
title: "关于梯度提升算法，不允许你没听说过它——LightGBM"
date: 2024-06-18T10:49:26Z
draft: ["false"]
tags: [
  "fetched",
  "生信滩"
]
categories: ["Acdemic"]
---
关于梯度提升算法，不允许你没听说过它——LightGBM by 生信滩
------
<div><section><section powered-by="xiumi.us"><section><p><img data-galleryid="" data-imgfileid="100008014" data-ratio="0.2222222222222222" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/YHGRXkSxjSRvhAzztUiaKYKYRIqQEWXNoxXibsZRcJjicibDicCibYA7y5icMRcZgx2SdN2kLyRrksNrj1aFrfQFcB9sw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/YHGRXkSxjSRvhAzztUiaKYKYRIqQEWXNoxXibsZRcJjicibDicCibYA7y5icMRcZgx2SdN2kLyRrksNrj1aFrfQFcB9sw/640?wx_fmt=png&amp;from=appmsg"></p><section powered-by="xiumi.us"><br></section></section><p>家人们大家好啊，我还是那个大海哥，今天大海哥要给大家介绍一个好东西！一个在机器学习领域崭露头角的超强算法，它就是LightGBM！如果你对机器学习、数据科学感兴趣，或者正在寻找一个高效、强大的工具来解决你的问题，那么一定要继续往下看。</p><p><br></p><p>LightGBM是一款由微软亚洲研究院开发的机器学习算法，它的出现彻底改变了机器学习的游戏规则。为什么呢？因为它有一系列超级厉害的特点，让它在处理大规模数据集和高维特征的问题时游刃有余。首先，LightGBM采用了一种基于直方图的学习策略，这意味着它会将数据集分成多个直方图，并在每个直方图上训练树模型。这不仅降低了内存消耗，还大幅提升了训练速度。想象一下，你可以在短短几秒钟内处理上百万行数据，这是不是让你觉得机器学习变得不再那么可怕了呢？其次，LightGBM支持分类和回归两种任务。还有，LightGBM在并行计算和GPU加速方面表现出色，这意味着你可以充分利用多核CPU和强大的GPU来训练模型，进一步提高效率。当然了，超参数优化也是必不可少的一部分。最重要的是，LightGBM是一个开源项目，可以在多种编程语言中使用，包括Python、R和C++。</p><p><br></p><p>说了那么多，你应该大概了解这是一个什么东西了！那么让我们开始吧！</p><p>library(lightgbm)</p><p>library(data.table)</p></section><section powered-by="xiumi.us"><section><ul><li><li><li><li><li></ul><pre data-lang="r"><code><span><span>#安装一个R包，大海哥今天的数据集就靠它了</span></span></code><code><span>install.packages(<span>"ISLR2"</span>)</span></code><code><span>data(<span>"Boston"</span>,package = <span>"ISLR2"</span>)</span></code><code><span>Boston_matrix &lt;- data.matrix(Boston)</span></code><code><span><span>#看一下数据长什么样子</span></span></code></pre></section></section><section powered-by="xiumi.us"><section><img data-ratio="0.34615384615384615" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/YHGRXkSxjST7OJ4oicQJNxwca3ISQxPCRtgdfV81YHAafuYKp1qZf84icZM7dX9Y2JKEShd0G5uDF2ZicmjbP70bg/640?wx_fmt=png" data-type="png" data-w="702" src="https://mmbiz.qpic.cn/mmbiz_png/YHGRXkSxjST7OJ4oicQJNxwca3ISQxPCRtgdfV81YHAafuYKp1qZf84icZM7dX9Y2JKEShd0G5uDF2ZicmjbP70bg/640?wx_fmt=png"></section></section><section powered-by="xiumi.us"><section><ul><li><li><li><li><li><li><li><li><li></ul><pre data-lang="r"><code><span><span>#这是一个数值矩阵数据，最后一个medv就是我们的目标向量</span></span></code><code><span><span>#来划分数据集啦！</span></span></code><code><span>set.seed(<span>123</span>)</span></code><code><span>train_index &lt;- sample(<span>1</span>:nrow(Boston_matrix), <span>0.7</span> * nrow(Boston_matrix))</span></code><code><span>train_data &lt;- Boston_matrix[train_index, ]</span></code><code><span>test_data &lt;- Boston_matrix[-train_index, ]</span></code><code><span><span>#lightGBM算法需要特定的数据格式</span></span></code><code><span>train_data_lgb &lt;- lgb.Dataset(data = as.matrix(train_data[, -ncol(train_data)]), label = train_data[,<span>13</span>])</span></code><code><span><span>#看看这是个啥格式</span></span></code></pre></section></section><p powered-by="xiumi.us"><br></p><section powered-by="xiumi.us"><section><img data-ratio="0.6173410404624278" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/YHGRXkSxjST7OJ4oicQJNxwca3ISQxPCR2grpmKqRNJQ8GD6piavDb2wWPfSialYRUiboI0fh7ptVtyO4IjL05sdwA/640?wx_fmt=png" data-type="png" data-w="865" src="https://mmbiz.qpic.cn/mmbiz_png/YHGRXkSxjST7OJ4oicQJNxwca3ISQxPCR2grpmKqRNJQ8GD6piavDb2wWPfSialYRUiboI0fh7ptVtyO4IjL05sdwA/640?wx_fmt=png"></section></section><section powered-by="xiumi.us"><section><ul><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="r"><code><span>test_data_lgb &lt;- lgb.Dataset(data = as.matrix(test_data[, -ncol(test_data)]), label = test_data[,<span>13</span>])</span></code><code><span>fit &lt;- lgb.train(</span></code><code><span>  params = <span>list</span>(learning_rate=<span>0.1</span>,  <span># 学习率         </span></span></code><code><span>                objective=<span>"regression"</span>),  <span># 模型类型        </span></span></code><code><span>  data=dtrain,   <span># 数据集       </span></span></code><code><span>  verbose = -<span>1</span>,  <span># 不显示模型迭代过程      </span></span></code><code><span>  nrounds = <span>200</span>  <span>#迭代次数</span></span></code><code><span>)  </span></code><code><span><span># 预测</span></span></code><code><span>lgb_pred &lt;- predict(fit,data = data.matrix(test_data[,-<span>13</span>]))         </span></code><code><span>head(lgb_pred)</span></code></pre></section></section><section powered-by="xiumi.us"><section><img data-ratio="0.10820895522388059" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/YHGRXkSxjST7OJ4oicQJNxwca3ISQxPCRm7ibsATBurMsicFj13vflzw3KqdiaPwSSGmqzJmzNSnGMxgYkUtmgwvkA/640?wx_fmt=png" data-type="png" data-w="536" src="https://mmbiz.qpic.cn/mmbiz_png/YHGRXkSxjST7OJ4oicQJNxwca3ISQxPCRm7ibsATBurMsicFj13vflzw3KqdiaPwSSGmqzJmzNSnGMxgYkUtmgwvkA/640?wx_fmt=png"></section></section><section powered-by="xiumi.us"><section><ul><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="r"><code><span><span>#预测结果出来啦，我们来看看和真实值有多大差异</span></span></code><code><span>library(dplyr)</span></code><code><span>library(ggplot2)</span></code><code><span>library(tune)</span></code><code><span><span># 整合预测值和真实值</span></span></code><code><span>lgb_res &lt;- bind_cols(truevalue=test_data[,<span>13</span>],estimator=lgb_pred)</span></code><code><span><br></span></code><code><span>ggplot(lgb_res,mapping=aes(truevalue,estimator))+</span></code><code><span>  geom_point(alpha=<span>0.3</span>,size=<span>2</span>)+</span></code><code><span>  geom_abline(intercept=<span>0</span>,slope=<span>1</span>,col=<span>"red"</span>)+</span></code><code><span>   labs(x = <span>"observed"</span>, y = <span>"predicted"</span>) +</span></code><code><span>  coord_obs_pred()</span></code></pre></section></section><section powered-by="xiumi.us"><section><img data-ratio="0.9370314842578711" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/YHGRXkSxjST7OJ4oicQJNxwca3ISQxPCR8ibHGR9nvyt1I104ZHZEiaZyXU4iacWzDuAJkibu7j89icKzOE5Mgh5MIPw/640?wx_fmt=png" data-type="png" data-w="667" src="https://mmbiz.qpic.cn/mmbiz_png/YHGRXkSxjST7OJ4oicQJNxwca3ISQxPCR8ibHGR9nvyt1I104ZHZEiaZyXU4iacWzDuAJkibu7j89icKzOE5Mgh5MIPw/640?wx_fmt=png"></section></section><p powered-by="xiumi.us"><br></p><section powered-by="xiumi.us"><section><ul><li><li><li><li><li><li><li><li><li></ul><pre data-lang="r"><code><span><span>#模型解释</span></span></code><code><span>library(DALEX)</span></code><code><span>library(DALEXtra)</span></code><code><span><span># 构建模型解释器</span></span></code><code><span>exp &lt;- DALEXtra::explain_tidymodels(fit,</span></code><code><span>                                    Boston_matrix[,-<span>13</span>],</span></code><code><span>                                    y=Boston_matrix[,<span>13</span>],</span></code><code><span>                                    label = <span>"LightGBM"</span>)</span></code><code><span><span>#有了这个就很方便了哦</span></span></code></pre></section></section><section powered-by="xiumi.us"><section><img data-ratio="0.29132947976878615" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/YHGRXkSxjST7OJ4oicQJNxwca3ISQxPCR9tPIhpQOAB67uqfqykVsET5noON8QgTE69qczvQH3YDVMaTiaqDMJqA/640?wx_fmt=png" data-type="png" data-w="865" src="https://mmbiz.qpic.cn/mmbiz_png/YHGRXkSxjST7OJ4oicQJNxwca3ISQxPCR9tPIhpQOAB67uqfqykVsET5noON8QgTE69qczvQH3YDVMaTiaqDMJqA/640?wx_fmt=png"></section></section><p powered-by="xiumi.us"><br></p><section powered-by="xiumi.us"><section><ul><li><li><li><li></ul><pre data-lang="r"><code><span><span>#可以随便查看模型的多种评价指标</span></span></code><code><span><span>#然后还可以像随机森林一样，看看变量重要性哦！</span></span></code><code><span>lgb_mp &lt;- model_parts(<span>exp</span>)          </span></code><code><span>plot(lgb_mp)</span></code></pre></section></section><section powered-by="xiumi.us"><section><img data-ratio="0.9537223340040242" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/YHGRXkSxjST7OJ4oicQJNxwca3ISQxPCRyjtTxtib2ialk6QTuH2AEz3ibQDXI9d7SUGlibBrpV2ptKbX2thlxbTXWw/640?wx_fmt=png" data-type="png" data-w="497" src="https://mmbiz.qpic.cn/mmbiz_png/YHGRXkSxjST7OJ4oicQJNxwca3ISQxPCRyjtTxtib2ialk6QTuH2AEz3ibQDXI9d7SUGlibBrpV2ptKbX2thlxbTXWw/640?wx_fmt=png"></section></section><section powered-by="xiumi.us"><section><ul><li></ul><pre data-lang="r"><code><span><span>#还可以看看残差的变化情况</span></span></code></pre></section></section><section powered-by="xiumi.us"><section><img data-ratio="0.9273049645390071" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/YHGRXkSxjST7OJ4oicQJNxwca3ISQxPCRcHoFlubhE9jRCGmnTORsOI3Heibz4Pl2cmGXORPFddxeyGn9ZStVjog/640?wx_fmt=png" data-type="png" data-w="564" src="https://mmbiz.qpic.cn/mmbiz_png/YHGRXkSxjST7OJ4oicQJNxwca3ISQxPCRcHoFlubhE9jRCGmnTORsOI3Heibz4Pl2cmGXORPFddxeyGn9ZStVjog/640?wx_fmt=png"></section></section><section powered-by="xiumi.us"><section><ul><li><li></ul><pre data-lang="r"><code><span><span>#不仅如此还有很多可视化方法都可以使用。这里就不一一介绍啦！</span></span></code><code><span><span>#好了这就是今天大海哥想要分享的全部内容啦，不仅可以预测大海哥用到的这种数值型数据，分类数据也是可以的哦！大家慢慢摸索吧，lightGBM可是非常强大的算法哦！它在各种机器学习竞赛和实际应用中都取得了卓越的成绩。所以如果你需要解决分类或回归问题，并且面对大规模数据集，LightGBM是值得考虑的一个强大工具。</span></span></code></pre></section></section><section powered-by="xiumi.us"><p><br></p><p>好了好了，又到了总结时间，经过了大海哥分享的案例分析，我相信你现在可能已经知道如何在你的项目中使用LightGBM了。简单来说就几步，首先需要加载LightGBM库，然后准备好你的数据集，将其转换为LightGBM的数据格式。接着，你可以定义模型参数，训练模型，进行预测，最后评估模型性能。不过，要记住调整参数和数据预处理是关键步骤哦。</p><p><br></p><p>LightGBM是机器学习领域的一颗新星，它以快速、高效、高准确性著称。如果你有大规模的数据集和高维特征，想要快速构建预测模型，那么LightGBM绝对值得一试。希望今天的分享让你对LightGBM有了更深入的了解，有条件的小伙伴们不妨动手试一试，体验一下它的强大之处。大海哥会继续为你带来更多分享，敬请期待哦！</p><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><p>大海哥还提供思路设计、定制生信分析、文献思路复现；有需要的小伙伴欢迎直接扫码咨询~</p></section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><img data-cropselx1="0" data-cropselx2="177" data-cropsely1="0" data-cropsely2="177" data-imgfileid="100010202" data-ratio="0.9973474801061007" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/YHGRXkSxjSQicw3pkyJwFjNBuDYsZOL0kg45dSicgiaibBKJ3sbCq5IqXgFt7c9DmuucV9s07LXWFIoyBPufribs2ibA/640?wx_fmt=png&amp;from=appmsg" data-type="jpeg" data-w="377" src="https://mmbiz.qpic.cn/mmbiz_png/YHGRXkSxjSQicw3pkyJwFjNBuDYsZOL0kg45dSicgiaibBKJ3sbCq5IqXgFt7c9DmuucV9s07LXWFIoyBPufribs2ibA/640?wx_fmt=png&amp;from=appmsg"></section></section></section><section><section powered-by="xiumi.us"><section><p><strong>定制生信分析<br></strong></p><p><strong>服务器租赁</strong></p><p><strong>扫码咨询大海哥</strong></p></section></section></section></section></section></section><p powered-by="xiumi.us"><br></p><section powered-by="xiumi.us"><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzkzMzUwODcwMg==&amp;mid=2247491024&amp;idx=2&amp;sn=d8ccbed93d5e13fd8a885a87cd12231b&amp;chksm=c24a3ee1f53db7f72717fae9c169ffc49e75005f8714185e35fc0864dac2e218e6563ecb3d08&amp;scene=21#wechat_redirect" textvalue="你已选中了添加链接的内容" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="1"><span><img data-imgfileid="100010201" data-ratio="0.29333333333333333" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/YHGRXkSxjSRzichicbEcnU2mvqdp0llrP8YNwNxNKRMdrRvz0oLnZNEMMFCyVfJXeWmtQcJ24EkyyXxgyaYicwn5w/640?wx_fmt=jpeg&amp;from=appmsg" data-type="jpeg" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_jpg/YHGRXkSxjSRzichicbEcnU2mvqdp0llrP8YNwNxNKRMdrRvz0oLnZNEMMFCyVfJXeWmtQcJ24EkyyXxgyaYicwn5w/640?wx_fmt=jpeg&amp;from=appmsg"></span></a></section></section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><p><strong>往期回顾</strong></p></section></section><section powered-by="xiumi.us"><section><svg viewbox="0 0 1 1"></svg></section></section><section powered-by="xiumi.us"><section><svg viewbox="0 0 1 1"></svg></section></section></section><section><section powered-by="xiumi.us"><section><svg viewbox="0 0 1 1"></svg></section></section><section powered-by="xiumi.us"><section><svg viewbox="0 0 1 1"></svg></section></section></section></section><section powered-by="xiumi.us"><section><table width="100%"><tbody><tr opera-tn-ra-comp="_$.pages:0.layers:0.comps:4.classicTable1:0" powered-by="xiumi.us"><td colspan="1" rowspan="1" opera-tn-ra-cell="_$.pages:0.layers:0.comps:4.classicTable1:0.td@@0" width="100.0000%"><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><p><strong>01</strong></p></section></section><section><section powered-by="xiumi.us"><p><span>｜<a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzkzMzUwODcwMg==&amp;mid=2247491024&amp;idx=2&amp;sn=d8ccbed93d5e13fd8a885a87cd12231b&amp;chksm=c24a3ee1f53db7f72717fae9c169ffc49e75005f8714185e35fc0864dac2e218e6563ecb3d08&amp;scene=21#wechat_redirect" textvalue="生信人必备神器——1024G存储的生信服务器，免费试用啦" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2">生信人必备神器——1024G存储的生信服务器，免费试用啦</a></span></p></section></section></section><section powered-by="xiumi.us"><section><svg viewbox="0 0 1 1"></svg></section></section></section></td></tr><tr opera-tn-ra-comp="_$.pages:0.layers:0.comps:4.classicTable1:1" powered-by="xiumi.us"><td colspan="1" rowspan="1" opera-tn-ra-cell="_$.pages:0.layers:0.comps:4.classicTable1:1.td@@0" width="100.0000%"><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><p><strong>02</strong></p></section></section><section><section powered-by="xiumi.us"><p><span>｜<a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzkzMzUwODcwMg==&amp;mid=2247490768&amp;idx=1&amp;sn=f7fa9fe45eb128a9729aaeeb866e37bb&amp;chksm=c24a3fe1f53db6f7f936d8397efb9fd089b412a7b48d53f3a76496eb2122843dd3a349a0065b&amp;scene=21#wechat_redirect" textvalue="【BWMR】孟德尔随机化分析利器，克服分析挑战！" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2">【BWMR】孟德尔随机化分析利器，克服分析挑战！</a></span></p></section></section></section><section powered-by="xiumi.us"><section><svg viewbox="0 0 1 1"></svg></section></section></section></td></tr><tr opera-tn-ra-comp="_$.pages:0.layers:0.comps:4.classicTable1:2" powered-by="xiumi.us"><td colspan="1" rowspan="1" opera-tn-ra-cell="_$.pages:0.layers:0.comps:4.classicTable1:2.td@@0" width="100.0000%"><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><p><strong>03</strong></p></section></section><section><section powered-by="xiumi.us"><p><span>｜<a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzkzMzUwODcwMg==&amp;mid=2247490408&amp;idx=1&amp;sn=ed197d298464c36bc55e010e5005bd82&amp;chksm=c24a3859f53db14f6dac19c3b53824c27b6bcec7f36ff04acc89505970a2749fc2f13acdcc1d&amp;scene=21#wechat_redirect" textvalue="分子对接花了几个小时？批量分子对接帮你5分钟搞定！" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2">分子对接花了几个小时？批量分子对接帮你5分钟搞定！</a></span></p></section></section></section><section powered-by="xiumi.us"><section><svg viewbox="0 0 1 1"></svg></section></section></section></td></tr><tr opera-tn-ra-comp="_$.pages:0.layers:0.comps:4.classicTable1:3" powered-by="xiumi.us"><td colspan="1" rowspan="1" opera-tn-ra-cell="_$.pages:0.layers:0.comps:4.classicTable1:3.td@@0" width="100.0000%"><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><p><strong>04</strong></p></section></section><section><section powered-by="xiumi.us"><p><span>｜<a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzkzMzUwODcwMg==&amp;mid=2247490092&amp;idx=1&amp;sn=60fa51a91ee9882bb37aaa240ac5a63a&amp;chksm=c24a391df53db00bbd05351d9cc70897d6c9e1670d92a0c56283d10aec4ce179f5dedd4338ad&amp;scene=21#wechat_redirect" textvalue="手把手带你复现XGboost和LightGBM机器学习算法特征重要性排名和 SHAP 汇总图" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2">手把手带你复现XGboost和LightGBM机器学习算法特征重要性排名和 SHAP 汇总图</a></span></p></section></section></section><section powered-by="xiumi.us"><section><svg viewbox="0 0 1 1"></svg></section></section></section></td></tr></tbody></table></section></section></section><p><br></p></section></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/qQw7ImJeIFlaft2creeDjg",target="_blank" rel="noopener noreferrer">原文链接</a>
