---
title: "GSE73731数据下载及整理"
date: 2024-06-29T12:31:20Z
draft: ["false"]
tags: [
  "fetched",
  "学R时习之"
]
categories: ["Acdemic"]
---
GSE73731数据下载及整理 by 学R时习之
------
<div><p><code><span>GSE73731</span></code><span>包含 265例ccRCC(肾透明细胞癌)临床样本，文章发表在</span><code><span>PMID: 28779136</span></code><span>。</span><ne-clipboard source="https%3A%2F%2Fwww.yuque.com%2Fgaodashitou%2Ffomdu3%2Fyiwu09lqh124ggmh"></ne-clipboard></p><p><img data-imgfileid="100003486" data-ratio="0.5233082706766917" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/C0nicuvoMeDFxDoTmM0ebmglcXWQuicLsiaeSS6ibwZuP713rPYVbicedWn5DDjxcFwUePa693QrgIibO7GTECdGFHTw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1330" width="665" src="https://mmbiz.qpic.cn/sz_mmbiz_png/C0nicuvoMeDFxDoTmM0ebmglcXWQuicLsiaeSS6ibwZuP713rPYVbicedWn5DDjxcFwUePa693QrgIibO7GTECdGFHTw/640?wx_fmt=png&amp;from=appmsg"></p><h1><span>1 数据下载分析</span></h1><h1><span></span></h1><p><code><span>GSE73731</span></code><span>属于经典的GEO数据集，具体可参考</span><a href="https://mp.weixin.qq.com/s?__biz=MzU4NzcyNDMxOA==&amp;mid=2247487095&amp;idx=1&amp;sn=3a4209fc2baba7e24c698d9f727f86d2&amp;scene=21#wechat_redirect" data-href="https://mp.weixin.qq.com/s?__biz=MzU4NzcyNDMxOA==&amp;mid=2247487095&amp;idx=1&amp;sn=3a4209fc2baba7e24c698d9f727f86d2&amp;scene=21#wechat_redirect" target="_blank" data-linktype="2"><span>GSE22541数据下载及整理</span></a><span>。</span></p><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><pre data-tool="mdnice编辑器"><span></span><code><br><span># GSE73731 进行分析</span><br>rm(list = ls())<br>librarian::shelf(tidyverse, GEOquery,AnnoProbe, limma)<br><br>dir.create(<span>"results"</span>)<br>gse=<span>"GSE73731"</span><br><span># GSE73731_eSet.Rdata: 67.2 MB</span><br><span># 用 axel http://49.235.27.111/GEOmirror/GSE73nnn/GSE73731_eSet.Rdata 下载数据</span><br><br><span>if</span>(!file.exists(<span>"GSE73731_eSet.Rdata"</span>)){<br>  geoChina(gse)<br>}<br>load(<span>"GSE73731_eSet.Rdata"</span>)<br><br>eSet=gset[[1]] <span>#转为ExpressionSet对象</span><br>gpl &lt;- eSet@annotation <span>#注释平台  </span><br>ids &lt;- AnnoProbe::idmap(gpl) <span>#注释信息</span><br><br><span>###############################################################################</span><br><span># 表达矩阵</span><br>exprSet &lt;- exprs(eSet)<br>ex &lt;- exprSet<br>qx &lt;- as.numeric(quantile(ex, c(0., 0.25, 0.5, 0.75, 0.99, 1.0), na.rm=T))<br>LogC &lt;- (qx[5] &gt; 100) ||<br>  (qx[6]-qx[1] &gt; 50 &amp;&amp; qx[2] &gt; 0) ||<br>  (qx[2] &gt; 0 &amp;&amp; qx[2] &lt; 1 &amp;&amp; qx[4] &gt; 1 &amp;&amp; qx[4] &lt; 2)<br><br><span>if</span> (LogC) { ex[<span>which</span>(ex &lt;= 0)] &lt;- NaN<br>exprSet &lt;- log2(ex)<br><span>print</span>(<span>"log2 transform finished"</span>)}<span>else</span>{<span>print</span>(<span>"log2 transform not needed"</span>)}<br><br>boxplot(exprSet)<br>exp &lt;- limma::normalizeBetweenArrays(exprSet)<br>boxplot(exp[,1:20])<br>range(exp)<br><br>exp &lt;- data.frame(exp) %&gt;%<br>  rownames_to_column(<span>"probe_id"</span>)<br><br>exp[1:4,1:4]<br><br><span># 注释信息与表达矩阵整合</span><br>expr1 &lt;- ids %&gt;%<br>  inner_join(exp,by=<span>"probe_id"</span>) %&gt;%<br>  dplyr::select(-probe_id) %&gt;%<br>  dplyr::mutate(rowMean=rowMeans(.[,-1])) %&gt;%<br>  arrange(desc(rowMean)) %&gt;%<br>  distinct(symbol,.keep_all = T) %&gt;%<br>  dplyr::select(-rowMean)<br><span>#write.csv(expr1,file = "results/GSE73731_eset.csv",quote = F, row.names = F)</span><br><br>pd &lt;- pData(eSet) <span>#临床数据</span><br><br>pd1 &lt;- pd %&gt;% <br>  dplyr::select(<span>"geo_accession"</span>, <span>"gender:ch1"</span>, <span>"grade:ch1"</span>, <span>"Stage:ch1"</span>)<br>colnames(pd1) &lt;- c(<span>"geo_accession"</span>,<span>"gender"</span>,<span>"grade"</span>,<span>"stage"</span>)<br><span>#write.csv(pd1, file = "results/GSE73731_pdata.csv", quote = F, row.names = F)</span></code></pre></section><p><span>一顿操作猛如虎，最后得到两个文件：</span></p><ul><li><p><code><span>GSE73731_eset.csv</span></code><span>: 表达矩阵</span></p></li><li><p><code><span>GSE73731_pdata.csv</span></code><span>: 临床特征</span></p></li></ul><p><img data-imgfileid="100003485" data-ratio="0.5" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/C0nicuvoMeDFxDoTmM0ebmglcXWQuicLsiaOYBJhsdhe2SiazzuaPFDGe0gRfByaKUX4YnOPY15BKaT5cuZrZLvf1g/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1640" width="820" src="https://mmbiz.qpic.cn/sz_mmbiz_png/C0nicuvoMeDFxDoTmM0ebmglcXWQuicLsiaOYBJhsdhe2SiazzuaPFDGe0gRfByaKUX4YnOPY15BKaT5cuZrZLvf1g/640?wx_fmt=png&amp;from=appmsg"><img data-imgfileid="100003484" data-ratio="1" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/C0nicuvoMeDFxDoTmM0ebmglcXWQuicLsiajEBRMyLLswicYYrQ0MvtWwZs3PvmsJQSmUcnqH48FZQylvFJpPAcqnw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="794" width="397" src="https://mmbiz.qpic.cn/sz_mmbiz_png/C0nicuvoMeDFxDoTmM0ebmglcXWQuicLsiajEBRMyLLswicYYrQ0MvtWwZs3PvmsJQSmUcnqH48FZQylvFJpPAcqnw/640?wx_fmt=png&amp;from=appmsg"></p><hr><h1><span>2 文章实战</span></h1><p><span>在</span><code><span>PubMed</span></code><span>搜索</span><code><span>GSE73731</span></code><span>可发现共有 7 篇文献。</span></p><p><img data-imgfileid="100003487" data-ratio="0.9290586630286494" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/C0nicuvoMeDFxDoTmM0ebmglcXWQuicLsiaaSvHNONz4PEGYv47oamdrL0jGfPO53AkzVZaCvt71eZmoAklp5eia3g/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1466" width="733" src="https://mmbiz.qpic.cn/sz_mmbiz_png/C0nicuvoMeDFxDoTmM0ebmglcXWQuicLsiaaSvHNONz4PEGYv47oamdrL0jGfPO53AkzVZaCvt71eZmoAklp5eia3g/640?wx_fmt=png&amp;from=appmsg"></p><p><span><strong><span>实战1-PMID38614981</span></strong></span><br></p><p><span>文中作者根据stage分期分级，分为late-stage和early-stage，获得差异基因，并将差异基因求交集。</span></p><p><img data-imgfileid="100003488" data-ratio="0.7196969696969697" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/C0nicuvoMeDFxDoTmM0ebmglcXWQuicLsia7NiayyY02eNricZVByHjkwq1UlIcox1FaMQ7b7zPicvvAfKK9wWmbHMiaQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1584" width="792" src="https://mmbiz.qpic.cn/sz_mmbiz_png/C0nicuvoMeDFxDoTmM0ebmglcXWQuicLsia7NiayyY02eNricZVByHjkwq1UlIcox1FaMQ7b7zPicvvAfKK9wWmbHMiaQ/640?wx_fmt=png&amp;from=appmsg"></p><hr><p><span><strong><span>实战2-PMID32973873</span></strong></span></p><p><span>该文作者针对</span><code><span>GSE73731</span></code><span>进行 WGCNA 分析，获取 stage 和 grade相关基因模块，同时通过MCC方法选定KIF18B进行验证。</span></p><p><img data-imgfileid="100003490" data-ratio="0.671264367816092" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/C0nicuvoMeDFxDoTmM0ebmglcXWQuicLsiaOiaMrlIXFhj24KJ0gnY0uVxnsM2vqUqweEFr9LBl0YLZ4ibd0O1cHtIw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1740" width="870" src="https://mmbiz.qpic.cn/sz_mmbiz_png/C0nicuvoMeDFxDoTmM0ebmglcXWQuicLsiaOiaMrlIXFhj24KJ0gnY0uVxnsM2vqUqweEFr9LBl0YLZ4ibd0O1cHtIw/640?wx_fmt=png&amp;from=appmsg"><img data-imgfileid="100003489" data-ratio="0.7245283018867924" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/C0nicuvoMeDFxDoTmM0ebmglcXWQuicLsiaibB2UicLukr5DtAaTlcj0b9GQK4dS5DxbYrenPeOMkwEY7GAxNgjJhXQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1590" width="795" src="https://mmbiz.qpic.cn/sz_mmbiz_png/C0nicuvoMeDFxDoTmM0ebmglcXWQuicLsiaibB2UicLukr5DtAaTlcj0b9GQK4dS5DxbYrenPeOMkwEY7GAxNgjJhXQ/640?wx_fmt=png&amp;from=appmsg"></p><hr><p><span>声明：本文代码均学习收集整理自网络，仅供交流学习，禁止用于商业用途，如有侵权，请联系删除。鉴于本人水平有限，某些内容难免理解不到位，还请各位大佬多多指教。</span></p><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/5Da94ZKbvCMf2tFofOZpGA",target="_blank" rel="noopener noreferrer">原文链接</a>
