---
title: "VIPER 单细胞蛋白活性推断(一)：pyVIPER"
date: 2024-06-13T00:47:23Z
draft: ["false"]
tags: [
  "fetched",
  "生信益站"
]
categories: ["Acdemic"]
---
VIPER 单细胞蛋白活性推断(一)：pyVIPER by 生信益站
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><figure data-tool="mdnice编辑器"><img data-imgfileid="100027847" data-ratio="0.278125" data-src="https://mmbiz.qpic.cn/sz_mmbiz_gif/mhoJzVKWSibibFpqLaHtmMialEcadgstRAOKMlP09QAwavcXv7jicoPePMlZqULCV6OEZeX8Bo0mpgR3vS53ia64KKA/640?wx_fmt=gif&amp;from=appmsg" data-type="gif" data-w="640" src="https://mmbiz.qpic.cn/sz_mmbiz_gif/mhoJzVKWSibibFpqLaHtmMialEcadgstRAOKMlP09QAwavcXv7jicoPePMlZqULCV6OEZeX8Bo0mpgR3vS53ia64KKA/640?wx_fmt=gif&amp;from=appmsg"></figure><p data-tool="mdnice编辑器"><code>生信益站，一点就有益</code>！<strong>祝友友们天天开心，月月发 CNS~</strong></p><section><mp-common-profile data-pluginname="mpprofile" data-id="MzU1NTk0MTUxMg==" data-headimg="http://mmbiz.qpic.cn/sz_mmbiz_png/mhoJzVKWSib8n88v0Cj6koLMO8nOuGacicngmJdb0zgmMpxaXYnrB7sjV5iar1cTzTDLsicoyNKrjic1Hgric41HObSQ/0?wx_fmt=png" data-nickname="生信益站" data-alias="" data-signature="生物信息或基因测序数据分析、软件算法、科研绘图、Python/Perl/R代码分享。" data-from="0" data-is_biz_ban="0"></mp-common-profile></section><hr data-tool="mdnice编辑器"><figure data-tool="mdnice编辑器"><img data-imgfileid="100027846" data-ratio="0.3768518518518518" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/mhoJzVKWSibibFpqLaHtmMialEcadgstRAOIz7FOrOhoIBBcNtyUk6Nrx4VwbvFXmNvkLTNJ89TNjtHyRoeHcoynA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/mhoJzVKWSibibFpqLaHtmMialEcadgstRAOIz7FOrOhoIBBcNtyUk6Nrx4VwbvFXmNvkLTNJ89TNjtHyRoeHcoynA/640?wx_fmt=png&amp;from=appmsg"><figcaption>设我为🌟星标，每天就能第一时间看到推送啦~</figcaption></figure><figure data-tool="mdnice编辑器"><img data-imgfileid="100027845" data-ratio="1" data-src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/mhoJzVKWSibibFpqLaHtmMialEcadgstRAOLbxZIZ2dGEMoGgYRuGZynbsibwGSP245HtTg1v2EEL0myUgaZBvF9Bw/640?wx_fmt=jpeg&amp;from=appmsg" data-type="jpeg" data-w="1024" src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/mhoJzVKWSibibFpqLaHtmMialEcadgstRAOLbxZIZ2dGEMoGgYRuGZynbsibwGSP245HtTg1v2EEL0myUgaZBvF9Bw/640?wx_fmt=jpeg&amp;from=appmsg"><figcaption><code>单细胞培训班-预报名</code></figcaption></figure><blockquote data-tool="mdnice编辑器"><span>❝</span><p><code>pyVIPER</code>——<span>使用 Python 对单细胞 RNASeq 进行 </span><code><span>VIPER</span></code><span> 分析。该包支持在 Python 上进行基于网络的蛋白质活性估计。</span>它还提供了 scanpy（Python 中的单细胞 RNASeq 分析）的接口。部分功能移植自 R 包 viper 和 R 包 NaRnEA。</p></blockquote><h1 data-tool="mdnice编辑器"><span></span><span>VIPER 算法原理</span><span></span></h1><p data-tool="mdnice编辑器">VIPER（Virtual Inference of Protein-activity by Enriched Regulon analysis）是一种先进的生物信息学工具，用于从单细胞基因表达数据中<code>推断蛋白质活性</code>。以下是该算法的介绍：</p><ul data-tool="mdnice编辑器"><li><section><p><code>Master Regulon</code> 的概念：VIPER 算法基于<code>master regulon</code>，这是一组由相同转录因子或信号通路调控的基因。这些基因集的表达模式通常高度一致，能够反映出其调控蛋白（<code>比如转录因子</code>）的活性状态。</p></section></li><li><section><p><code>基因表达</code>数据的分析：VIPER 利用单细胞基因表达数据，这些数据捕捉了细胞在特定生物学状态下的基因活性快照。</p></section></li><li><section><p><code>ARACNe 算法</code>的整合：VIPER 结合了 ARACNe 算法，后者是一种用于从基因表达数据中嵌入转录因子推断基因调控网络的工具。通过 ARACNe，VIPER 能够识别细胞内基因之间的相互作用和调控关系，为推断蛋白质活性提供了网络层面的支持。</p></section></li></ul><figure data-tool="mdnice编辑器"><img data-imgfileid="100027844" data-ratio="0.8940568475452196" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/mhoJzVKWSibibFpqLaHtmMialEcadgstRAO9JhwzjarKvRIXUmnjiaiasgjtVepfFWpWqawz6oBiaDIdp8KmLNY3MNwA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="774" src="https://mmbiz.qpic.cn/sz_mmbiz_png/mhoJzVKWSibibFpqLaHtmMialEcadgstRAO9JhwzjarKvRIXUmnjiaiasgjtVepfFWpWqawz6oBiaDIdp8KmLNY3MNwA/640?wx_fmt=png&amp;from=appmsg"><figcaption>https://api.semanticscholar.org/CorpusID:17237712</figcaption></figure><ul data-tool="mdnice编辑器"><li><section><p><code>蛋白质活性</code>的推断：VIPER 通过分析 master regulon 中基因的表达模式变化，推断其调控蛋白的活性。如果一个 master regulon 的基因表达水平在特定条件下显著变化，这通常表明其调控蛋白的活性发生了相应的变化。</p></section></li><li><section><p><code>统计方法</code>的应用：VIPER 使用统计方法来评估基因集表达模式的变化是否显著，并确定这些变化是否与蛋白质活性的变化相关联。</p></section></li></ul><blockquote data-tool="mdnice编辑器"><span>❝</span><p>基于 VIPER，已经发展出了很多延伸的算法，<span>今天给大家介绍的是 python 版本的 pyVIPER。</span></p></blockquote><h1 data-tool="mdnice编辑器"><span></span><span>依赖项</span><span></span></h1><ul data-tool="mdnice编辑器"><li><section>scanpy for single cell pipeline</section></li><li><section>pandas (&gt;=1.3.0 &amp; &lt;2.0, due to scanpy incompatibility (issue)) and anndata for data computing and storage.</section></li><li><section>numpy and scipy for scientific computation.</section></li><li><section>joblib for parallel computing</section></li><li><section>tqdm show progress bar</section></li></ul><h1 data-tool="mdnice编辑器"><span></span><span>安装</span><span></span></h1><p data-tool="mdnice编辑器">pypi</p><pre data-tool="mdnice编辑器"><span></span><code>pip install viper-in-python<br></code></pre><p data-tool="mdnice编辑器">local</p><pre data-tool="mdnice编辑器"><span></span><code>git <span>clone</span> https://github.com/alevax/pyviper/<br><span>cd</span> pyviper<br>pip install -e .<br></code></pre><h1 data-tool="mdnice编辑器"><span></span><span>使用</span><span></span></h1><pre data-tool="mdnice编辑器"><span></span><code><span>import</span> pandas <span>as</span> pd<br><span>import</span> anndata<br><span>import</span> pyviper<br><br><span># Load sample data</span><br>ges = anndata.read_text(<span>"test/unit_tests/test_1/test_1_inputs/LNCaPWT_gExpr_GES.tsv"</span>).T<br><br><span># Load network</span><br>network = pyviper.load.msigdb_regulon(<span>"h"</span>)<br><br><span># Translate sample data from ensembl to gene names</span><br>ges = pyviper.translate_adata_index(ges, desired_format = <span>"human_symbol"</span>)<br><br><span>## Filter targets in the interactome</span><br>network.filter_targets(ges.var_names)<br><br><span># Compute regulon activities</span><br><span>## area</span><br>activity = pyviper.viper(gex_data=ges, interactome=network, enrichment=<span>"area"</span>)<br>print(activity.to_df())<br><br><span>## narnea</span><br>activity = pyviper.viper(gex_data=ges, interactome=network, enrichment=<span>"narnea"</span>, eset_filter=<span>False</span>)<br>print(activity.to_df())<br></code></pre><h1 data-tool="mdnice编辑器"><span></span><span>更多教程</span><span></span></h1><p data-tool="mdnice编辑器">见官网：https://github.com/alevax/pyviper</p><figure data-tool="mdnice编辑器"><img data-imgfileid="100027843" data-ratio="0.18611111111111112" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/mhoJzVKWSibibFpqLaHtmMialEcadgstRAOYRH50Rl8tI4Jo7g5EM0Jey3XoH6Md1xNkCeINFfo1C89H0uds0lGag/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/mhoJzVKWSibibFpqLaHtmMialEcadgstRAOYRH50Rl8tI4Jo7g5EM0Jey3XoH6Md1xNkCeINFfo1C89H0uds0lGag/640?wx_fmt=png&amp;from=appmsg"></figure><figure data-tool="mdnice编辑器"><img data-imgfileid="100027850" data-ratio="0.20833333333333334" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/mhoJzVKWSibibFpqLaHtmMialEcadgstRAOR5FHrBZyYL4jlLicd6D2gE4q9J3WmQ0bLrByDAUIkhGvEbibnGeoJTYA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/mhoJzVKWSibibFpqLaHtmMialEcadgstRAOR5FHrBZyYL4jlLicd6D2gE4q9J3WmQ0bLrByDAUIkhGvEbibnGeoJTYA/640?wx_fmt=png&amp;from=appmsg"></figure><figure data-tool="mdnice编辑器"><img data-imgfileid="100027852" data-ratio="0.5731481481481482" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/mhoJzVKWSibibFpqLaHtmMialEcadgstRAO4bAUTVGBtnKddkIqAJjb1sxlleTlKoFVib1b2cJhFibG8UPIZDINgQSg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/mhoJzVKWSibibFpqLaHtmMialEcadgstRAO4bAUTVGBtnKddkIqAJjb1sxlleTlKoFVib1b2cJhFibG8UPIZDINgQSg/640?wx_fmt=png&amp;from=appmsg"></figure><figure data-tool="mdnice编辑器"><img data-imgfileid="100027848" data-ratio="0.3518705763397371" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/mhoJzVKWSibibFpqLaHtmMialEcadgstRAOwBEN3RbicFdwoarIkTc9MyJxagzm3XK8PJiaONSibsPU17L1Y7CNqY2xg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="989" src="https://mmbiz.qpic.cn/sz_mmbiz_png/mhoJzVKWSibibFpqLaHtmMialEcadgstRAOwBEN3RbicFdwoarIkTc9MyJxagzm3XK8PJiaONSibsPU17L1Y7CNqY2xg/640?wx_fmt=png&amp;from=appmsg"></figure><figure data-tool="mdnice编辑器"><img data-imgfileid="100027849" data-ratio="0.8520710059171598" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/mhoJzVKWSibibFpqLaHtmMialEcadgstRAOkdmT49mWgpUyFITdxZ4A2mgWz2bOP3wicXqH7GzRVsSWwX87ch3GD8g/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="845" src="https://mmbiz.qpic.cn/sz_mmbiz_png/mhoJzVKWSibibFpqLaHtmMialEcadgstRAOkdmT49mWgpUyFITdxZ4A2mgWz2bOP3wicXqH7GzRVsSWwX87ch3GD8g/640?wx_fmt=png&amp;from=appmsg"></figure><figure data-tool="mdnice编辑器"><img data-imgfileid="100027851" data-ratio="0.6148148148148148" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/mhoJzVKWSibibFpqLaHtmMialEcadgstRAO2e26hia8CibekCgeFbbibEmU6dicjibQ5AjAqErzKEgHLpramj0BW70Xuow/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/mhoJzVKWSibibFpqLaHtmMialEcadgstRAO2e26hia8CibekCgeFbbibEmU6dicjibQ5AjAqErzKEgHLpramj0BW70Xuow/640?wx_fmt=png&amp;from=appmsg"></figure><h1 data-tool="mdnice编辑器"><span></span><span>pyVIPER 结构和原理</span><span></span></h1><p data-tool="mdnice编辑器">pyviper 可用的<code>主要功能</code>包括：</p><ul data-tool="mdnice编辑器"><li><section><p>pyviper.viper：通过富集调控子分析 (VIPER) 虚拟推断蛋白质活性的“pyviper”函数。该函数允许使用 2 种富集算法，aREA 和 (matrix)-NaRnEA（见下文）。</p></section></li><li><section><p>pyviper.aREA：计算 aREA（基于分析等级的富集分析）和 meta-aREA</p></section></li><li><section><p>pyviper.NaRnEA：计算矩阵 NaRnEA ，即 NaRnEA 的矢量化实现</p></section></li><li><section><p>pyviper.pp.translate_adata_index：用于物种之间（即小鼠与人类）以及 ensembl、entrez 和基因符号之间的转换。</p></section></li><li><section><p>pyviper.tl.path_enr：计算通路富集</p></section></li></ul><p data-tool="mdnice编辑器">其他值得<code>注意的功能</code>包括：</p><ul data-tool="mdnice编辑器"><li><section>pyviper.tl.OncoMatch：计算 OncoMatch，这是一种评估两组样本之间差异活性 MR 蛋白重叠的算法（例如验证 GEMM 作为人类样本的有效模型）</section></li><li><section>pyviper.pp.stouffer：使用 Cluster integration 方法逐个簇计算特征，实现通路富集</section></li><li><section>pyviper.pp.viper_similarity：计算 VIPER 特征之间的相似度</section></li><li><section>pyviper.pp.repr_metacells：使用我们的方法计算代表性 metecells（例如 ARACNe），以最大化唯一样本的使用并最小化重采样（用户可以指定深度、数据使用百分比等）。</section></li><li><section>pyviper.pp.repr_subsample：使用我们的方法选择具有代表性的数据子样本，以确保广泛分布的采样。</section></li></ul><p data-tool="mdnice编辑器">此外，还有以下子模块可用：</p><ul data-tool="mdnice编辑器"><li><section>pyviper.load：子模块包含几个可用于不同分析的实用函数，包括 load_msigdb_regulon、load_TFs 等</section></li><li><section>pyviper.pl：包含用于 scanpy 绘图的 pyviper-wrappers 子模块</section></li><li><section>pyviper.tl：包含用于 scanpy 数据转换的 pyviper-wrappers 子模块</section></li><li><section>pyviper.config：子模块允许用户指定当前物种和调节子的文件路径</section></li></ul><h1 data-tool="mdnice编辑器"><span></span><span>算法地址</span><span></span></h1><ul data-tool="mdnice编辑器"><li><section>https://github.com/alevax/pyviper</section></li></ul><hr data-tool="mdnice编辑器"><p data-tool="mdnice编辑器">OK，今天的分享到此为止。咱们明天见~</p><h1 data-tool="mdnice编辑器"><span></span><span>益站可以评论、留言啦。赶紧发表您的看法吧~</span><span></span></h1><h1 data-tool="mdnice编辑器"><span></span><span>联系站长</span><span></span></h1><blockquote data-tool="mdnice编辑器"><span>❝</span><p>对<code>本篇文章有疑问</code>，或者有<code>科研服务需求</code>的友友可以在益站<code>发消息留言</code>，也欢迎各位童鞋<code>扫下面的二维码</code>加入我们的 <code>QQ</code> 交流群。</p></blockquote><figure data-tool="mdnice编辑器"><img data-imgfileid="100027855" data-ratio="1.5" data-src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/mhoJzVKWSibibFpqLaHtmMialEcadgstRAOOYs4U6ZN3nJCtdBIx72H3QSby5z1BLX6ybx5icibHuotXouZ2w0bThiaw/640?wx_fmt=jpeg&amp;from=appmsg" data-type="jpeg" data-w="512" src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/mhoJzVKWSibibFpqLaHtmMialEcadgstRAOOYs4U6ZN3nJCtdBIx72H3QSby5z1BLX6ybx5icibHuotXouZ2w0bThiaw/640?wx_fmt=jpeg&amp;from=appmsg"><figcaption>最新QQ群</figcaption></figure><hr data-tool="mdnice编辑器"><figure data-tool="mdnice编辑器"><img data-imgfileid="100027857" data-ratio="0.7277777777777777" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/mhoJzVKWSibibFpqLaHtmMialEcadgstRAOic2YMXmDrbUMWWZkldl5KVZmEW7OLZNdpNAxFcI8nYriaTXUXlibZia6Gw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/mhoJzVKWSibibFpqLaHtmMialEcadgstRAOic2YMXmDrbUMWWZkldl5KVZmEW7OLZNdpNAxFcI8nYriaTXUXlibZia6Gw/640?wx_fmt=png&amp;from=appmsg"><figcaption>科研服务</figcaption></figure><hr data-tool="mdnice编辑器"><figure data-tool="mdnice编辑器"><img data-imgfileid="100027856" data-ratio="1" data-src="https://mmbiz.qpic.cn/sz_mmbiz_gif/mhoJzVKWSibibFpqLaHtmMialEcadgstRAOXFGVRg7ibics4H0rm9p8kTYBlQwA8QMic7PDnOuPaNgDkHJPZ73CXWXpQ/640?wx_fmt=gif&amp;from=appmsg" data-type="gif" data-w="240" src="https://mmbiz.qpic.cn/sz_mmbiz_gif/mhoJzVKWSibibFpqLaHtmMialEcadgstRAOXFGVRg7ibics4H0rm9p8kTYBlQwA8QMic7PDnOuPaNgDkHJPZ73CXWXpQ/640?wx_fmt=gif&amp;from=appmsg"><figcaption>您的<code>关注、点赞、在看、转发</code>是对益站最大的<code>鼓励和支持</code>哈</figcaption></figure><hr data-tool="mdnice编辑器"></section><section><mp-common-profile data-pluginname="mpprofile" data-id="MzU1NTk0MTUxMg==" data-headimg="http://mmbiz.qpic.cn/sz_mmbiz_png/mhoJzVKWSib8n88v0Cj6koLMO8nOuGacicngmJdb0zgmMpxaXYnrB7sjV5iar1cTzTDLsicoyNKrjic1Hgric41HObSQ/0?wx_fmt=png" data-nickname="生信益站" data-alias="" data-signature="生物信息或基因测序数据分析、软件算法、科研绘图、Python/Perl/R代码分享。" data-from="0" data-is_biz_ban="0"></mp-common-profile></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/qDF1VavcsItO0qHgx-jOXg",target="_blank" rel="noopener noreferrer">原文链接</a>
