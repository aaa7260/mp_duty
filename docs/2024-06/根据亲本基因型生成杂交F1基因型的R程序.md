---
title: "根据亲本基因型生成杂交F1基因型的R程序"
date: 2024-06-17T00:12:25Z
draft: ["false"]
tags: [
  "fetched",
  "育种数据分析之放飞自我"
]
categories: ["Acdemic"]
---
根据亲本基因型生成杂交F1基因型的R程序 by 育种数据分析之放飞自我
------
<div><p data-mpa-powered-by="yiban.io">大家好，我是邓飞。</p><p>今天介绍一下如何根据亲本基因型，生成杂交F1的基因型数据。</p><p><strong>应用场景：</strong><br></p><p><span>玉米等物种中常见的步骤，其中只对父母（纯合系列）进行基因型分型，然后利用这些信息来生成/推测每个杂交后代的基因型数据。这个函数也可以用于混合DNA分析，以获得只对父母进行基因型分型的全同胞个体的混合分子矩阵。</span></p><p><span>R包：ASRgenomics，最新的版本为1.1.4。<br></span></p><p><span>安装命令：</span></p><section><ul><li></ul><pre data-lang="javascript"><code><span>install.packages(<span>"ASRgenomics"</span>)</span></code></pre></section><p><span></span></p><p>也可以在Rstudio中，鼠标点击形式，进行安装</p><p><img data-galleryid="" data-imgfileid="100012009" data-ratio="0.741514360313316" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/XEicwVA08daCkIYIfqbuINZs7KD9nvZ2QTwarIbDXsrPyoyKwS5XriblbNnOXf0F4EB2s2CpSHibahZSibyMSfrAzg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="383" src="https://mmbiz.qpic.cn/mmbiz_png/XEicwVA08daCkIYIfqbuINZs7KD9nvZ2QTwarIbDXsrPyoyKwS5XriblbNnOXf0F4EB2s2CpSHibahZSibyMSfrAzg/640?wx_fmt=png&amp;from=appmsg"></p><p><span></span></p><p><img data-galleryid="" data-imgfileid="100012011" data-ratio="0.2344931921331316" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/XEicwVA08daCkIYIfqbuINZs7KD9nvZ2QAryzIJiahnOLzxl0ufW9vOwrCpH3djlSKiayG8Js8jIq2MAm7bfRF1yw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="661" src="https://mmbiz.qpic.cn/mmbiz_png/XEicwVA08daCkIYIfqbuINZs7KD9nvZ2QAryzIJiahnOLzxl0ufW9vOwrCpH3djlSKiayG8Js8jIq2MAm7bfRF1yw/640?wx_fmt=png&amp;from=appmsg"></p><p><br></p><p><strong>函数说明：</strong><br></p><h3>Usage</h3><pre tabindex="0"><code>synthetic.cross<span>(</span><br>  M <span>=</span> <span>NULL</span><span>,</span><br>  ped <span>=</span> <span>NULL</span><span>,</span><br>  indiv <span>=</span> <span>NULL</span><span>,</span><br>  mother <span>=</span> <span>NULL</span><span>,</span><br>  father <span>=</span> <span>NULL</span><span>,</span><br>  heterozygote.action <span>=</span> c<span>(</span><span>"useNA"</span><span>,</span> <span>"exact"</span><span>,</span> <span>"fail"</span><span>,</span> <span>"expected"</span><span>)</span><span>,</span><br>  na.action <span>=</span> c<span>(</span><span>"useNA"</span><span>,</span> <span>"expected"</span><span>)</span><span>,</span><br>  message <span>=</span> <span>TRUE</span><br><span>)</span><br></code></pre><h3>Arguments</h3><p><br></p><p><br></p><table><tbody><tr><td><code>M</code></td><td><p>A matrix with marker data of full form (<code><span><span><semantics><mrow><mi>�</mi><mo>×</mo><mi>�</mi></mrow></semantics></span><span aria-hidden="true"><span><span></span><span>n</span><span></span><span>×</span><span></span></span><span><span></span><span>p</span></span></span></span></code>), with <code><span><span><semantics><mrow><mi>�</mi></mrow></semantics></span><span aria-hidden="true"><span><span></span><span>n</span></span></span></span></code> individuals (mothers and fathers) and <code><span><span><semantics><mrow><mi>�</mi></mrow></semantics></span><span aria-hidden="true"><span><span></span><span>p</span></span></span></span></code> markers. Individual and marker names are assigned to <code>rownames</code> and <code>colnames</code>, respectively. Data in matrix is coded as 0, 1, 2 (integer or numeric) (default = <code>NULL</code>).</p></td></tr><tr><td><code>ped</code></td><td><p>A data frame with three columns containing only the pedigree of the hypothetical offspring. (not pedigree of parents) It should include the three columns for individual, mother and father (default = <code>NULL</code>).</p></td></tr><tr><td><code>indiv</code></td><td><p>A character indicating the column in <code>ped</code> data frame containing the identification of the offspring (default = <code>NULL</code>).</p></td></tr><tr><td><code>mother</code></td><td><p>A character indicating the column in <code>ped</code> data frame containing the identification of the mother (default = <code>NULL</code>).</p></td></tr><tr><td><code>father</code></td><td><p>A character indicating the column in <code>ped</code> data frame containing the identification of the father (default = <code>NULL</code>).</p></td></tr><tr><td><code>heterozygote.action</code></td><td><p>Indicates the action to take when heterozygotes are found in a marker. Options are: <code>"useNA"</code>, <code>"exact"</code>, <code>"fail"</code>, and <code>"expected"</code>. See details for more information (default = <code>"useNA"</code>)</p></td></tr><tr><td><code>na.action</code></td><td><p>Indicates the action to take when missing values are found in a marker. Options are: <code>"useNA"</code> and <code>"expected"</code>. See details for more information (default = <code>"useNA"</code>).</p></td></tr><tr><td><code>message</code></td><td><p>If <code>TRUE</code> diagnostic messages are printed on screen (default = <code>TRUE</code>).</p></td></tr></tbody></table><p><br></p><p><br></p><p>主要参数：<br></p><p>M：为0-1-2编码的基因型数据，正常来说，都为0或者2，不应该有杂合的位点</p><p>ped：需要杂交的系谱，ID，亲本1，亲本2</p><p>注意事项：</p><p>亲本不允许有缺失值，不允许有杂合位点，这样生成的F1才是靠谱的。否则就会有推算，有错误的概率。<br></p><p><span></span><span>函数：</span><span>synthetic.cross 有根据</span><span>频率</span><span>推算的</span><span>方法，</span><span>不建议使用。</span><span>最好的方法是提取把数据处理好，不要有缺失值，不要有杂合位点，转为0-1-2的编码形式，然后用这个函数就可以生成了。</span></p><p><span><br></span></p><p><span>举个栗子：<br></span></p><section><ul><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="makefile"><code><span>library(ASRgenomics)</span></code><code><span><br></span></code><code><span>set.seed(123)</span></code><code><span>xx = sample(c(0,2),size=100,replace = T)</span></code><code><span><br></span></code><code><span>M012 = matrix(xx,5,20)</span></code><code><span><br></span></code><code><span>M012 = as.data.frame(M012)</span></code><code><span>names(M012) = paste0(<span>"SNP"</span>,1:20)</span></code><code><span>row.names(M012) = paste0(<span>"ID"</span>,1:5)</span></code><code><span>M012 = as.matrix(M012)</span></code><code><span>M012</span></code></pre></section><p><span></span></p><p><strong>模拟的基因型数据：</strong></p><p>5个个体，每个个体有20个SNP分型，0是主等位基因纯合，2是次等位基因纯合。<br></p><p><img data-galleryid="" data-imgfileid="100012010" data-ratio="0.12962962962962962" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/XEicwVA08daCkIYIfqbuINZs7KD9nvZ2QOd9mFtfTJkric2upsF0dvgyibY5QdmG87BKHAgtdVW3e0LA4yqWNXQ8A/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/XEicwVA08daCkIYIfqbuINZs7KD9nvZ2QOd9mFtfTJkric2upsF0dvgyibY5QdmG87BKHAgtdVW3e0LA4yqWNXQ8A/640?wx_fmt=png&amp;from=appmsg"></p><p>假定ID1，ID2，ID3作为母本，ID4和ID5作为父本，一共生成6个个体，想要得到这6个个体的基因型数据：</p><section><ul><li><li><li><li><li><li></ul><pre data-lang="makefile"><code><span>ped = data.frame(P1 = rep(c(<span>"ID1"</span>,<span>"ID2"</span>,<span>"ID3"</span>),each=2), P2 = rep(c(<span>"ID4"</span>,<span>"ID5"</span>),3))</span></code><code><span>ped</span></code><code><span><br></span></code><code><span>library(tidyverse)</span></code><code><span>ped = ped %&gt;% mutate(ID = str_c(P1,<span>"_"</span>,P2)) %&gt;% select(ID,P1,P2)</span></code><code><span>ped</span></code></pre></section><p><br></p><p><img data-galleryid="" data-imgfileid="100012008" data-ratio="0.3109677419354839" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/XEicwVA08daCkIYIfqbuINZs7KD9nvZ2QqFTxhxchnLQOlHGZPN1q9t7icxkvc6PzWGVquCZspoiaqWuQBicc4jZeg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="775" src="https://mmbiz.qpic.cn/mmbiz_png/XEicwVA08daCkIYIfqbuINZs7KD9nvZ2QqFTxhxchnLQOlHGZPN1q9t7icxkvc6PzWGVquCZspoiaqWuQBicc4jZeg/640?wx_fmt=png&amp;from=appmsg"></p><p><br></p><p>生成F1的代码：<br></p><p>synthetic.cross(M012,ped = ped,indiv = "ID",mother = "P1",father = "P2",heterozygote.action = "exact")</p><section><ul><li></ul><pre data-lang="javascript"><code><span>synthetic.cross(M012,ped = ped,indiv = <span>"ID"</span>,mother = <span>"P1"</span>,father = <span>"P2"</span>,heterozygote.action = <span>"exact"</span>)</span></code></pre></section><p><br></p><p>M012是0-1-2编码的基因型数据，ped是系谱数据，然后分别是ID的名称、母本的名称、父本的名称，以及杂交种处理的方式，这里为“exact”，即无法准确推测的设置为缺失，还有其它的选项可以选择。</p><p><br></p><p>结果文件：</p><p><img data-galleryid="" data-imgfileid="100012012" data-ratio="0.23796296296296296" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/XEicwVA08daCkIYIfqbuINZs7KD9nvZ2QuprjsciaCofibShUJiaoG4bBUZLwN9kyWInyExPI3xHVTqTBwhUrnFPUg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/XEicwVA08daCkIYIfqbuINZs7KD9nvZ2QuprjsciaCofibShUJiaoG4bBUZLwN9kyWInyExPI3xHVTqTBwhUrnFPUg/640?wx_fmt=png&amp;from=appmsg"><span></span></p><p><span>搞定！！！<br></span></p><p><strong>推荐阅读：</strong><br></p><p><strong><br></strong></p><p><strong><strong><span>想要更好的学习和交流，快来加入</span><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzI0MTIzNjYwNQ==&amp;mid=2247491476&amp;idx=1&amp;sn=8512962ea1264b569db4aa8d15b8712f&amp;chksm=e90ff086de7879908a1fa151e81004993a15650bae3f68e4d518a332beb18a130373c492043e&amp;scene=21#wechat_redirect" textvalue="飞哥的知识星球" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1">飞哥的知识星球</a><span>，这是一个生物统计+数量遗传学+GWAS+GS的社区，在这里你可以向飞哥提问、帮你指定学习计划、跟着飞哥一起做实战项目，冲冲冲。</span><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzI0MTIzNjYwNQ==&amp;mid=2247491476&amp;idx=1&amp;sn=8512962ea1264b569db4aa8d15b8712f&amp;chksm=e90ff086de7879908a1fa151e81004993a15650bae3f68e4d518a332beb18a130373c492043e&amp;scene=21#wechat_redirect" textvalue="点击这里加入吧：飞哥的学习圈子" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1"><span><strong>点击这里加入吧：</strong></span>飞哥的学习圈子</a></strong></strong></p><p><strong><img data-imgfileid="100012016" data-ratio="1.2462264150943396" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/XEicwVA08daCyoYQooxoH1tCzgN5xxevlQokBib7RiaStK9nPw4qo80OfqYAuRHsPAU4DJ2StOCUnHicqZNuG4fibow/640?wx_fmt=other&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1&amp;tp=webp" data-w="1060" src="https://mmbiz.qpic.cn/mmbiz_jpg/XEicwVA08daCyoYQooxoH1tCzgN5xxevlQokBib7RiaStK9nPw4qo80OfqYAuRHsPAU4DJ2StOCUnHicqZNuG4fibow/640?wx_fmt=other&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1&amp;tp=webp"></strong></p><p><br></p><p>1，<a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzI0MTIzNjYwNQ==&amp;mid=2247489866&amp;idx=1&amp;sn=e8631d343a33ae956b23d97a6b2b3fe4&amp;chksm=e90ff658de787f4e3b52929c85adadbe8c6f54bf0943780ea94f9e19e4cc6ef8756e068761f9&amp;scene=21#wechat_redirect" textvalue="快来领取 | 飞哥的GWAS分析教程" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" wah-hotarea="click" hasload="1">快来领取 | 飞哥的GWAS分析教程</a></p><p><br></p><p>2，<a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzI0MTIzNjYwNQ==&amp;mid=2247489124&amp;idx=1&amp;sn=923b2d827f0e4b6c70494ebd458bdfa5&amp;chksm=e90ff976de78706065f72955113db192e9f74682c503dc69c3ebf8d17e9b8726db82be1ffa0a&amp;scene=21#wechat_redirect" textvalue="飞哥汇总 | 入门数据分析资源推荐" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" wah-hotarea="click" hasload="1">飞哥汇总 | 入门数据分析资源推荐</a><br></p><p><br></p><p>3，<a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzI0MTIzNjYwNQ==&amp;mid=2247488460&amp;idx=3&amp;sn=b3acd30a2ab34e10415dacc90f596e4a&amp;chksm=e90ffcdede7875c8ba669382e38e91f5d1e10960448a1b88dbbe60bde1e5c2880e8ab918e914&amp;scene=21#wechat_redirect" textvalue="数量遗传学，分享几本书的电子版" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" wah-hotarea="click" hasload="1">数量遗传学，分享几本书的电子版</a></p><p><br></p><p>4，<a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzI0MTIzNjYwNQ==&amp;mid=2247490492&amp;idx=1&amp;sn=24434d7598cf1993bbece938b63cc7e8&amp;chksm=e90ff4aede787db837d5de895a24bb0cc055868d4345a5974a24534827aaff9882c86bbe6550&amp;scene=21#wechat_redirect" textvalue="R语言学习看最新版的电子书不香嘛？" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1">R语言学习看最新版的电子书不香嘛？</a></p><p><br></p><p><span>5，</span><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzI0MTIzNjYwNQ==&amp;mid=2247490897&amp;idx=1&amp;sn=2836fdb9bf636213d2ac9438c5d4d575&amp;chksm=e90ff243de787b55c501cf2ecc5bf3eb23f462b303ed4c861f0ade5c9d34741d338f18db3976&amp;scene=21#wechat_redirect" textvalue="书籍及配套代码领取--统计遗传分析导论" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" wah-hotarea="click" hasload="1"><span>书籍及配套代码领取--统计遗传分析导论</span></a></p><p><span><br></span></p><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/ts7YEqS0kOxKoVjokZ9KEw",target="_blank" rel="noopener noreferrer">原文链接</a>
