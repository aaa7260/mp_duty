---
title: "模仿一区top绘制地图柱状图、饼图"
date: 2024-06-28T09:43:44Z
draft: ["false"]
tags: [
  "fetched",
  "气象水文科研猫"
]
categories: ["Acdemic"]
---
模仿一区top绘制地图柱状图、饼图 by 气象水文科研猫
------
<div><p data-mpa-powered-by="yiban.io"><span><strong><span>R语言绘制地图柱状图、饼图：</span></strong></span><span></span></p><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><pre data-tool="mdnice编辑器"><span></span><code><span># 加载R包</span><br>library(sf)<br>library(ggplot2)<br>library(cowplot)<br>library(tidyverse)<br>library(ggspatial)<br>library(dplyr)<br><span># 绘制中国省份地图着色图</span><br>China_map=read_sf(<span>"./China_p.json"</span>)<br>df&lt;-read.csv(<span>"./capital624.csv"</span>,fileEncoding=<span>"gbk"</span>)<br><span># 地图散点图2</span><br>p2=ggplot(China_map)+<br>  geom_sf(color=<span>'black'</span>,fill=<span>"#eebd96"</span>,size=0.8)+<span>#地图线条粗细</span><br>  annotation_scale(location = <span>"bl"</span>, width_hint = 0.3) +<span>#添加比例尺并调整位置及长度</span><br>  annotation_north_arrow(location = <span>"tl"</span>, which_north = F, <br>                         pad_x = unit(0.05, <span>"in"</span>), pad_y = unit(0.05, <span>"in"</span>),<br>                         style = north_arrow_nautical)+<span>#添加指北针，指北针类型style有north_arrow_orienteering；north_arrow_fancy_orienteering；north_arrow_minimal与north_arrow_nautical四种类型</span><br>  theme_bw()<br><span># 地图饼图</span><br>library(scatterpie)<br>p2+geom_scatterpie(aes(x=lon,y=lat,group=region,r=1.2),data=df,cols=LETTERS[1:4],color=NA,alpha=0.8)+<br>                                  scale_fill_manual(values=c(<span>"blue"</span>,<span>"red"</span>,<span>"green"</span>,<span>"yellow"</span>))<br>p2+scatterpie::geom_scatterpie(data=df,aes(x=lon,y=lat,r=1.5),cols=c(<span>"A"</span>,<span>"B"</span>,<span>"C"</span>,<span>"D"</span>),alpha=.9)+<br>       scale_fill_manual(values=c(<span>"blue"</span>,<span>"red"</span>,<span>"green"</span>,<span>"yellow"</span>))<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100017263" data-ratio="0.8907407407407407" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/VQj38bogwOLHYfh3LzdoamIUbOdaQFvQyICSPlrqh2Nt1ap3yYJfibKFISMceZ7DBvks4F5Sib3gqdD6ib7UQOung/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/VQj38bogwOLHYfh3LzdoamIUbOdaQFvQyICSPlrqh2Nt1ap3yYJfibKFISMceZ7DBvks4F5Sib3gqdD6ib7UQOung/640?wx_fmt=png&amp;from=appmsg"></figure><pre data-tool="mdnice编辑器"><span></span><code><span># 地图柱状图</span><br>df2&lt;-read.csv(<span>"./capital625.csv"</span>,fileEncoding=<span>"gbk"</span>)<br>p2+geom_linerange(data=df2, aes(x=lon-.3,ymin=lat,ymax=lat+A*0.3,color=<span>'A'</span>),  alpha=0.8,size=3)+<br>       geom_linerange(data=df2, aes(x=lon+.3,ymin=lat,ymax=lat+B*0.3,color=<span>'B'</span>), alpha=0.8,size=3)+<br>       geom_linerange(data=df2, aes(x=lon+.9,ymin=lat,ymax=lat+C*0.3,color=<span>'C'</span>),  alpha=0.8,size=3)+<br>       geom_linerange(data=df2, aes(x=lon+1.5,ymin=lat,ymax=lat+D*0.3,color=<span>'D'</span>), alpha=0.8,size=3)<br>p2+geom_errorbar(data=df2,aes(x=lon-.3,ymin=lat,ymax=lat+A*0.3,color=<span>'A'</span>),size=3,color=<span>"blue"</span>,width=0,alpha=0.8)+<br>       geom_errorbar(data=df2, aes(x=lon+.3,ymin=lat,ymax=lat+B*0.3,color=<span>'B'</span>),size=3,color=<span>"red"</span>,width=0,alpha=0.8)+<br>       geom_errorbar(data=df2, aes(x=lon+.9,ymin=lat,ymax=lat+C*0.3,color=<span>'C'</span>),size=3,color=<span>"green"</span>,width=0,alpha=0.8)+<br>       geom_errorbar(data=df2, aes(x=lon+1.5,ymin=lat,ymax=lat+D*0.3,color=<span>'D'</span>),size=3,color=<span>"yellow"</span>,width=0,alpha=0.8)<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100017262" data-ratio="0.9027777777777778" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/VQj38bogwOLHYfh3LzdoamIUbOdaQFvQqO3EibHBoDic5mycNBCbR4AGBOYzWAialETe9ZYzUZew1eicicVWP26mKSA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/VQj38bogwOLHYfh3LzdoamIUbOdaQFvQqO3EibHBoDic5mycNBCbR4AGBOYzWAialETe9ZYzUZew1eicicVWP26mKSA/640?wx_fmt=png&amp;from=appmsg"></figure><hr><section><strong><span>********************************</span></strong></section><section><span><strong><span>欢迎加气象水文科研猫主编微信，</span></strong></span></section><section><span><strong><span>免费加入微信交流群，</span></strong></span></section><section><span><strong><span>获取更多免费代码和科研数据。</span></strong></span></section><section><strong><span>********************************</span></strong></section><section><img data-imgfileid="100017264" data-ratio="1.271444082519001" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/VQj38bogwOJG5okcEPbNPoh6U7OibH0K9iaC23cU8JJ2KC0mgP5085YKKGBTaKXicGV8tCykyW757GvIufia9QXmgg/640?wx_fmt=other&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1&amp;tp=webp" data-type="jpeg" data-w="921" src="https://mmbiz.qpic.cn/mmbiz_jpg/VQj38bogwOJG5okcEPbNPoh6U7OibH0K9iaC23cU8JJ2KC0mgP5085YKKGBTaKXicGV8tCykyW757GvIufia9QXmgg/640?wx_fmt=other&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1&amp;tp=webp"></section></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/Y5DNhxXTFh4F_ahgFGkEnA",target="_blank" rel="noopener noreferrer">原文链接</a>
