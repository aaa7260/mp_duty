---
title: "生信技能树-day16 转录组上游分析-概述、fastq、准备工作"
date: 2024-06-21T00:56:35Z
draft: ["false"]
tags: [
  "fetched",
  "生信菜鸟团"
]
categories: ["Acdemic"]
---
生信技能树-day16 转录组上游分析-概述、fastq、准备工作 by 生信菜鸟团
------
<div><blockquote data-tool="mdnice编辑器"><p><span>从我们</span><span>生信技能树</span><span>历年的几千个马拉松授课学员里面募集了一些优秀的创作者，某种意义来说是传承了我们生信技能树的知识整理和分享的思想！</span></p></blockquote><hr data-tool="mdnice编辑器"><p data-tool="mdnice编辑器">今天的是三周合计15天的数据挖掘授课学员一点一滴整理的授课知识点笔记哦，还有互动练习题哈，欢迎大家点击文末的阅读原文去关注我们学员的公众号哦！</p><p><img data-galleryid="" data-imgfileid="100039958" data-ratio="0.9869791666666666" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicZWFXx8AD2QqR5r26iaEib7iaTAeenkZojmCFn9w4mCdFoicJMx4AQ3q11rUoUaJn8lUjibicBWzLIhSAQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1536" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicZWFXx8AD2QqR5r26iaEib7iaTAeenkZojmCFn9w4mCdFoicJMx4AQ3q11rUoUaJn8lUjibicBWzLIhSAQ/640?wx_fmt=png&amp;from=appmsg"></p><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><h2 data-tool="mdnice编辑器"><span>转录组测序分析</span><span></span></h2><h3 data-tool="mdnice编辑器"><span>转录组测序概述</span></h3><h4 data-tool="mdnice编辑器"><span>转录组测序分析的流程</span></h4><figure data-tool="mdnice编辑器"><img data-imgfileid="100039312" data-ratio="1.1060070671378093" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/6s6vow09gKwKeRBdpqWlkgAcqI18Uv5viamnWh2icIvmAK8DKuD9YvFrniaxFB7CxFjiak0IkvBeTkqmniaUcVTWNGQ/640?wx_fmt=other&amp;from=appmsg&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" data-type="png" data-w="283" src="https://mmbiz.qpic.cn/sz_mmbiz_png/6s6vow09gKwKeRBdpqWlkgAcqI18Uv5viamnWh2icIvmAK8DKuD9YvFrniaxFB7CxFjiak0IkvBeTkqmniaUcVTWNGQ/640?wx_fmt=other&amp;from=appmsg&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"></figure><figure data-tool="mdnice编辑器"><img data-imgfileid="100039314" data-ratio="0.6475548060708263" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/6s6vow09gKwKeRBdpqWlkgAcqI18Uv5vVXYZhva6ePEtotX23lEQKyDJDCrIDIickNIzaOkqZzUKsEE3wopoh1w/640?wx_fmt=other&amp;from=appmsg&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" data-type="png" data-w="593" src="https://mmbiz.qpic.cn/sz_mmbiz_png/6s6vow09gKwKeRBdpqWlkgAcqI18Uv5vVXYZhva6ePEtotX23lEQKyDJDCrIDIickNIzaOkqZzUKsEE3wopoh1w/640?wx_fmt=other&amp;from=appmsg&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"></figure><figure data-tool="mdnice编辑器"><img data-imgfileid="100039313" data-ratio="0.681214421252372" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/6s6vow09gKwKeRBdpqWlkgAcqI18Uv5vxhU22nlvYcLLrhA7xUy9fkBEjT3AnxzIjZGNrmchysfha6y1K74zGQ/640?wx_fmt=other&amp;from=appmsg&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" data-type="png" data-w="527" src="https://mmbiz.qpic.cn/sz_mmbiz_png/6s6vow09gKwKeRBdpqWlkgAcqI18Uv5vxhU22nlvYcLLrhA7xUy9fkBEjT3AnxzIjZGNrmchysfha6y1K74zGQ/640?wx_fmt=other&amp;from=appmsg&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"></figure><h4 data-tool="mdnice编辑器"><span>中心法则、non-coding RNA分类</span></h4><figure data-tool="mdnice编辑器"><img data-imgfileid="100039315" data-ratio="0.6120218579234973" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/6s6vow09gKwKeRBdpqWlkgAcqI18Uv5vawcXltzJxprWCKNyyNvibb0EKK3CkwXiaEPy9nzeJpG1nv2jCD6dCK5g/640?wx_fmt=other&amp;from=appmsg&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" data-type="png" data-w="366" src="https://mmbiz.qpic.cn/sz_mmbiz_png/6s6vow09gKwKeRBdpqWlkgAcqI18Uv5vawcXltzJxprWCKNyyNvibb0EKK3CkwXiaEPy9nzeJpG1nv2jCD6dCK5g/640?wx_fmt=other&amp;from=appmsg&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"></figure><figure data-tool="mdnice编辑器"><img data-imgfileid="100039311" data-ratio="0.6019900497512438" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/6s6vow09gKwKeRBdpqWlkgAcqI18Uv5vicr9XniaemcSoeibYSKD6VwqVqRArlx7ECeKnFbJibYuv9PFLBOchLrZpg/640?wx_fmt=other&amp;from=appmsg&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" data-type="png" data-w="402" src="https://mmbiz.qpic.cn/sz_mmbiz_png/6s6vow09gKwKeRBdpqWlkgAcqI18Uv5vicr9XniaemcSoeibYSKD6VwqVqRArlx7ECeKnFbJibYuv9PFLBOchLrZpg/640?wx_fmt=other&amp;from=appmsg&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"></figure><figure data-tool="mdnice编辑器"><img data-imgfileid="100039320" data-ratio="0.4704968944099379" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/6s6vow09gKwKeRBdpqWlkgAcqI18Uv5vZDgRhPiafylsaPWvxiaHsA3gXeZyGW13DTwiarY4WHMXdRndBw9Enlaww/640?wx_fmt=other&amp;from=appmsg&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" data-type="png" data-w="644" src="https://mmbiz.qpic.cn/sz_mmbiz_png/6s6vow09gKwKeRBdpqWlkgAcqI18Uv5vZDgRhPiafylsaPWvxiaHsA3gXeZyGW13DTwiarY4WHMXdRndBw9Enlaww/640?wx_fmt=other&amp;from=appmsg&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"></figure><h4 data-tool="mdnice编辑器"><span>此部分需要理解的重点</span></h4><ol data-tool="mdnice编辑器"><li><section>构建文库→质检→上机测序</section></li><li><section>SBS（Sequencing-By-Synthesis）：通过单分子阵列实现在小型芯片（Flowcell）上进行桥式PCR反应。通过可逆阻断技术实现每次只合成一个碱基，再利用四种带有不同荧光标记的碱基，通过荧光激发/捕获，读取碱基信息：<strong>基于可逆终止的、荧光标记dNTP，边合成边测序</strong></section></li><li><section>双端测序，得到的文件每个样本有2个fastq文件，指的是read1和read2</section></li><li><section>测序得到的是荧光信号，根据荧光信号定量</section></li></ol><h4 data-tool="mdnice编辑器"><span>fastq数据格式</span></h4><ul data-tool="mdnice编辑器"><li><section><p>测序平台→原始图像数据→碱基识别Base Calling→原始测序序列Raw Data</p></section></li><li><section><p>文件格式为FASTQ（fq）</p></section></li><li><section><p>包含测序序列信息及对应质量信息，每个Read由四行组成：</p></section></li></ul><ol data-tool="mdnice编辑器"><li><section>第一行：@开头+Illumina测序识别符Sequence Identifiers（和描述文字）</section></li></ol><figure data-tool="mdnice编辑器"><img data-imgfileid="100039318" data-ratio="0.824390243902439" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/6s6vow09gKwKeRBdpqWlkgAcqI18Uv5vVIcu2cKnMzW0HEgic5R71XYlz9nX3Hr1CPBbtWXxL2YEDIJkw2ed4NA/640?wx_fmt=other&amp;from=appmsg&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" data-type="png" data-w="410" src="https://mmbiz.qpic.cn/sz_mmbiz_png/6s6vow09gKwKeRBdpqWlkgAcqI18Uv5vVIcu2cKnMzW0HEgic5R71XYlz9nX3Hr1CPBbtWXxL2YEDIJkw2ed4NA/640?wx_fmt=other&amp;from=appmsg&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"></figure><ol start="2" data-tool="mdnice编辑器"><li><section><p>第二行：碱基序列</p></section></li><li><section><p>第三行：+开头（和测序识别符）</p></section></li><li><section><p>第四行：对应序列的测序质量的ASCII码</p></section></li></ol><ul data-tool="mdnice编辑器"><li><section>碱基质量值Quality Score/Q-score：碱基识别出错的概率的整数映射，值越<strong>高</strong>说明碱基<strong>识别准确度越高，识别越可靠</strong></section></li></ul><figure data-tool="mdnice编辑器"><img data-imgfileid="100039316" data-ratio="0.54" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/6s6vow09gKwKeRBdpqWlkgAcqI18Uv5veZcasiaNwKmHAh2HkPyc38N2ToheFNhmXNktzAt972K4hCh5ffdyxYQ/640?wx_fmt=png&amp;from=appmsg&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" data-type="png" data-w="350" src="https://mmbiz.qpic.cn/sz_mmbiz_png/6s6vow09gKwKeRBdpqWlkgAcqI18Uv5veZcasiaNwKmHAh2HkPyc38N2ToheFNhmXNktzAt972K4hCh5ffdyxYQ/640?wx_fmt=png&amp;from=appmsg&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"></figure><ul data-tool="mdnice编辑器"><li><section>第四行中的字母和符号为<strong>Q值+33</strong>（也有可能是+64，根据不同机器）在ACSII表中对应的字符</section></li></ul><figure data-tool="mdnice编辑器"><img data-imgfileid="100039317" data-ratio="0.5387994143484627" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/6s6vow09gKwKeRBdpqWlkgAcqI18Uv5v1RnQxj9Rox2aHZNAcGkTk0329x6icRkVW53hZlPF4DY6jQ5EkMBiahAg/640?wx_fmt=other&amp;from=appmsg&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" data-type="png" data-w="683" src="https://mmbiz.qpic.cn/sz_mmbiz_png/6s6vow09gKwKeRBdpqWlkgAcqI18Uv5v1RnQxj9Rox2aHZNAcGkTk0329x6icRkVW53hZlPF4DY6jQ5EkMBiahAg/640?wx_fmt=other&amp;from=appmsg&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"></figure><figure data-tool="mdnice编辑器"><img data-imgfileid="100039319" data-ratio="0.18100358422939067" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/6s6vow09gKwKeRBdpqWlkgAcqI18Uv5vCxHbRtEMlgz7jAPbVSLJVGFIJWaD7iasf2oUjhbphAG3xpxpa4ILibzg/640?wx_fmt=other&amp;from=appmsg&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" data-type="png" data-w="558" src="https://mmbiz.qpic.cn/sz_mmbiz_png/6s6vow09gKwKeRBdpqWlkgAcqI18Uv5vCxHbRtEMlgz7jAPbVSLJVGFIJWaD7iasf2oUjhbphAG3xpxpa4ILibzg/640?wx_fmt=other&amp;from=appmsg&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"></figure><ul data-tool="mdnice编辑器"><li><section>实际质控报告结果示例：</section></li></ul><ol data-tool="mdnice编辑器"><li><section>ReadNum：原始数据有多少对Read</section></li><li><section>BaseNum：原始数据有多少碱基</section></li><li><section>Q20：Phred值大于20的碱基数占总碱基数的百分比，其他同理</section></li></ol><figure data-tool="mdnice编辑器"><img data-imgfileid="100039321" data-ratio="0.24958123953098826" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/6s6vow09gKwKeRBdpqWlkgAcqI18Uv5v6VibNo1eo3IPnybyzWxJ4qyyW438ZW1oFmwfHK4t9WaMIZyMDY1ogfg/640?wx_fmt=other&amp;from=appmsg&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" data-type="png" data-w="597" src="https://mmbiz.qpic.cn/sz_mmbiz_png/6s6vow09gKwKeRBdpqWlkgAcqI18Uv5v6VibNo1eo3IPnybyzWxJ4qyyW438ZW1oFmwfHK4t9WaMIZyMDY1ogfg/640?wx_fmt=other&amp;from=appmsg&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"></figure><h3 data-tool="mdnice编辑器"><span>准备工作</span></h3><h4 data-tool="mdnice编辑器"><span>1.工作目录管理</span></h4><p data-tool="mdnice编辑器">这一部分非常非常非常重要，拥有一个优秀的工作习惯比什么都重要</p><h5 data-tool="mdnice编辑器"><span>1.1 目录一览</span></h5><pre data-tool="mdnice编辑器"><code><span>## 示例如下：</span><br>├── database <span># 数据库存放目录，包括参考基因组，注释文件，公共数据库等</span><br>├── project  <span># 项目分析目录</span><br>    └── Human-16-Asthma-Trans <span>#具体项目</span><br>        ├── data <span># 数据存放目录</span><br>        │   ├── cleandata <span># 过滤后的数据</span><br>            │ ├── trim_galore <span># trim_galore过滤</span><br>      │ └── fastp     <span># fastp过滤</span><br>        │   └── rawdata <span># 原始数据</span><br>        ├──  Mapping <span># 比对目录</span><br>        │   ├── Hisat2 <span># Hisat比对</span><br>        │   └── Subjunc <span># subjunc比对</span><br>        └── Expression <span># 定量</span><br>            ├── featureCounts <span># featureCounts</span><br>            └── Salmon <span># salmon定量</span><br></code></pre><h5 data-tool="mdnice编辑器"><span>1.2 详细命令</span></h5><pre data-tool="mdnice编辑器"><code><span># 进入到个人目录</span><br><span>cd</span> ~<br><br><span>## 1.建立数据库目录：在数据库下建立参考基因组数据库，注意命名习惯：参考基因组版本信息</span><br>mkdir -p database/GRCh38.105<br><br><span>## 2.建立项目分析目录</span><br>mkdir project<br><span>cd</span> project<br>mkdir Human-16-Asthma-Trans <span># 注意项目命名习惯：物种-样本数-疾病-分析流程</span><br><span>cd</span> Human-16-Asthma-Trans<br><br><span># 建立数据存放目录</span><br>mkdir -p  data/rawdata  data/cleandata/trim_galore  data/cleandata/fastp<br><span># 建立比对目录</span><br>mkdir -p Mapping/Hisat2  Mapping/Subjunc<br><span># 建立定量目录</span><br>mkdir -p Expression/featureCounts  Expression/Salmon<br><span># 创建差异分析目录</span><br>mkdir Diff_analysis<br><span># 查看整个分析目录准备结构</span><br>tree<br>.<br>├── data<br>│   ├── cleandata<br>│   │   ├── fastp<br>│   │   └── trim_galore<br>│   └── rawdata<br>├── Diff_analysis<br>├── Expression<br>│   ├── featureCounts<br>│   └── Salmon<br>└── Mapping<br>    ├── Hisat2<br>    └── Subjunc<br></code></pre><h5 data-tool="mdnice编辑器"><span>课后习题答案</span></h5><p data-tool="mdnice编辑器">1.统计reads_1.fq文件种共有多少条reads？</p><pre data-tool="mdnice编辑器"><code><span># NR表示行号</span><br><span># %表示取余数</span><br>zless  SRR1039510_1.fastq.gz | grep <span>"@SRR"</span> -c<br>zless  SRR1039510_1.fastq.gz | grep <span>'^@SRR'</span> |wc -l<br>zless -S SRR1039510_1.fastq.gz | paste - - - - |wc -l<br>zless  SRR1039510_1.fastq.gz |wc -l | awk <span>'{print $0/4}'</span><br>zless -S SRR1039510_1.fastq.gz |awk <span>'{ if(NR%4==2) {print} }'</span> |wc -l<br><br><span># sed 版本 课后习题</span><br></code></pre><p data-tool="mdnice编辑器">2.输出reads_1.fq文件中所有的序列ID（即第一行）</p><pre data-tool="mdnice编辑器"><code>zless  SRR1039510_1.fastq.gz | grep <span>'^@SRR'</span>  |less -S<br>zless  SRR1039510_1.fastq.gz | paste - - - - |cut -f 1 |less -S<br>zless -S SRR1039510_1.fastq.gz |awk <span>'{if(NR%4==1){print}}'</span> |less -S<br></code></pre><p data-tool="mdnice编辑器">3.输出SRR1039510_1.fastq.gz文件中所有的序列（即第二行）</p><pre data-tool="mdnice编辑器"><code>zless  SRR1039510_1.fastq.gz | paste - - - - |cut -f 2 |less -S<br>zless -S SRR1039510_1.fastq.gz |awk <span>'{if(NR%4==2){print}}'</span> |less -S <br></code></pre><p data-tool="mdnice编辑器">4.统计SRR1039510_1.fastq.gz碱基总数</p><pre data-tool="mdnice编辑器"><code><span># 简单版本</span><br>zless -S SRR1039510_1.fastq.gz |paste - - - - |cut -f 2 |tr -d <span>'\n'</span> |wc -m<br>zless -S SRR1039510_1.fastq.gz |paste - - - - |cut -f 2 |grep -o [ATCGN] |wc -l<br><br><span># awk的高阶用法：BEGIN END模块</span><br>zless -S SRR1039510_1.fastq.gz |awk <span>'{ if(NR%4==2){print} }'</span> | awk <span>'BEGIN {num=0} {num=num+length($0)}  END{ print "num="num}'</span><br></code></pre><blockquote data-tool="mdnice编辑器"><p>from 生信技能树</p></blockquote><span></span></section><p><br></p><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><h3 data-tool="mdnice编辑器"><span>文末友情宣传</span></h3><p data-tool="mdnice编辑器"><strong>强烈建议你推荐给身边的博士后以及年轻生物学PI，多一点数据认知，让他们的科研上一个台阶：</strong></p><ul data-tool="mdnice编辑器"><li><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247530001&amp;idx=1&amp;sn=676dcf224f9be23b288189775292aeeb&amp;chksm=9b4b36aaac3cbfbc3e3bb0865bd789d5093e3a643f3f345332995f707b7f209ae924e9e9529e&amp;scene=21#wechat_redirect" textvalue="生物信息学马拉松授课（买‍一得五）" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1">生物信息学马拉松授课（买一得五）</a> ，你的生物信息学入门课</section></li><li><section><a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247524148&amp;idx=1&amp;sn=7806da6feb41a36493c519c1cfc1d3ac&amp;scene=21#wechat_redirect" data-linktype="2">时隔5年，我们的生信技能树VIP学徒继续招生啦</a></section></li><li><section><a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247528363&amp;idx=1&amp;sn=5e02f3e9b2e148191e23ebc2c0d780e7&amp;scene=21#wechat_redirect" data-linktype="2">2024的共享服务器交个朋友福利价仍然是800</a></section></li><li><section><a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247519765&amp;idx=1&amp;sn=ce5a8c8182f854c88043059f8c2cb9ff&amp;scene=21#wechat_redirect" data-linktype="2">千呼万唤始出来的独享生物信息学云服务器</a></section></li><li><section><a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247528144&amp;idx=1&amp;sn=be4d7e542d1077921024c86a4c130f16&amp;scene=21#wechat_redirect" data-linktype="2">永久免费的生信进阶培训（线下）</a></section></li></ul></section><p><br></p><p><mp-style-type data-value="10000"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/JH86aRUVgBF2GBdHNOrNQQ",target="_blank" rel="noopener noreferrer">原文链接</a>
