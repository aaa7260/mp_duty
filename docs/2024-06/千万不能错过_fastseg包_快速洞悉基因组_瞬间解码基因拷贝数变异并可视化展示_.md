---
title: "千万不能错过！fastseg包，快速洞悉基因组，瞬间解码基因拷贝数变异并可视化展示！"
date: 2024-06-10T11:52:26Z
draft: ["false"]
tags: [
  "fetched",
  "生信滩"
]
categories: ["Acdemic"]
---
千万不能错过！fastseg包，快速洞悉基因组，瞬间解码基因拷贝数变异并可视化展示！ by 生信滩
------
<div><p><img data-galleryid="" data-imgfileid="100008014" data-ratio="0.2222222222222222" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/YHGRXkSxjSRvhAzztUiaKYKYRIqQEWXNoxXibsZRcJjicibDicCibYA7y5icMRcZgx2SdN2kLyRrksNrj1aFrfQFcB9sw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/YHGRXkSxjSRvhAzztUiaKYKYRIqQEWXNoxXibsZRcJjicibDicCibYA7y5icMRcZgx2SdN2kLyRrksNrj1aFrfQFcB9sw/640?wx_fmt=png&amp;from=appmsg"></p><p><span><img data-imgfileid="100010137" data-ratio="0.3044654939106901" data-src="https://mmbiz.qpic.cn/mmbiz_png/YHGRXkSxjSQL3QRcHv1UglwPicKQF6FUvRhfOFEKfNhFBnic5s5FSIJvxKoIzG87aFUQibkHYuqiaSEia7yplw2ArCg/640?wx_fmt=png" data-type="png" data-w="739" height="168.60000610351562" width="553.739990234375" src="https://mmbiz.qpic.cn/mmbiz_png/YHGRXkSxjSQL3QRcHv1UglwPicKQF6FUvRhfOFEKfNhFBnic5s5FSIJvxKoIzG87aFUQibkHYuqiaSEia7yplw2ArCg/640?wx_fmt=png"></span><span></span></p><p><span>嘿，大家好！</span><span>大海哥</span><span>今天要向大家介绍一个强大的工具——fastseg包！想象一下，你手头有大量的基因组数据，每个片段都是一个未知的谜团，蕴含着无限的变异可能性。那么，如何快速准确地识别基因组中的潜在结构变化点？如何比较不同样本之间的基因拷贝数变异情况呢？别担心，fastseg包将成为你的得力助手！它不仅能够快速分割基因组数据，还能可视化基因拷贝数变异，帮助你深入理解基因组的结构和功能。</span><span>这篇宝藏文章可是出自</span><span>大海哥</span><span>我这个生信高手之手哦，要是同学们有自己做不了的生信分析，欢迎随时联系我！！！</span><span></span></p><p><span>在今天的学习中，我们将深入了解fastseg包的功能和重要性，学会如何处理基因组数据并进行分割分析，最终实现对基因拷贝数变异的准确识别和可视化展示。接下来，让我们一起开启对fastseg包的学习之旅吧！</span></p><p><span>          <p> </p></span></p><p><span>本次介绍的R包需要较多的硬件资源，在服务器可以更加流畅运行，同学们如果没有自己的服务器欢迎联系我们进行服务器租赁~</span>  </p><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><p><br></p></section></section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><p>公众号后台回复<span>“SXT”</span>领取本篇代码、基因集或示例数据等文件；</p><p><span><em><strong>文件编号：240603</strong></em></span></p><p><strong><span>大海哥送福利</span></strong><span><strong>：生信人必备神器——服务器</strong></span><br></p><p>平时生信分析学习中有要的小伙伴可以联系大海哥租赁，粉丝福利都是市场超低价格，赶快找大海哥领取免费的试用账号吧！</p><section><section><section><section><section><p><img data-imgfileid="100010140" data-ratio="0.9973474801061007" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/YHGRXkSxjSQicw3pkyJwFjNBuDYsZOL0kg45dSicgiaibBKJ3sbCq5IqXgFt7c9DmuucV9s07LXWFIoyBPufribs2ibA/640?wx_fmt=png" data-type="png" data-w="377" src="https://mmbiz.qpic.cn/mmbiz_png/YHGRXkSxjSQicw3pkyJwFjNBuDYsZOL0kg45dSicgiaibBKJ3sbCq5IqXgFt7c9DmuucV9s07LXWFIoyBPufribs2ibA/640?wx_fmt=png"></p><section><br></section></section><section><section><section><p>定制生信分析<br></p><p>云服务器租赁</p><p>（加微信<span>备注99</span>领取使用）</p></section></section></section></section></section></section></section><p><br></p></section></section></section></section></section></section><p><br></p><p><span>fastseg介绍</span></p><p><span>fastseg 是一个用于基因组分割（segmentation）的 R 语言包。它提供了一种快速和高效的方法来检测基因组中的潜在结构变化点，例如基因拷贝数变异、染色体异常等。fastseg 包基于分段分析的原理，通过在基因组上识别潜在的分割点，将基因组分割成具有相似性质的区域。它提供了多种分割算法和参数设置，以适应不同类型的基因组数据和分析需求。通过 fastseg 包，用户可以进行基因组分割的可视化、比较和解释，有助于深入理解基因组的结构和功能。</span></p><p><span>          <p> </p></span></p><p><span>fastseg包安装</span></p><p><span>需要R语言版本为4.3，在控制台中输入以下命令：</span></p><section><ul><li><li><li><li><li></ul><pre data-lang="php"><code><span><span>if</span> (!<span>require</span>(<span>"BiocManager"</span>, quietly = <span>TRUE</span>))</span></code><code><span>    install.packages(<span>"BiocManager "</span>)</span></code><code><span>BiocManager::install(<span>"fastseg"</span>) <span># 在BiocManager环境下安装fastseg</span></span></code><code><span>查看是否安装成功：</span></code><code><span>packageVersion(<span>"fastseg"</span>) <span># 查看fastseg版本</span></span></code></pre></section><p><span></span></p><p><span><img data-imgfileid="100010136" data-ratio="0.16896551724137931" data-src="https://mmbiz.qpic.cn/mmbiz_png/YHGRXkSxjSQL3QRcHv1UglwPicKQF6FUv5rHyHuX9bAzjGGnyUZHLdxwV7muyx10MTjBDPQ2Q55w8ektygs8SKw/640?wx_fmt=png" data-type="png" data-w="870" height="93.530029296875" width="553.739990234375" src="https://mmbiz.qpic.cn/mmbiz_png/YHGRXkSxjSQL3QRcHv1UglwPicKQF6FUv5rHyHuX9bAzjGGnyUZHLdxwV7muyx10MTjBDPQ2Q55w8ektygs8SKw/640?wx_fmt=png"></span><span></span></p><p><span>显示为1.48.0版本，则表示已经安装了fastseg包。</span>    <page></page></p><p><span>除此之外，后续示例还需要使用GenomicRanges包，我们可以提前安装，安装命令如下：</span></p><section><ul><li></ul><pre data-lang="php"><code><span>BiocManager::install(<span>"GenomicRanges"</span>) <span># 在BiocManager环境下安装SingleCellExperiment</span></span></code></pre></section><p><span>使用fastseg包进行基因组分割</span></p><p><span>载入需要的包和数据：</span></p><p><span>我们首先需要载入fastseg包。</span></p><section><ul><li></ul><pre data-lang="bash"><code><span>library(fastseg) <span># 载入fastseg包</span></span></code></pre></section><p><span>在本文中我们将使用Snijders研究数据集中的一个子集coriell。这些数据对应于成纤维细胞株的两项阵列 CGH 研究，GM05296 和 GM13330。在仅选择了来自染色体 1-22 和 X 的映射数据后，共有 2271 个数据点。</span></p><p><span>为了加载我们示例中的数据，我们需要执行以下代码：</span></p><section><ul><li><li></ul><pre data-lang="powershell"><code><span><span>data</span>(coriell) <span># 载入coriell数据集</span></span></code><code><span>head(coriell) <span># 查看coriell数据集的开始部分</span></span></code></pre></section><p><span>显示如下图：</span><span></span></p><p><span><img data-imgfileid="100010134" data-ratio="0.18703703703703703" data-src="https://mmbiz.qpic.cn/mmbiz_png/YHGRXkSxjSQL3QRcHv1UglwPicKQF6FUveOffhiajETKh2Hz2fnCczhWaBE15VqoFRMjywO83u4Gb57Xb2JExZwg/640?wx_fmt=png" data-type="png" data-w="1080" height="103.469970703125" width="553.739990234375" src="https://mmbiz.qpic.cn/mmbiz_png/YHGRXkSxjSQL3QRcHv1UglwPicKQF6FUveOffhiajETKh2Hz2fnCczhWaBE15VqoFRMjywO83u4Gb57Xb2JExZwg/640?wx_fmt=png"></span><span></span></p><p><span>共2271行，5列数据。</span></p><p><span>紧接着我们需要对coriell数据集进行一定的处理，从而满足</span><span>fastseg包的格式需求，相关的代码如下：</span>    </p><section><ul><li><li><li><li></ul><pre data-lang="nginx"><code><span><span>samplenames</span> &lt;- colnames(coriell)[<span>4</span>:<span>5</span>] <span># 提取coriell数据集4和5列的类名作为样本名称</span></span></code><code><span>data &lt;- as.matrix(coriell[<span>4</span>:<span>5</span>]) <span># 提取coriell数据集4和5列的数据构建矩阵</span></span></code><code><span>chrom &lt;- coriell<span>$Chromosome</span> <span># 提取coriell数据集的Chromosome列</span></span></code><code><span>maploc &lt;- coriell<span>$Position</span><span># 提取coriell数据集的Position列</span></span></code></pre></section><p><span></span></p><p><span>至此，我们已经完成了对于coriell数据集的预处理工作，接下来我们将演示如何使用</span><span>fastseg包对基因组数据进行分割并观察其拷贝数变化。同学们可要注意了，接下来要演示的可是fastseg包的主要功能，也是我们本篇文章的核心内容，更是每个同学都不容错过的重点中的重点。</span></p><p><span>对基因组数据进行分割：</span></p><p><span>fastseg包可同时处理多种数据格式，Granges类, ExpressionSet类,矩阵和向量等。本篇文章我们主要演示对于Granges类的构建和处理，同学们如果对于其他类型的数据格式感兴趣，可以去查阅fastseg包的参考手册。</span></p><p><span>构建Granges类的相关命令如下：</span></p><section><ul><li><li><li><li><li><li><li></ul><pre data-lang="powershell"><code><span>library(<span>"GenomicRanges"</span>) <span># 载入GenomicRanges包</span></span></code><code><span>gr &lt;- GRanges(seqnames=chrom,</span></code><code><span>        ranges=IRanges(maploc, <span>end</span>=maploc)) <span># 使用预处理的数据构建Granges类    </span></span></code><code><span>mcols(gr) &lt;- <span>data</span> <span># 将data中的数据赋值到gr的原数据中</span></span></code><code><span>colnames(mcols(gr)) &lt;- samplenames <span># 为gr的原数据赋值列名</span></span></code><code><span>res &lt;- fastseg(gr) <span># 对gr进行基因组分割</span></span></code><code><span>res <span># 查看分割结果</span></span></code></pre></section><p><span></span></p><p><span>结果如下图：</span></p><p><span><img data-imgfileid="100010138" data-ratio="0.275" data-src="https://mmbiz.qpic.cn/mmbiz_png/YHGRXkSxjSQL3QRcHv1UglwPicKQF6FUvWe7jhIAqf8Fol6WzqTfuJUic4L3J1TznEzSaDSJLpfL5NkRicLNCelnA/640?wx_fmt=png" data-type="png" data-w="1080" height="152.39996337890625" width="553.739990234375" src="https://mmbiz.qpic.cn/mmbiz_png/YHGRXkSxjSQL3QRcHv1UglwPicKQF6FUvWe7jhIAqf8Fol6WzqTfuJUic4L3J1TznEzSaDSJLpfL5NkRicLNCelnA/640?wx_fmt=png"></span><span></span></p><p><span>如图所示，两个细胞样本，一共被分割产生了65个片段，可知在部分染色体上的部分片段其基因拷贝数与片段整体值不同，接下来我们将通过对分割结果的可视化来定位这些片段。</span></p><p><span>基因拷贝数变异可视化：</span></p><p><span>我们可以使用segPlot函数来对基因组分割的记过进行可视化，命令如下：</span></p><section><ul><li></ul><pre data-lang="go"><code><span>segPlot(gr,res, plot.<span>type</span>=<span>"w"</span>) # 使用segPlot可视化基因组分割结果，其中plot.<span>type</span>=<span>"w"</span>制定了绘图的类型。</span></code></pre></section><p><span>结果如下图：</span>    <page></page></p><p><span><img data-imgfileid="100010135" data-ratio="0.6527777777777778" data-src="https://mmbiz.qpic.cn/mmbiz_png/YHGRXkSxjSQL3QRcHv1UglwPicKQF6FUvSsQz4ajGs5vNFicHLdFBHowZh9QiavpezS8dE42wYcg3DiawxicEjRMkew/640?wx_fmt=png" data-type="png" data-w="1080" height="361.2099914550781" width="553.2100219726562" src="https://mmbiz.qpic.cn/mmbiz_png/YHGRXkSxjSQL3QRcHv1UglwPicKQF6FUvSsQz4ajGs5vNFicHLdFBHowZh9QiavpezS8dE42wYcg3DiawxicEjRMkew/640?wx_fmt=png"></span><span></span></p><p><span><img data-imgfileid="100010139" data-ratio="0.6527777777777778" data-src="https://mmbiz.qpic.cn/mmbiz_png/YHGRXkSxjSQL3QRcHv1UglwPicKQF6FUvsm4rdXrKWSGm9XQH05icNHIKRa545PAicM9YacZYxuAWQy1FNFhwczMQ/640?wx_fmt=png" data-type="png" data-w="1080" height="361.2099914550781" width="553.2100219726562" src="https://mmbiz.qpic.cn/mmbiz_png/YHGRXkSxjSQL3QRcHv1UglwPicKQF6FUvsm4rdXrKWSGm9XQH05icNHIKRa545PAicM9YacZYxuAWQy1FNFhwczMQ/640?wx_fmt=png"></span><span></span></p><p><span>由图可知Coriell.05296样本的10号染色体以及23号染色体的部分位置，基因复制数相对于标准值偏高，而11号染色体的部分位置，基因复制数相对于标准值偏低。Coriell.13330样本的1号染色体的部分位置，基因复制数相对于标准值偏高，而4号染色体的末尾的极小部分片段基因复制数偏低，并且其13至22以及X染色体的复制数相较于标准值均具有轻微波动。</span>    <span>      </span><p> </p></p><p><span>以上就是对于</span><span>fastseg包的全部介绍了。本篇文章，</span><span>大海哥</span><span>带领大家从安装到应用，由浅及深，学习了如何准备数据，如何使用 fastseg 包进行基因组分割，以及如何通过 segPlot 函数将复杂的基因拷贝数变异可视化，这些技能对于理解基因组结构和变异至关重要。然而，这仅仅是冰山一角。fastseg 包的潜力远不止于此，它能够处理多种数据格式，为研究者提供了广阔的探索空间。</span><span>大海哥</span><span>鼓励同学们继续深入学习，挖掘 fastseg 包的更多功能，将其应用于更广泛的生物信息学研究中。</span><span>        </span><p> </p></p><p><span>同学们如果觉得自己写代码麻烦，可以体验一下我们的云生信小工具，只需输入数据，即可轻松生成所需图表。立即访问云生信</span><span><span>（</span></span><span><span>http://www.biocloudservice.com/home.html</span></span><span><span>）</span></span><span></span><span>，开启便捷的生信之旅！</span></p><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><p>大海哥还提供思路设计、定制生信分析、文献思路复现；有需要的小伙伴欢迎直接扫码咨询~</p></section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><img data-cropselx1="0" data-cropselx2="177" data-cropsely1="0" data-cropsely2="177" data-imgfileid="100010143" data-ratio="0.9973474801061007" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/YHGRXkSxjSQicw3pkyJwFjNBuDYsZOL0kg45dSicgiaibBKJ3sbCq5IqXgFt7c9DmuucV9s07LXWFIoyBPufribs2ibA/640?wx_fmt=png&amp;from=appmsg" data-type="jpeg" data-w="377" src="https://mmbiz.qpic.cn/mmbiz_png/YHGRXkSxjSQicw3pkyJwFjNBuDYsZOL0kg45dSicgiaibBKJ3sbCq5IqXgFt7c9DmuucV9s07LXWFIoyBPufribs2ibA/640?wx_fmt=png&amp;from=appmsg"></section></section></section><section><section powered-by="xiumi.us"><section><p><strong>定制生信分析<br></strong></p><p><strong>服务器租赁</strong></p><p><strong>扫码咨询大海哥</strong></p></section></section></section></section></section></section><p powered-by="xiumi.us"><br></p><section powered-by="xiumi.us"><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzkzMzUwODcwMg==&amp;mid=2247491024&amp;idx=2&amp;sn=d8ccbed93d5e13fd8a885a87cd12231b&amp;chksm=c24a3ee1f53db7f72717fae9c169ffc49e75005f8714185e35fc0864dac2e218e6563ecb3d08&amp;scene=21#wechat_redirect" textvalue="你已选中了添加链接的内容" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="1"><span><img data-imgfileid="100010142" data-ratio="0.29333333333333333" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/YHGRXkSxjSRzichicbEcnU2mvqdp0llrP8YNwNxNKRMdrRvz0oLnZNEMMFCyVfJXeWmtQcJ24EkyyXxgyaYicwn5w/640?wx_fmt=jpeg&amp;from=appmsg" data-type="jpeg" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_jpg/YHGRXkSxjSRzichicbEcnU2mvqdp0llrP8YNwNxNKRMdrRvz0oLnZNEMMFCyVfJXeWmtQcJ24EkyyXxgyaYicwn5w/640?wx_fmt=jpeg&amp;from=appmsg"></span></a></section></section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><p><strong>往期回顾</strong></p></section></section><section powered-by="xiumi.us"><section><svg viewbox="0 0 1 1"></svg></section></section><section powered-by="xiumi.us"><section><svg viewbox="0 0 1 1"></svg></section></section></section><section><section powered-by="xiumi.us"><section><svg viewbox="0 0 1 1"></svg></section></section><section powered-by="xiumi.us"><section><svg viewbox="0 0 1 1"></svg></section></section></section></section><section powered-by="xiumi.us"><section><table width="100%"><tbody><tr opera-tn-ra-comp="_$.pages:0.layers:0.comps:4.classicTable1:0" powered-by="xiumi.us"><td colspan="1" rowspan="1" opera-tn-ra-cell="_$.pages:0.layers:0.comps:4.classicTable1:0.td@@0" width="100.0000%"><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><p><strong>01</strong></p></section></section><section><section powered-by="xiumi.us"><p><span>｜<a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzkzMzUwODcwMg==&amp;mid=2247491024&amp;idx=2&amp;sn=d8ccbed93d5e13fd8a885a87cd12231b&amp;chksm=c24a3ee1f53db7f72717fae9c169ffc49e75005f8714185e35fc0864dac2e218e6563ecb3d08&amp;scene=21#wechat_redirect" textvalue="生信人必备神器——1024G存储的生信服务器，免费试用啦" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2">生信人必备神器——1024G存储的生信服务器，免费试用啦</a></span></p></section></section></section><section powered-by="xiumi.us"><section><svg viewbox="0 0 1 1"></svg></section></section></section></td></tr><tr opera-tn-ra-comp="_$.pages:0.layers:0.comps:4.classicTable1:1" powered-by="xiumi.us"><td colspan="1" rowspan="1" opera-tn-ra-cell="_$.pages:0.layers:0.comps:4.classicTable1:1.td@@0" width="100.0000%"><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><p><strong>02</strong></p></section></section><section><section powered-by="xiumi.us"><p><span>｜<a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzkzMzUwODcwMg==&amp;mid=2247490768&amp;idx=1&amp;sn=f7fa9fe45eb128a9729aaeeb866e37bb&amp;chksm=c24a3fe1f53db6f7f936d8397efb9fd089b412a7b48d53f3a76496eb2122843dd3a349a0065b&amp;scene=21#wechat_redirect" textvalue="【BWMR】孟德尔随机化分析利器，克服分析挑战！" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2">【BWMR】孟德尔随机化分析利器，克服分析挑战！</a></span></p></section></section></section><section powered-by="xiumi.us"><section><svg viewbox="0 0 1 1"></svg></section></section></section></td></tr><tr opera-tn-ra-comp="_$.pages:0.layers:0.comps:4.classicTable1:2" powered-by="xiumi.us"><td colspan="1" rowspan="1" opera-tn-ra-cell="_$.pages:0.layers:0.comps:4.classicTable1:2.td@@0" width="100.0000%"><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><p><strong>03</strong></p></section></section><section><section powered-by="xiumi.us"><p><span>｜<a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzkzMzUwODcwMg==&amp;mid=2247490408&amp;idx=1&amp;sn=ed197d298464c36bc55e010e5005bd82&amp;chksm=c24a3859f53db14f6dac19c3b53824c27b6bcec7f36ff04acc89505970a2749fc2f13acdcc1d&amp;scene=21#wechat_redirect" textvalue="分子对接花了几个小时？批量分子对接帮你5分钟搞定！" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2">分子对接花了几个小时？批量分子对接帮你5分钟搞定！</a></span></p></section></section></section><section powered-by="xiumi.us"><section><svg viewbox="0 0 1 1"></svg></section></section></section></td></tr><tr opera-tn-ra-comp="_$.pages:0.layers:0.comps:4.classicTable1:3" powered-by="xiumi.us"><td colspan="1" rowspan="1" opera-tn-ra-cell="_$.pages:0.layers:0.comps:4.classicTable1:3.td@@0" width="100.0000%"><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><p><strong>04</strong></p></section></section><section><section powered-by="xiumi.us"><p><span>｜<a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzkzMzUwODcwMg==&amp;mid=2247490092&amp;idx=1&amp;sn=60fa51a91ee9882bb37aaa240ac5a63a&amp;chksm=c24a391df53db00bbd05351d9cc70897d6c9e1670d92a0c56283d10aec4ce179f5dedd4338ad&amp;scene=21#wechat_redirect" textvalue="手把手带你复现XGboost和LightGBM机器学习算法特征重要性排名和 SHAP 汇总图" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2">手把手带你复现XGboost和LightGBM机器学习算法特征重要性排名和 SHAP 汇总图</a></span></p></section></section></section><section powered-by="xiumi.us"><section><svg viewbox="0 0 1 1"></svg></section></section></section></td></tr></tbody></table></section></section></section><p><span>         <p> </p></span><span>    </span><br></p><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/oy3gQderjWAyYxHgR8eVUw",target="_blank" rel="noopener noreferrer">原文链接</a>
