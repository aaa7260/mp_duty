---
title: "多时间点连续的药物处理看转录变化经典例子"
date: 2024-06-12T11:05:17Z
draft: ["false"]
tags: [
  "fetched",
  "生信技能树"
]
categories: ["Acdemic"]
---
多时间点连续的药物处理看转录变化经典例子 by 生信技能树
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><blockquote data-tool="mdnice编辑器"><p>最近看到了一个多组学研究，它的Bulk RNA-Seq数据集超级多，比如: GSE148692, GSE167284, GSE180023, GSE167281, GSE167282, GSE167283, GSE167285, GSE16728 and GSE180013). ，但是这些数据集目前都是currently private and is scheduled to be released on Apr 15, 2023.</p></blockquote><p data-tool="mdnice编辑器">虽然如此，它的实验设计还是可圈可点，值得推荐，比如 ：Figure 3. Rapid conversion of colonocytes to enterocytes after SATB2 loss</p><p data-tool="mdnice编辑器">实验设计就是 (A) A time course study of colonic mucosa after a single dose of TAM treatment in Satb2cKO mice showed rapid activation of FABP6 and downregulation of CA1 at day 2 and complete replacement of CA1+ cells by FABP6+ cells by day 6. OLFM4 and LYZ1 were not robustly activated until day 30. 如下所示  ：</p><p><img data-galleryid="" data-ratio="1.0088105726872247" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wzQS9MicatnNmnsqibE0XHbLNIKoRekC5icE6ey0xPoNeiajibdukYESJ94ro8q7GGaOicZqicC8IbOvAvTg/640?wx_fmt=png" data-type="png" data-w="908" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wzQS9MicatnNmnsqibE0XHbLNIKoRekC5icE6ey0xPoNeiajibdukYESJ94ro8q7GGaOicZqicC8IbOvAvTg/640?wx_fmt=png"></p><figure data-tool="mdnice编辑器"><figcaption>实验设计</figcaption></figure><p data-tool="mdnice编辑器">因为文章的转录组数据目前不公开，所以我们先看看美图养养眼，如下所示：</p><p><img data-galleryid="" data-ratio="1.117782909930716" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wzQS9MicatnNmnsqibE0XHbLNRoXjgnC4ZPU5CRKhPpnqbF6gx6VovfE439EFKrxnfh1uVmcKnkwHfg/640?wx_fmt=png" data-type="png" data-w="866" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wzQS9MicatnNmnsqibE0XHbLNRoXjgnC4ZPU5CRKhPpnqbF6gx6VovfE439EFKrxnfh1uVmcKnkwHfg/640?wx_fmt=png"></p><figure data-tool="mdnice编辑器"><figcaption>主成分分析和热图</figcaption></figure><p data-tool="mdnice编辑器">在正文重点展示了持续上升和持续下降的趋势基因集，并且进行了生物学功能数据库注释。</p><p data-tool="mdnice编辑器">当然了，其它变化趋势（比如先上升再下降或）的基因集也可以进行生物学功能数据库注释，在文章的附件里面展示：</p><p data-tool="mdnice编辑器"><strong>I</strong>. RNA-seq profiles and GeneOntology analysis of clusters 6-9 in SATB2 timed deletion study.</p><p><img data-galleryid="" data-ratio="0.2018867924528302" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wzQS9MicatnNmnsqibE0XHbLNlbz9YklDcCe2b5adtJCI88XKMfurPRcdJ3h3KDG0scmuSKHqc6AYKg/640?wx_fmt=png" data-type="png" data-w="2120" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wzQS9MicatnNmnsqibE0XHbLNlbz9YklDcCe2b5adtJCI88XKMfurPRcdJ3h3KDG0scmuSKHqc6AYKg/640?wx_fmt=png"></p><figure data-tool="mdnice编辑器"><figcaption> </figcaption></figure><p data-tool="mdnice编辑器">这个文章发表于2021年9月27日，美国康奈尔医学院<strong>周乔</strong>课题组在***Cell Stem Cell*** 期刊，文章标题是：《SATB2 preserves colon stem cell identity and mediates ileum-colon conversion via enhancer remodeling》，在线阅读链接 是：https://doi.org/10.1016/j.stem.2021.09.004，感兴趣的可以细读。</p><h3 data-tool="mdnice编辑器"><span></span>使用R包Mfuzz进行时间序列数据分析是很简单的<span></span></h3><p data-tool="mdnice编辑器">通常R包Mfuzz，Mfuzz采用了一种新的聚类算法fuzzy c-means algorithm。在文献中称这<strong>种聚类算法为soft clustering算法</strong>，相比K-means等hard clustering算法，一定程度上降低了噪声对聚类结果的干扰，而且这种算法有效的定义了基因和cluster之间的关系，即基因是否属于某个cluster, 对应的值为memebership。<strong>对于分析而言</strong>，我们只需要提供基因表达量的数据就可以了，需要注意的是，<strong>Mfuzz默认你提供的数据是归一化之后的表达量</strong>，这意味着表达量必须可以直接在样本间进行比较，对于FPKM, TPM这两种定量方式而言，是可以直接在样本间进行比较的；但是对于count的定量结果，我们必须先进行归一化，可以使用edgeR或者DESeq先得到归一化之后的数据在进行后续分析。</p><p data-tool="mdnice编辑器">示例代码如下所示，其中 DEGs_exp_averp 矩阵的处理有点技巧，这里略 ：</p><pre data-tool="mdnice编辑器"><span></span><code><span># 首先安装R包并加载</span><br>BiocManager::install(<span>"Mfuzz"</span>)<br><span>library</span>(Mfuzz)<br><span>## 1. 预处理：去除表达量太低或者在不同时间点间变化太小的基因等步骤</span><br><span># Mfuzz聚类时要求是一个ExpressionSet类型的对象，所以需要先用表达量构建这样一个对象。</span><br>eset &lt;- new(<span>"ExpressionSet"</span>,exprs = DEGs_exp_averp)<br><span># 根据标准差去除样本间差异太小的基因</span><br>eset &lt;- filter.std(eset,min.std=<span>0</span>)<br><span>## 2. 标准化：聚类时需要用一个数值来表征不同基因间的距离，Mfuzz中采用的是欧式距离，</span><br><span># 由于普通欧式距离的定义没有考虑不同维度间量纲的不同，所以需要先进行标准化</span><br>eset &lt;- standardise(eset)<br><span>## 3. 聚类：Mfuzz中的聚类算法需要提供两个参数，第一个参数为希望最终得到的聚类的个数，这个参数由我们直接指定；</span><br><span># 第二个参数称之为fuzzifier值，用小写字母m表示，可以通过函数评估一个最佳取值</span><br>c &lt;- <span>6</span> <span># 聚类个数，文章中用的6个聚类，我们也用6个</span><br>m &lt;- mestimate(eset) <span>#  评估出最佳的m值</span><br>cl &lt;- mfuzz(eset, c = c, m = m) <span># 聚类</span><br><br><span># 在cl这个对象中就保存了聚类的完整结果，对于这个对象的常见操作如下</span><br>cl$size <span># 查看每个cluster中的基因个数，看的出来与文章每个类别基因个数差了一些</span><br>[<span>1</span>] <span>2269</span> <span>1982</span> <span>2289</span> <span>1653</span> <span>1393</span> <span>1729</span><br><br>cl$cluster[cl$cluster == <span>1</span>] <span># 提取某个cluster下的基因</span><br>cl$membership <span># 查看基因和cluster之间的membership</span><br><br><span>## 4. 可视化</span><br><span>library</span>(RColorBrewer)<br>color.2 &lt;- colorRampPalette(rev(c(<span>"#ff0000"</span>, <span>"Yellow"</span>, <span>"OliveDrab1"</span>)))(<span>1000</span>)<br>mfuzz.plot(eset,cl,mfrow=c(<span>2</span>,<span>3</span>),new.window= <span>FALSE</span>,time.labels=colnames(DEGs_exp_averp),colo = color.2)<br></code></pre><h3 data-tool="mdnice编辑器"><span></span>时间序列设计也可以结合单细胞<span></span></h3><p data-tool="mdnice编辑器">我看到2020的文章：《Identification of EMT signaling cross-talk and gene regulatory networks by single-cell RNA sequencing》，就是一个时间序列分析，6组不同时间点的单细胞转录组数据：</p><p><img data-galleryid="" data-ratio="0.43221476510067114" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wzQS9MicatnNmnsqibE0XHbLNxmOpKT4eQNcI8bML9nCT2epY8xRJcImHUxIMicH7dn9k9TQiciaM13b0A/640?wx_fmt=png" data-type="png" data-w="1490" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wzQS9MicatnNmnsqibE0XHbLNxmOpKT4eQNcI8bML9nCT2epY8xRJcImHUxIMicH7dn9k9TQiciaM13b0A/640?wx_fmt=png"></p><figure data-tool="mdnice编辑器"><figcaption>6组不同时间点的单细胞转录组数据</figcaption></figure><p data-tool="mdnice编辑器">从标题就可以看到本文更新 EMT 过程，它涉及到如下所示的3种基因；</p><ul data-tool="mdnice编辑器"><li><section>epithelial markers (CDH1, EpCAM, and S100A9),</section></li><li><section>mesenchymal markers (CDH2, FN1, and FAP),</section></li><li><section>EMT transcription factors (TGFB1, SNAI2, and S100A6)</section></li></ul><p data-tool="mdnice编辑器">也是重点关心，随着时间变化的关键变量或者说指标：</p><p><img data-galleryid="" data-ratio="1.0293542074363993" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wzQS9MicatnNmnsqibE0XHbLNvNwF0oHVpzJibhA7yFiarHb8jSotPjarYIH31YCicVjzXHABBECYT9J7Q/640?wx_fmt=png" data-type="png" data-w="1022" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wzQS9MicatnNmnsqibE0XHbLNvNwF0oHVpzJibhA7yFiarHb8jSotPjarYIH31YCicVjzXHABBECYT9J7Q/640?wx_fmt=png"></p><figure data-tool="mdnice编辑器"><figcaption>随着时间变化的关键变量</figcaption></figure><h3 data-tool="mdnice编辑器"><span></span>学徒作业<span></span></h3><p data-tool="mdnice编辑器">多时间点多药物多浓度处理的多种细胞系的表达量的趋势分析；</p><p data-tool="mdnice编辑器">数据集是https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE116439，大家可以任选一个细胞系的一种药物的不同浓度不同时间段处理数据，比如：</p><pre data-tool="mdnice编辑器"><span></span><code>GSM3232619 A549_cisplatin_0nM_24h<br>GSM3232620 A549_cisplatin_0nM_2h<br>GSM3232621 A549_cisplatin_0nM_6h<br>GSM3232622 A549_cisplatin_15000nM_24h<br>GSM3232623 A549_cisplatin_15000nM_2h<br>GSM3232624 A549_cisplatin_15000nM_6h<br>GSM3232625 A549_cisplatin_3000nM_24h<br>GSM3232626 A549_cisplatin_3000nM_2h<br>GSM3232627 A549_cisplatin_3000nM_6h<br></code></pre><p data-tool="mdnice编辑器">做出趋势热图，折线图，等等！</p></section><p data-tool="mdnice编辑器">最后，值得一提的是，如果你有转录组数据，分析起来困难重重，可以考虑我们《生信技能树》的明码标价产品哦：</p><ul data-tool="mdnice编辑器"><li><section><a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247499830&amp;idx=1&amp;sn=365f26cf3454031d59f35856c852f6bb&amp;scene=21#wechat_redirect" data-linktype="2" wah-hotarea="click">明码标价之转录组常规测序服务（仅需799每个样品）</a></section></li><li><section><a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247499208&amp;idx=1&amp;sn=5ef47d5e0d2ebfe61e481e02963bdcef&amp;scene=21#wechat_redirect" data-linktype="2" wah-hotarea="click">明码标价之普通转录组上游分析</a></section></li><li><section><a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247500005&amp;idx=1&amp;sn=1ed83a9a3c6f6113b159ec1185228e86&amp;scene=21#wechat_redirect" data-linktype="2" wah-hotarea="click">明码标价之转录组下游分析仅需800元</a></section></li><li><section><a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247499308&amp;idx=1&amp;sn=ca92b6fc47b7deb6928cddade0aa0436&amp;scene=21#wechat_redirect" data-linktype="2" wah-hotarea="click">明码标价之转录组测序数据的可变剪切</a></section></li><li><section><a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247500795&amp;idx=1&amp;sn=78e855193e70080bf755180353351f0f&amp;scene=21#wechat_redirect" data-linktype="2" wah-hotarea="click">明码标价之RNA-Seq数据的内含子保留分析</a></section></li></ul></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/YdYT5dlsdfePh8e9NMlJSg",target="_blank" rel="noopener noreferrer">原文链接</a>
