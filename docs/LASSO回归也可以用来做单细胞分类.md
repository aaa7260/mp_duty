---
title: "LASSO回归也可以用来做单细胞分类"
date: 2022-11-19T13:19:11Z
draft: ["false"]
tags: [
  "fetched",
  "生信技能树"
]
categories: ["Acdemic"]
---
LASSO回归也可以用来做单细胞分类 by 生信技能树
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><blockquote data-tool="mdnice编辑器"><p>前面的 <a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247518377&amp;idx=1&amp;sn=1e3f8c3ad2a0cb064e51025fea35d961&amp;scene=21#wechat_redirect" data-linktype="2">一个完美的单细胞亚群随机森林分离器是如何炼成的</a> 有一个评价是这样的机器学习模型都是黑箱子，其实随机森林还好，它可以拿到具体的每个分类的重要的基因列表，有点类似于每个单细胞亚群的特异性高表达量基因：</p></blockquote><pre data-tool="mdnice编辑器"><span></span><code>load(file=<span>'rf_output.Rdata'</span>)<br>load(file = <span>'input.Rdata'</span>)<br><br>rf_importances=importance(rf_output, scale=<span>FALSE</span>)<br>head(rf_importances)<br>confusion=rf_output$confusion<br>confusion<br><br>varImpPlot(rf_output, type=<span>2</span>, n.var=<span>30</span>, <br>           scale=<span>FALSE</span>, <br>           main=<span>"Variable Importance (Gini) for top 30 predictors"</span>,cex =<span>.7</span>)<br><br>table(target)<br>MDSplot(rf_output, target, k=<span>2</span>)<br></code></pre><p data-tool="mdnice编辑器">首先，复制粘贴前面的 <a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247518377&amp;idx=1&amp;sn=1e3f8c3ad2a0cb064e51025fea35d961&amp;scene=21#wechat_redirect" data-linktype="2">一个完美的单细胞亚群随机森林分离器是如何炼成的</a> ，就可以拿到上面代码里面的两个rdata文件哈，然后得到的 rf_importances 这个数据里面有各个单细胞亚群对应的基因。</p><p data-tool="mdnice编辑器">虽然随机森林已经是很完美了，但是机器学习的算法非常多，我们有必要多用几个看看效果，接下来就演示一下LASSO回归，它也可以用来做单细胞分类。</p><h3 data-tool="mdnice编辑器"><span></span><span>训练LASSO回归模型</span><span></span></h3><p data-tool="mdnice编辑器">首先，复制粘贴前面的 <a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247518377&amp;idx=1&amp;sn=1e3f8c3ad2a0cb064e51025fea35d961&amp;scene=21#wechat_redirect" data-linktype="2">一个完美的单细胞亚群随机森林分离器是如何炼成的</a> ，就可以把单细胞表达量矩阵划分为训练集和测试集，然后走标准代码训练LASSO回归模型：</p><pre data-tool="mdnice编辑器"><span></span><code><br><span># family=“gaussian” 适用于一维连续因变量(univariate)</span><br><span># family=“mgaussian” 适用于多维连续因变量(multivariate)</span><br><span># family=“poisson” 适用于非负次数因变量(count)</span><br><span># family=“binomial” 适用于二元离散因变量(binary)</span><br><span># family=“multinomial” 适用于多元离散因变量(category)</span><br><span>library</span>(glmnet)                         <br>model_lasso &lt;- glmnet( predictor_data , target,<br>                      family=<span>"multinomial"</span>, nlambda=<span>50</span>, alpha=<span>1</span>)                                <br>print(model_lasso) <br><br>cv_fit &lt;- cv.glmnet(predictor_data , target,     <br>                    family=<span>"multinomial"</span>,<br>                    alpha = <span>1</span>, nlambda = <span>1000</span>) <br>c(cv_fit$lambda.min,cv_fit$lambda.1se)<br>save(model_lasso,cv_fit,file=<span>'lasso_output.Rdata'</span>)<br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span>看看模型效果:</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code><span>library</span>(glmnet)  <br>load(file=<span>'lasso_output.Rdata'</span>)<br>test_outputs &lt;-  predict(cv_fit,  as.matrix(test_expr) , <br>                         type=<span>"response"</span>, s=<span>"lambda.1se"</span>) <br>head( test_outputs ) <br>pred_y = colnames(test_outputs)[apply(test_outputs, <span>1</span>, which.max)]<br>pred_y = factor(pred_y,levels = levels(test_y))<br><br>pdf(<span>'lasso-performance.pdf'</span>,width = <span>10</span>)<br>gplots::balloonplot(table(pred_y,test_y))<br>dev.off()<br></code></pre><p data-tool="mdnice编辑器">仍然是简单的肉眼看了看，居然比前面的 <a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247518377&amp;idx=1&amp;sn=1e3f8c3ad2a0cb064e51025fea35d961&amp;scene=21#wechat_redirect" data-linktype="2">一个完美的单细胞亚群随机森林分离器是如何炼成的</a> 好一点哦，主要占比极低的树突细胞和血小板区分的比较好：</p><p><img data-galleryid="" data-ratio="0.4679144385026738" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wzCcusAribag2NR1EbFeW4V56ib4BEMc26yjRTUES74h6jxDQiagk39XZI0iaYfILqBwhsrJjHtiaRsZeQ/640?wx_fmt=png" data-type="png" data-w="1496" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wzCcusAribag2NR1EbFeW4V56ib4BEMc26yjRTUES74h6jxDQiagk39XZI0iaYfILqBwhsrJjHtiaRsZeQ/640?wx_fmt=png"></p><figure data-tool="mdnice编辑器"><figcaption>模型效果更好</figcaption></figure><p data-tool="mdnice编辑器">当然了，如果是系统性学习过机器学习算法，理论上我们的这样的分类器应该是有评价指标，而不是简单的肉眼看。StatQuest生物统计学视频是一个很优秀的生物统计学教程，教程作者是Josh Starmer （个人博客https://statquest.org/），生信菜鸟图很早之前就推过相关的学习资源。而且还组建过学习小分队，给视频写配套笔记：</p><ul data-tool="mdnice编辑器"><li><section><a href="https://mp.weixin.qq.com/s?__biz=MzUzMTEwODk0Ng==&amp;mid=2247489844&amp;idx=2&amp;sn=3338b4f141b2354ebda96fee29856dde&amp;scene=21#wechat_redirect" data-linktype="2">StatQuest生物统计学 - 二项分布</a></section></li><li><section><a href="https://mp.weixin.qq.com/s?__biz=MzUzMTEwODk0Ng==&amp;mid=2247490037&amp;idx=1&amp;sn=ba91529ed5d0f36501ba82879ac71a5d&amp;scene=21#wechat_redirect" data-linktype="2">StatQuest生物统计学 - 中心极限定理</a></section></li><li><section><a href="https://mp.weixin.qq.com/s?__biz=MzUzMTEwODk0Ng==&amp;mid=2247490099&amp;idx=1&amp;sn=89c81c6f39ec2ae662cbb87a4fbc092e&amp;scene=21#wechat_redirect" data-linktype="2">StatQuest生物统计学 - 箱线图</a></section></li><li><section><a href="https://mp.weixin.qq.com/s?__biz=MzUzMTEwODk0Ng==&amp;mid=2247490240&amp;idx=1&amp;sn=90ba6b975f142c90ad73a4237f9e5d7c&amp;scene=21#wechat_redirect" data-linktype="2">StatQuest生物统计学 - 二项分布的极大似然估计</a></section></li><li><section><a href="https://mp.weixin.qq.com/s?__biz=MzUzMTEwODk0Ng==&amp;mid=2247490315&amp;idx=1&amp;sn=3453f219ad45137868f325817c222325&amp;scene=21#wechat_redirect" data-linktype="2">StatQuest生物统计学 - 机器学习介绍</a></section></li><li><section><a href="https://mp.weixin.qq.com/s?__biz=MzUzMTEwODk0Ng==&amp;mid=2247490444&amp;idx=1&amp;sn=9dcd6829ba6bfaa6cc7782297a5d08bc&amp;scene=21#wechat_redirect" data-linktype="2">StatQuest生物统计学 - 机器学习之ConfusionMatrix</a></section></li></ul><p data-tool="mdnice编辑器">另外推荐生信菜鸟团的《周日-鲍志炜专栏》</p><p data-tool="mdnice编辑器">如果是是python呢，我们生信菜鸟团的《周日-鲍志炜专栏》也有一个机器学习系列教程，目录如下：</p><ol data-tool="mdnice编辑器"><li><section><a href="https://mp.weixin.qq.com/s?__biz=MzUzMTEwODk0Ng==&amp;mid=2247487916&amp;idx=1&amp;sn=0f95894a511ad2a7d594ea1c8a762693&amp;chksm=fa46d491cd315d87c6b69653a03778f5b875893d03c217b070a1104616fc0d075ce2ebcad160&amp;scene=21#wechat_redirect" data-linktype="2">Jupyter Notebook 你不得不知的交互式笔记本</a></section></li><li><section><a href="https://mp.weixin.qq.com/s?__biz=MzUzMTEwODk0Ng==&amp;mid=2247488932&amp;idx=1&amp;sn=6a065c93a79d4d7cf34073e5e2e5b07e&amp;chksm=fa46d099cd31598fbc25a86006304cbeae5a506b589e0c4923e900acda8549821259e86a7b89&amp;scene=21#wechat_redirect" data-linktype="2">我最常用的 10 个 Jupyter Notebook 插件</a></section></li><li><section><a href="https://mp.weixin.qq.com/s?__biz=MzUzMTEwODk0Ng==&amp;mid=2247485945&amp;idx=1&amp;sn=7e1cb441d13469bffdeba24617254f5d&amp;chksm=fa46ccc4cd3145d2d2db8a57d3cd2ad2d12a05bfe93e3c74b8b119ee5d9ca96680c0aa82def9&amp;scene=21#wechat_redirect" data-linktype="2">免费的在线 Jupyter Notebook</a></section></li><li><section><a href="https://mp.weixin.qq.com/s?__biz=MzUzMTEwODk0Ng==&amp;mid=2247488382&amp;idx=1&amp;sn=607b5062f9b49f589e73691821038c73&amp;chksm=fa46d643cd315f55fdd52785d1b05dd5e6d562b6657c0b825aed88068a9fbc95efb6e8a4706a&amp;scene=21#wechat_redirect" data-linktype="2">机器学习实战 | 数据预处理</a></section></li><li><section><a href="https://mp.weixin.qq.com/s?__biz=MzUzMTEwODk0Ng==&amp;mid=2247488595&amp;idx=1&amp;sn=d41bf14905e744695a268621b0206471&amp;chksm=fa46d16ecd315878d11fbead1637e70067733e1b2f1aec1d0164ffe4e573b10eb088abe0845f&amp;scene=21#wechat_redirect" data-linktype="2">机器学习实战 | 特征选择</a></section></li><li><section><a href="https://mp.weixin.qq.com/s?__biz=MzUzMTEwODk0Ng==&amp;mid=2247488026&amp;idx=1&amp;sn=ac52662c0f22233cf0de73ee4e254e47&amp;chksm=fa46d727cd315e31b6d2c4b723acbb0f247c20ac74da97bb38280259e6aefbb9d3d639111aa5&amp;scene=21#wechat_redirect" data-linktype="2">机器学习实战 | k-邻近算法</a></section></li><li><section><a href="https://mp.weixin.qq.com/s?__biz=MzUzMTEwODk0Ng==&amp;mid=2247488089&amp;idx=1&amp;sn=6e9b01bd428761664f69d34c37e4d676&amp;chksm=fa46d764cd315e7240c73e8d9b9df28008d83c698a05b1c40e234729bbd4fe0863c274ab5348&amp;scene=21#wechat_redirect" data-linktype="2">机器学习实战 | 决策树</a></section></li><li><section><a href="https://mp.weixin.qq.com/s?__biz=MzUzMTEwODk0Ng==&amp;mid=2247488130&amp;idx=1&amp;sn=aaa05c5926d112f1ff1b5cad8f7af965&amp;chksm=fa46d7bfcd315ea9e4edb2f00987d06577f32b53a102978482c61d809470b891ff2667e6c78e&amp;scene=21#wechat_redirect" data-linktype="2">机器学习实战 | 朴素贝叶斯</a></section></li><li><section><a href="https://mp.weixin.qq.com/s?__biz=MzUzMTEwODk0Ng==&amp;mid=2247488174&amp;idx=1&amp;sn=7c2c7c783ca1b0fb85f8a5ce6c26e6ae&amp;chksm=fa46d793cd315e856532453f4f84f86432c9d0642708308b4f5e591c8e66703835a809f6a43a&amp;scene=21#wechat_redirect" data-linktype="2">机器学习实战 | 逻辑回归</a></section></li><li><section><a href="https://mp.weixin.qq.com/s?__biz=MzUzMTEwODk0Ng==&amp;mid=2247488210&amp;idx=1&amp;sn=8816d7fc159b4dd2cf0491c04f71ce1f&amp;chksm=fa46d7efcd315ef98591b9d33f51a0ef80ada94ad7bfad4e3f357e2d25c02bac32509608df79&amp;scene=21#wechat_redirect" data-linktype="2">机器学习实战 | 支持向量机</a></section></li><li><section><a href="https://mp.weixin.qq.com/s?__biz=MzUzMTEwODk0Ng==&amp;mid=2247488255&amp;idx=1&amp;sn=4fc547793d885fe503840bda9dc330f3&amp;chksm=fa46d7c2cd315ed40a4c35f4f8d05a1e6d0e84409fcfa002b96396ae7a39d57d03b7a532557d&amp;scene=21#wechat_redirect" data-linktype="2">机器学习实战 | 支持向量机·sklearn 参数详解</a></section></li><li><section><a href="https://mp.weixin.qq.com/s?__biz=MzUzMTEwODk0Ng==&amp;mid=2247488350&amp;idx=1&amp;sn=ffa3d2b18d5d6cfaecdfd48368a69dbe&amp;chksm=fa46d663cd315f7559a51458d288b1b6928ecf6eb4bcf1ea4c4ffd1a7c9da0162e6c197edb19&amp;scene=21#wechat_redirect" data-linktype="2">机器学习实战 | Adaboost</a></section></li><li><section><a href="https://mp.weixin.qq.com/s?__biz=MzUzMTEwODk0Ng==&amp;mid=2247488470&amp;idx=1&amp;sn=e6b5f2f7b3d2d04f954cd2714c7d04a1&amp;chksm=fa46d6ebcd315ffd9feb654515be4bc9c81bfc209577157ca2abf475de47a4a47b383b4946cc&amp;scene=21#wechat_redirect" data-linktype="2">机器学习实战 | 机器学习性能指标</a></section></li><li><section><a href="https://mp.weixin.qq.com/s?__biz=MzUzMTEwODk0Ng==&amp;mid=2247491418&amp;idx=1&amp;sn=a5e80f7efa28868fb2406b87977b4ce9&amp;chksm=fa46da67cd3153719acfca7dbca9dae7526f6250955dbe8a270e0208f749862f5960f2d940cd&amp;scene=21#wechat_redirect" data-linktype="2">用小样本数据集进行机器学习建模的一些建议</a></section></li><li><section><a href="https://mp.weixin.qq.com/s?__biz=MzUzMTEwODk0Ng==&amp;mid=2247491503&amp;idx=1&amp;sn=352bdb472f8555cfd9a1ee3a08fa58bb&amp;chksm=fa46da92cd3153848a09ada2db170402bd63ca99bc1f9382a1e3d841a177e80bd0b70f928e5c&amp;scene=21#wechat_redirect" data-linktype="2">用 Scikit-learn Pipeline 创建机器学习流程</a></section></li><li><section><a href="https://mp.weixin.qq.com/s?__biz=MzUzMTEwODk0Ng==&amp;mid=2247492331&amp;idx=1&amp;sn=886363efe435bdf4fcdb2889fa28055c&amp;chksm=fa4527d6cd32aec07e34aaa4462e705677792e87c6908fe3d497c203a09483a990214ed32a23&amp;scene=21#wechat_redirect" data-linktype="2">sklearn 模型的保存与加载</a></section></li></ol><h2 data-tool="mdnice编辑器"><span></span><span>写在文末</span><span></span></h2><p data-tool="mdnice编辑器">我在《生信技能树》，《生信菜鸟团》，《单细胞天地》的大量推文教程里面共享的代码都是复制粘贴即可使用的， 有任何疑问欢迎留言讨论，也可以发邮件给我，详细描述你遇到的困难的前因后果给我，我的邮箱地址是 jmzeng1314@163.com</p><p data-tool="mdnice编辑器">如果你确实觉得我的教程对你的科研课题有帮助，让你茅塞顿开，或者说你的课题大量使用我的技能，烦请日后在发表自己的成果的时候，加上一个简短的致谢，如下所示：</p><p data-tool="mdnice编辑器">We thank Dr.Jianming Zeng(University of Macau), and all the members of his bioinformatics team, biotrainee, for generously sharing their experience and codes.</p><p data-tool="mdnice编辑器">十年后我环游世界各地的高校以及科研院所（当然包括中国大陆）的时候，如果有这样的情谊，我会优先见你。</p></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/6i7Io5en13XXlPt6R1uf1A",target="_blank" rel="noopener noreferrer">原文链接</a>
