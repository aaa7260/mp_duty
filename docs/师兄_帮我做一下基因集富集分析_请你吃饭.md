---
title: "师兄，帮我做一下基因集富集分析，请你吃饭"
date: 2022-12-01T10:07:58Z
draft: ["false"]
tags: [
  "fetched",
  "SCIPainter"
]
categories: ["Acdemic"]
---
师兄，帮我做一下基因集富集分析，请你吃饭 by SCIPainter
------
<div><section data-mpa-powered-by="yiban.io"><span>之前，在</span><span><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzA5NzQzOTgzMw==&amp;mid=2650965313&amp;idx=1&amp;sn=efba9117f1797d526e2b33707b1a1745&amp;chksm=8b56fc77bc217561b8c85ad553765410a80ca80686d9ff1ee54cdb0f8971b82f840f8f26a71b&amp;scene=21#wechat_redirect" textvalue="《从数据整理到软件使用，GSEA实操分享》" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2">《从数据整理到软件使用，GSEA实操分享》</a></span><span>一文中介绍了如何基于基因表达量数据进行GSEA，也就是，通过表达量计算组间的Signal2Nosise值进行排序。由于GSEA软件最初是针对芯片数据开发的，那么对于常规RNA-seq的表达量数据，比如RPKM/FPKM值，官方推荐使用预排序的方式进行GSEA。</span></section><section><br></section><section><span>排序文件(rnk)和基因集文件（gmt）是执行GSEA过程中最核心的两个文件。除了通过表达量计算组间的Signal2Nosise值进行排序，我们也常用edgeR、DESeq2等差异分析工具得到的</span><span>log<sub>2</sub></span><span>FC值进行排序。</span><span>利用<span>log</span><sub>2</sub>FC整理排序文件的格式如下，第1列为基因ID<span>（</span>这里为Symbol号，与gmt文件的基因ID类型保持一致），第2列为<span>log</span><sub>2</sub>FC值，删掉表头（列名），另存为制表符分隔的文本文件，并将拓展名改为“rnk”。</span></section><section><span><br></span></section><section><img data-ratio="1.0271084337349397" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6lIwVoat7Y8YzZqGdRGhkQ4onUax2GiaqIBNPibks9IQpQ0h7PtPwEMiaBwVgt5nXYlGJsicicrQPwrefA/640?wx_fmt=png" data-type="png" data-w="996" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6lIwVoat7Y8YzZqGdRGhkQ4onUax2GiaqIBNPibks9IQpQ0h7PtPwEMiaBwVgt5nXYlGJsicicrQPwrefA/640?wx_fmt=png"></section><section><br></section><section><span>然后，上传排序文件(rnk)和基因集文件（gmt），点击</span><span>Run GSEA Preranked</span><span>选项进行GSEA，具体的选项设置如下，然后点</span><span>Run</span><span>运行即可。</span></section><section><span><br></span></section><section><img data-ratio="0.6718538565629228" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6lIwVoat7Y8YzZqGdRGhkQ4kRJBHic1amSdVP1iaJz9E3oB6mbibrMNOchicZjKTYwaibiaXQKsL1tXeMMw/640?wx_fmt=png" data-type="png" data-w="1478" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6lIwVoat7Y8YzZqGdRGhkQ4kRJBHic1amSdVP1iaJz9E3oB6mbibrMNOchicZjKTYwaibiaXQKsL1tXeMMw/640?wx_fmt=png"></section><section><br></section><section><span>除了使用官方软件进行GSEA，我们也可以使用R语言的clusterProfiler包进行GSEA并对分析结果进行可视化。当然，这里也是基于预排序文件的进行GSEA的。下面就看下如何使用R语言进行GSEA吧！</span></section><section><span><br></span></section><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><p><strong>1. 安装R包</strong></p></section></section></section></section></section></section><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><svg viewbox="0 0 1 1"></svg></section></section><section powered-by="xiumi.us"><section><svg viewbox="0 0 1 1"></svg></section></section></section></section></section></section></section><section><br></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>#选择国内镜像；</span><br mpa-from-tpl="t"><span>chooseBioCmirror</span>()<br mpa-from-tpl="t"><span>#5: China (Peking)</span><br mpa-from-tpl="t"><span>#6: China (Nanjing)</span><br mpa-from-tpl="t"><span>#安装"BiocManager"；</span><br mpa-from-tpl="t"><span>install</span>.packages(<span>"BiocManager"</span>)<br mpa-from-tpl="t"><span>library</span>(BiocManager)<br mpa-from-tpl="t"><span>#安装clusterProfiler包；</span><br mpa-from-tpl="t"><span>install</span>(<span>"clusterProfiler"</span>)<br mpa-from-tpl="t"><span>install</span>(<span>"msigdbr"</span>)<br mpa-from-tpl="t"><span>#载入所需R包；</span><br mpa-from-tpl="t"><span>library</span>(clusterProfiler)<br mpa-from-tpl="t"><span>library</span>(dplyr)<br mpa-from-tpl="t"><span>library</span>(enrichplot)</code></pre></section><p><br mpa-from-tpl="t"></p><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><p><strong>2. 数据过滤</strong></p></section></section></section></section></section></section><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><svg viewbox="0 0 1 1"></svg></section></section><section powered-by="xiumi.us"><section><svg viewbox="0 0 1 1"></svg></section></section></section></section></section></section></section><section><br></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>#设置工作目录；</span><br mpa-from-tpl="t"><span>setwd</span>(<span>"C:/Users/你自己的文件位置/范例数据"</span>)<br mpa-from-tpl="t"><span>#读取差异分析表格；</span><br mpa-from-tpl="t"><span>exp</span> &lt;- read.csv(<span>"patient-control_diff_new.csv"</span>)<br mpa-from-tpl="t"><span>#预览数据；</span><br mpa-from-tpl="t"><span>head</span>(exp)</code></pre></section><p><br mpa-from-tpl="t"></p><section><img data-ratio="0.2617100371747212" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6lIwVoat7Y8YzZqGdRGhkQ4uKzHAjwNyH5jD9OKvibyFU4h3ic6PQXjeia7ib3SCqAibl3wcRpIrCicO3PA/640?wx_fmt=png" data-type="png" data-w="1345" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6lIwVoat7Y8YzZqGdRGhkQ4uKzHAjwNyH5jD9OKvibyFU4h3ic6PQXjeia7ib3SCqAibl3wcRpIrCicO3PA/640?wx_fmt=png"></section><section><br mpa-from-tpl="t"></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>#去掉没有symbol号的探针记录；</span><br mpa-from-tpl="t"><span>exp1</span> &lt;- exp[exp$GENE_SYMBOL!='',]<br mpa-from-tpl="t"><span>#查看筛选后的数据量；</span><br mpa-from-tpl="t"><span>dim</span>(exp1)<br mpa-from-tpl="t"><span>#[1] 29833 14</span><br mpa-from-tpl="t"><span>#一个基因对应多个探针，继续过滤；</span><br mpa-from-tpl="t"><span>#查看基因个数；</span><br mpa-from-tpl="t"><span>length</span>(unique(exp1$GENE_SYMBOL))<br mpa-from-tpl="t"><span>#[1] 21754</span><br mpa-from-tpl="t"><span>#根据logFC对表格进行降序排列；</span><br mpa-from-tpl="t"><span>exp2</span> &lt;- arrange(exp1,desc(logFC))<br mpa-from-tpl="t"><span>#根据Gene symbol列移除包含重复的行；</span><br mpa-from-tpl="t"><span>exp3</span>&lt;- exp2 %&gt;% distinct(GENE_SYMBOL, .keep_all = TRUE)<br mpa-from-tpl="t"><span>#查看表格的行列数；</span><br mpa-from-tpl="t"><span>dim</span>(exp3)<br mpa-from-tpl="t"><span>#[1] 21754 15</span><br mpa-from-tpl="t"><span>#准备目的gene列表；</span><br mpa-from-tpl="t"><span>gene_list</span> &lt;- exp3$logFC<br mpa-from-tpl="t"><span>names</span>(gene_list) &lt;- exp3$GENE_SYMBOL<br mpa-from-tpl="t"><span>gene_list</span>[1:6]</code></pre></section><p><br mpa-from-tpl="t"></p><section><img data-ratio="0.11891117478510028" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6lIwVoat7Y8YzZqGdRGhkQ47rQN2K5fZSOQSDWeAsP2dTXTutyb3GOEJdaeM6wpDnOEeiaNOH3D8MQ/640?wx_fmt=png" data-type="png" data-w="1396" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6lIwVoat7Y8YzZqGdRGhkQ47rQN2K5fZSOQSDWeAsP2dTXTutyb3GOEJdaeM6wpDnOEeiaNOH3D8MQ/640?wx_fmt=png"></section><section><br mpa-from-tpl="t"></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>#读取从GSEA官网下载好的基因集文件；</span><br mpa-from-tpl="t"><span>h</span>.all_gmt &lt;- read.gmt(<span>"h.all.v2022.1.Hs.symbols.gmt"</span>)<br mpa-from-tpl="t"><span>c2</span>.cp.kegg_gmt &lt;- read.gmt(<span>"c2.cp.kegg.v2022.1.Hs.symbols.gmt"</span>)<br mpa-from-tpl="t"><span>#预览转换格式后的gmt文件；</span><br mpa-from-tpl="t"><span>head</span>(h.all_gmt)<br mpa-from-tpl="t"><span>head</span>(c2.cp.kegg_gmt)</code></pre></section><p><br mpa-from-tpl="t"></p><section><img data-ratio="0.45702592087312416" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6lIwVoat7Y8YzZqGdRGhkQ42eMkYSurtflaGDJ5shp21Kyqa2YJztsSicQUjXQexaouXAMW7wYtZrQ/640?wx_fmt=png" data-type="png" data-w="1466" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6lIwVoat7Y8YzZqGdRGhkQ42eMkYSurtflaGDJ5shp21Kyqa2YJztsSicQUjXQexaouXAMW7wYtZrQ/640?wx_fmt=png"></section><section><br mpa-from-tpl="t"></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>#拓展内容：</span><br mpa-from-tpl="t"><span>#另一种方法是直接从msigdbr包获取基因集文件；</span><br mpa-from-tpl="t"><span>library</span>(msigdbr)<br mpa-from-tpl="t"><span>#查看支持的物种；</span><br mpa-from-tpl="t"><span>msigdbr_species</span>()</code></pre></section><p><br mpa-from-tpl="t"></p><section><img data-ratio="0.5697399527186762" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6lIwVoat7Y8YzZqGdRGhkQ4icSyRiavErK0f4KEX543oGKWJt5aRaUq1KcacwUIJE8FpwnF1mGyW97w/640?wx_fmt=png" data-type="png" data-w="1269" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6lIwVoat7Y8YzZqGdRGhkQ4icSyRiavErK0f4KEX543oGKWJt5aRaUq1KcacwUIJE8FpwnF1mGyW97w/640?wx_fmt=png"></section><section><br mpa-from-tpl="t"></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>#检索人的所有基因集（较慢）；</span><br mpa-from-tpl="t"><span>m_df</span> &lt;- msigdbr(species = <span>"Homo sapiens"</span>)<br mpa-from-tpl="t"><span>#查看分类；</span><br mpa-from-tpl="t"><span>unique</span>(m_df$gs_cat)<br mpa-from-tpl="t"><span>#[1] "C3" "C2" "C8" "C6" "C7" "C4" "C1" "C5" "H"</span><br mpa-from-tpl="t"><span>#创建基因集文件；</span><br mpa-from-tpl="t"><span>H</span>.gmt &lt;- msigdbr(species = <span>"Homo sapiens"</span>, category = <span>"H"</span>) %&gt;%<br mpa-from-tpl="t"><span>dplyr</span>::select(gs_name, gene_symbol)<br mpa-from-tpl="t"><span>head</span>(H.gmt)</code></pre></section><p><br mpa-from-tpl="t"></p><section><img data-ratio="0.3023743016759777" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6lIwVoat7Y8YzZqGdRGhkQ4PJwqx85IUr9gE9XqiaBve6ppcywRWQTDXfic0e2tI7mdfddE2bCB2WgA/640?wx_fmt=png" data-type="png" data-w="1432" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6lIwVoat7Y8YzZqGdRGhkQ4PJwqx85IUr9gE9XqiaBve6ppcywRWQTDXfic0e2tI7mdfddE2bCB2WgA/640?wx_fmt=png"></section><section><br></section><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><p><strong>3. GSEA</strong></p></section></section></section></section></section></section><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><svg viewbox="0 0 1 1"></svg></section></section><section powered-by="xiumi.us"><section><svg viewbox="0 0 1 1"></svg></section></section></section></section></section></section></section><section><br></section><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><svg viewbox="0 0 1 1"></svg></section></section></section><section><section powered-by="xiumi.us"><section><p><strong><strong><span>3.1 基于Hallmark基因集进行GSEA</span></strong></strong></p></section></section><section powered-by="xiumi.us"><section><svg viewbox="0 0 1 1"></svg></section></section></section><section><section powered-by="xiumi.us"><p><br></p></section></section></section></section><section><br></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>#执行GSEA;</span><br mpa-from-tpl="t"><span>h</span>.all_res &lt;- GSEA(gene_list,TERM2GENE = h.all_gmt)<br mpa-from-tpl="t"><span>#预览分析结果；</span><br mpa-from-tpl="t"><span>head</span>(h.all_res@result[3:10])</code></pre></section><p><br mpa-from-tpl="t"></p><section><img data-ratio="0.5582677165354331" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6lIwVoat7Y8YzZqGdRGhkQ4yn9lvPPn7tkLibmNphv6vop2TnDmvaqd2KEqthPU4rEn33zIwvrkfCQ/640?wx_fmt=png" data-type="png" data-w="1270" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6lIwVoat7Y8YzZqGdRGhkQ4yn9lvPPn7tkLibmNphv6vop2TnDmvaqd2KEqthPU4rEn33zIwvrkfCQ/640?wx_fmt=png"></section><section><br mpa-from-tpl="t"></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>#对第1个基因集的富集结果进行可视化；</span><br mpa-from-tpl="t"><span>gseaplot2</span>(h.all_res,<br mpa-from-tpl="t"><span>title</span> = h.all_res$Description[1],<br mpa-from-tpl="t"><span>geneSetID</span> = 1)</code></pre></section><p><br mpa-from-tpl="t"></p><section><img data-ratio="0.9031111111111111" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6lIwVoat7Y8YzZqGdRGhkQ4icO4QiaA4WToTiaj70ibpVKZvbAfGqrBNribhNiaZCtld7OYicKopsJUSVaKw/640?wx_fmt=png" data-type="png" data-w="1125" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6lIwVoat7Y8YzZqGdRGhkQ4icO4QiaA4WToTiaj70ibpVKZvbAfGqrBNribhNiaZCtld7OYicKopsJUSVaKw/640?wx_fmt=png"></section><section><br mpa-from-tpl="t"></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>#对感兴趣基因集的富集结果进行可视化；</span><br mpa-from-tpl="t"><span>gset</span>=<span>"HALLMARK_OXIDATIVE_PHOSPHORYLATION"</span><br mpa-from-tpl="t"><span>gsetid</span>&lt;- h.all_res@result$ID<br mpa-from-tpl="t"><span>#获取位置编号；</span><br mpa-from-tpl="t"><span>index</span> &lt;- which(gsetid==gset)<br mpa-from-tpl="t"><span>#绘图；</span><br mpa-from-tpl="t"><span>gseaplot2</span>(h.all_res, title = h.all_res$Description[index],<br mpa-from-tpl="t"><span>geneSetID</span> = index)</code></pre></section><p><br mpa-from-tpl="t"></p><section><img data-ratio="0.9125780553077609" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6lIwVoat7Y8YzZqGdRGhkQ4sVmIqXiblJuTN1SvyukzvlLIaYVID9sUBgp5sjxHLnibB9JTWLp7zJSg/640?wx_fmt=png" data-type="png" data-w="1121" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6lIwVoat7Y8YzZqGdRGhkQ4sVmIqXiblJuTN1SvyukzvlLIaYVID9sUBgp5sjxHLnibB9JTWLp7zJSg/640?wx_fmt=png"></section><section><br mpa-from-tpl="t"></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>#同时绘制多个基因集的富集结果；</span><br mpa-from-tpl="t"><span>gseaplot2</span>(h.all_res, title = <span>""</span>, geneSetID = 1:5)</code></pre></section><p><br mpa-from-tpl="t"></p><section><img data-ratio="0.8169464428457234" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6lIwVoat7Y8YzZqGdRGhkQ4LzKq4h89NhrCI4OPgRbEPGZRt9USeaysuwHe1sVqdyzfJB26BjvFfw/640?wx_fmt=png" data-type="png" data-w="1251" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6lIwVoat7Y8YzZqGdRGhkQ4LzKq4h89NhrCI4OPgRbEPGZRt9USeaysuwHe1sVqdyzfJB26BjvFfw/640?wx_fmt=png"></section><section><br mpa-from-tpl="t"></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>#其他可视化的方法；</span><br mpa-from-tpl="t"><span>#详细教程请参考</span><span><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzA5NzQzOTgzMw==&amp;mid=2650958283&amp;idx=1&amp;sn=81f3a2b7d7ec0c81af47f2aa5c23af42&amp;chksm=8b5610fdbc2199eb95ca3b09674260b81ab748742cd74fb8346a93ae4d2439f460acd0e8eb3c&amp;scene=21#wechat_redirect" textvalue="《在GSEA中标注候选基因原来如此简单！》" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2">《在GSEA中标注候选基因原来如此简单！》</a></span><span>一文；</span><br mpa-from-tpl="t"><span>devtools</span>::install_github(<span>"junjunlab/GseaVis"</span>)<br mpa-from-tpl="t"><span>library</span>(GseaVis)<br mpa-from-tpl="t"><span>#自定义配色1：</span><br mpa-from-tpl="t"><span>gseaNb</span>(object = h.all_res,<br mpa-from-tpl="t"><span>geneSetID</span> = h.all_res@result$ID[5],<br mpa-from-tpl="t"><span>subPlot</span> = 3,<br mpa-from-tpl="t"><span>addPval</span> = T,<br mpa-from-tpl="t"><span>pvalX</span> = 0.95,<br mpa-from-tpl="t"><span>pvalY</span> = 0.8,<br mpa-from-tpl="t"><span>curveCol</span> = c(<span>"#FF9999"</span>,<span>"#99CC00"</span>),<br mpa-from-tpl="t"><span>htCol</span> = c(<span>"#FF9999"</span>,<span>"#99CC00"</span>),<br mpa-from-tpl="t"><span>rankCol</span> = c(<span>"#FF9999"</span>, <span>"white"</span>, <span>"#99CC00"</span>))</code></pre></section><p><br mpa-from-tpl="t"></p><section><img data-ratio="0.9799498746867168" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6lIwVoat7Y8YzZqGdRGhkQ4nLfwzTwUkKDbIo1XTEic3qBTKnb4StQ7bCesTz3QxicocEFKDTYEERcA/640?wx_fmt=png" data-type="png" data-w="798" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6lIwVoat7Y8YzZqGdRGhkQ4nLfwzTwUkKDbIo1XTEic3qBTKnb4StQ7bCesTz3QxicocEFKDTYEERcA/640?wx_fmt=png"></section><section><br></section><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><svg viewbox="0 0 1 1"></svg></section></section></section><section><section powered-by="xiumi.us"><section><p><strong><strong><span>3.2 基于KEGG基因集进行GSEA</span></strong></strong></p></section></section><section powered-by="xiumi.us"><section><svg viewbox="0 0 1 1"></svg></section></section></section><section><section powered-by="xiumi.us"><p><br></p></section></section></section></section><section><br></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>#执行GSEA;</span><br mpa-from-tpl="t"><span>c2</span>.cp.kegg_res &lt;- GSEA(gene_list,TERM2GENE = c2.cp.kegg_gmt)<br mpa-from-tpl="t"><span>#预览分析结果；</span><br mpa-from-tpl="t"><span>head</span>(c2.cp.kegg_res@result[3:10])</code></pre></section><p><br mpa-from-tpl="t"></p><section><img data-ratio="0.5591677503250976" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6lIwVoat7Y8YzZqGdRGhkQ4AFRibGnTJDnuEexqJIYs1JeiaiaUrY2sd1RTF8QicPh8u6KCSlKr9ZXBbg/640?wx_fmt=png" data-type="png" data-w="1538" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6lIwVoat7Y8YzZqGdRGhkQ4AFRibGnTJDnuEexqJIYs1JeiaiaUrY2sd1RTF8QicPh8u6KCSlKr9ZXBbg/640?wx_fmt=png"></section><section><br mpa-from-tpl="t"></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>#对感兴趣基因集的富集结果进行可视化；</span><br mpa-from-tpl="t"><span>kgset</span>=<span>"KEGG_OXIDATIVE_PHOSPHORYLATION"</span><br mpa-from-tpl="t"><span>kgsetid</span>&lt;- c2.cp.kegg_res@result$ID<br mpa-from-tpl="t"><span>#获取位置编号；</span><br mpa-from-tpl="t"><span>index2</span> &lt;- which(kgsetid==kgset)<br mpa-from-tpl="t"><span>#绘制富集结果；</span><br mpa-from-tpl="t"><span>gseaplot2</span>(c2.cp.kegg_res,<br mpa-from-tpl="t"><span>title</span> = c2.cp.kegg_res$Description[index2],<br mpa-from-tpl="t"><span>geneSetID</span> = index2)</code></pre></section><p><br mpa-from-tpl="t"></p><section><img data-ratio="0.9364937388193202" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6lIwVoat7Y8YzZqGdRGhkQ4P4hl5yiakLOJUMBSLspgblia9iaUDKX6wk1WQgALSu6eiadV4TT8yGiamqQ/640?wx_fmt=png" data-type="png" data-w="1118" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6lIwVoat7Y8YzZqGdRGhkQ4P4hl5yiakLOJUMBSLspgblia9iaUDKX6wk1WQgALSu6eiadV4TT8yGiamqQ/640?wx_fmt=png"></section><section><br mpa-from-tpl="t"></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>#自定义配色2：</span><br mpa-from-tpl="t"><span>gseaNb</span>(object = c2.cp.kegg_res,<br mpa-from-tpl="t"><span>geneSetID</span> = c2.cp.kegg_res@result$ID[index2],<br mpa-from-tpl="t"><span>subPlot</span> = 3,<br mpa-from-tpl="t"><span>addPval</span> = T,<br mpa-from-tpl="t"><span>pvalX</span> = 0.95,<br mpa-from-tpl="t"><span>pvalY</span> = 0.8,<br mpa-from-tpl="t"><span>curveCol</span> = c(<span>"#99CC00"</span>,<span>"#c77cff"</span>),<br mpa-from-tpl="t"><span>htCol</span> = c(<span>"#99CC00"</span>,<span>"#c77cff"</span>),<br mpa-from-tpl="t"><span>rankCol</span> = c(<span>"#99CC00"</span>, <span>"white"</span>, <span>"#c77cff"</span>))</code></pre></section><p><br mpa-from-tpl="t"></p><section><img data-ratio="0.9644549763033176" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6lIwVoat7Y8YzZqGdRGhkQ4B5pDE3PjOL0ut28djPNtpucO1T1e20ddibQNlUJYVvDFNBX8zib3Xzwg/640?wx_fmt=png" data-type="png" data-w="844" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6lIwVoat7Y8YzZqGdRGhkQ4B5pDE3PjOL0ut28djPNtpucO1T1e20ddibQNlUJYVvDFNBX8zib3Xzwg/640?wx_fmt=png"></section><section><span></span></section><section><br></section><section><span>好啦，本次的分享就先到这里！</span></section><section><span><br></span></section><section data-role="paragraph"><section><section hm_fix="368:481"><section><img data-ratio="0.8181818181818182" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6lIwVoat7Y8YzZqGdRGhkQ4PY3sgkMvJbXsEfrgg1GwNibGHBCrwtlwtw7R2wbmxhjUrNI3oib96WkA/640?wx_fmt=png" data-type="png" data-w="44" data-width="100%" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6lIwVoat7Y8YzZqGdRGhkQ4PY3sgkMvJbXsEfrgg1GwNibGHBCrwtlwtw7R2wbmxhjUrNI3oib96WkA/640?wx_fmt=png"></section><section><section data-brushtype="text"><strong><span>参考资料</span></strong></section><section data-width="100%"><br></section></section></section></section></section><section><span>https://yulab-smu.top/biomedical-knowledge-mining-book/enrichplot.html</span></section><section><span><br></span></section><section><span><strong><span>*未经许可，不得以任何方式复制或抄袭本篇文章之部分或全部内容。版权所有，侵权必究。</span></strong></span></section><section><span><br></span></section><section data-role="outer" label="Powered by 135editor.com"><section data-tools="135编辑器" data-id="105648"><section><section data-role="outer" label="Powered by 135editor.com"><section data-role="paragraph"><section data-role="outer" label="Powered by 135editor.com"><section data-tools="135编辑器" data-id="105648"><section><section><img data-ratio="0.8928571428571429" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6kCKJYcEqEIfoJYG621mPJE8VibmibGU0Jxic9iabARVRH0FT6BNE8VAglWFXBPibFAU7a6tWGibSs8wyUg/640?wx_fmt=png" data-type="png" data-w="41" data-width="100%" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6kCKJYcEqEIfoJYG621mPJE8VibmibGU0Jxic9iabARVRH0FT6BNE8VAglWFXBPibFAU7a6tWGibSs8wyUg/640?wx_fmt=png"></section><section><section><section data-width="35%"><section><section data-width="100%"><img data-ratio="1" data-src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/tgUVxVRjT6kCKJYcEqEIfoJYG621mPJEv5etCBwHicqbEPwnVrkpaasxqaVibM4mT2JdIuN6yTlYWDD4mL5A427A/640?wx_fmt=jpeg" data-type="jpeg" data-w="860" data-width="100%" title="SCIPainter 30cm二维码.jpg" src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/tgUVxVRjT6kCKJYcEqEIfoJYG621mPJEv5etCBwHicqbEPwnVrkpaasxqaVibM4mT2JdIuN6yTlYWDD4mL5A427A/640?wx_fmt=jpeg"></section></section></section><section data-width="50%"><section><section data-brushtype="text"><strong># SCIPainter</strong></section><section data-brushtype="text" hm_fix="361:593"><p>基迪奥旗下绘图公众号</p><p>分享科研绘图技能与工具</p><p>欢迎关注与转发~</p></section></section></section></section></section></section></section></section></section></section><section><br></section></section></section><section data-role="paragraph"><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><img data-ratio="1" data-src="https://mmbiz.qpic.cn/sz_mmbiz_gif/tgUVxVRjT6kCKJYcEqEIfoJYG621mPJEgMd0aMPtmrDjiaX8sBhfhicVteeHf1JicexSpUbS3fdS9SiboUVN7guaPw/640?wx_fmt=gif" data-type="gif" data-w="400" src="https://mmbiz.qpic.cn/sz_mmbiz_gif/tgUVxVRjT6kCKJYcEqEIfoJYG621mPJEgMd0aMPtmrDjiaX8sBhfhicVteeHf1JicexSpUbS3fdS9SiboUVN7guaPw/640?wx_fmt=gif"></section></section></section><section><section powered-by="xiumi.us"><section><p><span><strong>你的好友拍了拍你</strong></span></p><p><span><strong>并请你帮她点一下</strong></span><span><strong><span>“分享”</span></strong></span><span><strong><span>~</span></strong></span></p></section></section></section></section></section><p><br></p></section></section><section><span></span></section><p><mp-style-type data-value="10000"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/qmSGsEKZ2ooTGHthkxfkqw",target="_blank" rel="noopener noreferrer">原文链接</a>
