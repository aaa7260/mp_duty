---
title: "怎么就把免疫细胞里面的B细胞弄丢了呢"
date: 2023-05-05T12:35:27Z
draft: ["false"]
tags: [
  "fetched",
  "生信菜鸟团"
]
categories: ["Acdemic"]
---
怎么就把免疫细胞里面的B细胞弄丢了呢 by 生信菜鸟团
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><blockquote data-tool="mdnice编辑器"><p>看到了新鲜出炉的一个nature文章：《<strong>PI3Kβ controls immune evasion in PTEN- deficient breast tumours</strong>》，虽然是 19 April 2023发表，但是是November 2020投稿的，也挺不容易的，里面针对3种小鼠模型都做了3个重复的单细胞数据；https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE224906</p></blockquote><pre data-tool="mdnice编辑器"><span></span><code>GSM7035400 PP_M1<br>GSM7035401 PPA_M2<br>GSM7035402 PPB_M3<br>GSM7035403 PP_M4<br>GSM7035404 PPA_M5<br>GSM7035405 PPB_M6<br>GSM7035406 PP_M7<br>GSM7035407 PPA_M8<br>GSM7035408 PPB_M9<br></code></pre><p data-tool="mdnice编辑器">作者也提供了表达量矩阵和注释信息：</p><pre data-tool="mdnice编辑器"><span></span><code>GSE224906_pi3k_merged_counts.txt.gz 17.7 Mb  <br>GSE224906_pi3k_merged_metadata.txt.gz 99.4 Kb  <br></code></pre><p data-tool="mdnice编辑器">虽然是9个样品的单细胞转录组，但是因为并不是10x单细胞技术，所以合起来也就是不到1万个细胞，非常简单就可以降维聚类分群啦， 让我们先看看作者的亚群命名：</p><p><img data-galleryid="" data-ratio="1.5959183673469388" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wwaC5ggfTYia6aAguX0P9quIQ8AabaLCn2NfokeBY8qrdmZsM6WibcotmFvAofCrrn1UCYS0KxJkmPw/640?wx_fmt=png" data-type="png" data-w="490" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wwaC5ggfTYia6aAguX0P9quIQ8AabaLCn2NfokeBY8qrdmZsM6WibcotmFvAofCrrn1UCYS0KxJkmPw/640?wx_fmt=png"></p><figure data-tool="mdnice编辑器"><figcaption>作者的亚群命名</figcaption></figure><p data-tool="mdnice编辑器">非常有意思的是明明是CD45流式细胞术筛选了免疫细胞，但是里面居然没有B细胞。所以作者就是针对T细胞进行进一步的降维聚类分群，如下所示：</p><p><img data-galleryid="" data-ratio="1.1780415430267062" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wwaC5ggfTYia6aAguX0P9quIR62Yiaqia8tm3DgR9aWlKfbwIO30Y6npFJh1ThPvFjRasXrpqd4Z6hLQ/640?wx_fmt=png" data-type="png" data-w="674" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wwaC5ggfTYia6aAguX0P9quIR62Yiaqia8tm3DgR9aWlKfbwIO30Y6npFJh1ThPvFjRasXrpqd4Z6hLQ/640?wx_fmt=png"></p><figure data-tool="mdnice编辑器"><figcaption>针对T细胞进行进一步的降维聚类分群</figcaption></figure><p data-tool="mdnice编辑器">作者仍然是不走寻常路，并不是常规的T细胞的各个功能亚群（naive, memory ，effector，cytotoxic，Exhaustion）的命名方式，而是针对这个无监督聚类的4个亚群的表达量比较高的基因去进行生物学功能注释后给名字，蛮有意思的。</p><p data-tool="mdnice编辑器">因为它发nature，所以我这样的科研小透明也不好说什么。</p><p data-tool="mdnice编辑器">我试试看读取它的文件走流程看看是不是真的b细胞缺失吧，首先读取作者提供的两个txt文件后构建Seurat对象：</p><pre data-tool="mdnice编辑器"><span></span><code><br>rm(list=ls())<br>options(stringsAsFactors = <span>F</span>) <br><span>source</span>(<span>'scRNA_scripts/lib.R'</span>)<br><br><span>###### step1:导入数据 ######   </span><br><span># 付费环节 800 元人民币</span><br>a=fread(<span>'GSE224906_pi3k_merged_counts.txt.gz'</span>,data.table = <span>F</span>)<br>a[<span>1</span>:<span>4</span>,<span>1</span>:<span>4</span>]<br>rownames(a)=a[,<span>1</span>]<br>a=a[,-<span>1</span>]<br>phe=str_split(colnames(a),<span>'[_]'</span>,simplify = <span>T</span>)<br>phe=fread(<span>'GSE224906_pi3k_merged_metadata.txt.gz'</span>,data.table = <span>F</span>) <br>rownames(phe)=colnames(a)<br>sce.all=CreateSeuratObject(counts = a,meta.data = phe) <br>identical(sce.all$nFeature_RNA,sce.all$nGene)<br>sce.all$orig.ident = sce.all$mouse_id<br>table(sce.all$orig.ident)<br>sce.all$group = sce.all$GEM  <br></code></pre><p data-tool="mdnice编辑器">有了sce.all变量命名的对象就很容易降维聚类分群啦，记得harmony一下哦，就可以得到如下所示的图表：</p><p><img data-galleryid="" data-ratio="0.9074074074074074" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wwaC5ggfTYia6aAguX0P9quIL9gVOcTsJhRuADlicg0NMCVfdpTiczmJNOs8l6pVmcvapNUiaOwWsUhMA/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wwaC5ggfTYia6aAguX0P9quIL9gVOcTsJhRuADlicg0NMCVfdpTiczmJNOs8l6pVmcvapNUiaOwWsUhMA/640?wx_fmt=png"></p><figure data-tool="mdnice编辑器"><figcaption>降维聚类分群</figcaption></figure><p data-tool="mdnice编辑器">如果大家背诵了上面的基因，很容易看到7是t细胞啦，10应该是nk，虽然基因并没有在上面的图里面进行高亮。</p><p data-tool="mdnice编辑器">然后 9 是单核细胞，11看起来是pDC但是不知道为什么大量表达了cd4和cd8，让我很意外，12是dc1，17是特殊dc3</p><p data-tool="mdnice编辑器">然后1,12,18是增值状态的巨噬细胞，剩余的都是巨噬细胞。我简单看了看我的命名，应该是比文章好一点：</p><p><img data-galleryid="" data-ratio="0.37777777777777777" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wwaC5ggfTYia6aAguX0P9quIRT4z9y18GMU8AU2qa0oO4dalqGEKF9q9OGibqgTj5qouEWKm735LmjA/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wwaC5ggfTYia6aAguX0P9quIRT4z9y18GMU8AU2qa0oO4dalqGEKF9q9OGibqgTj5qouEWKm735LmjA/640?wx_fmt=png"></p><figure data-tool="mdnice编辑器"><figcaption>我的命名</figcaption></figure><p data-tool="mdnice编辑器">其实文章也没有什么原则上的错误，如下所示：</p><p><img data-galleryid="" data-ratio="0.4740740740740741" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wwaC5ggfTYia6aAguX0P9quICpzfPGBwntcX1Nzk0Y7Jzb0uRSwTJb86whFPicXCn6Naabyiaa7Pm7Og/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wwaC5ggfTYia6aAguX0P9quICpzfPGBwntcX1Nzk0Y7Jzb0uRSwTJb86whFPicXCn6Naabyiaa7Pm7Og/640?wx_fmt=png"></p><figure data-tool="mdnice编辑器"><figcaption>文章也没有什么原则上的错误</figcaption></figure><p data-tool="mdnice编辑器">我区分了巨噬细胞和单核细胞，作者不区分有没有问题，毕竟我其实本来就可以区分增殖状态的细胞也是偷懒了。</p><p data-tool="mdnice编辑器">然后我区分了DC1和DC3，有意思的是部分本来应该是巨噬细胞的不知道为什么会被作者“错误”的划分到了树突细胞，特好玩的。单细胞亚群命名靠的就是生物学背景，比如免疫细胞里面的髓系和B细胞细分亚群：</p><ul data-tool="mdnice编辑器"><li><section><a href="https://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247506948&amp;idx=1&amp;sn=025d7f91abfa1b68d7910c86cf709e43&amp;scene=21#wechat_redirect" data-linktype="2">B细胞细分亚群</a></section></li><li><section><a href="https://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247506971&amp;idx=1&amp;sn=f0242285e2c827d922f938d9858d4ffe&amp;scene=21#wechat_redirect" data-linktype="2">髓系免疫细胞细分亚群</a></section></li></ul><p data-tool="mdnice编辑器">可惜的是确实这个单细胞数据集里面的免疫细胞里面的B细胞弄丢了，不知道是不是单细胞技术问题，毕竟并不是10x技术，但是可以看到哪怕是很差的单细胞数据质量也不影响它发CNS哦。</p></section><p data-tool="mdnice编辑器">强烈建议你推荐给身边的<strong>博士后以及年轻生物学PI</strong>，多一点数据认知，让他们的科研上一个台阶：</p><ul data-tool="mdnice编辑器"><li><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247521372&amp;idx=1&amp;sn=373dcb6bd096e42961254c96480c0676&amp;chksm=9b4bd4e7ac3c5df17b9d27667a7ce8daebca8d58776c7f7d914b6c4d5c524eaa5450c11fc458&amp;scene=21#wechat_redirect" textvalue="生物信息学马拉松授课（买‍一得五）" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1">生物信息学马拉松授课（买一得五）</a> ，你的生物信息学入门课（4月3号开课）</section></li><li><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247519765&amp;idx=2&amp;sn=6cb33654c7751f4c3df0f84743f77aaf&amp;chksm=9b4bceaeac3c47b8899afc00077b96357b87a4ed6b75e7c434ba14071fd6c8448e4c218de5e0&amp;scene=21#wechat_redirect" textvalue="144线程640Gb内存服务器共享一年仍然是仅需800" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1">144线程640Gb内存服务器共享一年仍然是仅需800</a></section></li><li><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247519765&amp;idx=1&amp;sn=ce5a8c8182f854c88043059f8c2cb9ff&amp;chksm=9b4bceaeac3c47b88c19941d43dbb1401f3a92206481a0afc41159927868199643f795d62a7e&amp;scene=21#wechat_redirect" textvalue="千呼万唤始出来的独享生物信息学云服务器" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1">千呼万唤始出来的独享生物信息学云服务器</a></section></li></ul><p><span>再怎么强调生物信息学数据处理的计算机基础都不为过，<span>我把它粗略的分成</span><strong>基于R语言的统计可视化，以及基于Linux的NGS数据处理</strong><span>：</span></span></p><ul data-tool="mdnice编辑器"><li><section>《<a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247491094&amp;idx=1&amp;sn=3a8ececefdf5894f4ef98b0823f204b8&amp;scene=21#wechat_redirect" data-linktype="2">生信分析人员如何系统入门R(2019更新版)</a>》</section></li><li><section>《<a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247491112&amp;idx=1&amp;sn=5c23959b4f36ba83532debdacf3eaa45&amp;scene=21#wechat_redirect" data-linktype="2">生信分析人员如何系统入门Linux(2019更新版)</a>》</section></li></ul><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/Zgr8AE6gSdu3s-RF1lMN9w",target="_blank" rel="noopener noreferrer">原文链接</a>
