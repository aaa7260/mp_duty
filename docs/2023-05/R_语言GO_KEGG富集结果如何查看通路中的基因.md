---
title: "R 语言GO,KEGG富集结果如何查看通路中的基因"
date: 2023-05-27T03:36:27Z
draft: ["false"]
tags: [
  "fetched",
  "生命数据科学"
]
categories: ["Acdemic"]
---
R 语言GO,KEGG富集结果如何查看通路中的基因 by 生命数据科学
------
<div><section><mp-common-profile data-pluginname="mpprofile" data-weui-theme="light" data-id="Mzk0MDI4MjM4NQ==" data-headimg="http://mmbiz.qpic.cn/mmbiz_png/Nf8QqUlJukMmaCXNABdtSPicSfZU9GMyI6PHia3Gqfy5DNMias3VicXY8Gh70vu1gibxsObqoGRRHYtJLKX6WbyeeNw/0?wx_fmt=png" data-nickname="生命数据科学" data-alias="Data_Research" data-signature="科研是天马行空的想象和脚踏实地的认真！" data-from="0" data-is_biz_ban="0"></mp-common-profile></section><section data-tool="markdown编辑器" data-website="https://markdown.com.cn/editor"><blockquote data-tool="markdown.com.cn编辑器"><p>当做完GO或KEGG富集分析后，通路中的结果是以<strong>Entrez ID</strong>进行展示的，常常不利于后续进行一个检查，因此，将<strong>Entrez ID</strong>转换为<strong>Gene symbol</strong>格式往往就非常必要，本文主要针对使用<strong>clusterProfiler包</strong>进行富集分析后，<strong>基因快速ID转换</strong>进行总结</p></blockquote><p data-tool="markdown.com.cn编辑器">输入数据来源于自带包<code>data(geneList, package="DOSE")</code>，物种为<code>人</code>，因此后面所用的包为<code>org.Hs.eg.db</code></p><pre data-tool="markdown.com.cn编辑器"><span></span><code>library(org.Hs.eg.db)<br>library(clusterProfiler)<br><br>data(geneList, package="DOSE")<br><br>&gt; head(geneList)<br>    4312     8318    10874    55143    55388      991 <br>4.572613 4.514594 4.418218 4.144075 3.876258 3.677857****<br><br>de &lt;- names(geneList)[1:100]<br>x &lt;- enrichKEGG(de)<br><br></code></pre><p data-tool="markdown.com.cn编辑器">查看富集分析结果<code>x</code></p><pre data-tool="markdown.com.cn编辑器"><span></span><code># 富集分析结果，geneID为Entrez ID<br>head(x, 3)<br>##                ID         Description GeneRatio  BgRatio       pvalue<br>## hsa04110 hsa04110          Cell cycle      8/47 126/8142 4.990001e-07<br>## hsa04218 hsa04218 Cellular senescence      7/47 156/8142 2.737780e-05<br>## hsa04114 hsa04114      Oocyte meiosis      6/47 131/8142 9.667769e-05<br>##              p.adjust       qvalue                               geneID Count<br>## hsa04110 5.988001e-05 5.462738e-05 8318/991/9133/890/983/4085/7272/1111     8<br>## hsa04218 1.642668e-03 1.498574e-03    2305/4605/9133/890/983/51806/1111     7<br>## hsa04114 3.867107e-03 3.527888e-03         991/9133/983/4085/51806/6790     6<br></code></pre><p data-tool="markdown.com.cn编辑器"><code>Entrez ID</code>转<code>Gene symbol</code></p><pre data-tool="markdown.com.cn编辑器"><span></span><code>data &lt;- setReadable(x, OrgDb = org.Hs.eg.db, keyType="ENTREZID")<br></code></pre><p data-tool="markdown.com.cn编辑器">查看结果,<code>gene ID</code>列转换为<code>Gene symbol</code>格式</p><pre data-tool="markdown.com.cn编辑器"><span></span><code>&gt; head(data,5)<br>               ID             Description GeneRatio  BgRatio       pvalue<br>hsa04110 hsa04110              Cell cycle     12/58 157/8463 4.655305e-10<br>hsa04218 hsa04218     Cellular senescence      7/58 156/8463 8.635565e-05<br>hsa04114 hsa04114          Oocyte meiosis      6/58 131/8463 2.566691e-04<br>hsa04814 hsa04814          Motor proteins      7/58 193/8463 3.233170e-04<br>hsa04657 hsa04657 IL-17 signaling pathway      5/58  94/8463 4.372874e-04<br>             p.adjust       qvalue<br>hsa04110 5.632919e-08 5.243343e-08<br>hsa04218 5.224517e-03 4.863187e-03<br>hsa04114 9.780339e-03 9.103926e-03<br>hsa04814 9.780339e-03 9.103926e-03<br>hsa04657 1.058236e-02 9.850475e-03<br>                                                                        geneID Count<br>hsa04110 CDC45/CDC20/CCNB2/NDC80/CCNA2/CDK1/MAD2L1/CDT1/TTK/AURKB/CHEK1/TRIP13    12<br>hsa04218                             FOXM1/MYBL2/CCNB2/CCNA2/CDK1/CALML5/CHEK1     7<br>hsa04114                                  CDC20/CCNB2/CDK1/MAD2L1/CALML5/AURKA     6<br>hsa04814                          KIF23/CENPE/KIF18A/KIF11/KIFC1/KIF18B/KIF20A     7<br>hsa04657                                      MMP1/S100A9/S100A8/S100A7/CXCL10     5<br></code></pre><p data-tool="markdown.com.cn编辑器">导出结果</p><pre data-tool="markdown.com.cn编辑器"><span></span><code>write.table(data,"KEGG_results.xls",sep = "\t",row.names = F,col.names = T,quote = F)<br></code></pre><p data-tool="markdown.com.cn编辑器">画个图看看</p><pre data-tool="markdown.com.cn编辑器"><span></span><code>data &lt;- data@result<br>data$Description &lt;- factor(data$Description,levels = data$Description) # factor,可在levels处排序<br><br><br>KEGG &lt;- ggplot(data[1:10,], aes(x=Description, y=Count,fill=pvalue)) +<br>  geom_bar(stat="identity", width=0.8) + # width可设置条形图宽度<br>  coord_flip() +<br>  xlab("") +<br>  theme_bw()+<br>  scale_fill_gradient(low = "#e2e071",  #设置p值low 和 high的颜色,最终是两种颜色渐变<br>                      high = "#7f3185")+<br>  theme_bw()+<br>  theme(panel.grid=element_blank())+<br>  theme(axis.title = element_text(size = 15,face = "bold",colour = "black"), # 可以设置标题字体大小、是否加粗、颜色<br>        axis.text = element_text(size=15,face = "bold",colour = "black"), #同理<br>        panel.border = element_rect(fill=NA,color="black", size=3, linetype="solid"), # 外围加框，fill为填充色<br>        axis.ticks = element_line(size = 2)) # 坐标轴线条加粗<br>KEGG<br>ggsave(KEGG, filename = "KEGG.png",width = 10, height = 7, units = "in")<br></code></pre><figure data-tool="markdown.com.cn编辑器"><img data-ratio="0.7" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/Nf8QqUlJukMR9nY2fHZibNuIN7ciaUNcnaT8ExPolP0IRdjcFV4pxiaVvsOTFE1aZh5ibPmxhFzH4S3xd2Nz5AZoSg/640?wx_fmt=png" data-type="png" data-w="3000" src="https://mmbiz.qpic.cn/sz_mmbiz_png/Nf8QqUlJukMR9nY2fHZibNuIN7ciaUNcnaT8ExPolP0IRdjcFV4pxiaVvsOTFE1aZh5ibPmxhFzH4S3xd2Nz5AZoSg/640?wx_fmt=png"><figcaption>KEGG.png</figcaption></figure><p data-tool="markdown.com.cn编辑器">收工~</p><p data-tool="markdown.com.cn编辑器">感谢观看，如果有用还请<span><strong>点赞，</strong><strong>关注，在看，转发！</strong></span></p><section><mp-common-profile data-pluginname="mpprofile" data-weui-theme="light" data-id="Mzk0MDI4MjM4NQ==" data-headimg="http://mmbiz.qpic.cn/mmbiz_png/Nf8QqUlJukMmaCXNABdtSPicSfZU9GMyI6PHia3Gqfy5DNMias3VicXY8Gh70vu1gibxsObqoGRRHYtJLKX6WbyeeNw/0?wx_fmt=png" data-nickname="生命数据科学" data-alias="Data_Research" data-signature="科研是天马行空的想象和脚踏实地的认真！" data-from="0" data-is_biz_ban="0"></mp-common-profile><br></section></section><p><br></p><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/ghW3fEnCgzj34YwXF19liQ",target="_blank" rel="noopener noreferrer">原文链接</a>
