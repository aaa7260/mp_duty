---
title: "GO富集分析及可视化，一把子拿捏！"
date: 2023-05-17T04:05:59Z
draft: ["false"]
tags: [
  "fetched",
  "基迪奥生物"
]
categories: ["Acdemic"]
---
GO富集分析及可视化，一把子拿捏！ by 基迪奥生物
------
<div><section data-mpa-powered-by="yiban.io"><span>TCGA转录组数据改</span><span>版后的整理可戳：<a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzA5NzQzOTgzMw==&amp;mid=2650928313&amp;idx=1&amp;sn=9dc3e0d0a94982f8ed8db30a40a4188d&amp;chksm=8b558d8fbc220499a1a36515a8c1d450b0dd030104abff78ff265e0f59438bad0b0bffdc2fe7&amp;scene=21#wechat_redirect" textvalue="《TCGA更新了？！最新数据处理拿捏住！》" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2">《TCGA更新了？！最新数据处理拿捏住！》</a></span></section><section><br></section><section><span>基于DESeq2的差异分析可戳：<a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzA5NzQzOTgzMw==&amp;mid=2650926611&amp;idx=1&amp;sn=316c0e340ce1968acabdb85d744962c1&amp;chksm=8b559725bc221e33ef3024877e025d662a82e4f1801ad5762f4dcf1792913a8509b0b12856e9&amp;scene=21#wechat_redirect" textvalue="《TCGA数据如何做差异分析？从数据下载到可视化！》" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2">《TCGA数据如何做差异分析？从数据下载到可视化！》</a></span></section><section><section><section data-role="splitline" data-tools="135编辑器" data-id="108183"><section><section hm_fix="372:343"><section data-width="100%"><br></section><section><img data-ratio="1.1608391608391608" data-type="gif" data-w="143" data-width="100%" data-src="https://mmbiz.qpic.cn/mmbiz_gif/6kvRq2WRXpiatV2XicfRyibOKSv5HRr70iaCfXAUlt4jUAzB8w92wW8YsAJGnJhQf4VibLOuCdCH0d5o0qcsibfbOQwg/640?wx_fmt=gif" src="https://mmbiz.qpic.cn/mmbiz_gif/6kvRq2WRXpiatV2XicfRyibOKSv5HRr70iaCfXAUlt4jUAzB8w92wW8YsAJGnJhQf4VibLOuCdCH0d5o0qcsibfbOQwg/640?wx_fmt=gif"></section><section data-width="100%"><br></section></section></section><section data-role="paragraph"><p><br></p></section></section></section></section><section><span>上周我们学习了基于clusterProfiler包的KEGG富集分析及可视化展示，可戳：<a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzA5NzQzOTgzMw==&amp;mid=2650931485&amp;idx=1&amp;sn=6f3d5f842b19252869e6a2b5955bccc0&amp;chksm=8b56782bbc21f13ddf2a9f94c82efef9b2cebdd64b65c248667c46b0523764a3dce6619bbfd0&amp;scene=21#wechat_redirect" textvalue="《KEGG富集分析及可视化，一把子拿捏！》" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2">《KEGG富集分析及可视化，一把子拿捏！》</a></span></section><section><br></section><section><span>这周我们继续学习GO富集分析，仍从导入DESeq2得到的差异分析结果表开始，包括</span><span><strong>差异基因提取、gene ID转换、GO富集分析、富集因子计算、可视化展示</strong></span><span>等，在可视化部分会包含一些小细节，比如</span><span><strong>创建自定义函数简化代码提高效率、term过长字符串的换行或省略、三个ontology合并展示如何用不同颜色的y轴标签进行区分</strong></span><span>等等。</span></section><section><br></section><section data-role="outer" label="Powered by 135editor.com"><section data-tools="135编辑器" data-id="94063"><section hm_fix="271:265"><section><section data-bgless="spin" data-bglessp="280"><br></section><section><span><span><strong>PS</strong></span></span></section></section></section></section></section><p><span>有童鞋在后台问关于</span><span><strong>非模式物种</strong></span><span>注释和GO富集，由于本篇使用的是人类癌症数据，有现成的Homo sapiens注释包，所以没有这个苦恼，关于非模注释并使用clusterProfiler完成富集指导可以直接跳转文末收看。</span></p><section><span></span></section><section><br></section><section><span>那么马上开始今天的学习！</span></section><section><br></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>#相关R包载入（还有部分R包使用前再载入）：</span><br mpa-from-tpl="t"><span>library</span>(dplyr)#数据清洗<br mpa-from-tpl="t"><span>library</span>(stringr)<br mpa-from-tpl="t"><span>library</span>(org.Hs.eg.db)#物种注释(Homo sapiens)<br mpa-from-tpl="t"><span>library</span>(clusterProfiler)#富集分析<br mpa-from-tpl="t"><span>library</span>(ggplot2)#个性化绘图<br mpa-from-tpl="t"><span>library</span>(RColorBrewer)#配色调整<br mpa-from-tpl="t"><br mpa-from-tpl="t"><span>#差异分析结果表格导入（结果来自往期推文整理）：</span><br mpa-from-tpl="t"><span>load</span>(<span>"TCGA_CHOL_DESeq2.Rdata"</span>)<br mpa-from-tpl="t"><span>head</span>(DESeq2)</code></pre></section><p><br mpa-from-tpl="t"></p><section><span></span></section><section><img data-ratio="0.1863149216817807" data-type="png" data-w="1213" data-src="https://mmbiz.qpic.cn/mmbiz_png/6kvRq2WRXpiaCujUCPWNHuInrf6rVDH4dVsMHlBNian1CAVuIy7gnkPtTsiaEwJKiceRGavPOQW9jicnMwSHNwor0pw/640?wx_fmt=png" src="https://mmbiz.qpic.cn/mmbiz_png/6kvRq2WRXpiaCujUCPWNHuInrf6rVDH4dVsMHlBNian1CAVuIy7gnkPtTsiaEwJKiceRGavPOQW9jicnMwSHNwor0pw/640?wx_fmt=png"></section><section><br></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>#添加上下调基因分组标签：</span><br mpa-from-tpl="t"><span>DESeq2</span>$group &lt;- case_when(<br mpa-from-tpl="t"><span>DESeq2</span>$log2FoldChange &gt; 2 &amp; DESeq2$pvalue &lt; 0.05 ~ <span>"up"</span>,<br mpa-from-tpl="t"><span>DESeq2</span>$log2FoldChange &lt; -2 &amp; DESeq2$pvalue &lt; 0.05 ~ <span>"down"</span>,<br mpa-from-tpl="t"><span>abs</span>(DESeq2$log2FoldChange) &lt;= 2 ~ <span>"none"</span>,<br mpa-from-tpl="t"><span>DESeq2</span>$pvalue &gt;= 0.05 ~ <span>"none"</span><br mpa-from-tpl="t">)<br mpa-from-tpl="t"><span>head</span>(DESeq2)</code></pre></section><p><br mpa-from-tpl="t"></p><section><span></span></section><section><img data-ratio="0.1863149216817807" data-type="png" data-w="1213" data-src="https://mmbiz.qpic.cn/mmbiz_png/6kvRq2WRXpiaCujUCPWNHuInrf6rVDH4d68u6LQc86OcB4Y88ZDia5RmbUD4ct5uODRDic5IGpd17Ow9JsaYBNhiaQ/640?wx_fmt=png" src="https://mmbiz.qpic.cn/mmbiz_png/6kvRq2WRXpiaCujUCPWNHuInrf6rVDH4d68u6LQc86OcB4Y88ZDia5RmbUD4ct5uODRDic5IGpd17Ow9JsaYBNhiaQ/640?wx_fmt=png"></section><section><br></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>#根据研究目的筛选差异基因(仅上调、下调或者全部)：</span><br mpa-from-tpl="t"><span>up</span> &lt;- rownames(DESeq2)[DESeq2$group==<span>"up"</span>]#差异上调<br mpa-from-tpl="t"><span>down</span> &lt;- rownames(DESeq2)[DESeq2$group==<span>"down"</span>]#差异下调<br mpa-from-tpl="t"><span>diff</span> &lt;- c(up,down)#所有差异基因<br mpa-from-tpl="t"><span>head</span>(up)<br mpa-from-tpl="t"><span>head</span>(down)</code></pre></section><p><br mpa-from-tpl="t"></p><section><span></span></section><section><img data-ratio="0.09810387469084914" data-type="png" data-w="1213" data-src="https://mmbiz.qpic.cn/mmbiz_png/6kvRq2WRXpiaCujUCPWNHuInrf6rVDH4dibs4hAKHgPr5AF70QIf9N4ibnoJp3kjIOE52W9aDiaHgZ5RbL19a4te0A/640?wx_fmt=png" src="https://mmbiz.qpic.cn/mmbiz_png/6kvRq2WRXpiaCujUCPWNHuInrf6rVDH4dibs4hAKHgPr5AF70QIf9N4ibnoJp3kjIOE52W9aDiaHgZ5RbL19a4te0A/640?wx_fmt=png"></section><section><br></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>#ID转换：</span><br mpa-from-tpl="t"><span>#查看可转换的ID类型：</span><br mpa-from-tpl="t"><span>columns</span>(org.Hs.eg.db)<br mpa-from-tpl="t"><br mpa-from-tpl="t"><span>##使用clusterProfiler包自带ID转换函数bitr(基于org.Hs.eg.db)：</span><br mpa-from-tpl="t"><span>#up：</span><br mpa-from-tpl="t"><span>up_entrez</span> &lt;- bitr(up,<br mpa-from-tpl="t"><span>fromType</span> = <span>"SYMBOL"</span>,#现有的ID类型<br mpa-from-tpl="t"><span>toType</span> = <span>"ENTREZID"</span>,#需转换的ID类型<br mpa-from-tpl="t"><span>OrgDb</span> = <span>"org.Hs.eg.db"</span>)<br mpa-from-tpl="t"><span>#down：</span><br mpa-from-tpl="t"><span>down_entrez</span> &lt;- bitr(down,<br mpa-from-tpl="t"><span>fromType</span> = <span>"SYMBOL"</span>,<br mpa-from-tpl="t"><span>toType</span> = <span>"ENTREZID"</span>,<br mpa-from-tpl="t"><span>OrgDb</span> = <span>"org.Hs.eg.db"</span>)<br mpa-from-tpl="t"><span>#diff：</span><br mpa-from-tpl="t"><span>diff_entrez</span> &lt;- bitr(diff,<br mpa-from-tpl="t"><span>fromType</span> = <span>"SYMBOL"</span>,<br mpa-from-tpl="t"><span>toType</span> = <span>"ENTREZID"</span>,<br mpa-from-tpl="t"><span>OrgDb</span> = <span>"org.Hs.eg.db"</span>)<br mpa-from-tpl="t"><span>head</span>(diff_entrez)</code></pre></section><p><br mpa-from-tpl="t"></p><section><span></span></section><section><img data-ratio="0.23662306777645659" data-type="png" data-w="841" data-src="https://mmbiz.qpic.cn/mmbiz_png/6kvRq2WRXpiaCujUCPWNHuInrf6rVDH4dgt8NSTcRvNO8RsmMemmblpp79AVtiaiciaN8nYemX03e2iajic32yajR1Aw/640?wx_fmt=png" src="https://mmbiz.qpic.cn/mmbiz_png/6kvRq2WRXpiaCujUCPWNHuInrf6rVDH4dgt8NSTcRvNO8RsmMemmblpp79AVtiaiciaN8nYemX03e2iajic32yajR1Aw/640?wx_fmt=png"></section><section><br></section><section><span>在GO富集分析中有三个Ontology，分别为：</span><span><strong>分子功能MF</strong></span><span>(Molecular Function)、</span><span><strong>细胞组分CC</strong></span><span>(Cellular Component)及</span><span><strong>生物过程BP</strong></span><span>(Biological Process)，我们在进行富集时，可以分别富集，也可以选择合并富集。</span></section><section><br></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>#GO(Gene Ontology)富集分析：</span><br mpa-from-tpl="t"><span>##MF(我们以总差异基因的GO富集为例):</span><br mpa-from-tpl="t"><span>GO_MF_diff</span> &lt;- enrichGO(gene = diff_entrez$ENTREZID, #用来富集的差异基因<br mpa-from-tpl="t"><span>OrgDb</span> = org.Hs.eg.db, #指定包含该物种注释信息的org包<br mpa-from-tpl="t"><span>ont</span> = <span>"MF"</span>, #可以三选一分别富集,或者<span>"ALL"</span>合并<br mpa-from-tpl="t"><span>pAdjustMethod</span> = <span>"BH"</span>, #多重假设检验矫正方法<br mpa-from-tpl="t"><span>pvalueCutoff</span> = 0.05,<br mpa-from-tpl="t"><span>qvalueCutoff</span> = 0.05,<br mpa-from-tpl="t"><span>readable</span> = TRUE) #是否将gene ID映射到gene name<br mpa-from-tpl="t"><span>#提取结果表格：</span><br mpa-from-tpl="t"><span>GO_MF_result</span> &lt;- GO_MF_diff@result<br mpa-from-tpl="t"><span>View</span>(GO_MF_result)</code></pre></section><p><br mpa-from-tpl="t"></p><section><span></span></section><section><img data-ratio="0.4540622627182992" data-type="png" data-w="1317" data-src="https://mmbiz.qpic.cn/mmbiz_png/6kvRq2WRXpiaCujUCPWNHuInrf6rVDH4dibkOOCw9miaU1UNz7IX0439HHk2YltibSCn2DE7WXChjf6QqYLZkr7dIw/640?wx_fmt=png" src="https://mmbiz.qpic.cn/mmbiz_png/6kvRq2WRXpiaCujUCPWNHuInrf6rVDH4dibkOOCw9miaU1UNz7IX0439HHk2YltibSCn2DE7WXChjf6QqYLZkr7dIw/640?wx_fmt=png"></section><section><br></section><section><span>和KEGG富集结果表基本相同，共9列：</span></section><section><span>第一列（ID）：</span><span>GO term ID号</span></section><section><span>第二列（Description）：</span><span>GO term的功能描述</span></section><section><span>第三列（GeneRatio）：</span><span>差异基因中富集到该GO term的基因数/差异基因总数</span></section><section><span>第四列（BgRatio）：</span><span>背景基因中富集到该GO term的基因数/背景基因总数</span></section><section><span>第五列（pvalue）</span><span>：显著性p值</span></section><section><span>第六列（p.adjust）：</span><span>多重检验矫正后p值</span></section><section><span>第七列（qvalue）</span><span>：显著性q值</span></section><section><span>第八列（geneID）：</span><span>富集到这个GO term的差异基因（已转换为gene name）</span></section><section><span>第九列（Count）：</span><span>富集到该GO term的基因数量</span></section><section><br></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>#CC:</span><br mpa-from-tpl="t"><span>GO_CC_diff</span> &lt;- enrichGO(gene = diff_entrez$ENTREZID,<br mpa-from-tpl="t"><span>OrgDb</span> = org.Hs.eg.db,<br mpa-from-tpl="t"><span>ont</span> = <span>"CC"</span>,<br mpa-from-tpl="t"><span>pAdjustMethod</span> = <span>"BH"</span>,<br mpa-from-tpl="t"><span>pvalueCutoff</span> = 0.05,<br mpa-from-tpl="t"><span>qvalueCutoff</span> = 0.05,<br mpa-from-tpl="t"><span>readable</span> = TRUE)<br mpa-from-tpl="t"><span>#提取结果表格：</span><br mpa-from-tpl="t"><span>GO_CC_result</span> &lt;- GO_CC_diff@result<br mpa-from-tpl="t"><br mpa-from-tpl="t"><span>#BP:</span><br mpa-from-tpl="t"><span>GO_BP_diff</span> &lt;- enrichGO(gene = diff_entrez$ENTREZID,<br mpa-from-tpl="t"><span>OrgDb</span> = org.Hs.eg.db,<br mpa-from-tpl="t"><span>ont</span> = <span>"BP"</span>,<br mpa-from-tpl="t"><span>pAdjustMethod</span> = <span>"BH"</span>,<br mpa-from-tpl="t"><span>pvalueCutoff</span> = 0.05,<br mpa-from-tpl="t"><span>qvalueCutoff</span> = 0.05,<br mpa-from-tpl="t"><span>readable</span> = TRUE)<br mpa-from-tpl="t"><span>#提取结果表格：</span><br mpa-from-tpl="t"><span>GO_BP_result</span> &lt;- GO_BP_diff@result<br mpa-from-tpl="t"><br mpa-from-tpl="t"><span>#MF、CC、BP三合一：</span><br mpa-from-tpl="t"><span>GO_all_diff</span> &lt;- enrichGO(gene = diff_entrez$ENTREZID,<br mpa-from-tpl="t"><span>OrgDb</span> = org.Hs.eg.db,<br mpa-from-tpl="t"><span>ont</span> = <span>"ALL"</span>, #三合一选择“<span>ALL</span>”<br mpa-from-tpl="t"><span>pAdjustMethod</span> = <span>"BH"</span>,<br mpa-from-tpl="t"><span>pvalueCutoff</span> = 0.05,<br mpa-from-tpl="t"><span>qvalueCutoff</span> = 0.05,<br mpa-from-tpl="t"><span>readable</span> = TRUE)<br mpa-from-tpl="t"><span>#提取结果表格：</span><br mpa-from-tpl="t"><span>GO_all_result</span> &lt;- GO_all_diff@result<br mpa-from-tpl="t"><br mpa-from-tpl="t"><span>##保存GO富集结果：</span><br mpa-from-tpl="t"><span>save</span>(GO_MF_diff,GO_CC_diff,GO_BP_diff,GO_all_diff,file = c(<span>"GO_diff.Rdata"</span>))</code></pre></section><p><br></p><section><span>下面，可以先使用一些包装好的函数进行富集结果快速可视化：</span></section><section><br></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>#####快速可视化探索(以CC为例)：</span><br mpa-from-tpl="t"><span>BiocManager</span>::install(<span>"topGO"</span>)<br mpa-from-tpl="t"><span>library</span>(topGO)<br mpa-from-tpl="t"><span>library</span>(enrichplot)</code></pre></section><p><br></p><section><span>首先，我们绘制GO的有向无环图，这里有两个函数我们可以使用：</span></section><section><br></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>#GO有向无环图绘制(两种形式)：</span><br mpa-from-tpl="t"><span>goplot</span>(GO_CC_diff) #来自enrichplot</code></pre></section><p><br mpa-from-tpl="t"></p><section><span></span></section><section><img data-ratio="0.8595292331055429" data-type="png" data-w="1317" data-src="https://mmbiz.qpic.cn/mmbiz_png/6kvRq2WRXpiaCujUCPWNHuInrf6rVDH4dEGp2c0zNq2iaLdrlBDQibquo2hLs9kDLlM4GibhZhMavN5ZbQed3n2Ncw/640?wx_fmt=png" src="https://mmbiz.qpic.cn/mmbiz_png/6kvRq2WRXpiaCujUCPWNHuInrf6rVDH4dEGp2c0zNq2iaLdrlBDQibquo2hLs9kDLlM4GibhZhMavN5ZbQed3n2Ncw/640?wx_fmt=png"></section><section><br></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>plotGOgraph</span>(GO_CC_diff) #来自topGO</code></pre></section><p><br></p><section><img data-ratio="0.7560283687943262" data-type="png" data-w="1410" data-src="https://mmbiz.qpic.cn/mmbiz_png/6kvRq2WRXpiaCujUCPWNHuInrf6rVDH4duDbGsPibyJu8D7C4Jquau8siaY8ckCENECIicCq70YdrwG8pkXrrjYVJw/640?wx_fmt=png" src="https://mmbiz.qpic.cn/mmbiz_png/6kvRq2WRXpiaCujUCPWNHuInrf6rVDH4duDbGsPibyJu8D7C4Jquau8siaY8ckCENECIicCq70YdrwG8pkXrrjYVJw/640?wx_fmt=png"></section><section><br></section><section><span>有向无环图如何看相信大家都比较熟悉了，这里不再赘述。如果还不是熟悉的新童鞋可戳推文/论坛帖详细了解：</span></section><section><br></section><section><span>1. 《GO富集分析工具的使用与解读详细教程》：</span></section><section><span>https://www.omicshare.com/forum/thread-826-1-1.html</span></section><section><br></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzA5NzQzOTgzMw==&amp;mid=2650826394&amp;idx=1&amp;sn=040ca718d3c3e162d8263da35b215d7e&amp;chksm=8b541facbc2396ba48945b3ef231267b3bb39437643e01db692095973b3d5a4efe09057504bb&amp;scene=21#wechat_redirect" textvalue="《GO数据库的分类层级说明》" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2"><span>2. 《GO数据库的分类层级说明》</span></a></section><section><br></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>#GO富集条形图：</span><br mpa-from-tpl="t"><span>barplot</span>(<br mpa-from-tpl="t"><span>GO_CC_diff</span>,<br mpa-from-tpl="t"><span>x</span> = <span>"Count"</span>, #or <span>"GeneRatio"</span><br mpa-from-tpl="t"><span>color</span> = <span>"pvalue"</span>, #or <span>"p.adjust"</span> and <span>"qvalue"</span><br mpa-from-tpl="t"><span>showCategory</span> = 20,#显示前top20(enrichResult按照p值排序)<br mpa-from-tpl="t"><span>font</span>.size = 12,<br mpa-from-tpl="t"><span>title</span> = <span>"Cellular Component enrichment barplot"</span>,<br mpa-from-tpl="t"><span>label_format</span> = 30 #超过30个字符串换行<br mpa-from-tpl="t">)</code></pre></section><p><br></p><section><img data-ratio="1.010212765957447" data-type="png" data-w="1175" data-src="https://mmbiz.qpic.cn/mmbiz_png/6kvRq2WRXpiaCujUCPWNHuInrf6rVDH4dx40pbicia10eyjeLoThzGKnu1wKxGe6EQDouL059oUHSpWCxxvn1YusA/640?wx_fmt=png" src="https://mmbiz.qpic.cn/mmbiz_png/6kvRq2WRXpiaCujUCPWNHuInrf6rVDH4dx40pbicia10eyjeLoThzGKnu1wKxGe6EQDouL059oUHSpWCxxvn1YusA/640?wx_fmt=png"></section><section><br></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>#GO富集气泡图：</span><br mpa-from-tpl="t"><span>dotplot</span>(<br mpa-from-tpl="t"><span>GO_CC_diff</span>,<br mpa-from-tpl="t"><span>x</span> = <span>"GeneRatio"</span>,<br mpa-from-tpl="t"><span>color</span> = <span>"p.adjust"</span>,<br mpa-from-tpl="t"><span>title</span> = <span>"Top 20 of GO CC terms Enrichment"</span>,<br mpa-from-tpl="t"><span>showCategory</span> = 20,<br mpa-from-tpl="t"><span>label_format</span> = 30<br mpa-from-tpl="t">)</code></pre></section><p><br></p><section><img data-ratio="1.010212765957447" data-type="png" data-w="1175" data-src="https://mmbiz.qpic.cn/mmbiz_png/6kvRq2WRXpiaCujUCPWNHuInrf6rVDH4dCb5Upc3pkMYkQxKkm6I3xicdLEs4WHuDRgzF3VmyzbVZiagoiaVu2wF1g/640?wx_fmt=png" src="https://mmbiz.qpic.cn/mmbiz_png/6kvRq2WRXpiaCujUCPWNHuInrf6rVDH4dCb5Upc3pkMYkQxKkm6I3xicdLEs4WHuDRgzF3VmyzbVZiagoiaVu2wF1g/640?wx_fmt=png"></section><section><br></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>#富集网络图:</span><br mpa-from-tpl="t"><span>edo</span> &lt;- pairwise_termsim(GO_CC_diff)<br mpa-from-tpl="t"><span>emapplot</span>(edo,<br mpa-from-tpl="t"><span>layout</span> = <span>"kk"</span>, #布局形式<br mpa-from-tpl="t"><span>showCategory</span> = 30) #展示GO terms的数量</code></pre></section><p><br></p><section><img data-ratio="0.8485617597292724" data-type="png" data-w="1182" data-src="https://mmbiz.qpic.cn/mmbiz_png/6kvRq2WRXpiaCujUCPWNHuInrf6rVDH4d6m8asap0CltAna5ZtD6ETrCT5qJ86IZuZ9XmZxfVaAvKiclX9KavYGw/640?wx_fmt=png" src="https://mmbiz.qpic.cn/mmbiz_png/6kvRq2WRXpiaCujUCPWNHuInrf6rVDH4d6m8asap0CltAna5ZtD6ETrCT5qJ86IZuZ9XmZxfVaAvKiclX9KavYGw/640?wx_fmt=png"></section><section><br></section><section><span>用于</span><strong><span>展示不同GO terms（节点）间的基因重叠关系</span></strong><span>。如果两个GO terms内富集到的差异基因存在重叠，则说明这两个GO terms间存在overlap，用线条进行连接。节点的大小表示富集到基因的数量，颜色这里代表的是p.ajust，选择了p.ajust前top30的terms进行网络图绘制。</span></section><section><br></section><section><span>当然啦，对于常见的富集条形图和富集气泡图，我们还可以使用ggplot2美化：</span></section><section><br></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>####使用ggplot2进行可视化:</span><br mpa-from-tpl="t"><span>#取前top20，并简化命名：</span><br mpa-from-tpl="t"><span>MF</span> &lt;- GO_MF_result[1:20,]<br mpa-from-tpl="t"><span>CC</span> &lt;- GO_CC_result[1:20,]<br mpa-from-tpl="t"><span>BP</span> &lt;- GO_BP_result[1:20,]<br mpa-from-tpl="t"><br mpa-from-tpl="t"><span>#自定义主题</span><br mpa-from-tpl="t"><span>mytheme</span> &lt;- theme(axis.title = element_text(size = 13),<br mpa-from-tpl="t"><span>axis</span>.text = element_text(size = 11),<br mpa-from-tpl="t"><span>plot</span>.title = element_text(size = 14,<br mpa-from-tpl="t"><span>hjust</span> = 0.5,<br mpa-from-tpl="t"><span>face</span> = <span>"bold"</span>),<br mpa-from-tpl="t"><span>legend</span>.title = element_text(size = 13),<br mpa-from-tpl="t"><span>legend</span>.text = element_text(size = 11))</code></pre></section><p><br></p><section><span>在GO富集可视化中，一个非常高频出现的问题就是部分GO terms的功能描述特别长，一般作为y轴标签来说30-40个字符串已经算是比较长的了，有些terms的描述可以150、160多个字符串，即使跨行仍无法较好的展示。这种情况需要我们省略一部分内容，用“...”代替。</span></section><section><br></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>#在MF的Description中存在过长字符串，我们将长度超过50的部分用...代替：</span><br mpa-from-tpl="t"><span>MF2</span> &lt;- MF<br mpa-from-tpl="t"><span>MF2</span>$Description &lt;- str_trunc(MF$Description,width = 50,side = <span>"right"</span>)<br mpa-from-tpl="t"><span>MF2</span>$Description</code></pre></section><p><br></p><section><img data-ratio="0.5042301184433164" data-type="png" data-w="1182" data-src="https://mmbiz.qpic.cn/mmbiz_png/6kvRq2WRXpiaCujUCPWNHuInrf6rVDH4dz7hpwWZE7nq5QrPVubpvIxbh1taplCGQicb1kxVcYbfqVNvTELCy6Jw/640?wx_fmt=png" src="https://mmbiz.qpic.cn/mmbiz_png/6kvRq2WRXpiaCujUCPWNHuInrf6rVDH4dz7hpwWZE7nq5QrPVubpvIxbh1taplCGQicb1kxVcYbfqVNvTELCy6Jw/640?wx_fmt=png"></section><section><br></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>#指定绘图顺序（转换为因子）：</span><br mpa-from-tpl="t"><span>MF2</span>$term &lt;- factor(MF2$Description,levels = rev(MF2$Description))<br mpa-from-tpl="t"><span>CC</span>$term &lt;- factor(CC$Description,levels = rev(CC$Description))<br mpa-from-tpl="t"><span>BP</span>$term &lt;- factor(BP$Description,levels = rev(BP$Description))</code></pre></section><p><br></p><section><span>三个Ontology数据结构完全相同，因此我们可以用一个自定义函数包裹相同的绘图代码，提高效率。</span></section><section><br></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>#GO富集柱形图：</span><br mpa-from-tpl="t"><span>GO_bar</span> &lt;- function(x){<br mpa-from-tpl="t"><span>y</span> &lt;- get(x)<br mpa-from-tpl="t"><span>ggplot</span>(data = y,<br mpa-from-tpl="t"><span>aes</span>(x = Count,<br mpa-from-tpl="t"><span>y</span> = term,<br mpa-from-tpl="t"><span>fill</span> = -log10(pvalue))) +<br mpa-from-tpl="t"><span>scale_y_discrete</span>(labels = function(y) str_wrap(y, width = 50) ) + #label换行，部分term描述太长<br mpa-from-tpl="t"><span>geom_bar</span>(stat = <span>"identity"</span>,width = 0.8) +<br mpa-from-tpl="t"><span>labs</span>(x = <span>"Gene Number"</span>,<br mpa-from-tpl="t"><span>y</span> = <span>"Description"</span>,<br mpa-from-tpl="t"><span>title</span> = paste0(x,<span>" of GO enrichment barplot"</span>)) +<br mpa-from-tpl="t"><span>theme_bw</span>() +<br mpa-from-tpl="t"><span>mytheme</span><br mpa-from-tpl="t">}<br mpa-from-tpl="t"><br mpa-from-tpl="t"><span>#MF:</span><br mpa-from-tpl="t"><span>p1</span> &lt;- GO_bar(<span>"MF2"</span>)+scale_fill_distiller(palette = <span>"Blues"</span>,direction = 1)</code></pre></section><p><br></p><section><img data-ratio="0.8677443056576047" data-type="png" data-w="1361" data-src="https://mmbiz.qpic.cn/mmbiz_png/6kvRq2WRXpiaCujUCPWNHuInrf6rVDH4dqbK1jUfichLqVBc3vfklUqNM9eD29WjSH3LdDnTxtblDOdAk4J8aPLQ/640?wx_fmt=png" src="https://mmbiz.qpic.cn/mmbiz_png/6kvRq2WRXpiaCujUCPWNHuInrf6rVDH4dqbK1jUfichLqVBc3vfklUqNM9eD29WjSH3LdDnTxtblDOdAk4J8aPLQ/640?wx_fmt=png"></section><section><br></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>#CC:</span><br mpa-from-tpl="t"><span>p2</span> &lt;- GO_bar(<span>"CC"</span>)+scale_fill_distiller(palette = <span>"Reds"</span>,direction = 1)</code></pre></section><p><br></p><section><img data-ratio="0.8677443056576047" data-type="png" data-w="1361" data-src="https://mmbiz.qpic.cn/mmbiz_png/6kvRq2WRXpiaCujUCPWNHuInrf6rVDH4dVm5hjAor7uXLw94qOdBOSkkia5ibuRj4zkllFnURmX04vfKibVqfN13wA/640?wx_fmt=png" src="https://mmbiz.qpic.cn/mmbiz_png/6kvRq2WRXpiaCujUCPWNHuInrf6rVDH4dVm5hjAor7uXLw94qOdBOSkkia5ibuRj4zkllFnURmX04vfKibVqfN13wA/640?wx_fmt=png"></section><section><br></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>#BP:</span><br mpa-from-tpl="t"><span>p3</span> &lt;- GO_bar(<span>"BP"</span>)+scale_fill_distiller(palette = <span>"Oranges"</span>,direction = 1)</code></pre></section><p><br></p><section><img data-ratio="0.8677443056576047" data-type="png" data-w="1361" data-src="https://mmbiz.qpic.cn/mmbiz_png/6kvRq2WRXpiaCujUCPWNHuInrf6rVDH4dvmjm12YKg6204RGsaMjKMzRicDNtx3lwEwQiaojXXRlNFgZkbpEe1aGA/640?wx_fmt=png" src="https://mmbiz.qpic.cn/mmbiz_png/6kvRq2WRXpiaCujUCPWNHuInrf6rVDH4dvmjm12YKg6204RGsaMjKMzRicDNtx3lwEwQiaojXXRlNFgZkbpEe1aGA/640?wx_fmt=png"></section><section><br></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>#GO富集气泡图：</span><br mpa-from-tpl="t"><span>#计算富集因子(Rich Factor):</span><br mpa-from-tpl="t"><span>#MF:</span><br mpa-from-tpl="t"><span>rf</span>&lt;- apply(MF2,1,function(x){<br mpa-from-tpl="t"><span>GeneRatio</span> &lt;- eval(parse(text = x[<span>"GeneRatio"</span>]))<br mpa-from-tpl="t"><span>BgRatio</span> &lt;- eval(parse(text = x[<span>"BgRatio"</span>]))<br mpa-from-tpl="t"><span>RF</span>&lt;- round(GeneRatio/BgRatio,2)<br mpa-from-tpl="t"><span>RF</span><br mpa-from-tpl="t">})<br mpa-from-tpl="t"><span>MF2</span>$Rich_Factor &lt;- rf<br mpa-from-tpl="t"><span>##CC和BP计算方法相同（这里省略代码，不再重复展示）</span><br mpa-from-tpl="t"><br mpa-from-tpl="t"><span>#绘制GO富集气泡图：</span><br mpa-from-tpl="t"><span>GO_dot</span> &lt;- function(x){<br mpa-from-tpl="t"><span>y</span> = get(x)<br mpa-from-tpl="t"><span>ggplot</span>(data = y,<br mpa-from-tpl="t"><span>aes</span>(x = Rich_Factor,<br mpa-from-tpl="t"><span>y</span> = term)) +<br mpa-from-tpl="t"><span>geom_point</span>(aes(size = Count,<br mpa-from-tpl="t"><span>color</span> = -log10(pvalue))) + # 气泡大小及颜色设置<br mpa-from-tpl="t"><span>scale_y_discrete</span>(labels = function(y) str_wrap(y, width = 50) ) +<br mpa-from-tpl="t"><span>labs</span>(x = <span>"Rich Factor"</span>,<br mpa-from-tpl="t"><span>y</span> = <span>"Description"</span>,<br mpa-from-tpl="t"><span>title</span> = paste0(x,<span>"of GO enrichment Dotplot"</span>), # 设置坐标轴标题及图标题<br mpa-from-tpl="t"><span>size</span> = <span>"Gene Number"</span>) + # 设置图例颜色及大小<br mpa-from-tpl="t"><span>theme_bw</span>()+<br mpa-from-tpl="t"><span>mytheme</span><br mpa-from-tpl="t">}<br mpa-from-tpl="t"><br mpa-from-tpl="t"><span>#MF：</span><br mpa-from-tpl="t"><span>pp1</span> &lt;- GO_dot(<span>"MF2"</span>) + scale_color_distiller(palette = <span>"YlOrRd"</span>,direction = 1)</code></pre></section><p><br></p><section><img data-ratio="0.8677443056576047" data-type="png" data-w="1361" data-src="https://mmbiz.qpic.cn/mmbiz_png/6kvRq2WRXpiaCujUCPWNHuInrf6rVDH4dJKfHtmMKs0yO4CgbmqRZ9tfic1GvibKZCrHr3lNEBK1kibOWddTBwN6RQ/640?wx_fmt=png" src="https://mmbiz.qpic.cn/mmbiz_png/6kvRq2WRXpiaCujUCPWNHuInrf6rVDH4dJKfHtmMKs0yO4CgbmqRZ9tfic1GvibKZCrHr3lNEBK1kibOWddTBwN6RQ/640?wx_fmt=png"></section><section><br></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>#CC：</span><br mpa-from-tpl="t"><span>pp2</span> &lt;- GO_dot(<span>"CC"</span>) + scale_color_distiller(palette = <span>"YlGnBu"</span>,direction = 1)</code></pre></section><p><br></p><section><img data-ratio="0.8677443056576047" data-type="png" data-w="1361" data-src="https://mmbiz.qpic.cn/mmbiz_png/6kvRq2WRXpiaCujUCPWNHuInrf6rVDH4dx6IiaW3QhnRG41cmBpANmmVBib1q3MnVChlLcwqtly8FPvmnBjzMcn1w/640?wx_fmt=png" src="https://mmbiz.qpic.cn/mmbiz_png/6kvRq2WRXpiaCujUCPWNHuInrf6rVDH4dx6IiaW3QhnRG41cmBpANmmVBib1q3MnVChlLcwqtly8FPvmnBjzMcn1w/640?wx_fmt=png"></section><section><br></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>#BP：</span><br mpa-from-tpl="t"><span>pp3</span> &lt;- GO_dot(<span>"BP"</span>) + scale_color_distiller(palette = <span>"YlOrBr"</span>,direction = 1)</code></pre></section><p><br></p><section><img data-ratio="0.8677443056576047" data-type="png" data-w="1361" data-src="https://mmbiz.qpic.cn/mmbiz_png/6kvRq2WRXpiaCujUCPWNHuInrf6rVDH4dMeGxFj7sACiaawMGuxdNVqvTdXo3DlTmnPxOVYYdnjcu2DKeBrwgm4A/640?wx_fmt=png" src="https://mmbiz.qpic.cn/mmbiz_png/6kvRq2WRXpiaCujUCPWNHuInrf6rVDH4dMeGxFj7sACiaawMGuxdNVqvTdXo3DlTmnPxOVYYdnjcu2DKeBrwgm4A/640?wx_fmt=png"></section><section><br></section><section><span>除了将三个Ontology分别展示，我们也可以将</span><span><strong>三者合并</strong></span><span>后进行展示：</span></section><section><br></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>#将三个ontology拉通取top30(按照p值排序)绘图：</span><br mpa-from-tpl="t"><span>all_result</span> &lt;- arrange(GO_all_result,pvalue) #默认升序<br mpa-from-tpl="t"><br mpa-from-tpl="t"><span>#取top30：</span><br mpa-from-tpl="t"><span>all</span> &lt;- all_result[1:30,]<br mpa-from-tpl="t"><br mpa-from-tpl="t"><span>#指定绘图顺序（转换为因子）：</span><br mpa-from-tpl="t"><span>all</span>$term &lt;- factor(<span>all</span>$Description,levels = rev(<span>all</span>$Description))</code></pre></section><p><br></p><section><span>合并后，我们可以通过</span><span><strong>指定y轴标签颜色</strong></span><span>来区分不同的Ontology：</span></section><section><br></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>#自定义y轴标签颜色(区分不同ontology)：</span><br mpa-from-tpl="t"><span>col_function</span> &lt;- function(x){<br mpa-from-tpl="t"><span>col</span> &lt;- rep(<span>"black"</span>, length(x))<br mpa-from-tpl="t"><span>BP</span> &lt;- which(x %in% c(<span>"BP"</span>))<br mpa-from-tpl="t"><span>CC</span> &lt;- which(x %in% c(<span>"CC"</span>))<br mpa-from-tpl="t"><span>MF</span> &lt;- which(x %in% c(<span>"MF"</span>))<br mpa-from-tpl="t"><span>col</span>[BP] &lt;- <span>"#fc4d26"</span><br mpa-from-tpl="t"><span>col</span>[CC] &lt;- <span>"#1792c1"</span><br mpa-from-tpl="t"><span>col</span>[MF] &lt;- <span>"#3fad5d"</span><br mpa-from-tpl="t"><span>col</span><br mpa-from-tpl="t">}<br mpa-from-tpl="t"><br mpa-from-tpl="t"><span>y_text_color</span> &lt;- col_function(<span>all</span>$ONTOLOGY)<br mpa-from-tpl="t"><br mpa-from-tpl="t"><span>#绘制富集柱形图(代码同上，这里不再赘述)：</span><br mpa-from-tpl="t"><span>ppp1</span></code></pre></section><p><br></p><section><img data-ratio="0.8677443056576047" data-type="png" data-w="1361" data-src="https://mmbiz.qpic.cn/mmbiz_png/6kvRq2WRXpiaCujUCPWNHuInrf6rVDH4dPicria2hvge0zCbB1qEvsTLMULY8TsJ9ku88ficFY2TFxJquVxFC9WmTw/640?wx_fmt=png" src="https://mmbiz.qpic.cn/mmbiz_png/6kvRq2WRXpiaCujUCPWNHuInrf6rVDH4dPicria2hvge0zCbB1qEvsTLMULY8TsJ9ku88ficFY2TFxJquVxFC9WmTw/640?wx_fmt=png"></section><section><br></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>#绘制富集气泡图(代码同上，这里不再赘述)：</span><br mpa-from-tpl="t"><span>ppp2</span></code></pre></section><p><br></p><section><img data-ratio="0.8677443056576047" data-type="png" data-w="1361" data-src="https://mmbiz.qpic.cn/mmbiz_png/6kvRq2WRXpiaCujUCPWNHuInrf6rVDH4dib2NP9fPSRdX5e1uCO70Y78olCjvIxOkJwZgaicib48ib0fgw9xWxjzB0g/640?wx_fmt=png" src="https://mmbiz.qpic.cn/mmbiz_png/6kvRq2WRXpiaCujUCPWNHuInrf6rVDH4dib2NP9fPSRdX5e1uCO70Y78olCjvIxOkJwZgaicib48ib0fgw9xWxjzB0g/640?wx_fmt=png"></section><section><br></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>library</span>(patchwork)<br mpa-from-tpl="t"><span>ppp1</span>+ppp2</code></pre></section><p><br></p><section><img data-ratio="0.4163241338813858" data-type="png" data-w="1703" data-src="https://mmbiz.qpic.cn/mmbiz_png/6kvRq2WRXpiaCujUCPWNHuInrf6rVDH4dUU3mIFYHEgLPjrAezSeIVUcWCeq0icIUydP1CQ7zOEWQ0m6aqnYbIPQ/640?wx_fmt=png" src="https://mmbiz.qpic.cn/mmbiz_png/6kvRq2WRXpiaCujUCPWNHuInrf6rVDH4dUU3mIFYHEgLPjrAezSeIVUcWCeq0icIUydP1CQ7zOEWQ0m6aqnYbIPQ/640?wx_fmt=png"></section><section><br></section><section><span>将不同颜色映射到y轴标签后，可以清晰看出显著富集的前30个GO term主要来自BP，有三个来自CC。</span></section><section><br></section><section><span>当然啦，这里只展示了最常见的几种图表，不过，既然富集结果表已经到手，想必其它都难不倒大家啦，后续我们再继续为大家分享！</span></section><section><br></section><section data-role="outer" label="Powered by 135editor.com"><section data-tools="135编辑器" data-id="94063"><section hm_fix="271:265"><section><section data-bgless="spin" data-bglessp="280"><br></section><section><span><span><strong>PS</strong></span></span></section></section></section></section></section><p><span><strong><span>非模式物种如何使用clusterProfiler包完成富集分析？</span></strong></span><br></p><section><br></section><section><span>篇幅原因，这里展开不了，我们先查看作者说明：</span></section><section><img data-ratio="0.43215211754537597" data-type="png" data-w="1157" data-src="https://mmbiz.qpic.cn/mmbiz_png/6kvRq2WRXpiaCujUCPWNHuInrf6rVDH4dw9MJQCFtwbDn1CYOSDSoztScZIUFq4GegIibDFWUtVhrz9g6bSswRjQ/640?wx_fmt=png" src="https://mmbiz.qpic.cn/mmbiz_png/6kvRq2WRXpiaCujUCPWNHuInrf6rVDH4dw9MJQCFtwbDn1CYOSDSoztScZIUFq4GegIibDFWUtVhrz9g6bSswRjQ/640?wx_fmt=png"></section><section><span><br></span></section><section><span>总的来说，不管在哪做富集，非模式种的难点就是搞到背景注释文件（geneID和GO termID的对应关系），对于clusterProfiler包，需要OrgDb的对象作为背景注释，有几个方法：</span></section><section><br></section><section><span>1.首先，通过</span><span><strong>AnnotationHub</strong></span><span>或</span><span><strong>biomaRt</strong></span><span>包检索和下载注释文件：</span></section><section><br></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span># AnnotationHub或biomaRt包的安装和载入：</span><br mpa-from-tpl="t"><span>if</span> (!require(<span>"BiocManager"</span>, quiet = TRUE))<br mpa-from-tpl="t"><span>install</span>.packages(<span>"BiocManager"</span>)<br mpa-from-tpl="t"><br mpa-from-tpl="t"><span>BiocManager</span>::install(<span>"AnnotationHub"</span>)<br mpa-from-tpl="t"><span>BiocManager</span>::install(<span>"biomaRt"</span>)<br mpa-from-tpl="t"><br mpa-from-tpl="t"><span>library</span>(AnnotationHub)<br mpa-from-tpl="t"><span>library</span>(biomaRt)<br mpa-from-tpl="t"><br mpa-from-tpl="t"><span>#查看网页说明文档(篇幅原因，自行查阅学习)：</span><br mpa-from-tpl="t"><span>browseVignettes</span>(<span>"AnnotationHub"</span>)<br mpa-from-tpl="t"><span>browseVignettes</span>(<span>"biomaRt"</span>)</code></pre></section><p><br mpa-from-tpl="t"></p><section><span>如果能找到，下载对应的注释文件就可以直接做富集分析了。</span></section><section><br></section><section><span>2.如果没找到，就需要</span><span><strong>自行比对序列</strong></span><span>进行批量注释了，可以使用</span><span>eggNOG：http://eggnog-mapper.embl.de/</span><span> (在注释结果文件中，可同时获得序列映射的KO和GO号)；或者直接在OmicShare云工具平台进行注释：</span><span>https://www.omicshare.com/tools/Home/Soft/getsoft </span><span>（傻瓜式一键操作，各种注释全都支持哦）。</span></section><section><br></section><section><img data-ratio="0.6086404066073697" data-type="png" data-w="1574" data-src="https://mmbiz.qpic.cn/mmbiz_png/6kvRq2WRXpiaCujUCPWNHuInrf6rVDH4dVkQNCMp7vGnbqdmAgoDQkysK9vMPVxvqFuIRMYuB83jVKHYja5hezA/640?wx_fmt=png" src="https://mmbiz.qpic.cn/mmbiz_png/6kvRq2WRXpiaCujUCPWNHuInrf6rVDH4dVkQNCMp7vGnbqdmAgoDQkysK9vMPVxvqFuIRMYuB83jVKHYja5hezA/640?wx_fmt=png"></section><section><br></section><section><span>3.自行注释完成后，使用</span><span><strong>AnnotationForge</strong></span><span>创建注释包：</span></section><section><br></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>BiocManager</span>::install(<span>"AnnotationForge"</span>)#下载<br mpa-from-tpl="t"><span>browseVignettes</span>(<span>"AnnotationForge"</span>)#查看使用说明</code></pre></section><p><br></p><section><span>最后用创建好的注释包作为OrgDb对象进行富集分析即可。</span></section><section><br></section><section><span>当然，觉得麻烦可以直接在OmicShare云平台完成全套CNS级别的富集分析及可视化，无代码友好，还有更多美图哟！</span></section><section><br></section><section><span>那么今天的分享就到这里！</span></section><section><br></section><section><span>clusterProfiler网页说明：</span></section><section><span>https://yulab-smu.top/biomedical-knowledge-mining-book/index.html</span></section><section><br></section><p><span></span></p><section><section><section><section><section><section><svg viewbox="0 0 1 1"></svg></section></section></section></section><section><section><section><section><svg viewbox="0 0 1 1"></svg></section></section></section></section><section><section><section><section><section><section><svg viewbox="0 0 1 1"></svg></section></section></section><section><section><section><svg viewbox="0 0 1 1"></svg></section></section></section><section><section><section><svg viewbox="0 0 1 1"></svg></section></section></section></section></section></section><section><section><section><section><svg viewbox="0 0 1 1"></svg></section></section></section></section><section><section><section><section><svg viewbox="0 0 1 1"></svg></section></section></section></section></section></section><section><span></span><br></section><section><span><span>如果你还在为不知如何绘制SCI图表而忧愁，</span><span>还在为毕业论文制图效率低下而焦心，</span><span>或者想要找到一个生信学习、绘图软件学习、R语言学习的干货集中地……</span></span></section><section><br></section><section><span><span>关注一个</span><span>SCIPainter</span><span>就对了！什么叫大隐隐于市，什么叫酒香巷子深，什么叫少林寺的扫地僧！怀揣绘图绝技，深藏功名的就是它！</span><span>SCIPainter！！！</span></span></section><section><br></section><p><img data-galleryid="" data-ratio="0.922752808988764" data-s="300,640" data-type="jpeg" data-w="712" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/6kvRq2WRXpgmrHawRmrKq94ceUqwfJsbEZKuylpKibHF3FT148FTePJedurIZpWibX5jqbprh1FGWKxxore882PQ/640?wx_fmt=jpeg" src="https://mmbiz.qpic.cn/mmbiz_jpg/6kvRq2WRXpgmrHawRmrKq94ceUqwfJsbEZKuylpKibHF3FT148FTePJedurIZpWibX5jqbprh1FGWKxxore882PQ/640?wx_fmt=jpeg"></p><section><br></section><section><span><span>SCIPainter</span><span>是基迪奥旗下的科研图表类干货分享公众号，之后</span><span>更多</span><span>与科研图表绘制相关内容，我们会在这个账号中持续进行分享和发布，聪明的你一定不会错过！</span></span></section><section><br></section><section><span><span>左手一个</span><span>基迪奥生物</span><span>，右手一个</span><span>SCIPainter</span><span>，老板再也不用担心我的课题和论文了！</span></span></section><section><mpprofile data-pluginname="mpprofile" data-id="MzIyOTY3MDA3MA==" data-headimg="http://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mRwVORS9icssbib3HAFTa5u2YKBiacgVf3UkLCZCoZHbSBva8RL5mqPvVeB8eteUk17ibEIeYNDx7Xfw/0?wx_fmt=png" data-nickname="SCIPainter" data-alias="genedenovo2" data-signature="“一图胜千言”，好看的图形千篇一律，丑的配图千奇百怪。SCIPainter，旨在分享科研绘图的技能与工具。不保证日更，有时间就做线上培训，不排除录制付费视频的可能。如果你想看我日更，请多把我分享出去，说不定我就文思如尿崩了。" data-from="0"></mpprofile></section><section><br></section><section data-tools="135编辑器" data-id="100625"><section><section><p><img data-galleryid="" data-ratio="1.2666666666666666" data-type="gif" data-w="600" data-src="https://mmbiz.qpic.cn/mmbiz_gif/6kvRq2WRXpjibT3YBB4rzAbpFham1zGOPYzcKqcSBqbSnCEI0QzDA8Hjfu0ppuco4ZfLuxhcfH4GD69iaZpfoN7A/640?wx_fmt=gif" src="https://mmbiz.qpic.cn/mmbiz_gif/6kvRq2WRXpjibT3YBB4rzAbpFham1zGOPYzcKqcSBqbSnCEI0QzDA8Hjfu0ppuco4ZfLuxhcfH4GD69iaZpfoN7A/640?wx_fmt=gif"></p><section data-brushtype="text"><strong><span>基迪奥生物|专业定制测序服务</span></strong><br></section><section><section data-brushtype="text"><span><strong>联系方式：020-39341079；service@genedenovo.com</strong></span></section></section><section><section><img data-ratio="1" data-type="jpeg" data-w="258" data-width="100%" title="公众号二维码.jpg" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/6kvRq2WRXpjibT3YBB4rzAbpFham1zGOPp58TI0RWbkqEM3Rq8cvlxtQMlWxXHm6eOWCnxicBt1wIdrHZ7JtxvXg/640?wx_fmt=jpeg" src="https://mmbiz.qpic.cn/mmbiz_jpg/6kvRq2WRXpjibT3YBB4rzAbpFham1zGOPp58TI0RWbkqEM3Rq8cvlxtQMlWxXHm6eOWCnxicBt1wIdrHZ7JtxvXg/640?wx_fmt=jpeg"></section><section data-brushtype="text"><span><strong><span>扫码关注</span></strong></span></section></section></section></section></section><section data-role="paragraph"><p><br></p></section></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/9hRm6y9F3hN6C-2goTiNkg",target="_blank" rel="noopener noreferrer">原文链接</a>
