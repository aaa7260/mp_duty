---
title: "泰酷辣！360°无死角可视化你的降维数据！"
date: 2023-05-17T04:04:51Z
draft: ["false"]
tags: [
  "fetched",
  "TOP生物信息"
]
categories: ["Acdemic"]
---
泰酷辣！360°无死角可视化你的降维数据！ by TOP生物信息
------
<div><section data-mpa-powered-by="yiban.io"><span>如何</span><span>360°全方位、无死角</span><span>的展示你的PCA、tSNE、UMAP等降维型散点数据？一般论文使用的是二维坐标，但经常会出现</span><span>二维坐标散点重叠</span><span>的问题。如果想要进行更直观的展示，特别是用于各种需汇报场合，不妨尝试一下可交互的3D降维散点图！</span></section><section><p></p></section><section><br></section><section><span>今天分享一个帮助我们实现可交互散点图绘制的R包</span><span>plotly</span><span>，想想组会时在老板和师弟师妹面前，结合3D图表侃侃而谈，简直哇塞！</span></section><section><span><p><br></p><p><img data-galleryid="" data-ratio="0.8962001853568119" data-src="https://mmbiz.qpic.cn/sz_mmbiz_gif/tgUVxVRjT6lnexTn5FfmxKZTIdwq31f8gk5ncfKKicBFk2f6yhTsUia0xtcbiasibQrfs6SF7WMKqHdMXo0tQjRshQ/640?wx_fmt=gif" data-type="gif" data-w="1079" height="967" width="1079" src="https://mmbiz.qpic.cn/sz_mmbiz_gif/tgUVxVRjT6lnexTn5FfmxKZTIdwq31f8gk5ncfKKicBFk2f6yhTsUia0xtcbiasibQrfs6SF7WMKqHdMXo0tQjRshQ/640?wx_fmt=gif"></p></span></section><section><span><br></span></section><section><span>本期以3DtSNE绘制为例，从seurat三维tSNE坐标获取、到目标数据提取与绘图，通通拿捏住！</span></section><section data-mpa-template="t" mpa-from-tpl="t"><img data-ratio="0.6359375" data-src="https://mmbiz.qpic.cn/mmbiz_gif/2Dkp7U8D8pM29mxCMDMwNrl5MC6Bia8clV6blVZ4X92GhoiaqDibkKjeuibkSeerbrVksRxaFFYUyic0O9icPKxuColQ/640?&amp;wx_fmt=gif" data-w="640" width="100%" src="https://mmbiz.qpic.cn/mmbiz_gif/2Dkp7U8D8pM29mxCMDMwNrl5MC6Bia8clV6blVZ4X92GhoiaqDibkKjeuibkSeerbrVksRxaFFYUyic0O9icPKxuColQ/640?&amp;wx_fmt=gif"></section><p><br></p><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>#相关R包安装与载入：</span><br mpa-from-tpl="t"><span>install</span>.packages('plotly') <span>#稳定版</span><br mpa-from-tpl="t"><span>remotes</span>::install_github(<span>"plotly/plotly"</span>) <span>#开发版</span><br mpa-from-tpl="t"><br mpa-from-tpl="t"><span>library</span>(plotly)<br mpa-from-tpl="t"><span>library</span>(Seurat)<br mpa-from-tpl="t"><span>library</span>(cols4all)<br mpa-from-tpl="t"><span>library</span>(tidydr)<br mpa-from-tpl="t"><span>library</span>(dplyr)<br mpa-from-tpl="t"><span>library</span>(ggplot2)<br mpa-from-tpl="t"><br mpa-from-tpl="t"><span>#载入测试数据(Seurat对象)：</span><br mpa-from-tpl="t"><span>load</span>('obj.Rda')<br mpa-from-tpl="t"><span>dim</span>(seurat_object)</code></pre></section><p><br></p><section><span><p><img data-galleryid="" data-ratio="0.11336717428087986" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6lnexTn5FfmxKZTIdwq31f8AUhsIv4MDLdicnloicMql2zE5dMsN6uKicK026KPL1czGgAWnKJhJr0rg/640?wx_fmt=png" data-type="png" data-w="591" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6lnexTn5FfmxKZTIdwq31f8AUhsIv4MDLdicnloicMql2zE5dMsN6uKicK026KPL1czGgAWnKJhJr0rg/640?wx_fmt=png"></p></span></section><section><br></section><section><span>往期我们学习了如何从Seurat中提取二维降维数据，并进行个性化tSNE或UMAP图的绘制，先进行简单回顾：</span></section><section><span><br mpa-from-tpl="t"></span></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>#提取二维tSNE数据：</span><br mpa-from-tpl="t"><span>tSNE</span> &lt;- cbind(as.data.frame(seurat_object@reductions$tsne@cell.embeddings),<br mpa-from-tpl="t">              <span>celltype</span> = Idents(seurat_object))<br mpa-from-tpl="t"><br mpa-from-tpl="t"><span>#计算中心亚群标签坐标：</span><br mpa-from-tpl="t"><span>label</span> &lt;- tSNE %&gt;%<br mpa-from-tpl="t">  <span>group_by</span>(celltype)%&gt;%<br mpa-from-tpl="t">  <span>summarise</span>(tSNE_1 = median(tSNE_1), tSNE_2 = median(tSNE_2))<br mpa-from-tpl="t"><span>head</span>(tSNE);head(label)</code></pre></section><p><br></p><section><span><p><img data-galleryid="" data-ratio="0.5644490644490644" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6lnexTn5FfmxKZTIdwq31f8VH4jsRTZE5Hibopa9LKRpUfNoRhW0d16GgzbiaMNw7d3g9MG3Sh6uFjA/640?wx_fmt=png" data-type="png" data-w="962" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6lnexTn5FfmxKZTIdwq31f8VH4jsRTZE5Hibopa9LKRpUfNoRhW0d16GgzbiaMNw7d3g9MG3Sh6uFjA/640?wx_fmt=png"></p></span></section><section><span><br mpa-from-tpl="t"></span></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>#ggplot2绘图：</span><br mpa-from-tpl="t"><span>mycol</span> &lt;- c4a('10',9)<br mpa-from-tpl="t"><span>mytheme</span> &lt;- theme_void() + theme(plot.margin = margin(5.5,15,5.5,5.5)) <br mpa-from-tpl="t"><br mpa-from-tpl="t"><span>p</span> &lt;- ggplot(data = tSNE, aes(x = tSNE_1, y = tSNE_2)) +<br mpa-from-tpl="t">  <span>stat_ellipse</span>(aes(fill = celltype), level = 0.95, linetype = 1, <br mpa-from-tpl="t">               <span>show</span>.legend = F, geom = 'polygon', alpha = 0.1) +<br mpa-from-tpl="t">  <span>geom_point</span>(aes(color = celltype), size = 0.4, alpha = 1) +<br mpa-from-tpl="t">  <span>mytheme</span> +<br mpa-from-tpl="t">  <span>theme_dr</span>(xlength = 0.2, ylength = 0.2, <br mpa-from-tpl="t">           <span>arrow</span> = grid::arrow(length = unit(0.1, <span>"inches"</span>), <br mpa-from-tpl="t">                               <span>ends</span> = 'last', type = <span>"closed"</span>)) + <br mpa-from-tpl="t">  <span>theme</span>(panel.grid = element_blank()) +<br mpa-from-tpl="t">  <span>geom_text</span>(data = label, aes(x = tSNE_1, y = tSNE_2, label = celltype), fontface = <span>"bold"</span>, color = 'black', size = 4) +<br mpa-from-tpl="t">  <span>guides</span>(color = guide_legend(override.aes = list(size = 5))) +<br mpa-from-tpl="t">  <span>scale_fill_manual</span>(values = mycol) + <br mpa-from-tpl="t">  <span>scale_color_manual</span>(values = mycol)<br mpa-from-tpl="t"><span>p</span></code></pre></section><p><span></span><br></p><section><span><p><img data-galleryid="" data-ratio="0.7388888888888889" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6lnexTn5FfmxKZTIdwq31f85hlhUtJ830eYq4UEES1icSHqITtWULsKax7IcicQE9gV5yCA35hzuEKA/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6lnexTn5FfmxKZTIdwq31f85hlhUtJ830eYq4UEES1icSHqITtWULsKax7IcicQE9gV5yCA35hzuEKA/640?wx_fmt=png"></p></span></section><section><br></section><section><span>如果对上述代码还不太理解，可戳往期</span><span><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzIyOTY3MDA3MA==&amp;mid=2247515784&amp;idx=1&amp;sn=a05e1267335ab99cdb8b6f3b92c4b57e&amp;chksm=e8bdd351dfca5a472e7c27420a8ba1983b663a809be2669f2c43cd4c39a18281430610ebab74&amp;scene=21#wechat_redirect" textvalue="《如何提取Seurat数据，绘制更加个性化的tSNE/UMAP图？》" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2">《如何提取Seurat数据，绘制更加个性化的tSNE/UMAP图？》</a></span><span>查看更多绘图细节。</span><p></p></section><section><span></span><br></section><section><span>下面进入今天的正题：</span></section><section><span><br></span></section><section><span><br mpa-from-tpl="t"></span></section><section data-mpa-template="t" mpa-from-tpl="t"><section data-mpa-template="t" data-mpa-template-id="685" data-mpa-category="模板" mpa-from-tpl="t"><section data-mpa-category="模板" data-mid="" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><img data-ratio="0.875" data-src="https://mmbiz.qpic.cn/mmbiz_png/Zd7lC7dZrNsGKourGfhGCgJ0nbibNLGiaxqibFocWpv7fPxryQhPtRR1HxdYia6rscVAkEV6dttam1JKWooQ5znib0A/640?wx_fmt=png" data-w="48" src="https://mmbiz.qpic.cn/mmbiz_png/Zd7lC7dZrNsGKourGfhGCgJ0nbibNLGiaxqibFocWpv7fPxryQhPtRR1HxdYia6rscVAkEV6dttam1JKWooQ5znib0A/640?wx_fmt=png"></section><section data-mid="" mpa-from-tpl="t"><img data-ratio="0.8333333333333334" data-src="https://mmbiz.qpic.cn/mmbiz_png/tHxZXDCS5PXWda1droic5LNE1YVJ1icjS8hsAeFUL37Fcr7RMCKQHXrJo2mKATG55J9G42b3bZicNo7LbxQibfS3Aw/640?wx_fmt=png" data-w="12" src="https://mmbiz.qpic.cn/mmbiz_png/tHxZXDCS5PXWda1droic5LNE1YVJ1icjS8hsAeFUL37Fcr7RMCKQHXrJo2mKATG55J9G42b3bZicNo7LbxQibfS3Aw/640?wx_fmt=png"></section><section data-mid="" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><p data-mid="">1.seurat三维tSNE降维</p></section></section><section data-mid="" mpa-from-tpl="t"><img data-ratio="0.8333333333333334" data-src="https://mmbiz.qpic.cn/mmbiz_png/CcjicgbSspyD4ozMDj5nzjXz3BOmLuKFK3UvjOFHK67r7ysYYQMRYswQYDHnskTuPhVVuehnJSibO0qSkL0EYPvQ/640?wx_fmt=png" data-w="12" src="https://mmbiz.qpic.cn/mmbiz_png/CcjicgbSspyD4ozMDj5nzjXz3BOmLuKFK3UvjOFHK67r7ysYYQMRYswQYDHnskTuPhVVuehnJSibO0qSkL0EYPvQ/640?wx_fmt=png"></section><section data-mid="" mpa-from-tpl="t"><img data-ratio="0.8333333333333334" data-src="https://mmbiz.qpic.cn/mmbiz_png/wRFIKUjeRTia52Xc9ouv5OemGBvN80VAAvXsopES5Molkia5YNX9F2z0viaqa0AsH6NvdhquzQib1ib6HWlajsTuNQw/640?wx_fmt=png" data-w="12" src="https://mmbiz.qpic.cn/mmbiz_png/wRFIKUjeRTia52Xc9ouv5OemGBvN80VAAvXsopES5Molkia5YNX9F2z0viaqa0AsH6NvdhquzQib1ib6HWlajsTuNQw/640?wx_fmt=png"></section></section></section></section></section><p><br mpa-from-tpl="t"></p><section><br></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>seurat_object</span> &lt;- RunTSNE(<br mpa-from-tpl="t">  <span>seurat_object</span>,<br mpa-from-tpl="t">  <span>reduction</span> = 'harmony', <br mpa-from-tpl="t">  <span>dims</span> = 1:20,<br mpa-from-tpl="t">  <span>dim</span>.embed = 3 <span>#默认为2维tSNE,3dtSNE需设置为3</span><br mpa-from-tpl="t">)</code></pre></section><p><br></p><section><span><br></span></section><section data-mpa-template="t" data-mpa-template-id="685" data-mpa-category="模板" mpa-from-tpl="t"><section data-mpa-category="模板" data-mid="" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><img data-ratio="0.875" data-src="https://mmbiz.qpic.cn/mmbiz_png/Zd7lC7dZrNsGKourGfhGCgJ0nbibNLGiaxqibFocWpv7fPxryQhPtRR1HxdYia6rscVAkEV6dttam1JKWooQ5znib0A/640?wx_fmt=png" data-w="48" src="https://mmbiz.qpic.cn/mmbiz_png/Zd7lC7dZrNsGKourGfhGCgJ0nbibNLGiaxqibFocWpv7fPxryQhPtRR1HxdYia6rscVAkEV6dttam1JKWooQ5znib0A/640?wx_fmt=png"></section><section data-mid="" mpa-from-tpl="t"><img data-ratio="0.8333333333333334" data-src="https://mmbiz.qpic.cn/mmbiz_png/tHxZXDCS5PXWda1droic5LNE1YVJ1icjS8hsAeFUL37Fcr7RMCKQHXrJo2mKATG55J9G42b3bZicNo7LbxQibfS3Aw/640?wx_fmt=png" data-w="12" src="https://mmbiz.qpic.cn/mmbiz_png/tHxZXDCS5PXWda1droic5LNE1YVJ1icjS8hsAeFUL37Fcr7RMCKQHXrJo2mKATG55J9G42b3bZicNo7LbxQibfS3Aw/640?wx_fmt=png"></section><section data-mid="" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><p data-mid="">2.三维坐标和亚群注释信息提取</p></section></section><section data-mid="" mpa-from-tpl="t"><img data-ratio="0.8333333333333334" data-src="https://mmbiz.qpic.cn/mmbiz_png/CcjicgbSspyD4ozMDj5nzjXz3BOmLuKFK3UvjOFHK67r7ysYYQMRYswQYDHnskTuPhVVuehnJSibO0qSkL0EYPvQ/640?wx_fmt=png" data-w="12" src="https://mmbiz.qpic.cn/mmbiz_png/CcjicgbSspyD4ozMDj5nzjXz3BOmLuKFK3UvjOFHK67r7ysYYQMRYswQYDHnskTuPhVVuehnJSibO0qSkL0EYPvQ/640?wx_fmt=png"></section><section data-mid="" mpa-from-tpl="t"><img data-ratio="0.8333333333333334" data-src="https://mmbiz.qpic.cn/mmbiz_png/wRFIKUjeRTia52Xc9ouv5OemGBvN80VAAvXsopES5Molkia5YNX9F2z0viaqa0AsH6NvdhquzQib1ib6HWlajsTuNQw/640?wx_fmt=png" data-w="12" src="https://mmbiz.qpic.cn/mmbiz_png/wRFIKUjeRTia52Xc9ouv5OemGBvN80VAAvXsopES5Molkia5YNX9F2z0viaqa0AsH6NvdhquzQib1ib6HWlajsTuNQw/640?wx_fmt=png"></section></section></section></section><section><span></span></section><section><br></section><section><br></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>#三维坐标信息提取：</span><br mpa-from-tpl="t"><span>tSNE_3d</span> &lt;- as.data.frame(seurat_object@reductions$tsne@cell.embeddings)<br mpa-from-tpl="t"><span>head</span>(tSNE_3d)</code></pre></section><p><br></p><p><img data-galleryid="" data-ratio="0.29175946547884185" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6lnexTn5FfmxKZTIdwq31f808CWTrbuCJRGGucFIl40yveEb68eQIrQWc38iaOTW2DkYLicEN2ObgXw/640?wx_fmt=png" data-type="png" data-w="898" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6lnexTn5FfmxKZTIdwq31f808CWTrbuCJRGGucFIl40yveEb68eQIrQWc38iaOTW2DkYLicEN2ObgXw/640?wx_fmt=png"></p><section><br></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>#细胞注释信息提取：</span><br mpa-from-tpl="t"><span>celltype</span> &lt;- Idents(seurat_object)<br mpa-from-tpl="t"><span>table</span>(celltype)</code></pre></section><p><br></p><p><img data-galleryid="" data-ratio="0.15462962962962962" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6lnexTn5FfmxKZTIdwq31f8Vj2oAviaFXk5usC3XAHTibmXqfVsFn1XBY7ExACCg3HTUItmzQwUqouA/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6lnexTn5FfmxKZTIdwq31f8Vj2oAviaFXk5usC3XAHTibmXqfVsFn1XBY7ExACCg3HTUItmzQwUqouA/640?wx_fmt=png"></p><section><br></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>tSNE_3d</span> &lt;- cbind(tSNE_3d,celltype) <span>#数据框合并</span><br mpa-from-tpl="t"><span>head</span>(tSNE_3d)</code></pre></section><p><br></p><section><span><p><img data-galleryid="" data-ratio="0.23333333333333334" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6lnexTn5FfmxKZTIdwq31f8J1Iia5s4CjezfAUMK5FDm6bMWBvryVByicE25GQJxq4l6Z2IFELpMyNw/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6lnexTn5FfmxKZTIdwq31f8J1Iia5s4CjezfAUMK5FDm6bMWBvryVByicE25GQJxq4l6Z2IFELpMyNw/640?wx_fmt=png"></p></span></section><section><br></section><section><br></section><section data-mpa-template="t" data-mpa-template-id="685" data-mpa-category="模板" mpa-from-tpl="t"><section data-mpa-category="模板" data-mid="" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><img data-ratio="0.875" data-src="https://mmbiz.qpic.cn/mmbiz_png/Zd7lC7dZrNsGKourGfhGCgJ0nbibNLGiaxqibFocWpv7fPxryQhPtRR1HxdYia6rscVAkEV6dttam1JKWooQ5znib0A/640?wx_fmt=png" data-w="48" src="https://mmbiz.qpic.cn/mmbiz_png/Zd7lC7dZrNsGKourGfhGCgJ0nbibNLGiaxqibFocWpv7fPxryQhPtRR1HxdYia6rscVAkEV6dttam1JKWooQ5znib0A/640?wx_fmt=png"></section><section data-mid="" mpa-from-tpl="t"><img data-ratio="0.8333333333333334" data-src="https://mmbiz.qpic.cn/mmbiz_png/tHxZXDCS5PXWda1droic5LNE1YVJ1icjS8hsAeFUL37Fcr7RMCKQHXrJo2mKATG55J9G42b3bZicNo7LbxQibfS3Aw/640?wx_fmt=png" data-w="12" src="https://mmbiz.qpic.cn/mmbiz_png/tHxZXDCS5PXWda1droic5LNE1YVJ1icjS8hsAeFUL37Fcr7RMCKQHXrJo2mKATG55J9G42b3bZicNo7LbxQibfS3Aw/640?wx_fmt=png"></section><section data-mid="" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><p data-mid="">3.plotly包绘图</p></section></section><section data-mid="" mpa-from-tpl="t"><img data-ratio="0.8333333333333334" data-src="https://mmbiz.qpic.cn/mmbiz_png/CcjicgbSspyD4ozMDj5nzjXz3BOmLuKFK3UvjOFHK67r7ysYYQMRYswQYDHnskTuPhVVuehnJSibO0qSkL0EYPvQ/640?wx_fmt=png" data-w="12" src="https://mmbiz.qpic.cn/mmbiz_png/CcjicgbSspyD4ozMDj5nzjXz3BOmLuKFK3UvjOFHK67r7ysYYQMRYswQYDHnskTuPhVVuehnJSibO0qSkL0EYPvQ/640?wx_fmt=png"></section><section data-mid="" mpa-from-tpl="t"><img data-ratio="0.8333333333333334" data-src="https://mmbiz.qpic.cn/mmbiz_png/wRFIKUjeRTia52Xc9ouv5OemGBvN80VAAvXsopES5Molkia5YNX9F2z0viaqa0AsH6NvdhquzQib1ib6HWlajsTuNQw/640?wx_fmt=png" data-w="12" src="https://mmbiz.qpic.cn/mmbiz_png/wRFIKUjeRTia52Xc9ouv5OemGBvN80VAAvXsopES5Molkia5YNX9F2z0viaqa0AsH6NvdhquzQib1ib6HWlajsTuNQw/640?wx_fmt=png"></section></section></section></section><section><br></section><section><br></section><section><span>plotly是一个交互式高质量图表绘制R包，如折线图、散点图、面积图、柱形图、箱线图、直方图等等，当然也包括了3D型图表的绘制，如三维散点图、线图、曲面图等。</span></section><section><span><br mpa-from-tpl="t"></span></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>#自定义亚群配色：</span><br mpa-from-tpl="t"><span>c4a_gui</span>() <br mpa-from-tpl="t"><span>mycol2</span> &lt;- c4a('superfishel_stone',9) <br mpa-from-tpl="t"><br mpa-from-tpl="t"><span>#3DtSNE图绘制：</span><br mpa-from-tpl="t"><span>plot_ly</span>(<br mpa-from-tpl="t">  <span>data</span> = tSNE_3d,<br mpa-from-tpl="t">  <span>x</span> = ~tSNE_1,<br mpa-from-tpl="t">  <span>y</span> = ~tSNE_2,<br mpa-from-tpl="t">  <span>z</span> = ~tSNE_3,<br mpa-from-tpl="t">  <span>type</span> = 'scatter3d',<br mpa-from-tpl="t">  <span>mode</span> = 'markers',<br mpa-from-tpl="t">  <span>marker</span> = list(size = 1.5)<br mpa-from-tpl="t">)</code></pre></section><p><br></p><p><img data-galleryid="" data-ratio="0.8564814814814815" data-src="https://mmbiz.qpic.cn/sz_mmbiz_gif/tgUVxVRjT6lnexTn5FfmxKZTIdwq31f8dzI3NwJwC4s46R33V1KaUNjnmicqhJ7Zq1WbicfxvUxNbkus2NQhlVBw/640?wx_fmt=gif" data-type="gif" data-w="1080" height="925" width="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_gif/tgUVxVRjT6lnexTn5FfmxKZTIdwq31f8dzI3NwJwC4s46R33V1KaUNjnmicqhJ7Zq1WbicfxvUxNbkus2NQhlVBw/640?wx_fmt=gif"></p><p><br></p><section><span>可以看到绘制出的散点图在一个三维立体空间中，我们可以任意拖拽旋转、放大缩小，随时实现对目标位置的交互功能。鼠标悬停时，能够同时显示对应位置的亚群标签和坐标位置信息。</span><p></p></section><section><span><br></span></section><section><span><strong><span>右上角重要功能图标：</span></strong></span><p></p></section><section><span><br></span></section><section><span>1）点击第二个图标</span><span>‘Zoom’</span><span>，可锁定角度，只进行放大缩小（鼠标滚轮）；</span><p></p></section><section><span>2）点击第三个图标</span><span>‘Pan’</span><span>，可锁定角度，只进行放大缩小（鼠标滚轮）和图表位置移动（长按拖拽）；</span><p></p></section><section><span>3）点击第四个图标</span><span>‘Orbital rotation’</span><span>，可进行任意旋转（鼠标长按拖拽）和放大缩小（鼠标滚轮）。</span><p></p></section><section><br></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>#将celltype映射到颜色：</span><br mpa-from-tpl="t"><span>plot_ly</span>(<br mpa-from-tpl="t">  <span>data</span> = tSNE_3d,<br mpa-from-tpl="t">  <span>x</span> = ~tSNE_1,<br mpa-from-tpl="t">  <span>y</span> = ~tSNE_2,<br mpa-from-tpl="t">  <span>z</span> = ~tSNE_3,<br mpa-from-tpl="t">  <span>type</span> = 'scatter3d',<br mpa-from-tpl="t">  <span>mode</span> = 'markers',<br mpa-from-tpl="t">  <span>marker</span> = list(size = 1.5),<br mpa-from-tpl="t">  <span>color</span> = celltype, <br mpa-from-tpl="t">  <span>colors</span> = mycol2 <span>#添加自定义色板配色</span><br mpa-from-tpl="t">)<span></span></code></pre></section><p><br></p><p><img data-galleryid="" data-ratio="0.8897126969416126" data-src="https://mmbiz.qpic.cn/sz_mmbiz_gif/tgUVxVRjT6lnexTn5FfmxKZTIdwq31f8m0cXicbQIqmgwKFE3s9ibb8FvyIEJsqfiaGsdY5L9ib0xKoUpwxsxib9bGQ/640?wx_fmt=gif" data-type="gif" data-w="1079" height="960" width="1079" src="https://mmbiz.qpic.cn/sz_mmbiz_gif/tgUVxVRjT6lnexTn5FfmxKZTIdwq31f8m0cXicbQIqmgwKFE3s9ibb8FvyIEJsqfiaGsdY5L9ib0xKoUpwxsxib9bGQ/640?wx_fmt=gif"></p><section><span><br mpa-from-tpl="t"></span></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>#鼠标悬停时只显示亚群标签：</span><br mpa-from-tpl="t"><span>plot_ly</span>(<br mpa-from-tpl="t">  <span>data</span> = tSNE_3d,<br mpa-from-tpl="t">  <span>x</span> = ~tSNE_1,<br mpa-from-tpl="t">  <span>y</span> = ~tSNE_2,<br mpa-from-tpl="t">  <span>z</span> = ~tSNE_3,<br mpa-from-tpl="t">  <span>type</span> = 'scatter3d',<br mpa-from-tpl="t">  <span>mode</span> = 'markers',<br mpa-from-tpl="t">  <span>marker</span> = list(size = 1.5),<br mpa-from-tpl="t">  <span>color</span> = celltype, <br mpa-from-tpl="t">  <span>colors</span> = mycol2, <br mpa-from-tpl="t">  <span>text</span> = celltype,<br mpa-from-tpl="t">  <span>hoverinfo</span> = 'text'<br mpa-from-tpl="t">)<span></span></code></pre></section><p><br></p><p><img data-galleryid="" data-ratio="0.8962001853568119" data-src="https://mmbiz.qpic.cn/sz_mmbiz_gif/tgUVxVRjT6lnexTn5FfmxKZTIdwq31f8gk5ncfKKicBFk2f6yhTsUia0xtcbiasibQrfs6SF7WMKqHdMXo0tQjRshQ/640?wx_fmt=gif" data-type="gif" data-w="1079" height="967" width="1079" src="https://mmbiz.qpic.cn/sz_mmbiz_gif/tgUVxVRjT6lnexTn5FfmxKZTIdwq31f8gk5ncfKKicBFk2f6yhTsUia0xtcbiasibQrfs6SF7WMKqHdMXo0tQjRshQ/640?wx_fmt=gif"></p><section><br></section><section><span>除此之外，点击图例可将对应散点在图中隐藏掉，如需显示，再次点击对应图例即可。</span></section><section><span><br></span></section><section><span><p><img data-galleryid="" data-ratio="0.8359592215013901" data-src="https://mmbiz.qpic.cn/sz_mmbiz_gif/tgUVxVRjT6lnexTn5FfmxKZTIdwq31f8YPZAWJvxPvoc7X658PV5Y5OvWzka2e2gNd8pV9HoFD5pEZLDX8UV6w/640?wx_fmt=gif" data-type="gif" data-w="1079" height="902" width="1079" src="https://mmbiz.qpic.cn/sz_mmbiz_gif/tgUVxVRjT6lnexTn5FfmxKZTIdwq31f8YPZAWJvxPvoc7X658PV5Y5OvWzka2e2gNd8pV9HoFD5pEZLDX8UV6w/640?wx_fmt=gif"></p><p><br></p></span></section><section><span>在Rstudio的</span><span><strong>Viewer</strong></span><span>中选择</span><span>Save as Web Page</span><span>，即可将你的本次交互图表结果保存为一个交互网页，方便你随时调用！</span><p></p></section><section><span><br></span></section><section><span><p><img data-galleryid="" data-ratio="0.8455089820359282" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6lnexTn5FfmxKZTIdwq31f8q5MkXsxaj4NRrB2kwACHuibL9HDVtUFhJpcZfPUYbdgK7bFfSQicea4A/640?wx_fmt=png" data-type="png" data-w="835" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6lnexTn5FfmxKZTIdwq31f8q5MkXsxaj4NRrB2kwACHuibL9HDVtUFhJpcZfPUYbdgK7bFfSQicea4A/640?wx_fmt=png"></p><br></span></section><section><span>如果需要保存静态图表，调整好角度大小位置后，点击第一个相机图标</span><span>‘Download plot as a png’</span><span>可下载位图到本地。</span></section><section><span><p><img data-galleryid="" data-ratio="0.8194444444444444" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6lnexTn5FfmxKZTIdwq31f8CbB9gU4mLx1qZt4n1YHZSrCDBlhQcGbTmfU60BaqBHwud4cYJBeibMg/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6lnexTn5FfmxKZTIdwq31f8CbB9gU4mLx1qZt4n1YHZSrCDBlhQcGbTmfU60BaqBHwud4cYJBeibMg/640?wx_fmt=png"></p><br></span></section><section><span>好啦，今天的分享就到这里！</span></section><section><span><br mpa-from-tpl="t"></span></section><section data-mpa-template="t" mpa-from-tpl="t"><section data-role="title" data-tools="135编辑器" data-id="115905" mpa-from-tpl="t"><section mpa-from-tpl="t"><section mpa-from-tpl="t"><section mpa-from-tpl="t"><section mpa-from-tpl="t"><section mpa-from-tpl="t"><section mpa-from-tpl="t"><br mpa-from-tpl="t"></section></section><section mpa-from-tpl="t"><section mpa-from-tpl="t"><br mpa-from-tpl="t"></section></section></section><section hm_fix="360:442" mpa-from-tpl="t"><span><strong data-brushtype="text" mpa-from-tpl="t">参考资料</strong></span></section><section mpa-from-tpl="t"><section mpa-from-tpl="t"><section mpa-from-tpl="t"><br mpa-from-tpl="t"></section></section><section mpa-from-tpl="t"><section mpa-from-tpl="t"><br></section></section></section></section></section></section></section></section><section><span>https://plotly.com/r/</span><p></p></section><section><br></section><section><br></section><p><strong><span>*未经许可，不得以任何方式复制或抄袭本篇文章之部分或全部内容。版权所有，侵权必究。</span></strong></p><p><br></p><section data-role="outer" label="Powered by 135editor.com"><section data-tools="135编辑器" data-id="105648"><section><section data-role="outer" label="Powered by 135editor.com"><section data-role="paragraph"><section data-role="outer" label="Powered by 135editor.com"><section data-tools="135编辑器" data-id="105648"><section><section><img data-ratio="0.8780487804878049" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6kCKJYcEqEIfoJYG621mPJE8VibmibGU0Jxic9iabARVRH0FT6BNE8VAglWFXBPibFAU7a6tWGibSs8wyUg/640?wx_fmt=png" data-type="png" data-w="41" data-width="100%" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6kCKJYcEqEIfoJYG621mPJE8VibmibGU0Jxic9iabARVRH0FT6BNE8VAglWFXBPibFAU7a6tWGibSs8wyUg/640?wx_fmt=png"></section><section><section><section data-width="35%"><section><section data-width="100%"><img data-ratio="1" data-src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/tgUVxVRjT6kCKJYcEqEIfoJYG621mPJEv5etCBwHicqbEPwnVrkpaasxqaVibM4mT2JdIuN6yTlYWDD4mL5A427A/640?wx_fmt=jpeg" data-type="jpeg" data-w="860" data-width="100%" title="SCIPainter 30cm二维码.jpg" src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/tgUVxVRjT6kCKJYcEqEIfoJYG621mPJEv5etCBwHicqbEPwnVrkpaasxqaVibM4mT2JdIuN6yTlYWDD4mL5A427A/640?wx_fmt=jpeg"></section></section></section><section data-width="50%"><section><section data-brushtype="text"><span><strong># SCIPainter</strong></span></section><section data-brushtype="text" hm_fix="361:593"><p>基迪奥旗下绘图公众号</p><p>分享科研绘图技能与工具</p><p>欢迎关注与转发~</p></section></section></section></section></section></section></section></section></section></section><section><br></section></section></section><section data-role="paragraph"><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><img data-ratio="1" data-src="https://mmbiz.qpic.cn/sz_mmbiz_gif/tgUVxVRjT6kCKJYcEqEIfoJYG621mPJEgMd0aMPtmrDjiaX8sBhfhicVteeHf1JicexSpUbS3fdS9SiboUVN7guaPw/640?wx_fmt=gif" data-type="gif" data-w="400" src="https://mmbiz.qpic.cn/sz_mmbiz_gif/tgUVxVRjT6kCKJYcEqEIfoJYG621mPJEgMd0aMPtmrDjiaX8sBhfhicVteeHf1JicexSpUbS3fdS9SiboUVN7guaPw/640?wx_fmt=gif"></section></section></section><section><section powered-by="xiumi.us"><section><p><span><strong>你的好友拍了拍你</strong></span></p><p><span><strong>并请你帮她点一下</strong></span><strong><span>“分享”</span></strong><span><strong><span>~</span></strong></span></p></section></section></section></section></section></section></section><p><mp-style-type data-value="10000"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/ZHgP-9zJar98-hAKm_6i6Q",target="_blank" rel="noopener noreferrer">原文链接</a>
