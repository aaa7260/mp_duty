---
title: "相关性分析的最新选择：linkET"
date: 2023-05-05T12:36:10Z
draft: ["false"]
tags: [
  "fetched",
  "Biomamba 生信基地"
]
categories: ["Acdemic"]
---
相关性分析的最新选择：linkET by Biomamba 生信基地
------
<div><section data-support="96编辑器" data-style-id="19566"><section><section><section><section data-support="96编辑器" data-style-id="28526"><section><section><section><p>写在前面</p></section><section><section data-width="100%"><br></section></section></section></section></section><section data-support="96编辑器" data-style-id="38091"><section><section><section><section><br></section><section><br></section><section data-width="83%"><br></section></section><section><section>之前我们也介绍过相关性分析的一些内容:</section><section><a href="https://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247484429&amp;idx=1&amp;sn=09f1b31c30a105add532fa17e8715e5a&amp;chksm=9b3f7d5dac48f44bf739ec49a7827923eb0e87a8b26510627cf89c121e63c06561901720ab6c&amp;scene=21#wechat_redirect" data-linktype="2"><span>一文搞定相关性分析</span></a></section><section><a href="https://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247484467&amp;idx=1&amp;sn=762ff5fbb54441633144ed6dead0b096&amp;chksm=9b3f7d63ac48f475071fd62ae6a1c09a23da8036cc2cbd11e7740fdb9def79328e4eab45f4b1&amp;scene=21#wechat_redirect" data-linktype="2"><span>在线版相关性分析</span></a></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247487980&amp;idx=1&amp;sn=de00628f4ed037d9163ceb4589e307fa&amp;chksm=9b3f68bcac48e1aa8b8fbad2060e035af7c19dc108091aa649eea9ed5b85b2608a337516fd6e&amp;scene=21#wechat_redirect" textvalue="相关性分析用腻了ggcorrplot, 来试试ggcor吧" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2"><span>相关性分析用腻了ggcorrplot, 来试试ggcor吧</span></a><br></section><section>这里给大家介绍ggcor的更新版：<span>linkET</span></section><section><span><span>linkET</span>就是<span>ggcor</span>原作者推出的更新版，其实我在介绍</span><code><span>ggcor</span></code><span>时，</span><code><span>linkET</span></code><span>就已经存在了，随着R和各个依赖包的更新，</span><code><span>ggcor</span></code><span>使用起来略显不顺手，甚至在R4.2里无法顺利安装了，这里便把</span><code><span>linkET</span></code><span>的教程更新出来。所以还是推荐大家多去</span><span>github</span><span>逛逛，一定比在咱们公众号里收获多！</span></section><section><span>这依旧是一个依赖于<span>ggplot2</span>的包，与</span><code><span>ggcor</span></code><span>不同的是这里增加了一个</span><code><span>correlate()</span></code><span>函数来返回相关性矩阵的r值与p值。</span></section></section></section></section></section></section></section></section></section><section><section data-support="96编辑器" data-style-id="28526"><section><section><section><p><br></p><p>演示</p></section><section><section data-width="100%"><br></section></section></section></section></section><section><h2><span>安装</span></h2><pre><code><span><span>if</span>(<span>!</span><span>require</span>(devtools))<span>install.packages</span>(<span>"devtools"</span>)</span><span><span>#&gt; 载入需要的程辑包：devtools</span></span><span><span>#&gt; 载入需要的程辑包：usethis</span></span><span><span>if</span>(<span>!</span><span>require</span>(linkET))devtools<span>::</span><span>install_github</span>(<span>"Hy4m/linkET"</span>, <span>force =</span> <span>TRUE</span>)</span><span><span>#&gt; 载入需要的程辑包：linkET</span></span><span><span>packageVersion</span>(<span>"linkET"</span>)</span><span><span>#&gt; [1] '0.0.4'</span></span></code></pre><h3><span>数据处理</span></h3><pre><code><span><span>library</span>(linkET)</span><span><span>head</span>(mtcars)</span><span><span>#&gt;                    mpg cyl disp  hp drat    wt  qsec vs am gear carb</span></span><span><span>#&gt; Mazda RX4         21.0   6  160 110 3.90 2.620 16.46  0  1    4    4</span></span><span><span>#&gt; Mazda RX4 Wag     21.0   6  160 110 3.90 2.875 17.02  0  1    4    4</span></span><span><span>#&gt; Datsun 710        22.8   4  108  93 3.85 2.320 18.61  1  1    4    1</span></span><span><span>#&gt; Hornet 4 Drive    21.4   6  258 110 3.08 3.215 19.44  1  0    3    1</span></span><span><span>#&gt; Hornet Sportabout 18.7   8  360 175 3.15 3.440 17.02  0  0    3    2</span></span><span><span>#&gt; Valiant           18.1   6  225 105 2.76 3.460 20.22  1  0    3    1</span></span><span><span>matrix_data</span>(<span>list</span>(<span>mtcars =</span> mtcars))</span><span><span>#&gt; A matrix data object:</span></span><span><span>#&gt; Number:  1 </span></span><span><span>#&gt; Names:  mtcars </span></span><span><span>#&gt; Dimensions:  32 rows, 11 columns</span></span><span><span>#&gt; Row names:  Mazda RX4, Mazda RX4 Wag, Datsun 710, Hornet 4 Drive, Hor... </span></span><span><span>#&gt; Column names:  mpg, cyl, disp, hp, drat, wt, qsec, vs, am, gear, carb</span></span><span><span>## 计算数据的相关性</span></span><span>mycor <span>&lt;-</span> <span>correlate</span>(mtcars,<span>method =</span> <span>"pearson"</span><span>#可选择的相关性计算方式有："pearson", "kendall", or "spearman".</span></span><span>                   ) <span>%&gt;%</span> <span>#计算各列变量之间的之间的相关性</span></span><span>  <span>as_matrix_data</span>()</span><span><span>#这个结果里收录了两个矩阵</span></span><span>mycor<span>$</span>r <span>%&gt;%</span> .[<span>1</span><span>:</span><span>4</span>,<span>1</span><span>:</span><span>4</span>]<span>#相关性矩阵</span></span><span><span>#&gt;             mpg        cyl       disp         hp</span></span><span><span>#&gt; mpg   1.0000000 -0.8521620 -0.8475514 -0.7761684</span></span><span><span>#&gt; cyl  -0.8521620  1.0000000  0.9020329  0.8324475</span></span><span><span>#&gt; disp -0.8475514  0.9020329  1.0000000  0.7909486</span></span><span><span>#&gt; hp   -0.7761684  0.8324475  0.7909486  1.0000000</span></span><span>mycor<span>$</span>p <span>%&gt;%</span> .[<span>1</span><span>:</span><span>4</span>,<span>1</span><span>:</span><span>4</span>]<span>#显著性矩阵</span></span><span><span>#&gt;               mpg          cyl         disp           hp</span></span><span><span>#&gt; mpg  0.000000e+00 6.112687e-10 9.380327e-10 1.787835e-07</span></span><span><span>#&gt; cyl  6.112687e-10 0.000000e+00 1.802838e-12 3.477861e-09</span></span><span><span>#&gt; disp 9.380327e-10 1.802838e-12 0.000000e+00 7.142679e-08</span></span><span><span>#&gt; hp   1.787835e-07 3.477861e-09 7.142679e-08 0.000000e+00</span></span></code></pre><h3><span>热图可视化</span></h3><pre><code><span><span>library</span>(ggplot2)</span><span><span>#原数据热图：</span></span><span><span>matrix_data</span>(<span>list</span>(<span>mtcars =</span> mtcars)) <span>%&gt;%</span> </span><span>  <span>hyplot</span>(<span>aes</span>(<span>fill =</span> mtcars)) <span>+</span></span><span>  <span>geom_tile</span>()</span></code></pre><p><img data-ratio="0.7142857142857143" data-src="https://mmbiz.qpic.cn/mmbiz_png/ImlBFVOwwpywv7rab2Ce9EyqxE2yEC9FDns7HvWUZFkXibtyjcahqZ8GSFaQicp3YGKlVmuWTEgQhgEuficofn1vg/640?wx_fmt=png" data-type="png" data-w="1344" width="100%" src="https://mmbiz.qpic.cn/mmbiz_png/ImlBFVOwwpywv7rab2Ce9EyqxE2yEC9FDns7HvWUZFkXibtyjcahqZ8GSFaQicp3YGKlVmuWTEgQhgEuficofn1vg/640?wx_fmt=png"></p><p><span><br></span></p><pre><code><span><span>as_md_tbl</span>(mtcars) <span>%&gt;%</span> </span><span>  <span>hyplot</span>(<span>aes</span>(<span>size =</span> mtcars)) <span>+</span></span><span>  <span>geom_point</span>(<span>shape =</span> <span>21</span>, <span>fill =</span> <span>NA</span>)</span></code></pre><p><img data-ratio="0.7142857142857143" data-src="https://mmbiz.qpic.cn/mmbiz_png/ImlBFVOwwpywv7rab2Ce9EyqxE2yEC9FNiawCUlLicZicnoqDrRDyJwib181diccaXoq1ViaeUM9d75CzhEkFzCLn2QA/640?wx_fmt=png" data-type="png" data-w="1344" width="100%" src="https://mmbiz.qpic.cn/mmbiz_png/ImlBFVOwwpywv7rab2Ce9EyqxE2yEC9FNiawCUlLicZicnoqDrRDyJwib181diccaXoq1ViaeUM9d75CzhEkFzCLn2QA/640?wx_fmt=png"></p><p><span><br></span></p><pre><code><span><span>correlate</span>(mtcars) <span>%&gt;%</span> </span><span>  <span>as_md_tbl</span>() <span>%&gt;%</span> </span><span>  <span>qcorrplot</span>() <span>+</span></span><span>  <span>geom_square</span>()</span></code></pre><p><img data-ratio="0.7142857142857143" data-src="https://mmbiz.qpic.cn/mmbiz_png/ImlBFVOwwpywv7rab2Ce9EyqxE2yEC9F9D54qQe9pud9FvnhXcl7IvBCne1KRA1nsdylzViciaAaJBkQ05v31jHQ/640?wx_fmt=png" data-type="png" data-w="1344" width="100%" src="https://mmbiz.qpic.cn/mmbiz_png/ImlBFVOwwpywv7rab2Ce9EyqxE2yEC9F9D54qQe9pud9FvnhXcl7IvBCne1KRA1nsdylzViciaAaJBkQ05v31jHQ/640?wx_fmt=png"></p><p><span><br></span></p><pre><code><span><span>library</span>(vegan)</span><span><span>#&gt; 载入需要的程辑包：permute</span></span><span><span>#&gt; </span></span><span><span>#&gt; 载入程辑包：'permute'</span></span><span><span>#&gt; The following object is masked from 'package:devtools':</span></span><span><span>#&gt; </span></span><span><span>#&gt;     check</span></span><span><span>#&gt; 载入需要的程辑包：lattice</span></span><span><span>#&gt; This is vegan 2.6-2</span></span><span><span>data</span>(<span>"varespec"</span>)</span><span><span>data</span>(<span>"varechem"</span>)</span><span><span>correlate</span>(varespec[<span>1</span><span>:</span><span>30</span>], varechem) <span>%&gt;%</span> </span><span>  <span>#可以很方便的计算两组变量之间的相关性，笔者原来用ggcorrplot时还需要用cor()函数计算后再取对应的行与列</span></span><span>  <span>qcorrplot</span>() <span>+</span></span><span>  <span>geom_square</span>() <span>+</span><span>#设置热图色块为矩形</span></span><span>  <span>scale_fill_gradientn</span>(<span>colours =</span> RColorBrewer<span>::</span><span>brewer.pal</span>(<span>11</span>, <span>"RdBu"</span>))</span></code></pre><p><img data-ratio="0.7142857142857143" data-src="https://mmbiz.qpic.cn/mmbiz_png/ImlBFVOwwpywv7rab2Ce9EyqxE2yEC9FI4gQJLj08LKaiavdDJEMYiaSqf89jytAx3HfdSxWuQtUibFG2HplYzzMw/640?wx_fmt=png" data-type="png" data-w="1344" width="100%" src="https://mmbiz.qpic.cn/mmbiz_png/ImlBFVOwwpywv7rab2Ce9EyqxE2yEC9FI4gQJLj08LKaiavdDJEMYiaSqf89jytAx3HfdSxWuQtUibFG2HplYzzMw/640?wx_fmt=png"></p><p><span><br></span></p><pre><code><span><span>qcorrplot</span>(varespec[<span>1</span><span>:</span><span>30</span>], </span><span>          <span>type =</span> <span>"lower"</span><span>#也可以改成up，目的是去除重复步骤</span></span><span>          ) <span>+</span><span>#单个矩阵时与ggcor一样用qcorrplot直接绘制即可</span></span><span>  <span>geom_square</span>() <span>+</span></span><span>  <span>scale_fill_gradientn</span>(<span>colours =</span> RColorBrewer<span>::</span><span>brewer.pal</span>(<span>11</span>, <span>"RdBu"</span>))<span>#设置配色</span></span><span><span>#&gt; The input data is not a correlation matrix,</span></span><span><span>#&gt; you can override this behavior by setting the `is_corr` parameter.</span></span></code></pre><p><img data-ratio="0.7142857142857143" data-src="https://mmbiz.qpic.cn/mmbiz_png/ImlBFVOwwpywv7rab2Ce9EyqxE2yEC9F41fVrgJPKAG7C9coork2zHw1zty4kaKWWk8CRrjBAzju5C96tJhVeQ/640?wx_fmt=png" data-type="png" data-w="1344" width="100%" src="https://mmbiz.qpic.cn/mmbiz_png/ImlBFVOwwpywv7rab2Ce9EyqxE2yEC9F41fVrgJPKAG7C9coork2zHw1zty4kaKWWk8CRrjBAzju5C96tJhVeQ/640?wx_fmt=png"></p><h2><br></h2><h2><span>设置图片风格：</span></h2><pre><code><span><span>## corrplot风格：</span></span><span><span>set_corrplot_style</span>()</span><span><span>qcorrplot</span>(mtcars) <span>+</span> <span>geom_shaping</span>(<span>marker =</span> <span>"circle"</span>)</span><span><span>#&gt; The input data is not a correlation matrix,</span></span><span><span>#&gt; you can override this behavior by setting the `is_corr` parameter.</span></span></code></pre><p><img data-ratio="0.7142857142857143" data-src="https://mmbiz.qpic.cn/mmbiz_png/ImlBFVOwwpywv7rab2Ce9EyqxE2yEC9FWxqyict6jEjg0fFcEK56hTttHMUtuuqmdibp6oQEGTpvTLN7AlR4qeoQ/640?wx_fmt=png" data-type="png" data-w="1344" width="100%" src="https://mmbiz.qpic.cn/mmbiz_png/ImlBFVOwwpywv7rab2Ce9EyqxE2yEC9FWxqyict6jEjg0fFcEK56hTttHMUtuuqmdibp6oQEGTpvTLN7AlR4qeoQ/640?wx_fmt=png"></p><p><span><br></span></p><pre><code><span><span>## 设置个性化配色：</span></span><span><span>set_corrplot_style</span>(<span>colours =</span> <span>c</span>(<span>"red"</span>, <span>"white"</span>, <span>"blue"</span>))</span><span><span>qcorrplot</span>(mtcars) <span>+</span> <span>geom_shaping</span>(<span>marker =</span> <span>"circle"</span>)</span><span><span>#&gt; The input data is not a correlation matrix,</span></span><span><span>#&gt; you can override this behavior by setting the `is_corr` parameter.</span></span></code></pre><p><img data-ratio="0.7142857142857143" data-src="https://mmbiz.qpic.cn/mmbiz_png/ImlBFVOwwpywv7rab2Ce9EyqxE2yEC9FjfyrmsBCnHUQnqhhJNWGmWYt3dGox8QbWkkpT30ws6UAhXdVdat8nw/640?wx_fmt=png" data-type="png" data-w="1344" width="100%" src="https://mmbiz.qpic.cn/mmbiz_png/ImlBFVOwwpywv7rab2Ce9EyqxE2yEC9FjfyrmsBCnHUQnqhhJNWGmWYt3dGox8QbWkkpT30ws6UAhXdVdat8nw/640?wx_fmt=png"></p><p><span><br></span></p><pre><code><span><span>## 个性化scale方式：</span></span><span><span>set_corrplot_style</span>(<span>scale =</span> ggplot2<span>::</span><span>scale_fill_viridis_c</span>(<span>limits =</span> <span>c</span>(<span>-</span><span>1</span>, <span>1</span>)))</span><span><span>qcorrplot</span>(mtcars) <span>+</span> <span>geom_shaping</span>(<span>marker =</span> <span>"circle"</span>)</span><span><span>#&gt; The input data is not a correlation matrix,</span></span><span><span>#&gt; you can override this behavior by setting the `is_corr` parameter.</span></span></code></pre><p><img data-ratio="0.7142857142857143" data-src="https://mmbiz.qpic.cn/mmbiz_png/ImlBFVOwwpywv7rab2Ce9EyqxE2yEC9FNpNyc8VWp2Fhpr6m52q9av7LyeGiaIMGozPkR0BKskjxxAgW4P1tu2w/640?wx_fmt=png" data-type="png" data-w="1344" width="100%" src="https://mmbiz.qpic.cn/mmbiz_png/ImlBFVOwwpywv7rab2Ce9EyqxE2yEC9FNpNyc8VWp2Fhpr6m52q9av7LyeGiaIMGozPkR0BKskjxxAgW4P1tu2w/640?wx_fmt=png"></p><p><span><br></span></p><pre><code><span><span>## 恢复原始风格：</span></span><span><span>set_default_style</span>()</span><span><span>qcorrplot</span>(mtcars) <span>+</span> <span>geom_shaping</span>(<span>marker =</span> <span>"circle"</span>)</span><span><span>#&gt; The input data is not a correlation matrix,</span></span><span><span>#&gt; you can override this behavior by setting the `is_corr` parameter.</span></span></code></pre><p><img data-ratio="0.7142857142857143" data-src="https://mmbiz.qpic.cn/mmbiz_png/ImlBFVOwwpywv7rab2Ce9EyqxE2yEC9FULwqWuHDqpo0ZBIB1MuHd0WpsE7GVysHVUFYafCRv6e88eLps7n7tg/640?wx_fmt=png" data-type="png" data-w="1344" width="100%" src="https://mmbiz.qpic.cn/mmbiz_png/ImlBFVOwwpywv7rab2Ce9EyqxE2yEC9FULwqWuHDqpo0ZBIB1MuHd0WpsE7GVysHVUFYafCRv6e88eLps7n7tg/640?wx_fmt=png"></p><p><span><br></span></p><pre><code><span><span>#还可以添加ggplot中的一些主题，这里不做展示</span></span><span><span>#另外大家可以在这里选择心水的颜色：https://www.sioe.cn/yingyong/yanse-rgb-16/</span></span></code></pre><h2><br></h2><h2><span>层相关分析(<strong>mantel test</strong>)</span></h2><pre><code><span><span>library</span>(dplyr)</span><span><span>#&gt; </span></span><span><span>#&gt; 载入程辑包：'dplyr'</span></span><span><span>#&gt; The following objects are masked from 'package:stats':</span></span><span><span>#&gt; </span></span><span><span>#&gt;     filter, lag</span></span><span><span>#&gt; The following objects are masked from 'package:base':</span></span><span><span>#&gt; </span></span><span><span>#&gt;     intersect, setdiff, setequal, union</span></span><span><span>data</span>(<span>"varechem"</span>, <span>package =</span> <span>"vegan"</span>)</span><span><span>data</span>(<span>"varespec"</span>, <span>package =</span> <span>"vegan"</span>)</span><span>varechem[<span>1</span><span>:</span><span>4</span>,<span>1</span><span>:</span><span>4</span>]</span><span><span>#&gt;       N    P     K    Ca</span></span><span><span>#&gt; 18 19.8 42.1 139.9 519.4</span></span><span><span>#&gt; 15 13.4 39.1 167.3 356.7</span></span><span><span>#&gt; 24 20.2 67.7 207.1 973.3</span></span><span><span>#&gt; 27 20.6 60.8 233.7 834.0</span></span><span>varespec[<span>1</span><span>:</span><span>4</span>,<span>1</span><span>:</span><span>4</span>]</span><span><span>#&gt;    Callvulg Empenigr Rhodtome Vaccmyrt</span></span><span><span>#&gt; 18     0.55    11.13     0.00     0.00</span></span><span><span>#&gt; 15     0.67     0.17     0.00     0.35</span></span><span><span>#&gt; 24     0.10     1.55     0.00     0.00</span></span><span><span>#&gt; 27     0.00    15.13     2.42     5.92</span></span><span>mantel <span>&lt;-</span> <span>mantel_test</span>(varespec, varechem,</span><span>                      <span>spec_select =</span> <span>list</span>(<span>Spec01 =</span> <span>1</span><span>:</span><span>7</span>,<span>#设置层相关的“几层”变量</span></span><span>                                         <span>Spec02 =</span> <span>8</span><span>:</span><span>18</span>,</span><span>                                         <span>Spec03 =</span> <span>19</span><span>:</span><span>37</span>,</span><span>                                         <span>Spec04 =</span> <span>38</span><span>:</span><span>44</span>)) <span>%&gt;%</span> </span><span>  <span>mutate</span>(<span>rd =</span> <span>cut</span>(r, <span>breaks =</span> <span>c</span>(<span>-</span><span>Inf</span>, <span>0.2</span>, <span>0.4</span>, <span>Inf</span>),</span><span>                  <span>labels =</span> <span>c</span>(<span>"&lt; 0.2"</span>, <span>"0.2 - 0.4"</span>, <span>"&gt;= 0.4"</span>)),</span><span>         <span>pd =</span> <span>cut</span>(p, <span>breaks =</span> <span>c</span>(<span>-</span><span>Inf</span>, <span>0.01</span>, <span>0.05</span>, <span>Inf</span>),</span><span>                  <span>labels =</span> <span>c</span>(<span>"&lt; 0.01"</span>, <span>"0.01 - 0.05"</span>, <span>"&gt;= 0.05"</span>)))<span>#将r值与p值分为一定的等级</span></span><span><span>#&gt; `mantel_test()` using 'bray' dist method for 'spec'.</span></span><span><span>#&gt; `mantel_test()` using 'euclidean' dist method for 'env'.</span></span><span>mantel[<span>1</span><span>:</span><span>4</span>,<span>1</span><span>:</span><span>4</span>]</span><span><span>#&gt; # A tibble: 4 × 4</span></span><span><span>#&gt;   spec   env        r     p</span></span><span><span>#&gt;   &lt;chr&gt;  &lt;chr&gt;  &lt;dbl&gt; &lt;dbl&gt;</span></span><span><span>#&gt; 1 Spec01 N     0.256  0.015</span></span><span><span>#&gt; 2 Spec01 P     0.137  0.093</span></span><span><span>#&gt; 3 Spec01 K     0.400  0.004</span></span><span><span>#&gt; 4 Spec01 Ca    0.0113 0.427</span></span><span><span>qcorrplot</span>(<span>correlate</span>(varechem), <span>type =</span> <span>"lower"</span>, <span>diag =</span> <span>FALSE</span>) <span>+</span></span><span>  <span>geom_square</span>() <span>+</span></span><span>  <span>geom_couple</span>(<span>aes</span>(<span>colour =</span> pd, <span>size =</span> rd), </span><span>              <span>data =</span> mantel, </span><span>              <span>curvature =</span> <span>nice_curvature</span>()) <span>+</span><span>#加入pd与rd的信息</span></span><span>  <span>scale_fill_gradientn</span>(<span>colours =</span> RColorBrewer<span>::</span><span>brewer.pal</span>(<span>11</span>, <span>"RdBu"</span>)) <span>+</span><span>#设置色系</span></span><span>  <span>scale_size_manual</span>(<span>values =</span> <span>c</span>(<span>0.5</span>, <span>1</span>, <span>2</span>)) <span>+</span></span><span>  <span>scale_colour_manual</span>(<span>values =</span> <span>color_pal</span>(<span>3</span>)) <span>+</span></span><span>  <span>guides</span>(<span>size =</span> <span>guide_legend</span>(<span>title =</span> <span>"Mantel's r"</span>,</span><span>                             <span>override.aes =</span> <span>list</span>(<span>colour =</span> <span>"grey35"</span>), </span><span>                             <span>order =</span> <span>2</span>),</span><span>         <span>colour =</span> <span>guide_legend</span>(<span>title =</span> <span>"Mantel's p"</span>, </span><span>                               <span>override.aes =</span> <span>list</span>(<span>size =</span> <span>3</span>), </span><span>                               <span>order =</span> <span>1</span>),</span><span>         <span>fill =</span> <span>guide_colorbar</span>(<span>title =</span> <span>"Pearson's r"</span>, <span>order =</span> <span>3</span>))</span></code></pre><p><img data-ratio="0.7142857142857143" data-src="https://mmbiz.qpic.cn/mmbiz_png/ImlBFVOwwpywv7rab2Ce9EyqxE2yEC9FQiclg8hlEdTs5lGAib11g79dVBMAVcSfibJJATugzSQ2lk2fBoZDjicibGQ/640?wx_fmt=png" data-type="png" data-w="1344" width="100%" src="https://mmbiz.qpic.cn/mmbiz_png/ImlBFVOwwpywv7rab2Ce9EyqxE2yEC9FQiclg8hlEdTs5lGAib11g79dVBMAVcSfibJJATugzSQ2lk2fBoZDjicibGQ/640?wx_fmt=png"></p><h2><span>pairs plot 展示数据间关联性的更多细节</span></h2><pre><code><span>iris[<span>1</span><span>:</span><span>4</span>,<span>1</span><span>:</span><span>4</span>]</span><span><span>#&gt;   Sepal.Length Sepal.Width Petal.Length Petal.Width</span></span><span><span>#&gt; 1          5.1         3.5          1.4         0.2</span></span><span><span>#&gt; 2          4.9         3.0          1.4         0.2</span></span><span><span>#&gt; 3          4.7         3.2          1.3         0.2</span></span><span><span>#&gt; 4          4.6         3.1          1.5         0.2</span></span><span><span>qpairs</span>(iris) <span>+</span> <span>geom_pairs</span>()</span></code></pre><p><img data-ratio="1" data-src="https://mmbiz.qpic.cn/mmbiz_png/ImlBFVOwwpywv7rab2Ce9EyqxE2yEC9FP4o7bUn2zZDKpQGSm3PYfwxY1g3etna9UOOibFHvZr0SRAsBgnfkHVQ/640?wx_fmt=png" data-type="png" data-w="1920" width="100%" src="https://mmbiz.qpic.cn/mmbiz_png/ImlBFVOwwpywv7rab2Ce9EyqxE2yEC9FP4o7bUn2zZDKpQGSm3PYfwxY1g3etna9UOOibFHvZr0SRAsBgnfkHVQ/640?wx_fmt=png"></p><h2><span>网络图</span></h2><p><span>emm，还是用igraph或者ggplot绘制网络图吧</span></p><pre><code><span><span>correlate</span>(mtcars) <span>%&gt;%</span> </span><span>  <span>as.igraph</span>() <span>%&gt;%</span> </span><span>  <span>plot</span>(<span>layout =</span> layout_with_circular)</span></code></pre><p><img data-ratio="0.7142857142857143" data-src="https://mmbiz.qpic.cn/mmbiz_png/ImlBFVOwwpywv7rab2Ce9EyqxE2yEC9FrJQOCOOa7TOlEbknkl44Aibo6VSdqRVfjVVlmncdK9EOZd7q4eKAL0A/640?wx_fmt=png" data-type="png" data-w="1344" width="100%" src="https://mmbiz.qpic.cn/mmbiz_png/ImlBFVOwwpywv7rab2Ce9EyqxE2yEC9FrJQOCOOa7TOlEbknkl44Aibo6VSdqRVfjVVlmncdK9EOZd7q4eKAL0A/640?wx_fmt=png"></p><h2><span></span></h2><section data-support="96编辑器" data-style-id="28526"><section><section><section><p><br></p><p>Reference</p></section><section><section data-width="100%"><br></section></section></section></section></section><h2><span>引用是美德：</span></h2><p><span>Houyun Huang(2021). linkET: Everything is Linkable. R package version 0.0.3. </span></p><p><br></p></section></section><section><section><section data-support="96编辑器" data-style-id="27326"><section><section><section><section><section><p><br></p><section><section data-support="96编辑器" data-style-id="34887"><section><section><section><img data-ratio="0.8372093023255814" data-type="png" data-w="86" data-width="100%" data-src="https://mmbiz.qpic.cn/mmbiz_png/Ljib4So7yuWjsU2VMXgI8TRjfwVeo0Aj4EiaLjQXteia730VKnC0j8Tkgu6hkTs7ZO0JRFyw8riaczdNlQQKsOnfIQ/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" src="https://mmbiz.qpic.cn/mmbiz_png/Ljib4So7yuWjsU2VMXgI8TRjfwVeo0Aj4EiaLjQXteia730VKnC0j8Tkgu6hkTs7ZO0JRFyw8riaczdNlQQKsOnfIQ/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"></section><section><section><section><p>如何联系我们</p></section></section></section></section></section></section><p><br></p></section><section data-support="96编辑器" data-style-id="34892"><section><section><section><section><img data-ratio="1.1627906976744187" data-type="gif" data-w="43" data-src="https://mmbiz.qpic.cn/mmbiz_gif/Ljib4So7yuWjsU2VMXgI8TRjfwVeo0Aj4z284kwxMryKUBLBbNicjxYMDvWxmosNGHmIW66jtmJuia0pe51q8hFzQ/640?wx_fmt=gif&amp;wxfrom=5&amp;wx_lazy=1" src="https://mmbiz.qpic.cn/mmbiz_gif/Ljib4So7yuWjsU2VMXgI8TRjfwVeo0Aj4z284kwxMryKUBLBbNicjxYMDvWxmosNGHmIW66jtmJuia0pe51q8hFzQ/640?wx_fmt=gif&amp;wxfrom=5&amp;wx_lazy=1"></section></section></section><section><section><section><section>公众号后台中消息更新不及时，超过48h后便不允许回复读者消息，这里给大家留一下领取资料、免费服务器的<span><strong>微信号</strong></span>，方便大家随时交流、提建议（由助理接待）。此外呼声一直很高的<span>交流群</span>也建好了，欢迎大家入群讨论：</section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247490936&amp;idx=1&amp;sn=850dfc45b10a6bd538c81cfbf1d7af37&amp;chksm=9b3f6428ac48ed3e4199dbfdec2fce4324d3226af19e335b8e5c0143cf8f0881667e36074d83&amp;scene=21#wechat_redirect" textvalue="永久免费的千人生信、科研交流群" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1">永久免费的千人生信、科研交流群</a><br></section><section><br></section><section><span>大家可以阅读完这几篇之后添加</span></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247484685&amp;idx=1&amp;sn=3b47c0bcad97a265650b5f34c00a6a3c&amp;chksm=9b3f7c5dac48f54be9cde50ab7a1147c55a36b980ffa0e721c02c05cbb88fef41a8fbc13d599&amp;scene=21#wechat_redirect" textvalue="笑一笑也就算了" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" wah-hotarea="click" hasload="1">笑一笑也就算了</a></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247488966&amp;idx=1&amp;sn=9e9e7659b4cf00ac3173d21e88e1602b&amp;chksm=9b3f6c96ac48e580efe53f966430f6598785e5c5c6bcc20f5eef019e723e49baaaea6d73fb7b&amp;scene=21#wechat_redirect" textvalue="如何搜索公众号过往发布内容" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1">如何搜索公众号过往发布内容</a><br></section><p><img data-galleryid="" data-ratio="1.2464962901896126" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/ImlBFVOwwpyUNnHOn8es4zIE8EU8PJ0wRtpDqO03bR2TecVjskmGmoY0DVzyDjOycE4xHrfx7dw4HFSO7JhEgQ/640?wx_fmt=jpeg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" data-type="jpeg" data-w="1213" src="https://mmbiz.qpic.cn/mmbiz_jpg/ImlBFVOwwpyUNnHOn8es4zIE8EU8PJ0wRtpDqO03bR2TecVjskmGmoY0DVzyDjOycE4xHrfx7dw4HFSO7JhEgQ/640?wx_fmt=jpeg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"></p></section></section></section></section></section></section></section></section></section></section></section></section></section><section><br></section></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/APFvubIqlDt4kbeZTtUP0Q",target="_blank" rel="noopener noreferrer">原文链接</a>
