---
title: "跟着Nature学作图:R语言ggplot2散点图并给指定的点添加颜色"
date: 2023-05-22T00:20:37Z
draft: ["false"]
tags: [
  "fetched",
  "小明的数据分析笔记本"
]
categories: ["Acdemic"]
---
跟着Nature学作图:R语言ggplot2散点图并给指定的点添加颜色 by 小明的数据分析笔记本
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-mpa-powered-by="yiban.io"><h2 data-tool="mdnice编辑器"><span></span><span>论文</span><span> </span></h2><blockquote data-tool="mdnice编辑器"><p>Telomere-to-mitochondria signalling by ZBP1 mediates replicative crisis</p></blockquote><p data-tool="mdnice编辑器">https://www.nature.com/articles/s41586-023-05710-8</p><p data-tool="mdnice编辑器"><code>s41586-023-05710-8.pdf</code></p><p data-tool="mdnice编辑器">大部分图的原始数据都有，争取把有原始数据的图都用R语言来复现一下</p><p data-tool="mdnice编辑器"><code>41586_2023_5710_MOESM4_ESM (1).xlsx</code></p><p data-tool="mdnice编辑器">今天的推文复现一下论文中的Fig1a</p><figure data-tool="mdnice编辑器"><img data-ratio="1.3121951219512196" data-src="https://mmbiz.qpic.cn/mmbiz_png/t1wZDoUyFk6fibCXC0OlRvMcL1UN8pibzCK8rsJ3Vr7ydaYdDAHgTic82HcTULaD0Qxiawm1aVrwAvWr8Rt5OEmlzg/640?wx_fmt=png" data-type="png" data-w="410" src="https://mmbiz.qpic.cn/mmbiz_png/t1wZDoUyFk6fibCXC0OlRvMcL1UN8pibzCK8rsJ3Vr7ydaYdDAHgTic82HcTULaD0Qxiawm1aVrwAvWr8Rt5OEmlzg/640?wx_fmt=png"><figcaption>image.png</figcaption></figure><h2 data-tool="mdnice编辑器"><span></span><span>部分示例数据</span><span> </span></h2><figure data-tool="mdnice编辑器"><img data-ratio="0.5179090029041626" data-src="https://mmbiz.qpic.cn/mmbiz_png/t1wZDoUyFk6fibCXC0OlRvMcL1UN8pibzCy8frGAqs98cjPhAfU4yGARu0M30VUmC0hWZiaYzKh0lvpcpkoDuQiblQ/640?wx_fmt=png" data-type="png" data-w="1033" src="https://mmbiz.qpic.cn/mmbiz_png/t1wZDoUyFk6fibCXC0OlRvMcL1UN8pibzCy8frGAqs98cjPhAfU4yGARu0M30VUmC0hWZiaYzKh0lvpcpkoDuQiblQ/640?wx_fmt=png"><figcaption>image.png</figcaption></figure><h2 data-tool="mdnice编辑器"><span></span><span>最基本的散点图</span><span> </span></h2><pre data-tool="mdnice编辑器"><span></span><code>library(tidyverse)<br>fig1a&lt;-read_delim(<span>"data/20230521/Figure1a.txt"</span>,<br>           delim = <span>" "</span>)<br><br>library(ggplot2)<br><br>ggplot()+<br>  geom_point(data=fig1a,<br>             aes(x=log2(FC_Replicate_1),<br>                 y=log2(FC_Replicate_2)),<br>             size=10,<br>             shape=21,<br>             fill=<span>"#f1f1f1"</span>,<br>             color=<span>"black"</span>)+<br>  theme_bw()<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.8424015009380863" data-src="https://mmbiz.qpic.cn/mmbiz_png/t1wZDoUyFk6fibCXC0OlRvMcL1UN8pibzCzZgHiaKp8Vj5uGoUIDicCssrQ5Xc8Fyicia4JGibbaRZUrxVoiaQswfibVpvw/640?wx_fmt=png" data-type="png" data-w="1066" src="https://mmbiz.qpic.cn/mmbiz_png/t1wZDoUyFk6fibCXC0OlRvMcL1UN8pibzCzZgHiaKp8Vj5uGoUIDicCssrQ5Xc8Fyicia4JGibbaRZUrxVoiaQswfibVpvw/640?wx_fmt=png"><figcaption>image.png</figcaption></figure><h2 data-tool="mdnice编辑器"><span></span><span>给指定的点映射颜色</span><span> </span></h2><p data-tool="mdnice编辑器">这里我的处理方式是把想要映射颜色的点单独挑出来，然后再叠加一层</p><pre data-tool="mdnice编辑器"><span></span><code>geneSelected&lt;-c(<span>"ZBP1"</span>,<span>"IFNB1"</span>,<span>"CGAS"</span>,<span>"IFNAR1"</span>,<span>"STING"</span>,<span>"IFNAR2"</span>)<br>match(geneSelected,fig1a %&gt;% pull(Gene))<br></code></pre><p data-tool="mdnice编辑器">本来是想用上面的代码把图例基因的数据匹配出来，但是有些基因名没有找到，这里我就随机选择几个了</p><pre data-tool="mdnice编辑器"><span></span><code>fig1a %&gt;% <br>  sample_n(6) -&gt; fig1adf<br><br><br>ggplot()+<br>  geom_point(data=fig1a,<br>             aes(x=log2(FC_Replicate_1),<br>                 y=log2(FC_Replicate_2)),<br>             size=10,<br>             shape=21,<br>             fill=<span>"#f1f1f1"</span>,<br>             color=<span>"black"</span>)+<br>  theme_bw()+<br>  geom_point(data=fig1adf,<br>             aes(x=log2(FC_Replicate_1),<br>                 y=log2(FC_Replicate_2),<br>                 fill=Gene),<br>             size=10,<br>             shape=21)<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.8205607476635514" data-src="https://mmbiz.qpic.cn/mmbiz_png/t1wZDoUyFk6fibCXC0OlRvMcL1UN8pibzC0ico7NvBkVic3PwjxTgWqdOEjdJUIZaXfM83SBLkbbhRwkJ1n2JNfnnA/640?wx_fmt=png" data-type="png" data-w="1070" src="https://mmbiz.qpic.cn/mmbiz_png/t1wZDoUyFk6fibCXC0OlRvMcL1UN8pibzC0ico7NvBkVic3PwjxTgWqdOEjdJUIZaXfM83SBLkbbhRwkJ1n2JNfnnA/640?wx_fmt=png"><figcaption>image.png</figcaption></figure><h2 data-tool="mdnice编辑器"><span></span><span>接下来是调整一些细节</span><span> </span></h2><pre data-tool="mdnice编辑器"><span></span><code>ggplot()+<br>  geom_point(data=fig1a,<br>             aes(x=log2(FC_Replicate_1),<br>                 y=log2(FC_Replicate_2)),<br>             size=10,<br>             shape=21,<br>             fill=<span>"#f1f1f1"</span>,<br>             color=<span>"black"</span>)+<br>  theme_classic()+<br>  geom_point(data=fig1adf,<br>             aes(x=log2(FC_Replicate_1),<br>                 y=log2(FC_Replicate_2),<br>                 fill=Gene),<br>             size=10,<br>             shape=21)+<br>  scale_x_continuous(breaks = c(2,3,4))+<br>  scale_y_continuous(breaks = c(2,3,4))+<br>  theme(legend.position = <span>"top"</span>,<br>        legend.text = element_text(face=<span>"italic"</span>))+<br>  guides(fill=guide_legend(ncol = 2,title = NULL))+<br>  labs(x=<span>"log2[fold change]\nReplicate 1"</span>,<br>       y=<span>"log2[fold change]\nReplicate 2"</span>)<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.8175925925925925" data-src="https://mmbiz.qpic.cn/mmbiz_png/t1wZDoUyFk6fibCXC0OlRvMcL1UN8pibzCrvQrISibHKzqdfgmCsoVq8mFy5mhQ7CAuDe5M7iaS8ic6PYiaEjwdjibAAg/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/t1wZDoUyFk6fibCXC0OlRvMcL1UN8pibzCrvQrISibHKzqdfgmCsoVq8mFy5mhQ7CAuDe5M7iaS8ic6PYiaEjwdjibAAg/640?wx_fmt=png"><figcaption>image.png</figcaption></figure><p data-tool="mdnice编辑器">这里既要把2设置成下标，又要实现文本分行，我暂时想不到用什么办法来实现了</p><h2 data-tool="mdnice编辑器"><span></span><span>最后是生成封面图的代码</span><span> </span></h2><pre data-tool="mdnice编辑器"><span></span><code>ggplot()+<br>  geom_point(data=fig1a,<br>             aes(x=log2(FC_Replicate_1),<br>                 y=log2(FC_Replicate_2)),<br>             size=5,<br>             shape=21,<br>             fill=<span>"#f1f1f1"</span>,<br>             color=<span>"black"</span>)+<br>  theme_classic()+<br>  geom_point(data=fig1adf,<br>             aes(x=log2(FC_Replicate_1),<br>                 y=log2(FC_Replicate_2),<br>                 fill=Gene),<br>             size=5,<br>             shape=21)+<br>  scale_x_continuous(breaks = c(2,3,4))+<br>  scale_y_continuous(breaks = c(2,3,4))+<br>  theme(legend.position = <span>"top"</span>,<br>        legend.text = element_text(face=<span>"italic"</span>))+<br>  guides(fill=guide_legend(ncol = 2,title = NULL))+<br>  labs(x=<span>"log2[fold change]\nReplicate 1"</span>,<br>       y=<span>"log2[fold change]\nReplicate 2"</span>) -&gt; p1<br><br>ggplot()+<br>  geom_point(data=fig1a,<br>             aes(x=log2(FC_Replicate_1),<br>                 y=log2(FC_Replicate_2)),<br>             size=5,<br>             shape=21,<br>             fill=<span>"#f1f1f1"</span>,<br>             color=<span>"black"</span>)+<br>  theme_classic()+<br>  geom_point(data=fig1adf,<br>             aes(x=log2(FC_Replicate_1),<br>                 y=log2(FC_Replicate_2),<br>                 fill=Gene),<br>             size=5,<br>             shape=21)+<br>  scale_x_continuous(breaks = c(2,3,4))+<br>  scale_y_continuous(breaks = c(2,3,4))+<br>  theme(legend.position = <span>"top"</span>,<br>        legend.text = element_text(face=<span>"italic"</span>))+<br>  guides(fill=guide_legend(ncol = 2,title = NULL))+<br>  labs(x=<span>"log2[fold change]\nReplicate 1"</span>,<br>       y=<span>"log2[fold change]\nReplicate 2"</span>)+<br>  scale_fill_manual(values = c(<span>"#ef7a79"</span>,<span>"#edd08e"</span>,<span>"#29b473"</span>,<br>                               <span>"#000000"</span>,<span>"#094c8b"</span>,<span>"#92d4f6"</span>)) -&gt; p2<br><br>library(patchwork)<br>p1+p2<br><br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.42685185185185187" data-src="https://mmbiz.qpic.cn/mmbiz_png/t1wZDoUyFk6fibCXC0OlRvMcL1UN8pibzCE4v47iaAC43XAa9ATdmsEVKIQrcAibEATbceHic22s1lr4AQNgSGQYgLA/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/t1wZDoUyFk6fibCXC0OlRvMcL1UN8pibzCE4v47iaAC43XAa9ATdmsEVKIQrcAibEATbceHic22s1lr4AQNgSGQYgLA/640?wx_fmt=png"><figcaption>image.png</figcaption></figure><blockquote data-tool="mdnice编辑器"><p>推文记录的是自己的学习笔记，内容可能会存在错误，请大家批判着看，欢迎大家指出其中的错误</p></blockquote><blockquote data-tool="mdnice编辑器"><p>示例数据和代码可以给推文点赞，然后点击在看，最后留言获取</p></blockquote><p data-tool="mdnice编辑器">欢迎大家关注我的公众号</p><p data-tool="mdnice编辑器"><strong>小明的数据分析笔记本</strong></p><section><mp-common-profile data-pluginname="mpprofile" data-weui-theme="light" data-id="MzI3NzQ3MTcxMg==" data-headimg="http://mmbiz.qpic.cn/mmbiz_png/t1wZDoUyFk5t1sOnM0iabvBhnfIj5YpyqrMib0E1MGCd9ibcYxaOPZd0GWhQBDvK2BPEwsicQxd6y5MHLfphnwHnow/0?wx_fmt=png" data-nickname="小明的数据分析笔记本" data-alias="" data-signature="分享R语言和python在生物信息领域做数据分析和数据可视化的简单小例子；偶尔会分享一些组学数据处理相关的内容" data-from="0" data-is_biz_ban="0"></mp-common-profile></section><p data-tool="mdnice编辑器"><br></p><blockquote data-tool="mdnice编辑器"><p>小明的数据分析笔记本 公众号 主要分享：1、R语言和python做数据分析和数据可视化的简单小例子；2、园艺植物相关转录组学、基因组学、群体遗传学文献阅读笔记；3、生物信息学入门学习资料及自己的学习笔记！</p></blockquote></section><p><br></p><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/JrtvjaxoqNf7sQuLBhswQA",target="_blank" rel="noopener noreferrer">原文链接</a>
