---
title: "​高分文章都在炫的双曲线火山图怎么画？新型火山图拿捏！"
date: 2023-05-05T03:44:57Z
draft: ["false"]
tags: [
  "fetched",
  "SCIPainter"
]
categories: ["Acdemic"]
---
​高分文章都在炫的双曲线火山图怎么画？新型火山图拿捏！ by SCIPainter
------
<div><p data-mpa-powered-by="yiban.io"><span>火山图算是咱们在转录、蛋白、代谢等组学研究中用于可视化差异数据、筛选差异表达基因的重要图表了。</span></p><p><span><br></span></p><p><span>一般我们设定好阈值，绘制出的火山图效果如下：</span></p><p><span><br></span></p><p><img data-ratio="0.7675925925925926" data-src="https://mmbiz.qpic.cn/mmbiz_png/6kvRq2WRXphp1d6VLvcvHtShicOxF5vy85KTN0k8orRvawNFKaZB9xjicfCm33L2sqvicEyUf5MCYibs2MId4LjCtA/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/6kvRq2WRXphp1d6VLvcvHtShicOxF5vy85KTN0k8orRvawNFKaZB9xjicfCm33L2sqvicEyUf5MCYibs2MId4LjCtA/640?wx_fmt=png"></p><p><br></p><p><span>不过最近发现许多文章中出现了一种比较新颖的曲线阈值火山图，如在Cell中：</span></p><p><span><br></span></p><p><img data-ratio="0.5361111111111111" data-src="https://mmbiz.qpic.cn/mmbiz_png/6kvRq2WRXphp1d6VLvcvHtShicOxF5vy82p74dchaaViafxgye5dPfp8CtGyvmlCszHEXBVr3fx1P3mbG3Ew1nGA/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/6kvRq2WRXphp1d6VLvcvHtShicOxF5vy82p74dchaaViafxgye5dPfp8CtGyvmlCszHEXBVr3fx1P3mbG3Ew1nGA/640?wx_fmt=png"></p><p><span>（<em>Cell</em>, 2019）</span></p><p><span><br></span></p><p><span>应该是在原本阈值线的基础上新增了一个反比例函数曲线作为新阈值线，这样筛选到的差异基因或蛋白更为显著（数量会少点）。</span></p><p><span><br></span></p><p><span>下面我们从常规火山图的绘制开始学习，层层递进，两种类型全部拿捏！</span></p><p><br></p><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><p><span>#相关R包载入：</span><br mpa-from-tpl="t"><span>library</span>(dplyr)<br mpa-from-tpl="t"><span>library</span>(ggplot2)<br mpa-from-tpl="t"><span>library</span>(ggrepel)<br mpa-from-tpl="t"><span>library</span>(patchwork)<br mpa-from-tpl="t"><span>#本地测试数据读入：</span><br mpa-from-tpl="t"><span>df</span> &lt;- read.csv('testdt.csv',header = T)<br mpa-from-tpl="t"><span>head</span>(df)</p></pre></section><section><br></section><section><img data-ratio="0.27537922987164526" data-src="https://mmbiz.qpic.cn/mmbiz_png/6kvRq2WRXphp1d6VLvcvHtShicOxF5vy80sibZJrf3t1boadIthZXwJKkhlKI0BydMbB1qHP9nskibex0pnvTZeQQ/640?wx_fmt=png" data-type="png" data-w="857" src="https://mmbiz.qpic.cn/mmbiz_png/6kvRq2WRXphp1d6VLvcvHtShicOxF5vy80sibZJrf3t1boadIthZXwJKkhlKI0BydMbB1qHP9nskibex0pnvTZeQQ/640?wx_fmt=png"></section><section><br></section><section data-mpa-template="t" mpa-from-tpl="t"><section data-mpa-template="t" mpa-from-tpl="t"><section><section data-mid="" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><img data-ratio="1" data-w="46" data-src="https://mmbiz.qpic.cn/mmbiz_png/VxWiabJ2GUuxb7LhLaVRHCv7HUXHUo4Jr1b2y63efhp8tI4GCZK6QG87uKWaYS0JHmEtfztUB5ic9nMUdQXMlQtg/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" src="https://mmbiz.qpic.cn/mmbiz_png/VxWiabJ2GUuxb7LhLaVRHCv7HUXHUo4Jr1b2y63efhp8tI4GCZK6QG87uKWaYS0JHmEtfztUB5ic9nMUdQXMlQtg/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"></section><section data-mid="" mpa-from-tpl="t"><img data-ratio="1.3076923076923077" data-w="26" data-src="https://mmbiz.qpic.cn/mmbiz_png/z3lqr6k1WicJ7bQ5qfbIK3l5J2iaQfKEwaK133pEy3jXg6yAErLD6WYaC38Sg0jfscOub1yic8M3Tl23a6Z2yJmoQ/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" src="https://mmbiz.qpic.cn/mmbiz_png/z3lqr6k1WicJ7bQ5qfbIK3l5J2iaQfKEwaK133pEy3jXg6yAErLD6WYaC38Sg0jfscOub1yic8M3Tl23a6Z2yJmoQ/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"></section><section data-mid="" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><br mpa-from-tpl="t"></section><section data-mid="" mpa-from-tpl="t"><p data-mid=""><span>1. 常规阈值火山图绘制</span></p></section><section data-mid="" mpa-from-tpl="t"><br mpa-from-tpl="t"></section></section></section></section><section data-mid="" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><br mpa-from-tpl="t"></section></section></section></section></section><section><span></span><br></section></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><section><span>##筛选阈值确定：p＜0.05，|log2FC|＞1</span><br mpa-from-tpl="t"><span>pvalue</span> = 0.05<br mpa-from-tpl="t"><span>log2FC</span> = 1<br mpa-from-tpl="t"><span>#根据阈值添加上下调分组标签：</span><br mpa-from-tpl="t"><span>df</span>$group &lt;- case_when(<br mpa-from-tpl="t"><span>df</span>$log2FoldChange &gt; log2FC &amp; df$pvalue &lt; pvalue ~ <span>"up"</span>,<br mpa-from-tpl="t"><span>df</span>$log2FoldChange &lt; -log2FC &amp; df$pvalue &lt; pvalue ~ <span>"down"</span>,<br mpa-from-tpl="t"><span>TRUE</span> ~ 'none'<br mpa-from-tpl="t">)<br mpa-from-tpl="t"><span>head</span>(df)</section></pre></section><section><br></section><section><img data-ratio="0.25877192982456143" data-src="https://mmbiz.qpic.cn/mmbiz_png/6kvRq2WRXphp1d6VLvcvHtShicOxF5vy8icvXrK7Vh3ecubJonJeqiaUK1w8U8Yr6Id0D4ibuUK5w4WQU17Lvs3T4g/640?wx_fmt=png" data-type="png" data-w="912" src="https://mmbiz.qpic.cn/mmbiz_png/6kvRq2WRXphp1d6VLvcvHtShicOxF5vy8icvXrK7Vh3ecubJonJeqiaUK1w8U8Yr6Id0D4ibuUK5w4WQU17Lvs3T4g/640?wx_fmt=png"></section><section><br></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><section><span>#转换为因子指定绘图顺序；</span><br mpa-from-tpl="t"><span>df</span>$'-log10(pvalue)' &lt;- -log10(df$pvalue) <span>#新增-log10p列</span><br mpa-from-tpl="t"><span>df</span>$group &lt;- factor(df$group, levels = c(<span>"up"</span>,<span>"down"</span>,<span>"none"</span>))<br mpa-from-tpl="t"><span>#ggplot2建立映射：</span><br mpa-from-tpl="t"><span>p</span> &lt;- ggplot(data = df,<br mpa-from-tpl="t"><span>aes</span>(x = log2FoldChange, y = -log10(pvalue), color = group)) + <span>#建立映射</span><br mpa-from-tpl="t"><span>geom_point</span>(size = 2.2) <span>#绘制散点</span><br mpa-from-tpl="t"><span>p</span></section></pre></section><section><br></section><section><img data-ratio="0.7351851851851852" data-src="https://mmbiz.qpic.cn/mmbiz_png/6kvRq2WRXphp1d6VLvcvHtShicOxF5vy8qYFVCKDS05m6PkjnicEOt013ylicdQTwjepm1KOvH7tKZnqznc5WaYjg/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/6kvRq2WRXphp1d6VLvcvHtShicOxF5vy8qYFVCKDS05m6PkjnicEOt013ylicdQTwjepm1KOvH7tKZnqznc5WaYjg/640?wx_fmt=png"></section><section><br></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><section><span>#限制坐标轴(坐标轴自定义)：</span><br mpa-from-tpl="t"><span>p1</span> &lt;- p +<br mpa-from-tpl="t"><span>scale_x_continuous</span>(limits = c(-4, 4), breaks = seq(-4, 4, by = 2))+<br mpa-from-tpl="t"><span>scale_y_continuous</span>(expand = expansion(add = c(2, 0)),<br mpa-from-tpl="t"><span>limits</span> = c(0, 40), breaks = seq(0, 40, by = 10))<br mpa-from-tpl="t"><span>p1</span></section></pre></section><section><br></section><section><img data-ratio="0.7351851851851852" data-src="https://mmbiz.qpic.cn/mmbiz_png/6kvRq2WRXphp1d6VLvcvHtShicOxF5vy8qJosdFurM4kBWYflIAI3aPpHJ6Wr8aI4g2x4hV7oAn9yMjHwfEzeiaw/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/6kvRq2WRXphp1d6VLvcvHtShicOxF5vy8qJosdFurM4kBWYflIAI3aPpHJ6Wr8aI4g2x4hV7oAn9yMjHwfEzeiaw/640?wx_fmt=png"></section><section><br></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><section><span>#自定义颜色与主题：</span><br mpa-from-tpl="t"><span>mycol</span> &lt;- c(<span>"#EB4232"</span>,<span>"#2DB2EB"</span>,<span>"#d8d8d8"</span>)<br mpa-from-tpl="t"><span>mytheme</span> &lt;- theme_classic() +<br mpa-from-tpl="t"><span>theme</span>(<br mpa-from-tpl="t"><span>axis</span>.title = element_text(size = 15),<br mpa-from-tpl="t"><span>axis</span>.text = element_text(size = 14),<br mpa-from-tpl="t"><span>legend</span>.text = element_text(size = 14)<br mpa-from-tpl="t">)<br mpa-from-tpl="t"><span>p2</span> &lt;- p1 +<br mpa-from-tpl="t"><span>scale_colour_manual</span>(name = <span>""</span>, values = alpha(mycol, 0.7)) +<br mpa-from-tpl="t"><span>mytheme</span><br mpa-from-tpl="t"><span>p2</span></section></pre></section><section><br></section><section><img data-ratio="0.7351851851851852" data-src="https://mmbiz.qpic.cn/mmbiz_png/6kvRq2WRXphp1d6VLvcvHtShicOxF5vy8paBb7cCmdwE031MUtZIpmicE4eTeiay1z2w1iaMN8Wtj5QjkHtBEBicMow/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/6kvRq2WRXphp1d6VLvcvHtShicOxF5vy8paBb7cCmdwE031MUtZIpmicE4eTeiay1z2w1iaMN8Wtj5QjkHtBEBicMow/640?wx_fmt=png"></section><section><br></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><section><span>#添加阈值线：</span><br mpa-from-tpl="t"><span>p3</span> &lt;- p2 +<br mpa-from-tpl="t"><span>geom_hline</span>(yintercept = c(-log10(pvalue)),size = 0.7,color = <span>"black"</span>,lty = <span>"dashed"</span>) + #水平阈值线<br mpa-from-tpl="t"><span>geom_vline</span>(xintercept = c(-log2FC, log2FC),size = 0.7,color = <span>"black"</span>,lty = <span>"dashed"</span>) #垂直阈值线<br mpa-from-tpl="t"><span>p3</span></section></pre></section><section><br></section><section><img data-ratio="0.7351851851851852" data-src="https://mmbiz.qpic.cn/mmbiz_png/6kvRq2WRXphp1d6VLvcvHtShicOxF5vy8upJ2cmfibbddXE5hsHR4cpxvxVYtZwBiceNW7XfzYMjXwDLpWS9PNyBQ/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/6kvRq2WRXphp1d6VLvcvHtShicOxF5vy8upJ2cmfibbddXE5hsHR4cpxvxVYtZwBiceNW7XfzYMjXwDLpWS9PNyBQ/640?wx_fmt=png"></section><section><br></section><section data-mpa-template="t" mpa-from-tpl="t"><section data-mpa-template="t" mpa-from-tpl="t"><section><section data-mid="" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><img data-ratio="1" data-w="46" data-src="https://mmbiz.qpic.cn/mmbiz_png/VxWiabJ2GUuxb7LhLaVRHCv7HUXHUo4Jr1b2y63efhp8tI4GCZK6QG87uKWaYS0JHmEtfztUB5ic9nMUdQXMlQtg/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" src="https://mmbiz.qpic.cn/mmbiz_png/VxWiabJ2GUuxb7LhLaVRHCv7HUXHUo4Jr1b2y63efhp8tI4GCZK6QG87uKWaYS0JHmEtfztUB5ic9nMUdQXMlQtg/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"></section><section data-mid="" mpa-from-tpl="t"><img data-ratio="1.3076923076923077" data-w="26" data-src="https://mmbiz.qpic.cn/mmbiz_png/z3lqr6k1WicJ7bQ5qfbIK3l5J2iaQfKEwaK133pEy3jXg6yAErLD6WYaC38Sg0jfscOub1yic8M3Tl23a6Z2yJmoQ/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" src="https://mmbiz.qpic.cn/mmbiz_png/z3lqr6k1WicJ7bQ5qfbIK3l5J2iaQfKEwaK133pEy3jXg6yAErLD6WYaC38Sg0jfscOub1yic8M3Tl23a6Z2yJmoQ/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"></section><section data-mid="" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><br mpa-from-tpl="t"></section><section data-mid="" mpa-from-tpl="t"><p data-mid=""><span>2. 曲线阈值火山图绘制</span></p></section><section data-mid="" mpa-from-tpl="t"><br mpa-from-tpl="t"></section></section></section></section><section data-mid="" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><br mpa-from-tpl="t"></section></section></section></section></section><section><br></section></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><section><span>#根据反比例函数 y = 1/X和设定的阈值自定义双曲线函数：</span><br mpa-from-tpl="t"><span>f</span> &lt;- function(x){<br mpa-from-tpl="t"><span>inputx</span> &lt;- seq(0.0001, x, by = 0.0001)<br mpa-from-tpl="t"><span>y</span> &lt;- 1/(inputx) + (-log10(pvalue))<br mpa-from-tpl="t"><span>dff</span> &lt;- rbind(data.frame(x = inputx + log2FC, y = y),<br mpa-from-tpl="t"><span>data</span>.frame(x = -(inputx + log2FC), y = y))<br mpa-from-tpl="t"><span>return</span>(dff)<br mpa-from-tpl="t">}<br mpa-from-tpl="t"><span>#根据函数生成所需的曲线数组坐标：</span><br mpa-from-tpl="t"><span>dff_curve</span> &lt;- f(5)<br mpa-from-tpl="t"><span>head</span>(dff_curve)</section></pre></section><section><br></section><section><img data-ratio="0.3848684210526316" data-src="https://mmbiz.qpic.cn/mmbiz_png/6kvRq2WRXphp1d6VLvcvHtShicOxF5vy8cRAxFXrSoo9nuDkaO44EUWaFD0s2Sf1E1bcWfKXjx9SbIEUHJ0ECkw/640?wx_fmt=png" data-type="png" data-w="608" src="https://mmbiz.qpic.cn/mmbiz_png/6kvRq2WRXphp1d6VLvcvHtShicOxF5vy8cRAxFXrSoo9nuDkaO44EUWaFD0s2Sf1E1bcWfKXjx9SbIEUHJ0ECkw/640?wx_fmt=png"></section><section><br></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><section><span>#新增曲线数值列：</span><br mpa-from-tpl="t"><span>##每列log2FoldChange值在曲线上对应的y轴坐标；</span><br mpa-from-tpl="t"><span>df</span>$curve_y &lt;- case_when(<br mpa-from-tpl="t"><span>df</span>$log2FoldChange &gt; 0 ~ 1/(df$log2FoldChange-log2FC) + (-log10(pvalue)),<br mpa-from-tpl="t"><span>df</span>$log2FoldChange &lt;= 0 ~ 1/(-df$log2FoldChange-log2FC) + (-log10(pvalue))<br mpa-from-tpl="t">)<br mpa-from-tpl="t"><span>#根据曲线新增上下调分组标签：</span><br mpa-from-tpl="t"><span>df</span>$group2 &lt;- case_when(<br mpa-from-tpl="t"><span>df</span>$`-log10(pvalue)` &gt; df$curve_y &amp; df$log2FoldChange &gt;= log2FC ~ 'up',<br mpa-from-tpl="t"><span>df</span>$`-log10(pvalue)` &gt; df$curve_y &amp; df$log2FoldChange &lt;= -log2FC ~ 'down',<br mpa-from-tpl="t"><span>TRUE</span> ~ 'none'<br mpa-from-tpl="t">)<br mpa-from-tpl="t"><span>#绘制新双曲线阈值火山图：</span><br mpa-from-tpl="t"><span>df</span>$group2 &lt;- factor(df$group2, levels = c(<span>"up"</span>,<span>"down"</span>,<span>"none"</span>)) <span>#指定顺序</span><br mpa-from-tpl="t"><span>mycol2</span> &lt;- c(<span>"#F8B606"</span>,<span>"#4A1985"</span>,<span>"#d8d8d8"</span>)<br mpa-from-tpl="t"><span>p4</span> &lt;- ggplot(data = df,<br mpa-from-tpl="t"><span>aes</span>(x = log2FoldChange, y = -log10(pvalue), color = group2)) + <span>#使用新的分组</span><br mpa-from-tpl="t"><span>geom_point</span>(size = 2.2) +<br mpa-from-tpl="t"><span>scale_x_continuous</span>(limits = c(-4, 4), breaks = seq(-4, 4, by = 2)) +<br mpa-from-tpl="t"><span>scale_y_continuous</span>(expand = expansion(add = c(2, 0)),<br mpa-from-tpl="t"><span>limits</span> = c(0, 40), breaks = seq(0, 40, by = 10)) +<br mpa-from-tpl="t"><span>scale_colour_manual</span>(name = <span>""</span>, values = alpha(mycol2, 0.7)) +<br mpa-from-tpl="t"><span>geom_line</span>(data = dff_curve,<br mpa-from-tpl="t"><span>aes</span>(x = x, y = y), <span>#曲线坐标</span><br mpa-from-tpl="t"><span>color</span> = <span>"black"</span>,lty = <span>"dashed"</span>, size = 0.7) +<br mpa-from-tpl="t"><span>mytheme</span><br mpa-from-tpl="t"><span>p4</span></section></pre></section><section><br></section><section><img data-ratio="0.7351851851851852" data-src="https://mmbiz.qpic.cn/mmbiz_png/6kvRq2WRXphp1d6VLvcvHtShicOxF5vy8a7JBzZZnqtWrTEY3p7jP63zeE9HOZY8f3Xq54lQXMADeCYXsKibibSkw/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/6kvRq2WRXphp1d6VLvcvHtShicOxF5vy8a7JBzZZnqtWrTEY3p7jP63zeE9HOZY8f3Xq54lQXMADeCYXsKibibSkw/640?wx_fmt=png"></section><section><br></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><section><span>#拼图：</span><br mpa-from-tpl="t"><span>p3</span> + p4</section></pre></section><section><br></section><section><img data-ratio="0.36203703703703705" data-src="https://mmbiz.qpic.cn/mmbiz_png/6kvRq2WRXphp1d6VLvcvHtShicOxF5vy8MQLG7ZYvicgZtfCGicty2G3BCiaye8o2m1mOG9BfHhKjJn1H4a7TiaF3hA/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/6kvRq2WRXphp1d6VLvcvHtShicOxF5vy8MQLG7ZYvicgZtfCGicty2G3BCiaye8o2m1mOG9BfHhKjJn1H4a7TiaF3hA/640?wx_fmt=png"></section><section><br></section><section data-mpa-template="t" mpa-from-tpl="t"><section data-mpa-template="t" mpa-from-tpl="t"><section><section data-mid="" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><img data-ratio="1" data-w="46" data-src="https://mmbiz.qpic.cn/mmbiz_png/VxWiabJ2GUuxb7LhLaVRHCv7HUXHUo4Jr1b2y63efhp8tI4GCZK6QG87uKWaYS0JHmEtfztUB5ic9nMUdQXMlQtg/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" src="https://mmbiz.qpic.cn/mmbiz_png/VxWiabJ2GUuxb7LhLaVRHCv7HUXHUo4Jr1b2y63efhp8tI4GCZK6QG87uKWaYS0JHmEtfztUB5ic9nMUdQXMlQtg/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"></section><section data-mid="" mpa-from-tpl="t"><img data-ratio="1.3076923076923077" data-w="26" data-src="https://mmbiz.qpic.cn/mmbiz_png/z3lqr6k1WicJ7bQ5qfbIK3l5J2iaQfKEwaK133pEy3jXg6yAErLD6WYaC38Sg0jfscOub1yic8M3Tl23a6Z2yJmoQ/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" src="https://mmbiz.qpic.cn/mmbiz_png/z3lqr6k1WicJ7bQ5qfbIK3l5J2iaQfKEwaK133pEy3jXg6yAErLD6WYaC38Sg0jfscOub1yic8M3Tl23a6Z2yJmoQ/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"></section><section data-mid="" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><br mpa-from-tpl="t"></section><section data-mid="" mpa-from-tpl="t"><p data-mid=""><span>3. 添加自定义标签</span></p></section><section data-mid="" mpa-from-tpl="t"><br mpa-from-tpl="t"></section></section></section></section><section data-mid="" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><br mpa-from-tpl="t"></section></section></section></section></section><section><br></section></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><section><span>#筛选显著性top10标签：</span><br mpa-from-tpl="t"><span>top10</span> &lt;- filter(df, group2 != <span>"none"</span>) %&gt;%<br mpa-from-tpl="t"><span>distinct</span>(Symbol, .keep_all = T) %&gt;%<br mpa-from-tpl="t"><span>top_n</span>(10, abs(log2FoldChange))<br mpa-from-tpl="t"><span>p5</span> &lt;- p3 +<br mpa-from-tpl="t"><span>geom_text_repel</span>(data = top10,<br mpa-from-tpl="t"><span>aes</span>(x = log2FoldChange, y = -log10(pvalue), label = Symbol),<br mpa-from-tpl="t"><span>force</span> = 80, color = 'black', size = 3.2,<br mpa-from-tpl="t"><span>point</span>.padding = 0.5, hjust = 0.5,<br mpa-from-tpl="t"><span>arrow</span> = arrow(length = unit(0.02, <span>"npc"</span>),<br mpa-from-tpl="t"><span>type</span> = <span>"open"</span>, ends = <span>"last"</span>),<br mpa-from-tpl="t"><span>segment</span>.color=<span>"black"</span>,<br mpa-from-tpl="t"><span>segment</span>.size = 0.3,<br mpa-from-tpl="t"><span>nudge_x</span> = 0,<br mpa-from-tpl="t"><span>nudge_y</span> = 1)<br mpa-from-tpl="t"><span>p5</span></section></pre></section><section><br></section><section><img data-ratio="0.7675925925925926" data-src="https://mmbiz.qpic.cn/mmbiz_png/6kvRq2WRXphp1d6VLvcvHtShicOxF5vy85KTN0k8orRvawNFKaZB9xjicfCm33L2sqvicEyUf5MCYibs2MId4LjCtA/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/6kvRq2WRXphp1d6VLvcvHtShicOxF5vy85KTN0k8orRvawNFKaZB9xjicfCm33L2sqvicEyUf5MCYibs2MId4LjCtA/640?wx_fmt=png"></section><section><br></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><section><span>p6</span> &lt;- p4 +<br mpa-from-tpl="t"><span>geom_text_repel</span>(data = top10,<br mpa-from-tpl="t"><span>aes</span>(x = log2FoldChange, y = -log10(pvalue), label = Symbol),<br mpa-from-tpl="t"><span>force</span> = 80, color = 'black', size = 3.2,<br mpa-from-tpl="t"><span>point</span>.padding = 0.5, hjust = 0.5,<br mpa-from-tpl="t"><span>arrow</span> = arrow(length = unit(0.02, <span>"npc"</span>),<br mpa-from-tpl="t"><span>type</span> = <span>"open"</span>, ends = <span>"last"</span>),<br mpa-from-tpl="t"><span>segment</span>.color=<span>"black"</span>,<br mpa-from-tpl="t"><span>segment</span>.size = 0.3,<br mpa-from-tpl="t"><span>nudge_x</span> = 0,<br mpa-from-tpl="t"><span>nudge_y</span> = 1)<br mpa-from-tpl="t"><span>p6</span></section></pre></section><section><br></section><section><img data-ratio="0.7675925925925926" data-src="https://mmbiz.qpic.cn/mmbiz_png/6kvRq2WRXphp1d6VLvcvHtShicOxF5vy89yIvlibeMSYaD2oEV8Fo0owuBdB14GVg8aQVKPFtjm2bWIzP9D7eflg/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/6kvRq2WRXphp1d6VLvcvHtShicOxF5vy89yIvlibeMSYaD2oEV8Fo0owuBdB14GVg8aQVKPFtjm2bWIzP9D7eflg/640?wx_fmt=png"></section><section><br></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><section><span>#拼图</span><br mpa-from-tpl="t"><span>p5</span> + p6</section></pre></section><section><br></section><section><img data-ratio="0.36203703703703705" data-src="https://mmbiz.qpic.cn/mmbiz_png/6kvRq2WRXphp1d6VLvcvHtShicOxF5vy81E9Elf81QFtjibeNLlGUuafT19wwbQnlvH6rmU8W2muaqRD3Wney3CQ/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/6kvRq2WRXphp1d6VLvcvHtShicOxF5vy81E9Elf81QFtjibeNLlGUuafT19wwbQnlvH6rmU8W2muaqRD3Wney3CQ/640?wx_fmt=png"></section><section><br></section><section><span>好啦，今天的分享就到这里！</span></section><section data-mpa-template="t" mpa-from-tpl="t"><section data-role="title" data-tools="135编辑器" data-id="113060" mpa-from-tpl="t"><section><section mpa-from-tpl="t"><section mpa-from-tpl="t"><section mpa-from-tpl="t"><section mpa-from-tpl="t"><br mpa-from-tpl="t"></section><section data-brushtype="text" hm_fix="302:513" mpa-from-tpl="t"><span><strong mpa-from-tpl="t">参考文献</strong></span></section><section mpa-from-tpl="t"><br mpa-from-tpl="t"></section></section><section mpa-from-tpl="t"><br mpa-from-tpl="t"></section></section></section></section></section></section><section><span>Harel M, Ortenberg R, Varanasi S K, et al. Proteomics of melanoma response to immunotherapy reveals mitochondrial dependence[J]. Cell, 2019, 179(1): 236-250. e18.</span><br></section><section><br></section><section><strong><span>*未经许可，不得以任何方式复制或抄袭本篇文章之部分或全部内容。版权所有，侵权必究。</span></strong></section><section><br></section><section data-tools="135编辑器" data-id="100625"><section><section><img data-galleryid="" data-ratio="1.2666666666666666" data-src="https://mmbiz.qpic.cn/mmbiz_gif/6kvRq2WRXpjibT3YBB4rzAbpFham1zGOPYzcKqcSBqbSnCEI0QzDA8Hjfu0ppuco4ZfLuxhcfH4GD69iaZpfoN7A/640?wx_fmt=gif" data-type="gif" data-w="600" src="https://mmbiz.qpic.cn/mmbiz_gif/6kvRq2WRXpjibT3YBB4rzAbpFham1zGOPYzcKqcSBqbSnCEI0QzDA8Hjfu0ppuco4ZfLuxhcfH4GD69iaZpfoN7A/640?wx_fmt=gif"></section><section><strong><span>基迪奥生物|专业定制测序服务</span></strong><br></section><section><section><section data-brushtype="text"><span><strong>联系方式：020-39341079；service@genedenovo.com</strong></span></section></section><section><section><img data-ratio="1" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/6kvRq2WRXpjibT3YBB4rzAbpFham1zGOPp58TI0RWbkqEM3Rq8cvlxtQMlWxXHm6eOWCnxicBt1wIdrHZ7JtxvXg/640?wx_fmt=jpeg" data-type="jpeg" data-w="258" data-width="100%" title="公众号二维码.jpg" src="https://mmbiz.qpic.cn/mmbiz_jpg/6kvRq2WRXpjibT3YBB4rzAbpFham1zGOPp58TI0RWbkqEM3Rq8cvlxtQMlWxXHm6eOWCnxicBt1wIdrHZ7JtxvXg/640?wx_fmt=jpeg"></section><section data-brushtype="text"><span><strong><span>扫码关注</span></strong></span></section></section></section></section></section><section data-role="paragraph"><section><br></section></section><section><mp-style-type data-value="10000"></mp-style-type></section></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/Dht1nW541anAYYc17Iq1Lw",target="_blank" rel="noopener noreferrer">原文链接</a>
