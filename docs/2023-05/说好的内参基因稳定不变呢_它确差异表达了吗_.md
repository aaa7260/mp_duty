---
title: "说好的内参基因稳定不变呢？它确差异表达了吗？"
date: 2023-05-03T00:49:32Z
draft: ["false"]
tags: [
  "fetched",
  "生信技能树"
]
categories: ["Acdemic"]
---
说好的内参基因稳定不变呢？它确差异表达了吗？ by 生信技能树
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><blockquote data-tool="mdnice编辑器"><p>最近安排学徒做文献图表复现，其中一个表达量芯片和测序项目都是同样的处理和对照，所以让学徒做一下这两个表达矩阵的差异分析，比较一下不同技术是否有比较好的吻合。</p></blockquote><p data-tool="mdnice编辑器">其中测序是：https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE64486</p><p data-tool="mdnice编辑器">可以看到是8个KD病人，他们一半处理一半为处理：</p><pre data-tool="mdnice编辑器"><span></span><code>GSM1572233 KD1 - untreated<br>GSM1572234 KD2 - untreated<br>GSM1572235 KD3 - untreated<br>GSM1572236 KD4 - untreated<br>GSM1572237 KD5 - treated<br>GSM1572238 KD6 - treated<br>GSM1572239 KD7 - treated<br>GSM1572240 KD8 - treated<br></code></pre><p data-tool="mdnice编辑器">作者给出来的每个样品一个独立的表达量矩阵txt格式的文本文件：</p><pre data-tool="mdnice编辑器"><span></span><code>GSM1572233_8502X3_case_union_COUNTS.txt.gz 175.2 Kb<br>GSM1572234_10229X2_case_union_COUNTS.txt.gz 186.7 Kb<br>GSM1572235_10229X1_case_union_COUNTS.txt.gz 189.7 Kb<br>GSM1572236_9374X3_case_union_COUNTS.txt.gz 177.3 Kb<br>GSM1572237_8898X1_case_union_COUNTS.txt.gz 189.5 Kb<br>GSM1572238_8898X2_case_union_COUNTS.txt.gz 188.2 Kb<br>GSM1572239_8502X4_case_union_COUNTS.txt.gz 186.7 Kb<br>GSM1572240_10229X3_case_union_COUNTS.txt.gz 191.3 Kb<br></code></pre><p data-tool="mdnice编辑器">其对应的文章是：The transcriptional profile of coronary arteritis in Kawasaki disease. <em>BMC Genomics</em> 2015 Dec ，作者做的是这些KD病人去跟正常人的对比：</p><p><img data-galleryid="" data-ratio="0.5781448538754765" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wwPFvoGric8TIqQoQmkKy1xOYGicBqupWtaCTptPtuSN4L4xK6xKgtlXNeWxETkgiaqImNkJVHlibDAuw/640?wx_fmt=png" data-type="png" data-w="1574" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wwPFvoGric8TIqQoQmkKy1xOYGicBqupWtaCTptPtuSN4L4xK6xKgtlXNeWxETkgiaqImNkJVHlibDAuw/640?wx_fmt=png"></p><figure data-tool="mdnice编辑器"><figcaption>这些KD病人去跟正常人的对比</figcaption></figure><p data-tool="mdnice编辑器">做了三次差异分析，都是病人和正常人的对比，并没有做4个处理的病人和4个未处理病人的差异，所以我安排学徒做了这个。</p><p data-tool="mdnice编辑器">有意思的是，默认情况下我们会读取表达量矩阵后看看常见的管家基因是否是高表达，来确定矩阵的准确性。如下所示的代码，需要自己下载GSE64486_RAW.tar文件，然后解压哦，接下来就可以读取解压后的文件夹里面的全部的 txt文件 ：</p><pre data-tool="mdnice编辑器"><span></span><code>fs=list.files(<span>'GSE64486_RAW/'</span>,pattern = <span>'case'</span>,full.names = <span>T</span>)<br>fs<br><span>library</span>(data.table)<br>gid=fread(fs[<span>1</span>],data.table = <span>F</span>)[,<span>1</span>]<br>head(gid)<br>rawcount = do.call(cbind,<br>        lapply(fs, <span>function</span>(x){<br>          fread(x,data.table = <span>F</span>)[,<span>2</span>]<br>        }))<br>rawcount[<span>1</span>:<span>4</span>,<span>1</span>:<span>4</span>]<br>keep &lt;- rowSums(rawcount&gt;<span>0</span>) &gt;= floor(<span>0.75</span>*ncol(rawcount))<br>table(keep)<br>rawcount=rawcount[keep,]<br>gid=gid[keep] <br><br><span>library</span>(AnnoProbe)<br>ids=annoGene( gid ,<br>            ID_type = <span>'ENSEMBL'</span>,species = <span>'human'</span><br>)<br>head(ids)<br>ids=ids[!duplicated(ids$SYMBOL),]<br>rawcount=rawcount[match(ids$ENSEMBL , gid),]<br>rownames(rawcount) = ids$SYMBOL<br>rawcount[<span>1</span>:<span>4</span>,<span>1</span>:<span>4</span>]<br>rawcount[<span>'GAPDH'</span>,]<br>cg = log2(edgeR::cpm(rawcount)+<span>1</span>)[<span>'GAPDH'</span>,]<br>gp = rep(c(<span>'untreated'</span>,<span>'treated'</span>),each=<span>4</span>)<br>t.test(cg ~ gp)<br></code></pre><p data-tool="mdnice编辑器">可以看到：</p><pre data-tool="mdnice编辑器"><span></span><code>&gt; rawcount[1:4,1:4]<br>           [,1] [,2] [,3] [,4]<br>WASH7P        6    5   10    0<br>AL627309.1   27   28   13    4<br>AL627309.5   46  101   88   29<br>AL627309.4    0    6   11    5<br>&gt; rawcount[<span>'GAPDH'</span>,]<br>[1]   720   873  2374   893  2655  6928  2687 12173<br></code></pre><p data-tool="mdnice编辑器">表达量矩阵本身没有问题，表达量比较高就是两个超级出名的非编码基因，以及线粒体基因等等：</p><p><img data-galleryid="" data-ratio="0.656060606060606" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wwPFvoGric8TIqQoQmkKy1xOjQTCSCgIenKcicpSN3YQ9KvbWZiciaMuOqhCAo9yqveqjJvXhV1eCWlnw/640?wx_fmt=png" data-type="png" data-w="1320" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wwPFvoGric8TIqQoQmkKy1xOjQTCSCgIenKcicpSN3YQ9KvbWZiciaMuOqhCAo9yqveqjJvXhV1eCWlnw/640?wx_fmt=png"></p><figure data-tool="mdnice编辑器"><figcaption>合理的表达量矩阵</figcaption></figure><p data-tool="mdnice编辑器">符合常识，所以我非常确定作者的转录组上游定量流程是ok的。但是它确实在GAPDH这个基因上面，有表达量的差异，仅仅是原始counts值就出现了肉眼可见的巨大差异，哪怕是归一化后也是如此 ：</p><pre data-tool="mdnice编辑器"><span></span><code>&gt; log2(edgeR::cpm(rawcount)+1)[<span>'GAPDH'</span>,]<br>[1] 8.176485 6.939699 7.703584 6.935478 8.039263 8.904722 8.204658 9.174328<br><br>&gt; t.test(cg ~ gp)<br><br> Welch Two Sample t-test<br><br>data:  cg by gp<br>t = 2.7911, df = 5.9258, p-value = 0.03195<br>sample estimates:<br>  mean <span>in</span> group treated mean <span>in</span> group untreated <br>               8.580743                7.438812 <br></code></pre><p data-tool="mdnice编辑器">当然了，我们不能是仅仅是靠肉眼，靠单个基因的检验 ，我们还是使用常见的转录组测序表达量矩阵的差异分析方法：</p><pre data-tool="mdnice编辑器"><span></span><code>exprSet = rawcount<br>group_list = gp<br><span># 加载包</span><br><span>library</span>(DESeq2) <br><span># 第一步，构建DESeq2的DESeq对象</span><br>colData &lt;- data.frame(row.names=colnames(exprSet),group_list=group_list)<br>dds &lt;- DESeqDataSetFromMatrix(countData = exprSet,colData = colData,design = ~ group_list)<br><br><span># 第二步，进行差异表达分析</span><br>dds2 &lt;- DESeq(dds)<br><br><span># 提取差异分析结果，trt组对untrt组的差异分析结果</span><br>tmp &lt;- results(dds2,contrast=c(<span>"group_list"</span>,<span>"treated"</span>,<span>"untreated"</span>))<br>DEG_DESeq2 &lt;- as.data.frame(tmp[order(tmp$padj),])<br>head(DEG_DESeq2)<br><br><span># 去除差异分析结果中包含NA值的行</span><br>DEG_DESeq2 = na.omit(DEG_DESeq2)<br>DEG_DESeq2[<span>'GAPDH'</span>,]<br></code></pre><p data-tool="mdnice编辑器">可以看到，这个时候它仍然是统计学显著，也就是说pvalue是 0.05以下，但是矫正后padj就不显著啦，所以它被排除到差异上下调基因之外了哦。</p><p data-tool="mdnice编辑器">另外，它的log2FoldChange 已经是 1.14而已，我们如果稍微提高一下阈值，比如 1.5，它这个基因也没有统计学显著的差异。我们肉眼看到的差异其实是转录组测序本身的技术噪音，它一下子对两万多个基因进行定量，肯定是有一些哪怕是本身并不会在两个分组有明显差异表达量的基因也会表现出来差异，但是差异是否在可以接受的范围就需要严格的统计学检验了哦。</p><p data-tool="mdnice编辑器">眼尖的小朋友可能会注意到，其实这个探索，忽略了一个很重要的质量控制，就是三张图。我在生信技能树的教程：<a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247491228&amp;idx=1&amp;sn=34fed09dec0f8c27bd408ba8476d9133&amp;scene=21#wechat_redirect" data-linktype="2">《你确定你的差异基因找对了吗？》</a>提到过，必须要对你的<strong>转录水平的全局表达矩阵</strong>做好质量控制，最好是看到<strong>标准3张图</strong>：</p><ul data-tool="mdnice编辑器"><li><section>左边的热图，说明我们实验的两个分组，normal和npc的很多基因表达量是有明显差异的</section></li><li><section>中间的PCA图，说明我们的normal和npc两个分组非常明显的差异</section></li><li><section>右边的层次聚类也是如此，说明我们的normal和npc两个分组非常明显的差异</section></li></ul><p data-tool="mdnice编辑器">如果分组在3张图里面体现不出来，<strong>实际上后续差异分析是有风险的</strong>。这个时候需要根据你自己不合格的3张图，仔细探索哪些样本是离群点，自行查询中间过程可能的问题所在，或者检查是否有其它混杂因素，都是会影响我们的差异分析结果的生物学解释。</p><h3 data-tool="mdnice编辑器"><span></span>学徒作业<span></span></h3><p data-tool="mdnice编辑器">针对这个GSE64486数据集进行文章的3次差异分析，并且和作者给出来的上下调基因进行对比，看看十年前的差异分析和现在的差异分析，是否会有很严重的区别！</p><pre data-tool="mdnice编辑器"><span></span><code>GSE64486_case_vs_control_foldgenes_broad.txt.gz 1.3 Mb  <br>GSE64486_treated_vs_control_foldgenes_broad.txt.gz 1.1 Mb <br>GSE64486_untreated_vs_control_foldgenes_broad.txt.gz 1.2 Mb <br></code></pre></section><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><p data-tool="mdnice编辑器"><span>文末友情宣传</span><br></p></section></section><p data-tool="mdnice编辑器">强烈建议你推荐给身边的<strong>博士后以及年轻生物学PI</strong>，多一点数据认知，让他们的科研上一个台阶：</p><ul data-tool="mdnice编辑器"><li><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247513829&amp;idx=1&amp;sn=ac6e5883d88069f8c0b07842a84866d6&amp;chksm=9b4bf65eac3c7f48dd00cc50ced7a45bce4f7535f731a36e1f84064e242e8761d7e4a57d31cf&amp;scene=21#wechat_redirect" textvalue="数据挖掘（GEO,TCGA,单细胞）2022‍年5~6月场" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" wah-hotarea="click" hasload="1">数据挖掘（GEO,TCGA,单细胞）2022年5~6月场</a>，快速了解一些生物信息学应用图表</section></li><li><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247513829&amp;idx=2&amp;sn=ea5e82df5c7295bb62a2767f2a5ca2a2&amp;chksm=9b4bf65eac3c7f48c715edf15c690909e3922e907d5330586fd927449b91bd1b8efb4b6c53e8&amp;scene=21#wechat_redirect" textvalue="生信入门课-2022年5~6月场" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" wah-hotarea="click" hasload="1">生信入门课-2022年5~6月场</a>，你的生物信息学第一课</section></li></ul><p><br></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/uNvcIuhFrVY46Mh44GvLww",target="_blank" rel="noopener noreferrer">原文链接</a>
