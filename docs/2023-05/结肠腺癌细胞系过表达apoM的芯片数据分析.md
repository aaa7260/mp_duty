---
title: "结肠腺癌细胞系过表达apoM的芯片数据分析"
date: 2023-05-03T00:44:39Z
draft: ["false"]
tags: [
  "fetched",
  "生信技能树"
]
categories: ["Acdemic"]
---
结肠腺癌细胞系过表达apoM的芯片数据分析 by 生信技能树
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><blockquote data-tool="mdnice编辑器"><p>前面咱们组建了交流群：<a href="https://mp.weixin.qq.com/s?__biz=MzUzMTEwODk0Ng==&amp;mid=2247504144&amp;idx=2&amp;sn=4bfaa0064cef963de6d144f073a4f112&amp;scene=21#wechat_redirect" data-linktype="2">让天下没有难处理的表达量芯片</a>，帮助大家解决了各种稀奇古怪的芯片。确实有一些表达量芯片数据集就很难，对初学者来说。</p></blockquote><p data-tool="mdnice编辑器">比如GSE162325这个数据集，它比较新：https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE162325，所以如果你使用我的AnnoProbe包里面的 geoChina("GSE162325") 函数会失败，因为我最近没有空去同步这些新的表达量芯片数据集。</p><p data-tool="mdnice编辑器">而且平台好奇怪：GPL23126 [Clariom_D_Human] Affymetrix Human Clariom D Assay [transcript (gene) version]  ，不过是很标准的两个分组：</p><pre data-tool="mdnice编辑器"><span></span><code>GSM4949747 NC-1<br>GSM4949748 NC-2<br>GSM4949749 NC-3<br>GSM4949750 Overexpression-1<br>GSM4949751 Overexpression-2<br>GSM4949752 Overexpression-3<br></code></pre><p data-tool="mdnice编辑器">因为比较新，所以没有被 AnnoProbe 收录 ，我是自己去其页面下载了 GSE162325_series_matrix.txt.gz 文件 ， 网页地址是：</p><ul data-tool="mdnice编辑器"><li><section>https://ftp.ncbi.nlm.nih.gov/geo/series/GSE162nnn/GSE162325/matrix/GSE162325_series_matrix.txt.gz</section></li></ul><p data-tool="mdnice编辑器">然后使用 GEOquery 加载它 ，如下所示的代码  ：</p><pre data-tool="mdnice编辑器"><span></span><code>rm(list = ls())  <span>## 魔幻操作，一键清空~</span><br>options(stringsAsFactors = <span>F</span>)<br><br>getOption(<span>'timeout'</span>)<br>options(timeout=<span>10000</span>)<br><br><span>library</span>(AnnoProbe)<br><span>library</span>(GEOquery) <br><span>if</span>(<span>F</span>){<br>  gset &lt;- geoChina(<span>"GSE162325"</span>)<br>  gset<br>}<br><br>gset &lt;- getGEO(<span>"GSE162325"</span>,<br>               filename = <span>'GSE162325_series_matrix.txt.gz'</span>,<br>               AnnotGPL = <span>FALSE</span>, getGPL = <span>FALSE</span>)<br>               <br><span># trying URL 'https://ftp.ncbi.nlm.nih.gov/geo/series/GSE162nnn/GSE162325/matrix/GSE162325_series_matrix.txt.gz'</span><br><span>#  cannot open URL 'https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?targ=self&amp;acc=GPL23126&amp;form=text&amp;view=full'</span><br></code></pre><p data-tool="mdnice编辑器">可以看到，确实比较麻烦，而且表达量芯片对应的探针信息也需要自己注释：https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GPL23126</p><p data-tool="mdnice编辑器">可以看到：</p><p><img data-galleryid="" data-ratio="0.5853658536585366" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4ww1hSNqetic61XFaJ8kpoBh9ZgyKUZttJFS1ofibyyUbzlSb9wMlsyzL1ZHxs8icewKBib9cvUL6TRyAw/640?wx_fmt=png" data-type="png" data-w="1230" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4ww1hSNqetic61XFaJ8kpoBh9ZgyKUZttJFS1ofibyyUbzlSb9wMlsyzL1ZHxs8icewKBib9cvUL6TRyAw/640?wx_fmt=png"></p><figure data-tool="mdnice编辑器"><figcaption>探针信息也需要自己注释</figcaption></figure><p data-tool="mdnice编辑器">在 https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?targ=self&amp;acc=GPL23126&amp;form=text&amp;view=full 可以下载一个 GPL23126.txt的文本文件，大约是1G，内容有点多，所以需要简单的处理一下，我这里使用了shell命令：</p><pre data-tool="mdnice编辑器"><span></span><code>cut -f 1,8 GPL23126.txt |grep -v <span>"^!"</span>|grep -v <span>"^#"</span> &gt;  GPL23126_ids.txt<br></code></pre><p data-tool="mdnice编辑器">然后又是R里面的解析即可，如下所示的代码：</p><pre data-tool="mdnice编辑器"><span></span><code><br><span>library</span>(data.table)<br><span>library</span>(stringr)<br><span># b=fread('GPL23126.txt',data.table = F)</span><br><span># cut -f 1,8 GPL23126.txt |grep -v "^!"|grep -v "^#" &gt;  GPL23126_ids.txt</span><br>b=fread(<span>'GPL23126_ids.txt'</span>,data.table = <span>F</span>)<br>head(b)<br>ids=data.frame(<br>  ID=b$ID,<br>  symbol=str_split(b$gene_assignment,<span>' // '</span>,simplify = <span>T</span>)[,<span>2</span>]<br>)<br>head(ids)<br>ids=ids[ids$symbol != <span>''</span>,]<br>dat=dat[rownames(dat) %<span>in</span>% ids$ID,]<br>ids=ids[match(rownames(dat),ids$ID),]<br>head(ids) <br><br>colnames(ids)=c(<span>'probe_id'</span>,<span>'symbol'</span>)  <br>ids$probe_id=as.character(ids$probe_id)<br>rownames(dat)=ids$probe_id<br>dat[<span>1</span>:<span>4</span>,<span>1</span>:<span>4</span>] <br><br>ids=ids[ids$probe_id %<span>in</span>%  rownames(dat),]<br>dat[<span>1</span>:<span>4</span>,<span>1</span>:<span>4</span>]   <br>dat=dat[ids$probe_id,] <br></code></pre><p data-tool="mdnice编辑器">后续也是常规分析，如下所示：</p><p><img data-galleryid="" data-ratio="1" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4ww1hSNqetic61XFaJ8kpoBh9Vy1UQeThBfSKG7Xq6HkXNgxaVFsibBhftWHtl6f4VTk33XSPFkfMDeg/640?wx_fmt=png" data-type="png" data-w="2100" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4ww1hSNqetic61XFaJ8kpoBh9Vy1UQeThBfSKG7Xq6HkXNgxaVFsibBhftWHtl6f4VTk33XSPFkfMDeg/640?wx_fmt=png"></p><figure data-tool="mdnice编辑器"><figcaption>两个分组很明显</figcaption></figure><p data-tool="mdnice编辑器">后面的步骤我就不多说了，标准代码在交流群：<a href="https://mp.weixin.qq.com/s?__biz=MzUzMTEwODk0Ng==&amp;mid=2247504144&amp;idx=2&amp;sn=4bfaa0064cef963de6d144f073a4f112&amp;scene=21#wechat_redirect" data-linktype="2">让天下没有难处理的表达量芯片</a>，群公告置顶，感兴趣的自己去拿哈！</p><blockquote data-tool="mdnice编辑器"><p>GEO数据库里面的表达量芯片数据处理，主要的难点是表达量矩阵获取和探针的基因名字转换，搞定后只需要一定的生物学背景对数据进行合理的分组后就是标准的差异分析，富集分析。<strong>主要是参考我八年前的笔记：</strong></p></blockquote><ul data-tool="mdnice编辑器"><li><section><a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247486063&amp;idx=1&amp;sn=156bee5397e979722b36b78284188538&amp;scene=21#wechat_redirect" data-linktype="2">解读GEO数据存放规律及下载，一文就够</a></section></li><li><section><a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247486054&amp;idx=1&amp;sn=209975adee162228cfe6e6c5065c5c8c&amp;scene=21#wechat_redirect" data-linktype="2">解读SRA数据库规律一文就够</a></section></li><li><section><a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247486087&amp;idx=1&amp;sn=1e775a1c3e215384e381953a9fa74ec3&amp;scene=21#wechat_redirect" data-linktype="2">从GEO数据库下载得到表达矩阵 一文就够</a></section></li><li><section><a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247486090&amp;idx=1&amp;sn=62374fbdd4f20c3185beb6568bbeb3e9&amp;scene=21#wechat_redirect" data-linktype="2">GSEA分析一文就够（单机版+R语言版）</a></section></li><li><section><a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247486112&amp;idx=1&amp;sn=67a2104c62222bcb139623699f874a6c&amp;scene=21#wechat_redirect" data-linktype="2">根据分组信息做差异分析- 这个一文不够的</a></section></li><li><section><a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247486120&amp;idx=1&amp;sn=14d7892c1beec2fb9cdfc0ec0aba3e4e&amp;scene=21#wechat_redirect" data-linktype="2">差异分析得到的结果注释一文就够</a></section></li></ul></section><p><br></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/ZX7pVkH1qXwOLgiS8Uq8kQ",target="_blank" rel="noopener noreferrer">原文链接</a>
