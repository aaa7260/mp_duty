---
title: "跟着 Cancer Cell 学作图 | 相关性热图（不对称版）"
date: 2023-05-26T07:13:53Z
draft: ["false"]
tags: [
  "fetched",
  "木舟笔记"
]
categories: ["Acdemic"]
---
跟着 Cancer Cell 学作图 | 相关性热图（不对称版） by 木舟笔记
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-mpa-powered-by="yiban.io"><figure data-tool="mdnice编辑器"><img data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/aMicyicM8Ll19mjOUJiclRpFbhFM45hyniaVzRCNnm2zBGNFtySRJMsibWiahUDnn2NpXCNuMLbv7j9YELQRMPr4vucg/640?wx_fmt=jpeg" data-type="jpeg" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_jpg/aMicyicM8Ll19mjOUJiclRpFbhFM45hyniaVzRCNnm2zBGNFtySRJMsibWiahUDnn2NpXCNuMLbv7j9YELQRMPr4vucg/640?wx_fmt=jpeg"><figcaption><span></span>cor_heapmap</figcaption></figure><section><mp-common-profile data-pluginname="mpprofile" data-weui-theme="light" data-id="MzIxMDExNDE0OQ==" data-headimg="http://mmbiz.qpic.cn/mmbiz_png/aMicyicM8Ll1ib0O4bhukQJ50YEnDwcMTIvaj1jSnOACbZmy7XsUAmicqyoF1WkNzzwian0IUUbGlNmaniaMDXLsa6pA/0?wx_fmt=png" data-nickname="木舟笔记" data-alias="MZBJNOTE" data-signature="分享CNS绘图指南、生信教程及常见套路、多组学研究思路及机器学习基础。" data-from="0" data-is_biz_ban="0"></mp-common-profile></section><h2 data-tool="mdnice编辑器"><span></span><span>本期图片</span><span></span></h2><figure data-tool="mdnice编辑器"><img data-ratio="1.0240740740740741" data-src="https://mmbiz.qpic.cn/mmbiz_png/aMicyicM8Ll19mjOUJiclRpFbhFM45hyniaVdqwFibZ0qvq5BSDTzw5CA1mibKFkeSrfZH1QzcAic5wfO1wvvIGicujObA/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/aMicyicM8Ll19mjOUJiclRpFbhFM45hyniaVdqwFibZ0qvq5BSDTzw5CA1mibKFkeSrfZH1QzcAic5wfO1wvvIGicujObA/640?wx_fmt=png"></figure><blockquote data-tool="mdnice编辑器"><span>❝</span><p>R, Fong C, Smith S, Riely GJ, Rudin CM, Gomez DR, Solit DB, Berger MF, Li BT, Mayo MW, Matei I, Lyden DC, Adusumilli PS, Schultz N, Sanchez-Vega F, Jones DR. Genomic mapping of metastatic organotropism in lung adenocarcinoma. Cancer Cell. 2023 May 8;41(5):970-985.e3. doi: 10.1016/j.ccell.2023.03.018.</p><span>❞</span></blockquote><p data-tool="mdnice编辑器">实际上该图是 Co-occurrence and mutual exclusivity of genes 。按照协同和互斥的作用模式，可将突变分为以下两类：<strong>「1. Co-occurencing mutations；2. Mutually exclusive mutations」</strong>。互斥的驱动基因往往共享相同的通路 (Pathway) 或 不同进展途径 (Different progression pathways，如不同肿瘤类型) 中的基因。</p><p data-tool="mdnice编辑器">我们这里这里为了方便，直接以相关性分析的结果做图。</p><p data-tool="mdnice编辑器">该图的难点是上三角和下三角分别只显示正相关和负相关的值j及其对应的显著性标记。我们只需要对数据进行前期的预处理即可。</p><h2 data-tool="mdnice编辑器"><span></span><span>复现结果</span><span></span></h2><figure data-tool="mdnice编辑器"><img data-ratio="1.0046296296296295" data-src="https://mmbiz.qpic.cn/mmbiz_png/aMicyicM8Ll19mjOUJiclRpFbhFM45hyniaVdiby4r9M568Zhst5HAL00uicA84PJ8qf5NtehQclPoSiaY1HjGPvcicf5A/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/aMicyicM8Ll19mjOUJiclRpFbhFM45hyniaVdiby4r9M568Zhst5HAL00uicA84PJ8qf5NtehQclPoSiaY1HjGPvcicf5A/640?wx_fmt=png"><figcaption><span></span>fig</figcaption></figure><h2 data-tool="mdnice编辑器"><span></span><span>示例数据和代码领取</span><span></span></h2><h3 data-tool="mdnice编辑器"><span></span><span><span></span>木舟笔记永久VIP企划</span><span></span></h3><p data-tool="mdnice编辑器"><strong>「权益：」</strong></p><ol data-tool="mdnice编辑器"><li><section><p><strong>「木舟笔记所有推文示例数据及代码(<strong>「在VIP群里」</strong>实时更新」</strong>）。</p><figure><img data-ratio="0.5435185185185185" data-src="https://mmbiz.qpic.cn/mmbiz_png/aMicyicM8Ll19mjOUJiclRpFbhFM45hyniaV4q8jwicrJic3d6kgdjOSkSv5TWEXPfCdh7U6GhOWiaw8c8kg5XPlCy6Xg/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/aMicyicM8Ll19mjOUJiclRpFbhFM45hyniaV4q8jwicrJic3d6kgdjOSkSv5TWEXPfCdh7U6GhOWiaw8c8kg5XPlCy6Xg/640?wx_fmt=png"><figcaption><span></span>data+code</figcaption></figure></section></li><li><section><p>木舟笔记<strong>「科研交流群」</strong>。</p></section></li></ol><p data-tool="mdnice编辑器"><strong>「收费：」</strong></p><p data-tool="mdnice编辑器">	<strong>「169￥/人」</strong>。可添加微信：<code>mzbj0002</code> 转账（或扫描下方二维码），或直接在文末打赏。木舟笔记<strong>「2022VIP」</strong>可直接支付<strong>「70￥」</strong>升级。</p><blockquote data-tool="mdnice编辑器"><span>❝</span><p><code>点赞</code>、<code>在看</code> 本文，分享至朋友圈<code>集赞30个</code>并<code>保留30分钟</code>，可优惠<code>20￥</code>。</p><span>❞</span></blockquote><img data-ratio="1.1384615384615384" data-src="https://mmbiz.qpic.cn/mmbiz_png/aMicyicM8Ll19mjOUJiclRpFbhFM45hyniaVO3p723aDBpocJ5bxr3vGLYpMc7I1mb1zYaxoTRNslQ07pnvOdr0RLg/640?wx_fmt=png" data-type="png" data-w="520" src="https://mmbiz.qpic.cn/mmbiz_png/aMicyicM8Ll19mjOUJiclRpFbhFM45hyniaVO3p723aDBpocJ5bxr3vGLYpMc7I1mb1zYaxoTRNslQ07pnvOdr0RLg/640?wx_fmt=png"><h2 data-tool="mdnice编辑器"><span></span><span>绘图</span><span></span></h2><pre data-tool="mdnice编辑器"><span></span><code>rm(list = ls())<br><span>library</span>(corrplot)<br><span># 准备数据（示例数据）</span><br>cor_matrix &lt;- cor(mtcars)  <span># 使用mtcars数据集作为示例数据</span><br><br><span># 创建相关性矩阵</span><br>corr_matrix &lt;- cor_matrix  <span># 复制相关性矩阵</span><br><br>corr_matrix[corr_matrix == <span>1</span>] &lt;- <span>NA</span> <span># 将值为1的元素替换为NA</span><br>corr_matrix[upper.tri(corr_matrix) &amp; corr_matrix &gt; <span>0</span>] &lt;- <span>0</span>  <span># 上三角大于0的值替换为0</span><br>corr_matrix[lower.tri(corr_matrix) &amp; corr_matrix &lt; <span>0</span>] &lt;- <span>0</span>  <span># 下三角小于0的值替换为0</span><br><br><br>p.mat &lt;- cor.mtest(cor_matrix)$p  <span># 计算相关系数的显著性</span><br><span># 预处理使得显著性只显示在对应的区域</span><br><span># 这一步为了让结果好看 有点问题 大家可以加群讨论</span><br>p.mat[p.mat == <span>0</span>] &lt;- <span>0</span> <br>p.mat[corr_matrix != <span>0</span>] &lt;- <span>1</span><br><span># 创建热图</span><br><span>library</span>(ComplexHeatmap)<br><br>ht_list &lt;- Heatmap(<br>  corr_matrix, <br>  name = <span>" "</span>, <br>  border = <span>"white"</span>,<br>  col = colorRampPalette(c(<span>"#417e46"</span>, <span>"#f7f8f9"</span>, <span>"#6f2f7e"</span>))(<span>100</span>),<br>  rect_gp = gpar(col = <span>"white"</span>, lwd = <span>2</span>),<br>  column_order = colnames(corr_matrix),<br>  row_order = rownames(corr_matrix),<br>  row_names_side = <span>"left"</span>,  <span># 行标签放在左边</span><br>  column_names_side = <span>"top"</span>,   <span># 列标签放在上边</span><br>  row_names_gp = gpar(<br>    fontsize = <span>10</span>),<br>  column_names_gp = gpar(<br>    fontsize = <span>10</span>),<br>  heatmap_legend_param = list(<br>  title = <span>"correlation"</span>, <br>  direction = <span>"horizontal"</span>,<br>  legend_width = unit(<span>10</span>, <span>"cm"</span>),<br>  legend_height = unit(<span>4</span>, <span>"cm"</span>)),<br>  cell_fun = <span>function</span>(j, i, x, y, w, h, fill) {<br>    <span>if</span>(p.mat[i, j] &gt; <span>0.05</span>) { <span># 为了结果美观修改，实际上因该上&lt;0.05,可以加群讨论</span><br>      grid.text(<span>"*"</span>, x, y,<br>                gp = gpar(col = <span>'white'</span>,<br>                          fontsize = <span>25</span>))<br>    } <br>  }<br>  )<br>pdf(<span>'cor_heapmap.pdf'</span>,width = <span>8</span>,height = <span>8</span>)<br>draw(ht_list, heatmap_legend_side = <span>"bottom"</span>)<br>dev.off()<br><br></code></pre><h2 data-tool="mdnice编辑器"><span></span><span>往期内容</span><span></span></h2><ol data-tool="mdnice编辑器"><li><section><a href="http://mp.weixin.qq.com/s?__biz=MzIxMDExNDE0OQ==&amp;mid=2247491989&amp;idx=1&amp;sn=a6cc7094dcd301dfc67412858f2729ca&amp;chksm=976b229fa01cab8955a7ac33f1e6efdd18ede285ba717ae7c1df0362de380a08fe8a530d0e29&amp;scene=21#wechat_redirect" data-linktype="2">资源汇总 | 2022 木舟笔记原创推文合集（附数据及代码领取方式）</a></section></li><li><section><a href="http://mp.weixin.qq.com/s?__biz=MzIxMDExNDE0OQ==&amp;mid=2247488950&amp;idx=1&amp;sn=8c06246890d3cee4a3297829e404beba&amp;chksm=9768d6bca01f5faaba25bf32d3a895f61b4dac7b5daed38deb147f7f1702291a43154da6958d&amp;scene=21#wechat_redirect" data-linktype="2">CNS图表复现|生信分析|R绘图 资源分享&amp;讨论群！</a></section></li><li><section><a href="http://mp.weixin.qq.com/s?__biz=MzIxMDExNDE0OQ==&amp;mid=2247492418&amp;idx=1&amp;sn=10416a633f539a8aaf8c02d906da7676&amp;chksm=976b2048a01ca95eb525a669106206def082476b47345ce51207173535b000c846e159f1a5bf&amp;scene=21#wechat_redirect" data-linktype="2">R绘图 | 浅谈散点图及其变体的作图逻辑</a></section></li><li><section><a href="http://mp.weixin.qq.com/s?__biz=MzIxMDExNDE0OQ==&amp;mid=2247489467&amp;idx=1&amp;sn=fa150ecac0e16684bed1337c61df63e3&amp;chksm=9768d4b1a01f5da7129df1e8d0ac15cca300d44754c00421fc59d37ffd151baa5d83e0e6e188&amp;scene=21#wechat_redirect" data-linktype="2">这图怎么画| 有点复杂的散点图</a></section></li><li><section><a href="http://mp.weixin.qq.com/s?__biz=MzIxMDExNDE0OQ==&amp;mid=2247489395&amp;idx=1&amp;sn=535716eeb4cead09bffa3213b860b5cc&amp;chksm=9768d479a01f5d6fd7ff9261ecca140d9495d88f302048720b28c46b9a1005a0cabcf1ed06ea&amp;scene=21#wechat_redirect" data-linktype="2">这图怎么画 | 相关分析棒棒糖图</a></section></li><li><section><a href="http://mp.weixin.qq.com/s?__biz=MzIxMDExNDE0OQ==&amp;mid=2247489004&amp;idx=1&amp;sn=0654118a49fd0cc3b97a7fe6535e4849&amp;chksm=9768d6e6a01f5ff0758a740c3e1cf9a72cfeb4784d064862f4eac822f78a716371c5f7cfbce7&amp;scene=21#wechat_redirect" data-linktype="2">组学生信| Front Immunol |基于血清蛋白质组早期诊断标志筛选的简单套路</a></section></li><li><section><a href="http://mp.weixin.qq.com/s?__biz=MzIxMDExNDE0OQ==&amp;mid=2247486072&amp;idx=1&amp;sn=d579a62420f722285eac318c4114d199&amp;chksm=9768c972a01f4064a84f30fd48b8c2107af543c31b6adb5f36234b1377ac42c8af54f45efda9&amp;scene=21#wechat_redirect" data-linktype="2">(免费教程+代码领取)|跟着Cell学作图系列合集</a></section></li><li><section><a href="http://mp.weixin.qq.com/s?__biz=MzIxMDExNDE0OQ==&amp;mid=2247487979&amp;idx=1&amp;sn=efbc86019b0e20ec8445489df16e4fbc&amp;chksm=9768d2e1a01f5bf708214c51bb0eceeaf48d743851b14a72187e1fa229223d75fa902381a3ad&amp;scene=21#wechat_redirect" data-linktype="2">Q&amp;A | 如何在论文中画出漂亮的插图？</a></section></li><li><section><a href="http://mp.weixin.qq.com/s?__biz=MzIxMDExNDE0OQ==&amp;mid=2247488167&amp;idx=1&amp;sn=b83be3d0c76f0413affe0b5cab9b93a2&amp;chksm=9768d1ada01f58bb5008ad29506b61eb1a964f21cb1efe40f525add6092e86da24794b8b4790&amp;scene=21#wechat_redirect" data-linktype="2">跟着 Cell 学作图 | 桑葚图(ggalluvial)</a></section></li><li><section><a href="http://mp.weixin.qq.com/s?__biz=MzIxMDExNDE0OQ==&amp;mid=2247488226&amp;idx=1&amp;sn=4515eb615d43ccb760a9a8d74ef35072&amp;chksm=9768d1e8a01f58fe66e120c9e8b50837be0757f695eb0466bd864e5a2d50357f65e7ed5efab1&amp;scene=21#wechat_redirect" data-linktype="2">R实战 | Lasso回归模型建立及变量筛选</a></section></li><li><section><a href="http://mp.weixin.qq.com/s?__biz=MzIxMDExNDE0OQ==&amp;mid=2247488256&amp;idx=1&amp;sn=433e1e89a23805d83929a963881eade4&amp;chksm=9768d00aa01f591c5564153baa6c5dfcdb9b4a49bf8a3a9355e3281df34f9080916790745a1b&amp;scene=21#wechat_redirect" data-linktype="2">跟着 NC 学作图 | 互作网络图进阶(蛋白+富集通路)(Cytoscape)</a></section></li><li><section><a href="http://mp.weixin.qq.com/s?__biz=MzIxMDExNDE0OQ==&amp;mid=2247488318&amp;idx=1&amp;sn=9bd4daa918eca93dd5dedbeaa25ceb77&amp;chksm=9768d034a01f59220b5970fb04aaec5cfa732fa176b82a38c72e6de7fc2999780076ea687456&amp;scene=21#wechat_redirect" data-linktype="2">R实战 | 给聚类加个圈圈(ggunchull)</a></section></li><li><section><a href="http://mp.weixin.qq.com/s?__biz=MzIxMDExNDE0OQ==&amp;mid=2247488443&amp;idx=1&amp;sn=6a1b8766b2daf5433a8275d730c07fa2&amp;chksm=9768d0b1a01f59a797e9d42dffdcbbf8e8a6d4cef495e7ba5b14dd411188e681403cfb511e1f&amp;scene=21#wechat_redirect" data-linktype="2">R实战 | NGS数据时间序列分析(maSigPro)</a></section></li><li><section><a href="http://mp.weixin.qq.com/s?__biz=MzIxMDExNDE0OQ==&amp;mid=2247488618&amp;idx=1&amp;sn=21f561a6a99e2e603ea72bc6889d96e4&amp;chksm=9768d760a01f5e7606901e9e3839f7ea583205c65b232af6eef971e18a4233b5e42222ed7091&amp;scene=21#wechat_redirect" data-linktype="2">跟着 Cell 学作图 | 韦恩图(ggVennDiagram)</a></section></li></ol><hr data-tool="mdnice编辑器"><figure data-tool="mdnice编辑器"><img data-ratio="0.6676163342830009" data-src="https://mmbiz.qpic.cn/mmbiz_png/aMicyicM8Ll19mjOUJiclRpFbhFM45hyniaVC0FKVaJdgSOqlVXJI08klXvMFGXMfKhSZ4IVibsv7ZTCibRQoJZiby4nw/640?wx_fmt=png" data-type="png" data-w="1053" src="https://mmbiz.qpic.cn/mmbiz_png/aMicyicM8Ll19mjOUJiclRpFbhFM45hyniaVC0FKVaJdgSOqlVXJI08klXvMFGXMfKhSZ4IVibsv7ZTCibRQoJZiby4nw/640?wx_fmt=png"><figcaption><span></span>木舟笔记矩阵</figcaption></figure></section><p><br></p><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/Brqlokw-GcRBfXyzavvrvA",target="_blank" rel="noopener noreferrer">原文链接</a>
