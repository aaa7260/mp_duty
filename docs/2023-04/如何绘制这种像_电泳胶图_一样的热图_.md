---
title: "如何绘制这种像“电泳胶图”一样的热图？"
date: 2023-04-01T04:05:39Z
draft: ["false"]
tags: [
  "fetched",
  "SCIPainter"
]
categories: ["Acdemic"]
---
如何绘制这种像“电泳胶图”一样的热图？ by SCIPainter
------
<div><section data-mpa-powered-by="yiban.io"><span>最近，一直在摸索绘制一种形似“电泳胶图”一般的热图，终于还是有进展了，绘图效果如下。</span></section><section><span><br></span></section><section><img data-ratio="0.9715994020926756" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6k6lAkXtzaNEaF1T5IpHrsKQlibqCqbbW2WuPjgx66xrssB3xlVuZ9nO75yozRp6gia1gaZhnRDtV6w/640?wx_fmt=png" data-type="png" data-w="669" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6k6lAkXtzaNEaF1T5IpHrsKQlibqCqbbW2WuPjgx66xrssB3xlVuZ9nO75yozRp6gia1gaZhnRDtV6w/640?wx_fmt=png"></section><section><br></section><section><span>对于常规热图，主要用于展示连续型数据（例如基因的表达量）的变化规律，而这种胶图热图可展示离散型数据（如基因的上调表达、下调表达）的变化规律。下面就一起看看如何绘制吧！</span></section><section><br mpa-from-tpl="t"></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>#载入热图R包；</span><br mpa-from-tpl="t"><span>library</span>(ComplexHeatmap)<br mpa-from-tpl="t"><span>#读入练习数据；</span><br mpa-from-tpl="t"><span>df</span>&lt;- read.csv(<span>"jiaotudata1.csv"</span>,row.names = 1)<br mpa-from-tpl="t"><span>#预览数据；</span><br mpa-from-tpl="t"><span>head</span>(df,10)</code></pre></section><p><br mpa-from-tpl="t"></p><section><img data-ratio="0.39624505928853754" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6k6lAkXtzaNEaF1T5IpHrsK6JsPx5EzlFWRtP7GwyicpSMkKrMmJLFS0ibU2ibFugpqEQhv3P1h7x27g/640?wx_fmt=png" data-type="png" data-w="1012" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6k6lAkXtzaNEaF1T5IpHrsK6JsPx5EzlFWRtP7GwyicpSMkKrMmJLFS0ibU2ibFugpqEQhv3P1h7x27g/640?wx_fmt=png"></section><section><br mpa-from-tpl="t"></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>#提取特定列中的基因；</span><br mpa-from-tpl="t"><span>ind</span> &lt;- which(df$clu9 != <span>"up"</span>|df$clu9 != <span>"down"</span>)<br mpa-from-tpl="t"><span>labels</span> &lt;- rownames(df)[ind]<br mpa-from-tpl="t"><span>#预览标签；</span><br mpa-from-tpl="t"><span>labels</span><br mpa-from-tpl="t"><span>#提取数据的列名，并转成因子；</span><br mpa-from-tpl="t"><span>cluster</span>&lt;- factor(colnames(df),levels = colnames(df))<br mpa-from-tpl="t"><span>cluster</span></code></pre></section><p><br mpa-from-tpl="t"></p><section><img data-ratio="0.21666666666666667" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6k6lAkXtzaNEaF1T5IpHrsKK1icjTndfP1PPicE3ib3GzwJFKm56R5hO89yX2GibQlJwchrHFjk1rpG3Q/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6k6lAkXtzaNEaF1T5IpHrsKK1icjTndfP1PPicE3ib3GzwJFKm56R5hO89yX2GibQlJwchrHFjk1rpG3Q/640?wx_fmt=png"></section><section><br mpa-from-tpl="t"></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>#使用labels_gp调整字体大小；</span><br mpa-from-tpl="t"><span>lab</span> = rowAnnotation(foo = anno_mark(at = ind,<br mpa-from-tpl="t"><span>labels</span> = labels,<br mpa-from-tpl="t"><span>labels_gp</span> = gpar(fontsize = 9),<br mpa-from-tpl="t"><span>lines_gp</span> = gpar()))<br mpa-from-tpl="t"><span>#尝试绘制胶图热图；</span><br mpa-from-tpl="t"><span>p1</span> &lt;- Heatmap(df, name = <span>"EXP"</span>,<br mpa-from-tpl="t"><span>na_col</span> = <span>"grey95"</span>,<br mpa-from-tpl="t"><span>col</span> = c(<span>"up"</span> = <span>"#a159dc88"</span>,<br mpa-from-tpl="t">"<span>down</span><span>" = "</span>#7d79e3EE<span>"),<br mpa-from-tpl="t">show_row_names = F,<br mpa-from-tpl="t">show_column_names = F,<br mpa-from-tpl="t">rect_gp=gpar(col=NA,lwd=1),<br mpa-from-tpl="t">width = unit(5, "</span>in<span>"),<br mpa-from-tpl="t">height = unit(6, "</span>in<span>"),<br mpa-from-tpl="t">right_annotation = lab,<br mpa-from-tpl="t">column_title_gp = gpar(fontsize = 12,<br mpa-from-tpl="t">fontface = "</span>plain<span>",<br mpa-from-tpl="t">col = "</span>grey30<span>"),<br mpa-from-tpl="t">column_names_side="</span>top<span>",<br mpa-from-tpl="t">column_names_gp = gpar(fontsize = 10,<br mpa-from-tpl="t">fontface = "</span>plain<span>"),<br mpa-from-tpl="t">column_names_rot = 0,<br mpa-from-tpl="t">column_names_centered = T,<br mpa-from-tpl="t">column_split = cluster,<br mpa-from-tpl="t">column_gap = unit(0, "</span>mm<span>"),<br mpa-from-tpl="t">border = T,<br mpa-from-tpl="t">border_gp = gpar(col = "</span>grey95<span>",<br mpa-from-tpl="t">lineend="</span>square<span>",<br mpa-from-tpl="t">linejoin="</span>mitre<span>",<br mpa-from-tpl="t">lwd=10),<br mpa-from-tpl="t">column_title = "</span><span>")<br mpa-from-tpl="t">draw(p1)</span></code></pre></section><p><br mpa-from-tpl="t"></p><section><img data-ratio="0.9688972667295005" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6k6lAkXtzaNEaF1T5IpHrsKNE6OCZ2o2vgibLyfMTUQ27IqL0ztqO2ngRvZkGCqdyPBKLFeUZyl3icw/640?wx_fmt=png" data-type="png" data-w="1061" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6k6lAkXtzaNEaF1T5IpHrsKNE6OCZ2o2vgibLyfMTUQ27IqL0ztqO2ngRvZkGCqdyPBKLFeUZyl3icw/640?wx_fmt=png"></section><section><br mpa-from-tpl="t"></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>#尝试绘制圆角胶图热图；</span><br mpa-from-tpl="t"><span>p2</span> &lt;- Heatmap(df, name = <span>"EXP"</span>,<br mpa-from-tpl="t"><span>na_col</span> = <span>"grey95"</span>,<br mpa-from-tpl="t"><span>col</span> = c(<span>"up"</span> = <span>"#a159dc88"</span>,<br mpa-from-tpl="t">"<span>down</span><span>" = "</span>#7d79e3EE<span>"),<br mpa-from-tpl="t">show_row_names = F,<br mpa-from-tpl="t">show_column_names = F,<br mpa-from-tpl="t">rect_gp=gpar(col=NA,lwd=1),<br mpa-from-tpl="t">width = unit(5, "</span>in<span>"),<br mpa-from-tpl="t">height = unit(6, "</span>in<span>"),<br mpa-from-tpl="t">right_annotation = lab,<br mpa-from-tpl="t">column_title_gp = gpar(fontsize = 12,<br mpa-from-tpl="t">fontface = "</span>plain<span>",<br mpa-from-tpl="t">col = "</span>grey30<span>"),<br mpa-from-tpl="t">column_names_side="</span>top<span>",<br mpa-from-tpl="t">column_names_gp = gpar(fontsize = 10,<br mpa-from-tpl="t">fontface = "</span>plain<span>"),<br mpa-from-tpl="t">column_names_rot = 0,<br mpa-from-tpl="t">column_names_centered = T,<br mpa-from-tpl="t">column_split = cluster,<br mpa-from-tpl="t">column_gap = unit(0, "</span>mm<span>"),<br mpa-from-tpl="t">border = T,<br mpa-from-tpl="t">border_gp = gpar(col = "</span>grey95<span>",<br mpa-from-tpl="t">lineend="</span>round<span>",<br mpa-from-tpl="t">linejoin="</span>round<span>",<br mpa-from-tpl="t">lwd=10),<br mpa-from-tpl="t">column_title = "</span><span>")<br mpa-from-tpl="t">draw(p2)</span></code></pre></section><p><br mpa-from-tpl="t"></p><section><img data-ratio="0.9724596391263058" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6k6lAkXtzaNEaF1T5IpHrsKTmv3ONEvicSnt0BS0U6KdUwgDFQIez1gSG1UgAibwOnKZdc8AttOjbZw/640?wx_fmt=png" data-type="png" data-w="1053" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6k6lAkXtzaNEaF1T5IpHrsKTmv3ONEvicSnt0BS0U6KdUwgDFQIez1gSG1UgAibwOnKZdc8AttOjbZw/640?wx_fmt=png"></section><section><br mpa-from-tpl="t"></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>#尝试绘制条形热图；</span><br mpa-from-tpl="t"><span>p3</span> &lt;- Heatmap(df, name = <span>"EXP"</span>,<br mpa-from-tpl="t"><span>na_col</span> = <span>"grey95"</span>,<br mpa-from-tpl="t"><span>col</span> = c(<span>"up"</span> = <span>"#a159dc88"</span>,<br mpa-from-tpl="t">"<span>down</span><span>" = "</span>#7d79e3EE<span>"),<br mpa-from-tpl="t">show_row_names = F,<br mpa-from-tpl="t">show_column_names = F,<br mpa-from-tpl="t">rect_gp=gpar(col=NA,lwd=1),<br mpa-from-tpl="t">width = unit(5, "</span>in<span>"),<br mpa-from-tpl="t">height = unit(6, "</span>in<span>"),<br mpa-from-tpl="t">right_annotation = lab,<br mpa-from-tpl="t">column_title_gp = gpar(fontsize = 12,<br mpa-from-tpl="t">fontface = "</span>plain<span>",<br mpa-from-tpl="t">col = "</span>grey30<span>"),<br mpa-from-tpl="t">column_names_side="</span>top<span>",<br mpa-from-tpl="t">column_names_gp = gpar(fontsize = 10,<br mpa-from-tpl="t">fontface = "</span>plain<span>"),<br mpa-from-tpl="t">column_names_rot = 0,<br mpa-from-tpl="t">column_names_centered = T,<br mpa-from-tpl="t">column_split = cluster,<br mpa-from-tpl="t">column_gap = unit(3, "</span>mm<span>"),<br mpa-from-tpl="t">column_title = "</span><span>")<br mpa-from-tpl="t">draw(p3)</span></code></pre></section><p><br mpa-from-tpl="t"></p><section><img data-ratio="0.9068736141906873" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6k6lAkXtzaNEaF1T5IpHrsKfq57WOQI1yQGBQQfqzyBFqWplsXptWZtJ0fOJ5TibyrhCZaXlY4Ltfw/640?wx_fmt=png" data-type="png" data-w="902" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6k6lAkXtzaNEaF1T5IpHrsKfq57WOQI1yQGBQQfqzyBFqWplsXptWZtJ0fOJ5TibyrhCZaXlY4Ltfw/640?wx_fmt=png"></section><section><br></section><section><span>好啦，本次的绘图教程就分享到这里啦！</span></section><section><span><br></span></section><section><span><strong><span>*未经许可，不得以任何方式复制或抄袭本篇文章之部分或全部内容。版权所有，侵权必究。</span></strong></span></section><section><span><strong><span><br></span></strong></span></section><section data-role="outer" label="Powered by 135editor.com"><section data-tools="135编辑器" data-id="105648"><section><section data-role="outer" label="Powered by 135editor.com"><section data-role="paragraph"><section data-role="outer" label="Powered by 135editor.com"><section data-tools="135编辑器" data-id="105648"><section><section><img data-ratio="0.8780487804878049" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6kCKJYcEqEIfoJYG621mPJE8VibmibGU0Jxic9iabARVRH0FT6BNE8VAglWFXBPibFAU7a6tWGibSs8wyUg/640?wx_fmt=png" data-type="png" data-w="41" data-width="100%" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6kCKJYcEqEIfoJYG621mPJE8VibmibGU0Jxic9iabARVRH0FT6BNE8VAglWFXBPibFAU7a6tWGibSs8wyUg/640?wx_fmt=png"></section><section><section><section data-width="35%"><section><section data-width="100%"><img data-ratio="1" data-src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/tgUVxVRjT6kCKJYcEqEIfoJYG621mPJEv5etCBwHicqbEPwnVrkpaasxqaVibM4mT2JdIuN6yTlYWDD4mL5A427A/640?wx_fmt=jpeg" data-type="jpeg" data-w="860" data-width="100%" title="SCIPainter 30cm二维码.jpg" src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/tgUVxVRjT6kCKJYcEqEIfoJYG621mPJEv5etCBwHicqbEPwnVrkpaasxqaVibM4mT2JdIuN6yTlYWDD4mL5A427A/640?wx_fmt=jpeg"></section></section></section><section data-width="50%"><section><section data-brushtype="text"><span><strong># SCIPainter</strong></span></section><section data-brushtype="text" hm_fix="361:593"><p>基迪奥旗下绘图公众号</p><p>分享科研绘图技能与工具</p><p>欢迎关注与转发~</p></section></section></section></section></section></section></section></section></section></section><section><br></section></section></section><section data-role="paragraph"><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><img data-ratio="1" data-src="https://mmbiz.qpic.cn/sz_mmbiz_gif/tgUVxVRjT6kCKJYcEqEIfoJYG621mPJEgMd0aMPtmrDjiaX8sBhfhicVteeHf1JicexSpUbS3fdS9SiboUVN7guaPw/640?wx_fmt=gif" data-type="gif" data-w="400" src="https://mmbiz.qpic.cn/sz_mmbiz_gif/tgUVxVRjT6kCKJYcEqEIfoJYG621mPJEgMd0aMPtmrDjiaX8sBhfhicVteeHf1JicexSpUbS3fdS9SiboUVN7guaPw/640?wx_fmt=gif"></section></section></section><section><section powered-by="xiumi.us"><section><p><span><strong>你的好友拍了拍你</strong></span></p><p><span><strong>并请你帮她点一下</strong></span><strong><span>“分享”</span></strong><span><strong><span>~</span></strong></span></p></section></section></section></section></section><p><br></p></section></section><section><span><strong><span></span></strong></span></section><p><mp-style-type data-value="10000"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/NlGMMM5Y84OIxbNFiwgGsQ",target="_blank" rel="noopener noreferrer">原文链接</a>
