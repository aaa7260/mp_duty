---
title: "改造单细胞降维图| 4.一些造好的轮子"
date: 2023-04-01T01:58:02Z
draft: ["false"]
tags: [
  "fetched",
  "Biomamba 生信基地"
]
categories: ["Acdemic"]
---
改造单细胞降维图| 4.一些造好的轮子 by Biomamba 生信基地
------
<div><section data-support="96编辑器" data-style-id="35167"><section><section><section><section><mp-common-profile data-pluginname="mpprofile" data-weui-theme="light" data-id="MzAwMzIzOTk5OQ==" data-headimg="http://mmbiz.qpic.cn/mmbiz_png/ImlBFVOwwpzyQpcoEQKDb6ic0Dia8dFR0tfmNm2u0eJfmhJzN3Jjh0jmmTycIeJdu7XMxu6Fvz8jicsKmH2S4MvOQ/0?wx_fmt=png" data-nickname="Biomamba 生信基地" data-alias="" data-signature="本人为在读博士研究生，此公众号旨在分享生信知识及科研经验与体会，欢迎各位同学、老师与专家的批评指正，也欢迎各界人士的合作与交流。" data-from="0" data-is_biz_ban="0"></mp-common-profile></section></section></section></section></section><section><section data-support="96编辑器" data-style-id="35163"><section data-support="96编辑器" data-style-id="35167"><section><section><section><section><img data-ratio="0.5543478260869565" data-src="https://mmbiz.qpic.cn/mmbiz_png/Ljib4So7yuWgEPt6jo0gEwibQzFX4zmOqqxYF92esgbSzibpibzibzTHwLVVnyELLK10c4Gtwf2KmsmltWyKV9Iiar8A/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" data-type="png" data-w="92" data-width="100%" src="https://mmbiz.qpic.cn/mmbiz_png/Ljib4So7yuWgEPt6jo0gEwibQzFX4zmOqqxYF92esgbSzibpibzibzTHwLVVnyELLK10c4Gtwf2KmsmltWyKV9Iiar8A/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"></section><section><p>写在前面</p></section></section><section data-width="100%"><br></section></section></section></section><section><span><img data-ratio="0.6349206349206349" data-src="https://mmbiz.qpic.cn/mmbiz_gif/Ljib4So7yuWgEPt6jo0gEwibQzFX4zmOqqiaM9bZyTy3bIjLJcicVlkUFwFvyicJx8wR2ZslWiaBicM4nw9AtyQ7k7ugA/640?wx_fmt=gif&amp;wxfrom=5&amp;wx_lazy=1" data-type="gif" data-w="63" data-width="100%" src="https://mmbiz.qpic.cn/mmbiz_gif/Ljib4So7yuWgEPt6jo0gEwibQzFX4zmOqqiaM9bZyTy3bIjLJcicVlkUFwFvyicJx8wR2ZslWiaBicM4nw9AtyQ7k7ugA/640?wx_fmt=gif&amp;wxfrom=5&amp;wx_lazy=1"></span></section><section><section><section>随着我们课程的持续深入，以及各位小伙伴分析技能的日益提升，目前很多同学已经不满足于Seurat的可视化功能并希望能够做出一些<strong><span>改进的可视化</span></strong>。我个人对可视化的方式改进其实并不感冒，画图嘛，跟翻译一样<strong><span>信达雅</span></strong>即可，没必要盲目追求视觉效果。不过这也并不妨碍我给大家做这类的教程。我们准备出一系列<strong><span>单细胞测图片改造计划</span></strong>的推送，大家如果有任何关于可视化的想法，也可以通过文末客服微信联系我们。<br></section><section>前几次的教程我们用ggplot2、plotly、gg3D、gganimate等对单细胞测序的降维图进行了一些修改，但这些包本不是设计用于单细胞数据的可视化分析，因此使用时需要进行一些数据格式的转换或复杂的语法设计。通常情况下，我们并不需要自己去造轮子，有一些大佬已经为大家造好了轮子，例如这次需要介绍的<code><span>plot1cell</span></code>与<code><span>scRNAtoolVis</span></code><span>。大家学习之余不要忘记去github给作者点上小星星。</span></section><section><span><br></span></section><section><span>往期回顾：</span></section><section><span><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247496162&amp;idx=1&amp;sn=598c2920f7cc0697ee5a1fa6cadaee04&amp;chksm=9b3c88b2ac4b01a415feeebbbec6c4891319439dc8dcdafd33cca7a1222e5adc723ae9d3a73d&amp;scene=21#wechat_redirect" textvalue="改造单细胞降维图| 1.DimPlot的探索" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2">改造单细胞降维图| 1.DimPlot的探索</a><br></span></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247497867&amp;idx=1&amp;sn=37a539bbd37dafb6cce5cd52dec84f52&amp;chksm=9b3c81dbac4b08cd34b5edab4da14df5d0964a5c6fbe4dbab6f9879bbac9bc3f9e08abe8dd1c&amp;scene=21#wechat_redirect" textvalue="改造单细胞降维图| 2.ggplot2中的DIY" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2"><span>改造单细胞降维图| 2.ggplot2中的DIY</span></a><br></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247498080&amp;idx=2&amp;sn=a9bcf65e3ae34ba201e8d49ee33c0728&amp;chksm=9b3c8030ac4b0926c3f059a9a5d23f1bcdbcaf8e5a562eba2b7e3bec3396c44573269bd08e7b&amp;scene=21#wechat_redirect" textvalue="改造单细胞降维图| 3.3D降维图与动图绘制" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2"><span>改造单细胞降维图| 3.3D降维图与动图绘制</span></a><br></section></section></section></section><section><section><br></section><section><br></section></section></section><section data-support="96编辑器" data-style-id="35167"><section><section><section><section><img data-ratio="0.5543478260869565" data-src="https://mmbiz.qpic.cn/mmbiz_png/Ljib4So7yuWgEPt6jo0gEwibQzFX4zmOqqxYF92esgbSzibpibzibzTHwLVVnyELLK10c4Gtwf2KmsmltWyKV9Iiar8A/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" data-type="png" data-w="92" data-width="100%" src="https://mmbiz.qpic.cn/mmbiz_png/Ljib4So7yuWgEPt6jo0gEwibQzFX4zmOqqxYF92esgbSzibpibzibzTHwLVVnyELLK10c4Gtwf2KmsmltWyKV9Iiar8A/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"></section><section><p>视频教程</p></section></section><section data-width="100%"><br></section></section></section></section><section><section data-support="96编辑器" data-style-id="35163"><section><span><img data-ratio="0.6349206349206349" data-src="https://mmbiz.qpic.cn/mmbiz_gif/Ljib4So7yuWgEPt6jo0gEwibQzFX4zmOqqiaM9bZyTy3bIjLJcicVlkUFwFvyicJx8wR2ZslWiaBicM4nw9AtyQ7k7ugA/640?wx_fmt=gif&amp;wxfrom=5&amp;wx_lazy=1" data-type="gif" data-w="63" data-width="100%" src="https://mmbiz.qpic.cn/mmbiz_gif/Ljib4So7yuWgEPt6jo0gEwibQzFX4zmOqqiaM9bZyTy3bIjLJcicVlkUFwFvyicJx8wR2ZslWiaBicM4nw9AtyQ7k7ugA/640?wx_fmt=gif&amp;wxfrom=5&amp;wx_lazy=1"></span></section><section><section><section>B站同步播出，连播更方便，文末阅读原文可直达：</section><section><span>https://www.bilibili.com/video/BV1S44y1b76Z?p=14</span></section><section><iframe data-vidtype="2" data-mpvid="wxv_2839519123918585860" data-cover="http%3A%2F%2Fmmbiz.qpic.cn%2Fmmbiz_jpg%2FImlBFVOwwpxPxctcB39As6oeIdjjNPrsUXD76tyOIyTPU4fE08vicDYFAsEia3C085ccmJqVktPnLv8IQ5hstAbA%2F0%3Fwx_fmt%3Djpeg" allowfullscreen="" frameborder="0" data-ratio="1.7777777777777777" data-w="1920" data-src="https://mp.weixin.qq.com/mp/readtemplate?t=pages/video_player_tmpl&amp;action=mpvideo&amp;auto=0&amp;vid=wxv_2839519123918585860"></iframe></section></section></section></section><section><section><br></section><section data-support="96编辑器" data-style-id="35167"><section><section><section><section><br></section></section></section><section><section><section data-support="96编辑器" data-style-id="35167"><section><section><section><section><img data-ratio="0.5543478260869565" data-src="https://mmbiz.qpic.cn/mmbiz_png/Ljib4So7yuWgEPt6jo0gEwibQzFX4zmOqqxYF92esgbSzibpibzibzTHwLVVnyELLK10c4Gtwf2KmsmltWyKV9Iiar8A/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" data-type="png" data-w="92" data-width="100%" src="https://mmbiz.qpic.cn/mmbiz_png/Ljib4So7yuWgEPt6jo0gEwibQzFX4zmOqqxYF92esgbSzibpibzibzTHwLVVnyELLK10c4Gtwf2KmsmltWyKV9Iiar8A/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"></section><section><p>图文教程</p></section></section><section data-width="100%"><br></section></section></section></section><section><section data-support="96编辑器" data-style-id="35163"><section><span><img data-ratio="0.6349206349206349" data-src="https://mmbiz.qpic.cn/mmbiz_gif/Ljib4So7yuWgEPt6jo0gEwibQzFX4zmOqqiaM9bZyTy3bIjLJcicVlkUFwFvyicJx8wR2ZslWiaBicM4nw9AtyQ7k7ugA/640?wx_fmt=gif&amp;wxfrom=5&amp;wx_lazy=1" data-type="gif" data-w="63" data-width="100%" src="https://mmbiz.qpic.cn/mmbiz_gif/Ljib4So7yuWgEPt6jo0gEwibQzFX4zmOqqiaM9bZyTy3bIjLJcicVlkUFwFvyicJx8wR2ZslWiaBicM4nw9AtyQ7k7ugA/640?wx_fmt=gif&amp;wxfrom=5&amp;wx_lazy=1"></span></section><section><section><h2>1 <code>plot1cell</code></h2><p>更多功能可以看这里：</p><p><span>https://github.com/HaojiaWu/plot1cell</span></p><pre><code><span>#依赖的包比较多，并且很多也比较难装，装的时候需要有点耐心</span><br><span>if</span>(!<span>require</span>(devtools))install.packages(<span>'devtools'</span>)<br><span>if</span>(!<span>require</span>(biomaRt))install.packages(<span>'biomaRt'</span>)<br><span>if</span>(!<span>require</span>(XML))install.packages(<span>'XML'</span>)<br><span>if</span>(!<span>require</span>(biomaRt))devtools::install_github(<span>'alyst/biomaRt'</span>,dependencies = <span>T</span>)<br><span>#if(!require(biomaRt))devtools::install_github('grimbough/biomaRt')</span><br><span>if</span>(!<span>require</span>(GenomeInfoDb))install.packages(<span>'GenomeInfoDb'</span>)<br><span>if</span> (!<span>require</span>(<span>"BiocManager"</span>, quietly = <span>TRUE</span>)) install.packages(<span>"BiocManager"</span>)<br><span>if</span>(!<span>require</span>(EnsDb.Hsapiens.v86))BiocManager::install(<span>'EnsDb.Hsapiens.v86'</span>)<br><span>if</span>(!<span>require</span>(GEOquery))BiocManager::install(<span>'GEOquery'</span>)<br><span>if</span>(!<span>require</span>(simplifyEnrichment))BiocManager::install(<span>'simplifyEnrichment'</span>)<br><span>if</span>(!<span>require</span>(ComplexHeatmap))BiocManager::install(<span>'ComplexHeatmap'</span>)<br><span>if</span>(!<span>require</span>(DoubletFinder))devtools::install_github(<span>"chris-mcginnis-ucsf/DoubletFinder"</span>)<br><span>if</span>(!<span>require</span>(loomR))devtools::install_github(<span>"mojaveazure/loomR"</span>)<br><span>if</span>(!<span>require</span>(hdf5r))devtools::install_github(<span>"Novartis/hdf5r"</span>)<br><span>if</span>(!<span>require</span>(plot1cell)) devtools::install_github(<span>"TheHumphreysLab/plot1cell"</span>)<br><span>#建议安装的时候选1，依赖的包都装上</span></code></pre><pre><code>#测试文件下载：http://biomamba.com:34080/free.download/iri.intergrate.rds</code></pre><pre><code>iri.integrated &lt;- readRDS(<span>'iri.intergrate.rds'</span>)<br>colnames(iri.integrated@meta.data)  <br><span>#这个数据的太大了，一共超过12万个，我们每种细胞抽取1000个做展示：</span><br>iri.integrated &lt;- subset(iri.integrated, downsample = <span>1000</span>)<br>saveRDS(iri.integrated,<span>'demo.iri.rds'</span>)</code></pre><pre><code>iri.integrated &lt;- readRDS(<span>'demo.iri.rds'</span>)</code></pre><p>还剩两万多个细胞，运行起来比较快：</p><pre><code>ncol(iri.integrated)</code></pre><pre><code>## [1] 22895</code></pre><pre><code><span>###Prepare data for ploting</span><br>circ_data &lt;- prepare_circlize_data(iri.integrated, scale = <span>0.8</span> )<br>set.seed(<span>1234</span>)<br>cluster_colors&lt;-rand_color(length(levels(iri.integrated)))<br>group_colors&lt;-rand_color(length(names(table(iri.integrated$Group))))<br>rep_colors&lt;-rand_color(length(names(table(iri.integrated$orig.ident))))<br><br><span>###plot and save figures</span><br><span>#png(filename =  'circlize_plot.png', width = 6, height = 6,units = 'in', res = 300)</span><br>plot_circlize(circ_data,do.label = <span>T</span>, pt.size = <span>0.01</span>, col.use = cluster_colors ,bg.color = <span>'white'</span>, kde2d.n = <span>200</span>, repel = <span>T</span>, label.cex = <span>0.6</span>)<br>add_track(circ_data, group = <span>"Group"</span>, colors = group_colors, track_num = <span>2</span>) <span>## 由内向外数</span><br>add_track(circ_data, group = <span>"orig.ident"</span>,colors = rep_colors, track_num = <span>3</span>)</code></pre><p><img data-ratio="0.7138888888888889" data-src="https://mmbiz.qpic.cn/mmbiz_png/ImlBFVOwwpzkx4GcszFDF2ykW7ACU5VDOtYyVVg1jwYwXrJaLQWnGhea2VGMw7QicYlnpPTdZ8RGbovvVpDsdsw/640?wx_fmt=png" data-type="png" data-w="1080" width="672" src="https://mmbiz.qpic.cn/mmbiz_png/ImlBFVOwwpzkx4GcszFDF2ykW7ACU5VDOtYyVVg1jwYwXrJaLQWnGhea2VGMw7QicYlnpPTdZ8RGbovvVpDsdsw/640?wx_fmt=png"></p><pre><code><span>#dev.off()</span></code></pre><h2>2 scRNAtoolVis</h2><p>更多功能可以看这里：</p><p><span>https://junjunlab.github.io/scRNAtoolVis-manual/intro.html</span></p><pre><code><span>if</span>(!<span>require</span>(devtools))install.packages(<span>"devtools"</span>)<br><span>if</span>(!<span>require</span>(scRNAtoolVis))devtools::install_github(<span>"junjunlab/scRNAtoolVis"</span>)<br>test &lt;- system.file(<span>"extdata"</span>, <span>"seuratTest.RDS"</span>, package = <span>"scRNAtoolVis"</span>)<br>tmp &lt;- readRDS(test)</code></pre><pre><code><span>#最简单的绘图</span><br>clusterCornerAxes(object = tmp,reduction = <span>'umap'</span>,<br>                  noSplit = <span>T</span>)</code></pre><p><img data-ratio="0.7138888888888889" data-src="https://mmbiz.qpic.cn/mmbiz_png/ImlBFVOwwpzkx4GcszFDF2ykW7ACU5VDlhgbEuXMCAIVKe8JUtwofW6bmNOjcQ2lZ2canT6t9gVyrD8hSUUDyA/640?wx_fmt=png" data-type="png" data-w="1080" width="672" src="https://mmbiz.qpic.cn/mmbiz_png/ImlBFVOwwpzkx4GcszFDF2ykW7ACU5VDlhgbEuXMCAIVKe8JUtwofW6bmNOjcQ2lZ2canT6t9gVyrD8hSUUDyA/640?wx_fmt=png"></p><pre><code><span>#改变箭头形状</span><br>clusterCornerAxes(object = tmp,reduction = <span>'umap'</span>,<br>                  noSplit = <span>T</span>,arrowType = <span>'open'</span>)</code></pre><p><img data-ratio="0.7138888888888889" data-src="https://mmbiz.qpic.cn/mmbiz_png/ImlBFVOwwpzkx4GcszFDF2ykW7ACU5VDoic6icJrQVaW7eI28BvVUyb91aCiaoLFyFVfMbic7Wqibs4lsNNNBA9XnlA/640?wx_fmt=png" data-type="png" data-w="1080" width="672" src="https://mmbiz.qpic.cn/mmbiz_png/ImlBFVOwwpzkx4GcszFDF2ykW7ACU5VDoic6icJrQVaW7eI28BvVUyb91aCiaoLFyFVfMbic7Wqibs4lsNNNBA9XnlA/640?wx_fmt=png"></p><pre><code><span>#按照一定分组变量拆分：</span><br>clusterCornerAxes(object = tmp,<br>                  reduction = <span>'umap'</span>,<br>                  noSplit = <span>F</span>,<br>                  groupFacet = <span>'seurat_clusters'</span>,<br>                  aspect.ratio = <span>1</span>,<br>                  relLength = <span>0.5</span>)</code></pre><p><img data-ratio="0.25" data-src="https://mmbiz.qpic.cn/mmbiz_png/ImlBFVOwwpzkx4GcszFDF2ykW7ACU5VDsrYVrtJdJsPT1eF0b4yTc0VehgvhMjwv3KibSrx4JN55oicAx9dVtdIw/640?wx_fmt=png" data-type="png" data-w="1080" width="1920" src="https://mmbiz.qpic.cn/mmbiz_png/ImlBFVOwwpzkx4GcszFDF2ykW7ACU5VDsrYVrtJdJsPT1eF0b4yTc0VehgvhMjwv3KibSrx4JN55oicAx9dVtdIw/640?wx_fmt=png"></p><pre><code><span>#拆分时仅保留一个坐标轴</span><br>clusterCornerAxes(object = tmp,<br>                  reduction = <span>'umap'</span>,<br>                  noSplit = <span>F</span>,<br>                  groupFacet = <span>'orig.ident'</span>,<br>                  aspect.ratio = <span>1</span>,<br>                  relLength = <span>0.5</span>,<br>                  axes = <span>'one'</span>)</code></pre><p><img data-ratio="0.25" data-src="https://mmbiz.qpic.cn/mmbiz_png/ImlBFVOwwpzkx4GcszFDF2ykW7ACU5VDcy6XIVMYymwINd0s4FbfpAoGkQL2sR1Ecw2HXh1gEcZEMlplbNH7gg/640?wx_fmt=png" data-type="png" data-w="1080" width="1920" src="https://mmbiz.qpic.cn/mmbiz_png/ImlBFVOwwpzkx4GcszFDF2ykW7ACU5VDcy6XIVMYymwINd0s4FbfpAoGkQL2sR1Ecw2HXh1gEcZEMlplbNH7gg/640?wx_fmt=png"></p><pre><code><span>#调整坐标轴颜色：</span><br>clusterCornerAxes(object = tmp,<br>                  reduction = <span>'umap'</span>,<br>                  noSplit = <span>F</span>,<br>                  groupFacet = <span>'orig.ident'</span>,<br>                  aspect.ratio = <span>1</span>,<br>                  relLength = <span>0.5</span>,<br>                  lineTextcol = <span>'grey50'</span>)</code></pre><p><img data-croporisrc="https://mmbiz.qpic.cn/mmbiz_png/ImlBFVOwwpzkx4GcszFDF2ykW7ACU5VD4AHpFMdrJ5KSziasg9ccJ22Oibk6aypqENo5vhBlNN5333wDsGng3nGA/0?wx_fmt=png" data-cropx1="0" data-cropx2="1344" data-cropy1="286.9489051094891" data-cropy2="667.094890510949" data-ratio="0.2824074074074074" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/ImlBFVOwwpzkx4GcszFDF2ykW7ACU5VDXNMaMiaRuZAUBhibB8hWcbxjziaaDEq60P2Kq26ibKtBktYFtj0Y9OBmZg/640?wx_fmt=jpeg" data-type="jpeg" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_jpg/ImlBFVOwwpzkx4GcszFDF2ykW7ACU5VDXNMaMiaRuZAUBhibB8hWcbxjziaaDEq60P2Kq26ibKtBktYFtj0Y9OBmZg/640?wx_fmt=jpeg"></p><pre><code><span>#调整图注大小</span><br>clusterCornerAxes(object = tmp,<br>                  reduction = <span>'umap'</span>,<br>                  noSplit = <span>T</span>,<br>                  keySize = <span>8</span>)</code></pre><p><img data-ratio="0.7138888888888889" data-src="https://mmbiz.qpic.cn/mmbiz_png/ImlBFVOwwpzkx4GcszFDF2ykW7ACU5VDXkjWTrIrHibs3cexgg2lO86RbjXTibYps3Fh3vLr3Z9libs2KxXnqk3dQ/640?wx_fmt=png" data-type="png" data-w="1080" width="672" src="https://mmbiz.qpic.cn/mmbiz_png/ImlBFVOwwpzkx4GcszFDF2ykW7ACU5VDXkjWTrIrHibs3cexgg2lO86RbjXTibYps3Fh3vLr3Z9libs2KxXnqk3dQ/640?wx_fmt=png"></p><pre><code><span>#展示lebel并调整label大小</span><br>clusterCornerAxes(object = tmp,<br>                  reduction = <span>'umap'</span>,<br>                  noSplit = <span>T</span>,<br>                  cellLabel = <span>T</span>,<br>                  cellLabelSize = <span>5</span>)</code></pre><p><img data-ratio="0.7138888888888889" data-src="https://mmbiz.qpic.cn/mmbiz_png/ImlBFVOwwpzkx4GcszFDF2ykW7ACU5VDP1004jseibSTFV1Gh93gZN38J10d8sQzpKsyq4okND501AJDvXtdPLg/640?wx_fmt=png" data-type="png" data-w="1080" width="672" src="https://mmbiz.qpic.cn/mmbiz_png/ImlBFVOwwpzkx4GcszFDF2ykW7ACU5VDP1004jseibSTFV1Gh93gZN38J10d8sQzpKsyq4okND501AJDvXtdPLg/640?wx_fmt=png"></p><pre><code><span>#更改主题</span><br>clusterCornerAxes(object = tmp,<br>                  reduction = <span>'umap'</span>,<br>                  groupFacet = <span>'orig.ident'</span>,<br>                  noSplit = <span>F</span>,<br>                  cellLabel = <span>T</span>,<br>                  cellLabelSize = <span>3</span>,<br>                  show.legend = <span>F</span>,<br>                  aspect.ratio = <span>1</span>,<br>                  themebg = <span>'bwCorner'</span>)</code></pre><p><img data-croporisrc="https://mmbiz.qpic.cn/mmbiz_png/ImlBFVOwwpzkx4GcszFDF2ykW7ACU5VDGOBFr4QOrE2JRbUiaVJUAgBw8lw9n9IQ5Jw9JQoV8sKSLhzRdm24WVg/0?wx_fmt=png" data-cropx1="0" data-cropx2="1344" data-cropy1="259.97080291970804" data-cropy2="662.1897810218978" data-ratio="0.29814814814814816" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/ImlBFVOwwpzkx4GcszFDF2ykW7ACU5VDJ0icEx3UFwl1wiadICyQYGfaOV9kH1a32ck3FhnSO0yVSH0icONG811hA/640?wx_fmt=jpeg" data-type="jpeg" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_jpg/ImlBFVOwwpzkx4GcszFDF2ykW7ACU5VDJ0icEx3UFwl1wiadICyQYGfaOV9kH1a32ck3FhnSO0yVSH0icONG811hA/640?wx_fmt=jpeg"></p><pre><code><span>#加上曲线</span><br>clusterCornerAxes(object = tmp,reduction = <span>'umap'</span>,<br>                  noSplit = <span>T</span>,<br>                  cornerTextSize = <span>3.5</span>,<br>                  themebg = <span>'bwCorner'</span>,<br>                  addCircle = <span>TRUE</span>,<br>                  cicAlpha = <span>0.2</span>,<br>                  nbin = <span>200</span>)</code></pre><p><img data-ratio="0.7138888888888889" data-src="https://mmbiz.qpic.cn/mmbiz_png/ImlBFVOwwpzkx4GcszFDF2ykW7ACU5VDsBqtStQFSkWFuY5pjmoOxQ3pc1TRvSHaryW2aBucG0npQsakS46vPQ/640?wx_fmt=png" data-type="png" data-w="1080" width="672" src="https://mmbiz.qpic.cn/mmbiz_png/ImlBFVOwwpzkx4GcszFDF2ykW7ACU5VDsBqtStQFSkWFuY5pjmoOxQ3pc1TRvSHaryW2aBucG0npQsakS46vPQ/640?wx_fmt=png"></p></section></section></section><section><section data-support="96编辑器" data-style-id="35167"><section><section><section><section><br></section></section></section></section></section></section></section></section></section></section></section><section><section><section><section data-support="96编辑器" data-style-id="25142"><section><section><section><section><section><section data-support="96编辑器" data-style-id="27326"><section><section><section><section><section><section><section data-support="96编辑器" data-style-id="34887"><section><section><section><img data-ratio="0.8372093023255814" data-src="https://mmbiz.qpic.cn/mmbiz_png/Ljib4So7yuWjsU2VMXgI8TRjfwVeo0Aj4EiaLjQXteia730VKnC0j8Tkgu6hkTs7ZO0JRFyw8riaczdNlQQKsOnfIQ/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" data-type="png" data-w="86" data-width="100%" src="https://mmbiz.qpic.cn/mmbiz_png/Ljib4So7yuWjsU2VMXgI8TRjfwVeo0Aj4EiaLjQXteia730VKnC0j8Tkgu6hkTs7ZO0JRFyw8riaczdNlQQKsOnfIQ/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"></section><section><section><section><p>如何联系我们</p></section></section></section></section></section></section><p><br></p></section><section data-support="96编辑器" data-style-id="34892"><section><section><section><section><img data-ratio="1.1627906976744187" data-type="gif" data-w="43" data-src="https://mmbiz.qpic.cn/mmbiz_gif/Ljib4So7yuWjsU2VMXgI8TRjfwVeo0Aj4z284kwxMryKUBLBbNicjxYMDvWxmosNGHmIW66jtmJuia0pe51q8hFzQ/640?wx_fmt=gif&amp;wxfrom=5&amp;wx_lazy=1" src="https://mmbiz.qpic.cn/mmbiz_gif/Ljib4So7yuWjsU2VMXgI8TRjfwVeo0Aj4z284kwxMryKUBLBbNicjxYMDvWxmosNGHmIW66jtmJuia0pe51q8hFzQ/640?wx_fmt=gif&amp;wxfrom=5&amp;wx_lazy=1"></section></section></section><section><section><section><section>公众号后台消息更新不及时，超过48h便不允许回复读者消息，这里给大家留一下领取资料、免费服务器的<span><strong>微信号</strong></span>，方便各位随时交流、提建议(科研任务繁重，回复不及时请见谅)。此外呼声一直很高的<strong><span>交流群</span></strong>也建好了，欢迎大家入群讨论：</section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247492981&amp;idx=1&amp;sn=aed903c4b853113d8c89e13848ea3365&amp;chksm=9b3c9c25ac4b1533feb5f42f94ab4b6023a160313db4bc6a2f142e54d26627e3ea94b53e9031&amp;scene=21#wechat_redirect" textvalue="永久免费的千人生信、科研交流群" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1">永久免费的千人生信、科研交流群</a><br></section><section><br></section><section><span>大家可以阅读完这几篇之后添加</span></section><section><span><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247493329&amp;idx=1&amp;sn=597870b7f7ce10346da3561e7c281627&amp;chksm=9b3c9f81ac4b169794088ce9abbcacb5f18e9fd174fc0d7e28da62d78facadf3100ef38aaf22&amp;scene=21#wechat_redirect" textvalue="给生信入门初学者的小贴士" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1">给生信入门初学者的小贴士</a><br></span></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247488966&amp;idx=1&amp;sn=9e9e7659b4cf00ac3173d21e88e1602b&amp;chksm=9b3f6c96ac48e580efe53f966430f6598785e5c5c6bcc20f5eef019e723e49baaaea6d73fb7b&amp;scene=21#wechat_redirect" textvalue="如何搜索公众号过往发布内容" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1">如何搜索公众号过往发布内容</a><br></section><p><img data-galleryid="" data-ratio="0.5537037037037037" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/ImlBFVOwwpxD2E7IWhoq4ufKkicBibrsZDOgj4GOibMq3okeKsrLGaNeWVOKL2lxyx5UrDR8sV4lCC2RkibjAq722g/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/ImlBFVOwwpxD2E7IWhoq4ufKkicBibrsZDOgj4GOibMq3okeKsrLGaNeWVOKL2lxyx5UrDR8sV4lCC2RkibjAq722g/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"><span></span></p></section></section></section></section></section></section></section></section></section></section></section></section></section><section><section><section><img data-ratio="0.7619047619047619" data-w="84" data-width="80%" data-src="https://mmbiz.qpic.cn/mmbiz_gif/Ljib4So7yuWhFTIP7DCMLPwWh8Yhjs079f1vMqlYdExqbWaZVJyiawKkr21EDSNW740b4yMzkeHxFJULTpZGzYwQ/640?wx_fmt=gif&amp;wxfrom=5&amp;wx_lazy=1" src="https://mmbiz.qpic.cn/mmbiz_gif/Ljib4So7yuWhFTIP7DCMLPwWh8Yhjs079f1vMqlYdExqbWaZVJyiawKkr21EDSNW740b4yMzkeHxFJULTpZGzYwQ/640?wx_fmt=gif&amp;wxfrom=5&amp;wx_lazy=1"></section><section><span>您点的每个赞和在看，我都认真当成了喜欢</span></section></section></section><section><br></section><p><br></p></section></section></section></section></section></section></section></section></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/XXVR290h80-V9BtX42UWlQ",target="_blank" rel="noopener noreferrer">原文链接</a>
