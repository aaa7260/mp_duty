---
title: "bngeneplot()函数展示基因的上下游推断"
date: 2023-04-02T02:30:42Z
draft: ["false"]
tags: [
  "fetched",
  "Paper绘图"
]
categories: ["Acdemic"]
---
bngeneplot()函数展示基因的上下游推断 by Paper绘图
------
<div><h4 cid="n149" mdtype="heading" data-mpa-powered-by="yiban.io"><span md-inline="plain">bngeneplot()函数展示基因的上下游推断</span></h4><h4 cid="n151" mdtype="heading"><span md-inline="html_inline" spellcheck="false"><span>背景</span></span><span md-inline="html_inline" spellcheck="false"><span>介绍</span></span></h4><p cid="n152" mdtype="paragraph"><span md-inline="plain">上一次，我们介绍了如何从转录组测序结果进行数据的整理，得到可以进行上下游推断的数据。</span></p><p cid="n153" mdtype="paragraph"><span md-inline="plain">原文在这：</span><span><a spellcheck="false" href="https://mp.weixin.qq.com/s?__biz=MzA4MzIzMzc0Mw==&amp;mid=2647718433&amp;idx=1&amp;sn=ec51b934a43d87986865230e5db0e9aa&amp;scene=21#wechat_redirect" data-linktype="2">贝叶斯网络绘图进行基因集富集结果的分析</a></span></p><p cid="n154" mdtype="paragraph"><span md-inline="plain">接下来，我们看看，利用制备好的数据，可以进行哪些上下游推断分析。</span></p><h4 cid="n155" mdtype="heading"><span md-inline="html_inline" spellcheck="false"><span>基因</span></span><span md-inline="plain">的</span><span md-inline="html_inline" spellcheck="false"><span>上下游推断</span></span></h4><p cid="n156" mdtype="paragraph"><span md-inline="plain">1.直接使用bngeneplot函数可以进行查看，比如查看第17条通路上的基因信息</span></p><pre spellcheck="false" lang="R" cid="n157" mdtype="fences"><span role="presentation"><span>bngeneplot</span>(<span>results</span> <span>=</span> <span>pway</span>, <span>exp</span> <span>=</span> <span>vsted</span>, <span>pathNum</span> <span>=</span> <span>17</span>)</span></pre><p cid="n158" mdtype="paragraph"><span md-inline="image" data-src="https://superdong.oss-cn-beijing.aliyuncs.com//img/202212061042101.png"><img data-ratio="1" data-src="https://mmbiz.qpic.cn/mmbiz_png/4s8uyoT9WzP4yXWaeceU1MEWEqQZMXiaIqJu04k8mgoLGQMt0aIP1WY9zm041iaKQf0wyUI4edKsJkU9K2W1Xjcw/640?wx_fmt=png" data-type="png" data-w="1920" src="https://mmbiz.qpic.cn/mmbiz_png/4s8uyoT9WzP4yXWaeceU1MEWEqQZMXiaIqJu04k8mgoLGQMt0aIP1WY9zm041iaKQf0wyUI4edKsJkU9K2W1Xjcw/640?wx_fmt=png"></span></p><p cid="n159" mdtype="paragraph"><span md-inline="plain">2.改变了标签之后，可以使得图形更适合阅读</span></p><pre spellcheck="false" lang="R" cid="n160" mdtype="fences"><span role="presentation"><span>bngeneplot</span>(<span>results</span> <span>=</span> <span>pway</span>, <span>exp</span> <span>=</span> <span>vsted</span>, <span>pathNum</span> <span>=</span> <span>17</span>, <span>labelSize</span><span>=</span><span>7</span>, <span>shadowText</span><span>=</span><span>TRUE</span>)</span></pre><p cid="n161" mdtype="paragraph"><span md-inline="image" data-src="https://superdong.oss-cn-beijing.aliyuncs.com//img/202212061042105.png"><img data-ratio="1" data-src="https://mmbiz.qpic.cn/mmbiz_png/4s8uyoT9WzP4yXWaeceU1MEWEqQZMXiaIhnhaadaiaib0VZvPfPBDZ8BXu3icSlADJ9t3ia7wXNHALg9YIRvIVWYLdw/640?wx_fmt=png" data-type="png" data-w="1920" src="https://mmbiz.qpic.cn/mmbiz_png/4s8uyoT9WzP4yXWaeceU1MEWEqQZMXiaIhnhaadaiaib0VZvPfPBDZ8BXu3icSlADJ9t3ia7wXNHALg9YIRvIVWYLdw/640?wx_fmt=png"></span></p><p cid="n162" mdtype="paragraph"><span md-inline="plain">3.当然，也可以对指定的样本</span><span md-inline="code" spellcheck="false"><code>expSample</code></span><span md-inline="plain">进行展示</span></p><pre spellcheck="false" lang="R" cid="n163" mdtype="fences"><span role="presentation"><span>bngeneplot</span>(<span>results</span> <span>=</span> <span>pway</span>, <span>exp</span> <span>=</span> <span>vsted</span>, <span>expSample</span> <span>=</span> <span>incSample</span>, <span>pathNum</span> <span>=</span> <span>17</span>)</span></pre><p cid="n164" mdtype="paragraph"><span md-inline="image" data-src="https://superdong.oss-cn-beijing.aliyuncs.com//img/202212061042106.png"><img data-ratio="1" data-src="https://mmbiz.qpic.cn/mmbiz_png/4s8uyoT9WzP4yXWaeceU1MEWEqQZMXiaIWaibohtOibav6rSH7DhahlRtD9Af32xrXNAfrm6Xaj6dDhh33DZdaYaA/640?wx_fmt=png" data-type="png" data-w="1920" src="https://mmbiz.qpic.cn/mmbiz_png/4s8uyoT9WzP4yXWaeceU1MEWEqQZMXiaIWaibohtOibav6rSH7DhahlRtD9Af32xrXNAfrm6Xaj6dDhh33DZdaYaA/640?wx_fmt=png"></span></p><p cid="n165" mdtype="paragraph"><span md-inline="plain">4.如果网络比较混乱，也可以通过设置阈值，软件就会自动通过功能函数threshold()进行更改</span></p><pre spellcheck="false" lang="R" cid="n166" mdtype="fences"><span role="presentation"><span>bngeneplot</span>(<span>results</span> <span>=</span> <span>pway</span>,</span><br><span role="presentation">           <span>exp</span> <span>=</span> <span>vsted</span>,</span><br><span role="presentation">           <span>expSample</span> <span>=</span> <span>incSample</span>,</span><br><span role="presentation">           <span>pathNum</span> <span>=</span> <span>17</span>, <span>R</span> <span>=</span> <span>10</span>,</span><br><span role="presentation">           <span>convertSymbol</span> <span>=</span> <span>TRUE</span>,</span><br><span role="presentation">           <span>expRow</span> <span>=</span> <span>"ENSEMBL"</span>,</span><br><span role="presentation">           <span>strThresh</span> <span>=</span> <span>0.75</span>)</span></pre><p cid="n167" mdtype="paragraph"><span md-inline="image" data-src="https://superdong.oss-cn-beijing.aliyuncs.com//img/202212061042107.png"><img data-ratio="1" data-src="https://mmbiz.qpic.cn/mmbiz_png/4s8uyoT9WzP4yXWaeceU1MEWEqQZMXiaIFQPG6lVvbzLwdRCkE0eyugjmUEHBvrtHPJzsko2M4ekPuxwgxUYTYQ/640?wx_fmt=png" data-type="png" data-w="1920" src="https://mmbiz.qpic.cn/mmbiz_png/4s8uyoT9WzP4yXWaeceU1MEWEqQZMXiaIFQPG6lVvbzLwdRCkE0eyugjmUEHBvrtHPJzsko2M4ekPuxwgxUYTYQ/640?wx_fmt=png"></span></p><p cid="n168" mdtype="paragraph"><span md-inline="plain">5.也可以通过设置置信区间，边的置信区间数值。通过参数</span><span md-inline="code" spellcheck="false"><code>showDir = T</code></span><span md-inline="plain">进行展示，颜色代表了强度的数值</span></p><pre spellcheck="false" lang="R" cid="n169" mdtype="fences"><span role="presentation"><span>bngeneplot</span>(<span>results</span> <span>=</span> <span>pway</span>,</span><br><span role="presentation">           <span>exp</span> <span>=</span> <span>vsted</span>,</span><br><span role="presentation">           <span>expSample</span> <span>=</span> <span>incSample</span>,</span><br><span role="presentation">           <span>pathNum</span> <span>=</span> <span>13</span>, <span>R</span> <span>=</span> <span>50</span>, <span>showDir</span> <span>=</span> <span>T</span>,</span><br><span role="presentation">           <span>convertSymbol</span> <span>=</span> <span>T</span>,</span><br><span role="presentation">           <span>expRow</span> <span>=</span> <span>"ENSEMBL"</span>,</span><br><span role="presentation">           <span>strThresh</span> <span>=</span> <span>0.7</span>)</span></pre><p cid="n170" mdtype="paragraph"><span md-inline="image" data-src="https://superdong.oss-cn-beijing.aliyuncs.com//img/202212061042108.png"><img data-ratio="1" data-src="https://mmbiz.qpic.cn/mmbiz_png/4s8uyoT9WzP4yXWaeceU1MEWEqQZMXiaIztI7n3ceFWtt1fZ0ibEbBLWsqFK2R14FibobiaXY2lxibVZMlYbsFLy4vQ/640?wx_fmt=png" data-type="png" data-w="1920" src="https://mmbiz.qpic.cn/mmbiz_png/4s8uyoT9WzP4yXWaeceU1MEWEqQZMXiaIztI7n3ceFWtt1fZ0ibEbBLWsqFK2R14FibobiaXY2lxibVZMlYbsFLy4vQ/640?wx_fmt=png"></span></p><p cid="n171" mdtype="paragraph"><span md-inline="plain">6.展示出Hub基因会让图形信息更加丰富</span></p><pre spellcheck="false" lang="R" cid="n172" mdtype="fences"><span role="presentation"><span>bngeneplot</span>(<span>results</span> <span>=</span> <span>pway</span>,</span><br><span role="presentation">           <span>exp</span> <span>=</span> <span>vsted</span>,</span><br><span role="presentation">           <span>expSample</span> <span>=</span> <span>incSample</span>,</span><br><span role="presentation">           <span>pathNum</span> <span>=</span> <span>13</span>, <span>R</span> <span>=</span> <span>50</span>, <span>showDir</span> <span>=</span> <span>T</span>,</span><br><span role="presentation">           <span>convertSymbol</span> <span>=</span> <span>T</span>,</span><br><span role="presentation">           <span>expRow</span> <span>=</span> <span>"ENSEMBL"</span>, <span>hub</span><span>=</span><span>5</span>,</span><br><span role="presentation">           <span>strThresh</span> <span>=</span> <span>0.7</span>)</span></pre><p cid="n173" mdtype="paragraph"><span md-inline="image" data-src="https://superdong.oss-cn-beijing.aliyuncs.com//img/202212061044698.png"><img data-ratio="1" data-src="https://mmbiz.qpic.cn/mmbiz_png/4s8uyoT9WzP4yXWaeceU1MEWEqQZMXiaIpxzPHaKXwzZEQpqz9CxVYR3OJicBEYCrV0fqP5CySuMicxCJv0P0giaWA/640?wx_fmt=png" data-type="png" data-w="1920" src="https://mmbiz.qpic.cn/mmbiz_png/4s8uyoT9WzP4yXWaeceU1MEWEqQZMXiaIpxzPHaKXwzZEQpqz9CxVYR3OJicBEYCrV0fqP5CySuMicxCJv0P0giaWA/640?wx_fmt=png"></span></p><p cid="n174" mdtype="paragraph"><span md-inline="plain">7.通过设置参数</span><span md-inline="code" spellcheck="false"><code>compareRef=TRUE</code></span><span md-inline="plain">和指定</span><span md-inline="code" spellcheck="false"><code>pathDb</code></span><span md-inline="plain">形成推断网络，比较推断网络，可以发现基因之间的关系</span></p><pre spellcheck="false" lang="R" cid="n175" mdtype="fences"><span role="presentation"><span>library</span>(<span>parallel</span>)</span><br><span role="presentation"><span>cl</span> <span>=</span> <span>makeCluster</span>(<span>4</span>)</span><br><span role="presentation"><span>bngeneplot</span>(<span>results</span> <span>=</span> <span>pway</span>,</span><br><span role="presentation">           <span>exp</span> <span>=</span> <span>vsted</span>,</span><br><span role="presentation">           <span>expSample</span> <span>=</span> <span>incSample</span>,</span><br><span role="presentation">           <span>pathNum</span> <span>=</span> <span>13</span>, <span>R</span> <span>=</span> <span>30</span>, <span>compareRef</span> <span>=</span> <span>T</span>,</span><br><span role="presentation">           <span>convertSymbol</span> <span>=</span> <span>T</span>, <span>pathDb</span> <span>=</span> <span>"reactome"</span>,</span><br><span role="presentation">           <span>expRow</span> <span>=</span> <span>"ENSEMBL"</span>, <span>cl</span> <span>=</span> <span>cl</span>)</span></pre><p cid="n176" mdtype="paragraph"><span md-inline="image" data-src="https://superdong.oss-cn-beijing.aliyuncs.com//img/202212061050845.png"><img data-ratio="0.6666666666666666" data-src="https://mmbiz.qpic.cn/mmbiz_png/4s8uyoT9WzP4yXWaeceU1MEWEqQZMXiaIVQCMKpibhpQdUbxbeHzSj78FdUTVyebh2F7dsNFSMtTpxkibBSianPgkA/640?wx_fmt=png" data-type="png" data-w="2880" src="https://mmbiz.qpic.cn/mmbiz_png/4s8uyoT9WzP4yXWaeceU1MEWEqQZMXiaIVQCMKpibhpQdUbxbeHzSj78FdUTVyebh2F7dsNFSMtTpxkibBSianPgkA/640?wx_fmt=png"></span></p><p cid="n177" mdtype="paragraph"><br></p><p cid="n178" mdtype="paragraph"><span md-inline="plain">8.通过指定</span><span md-inline="code" spellcheck="false"><code>compareRefType="difference"</code></span><span md-inline="plain">，从推断网络之间发现差异</span></p><pre spellcheck="false" lang="R" cid="n179" mdtype="fences"><span role="presentation"><span>bngeneplot</span>(<span>results</span> <span>=</span> <span>pway</span>,</span><br><span role="presentation">           <span>exp</span> <span>=</span> <span>vsted</span>,</span><br><span role="presentation">           <span>expSample</span> <span>=</span> <span>incSample</span>,</span><br><span role="presentation">           <span>pathNum</span> <span>=</span> <span>15</span>, <span>R</span> <span>=</span> <span>10</span>, <span>compareRef</span> <span>=</span> <span>T</span>,</span><br><span role="presentation">           <span>convertSymbol</span> <span>=</span> <span>T</span>, <span>pathDb</span> <span>=</span> <span>"reactome"</span>, <span>compareRefType</span> <span>=</span> <span>"difference"</span>,</span><br><span role="presentation">           <span>expRow</span> <span>=</span> <span>"ENSEMBL"</span>)</span></pre><p cid="n180" mdtype="paragraph"><span md-inline="image" data-src="https://superdong.oss-cn-beijing.aliyuncs.com//img/202212061050847.png"><img data-ratio="0.6666666666666666" data-src="https://mmbiz.qpic.cn/mmbiz_png/4s8uyoT9WzP4yXWaeceU1MEWEqQZMXiaIIiaXiakTKdUwtztbMIG7k3J4qHsdZKyx9t4vzuX2MTgO0PqIrIvo8aFQ/640?wx_fmt=png" data-type="png" data-w="2880" src="https://mmbiz.qpic.cn/mmbiz_png/4s8uyoT9WzP4yXWaeceU1MEWEqQZMXiaIIiaXiakTKdUwtztbMIG7k3J4qHsdZKyx9t4vzuX2MTgO0PqIrIvo8aFQ/640?wx_fmt=png"></span></p><p cid="n181" mdtype="paragraph"><span md-inline="plain">9.使用DepMap信息绘图：DepMap依赖评分能够使用depmap包进行节点大小的绘图，可以通过指定参数</span><span md-inline="code" spellcheck="false"><code>sizeDep=TRUE</code></span><span md-inline="plain">进行实现，对于癌症相关的研究非常有用。</span></p><pre spellcheck="false" lang="R" cid="n182" mdtype="fences">dep = depmap::depmap_crispr()<br>bngeneplot(results = pway,<br>           exp = vsted,<br>           expSample = incSample,<br>           pathNum = 15, R = 5,compareRef = T,<br>           convertSymbol = T, pathDb = "reactome", compareRefType = "intersection",<br>           expRow = "ENSEMBL", sizeDep = T, dep = dep)</pre><p cid="n183" mdtype="paragraph"><span md-inline="image" data-src="https://superdong.oss-cn-beijing.aliyuncs.com//img/202212061102337.png"><img data-ratio="0.5" data-src="https://mmbiz.qpic.cn/mmbiz_png/4s8uyoT9WzP4yXWaeceU1MEWEqQZMXiaIkYepK7Esk680icVIpibynVLqaicI1BPdrgvNnFtjA3dBWpfTwPWGcLZdw/640?wx_fmt=png" data-type="png" data-w="3840" src="https://mmbiz.qpic.cn/mmbiz_png/4s8uyoT9WzP4yXWaeceU1MEWEqQZMXiaIkYepK7Esk680icVIpibynVLqaicI1BPdrgvNnFtjA3dBWpfTwPWGcLZdw/640?wx_fmt=png"></span></p><p cid="n184" mdtype="paragraph"><span md-inline="plain">10.基于分数进行RNA的推断</span></p><pre spellcheck="false" lang="R" cid="n185" mdtype="fences">rnai = depmap::depmap_rnai()<br>bngeneplot(results = pway,<br>           exp = vsted,<br>           expSample = incSample,<br>           pathNum = 3, R = 5,compareRef = T,<br>           convertSymbol = T, pathDb = "reactome", compareRefType = "intersection",<br>           expRow = "ENSEMBL", sizeDep = T, dep = rnai, cellLineName = "UMUC3_URINARY_TRACT")</pre><p cid="n186" mdtype="paragraph"><span md-inline="image" data-src="https://superdong.oss-cn-beijing.aliyuncs.com//img/202212061102338.png"><img data-ratio="0.5" data-src="https://mmbiz.qpic.cn/mmbiz_png/4s8uyoT9WzP4yXWaeceU1MEWEqQZMXiaIeR9rrleBpUBeSTbYAumf53RSLu3bYqF1uClysXCbH8pzzNwFZibXnGA/640?wx_fmt=png" data-type="png" data-w="3840" src="https://mmbiz.qpic.cn/mmbiz_png/4s8uyoT9WzP4yXWaeceU1MEWEqQZMXiaIeR9rrleBpUBeSTbYAumf53RSLu3bYqF1uClysXCbH8pzzNwFZibXnGA/640?wx_fmt=png"></span></p><p cid="n187" mdtype="paragraph"><span md-inline="plain">11.我们也可以绘制感兴趣基因的依赖评分，通过指定参数</span><span md-inline="code" spellcheck="false"><code>showLineage=TRUE</code></span><span md-inline="plain">进行。需要注意的是，对depMeta要提供metadata</span></p><pre spellcheck="false" lang="R" cid="n188" mdtype="fences">depMeta = depmap::depmap_metadata()<br>bngeneplot(results = pway,<br>           exp = vsted,<br>           expSample = incSample,<br>           pathNum = 15, R = 10, compareRef = T,<br>           convertSymbol = T, pathDb = "reactome", compareRefType = "intersection",<br>           expRow = "ENSEMBL", sizeDep = T, dep = dep, showLineage = T, depMeta = depMeta)</pre><p cid="n189" mdtype="paragraph"><span md-inline="image" data-src="https://superdong.oss-cn-beijing.aliyuncs.com//img/202212061102339.png"><img data-ratio="0.75" data-src="https://mmbiz.qpic.cn/mmbiz_png/4s8uyoT9WzP4yXWaeceU1MEWEqQZMXiaIIgSkBx8jDWeJoIukgveIGxicfYaOPibvoRbJZPTm3b7ugAHyp11fhUtg/640?wx_fmt=png" data-type="png" data-w="3840" src="https://mmbiz.qpic.cn/mmbiz_png/4s8uyoT9WzP4yXWaeceU1MEWEqQZMXiaIIgSkBx8jDWeJoIukgveIGxicfYaOPibvoRbJZPTm3b7ugAHyp11fhUtg/640?wx_fmt=png"></span></p><p cid="n190" mdtype="paragraph"><span md-inline="plain">12.绘制边的强度：通过指定</span><span md-inline="code" spellcheck="false"><code>strengthPlot=TRUE</code></span><span md-inline="plain"> 和 </span><span md-inline="code" spellcheck="false"><code>nStrength</code></span><span md-inline="plain">参数，增加一个描绘边的强度和方向的柱状图</span></p><p cid="n191" mdtype="paragraph"><span md-inline="image" data-src="https://superdong.oss-cn-beijing.aliyuncs.com//img/202212061102340.png"><img data-ratio="0.75" data-src="https://mmbiz.qpic.cn/mmbiz_png/4s8uyoT9WzP4yXWaeceU1MEWEqQZMXiaIBFuGWHkOnThJnQ7ydJoST5ovgNB0xkEqZVs506SZlUIvpzyoQjt77Q/640?wx_fmt=png" data-type="png" data-w="3840" src="https://mmbiz.qpic.cn/mmbiz_png/4s8uyoT9WzP4yXWaeceU1MEWEqQZMXiaIBFuGWHkOnThJnQ7ydJoST5ovgNB0xkEqZVs506SZlUIvpzyoQjt77Q/640?wx_fmt=png"></span></p><p cid="n192" mdtype="paragraph"><span md-inline="plain">13.绘制多条通路的基因</span></p><pre spellcheck="false" lang="R" cid="n193" mdtype="fences"><span role="presentation"><span>cl</span> <span>=</span> <span>makeCluster</span>(<span>8</span>)</span><br><span role="presentation"><span>bngeneplot</span>(<span>results</span> <span>=</span> <span>pway</span>,</span><br><span role="presentation">           <span>exp</span> <span>=</span> <span>vsted</span>,</span><br><span role="presentation">           <span>expSample</span> <span>=</span> <span>incSample</span>,</span><br><span role="presentation">           <span>pathNum</span> <span>=</span> <span>c</span>(<span>15</span>, <span>16</span>), <span>R</span> <span>=</span> <span>10</span>,</span><br><span role="presentation">           <span>convertSymbol</span> <span>=</span> <span>T</span>,</span><br><span role="presentation">           <span>expRow</span> <span>=</span> <span>"ENSEMBL"</span>)</span></pre><p cid="n194" mdtype="paragraph"><span md-inline="image" data-src="https://superdong.oss-cn-beijing.aliyuncs.com//img/202212061102341.png"><img data-ratio="1" data-src="https://mmbiz.qpic.cn/mmbiz_png/4s8uyoT9WzP4yXWaeceU1MEWEqQZMXiaI348Q3x5KhSqjJpeaGxX0A1jXkH5ypOHILrwqEnWBCWpeXavazVnJPg/640?wx_fmt=png" data-type="png" data-w="3840" src="https://mmbiz.qpic.cn/mmbiz_png/4s8uyoT9WzP4yXWaeceU1MEWEqQZMXiaI348Q3x5KhSqjJpeaGxX0A1jXkH5ypOHILrwqEnWBCWpeXavazVnJPg/640?wx_fmt=png"></span></p><h4 cid="n195" mdtype="heading"><span md-inline="plain">原文链接：</span></h4><p cid="n196" mdtype="paragraph"><span md-inline="url" spellcheck="false">https://noriakis.github.io/software/CBNplot/</span></p><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/UKAfvqqoIA9PFRvNIrAPbg",target="_blank" rel="noopener noreferrer">原文链接</a>
