---
title: "DNBeLab C4单细胞转录组技术上游分析流程"
date: 2023-04-15T00:32:31Z
draft: ["false"]
tags: [
  "fetched",
  "东林的扯淡小屋"
]
categories: ["Acdemic"]
---
DNBeLab C4单细胞转录组技术上游分析流程 by 东林的扯淡小屋
------
<div><p><img data-galleryid="" data-ratio="0.6398148148148148" data-s="300,640" data-type="png" data-w="1080" data-src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBrk2eQ1eEibVUbt7QV9Chcg7qKJto2qsIdjN53hAuXZYjibLH8fVmXpicXOhaq1PoJ8icGmfBNo2ue8IA/640?wx_fmt=png" src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBrk2eQ1eEibVUbt7QV9Chcg7qKJto2qsIdjN53hAuXZYjibLH8fVmXpicXOhaq1PoJ8icGmfBNo2ue8IA/640?wx_fmt=png"></p><p><img data-galleryid="" data-ratio="0.8101851851851852" data-s="300,640" data-type="png" data-w="1080" data-src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBrk2eQ1eEibVUbt7QV9Chcg7icG3CF5BEnJONxTLUSaShOuyfGHhojAVro8OJVL4mESOichXsjS1opmQ/640?wx_fmt=png" src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBrk2eQ1eEibVUbt7QV9Chcg7icG3CF5BEnJONxTLUSaShOuyfGHhojAVro8OJVL4mESOichXsjS1opmQ/640?wx_fmt=png"></p><p><img data-galleryid="" data-ratio="0.7574074074074074" data-s="300,640" data-type="png" data-w="1080" data-src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBrk2eQ1eEibVUbt7QV9Chcg7VC3Ar3gqgJK38AxicvaJ5dkjQPib7SCOXeicEpRByCdkmF7x4ibZpklicCA/640?wx_fmt=png" src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBrk2eQ1eEibVUbt7QV9Chcg7VC3Ar3gqgJK38AxicvaJ5dkjQPib7SCOXeicEpRByCdkmF7x4ibZpklicCA/640?wx_fmt=png">https://www.nature.com/articles/s41586-022-04625-0</p><p><img data-galleryid="" data-ratio="0.6796296296296296" data-s="300,640" data-type="png" data-w="1080" data-src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBrk2eQ1eEibVUbt7QV9Chcg7UcMr87gHv2p1djGKholNjQbBJPGiaRnrZJtyNCEcqH5rHl3v2Dejukw/640?wx_fmt=png" src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBrk2eQ1eEibVUbt7QV9Chcg7UcMr87gHv2p1djGKholNjQbBJPGiaRnrZJtyNCEcqH5rHl3v2Dejukw/640?wx_fmt=png"></p><p><img data-galleryid="" data-ratio="0.8768518518518519" data-s="300,640" data-type="png" data-w="1080" data-src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBrk2eQ1eEibVUbt7QV9Chcg7xAsK0w5OWCtOialELrl3tGGGbX6goCtcDNic4Nic4MbMWXPmMN51UUBTg/640?wx_fmt=png" src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBrk2eQ1eEibVUbt7QV9Chcg7xAsK0w5OWCtOialELrl3tGGGbX6goCtcDNic4Nic4MbMWXPmMN51UUBTg/640?wx_fmt=png"></p><p>分析的流程：The analysis pipelines for scRNA-seq data generated by DNBeLab C4 are implemented using an in-house workflow (https://github.com/MGI-tech-bioinformatics/DNBelab_C_Series_HT_scRNA-analysis-software).<br></p><p><br></p><p>开始安装软件：https://github.com/MGI-tech-bioinformatics/DNBelab_C_Series_HT_scRNA-analysis-software/blob/version2.0/doc/quickstart.md<br></p><section><ul><li><li><li><li><li><li><li><li><li></ul><pre data-lang="properties"><code><span><span>git</span> <span>clone https://github.com/MGI-tech-bioinformatics/DNBelab_C_Series_HT_scRNA-analysis-software.git</span></span></code><code><span><span>chmod</span> <span>755 -R DNBelab_C_Series_HT_scRNA-analysis-software</span></span></code><code><span><span>cd</span> <span>DNBelab_C_Series_HT_scRNA-analysis-software</span></span></code><code><span><span>source</span> <span>/miniconda3/bin/activate</span></span></code><code><span><span>conda</span> <span>env create -f DNBC4tools.yaml -n DNBC4tools</span></span></code><code><span><span>conda</span> <span>activate DNBC4tools</span></span></code><code><span><span>Rscript</span> <span>-e "devtools::install_github(c('chris-mcginnis-ucsf/DoubletFinder','ggjlab/scHCL','ggjlab/scMCA'),force = TRUE);"</span></span></code><code><span><span>source</span> <span>activate DNBC4tools</span></span></code><code><span><span>pip</span> <span>install --upgrade -i https://pypi.tuna.tsinghua.edu.cn/simple dnbc4tools</span></span></code></pre></section><p><img data-galleryid="" data-ratio="0.5675925925925925" data-s="300,640" data-type="png" data-w="1080" data-src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBrk2eQ1eEibVUbt7QV9Chcg75agjXlkJdGD5NaTichuJq2GcLyVnen2pDhFPRmsLsCib3jBFDpBWHzicQ/640?wx_fmt=png" src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBrk2eQ1eEibVUbt7QV9Chcg75agjXlkJdGD5NaTichuJq2GcLyVnen2pDhFPRmsLsCib3jBFDpBWHzicQ/640?wx_fmt=png"></p><p><img data-galleryid="" data-ratio="0.24166666666666667" data-s="300,640" data-type="png" data-w="1080" data-src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBrk2eQ1eEibVUbt7QV9Chcg7xo0wS8F1lRhv6letO9g0xTszNfjZAOfU0z9NP3iaUq6wicSFOKuTEWzw/640?wx_fmt=png" src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBrk2eQ1eEibVUbt7QV9Chcg7xo0wS8F1lRhv6letO9g0xTszNfjZAOfU0z9NP3iaUq6wicSFOKuTEWzw/640?wx_fmt=png"></p><p><img data-galleryid="" data-ratio="0.5601851851851852" data-s="300,640" data-type="png" data-w="1080" data-src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBrk2eQ1eEibVUbt7QV9Chcg7XMYBGoqvqe0icFMsRggWxxBGnCtXm4BqoJvb1WF37gYFN79FLwKEWmw/640?wx_fmt=png" src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBrk2eQ1eEibVUbt7QV9Chcg7XMYBGoqvqe0icFMsRggWxxBGnCtXm4BqoJvb1WF37gYFN79FLwKEWmw/640?wx_fmt=png"></p><p><br></p><p>下载参考基因组：https://github.com/MGI-tech-bioinformatics/DNBelab_C_Series_HT_scRNA-analysis-software/blob/version2.0/doc/quickstart.md</p><p><img data-galleryid="" data-ratio="0.5953703703703703" data-s="300,640" data-type="png" data-w="1080" data-src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBrk2eQ1eEibVUbt7QV9Chcg7VUzmymtwU6gp7doPmTLXfTIOKFOocn58Hxg9GpiconjwXrvkyRCQelw/640?wx_fmt=png" src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBrk2eQ1eEibVUbt7QV9Chcg7VUzmymtwU6gp7doPmTLXfTIOKFOocn58Hxg9GpiconjwXrvkyRCQelw/640?wx_fmt=png"></p><p><img data-galleryid="" data-ratio="0.612037037037037" data-s="300,640" data-type="png" data-w="1080" data-src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBrk2eQ1eEibVUbt7QV9Chcg7yRFWHoqm14HVU1GogMlQn8nUrjia8r6h6WltX5nbTo73AEhUMeIGD4Q/640?wx_fmt=png" src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBrk2eQ1eEibVUbt7QV9Chcg7yRFWHoqm14HVU1GogMlQn8nUrjia8r6h6WltX5nbTo73AEhUMeIGD4Q/640?wx_fmt=png"></p><p><img data-galleryid="" data-ratio="0.6101851851851852" data-s="300,640" data-type="png" data-w="1080" data-src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBrk2eQ1eEibVUbt7QV9Chcg7zY4njORHIfqW1alBicMXqPeu1n5JkQPEXwF1icW649HQAfahPYXia2lxQ/640?wx_fmt=png" src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBrk2eQ1eEibVUbt7QV9Chcg7zY4njORHIfqW1alBicMXqPeu1n5JkQPEXwF1icW649HQAfahPYXia2lxQ/640?wx_fmt=png"></p><section><ul><li><li><li><li></ul><pre data-lang="ruby"><code><span>wget <span>http:</span>/<span>/ftp.ebi.ac.uk/pub</span><span>/databases/gencode</span><span>/Gencode_mouse/release</span>_M23/GRCm38.primary_assembly.genome.fa.gz</span></code><code><span>wget <span>http:</span>/<span>/ftp.ebi.ac.uk/pub</span><span>/databases/gencode</span><span>/Gencode_mouse/release</span>_M23/gencode.vM23.primary_assembly.annotation.gtf.gz</span></code><code><span>gzip -d GRCm38.primary_assembly.genome.fa.gz</span></code><code><span>gzip -d gencode.vM23.primary_assembly.annotation.gtf.gz</span></code></pre></section><p><img data-galleryid="" data-ratio="0.35462962962962963" data-s="300,640" data-type="png" data-w="1080" data-src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBrk2eQ1eEibVUbt7QV9Chcg7ryyJbWPBaQdrYUYdgGjRs6ryXOTcHJlx50QoTkaEOdnQT6iclrFU8oQ/640?wx_fmt=png" src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBrk2eQ1eEibVUbt7QV9Chcg7ryyJbWPBaQdrYUYdgGjRs6ryXOTcHJlx50QoTkaEOdnQT6iclrFU8oQ/640?wx_fmt=png"></p><p><img data-galleryid="" data-ratio="0.4462962962962963" data-s="300,640" data-type="png" data-w="1080" data-src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBrk2eQ1eEibVUbt7QV9Chcg7Sy1e17Lfm11afeVklSMMCwOs8yCzbjbVcukp9W5nfjYTJ0IrjiaW4fw/640?wx_fmt=png" src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBrk2eQ1eEibVUbt7QV9Chcg7Sy1e17Lfm11afeVklSMMCwOs8yCzbjbVcukp9W5nfjYTJ0IrjiaW4fw/640?wx_fmt=png"></p><p><img data-galleryid="" data-ratio="0.6064814814814815" data-s="300,640" data-type="png" data-w="1080" data-src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBrk2eQ1eEibVUbt7QV9Chcg75uTfe7g5OmkW3TAC879KB5QuJBRNJpwFbecfkOibzQib0sPAF6wlRLNQ/640?wx_fmt=png" src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBrk2eQ1eEibVUbt7QV9Chcg75uTfe7g5OmkW3TAC879KB5QuJBRNJpwFbecfkOibzQib0sPAF6wlRLNQ/640?wx_fmt=png"></p><p><img data-galleryid="" data-ratio="0.5944444444444444" data-s="300,640" data-type="png" data-w="1080" data-src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBrk2eQ1eEibVUbt7QV9Chcg7cDN6lcKV7dDp86fyyjg1y6ibH0LdErbs3PTUWcQmqeESO3hr0LbKNyg/640?wx_fmt=png" src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBrk2eQ1eEibVUbt7QV9Chcg7cDN6lcKV7dDp86fyyjg1y6ibH0LdErbs3PTUWcQmqeESO3hr0LbKNyg/640?wx_fmt=png"></p><p><img data-galleryid="" data-ratio="0.487962962962963" data-s="300,640" data-type="png" data-w="1080" data-src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBrk2eQ1eEibVUbt7QV9Chcg79GANrTm81Uw8iazp1rWdcS7DOAmP7PfPltMHsB3RzkNrrNlSSZodibUQ/640?wx_fmt=png" src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBrk2eQ1eEibVUbt7QV9Chcg79GANrTm81Uw8iazp1rWdcS7DOAmP7PfPltMHsB3RzkNrrNlSSZodibUQ/640?wx_fmt=png"></p><p><img data-galleryid="" data-ratio="0.48148148148148145" data-s="300,640" data-type="png" data-w="1080" data-src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBrk2eQ1eEibVUbt7QV9Chcg7ZD9A4ibCYzgvtV0We9tIvABh1micGUE0JeF9edX2cZYmp6Ux6rhkIhew/640?wx_fmt=png" src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBrk2eQ1eEibVUbt7QV9Chcg7ZD9A4ibCYzgvtV0We9tIvABh1micGUE0JeF9edX2cZYmp6Ux6rhkIhew/640?wx_fmt=png"></p><p>开始运行：</p><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="bash"><code><span>DNBC4tools run --cDNAfastq1 /<span>test</span>/data/test_cDNA_R1.fastq.gz \</span></code><code><span>  --cDNAfastq2 /<span>test</span>/data/test_cDNA_R2.fastq.gz \</span></code><code><span>  --oligofastq1 /<span>test</span>/data/test_oligo1_1.fq.gz,/<span>test</span>/data/test_oligo2_1.fq.gz \</span></code><code><span>  --oligofastq2 /<span>test</span>/data/test_oligo1_2.fq.gz,/<span>test</span>/data/test_oligo2_2.fq.gz \</span></code><code><span>  --genomeDir /database/Mouse/mm10 --gtf /database/Mouse/mm10/genes.gtf \</span></code><code><span>  --name <span>test</span> --species Mus_musculus --thread 10</span></code><code><span>  </span></code><code><span><span># set "--expectcells" ,it is recommended to set the expected number of recovered cells according to 50% of the input amount of viable cells (capture efficiency 50%).</span></span></code><code><span><span># For example, the input of viable cells is 20,000</span></span></code><code><span>DNBC4tools run --cDNAfastq1 /<span>test</span>/data/test_cDNA_R1.fastq.gz \</span></code><code><span>  --cDNAfastq2 /<span>test</span>/data/test_cDNA_R2.fastq.gz \</span></code><code><span>  --oligofastq1 /<span>test</span>/data/test_oligo1_1.fq.gz,/<span>test</span>/data/test_oligo2_1.fq.gz \</span></code><code><span>  --oligofastq2 /<span>test</span>/data/test_oligo1_2.fq.gz,/<span>test</span>/data/test_oligo2_2.fq.gz \</span></code><code><span>  --genomeDir /database/Mouse/mm10 --gtf /database/Mouse/mm10/genes.gtf \</span></code><code><span>  --name <span>test</span> --species Mus_musculus --expectcells 10000 --thread 10</span></code><code><span>  </span></code><code><span><span># set "--chemistry" and "--darkreaction" or "--customize", "--customize" has the highest priority</span></span></code><code><span>DNBC4tools run --cDNAfastq1 /<span>test</span>/data/test_cDNA_R1.fastq.gz \</span></code><code><span>  --cDNAfastq2 /<span>test</span>/data/test_cDNA_R2.fastq.gz \</span></code><code><span>  --oligofastq1 /<span>test</span>/data/test_oligo1_1.fq.gz,/<span>test</span>/data/test_oligo2_1.fq.gz \</span></code><code><span>  --oligofastq2 /<span>test</span>/data/test_oligo1_2.fq.gz,/<span>test</span>/data/test_oligo2_2.fq.gz \</span></code><code><span>  --genomeDir /database/Mouse/mm10 --gtf /database/Mouse/mm10/genes.gtf \</span></code><code><span>  --name <span>test</span> --species Mus_musculus --expectcells 10000 \</span></code><code><span>  --customize scRNA_beads_darkReaction.json,scRNA_oligo_darkReaction.json --thread 10</span></code></pre></section><p><br></p><p>有中文版：https://dnbc4tools.readthedocs.io/zh/latest/analysis.html</p><p><img data-galleryid="" data-ratio="0.6296296296296297" data-s="300,640" data-type="png" data-w="1080" data-src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBrk2eQ1eEibVUbt7QV9Chcg7S3Hlgn2nLp2HuI2SmqPjJJ3RbWxzCJs9zTGN0ibHsPpDkq0EXibfJ5qw/640?wx_fmt=png" src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBrk2eQ1eEibVUbt7QV9Chcg7S3Hlgn2nLp2HuI2SmqPjJJ3RbWxzCJs9zTGN0ibHsPpDkq0EXibfJ5qw/640?wx_fmt=png"></p><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/UAo3oGddKdV2LQPIWEtXrw",target="_blank" rel="noopener noreferrer">原文链接</a>
