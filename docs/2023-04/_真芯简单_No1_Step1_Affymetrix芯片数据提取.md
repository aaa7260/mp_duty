---
title: "#真芯简单 No1 Step1 Affymetrix芯片数据提取"
date: 2023-04-10T00:02:32Z
draft: ["false"]
tags: [
  "fetched",
  "生信菜鸟团"
]
categories: ["Acdemic"]
---
#真芯简单 No1 Step1 Affymetrix芯片数据提取 by 生信菜鸟团
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><p data-tool="mdnice编辑器"><span><strong><span>感恩曾老师、小洁老师及生信技能树的伙伴们</span></strong></span></p><p data-tool="mdnice编辑器"><span><span>标签：#芯片差异富集分析  </span><span>#Affymetrix  #单分组</span></span></p><p data-tool="mdnice编辑器"><span><strong><span>系列预告</span></strong></span></p><p data-tool="mdnice编辑器"><span>#真芯简单 No2 Step1  Agilent芯片数据提取</span></p><p data-tool="mdnice编辑器"><span>#<span>真芯简单 No3 Step1  正常Illumina芯片数据提取</span></span></p><h1 data-tool="mdnice编辑器"><span>0.0前情提要</span></h1><p data-tool="mdnice编辑器">学习了芯片数据的差异富集分析后，非常感谢曾老师适时地在我的邮箱中发送了以下练习题。一共32个数据集的练习。个人认为芯片分析的重点：获取<strong>表达矩阵</strong>，获取<strong>分组信息</strong>，获取<strong>注释文件</strong>，不要在意获取顺序，只要准备好了这3个文件就可以开展后续的差异富集分析。如果是曾老师的话，每个数据集大概3分钟吧，嗯，确信。今天是No1，GSE33532 <img data-ratio="0.7138888888888889" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los980mOE09sibQ0nIUcuooN1LpJAOFyicP3pkncavcoL5pGSv9ibyqnhfFMaL6Qc28uk8jPTR8lL0ZSVA/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los980mOE09sibQ0nIUcuooN1LpJAOFyicP3pkncavcoL5pGSv9ibyqnhfFMaL6Qc28uk8jPTR8lL0ZSVA/640?wx_fmt=png"></p><h1 data-tool="mdnice编辑器"><span>1 数据观察</span></h1><p data-tool="mdnice编辑器">GSE33532，NCBI查询<img data-ratio="1.2426666666666666" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los980mOE09sibQ0nIUcuooN1LkS41gowKmrGv7dhhadyZhJeaVE58aagVAA2NA65tkUAKEQOO9aIw5w/640?wx_fmt=png" data-type="png" data-w="750" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los980mOE09sibQ0nIUcuooN1LkS41gowKmrGv7dhhadyZhJeaVE58aagVAA2NA65tkUAKEQOO9aIw5w/640?wx_fmt=png">芯片厂家与小洁老师上课的一样了。应该可以直接拿Series Matrix File(s)提取表达矩阵。</p><h1 data-tool="mdnice编辑器"><span>2 数据获取</span></h1><h2 data-tool="mdnice编辑器"><span>2 1/3 从series_matrix.txt.gz获取表达矩阵exp</span></h2><p data-tool="mdnice编辑器">#####文件下载#####</p><h3 data-tool="mdnice编辑器"><span>1 文件下载</span></h3><p data-tool="mdnice编辑器"><img data-ratio="0.48807631160572335" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los980mOE09sibQ0nIUcuooN1LjqLoHsZAeOS4ypP2FwPBg9umJ1H04Uas9gwA2mxKkhcqJbeTTM7hLg/640?wx_fmt=png" data-type="png" data-w="629" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los980mOE09sibQ0nIUcuooN1LjqLoHsZAeOS4ypP2FwPBg9umJ1H04Uas9gwA2mxKkhcqJbeTTM7hLg/640?wx_fmt=png">点击这个红框<img data-ratio="0.18899521531100477" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los980mOE09sibQ0nIUcuooN1L6ojoOhp4spqEbg6N00mBOhFQ3ca6RMyUFaib9EWWtGgIVIAAp1dsghw/640?wx_fmt=png" data-type="png" data-w="418" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los980mOE09sibQ0nIUcuooN1L6ojoOhp4spqEbg6N00mBOhFQ3ca6RMyUFaib9EWWtGgIVIAAp1dsghw/640?wx_fmt=png">下载这个红箭头指向的文件</p><h3 data-tool="mdnice编辑器"><span>2 R包加载，信息输入</span></h3><pre data-tool="mdnice编辑器"><code><span>#先加载一堆包</span><br>rm(list=ls())<br>options(stringsAsFactors=F)<br>library(limma)<br>library(GEOquery)<br>library(GenomicFeatures)<br>library(methylumi)<br>library(lumi)<br>library(dplyr)<br>library(stringr)<br>library(idmap1)<br>library(stringr)<br>library(AnnoProbe)<br><br><span>#芯片信息，通过GSE号查询NCBI就可以知道GPL号</span><br>gse_number = <span>"GSE33532"</span><br>gpl_number = <span>"GPL570"</span><br>file_name=paste0(gse_number,<span>'_series_matrix.txt.gz'</span>) <span>#懒得每次都改文件名了</span><br></code></pre><h3 data-tool="mdnice编辑器"><span>3 提取数据集eSet</span></h3><pre data-tool="mdnice编辑器"><code><span>#获取GSE33532的数据集</span><br>eSet = getGEO(filename=file_name,getGPL = F)<br></code></pre><p data-tool="mdnice编辑器"><img data-ratio="0.27366020524515394" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los980mOE09sibQ0nIUcuooN1LI46INXGQX0fZsA7VlKN0ruyLMyVhciaGS1wMvcjP2Ftv0icj9l5SRfUw/640?wx_fmt=png" data-type="png" data-w="877" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los980mOE09sibQ0nIUcuooN1LI46INXGQX0fZsA7VlKN0ruyLMyVhciaGS1wMvcjP2Ftv0icj9l5SRfUw/640?wx_fmt=png">简单就找到了表达矩阵，样本数量与列数也能对应上。<img data-ratio="0.26158940397350994" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los980mOE09sibQ0nIUcuooN1La7vib4rubpyXRhfnDeCY6XVA8b3eRZIGmS11Kqal22o46EJm9Sr5pTQ/640?wx_fmt=png" data-type="png" data-w="906" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los980mOE09sibQ0nIUcuooN1La7vib4rubpyXRhfnDeCY6XVA8b3eRZIGmS11Kqal22o46EJm9Sr5pTQ/640?wx_fmt=png">从environmint来看是用@提取。那来吧。</p><h3 data-tool="mdnice编辑器"><span>4 从eSet提取表达矩阵exp</span></h3><pre data-tool="mdnice编辑器"><code><span>#从数据集提取表达矩阵</span><br>exp=eSet@assayData<span>$exprs</span> <br>exp[1:4,1:4] <span>#看一眼提取的表达矩阵</span><br>dim(exp) <span>#确认一下行列数</span><br></code></pre><pre data-tool="mdnice编辑器"><code><span>#结果</span><br>&gt; exp[1:4,1:4]<br>          GSM835268 GSM835269 GSM835270 GSM835271<br>1007_s_at  9.872989 10.434562 10.093931  9.830508<br>1053_at    6.648595  6.773601  6.643051  6.854348<br>121_at     7.185752  6.980180  7.153527  7.199128<br>1255_g_at  4.117641  4.318899  3.796970  4.030910<br>&gt; dim(exp)<br>[1] 25906   100<br></code></pre><p data-tool="mdnice编辑器">表达矩阵exp，Get！</p><h2 data-tool="mdnice编辑器"><span>2 2/3从series_matrix.txt.gz获取分组信息Group</span></h2><h3 data-tool="mdnice编辑器"><span>1 从1/3继承数据集eSet</span></h3><p data-tool="mdnice编辑器"><img data-ratio="0.44166666666666665" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los980mOE09sibQ0nIUcuooN1LzLNnLpiaVJaryEvtL41JBicRLR6JmZYTwqoXm2Sazd5wtK4ic4MTSEPibQ/640?wx_fmt=png" data-type="png" data-w="960" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los980mOE09sibQ0nIUcuooN1LzLNnLpiaVJaryEvtL41JBicRLR6JmZYTwqoXm2Sazd5wtK4ic4MTSEPibQ/640?wx_fmt=png">观察了一下，发现phenoData下的Data数据框里面有记录了很多实验相关的信息，觉得分组信息应该就在里面。<img data-ratio="0.3337041156840934" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los980mOE09sibQ0nIUcuooN1L9jjovEUKcSqCzpc9yYj2ia3GEhX4B8XZZMpxib9XJpeJSWE6gDSD0icKw/640?wx_fmt=png" data-type="png" data-w="899" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los980mOE09sibQ0nIUcuooN1L9jjovEUKcSqCzpc9yYj2ia3GEhX4B8XZZMpxib9XJpeJSWE6gDSD0icKw/640?wx_fmt=png">再次使用@提取</p><h3 data-tool="mdnice编辑器"><span>2 从eSet提取分组信息Group</span></h3><p data-tool="mdnice编辑器"><img data-ratio="0.47764227642276424" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los980mOE09sibQ0nIUcuooN1L9edmhcODop9MIJdXWuNQAC4HHATbgB98PRyiamXf7WR9cK10X6JWmibg/640?wx_fmt=png" data-type="png" data-w="984" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los980mOE09sibQ0nIUcuooN1L9edmhcODop9MIJdXWuNQAC4HHATbgB98PRyiamXf7WR9cK10X6JWmibg/640?wx_fmt=png">发现title列的内容可以和GEO页面给的分组信息互相对应。于是，我用title列进行分组。</p><pre data-tool="mdnice编辑器"><code>pd=eSet@phenoData@data <span>#提取表观数据总表格</span><br>table(pd<span>$title</span>) <span>#查看列名方便复制粘贴</span><br>Group=ifelse(grepl(<span>'normal'</span>,pd<span>$title</span>),<span>'control'</span>,<span>'tumor'</span>) <span>#使用normal为关键词进行分组</span><br>table(Group) <span>#查看一下分组对不对，应该control 20，tumor 80</span><br>Group = factor(Group,levels = c(<span>"control"</span>,<span>"tumor"</span>)) <span>#分组因子化</span><br>Group <br></code></pre><pre data-tool="mdnice编辑器"><code><span>#结果</span><br>&gt; Group=ifelse(grepl(<span>'normal'</span>,pd<span>$title</span>),<span>'control'</span>,<span>'tumor'</span>)<br>&gt; table(Group)<br>Group<br>control   tumor <br>     20      80  <span>#分组正确</span><br>&gt; Group = factor(Group,levels = c(<span>"control"</span>,<span>"tumor"</span>))<br>&gt; Group<br>  [1] tumor   tumor   tumor   tumor   control tumor   tumor   tumor   tumor   control tumor   tumor  <br> [13] tumor   tumor   control tumor   tumor   tumor   tumor   control tumor   tumor   tumor   tumor  <br> [25] control tumor   tumor   tumor   tumor   control tumor   tumor   tumor   tumor   control tumor  <br> [37] tumor   tumor   tumor   control tumor   tumor   tumor   tumor   control tumor   tumor   tumor  <br> [49] tumor   control tumor   tumor   tumor   tumor   control tumor   tumor   tumor   tumor   control<br> [61] tumor   tumor   tumor   tumor   control tumor   tumor   tumor   tumor   control tumor   tumor  <br> [73] tumor   tumor   control tumor   tumor   tumor   tumor   control tumor   tumor   tumor   tumor  <br> [85] control tumor   tumor   tumor   tumor   control tumor   tumor   tumor   tumor   control tumor  <br> [97] tumor   tumor   tumor   control<br>Levels: control tumor <span>#因子化成功</span><br></code></pre><p data-tool="mdnice编辑器">分组信息Group，Get！</p><h2 data-tool="mdnice编辑器"><span>3 3/3使用AnnoProbe包，idmap函数获取注释文件nids</span></h2><h3 data-tool="mdnice编辑器"><span>1 提取原始注释文件nids</span></h3><pre data-tool="mdnice编辑器"><code><span>#不library了，开始的时候已经library了</span><br>nids=idmap(gpl_number,<span>'soft'</span>)<br>head(nids) <span>#看一眼长啥样</span><br></code></pre><pre data-tool="mdnice编辑器"><code><span>#结果</span><br>&gt; nids=idmap(gpl_number,<span>'soft'</span>)<br>trying URL <span>'http://49.235.27.111/GEOmirror/GPL/GPL570_soft.rda'</span><br>Content <span>type</span> <span>'application/octet-stream'</span> length 295573 bytes (288 KB)<br>==================================================<br>downloaded 288 KB<br><br>file downloaded <span>in</span> /home/data/sbc197/MicroArray/A1/GSE33532<br>&gt; head(nids) <span>#看一眼长啥样</span><br>         ID           symbol<br>1 1007_s_at DDR1 /// MIR4640<br>2   1053_at             RFC2<br>3    117_at            HSPA6<br>4    121_at             PAX8<br>5 1255_g_at           GUCA1A<br>6   1294_at MIR5193 /// UBA7<br></code></pre><p data-tool="mdnice编辑器">symbol这一列有点奇怪，symbol与symbol之间有///符号，以下我列举了3种处理方法</p><h3 data-tool="mdnice编辑器"><span>2 三种策略 - 从原始注释文件nids到注释文件ids</span></h3><h4 data-tool="mdnice编辑器"><span>2-1直接删除带有///的symbol行，组成ids</span></h4><pre data-tool="mdnice编辑器"><code>colnames(nids)=c(<span>"probe_id"</span>,<span>"symbol"</span>) <span>#改列名，后续代码是批量复制粘贴的，变量名与代码匹配</span><br>head(nids) <span>#看一眼</span><br><br></code></pre><pre data-tool="mdnice编辑器"><code><span>#结果</span><br>&gt; colnames(nids)=c(<span>"probe_id"</span>,<span>"symbol"</span>) <span>#改列名，后续代码是批量复制粘贴的，变量名与代码匹配</span><br>&gt; head(nids) <span>#看一眼</span><br>   probe_id           symbol<br>1 1007_s_at DDR1 /// MIR4640<br>2   1053_at             RFC2<br>3    117_at            HSPA6<br>4    121_at             PAX8<br>5 1255_g_at           GUCA1A<br>6   1294_at MIR5193 /// UBA7<br><br></code></pre><pre data-tool="mdnice编辑器"><code><span>#处理symbol列 11111111111111111111号</span><br>k1 = nids<span>$symbol</span>!=<span>""</span>;table(k1)  <span>#选出非空symbol</span><br>k2 = !str_detect(nids<span>$symbol</span>,<span>"///"</span>);table(k2) <span>#选出不带有///的symbol列</span><br>nids = nids[ k1 &amp; k2,] <span>#二者取并集，获得注释文件</span><br>nids<span>$probe_id</span>=as.character(nids<span>$probe_id</span>)<span>#保险步骤，部分注释编号为纯数字防止其被转化为数值型</span><br>head(nids)<br>ids=nids<br><br></code></pre><pre data-tool="mdnice编辑器"><code><span>#结果</span><br>&gt; <span>#处理symbol列 11111111111111111111号</span><br>&gt; k1 = nids<span>$symbol</span>!=<span>""</span>;table(k1)  <span>#选出非空symbol</span><br>k1<br>FALSE  TRUE <br> 8893 45782 <br>&gt; k2 = !str_detect(nids<span>$symbol</span>,<span>"///"</span>);table(k2) <span>#选出不带有///的symbol列</span><br>k2<br>FALSE  TRUE <br> 2796 51879 <br>&gt; nids = nids[ k1 &amp; k2,] <span>#二者取并集，获得注释文件</span><br>&gt; nids<span>$probe_id</span>=as.character(nids<span>$probe_id</span>)<span>#保险步骤，部分注释编号为纯数字防止其被转化为数值型</span><br>&gt; head(nids)<br>   probe_id symbol<br>2   1053_at   RFC2<br>3    117_at  HSPA6<br>4    121_at   PAX8<br>5 1255_g_at GUCA1A<br>7   1316_at   THRA<br>8   1320_at PTPN21<br><br></code></pre><p data-tool="mdnice编辑器"><strong>ids Get！</strong></p><h4 data-tool="mdnice编辑器"><span>2-2 不删除带有///的行，保留///前的基因symbol组成ids</span></h4><pre data-tool="mdnice编辑器"><code><span>#使用///符号前的全部symbol 222222222222222222222号</span><br><span>if</span> (F){<br>  nids=idmap(gpl_number,<span>'soft'</span>)<span>#重新提取nids</span><br>  head(nids)<br>  colnames(nids)=c(<span>"probe_id"</span>,<span>"symbol"</span>) <span>#改列名，后续代码是批量复制粘贴的，变量名与代码匹配</span><br>  head(nids) <span>#看一眼</span><br>  k2= str_split(nids<span>$symbol</span>,<span>'\\///'</span>,simplify = T) <span>#使用str_split将其分成2列</span><br>  head(k2)<br>  dim(k2)<br>  nids<span>$symbol</span>=k2[,1] <span>#直接取第一列</span><br>  dim(nids)<br>  nids=nids[nids<span>$symbol</span> !=<span>''</span>,] <span>#去除空行</span><br>  dim(nids)<br>  nids<span>$probe_id</span>=as.character(nids<span>$probe_id</span>) <span>#若有数值型会被转化成为字符串型</span><br>  head(nids)<br>  ids=nids <br>  head(ids)<br>  <span>#ids GET</span><br>}<br><br></code></pre><pre data-tool="mdnice编辑器"><code><span>#结果</span><br>&gt; nids=idmap(gpl_number,<span>'soft'</span>)<br>trying URL <span>'http://49.235.27.111/GEOmirror/GPL/GPL570_soft.rda'</span><br>Content <span>type</span> <span>'application/octet-stream'</span> length 295573 bytes (288 KB)<br>==================================================<br>downloaded 288 KB<br><br>file downloaded <span>in</span> /home/data/sbc197/MicroArray/A1/GSE33532<br>&gt;   head(nids)<br>         ID           symbol<br>1 1007_s_at DDR1 /// MIR4640<br>2   1053_at             RFC2<br>3    117_at            HSPA6<br>4    121_at             PAX8<br>5 1255_g_at           GUCA1A<br>6   1294_at MIR5193 /// UBA7<br>&gt; colnames(nids)=c(<span>"probe_id"</span>,<span>"symbol"</span>) <span>#改列名，后续代码是批量复制粘贴的，变量名与代码匹配</span><br>&gt;   head(nids) <span>#看一眼</span><br>   probe_id           symbol<br>1 1007_s_at DDR1 /// MIR4640<br>2   1053_at             RFC2<br>3    117_at            HSPA6<br>4    121_at             PAX8<br>5 1255_g_at           GUCA1A<br>6   1294_at MIR5193 /// UBA7<br>&gt; k2= str_split(nids<span>$symbol</span>,<span>'\\///'</span>,simplify = T) <span>#使用str_split将其分成2列</span><br>&gt;   head(k2)<br>     [,1]       [,2]       [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11] [,12] [,13] [,14] [,15]<br>[1,] <span>"DDR1 "</span>    <span>" MIR4640"</span> <span>""</span>   <span>""</span>   <span>""</span>   <span>""</span>   <span>""</span>   <span>""</span>   <span>""</span>   <span>""</span>    <span>""</span>    <span>""</span>    <span>""</span>    <span>""</span>    <span>""</span>   <br>[2,] <span>"RFC2"</span>     <span>""</span>         <span>""</span>   <span>""</span>   <span>""</span>   <span>""</span>   <span>""</span>   <span>""</span>   <span>""</span>   <span>""</span>    <span>""</span>    <span>""</span>    <span>""</span>    <span>""</span>    <span>""</span>   <br>[3,] <span>"HSPA6"</span>    <span>""</span>         <span>""</span>   <span>""</span>   <span>""</span>   <span>""</span>   <span>""</span>   <span>""</span>   <span>""</span>   <span>""</span>    <span>""</span>    <span>""</span>    <span>""</span>    <span>""</span>    <span>""</span>   <br>[4,] <span>"PAX8"</span>     <span>""</span>         <span>""</span>   <span>""</span>   <span>""</span>   <span>""</span>   <span>""</span>   <span>""</span>   <span>""</span>   <span>""</span>    <span>""</span>    <span>""</span>    <span>""</span>    <span>""</span>    <span>""</span>   <br>[5,] <span>"GUCA1A"</span>   <span>""</span>         <span>""</span>   <span>""</span>   <span>""</span>   <span>""</span>   <span>""</span>   <span>""</span>   <span>""</span>   <span>""</span>    <span>""</span>    <span>""</span>    <span>""</span>    <span>""</span>    <span>""</span>   <br>[6,] <span>"MIR5193 "</span> <span>" UBA7"</span>    <span>""</span>   <span>""</span>   <span>""</span>   <span>""</span>   <span>""</span>   <span>""</span>   <span>""</span>   <span>""</span>    <span>""</span>    <span>""</span>    <span>""</span>    <span>""</span>    <span>""</span>   <br>     [,16] [,17] [,18] [,19] [,20] [,21] [,22]<br>[1,] <span>""</span>    <span>""</span>    <span>""</span>    <span>""</span>    <span>""</span>    <span>""</span>    <span>""</span>   <br>[2,] <span>""</span>    <span>""</span>    <span>""</span>    <span>""</span>    <span>""</span>    <span>""</span>    <span>""</span>   <br>[3,] <span>""</span>    <span>""</span>    <span>""</span>    <span>""</span>    <span>""</span>    <span>""</span>    <span>""</span>   <br>[4,] <span>""</span>    <span>""</span>    <span>""</span>    <span>""</span>    <span>""</span>    <span>""</span>    <span>""</span>   <br>[5,] <span>""</span>    <span>""</span>    <span>""</span>    <span>""</span>    <span>""</span>    <span>""</span>    <span>""</span>   <br>[6,] <span>""</span>    <span>""</span>    <span>""</span>    <span>""</span>    <span>""</span>    <span>""</span>    <span>""</span>   <br>&gt; dim(k2)<br>[1] 54675    22<br>&gt; nids<span>$symbol</span>=k2[,1]<br>&gt; dim(nids)<br>[1] 54675     2<br>&gt; nids=nids[nids<span>$symbol</span> !=<span>''</span>,]<br>&gt; dim(nids)<br>[1] 45782     2<br>&gt; nids<span>$probe_id</span>=as.character(nids<span>$probe_id</span>)<br>&gt;   head(nids)<br>   probe_id   symbol<br>1 1007_s_at    DDR1 <br>2   1053_at     RFC2<br>3    117_at    HSPA6<br>4    121_at     PAX8<br>5 1255_g_at   GUCA1A<br>6   1294_at MIR5193 <br>&gt; ids=nids<br>&gt;   head(ids)<br>   probe_id   symbol<br>1 1007_s_at    DDR1 <br>2   1053_at     RFC2<br>3    117_at    HSPA6<br>4    121_at     PAX8<br>5 1255_g_at   GUCA1A<br>6   1294_at MIR5193 <br>&gt;   <span>#ids GET！</span><br><br></code></pre><p data-tool="mdnice编辑器"><strong>ids Get！</strong></p><h4 data-tool="mdnice编辑器"><span>2-3 不删除带有///的行，如有///，保留///后的第一个基因symbol组成ids</span></h4><pre data-tool="mdnice编辑器"><code>  <span>#若///后有symbol，那就使用///后的第一个symbol 333333333333333333333333号</span><br>  <span>if</span> (F){<br>  nids=idmap(gpl_number,<span>'soft'</span>)<br>  head(nids)<br>  dim(nids)<br>  table(nids<span>$symbol</span> == <span>''</span>) <br>  nids=nids[nids<span>$symbol</span> !=<span>''</span>,]<br>  dim(nids) <span>#数值对上说明symbol为空的行已经全部去掉</span><br>  k2= str_split(nids<span>$symbol</span>,<span>'\\///'</span>,simplify = T) <span>#使用str_split将其分成2列，可能因为空格也被算成一列了</span><br>  head(k2)<br>  dim(k2)<br>  k2=k2[,1:2]<span>#取前2列</span><br>  head(k2)<br>  nk2=vector(length = length(k2[,1])) <span>#创建与k2等长的空向量</span><br>  <span>for</span> (i <span>in</span> 1:length(k2[,1])){<br>    <span>if</span> (k2[i,2] == <span>""</span> ) {nk2[i] = k2[i,1]<br>    }<span>else</span>{ <br>      nk2[i] = k2[i,2]<br>    }}<br>  nids<span>$symbol</span>=nk2<br>  colnames(nids)=c(<span>"probe_id"</span>,<span>"symbol"</span>)<br>  head(nids)<br>  ids=nids<br>  <span>#ids GET！</span><br>  }<br><br><br></code></pre><pre data-tool="mdnice编辑器"><code><span>#运行结果</span><br>&gt; nids=idmap(gpl_number,<span>'soft'</span>)<br>trying URL <span>'http://49.235.27.111/GEOmirror/GPL/GPL570_soft.rda'</span><br>Content <span>type</span> <span>'application/octet-stream'</span> length 295573 bytes (288 KB)<br>==================================================<br>downloaded 288 KB<br><br>file downloaded <span>in</span> /home/data/sbc197/MicroArray/A1/GSE33532<br>&gt;   head(nids)<br>         ID           symbol<br>1 1007_s_at DDR1 /// MIR4640<br>2   1053_at             RFC2<br>3    117_at            HSPA6<br>4    121_at             PAX8<br>5 1255_g_at           GUCA1A<br>6   1294_at MIR5193 /// UBA7<br>&gt; dim(nids)<br>[1] 54675     2<br>&gt; table(nids<span>$symbol</span> == <span>''</span>) <br>FALSE  TRUE <br>45782  8893 <br>&gt; nids=nids[nids<span>$symbol</span> !=<span>''</span>,]<br>&gt; dim(nids) <span>#数值对上说明symbol为空的行已经全部去掉</span><br>[1] 45782     2<br>&gt; k2= str_split(nids<span>$symbol</span>,<span>'\\///'</span>,simplify = T) <span>#使用str_split将其分成2列，因为空格也被算成一列了</span><br>&gt;   head(k2)<br>     [,1]       [,2]       [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11] [,12] [,13] [,14] [,15]<br>[1,] <span>"DDR1 "</span>    <span>" MIR4640"</span> <span>""</span>   <span>""</span>   <span>""</span>   <span>""</span>   <span>""</span>   <span>""</span>   <span>""</span>   <span>""</span>    <span>""</span>    <span>""</span>    <span>""</span>    <span>""</span>    <span>""</span>   <br>[2,] <span>"RFC2"</span>     <span>""</span>         <span>""</span>   <span>""</span>   <span>""</span>   <span>""</span>   <span>""</span>   <span>""</span>   <span>""</span>   <span>""</span>    <span>""</span>    <span>""</span>    <span>""</span>    <span>""</span>    <span>""</span>   <br>[3,] <span>"HSPA6"</span>    <span>""</span>         <span>""</span>   <span>""</span>   <span>""</span>   <span>""</span>   <span>""</span>   <span>""</span>   <span>""</span>   <span>""</span>    <span>""</span>    <span>""</span>    <span>""</span>    <span>""</span>    <span>""</span>   <br>[4,] <span>"PAX8"</span>     <span>""</span>         <span>""</span>   <span>""</span>   <span>""</span>   <span>""</span>   <span>""</span>   <span>""</span>   <span>""</span>   <span>""</span>    <span>""</span>    <span>""</span>    <span>""</span>    <span>""</span>    <span>""</span>   <br>[5,] <span>"GUCA1A"</span>   <span>""</span>         <span>""</span>   <span>""</span>   <span>""</span>   <span>""</span>   <span>""</span>   <span>""</span>   <span>""</span>   <span>""</span>    <span>""</span>    <span>""</span>    <span>""</span>    <span>""</span>    <span>""</span>   <br>[6,] <span>"MIR5193 "</span> <span>" UBA7"</span>    <span>""</span>   <span>""</span>   <span>""</span>   <span>""</span>   <span>""</span>   <span>""</span>   <span>""</span>   <span>""</span>    <span>""</span>    <span>""</span>    <span>""</span>    <span>""</span>    <span>""</span>   <br>     [,16] [,17] [,18] [,19] [,20] [,21] [,22]<br>[1,] <span>""</span>    <span>""</span>    <span>""</span>    <span>""</span>    <span>""</span>    <span>""</span>    <span>""</span>   <br>[2,] <span>""</span>    <span>""</span>    <span>""</span>    <span>""</span>    <span>""</span>    <span>""</span>    <span>""</span>   <br>[3,] <span>""</span>    <span>""</span>    <span>""</span>    <span>""</span>    <span>""</span>    <span>""</span>    <span>""</span>   <br>[4,] <span>""</span>    <span>""</span>    <span>""</span>    <span>""</span>    <span>""</span>    <span>""</span>    <span>""</span>   <br>[5,] <span>""</span>    <span>""</span>    <span>""</span>    <span>""</span>    <span>""</span>    <span>""</span>    <span>""</span>   <br>[6,] <span>""</span>    <span>""</span>    <span>""</span>    <span>""</span>    <span>""</span>    <span>""</span>    <span>""</span>   <br>&gt; dim(k2)<br>[1] 45782    22<br>&gt; k2=k2[,1:2]<span>#取前2列</span><br>&gt;   head(k2)<br>     [,1]       [,2]      <br>[1,] <span>"DDR1 "</span>    <span>" MIR4640"</span><br>[2,] <span>"RFC2"</span>     <span>""</span>        <br>[3,] <span>"HSPA6"</span>    <span>""</span>        <br>[4,] <span>"PAX8"</span>     <span>""</span>        <br>[5,] <span>"GUCA1A"</span>   <span>""</span>        <br>[6,] <span>"MIR5193 "</span> <span>" UBA7"</span>   <br>&gt; nk2=vector(length = length(k2[,1])) <span>#创建与k2等长的空向量</span><br>&gt; <span>for</span> (i <span>in</span> 1:length(k2[,1])){<br>+ <span>if</span> (k2[i,2] == <span>""</span> ) {nk2[i] = k2[i,1]<br>+ }<span>else</span>{ <br>+ nk2[i] = k2[i,2]<br>+ }}<br>&gt; nids<span>$symbol</span>=nk2<br>&gt; colnames(nids)=c(<span>"probe_id"</span>,<span>"symbol"</span>)<br>&gt;   head(nids)<br>   probe_id   symbol<br>1 1007_s_at  MIR4640<br>2   1053_at     RFC2<br>3    117_at    HSPA6<br>4    121_at     PAX8<br>5 1255_g_at   GUCA1A<br>6   1294_at     UBA7<br>&gt; ids=nids<br>&gt;   <span>#ids GET！</span><br><br></code></pre><p data-tool="mdnice编辑器"><strong>ids Get！</strong>综上，我们已经获得了exp、Group&amp; ids</p><h1 data-tool="mdnice编辑器"><span>3 使用ids注释表达exp</span></h1><p data-tool="mdnice编辑器">我在这里使用策略1获得的ids进行注释。带有///也就2K多，去掉就去掉吧，在5W基因面前不算多。开始前先看一下文件格式~<img data-ratio="0.4896694214876033" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los980mOE09sibQ0nIUcuooN1LKibKZEWrtdq7EVNQuZ2vyCibsWE2ZOvz1hOx6DmekOib5GJHIpA8zXhJA/640?wx_fmt=png" data-type="png" data-w="968" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los980mOE09sibQ0nIUcuooN1LKibKZEWrtdq7EVNQuZ2vyCibsWE2ZOvz1hOx6DmekOib5GJHIpA8zXhJA/640?wx_fmt=png">目前获得的表达矩阵exp<img data-ratio="0.5346232179226069" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los980mOE09sibQ0nIUcuooN1LZ8vwr02Ejb3JL1Aym67ZSeg2qzuZEYRajNQ2XIFnHsSVLydZ33DhuA/640?wx_fmt=png" data-type="png" data-w="982" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los980mOE09sibQ0nIUcuooN1LZ8vwr02Ejb3JL1Aym67ZSeg2qzuZEYRajNQ2XIFnHsSVLydZ33DhuA/640?wx_fmt=png">目前获得的注释文件ids说白了就是要根据probe_id把exp的行名换成基因名symbol。那么，开始吧。</p><pre data-tool="mdnice编辑器"><code>dat=exp <span>#为保证exp数据类型不变，先做个备份dat</span><br>probe_id=rownames(dat) <span>#取exp的行名，命名为"probe_id"</span><br>dat=cbind(probe_id,dat) <span>#把行名加在exp的最前面</span><br>dat[1:4,1:4] <br><br></code></pre><pre data-tool="mdnice编辑器"><code><span>#结果  若数值两边出现""说明格式不对，不能运行后续步骤</span><br>&gt; dat[1:4,1:4]<br>          probe_id    GSM835268     GSM835269     GSM835270    <br>1007_s_at <span>"1007_s_at"</span> <span>"9.872989252"</span> <span>"10.43456219"</span> <span>"10.09393094"</span><br>1053_at   <span>"1053_at"</span>   <span>"6.648595101"</span> <span>"6.773601028"</span> <span>"6.643051133"</span><br>121_at    <span>"121_at"</span>    <span>"7.185752337"</span> <span>"6.980179687"</span> <span>"7.153527467"</span><br>1255_g_at <span>"1255_g_at"</span> <span>"4.117640898"</span> <span>"4.318898976"</span> <span>"3.796969751"</span><br><br></code></pre><pre data-tool="mdnice编辑器"><code><span>#使用merge函数匹配exp和ids</span><br>dat=merge(ids,dat,by=<span>"probe_id"</span>)  <br>dat=dat[!duplicated(dat<span>$symbol</span>),] <span>#去重复</span><br>dat[1:4,1:4]<br><br></code></pre><pre data-tool="mdnice编辑器"><code><span>#结果</span><br>&gt; dat=merge(ids,dat,by=<span>"probe_id"</span>)<br>&gt; dat=dat[!duplicated(dat<span>$symbol</span>),]<br>&gt; dat[1:4,1:4]<br>   probe_id symbol   GSM835268   GSM835269<br>1   1053_at   RFC2 6.648595101 6.773601028<br>2    121_at   PAX8 7.185752337 6.980179687<br>3 1255_g_at GUCA1A 4.117640898 4.318898976<br>4   1316_at   THRA 5.255939827 4.946494604<br><br></code></pre><pre data-tool="mdnice编辑器"><code><span>#获得完成注释的表达矩阵，以下步骤相当于利用dat的顺序对exp的信息进行提取</span><br><span>#但不影响exp的数据类型</span><br>exp = exp[dat<span>$probe_id</span>,]<br>rownames(exp) = dat<span>$symbol</span><br>exp[1:4,1:4]<br>pheatmap::pheatmap(exp[1:4,1:8]) <span>#检查数据格式画个热图</span><br><br></code></pre><pre data-tool="mdnice编辑器"><code><span>#结果</span><br>&gt; exp[1:4,1:4]<br>       GSM835268 GSM835269 GSM835270 GSM835271<br>RFC2    6.648595  6.773601  6.643051  6.854348<br>PAX8    7.185752  6.980180  7.153527  7.199128<br>GUCA1A  4.117641  4.318899  3.796970  4.030910<br>THRA    5.255940  4.946495  5.527133  5.217120<br><br></code></pre><p data-tool="mdnice编辑器"><img data-ratio="0.5813186813186814" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los980mOE09sibQ0nIUcuooN1LMbugrrz5LhiaDW9Upjn0ibiaoVVAxicvwet5yFZvBdZn186NnFEtFz2Esg/640?wx_fmt=png" data-type="png" data-w="910" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los980mOE09sibQ0nIUcuooN1LMbugrrz5LhiaDW9Upjn0ibiaoVVAxicvwet5yFZvBdZn186NnFEtFz2Esg/640?wx_fmt=png">数据格式ok！<strong>注释后表达矩阵exp GET！</strong></p><h1 data-tool="mdnice编辑器"><span>4 数据检查</span></h1><pre data-tool="mdnice编辑器"><code><span>#是否需要取log</span><br>exp[1:4,1:4]<br>range(exp)<br><br></code></pre><pre data-tool="mdnice编辑器"><code><span>#结果</span><br>&gt; <span>#是否需要取log</span><br>&gt; exp[1:4,1:4]<br>       GSM835268 GSM835269 GSM835270 GSM835271<br>RFC2    6.648595  6.773601  6.643051  6.854348<br>PAX8    7.185752  6.980180  7.153527  7.199128<br>GUCA1A  4.117641  4.318899  3.796970  4.030910<br>THRA    5.255940  4.946495  5.527133  5.217120<br>&gt; range(exp) <br>[1]  1.809565 13.648949<br><br></code></pre><p data-tool="mdnice编辑器">20以内，不需要取。</p><pre data-tool="mdnice编辑器"><code><span>#标准校准套餐</span><br>  exp=normalizeBetweenArrays(exp)<br>  boxplot(exp[,1:4],las=2)<br><br></code></pre><p data-tool="mdnice编辑器"><img data-ratio="0.5291529152915292" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los980mOE09sibQ0nIUcuooN1Le2vJgibEicNnvuq80KVHuaHvx5pRIKNtqcNkYTicVO4PtsE0TPsGYq8kA/640?wx_fmt=png" data-type="png" data-w="909" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los980mOE09sibQ0nIUcuooN1Le2vJgibEicNnvuq80KVHuaHvx5pRIKNtqcNkYTicVO4PtsE0TPsGYq8kA/640?wx_fmt=png">校准完成。</p><h1 data-tool="mdnice编辑器"><span>5 简单做一个差异分析</span></h1><pre data-tool="mdnice编辑器"><code>design &lt;- model.matrix(~Group)<br>fit &lt;- lmFit(exp,design)<br>fit &lt;- eBayes(fit,trend=TRUE,robust=TRUE)<br>summary(decideTests(fit))<br><span>#绘制差异基因箱线图</span><br>deg = topTable(fit,coef=2)<br>boxplot(exp[rownames(deg)[1],]~Group)<br><br></code></pre><pre data-tool="mdnice编辑器"><code><span>#分析结果：能看到上调、下调基因的数量</span><br>&gt; summary(decideTests(fit))<br>       (Intercept) Grouptumor<br>Down             0       4189<br>NotSig           0       4276<br>Up           13908       5443<br><br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.5183129855715871" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los980mOE09sibQ0nIUcuooN1LyR8o7Wz7WzlLUhNPIhvqsxZsKJtTh3JGWUgDC9pmVT1anyIosriaeVw/640?wx_fmt=png" data-type="png" data-w="901" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los980mOE09sibQ0nIUcuooN1LyR8o7Wz7WzlLUhNPIhvqsxZsKJtTh3JGWUgDC9pmVT1anyIosriaeVw/640?wx_fmt=png"><figcaption>image.png</figcaption></figure><h1 data-tool="mdnice编辑器"><span>6 数据保存</span></h1><p data-tool="mdnice编辑器">在上面的操作中，因为基因注释已经完成了，现在也不需要注释文件ids了。在后续的差异和聚类分析中，只需要<strong>分组信息Group</strong>,<strong>注释好的表达矩阵exp</strong>就可。两者目前的格式如下：<img data-ratio="0.2583518930957684" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los980mOE09sibQ0nIUcuooN1LI3PZRq6IgaT5iby3rscPQL0hiakoAMzrbic1bppkmmaszqcgLR5Nzfvkw/640?wx_fmt=png" data-type="png" data-w="898" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los980mOE09sibQ0nIUcuooN1LI3PZRq6IgaT5iby3rscPQL0hiakoAMzrbic1bppkmmaszqcgLR5Nzfvkw/640?wx_fmt=png">Group的格式<img data-ratio="0.6038114343029087" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los980mOE09sibQ0nIUcuooN1Lia0TBghicU7sbyBOXx0x68PmJxgcdrjGCBUgnqZmaAzFBTwovmfguw3Q/640?wx_fmt=png" data-type="png" data-w="997" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los980mOE09sibQ0nIUcuooN1Lia0TBghicU7sbyBOXx0x68PmJxgcdrjGCBUgnqZmaAzFBTwovmfguw3Q/640?wx_fmt=png">exp的格式</p><pre data-tool="mdnice编辑器"><code><span>#保存一下这次分析相关的数据</span><br>save(gse_number,gpl_number,Group,exp,file = <span>"step1_exp_multi_gpl.Rdata"</span>)<br><br></code></pre><h1 data-tool="mdnice编辑器"><span>7 代码整合</span></h1><pre data-tool="mdnice编辑器"><code><span>#先加载一堆包</span><br>rm(list=ls())<br>options(stringsAsFactors=F)<br>library(limma)<br>library(GEOquery)<br>library(GenomicFeatures)<br>library(methylumi)<br>library(lumi)<br>library(dplyr)<br>library(stringr)<br>library(idmap1)<br>library(stringr)<br>library(AnnoProbe)<br><br><span>#芯片信息，通过GSE号查询NCBI就可以知道GPL号</span><br>gse_number = <span>"GSE33532"</span><br>gpl_number = <span>"GPL570"</span><br>file_name=paste0(gse_number,<span>'_series_matrix.txt.gz'</span>) <span>#懒得每次都改文件名了</span><br><br><span>#获取GSE33532的数据集</span><br>eSet = getGEO(filename=file_name,getGPL = F)<br><br><span>#从数据集提取表达矩阵</span><br>exp=eSet@assayData<span>$exprs</span> <br>exp[1:4,1:4] <span>#看一眼提取的表达矩阵</span><br>dim(exp) <span>#确认一下行列数</span><br><br>pd=eSet@phenoData@data <span>#提取表观数据总表格</span><br>table(pd<span>$title</span>) <span>#查看列名方便复制粘贴</span><br>Group=ifelse(grepl(<span>'normal'</span>,pd<span>$title</span>),<span>'control'</span>,<span>'tumor'</span>) <span>#使用normal为关键词进行分组</span><br>table(Group) <span>#查看一下分组对不对，应该control 20，tumor 80</span><br>Group = factor(Group,levels = c(<span>"control"</span>,<span>"tumor"</span>)) <span>#分组因子化</span><br>Group <br><br><span>#不library了，开始的时候已经library了</span><br>nids=idmap(gpl_number,<span>'soft'</span>)<br>head(nids) <span>#看一眼长啥样</span><br><br>colnames(nids)=c(<span>"probe_id"</span>,<span>"symbol"</span>) <span>#改列名，后续代码是批量复制粘贴的，变量名与代码匹配</span><br>head(nids) <span>#看一眼</span><br><br><span>#处理symbol列 11111111111111111111号</span><br>k1 = nids<span>$symbol</span>!=<span>""</span>;table(k1)  <span>#选出非空symbol</span><br>k2 = !str_detect(nids<span>$symbol</span>,<span>"///"</span>);table(k2) <span>#选出不带有///的symbol列</span><br>nids = nids[ k1 &amp; k2,] <span>#二者取并集，获得注释文件</span><br>nids<span>$probe_id</span>=as.character(nids<span>$probe_id</span>)<span>#保险步骤，部分注释编号为纯数字防止其被转化为数值型</span><br>head(nids)<br>ids=nids<br>head(ids)<br><span>#使用///符号前的全部symbol 222222222222222222222号</span><br><span>if</span> (F){<br>  nids=idmap(gpl_number,<span>'soft'</span>)<br>  head(nids)<br>  colnames(nids)=c(<span>"probe_id"</span>,<span>"symbol"</span>) <span>#改列名，后续代码是批量复制粘贴的，变量名与代码匹配</span><br>  head(nids) <span>#看一眼</span><br>  k2= str_split(nids<span>$symbol</span>,<span>'\\///'</span>,simplify = T) <span>#使用str_split将其分成2列</span><br>  head(k2)<br>  dim(k2)<br>  nids<span>$symbol</span>=k2[,1]<br>  dim(nids)<br>  nids=nids[nids<span>$symbol</span> !=<span>''</span>,]<br>  dim(nids)<br>  nids<span>$probe_id</span>=as.character(nids<span>$probe_id</span>)<br>  head(nids)<br>  ids=nids<br>  head(ids)<br>  <span>#ids GET！</span><br>}<br><br><span>#若///后有symbol，那就使用///后的第一个symbol 333333333333333333333333号</span><br><span>if</span> (F){<br>  nids=idmap(gpl_number,<span>'soft'</span>)<br>  head(nids)<br>  dim(nids)<br>  table(nids<span>$symbol</span> == <span>''</span>) <br>  nids=nids[nids<span>$symbol</span> !=<span>''</span>,]<br>  dim(nids) <span>#数值对上说明symbol为空的行已经全部去掉</span><br>  k2= str_split(nids<span>$symbol</span>,<span>'\\///'</span>,simplify = T) <span>#使用str_split将其分成2列，可能因为空格也被算成一列了</span><br>  head(k2)<br>  dim(k2)<br>  k2=k2[,1:2]<span>#取前2列</span><br>  head(k2)<br>  nk2=vector(length = length(k2[,1])) <span>#创建与k2等长的空向量</span><br>  <span>for</span> (i <span>in</span> 1:length(k2[,1])){<br>    <span>if</span> (k2[i,2] == <span>""</span> ) {nk2[i] = k2[i,1]<br>    }<span>else</span>{ <br>      nk2[i] = k2[i,2]<br>    }}<br>  nids<span>$symbol</span>=nk2<br>  colnames(nids)=c(<span>"probe_id"</span>,<span>"symbol"</span>)<br>  head(nids)<br>  ids=nids<br>  <span>#ids GET！</span><br>}<br><br><span>##注释表达矩阵---</span><br>dat=exp<br>probe_id=rownames(dat)<br><span>#dat=as.data.frame(dat)</span><br>dat=cbind(probe_id,dat)<br>dat[1:4,1:4]<br>dat=merge(ids,dat,by=<span>"probe_id"</span>)<br>dat=dat[!duplicated(dat<span>$symbol</span>),]<br>dat[1:4,1:4]<br><br><span>#rownames(dat)=dat$symbol</span><br><span>#dat[1:4,1:4]</span><br><span>##获得完成注释的表达矩阵</span><br><span>#以下步骤相当于用外力干扰exp的排序，但不会影响它的数据类型</span><br>exp = exp[dat<span>$probe_id</span>,]<br>rownames(exp) = dat<span>$symbol</span><br>exp[1:4,1:4]<br>pheatmap::pheatmap(exp[1:4,1:8])<br><span>##exp571数据检查</span><br><span>#是否需要取log</span><br>exp[1:4,1:4]<br>range(exp) <br><span>if</span> (F) {<br>  exp=log2(exp)<br>  range(exp)<br>}<br>boxplot(exp[,1:4],las=2) <span>#不调节</span><br><span>if</span> (F) {<br>  library(limma)<br>  exp=normalizeBetweenArrays(exp)<br>  boxplot(exp[,1:4],las=2)<br>}<br><br>design &lt;- model.matrix(~Group)<br>fit &lt;- lmFit(exp,design)<br>fit &lt;- eBayes(fit,trend=TRUE,robust=TRUE)<br>summary(decideTests(fit))<br><br><br><span>#绘制差异基因箱线图</span><br><span>#deg = topTable(fit,coef=2,n=dim(y)[1])</span><br>deg = topTable(fit,coef=2)<br>boxplot(exp[rownames(deg)[1],]~Group)<br><br><span>#保存一下这次分析相关的数据</span><br>save(gse_number,gpl_number,Group,exp,file = <span>"step1_exp_multi_gpl.Rdata"</span>)<br><br></code></pre><h1 data-tool="mdnice编辑器"><span>8 致谢</span></h1><p data-tool="mdnice编辑器">再次感谢曾老师和小洁老师在代码上帮助，也再次感谢生信技能树的小伙伴也回答了我很多入门级的问题。参考的主要是生信技能树马拉松入门班的代码。</p><p data-tool="mdnice编辑器">这篇就不Mark了，整体非常常规。</p></section><p><br></p><p><mp-style-type data-value="10000"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/v374wBsWAM7Itbqab8A5rg",target="_blank" rel="noopener noreferrer">原文链接</a>
