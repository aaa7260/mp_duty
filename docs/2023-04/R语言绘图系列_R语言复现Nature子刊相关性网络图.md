---
title: "R语言绘图系列|R语言复现Nature子刊相关性网络图"
date: 2023-04-26T08:11:42Z
draft: ["false"]
tags: [
  "fetched",
  "科研生信充电宝"
]
categories: ["Acdemic"]
---
R语言绘图系列|R语言复现Nature子刊相关性网络图 by 科研生信充电宝
------
<div><section><section powered-by="xiumi.us"><section><p><strong>R语言绘图系列</strong></p></section></section><section powered-by="xiumi.us"><section><p>R</p></section></section><section powered-by="xiumi.us"><section><p><strong>R语言复现</strong></p><p><strong>Nature子刊相关性网络图</strong><br></p></section></section><section powered-by="xiumi.us"><p>- 04·25-</p></section><section powered-by="xiumi.us"><section><p>宜分享</p></section></section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><p><strong>Nature子刊</strong><strong>相关性网络图</strong></p></section></section></section><section powered-by="xiumi.us"><section><p><span>Brief Introduction</span><br></p></section></section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><p><strong>01</strong></p></section></section></section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><p><strong>原图：</strong></p></section></section></section></section><section powered-by="xiumi.us"><section><img data-ratio="0.5157407407407407" data-src="https://mmbiz.qpic.cn/mmbiz_png/hN03ibG0t2HvnBiawLvmYzRYaDkJUnaIyMx1wlvktibZhKxmRosSXcic3RUVAWRA5iaWwnu2pmSuoltyqfGlf1haRKQ/640?wx_fmt=png" data-w="1080" width="100%" src="https://mmbiz.qpic.cn/mmbiz_png/hN03ibG0t2HvnBiawLvmYzRYaDkJUnaIyMx1wlvktibZhKxmRosSXcic3RUVAWRA5iaWwnu2pmSuoltyqfGlf1haRKQ/640?wx_fmt=png"></section></section><section powered-by="xiumi.us"><section><img data-ratio="0.5448460508701473" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/hN03ibG0t2HvnBiawLvmYzRYaDkJUnaIyMeSAYBbibAwiaD6uDictfkcfkakU6kicwgFCH34uNUtGt45THgsuLvQtKgA/640?wx_fmt=jpeg" data-w="747" width="100%" src="https://mmbiz.qpic.cn/mmbiz_jpg/hN03ibG0t2HvnBiawLvmYzRYaDkJUnaIyMeSAYBbibAwiaD6uDictfkcfkakU6kicwgFCH34uNUtGt45THgsuLvQtKgA/640?wx_fmt=jpeg"></section></section><section powered-by="xiumi.us"><p><strong>Figure1. 欧洲血统中14种自身免疫性疾病的遗传相关性。</strong></p><p>左图显示了14种自身免疫性疾病的遗传相关性。使用跨性状LDSC估计遗传相关性。正方形的颜色强度和大小与遗传相关性的强度成正比（棕色=负相关，绿色=正相关）。星号表示在错误发现率水平 0.05 时具有统计显著性的遗传相关性。红框突出显示了系统性红斑狼疮与其他性状之间的相关性。</p><p><strong>右图说明了显著遗传相关性状的网络。</strong>线条的颜色表示使用 LDSC 的遗传相关性估计的大小。线的宽度表示统计显著性。疾病名称缩写：AN = 强直性脊柱炎，ATD = 自身免疫性甲状腺疾病，CD = 克罗恩病，CEL = 乳糜泻，MS = 多发性硬化症，PBC = 原发性胆汁性肝硬化，PSOA = 银屑病关节炎，RA = 类风湿性关节炎，SJO = 干燥综合征，SLE = 系统性红斑狼疮，SSC = 系统性硬化症，T1D = 1 型糖尿病，UC = 溃疡性结肠炎，VIT = 白癜风。</p><p><br></p><p><strong>接下来，我们就来复刻下右边这张图吧~</strong></p><p><br></p></section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><p><strong>02</strong></p></section></section></section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><p><strong>R实例：</strong><strong>Nature子刊</strong><strong>相关性网络图</strong></p></section></section></section></section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><svg viewbox="0 0 1 1"></svg></section></section></section><section><section powered-by="xiumi.us"><section><p><strong>① 导入包：</strong></p></section></section><section powered-by="xiumi.us"><section><svg viewbox="0 0 1 1"></svg></section></section></section></section><section><ul><li><li><li><li><li></ul><pre data-lang="python"><code><span>library(tidyverse)</span></code><code><span>library(ggplot2)</span></code><code><span>library(igraph)</span></code><code><span>library(ggraph)</span></code><code><span>library(RColorBrewer)</span></code></pre></section><p powered-by="xiumi.us"><br></p><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><svg viewbox="0 0 1 1"></svg></section></section></section><section><section powered-by="xiumi.us"><section><p><strong>② 构造数据集：</strong></p></section></section><section powered-by="xiumi.us"><section><svg viewbox="0 0 1 1"></svg></section></section></section></section><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="python"><code><span><span>set</span>.seed(<span>10</span>)</span></code><code><span>vertices = data.frame(name=LETTERS[<span>1</span>:<span>12</span>])</span></code><code><span>edges = <span>as</span>.data.frame(t(combn(LETTERS[<span>1</span>:<span>12</span>],<span>2</span>)))</span></code><code><span>edges = edges[sample(<span>1</span>:nrow(edges),<span>30</span>),]</span></code><code><span>colnames(edges)&lt;- c(<span>"from"</span>,<span>"to"</span>)</span></code><code><span>edges$weight = c(sample(<span>1</span>:<span>2</span>,nrow(edges)-<span>5</span>,replace = T),</span></code><code><span>                 sample(<span>4</span>:<span>5</span>,<span>5</span>,replace=T))</span></code><code><span><br></span></code><code><span><span># 计算degree</span></span></code><code><span>counts = count(data.frame(v = c(edges$<span>from</span>,edges$to)),v)$n</span></code><code><span>vertices = mutate(vertices, degree = counts,<span><span>class</span> = <span>c</span>(<span><span>2</span>,rep(<span><span>1</span>,<span>11</span></span>)</span>))</span></span></code><code><span><br></span></code><code><span><span>head</span>(<span>vertices</span>)</span></code><code><span><span>head</span>(<span>edges</span>)</span></code></pre></section><section powered-by="xiumi.us"><section><img data-ratio="1.3310810810810811" data-w="296" data-src="https://mmbiz.qpic.cn/mmbiz_png/hN03ibG0t2HvnBiawLvmYzRYaDkJUnaIyMpfWq7A8lqNxrgKwtfzcO9eFiaCQsDIm1hUD9SpQh6tvAnBYBiaXjWmvw/640?wx_fmt=png" width="100%" src="https://mmbiz.qpic.cn/mmbiz_png/hN03ibG0t2HvnBiawLvmYzRYaDkJUnaIyMpfWq7A8lqNxrgKwtfzcO9eFiaCQsDIm1hUD9SpQh6tvAnBYBiaXjWmvw/640?wx_fmt=png"></section></section><p powered-by="xiumi.us"><br></p><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><svg viewbox="0 0 1 1"></svg></section></section></section><section><section powered-by="xiumi.us"><section><p><strong>③ 构建graph，指定颜色：</strong></p></section></section><section powered-by="xiumi.us"><section><svg viewbox="0 0 1 1"></svg></section></section></section></section><section><ul><li><li><li><li><li></ul><pre data-lang="python"><code><span>mygraph &lt;- graph_from_data_frame(d=edges,</span></code><code><span>                                 vertices=vertices,directed=F)</span></code><code><span><br></span></code><code><span>edges_color&lt;- brewer.pal(<span>11</span>,<span>"BrBG"</span>)[<span>7</span>:<span>11</span>]</span></code><code><span>node_color &lt;- c(<span>"#476DA1"</span>,<span>"#AB3A2A"</span>)</span></code></pre></section><p powered-by="xiumi.us"><br></p><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><svg viewbox="0 0 1 1"></svg></section></section></section><section><section powered-by="xiumi.us"><section><p><strong>④ 绘制相关性网络图：</strong></p></section></section><section powered-by="xiumi.us"><section><svg viewbox="0 0 1 1"></svg></section></section></section></section><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="python"><code><span>ggraph(mygraph,<span>"linear"</span>, circular = T) +</span></code><code><span>  geom_edge_arc0(mapping = aes(width = weight,color = <span>as</span>.factor(weight))) +</span></code><code><span>  geom_node_point(aes(size=degree, fill=factor(<span><span>class</span>)),<span>shape</span>= 21, <span>color</span>='<span>black</span>')+</span></span></code><code><span>  <span>geom_node_text</span>(<span>aes(<span>label=name, size = weight</span>),</span></span></code><code><span><span>                 color =<span>"white"</span>, angle=<span>0</span>,hjust=<span>0.5</span>,size=<span>4</span></span>) +</span></code><code><span>  <span>scale_edge_width</span>(<span><span>range</span> = c(<span><span>1</span>,<span>5</span></span>),</span></span></code><code><span>                   guide = guide_legend(<span>title = <span>"Wight"</span>,</span></span></code><code><span><span>                                        order=<span>1</span></span>))+</span></code><code><span>  <span>scale_size</span>(<span>breaks = seq(<span><span>1</span>, <span>max</span>(<span>vertices$degree</span>),<span>3</span></span>),</span></span></code><code><span>             label = seq(<span><span>1</span>,<span>max</span>(<span>vertices$degree</span>),<span>3</span></span>),</span></code><code><span>             <span>range</span> = c(<span><span>8</span>,<span>15</span></span>),</span></code><code><span><span>             guide = guide_legend(<span>title =<span>"Degree"</span>,order = <span>2</span></span>)</span>) +</span></code><code><span>  <span>scale_fill_manual</span>(<span>values = node_color, guide = <span>"none"</span></span>) +</span></code><code><span>  <span>scale_edge_colour_manual</span>(<span>values = edges_color,guide =<span>"none"</span></span>) +</span></code><code><span>  <span>theme_void</span>( )+</span></code><code><span>  <span>theme</span>(<span>legend.title = element_text(<span>size=<span>18</span></span>),</span></span></code><code><span>        legend.direction =<span>"vertical"</span>,</span></code><code><span>        legend.box =<span>"horizontal"</span>,</span></code><code><span>        legend.position =<span>"right"</span>,</span></code><code><span>        legend.justification=<span>"bottom"</span>)</span></code></pre></section><section powered-by="xiumi.us"><section><img data-ratio="0.8490740740740741" data-w="1080" data-src="https://mmbiz.qpic.cn/mmbiz_png/hN03ibG0t2HvnBiawLvmYzRYaDkJUnaIyMGZgzGJcc9BXHrkWP1LDqzXAPUjDwJAZZBdwhicpopJ49RVtfEiaFUm8A/640?wx_fmt=png" width="100%" src="https://mmbiz.qpic.cn/mmbiz_png/hN03ibG0t2HvnBiawLvmYzRYaDkJUnaIyMGZgzGJcc9BXHrkWP1LDqzXAPUjDwJAZZBdwhicpopJ49RVtfEiaFUm8A/640?wx_fmt=png"></section></section><p powered-by="xiumi.us"><br></p><p powered-by="xiumi.us"><strong>现在：</strong></p><section powered-by="xiumi.us"><p><br></p><p>长按扫码关注：<strong>科研生信充电宝</strong></p></section><section powered-by="xiumi.us"><section><img data-ratio="1" data-w="258" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/hN03ibG0t2HvnBiawLvmYzRYaDkJUnaIyMR9TAEibq3C82R4ZrNLAiaeI3MpozvB7gicwvOKN523KHOqUbDjPfV75Fg/640?wx_fmt=jpeg" width="100%" src="https://mmbiz.qpic.cn/mmbiz_jpg/hN03ibG0t2HvnBiawLvmYzRYaDkJUnaIyMR9TAEibq3C82R4ZrNLAiaeI3MpozvB7gicwvOKN523KHOqUbDjPfV75Fg/640?wx_fmt=jpeg"></section></section><section powered-by="xiumi.us"><p><strong><span>10元赞赏本文，即喜欢作者~</span></strong></p><p><strong><span><br></span></strong></p><p><strong><span>即可直接解锁：</span></strong></p><p><br></p><p><span><strong>《R语言复现Nature子刊相关性网络图》全套</strong></span><strong><span>代码和源文件</span></strong></p><p><br></p><p><span>看到这里你还不心动吗？</span><br></p><p><span><br></span></p><p><span>赶紧关注、转发、点赞、分享，领取你的专属福利吧~</span></p></section><section powered-by="xiumi.us"><p><br></p><p><br></p><p>好啦，以上就是今天推文的全部内容啦！<br></p><p><br></p><p><br></p></section><section powered-by="xiumi.us"><p>今天的分享就到这里啦~<br></p><p><br></p><p><span><strong>另外，本公众号建立了R语言和Python学习分享群，联系后台，拉您入群。</strong></span></p><p><span><strong><br></strong></span></p></section><p powered-by="xiumi.us">或直接添加小编，拉您入群：</p><section powered-by="xiumi.us"><section><img data-ratio="1.3642105263157895" data-w="950" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/hN03ibG0t2HvnBiawLvmYzRYaDkJUnaIyM4JTia5Aczhs9Z4tjMbGBd0qrQuib5Sy7L1OhibicZNGUuHfdcVkPr2GicAw/640?wx_fmt=jpeg" width="100%" src="https://mmbiz.qpic.cn/mmbiz_jpg/hN03ibG0t2HvnBiawLvmYzRYaDkJUnaIyM4JTia5Aczhs9Z4tjMbGBd0qrQuib5Sy7L1OhibicZNGUuHfdcVkPr2GicAw/640?wx_fmt=jpeg"></section></section><p powered-by="xiumi.us"><br></p><section powered-by="xiumi.us"><p><br></p><p><br></p><p>版权声明：本文内容由互联网用户自发贡献，版权归作者所有，本公众号不拥有所有权，也不承担相关法律责任。</p><p>如果您发现本公众号中有涉嫌抄袭的内容，欢迎发送邮件至：kysxcdb@163.com 进行举报，一经查实，本公众号将立刻删除涉嫌侵权内容。</p></section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><p><strong>BIOINFOR</strong></p></section></section></section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><img data-ratio="1" data-w="258" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/hN03ibG0t2HvnBiawLvmYzRYaDkJUnaIyMR9TAEibq3C82R4ZrNLAiaeI3MpozvB7gicwvOKN523KHOqUbDjPfV75Fg/640?wx_fmt=jpeg" width="100%" src="https://mmbiz.qpic.cn/mmbiz_jpg/hN03ibG0t2HvnBiawLvmYzRYaDkJUnaIyMR9TAEibq3C82R4ZrNLAiaeI3MpozvB7gicwvOKN523KHOqUbDjPfV75Fg/640?wx_fmt=jpeg"></section></section><section powered-by="xiumi.us"><section><p>微信号｜科研生信充电宝</p></section></section><section powered-by="xiumi.us"><section><p><span><strong> · BIOINFOR · </strong></span></p></section></section><p powered-by="xiumi.us"><br></p></section></section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><svg viewbox="0 0 1 1"></svg></section></section></section><section><section powered-by="xiumi.us"><section><p><strong>永远相信美好的事情</strong></p></section></section></section><section><section powered-by="xiumi.us"><section><svg viewbox="0 0 1 1"></svg></section></section></section><section><section powered-by="xiumi.us"><section><p><strong>即将发生</strong></p></section></section></section><section><section powered-by="xiumi.us"><section><svg viewbox="0 0 1 1"></svg></section></section></section></section></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/4DaBBI3ON1ujngmh6dXJ0Q",target="_blank" rel="noopener noreferrer">原文链接</a>
