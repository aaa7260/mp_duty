---
title: "KEGG数据库报错及解决"
date: 2023-04-02T01:59:04Z
draft: ["false"]
tags: [
  "fetched",
  "生命数据科学"
]
categories: ["Acdemic"]
---
KEGG数据库报错及解决 by 生命数据科学
------
<div><section><qqmusic musicid="262017586" mid="003xysAP2Jlpeq" albumurl="https://y.gtimg.cn/music/photo_new/T002R68x68M0000020ZPSo0fcJag.jpg" audiourl="http://isure6.stream.qqmusic.qq.com/C200003xysAP2Jlpeq.m4a?guid=2000000052&amp;vkey=6F69CD42098F101CA74B68C2498CA531FE1F4F7BFA2A55BE10E9DAC3D632F7A6CE6C9BF17B3364F6E651203ADF3E4C061AFFBE38675F038F&amp;uin=&amp;fromtag=20052" music_name="愿爱无忧" singer="痛仰乐队 - 愿爱无忧（台版）" play_length="293" src="/mp/readtemplate?t=app_editor/music&amp;singer=%E7%97%9B%E4%BB%B0%E4%B9%90%E9%98%9F%20-%20%E6%84%BF%E7%88%B1%E6%97%A0%E5%BF%A7%EF%BC%88%E5%8F%B0%E7%89%88%EF%BC%89&amp;music_name=%E6%84%BF%E7%88%B1%E6%97%A0%E5%BF%A7&amp;albumurl=https%3A%2F%2Fy.gtimg.cn%2Fmusic%2Fphoto_new%2FT002R68x68M0000020ZPSo0fcJag.jpg&amp;musictype=1" musictype="1" otherid="003xysAP2Jlpeq" albumid="0020ZPSo0fcJag" jumpurlkey="" data-pluginname="insertaudio"></qqmusic></section><section><section><span title="" opera-tn-ra-cell="_$.pages:0.layers:0.comps:0.title1"><p>名人名言<span></span></p></span></section></section><section><section powered-by="xiumi.us"><section><p><strong>汪品先院士</strong><strong>曾经说过：德育崇尚信仰，科学贵在怀疑</strong></p></section></section></section><p><br></p><section><section powered-by="xiumi.us"><section><p><strong>1</strong></p></section></section></section><section><section powered-by="xiumi.us"><p><strong>起因</strong><strong></strong></p></section><section powered-by="xiumi.us"><section><section><svg viewbox="0 0 1 1"></svg></section></section></section></section><section><section powered-by="xiumi.us"><section><section><br></section></section></section></section><p><br></p><p>前几天做KEGG时报错了，误以为KEGG用不成了，心想可能是数据库出现了问题，当时的心情不亚于当年被苏联专家们抛弃的感受，如果上天再给我一次机会，我一定把它本地化了！</p><p><span>还好，这个问题被</span><span>生信技能树的</span><span>专家们和Y叔</span><span>解决了（<a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247514395&amp;idx=1&amp;sn=97fd9130fdf5fb63a55ce23a336f8313&amp;scene=21#wechat_redirect" textvalue="KEGG数据库倒闭了吗" linktype="text" imgurl="" imgdata="null" tab="innerlink" data-linktype="2"><strong>KEGG数据库倒闭了吗</strong></a>），</span><span>报错原因明确，解决方法也很</span><span>简单。</span></p><p><img data-backh="392" data-backw="578" data-galleryid="" data-ratio="0.6782608695652174" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/Nf8QqUlJukOmV8f0aicfQ8lbk8WdTsb5E6dNGPMXeUCGgRtAA4seIVibmnZVzvFGhv26Cvgiap9Zn6ww858peY1nQ/640?wx_fmt=png" data-type="png" data-w="920" src="https://mmbiz.qpic.cn/mmbiz_png/Nf8QqUlJukOmV8f0aicfQ8lbk8WdTsb5E6dNGPMXeUCGgRtAA4seIVibmnZVzvFGhv26Cvgiap9Zn6ww858peY1nQ/640?wx_fmt=png"></p><p><span></span></p><p><br></p><section><section powered-by="xiumi.us"><section><p><strong>2</strong></p></section></section></section><section><section powered-by="xiumi.us"><p><strong>解决方法</strong><strong></strong></p></section><section powered-by="xiumi.us"><section><section><svg viewbox="0 0 1 1"></svg></section></section></section></section><section><section powered-by="xiumi.us"><section><section><br></section></section></section></section><p><br></p><p>简要概括解决办法就是：<strong>修改R下载函数的协议</strong></p><section><ul><li><li><li><li></ul><pre data-lang="php"><code><span><span># 第一种解决方法，间接</span></span></code><code><span><span># install.packages('R.utils') #仅需安装一次</span></span></code><code><span>library(<span>"R.utils"</span>)    </span></code><code><span>R.utils::setOption( <span>"clusterProfiler.download.method"</span>,<span>'auto'</span> )</span></code></pre></section><section><ul><li><li></ul><pre data-lang="apache"><code><span><span># 第二种解决方法，直接</span></span></code><code><span><span><span>options</span></span>(clusterProfiler.download.method = <span>"wininet"</span>)</span></code></pre></section><p>两种方法均可，本文推送完毕，针对KEGG数据库分析<strong>将不再有任何问题</strong>。</p><p><br></p><p><strong>但！</strong></p><p><br></p><section><section powered-by="xiumi.us"><section><p><strong>3</strong></p></section></section></section><section><section powered-by="xiumi.us"><p><strong>番外：万一KEGG真用不了了</strong><strong></strong></p></section><section powered-by="xiumi.us"><section><section><svg viewbox="0 0 1 1"></svg></section></section></section></section><section><section powered-by="xiumi.us"><section><section><br></section></section></section></section><p><br></p><p>小日子过得不错的日本数据库——KEGG，如果有一天突然倒塌了，富集分析将何去何从，确实是这次报错所揭露的隐患，<strong>自己搞出原子弹，才能挺直腰杆子</strong>。</p><p><img data-galleryid="" data-ratio="2.472263868065967" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/Nf8QqUlJukOmV8f0aicfQ8lbk8WdTsb5E5J7P6MDVh70knGtPrzVB2hxealjIKXUJNV372Wer2iaIc0VNoXeDV5A/640?wx_fmt=png" data-type="png" data-w="1334" src="https://mmbiz.qpic.cn/mmbiz_png/Nf8QqUlJukOmV8f0aicfQ8lbk8WdTsb5E5J7P6MDVh70knGtPrzVB2hxealjIKXUJNV372Wer2iaIc0VNoXeDV5A/640?wx_fmt=png"></p><p><br></p><p>当我们</p><p>检索数据库</p><p>获得数据集</p><p>做完标准化</p><p>进行差异分析</p><p>最后准备富集分析，大干一场的时候，突然“日本”专家要停止援助了，方才知道，自己有，才是真的有。</p><p><br></p><p><img data-ratio="0.558" data-src="https://mmbiz.qpic.cn/mmbiz_png/Nf8QqUlJukOmV8f0aicfQ8lbk8WdTsb5EoDe6SkOGlJZoIEU6EjuL3yXicRPS7yTDDjWOWKpvLHgnmt7zWMjiaibOA/640?wx_fmt=png" data-type="png" data-w="1000" src="https://mmbiz.qpic.cn/mmbiz_png/Nf8QqUlJukOmV8f0aicfQ8lbk8WdTsb5EoDe6SkOGlJZoIEU6EjuL3yXicRPS7yTDDjWOWKpvLHgnmt7zWMjiaibOA/640?wx_fmt=png"></p><p><br></p><p>那么如何使KEGG本地化呢？Y叔早已做足了准备<span>，但</span><span>本文仅为粗略回顾，</span><span>相关</span><span>概念请</span><span>移步参考资料，同时可以关注Y叔公众号进行学习，clusterProfiler博大精深。</span></p><section><mpprofile data-pluginname="mpprofile" data-id="MzI5NjUyNzkxMg==" data-headimg="http://mmbiz.qpic.cn/mmbiz_png/MPBFtnFrw4kl0YyAibxKSvDIOeywKhuAxRW03Pn2iclS0j6ibCP8Qcl5xgKib4lVjqpiaxvGkv9Yyp5MwJJVjMcj7yQ/0?wx_fmt=png" data-nickname="YuLabSMU" data-alias="biobabble" data-signature="南方医科大学生物信息学系余光创课题组" data-from="0"></mpprofile></section><p><br></p><section><section powered-by="xiumi.us"><section><p><strong>4</strong></p></section></section></section><section><section powered-by="xiumi.us"><p><strong>KEGG数据库本地化</strong><span><strong></strong></span></p></section><section powered-by="xiumi.us"><section><section><svg viewbox="0 0 1 1"></svg></section></section></section></section><section><section powered-by="xiumi.us"><section><section><br></section></section></section></section><p><br></p><p>1.网络条件好的情况下</p><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="cpp"><code><span><span># install.packages(<span>"remotes"</span>)</span></span></code><code><span>setwd(<span>"G:\\"</span>)</span></code><code><span>remotes::install_github(<span>"YuLab-SMU/createKEGGdb"</span>) <span>#github在线安装</span></span></code><code><span>library(<span>"createKEGGdb"</span>)</span></code><code><span>create_kegg_db(<span>"hsa"</span>) #将人类的KEGG富集所需文件打包为KEGGdb包</span></code><code><span>install.packages(<span>"G:\\KEGG.db_1.0.tar.gz"</span>, repos=<span>NULL</span>,type = <span>"source"</span>) #建议一段时间运行一次</span></code><code><span><br></span></code><code><span>#上述代码仅需一段时间运行一次即可，KEGG更新速度不会很快</span></code><code><span>#实际使用情况</span></code><code><span>library(KEGG.db)</span></code><code><span>library(clusterProfiler)</span></code><code><span>kk &lt;- enrichKEGG(gene         = gene,</span></code><code><span>                 organism     = <span>'hsa'</span>,</span></code><code><span>                 pvalueCutoff = <span>0.05</span>,</span></code><code><span>                 qvalueCutoff = <span>0.05</span>,</span></code><code><span>                 use_internal_data =T)</span></code><code><span>#其实本地查询与在线查询唯一不同的就是设置use_internal_data =T</span></code></pre></section><p>2.网络条件不好的情况下</p><p><br></p><p><strong>先安装devtools，以前参考过的devtools安装教程：</strong></p><p>https://blog.csdn.net/weixin_42098685/article/details/105864543</p><p><span>同时，</span><span>7天内</span><span>后台回复</span><strong>KEGG本地化</strong><span>，获得</span><strong>createKEGGdb-master.zip</strong><span>文件的下载链接，将文件下载后，</span><strong>绝对路径</strong><span>放入参数</span><span>中即可安装</span></p><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="cpp"><code><span>devtools::install_local(<span>"G:\\createKEGGdb-master.zip"</span>)</span></code><code><span>library(<span>"createKEGGdb"</span>)</span></code><code><span>create_kegg_db(<span>"hsa"</span>) #将人类的KEGG富集所需文件打包为KEGGdb包</span></code><code><span>install.packages(<span>"G:\\KEGG.db_1.0.tar.gz"</span>, repos=<span>NULL</span>,type = <span>"source"</span>)</span></code><code><span><br></span></code><code><span>#上述代码仅需一段时间运行一次即可，KEGG更新速度不会很快</span></code><code><span>#实际使用情况</span></code><code><span>library(KEGG.db)</span></code><code><span>library(clusterProfiler)</span></code><code><span>gene &lt;- c(<span>5214</span>,<span>54578</span>,<span>54659</span>,<span>117145</span>,<span>217</span>,<span>84869</span>)#输入的基因格式为entrezID</span></code><code><span>kk &lt;- enrichKEGG(gene         = gene,</span></code><code><span>                 organism     = <span>'hsa'</span>,</span></code><code><span>                 pvalueCutoff = <span>0.05</span>,</span></code><code><span>                 qvalueCutoff = <span>0.05</span>,</span></code><code><span>                 use_internal_data =T)</span></code><code><span>kk@result</span></code><code><span>#其实本地查询与在线查询唯一不同的就是设置use_internal_data =T</span></code></pre></section><section><mpprofile data-pluginname="mpprofile" data-id="Mzk0MDI4MjM4NQ==" data-headimg="http://mmbiz.qpic.cn/mmbiz_png/Nf8QqUlJukPKjJubnJmGLP8FSg5jVWUFfvFOHlpBCDCHPyWUVuDW1EO6gET24qoljsYO2ib1KaobZzOCh8BBF4A/0?wx_fmt=png" data-nickname="研究生学生信" data-alias="sxmu_bioinformatics" data-signature="Make bioinformatics great again" data-from="0"></mpprofile></section><p><span>感谢观看到最后，欢迎批评指正！</span></p><p><span><br></span></p><p>【参考资料】</p><section><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247514395&amp;idx=1&amp;sn=97fd9130fdf5fb63a55ce23a336f8313&amp;scene=21#wechat_redirect" textvalue="KEGG数据库倒闭了吗" linktype="text" imgurl="" imgdata="null" tab="innerlink" data-linktype="2"><strong>KEGG数据库倒闭了吗</strong></a></section><section><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzI5NjUyNzkxMg==&amp;mid=2247488313&amp;idx=1&amp;sn=4ad8f14c26960bad12e2b5b31aa615ca&amp;scene=21#wechat_redirect" textvalue="KEGG数据本地化，再也不用担心网络问题了" linktype="text" imgurl="" imgdata="null" tab="innerlink" data-linktype="2"><strong>KEGG数据本地化，再也不用担心网络问题了</strong></a></section><section><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzI5NjUyNzkxMg==&amp;mid=2247488313&amp;idx=1&amp;sn=4ad8f14c26960bad12e2b5b31aa615ca&amp;scene=21#wechat_redirect" textvalue="KEGG数据本地化，再也不用担心网络问题了" linktype="text" imgurl="" imgdata="null" tab="innerlink" data-linktype="2"></a></section><section><br></section><section><span>注：图源网络，侵删</span><br></section><section><br></section></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/lyQCWLRgGYB5CWvPXmg1bQ",target="_blank" rel="noopener noreferrer">原文链接</a>
