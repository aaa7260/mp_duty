---
title: "Docker 快速入门"
date: 2023-04-28T08:13:16Z
draft: ["false"]
tags: [
  "fetched",
  "生信菜鸟团"
]
categories: ["Acdemic"]
---
Docker 快速入门 by 生信菜鸟团
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><p data-tool="mdnice编辑器">Docker已经成为软件开发人员和系统管理员的标准工具，可用于快速、简单和可移植的应用程序开发。Docker是容器生产、分发和使用的完整解决方案，而容器利用操作系统内核特性来提供部分虚拟化的环境。</p><h4 data-tool="mdnice编辑器">Dockerfile 构建镜像</h4><pre data-tool="mdnice编辑器"><span></span><code>FROM ubuntu:latest<br><br>SHELL ["/bin/bash", "-c"]<br><br>RUN set -e \<br>    &amp;&amp; apt-get -y update \<br>    &amp;&amp; apt-get -y dist-upgrade \<br>    &amp;&amp; apt-get -y install curl build-essential libncurses5-dev zlib1g-dev libbz2-dev liblzma-dev libcurl4-openssl-dev \<br>    &amp;&amp; apt-get -y autoremove \<br>    &amp;&amp; apt-get clean \<br>    &amp;&amp; apt-get -y install gcc-9 g++-9 \<br>    &amp;&amp; apt-get -y install r-base \<br>    &amp;&amp; apt-get -y install perl \<br>    &amp;&amp; apt-get -y install python3.8 \<br>    &amp;&amp; apt-get -y install imagemagick \<br>    &amp;&amp; rm -rf /var/lib/apt/lists/*<br>docker build -f ./Dockerfile -t sjtu-scomics/scrap:3.0 .<br></code></pre><h4 data-tool="mdnice编辑器">Docker 直接构建镜像</h4><h5 data-tool="mdnice编辑器">拉取镜像</h5><p data-tool="mdnice编辑器">拉取镜像：docker pull ubuntu:18.04</p><pre data-tool="mdnice编辑器"><span></span><code><span>#</span><span> 列出当前的docker镜像</span><br>test@MacBook-Pro 2.Cloud % docker image ls<br>REPOSITORY   TAG       IMAGE ID       CREATED       SIZE<br>ubuntu       18.04     c1adc1968c7b   5 weeks ago   56.7MB<br><br>test@MacBook-Pro lib % docker image ls<br>REPOSITORY   TAG       IMAGE ID       CREATED       SIZE<br>scrap        v3        c1adc1968c7b   5 weeks ago   56.7MB<br>ubuntu       18.04     c1adc1968c7b   5 weeks ago   56.7MB<br></code></pre><h5 data-tool="mdnice编辑器">修改镜像名</h5><p data-tool="mdnice编辑器">修改镜像名：docker tag &lt;当前镜像名&gt; &lt;重命名的镜像名&gt;</p><pre data-tool="mdnice编辑器"><span></span><code>test@MacBook-Pro lib % docker tag ubuntu:18.04 scrap:v3<br></code></pre><h5 data-tool="mdnice编辑器">删除镜像</h5><p data-tool="mdnice编辑器">删除镜像：docker image rm &lt;镜像名：版本&gt;</p><pre data-tool="mdnice编辑器"><span></span><code>test@MacBook-Pro lib % docker image rm rjr:test<br>Untagged: rjr:test<br></code></pre><h5 data-tool="mdnice编辑器">启动容器</h5><p data-tool="mdnice编辑器">简单的启动镜像进入容器：docker run -it &lt;镜像名&gt;</p><p data-tool="mdnice编辑器">启动镜像容器：docker run -it -d --name &lt;启动的容器名称&gt; -p &lt;端口&gt; &lt;镜像名称&gt;</p><p data-tool="mdnice编辑器">查看启动的容器：docker ps -a</p><pre data-tool="mdnice编辑器"><span></span><code>test@MacBook-Pro lib % docker run -it -d --name myubuntu -p 8088:80 ubuntu:18.04<br>test@MacBook-Pro lib % docker ps -a<br>CONTAINER ID   IMAGE          COMMAND       CREATED       STATUS       PORTS                  NAMES<br>9076ed3f0dc9   ubuntu:18.04   "/bin/bash"   3 hours ago   Up 3 hours   0.0.0.0:8088-&gt;80/tcp   myubuntu<br></code></pre><h5 data-tool="mdnice编辑器">查看容器信息</h5><p data-tool="mdnice编辑器">查看容信息：docker inspect &lt;容器ID&gt;</p><pre data-tool="mdnice编辑器"><span></span><code>test@MacBook-Pro lib % docker inspect 9076ed3f0dc9<br>[<br>    {<br>        "Id": "9076ed3f0dc9e792ea865b24da6bb78f6d48a070bdb8f17cea4e811d4e06fad6",<br>        "Created": "2023-04-18T05:44:40.08253018Z",<br>        "Path": "/bin/bash",<br>        "Args": [],<br>        "State": {<br>            "Status": "running",<br>            "Running": true,<br>            "Paused": false,<br>            "Restarting": false,<br>            "OOMKilled": false,<br>            "Dead": false,<br></code></pre><h5 data-tool="mdnice编辑器">进入容器</h5><p data-tool="mdnice编辑器">进入容器：docker exec -it &lt;容器ID&gt; /bin/bash</p><pre data-tool="mdnice编辑器"><span></span><code>test@MacBook-Pro lib % docker exec -it 9076ed3f0dc9 /bin/bash<br>root@9076ed3f0dc9:/#<br></code></pre><h5 data-tool="mdnice编辑器">删除容器</h5><p data-tool="mdnice编辑器">docker rm -f &lt;容器ID/容器名&gt;</p><pre data-tool="mdnice编辑器"><span></span><code>test@MacBook-Pro lib % docker ps -a<br>CONTAINER ID   IMAGE          COMMAND       CREATED          STATUS                      PORTS                  NAMES<br>18188ce55a8a   scrap:v3       "/bin/bash"   32 minutes ago   Exited (1) 31 minutes ago                          sad_mclean<br>4d68ce0d1d26   scrap:v3       "python"      33 minutes ago   Created                                            strange_feistel<br>9076ed3f0dc9   ubuntu:18.04   "/bin/bash"   45 hours ago     Up 45 hours                 0.0.0.0:8088-&gt;80/tcp   myubuntu<br>test@MacBook-Pro lib % docker rm -f 18188ce55a8a<br>18188ce55a8a<br>test@MacBook-Pro lib % docker ps -a<br>CONTAINER ID   IMAGE          COMMAND       CREATED          STATUS        PORTS                  NAMES<br>4d68ce0d1d26   scrap:v3       "python"      33 minutes ago   Created                              strange_feistel<br>9076ed3f0dc9   ubuntu:18.04   "/bin/bash"   45 hours ago     Up 45 hours   0.0.0.## 删除未启动成功的容器<br>test@MacBook-Pro lib % docker ps -a |grep Created|awk '{print $1}'|xargs -n 1 docker rm -f<br>4d68ce0d1d26<br>test@MacBook-Pro lib % docker ps -a<br>CONTAINER ID   IMAGE          COMMAND       CREATED        STATUS        PORTS                  NAMES<br>9076ed3f0dc9   ubuntu:18.04   "/bin/bash"   45 hours ago   Up 45 hours   0.0.0.0:8088-&gt;80/tcp   myubuntu<br></code></pre><h5 data-tool="mdnice编辑器">容器拷贝操作</h5><p data-tool="mdnice编辑器"><strong>从外部拷贝数据或者脚本等到镜像内</strong></p><p data-tool="mdnice编辑器">首先需要启动镜像的容器，在进行拷贝</p><p data-tool="mdnice编辑器">docker cp &lt;文件&gt; &lt;容器ID&gt;:&lt;镜像内拷贝到的路径&gt;**</p><pre data-tool="mdnice编辑器"><span></span><code>test@MacBook-Pro lib % docker cp /Users/test/Documents/test/1.SJTU-BGI/0.pipline/PrepareParam.py myubuntu:/opt<br></code></pre><p data-tool="mdnice编辑器"><strong>从容器内部拷贝到外面</strong></p><p data-tool="mdnice编辑器">docker cp &lt;容器ID&gt;:&lt;镜像内文件&gt; &lt;外部需要拷贝到的路径&gt;**</p><pre data-tool="mdnice编辑器"><span></span><code>test@MacBook-Pro 2.Cloud % docker cp 9076ed3f0dc9:/opt/scrap/PrepareParam.py .<br></code></pre><h5 data-tool="mdnice编辑器">使用镜像运行脚本</h5><p data-tool="mdnice编辑器">docker run -v &lt;挂载宿主机的路径到镜像中&gt; -w &lt;镜像中的路径&gt; &lt;镜像&gt; python &lt;python脚本&gt;</p><p data-tool="mdnice编辑器">使用 -v 挂载路径到镜像内部：-v &lt;宿主机的路径&gt;:&lt;挂载到镜像内的路径&gt;</p><p data-tool="mdnice编辑器">使用 -w 指定挂载后镜像内的脚本所在的路径：-w &lt;挂载到镜像内的路径&gt;</p><pre data-tool="mdnice编辑器"><span></span><code>docker run -v /Users/test/Documents/test/1.SJTU-BGI/0.pipline:/opt -w /opt/ rjr:test python PrepareParam.py<br></code></pre><p data-tool="mdnice编辑器">如果脚本在镜像内部，则不需要-v挂载，直接运行</p><p data-tool="mdnice编辑器">docker run -w &lt;镜像中的路径&gt; &lt;镜像&gt; python &lt;python脚本&gt;</p><pre data-tool="mdnice编辑器"><span></span><code>test@MacBook-Pro 2.Cloud % docker run -w /opt/scrap rjr:test python PrepareParam.py<br></code></pre><h5 data-tool="mdnice编辑器">每次重启镜像后需要重新安装软件</h5><p data-tool="mdnice编辑器">要么使用Dockerfile构建容器，要么在容器内安装好软件后，重新将该容器打包成新的镜像</p><p data-tool="mdnice编辑器">docker commit &lt;容器ID&gt; &lt;镜像&gt;</p><pre data-tool="mdnice编辑器"><span></span><code>test@MacBook-Pro 2.Cloud % docker commit myubuntu rjr:test<br></code></pre><p data-tool="mdnice编辑器">更多使用请移步docker官网文档。</p><p data-tool="mdnice编辑器">https://www.docker.com </p><p data-tool="mdnice编辑器">https://docs.docker.com/get-started/02_our_app/</p></section><p><br></p><p><mp-style-type data-value="10000"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/lVk7p5kwW4_ap_ACSiJAEA",target="_blank" rel="noopener noreferrer">原文链接</a>
