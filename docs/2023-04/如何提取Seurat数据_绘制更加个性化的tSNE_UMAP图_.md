---
title: "如何提取Seurat数据，绘制更加个性化的tSNE/UMAP图？"
date: 2023-04-26T07:56:12Z
draft: ["false"]
tags: [
  "fetched",
  "SCIPainter"
]
categories: ["Acdemic"]
---
如何提取Seurat数据，绘制更加个性化的tSNE/UMAP图？ by SCIPainter
------
<div><section data-mpa-powered-by="yiban.io"><span>基于Seurat绘制tSNE或UMAP散点图往往参数有限，个性化程度较为一般，调整起来也比较麻烦。<br></span></section><section><br></section><section><span>如果想要绘制更精致的图表，可以从Seurat中提取二维绘图数据，使用ggplot2进行调整与美化，这也更加符合我们的下游绘图习惯，效率嗖嗖提升！</span></section><section><br mpa-from-tpl="t"></section><p><br></p><p><img data-galleryid="" data-ratio="0.75" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mWSqM9yWHgsMREhWAz1DTV5KlTxqVgust5iaKEsT0UGazCiaBEYymqDLiccUn9oUIpJNrE92Q74vDjg/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mWSqM9yWHgsMREhWAz1DTV5KlTxqVgust5iaKEsT0UGazCiaBEYymqDLiccUn9oUIpJNrE92Q74vDjg/640?wx_fmt=png"></p><p><br mpa-from-tpl="t"></p><p><br></p><p><br></p><section data-mpa-template="t" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><img data-ratio="0.2692307692307692" data-src="https://mmbiz.qpic.cn/mmbiz_png/VZiahicJ3snWTYO4HI8ibSS7oQH3Wz8VOl7ZtyjI3EZjUPzg9FgOoLkFMmqcPunfbQbWe7k7nxgN5cQ4D4mBhv9DQ/640?wx_fmt=png" data-w="52" src="https://mmbiz.qpic.cn/mmbiz_png/VZiahicJ3snWTYO4HI8ibSS7oQH3Wz8VOl7ZtyjI3EZjUPzg9FgOoLkFMmqcPunfbQbWe7k7nxgN5cQ4D4mBhv9DQ/640?wx_fmt=png"></section><section data-mid="" mpa-from-tpl="t"><p data-mid="">本期内容一览</p></section><section data-mid="" mpa-from-tpl="t"><img data-ratio="2.2" data-src="https://mmbiz.qpic.cn/mmbiz_png/PSUaGPzYJmAzhfEAUxDvQpxWiaCkTngicOIhiaolVdUib8FIU4bbIrK08f2weBVDlhM1WMXUfHOTGYT0fzk7HqC3Mg/640?wx_fmt=png" data-w="20" src="https://mmbiz.qpic.cn/mmbiz_png/PSUaGPzYJmAzhfEAUxDvQpxWiaCkTngicOIhiaolVdUib8FIU4bbIrK08f2weBVDlhM1WMXUfHOTGYT0fzk7HqC3Mg/640?wx_fmt=png"></section></section></section></section><section><br></section><section><span><strong><span>1.Seurat绘图数据提取</span><br></strong></span></section><section><span><strong><span>2.添加细胞亚群置信区间椭圆</span></strong></span></section><section><span><strong><span>3.带箭头的坐标轴添加</span></strong></span></section><section><span><strong><span>4.细胞亚群标签添加</span></strong></span><span></span></section><section><span><br></span></section><section><span>下面就开始今天的学习吧！</span></section><section><br></section><section><span><br mpa-from-tpl="t"></span></section><section data-mpa-template="t" mpa-from-tpl="t"><p><img data-ratio="0.5982532751091703" data-src="https://mmbiz.qpic.cn/mmbiz_gif/MfTd6rd9CyvNRMW8I9cvI1CK5gKiaYqg2veTn9t9dAe1GxYic7pAvgvRIKNFickConFyX8AvW2reAq8GchJI6aBpA/640?wx_fmt=gif" data-w="458" data-width="100%" src="https://mmbiz.qpic.cn/mmbiz_gif/MfTd6rd9CyvNRMW8I9cvI1CK5gKiaYqg2veTn9t9dAe1GxYic7pAvgvRIKNFickConFyX8AvW2reAq8GchJI6aBpA/640?wx_fmt=gif"></p></section><p><br></p><p><br></p><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>#载入相关R包：</span><br mpa-from-tpl="t"><span>install</span>.packages('tidydr')<br mpa-from-tpl="t"><span>library</span>(tidydr) <br mpa-from-tpl="t"><span>library</span>(Seurat)<br mpa-from-tpl="t"><span>library</span>(dplyr)<br mpa-from-tpl="t"><span>library</span>(ggplot2)<br mpa-from-tpl="t"><span>library</span>(cols4all)<br mpa-from-tpl="t"><br mpa-from-tpl="t"><span>#读取scRNA-seq测试数据：</span><br mpa-from-tpl="t"><span>##已完成分析的Seurat对象</span><br mpa-from-tpl="t"><span>load</span>('obj.Rda')<br mpa-from-tpl="t"><span>dim</span>(seurat_object)</code></pre></section><p><br></p><section><img data-ratio="0.11884550084889643" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mWSqM9yWHgsMREhWAz1DTVNGuDdjzDbnNMpup6zwcg0teFib0Itx7kg4GGYO8Bsu9eWphLSam1HuQ/640?wx_fmt=png" data-type="png" data-w="589" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mWSqM9yWHgsMREhWAz1DTVNGuDdjzDbnNMpup6zwcg0teFib0Itx7kg4GGYO8Bsu9eWphLSam1HuQ/640?wx_fmt=png"></section><section><br></section><section><span><br mpa-from-tpl="t"></span></section><section data-mpa-template="t" mpa-from-tpl="t"><section data-mpa-template="t" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><p data-mid=""><br mpa-from-tpl="t"></p></section><section data-mid="" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><img data-ratio="0.9166666666666666" data-w="24" data-src="https://mmbiz.qpic.cn/mmbiz_png/wady5w5ibo4iaCibB22U8bvrpHjAz27CgQgoyHQh4goSRRcnl5D3YxKnxwHcGWdEYFXmUwHtia6Q5LMInP0onAYY6w/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" src="https://mmbiz.qpic.cn/mmbiz_png/wady5w5ibo4iaCibB22U8bvrpHjAz27CgQgoyHQh4goSRRcnl5D3YxKnxwHcGWdEYFXmUwHtia6Q5LMInP0onAYY6w/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"></section><section data-mid="" mpa-from-tpl="t"><p data-mid=""><span>1. 提取下游绘图所需目标信息</span></p></section><section data-mid="" mpa-from-tpl="t"><img data-ratio="0.9090909090909091" data-w="22" data-src="https://mmbiz.qpic.cn/mmbiz_png/qXjbauddHyfIO0vW9YscibsrYLrQwibR9bPWkaJOGeSnPue5Yr7fwN3RpKFfic2B0w30tz1dEvafgtcExmmgvWDXQ/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" src="https://mmbiz.qpic.cn/mmbiz_png/qXjbauddHyfIO0vW9YscibsrYLrQwibR9bPWkaJOGeSnPue5Yr7fwN3RpKFfic2B0w30tz1dEvafgtcExmmgvWDXQ/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"></section></section></section></section></section></section><p><br></p><p><br></p><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>#tSNE</span><br mpa-from-tpl="t"><span>##提取x/y轴坐标信息：</span><br mpa-from-tpl="t"><span>tSNE</span> &lt;- as.data.frame(seurat_object@reductions$tsne@cell.embeddings)<br mpa-from-tpl="t"><span>head</span>(tSNE)</code></pre></section><p><br></p><section><img data-ratio="0.34993270524899056" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mWSqM9yWHgsMREhWAz1DTVvOQRaYLiaOdcfFvKT8nL1ZahKvsX5CEl77vs2lP0TRX3KyKQxQumQ4w/640?wx_fmt=png" data-type="png" data-w="743" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mWSqM9yWHgsMREhWAz1DTVvOQRaYLiaOdcfFvKT8nL1ZahKvsX5CEl77vs2lP0TRX3KyKQxQumQ4w/640?wx_fmt=png"></section><section><br></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>#</span><span>#提取亚群</span><span>注释信息：</span><br mpa-from-tpl="t"><span>celltype</span> &lt;- Idents(seurat_object)<br mpa-from-tpl="t"><span>table</span>(celltype)</code></pre></section><p><br></p><section><img data-ratio="0.15648148148148147" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mWSqM9yWHgsMREhWAz1DTV6F0MvFwYocJn0hlldDGsrFfuNFwERNr486BLI0CS7ZcCBIChBQG2tw/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mWSqM9yWHgsMREhWAz1DTV6F0MvFwYocJn0hlldDGsrFfuNFwERNr486BLI0CS7ZcCBIChBQG2tw/640?wx_fmt=png"></section><section><br></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>tSNE</span> &lt;- cbind(tSNE,celltype) <span>#数据框合并</span><br mpa-from-tpl="t"><span>head</span>(tSNE)</code></pre></section><p><br></p><section><img data-ratio="0.2898550724637681" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mWSqM9yWHgsMREhWAz1DTVxS14JVZ6nXrlwEjh6GAzMIKGZMheH7jup7RmR4OuIZIqB6C2aa3j3Q/640?wx_fmt=png" data-type="png" data-w="897" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mWSqM9yWHgsMREhWAz1DTVxS14JVZ6nXrlwEjh6GAzMIKGZMheH7jup7RmR4OuIZIqB6C2aa3j3Q/640?wx_fmt=png"></section><section><br></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>#UMAP提取方法相同：</span><br mpa-from-tpl="t"><span>UMAP</span> &lt;- as.data.frame(seurat_object@reductions$umap@cell.embeddings)<br mpa-from-tpl="t"><span>UMAP</span> &lt;- cbind(UMAP,celltype)<br mpa-from-tpl="t"><span>head</span>(UMAP)</code></pre></section><p><br></p><section><img data-ratio="0.2898550724637681" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mWSqM9yWHgsMREhWAz1DTVsgVkSWssNBAHVTczZib9XqfnzZUcYg9lxSBgCFSuCIj0sG8I0DoXiang/640?wx_fmt=png" data-type="png" data-w="897" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mWSqM9yWHgsMREhWAz1DTVsgVkSWssNBAHVTczZib9XqfnzZUcYg9lxSBgCFSuCIj0sG8I0DoXiang/640?wx_fmt=png"></section><section><span><br></span></section><section><span><br></span></section><section data-mpa-template="t" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><p data-mid=""><br mpa-from-tpl="t"></p></section><section data-mid="" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><img data-ratio="0.9166666666666666" data-w="24" data-src="https://mmbiz.qpic.cn/mmbiz_png/wady5w5ibo4iaCibB22U8bvrpHjAz27CgQgoyHQh4goSRRcnl5D3YxKnxwHcGWdEYFXmUwHtia6Q5LMInP0onAYY6w/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" src="https://mmbiz.qpic.cn/mmbiz_png/wady5w5ibo4iaCibB22U8bvrpHjAz27CgQgoyHQh4goSRRcnl5D3YxKnxwHcGWdEYFXmUwHtia6Q5LMInP0onAYY6w/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"></section><section data-mid="" mpa-from-tpl="t"><p data-mid=""><span>2. ggplot2下游绘图【以tSNE为例】</span></p></section><section data-mid="" mpa-from-tpl="t"><img data-ratio="0.9090909090909091" data-w="22" data-src="https://mmbiz.qpic.cn/mmbiz_png/qXjbauddHyfIO0vW9YscibsrYLrQwibR9bPWkaJOGeSnPue5Yr7fwN3RpKFfic2B0w30tz1dEvafgtcExmmgvWDXQ/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" src="https://mmbiz.qpic.cn/mmbiz_png/qXjbauddHyfIO0vW9YscibsrYLrQwibR9bPWkaJOGeSnPue5Yr7fwN3RpKFfic2B0w30tz1dEvafgtcExmmgvWDXQ/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"></section></section></section></section></section><section><br></section><section><br></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>#建立自定义</span><span>主题：</span><br mpa-from-tpl="t"><span>mytheme</span> &lt;- theme_void() + <span>#空白主题，便于我们后期添加tSNE箭头</span><br mpa-from-tpl="t">  <span>theme</span>(plot.margin = margin(5.5,15,5.5,5.5)) <span>#画布空白页缘调整</span><br mpa-from-tpl="t"><br mpa-from-tpl="t"><span>#建立映射，添加散点：</span><br mpa-from-tpl="t"><span>p</span> &lt;- ggplot(data = tSNE, aes(x = tSNE_1, y = tSNE_2)) +<br mpa-from-tpl="t">  <span>geom_point</span>(aes(color = celltype),<br mpa-from-tpl="t">             <span>size</span> = 0.4, <br mpa-from-tpl="t">             <span>alpha</span> = 0.8)<br mpa-from-tpl="t"><span>p</span></code></pre></section><p><br></p><section><img data-ratio="0.7712962962962963" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mWSqM9yWHgsMREhWAz1DTVCic5IsF9XXiaWZ8PSJrCYdQVliczDFibISpe76v0c1aG3vs10ds35AFickA/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mWSqM9yWHgsMREhWAz1DTVCic5IsF9XXiaWZ8PSJrCYdQVliczDFibISpe76v0c1aG3vs10ds35AFickA/640?wx_fmt=png"></section><section><span><br></span></section><section><span><br></span></section><section data-mpa-template="t" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><img data-ratio="1" data-w="12" data-src="https://mmbiz.qpic.cn/mmbiz_png/GSKggEmeRuUibZxxUXibSicEmX24yld0hibxa3YnVk96SuNa1r6uZVRlqPlPibAWib4ibw4cTFC8w2BFVjooibQrWOn2aw/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" src="https://mmbiz.qpic.cn/mmbiz_png/GSKggEmeRuUibZxxUXibSicEmX24yld0hibxa3YnVk96SuNa1r6uZVRlqPlPibAWib4ibw4cTFC8w2BFVjooibQrWOn2aw/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"></section><section data-mid="" mpa-from-tpl="t"><br mpa-from-tpl="t"></section></section><section data-mid="" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><img data-ratio="1.6666666666666667" data-w="12" data-src="https://mmbiz.qpic.cn/mmbiz_png/HmcmGhhubDesrH2ndkvrQyXWicAtXBo7N9WUzEAkzwmpicQh147qDLG29wnw8nqegAwTlyazWoicia5ZMbVGHZYGyQ/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" src="https://mmbiz.qpic.cn/mmbiz_png/HmcmGhhubDesrH2ndkvrQyXWicAtXBo7N9WUzEAkzwmpicQh147qDLG29wnw8nqegAwTlyazWoicia5ZMbVGHZYGyQ/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"></section><section data-mid="" mpa-from-tpl="t"><section mpa-from-tpl="t"><strong mpa-from-tpl="t"></strong><strong mpa-from-tpl="t"><span>2.1 添加置信区间</span></strong></section></section><section data-mid="" mpa-from-tpl="t"><img data-ratio="1.6666666666666667" data-w="12" data-src="https://mmbiz.qpic.cn/mmbiz_png/UDvYDXWMoLYEPWA4tYHODyxmlgFokQf5LjeIqK6Tfk2OVsOhxicab9zjOCqO56RPDvCFMk4MqQ4icTnXyzVcFzog/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" src="https://mmbiz.qpic.cn/mmbiz_png/UDvYDXWMoLYEPWA4tYHODyxmlgFokQf5LjeIqK6Tfk2OVsOhxicab9zjOCqO56RPDvCFMk4MqQ4icTnXyzVcFzog/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"></section></section></section><section data-mid="" mpa-from-tpl="t"><img data-ratio="1.1666666666666667" data-w="12" data-src="https://mmbiz.qpic.cn/mmbiz_png/XbuJkiaNveFR8A9Ckj5e3wd3aoolXlO6hvkyTkAnuzk2427fBxib3wl8QyFia7cSJc3Br7aVrJLiaszlxBsuLZy4Xg/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" src="https://mmbiz.qpic.cn/mmbiz_png/XbuJkiaNveFR8A9Ckj5e3wd3aoolXlO6hvkyTkAnuzk2427fBxib3wl8QyFia7cSJc3Br7aVrJLiaszlxBsuLZy4Xg/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"></section></section></section></section><section><br></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>#添加实线椭圆置信区间：</span><br mpa-from-tpl="t"><span>p1</span> &lt;- p +<br mpa-from-tpl="t">  <span>stat_ellipse</span>(aes(color = celltype), <br mpa-from-tpl="t">               <span>level</span> = 0.95, linetype = 1, show.legend = F) +<br mpa-from-tpl="t">  <span>mytheme</span><br mpa-from-tpl="t"><span>p1</span></code></pre></section><p><br></p><section><img data-ratio="0.7462962962962963" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mWSqM9yWHgsMREhWAz1DTVGvDJ3dzsIMCicVayCyIQGUZ0qlou3dFSco35G1oo3rENgthCRqkuxuw/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mWSqM9yWHgsMREhWAz1DTVGvDJ3dzsIMCicVayCyIQGUZ0qlou3dFSco35G1oo3rENgthCRqkuxuw/640?wx_fmt=png"></section><section><br mpa-from-tpl="t"></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>#添加虚线椭圆置信区间：</span><br mpa-from-tpl="t"><span>p2</span> &lt;- p +<br mpa-from-tpl="t">  <span>stat_ellipse</span>(aes(color = celltype), <br mpa-from-tpl="t">               <span>level</span> = 0.95, linetype = 2, show.legend = F) +<br mpa-from-tpl="t">  <span>mytheme</span><br mpa-from-tpl="t"><span>p2</span></code></pre></section><p><br></p><section><img data-ratio="0.7462962962962963" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mWSqM9yWHgsMREhWAz1DTV7Rlvp1TyddmDLuicKXAhXQEtI02DUO27vENP2xWdZbzBoAMLcRnLr4Q/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mWSqM9yWHgsMREhWAz1DTV7Rlvp1TyddmDLuicKXAhXQEtI02DUO27vENP2xWdZbzBoAMLcRnLr4Q/640?wx_fmt=png"></section><section><br mpa-from-tpl="t"></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>#添加填充型置信区间：</span><br mpa-from-tpl="t"><span>p3</span> &lt;- p +<br mpa-from-tpl="t">  <span>stat_ellipse</span>(aes(color = celltype, fill = celltype), <br mpa-from-tpl="t">               <span>level</span> = 0.95, linetype = 1, show.legend = F,<br mpa-from-tpl="t">               <span>geom</span> = 'polygon', alpha = 0.1) +<br mpa-from-tpl="t">  <span>mytheme</span><br mpa-from-tpl="t"><span>p3</span></code></pre></section><p><br></p><section><img data-ratio="0.7462962962962963" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mWSqM9yWHgsMREhWAz1DTVbpceBJ6xmVzB0sOV3EvHUh1a9N486icI1CickkX8o139gQPjakrrLPIg/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mWSqM9yWHgsMREhWAz1DTVbpceBJ6xmVzB0sOV3EvHUh1a9N486icI1CickkX8o139gQPjakrrLPIg/640?wx_fmt=png"></section><section><br></section><section><strong><span>PS：</span></strong><span>从ggplot2的图层关系来说，应该先添加置信区间色块在底层，再加散点元素。如果有强迫症，或者不透明度设置的比较高，可自行调换代码。</span></section><section><span><br></span></section><section><span><br></span></section><section data-mpa-template="t" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><img data-ratio="1" data-w="12" data-src="https://mmbiz.qpic.cn/mmbiz_png/GSKggEmeRuUibZxxUXibSicEmX24yld0hibxa3YnVk96SuNa1r6uZVRlqPlPibAWib4ibw4cTFC8w2BFVjooibQrWOn2aw/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" src="https://mmbiz.qpic.cn/mmbiz_png/GSKggEmeRuUibZxxUXibSicEmX24yld0hibxa3YnVk96SuNa1r6uZVRlqPlPibAWib4ibw4cTFC8w2BFVjooibQrWOn2aw/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"></section><section data-mid="" mpa-from-tpl="t"><br mpa-from-tpl="t"></section></section><section data-mid="" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><img data-ratio="1.6666666666666667" data-w="12" data-src="https://mmbiz.qpic.cn/mmbiz_png/HmcmGhhubDesrH2ndkvrQyXWicAtXBo7N9WUzEAkzwmpicQh147qDLG29wnw8nqegAwTlyazWoicia5ZMbVGHZYGyQ/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" src="https://mmbiz.qpic.cn/mmbiz_png/HmcmGhhubDesrH2ndkvrQyXWicAtXBo7N9WUzEAkzwmpicQh147qDLG29wnw8nqegAwTlyazWoicia5ZMbVGHZYGyQ/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"></section><section data-mid="" mpa-from-tpl="t"><section mpa-from-tpl="t"><strong mpa-from-tpl="t"></strong><strong mpa-from-tpl="t"><span>2.2 添加tSNE坐标轴箭头</span></strong></section></section><section data-mid="" mpa-from-tpl="t"><img data-ratio="1.6666666666666667" data-w="12" data-src="https://mmbiz.qpic.cn/mmbiz_png/UDvYDXWMoLYEPWA4tYHODyxmlgFokQf5LjeIqK6Tfk2OVsOhxicab9zjOCqO56RPDvCFMk4MqQ4icTnXyzVcFzog/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" src="https://mmbiz.qpic.cn/mmbiz_png/UDvYDXWMoLYEPWA4tYHODyxmlgFokQf5LjeIqK6Tfk2OVsOhxicab9zjOCqO56RPDvCFMk4MqQ4icTnXyzVcFzog/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"></section></section></section><section data-mid="" mpa-from-tpl="t"><img data-ratio="1.1666666666666667" data-src="https://mmbiz.qpic.cn/mmbiz_png/XbuJkiaNveFR8A9Ckj5e3wd3aoolXlO6hvkyTkAnuzk2427fBxib3wl8QyFia7cSJc3Br7aVrJLiaszlxBsuLZy4Xg/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" data-w="12" src="https://mmbiz.qpic.cn/mmbiz_png/XbuJkiaNveFR8A9Ckj5e3wd3aoolXlO6hvkyTkAnuzk2427fBxib3wl8QyFia7cSJc3Br7aVrJLiaszlxBsuLZy4Xg/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"></section></section></section></section><section><br></section><section><br></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>#添加tsne坐标轴箭头：</span><br mpa-from-tpl="t"><span>p4</span> &lt;- p3 +<br mpa-from-tpl="t">  <span>theme_dr</span>(xlength = 0.2, <span>#x轴长度</span><br mpa-from-tpl="t">           <span>ylength</span> = 0.2, <span>#y轴长度</span><br mpa-from-tpl="t">           <span>arrow</span> = grid::arrow(length = unit(0.1, <span>"inches"</span>), <span>#箭头大小/长度</span><br mpa-from-tpl="t">                               <span>ends</span> = 'last', type = <span>"closed"</span>)) + <span>#箭头描述信息</span><br mpa-from-tpl="t">  <span>theme</span>(panel.grid = element_blank())<br mpa-from-tpl="t"><span>p4</span></code></pre></section><p><br></p><section><img data-ratio="0.75" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mWSqM9yWHgsMREhWAz1DTVcbiakj0f4oGBWibJ8cRiamB6xn9ibP8CScatBwC0Ic91eCLUX54fdJc7NQ/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mWSqM9yWHgsMREhWAz1DTVcbiakj0f4oGBWibJ8cRiamB6xn9ibP8CScatBwC0Ic91eCLUX54fdJc7NQ/640?wx_fmt=png"></section><section><br></section><section><br></section><section data-mpa-template="t" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><img data-ratio="1" data-w="12" data-src="https://mmbiz.qpic.cn/mmbiz_png/GSKggEmeRuUibZxxUXibSicEmX24yld0hibxa3YnVk96SuNa1r6uZVRlqPlPibAWib4ibw4cTFC8w2BFVjooibQrWOn2aw/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" src="https://mmbiz.qpic.cn/mmbiz_png/GSKggEmeRuUibZxxUXibSicEmX24yld0hibxa3YnVk96SuNa1r6uZVRlqPlPibAWib4ibw4cTFC8w2BFVjooibQrWOn2aw/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"></section><section data-mid="" mpa-from-tpl="t"><br mpa-from-tpl="t"></section></section><section data-mid="" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><img data-ratio="1.6666666666666667" data-src="https://mmbiz.qpic.cn/mmbiz_png/HmcmGhhubDesrH2ndkvrQyXWicAtXBo7N9WUzEAkzwmpicQh147qDLG29wnw8nqegAwTlyazWoicia5ZMbVGHZYGyQ/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" data-w="12" src="https://mmbiz.qpic.cn/mmbiz_png/HmcmGhhubDesrH2ndkvrQyXWicAtXBo7N9WUzEAkzwmpicQh147qDLG29wnw8nqegAwTlyazWoicia5ZMbVGHZYGyQ/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"></section><section data-mid="" mpa-from-tpl="t"><section mpa-from-tpl="t"><strong mpa-from-tpl="t"></strong><strong mpa-from-tpl="t"><span>2.3 亚群中心添加标签信息</span></strong></section></section><section data-mid="" mpa-from-tpl="t"><img data-ratio="1.6666666666666667" data-w="12" data-src="https://mmbiz.qpic.cn/mmbiz_png/UDvYDXWMoLYEPWA4tYHODyxmlgFokQf5LjeIqK6Tfk2OVsOhxicab9zjOCqO56RPDvCFMk4MqQ4icTnXyzVcFzog/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" src="https://mmbiz.qpic.cn/mmbiz_png/UDvYDXWMoLYEPWA4tYHODyxmlgFokQf5LjeIqK6Tfk2OVsOhxicab9zjOCqO56RPDvCFMk4MqQ4icTnXyzVcFzog/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"></section></section></section><section data-mid="" mpa-from-tpl="t"><img data-ratio="1.1666666666666667" data-w="12" data-src="https://mmbiz.qpic.cn/mmbiz_png/XbuJkiaNveFR8A9Ckj5e3wd3aoolXlO6hvkyTkAnuzk2427fBxib3wl8QyFia7cSJc3Br7aVrJLiaszlxBsuLZy4Xg/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" src="https://mmbiz.qpic.cn/mmbiz_png/XbuJkiaNveFR8A9Ckj5e3wd3aoolXlO6hvkyTkAnuzk2427fBxib3wl8QyFia7cSJc3Br7aVrJLiaszlxBsuLZy4Xg/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"></section></section></section></section><section><br></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>#在图中增加亚群标签:</span><br mpa-from-tpl="t"><span>##计算每个亚群散点的中位数，作为图中标签的坐标</span><br mpa-from-tpl="t"><span>label</span> &lt;- tSNE %&gt;%<br mpa-from-tpl="t">  <span>group_by</span>(celltype)%&gt;%<br mpa-from-tpl="t">  <span>summarise</span>(tSNE_1 = median(tSNE_1), tSNE_2 = median(tSNE_2))<br mpa-from-tpl="t"><span>head</span>(label)</code></pre></section><p><br></p><section><img data-ratio="0.5241935483870968" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mWSqM9yWHgsMREhWAz1DTVXibhg8NGQ3cLvXiahZzmLZrAUic5Nj7uZg4VB95xOpuq6jn36YlQDNFPA/640?wx_fmt=png" data-type="png" data-w="620" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mWSqM9yWHgsMREhWAz1DTVXibhg8NGQ3cLvXiahZzmLZrAUic5Nj7uZg4VB95xOpuq6jn36YlQDNFPA/640?wx_fmt=png"></section><section><br mpa-from-tpl="t"></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>p5</span> &lt;- p4 +<br mpa-from-tpl="t">  <span>geom_text</span>(data = label,<br mpa-from-tpl="t">            <span>aes</span>(x = tSNE_1, y = tSNE_2, label = celltype),<br mpa-from-tpl="t">            <span>fontface</span> = <span>"bold"</span>, <span>#粗体强调</span><br mpa-from-tpl="t">            <span>color</span> = 'black', size = 4)<br mpa-from-tpl="t"><span>p5</span></code></pre></section><p><br></p><section><img data-ratio="0.75" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mWSqM9yWHgsMREhWAz1DTVFzfndnSJNpSwZCYDrpRWyIiaorKX8yN7XLsY2hMEDZGv0hE2koE1IPQ/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mWSqM9yWHgsMREhWAz1DTVFzfndnSJNpSwZCYDrpRWyIiaorKX8yN7XLsY2hMEDZGv0hE2koE1IPQ/640?wx_fmt=png"></section><section><br mpa-from-tpl="t"></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>#图表细节调整</span><br mpa-from-tpl="t"><span>##根据个人需求，哪里不满意调哪里即可</span><br mpa-from-tpl="t"><span>p6</span> &lt;- p5 +<br mpa-from-tpl="t">  <span>guides</span>(color = guide_legend(override.aes = list(size = 5))) <span>#放大图例中的散点</span><br mpa-from-tpl="t"><span>p6</span></code></pre></section><p><br></p><section><img data-ratio="0.75" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mWSqM9yWHgsMREhWAz1DTVHrTYKL9IVkoIIw8kDEOoARxElXia69eOBNSrHJqibz6UiaExEiaxibswXSQ/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mWSqM9yWHgsMREhWAz1DTVHrTYKL9IVkoIIw8kDEOoARxElXia69eOBNSrHJqibz6UiaExEiaxibswXSQ/640?wx_fmt=png"></section><section><br mpa-from-tpl="t"></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>#自定义颜色：</span><br mpa-from-tpl="t"><span>c4a_gui</span>() <span>#查看本次使用配色包的色板</span><br mpa-from-tpl="t"><span>mycol</span> &lt;- c4a('bold',9) <span>#选择配色即颜色数</span><br mpa-from-tpl="t"><br mpa-from-tpl="t"><span>p7</span> &lt;- p6 +<br mpa-from-tpl="t">  <span>scale_color_manual</span>(values = mycol) +<br mpa-from-tpl="t">  <span>scale_fill_manual</span>(values = mycol)<br mpa-from-tpl="t"><span>p7</span></code></pre></section><p><br></p><section><img data-ratio="0.75" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mWSqM9yWHgsMREhWAz1DTVsX52Y4KGyrYeIYcy3bt1Ic6thkW7ya7W5xXm6hcTCTHOd3Obz4ww0A/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mWSqM9yWHgsMREhWAz1DTVsX52Y4KGyrYeIYcy3bt1Ic6thkW7ya7W5xXm6hcTCTHOd3Obz4ww0A/640?wx_fmt=png"></section><section><span>上图使用色板：</span></section><section><span>"#7F3C8D" "#11A579" "#3969AC" "#F2B701" "#E73F74" "#80BA5A" "#E68310" "#008695" "#A5AA99"</span></section><section><br></section><section><span>下面再分享一下其它色彩的搭配效果，有需要的可以保存十六进制颜色码自用：</span></section><section><span><br></span></section><section><img data-ratio="0.75" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mWSqM9yWHgsMREhWAz1DTVGAcjPpKgGrRBMuN5SDOQCOzRoxqlzeCwqNJLnJl5dh9xfl7S4AmHWQ/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mWSqM9yWHgsMREhWAz1DTVGAcjPpKgGrRBMuN5SDOQCOzRoxqlzeCwqNJLnJl5dh9xfl7S4AmHWQ/640?wx_fmt=png"></section><section><span>上图使用色板：</span></section><section><span>"#66C5CC" "#F6CF71" "#F89C74" "#DCB0F2" "#87C55F" "#9EB9F3" "#FE88B1" "#C9DB74" "#8BE0A4"</span></section><section><span><br></span></section><section><img data-ratio="0.75" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mWSqM9yWHgsMREhWAz1DTVJ1JEIykoapibJ2P8Yc8jaT947vlbC7F8C3QzIkgGFaGextt3CKvsV3A/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mWSqM9yWHgsMREhWAz1DTVJ1JEIykoapibJ2P8Yc8jaT947vlbC7F8C3QzIkgGFaGextt3CKvsV3A/640?wx_fmt=png"></section><section><img data-ratio="0.75" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mWSqM9yWHgsMREhWAz1DTVVNFibXYcZbEBYfRn1zj0QbBxpWRfvDE0CUcsONg24sP2e8ZbYtp6xyA/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mWSqM9yWHgsMREhWAz1DTVVNFibXYcZbEBYfRn1zj0QbBxpWRfvDE0CUcsONg24sP2e8ZbYtp6xyA/640?wx_fmt=png"></section><section><span>上图使用色板：</span></section><section><span>"#4E79A7" "#F28E2B" "#E15759" "#76B7B2" "#59A14F" "#EDC948" "#B07AA1" "#FF9DA7" "#9C755F"</span></section><section><span><br></span></section><section><img data-ratio="0.75" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mWSqM9yWHgsMREhWAz1DTVHZyohc7CWniaJUWLhgqs6e16hiaGAV1uWrETDprBQtSRFibFpBNnOhQWg/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mWSqM9yWHgsMREhWAz1DTVHZyohc7CWniaJUWLhgqs6e16hiaGAV1uWrETDprBQtSRFibFpBNnOhQWg/640?wx_fmt=png"></section><section><span>上图使用色板：</span></section><section><span>"#4E79A7" "#A0CBE8" "#F28E2B" "#FFBE7D" "#59A14F" "#8CD17D" "#B6992D" "#F1CE63" "#499894"</span></section><section><span><br></span></section><section><span>如果个人的研究背景需要进行更加个性化的不规则几何圈选或标注，建议使用AI会更加便捷，比如下图：</span></section><section><span><br></span></section><section><img data-ratio="0.75" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mWSqM9yWHgsMREhWAz1DTVnQkp6DRBGoQPFzlmIGaTHTwqsfIgGiaRguPiaorOiarbwNIPXp8df0enA/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mWSqM9yWHgsMREhWAz1DTVnQkp6DRBGoQPFzlmIGaTHTwqsfIgGiaRguPiaorOiarbwNIPXp8df0enA/640?wx_fmt=png"></section><section><span>（圈选无生物学意义，仅绘图效果展示）</span></section><section><br></section><section><span>背景色块、或者虚线/实线描边的做法在各大期刊都能见到，很简单这里不再过多赘述了。如果有盆友不清楚也可以留言，需求多的话也可以单独出一期Adobe Illustrator圈选教程。</span></section><section><br></section><section><span>好啦，今天的分享就到这里！</span></section><section><span><br></span></section><section><span><br></span></section><section><span><br></span></section><p><strong><span>*未经许可，不得以任何方式复制或抄袭本篇文章之部分或全部内容。版权所有，侵权必究。</span></strong></p><p><br></p><section data-role="outer" label="Powered by 135editor.com"><section data-tools="135编辑器" data-id="105648"><section><section data-role="outer" label="Powered by 135editor.com"><section data-role="paragraph"><section data-role="outer" label="Powered by 135editor.com"><section data-tools="135编辑器" data-id="105648"><section><section><img data-ratio="0.8780487804878049" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6kCKJYcEqEIfoJYG621mPJE8VibmibGU0Jxic9iabARVRH0FT6BNE8VAglWFXBPibFAU7a6tWGibSs8wyUg/640?wx_fmt=png" data-type="png" data-w="41" data-width="100%" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6kCKJYcEqEIfoJYG621mPJE8VibmibGU0Jxic9iabARVRH0FT6BNE8VAglWFXBPibFAU7a6tWGibSs8wyUg/640?wx_fmt=png"></section><section><section><section data-width="35%"><section><section data-width="100%"><img data-ratio="1" data-src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/tgUVxVRjT6kCKJYcEqEIfoJYG621mPJEv5etCBwHicqbEPwnVrkpaasxqaVibM4mT2JdIuN6yTlYWDD4mL5A427A/640?wx_fmt=jpeg" data-type="jpeg" data-w="860" data-width="100%" title="SCIPainter 30cm二维码.jpg" src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/tgUVxVRjT6kCKJYcEqEIfoJYG621mPJEv5etCBwHicqbEPwnVrkpaasxqaVibM4mT2JdIuN6yTlYWDD4mL5A427A/640?wx_fmt=jpeg"></section></section></section><section data-width="50%"><section><section data-brushtype="text"><span><strong># SCIPainter</strong></span></section><section data-brushtype="text" hm_fix="361:593"><p>基迪奥旗下绘图公众号</p><p>分享科研绘图技能与工具</p><p>欢迎关注与转发~</p></section></section></section></section></section></section></section></section></section></section><section><br></section></section></section><section data-role="paragraph"><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><img data-ratio="1" data-src="https://mmbiz.qpic.cn/sz_mmbiz_gif/tgUVxVRjT6kCKJYcEqEIfoJYG621mPJEgMd0aMPtmrDjiaX8sBhfhicVteeHf1JicexSpUbS3fdS9SiboUVN7guaPw/640?wx_fmt=gif" data-type="gif" data-w="400" src="https://mmbiz.qpic.cn/sz_mmbiz_gif/tgUVxVRjT6kCKJYcEqEIfoJYG621mPJEgMd0aMPtmrDjiaX8sBhfhicVteeHf1JicexSpUbS3fdS9SiboUVN7guaPw/640?wx_fmt=gif"></section></section></section><section><section powered-by="xiumi.us"><section><p><span><strong>你的好友拍了拍你</strong></span></p><p><span><strong>并请你帮她点一下</strong></span><strong><span>“分享”</span></strong><span><strong><span>~</span></strong></span></p></section></section></section></section></section><p><br></p></section></section><section><span><br></span></section><p><mp-style-type data-value="10000"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/9TJiea_All0iQGsVxkjq-w",target="_blank" rel="noopener noreferrer">原文链接</a>
