---
title: "R包{ggExtra}原来可以做这么多件事！"
date: 2023-04-04T10:50:37Z
draft: ["false"]
tags: [
  "fetched",
  "R语言和统计"
]
categories: ["Acdemic"]
---
R包{ggExtra}原来可以做这么多件事！ by R语言和统计
------
<div><section data-mpa-powered-by="yiban.io"><span>想在散点图上添加边缘直方图（<span>marginal histograms），去除图片的背景网格线，将频率表画成图，还可以一行代码旋转x坐标上的文字。</span></span><span>这个fancy的R包</span><span>{ggExtra}</span><span>一定要看看！</span></section><section><br></section><section><span>准备要用的R包们：</span></section><section><span><br mpa-from-tpl="t"></span></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><section><span><span># 安装并载入{ggExtra}</span><br mpa-from-tpl="t">install.packages(<span>"ggExtra"</span>)<br mpa-from-tpl="t"></span><span>library</span><span>(ggExtra)<br mpa-from-tpl="t"><br mpa-from-tpl="t"><span># 下方仅为载入代码，需提前安装R包</span><br mpa-from-tpl="t"></span><span>library</span><span>(ggplot2)<br mpa-from-tpl="t"></span><span>library</span><span>(ggsci)</span></section></pre></section><section><span>首先，有请<span>ggMarginal()</span>，算是<span>{ggExtra}</span>当家函数，它能给散点图添上多种边缘图（密度图，直方图，小提琴图，箱形图等等）。</span></section><section><span><br></span></section><section><span>使用R自带数据集iris，</span><span>简化一下作图数据，提取出第1，3，5个变量：</span></section><section><br></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><section><span>mydata &lt;- iris[<span>1</span>:<span>120</span>, c(<span>1</span>, <span>3</span>, <span>5</span>)]<br mpa-from-tpl="t">summary(mydata)</span></section></pre></section><section><img data-galleryid="" data-ratio="0.35342465753424657" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/pCu8RzQCByRwLLWfkUA4VgfZdaNIiachgcuPW1HT2KHbtic92vBzLUrNnIjLjtpuQPoHdpRggC55SZZAddiamYEYg/640?wx_fmt=png" data-type="png" data-w="730" src="https://mmbiz.qpic.cn/mmbiz_png/pCu8RzQCByRwLLWfkUA4VgfZdaNIiachgcuPW1HT2KHbtic92vBzLUrNnIjLjtpuQPoHdpRggC55SZZAddiamYEYg/640?wx_fmt=png"></section><section><br></section><section><span>做出一个简单的散点图存入p中备用：<br mpa-from-tpl="t"></span></section><section><span><br></span></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><section><span>p &lt;- ggplot(mydata, aes(x = Sepal.Length, y = Petal.Length, colour = Species)) + <br mpa-from-tpl="t">  geom_point()<br mpa-from-tpl="t">p</span></section></pre></section><section><img data-galleryid="" data-ratio="0.7527777777777778" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/pCu8RzQCByRwLLWfkUA4VgfZdaNIiachgQv9MPkOPtqfic0iba3e127aVHoZiaVTuB4dLHhGmAHsIhlnftDwPiaQhAw/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/pCu8RzQCByRwLLWfkUA4VgfZdaNIiachgQv9MPkOPtqfic0iba3e127aVHoZiaVTuB4dLHhGmAHsIhlnftDwPiaQhAw/640?wx_fmt=png"></section><section><br></section><section><span>开始探索吧～</span></section><section><br></section><section><span><span>ggMarginal()</span>一行代码给散点图加上边缘图：</span></section><section><span><br></span></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><section><span>ggMarginal(p)</span></section></pre></section><section><img data-galleryid="" data-ratio="0.7453703703703703" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/pCu8RzQCByRwLLWfkUA4VgfZdaNIiachg6nC8mIiaTrgPLFYJUZvCSuUvTSDR1sGKlqSZKvCgFVonKqspORtMnlQ/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/pCu8RzQCByRwLLWfkUA4VgfZdaNIiachg6nC8mIiaTrgPLFYJUZvCSuUvTSDR1sGKlqSZKvCgFVonKqspORtMnlQ/640?wx_fmt=png"></section><section><span><br></span></section><section><span>上图中为边缘密度图，是默认的图型。</span></section><section><span><br></span></section><section><span>通过代码</span><span>type = "histogram"</span><span>可以更改一下边缘图的类型；也能很好的兼容</span><span>{ggplot2}</span><span>：</span><br></section><section><br></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><section><span>ggMarginal(p + theme_classic(<span>15</span>) + ggtitle(<span>"Marginal histograms"</span>), <br mpa-from-tpl="t">           type = <span>"histogram"</span>,<br mpa-from-tpl="t">           size = <span>3</span>) </span><span># 主图与边缘图的占比</span></section></pre></section><section><img data-galleryid="" data-ratio="0.7481481481481481" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/pCu8RzQCByRwLLWfkUA4VgfZdaNIiachgwzPkubtwzbQibfNoIx4nUHMZFrt0AtLb4ElMMbYXvOsjmxgmSGjEy7g/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/pCu8RzQCByRwLLWfkUA4VgfZdaNIiachgwzPkubtwzbQibfNoIx4nUHMZFrt0AtLb4ElMMbYXvOsjmxgmSGjEy7g/640?wx_fmt=png"></section><section><br></section><section><span>修饰图片。想让边缘直方图按不同组别呈现不同颜色，并且使用</span><span>{ggsci}</span><span>修改为自己想要的配色：</span><span><br mpa-from-tpl="t"></span></section><section><span><br></span></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><section><span>ggMarginal(p + scale_color_aaas() + theme_classic(), <br mpa-from-tpl="t">           margins = <span>"x"</span>, <br mpa-from-tpl="t">           size = <span>1</span>, <br mpa-from-tpl="t">           type = <span>"densigram"</span>, <br mpa-from-tpl="t">           groupColour = <span>TRUE</span>, <br mpa-from-tpl="t">           groupFill = <span>TRUE</span>)</span></section></pre></section><section><img data-galleryid="" data-ratio="0.7537037037037037" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/pCu8RzQCByRwLLWfkUA4VgfZdaNIiachgBzqmUNqBicPibGibe1vWtEd4jz5ehicZCqx910deXt0pYfrOiaiaauEFbV4g/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/pCu8RzQCByRwLLWfkUA4VgfZdaNIiachgBzqmUNqBicPibGibe1vWtEd4jz5ehicZCqx910deXt0pYfrOiaiaauEFbV4g/640?wx_fmt=png"></section><section><br></section><section><span>第二，函数</span><span>plotCount()</span><span>可以轻松展示表格中不同组别的个数。</span></section><section><span><br></span></section><section><span>创建新的数据为表格(table)形式：</span><br></section><section><br></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><section><span>mytable &lt;- table(mydata$Species)<br mpa-from-tpl="t"><span>mytable</span></span></section></pre></section><section><img data-galleryid="" data-ratio="0.17543859649122806" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/pCu8RzQCByRwLLWfkUA4VgfZdaNIiachgicFmh5lkdia3nLfHSicWIHLsxzl2xjbWLRRRySZhzAQv0oILd0ZiaUMbBA/640?wx_fmt=png" data-type="png" data-w="456" src="https://mmbiz.qpic.cn/mmbiz_png/pCu8RzQCByRwLLWfkUA4VgfZdaNIiachgicFmh5lkdia3nLfHSicWIHLsxzl2xjbWLRRRySZhzAQv0oILd0ZiaUMbBA/640?wx_fmt=png"></section><section><br></section><section><span>使用<span>plotCount()</span>作图：</span></section><section><span><br></span></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><section><span>p1 &lt;- plotCount(mytable, fill = <span>"orange3"</span>, colour = <span>"black"</span>, width = <span>0.2</span>) + <br mpa-from-tpl="t">  xlab(<span>"Species"</span>) + </span><span># 修饰图片</span><span><br mpa-from-tpl="t">  theme_bw() <br mpa-from-tpl="t">p1</span></section></pre></section><section><span><img data-galleryid="" data-ratio="0.7435185185185185" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/pCu8RzQCByQESzf4DXpJj81jVg2Edpb8S1p5KrKhkPNIfvfaOXSsEzL8ic3R9yNFxFPoSpGcibEK8TS7trb9px0Q/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/pCu8RzQCByQESzf4DXpJj81jVg2Edpb8S1p5KrKhkPNIfvfaOXSsEzL8ic3R9yNFxFPoSpGcibEK8TS7trb9px0Q/640?wx_fmt=png"></span></section><section><span><br></span></section><section><span>最后，介绍两个非常简单的函数：<span>rotateTextX()</span>和<span>removeGrid()</span>。</span></section><section><span><br></span></section><section><span><span>rotateTextX()</span><span>一行代码颠倒x轴上的文字内容：</span></span></section><section><span><br mpa-from-tpl="t"></span></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><section><span>p1 + rotateTextX()</span></section></pre></section><section><img data-galleryid="" data-ratio="0.7425925925925926" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/pCu8RzQCByRwLLWfkUA4VgfZdaNIiachg3Y6icrIhic8Xkw2BIbiboLNwODpia4t6YvdSplzIK6MQibbolXCOT2vA2sQ/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/pCu8RzQCByRwLLWfkUA4VgfZdaNIiachg3Y6icrIhic8Xkw2BIbiboLNwODpia4t6YvdSplzIK6MQibbolXCOT2vA2sQ/640?wx_fmt=png"></section><section><br></section><section><span>removeGrid()</span><span>一行代码去除背景网格线：</span></section><section><br></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><section><span>p1 + removeGrid()</span></section></pre></section><section><img data-galleryid="" data-ratio="0.7472222222222222" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/pCu8RzQCByRwLLWfkUA4VgfZdaNIiachgLZpZvXKN2sXgeahO4icQ9g0a1De2ibDALGzdEvFsdiarXSEnib1XnozwSg/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/pCu8RzQCByRwLLWfkUA4VgfZdaNIiachgLZpZvXKN2sXgeahO4icQ9g0a1De2ibDALGzdEvFsdiarXSEnib1XnozwSg/640?wx_fmt=png"></section><section><br></section><section><span>如果对这个包感兴趣，可以深入了解哦 </span><span>[1]</span><span>～</span><br></section><section><br></section><section><span>好啦，今天的内容就到这里。</span><span>如果有帮助，记得分享给需要的人</span><img data-src="https://res.wx.qq.com/t/wx_fed/we-emoji/res/v1.3.10/assets/Expression/Expression_67@2x.png" data-ratio="1" data-w="128" src="https://res.wx.qq.com/t/wx_fed/we-emoji/res/v1.3.10/assets/Expression/Expression_67@2x.png"><span>！</span></section><section><br></section><section><br></section><p><span>参考文献</span></p><p><br></p><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><p><span>[<span>1</span>]. https://github.com/daattali/ggExtra</span></p></pre></section><p><br></p><p><span><strong><span>公众号的线上课程</span></strong></span></p><p><span>1. <a target="_blank" href="http://mp.weixin.qq.com/s?__biz=Mzk0MzE5OTAxMg==&amp;mid=2247506555&amp;idx=2&amp;sn=386b4d66c19578e0d318c6bc1ac5e21f&amp;chksm=c3351c30f4429526ca948ba1d78311b1f16f017a5bc17623de1276dc38e89df5bc9bc029f0de&amp;scene=21#wechat_redirect" textvalue="《R语言和统计新手课程》" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2">《R语言和统计新手课程》</a></span></p><p><span>2. <a target="_blank" href="http://mp.weixin.qq.com/s?__biz=Mzk0MzE5OTAxMg==&amp;mid=2247506977&amp;idx=1&amp;sn=b7f96f32505ac8b88fb68357c8d43d69&amp;chksm=c3351a6af442937cc8777dd9241f23c3ab8e049677738b222d8dabe7aeb1e3074c80ce749dcd&amp;scene=21#wechat_redirect" textvalue="《回归：从入门到进阶》" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2">《回归：从入门到进阶》</a></span></p><p><span><br></span></p><p><span><strong><span>公众号核心成员的成果发表</span></strong></span></p><p><span><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=Mzk0MzE5OTAxMg==&amp;mid=2247506555&amp;idx=1&amp;sn=0ca95fddcc184506e02c5b7ea70c0567&amp;chksm=c3351c30f4429526acad9c6c20dc0c3b76dc849d57a1755155f234f6eb31a24a904962f7aa5d&amp;scene=21#wechat_redirect" textvalue="《SCI医学1区论文》" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2">《SCI医学1区影响因子8.8分论文》</a></span></p><section><br></section><section data-mpa-template="t" mpa-from-tpl="t"><section><span>▌本文由</span><span><strong mpa-from-tpl="t"><span>R语言和统计</span></strong></span><span>首发</span></section><section><span>▌课程相关咨询可添加R师妹微信: kefu_rstats</span></section><section><span>▌编辑：June</span></section><section><span>▌邮箱：contact@rstats.cn</span></section><section><span>▌网站：www.rstats.cn</span></section><section><span>▌<strong>我们致力于</strong><strong>让R语言和统计变得简单！</strong></span></section><section><span><strong></strong><br></span></section><section mpa-from-tpl="t"><section label="Powered by 135editor.com" data-role="outer" mpa-from-tpl="t"><section data-role="paragraph" mpa-from-tpl="t"><section data-mpa-template="t" mpa-from-tpl="t"><section mpa-from-tpl="t"><section label="Powered by 135editor.com" data-role="outer" mpa-from-tpl="t"><section data-role="paragraph" mpa-from-tpl="t"><section mpa-from-tpl="t"><section mpa-from-tpl="t"><section label="Powered by 135editor.com" data-role="outer" mpa-from-tpl="t"><section data-role="paragraph" mpa-from-tpl="t"><hr><section><br></section></section></section></section></section></section></section></section></section></section></section></section></section><section><section><br></section></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/oxe3XsPh_czMoN6hmWIYoA",target="_blank" rel="noopener noreferrer">原文链接</a>
