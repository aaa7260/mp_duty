---
title: "百迈客单细胞转录组测序数据处理"
date: 2022-09-03T08:44:20Z
draft: ["false"]
tags: [
  "fetched",
  "单细胞天地"
]
categories: ["Acdemic"]
---
百迈客单细胞转录组测序数据处理 by 单细胞天地
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><blockquote data-tool="mdnice编辑器"><p>前面我们举办了：<a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247517014&amp;idx=1&amp;sn=b765a75dcc9ed73211586b23d2f89f5c&amp;scene=21#wechat_redirect" data-linktype="2">国产单细胞技术大比拼（数据分析测评）</a>的活动，终于吸引到了各个国产单细胞公司的注意，拿到了一些公司的示例测序数据。</p></blockquote><p data-tool="mdnice编辑器">其实最早我们就有：<a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247511323&amp;idx=1&amp;sn=64c10afb3c6101fb2d21fe266b945d86&amp;scene=21#wechat_redirect" data-linktype="2">新格元的单细胞转录组软件CeleScope实战</a>，处理的数据集来源于文献，见：<a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247511185&amp;idx=2&amp;sn=21f12a47f89574d788dd4248ac194d1e&amp;scene=21#wechat_redirect" data-linktype="2">哪怕是同一个单细胞数据里面的不同细胞亚群质量控制参数也可以不一样</a> , 在新格元的官方网站，有对这款试剂盒及其分析软件（celescope）的介绍，在github上有软件的使用说明及下载：https://github.com/singleron-RD/CeleScope 其官方文档也很清晰：https://github.com/singleron-RD/CeleScope/blob/master/docs/quick_start.md</p><p data-tool="mdnice编辑器">接下来我们测评的是百迈客单细胞转录组测序数据，其官网链接是：http://www.bmkmanu.com/portfolio/demo，简单的申请即可获取</p><ul data-tool="mdnice编辑器"><li><section>百创S1000 Illumina Novaseq PE150 胚胎脑海马</section></li><li><section>百创DG1000 Illumina Novaseq PE150 某动物皮肤</section></li></ul><p data-tool="mdnice编辑器">如下所示，数据量不小，没有服务器的大家就无需重复这个步骤啦。</p><pre data-tool="mdnice编辑器"><span></span><code>ls -lh *gz |cut -d<span>" "</span> -f 5- <br> 11G 8月  27 17:40 20220424-2-02_good_1.fq.tar.gz<br> 11G 8月  27 17:41 20220424-2-02_good_2.fq.tar.gz<br> 13G 8月  27 19:08 YF-Brain-1-20220423_good_1.fq.gz<br> 14G 8月  27 19:09 YF-Brain-1-20220423_good_2.fq.gz<br></code></pre><p data-tool="mdnice编辑器">值得注意是的有.tar.gz格式文件，需要先解包 ：</p><pre data-tool="mdnice编辑器"><span></span><code>$ ls -lh *fq |cut -d<span>" "</span> -f 5-<br>63G 7月  15 18:18 20220424-2-02_good_1.fq<br>60G 8月  28 12:20 20220424-2-02_good_2.fq<br><br></code></pre><p data-tool="mdnice编辑器">然后压缩：</p><pre data-tool="mdnice编辑器"><span></span><code>$ ls -lh *gz |cut -d<span>" "</span> -f 5-<br>11G 7月  15 18:18 20220424-2-02_good_1.fq.gz<br>11G 8月  27 17:40 20220424-2-02_good_1.fq.tar.gz<br>11G 7月  15 14:54 20220424-2-02_good_2.fq.gz<br>11G 8月  27 17:41 20220424-2-02_good_2.fq.tar.gz<br><br></code></pre><p data-tool="mdnice编辑器">有了百迈客单细胞转录组测序数据，接下来就下载其对应的数据处理软件。基本上跟前面的：<a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247511323&amp;idx=1&amp;sn=64c10afb3c6101fb2d21fe266b945d86&amp;scene=21#wechat_redirect" data-linktype="2">新格元的单细胞转录组软件CeleScope实战</a>一样的，非常耗费时间。如果是最流行的10X单细胞，我们就很熟练了，正常走cellranger的定量流程即可，代码我已经是多次分享了。参考：</p><ul data-tool="mdnice编辑器"><li><section><a href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247512340&amp;idx=3&amp;sn=1b9609a8870a0209dd27ffdcbc3cac87&amp;chksm=9b4bf1afac3c78b90674678fcec66365b9faaa275ff4b0a2255e0a05fa8b905e15222a643bea&amp;scene=21#wechat_redirect" data-linktype="2">10X单细胞转录组原始测序数据的Cell Ranger流程（仅需800元）</a></section></li><li><section><a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247496813&amp;idx=1&amp;sn=4151bf2265618eff4e0123722c50e569&amp;scene=21#wechat_redirect" data-linktype="2">10X的单细胞转录组原始数据也可以在EBI下载</a></section></li><li><section><a href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247510920&amp;idx=1&amp;sn=c4561d34e984406693c014cdfe236c0f&amp;chksm=9b4beb33ac3c622542d894344c323ff7cca52f69119d02fc7aa4636af0cbe7df4b6c63dd5ba9&amp;scene=21#wechat_redirect" data-linktype="2">一个10x单细胞转录组项目从fastq到细胞亚群</a></section></li><li><section><a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247513565&amp;idx=1&amp;sn=092e637017d176c43f00a295d3210592&amp;scene=21#wechat_redirect" data-linktype="2">一文打通单细胞上游：从软件部署到上游分析</a></section></li><li><section><a href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247513605&amp;idx=1&amp;sn=e86a329c887745c6d00d3ededa39dcda&amp;chksm=9b4bf6beac3c7fa8523cef4e7189fb20b914460ddb61e6cd1dd520b5928e1b59a8b7827ce783&amp;scene=21#wechat_redirect" data-linktype="2">PRJNA713302这个10x单细胞fastq实战</a></section></li><li><section><a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247513968&amp;idx=1&amp;sn=f5a44a7bea0bdacd8af1a20c177763e5&amp;scene=21#wechat_redirect" data-linktype="2">一次曲折且昂贵的单细胞公共数据获取与上游处理</a></section></li><li><section><a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247514146&amp;idx=1&amp;sn=b9721433d49a2d963eeaab1ad47fc91b&amp;scene=21#wechat_redirect" data-linktype="2">只能下载bam文件的10x单细胞转录组项目数据处理</a></section></li><li><section><a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247511452&amp;idx=2&amp;sn=83ec97cbc3334a6095e6d63e05e9fd6e&amp;scene=21#wechat_redirect" data-linktype="2">不知道10x单细胞转录组样品和fastq文件的对应关系</a></section></li><li><section><a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247508521&amp;idx=2&amp;sn=2cf3158e74d37b3a741908d8bfc8f02f&amp;scene=21#wechat_redirect" data-linktype="2">10X单细胞转录组测序数据的 SRA转fastq踩坑那些事</a></section></li><li><section><a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247514395&amp;idx=2&amp;sn=96c505b76ae87dd0efa737c4c44e2270&amp;scene=21#wechat_redirect" data-linktype="2">10x的单细胞转录组fastq文件的R1和R2不能弄混哦</a></section></li></ul><p data-tool="mdnice编辑器">这里因为每个国产单细胞公司都有自己的规则，所以不得不耗费时间精力去学习对方的软件。其 <strong>Demo数据结果展示</strong>，在<a href="https://mp.weixin.qq.com/s?__biz=MzAwMjY4MTU2NA==&amp;mid=2650145125&amp;idx=2&amp;sn=02a66c2d8abee83553f8baa157fdaf47&amp;scene=21#wechat_redirect" data-linktype="2">百创DG1000单细胞Demo数据更新</a> 可以看到；</p><ul data-tool="mdnice编辑器"><li><section>物种：小鼠</section></li><li><section>组织类型：药物处理后的皮肤组织</section></li><li><section>单细胞分选平台：百创DG1000</section></li><li><section>测序平台：Illumina</section></li><li><section>文库设计：PE150</section></li><li><section>数据量：56.10G</section></li></ul><p data-tool="mdnice编辑器">其中动物皮肤那个数据需要填表待审核，而且如果是56.10G的fastq测序数据，会很耗费计算资源和时间。</p><h3 data-tool="mdnice编辑器"><span></span>下载百迈客官网软件并且构建conda环境<span></span></h3><p data-tool="mdnice编辑器">依赖的软件需要使用 export 添加到环境变量中，以实现流程的调用。所以我们直接 使用 conda安装 Star软件这样激活小环境就会把Star添加到环境变量了，但是百迈客官网软件 BSCMatrix_v1.6.tar.gz  里面的系列小工具就有点麻烦了。</p><pre data-tool="mdnice编辑器"><span></span><code><br>conda create -y -n  baimaike  python=3.8<br><span>#激活小环境</span><br>conda activate baimaike<br>conda install -y -c bioconda   Star=2.6.1d <br><span># 大量的Python模块 ,主要是应对百迈客官网软件 BSCMatrix_v1.6.tar.gz  里面的cellcalling 小工具。</span><br>pip install plotly -i https://mirrors.aliyun.com/pypi/simple/<br>pip install lz4 -i https://pypi.tuna.tsinghua.edu.cn/simple<br>pip install numpy -i https://pypi.tuna.tsinghua.edu.cn/simple<br>pip install Cython -i https://pypi.tuna.tsinghua.edu.cn/simple<br>pip install h5py -i https://pypi.tuna.tsinghua.edu.cn/simple<br>pip install scipy -i https://pypi.tuna.tsinghua.edu.cn/simple<br>pip install pandas -i https://pypi.tuna.tsinghua.edu.cn/simple<br><span># 无穷无尽的模块缺失：ModuleNotFoundError: No module named 'tables'</span><br><br><br>wget http://www.bmkmanu.com/wp-content/uploads/2022/08/BSCMatrix_v1.6.tar.gz <br>tar zxvf BSCMatrix_v1.6.tar.gz<br><span>cd</span> BSCMatrix_v1.6/cellcalling <br>python setup.py build_ext -i  <span># 需要前面的 scipy，plotly，lz4，numpy，Cython 系列Python模块</span><br></code></pre><h3 data-tool="mdnice编辑器"><span></span>下载对应的参考基因组及其注释文件<span></span></h3><p data-tool="mdnice编辑器">下载后还需要使用前面安装好的star软件去构建index 文件 ，我们首先在ensembl等数据库下载如下所示的文件，下载时间取决于网络：</p><pre data-tool="mdnice编辑器"><span></span><code>507M 8月  29 21:17 Homo_sapiens.GRCh38.107.chr.gff3<br>425M 6月   4 18:35 Homo_sapiens.GRCh38.cdna.all.fa <br>304M 8月  30 15:07 Mus_musculus.GRCm39.107.chr.gff3<br>831M 8月  30 15:07 Mus_musculus.GRCm39.107.chr.gtf<br>2.6G 8月  30 15:56 Mus_musculus.GRCm39.dna_rm.primary_assembly.fa <br></code></pre><p data-tool="mdnice编辑器">然后使用前面安装好的star软件去构建 index 文件的命令如下所示：</p><pre data-tool="mdnice编辑器"><span></span><code>mkdir starindex<br>STAR --runThreadN 8 \<br>--runMode genomeGenerate \<br>--genomeDir starindex/ \<br>--genomeFastaFiles Mus_musculus.GRCm39.dna_rm.primary_assembly.fa \<br>--sjdbGTFfile Mus_musculus.GRCm39.107.chr.gtf<br></code></pre><p data-tool="mdnice编辑器">构建好的index 文件 ，如下所示：</p><pre data-tool="mdnice编辑器"><span></span><code>$ ls -lh starindex    |cut -d<span>" "</span> -f 5-<br><br> 459 8月  30 16:07 chrLength.txt<br> 943 8月  30 16:07 chrNameLength.txt<br> 484 8月  30 16:07 chrName.txt<br> 666 8月  30 16:07 chrStart.txt<br> 30M 8月  30 16:20 exonGeTrInfo.tab<br> 12M 8月  30 16:20 exonInfo.tab<br>1.1M 8月  30 16:20 geneInfo.tab<br>2.7G 8月  30 16:23 Genome<br> 623 8月  30 16:23 genomeParameters.txt<br> 12G 8月  30 16:23 SA<br>1.5G 8月  30 16:23 SAindex<br>8.1M 8月  30 16:20 sjdbInfo.txt<br>6.4M 8月  30 16:20 sjdbList.fromGTF.out.tab<br>6.4M 8月  30 16:20 sjdbList.out.tab<br>8.9M 8月  30 16:20 transcriptInfo.tab<br><br></code></pre><p data-tool="mdnice编辑器">还需要使用 gtf 文件生成features.tsv 文件，这个时候可以使用百迈客官网软件 BSCMatrix_v1.6.tar.gz  里面的系列小工具。</p><pre data-tool="mdnice编辑器"><span></span><code>perl  BSCMatrix_v1.6/tools/features_generate.pl \<br>-i Mus_musculus.GRCm39.107.chr.gtf -o features.tsv <br></code></pre><p data-tool="mdnice编辑器">文件如下所示：</p><pre data-tool="mdnice编辑器"><span></span><code>2.4M 8月  30 15:52 features.tsv<br></code></pre><p data-tool="mdnice编辑器">准备工作就差不多了，主要是软件和参考基因组及其注释文件啦。</p><h3 data-tool="mdnice编辑器"><span></span>编写配置文件<span></span></h3><p data-tool="mdnice编辑器">主要是需要指定一下 fastq的测序文件路径，自己构建好的对应的参考基因组及其注释文件以及其star软件的index的路径。因为是小鼠，所以命名为  configm.txt 这个文本文件， 内容如下所示：</p><pre data-tool="mdnice编辑器"><span></span><code><span>### Globle parameters</span><br><span>## data</span><br>FQ1 /home/jmzeng/baimaike/20220424-2-02_good_1.fq.gz<br>FQ2 /home/jmzeng/baimaike/20220424-2-02_good_2.fq.gz<br><br><span>## Ref genome</span><br>INDEX /home/jmzeng/baimaike/run/starindex<br>GFF /home/jmzeng/baimaike/run/Mus_musculus.GRCm39.107.chr.gff3<br><br><span>## out put</span><br>OUTDIR /home/jmzeng/baimaike/run/outdirm2<br>PREFIX <span>test</span><br><br><span>### Local parameters</span><br><span>## fastq2BcUmi</span><br>MinKmerNum 3<br><br><span>## Umi2Gene</span><br>Sjdboverhang 100<br>Threads     8<br><br><span>## MatrixMake</span><br>FEATURE /home/jmzeng/baimaike/run/features.tsv<br><br><span>## QC</span><br>EC 3000<br><br></code></pre><p data-tool="mdnice编辑器">每个人编写这个配置文件都必须对自己的的计算机有足够的认知，里面的很多路径都是因人而异的。大家自己把这些文件存放的路径肯定不是我上面写的 /home/jmzeng/baimaike/</p><h3 data-tool="mdnice编辑器"><span></span>运行定量程序<span></span></h3><p data-tool="mdnice编辑器">最后进行下面命令得出结果网页版报告 html 文件 ，网页版报告 src 目录， 收集的基因表达矩阵等文件目录 。芯片对应的 barcode 类型文件， barcode 类型、对应的 umi 及 reads 数统计文件，features 文件 ，基因表达矩阵文件。</p><p data-tool="mdnice编辑器">流程分为 5 个步骤，如下所示：</p><p data-tool="mdnice编辑器">A）步骤 1：运行 fastq2BcUmiSC，识别 fastq 数据中的 barcode、umi。</p><p data-tool="mdnice编辑器">B）步骤 2：运行 Umi2Gene，将 reads 与参考基因组比对，得到每个 UMI 对应的基因信息。</p><p data-tool="mdnice编辑器">C）步骤 3：运行 MatrixMake，获得基因表达矩阵。</p><p data-tool="mdnice编辑器">D）步骤 4：运行 QC，过滤基因表达数据与统计。</p><p data-tool="mdnice编辑器">E）步骤 5：运行 WebReport，得到网页版报告。</p><p data-tool="mdnice编辑器">2）流程参数：</p><p data-tool="mdnice编辑器">-c config.txt 数据配置文件</p><p data-tool="mdnice编辑器">-s 步骤选择，0 为运行 1-5 所有步骤，也可选择个别步骤单独运行，多个步骤中间使用“，”</p><p data-tool="mdnice编辑器">分割。这里我们直接选择0 ， 就运行 1-5 所有步骤：</p><pre data-tool="mdnice编辑器"><span></span><code>mkdir /home/jmzeng/baimaike/run/outdirm2/<br>nohup ./BSCMatrix_v1.6/BSCMatrix -c configm.txt -s  3,4,5 &amp;<br><span># 因为模块问题，我反复在3这个步骤报错，不过不影响我们的定量 </span><br><span># rm -rf  outdirm2/test/</span><br><span># rm outdirm2/03.MatrixMake/*</span><br></code></pre><p data-tool="mdnice编辑器">如果每个步骤都成功了的话，那么 1-5 的每个步骤都会有各自对应的文件夹输出：</p><pre data-tool="mdnice编辑器"><span></span><code>9月   2 03:30 01.fastq2BcUmiSC<br>9月   2 14:44 02.Umi2Gene<br>9月   2 20:55 03.MatrixMake<br>9月   2 15:05 04.QC<br>9月   2 20:55 <span>test</span><br><br>$ ls -lh outdirm2/<span>test</span>/|cut -d<span>" "</span> -f 6-<br><br>9月   2 20:55 features.tsv.gz<br>29M 9月   2 20:55 matrix.mtx.gz<br><br></code></pre><p data-tool="mdnice编辑器">因为模块问题，我反复在3这个步骤报错，不过不影响我们的定量。虽然缺席了barcodes.tsv.gz，但是有了 matrix.mtx.gz矩阵，以及对应的 features.tsv.gz，就可以走后面的降维聚类分群啦。</p><h3 data-tool="mdnice编辑器"><span></span>读取表达量矩阵进行降维聚类分群<span></span></h3><h4 data-tool="mdnice编辑器"><span></span>分别读取matrix.mtx.gz矩阵和基因信息features.tsv.gz<span></span></h4><pre data-tool="mdnice编辑器"><span></span><code>rm(list=ls())<br>options(stringsAsFactors = F) <br>library(Seurat)<br>library(ggplot2)<br>library(clustree)<br>library(cowplot)<br>library(dplyr)<br><br><span>###### step1:导入数据 ######   </span><br>library(data.table)<br>library(Matrix)<br><br><span># https://hbctraining.github.io/scRNA-seq/lessons/readMM_loadData.html </span><br>mtx=readMM( <span>"matrix.mtx.gz"</span> )<br>mtx[1:4,1:4]<br>dim(mtx)<br><br>library(data.table)<br><span># cl=fread( "inputs/barcodes.tsv.gz"   ,</span><br><span>#           header = F,data.table = F ) </span><br><span># head(cl)</span><br><br>rl=fread(  <span>"features.tsv.gz"</span> ,<br>          header = F,data.table = F ) <br><span>#head(cl)</span><br>head(rl)  <br>dim(mtx)<br>colnames(mtx)= paste0(<span>'bar'</span>,1:ncol(mtx))<br>rownames(mtx)=rl<span>$V2</span><br>sce.all=CreateSeuratObject(counts =  mtx ,<br>                           project =  <span>'mouse'</span>,<br>                           min.cells = 5,min.features = 300)<br>sce.all<br><br>as.data.frame(sce.all@assays<span>$RNA</span>@counts[1:10, 1:2])<br>head(sce.all@meta.data, 10)<br>table(sce.all<span>$orig</span>.ident)<br></code></pre><p data-tool="mdnice编辑器">然后就可以降维聚类分群,之前在《生信技能树》公众号的一个教程：<a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247508352&amp;idx=1&amp;sn=7460909f1c9946cdb4d8fa63e9347ed6&amp;scene=21#wechat_redirect" data-linktype="2">这也能画？</a>，我提到了一个很无聊的R包，名字是：scRNAstat ，它可以4行代码进行单细胞转录组的降维聚类分群，其实完全没有技术含量， 就是把 Seurat 流程的一些步骤包装成为了4个函数：</p><ul data-tool="mdnice编辑器"><li><section>basic_qc (查看数据质量)</section></li><li><section>basic_filter （进行一定程度的过滤）</section></li><li><section>basic_workflow （降维聚类分群）</section></li><li><section>basic_markers（检查各个亚群的标记基因）</section></li></ul><p data-tool="mdnice编辑器">我们就使用它来处理这个单细胞转录组对象。</p><pre data-tool="mdnice编辑器"><span></span><code><br>x=<span>'baimaike'</span><br>dir.create( x )<br>sce = sce.all<br>library(scRNAstat)<br>sce = basic_qc(sce=sce,org=<span>'mouse'</span>,<br>               dir = x) ;sce<br><span>#sce = basic_filter(sce)  ;sce</span><br>sce = basic_workflow(sce,dir = x)   ;sce<br>markers_figures &lt;- basic_markers(sce,<br>                                 org=<span>'mouse'</span>,<br>                                 group=<span>'seurat_clusters'</span>,<br>                                 dir = x)<br></code></pre><p data-tool="mdnice编辑器">如下所示的分群：</p><p><img data-galleryid="" data-ratio="0.9891826923076923" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wwibaxwEic81xIjPR3Se3E2F6W5Efs10fz5uTmpP9EIRL7cPFlMdVgB5Aic0U9T4OYhCl2Fqays6mibzQ/640?wx_fmt=png" data-type="png" data-w="832" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wwibaxwEic81xIjPR3Se3E2F6W5Efs10fz5uTmpP9EIRL7cPFlMdVgB5Aic0U9T4OYhCl2Fqays6mibzQ/640?wx_fmt=png"></p><figure data-tool="mdnice编辑器"><figcaption>降维后的umap图展示不同分群</figcaption></figure><p data-tool="mdnice编辑器">简单的看一下基因表达量情况， 11是成纤维， 9是巨噬细胞，其它应该是都是皮肤细胞吧？</p><p><img data-galleryid="" data-ratio="0.719626168224299" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wwibaxwEic81xIjPR3Se3E2F61CJk86kHykcf1q7kEghHicBJDEv8rSPBNVLHBnS2YauQnJZXWX9ABIg/640?wx_fmt=png" data-type="png" data-w="749" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wwibaxwEic81xIjPR3Se3E2F61CJk86kHykcf1q7kEghHicBJDEv8rSPBNVLHBnS2YauQnJZXWX9ABIg/640?wx_fmt=png"></p><figure data-tool="mdnice编辑器"><figcaption>各个单细胞亚群top3基因</figcaption></figure><h3 data-tool="mdnice编辑器"><span></span>空间单细胞转录组也是类似的处理<span></span></h3><p data-tool="mdnice编辑器">下载百迈客官网软件，解压即可，其它环境可以使用前面配置好的conda</p><pre data-tool="mdnice编辑器"><span></span><code>wget http://www.bmkmanu.com/wp-content/uploads/2022/08/BSTMatrix_v1.8.tar.gz &amp;<br></code></pre><p data-tool="mdnice编辑器">然后就是制作配置文件时候需要指定 he.tif 以及 flu_signal.txt ，因为有图片需要处理，所以需要安装cv2模块。</p><p data-tool="mdnice编辑器">同样的，流程分为6个步骤，如下所示：</p><ul data-tool="mdnice编辑器"><li><section>步骤1：运行fastq2BcUmi，识别fastq数据中的barcode、umi。</section></li><li><section>步骤2：运行LinkBcChip，识别荧光数据的barcode信息并对应到芯片上位置。</section></li><li><section>步骤3：运行Umi2Gene，将reads与参考基因组比对，得到每个UMI对应的基因信息。</section></li><li><section>步骤4：运行MatrixMake，获得基因表达矩阵。</section></li><li><section>步骤5：运行AllheStat，处理HE图片。</section></li><li><section>步骤6：运行WebReport，得到网页版报告。</section></li></ul><p data-tool="mdnice编辑器">-c  config.txt 数据配置文件</p><p data-tool="mdnice编辑器">-s  步骤选择，0为运行1-6所有步骤，也可选择个别步骤单独运行，多个步骤中间使用“，”分割。</p></section><p><br></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/orc_vcIJbXKwo-cfax0Zig",target="_blank" rel="noopener noreferrer">原文链接</a>
