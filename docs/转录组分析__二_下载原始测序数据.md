---
title: "转录组分析|（二）下载原始测序数据"
date: 2022-10-11T00:00:41Z
draft: ["false"]
tags: [
  "fetched",
  "医学生之学习生信"
]
categories: ["Acdemic"]
---
转录组分析|（二）下载原始测序数据 by 医学生之学习生信
------
<div><section><section><p>转录组实战的第一步是获取原始测序数据，其中公共数据库下载是获取转录组原始数据的主要途径之一。下面小编将讲解如何下载sra格式的数据并将其转换成fastq文件。</p><p><span>sra文件下载</span></p><p>首先我们登录服务器，做一些简单的准备工作</p><pre><code><span>#</span><span>激活conda小环境</span><br>conda activate rna<br><span>#</span><span>进入项目文件夹</span><br>cd ~/project<br><span>#</span><span>创建每一步数据的文件夹</span><br>mkdir -p {sra,fastq}<br></code></pre><p>原始数据由NCBI的SRA数据库获取</p><p>SRA数据库（Short Read Archive)储存着海量的公开的高通量测序数据。</p><p>官网网址：http://www.ncbi.nlm.nih.gov/sra</p><p>SRA数据库中包含四级结构：</p><p>1.NCBI BioProject(PRJN···):表示单个研究计划，包含研究的多个样本和数据集</p><p>2.NCBI BioSample(SAMN···/SRS···)：描述生物来源的材料，每个物理上独特的标本应注册为一个BioSample</p><p>3.SRA实验（SRX···):特定样本的独特测序文库</p><p>4.SRA Run（SRR···/ERR···）：是连接到给定测序库的数据文件清单</p><p>那么当我们从文献中获得一个GEO样本编号，我们就可以链接到SRA数据库，获取它的原始测序数据。</p><p>下面以AML数据集GSE153348为例，简述数据的下载过程：</p><p>首先登陆NCBI的GEO数据库，搜索“GSE153348”，进入以下页面</p><p><img data-ratio="0.4861111111111111" data-src="https://mmbiz.qpic.cn/mmbiz_png/dgYTF46r3icY2soFzjAth0RjDOl5FcBdznIeicm7Ug8bz1KCqMfbH7YibZraJBWOTL9Xe34ic6KSIE7WXfzkOTHvfg/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/dgYTF46r3icY2soFzjAth0RjDOl5FcBdznIeicm7Ug8bz1KCqMfbH7YibZraJBWOTL9Xe34ic6KSIE7WXfzkOTHvfg/640?wx_fmt=png"></p><p>拖到页面下方，找到“SRA Run Selector"并点击，就可以跳转到SRA数据库</p><p><img data-ratio="0.4861111111111111" data-src="https://mmbiz.qpic.cn/mmbiz_png/dgYTF46r3icY2soFzjAth0RjDOl5FcBdzPRvXImHiasAPxlxkRnJk0sPibLiciavAexendSmXZUuGvBib2Hsvx0uT28w/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/dgYTF46r3icY2soFzjAth0RjDOl5FcBdzPRvXImHiasAPxlxkRnJk0sPibLiciavAexendSmXZUuGvBib2Hsvx0uT28w/640?wx_fmt=png"></p><p>可以查看数据集的基本信息，然后点击”Accession List"，下载一个txt文件（SRR_Acc_List.txt），里面包含数据集的SRA Run（也可以理解为下载数据清单），将该数据上传到服务器。</p><p><img data-ratio="0.4861111111111111" data-src="https://mmbiz.qpic.cn/mmbiz_png/dgYTF46r3icY2soFzjAth0RjDOl5FcBdzCGwvASjVgSqtZqr4Mdlty9LsiajMoNYBtIoiaDgu69c0bAQn8674AnKg/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/dgYTF46r3icY2soFzjAth0RjDOl5FcBdzCGwvASjVgSqtZqr4Mdlty9LsiajMoNYBtIoiaDgu69c0bAQn8674AnKg/640?wx_fmt=png"></p><p>接下来我们使用SRA Toolkit工具包下载和转换SRA数据</p><pre><code><span>#</span><span><span>#进入之前创建的sra文件夹</span></span><br>cd ./project/sra<br><span><br>#</span><span><span>#单个数据下载</span></span><br>prefetch SRR12097378<br><span><br>#</span><span><span>#批量下载,这时候就需要用到SRR_Acc_List.txt</span></span><br><span>#</span><span>查看文件</span><br>cat SRR_Acc_List.txt<br><span>#</span><span>批量</span><br>prefetch --option-file SRR_Acc_List.txt<br><span><br>#</span><span>循环操作,-O决定输出的文件夹(绝对路径)</span><br>cat SRR_Acc_List.txt | while read id<br>do<br>prefetch ${id} -O ~/.../sra<br>done<br><span><br>#</span><span>也可以创建脚本</span><br>vi sra.sh<br><span>#</span><span>按i进入vim编辑器的输入模式</span><br>cat SRR_Acc_List.txt | while read id<br>do<br>prefetch ${id} -O ~/.../sra<br>done<br><span>#</span><span>按esc键退出输入模式，保存并退出vim编辑器</span><br>:wq<br><span>#</span><span>运行脚本</span><br>bash sra.sh</code></pre><p><br></p><p><br></p><p><span>sra转换为fastq格式</span></p><p>ps:双端测序数据一个SRR文件对应两个fastq文件</p><pre><code><span>#</span><span><span>#转到下一文件夹</span></span><br>cd ../fastq<br><span><br>#</span><span><span>#将下载的sra文件软链接到当前文件夹</span></span><br>ln ~/project/sra/*.sra ./<br><span><br>#</span><span><span>#单个数据转换</span></span><br>fastq-dump --gzip --split-e -O ./ SRR12097378<br><span><br>#</span><span><span>#批量转换</span></span><br>ls */sra | while read id<br>do<br>fastq-dump --gzip --split-e -O ./ ${id}<br>done<br><span><br>#</span><span>也可以创建脚本</span><br>vi fastq.sh<br><span>#</span><span>按i进入vim编辑器的输入模式</span><br>ls */sra | while read id<br>do<br>fastq-dump --gzip --split-e -O ./ ${id}<br>done<br><span>#</span><span>按esc键退出输入模式，保存并退出vim编辑器</span><br>:wq<br><span>#</span><span>运行脚本</span><br>bash fastq.sh<br><span><br>#</span><span><span>#fastq-dump常用参数解析</span></span><br><span>-O#</span><span>设置输出目录</span><br><span>--gzip#</span><span>将输出结果使用gzip格式压缩</span><br><span>--split-e#</span><span>将sra格式转换成双末端fastq文件</span><br>-X #转换的最大记录数<br></code></pre><p><span>fastq文件简介</span></p><pre><code>#查看<span>fastq</span>文件<br><span>zless</span> <span>SRR12097386_2</span><span>.fastq</span><span>.gz</span><br></code></pre><p><br></p><p><br></p><p><img data-ratio="0.16043613707165108" data-src="https://mmbiz.qpic.cn/mmbiz_png/dgYTF46r3icY2soFzjAth0RjDOl5FcBdziaibOfUnNKasg81icq1EIuxDKTQia6EMiaBTILJZKE2amgEDB3xo8299Vlw/640?wx_fmt=png" data-type="png" data-w="642" src="https://mmbiz.qpic.cn/mmbiz_png/dgYTF46r3icY2soFzjAth0RjDOl5FcBdziaibOfUnNKasg81icq1EIuxDKTQia6EMiaBTILJZKE2amgEDB3xo8299Vlw/640?wx_fmt=png"></p><p><br></p><p><span>fastq文件每四行为一个单位</span><br></p><p>第一行：以@开头，随后为lllumina测序识别符（Sequence Identifiers)和描述文字（也可以没有）<br>第二行：碱基序列（ATCG）<br>第三行：以“+”开头，随后为lllumina测序识别符（与第一行相同，也可以没有）<br>第四行：对应序列的测序质量的ASCll码（碱基的质量值）</p></section><p><img data-galleryid="" data-ratio="0.64" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/dgYTF46r3icZFpKZBAw8MpYzPEzcVePTuSDibbVfErqsQdsEYmP3BydBFWtuJJ7Vc9zzeshD1yk3SGmu0uNNXclg/640?wx_fmt=png" data-type="png" data-w="1000" src="https://mmbiz.qpic.cn/mmbiz_png/dgYTF46r3icZFpKZBAw8MpYzPEzcVePTuSDibbVfErqsQdsEYmP3BydBFWtuJJ7Vc9zzeshD1yk3SGmu0uNNXclg/640?wx_fmt=png"></p><p>作者：胡嘉怡<br></p><p>编辑：胡嘉怡<br></p><p>校审：林炳昱<br></p></section><section><p><br></p></section><p><br></p><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/zVj3XJ_kuh9DqYE515v8uQ",target="_blank" rel="noopener noreferrer">原文链接</a>
