---
title: "ggplot2分组条形图饼图箱线图"
date: 2022-09-29T05:20:29Z
draft: ["false"]
tags: [
  "fetched",
  "生信喵实验柴"
]
categories: ["Acdemic"]
---
ggplot2分组条形图饼图箱线图 by 生信喵实验柴
------
<div><p><img data-galleryid="" data-ratio="0.2777777777777778" data-src="https://mmbiz.qpic.cn/mmbiz_gif/IAFet2H8TicyQzmBltWrwCrk3uRWeFvRtMiaUqTHyHeRImPcG0bQ1I0wkXbcL5icibMakSmAhU2ibz9ABuWcoZ3j6Kg/640?wx_fmt=gif" data-type="gif" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_gif/IAFet2H8TicyQzmBltWrwCrk3uRWeFvRtMiaUqTHyHeRImPcG0bQ1I0wkXbcL5icibMakSmAhU2ibz9ABuWcoZ3j6Kg/640?wx_fmt=gif"></p><p><span><strong>一、分组条形图</strong></span></p><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="bash"><code><span>x &lt;- read.csv(<span>"sv_distrubution.csv"</span>,header = T)  </span></code><code><span>x  </span></code><code><span><span># svs &lt;- x %&gt;% tidyr::pivot_longer(cols = 2:5,names_to = 'variation')</span></span></code><code><span>svs &lt;- x %&gt;% gather(key = Variation,value =Number,-X)</span></code><code><span>ggplot(data = svs,aes(x=X,y=Number))+geom_bar(<span>stat</span> = <span>"identity"</span>)</span></code><code><span>ggplot(data = svs,aes(x=X,y=Number,fill=Variation))+geom_bar(<span>stat</span> = <span>"identity"</span>)</span></code><code><span><br></span></code><code><span>p &lt;- ggplot(data = svs,aes(x=X,y=Number,fill=Variation))+geom_bar(<span>stat</span> = <span>"identity"</span>) </span></code><code><span>p + scale_x_discrete(limits=x<span>$X</span>)</span></code><code><span>p + scale_x_discrete(limits=x<span>$X</span>) + scale_fill_brewer(palette = 1,<span>type</span> = <span>'seq'</span>)</span></code><code><span>p + scale_x_discrete(limits=x<span>$X</span>) + scale_fill_brewer(palette = 2,<span>type</span> = <span>'seq'</span>)</span></code><code><span>p + scale_x_discrete(limits=x<span>$X</span>) + scale_fill_brewer(palette = 2,<span>type</span> = <span>'div'</span>)</span></code><code><span>p + scale_x_discrete(limits=x<span>$X</span>) + scale_fill_brewer(palette = 3,<span>type</span> = <span>'div'</span>)</span></code><code><span>p + scale_x_discrete(limits=x<span>$X</span>) + scale_fill_brewer(palette = 4,<span>type</span> = <span>'div'</span>)</span></code><code><span>p + scale_x_discrete(limits=x<span>$X</span>) + scale_fill_brewer(palette = <span>'Set2'</span>,<span>type</span> = <span>'div'</span>)</span></code><code><span>p + scale_x_discrete(limits=x<span>$X</span>) + scale_fill_brewer(palette = <span>'Set1'</span>,<span>type</span> = <span>'div'</span>)</span></code><code><span>p + scale_x_discrete(limits=x<span>$X</span>) + scale_fill_brewer(palette = <span>'Set1'</span>)</span></code><code><span>p + scale_x_discrete(limits=x<span>$X</span>) + scale_fill_brewer(palette = <span>'Blues'</span>)</span></code><code><span><br></span></code><code><span>ggplot(data = svs,aes(x=X,y=Number,fill=Variation))+geom_bar(<span>stat</span> = <span>"identity"</span>,position=<span>'dodge'</span>)</span></code><code><span>ggplot(data = svs,aes(x=X,y=Number,fill=Variation))+geom_bar(<span>stat</span> = <span>"identity"</span>,position=<span>'dodge2'</span>)</span></code><code><span>ggplot(data = svs,aes(x=X,y=Number,fill=Variation))+geom_bar(<span>stat</span> = <span>"identity"</span>,position=<span>'fill'</span>)</span></code><code><span>ggplot(data = svs,aes(x=X,y=Number,fill=Variation))+geom_bar(<span>stat</span> = <span>"identity"</span>,position=<span>'stack'</span>)</span></code><code><span><br></span></code><code><span>p + scale_x_discrete(limits=x<span>$X</span>) + scale_fill_brewer(palette = <span>'Set1'</span>)+</span></code><code><span>  labs(title =<span>"SV Distribution"</span>,x=<span>"Chromosome Number"</span>,y=<span>"SV Numbers"</span>) +</span></code><code><span>  theme(legend.position = <span>'bottom'</span>,plot.title = element_text(hjust = 0.5))</span></code></pre></section><p><img data-ratio="0.9162861491628614" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/IAFet2H8TicyTcibVtWT4C6u6UA5ykVsftoibjiciaSpoF4ZWbHI5TVyzKegBibNwCiariaXhN5Tyia46boRM6ABicDhQNrg/640?wx_fmt=png" data-type="png" data-w="657" src="https://mmbiz.qpic.cn/mmbiz_png/IAFet2H8TicyTcibVtWT4C6u6UA5ykVsftoibjiciaSpoF4ZWbHI5TVyzKegBibNwCiariaXhN5Tyia46boRM6ABicDhQNrg/640?wx_fmt=png"></p><p>ggplot2 绘制基因组 SV 突变堆叠条形图</p><section><ul><li><li><li><li></ul><pre data-lang="nginx"><code><span><span>p</span> + scale_x_discrete(limits=x<span>$X</span>) + scale_fill_brewer(palette = <span>'Set1'</span>)+</span></code><code><span>  labs(title =<span>"SV Distribution"</span>,x=<span>"Chromosome Number"</span>,y=<span>"SV Numbers"</span>) +</span></code><code><span>  theme(legend.position = <span>'bottom'</span>,plot.title = element_text(hjust = <span>0</span>.<span>5</span>)) +</span></code><code><span>  coord_polar() +guides(fill=<span>'none'</span>)</span></code></pre></section><p><img data-ratio="0.9381761978361669" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/IAFet2H8TicyTcibVtWT4C6u6UA5ykVsftR1Mpy9VFchFDCO5iavLRUaicA8uL57YDygLsVwl4lLpia0M3OL9SR5xGA/640?wx_fmt=png" data-type="png" data-w="647" src="https://mmbiz.qpic.cn/mmbiz_png/IAFet2H8TicyTcibVtWT4C6u6UA5ykVsftR1Mpy9VFchFDCO5iavLRUaicA8uL57YDygLsVwl4lLpia0M3OL9SR5xGA/640?wx_fmt=png"></p><p><br></p><p><span><strong>二、饼图</strong></span></p><section><ul><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="kotlin"><code><span>m &lt;- read.table(<span>"Species.txt"</span>,sep = <span>'\t'</span>,header = FALSE)</span></code><code><span>head(m)</span></code><code><span>sum(m$V3)</span></code><code><span>name &lt;- paste(m[,<span>1</span>],m[,<span>2</span>],<span>'\n'</span>,m$V3,<span>'%'</span>)</span></code><code><span>name</span></code><code><span>ggplot(<span>data</span> = m,aes(x = <span>""</span>,y=V3,fill=name))+geom_bar(stat = <span>'identity'</span>) +</span></code><code><span>  coord_polar(theta = <span>'y'</span>)+guides(fill = <span>'none'</span>)+scale_fill_brewer(palette = <span>'Set1'</span>)</span></code><code><span># y &lt;- paste(m[,<span>1</span>],m[,<span>2</span>])</span></code><code><span># x &lt;- <span>data</span>.frame(name=y,values=m$V3/sum(m$V3))</span></code><code><span># p &lt;- ggplot(<span>data</span> = x,aes(x = <span>""</span>,y=values,fill=name))+geom_bar(stat = <span>"identity"</span>,width = <span>1</span>)+guides(fill=<span>'none'</span>)</span></code><code><span># p</span></code><code><span># p+coord_polar(theta = <span>'y'</span>)+labs(x = <span>''</span>, y = <span>''</span>, title = <span>''</span>)</span></code></pre></section><p><img data-ratio="1.0032894736842106" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/IAFet2H8TicyTcibVtWT4C6u6UA5ykVsftHj6Q0iaWWyPjYxK7MPZGI90O3GCGm7nOp90lPDJDicPnJ1rO89o0jaUg/640?wx_fmt=png" data-type="png" data-w="608" src="https://mmbiz.qpic.cn/mmbiz_png/IAFet2H8TicyTcibVtWT4C6u6UA5ykVsftHj6Q0iaWWyPjYxK7MPZGI90O3GCGm7nOp90lPDJDicPnJ1rO89o0jaUg/640?wx_fmt=png"></p><p>ggplot2 绘制饼图</p><p><br></p><p><span><strong>三、箱线图</strong></span></p><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="powershell"><code><span>head(ToothGrowth)</span></code><code><span>ToothGrowth<span>$dose</span> &lt;- as.factor(ToothGrowth<span>$dose</span>)</span></code><code><span><span>#按提供药物种类分组</span></span></code><code><span>ggplot(<span>data</span> = ToothGrowth,aes(x=supp,y=len,fill=supp))+geom_boxplot()</span></code><code><span><span>#按剂量分组</span></span></code><code><span>ggplot(<span>data</span> = ToothGrowth,aes(x=dose,y=len,group=dose,fill=dose))+geom_boxplot()</span></code><code><span><span>#两组</span></span></code><code><span>ggplot(<span>data</span> = ToothGrowth,aes(x=dose,y=len,group=supp:dose,fill=supp:dose))+geom_boxplot()</span></code><code><span>ggplot(<span>data</span> = ToothGrowth,aes(x=dose,y=len,group=supp:dose,fill=supp))+geom_boxplot()</span></code><code><span>ggplot(<span>data</span> = ToothGrowth,aes(x=dose,y=len,group=supp:dose,fill=dose))+geom_boxplot()</span></code><code><span>ggplot(<span>data</span> = ToothGrowth,aes(x=supp,y=len,group=supp:dose,fill=dose))+geom_boxplot()</span></code><code><span><br></span></code><code><span><span>#box图加抖动点</span></span></code><code><span>p&lt;- ggplot(<span>data</span> = ToothGrowth,aes(x=dose,y=len,fill=dose))+geom_boxplot()+</span></code><code><span>  geom_jitter(width = <span>0.1</span>)</span></code><code><span>p+labs(title = <span>'ToothGrowth VC vs OJ'</span>,x=<span>'DOSE'</span>,y=<span>'Length'</span>)+</span></code><code><span>  scale_fill_brewer(palette = <span>'Set1'</span>) +</span></code><code><span>  theme(plot.title = element_text(hjust = <span>0.5</span>)) +</span></code><code><span>  theme(legend.position = <span>'bottom'</span>)</span></code></pre></section><p><img data-ratio="0.8949771689497716" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/IAFet2H8TicyTcibVtWT4C6u6UA5ykVsftgSP3JnianR20qjq83N7C8iczibF7zHuclV4a0wvlzltjZ5JoJSib4NzE8Q/640?wx_fmt=png" data-type="png" data-w="657" src="https://mmbiz.qpic.cn/mmbiz_png/IAFet2H8TicyTcibVtWT4C6u6UA5ykVsftgSP3JnianR20qjq83N7C8iczibF7zHuclV4a0wvlzltjZ5JoJSib4NzE8Q/640?wx_fmt=png"></p><p>ggplot2 绘制箱线图加抖动的点</p><section><ul><li><li><li><li></ul><pre data-lang="cs"><code><span><span>#分面</span></span></code><code><span>ggplot(data = ToothGrowth,aes(x=supp,y=len,<span>group</span>=supp:dose,fill=supp))+geom_boxplot()+</span></code><code><span>  scale_fill_brewer(palette = <span>'Set1'</span>)+</span></code><code><span>  facet_grid(~ supp,scales = <span>'free'</span>)</span></code></pre></section><p><img data-ratio="0.9310872894333844" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/IAFet2H8TicyTcibVtWT4C6u6UA5ykVsftc9ns6x0MpXIB49756gJywBspx9U75J6YgWM7HEUzJsozCtwywpT3yg/640?wx_fmt=png" data-type="png" data-w="653" src="https://mmbiz.qpic.cn/mmbiz_png/IAFet2H8TicyTcibVtWT4C6u6UA5ykVsftc9ns6x0MpXIB49756gJywBspx9U75J6YgWM7HEUzJsozCtwywpT3yg/640?wx_fmt=png"></p><p>ggplot2 绘制分面箱线图</p><p><img data-galleryid="" data-ratio="0.18518518518518517" data-src="https://mmbiz.qpic.cn/mmbiz_gif/IAFet2H8TicyQzmBltWrwCrk3uRWeFvRt1j7lLnMghic28HDCOogn7EfSWJf68twl5FIo1nRhY4qcpCaVPV7L9vA/640?wx_fmt=gif" data-type="gif" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_gif/IAFet2H8TicyQzmBltWrwCrk3uRWeFvRt1j7lLnMghic28HDCOogn7EfSWJf68twl5FIo1nRhY4qcpCaVPV7L9vA/640?wx_fmt=gif"></p><p>     写在最后：有时间我们会努力更新的。大家互动交流可以前去论坛，地址在下面，复制去浏览器即可访问，弥补下公众号没有留言功能的缺憾。</p><section><ul><li></ul><pre data-lang="css"><code><span><span>bioinfoer</span><span>.com</span></span></code></pre></section><p>     有些板块也可以预设为大家日常趣事的分享等，欢迎大家来提建议。</p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/iARbDD6foxS8cwe9Bc0d-Q",target="_blank" rel="noopener noreferrer">原文链接</a>
