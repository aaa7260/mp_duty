---
title: "ggplot2优雅绘制时间趋势变化散点图"
date: 2022-11-19T03:19:40Z
draft: ["false"]
tags: [
  "fetched",
  "R语言数据分析指南"
]
categories: ["Acdemic"]
---
ggplot2优雅绘制时间趋势变化散点图 by R语言数据分析指南
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><h3 data-tool="mdnice编辑器"><span></span><span><span></span>欢迎关注R语言数据分析指南</span><span></span></h3><blockquote data-tool="mdnice编辑器"><span>❝</span><p>本节来介绍一个小案例，如何绘制趋势变化散点图，数据主要展示世界主要国家近70年间GDP收入与lifeExp之间的关系，通过时间趋势的变化来更加直观的查看结果。<strong>「数据+代码已经上传VIP群，加群的观众老爷请自行下载」</strong></p><span>❞</span></blockquote><blockquote data-tool="mdnice编辑器"><span>❝</span><p><code>有需要学习数据可视化的朋友欢迎加入小编2022年度VIP群</code>，目前群内已经上传公众号文档<strong>「数据+代码约260篇」</strong>，<code>VIP交流群(1)已经500人满员</code>,随着内容不断增多，为了更好的创做内容现在进群需<strong>「付费149元」</strong> 双十一临近小编也做一波优惠活动 <strong>「从即日起至11月底无需转发文档到朋友圈积赞，可直接已129元的价格入群」</strong></p><span>❞</span></blockquote><h3 data-tool="mdnice编辑器"><span></span><span><span></span>淘宝店铺个性化绘图服务</span><span></span></h3><blockquote data-tool="mdnice编辑器"><span>❝</span><p>最近有部分观众老爷找小编做个性化绘图，为了给观众老爷提供更加优质的服务；小编开通了 <strong>「淘宝店铺(R语言数据分析指南)」</strong> ，有特殊绘图需求的欢迎关注咨询(<strong>「由于小编时间精力有限有需求的请及时下单」</strong>)</p><span>❞</span></blockquote><h3 data-tool="mdnice编辑器"><span></span><span><span></span>加载R包</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code><span>library</span>(tidyverse)<br><span>library</span>(scales)<br><span>library</span>(camcorder)<br><span>library</span>(shadowtext)<br><span>library</span>(ggh4x)<br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span><span></span>数据清洗</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code>df &lt;- read_tsv(<span>"data.xls"</span>) %&gt;% <br><span># 由于海湾战争的缘故Kuwait的数据比较异常因此在此剔除</span><br>  filter(country!=<span>"Kuwait"</span>,continent!=<span>"Oceania"</span>) %&gt;% <br>  arrange(year) %&gt;% <br>  group_by(country) %&gt;% <br>  mutate(label = if_else(year == max(year), country, <span>NULL</span>)) %&gt;% <br>  ungroup()<br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span><span></span>自定义分面</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code>ridiculous_strips &lt;- strip_themed(<br>  text_x = elem_list_text(colour=c(<span>"#9C8D58"</span>,<span>"#EDB749"</span>,<span>"#3CB2EC"</span>,<span>"red"</span>),<br>                          face=c(<span>"bold"</span>,<span>"bold"</span>,<span>"bold"</span>),size=c(<span>10</span>,<span>10</span>,<span>10</span>,<span>10</span>)),<br>  background_x = elem_list_rect(fill = c(<span>"#EEECE1"</span>,<span>"#FFF2E7"</span>,<span>"#E8F2FC"</span>,<span>"#E8F2FC"</span>)))<br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span><span></span>数据可视化</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code>ggplot(df,aes(x = gdpPercap, y = lifeExp,<br>                  group = country , label = label)) +<br>  geom_path(aes(size = year), color = <span>"salmon"</span>) +<br>  geom_point(data = df %&gt;% filter(label != <span>""</span>),color = <span>"brown"</span>) +<br>  <span># 定义文本信息</span><br>  geom_shadowtext(aes(alpha = <span>0.5</span>), hjust = <span>0</span>, nudge_y = <span>1</span>,<br>                  nudge_x = <span>1000</span>, check_overlap = <span>TRUE</span>,<br>                  color = <span>"#020271"</span>, size=<span>3.5</span>, bg.colour =  <span>"#CFDBE3"</span>, bg.r = <span>0.08</span>) +<br>  facet_wrap2(vars(continent),scales = <span>"free_y"</span>,axes = <span>"y"</span>,remove_labels = <span>"x"</span>,<br>              strip = ridiculous_strips)+<br>  scale_size_continuous(range = c(<span>0.3</span>, <span>0.8</span>)) +<br>  scale_alpha_identity() +<br>  scale_x_continuous(labels = label_number()) +<br>  coord_cartesian(clip = <span>"off"</span>) +<br>  theme_minimal() +<br>  theme(panel.spacing.x = unit(<span>0.1</span>,<span>"cm"</span>),<br>        panel.spacing.y = unit(<span>0.15</span>,<span>"cm"</span>),<br>        axis.title = element_blank(),<br>        strip.background = element_rect(fill=<span>"grey80"</span>,color=<span>"white"</span>),<br>        strip.text.x = element_text(size=<span>9</span>,color=<span>"black"</span>),<br>        axis.text = element_text(color=<span>"black"</span>),<br>        plot.margin = margin(<span>10</span>,<span>60</span>,<span>10</span>,<span>10</span>),<br>        legend.position = <span>"non"</span>)<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.9467592592592593" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAaKiaVAleNia4pwQhImkflzNkWNchp9yN4vps68AFW8EyXI2NB7BmLRz8xfcHX9LxGD6L4MOo9DpnlA/640?wx_fmt=png" data-type="png" data-w="864" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAaKiaVAleNia4pwQhImkflzNkWNchp9yN4vps68AFW8EyXI2NB7BmLRz8xfcHX9LxGD6L4MOo9DpnlA/640?wx_fmt=png"></figure><blockquote data-tool="mdnice编辑器"><span>❝</span><p>通过结果可以看出北欧等发达国家收入较高人均预期寿命也比较高，此图适用与有时间趋势变化的数据。那么本节介绍到此结束，喜欢的观众老爷欢迎分享转发；<strong>「当然更推荐大家加入我的VIP交流群」</strong>扫描下方二维码加小编微信<strong>「添加小编微信请备注来意，以便高效处理」</strong>，无需求请勿扰</p><span>❞</span></blockquote><h3 data-tool="mdnice编辑器"><span></span><span><span></span>小编微信</span><span></span></h3><p><img data-galleryid="" data-ratio="1" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/EibnicgwScTAaNu6sU2UCYkxFq9ibq75wuaO0lqFoYz1icUo4jh3N2icAWECmibgPvqyReur0FCp7JNKO0icnRAsbO9ug/640?wx_fmt=jpeg" data-type="jpeg" data-w="430" src="https://mmbiz.qpic.cn/mmbiz_jpg/EibnicgwScTAaNu6sU2UCYkxFq9ibq75wuaO0lqFoYz1icUo4jh3N2icAWECmibgPvqyReur0FCp7JNKO0icnRAsbO9ug/640?wx_fmt=jpeg"></p><h3 data-tool="mdnice编辑器"><span></span><span><span></span>关注下方公众号下回更新不迷路</span><span></span></h3><p><img data-galleryid="" data-ratio="0.3193449334698055" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAYib6Vf5Lfu4s64dJIEWhdGMvrcDEx2Rxgd91TOF5sjqy47Wqf2cTO1c5Nhdibh8G5IhOnR53j6XKrw/640?wx_fmt=png" data-type="png" data-w="1954" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAYib6Vf5Lfu4s64dJIEWhdGMvrcDEx2Rxgd91TOF5sjqy47Wqf2cTO1c5Nhdibh8G5IhOnR53j6XKrw/640?wx_fmt=png"></p></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/GPtuMEFaovB4ulJjzhCgYw",target="_blank" rel="noopener noreferrer">原文链接</a>
