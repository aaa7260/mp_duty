---
title: "药物预测之认识表达量矩阵和药物IC50"
date: 2022-11-11T15:15:31Z
draft: ["false"]
tags: [
  "fetched",
  "生信技能树"
]
categories: ["Acdemic"]
---
药物预测之认识表达量矩阵和药物IC50 by 生信技能树
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><blockquote data-tool="mdnice编辑器"><p>药物预测需要训练集，一般来说推荐使用权威资源作为训练集建好模型，这样就可以去预测你自己的数据。</p></blockquote><h3 data-tool="mdnice编辑器"><span></span>权威的药物预测训练集资源<span></span></h3><p data-tool="mdnice编辑器">那么，比较权威的资源一般就是Cancer Therapeutics Response Portal (CTRP) 和 Genomics of Drug Sensitivity in Cancer (<strong>GDSC</strong>)</p><h4 data-tool="mdnice编辑器"><span></span>Cancer Therapeutics Response Portal (CTRP)<span></span></h4><p data-tool="mdnice编辑器">目前主要是CTRP v2，官网是：http://portals.broadinstitute.org/ctrp.v2.1/</p><ul data-tool="mdnice编辑器"><li><section>481 compounds X 860 CCLs</section></li><li><section>correlations to copy-number and gene-expression data</section></li><li><section>mutation data integrate CCLE and Sanger/MGH calls</section></li><li><section>correlation and enrichment analysis on-the-fly</section></li><li><section>box-whisker visualization in addition to enrichment heatmaps</section></li><li><section>drill-down to scatter plots and concentration-response curves</section></li><li><section>flter by lineage/subtype, growth mode</section></li></ul><h4 data-tool="mdnice编辑器"><span></span>Genomics of Drug Sensitivity in Cancer (GDSC)<span></span></h4><p data-tool="mdnice编辑器">官网是：https://www.cancerrxgene.org/</p><p data-tool="mdnice编辑器">如果是v2的版本，有809 Cell lines 以及 198 Compounds</p><p data-tool="mdnice编辑器">如果是看v1版本，987 Cell lines 和 367 Compounds</p><h3 data-tool="mdnice编辑器"><span></span>资源都被整理好了<span></span></h3><p data-tool="mdnice编辑器">我们这里直接使用R包oncoPredict整理好的这两个数据库的rdata文件，下载链接是：https://osf.io/c6tfx/ ，</p><pre data-tool="mdnice编辑器"><span></span><code>oncoPredict<br>Contributors: Danielle Maeser Robert Gruener<br>Date created: 2021-03-26 01:39 PM | Last Updated: 2021-08-15 10:44 PM<br></code></pre><p data-tool="mdnice编辑器">下载约700M，重要的文件 如下所示；</p><pre data-tool="mdnice编辑器"><span></span><code> 171M Aug 14 17:10 CTRP2_Expr (RPKM, log2(x+1) Transformed).rds<br>  177M Apr  3  2021 CTRP2_Expr (TPM, log2(x+1) Transformed).rds<br>  1.1M Apr  3  2021 CTRP2_Res.rds<br>  119M Apr  3  2021 GDSC1_Expr (RMA Normalized and Log Transformed).rds<br>  2.0M Apr  3  2021 GDSC1_Res.rds<br>  100M Apr  3  2021 GDSC2_Expr (RMA Normalized and Log Transformed).rds<br>  906K Apr  3  2021 GDSC2_Res.rds<br></code></pre><p data-tool="mdnice编辑器">可以看到 Cancer Therapeutics Response Portal (CTRP) 数据库里面的细胞系表达量矩阵是来自于转录组测序， 所以 提供了 FPKM和TPM两个版本供用户选择。</p><p data-tool="mdnice编辑器">然后呢 Genomics of Drug Sensitivity in Cancer (GDSC) 数据库里面的细胞系表达量矩阵应该是芯片，因为它使用了  RMA Normalized and Log Transformed ，标准的芯片数据处理方法。</p><h3 data-tool="mdnice编辑器"><span></span>代码探索 (GDSC) 数据库<span></span></h3><p data-tool="mdnice编辑器">直接看 v2的版本，有809 Cell lines 以及 198 Compounds</p><p data-tool="mdnice编辑器">主要是八百多个细胞系的约2万个基因的表达量矩阵，以及对应八百多细胞系的约200个药物的IC50值。</p><pre data-tool="mdnice编辑器"><span></span><code><span>library</span>(reshape2)<br><span>library</span>(ggpubr)<br>th=theme(axis.text.x = element_text(angle = <span>45</span>,vjust = <span>0.5</span>))<br>dir=<span>'./DataFiles/Training Data/'</span><br>GDSC2_Expr = readRDS(file=file.path(dir,<span>'GDSC2_Expr (RMA Normalized and Log Transformed).rds'</span>))<br>dim(GDSC2_Expr)  <br>GDSC2_Expr[<span>1</span>:<span>4</span>, <span>1</span>:<span>4</span>]<br>boxplot(GDSC2_Expr[,<span>1</span>:<span>4</span>])<br>df=melt(GDSC2_Expr[,<span>1</span>:<span>4</span>])<br>head(df)<br>p1=ggboxplot(df, <span>"Var2"</span>, <span>"value"</span>) +th<br><br><span># Read GDSC2 response data. rownames() are samples, colnames() are drugs. </span><br>dir<br>GDSC2_Res = readRDS(file = file.path(dir,<span>"GDSC2_Res.rds"</span>))<br>dim(GDSC2_Res)  <span># 805 198</span><br>GDSC2_Res[<span>1</span>:<span>4</span>, <span>1</span>:<span>4</span>]<br>p2=ggboxplot(melt(GDSC2_Res[ , <span>1</span>:<span>4</span>]), <span>"Var2"</span>, <span>"value"</span>) +th ; p2<br><span># IMPORTANT note: here I do e^IC50 since the IC50s are actual ln values/log transformed already, and the calcPhenotype function Paul #has will do a power transformation (I assumed it would be better to not have both transformations)</span><br>GDSC2_Res &lt;- exp(GDSC2_Res)  <br>p3=ggboxplot(melt(GDSC2_Res[ , <span>1</span>:<span>4</span>]), <span>"Var2"</span>, <span>"value"</span>) +th ; p3<br><br><span>library</span>(patchwork)<br>p1+p2+p3<br><br></code></pre><p data-tool="mdnice编辑器">如下所示 ：</p><p><img data-galleryid="" data-ratio="0.5847222222222223" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wzpHSNicqIM941FbIgFF0nPpyDdKx0blCo3JjTgqr8iaQeEtopIjxbNxrs3wENLtfHrVeujXNI0Y9wA/640?wx_fmt=png" data-type="png" data-w="1440" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wzpHSNicqIM941FbIgFF0nPpyDdKx0blCo3JjTgqr8iaQeEtopIjxbNxrs3wENLtfHrVeujXNI0Y9wA/640?wx_fmt=png"></p><figure data-tool="mdnice编辑器"><figcaption> </figcaption></figure><p data-tool="mdnice编辑器">表达量矩阵被归一化很好，就是(RMA Normalized and Log Transformed)，跟绝大部分芯片数据分析一样的，介于 0到15之间。</p><p data-tool="mdnice编辑器">药物的ic50值，最开始的rds文件里面，也就是说从 (GDSC) 数据库下载得到的是被log转换的，所以又重新使用幂函数转回来。</p><p data-tool="mdnice编辑器">其中半抑制浓度，或称半抑制率，即IC50，其在间接竞争ELISA标准曲线中是一个非常重要的数据。这样就出现了好几个专有名词啦，不过我们可以简单一点理解，就是能杀死癌细胞的药物浓度的一半。</p><ul data-tool="mdnice编辑器"><li><section>比如设计 0.01，0.1，1，10，100 这样的药物梯度</section></li><li><section>发现从浓度1开始可以杀死癌细胞啦，所以我们就认为IC50是  0.5（一般来说不太可能出现浓度更高反而杀不死癌细胞的反常情况）</section></li><li><section>可以看到，浓度 梯度设计决定了 IC50的分辨率，就是一个区间值就足够啦。</section></li><li><section>如果IC50超级高，比如解决好几百大几千说明这是一个废物药物，约等于没有疗效。</section></li><li><section>如果IC50超级低，比如无限接近于0，说明这个药物就是传说中的灵丹妙药！</section></li></ul><p data-tool="mdnice编辑器">前面的箱线图，我们展现的是某个药物的八百多细胞系的IC50，这样可以看得出来有一些药物在很多癌症细胞系的表现就是废材，比如 "Cisplatin_1005"    和 "Cytarabine_1006"，当然了，因为我仅仅是展现了4个药物，所以说它们是废材仅仅是相当于 "Camptothecin_1003" 和"Vinblastine_1004"来说。</p><p data-tool="mdnice编辑器">还有另外一个展现方式，就是看针对具体的细胞系来说，那些药物有奇效那些药物是打酱油。代码如下所示：</p><pre data-tool="mdnice编辑器"><span></span><code>ggboxplot(melt(GDSC2_Res[ <span>1</span>:<span>4</span> ,]), <span>"Var1"</span>, <span>"value"</span>) +th<br></code></pre><p><img data-galleryid="" data-ratio="0.6141843971631206" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wzpHSNicqIM941FbIgFF0nPpQUAwqdYrhkib5tFbdlqp5zOrGTJ02tmaplYwDn5icWdrhvB24XsqyBibA/640?wx_fmt=png" data-type="png" data-w="1410" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wzpHSNicqIM941FbIgFF0nPpQUAwqdYrhkib5tFbdlqp5zOrGTJ02tmaplYwDn5icWdrhvB24XsqyBibA/640?wx_fmt=png"></p><figure data-tool="mdnice编辑器"><figcaption> </figcaption></figure><p data-tool="mdnice编辑器">因为每个细胞系的箱线图里面都是约200个药物，所以这样的可视化看不出来具体 的药物表现，并没有太大的意义。我们应该是直接看top药物即可：</p><pre data-tool="mdnice编辑器"><span></span><code>round(apply(GDSC2_Res[ 1:4 ,], 1, <span>function</span>(x){<br>  <span>return</span>(c(<br>    head(sort(x)),<br>    tail(sort(x))<br>  ))<br>}),2)<br><br>     COSMIC_906826 COSMIC_687983 COSMIC_910927 COSMIC_1240138<br> [1,]          0.00          0.00          0.00           0.05<br> [2,]          0.00          0.00          0.00           0.07<br> [3,]          0.01          0.01          0.01           0.09<br> [4,]          0.04          0.01          0.01           0.21<br> [5,]          0.05          0.01          0.01           0.95<br> [6,]          0.05          0.01          0.01           0.98<br> [7,]       2174.67        310.59        286.42         922.01<br> [8,]       2285.10        405.44        388.50         925.43<br> [9,]       2859.17        413.01        471.66         939.02<br>[10,]       3736.69        436.98        489.76         989.15<br>[11,]       5118.44        626.42        623.64        1105.89<br>[12,]      15431.05        973.87        803.89        1457.11<br></code></pre><p data-tool="mdnice编辑器">可以看到， 每个细胞系都是有自己的特异性药物和废物药物，IC50接近于0的就是神药，那些大几千的就是辣鸡药物啦。</p><p data-tool="mdnice编辑器">但是，我们可能是更想看到的是药物名字啦！</p><pre data-tool="mdnice编辑器"><span></span><code>apply(GDSC2_Res[ 1:4 ,], 1, <span>function</span>(x){ <br>  names(x)=gsub(<span>'_[0-9]*'</span>,<span>''</span>,colnames(GDSC2_Res))<br>  <span>return</span>(c(<br>    names(head(sort(x))),<br>    names(tail(sort(x)))<br>  ))<br>})<br><br>    COSMIC_906826          COSMIC_687983          COSMIC_910927          COSMIC_1240138<br> [1,] <span>"Sepantronium bromide"</span> <span>"Daporinad"</span>            <span>"Dactinomycin"</span>         <span>"Luminespib"</span>  <br> [2,] <span>"Bortezomib"</span>           <span>"Sepantronium bromide"</span> <span>"Sepantronium bromide"</span> <span>"CDK9"</span>        <br> [3,] <span>"Dactinomycin"</span>         <span>"Dactinomycin"</span>         <span>"Bortezomib"</span>           <span>"Dinaciclib"</span>  <br> [4,] <span>"Rapamycin"</span>            <span>"Bortezomib"</span>           <span>"Vinblastine"</span>          <span>"Dactinomycin"</span><br> [5,] <span>"Dactolisib"</span>           <span>"Docetaxel"</span>            <span>"Docetaxel"</span>            <span>"CDK9"</span>        <br> [6,] <span>"Docetaxel"</span>            <span>"Vinblastine"</span>          <span>"Luminespib"</span>           <span>"Sabutoclax"</span>  <br> <br> [7,] <span>"KU-55933"</span>             <span>"EPZ5676"</span>              <span>"AZD1208"</span>              <span>"IAP"</span>         <br> [8,] <span>"EPZ5676"</span>              <span>"Carmustine"</span>           <span>"Nelarabine"</span>           <span>"Mirin"</span>       <br> [9,] <span>"Acetalax"</span>             <span>"Selumetinib"</span>          <span>"Doramapimod"</span>          <span>"PFI3"</span>        <br>[10,] <span>"Nelarabine"</span>           <span>"Nelarabine"</span>           <span>"SB216763"</span>             <span>"ML323"</span>       <br>[11,] <span>"Doramapimod"</span>          <span>"Acetalax"</span>             <span>"Carmustine"</span>           <span>"AZD5991"</span>     <br>[12,] <span>"Temozolomide"</span>         <span>"5-Fluorouracil"</span>       <span>"Temozolomide"</span>         <span>"Carmustine"</span><br></code></pre><p data-tool="mdnice编辑器">前面的6个药物是各自细胞系的神药，后面的6个是废物药物啦。</p></section><h3 data-tool="mdnice编辑器">文末友情推荐</h3><p><span>做教学我们是认真的，如果你对我们的<strong>马拉松授课（直播一个月互动教学）</strong>有疑问，可以看完我们从2000多个提问互动交流里面精选的200个问答！ <a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247505193&amp;idx=1&amp;sn=bd55341f6409948188a0515f1552e2e3&amp;chksm=9b4b9592ac3c1c848b7f8965270cf9234945e0031e11ca3f559afc17247ca6098f57670cf192&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1" wah-hotarea="click">2021第二期_生信入门班_微信群答疑整理</a>，以及 <a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247505071&amp;idx=2&amp;sn=29727136d3907dd3b315232cbbb8d72d&amp;chksm=9b4b9414ac3c1d02c2ccd9639e01411d17347aa56c4e0eb3f254a8b159a50bde9aa7e20d2d2a&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1" wah-hotarea="click">2021第二期_数据挖掘班_微信群答疑笔记</a></span></p><p data-tool="mdnice编辑器"><span>与十万人一起学生信，你值得拥有下面的学习班：</span></p><ul><li><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247507009&amp;idx=2&amp;sn=f1c813866b3314a10463c317f62c3426&amp;chksm=9b4b9cfaac3c15ecc1325c17283d933650f27e4b2f84a1a423d64973dc7821eac58c1d46e838&amp;scene=21#wechat_redirect" textvalue="生信入门课-2021第8期" data-itemshowtype="0" tab="innerlink" data-linktype="2" wah-hotarea="click" hasload="1">生信入门课-2021第8期</a></p></li><li><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247507009&amp;idx=1&amp;sn=c1c9efd3ed6663df6e710bf7a5a249c6&amp;chksm=9b4b9cfaac3c15ec63b5a2c9e6f5a7c328f0575c1e04b245ce6ab6d594320fa33a824e5f7d6d&amp;scene=21#wechat_redirect" textvalue="数据挖掘（GEO,TCGA,单细胞）2021第8期" data-itemshowtype="0" tab="innerlink" data-linktype="2" wah-hotarea="click" hasload="1">数据挖掘（GEO,TCGA,单细胞）2021第8期</a></p></li><li><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247498002&amp;idx=1&amp;sn=c55c54c256cb99593af99d4325803e28&amp;chksm=ea1cff90dd6b76865a18d50a4aaea4b3b584b36c80b42423a9399d79d8acdaeb06d908a05172&amp;scene=21#wechat_redirect" data-itemshowtype="11" tab="innerlink" data-linktype="2" wah-hotarea="click" hasload="1">单细胞数据分析（一折起）</a></p></li></ul></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/pfy_qaHuA16Kqr7WhUTM0w",target="_blank" rel="noopener noreferrer">原文链接</a>
