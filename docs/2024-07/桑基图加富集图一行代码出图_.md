---
title: "桑基图加富集图一行代码出图?"
date: 2024-07-10T00:39:14Z
draft: ["false"]
tags: [
  "fetched",
  "老俊俊的生信笔记"
]
categories: ["Acdemic"]
---
桑基图加富集图一行代码出图? by 老俊俊的生信笔记
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-mpa-powered-by="yiban.io"><section><mp-common-profile data-pluginname="mpprofile" data-id="MzkyMTI1MTYxNA==" data-headimg="http://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usezgsqIGqjITSMggCTSoViaYeoKe2xoZr1IIvNJoztibQxibYHLDDoiabwAc6Ggws3Tvdo8EPss2nLgaVQ/0?wx_fmt=png" data-nickname="老俊俊的生信笔记" data-alias="JunJunLab" data-signature="老俊俊的生信技能和知识分享,我不是巨人,但你可以站在我的肩膀上更进一步!" data-from="0" data-is_biz_ban="0"></mp-common-profile></section></section><section><mp-common-clmusic data-pluginname="insertaudio" type="1" music_name="爱，很简单" albumurl="http://wx.y.gtimg.cn/music/photo_new/T002R500x500M000003ROVwj4PqLPa_2.jpg" singer="陶喆" duration="269000" username="v2_060000231003b20faec8cae2811ec0d6cf02ed31b07731fcb3f91623a9507625e4d60d9d2e14@finder" music_source="1" is_vip="1" listenid="78221641490562176"></mp-common-clmusic></section><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><h2 data-tool="mdnice编辑器"><span></span><span>引言</span><span></span></h2><blockquote data-tool="mdnice编辑器"><span>❝</span><p>网上关于 <strong>桑基图+富集分析</strong> 这样的组合图教程还是有很多的，但对于大家去使用出图还是比较麻烦的。搞成一个函数还是会方便很多，加一些参数稍微调整一下就很不错。这里写个 <strong>sankeyGoPlot</strong> 函数来做这样的事情，还是比较简单的。</p></blockquote><h2 data-tool="mdnice编辑器"><span></span><span>安装</span><span></span></h2><pre data-tool="mdnice编辑器"><span></span><code><span># install.packages("devtools")</span><br>devtools::install_github(<span>"junjunlab/GseaVis"</span>)<br></code></pre><h2 data-tool="mdnice编辑器"><span></span><span>使用介绍</span><span></span></h2><p data-tool="mdnice编辑器">首先做个富集分析：</p><pre data-tool="mdnice编辑器"><span></span><code><span># load test data</span><br>data(geneList, package=<span>"DOSE"</span>)<br><br><span># check</span><br>head(geneList)<br><span># 4312     8318    10874    55143    55388      991</span><br><span># 4.572613 4.514594 4.418218 4.144075 3.876258 3.677857</span><br><br>ego &lt;- enrichGO(gene = names(geneList),<br>                OrgDb = org.Hs.eg.db,<br>                keyType = <span>"ENTREZID"</span>,<br>                ont = <span>"BP"</span>,<br>                pvalueCutoff = <span>0.05</span>,<br>                readable = <span>T</span>)<br><br><span># get top 10 terms for visualization</span><br>ego_df &lt;- data.frame(ego) %&gt;% head(<span>10</span>)<br></code></pre><p data-tool="mdnice编辑器">绘图，<strong>默认取每条通路前 5 的基因进行展示</strong>：</p><pre data-tool="mdnice编辑器"><span></span><code>sankeyGoPlot(goData = ego_df)<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100030290" data-ratio="0.7509057971014492" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usezu17hibdx6ol1ricSAL1qKPAYNWjCPv1v2vzpZhn4k5HVqicBwqWSmBDY26l57ia46TLQ1fXYp44xZicg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1104" src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usezu17hibdx6ol1ricSAL1qKPAYNWjCPv1v2vzpZhn4k5HVqicBwqWSmBDY26l57ia46TLQ1fXYp44xZicg/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器">关于对齐的问题可以用下面参数调整到满意为止，其它参数比如修改颜色什么的可以看函数文档：</p><pre data-tool="mdnice编辑器"><span></span><code>sankeyGoPlot(goData = ego_df,<br>             downShift = <span>6.5</span>,upShift = <span>1</span>,<br>             sankeyExpand = c(<span>0.5</span>,<span>1</span>))<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100030292" data-ratio="0.7105038428693424" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usezu17hibdx6ol1ricSAL1qKPA1JFpYtkpOTxejRc1WyjoehU5DT8ZdjcKlWvX3dgnEzlsZ5OWfiaoecw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1171" src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usezu17hibdx6ol1ricSAL1qKPA1JFpYtkpOTxejRc1WyjoehU5DT8ZdjcKlWvX3dgnEzlsZ5OWfiaoecw/640?wx_fmt=png&amp;from=appmsg"></figure><blockquote data-tool="mdnice编辑器"><span>❝</span><p>后面讲一下这个 <strong>term_ratio</strong> 是怎么算的，就是<strong>富集到这个通路的基因数量比上该通路所有基因的数量</strong>。</p></blockquote><figure data-tool="mdnice编辑器"><img data-imgfileid="100030289" data-ratio="0.4911080711354309" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usezu17hibdx6ol1ricSAL1qKPAsB0jjXiaSnHokEBbJJpBUErPxHlNLqDUMMDV0gDHiaIUdWtvyzqATKqw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="731" src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usezu17hibdx6ol1ricSAL1qKPAsB0jjXiaSnHokEBbJJpBUErPxHlNLqDUMMDV0gDHiaIUdWtvyzqATKqw/640?wx_fmt=png&amp;from=appmsg"></figure><h2 data-tool="mdnice编辑器"><span></span><span>结尾</span><span></span></h2><blockquote data-tool="mdnice编辑器"><span>❝</span><p><strong>路漫漫其修远兮,吾将上下而求索。</strong></p></blockquote><hr data-tool="mdnice编辑器"><p data-tool="mdnice编辑器">欢迎加入生信交流群。加我微信我也拉你进 <strong>微信群聊</strong> <strong>老俊俊生信交流群</strong> <strong>(微信交流群需收取 20 元入群费用,一旦交费,拒不退还!(防止骗子和便于管理))</strong> 。QQ 群可免费加入, 记得进群按格式修改备注哦。</p><section data-tool="mdnice编辑器"><section><p><strong>老俊俊微信：</strong></p><figure><img data-imgfileid="100030288" data-ratio="1" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usezu17hibdx6ol1ricSAL1qKPAJOdFGNdbj3mJ3Kd9HnfLrtPUsDnAu66braxCUiaKV489Qib0PDfJA1RA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="430" src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usezu17hibdx6ol1ricSAL1qKPAJOdFGNdbj3mJ3Kd9HnfLrtPUsDnAu66braxCUiaKV489Qib0PDfJA1RA/640?wx_fmt=png&amp;from=appmsg"></figure><figure><img data-imgfileid="100030291" data-ratio="1.3668430335097002" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usezu17hibdx6ol1ricSAL1qKPAGdF1Jt1tBiaevOL4InUmmycfN6Tca2CQ9319g9uAqh5ibPqIc7lYcJfw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="567" src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usezu17hibdx6ol1ricSAL1qKPAGdF1Jt1tBiaevOL4InUmmycfN6Tca2CQ9319g9uAqh5ibPqIc7lYcJfw/640?wx_fmt=png&amp;from=appmsg"></figure></section><section><p><strong>知识星球：</strong></p><figure><img data-imgfileid="100030297" data-ratio="1.5896226415094339" data-src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/G5jjcE4usezu17hibdx6ol1ricSAL1qKPAbleyMBRNyRKFPT77dV4XzbNScerf3RAw8qqibkUVdpEP8mRA5Zr0s7g/640?wx_fmt=jpeg&amp;from=appmsg" data-type="jpeg" data-w="1060" src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/G5jjcE4usezu17hibdx6ol1ricSAL1qKPAbleyMBRNyRKFPT77dV4XzbNScerf3RAw8qqibkUVdpEP8mRA5Zr0s7g/640?wx_fmt=jpeg&amp;from=appmsg"></figure></section></section><hr data-tool="mdnice编辑器"><p data-tool="mdnice编辑器"><strong></strong></p><center data-tool="mdnice编辑器"><strong> 往期回顾目录</strong></center><blockquote data-tool="mdnice编辑器"><span>❝</span><p><strong></strong></p><center><strong><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247513935&amp;idx=1&amp;sn=7149af238f8ae9ef1750349fef7e79e9&amp;chksm=c1848d3ef6f3042892939e2ddee645b405c6a007fc290ff8e67f5cceeb7af37ff2cb11f1df93&amp;token=1267815615&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">GEO 上传数据最新教程</a></strong></center><strong><center><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247513903&amp;idx=1&amp;sn=7406e159002c4f5a11dffb74cd8bc16c&amp;chksm=c1848d5ef6f304485adeb4927b95318412d1f2d3aaddc21a6a60d58c4f4cac9d2c02340421e3&amp;token=350392803&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">试试 bulkRNA 做拟时序分析？</a></center></strong><strong><center><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247513809&amp;idx=1&amp;sn=05eb04b579b04ff5b20f3cab2f52406a&amp;chksm=c1848ca0f6f305b6005b1f9853a79843be0e582f7519c234350a6b22b81f7d07f5d749dbe87b&amp;token=350392803&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">ClusterGVis 绘制 lineplot 的优化</a></center></strong><strong><center><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247513792&amp;idx=1&amp;sn=b71dffea7f6dd9ad8acaec98ee99678c&amp;chksm=c1848cb1f6f305a7c85b54cbc9f40e2aaffefbc119654d533cd0aef2480eda6e7946295d5008&amp;token=1799964631&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">RNAseqQC 给你的数据来个全面的 QC 检查</a></center></strong><strong><center><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247513652&amp;idx=1&amp;sn=4750e40c39e055b0b8b6dae51d70c620&amp;chksm=c1848c45f6f30553044afacb5ea3544afd63287fd90f60858859b873db060019a569208590e9&amp;token=1799964631&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">如何 Pull Request 到 github 贡献你的代码</a></center></strong><strong><center><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247513591&amp;idx=2&amp;sn=24c65a23ae46dfd31757b8e5a4c5908d&amp;chksm=c1848f86f6f30690024b4d74a8a4beadd5a4691ee30df9287ed42b24a9e1fd42f531adecde9e&amp;token=1130224323&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">ggplot 添加分类型数据双坐标轴</a></center></strong><strong><center><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247513571&amp;idx=1&amp;sn=65c28c7798caee6a68208c7f8c50cc2b&amp;chksm=c1848f92f6f3068409d1036f0b038d7d127cee7c897138b12ddc34dc13f7b019136342582d86&amp;token=1130224323&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">富集分析流星图?</a></center></strong><strong><center><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247513557&amp;idx=1&amp;sn=0fdca9269c6def6c32006d1e8c29ac75&amp;chksm=c1848fa4f6f306b2fa7365b1cca4ea609ff0a3b11f1cdd1ca3badc9a4296ed636064fda727da&amp;token=1130224323&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">关于 ggplot2 分面的几点建议及补充</a></center></strong><strong><center><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247513497&amp;idx=1&amp;sn=099c2c64ad62fbd0cfed434cf6c9efe6&amp;chksm=c1848fe8f6f306fe1a50d1c1e40edaad3b22940d5be76b87a78d3cf6b31d593d144c66a82640&amp;token=1130224323&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">关于 footprint 可视化总结</a></center></strong><strong><center><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247513431&amp;idx=1&amp;sn=3817318720a1e6dec2274a9a5fdcabd9&amp;chksm=c1848f26f6f30630827c14c6ca2be924431b0f3844b28643a5d2880237774770d457e9c563f3&amp;token=1097809733&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">facet_sub 为 ggplot2 添加子图</a></center></strong><p><br></p></blockquote></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/4jnYpnDjxOK-uIqRc0rpeA",target="_blank" rel="noopener noreferrer">原文链接</a>
