---
title: "孟德尔分析的初步尝试"
date: 2024-07-26T00:45:07Z
draft: ["false"]
tags: [
  "fetched",
  "东林的扯淡小屋"
]
categories: ["Acdemic"]
---
孟德尔分析的初步尝试 by 东林的扯淡小屋
------
<div><p>Linux下载数据和软件：<br></p><section><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="properties"><code><span><span>#IEU下载的VCF格式</span></span></code><code><span><span>wget</span> <span>-c https://gwas.mrcieu.ac.uk/files/ieu-b-4953/ieu-b-4953.vcf.gz </span></span></code><code><span><span>gunzip</span> <span>ieu-b-4953.vcf.gz </span></span></code><code><span><br></span></code><code><span><span>unzip</span> <span>westra_eqtl_hg19.zip </span></span></code><code><span><br></span></code><code><span><br></span></code><code><span><span>#下载软件</span></span></code><code><span><span>cd</span> <span>/data/yudonglin/software</span></span></code><code><span><span>wget</span> <span>https://cnsgenomics.com/software/smr/download/smr_Linux.zip</span></span></code><code><span><span>unzip</span> <span>smr_Linux.zip</span></span></code><code><span><span>export</span> <span>PATH=/data/yudonglin/software:$PATH</span></span></code><code><span><span>/data/yudonglin/software/smr_linux_x86_64</span></span></code><code><span><br></span></code></pre></section></section><p>R处理数据：</p><section><ul><li><li><li><li><li></ul><pre data-lang="cpp"><code><span><br></span></code><code><span><span>#r运行</span></span></code><code><span>setwd(<span>"/data2/yudonglin/"</span>)</span></code><code><span>library(VariantAnnotation)</span></code><code><span><span>#devtools::install_github(<span>"MRCIEU/gwasglue"</span>)</span></span></code><code><span>library(gwasglue)</span></code><code><span>library(dplyr)</span></code><code><span><br></span></code><code><span>vcf &lt;- readVcf(<span>"ieu-b-4953.vcf"</span>)</span></code><code><span>gwas &lt;- gwasvcf_to_TwoSampleMR(vcf)</span></code><code><span>write.table(gwas,<span>"ieu-b-4953.txt"</span>,sep = <span>"\t"</span>,row.names = FALSE,quote = FALSE)</span></code><code><span>head(gwas)</span></code><code><span>library(tidyverse)</span></code><code><span>library(dplyr)</span></code><code><span>gwas &lt;- gwas %&gt;% </span></code><code><span>  rename(A1=effect_allele.exposure,A2=other_allele.exposure,freq=eaf.exposure,b=beta.exposure,se=se.exposure,p=pval.exposure,n=samplesize.exposure) %&gt;% </span></code><code><span>  dplyr::select(SNP,A1,A2,freq,b,se,p,n) %&gt;% </span></code><code><span>  filter(SNP != <span>""</span>&amp; !duplicated(SNP) &amp; SNP != <span>"."</span>)</span></code><code><span>write.table(gwas,<span>"bmi_gwas.txt"</span>,sep = <span>"\t"</span>,row.names = FALSE,quote = FALSE)</span></code><code><span># 查看处理后的数据</span></code><code><span>head(gwas)</span></code></pre></section><p>开始运行软件：</p><section><ul><li><li><li><li><li></ul><pre data-lang="sql"><code><span>/data/yudonglin/software/smr_linux_x86_64 <span>--bfile ./g1000_eur/g1000_eur \</span></span></code><code><span><span>--gwas-summary bmi_gwas.txt \</span></span></code><code><span><span>--beqtl-summary ./westra/westra_eqtl_hg19 \</span></span></code><code><span><span>--out smr_out \</span></span></code><code><span><span>--thread-num 22</span></span></code></pre></section><p><img data-galleryid="" data-imgfileid="100026706" data-ratio="0.5935185185185186" data-s="300,640" data-type="png" data-w="1080" data-src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBrR7eVNdh200EJ0C07OXjtUo05U5VvNdWD5Tmy5QmB2JNDFCrph4xWfykF1vSDL85az0z2dWIzvDg/640?wx_fmt=png&amp;from=appmsg" src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBrR7eVNdh200EJ0C07OXjtUo05U5VvNdWD5Tmy5QmB2JNDFCrph4xWfykF1vSDL85az0z2dWIzvDg/640?wx_fmt=png&amp;from=appmsg"></p><p>参考链接：</p><p>SMR | Yang Lab (westlake.edu.cn)</p><p>https://yanglab.westlake.edu.cn/software/smr/#SMR&amp;HEIDIanalysis</p><p></p><p></p><p></p><p></p><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/FKyyXh3jtAqPQaynI1K7nw",target="_blank" rel="noopener noreferrer">原文链接</a>
