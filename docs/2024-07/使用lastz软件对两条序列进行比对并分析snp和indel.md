---
title: "使用lastz软件对两条序列进行比对并分析snp和indel"
date: 2024-07-19T01:40:37Z
draft: ["false"]
tags: [
  "fetched",
  "小明的数据分析笔记本"
]
categories: ["Acdemic"]
---
使用lastz软件对两条序列进行比对并分析snp和indel by 小明的数据分析笔记本
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><h2 data-tool="mdnice编辑器"><span></span><span>代码来源于论文</span><span></span><span> </span></h2><blockquote data-tool="mdnice编辑器"><span></span><p>A complex phenotype in salmon controlled by a simple change in migratory timing</p></blockquote><p data-tool="mdnice编辑器">lastz和multiz可以通过conda进行安装</p><p data-tool="mdnice编辑器">我用拟南芥的基因组做测试</p><p data-tool="mdnice编辑器">运行脚本</p><pre data-tool="mdnice编辑器"><span></span><code>bash ~/my_data/raw_data/practice/science.salmon/lastz_seed_and_chain.sh abc an1chr1 c24chr1 an1.chr1.fa c24.chr1.fa<br></code></pre><p data-tool="mdnice编辑器">第一个位置参数是输出文件夹</p><p data-tool="mdnice编辑器">第二个位置参数是需要比对的基因组序列id (target)</p><p data-tool="mdnice编辑器">第三个位置参数是需要比对的基因组序列id(query)</p><p data-tool="mdnice编辑器">第四个位置参数是需要比对的基因组（target）</p><p data-tool="mdnice编辑器">第五个位置参数是需要比对的基因组（query）</p><p data-tool="mdnice编辑器">(2 3 位置参数序列id不能是一样的，如果两个序列id一样就会报错，我在这里搞了好长时间)</p><p data-tool="mdnice编辑器">输出的内容</p><figure data-tool="mdnice编辑器"><img data-imgfileid="100014220" data-ratio="0.7153075822603719" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/t1wZDoUyFk6icfmD21rWYFhT6CTbMHvPd2GFBX3gp9rBzd9kYvebqzxbAqaoBhTSZXFIN6HdagF6QTia49OhHWoQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="699" src="https://mmbiz.qpic.cn/sz_mmbiz_png/t1wZDoUyFk6icfmD21rWYFhT6CTbMHvPd2GFBX3gp9rBzd9kYvebqzxbAqaoBhTSZXFIN6HdagF6QTia49OhHWoQ/640?wx_fmt=png&amp;from=appmsg"><figcaption>image.png</figcaption></figure><p data-tool="mdnice编辑器">001.column是参考的结果</p><p data-tool="mdnice编辑器">002.column是查询的结果</p><h2 data-tool="mdnice编辑器"><span></span><span>接下来是R语言的代码</span><span></span><span> </span></h2><pre data-tool="mdnice编辑器"><span></span><code><span>source</span>(<span>"extract_variants_between_two_seqs.R"</span>)<br>library(tidyverse)<br><br>tq_seqs&lt;-tibble(ts=toupper(read_lines(<span>"abc/tmp_step=20_notransition_inner=1000_identity=97.001.column"</span>)),qs=toupper(read_lines(<span>"abc/tmp_step=20_notransition_inner=1<br>    000_identity=97.002.column"</span>)))<br><br>chrom28_narum_variants &lt;- extract_variants_between_two_seqs(tq_seqs)<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100014221" data-ratio="1.4732965009208103" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/t1wZDoUyFk6icfmD21rWYFhT6CTbMHvPdVSo8n0gojj7XGAY3icT173ZH1Ey4ADiaHwzKkvAkicMcKyw5tQpxs4MzQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="543" src="https://mmbiz.qpic.cn/sz_mmbiz_png/t1wZDoUyFk6icfmD21rWYFhT6CTbMHvPdVSo8n0gojj7XGAY3icT173ZH1Ey4ADiaHwzKkvAkicMcKyw5tQpxs4MzQ/640?wx_fmt=png&amp;from=appmsg"><figcaption>image.png</figcaption></figure><p data-tool="mdnice编辑器">extract_variants_between_two_seqs.R 这个脚本的内容可以在 https://eriqande.github.io/thompson-et-al-2020-chinook-salmon-migration-timing/003-extract-johnson-creek-variants.html 链接处查看</p><p data-tool="mdnice编辑器"><strong>欢迎大家关注我的公众号</strong></p><p data-tool="mdnice编辑器"><strong>小明的数据分析笔记本</strong></p><section><mp-common-profile data-pluginname="mpprofile" data-id="MzI3NzQ3MTcxMg==" data-headimg="http://mmbiz.qpic.cn/mmbiz_png/t1wZDoUyFk5t1sOnM0iabvBhnfIj5YpyqrMib0E1MGCd9ibcYxaOPZd0GWhQBDvK2BPEwsicQxd6y5MHLfphnwHnow/0?wx_fmt=png" data-nickname="小明的数据分析笔记本" data-alias="" data-signature="分享R语言和python在生物信息领域做数据分析和数据可视化的简单小例子；偶尔会分享一些组学数据处理相关的内容" data-from="0" data-is_biz_ban="0"></mp-common-profile></section><p data-tool="mdnice编辑器"><strong></strong></p><blockquote data-tool="mdnice编辑器"><span></span><p>小明的数据分析笔记本 公众号 主要分享：1、R语言和python做数据分析和数据可视化的简单小例子；2、园艺植物相关转录组学、基因组学、群体遗传学文献阅读笔记；3、生物信息学入门学习资料及自己的学习笔记！</p></blockquote></section><p><img data-galleryid="" data-imgfileid="100014223" data-ratio="0.35648148148148145" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/t1wZDoUyFk6icfmD21rWYFhT6CTbMHvPdFMVOaOwMuLiaQHsG5kxJIneTfYGlXMfBbYYw5o6sEopEK0EXhzAGsVA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/t1wZDoUyFk6icfmD21rWYFhT6CTbMHvPdFMVOaOwMuLiaQHsG5kxJIneTfYGlXMfBbYYw5o6sEopEK0EXhzAGsVA/640?wx_fmt=png&amp;from=appmsg"></p><p><br></p><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/qdNXDWYpaJHl8tley4lnTg",target="_blank" rel="noopener noreferrer">原文链接</a>
