---
title: "图片复现 | Nat Cancer. 坐标轴放缩散点图"
date: 2024-07-10T00:55:38Z
draft: ["false"]
tags: [
  "fetched",
  "被炸熟的虾"
]
categories: ["Acdemic"]
---
图片复现 | Nat Cancer. 坐标轴放缩散点图 by 被炸熟的虾
------
<div><p><span>本周重复目标：坐标轴放缩的散点图，</span><span><strong>重复效果很一般</strong></span><span>。</span><br></p><section><span>来源：</span><span>Phosphate dysregulation via the XPR1-KIDINS220 protein complex is a therapeutic vulnerability in ovarian cancer. Nat Cancer. 2022 Jun.</span></section><section><span>这次尝试复现</span><span>Fig 1A</span><span>。看起来是一个普普通通的散点图，但是</span><span>X/Y</span><span>轴均经过放缩，不是均一分布。实操后可以看出确实相当程度上改善了可视化效果。</span><span></span></section><p><img data-galleryid="" data-imgfileid="100004134" data-ratio="1.0935185185185186" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/dRYYdqiaan3LEsT1uIDrdo3ENcFpC6uHkHNNLHvvfj5hr6k9C1qKrX1jAMzyoRWwDHLEqgQlJFhf4TLPDx7A5jw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/dRYYdqiaan3LEsT1uIDrdo3ENcFpC6uHkHNNLHvvfj5hr6k9C1qKrX1jAMzyoRWwDHLEqgQlJFhf4TLPDx7A5jw/640?wx_fmt=png&amp;from=appmsg"></p><p><span></span></p><p><span>画图数据作者已经上传到了附件：</span></p><pre><code>rm(list = ls()) <br><span>library</span>(readxl)<br>exprSet &lt;- as.data.frame(read_excel(<span>"./NIHMS1786433-supplement-SourceData_Numerical_Fig_1.xlsx"</span>,sheet =<span>1</span>))<br>head(exprSet)<br>  <span># Rank     Gene          LRT Enrichement in Ovarian cancer</span><br><span># 1    1   FERMT2  81.09544836                     0.4233217</span><br><span># 2    2     PAX8 858.69268260                     0.4208479</span><br><span># 3    3   PARD6B 310.53420330                     0.2334991</span><br><span># 4    4     GPX4   0.05860341                     0.2333467</span><br><span># 5    5    PARD3 169.61717375                     0.1829157</span><br><span># 6    6 ARHGAP29 218.59577536                     0.1771456</span><br></code></pre><p><span>作者的分组方法：</span><span>The top 5% most predictable dependencies are highlighted in teal, where a random forest model using the genomic and molecular features of cancer cell lines can predict the strength of dependency.</span></p><p><span>这里随机挑选一部分基因加上</span><span>top 1% LRT</span><span>与 </span><span>top 1% Enrichement in Ovarian cancer</span><span>的基因，不想找了，偷懒<img data-src="https://res.wx.qq.com/t/wx_fed/we-emoji/res/v1.3.10/assets/Expression/Expression_9@2x.png" data-ratio="1" data-w="128" src="https://res.wx.qq.com/t/wx_fed/we-emoji/res/v1.3.10/assets/Expression/Expression_9@2x.png"><img data-src="https://res.wx.qq.com/t/wx_fed/we-emoji/res/v1.3.10/assets/Expression/Expression_9@2x.png" data-ratio="1" data-w="128" src="https://res.wx.qq.com/t/wx_fed/we-emoji/res/v1.3.10/assets/Expression/Expression_9@2x.png"></span></p><pre><code>top1LRT &lt;- which(exprSet$LRT &gt;= (sort(exprSet$LRT,decreasing = <span>T</span>)[floor(<span>0.01</span>*nrow(exprSet))]))<br>top1Rank &lt;- which(exprSet$Rank &lt; <span>0.01</span>*nrow(exprSet))<br>Sample &lt;- sample(<span>1</span>:nrow(exprSet),<span>1000</span>,replace = <span>FALSE</span>)<br>exprSet$Group &lt;- <span>"All others"</span><br>exprSet$Group[unique(c(top1LRT,top1Rank,Sample))] &lt;- <span>"Top predictable dependencies"</span><br>table(exprSet$Group)<br></code></pre><h2><span>1、常规散点图</span></h2><p><span>先画一个普通的散点图看看情况：</span><a href="https://mp.weixin.qq.com/s?__biz=MzkwNDQwMDI5NQ==&amp;mid=2247485207&amp;idx=1&amp;sn=de8661764466494a4b5cb6b27451ea45&amp;scene=21#wechat_redirect" data-linktype="2">R语言画图 | 散点图</a></p><pre><code><span>library</span>(ggplot2)<br>theme &lt;- theme_bw()+ <br>         theme(plot.title = element_text(hjust = <span>0.5</span>,size = <span>22</span>),<br>               axis.text.x = element_text(hjust = <span>0.5</span>,size = <span>18</span>), <br>               axis.text.y = element_text(hjust = <span>0.5</span>,size = <span>18</span>),<br>               axis.title.y = element_text(size = <span>18</span>), <br>               axis.title.x = element_text(size = <span>18</span>), <br>               legend.text = element_text(size = <span>18</span>),<br>               panel.grid = element_blank(), <br>               legend.title = element_blank(),<br>               legend.position = <span>"top"</span>,<br>               legend.background = element_blank())<br><span>#######仅设置坐标轴范围</span><br>p1 &lt;- ggplot(data = exprSet, aes(x = LRT, y = `Enrichement in Ovarian cancer`)) +<br>      geom_point(aes(color = Group),size = <span>2</span>) +<br>      scale_color_manual(values = c(<span>"#d9d7d6"</span>,<span>"#048c8c"</span>)) +<br>      scale_x_continuous(limits = c(<span>0</span>,<span>1000</span>),breaks = seq(<span>0</span>,<span>750</span>,<span>250</span>)) + <br>      scale_y_continuous(limits = c(<span>0</span>,<span>0.45</span>),breaks = seq(<span>0</span>,<span>0.4</span>,<span>0.1</span>)) + <br>      labs(x = <span>"Skewness in dependency across all cell line"</span>,<br>           y = <span>"Ovarian dependency enrichment"</span>,<br>           title = <span>NULL</span>) + <br>      theme  <br></code></pre><p><span>形状与作者调整坐标轴的展示结果差异巨大。</span></p><p><img data-galleryid="" data-imgfileid="100004130" data-ratio="0.5" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/dRYYdqiaan3LEsT1uIDrdo3ENcFpC6uHkurIAJjzdL7JarUsxTvBRRgo213DQoA1heMDn5Pw1TOrkx1TbWPJKvA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/dRYYdqiaan3LEsT1uIDrdo3ENcFpC6uHkurIAJjzdL7JarUsxTvBRRgo213DQoA1heMDn5Pw1TOrkx1TbWPJKvA/640?wx_fmt=png&amp;from=appmsg"></p><p><span>因为少部分极值区域点的存在，绝大部分点被压缩在一块很小的区域。以后遇到类似分布的数据可以考虑使用作者的展示方法——不均一坐标轴。</span></p><h2><span>2、坐标轴放缩</span></h2><p><span>ggplot2</span><span>绘图自带了很多转换函数：</span></p><pre><code>transform_asinh, transform_asn, transform_atanh, transform_boxcox, transform_compose, <br>transform_date, transform_exp, transform_hms, transform_identity, transform_log, <br>transform_log10, transform_log1p, transform_log2, transform_logit, transform_modulus, <br>transform_probability, transform_probit, transform_pseudo_log, transform_reciprocal, <br>transform_reverse, transform_sqrt, transform_time, transform_timespan, transform_yj<br></code></pre><p><span>经过观察，横/纵坐标都是数据越大反而分布尺度缩减，因此尝试一下执行</span><span>log1p </span><span>即</span><span>ln(x+1) </span><span>或平方根转换</span></p><pre><code><span>#######横坐标执行log(x+1) 即ln(x+1) 转换</span><br><span>#######纵坐标执行平方根转换</span><br>p2 &lt;- ggplot(data = exprSet, aes(x = LRT, y = `Enrichement in Ovarian cancer`)) +<br>      geom_point(aes(color = Group),size = <span>2</span>) +<br>      scale_color_manual(values = c(<span>"#d9d7d6"</span>,<span>"#048c8c"</span>)) +<br>      scale_x_continuous(trans = <span>"log1p"</span>,limits = c(<span>0</span>,<span>1000</span>),breaks = seq(<span>0</span>,<span>750</span>,<span>250</span>)) + <br>      scale_y_continuous(trans = <span>"sqrt"</span>,limits = c(<span>0</span>,<span>0.45</span>),breaks = seq(<span>0</span>,<span>0.4</span>,<span>0.1</span>)) + <br>      <span>#coord_trans(x = "log1p",y = "sqrt") + </span><br>      labs(x = <span>"Skewness in dependency across all cell line"</span>,<br>           y = <span>"Ovarian dependency enrichment"</span>,<br>           title = <span>NULL</span>) + <br>       theme<br><span>#######横坐标\纵坐标都执行平方根转换</span><br>p3 &lt;- ggplot(data = exprSet, aes(x = LRT, y = `Enrichement in Ovarian cancer`)) +<br>      geom_point(aes(color = Group),size = <span>2</span>) +<br>      scale_color_manual(values = c(<span>"#d9d7d6"</span>,<span>"#048c8c"</span>)) +<br>      scale_x_continuous(trans = <span>"sqrt"</span>,limits = c(<span>0</span>,<span>1000</span>),breaks = seq(<span>0</span>,<span>750</span>,<span>250</span>)) + <br>      scale_y_continuous(trans = <span>"sqrt"</span>,limits = c(<span>0</span>,<span>0.45</span>),breaks = seq(<span>0</span>,<span>0.4</span>,<span>0.1</span>)) + <br>      labs(x = <span>"Skewness in dependency across all cell line"</span>,<br>           y = <span>"Ovarian dependency enrichment"</span>,<br>           title = <span>NULL</span>) + <br>      theme<br>p2 &lt;- p2 + guides(colour = guide_legend(override.aes = list(size = <span>6</span>)))<br>p3 &lt;- p3 + guides(colour = guide_legend(override.aes = list(size = <span>6</span>)))<br></code></pre><p><img data-galleryid="" data-imgfileid="100004132" data-ratio="1" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/dRYYdqiaan3LEsT1uIDrdo3ENcFpC6uHk1yyBVghbEFqVCibG6Wb78mBwU6F9UYOT6cGBaDZiblmls8uNyqdvibRVA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/dRYYdqiaan3LEsT1uIDrdo3ENcFpC6uHk1yyBVghbEFqVCibG6Wb78mBwU6F9UYOT6cGBaDZiblmls8uNyqdvibRVA/640?wx_fmt=png&amp;from=appmsg"></p><p><mp-pay-preview-filter data-offset="22"></mp-pay-preview-filter></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/zVCCB38qbE3WqvTpbgyeDQ",target="_blank" rel="noopener noreferrer">原文链接</a>
