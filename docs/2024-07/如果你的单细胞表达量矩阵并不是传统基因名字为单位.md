---
title: "如果你的单细胞表达量矩阵并不是传统基因名字为单位"
date: 2024-07-25T08:33:59Z
draft: ["false"]
tags: [
  "fetched",
  "珠海健明生物医药科技"
]
categories: ["Acdemic"]
---
如果你的单细胞表达量矩阵并不是传统基因名字为单位 by 珠海健明生物医药科技
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><blockquote data-tool="mdnice编辑器"><span></span><p>最近学员提问了一个有意思的数据集，他使用我们授课的示例代码发现跑降维聚类分群是没有问题，但是在后面的特异性基因的可视化的时候就全军覆没了。</p></blockquote><p data-tool="mdnice编辑器">我让学员发来一下对应的gse数据集，然后去下载这个这个文件，自己读取看了看；</p><pre data-tool="mdnice编辑器"><span></span><code>counts &lt;- data.table::fread(<span>'GSE190482_UMIsMatrix.txt.gz'</span>,data.table = F)<br>counts[1:4,1:4]<br><br>&gt; counts[1:4,1:4]<br>                  V1 AAACCCAAGGTCGAGT-1_KO_B0310 AAACGAAAGGACACTG-1_WT_B0302<br>1 ENSMUSG00000051951                           0                           0<br>2 ENSMUSG00000089699                           0                           0<br>3 ENSMUSG00000102331                           0                           0<br>4 ENSMUSG00000102343                           0                           0<br></code></pre><p data-tool="mdnice编辑器">发现是因为里面的基因名字问题， 目前人类基因的命名体系主要包括 Ensembl、Gene Symbol 和 RefSeq。这些体系都是用于标识和命名基因的，是可以互相转换的 ：</p><ol data-tool="mdnice编辑器"><li><section><strong>Ensembl</strong>：Ensembl 是一个综合性基因组数据库和基因注释系统，提供了基因组序列的注释信息，包括基因位置、结构、功能等。Ensembl 使用类似于 ENSG00000139618 的 ID 标识基因，其中 "ENSG" 表示 Ensembl Gene，后面的数字为特定基因的唯一标识符。Ensembl 还提供了其他类型的 ID，如转录本 ID（ENST）、蛋白质 ID（ENSP）等。</section></li><li><section><strong>Gene Symbol</strong>：Gene Symbol 是一种更为常见的基因命名体系，使用了类似于 "TP53"（编码 p53 蛋白的基因）的简短字母数字组合来表示基因。Gene Symbol 是根据基因的功能、研究历史等因素确定的，易于记忆和使用。许多基因都有常用的 Gene Symbol，例如 "BRCA1"、"EGFR"、"MYC" 等。</section></li><li><section><strong>RefSeq</strong>：RefSeq 是由美国国家生物技术信息中心（NCBI）维护的参考序列数据库，提供了一系列标准化的生物分子序列记录，包括基因、转录本、蛋白质等。RefSeq 基因通常使用类似于 "NM_000546.6" 的格式，其中 "NM" 表示 mRNA 的 RefSeq ID，后面的数字是该基因的特定版本，".6" 表示修订版本。</section></li></ol><p data-tool="mdnice编辑器">既然是需要转换，所以我使用AnnoProbe包进行这个步骤，然后我测试了一下，转换的成功率还很高的：</p><pre data-tool="mdnice编辑器"><span></span><code>&gt; ids=annoGene(ensID,<span>'ENSEMBL'</span>,<span>'mouse'</span>)<br>Warning message:<br>In annoGene(ensID, <span>"ENSEMBL"</span>, <span>"mouse"</span>) :<br>  0.27% of input IDs are fail to annotate... <br>&gt; head(ids)<br>    SYMBOL       biotypes            ENSEMBL  chr   start     end<br>3     Xkr4 protein_coding ENSMUSG00000051951 chr1 3205901 3671498<br>8   Gm1992      antisense ENSMUSG00000089699 chr1 3466587 3513553<br>12 Gm19938 sense_intronic ENSMUSG00000102331 chr1 3647309 3658904<br>16 Gm37381        lincRNA ENSMUSG00000102343 chr1 3905739 3986215<br>17     Rp1 protein_coding ENSMUSG00000025900 chr1 3999557 4409241<br>20   Sox17 protein_coding ENSMUSG00000025902 chr1 4490931 4497354<br></code></pre><p data-tool="mdnice编辑器">最后的完整的代码如下所示：</p><pre data-tool="mdnice编辑器"><span></span><code>counts &lt;- data.table::fread(<span>'GSE190482_UMIsMatrix.txt.gz'</span>,data.table = <span>F</span>)<br>counts[<span>1</span>:<span>4</span>,<span>1</span>:<span>4</span>]<br>ensID = counts$V1<br><span>library</span>(AnnoProbe) <br>ids=annoGene(ensID,<span>'ENSEMBL'</span>,<span>'mouse'</span>)<br>head(ids)<br>tail(sort(table(ids$biotypes)))<br>ids=ids[ids$biotypes==<span>'protein_coding'</span>,]<br>ids=ids[!duplicated(ids$SYMBOL),]<br>ids=ids[!duplicated(ids$ENSEMBL),]<br>pos = match(ids$ENSEMBL,counts$V1)<br>counts=counts[pos,]<br>rownames(counts)=ids$SYMBOL<br>counts=counts[,-<span>1</span>]<br>sce.all &lt;- CreateSeuratObject(counts = counts,<br>                         <span># project = "Humanized vasculitis mice",</span><br>                          min.cells = <span>3</span>)<br>sce.all<br></code></pre><p data-tool="mdnice编辑器">有了这个seurat的对象，后面就是我们常规的！代码在：（链接: https://pan.baidu.com/s/1pKEnPmWXi-pTab0WZUWzgg?pwd=a7s1） 相信大家很容易跟着去复现一次！</p><p data-tool="mdnice编辑器">值得一提的是这个GSE190482数据集关联的文章是Kaymak T, <em>et al</em>. <em>Gut</em> 2023;标题是 ：《IL-20 subfamily cytokines impair the oesophageal epithelial barrier by diminishing filaggrin in eosinophilic oesophagitis》，但是文章正文里面根本就没有出现过一个单细胞图表，仅仅是在附件出现了一个Supplemental Figure 4. 的子图：(J) Normalised expression levels of Il20rα and Il20rβ in annotated cell types from the scRNA-seq dataset.</p><p><img data-galleryid="" data-imgfileid="100044766" data-ratio="0.39166666666666666" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wzIanBsAU4T16L2DMmYhGf4dTIbAjvtwF6L7vqwVPvR9294svlzfkZ3DIYQZDA6ALct4D2E0Quo8w/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wzIanBsAU4T16L2DMmYhGf4dTIbAjvtwF6L7vqwVPvR9294svlzfkZ3DIYQZDA6ALct4D2E0Quo8w/640?wx_fmt=png&amp;from=appmsg"></p><figure data-tool="mdnice编辑器"><figcaption>看了两个基因在不同单细胞亚群的表达量</figcaption></figure></section><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><h3 data-tool="mdnice编辑器"><span></span><span>学徒作业</span><span></span></h3><p data-tool="mdnice编辑器">完成这个数据集的降维聚类分群，并且看看上面的两个基因在不同单细胞亚群的表达量情况。如果你做完了可以打包代码和结果文件夹发给我哈<span>，我的邮箱地址是 jmzeng1314@163.com</span></p></section><h4 data-tool="mdnice编辑器">文末友情宣传</h4><p data-tool="mdnice编辑器">强烈建议你推荐给身边的<strong>博士后以及年轻生物学PI</strong>，多一点数据认知，让他们的科研上一个台阶：</p><ul data-tool="mdnice编辑器"><li><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247528328&amp;idx=1&amp;sn=33055906f1dca6958238a84b48405cd5&amp;chksm=9b4b2f33ac3ca6255cdf3d9e1422c6610aebd2fdece36ea0bd9d1cf838cbf1521b599ae81abe&amp;scene=21#wechat_redirect" textvalue="生物信息学马拉松授‍课（买一得五）" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1">生物信息学马拉松授课（买一得五）</a> ，你的生物信息学入门课</section></li><li><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247528133&amp;idx=1&amp;sn=2fc6bf3e8455222628c9814d6509c74f&amp;chksm=9b4b2e7eac3ca7687d2f12b37fa48bfe1b060b3c204df87dbf6e277321cfaeb8f5e4d283ca1e&amp;scene=21#wechat_redirect" textvalue="月薪两万找生信练习生（线下）" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1">月薪两万找生信练习生（线下）</a><br></section></li><li><section> <a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247528363&amp;idx=1&amp;sn=5e02f3e9b2e148191e23ebc2c0d780e7&amp;chksm=9b4b2f10ac3ca606c1c4bac8cf112bb9b0f18e3c4262f5f2b8c0dba3bfedf2ba201507247005&amp;scene=21#wechat_redirect" textvalue="2024的共享服务器交个朋友福利价仍然是800" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1">2024的共享服务器交个朋友福利价仍然是800</a></section></li><li><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247519765&amp;idx=1&amp;sn=ce5a8c8182f854c88043059f8c2cb9ff&amp;chksm=9b4bceaeac3c47b88c19941d43dbb1401f3a92206481a0afc41159927868199643f795d62a7e&amp;scene=21#wechat_redirect" textvalue="千呼万唤始出来的独享生物信息学云服务器" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1">千呼万唤始出来的独享生物信息学云服务器</a></section></li><li><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247528144&amp;idx=1&amp;sn=be4d7e542d1077921024c86a4c130f16&amp;chksm=9b4b2e6bac3ca77d87a0ae0c12ae028d10225db19c8d7fb92b1299fa12f572bb769bcd92889b&amp;scene=21#wechat_redirect" textvalue="永久免费的生信进阶培训（线下）" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1">永久免费的生信进阶培训（线下）</a></section></li></ul><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/_1k73JUxA4WNCz_ycFKe_A",target="_blank" rel="noopener noreferrer">原文链接</a>
