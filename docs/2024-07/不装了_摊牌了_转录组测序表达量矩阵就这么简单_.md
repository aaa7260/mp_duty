---
title: "不装了，摊牌了，转录组测序表达量矩阵就这么简单！"
date: 2024-07-28T13:27:07Z
draft: ["false"]
tags: [
  "fetched",
  "生信技能树"
]
categories: ["Acdemic"]
---
不装了，摊牌了，转录组测序表达量矩阵就这么简单！ by 生信技能树
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><blockquote data-tool="mdnice编辑器"><span></span><p>前面我在笔记：<a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247531099&amp;idx=1&amp;sn=dc4937045e2cf83b8dcd25187e33ca08&amp;scene=21#wechat_redirect" data-linktype="2">作者仅提供了fpkm格式表达量矩阵的转录组测序数据集该如何重新分析呢</a> 提到了一个小技巧，是可以通过下面的r代码读取geo数据库里面的转录组测序表达量矩阵，这个矩阵来自于geo官方的转录组定量流程 ，如下所示的r代码 ：</p></blockquote><pre data-tool="mdnice编辑器"><span></span><code>urld &lt;- <span>"https://www.ncbi.nlm.nih.gov/geo/download/?format=file&amp;type=rnaseq_counts"</span><br>path &lt;- paste(urld, <span>"acc=GSE182923"</span>, <span>"file=GSE182923_raw_counts_GRCh38.p13_NCBI.tsv.gz"</span>, sep=<span>"&amp;"</span>);<br>tbl &lt;- as.matrix(data.table::fread(path, header=<span>T</span>, colClasses=<span>"integer"</span>), rownames=<span>1</span>)<br></code></pre><p data-tool="mdnice编辑器">虽然说我们确实是在单细胞天地，生信菜鸟团，生信技能树等多个公众号转发了：<a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247531099&amp;idx=1&amp;sn=dc4937045e2cf83b8dcd25187e33ca08&amp;scene=21#wechat_redirect" data-linktype="2">作者仅提供了fpkm格式表达量矩阵的转录组测序数据集该如何重新分析呢</a> 里面的小技巧，但仍然是各个交流群还是有人发问，关于转录组测序的公共数据集如何分析，因为大家看到的常规教程都是之前的表达量芯片的数据分析流程。</p><p data-tool="mdnice编辑器">转录组测序首先是表达量矩阵是一个问题， 其次处理所用的r包，统计学方法也不一样。</p><p data-tool="mdnice编辑器">比如：https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE254592</p><p data-tool="mdnice编辑器">对应的文章是：Programmed cell death-1 is involved with peripheral blood immune cell profiles in patients with hepatitis C virus antiviral therapy. <em>PLoS One</em> 2024;19(5):e0299424. PMID: 38781172</p><p data-tool="mdnice编辑器">如果是看文件：</p><pre data-tool="mdnice编辑器"><span></span><code>GSE254592_Group01_vs_Group02_cds_expression_diff_summary.txt.gz 2.2 Mb (ftp)(http) TXT<br>GSE254592_Group01_vs_Group03_cds_expression_diff_summary.txt.gz 2.2 Mb (ftp)(http) TXT<br>GSE254592_Group02_vs_Group04_cds_expression_diff_summary.txt.gz 2.2 Mb (ftp)(http) TXT<br>GSE254592_Group03_vs_Group04_cds_expression_diff_summary.txt.gz 2.2 Mb (ftp)(http) TXT<br><br>GSE254592_TR_2305.genes.fpkm_table_annotation.txt.gz 6.4 Mb (ftp)(http) TXT<br>GSE254592_merged.gtf.gz 15.5 Mb (ftp)(http) GTF<br></code></pre><p data-tool="mdnice编辑器">确实是一个fpkm格式的表达量矩阵，虽然说geo页面给出来了一下 差异分析的组合，但是没办法替代我们自己想从原始的counts矩阵开始的差异分析需求。</p><p data-tool="mdnice编辑器">其实，如果是现在的大家仔细看说geo页面，就可以看到页面多了一个下载渠道的按钮  ：</p><p><img data-galleryid="" data-imgfileid="100048499" data-ratio="1.288888888888889" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wyLVh1kmaYWqzN7K8mnEliaYtCTaSb1RS1l64okJOoMvf4CibMpMVTOKDaM2lGorh5xLPCdzLeFfRibw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wyLVh1kmaYWqzN7K8mnEliaYtCTaSb1RS1l64okJOoMvf4CibMpMVTOKDaM2lGorh5xLPCdzLeFfRibw/640?wx_fmt=png&amp;from=appmsg"></p><figure data-tool="mdnice编辑器"><figcaption>页面多了一个按钮</figcaption></figure><p data-tool="mdnice编辑器">点进去就是geo官方的转录组定量流程后得到的表达量矩阵文件 ，如下所示链接 ：</p><ul data-tool="mdnice编辑器"><li><section>https://www.ncbi.nlm.nih.gov/geo/download/?acc=GSE254592</section></li><li><section>https://www.ncbi.nlm.nih.gov/geo/download/?type=rnaseq_counts&amp;acc=GSE254592&amp;format=file&amp;file=GSE254592_raw_counts_GRCh38.p13_NCBI.tsv.gz</section></li></ul><h3 data-tool="mdnice编辑器"><span></span><span>而且是每个数据集都是同样的结构</span><span></span></h3><p data-tool="mdnice编辑器">任意数据集，下面的URL只需要替换里面的gse编号即可：</p><ul data-tool="mdnice编辑器"><li><section>https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE122709</section></li><li><section>https://www.ncbi.nlm.nih.gov/geo/download/?acc=GSE122709</section></li></ul><p data-tool="mdnice编辑器"><span><strong>每个数据集都有自己的表达量矩阵文件下载，要么是作者自己给出来的转录组测序定量好的矩阵，要么是geo官方统一定量的文件</strong></span>，如下所示：</p><p><img data-galleryid="" data-imgfileid="100048498" data-ratio="1.1527777777777777" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wyLVh1kmaYWqzN7K8mnEliaYNed4ibnbSa2aQmx13zqDo8kL2lL9lc1WYsH4rJNeYyyJOhds8Vz9gZQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wyLVh1kmaYWqzN7K8mnEliaYNed4ibnbSa2aQmx13zqDo8kL2lL9lc1WYsH4rJNeYyyJOhds8Vz9gZQ/640?wx_fmt=png&amp;from=appmsg"></p><figure data-tool="mdnice编辑器"><figcaption>geo官方统一定量的文件</figcaption></figure><p data-tool="mdnice编辑器">也可以看它们的URL的规则：</p><ul data-tool="mdnice编辑器"><li><section>https://ftp.ncbi.nlm.nih.gov/geo/series/GSE122nnn/GSE122709/suppl/GSE122709_all.counts.txt.gz</section></li><li><section>https://www.ncbi.nlm.nih.gov/geo/download/?type=rnaseq_counts&amp;acc=GSE122709&amp;format=file&amp;file=GSE122709_raw_counts_GRCh38.p13_NCBI.tsv.gz</section></li></ul><h3 data-tool="mdnice编辑器"><span></span><span>实战一下</span><span></span></h3><p data-tool="mdnice编辑器">让我们看看2024年5月31日，中山大学附属孙逸仙纪念医院苏士成、陆艺文等人在癌症领域顶级期刊 Cancer Cell 上发表了题为：Tumor cells impair immunological synapse formation via central nervous system-enriched metabolite 的研究论文，该研究里面有一个公开的单细胞转录组数据集，以及转录组测序数据集：</p><ul data-tool="mdnice编辑器"><li><section>https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE233484</section></li></ul><p data-tool="mdnice编辑器">可以看到，这个转录组测序是9个样品，分成两组：</p><pre data-tool="mdnice编辑器"><span></span><code>GSM7429237 resistant1<br>GSM7429238 resistant2<br>GSM7429239 resistant3<br>GSM7429240 resistant4<br>GSM7429241 sensitive1<br>GSM7429242 sensitive2<br>GSM7429243 sensitive3<br>GSM7429244 sensitive4<br>GSM7429245 sensitive5<br></code></pre><p data-tool="mdnice编辑器">文章里面也给出来了转录组差异分析结果：</p><p><img data-galleryid="" data-imgfileid="100048497" data-ratio="0.21481481481481482" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wyLVh1kmaYWqzN7K8mnEliaYhGMbgXbkwJBxrkvWicBeA9AnOvzDwnpQP2Xib3l61TFr9a0iaNLRLTGBA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wyLVh1kmaYWqzN7K8mnEliaYhGMbgXbkwJBxrkvWicBeA9AnOvzDwnpQP2Xib3l61TFr9a0iaNLRLTGBA/640?wx_fmt=png&amp;from=appmsg"></p><figure data-tool="mdnice编辑器"><figcaption>转录组差异分析结果</figcaption></figure><p data-tool="mdnice编辑器">但是如果大家直接从geo界面看是每个样品的fpkm矩阵 ：</p><pre data-tool="mdnice编辑器"><span></span><code>GSM7429237_resistant1_pt01002_S19187.txt.gz 915.7 Kb<br>GSM7429238_resistant2_pt01003_S20199.txt.gz 923.3 Kb<br>GSM7429239_resistant3_pt01004_S20223.txt.gz 928.3 Kb<br>GSM7429240_resistant4_pt01009_S1820.txt.gz 923.1 Kb<br>GSM7429241_sensitive1_pt01006_S2040.txt.gz 903.4 Kb<br>GSM7429242_sensitive2_pt01007_S20177.txt.gz 911.0 Kb<br>GSM7429243_sensitive3_pt01010_S20195.txt.gz 922.3 Kb<br>GSM7429244_sensitive4_pt01011_S20191.txt.gz 907.0 Kb<br>GSM7429245_sensitive5_pt01012_S2017.txt.gz 919.7 Kb<br></code></pre><p data-tool="mdnice编辑器">就不适合做差异分析，所以可以下载这个 GSE233484_raw_counts_GRCh38.p13_NCBI.tsv.gz 文件 然后读取：</p><pre data-tool="mdnice编辑器"><span></span><code><span># load counts table from GEO</span><br>urld &lt;- <span>"https://www.ncbi.nlm.nih.gov/geo/download/?format=file&amp;type=rnaseq_counts"</span><br>path &lt;- paste(urld, <span>"acc=GSE233484"</span>, <span>"file=GSE233484_raw_counts_GRCh38.p13_NCBI.tsv.gz"</span>, sep=<span>"&amp;"</span>);<br>path=<span>'GSE233484_raw_counts_GRCh38.p13_NCBI.tsv.gz'</span><br>tbl &lt;- as.matrix(data.table::fread(path, header=<span>T</span>, colClasses=<span>"integer"</span>), rownames=<span>1</span>)<br></code></pre><p data-tool="mdnice编辑器">简单的做了常规的转录组测序 差异分析，基本上跟上面的题为：Tumor cells impair immunological synapse formation via central nervous system-enriched metabolite 的研究论文里面的图表一致，说明文章的数据分析是准确无误的！</p></section><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><h3 data-tool="mdnice编辑器"><span>写在文末</span></h3></section><p>如果你也想做单细胞转录组数据分析，<span>最好是有自己的计算机资源哦，比如我们的</span><a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247528363&amp;idx=1&amp;sn=5e02f3e9b2e148191e23ebc2c0d780e7&amp;scene=21#wechat_redirect" data-linktype="2">2024的共享服务器交个朋友福利价仍然是800</a><span>，而且还需要有基本的生物信息学基础，也可以看看我们的</span><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247531929&amp;idx=1&amp;sn=f6f16b7bf6b907360d6d0052e3d10cf6&amp;chksm=9b4b3d22ac3cb434b6aa7753a4cf0f266578147ccf10b49cc834e46af578ee6de99be0accb30&amp;scene=21#wechat_redirect" textvalue="生物信息学马拉‍松授课（买一得五）" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1">生物信息学马拉松授课（买一得五）</a><span> ，你的生物信息学入门课。</span></p><p><br></p><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/NY3IvpyPxb_mJEjeLe3mfg",target="_blank" rel="noopener noreferrer">原文链接</a>
