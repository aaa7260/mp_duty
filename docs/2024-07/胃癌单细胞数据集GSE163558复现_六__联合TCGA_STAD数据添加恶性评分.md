---
title: "胃癌单细胞数据集GSE163558复现(六)：联合TCGA-STAD数据添加恶性评分"
date: 2024-07-08T23:28:59Z
draft: ["false"]
tags: [
  "fetched",
  "单细胞天地"
]
categories: ["Acdemic"]
---
胃癌单细胞数据集GSE163558复现(六)：联合TCGA-STAD数据添加恶性评分 by 单细胞天地
------
<div><section data-style-type="5" data-tools="新媒体排版" data-id="2430070"><section data-style-type="5" data-tools="新媒体排版" data-id="2390348"><section><section powered-by="xiumi.us"><section><section><section powered-by="xiumi.us"><section><section><br></section><section><section><section><section><p>分享是一种态度</p></section></section></section></section></section></section></section><section><section powered-by="xiumi.us"><section><section><img data-ratio="0.8738095238095238" data-src="https://mmbiz.qpic.cn/mmbiz_gif/siaia0BDGJdjSnnb9ibXpFagGPWQ0JjSSTNVBZthROEhicfINuLcxX2Ro3Zb600LJhrzeYIb120tLjSVXEtLn14DwA/640?wx_fmt=gif" data-type="gif" data-w="420" width="100%" data-imgfileid="100040293" src="https://mmbiz.qpic.cn/mmbiz_gif/siaia0BDGJdjSnnb9ibXpFagGPWQ0JjSSTNVBZthROEhicfINuLcxX2Ro3Zb600LJhrzeYIb120tLjSVXEtLn14DwA/640?wx_fmt=gif"></section></section></section></section></section></section></section></section></section><section><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><h2 data-tool="mdnice编辑器"><span></span><span>前言</span><span></span></h2><p data-tool="mdnice编辑器">Hello小伙伴们大家好，我是生信技能树的小学徒”我才不吃蛋黄“。今天是胃癌单细胞数据集GSE163558复现系列第六期。第五期我们通过绘制饼图、堆积柱状图、气泡图等，比较不同分组之间细胞比例差异。本期，我们将下载胃癌bulk数据（TCGA-STAD），筛选胃癌相关差异表达基因，根据差异基因list，使用AddModuleScore_UCell函数给上皮细胞亚群Seurat对象添加恶性评分，以此协助区分正常上皮和恶性上皮。</p><h2 data-tool="mdnice编辑器"><span></span><span>1.背景介绍</span><span></span></h2><p data-tool="mdnice编辑器">众所周知，胃癌细胞是胃上皮细胞发生了恶性病变。在第三期对细胞分群注释时，我们并未对上皮细胞进行细分，这里面就包括非恶性上皮和恶性上皮细胞。那么该如何识别恶性上皮细胞？本文作者根据TCGA数据库中胃癌和正常胃组织之间的差异表达基因，定义了每个上皮细胞的恶性和非恶性评分，从而区分恶性上皮和非恶性上皮细胞。当然，我们还可以利用copykat和infercnv从单细胞转录组数据推断肿瘤拷贝数变异，从而区分上皮恶性与否（后期更新，敬请期待）。</p><h2 data-tool="mdnice编辑器"><span></span><span>2.数据下载</span><span></span></h2><p data-tool="mdnice编辑器">在正式分析之前，我们先从TCGA数据库获取胃癌患者的表达数据和临床数据。首先加载工作目录，创建新的文件夹，加载R包：</p><pre data-tool="mdnice编辑器"><span></span><code>rm(list=ls())<br>getwd()<br>setwd(<span>"/home/data/t020505/GSE163558-GC代码公众号复现版"</span>)<br>dir.create(<span>"6-TCGA_STAD"</span>)<br>setwd(<span>'6-TCGA_STAD/'</span>)<br><span>source</span>(<span>'../scRNA_scripts/mycolors.R'</span>)<br>library(tidyverse)<br>library(data.table) <br><span>#如果需要下载TCGA其他癌种，请更换proj</span><br>proj = <span>"TCGA-STAD"</span><br>dir.create(<span>"input"</span>)<br></code></pre><p data-tool="mdnice编辑器">在R中利用代码一键下载TCGA数据库胃癌患者的表达数据及临床数据，并将下载好了数据存放在input文件夹：</p><pre data-tool="mdnice编辑器"><span></span><code><span>if</span>(T){<br>  download.file(url = paste0(<span>"https://gdc.xenahubs.net/download/"</span>,proj, <span>".htseq_counts.tsv.gz"</span>),destfile = paste0(<span>"input/"</span>,proj,<span>".htseq_counts.tsv.gz"</span>))  <span>##表达数据</span><br>  download.file(url = paste0(<span>"https://gdc.xenahubs.net/download/"</span>,proj, <span>".GDC_phenotype.tsv.gz"</span>),destfile = paste0(<span>"input/"</span>,proj,<span>".GDC_phenotype.tsv.gz"</span>)) <span>##临床数据</span><br>  download.file(url = paste0(<span>"https://gdc.xenahubs.net/download/"</span>,proj, <span>".survival.tsv"</span>),destfile = paste0(<span>"input/"</span>,proj,<span>".survival.tsv"</span>)) <span>##生存数据</span><br>}<br>clinical = read.delim(paste0(<span>"input/"</span>,proj,<span>".GDC_phenotype.tsv.gz"</span>),fill = T,header = T,sep = <span>"\t"</span>)<br>surv = read.delim(paste0(<span>"input/"</span>,proj,<span>".survival.tsv"</span>),header = T) <br>head(surv) <span>#生存数据os和os.time</span><br></code></pre><p data-tool="mdnice编辑器">生存数据包括os和os.time：</p><figure data-tool="mdnice编辑器"><img data-imgfileid="100040296" data-ratio="0.3659217877094972" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQPYculj8enTHQNMDiaJpFMdZVXgXAeUaYJjiakiaUibHCEyA2u7VeiagbAAYRBMZSOjwkZv6uGY7ibTTnA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="358" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQPYculj8enTHQNMDiaJpFMdZVXgXAeUaYJjiakiaUibHCEyA2u7VeiagbAAYRBMZSOjwkZv6uGY7ibTTnA/640?wx_fmt=png&amp;from=appmsg"></figure><h2 data-tool="mdnice编辑器"><span></span><span>3.数据整理</span><span></span></h2><p data-tool="mdnice编辑器">在下载完数据之后，我们需要对数据进行初步的整理。</p><h3 data-tool="mdnice编辑器"><span></span><span>3.1 处理表达矩阵</span><span></span></h3><p data-tool="mdnice编辑器">首先处理表达矩阵：</p><pre data-tool="mdnice编辑器"><span></span><code>dat = read.table(paste0(<span>"input/"</span>,proj,<span>".htseq_counts.tsv.gz"</span>),check.names = F,row.names = 1,header = T)<br>dat &lt;- data.table::fread(paste0(<span>"input/"</span>,proj,<span>".htseq_counts.tsv.gz"</span>),<br>                         data.table = F) <span>#全部是symbol</span><br><br>a = dat[60483:60488,]<br>dat = dat[1:60483,]<br>rownames(dat) = dat<span>$Ensembl_ID</span><br>a = dat<br>a = a[,-1]<br>exp = a<br></code></pre><p data-tool="mdnice编辑器">去除在所有样本里表达量都为零的基因：</p><pre data-tool="mdnice编辑器"><span></span><code>exp = exp[rowSums(exp)&gt;0,]<br>nrow(exp)<br></code></pre><p data-tool="mdnice编辑器">仅保留在一半以上样本里表达的基因：</p><pre data-tool="mdnice编辑器"><span></span><code>exp = exp[apply(exp, 1, <span>function</span>(x) sum(x &gt; 0) &gt; 0.5*ncol(exp)), ]<br>nrow(exp)<br></code></pre><p data-tool="mdnice编辑器">表达矩阵行名ID转换：</p><pre data-tool="mdnice编辑器"><span></span><code>library(stringr)<br>head(rownames(exp))<br>library(AnnoProbe)<br>rownames(exp) = substr(rownames(exp), 1, 15)<br><span>##rownames(exp) = str_split(rownames(exp),"\\.",simplify = T)[,1];head(rownames(exp))</span><br><span>#annoGene(rownames(exp),ID_type = "ENSEMBL") </span><br>re = annoGene(rownames(exp),ID_type = <span>"ENSEMBL"</span>);head(re)<br><span>#if(!require(tinyarray))devtools::install_github("xjsun1221/tinyarray",upgrade = FALSE,dependencies = TRUE)</span><br>library(tinyarray)<br>exp = trans_array(exp,ids = re,from = <span>"ENSEMBL"</span>,to = <span>"SYMBOL"</span>)<br>exp[1:4,1:4]<br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span>3.2 整理分组信息</span><span></span></h3><p data-tool="mdnice编辑器">然后整理分组信息:</p><p data-tool="mdnice编辑器">根据样本ID的第14-15位，给样本分组（tumor和normal）：</p><ul data-tool="mdnice编辑器"><li><section>01A：癌症组织</section></li><li><section>01B：福尔马林浸泡样本</section></li><li><section>02A：复发组织</section></li><li><section>06A：转移组织</section></li><li><section>11A：癌旁组织</section></li></ul><pre data-tool="mdnice编辑器"><span></span><code>table(str_sub(colnames(exp),14,15))  <br>table(str_sub(colnames(exp),14,16)) <br>Group = ifelse(as.numeric(str_sub(colnames(exp),14,15)) &lt; 10,<span>'tumor'</span>,<span>'normal'</span>)  <br>Group = factor(Group,levels = c(<span>"normal"</span>,<span>"tumor"</span>))<br>table(Group)<br>group = make_tcga_group(exp)<br>table(group)<br></code></pre><p data-tool="mdnice编辑器">保存数据：</p><pre data-tool="mdnice编辑器"><span></span><code>save(exp,Group,proj,clinical,surv,file = paste0(proj,<span>".Rdata"</span>))<br></code></pre><h2 data-tool="mdnice编辑器"><span></span><span>4.数据分析</span><span></span></h2><h3 data-tool="mdnice编辑器"><span></span><span>4.1 TCGA差异分析</span><span></span></h3><p data-tool="mdnice编辑器">首先清除系统环境变量，加载TCGA数据，加载差异分析R包“edgeR”：</p><pre data-tool="mdnice编辑器"><span></span><code>rm(list = ls())<br>load(<span>"TCGA-STAD.Rdata"</span>)<br>table(Group)<br>library(edgeR)<br></code></pre><p data-tool="mdnice编辑器">开始进行胃癌和癌旁组织差异基因分析：</p><pre data-tool="mdnice编辑器"><span></span><code>dge &lt;- DGEList(counts=exp,group=Group)<br>dge<span>$samples</span><span>$lib</span>.size &lt;- colSums(dge<span>$counts</span>)<br>dge &lt;- calcNormFactors(dge) <br>design &lt;- model.matrix(~Group)<br>dge &lt;- estimateGLMCommonDisp(dge, design)<br>dge &lt;- estimateGLMTrendedDisp(dge, design)<br>dge &lt;- estimateGLMTagwiseDisp(dge, design)<br>fit &lt;- glmFit(dge, design)<br>fit &lt;- glmLRT(fit) <br>DEG2=topTags(fit, n=Inf)<br>class(DEG2)<br>DEG2=as.data.frame(DEG2)<br>head(DEG2)<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100040299" data-ratio="0.26851851851851855" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQPYculj8enTHQNMDiaJpFMdpuQjwSmzjkWfKxib92zqCra1QYQdgxMFkWBicic6k19S19PwxyC2Nyy3w/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="540" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQPYculj8enTHQNMDiaJpFMdpuQjwSmzjkWfKxib92zqCra1QYQdgxMFkWBicic6k19S19PwxyC2Nyy3w/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器">添加change列标记基因上调下调，在这里，我们对差异分析筛选的阈值为：“| log2 fold change |&gt;1, pvalue &lt;0.05”,最终在胃癌中筛选到了2213个上调基因，142个下调基因。</p><pre data-tool="mdnice编辑器"><span></span><code>logFC_t = 1<br>pvalue_t = 0.05<br>k1 = (DEG2<span>$PValue</span> &lt; pvalue_t)&amp;(DEG2<span>$logFC</span> &lt; -logFC_t)<br>k2 = (DEG2<span>$PValue</span> &lt; pvalue_t)&amp;(DEG2<span>$logFC</span> &gt; logFC_t)<br>DEG2<span>$change</span> = ifelse(k1,<span>"DOWN"</span>,ifelse(k2,<span>"UP"</span>,<span>"NOT"</span>))<br>head(DEG2)<br>table(DEG2<span>$change</span>)<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100040298" data-ratio="0.2356902356902357" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQPYculj8enTHQNMDiaJpFMdtXp3WqTIU3QKcZ15d7kyvweJVQnp6Atkpab5eZnicMlDzpXcqejE2Wg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="594" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQPYculj8enTHQNMDiaJpFMdtXp3WqTIU3QKcZ15d7kyvweJVQnp6Atkpab5eZnicMlDzpXcqejE2Wg/640?wx_fmt=png&amp;from=appmsg"></figure><figure data-tool="mdnice编辑器"><img data-imgfileid="100040297" data-ratio="0.37967914438502676" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQPYculj8enTHQNMDiaJpFMd40PCicbXzKpJGC2EKk1libOSFsibpkgu70vfxcMqbqdf1vnhwyfN9zJeQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="187" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQPYculj8enTHQNMDiaJpFMd40PCicbXzKpJGC2EKk1libOSFsibpkgu70vfxcMqbqdf1vnhwyfN9zJeQ/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器">保存差异分析结果：</p><pre data-tool="mdnice编辑器"><span></span><code>save(DEG2,Group,file = paste0(proj,<span>"_DEG.Rdata"</span>))<br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span>4.2.差异基因可视化</span><span></span></h3><p data-tool="mdnice编辑器">差异基因可视化选择了热图和火山图：</p><pre data-tool="mdnice编辑器"><span></span><code>library(ggplot2)<br>library(tinyarray)<br>dat = log2(cpm(exp)+1)<br>pca.plot = draw_pca(dat,Group);pca.plot<br>save(pca.plot,file = paste0(proj,<span>"_pcaplot.Rdata"</span>))<br>cg2 = rownames(DEG2)[DEG2<span>$change</span> !=<span>"NOT"</span>]<br>h2 = draw_heatmap(dat[cg2,],Group)<br>v2 = draw_volcano(DEG2,pkg = 2,logFC_cutoff = logFC_t)<br>library(patchwork)<br>h2 + v2 +plot_layout(guides = <span>'collect'</span>) &amp;theme(legend.position = <span>"none"</span>)<br>ggsave(paste0(proj,<span>"_heat_vo.png"</span>),width = 16,height = 9)<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100040300" data-ratio="0.4786680541103018" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQPYculj8enTHQNMDiaJpFMd3EkbnhFvichUgmB5zLBRbbDeK4AjJic9OQpiaQBupHVuKjh2GyZjZoxRg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="961" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQPYculj8enTHQNMDiaJpFMd3EkbnhFvichUgmB5zLBRbbDeK4AjJic9OQpiaQBupHVuKjh2GyZjZoxRg/640?wx_fmt=png&amp;from=appmsg"></figure><h3 data-tool="mdnice编辑器"><span></span><span>4.3 提取上皮细胞亚群</span><span></span></h3><p data-tool="mdnice编辑器">设置随机种子，读取第三期细胞分群注释后的单细胞文件：</p><pre data-tool="mdnice编辑器"><span></span><code>set.seed(12345)<br>sce.all=readRDS( <span>"../3-Celltype/sce_celltype.rds"</span>)<br>table(sce.all<span>$celltype</span>)<br></code></pre><p data-tool="mdnice编辑器">提取出其中的上皮细胞：</p><pre data-tool="mdnice编辑器"><span></span><code>sce1 = sce.all[, sce.all<span>$celltype</span> %<span>in</span>% c( <span>'Epithelial'</span> )]<br></code></pre><p data-tool="mdnice编辑器">然后对上皮细胞亚群走Seurat V5标准流程（同第二期）：</p><pre data-tool="mdnice编辑器"><span></span><code>names(sce1@assays<span>$RNA</span>@layers)<br>sce1[[<span>"RNA"</span>]]<span>$counts</span> <br>LayerData(sce1, assay = <span>"RNA"</span>, layer = <span>"counts"</span>)<br>dim(sce1[[<span>"RNA"</span>]]<span>$counts</span> )<br>as.data.frame(sce1@assays<span>$RNA</span><span>$counts</span>[1:10, 1:2])<br>head(sce1@meta.data, 10)<br>table(sce1<span>$orig</span>.ident) <br>sce = sce1<br>sce &lt;- NormalizeData(sce, normalization.method =  <span>"LogNormalize"</span>,               scale.factor = 1e4)<br>GetAssay(sce,assay = <span>"RNA"</span>)<br>sce &lt;- FindVariableFeatures(sce, selection.method = <span>"vst"</span>,<br>                            nfeatures = 2000)  <br>sce &lt;- ScaleData(sce) <br>sce &lt;- RunPCA(object = sce, pc.genes = VariableFeatures(sce)) <br>DimHeatmap(sce, dims = 1:12, cells = 100, balanced = TRUE)<br>ElbowPlot(sce) <br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100040304" data-ratio="0.603125" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQPYculj8enTHQNMDiaJpFMd3yqb8X9odQGHPBwvNm6lFUveL3svyRSAKh5jIzoiagL0Nah5eKuTm8w/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="960" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQPYculj8enTHQNMDiaJpFMd3yqb8X9odQGHPBwvNm6lFUveL3svyRSAKh5jIzoiagL0Nah5eKuTm8w/640?wx_fmt=png&amp;from=appmsg"><figcaption>DimHeatmap</figcaption></figure><figure data-tool="mdnice编辑器"><img data-imgfileid="100040301" data-ratio="0.5966562173458725" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQPYculj8enTHQNMDiaJpFMd0DLjUTgtkichF0z0AjCPDaIZO18pTot0oRntiat2RXYSONexxic9t36qA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="957" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQPYculj8enTHQNMDiaJpFMd0DLjUTgtkichF0z0AjCPDaIZO18pTot0oRntiat2RXYSONexxic9t36qA/640?wx_fmt=png&amp;from=appmsg"><figcaption>ElbowPlot</figcaption></figure><p data-tool="mdnice编辑器"><strong>分辨率设置为0.1：</strong></p><pre data-tool="mdnice编辑器"><span></span><code>sce &lt;- FindNeighbors(sce, dims = 1:15)<br>sce &lt;- FindClusters(sce, resolution = 0.1)<br>table(sce@meta.data<span>$RNA_snn_res</span>.0.1) <br></code></pre><p data-tool="mdnice编辑器"><strong>数据降维：</strong></p><pre data-tool="mdnice编辑器"><span></span><code>set.seed(321)<br>sce &lt;- RunTSNE(object = sce, dims = 1:15, do.fast = TRUE)<br>sce &lt;- RunUMAP(object = sce, dims = 1:5, do.fast = TRUE)<br></code></pre><p data-tool="mdnice编辑器"><strong>分群可视化：</strong></p><pre data-tool="mdnice编辑器"><span></span><code>p = DimPlot(sce,reduction = <span>"tsne"</span>,label=T,cols = mycolors) <br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100040305" data-ratio="0.5925925925925926" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQPYculj8enTHQNMDiaJpFMdeQ7ERicQTmsylrAEV22fiapbVzvzexKl6fAIg3EVOOniceT2wTyibuNLew/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="945" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQPYculj8enTHQNMDiaJpFMdeQ7ERicQTmsylrAEV22fiapbVzvzexKl6fAIg3EVOOniceT2wTyibuNLew/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器">然后保存上皮细胞rds文件：</p><pre data-tool="mdnice编辑器"><span></span><code>saveRDS(sce,file = <span>"Epithelial.rds"</span>)<br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span>4.4 AddModuleScore_UCell函数恶性评分</span><span></span></h3><p data-tool="mdnice编辑器">AddModuleScore_UCell函数可以实现基因集合打分，通过评估单细胞数据集中特定基因特征的表达模式，我们可以量化生物学信号的强度，并鉴定细胞的亚型和状态。在胃癌组织中取上调排名前50的差异基因用作恶性评分，下调排名前50的差异基因用作正常评分。</p><pre data-tool="mdnice编辑器"><span></span><code><span>#sce = readRDS('Epithelial.rds')</span><br>head(DEG2)<br>table(DEG2<span>$change</span>)<br>UP = DEG2[DEG2<span>$change</span> == <span>'UP'</span> &amp; DEG2<span>$FDR</span> &lt;0.01,]<br>DOWN = DEG2[DEG2<span>$change</span> == <span>'DOWN'</span> &amp; DEG2<span>$FDR</span> &lt;0.01,]<br><span>##用作恶性评分</span><br>sorted_up = UP[order(UP<span>$FDR</span>),]<br>top_50_upgene = rownames(sorted_up[1:50, ]) <br><span>##用作正常评分</span><br>sorted_down = DOWN[order(DOWN<span>$FDR</span>),]<br>top_50_downgene = rownames(sorted_down[1:50, ])<br>library(UCell)<br>marker &lt;- list(top_50_upgene,top_50_downgene)<span>#将基因整成list</span><br>names(marker)[1] &lt;- <span>'tumor'</span><br>names(marker)[2] &lt;- <span>'normal'</span><br>score &lt;- AddModuleScore_UCell(sce,features=marker)<br></code></pre><p data-tool="mdnice编辑器">计算每个上皮细胞的恶性评分减去非恶性评分，并将评分从小到大排序以拟合生长曲线。然后，根据生长曲线拐点附近的最大间隙，将细胞分为得分较高的恶性细胞（≥0.02）或得分较低的非恶性细胞（≤0.02）。</p><pre data-tool="mdnice编辑器"><span></span><code>sce2 = score<br>df = sce2@meta.data<br>df<span>$score</span> = df<span>$tumor_UCell</span> - df<span>$normal_UCell</span><br>table(df<span>$score</span>)<br>dim(sce)<br>df<span>$score1</span> = <span>'unknown'</span><br>df[df<span>$score</span> &gt; -0.02,]<span>$score1</span> = <span>'malignant'</span><br>table(df<span>$score1</span>)<br>df[df<span>$score</span> &lt; -0.02,]<span>$score1</span> = <span>'nonmalignant'</span><br>table(df<span>$score1</span>)<br>sce2@meta.data = df<br>DimPlot(sce2, reduction = <span>"tsne"</span>,cols = mycolors,pt.size = 0.8,<br>              group.by = <span>"score1"</span>,label = T,label.box = T)<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100040303" data-ratio="0.5489989462592202" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQPYculj8enTHQNMDiaJpFMdibfDZpwibmia8CNy0HXiaTa46s52G0jeIC9kDLUfSNDRMbpEon5Qm7LJicg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="949" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQPYculj8enTHQNMDiaJpFMdibfDZpwibmia8CNy0HXiaTa46s52G0jeIC9kDLUfSNDRMbpEon5Qm7LJicg/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器">然后绘制气泡图和堆积性柱状图可视化分组细胞比例（同第五期 <a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247523730&amp;idx=1&amp;sn=fc87d1d4ffdd8712bda7e980679828e9&amp;chksm=ea1c9b10dd6b120613c9f3bf39c7d25713ad1de248370a1198c389c18e7875286c45ca924838&amp;scene=21#wechat_redirect" textvalue="胃癌单细胞数据集GSE163558复现(五)：细胞比例" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2">胃癌单细胞数据集GSE163558复现(五)：细胞比例</a>）：</p><pre data-tool="mdnice编辑器"><span></span><code>tb=table(sce2<span>$tissue</span>, sce2<span>$score1</span>)<br>head(tb)<br>library (gplots) <br>balloonplot(tb)<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100040302" data-ratio="0.5811320754716981" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQPYculj8enTHQNMDiaJpFMdwd8Oib04nZcK3xG8b2MibyIyndkicdrtmTngXeYXyzR24SIuTnFC56dQw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="795" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQPYculj8enTHQNMDiaJpFMdwd8Oib04nZcK3xG8b2MibyIyndkicdrtmTngXeYXyzR24SIuTnFC56dQw/640?wx_fmt=png&amp;from=appmsg"></figure><pre data-tool="mdnice编辑器"><span></span><code>bar_data &lt;- as.data.frame(tb)<br><br>bar_per &lt;- bar_data %&gt;% <br>  group_by(Var1) %&gt;%<br>  mutate(sum(Freq)) %&gt;%<br>  mutate(percent = Freq / `sum(Freq)`)<br>head(bar_per) <br><span>#write.csv(bar_per,file = "celltype_by_group_percent.csv")</span><br>col =c(<span>"#3176B7"</span>,<span>"#F78000"</span>,<span>"#3FA116"</span>,<span>"#CE2820"</span>,<span>"#9265C1"</span>,<br>       <span>"#885649"</span>,<span>"#DD76C5"</span>,<span>"#BBBE00"</span>,<span>"#41BED1"</span>)<br>colnames(bar_per)<br><br>library(ggthemes)<br>p1 = ggplot(bar_per, aes(x = percent, y = Var1)) +<br>  geom_bar(aes(fill = Var2) , <span>stat</span> = <span>"identity"</span>) + coord_flip() +<br>  theme(axis.ticks = element_line(linetype = <span>"blank"</span>),<br>        legend.position = <span>"top"</span>,<br>        panel.grid.minor = element_line(colour = NA,linetype = <span>"blank"</span>), <br>        panel.background = element_rect(fill = NA),<br>        plot.background = element_rect(colour = NA)) +<br>  labs(y = <span>" "</span>, fill = NULL)+labs(x = <span>'Relative proportion(%)'</span>)+<br>  scale_fill_manual(values=col)+<br>  theme_few()+<br>  theme(plot.title = element_text(size=12,hjust=0.5))<br>p1<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100040308" data-ratio="0.5414937759336099" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQPYculj8enTHQNMDiaJpFMdykktvHzvKwuIDADmvklyuKIHdD1scKHhkAt9ZDianCcDMv4MZnKTs4w/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="964" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQPYculj8enTHQNMDiaJpFMdykktvHzvKwuIDADmvklyuKIHdD1scKHhkAt9ZDianCcDMv4MZnKTs4w/640?wx_fmt=png&amp;from=appmsg"><figcaption>p1</figcaption></figure><pre data-tool="mdnice编辑器"><span></span><code>tb=table(sce2<span>$sample</span>, sce2<span>$score1</span>)<br>head(tb)<br>                          <br>                           malignant nonmalignant<br>  adjacent_nontumor               84           92<br>  GC                            2805            4<br>  GC_liver_metastasis             39            0<br>  GC_lymph_metastasis             82            0<br>  GC_ovary_metastasis            578            0<br>  GC_peritoneum_metastasis       258            0<br>library (gplots) <br>balloonplot(tb)<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100040307" data-ratio="0.504708097928437" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQPYculj8enTHQNMDiaJpFMd6yImUAvhbGocKro2pI7UJn9TichkPUwY9jR3GoDKUdjaBxXsXQaMj4Q/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1062" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQPYculj8enTHQNMDiaJpFMd6yImUAvhbGocKro2pI7UJn9TichkPUwY9jR3GoDKUdjaBxXsXQaMj4Q/640?wx_fmt=png&amp;from=appmsg"></figure><pre data-tool="mdnice编辑器"><span></span><code>bar_data &lt;- as.data.frame(tb)<br><br>bar_per &lt;- bar_data %&gt;% <br>  group_by(Var1) %&gt;%<br>  mutate(sum(Freq)) %&gt;%<br>  mutate(percent = Freq / `sum(Freq)`)<br>head(bar_per) <br>colnames(bar_per)<br><br>library(ggthemes)<br>p2 = ggplot(bar_per, aes(x = percent, y = Var1)) +<br>  geom_bar(aes(fill = Var2) , <span>stat</span> = <span>"identity"</span>) + coord_flip() +<br>  theme(axis.ticks = element_line(linetype = <span>"blank"</span>),<br>        legend.position = <span>"top"</span>,<br>        panel.grid.minor = element_line(colour = NA,linetype = <span>"blank"</span>), <br>        panel.background = element_rect(fill = NA),<br>        plot.background = element_rect(colour = NA)) +<br>  labs(y = <span>" "</span>, fill = NULL)+labs(x = <span>'Relative proportion(%)'</span>)+<br>  scale_fill_manual(values=col)+<br>  theme_few()+<br>  theme(plot.title = element_text(size=12,hjust=0.5)) + <br>  theme(axis.text.x = element_text(angle = 45, hjust = 1))<br><br>p2<br>p1+p2<br>ggsave(filename=<span>"prop.pdf"</span>,width = 12,height = 8)<br>saveRDS(sce2,file = <span>"tumorEpithelial.rds"</span>)<br><br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100040310" data-ratio="0.49902912621359224" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQPYculj8enTHQNMDiaJpFMdzqxpwe4X8JuP5YnaMQeW5CVDQ1oV9FHgxIicxWMgzprLN5E4ZFWlGCA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1030" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQPYculj8enTHQNMDiaJpFMdzqxpwe4X8JuP5YnaMQeW5CVDQ1oV9FHgxIicxWMgzprLN5E4ZFWlGCA/640?wx_fmt=png&amp;from=appmsg"><figcaption>p2</figcaption></figure><figure data-tool="mdnice编辑器"><img data-imgfileid="100040309" data-ratio="0.48677766895200786" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQPYculj8enTHQNMDiaJpFMdlMD0bOqR66zNP0RCyFQfhqVXrmsKfbGp42RYj3OzRpYTNqPnuUH7Lw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1021" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQPYculj8enTHQNMDiaJpFMdlMD0bOqR66zNP0RCyFQfhqVXrmsKfbGp42RYj3OzRpYTNqPnuUH7Lw/640?wx_fmt=png&amp;from=appmsg"><figcaption>p1+p2</figcaption></figure><h3 data-tool="mdnice编辑器"><span></span><span>4.5 提取恶性上皮亚群</span><span></span></h3><p data-tool="mdnice编辑器">在添加恶性评分之后，我们可以在从上皮细胞中提取恶性上皮亚群，继续走Seurat V5标准流程：</p><pre data-tool="mdnice编辑器"><span></span><code>table(sce2<span>$score1</span>)<br>tumor = sce2[, sce2<span>$score1</span> %<span>in</span>% c( <span>'malignant'</span> )]<br>set.seed(1234567)<br>tumor[[<span>"RNA"</span>]]<span>$counts</span> <br>LayerData(tumor, assay = <span>"RNA"</span>, layer = <span>"counts"</span>)<br>tumor &lt;- JoinLayers(tumor)<br>dim(tumor[[<span>"RNA"</span>]]<span>$counts</span> )<br>as.data.frame(tumor@assays<span>$RNA</span><span>$counts</span>[1:10, 1:2])<br>head(tumor@meta.data, 10)<br>table(tumor<span>$orig</span>.ident) <br>tumor &lt;- NormalizeData(tumor, normalization.method =  <span>"LogNormalize"</span>,  <br>                       scale.factor = 1e4)<br>GetAssay(tumor,assay = <span>"RNA"</span>)<br>tumor &lt;- FindVariableFeatures(tumor, <br>                              selection.method = <span>"vst"</span>, nfeatures = 2000)  <br>tumor &lt;- ScaleData(tumor) <br>tumor &lt;- RunPCA(object = tumor, pc.genes = VariableFeatures(tumor)) <br>DimHeatmap(tumor, dims = 1:12, cells = 100, balanced = TRUE)<br>ElbowPlot(tumor) <br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100040306" data-ratio="0.5331412103746398" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQPYculj8enTHQNMDiaJpFMdRpd2CezVJfIXYBibFb56nQcfNggefSMqp6UwhtYEwVX20D2dic7syFrQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1041" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQPYculj8enTHQNMDiaJpFMdRpd2CezVJfIXYBibFb56nQcfNggefSMqp6UwhtYEwVX20D2dic7syFrQ/640?wx_fmt=png&amp;from=appmsg"></figure><pre data-tool="mdnice编辑器"><span></span><code>tumor &lt;- FindNeighbors(tumor, dims = 1:15)<br>tumor &lt;- FindClusters(tumor, resolution = 0.1)<br>table(tumor@meta.data<span>$RNA_snn_res</span>.0.1)  <br>set.seed(321)<br>tumor &lt;- RunTSNE(object = tumor, dims = 1:15, do.fast = TRUE)<br><br>tumor &lt;- RunUMAP(object = tumor, dims = 1:5, do.fast = TRUE)<br><br>mycolors &lt;-c(<span>'#E64A35'</span>,<span>'#4DBBD4'</span> ,<span>'#01A187'</span>  ,<span>'#3C5588'</span>  ,<span>'#F29F80'</span>  ,<br>             <span>'#8491B6'</span>,<span>'#91D0C1'</span>,<span>'#7F5F48'</span>,<span>'#AF9E85'</span>,<span>'#4F4FFF'</span>,<span>'#CE3D33'</span>,<br>             <span>'#739B57'</span>,<span>'#EFE685'</span>,<span>'#446983'</span>,<span>'#BB6239'</span>,<span>'#5DB1DC'</span>,<span>'#7F2268'</span>,<span>'#6BD66B'</span>,<span>'#800202'</span>,<span>'#D8D8CD'</span>,<span>'pink'</span><br>)<br><br>p2 = DimPlot(tumor,reduction = <span>"tsne"</span>,label=T,cols = mycolors)+<br>  theme_few()<br>p2<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100040315" data-ratio="0.5444874274661509" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQPYculj8enTHQNMDiaJpFMdV9e5Lsic2mwf9tZfHjD1LbOArbfyE8GxAzat02IAJxuicAl41KESfNMw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1034" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQPYculj8enTHQNMDiaJpFMdV9e5Lsic2mwf9tZfHjD1LbOArbfyE8GxAzat02IAJxuicAl41KESfNMw/640?wx_fmt=png&amp;from=appmsg"><figcaption>p2</figcaption></figure><p data-tool="mdnice编辑器">保存恶性上皮细胞rds文件</p><pre data-tool="mdnice编辑器"><span></span><code>table(tumor<span>$seurat_clusters</span>)<br>   0    1    2    3    4 <br>2275  579  482  314  196 <br>tumor<span>$celltype</span> = paste0(<span>'G'</span>,tumor<span>$seurat_clusters</span>)<br>table(tumor<span>$celltype</span>)<br>  G0   G1   G2   G3   G4 <br>2275  579  482  314  196 <br>saveRDS(tumor,file = <span>"malignant.rds"</span>)<br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span>4.6 富集分析</span><span></span></h3><p data-tool="mdnice编辑器">提取恶性上皮细胞之后，我们接着从单细胞层面筛选出了特征基因，并在此基础上进行了富集分析。</p><p data-tool="mdnice编辑器">首先读取恶性上皮细胞rds文件，加载R包：</p><pre data-tool="mdnice编辑器"><span></span><code><span>#sce =readRDS('malignant.rds') </span><br>sce = tumor<br><span>###热图表示GO富集分析</span><br>library(grid)<br>library(ggplot2)<br>library(gridExtra)<br>library(clusterProfiler)<br>library(org.Hs.eg.db)<br>library(enrichplot)<br>library(ggplot2)<br>library(org.Hs.eg.db)<br>library(GOplot)<br></code></pre><p data-tool="mdnice编辑器">然后使用Seurat内置函数FindAllMarkers筛选特征基因：</p><pre data-tool="mdnice编辑器"><span></span><code>markers &lt;- FindAllMarkers(object = sce, only.pos = TRUE, <br>                          min.pct = 0.25, <br>                          thresh.use = 0.25)<br>write.csv(markers,file=<span>'markers.csv'</span>)<br><br><span>#markers = read.csv('markers.csv',row.names = 1)</span><br>table(markers<span>$cluster</span>)<br>library(dplyr) <br>gene = markers[markers<span>$p_val</span> &lt;0.01 &amp; markers<span>$avg_log2FC</span> &gt;2,]<span>$gene</span><br>entrezIDs = bitr(gene, fromType = <span>"SYMBOL"</span>, toType = <span>"ENTREZID"</span>, OrgDb= <span>"org.Hs.eg.db"</span>, drop = TRUE)<br>gene&lt;- entrezIDs<span>$ENTREZID</span><br>marker_new = markers[markers<span>$gene</span> %<span>in</span>% entrezIDs<span>$SYMBOL</span>,]<br>marker_new = marker_new[!duplicated(marker_new<span>$gene</span>),]<br>identical(marker_new<span>$gene</span>, entrezIDs<span>$SYMBOL</span>)<br>p = identical(marker_new<span>$gene</span>, entrezIDs<span>$SYMBOL</span>);p<br><span>if</span>(!p) entrezIDs = entrezIDs[match(marker_new<span>$gene</span>,entrezIDs<span>$SYMBOL</span>),]<br>marker_new<span>$ID</span> = entrezIDs<span>$ENTREZID</span><br></code></pre><p data-tool="mdnice编辑器">GO富集分析：</p><pre data-tool="mdnice编辑器"><span></span><code>gcSample=split(marker_new<span>$ID</span>, marker_new<span>$cluster</span>) <br><span>###参数可以更改，看看?compareCluster</span><br>xx &lt;- compareCluster(gcSample,<br>                     fun = <span>"enrichGO"</span>,<br>                     OrgDb = <span>"org.Hs.eg.db"</span>,<br>                     ont = <span>"BP"</span>,<br>                     pAdjustMethod = <span>"BH"</span>,<br>                     pvalueCutoff = 0.01,<br>                     qvalueCutoff = 0.05<br>)<br>p &lt;- dotplot(xx)<br>library(ggthemes)<br>p + theme(axis.text.x = element_text(<br>  angle = 45,<br>  vjust = 0.5, hjust = 0.5<br>))+theme_few()<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100040314" data-ratio="0.5249266862170088" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQPYculj8enTHQNMDiaJpFMdnx5T8UoGEj3VTUHLm5mUdibwuv8gicbVJUubj8ZIbaMxxFJo1iaqoqDhQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1023" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQPYculj8enTHQNMDiaJpFMdnx5T8UoGEj3VTUHLm5mUdibwuv8gicbVJUubj8ZIbaMxxFJo1iaqoqDhQ/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器">还可以使用热图展示GO富集：</p><pre data-tool="mdnice编辑器"><span></span><code>a = xx@compareClusterResult<br>colnames(a)<br>a<span>$p</span> = -log10(a<span>$pvalue</span>)<br>b = a[,c(1,3,11)]<br>library(reshape2)<br>colnames(b)<br>library(tidyr)<br>wide_data &lt;- pivot_wider(b, names_from = Cluster, values_from = p)<br><br>wide_data = as.data.frame(wide_data)<br>rownames(wide_data) = wide_data<span>$Description</span><br>wide = wide_data[,-1]<br>wide = wide[c(1:13),]<br>rownames(wide) &lt;- sapply(rownames(wide), <span>function</span>(x) paste0(substr(x, 1, 40), <span>"..."</span>))<br>wide = as.matrix(wide)<br>library(pheatmap)<br>B &lt;- pheatmap(wide, show_rownames = T,<br>              show_colnames = T,<br>              col = colorRampPalette(c(<span>"white"</span>,<span>"firebrick3"</span>))(255),<br>              annotation_names_row = T,<span>#不显示行注释信息</span><br>              annotation_names_col = T ,<span>#不显示列注释信息</span><br>              column_title = NULL,<span>#不显示列标题</span><br>              cluster_rows = F,<br>              cluster_cols = F,<br>              scale = <span>'column'</span>,<br>              row_title = NULL)<span>#不显示行标题scale = "row"</span><br>B<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100040316" data-ratio="0.5185891325071497" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQPYculj8enTHQNMDiaJpFMd4bxU87JCN8Tuw2u68ZBMCpLu3dzfxTOYqtkC1lcIHiaIRU0sW5DoFgw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1049" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQPYculj8enTHQNMDiaJpFMd4bxU87JCN8Tuw2u68ZBMCpLu3dzfxTOYqtkC1lcIHiaIRU0sW5DoFgw/640?wx_fmt=png&amp;from=appmsg"><figcaption>B</figcaption></figure><h2 data-tool="mdnice编辑器"><span></span><span>结语</span><span></span></h2><p data-tool="mdnice编辑器">本期，我们根据TCGA数据库中胃癌和正常胃组织之间的差异表达基因，定义了每个上皮细胞的恶性和非恶性评分。下一期，我们将在本期基础上，分析恶性上皮细胞G0-G4的Marker基因并绘制热图和小提琴图，此外，我们还将使用AddModuleScore_UCell函数计算细胞的增殖和迁移评分。干货满满，欢迎大家持续追更，谢谢！</p></section><section data-style-type="5" data-tools="新媒体排版" data-id="2440476"><section><section><section><section><img data-imgfileid="100040292" data-ratio="0.9495798319327731" data-src="https://mmbiz.qpic.cn/mmbiz_gif/09gp6SvPE04j3m2v7Hr889icHUyibTOHs8YuUibicl7ibRD0ZwG5pDTjBluRreZvuib1o3BibvLkicYhnA4YW7dQsjn0cA/640?wx_fmt=gif" data-type="gif" data-w="119" data-width="100%" src="https://mmbiz.qpic.cn/mmbiz_gif/09gp6SvPE04j3m2v7Hr889icHUyibTOHs8YuUibicl7ibRD0ZwG5pDTjBluRreZvuib1o3BibvLkicYhnA4YW7dQsjn0cA/640?wx_fmt=gif"></section><section data-brushtype="text">往期回顾</section><section><br></section></section></section></section><section><section data-autoskip="1"><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247523888&amp;idx=1&amp;sn=c42c43a7acb5390cf647dd69e70b1e02&amp;chksm=ea1c98b2dd6b11a41aa62381cd7d8357e9f6190f309ff612f5003c76ebdc74c5b983f8899b28&amp;scene=21#wechat_redirect" textvalue="PDX小鼠模型的单细胞样品定量能选择人类参考基因组吗" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2"><span>PDX小鼠模型的单细胞样品定量能选择人类参考基因组吗</span></a><br></p><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247523839&amp;idx=1&amp;sn=5f40072170ad515ac2a77cd64bee4272&amp;chksm=ea1c9b7ddd6b126bf871437758363a496c2b3f17dfb836ab380b6ec6170e07e0ac81e9f08bf5&amp;scene=21#wechat_redirect" textvalue="话八 | 一千个放弃生信的理由" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2"><span>话八 | 一千个放弃生信的理由</span></a><br></p><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247523828&amp;idx=1&amp;sn=9245f1906ce53b921ac20748bc4ffcc8&amp;chksm=ea1c9b76dd6b126079dc0d3bc94a518c3b865c8f76da22a38c745f5eeeea221018ae1492d981&amp;scene=21#wechat_redirect" textvalue="一网打尽全部的商业化单细胞数据处理" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2"><span>一网打尽全部的商业化单细胞数据处理</span></a><br></p><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247523822&amp;idx=1&amp;sn=615d0d67b43428db4f1ad75c6749129c&amp;chksm=ea1c9b6cdd6b127a7c6842b2fca0ed364e29af9ec1b662ec19f412a0484756b9439acc425f7c&amp;scene=21#wechat_redirect" textvalue="plot1cell美化UMAP/TSNE结果" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2"><span>plot1cell美化UMAP/TSNE结果</span></a><br></p><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247523730&amp;idx=1&amp;sn=fc87d1d4ffdd8712bda7e980679828e9&amp;chksm=ea1c9b10dd6b120613c9f3bf39c7d25713ad1de248370a1198c389c18e7875286c45ca924838&amp;scene=21#wechat_redirect" textvalue="胃癌单细胞数据集GSE163558复现(五)：细胞比例" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2"><span>胃癌单细胞数据集GSE163558复现(五)：细胞比例</span></a><br></p></section></section><hr><p><br></p></section><section data-style-type="5" data-tools="新媒体排版" data-id="2440475"><hr><p><br></p><hr><section><p>如果你对单细胞转录组研究感兴趣，但又不知道如何入门，也许你可以关注一下下面的课程<span></span></p><p><br></p><ul><li><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247531360&amp;idx=1&amp;sn=0d9f69babb961a0a728d929b91a5fe22&amp;chksm=9b4b3bdbac3cb2cd2bf0c1b1b36fdd5c17ec97b7b73047823bd461df6bf2bbcddd5230f1aa08&amp;scene=21#wechat_redirect" textvalue="生信入门&amp;数据挖掘线上直播课7月班" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2">生信入门&amp;数据挖掘线上直播课7月班</a><br></p></li><li><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247524148&amp;idx=1&amp;sn=7806da6feb41a36493c519c1cfc1d3ac&amp;chksm=9b4bdf8fac3c569960369602f1ef26639cb366b250f233b2297d1f059471c0458335bfc0b829&amp;scene=21#wechat_redirect" textvalue="时隔5年，我们的生信技能树VIP学徒继续招生啦" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1">时隔5年，我们的生信技能树VIP学徒继续招生啦</a><br></p></li><li><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247520120&amp;idx=1&amp;sn=ad91a187458eb591129d3d366bfccf71&amp;chksm=ea1c89fadd6b00ec227d9588dadf672e1eb88d0449d500602d61f155023ee5721facdc9a5b57&amp;scene=21#wechat_redirect" textvalue="2024的共享服务器交个朋友福利价仍然是800" linktype="text" imgurl="" imgdata="null" data-itemshowtype="11" tab="innerlink" data-linktype="2" hasload="1">2024的共享服务器交个朋友福利价仍然是800</a></p></li></ul><p><img data-imgfileid="100040290" data-ratio="1" data-src="https://mmbiz.qpic.cn/mmbiz_gif/4TKeL1ZejtlKxOib5kmKX6ic6eX0w0WK5jvhtz9yBRsO3OI4yr6S5iaLNM7AbAeuPDHXMvDdur2DRz9wyiax4lEviag/640?wx_fmt=gif" data-type="gif" data-w="240" src="https://mmbiz.qpic.cn/mmbiz_gif/4TKeL1ZejtlKxOib5kmKX6ic6eX0w0WK5jvhtz9yBRsO3OI4yr6S5iaLNM7AbAeuPDHXMvDdur2DRz9wyiax4lEviag/640?wx_fmt=gif"><br></p><p><img data-imgfileid="100040289" data-ratio="0.05278592375366569" data-src="https://mmbiz.qpic.cn/mmbiz/4TKeL1Zejtlq03ZOSZiaTlic1MxgdKiaxTbOZ7ZSe0Xx1Ca8xF3L6Nyj1FYUajtYrSmRIHyZVSsAve0EAvEicZONpg/640?wx_fmt=jpeg" data-type="other" data-w="341" src="https://mmbiz.qpic.cn/mmbiz/4TKeL1Zejtlq03ZOSZiaTlic1MxgdKiaxTbOZ7ZSe0Xx1Ca8xF3L6Nyj1FYUajtYrSmRIHyZVSsAve0EAvEicZONpg/640?wx_fmt=jpeg"></p><p><strong><span>看完记得顺手点个</span></strong><span><strong><span>“在看”</span></strong></span><strong><span>哦！</span></strong></p></section><section><section data-tools="135编辑器" data-id="93668"><section><section data-width="95%"><section><section data-width="61.8%"><section><section><section><p><br></p><span><strong data-burshtype="text"><img data-copyright="0" data-cropselx1="0" data-cropselx2="109" data-cropsely1="0" data-cropsely2="109" data-imgfileid="100040291" data-ratio="1" data-src="https://mmbiz.qpic.cn/mmbiz/siaia0BDGJdjRMGrkqo64BGKecYk4akuHpGHVQs7FeOpY7eWbIPGC1tRw5Tw0oEPmx053mR9FTVerWvhuZchIpZw/640?wx_fmt=jpeg" data-type="other" data-w="258" title="qrcode_for_gh_5a3c482ed99f_1280.jpg" src="https://mmbiz.qpic.cn/mmbiz/siaia0BDGJdjRMGrkqo64BGKecYk4akuHpGHVQs7FeOpY7eWbIPGC1tRw5Tw0oEPmx053mR9FTVerWvhuZchIpZw/640?wx_fmt=jpeg"><strong data-burshtype="text">生物</strong><strong data-burshtype="text"> | 单细胞 | 转录组丨资料</strong></strong></span></section><section><span><strong data-burshtype="text">每天都精彩</strong></span></section></section></section><section><section><section><section><p><span>长按扫码可关注</span></p></section></section></section></section></section></section></section></section></section></section></section></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/i1MqQ3i7mEwFCmT5-HjCSA",target="_blank" rel="noopener noreferrer">原文链接</a>
