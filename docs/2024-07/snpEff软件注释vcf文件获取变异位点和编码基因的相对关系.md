---
title: "snpEff软件注释vcf文件获取变异位点和编码基因的相对关系"
date: 2024-07-23T23:51:01Z
draft: ["false"]
tags: [
  "fetched",
  "小明的数据分析笔记本"
]
categories: ["Acdemic"]
---
snpEff软件注释vcf文件获取变异位点和编码基因的相对关系 by 小明的数据分析笔记本
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><h2 data-tool="mdnice编辑器"><span></span><span>snpEff软件下载链接</span><span></span><span> </span></h2><p data-tool="mdnice编辑器">https://sourceforge.net/projects/snpeff/files/</p><p data-tool="mdnice编辑器">我下载的是 snpEff_v4_3t_core.zip</p><p data-tool="mdnice编辑器">软件主页</p><p data-tool="mdnice编辑器">http://snpeff.sourceforge.net/SnpEff_manual.html</p><p data-tool="mdnice编辑器">帮助文档</p><p data-tool="mdnice编辑器">http://snpeff.sourceforge.net/protocol.html</p><p data-tool="mdnice编辑器">（软件不用安装解压出来就能够使用）</p><p data-tool="mdnice编辑器">用大肠杆菌的一个数据做练习</p><p data-tool="mdnice编辑器">在 snpEff.jar 同级目录下新建一个data文件夹</p><pre data-tool="mdnice编辑器"><span></span><code>mkdir data<br><span>cd</span> data<br>mkdir genomes<br>mkdir ecoli<br></code></pre><p data-tool="mdnice编辑器">大肠杆菌基因组和基因注释文件的下载链接</p><p data-tool="mdnice编辑器">ftp://ftp.ncbi.nlm.nih.gov/genomes/all/GCF/000/005/845/GCF_000005845.2_ASM584v2/</p><p data-tool="mdnice编辑器">下载基因组fasta和基因注释文件gff</p><p data-tool="mdnice编辑器">基因组文件命名为ecoli.fa放在 genomes文件夹下</p><p data-tool="mdnice编辑器">基因注释文件命名为genes.gff放到ecoli文件夹下</p><p data-tool="mdnice编辑器">回到  snpEff.jar 同级目录 ，运行命令</p><pre data-tool="mdnice编辑器"><span></span><code><span>echo</span> <span>"ecoli.genome:ecoli"</span> &gt;&gt; snpEff.config<br></code></pre><p data-tool="mdnice编辑器">将<code>ecoli.genome:ecoli</code>添加到<code>snpEff.config</code>文件的最后一行</p><h2 data-tool="mdnice编辑器"><span></span><span>构建数据库</span><span></span><span> </span></h2><pre data-tool="mdnice编辑器"><span></span><code>java -Xmx4G -jar snpEff.jar build -gff3 ecoli<br></code></pre><p data-tool="mdnice编辑器">在<code>data/ecoli</code>目录下会多出一个<code>snpEffectPredictor.bin</code>文件</p><h2 data-tool="mdnice编辑器"><span></span><span>对vcf文件进行注释</span><span></span><span> </span></h2><pre data-tool="mdnice编辑器"><span></span><code>java -Xmx4G -jar snpEff.jar ecoli vcf_ann_Practice/E_coli_K12.filter.vcf &gt; E_coli_K12.filter.eff.vcf<br></code></pre><p data-tool="mdnice编辑器">同时会生成一个 snpEff_summary.html 文件</p><p data-tool="mdnice编辑器">在新生成的vcf文件里INFO列里会多出来很多信息</p><p data-tool="mdnice编辑器">vcf文件不是很大的话可以用R语言的vcfR包对信息进行解析</p><p data-tool="mdnice编辑器">读取vcf文件</p><pre data-tool="mdnice编辑器"><span></span><code>annoV&lt;-read.vcfR(<span>"E_coli_K12.filter.eff.vcf"</span>)<br></code></pre><p data-tool="mdnice编辑器">提取注释的信息</p><pre data-tool="mdnice编辑器"><span></span><code>vcfR2tidy(annoV)<span>$fix</span><span>$ANN</span><br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100014261" data-ratio="0.2661122661122661" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/t1wZDoUyFk77f9bSHrqrFsxHkibEA6g2mJdyb4xY2jFRhTdhBVLibdmujeZGgGJsy8PCfWFdwkCWAiciayboOZ3TKQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="962" src="https://mmbiz.qpic.cn/sz_mmbiz_png/t1wZDoUyFk77f9bSHrqrFsxHkibEA6g2mJdyb4xY2jFRhTdhBVLibdmujeZGgGJsy8PCfWFdwkCWAiciayboOZ3TKQ/640?wx_fmt=png&amp;from=appmsg"><figcaption>image.png</figcaption></figure><p data-tool="mdnice编辑器">这里的内容很多，具体哪些信息有用暂时还没搞清楚</p><p data-tool="mdnice编辑器"><strong>欢迎大家关注我的公众号</strong></p><p data-tool="mdnice编辑器"><strong>小明的数据分析笔记本</strong></p><section><mp-common-profile data-pluginname="mpprofile" data-id="MzI3NzQ3MTcxMg==" data-headimg="http://mmbiz.qpic.cn/mmbiz_png/t1wZDoUyFk5t1sOnM0iabvBhnfIj5YpyqrMib0E1MGCd9ibcYxaOPZd0GWhQBDvK2BPEwsicQxd6y5MHLfphnwHnow/0?wx_fmt=png" data-nickname="小明的数据分析笔记本" data-alias="" data-signature="分享R语言和python在生物信息领域做数据分析和数据可视化的简单小例子；偶尔会分享一些组学数据处理相关的内容" data-from="0" data-is_biz_ban="0"></mp-common-profile></section><p data-tool="mdnice编辑器"><strong></strong></p><blockquote data-tool="mdnice编辑器"><span></span><p>小明的数据分析笔记本 公众号 主要分享：1、R语言和python做数据分析和数据可视化的简单小例子；2、园艺植物相关转录组学、基因组学、群体遗传学文献阅读笔记；3、生物信息学入门学习资料及自己的学习笔记！</p></blockquote></section><p><br></p><p><img data-galleryid="" data-imgfileid="100014265" data-ratio="0.42592592592592593" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/t1wZDoUyFk77f9bSHrqrFsxHkibEA6g2mXcZYtBrjibUIYfhPEaVuTbI9qs8No7L7GgAowhC7foUHw2eBYGaIhwQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/t1wZDoUyFk77f9bSHrqrFsxHkibEA6g2mXcZYtBrjibUIYfhPEaVuTbI9qs8No7L7GgAowhC7foUHw2eBYGaIhwQ/640?wx_fmt=png&amp;from=appmsg"></p><p><br></p><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/KB779VIyVs4PyJxaMVGc8Q",target="_blank" rel="noopener noreferrer">原文链接</a>
