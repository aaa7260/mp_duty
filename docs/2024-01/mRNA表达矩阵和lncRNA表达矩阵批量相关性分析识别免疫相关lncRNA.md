---
title: "mRNA表达矩阵和lncRNA表达矩阵批量相关性分析识别免疫相关lncRNA"
date: 2024-01-22T02:15:25Z
draft: ["false"]
tags: [
  "fetched",
  "医学和生信笔记"
]
categories: ["Acdemic"]
---
mRNA表达矩阵和lncRNA表达矩阵批量相关性分析识别免疫相关lncRNA by 医学和生信笔记
------
<div><section><span>关注公众号，发送</span><strong>R语言</strong><span>或</span><strong>python</strong><span>，可获取资料</span><span></span></section><section><mp-common-profile data-pluginname="mpprofile" data-id="MzUzOTQzNzU0NA==" data-headimg="http://mmbiz.qpic.cn/mmbiz_png/tpAC6lR84R9YDc8IDhqWAHTrZsMuhDpFlw4scqOl1ZVWpeY77cdibaSzPeGALfkEhdVpwHzVibHCRSYZg4csB43g/0?wx_fmt=png" data-nickname="医学和生信笔记" data-alias="yxhsxbj" data-signature="外科医生👨‍⚕️的R语言和生信学习🔖" data-from="2" data-weuitheme="light"></mp-common-profile></section><section data-role="outer" label="edit by 135editor"><section data-role="paragraph"><section data-role="outer" label="edit by 135editor"><section data-role="paragraph"><section data-role="outer" label="edit by 135editor"><section data-role="paragraph"><section data-role="outer"><section data-role="outer" label="edit by 135editor"><section data-tools="135编辑器" data-id="28"><p data-brushtype="text" hm_fix="440:185"><span>💡专注R语言在🩺生物医学中的使用</span></p></section></section></section></section></section><hr><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><p data-tool="mdnice编辑器"><span><span>设为“</span><strong><span>星标</span></strong><span>”，精彩不错过</span></span><br></p><hr><p data-tool="mdnice编辑器"><span><strong></strong></span></p><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><p data-tool="mdnice编辑器">之前已经给大家介绍了4种识别免疫相关lncRNA的方法：</p><ul data-tool="mdnice编辑器"><li><section><a href="https://mp.weixin.qq.com/s?__biz=MzUzOTQzNzU0NA==&amp;mid=2247499013&amp;idx=1&amp;sn=3986f9083a796d5458c7ee2aeb5c31b6&amp;scene=21#wechat_redirect" data-linktype="2">免疫相关lncRNA的识别方法</a></section></li><li><section><a href="https://mp.weixin.qq.com/s?__biz=MzUzOTQzNzU0NA==&amp;mid=2247499014&amp;idx=1&amp;sn=ef0acc174b954825eb39234abaa6bff3&amp;scene=21#wechat_redirect" data-linktype="2">WGCNA识别免疫相关lncRNA</a></section></li></ul><p data-tool="mdnice编辑器">今天再给大家介绍一种，也是最简单的一种（去年写的忘记发了🌚🌚）。</p><p data-tool="mdnice编辑器">我们都知道，如果是想要获取免疫相关的mRNA，可以直接从<code>immport</code>这个网站下载，老牌网站，知名度很高。</p><p data-tool="mdnice编辑器">直达网址：https://www.immport.org/shared/genelists</p><p data-tool="mdnice编辑器">下载完成后，我们通过计算<code>lncRNA</code>和<code>免疫相关mRNA</code>的相关性，就可以得到<code>免疫相关lncRNA</code>。</p><p data-tool="mdnice编辑器">下面进行实操，我们以<code>TCGA-COAD</code>的转录组数据为例。</p><h2 data-tool="mdnice编辑器"><span></span><span>下载数据</span><span></span></h2><p data-tool="mdnice编辑器">首先下载<code>TCGA-COAD</code>的转录组数据，直接用<code>easyTCGA</code>，1行代码搞定：</p><pre data-tool="mdnice编辑器"><code><span>library</span>(easyTCGA)<br>getmrnaexpr(<span>"TCGA-COAD"</span>)<br></code></pre><p data-tool="mdnice编辑器">这样我们就得到了<code>TCGA-COAD</code>的<code>mRNA</code>和<code>lncRNA</code>的表达矩阵，我们使用<code>tpm</code>数据进行演示。这个数据是没有经过log转换的。</p><pre data-tool="mdnice编辑器"><code>load(file = <span>"G:/easyTCGA_test/output_mRNA_lncRNA_expr/TCGA-COAD_lncrna_expr_tpm.rdata"</span>)<br>load(file = <span>"G:/easyTCGA_test/output_mRNA_lncRNA_expr/TCGA-COAD_mrna_expr_tpm.rdata"</span>)<br></code></pre><p data-tool="mdnice编辑器">然后我们从网站直接下载免疫相关<code>mRNA</code>:</p><figure data-tool="mdnice编辑器"><img data-imgfileid="100017068" data-ratio="0.4398148148148148" data-type="png" data-w="1080" data-src="https://mmbiz.qpic.cn/mmbiz_png/tpAC6lR84R9YCxjSpjHibIXAcXAJM9ibml42PfS3aX5DNAWHFtKxAJibib1cNY9iaOC0PdmzaV3uPG1D2BA0TwWGIrw/640?wx_fmt=png&amp;from=appmsg" src="https://mmbiz.qpic.cn/mmbiz_png/tpAC6lR84R9YCxjSpjHibIXAcXAJM9ibml42PfS3aX5DNAWHFtKxAJibib1cNY9iaOC0PdmzaV3uPG1D2BA0TwWGIrw/640?wx_fmt=png&amp;from=appmsg"></figure><pre data-tool="mdnice编辑器"><code><span># 免疫相关mRNA是从网站直接下载的</span><br>imm.mrna &lt;- read.table(<span>"E:/projects/yefd/TCGA_BLCA/files/GeneList.txt"</span>,sep=<span>"\t"</span>,header=<span>T</span>)<br><br>head(imm.mrna)<br><span>##   Symbol  ID                                 Name                   Synonyms</span><br><span>## 1  AZGP1 563 alpha-2-glycoprotein 1, zinc-binding                   ZA2G|ZAG</span><br><span>## 2    B2M 567                 beta-2-microglobulin                      IMD43</span><br><span>## 3   CALR 811                         calreticulin CRT|HEL-S-99n|RO|SSA|cC1qR</span><br><span>## 4   CANX 821                             calnexin               CNX|IP90|P90</span><br><span>## 5   CD1A 909                        CD1a molecule        CD1|FCB6|HTA1|R4|T6</span><br><span>## 6   CD1B 910                        CD1b molecule                CD1|CD1A|R1</span><br><span>##   Chromosome                            Category</span><br><span>## 1          7 Antigen_Processing_and_Presentation</span><br><span>## 2         15 Antigen_Processing_and_Presentation</span><br><span>## 3         19 Antigen_Processing_and_Presentation</span><br><span>## 4          5 Antigen_Processing_and_Presentation</span><br><span>## 5          1 Antigen_Processing_and_Presentation</span><br><span>## 6          1 Antigen_Processing_and_Presentation</span><br></code></pre><p data-tool="mdnice编辑器">我们只要其中的<code>Symbol</code>即可，所以去重一下：</p><pre data-tool="mdnice编辑器"><code>imm.mrna &lt;- unique(imm.mrna$Symbol)<br>length(imm.mrna)<br><span>## [1] 1509</span><br><br>head(imm.mrna)<br><span>## [1] "AZGP1" "B2M"   "CALR"  "CANX"  "CD1A"  "CD1B"</span><br></code></pre><p data-tool="mdnice编辑器">还剩1509个<code>免疫相关的mRNA</code>。</p><h2 data-tool="mdnice编辑器"><span></span><span>immune-related mRNA matrix</span><span></span></h2><p data-tool="mdnice编辑器">我们已经有了免疫相关mRNA：<code>imm.mrna</code>，接下来就是提取免疫相关mRNA的表达矩阵。然后使用这个免疫相关mRNA的表达矩阵以及lncRNA的表达矩阵就可以计算相关性了。</p><p data-tool="mdnice编辑器">首先是提取免疫相关<code>mrna</code>的表达矩阵。</p><pre data-tool="mdnice编辑器"><code><span># 取个交集而已</span><br>index &lt;- intersect(rownames(mrna_expr_tpm),imm.mrna)<br><br>imm_expr &lt;- mrna_expr_tpm[index,]<br>dim(imm_expr)<br><span>## [1] 1098  524</span><br></code></pre><h2 data-tool="mdnice编辑器"><span></span><span>lncRNA matrix</span><span></span></h2><p data-tool="mdnice编辑器">接下来这个lncRNA表达矩阵就有很多处理方式了。</p><p data-tool="mdnice编辑器">如果你比较偷懒，或者不需要过滤，那你可以直接使用所有的lncRNA和<code>imm_expr</code>中的mRNA批量做相关性分析。</p><p data-tool="mdnice编辑器">我们这个<code>lncrna_expr_tpm</code>一共有16882个lncRNA，这个数据计算量其实是非常大的！</p><p data-tool="mdnice编辑器">所以我们也可以先对lncRNA做差异分析，然后再做相关性分析，也可以先做生存分析，也可以差异分析+生存分析一起做。</p><p data-tool="mdnice编辑器">当然，方法很多，目的只是为了缩小一下目标范围而已，那我做<code>WGCNA</code>行不行？做<code>免疫浸润</code>行不行？做分子分型行不行？都行！</p><p data-tool="mdnice编辑器">我们这里演示的是<strong>差异分析+生存分析</strong>，然后再做相关性分析。</p><p data-tool="mdnice编辑器">先做差异分析，使用<code>easyTCGA</code>包，1行代码解决：</p><pre data-tool="mdnice编辑器"><code><span>library</span>(easyTCGA)<br><br><span># 先过滤一下</span><br>lncrna_expr &lt;- lncrna_expr_tpm[!apply(lncrna_expr_tpm,<span>1</span>,sd)&lt;<span>0.1</span>,]<br><br>deg_res &lt;- diff_analysis(exprset = lncrna_expr,<br>                         is_count = <span>F</span>,<br>                         logFC_cut = <span>1</span>,<br>                         pvalue_cut = <span>0.05</span>,<br>                         adjpvalue_cut = <span>0.05</span><br>                         )<br><span>## =&gt; log2(x+0.1) transform finished</span><br><span>## =&gt; Running limma</span><br><span>## =&gt; Running wilcoxon test</span><br><span>## =&gt; Analysis done.</span><br><br><span># 用limma的结果</span><br>deg_limma &lt;- deg_res$deg_limma<br><br>dim(deg_limma)<br><span>## [1] 1421    7</span><br>head(deg_limma)<br><span>##                logFC   AveExpr         t       P.Value     adj.P.Val        B</span><br><span>## AC092652.1 -3.836206 -2.479661 -35.07337 1.368028e-139 1.847659e-135 307.5981</span><br><span>## VSTM2A-OT1 -1.434307 -3.066762 -30.42429 7.111569e-118 4.802443e-114 258.0771</span><br><span>## LINC00682  -2.770612 -2.762584 -30.13310 1.762372e-116 7.934198e-113 254.8951</span><br><span>## LINC00974  -4.175620 -2.359253 -28.73307 9.966442e-110 3.365169e-106 239.4790</span><br><span>## AC005358.1 -2.800434 -2.632442 -28.56468 6.545520e-109 1.768076e-105 237.6123</span><br><span>## AC025470.2 -2.128380 -2.861899 -27.80674 3.221137e-105 7.250780e-102 229.1800</span><br><span>##            genesymbol</span><br><span>## AC092652.1 AC092652.1</span><br><span>## VSTM2A-OT1 VSTM2A-OT1</span><br><span>## LINC00682   LINC00682</span><br><span>## LINC00974   LINC00974</span><br><span>## AC005358.1 AC005358.1</span><br><span>## AC025470.2 AC025470.2</span><br></code></pre><p data-tool="mdnice编辑器">差异分析后还剩1421个lncRNA，下面我们继续做生存分析，还是用<code>easyTCGA</code>,1行代码解决，而且默认是基于最佳截点，同时进行log-rank和单因素Cox两种批量生存分析：</p><pre data-tool="mdnice编辑器"><code><span># 加载生存信息，easyTCGA已经一起帮我们下载整理好了</span><br>load(file = <span>"G:/easyTCGA_test/output_mRNA_lncRNA_expr/TCGA-COAD_clinical.rdata"</span>)<br></code></pre><p data-tool="mdnice编辑器">批量生存分析：</p><pre data-tool="mdnice编辑器"><code>surv_res &lt;- batch_survival(exprset = lncrna_expr,<br>                           clin = clin_info,<br>                           is_count = <span>F</span>, <span># 不是count数据</span><br>                           optimal_cut = <span>T</span> <span># 使用最佳截点</span><br>                           )<br><span>#save(surv_res, file = "../000files/surv_res.rdata")</span><br></code></pre><p data-tool="mdnice编辑器">查看结果：</p><pre data-tool="mdnice编辑器"><code>load(file = <span>"../000files/surv_res.rdata"</span>)<br><span># 我们就用log-rank的结果，或者取logrank和cox的交集也可</span><br>log_rank_res &lt;- surv_res$res.logrank<br>dim(log_rank_res)<br><span>## [1] 9578    3</span><br><br>head(log_rank_res)<br><span>##         gene    p.value  cutpoint</span><br><span>## 1     MALAT1 0.02133476 5.2170446</span><br><span>## 2      NEAT1 0.26639139 2.7373944</span><br><span>## 3     SNHG25 0.04169925 0.4839386</span><br><span>## 4 AC103702.2 0.05712193 2.6707860</span><br><span>## 5 AL591895.1 0.01227174 6.8008582</span><br><span>## 6 AL354743.2 0.04968819 5.7748580</span><br></code></pre><p data-tool="mdnice编辑器">虽然我们使用了最佳截点，但是并不能保证P值一定是小于0.05的哈，所以我们还是要筛选一下，只要p&lt;0.05的：</p><pre data-tool="mdnice编辑器"><code>suppressMessages(<span>library</span>(dplyr))<br><br>log_rank_res &lt;- log_rank_res %&gt;% <br>  filter(p.value &lt; <span>0.05</span>)<br>dim(log_rank_res)<br><span>## [1] 5157    3</span><br></code></pre><p data-tool="mdnice编辑器">差异分析和生存分析的结果取交集：</p><pre data-tool="mdnice编辑器"><code>deg_logrank &lt;- intersect(log_rank_res$gene, deg_limma$genesymbol)<br>length(deg_logrank)<br><span>## [1] 575</span><br></code></pre><p data-tool="mdnice编辑器">还剩下575个lncRNA，然后就可以提取表达矩阵，做相关性分析了：</p><pre data-tool="mdnice编辑器"><code>lnc_expr &lt;- lncrna_expr_tpm[deg_logrank,]<br>dim(lnc_expr)<br><span>## [1] 575 524</span><br></code></pre><h2 data-tool="mdnice编辑器"><span></span><span>批量相关性分析</span><span></span></h2><p data-tool="mdnice编辑器">下面就是两个表达矩阵的批量相关性分析，这个运算量其实不小，如果你电脑不行，很容易卡死。</p><p data-tool="mdnice编辑器">在此之前还是要做些小准备，首先是只保留肿瘤样本，然后对表达矩阵进行log2转换，我们在做差异分析和生存分析时并没有做，这是因为<code>easyTCGA</code>会自动帮我们做。</p><pre data-tool="mdnice编辑器"><code><span># 只保留肿瘤样本</span><br>sample_type &lt;- ifelse(as.numeric(substr(colnames(imm_expr),<span>14</span>,<span>15</span>)) &lt; <span>10</span>,<span>"tumor"</span>,<span>"normal"</span>)<br><br>lnc_expr &lt;- lnc_expr[,sample_type == <span>"tumor"</span>]<br>imm_expr &lt;- imm_expr[,sample_type == <span>"tumor"</span>]<br><br><span># 进行log2转换</span><br>lnc_expr &lt;- log2(lnc_expr+<span>0.1</span>)<br>imm_expr &lt;- log2(imm_expr+<span>0.1</span>)<br><br>dim(lnc_expr)<br><span>## [1] 575 483</span><br>dim(imm_expr)<br><span>## [1] 1098  483</span><br><span># 两个表达矩阵的样本顺序完全一样</span><br>identical(colnames(lnc_expr),colnames(imm_expr))<br><span>## [1] TRUE</span><br></code></pre><p data-tool="mdnice编辑器">1098个<code>mRNA</code>和575个<code>lncRNA</code>批量进行相关性分析，这个计算过程非常大，小电脑会直接卡死！使用<code>linkET::correlate</code>计算是我能找到的最快的方法，比普通的方法快了几十倍！</p><p data-tool="mdnice编辑器">批量计算两个矩阵的相关性也是一个非常实用的技能哈，大家可以记录一下。</p><p data-tool="mdnice编辑器">此方法我在之前的推文中也介绍过：<a href="https://mp.weixin.qq.com/s?__biz=MzUzOTQzNzU0NA==&amp;mid=2247497817&amp;idx=1&amp;sn=57918e27cc5f47d5f744ce2c1e1c013b&amp;scene=21#wechat_redirect" data-linktype="2">免疫浸润常见的可视化方法</a></p><pre data-tool="mdnice编辑器"><code><span># 自定义一个函数</span><br>cormatrixes &lt;- <span>function</span>(x,y){<br>  tem &lt;- linkET::correlate(t(x),t(y),engine = <span>"WGCNA"</span>)<br>  tem1 &lt;- as.data.frame(tem[[<span>1</span>]])<br>  tem1 &lt;- cbind(rownames(tem1),tem1)<br>  tem1_long &lt;- reshape2::melt(tem1,value.name = <span>"correlation"</span>)<br>  tem2 &lt;- as.data.frame(tem[[<span>2</span>]])<br>  tem2 &lt;- cbind(rownames(tem2),tem2)<br>  tem2_long &lt;- reshape2::melt(tem2,value.name = <span>"pvalue"</span>)<br>  result &lt;- cbind(tem1_long,tem2_long$pvalue)<br>  names(result) &lt;- c(<span>"v1"</span>,<span>"v2"</span>,<span>"correlation"</span>,<span>"pvalue"</span>)<br>  <span>return</span>(result)<br>}<br></code></pre><p data-tool="mdnice编辑器">这个函数接受两个表达矩阵，然后返回相关系数和P值：</p><pre data-tool="mdnice编辑器"><code>cor_res &lt;- cormatrixes(lnc_expr,imm_expr)<br><span>## </span><br><span>## Using rownames(tem1) as id variables</span><br><span>## Using rownames(tem2) as id variables</span><br><br>tail(cor_res)<br><span>##                v1       v2 correlation pvalue</span><br><span>## 631345  LINC02868 TNFRSF6B          NA     NA</span><br><span>## 631346 AP001330.1 TNFRSF6B          NA     NA</span><br><span>## 631347 AL512358.2 TNFRSF6B          NA     NA</span><br><span>## 631348 AL391807.1 TNFRSF6B          NA     NA</span><br><span>## 631349 AC055874.1 TNFRSF6B          NA     NA</span><br><span>## 631350 AL772337.2 TNFRSF6B          NA     NA</span><br></code></pre><p data-tool="mdnice编辑器"><code>v1</code>是lncRNA，<code>v2</code>是mRNA，有些结果是NA，因为有的分子可能表达量在所有样本中都一样！我们把NA去掉即可。</p><p data-tool="mdnice编辑器">最后筛选P值小于0.05和相关系数大于0.7的lncRNA（这个东西没有标准，只要你能解释得通就行！），就可以认为是免疫相关lncRNA了！</p><pre data-tool="mdnice编辑器"><code>cor_res &lt;- na.omit(cor_res)<br><br>imm_lnc &lt;- cor_res %&gt;% <br>  filter(correlation &gt; <span>0.7</span>, pvalue &lt; <span>0.05</span>) %&gt;% <br>  distinct(v1) %&gt;% <br>  pull(v1)<br><br>length(imm_lnc)<br><span>## [1] 35</span><br>head(imm_lnc)<br><span>## [1] "LINC01614"  "AC090559.1" "AC016747.1" "LINC02381"  "MIR100HG"  </span><br><span>## [6] "AC134312.5"</span><br></code></pre><p data-tool="mdnice编辑器">最终得到35个免疫相关的lncRNA，而且是差异表达的，并且对生存有意义的！</p><p data-tool="mdnice编辑器">如果你嫌这个数字还是太多（或太少）怎么办？在演示过程中至少有3次可以设定阈值的地方，你随便试，直到找到你想要的数字即可！</p><h2 data-tool="mdnice编辑器"><span></span><span>简单的可视化</span><span></span></h2><p data-tool="mdnice编辑器">使用<code>easyTCGA</code>，我们做个简单的可视化。</p><pre data-tool="mdnice编辑器"><code><span># 随便取6个看看</span><br>set.seed(<span>1</span>)<br>markers &lt;- sample(imm_lnc,<span>6</span>,replace = <span>F</span>)<br>markers<br><span>## [1] "LINC02381"  "LINC01614"  "AC015911.3" "AL365361.1" "AC103591.4"</span><br><span>## [6] "AC092376.2"</span><br><br>tmp &lt;- log2(lncrna_expr_tpm+<span>1</span>)<br></code></pre><p data-tool="mdnice编辑器">首先是lncRNA在normal和tumor中的表达量箱线图：</p><pre data-tool="mdnice编辑器"><code>plot_gene(exprset = tmp,marker = markers,group = sample_type,return_data = <span>F</span>)<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100017066" data-ratio="1" data-type="png" data-w="576" data-src="https://mmbiz.qpic.cn/mmbiz_png/tpAC6lR84R9YCxjSpjHibIXAcXAJM9ibmlyQq40rsUVu5IWibgtNM5r5DxbZkoTicZHF2l3OcLhiaq8K4wpvWjicJywg/640?wx_fmt=png&amp;from=appmsg" src="https://mmbiz.qpic.cn/mmbiz_png/tpAC6lR84R9YCxjSpjHibIXAcXAJM9ibmlyQq40rsUVu5IWibgtNM5r5DxbZkoTicZHF2l3OcLhiaq8K4wpvWjicJywg/640?wx_fmt=png&amp;from=appmsg"><figcaption>plot of chunk unnamed-chunk-18</figcaption></figure><p data-tool="mdnice编辑器">配对的也可以：</p><pre data-tool="mdnice编辑器"><code>plot_gene_paired(exprset = tmp,marker = markers,return_data = <span>F</span>)<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100017065" data-ratio="1" data-type="png" data-w="576" data-src="https://mmbiz.qpic.cn/mmbiz_png/tpAC6lR84R9YCxjSpjHibIXAcXAJM9ibml4iakiboGVAjSicuIbDkVZTwREBbnPVCFarE3efAmL4rhah39RVCe8Zic2w/640?wx_fmt=png&amp;from=appmsg" src="https://mmbiz.qpic.cn/mmbiz_png/tpAC6lR84R9YCxjSpjHibIXAcXAJM9ibml4iakiboGVAjSicuIbDkVZTwREBbnPVCFarE3efAmL4rhah39RVCe8Zic2w/640?wx_fmt=png&amp;from=appmsg"><figcaption>plot of chunk unnamed-chunk-19</figcaption></figure><p data-tool="mdnice编辑器">在不同分期中的表达量箱线图，这时候就要把normal样本去掉了，而且由于我们并没有根据stage进行筛选，所以有些P值是大于0.05的：</p><pre data-tool="mdnice编辑器"><code>tmp &lt;- tmp[,sample_type==<span>"tumor"</span>]<br><br><span># 这个最好再手动整理下</span><br>ajcc_satge &lt;- clin_info[sample_type==<span>"tumor"</span>,<span>"ajcc_pathologic_stage"</span>]<br><br>plot_gene(exprset = tmp, marker = markers, group = ajcc_satge, return_data = <span>F</span>)<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100017067" data-ratio="1" data-type="png" data-w="576" data-src="https://mmbiz.qpic.cn/mmbiz_png/tpAC6lR84R9YCxjSpjHibIXAcXAJM9ibmlibXPUhhZTPS0UwfoFF3fnwuVWmy3OArtV6Tswic6Az2NXgromAI0dtNw/640?wx_fmt=png&amp;from=appmsg" src="https://mmbiz.qpic.cn/mmbiz_png/tpAC6lR84R9YCxjSpjHibIXAcXAJM9ibmlibXPUhhZTPS0UwfoFF3fnwuVWmy3OArtV6Tswic6Az2NXgromAI0dtNw/640?wx_fmt=png&amp;from=appmsg"><figcaption>plot of chunk unnamed-chunk-20</figcaption></figure><p data-tool="mdnice编辑器">生存分析也很easy，不过不能像上面这样拼图了：</p><pre data-tool="mdnice编辑器"><code>clin &lt;- clin_info[sample_type==<span>"tumor"</span>,c(<span>"days_to_last_follow_up"</span>,<span>"vital_status"</span>)]<br>names(clin) &lt;- c(<span>"time"</span>,<span>"event"</span>)<br>clin$event &lt;- ifelse(clin$event==<span>"Dead"</span>,<span>1</span>,<span>0</span>)<br><br><span># 默认也是基于最佳截点哦</span><br>plot_KM(exprset = tmp,marker = markers[<span>1</span>],<br>        clin = clin, return_data = <span>F</span>)<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100017064" data-ratio="1" data-type="png" data-w="504" data-src="https://mmbiz.qpic.cn/mmbiz_png/tpAC6lR84R9YCxjSpjHibIXAcXAJM9ibmldrr7bjz8o5nlghO95GCaREEg8wXKn6DAyn3lnHiaOc2zU6wrOn5mWzg/640?wx_fmt=png&amp;from=appmsg" src="https://mmbiz.qpic.cn/mmbiz_png/tpAC6lR84R9YCxjSpjHibIXAcXAJM9ibmldrr7bjz8o5nlghO95GCaREEg8wXKn6DAyn3lnHiaOc2zU6wrOn5mWzg/640?wx_fmt=png&amp;from=appmsg"><figcaption>plot of chunk unnamed-chunk-21</figcaption></figure><p data-tool="mdnice编辑器">真的是太棒了！</p><p data-tool="mdnice编辑器">给大家介绍了这么多识别免疫相关lncRNA的方法，大家学会了吗？</p></section><p><span><br></span></p><hr><blockquote><p><span><strong>联系我们，关注我们</strong></span></p><ol><li><section>免费QQ交流群1：613637742</section></li><li><section>免费QQ交流群2：608720452</section></li><li><section>公众号消息界面关于作者获取联系方式</section></li><li><section>知乎、CSDN、简书同名账号</section></li><li><section>哔哩哔哩：阿越就是我</section></li></ol></blockquote></section></section></section></section></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/Wj2dmk5hPhkbGIkdUylGOg",target="_blank" rel="noopener noreferrer">原文链接</a>
