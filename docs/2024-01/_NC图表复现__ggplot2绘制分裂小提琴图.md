---
title: "[NC图表复现] ggplot2绘制分裂小提琴图"
date: 2024-01-11T23:44:18Z
draft: ["false"]
tags: [
  "fetched",
  "R语言数据分析指南"
]
categories: ["Acdemic"]
---
[NC图表复现] ggplot2绘制分裂小提琴图 by R语言数据分析指南
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><h3 data-tool="mdnice编辑器"><span></span><span><span></span>欢迎关注R语言数据分析指南</span><span></span></h3><blockquote data-tool="mdnice编辑器"><span>❝</span><p>本节来复现NC上的一张小提琴图，通过分组拆分数据绘制分裂小提琴图，整个过程仅参考。希望对各位观众老爷能有所帮助。<strong>「数据代码已经整合上传到VIP交流群」</strong>，加群的观众老爷可自行下载，有需要的朋友可关注文末介绍加入VIP交流群。</p><span>❞</span></blockquote><figure data-tool="mdnice编辑器"><img data-imgfileid="100025321" data-ratio="0.3425925925925926" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAaCyRv77Rx7IZmGI4TlfDIJgDt8msUkQWywN6gYWG6WQYty187PtXFs8kLclyiccVgABRRr9MH6Z9Q/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAaCyRv77Rx7IZmGI4TlfDIJgDt8msUkQWywN6gYWG6WQYty187PtXFs8kLclyiccVgABRRr9MH6Z9Q/640?wx_fmt=png&amp;from=appmsg"></figure><figure data-tool="mdnice编辑器"><img data-imgfileid="100025322" data-ratio="0.6972222222222222" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAaCyRv77Rx7IZmGI4TlfDIJKPdvQo5A4RppzNgFibkyZSkWreG3GxliaBJgDCE3YiaYiczjTEyZT7pjTw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAaCyRv77Rx7IZmGI4TlfDIJKPdvQo5A4RppzNgFibkyZSkWreG3GxliaBJgDCE3YiaYiczjTEyZT7pjTw/640?wx_fmt=png&amp;from=appmsg"></figure><h3 data-tool="mdnice编辑器"><span></span><span><span></span>关于永久群内容的说明</span><span></span></h3><blockquote data-tool="mdnice编辑器"><span>❝</span><p>给予长期支持我们的忠实读者们一个特别待遇：凡是购买过小编2022年或2023年VIP会员文档的朋友们，<strong>「将自动获得2024年及以后更新的绘图文档代码，无需额外付费。」</strong>目前这两年的会员文档已累记卖出1500+，质量方面各位无需担忧。简要概括就是只要购买任意1年的会员内容，2024及后期公众号所更新的绘图文档均会在已经加入的会员群内分享。</p><span>❞</span></blockquote><h3 data-tool="mdnice编辑器"><span></span><span><span></span>加载R包</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code><span>library</span>(tidyverse)<br><span>library</span>(introdataviz)<br><span>library</span>(ggpubr)<br><span>library</span>(scales)<br><span>library</span>(patchwork)<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100025318" data-ratio="0.17407407407407408" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAaCyRv77Rx7IZmGI4TlfDIJIHt0kWr1q6M6r6ABFQYMicGh5YlL7p37PIfKcXZZchYug6icrFxmg3icw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAaCyRv77Rx7IZmGI4TlfDIJIHt0kWr1q6M6r6ABFQYMicGh5YlL7p37PIfKcXZZchYug6icrFxmg3icw/640?wx_fmt=png&amp;from=appmsg"></figure><h3 data-tool="mdnice编辑器"><span></span><span><span></span>导入数据</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code>df1 &lt;- read_tsv(<span>"F1ag.txt"</span>) %&gt;% select(<span>2</span>,<span>3</span>,-<span>1</span>) %&gt;% <br>  separate(`Treatment`,into=c(<span>"A"</span>,<span>"B"</span>),sep=<span>"-"</span>,convert = <span>T</span>) %&gt;% <br>  mutate(B = str_replace_all(B, <span>"[0-9]"</span>, <span>""</span>))<br><br>df1$A &lt;- factor(df1$A,levels = c(<span>"Conven"</span>,<span>"Conserv"</span>))<br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span><span></span>数据可视化</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code>a &lt;- ggplot(df1,aes(x = A, y =`SOC (g kg-1)` ,fill= B))+<br>  geom_split_violin(trim =F,color = NA,adjust = 1.5)+<br>  guides(fill=guide_legend(title=<span>"group"</span>))+<br>  stat_summary(fun.data = <span>"mean_sd"</span>,position=position_dodge(0.15),geom = <span>"errorbar"</span>,width = .1) +<br>  stat_summary(fun = <span>"mean"</span>, geom = <span>"point"</span>, position=position_dodge(0.15),show.legend = F)+<br>  stat_compare_means(aes(group = B), label = <span>"p.signif"</span>,label.y=15.1, method=<span>"t.test"</span>,size=5)+<br>  scale_fill_manual(values=c(<span>"#788FCE"</span>,<span>"#E6956F"</span>))+<br>  labs(x=NULL,y=<span>"SOC (g kg-1)"</span>)+<br>  theme(<br>        axis.text.x=element_text(angle =0,hjust =0.5,vjust =0.5,color=<span>"black"</span>,size = 10,margin = margin(b =2)),<br>        axis.text.y=element_text(color=<span>"black"</span>,size = 10,margin = margin(r =1)),<br>        panel.background = element_rect(fill = NA,color = NA),<br>        panel.grid.minor= element_line(size=0.2,color=<span>"#e5e5e5"</span>),<br>        panel.grid.major = element_line(size=0.2,color=<span>"#e5e5e5"</span>),<br>        panel.border = element_rect(fill=NA,color=<span>"black"</span>,size=1,linetype=<span>"solid"</span>),<br>        legend.key=element_blank(),<br>        legend.title = element_blank(),<br>        legend.text = element_text(color=<span>"black"</span>,size=8),<br>        legend.spacing.x=unit(0.1,<span>'cm'</span>),<br>        legend.key.width=unit(0.5,<span>'cm'</span>),<br>        legend.key.height=unit(0.5,<span>'cm'</span>),<br>        legend.position = c(1,0), legend.justification = c(1,0),<br>        legend.background=element_blank())<br></code></pre><pre data-tool="mdnice编辑器"><span></span><code>df2 &lt;- read_tsv(<span>"F1ag.txt"</span>) %&gt;% select(<span>2</span>,<span>4</span>,-<span>1</span>) %&gt;% <br>  separate(`Treatment`,into=c(<span>"A"</span>,<span>"B"</span>),sep=<span>"-"</span>,convert = <span>T</span>) %&gt;% <br>  mutate(B = str_replace_all(B, <span>"[0-9]"</span>, <span>""</span>))<br><br>df2$A &lt;- factor(df2$A,levels = c(<span>"Conven"</span>,<span>"Conserv"</span>))<br></code></pre><pre data-tool="mdnice编辑器"><span></span><code>g &lt;- ggplot(df2,aes(x = A, y =`DOC(mg kg-1)` ,fill= B))+<br>  geom_split_violin(trim =<span>F</span>,color = <span>NA</span>,adjust = <span>1.5</span>)+<br>  guides(fill=guide_legend(title=<span>"group"</span>))+<br>  stat_summary(fun.data = <span>"mean_sd"</span>,position=position_dodge(<span>0.15</span>),geom = <span>"errorbar"</span>,width = <span>.1</span>) +<br>  stat_summary(fun = <span>"mean"</span>, geom = <span>"point"</span>, position=position_dodge(<span>0.15</span>),show.legend = <span>F</span>)+<br>  stat_compare_means(aes(group = B), label = <span>"p.signif"</span>,label.y=<span>210</span>, method=<span>"t.test"</span>,size=<span>5</span>)+<br>  scale_fill_manual(values=c(<span>"#788FCE"</span>,<span>"#E6956F"</span>))+<br>  labs(x=<span>NULL</span>,y=<span>"DOC(mg kg-1)"</span>)+<br>  theme(<br>        axis.text.x=element_text(angle =<span>0</span>,hjust =<span>0.5</span>,vjust =<span>0.5</span>,color=<span>"black"</span>,size = <span>10</span>,margin = margin(b =<span>2</span>)),<br>        axis.text.y=element_text(color=<span>"black"</span>,size = <span>10</span>,margin = margin(r =<span>1</span>)),<br>        panel.background = element_rect(fill = <span>NA</span>,color = <span>NA</span>),<br>        panel.grid.minor= element_line(size=<span>0.2</span>,color=<span>"#e5e5e5"</span>),<br>        panel.grid.major = element_line(size=<span>0.2</span>,color=<span>"#e5e5e5"</span>),<br>        panel.border = element_rect(fill=<span>NA</span>,color=<span>"black"</span>,size=<span>1</span>,linetype=<span>"solid"</span>),<br>        legend.position =<span>"non"</span>)<br><br>df3 &lt;- read_tsv(<span>"F1BC.txt"</span>) %&gt;% <br>  select(<span>2</span>,<span>3</span>,-<span>1</span>) %&gt;% <br>  separate(`Treatment`,into=c(<span>"A"</span>,<span>"B"</span>),sep=<span>"-"</span>,convert = <span>T</span>) %&gt;% <br>  mutate(B = str_replace_all(B, <span>"[0-9]"</span>, <span>""</span>))<br><br>df3$A &lt;- factor(df3$A,levels = c(<span>"Conven"</span>,<span>"Conserv"</span>))<br><br>b &lt;- ggplot(df3,aes(x = A, y =`Soil temperate (℃)`,fill= B))+<br>  geom_split_violin(trim =<span>F</span>,color = <span>NA</span>,adjust = <span>1.5</span>)+<br>  guides(fill=guide_legend(title=<span>"group"</span>))+<br>  stat_summary(fun.data = <span>"mean_sd"</span>,position=position_dodge(<span>0.15</span>),geom = <span>"errorbar"</span>,width = <span>.1</span>) +<br>  stat_summary(fun = <span>"mean"</span>, geom = <span>"point"</span>, position=position_dodge(<span>0.15</span>),show.legend = <span>F</span>)+<br>  stat_compare_means(aes(group = B), label = <span>"p.signif"</span>,label.y=<span>17.1</span>, method=<span>"t.test"</span>,size=<span>5</span>)+<br>  scale_fill_manual(values=c(<span>"#788FCE"</span>,<span>"#E6956F"</span>)) +<br>  labs(x=<span>NULL</span>,y=<span>"Soil temperate"</span>)+<br>  theme(<br>        axis.text.x=element_text(angle =<span>0</span>,hjust =<span>0.5</span>,vjust =<span>0.5</span>,color=<span>"black"</span>,size = <span>10</span>,margin = margin(b =<span>2</span>)),<br>        axis.text.y=element_text(color=<span>"black"</span>,size = <span>10</span>,margin = margin(r =<span>1</span>)),<br>        panel.background = element_rect(fill = <span>NA</span>,color = <span>NA</span>),<br>        panel.grid.minor= element_line(size=<span>0.2</span>,color=<span>"#e5e5e5"</span>),<br>        panel.grid.major = element_line(size=<span>0.2</span>,color=<span>"#e5e5e5"</span>),<br>        panel.border = element_rect(fill=<span>NA</span>,color=<span>"black"</span>,size=<span>1</span>,linetype=<span>"solid"</span>),<br>        legend.position =<span>"non"</span>)<br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span><span></span>拼图</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code>a+b+g+ plot_annotation(tag_levels = <span>'A'</span>)<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100025320" data-ratio="0.37037037037037035" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAaCyRv77Rx7IZmGI4TlfDIJricM0fgZJAqF6FoU5ya4ZIpeELSWnn0QLNPMgWHkmylQmKZSbibvT2fQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAaCyRv77Rx7IZmGI4TlfDIJricM0fgZJAqF6FoU5ya4ZIpeELSWnn0QLNPMgWHkmylQmKZSbibvT2fQ/640?wx_fmt=png&amp;from=appmsg"></figure><blockquote data-tool="mdnice编辑器"><span>❝</span><p>本节介绍到此结束，有需要学习数据可视化的朋友，欢迎到小编的<strong>「淘宝店铺」</strong> <strong>「R语言数据分析指南」</strong>下单购买，内容主要包括各种<strong>「高分论文的图表分析复现以及一些个性化图表的绘制」</strong>均包含数据+代码。</p><span>❞</span></blockquote><p data-tool="mdnice编辑器">购买后微信发小编订单号即邀请进新的会员交流群，无论购买那一年的会员文档都将获取<strong>「2024年及以后更新的绘图文档」</strong>，早买早享受，需要了解更多信息的朋友欢迎淘宝店铺交流咨询。</p><h3 data-tool="mdnice编辑器"><span></span><span><span></span>淘宝扫一扫</span><span></span></h3><figure data-tool="mdnice编辑器"><img data-imgfileid="100025319" data-ratio="1.5681159420289854" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAaCyRv77Rx7IZmGI4TlfDIJakuC8E1rmTjy5HjuJK0WRlxMX1EMuU1sjicz9xGg9r4Xcm6YVOI9vmg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="690" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAaCyRv77Rx7IZmGI4TlfDIJakuC8E1rmTjy5HjuJK0WRlxMX1EMuU1sjicz9xGg9r4Xcm6YVOI9vmg/640?wx_fmt=png&amp;from=appmsg"></figure><h3 data-tool="mdnice编辑器"><span></span><span><span></span>淘宝店铺(有需要欢迎关注)</span><span></span></h3><p><img data-galleryid="" data-imgfileid="100019415" data-ratio="1.0210420841683367" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/EibnicgwScTAbvhPDLGT8NaialEsht92PTYNJWpmVLfoYGic1uha5FyBrDCibibZCLjiazgvpT1XcdwibfVywD2el0VAgg/640?wx_fmt=jpeg" data-type="jpeg" data-w="998" src="https://mmbiz.qpic.cn/mmbiz_jpg/EibnicgwScTAbvhPDLGT8NaialEsht92PTYNJWpmVLfoYGic1uha5FyBrDCibibZCLjiazgvpT1XcdwibfVywD2el0VAgg/640?wx_fmt=jpeg"></p><h3 data-tool="mdnice编辑器"><span></span><span><span></span>关注下方公众号下回更新不迷路</span><span></span></h3><p><img data-galleryid="" data-imgfileid="100016185" data-ratio="0.3194444444444444" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAYib6Vf5Lfu4s64dJIEWhdGMvrcDEx2Rxgd91TOF5sjqy47Wqf2cTO1c5Nhdibh8G5IhOnR53j6XKrw/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAYib6Vf5Lfu4s64dJIEWhdGMvrcDEx2Rxgd91TOF5sjqy47Wqf2cTO1c5Nhdibh8G5IhOnR53j6XKrw/640?wx_fmt=png"></p></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/VKG_XoMVViycRnF5SSR5yA",target="_blank" rel="noopener noreferrer">原文链接</a>
