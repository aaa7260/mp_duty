---
title: "新格元celescope的单细胞上游分析"
date: 2024-01-31T00:27:17Z
draft: ["false"]
tags: [
  "fetched",
  "东林的扯淡小屋"
]
categories: ["Acdemic"]
---
新格元celescope的单细胞上游分析 by 东林的扯淡小屋
------
<div><p><span>软件安装：</span><br></p><section><ul><li><li><li><li><li><li><li><li><li></ul><pre data-lang="javascript"><code><span><br></span></code><code><span>git clone https:<span>//github.com/singleron-RD/CeleScope.git</span></span></code><code><span>cd CeleScope</span></code><code><span>mamba create -n celescope -y --file conda_pkgs.txt</span></code><code><span>conda activate celescope</span></code><code><span>pip install celescope</span></code><code><span>conda activate celescope</span></code><code><span>celescope rna --help </span></code><code><span>#https:<span>//github.com/singleron-RD/CeleScope</span></span></code></pre></section><p><img data-galleryid="" data-ratio="0.5638888888888889" data-s="300,640" data-type="png" data-w="1080" data-src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBp4l7uicyQFKeoDQYcxX4fBLuYWJK4uic5uux41ick3vAjb0APyAnzTsXjlASTqXiaKiafKkA6K7pH54qQ/640?wx_fmt=png" src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBp4l7uicyQFKeoDQYcxX4fBLuYWJK4uic5uux41ick3vAjb0APyAnzTsXjlASTqXiaKiafKkA6K7pH54qQ/640?wx_fmt=png"></p><p><img data-galleryid="" data-ratio="0.5638888888888889" data-s="300,640" data-type="png" data-w="1080" data-src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBp4l7uicyQFKeoDQYcxX4fBLEajqAbiaKeWQW0icMqhCQusspeLQ9rzIw6BW4oib7tN6tIE09licEvyHvQ/640?wx_fmt=png" src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBp4l7uicyQFKeoDQYcxX4fBLEajqAbiaKeWQW0icMqhCQusspeLQ9rzIw6BW4oib7tN6tIE09licEvyHvQ/640?wx_fmt=png"></p><p><img data-galleryid="" data-ratio="0.48055555555555557" data-s="300,640" data-type="png" data-w="1080" data-src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBp4l7uicyQFKeoDQYcxX4fBLsIN69o5JmMAVicI0NpuWzia6MKyh1TmLRY73VhuIVQkXHsLOUDc2ibnXA/640?wx_fmt=png" src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBp4l7uicyQFKeoDQYcxX4fBLsIN69o5JmMAVicI0NpuWzia6MKyh1TmLRY73VhuIVQkXHsLOUDc2ibnXA/640?wx_fmt=png"></p><p><img data-galleryid="" data-ratio="0.5935185185185186" data-s="300,640" data-type="png" data-w="1080" data-src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBp4l7uicyQFKeoDQYcxX4fBLKTM33P8w8LPbgHUwzHRJ2iaI5jibXx7TCImpycC04cmqa8HsuKkUxhVw/640?wx_fmt=png" src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBp4l7uicyQFKeoDQYcxX4fBLKTM33P8w8LPbgHUwzHRJ2iaI5jibXx7TCImpycC04cmqa8HsuKkUxhVw/640?wx_fmt=png"></p><p><img data-galleryid="" data-ratio="0.5935185185185186" data-s="300,640" data-type="png" data-w="1080" data-src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBp4l7uicyQFKeoDQYcxX4fBL8JjunNzYOY0iaaBeaytY7uw72u12AcPJZEQzdX3M3uBRXH8COYBzibyA/640?wx_fmt=png" src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBp4l7uicyQFKeoDQYcxX4fBL8JjunNzYOY0iaaBeaytY7uw72u12AcPJZEQzdX3M3uBRXH8COYBzibyA/640?wx_fmt=png"></p><p><img data-galleryid="" data-ratio="0.5935185185185186" data-s="300,640" data-type="png" data-w="1080" data-src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBp4l7uicyQFKeoDQYcxX4fBLRfd5ic2VkCXhyib0bZtc9ulyBR7icOlPYL7Rv0UXGz5KWibKuMGz6v48SQ/640?wx_fmt=png" src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBp4l7uicyQFKeoDQYcxX4fBLRfd5ic2VkCXhyib0bZtc9ulyBR7icOlPYL7Rv0UXGz5KWibKuMGz6v48SQ/640?wx_fmt=png"></p><p>报错了hhh，于是用conda去安装软件：<br></p><section><ul><li></ul><pre data-lang="nginx"><code><span><span>conda</span> install -c <span>"bioconda/label/cf201901"</span> pysam</span></code></pre></section><p><img data-galleryid="" data-ratio="0.5935185185185186" data-s="300,640" data-type="png" data-w="1080" data-src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBpTQib13MgkuiapuAXHbpjtbsjuvCaW5sD8xwsv6e0Y54sFMu3AficACvNicMjBQaQZ6Irnk0mQavhgIA/640?wx_fmt=png" src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBpTQib13MgkuiapuAXHbpjtbsjuvCaW5sD8xwsv6e0Y54sFMu3AficACvNicMjBQaQZ6Irnk0mQavhgIA/640?wx_fmt=png"></p><p><img data-galleryid="" data-ratio="0.5935185185185186" data-s="300,640" data-type="png" data-w="1080" data-src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBpTQib13MgkuiapuAXHbpjtbs1m6wQJDksZgO3hzjqtTcXXWYFbOoepeXsbJMomZnVI1BlYRibmVEOicg/640?wx_fmt=png" src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBpTQib13MgkuiapuAXHbpjtbs1m6wQJDksZgO3hzjqtTcXXWYFbOoepeXsbJMomZnVI1BlYRibmVEOicg/640?wx_fmt=png"></p><p>成功安装！<br></p><p><img data-galleryid="" data-ratio="0.5935185185185186" data-s="300,640" data-type="png" data-w="1080" data-src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBpTQib13MgkuiapuAXHbpjtbsYT9ZIWwwmGQoibEQUN2oiatsdDvVdsmIY3qg8u5R389khnU8pXvXZL4w/640?wx_fmt=png" src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBpTQib13MgkuiapuAXHbpjtbsYT9ZIWwwmGQoibEQUN2oiatsdDvVdsmIY3qg8u5R389khnU8pXvXZL4w/640?wx_fmt=png"></p><p>构建索引：STAR索引<br></p><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="powershell"><code><span>cd /<span>data</span>3/yudonglin/metastases/lymph_node/breast_cancer</span></code><code><span><br></span></code><code><span>conda create -n rna python=<span>2</span></span></code><code><span><br></span></code><code><span>cd /<span>data</span>/yudonglin/reference/singcell</span></code><code><span>mkdir hs_ensembl_99</span></code><code><span>cd hs_ensembl_99</span></code><code><span><br></span></code><code><span>wget ftp://ftp.ensembl.org/pub/release-<span>99</span>/fasta/homo_sapiens/dna/Homo_sapiens.GRCh38.dna.primary_assembly.fa.gz</span></code><code><span>wget ftp://ftp.ensembl.org/pub/release-<span>99</span>/gtf/homo_sapiens/Homo_sapiens.GRCh38.<span>99</span>.gtf.gz</span></code><code><span><br></span></code><code><span>gunzip Homo_sapiens.GRCh38.dna.primary_assembly.fa.gz</span></code><code><span>gunzip Homo_sapiens.GRCh38.<span>99</span>.gtf.gz</span></code><code><span><br></span></code><code><span>conda activate celescope</span></code><code><span>celescope utils mkgtf Homo_sapiens.GRCh38.<span>99</span>.gtf Homo_sapiens.GRCh38.<span>99</span>.filtered.gtf</span></code><code><span>celescope rna mkref \</span></code><code><span> --genome_name Homo_sapiens_ensembl_99_filtered \</span></code><code><span> --fasta Homo_sapiens.GRCh38.dna.primary_assembly.fa \</span></code><code><span> --gtf Homo_sapiens.GRCh38.<span>99</span>.filtered.gtf \</span></code><code><span> --mt_gene_list mt_gene_list.txt</span></code></pre></section><p><img data-galleryid="" data-ratio="0.55" data-s="300,640" data-type="png" data-w="1080" data-src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBp4l7uicyQFKeoDQYcxX4fBLJ9Bg7qrJWVyI42fWHXerTHzEibWR5HcOQZTGN4uXftN87GB4GxyAiahw/640?wx_fmt=png" src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBp4l7uicyQFKeoDQYcxX4fBLJ9Bg7qrJWVyI42fWHXerTHzEibWR5HcOQZTGN4uXftN87GB4GxyAiahw/640?wx_fmt=png"></p><p><img data-galleryid="" data-imgfileid="100025302" data-ratio="0.12685185185185185" data-s="300,640" data-type="png" data-w="1080" data-src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBq9WElrnNmwwWKxmVlFicuUqzXs1zExmPcZejrmFiaAUHd1tmhKRibFVENpHJanazY0I7SfjouCBMAeA/640?wx_fmt=png&amp;from=appmsg" src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBq9WElrnNmwwWKxmVlFicuUqzXs1zExmPcZejrmFiaAUHd1tmhKRibFVENpHJanazY0I7SfjouCBMAeA/640?wx_fmt=png&amp;from=appmsg"></p><p><img data-galleryid="" data-imgfileid="100025306" data-ratio="0.5907407407407408" data-s="300,640" data-type="png" data-w="1080" data-src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBq9WElrnNmwwWKxmVlFicuUqQQGOkzEKiaj0nzTdsKjotVVRks5a1p9NdvaJxpR11SsjLOjfUftemew/640?wx_fmt=png&amp;from=appmsg" src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBq9WElrnNmwwWKxmVlFicuUqQQGOkzEKiaj0nzTdsKjotVVRks5a1p9NdvaJxpR11SsjLOjfUftemew/640?wx_fmt=png&amp;from=appmsg"></p><p><span>接下来就可以实战了！</span><br></p><p><br></p><p>参考链接：</p><p>https://mp.weixin.qq.com/s/tu8dy1MOr4Ew9udbfPiAOQ</p><p>https://mp.weixin.qq.com/s/sU4Rl_USalAPsy2xCdTSrA</p><p><img data-galleryid="" data-imgfileid="100025299" data-ratio="0.8425925925925926" data-s="300,640" data-type="png" data-w="1080" data-src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBq9WElrnNmwwWKxmVlFicuUq2eO1zLE1ibjhICMPgAF9picyYXXCG1dI9hEiaBTBYqPPlZictEWBqpkVicw/640?wx_fmt=png&amp;from=appmsg" src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBq9WElrnNmwwWKxmVlFicuUq2eO1zLE1ibjhICMPgAF9picyYXXCG1dI9hEiaBTBYqPPlZictEWBqpkVicw/640?wx_fmt=png&amp;from=appmsg"></p><p><img data-galleryid="" data-imgfileid="100025300" data-ratio="0.6023329798515377" data-s="300,640" data-type="png" data-w="943" data-src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBq9WElrnNmwwWKxmVlFicuUqQfab6HDEIjvZqFdaBxNkCDRG15u7YRgkYk8MrhWxLLcx52iaTgOYRaw/640?wx_fmt=png&amp;from=appmsg" src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBq9WElrnNmwwWKxmVlFicuUqQfab6HDEIjvZqFdaBxNkCDRG15u7YRgkYk8MrhWxLLcx52iaTgOYRaw/640?wx_fmt=png&amp;from=appmsg"></p><p><img data-galleryid="" data-imgfileid="100025301" data-ratio="0.8435185185185186" data-s="300,640" data-type="png" data-w="1080" data-src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBq9WElrnNmwwWKxmVlFicuUqAubBKnHeyqskVGm3CJjA9r3ibx9sZh9hhgiabSaib8Btf018mUeJrsiaQg/640?wx_fmt=png&amp;from=appmsg" src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBq9WElrnNmwwWKxmVlFicuUqAubBKnHeyqskVGm3CJjA9r3ibx9sZh9hhgiabSaib8Btf018mUeJrsiaQg/640?wx_fmt=png&amp;from=appmsg"></p><section><ul><li><li><li><li><li><li><li><li><li></ul><pre data-lang="swift"><code><span>cd /data1/yudonglin/scATAC</span></code><code><span><br></span></code><code><span>wget -<span>c</span> https:<span>//sra-pub-run-odp.s3.amazonaws.com/sra/SRR12695060/SRR12695060 -O SRR12695060.sra</span></span></code><code><span>wget -<span>c</span> https:<span>//sra-pub-run-odp.s3.amazonaws.com/sra/SRR12695061/SRR12695061 -O SRR12695061.sra</span></span></code><code><span>wget -<span>c</span> https:<span>//sra-pub-run-odp.s3.amazonaws.com/sra/SRR12695062/SRR12695062 -O SRR12695062.sra</span></span></code><code><span>fastq-<span>dump</span> --<span>split</span>-files --gzip <span>SRR12695060</span>.sra</span></code><code><span>fastq-<span>dump</span> --<span>split</span>-files --gzip <span>SRR12695061</span>.sra</span></code><code><span>fastq-<span>dump</span> --<span>split</span>-files --gzip <span>SRR12695062</span>.sra</span></code><code><span><br></span></code></pre></section><p><img data-galleryid="" data-imgfileid="100025339" data-ratio="0.5555555555555556" data-s="300,640" data-type="png" data-w="1080" data-src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBq9WElrnNmwwWKxmVlFicuUq7KRAMuXmjknjHvDIzEE4WsJCXLy3CibBNOc7AibibaT6ia5lTWicxWIXOQw/640?wx_fmt=png&amp;from=appmsg" src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBq9WElrnNmwwWKxmVlFicuUq7KRAMuXmjknjHvDIzEE4WsJCXLy3CibBNOc7AibibaT6ia5lTWicxWIXOQw/640?wx_fmt=png&amp;from=appmsg"></p><p><img data-galleryid="" data-imgfileid="100025303" data-ratio="0.11832946635730858" data-s="300,640" data-type="png" data-w="862" data-src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBq9WElrnNmwwWKxmVlFicuUqqtHVSw8vUWA3jMkTNH7aicK5XPkafpbfFGtHvLUlDY85TslicliaBETmQ/640?wx_fmt=png&amp;from=appmsg" src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBq9WElrnNmwwWKxmVlFicuUqqtHVSw8vUWA3jMkTNH7aicK5XPkafpbfFGtHvLUlDY85TslicliaBETmQ/640?wx_fmt=png&amp;from=appmsg"></p><p><img data-galleryid="" data-imgfileid="100025304" data-ratio="0.13703703703703704" data-s="300,640" data-type="png" data-w="1080" data-src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBq9WElrnNmwwWKxmVlFicuUqYTHY2XKHbc1RkVzd6vYbIyeib6jicMn1UdicF3fu6qyRhD9cGW5hSGq0A/640?wx_fmt=png&amp;from=appmsg" src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBq9WElrnNmwwWKxmVlFicuUqYTHY2XKHbc1RkVzd6vYbIyeib6jicMn1UdicF3fu6qyRhD9cGW5hSGq0A/640?wx_fmt=png&amp;from=appmsg"></p><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="bash"><code><span>multi_rna\</span></code><code><span>--<span>mapfile</span> ./<span>mapfile</span> \<span># 提供mapfile文件位置</span></span></code><code><span>--genomeDir pathto/genome \ <span># mkref创建的参考基因组目录(路径)</span></span></code><code><span>--thread 4  \<span># 线程数</span></span></code><code><span>--mod  shell \<span># 生成的脚本类型</span></span></code><code><span>--outdir   ./   <span># 可以指定文件的输出路径</span></span></code><code><span><br></span></code><code><span>--<span>mapfile</span>：包含三列, 每列之间用tab分割；每一行是一个样本。</span></code><code><span>第一列：fastq前缀</span></code><code><span>第二列：fastq所在文件夹</span></code><code><span>第三列：{sample}（即生成文件的前缀）</span></code><code><span>第四列：可选，期望细胞数</span></code><code><span>vi rna.mapfile</span></code><code><span>SRR12695060  /data1/yudonglin/scATAC/SRR12695060  primary_breast</span></code><code><span>SRR12695061  /data1/yudonglin/scATAC/SRR12695061  positive_lymph_node</span></code><code><span>SRR12695062  /data1/yudonglin/scATAC/SRR12695062  negative_lymph_node</span></code><code><span><br></span></code><code><span><br></span></code><code><span>multi_rna \</span></code><code><span>  --<span>mapfile</span> ./rna.mapfile \</span></code><code><span>  --genomeDir /data/yudonglin/reference/singcell/hs_ensembl_99 \</span></code><code><span>  --thread 20 \</span></code><code><span>  --mod shell</span></code><code><span><br></span></code></pre></section><p><img data-galleryid="" data-imgfileid="100025305" data-ratio="0.5398148148148149" data-s="300,640" data-type="png" data-w="1080" data-src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBq9WElrnNmwwWKxmVlFicuUqLDrlYDC9XgIDosv0FLoVR9aXLUDMh2Sjvgcz8k6qxKWXFoyibQQZdtA/640?wx_fmt=png&amp;from=appmsg" src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBq9WElrnNmwwWKxmVlFicuUqLDrlYDC9XgIDosv0FLoVR9aXLUDMh2Sjvgcz8k6qxKWXFoyibQQZdtA/640?wx_fmt=png&amp;from=appmsg"></p><section><ul><li><li><li><li></ul><pre data-lang="properties"><code><span><br></span></code><code><span><span>sh</span> <span>/data1/yudonglin/scATAC/shell/negative_lymph_node.sh  </span></span></code><code><span><span>sh</span> <span>/data1/yudonglin/scATAC/shell/positive_lymph_node.sh  </span></span></code><code><span><span>sh /data1/yudonglin/scATAC/shell/primary_breast.sh</span></span></code></pre></section><p><img data-galleryid="" data-imgfileid="100025307" data-ratio="0.5907407407407408" data-s="300,640" data-type="png" data-w="1080" data-src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBq9WElrnNmwwWKxmVlFicuUqh8fBXp8pG7ZqKzr7LUkZPFSxYbgIFcx6oUCqjmczWX0XL85rDh7mibQ/640?wx_fmt=png&amp;from=appmsg" src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBq9WElrnNmwwWKxmVlFicuUqh8fBXp8pG7ZqKzr7LUkZPFSxYbgIFcx6oUCqjmczWX0XL85rDh7mibQ/640?wx_fmt=png&amp;from=appmsg"></p><p>出问题了，因此手动修改代码：<br></p><p><img data-galleryid="" data-imgfileid="100025308" data-ratio="0.2537037037037037" data-s="300,640" data-type="png" data-w="1080" data-src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBq9WElrnNmwwWKxmVlFicuUqzZnav8nhV9BzPjp8bX2xx1lVFg2h8O2QrrjhFuqmp4HKicmOGSLc96w/640?wx_fmt=png&amp;from=appmsg" src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBq9WElrnNmwwWKxmVlFicuUqzZnav8nhV9BzPjp8bX2xx1lVFg2h8O2QrrjhFuqmp4HKicmOGSLc96w/640?wx_fmt=png&amp;from=appmsg"></p><section><ul><li><li><li><li><li><li></ul><pre data-lang="ruby"><code><span>celescope rna sample --outdir ./<span>/negative_lymph_node/</span><span>00</span>.sample --sample negative_lymph_node --thread <span>20</span> --chemistry scopeV1  --fq1 /data1/yudonglin/scATAC/SRR12695062/SRR12695062_1.fastq.gz </span></code><code><span>celescope rna prep_map --outdir ./<span>/negative_lymph_node/</span><span>01</span>.prep_map --sample negative_lymph_node --thread <span>20</span> --chemistry scopeV1 --lowNum <span>2</span> --minimum_length <span>20</span> --nextseq_trim <span>20</span> --overlap <span>10</span> --genomeDir /data/yudonglin/reference/singcell/hs_ensembl_99 --outFilterMatchNmin <span>50</span> --outFilterMultimapNmax <span>1</span> --starMem <span>30</span>  --fq1 /data1/yudonglin/scATAC/SRR12695062/SRR12695062_1.fastq.gz --fq2 /data1/yudonglin/scATAC/SRR12695062/SRR12695062_2.fastq.gz </span></code><code><span>celescope rna featureCounts --outdir ./<span>/negative_lymph_node/</span><span>02</span>.featureCounts --sample negative_lymph_node --thread <span>20</span> --gtf_type gene --genomeDir /data/yudonglin/reference/singcell/hs_ensembl_99  --input ./<span>/negative_lymph_node/</span><span>01</span>.prep_map/negative_lymph_node_Aligned.out.bam </span></code><code><span>celescope rna count --outdir ./<span>/negative_lymph_node/</span><span>03</span>.count --sample negative_lymph_node --thread <span>20</span> --genomeDir /data/yudonglin/reference/singcell/hs_ensembl_99 --expected_cell_num <span>3000</span> --cell_calling_method EmptyDrops_CR  --count_detail ./<span>/negative_lymph_node/</span><span>02</span>.featureCounts/negative_lymph_node_count_detail.txt --force_cell_num None </span></code><code><span>celescope rna analysis --outdir ./<span>/negative_lymph_node/</span><span>04</span>.analysis --sample negative_lymph_node --thread <span>20</span> --genomeDir /data/yudonglin/reference/singcell/hs_ensembl_99  --matrix_file ./<span>/negative_lymph_node/</span><span>03</span>.count/negative_lymph_node_filtered_feature_bc_matrix</span></code><code><span><br></span></code></pre></section><p><img data-galleryid="" data-imgfileid="100025309" data-ratio="0.5907407407407408" data-s="300,640" data-type="png" data-w="1080" data-src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBq9WElrnNmwwWKxmVlFicuUqxT0nhxynAhFnjkPG5lRicNE5IRO08bg2tGNDekUdqR5EQibwWDTvHMIg/640?wx_fmt=png&amp;from=appmsg" src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBq9WElrnNmwwWKxmVlFicuUqxT0nhxynAhFnjkPG5lRicNE5IRO08bg2tGNDekUdqR5EQibwWDTvHMIg/640?wx_fmt=png&amp;from=appmsg"></p><section><ul><li><li><li><li><li><li></ul><pre data-lang="ruby"><code><span>celescope rna sample --outdir ./<span>/positive_lymph_node/</span><span>00</span>.sample --sample positive_lymph_node --thread <span>20</span> --chemistry scopeV1  --fq1 /data1/yudonglin/scATAC/SRR12695061/SRR12695061_1.fastq.gz </span></code><code><span>celescope rna prep_map --outdir ./<span>/positive_lymph_node/</span><span>01</span>.prep_map --sample positive_lymph_node --thread <span>20</span> --chemistry scopeV1 --lowNum <span>2</span> --minimum_length <span>20</span> --nextseq_trim <span>20</span> --overlap <span>10</span> --genomeDir /data/yudonglin/reference/singcell/hs_ensembl_99 --outFilterMatchNmin <span>50</span> --outFilterMultimapNmax <span>1</span> --starMem <span>30</span>  --fq1 /data1/yudonglin/scATAC/SRR12695061/SRR12695061_1.fastq.gz --fq2 /data1/yudonglin/scATAC/SRR12695061/SRR12695061_2.fastq.gz </span></code><code><span>celescope rna featureCounts --outdir ./<span>/positive_lymph_node/</span><span>02</span>.featureCounts --sample positive_lymph_node --thread <span>20</span> --gtf_type gene --genomeDir /data/yudonglin/reference/singcell/hs_ensembl_99  --input ./<span>/positive_lymph_node/</span><span>01</span>.prep_map/positive_lymph_node_Aligned.out.bam </span></code><code><span>celescope rna count --outdir ./<span>/positive_lymph_node/</span><span>03</span>.count --sample positive_lymph_node --thread <span>20</span> --genomeDir /data/yudonglin/reference/singcell/hs_ensembl_99 --expected_cell_num <span>3000</span> --cell_calling_method EmptyDrops_CR  --count_detail ./<span>/positive_lymph_node/</span><span>02</span>.featureCounts/positive_lymph_node_count_detail.txt --force_cell_num None </span></code><code><span>celescope rna analysis --outdir ./<span>/positive_lymph_node/</span><span>04</span>.analysis --sample positive_lymph_node --thread <span>20</span> --genomeDir /data/yudonglin/reference/singcell/hs_ensembl_99  --matrix_file ./<span>/positive_lymph_node/</span><span>03</span>.count/positive_lymph_node_filtered_feature_bc_matrix</span></code><code><span><br></span></code></pre></section><p><br></p><section><ul><li><li><li><li><li><li></ul><pre data-lang="ruby"><code><span>celescope rna sample --outdir ./<span>/primary_breast/</span><span>00</span>.sample --sample primary_breast --thread <span>20</span> --chemistry scopeV1  --fq1 /data1/yudonglin/scATAC/SRR1269506<span>0</span>/SRR12695060_1.fastq.gz </span></code><code><span>celescope rna prep_map --outdir ./<span>/primary_breast/</span><span>01</span>.prep_map --sample primary_breast --thread <span>20</span> --chemistry scopeV1 --lowNum <span>2</span> --minimum_length <span>20</span> --nextseq_trim <span>20</span> --overlap <span>10</span> --genomeDir /data/yudonglin/reference/singcell/hs_ensembl_99 --outFilterMatchNmin <span>50</span> --outFilterMultimapNmax <span>1</span> --starMem <span>30</span>  --fq1 /data1/yudonglin/scATAC/SRR1269506<span>0</span>/SRR12695060_1.fastq.gz --fq2 /data1/yudonglin/scATAC/SRR1269506<span>0</span>/SRR12695060_2.fastq.gz </span></code><code><span>celescope rna featureCounts --outdir ./<span>/primary_breast/</span><span>02</span>.featureCounts --sample primary_breast --thread <span>20</span> --gtf_type gene --genomeDir /data/yudonglin/reference/singcell/hs_ensembl_99  --input ./<span>/primary_breast/</span><span>01</span>.prep_map/primary_breast_Aligned.out.bam </span></code><code><span>celescope rna count --outdir ./<span>/primary_breast/</span><span>03</span>.count --sample primary_breast --thread <span>20</span> --genomeDir /data/yudonglin/reference/singcell/hs_ensembl_99 --expected_cell_num <span>3000</span> --cell_calling_method EmptyDrops_CR  --count_detail ./<span>/primary_breast/</span><span>02</span>.featureCounts/primary_breast_count_detail.txt --force_cell_num None </span></code><code><span>celescope rna analysis --outdir ./<span>/primary_breast/</span><span>04</span>.analysis --sample primary_breast --thread <span>20</span> --genomeDir /data/yudonglin/reference/singcell/hs_ensembl_99  --matrix_file ./<span>/primary_breast/</span><span>03</span>.count/primary_breast_filtered_feature_bc_matrix</span></code><code><span><br></span></code></pre></section><p>或者可以继续执行：<br></p><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="http"><code><span><br></span></code><code><span><span>cd /data1/yudonglin/scATAC</span></span></code><code><span>conda activate /home/yudonglin/miniconda3/envs/celescope</span></code><code><span>sh /data1/yudonglin/scATAC/shell/negative_lymph_node.sh  </span></code><code><span><br></span></code><code><span><br></span></code><code><span>cd /data1/yudonglin/scATAC</span></code><code><span>conda activate /home/yudonglin/miniconda3/envs/celescope</span></code><code><span>sh /data1/yudonglin/scATAC/shell/positive_lymph_node.sh  </span></code><code><span><br></span></code><code><span><br></span></code><code><span>cd /data1/yudonglin/scATAC</span></code><code><span>conda activate /home/yudonglin/miniconda3/envs/celescope</span></code><code><span>sh /data1/yudonglin/scATAC/shell/primary_breast.sh</span></code><code><span><br></span></code></pre></section><p><img data-galleryid="" data-imgfileid="100025357" data-ratio="0.5623268698060941" data-s="300,640" data-type="png" data-w="361" data-src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBoM7kKVmYia50SOODAX3q76ohfiaXlVCIRcia16CJs7ZqWcKEXk2icPLK91mu3SibKicrIzPo2yt41R5E5Q/640?wx_fmt=png&amp;from=appmsg" src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBoM7kKVmYia50SOODAX3q76ohfiaXlVCIRcia16CJs7ZqWcKEXk2icPLK91mu3SibKicrIzPo2yt41R5E5Q/640?wx_fmt=png&amp;from=appmsg"></p><p><img data-galleryid="" data-imgfileid="100025358" data-ratio="0.44351851851851853" data-s="300,640" data-type="png" data-w="1080" data-src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBoM7kKVmYia50SOODAX3q76oyObTZAsG8CXxicvH4pCZXL8TSjM9wTWI3DoHXRTFndYf6FbQiaXIbHAQ/640?wx_fmt=png&amp;from=appmsg" src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBoM7kKVmYia50SOODAX3q76oyObTZAsG8CXxicvH4pCZXL8TSjM9wTWI3DoHXRTFndYf6FbQiaXIbHAQ/640?wx_fmt=png&amp;from=appmsg"></p><p>总的来说，比cellranger麻烦多了，但是也不算多难。<br></p><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/BxvBhLhRkH6pHZ_rawsXjQ",target="_blank" rel="noopener noreferrer">原文链接</a>
