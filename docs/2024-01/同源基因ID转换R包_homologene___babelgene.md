---
title: "同源基因ID转换R包 homologene / babelgene"
date: 2024-01-26T09:46:03Z
draft: ["false"]
tags: [
  "fetched",
  "被炸熟的虾"
]
categories: ["Acdemic"]
---
同源基因ID转换R包 homologene / babelgene by 被炸熟的虾
------
<div><p><span>在日常分析中，我们经常需要对同一物种基因ID和symbol进行互转，或者查找不同物种之间的同源基因。</span><span>通常我们会借助R包，例如biomaRt，easyConvert和org.Hs.eg.db等，或者借助在线工具，例如DAVIA，或是进入Ensemble、ncbi等数据库查询。</span><span>但是这些方法都存在各种各样的问题，如biomaRt对网络依赖很大，org.Hs.eg.db会丢失很多基因等，很多在线工具也是如此。</span><span>这里记录两种使用轻便的R包：</span></p><h2><span>1、<span>babelgene</span></span></h2><section><span>babelgene包汇总了来自多个数据库EggNOG、Ensembl、HGNC、HomoloGene、Inparanoid、NCBI、OMA、OrthoDB、OrthoMCL、Panther、PhylomeDB、Treefam的结果，根据查询的基因返回人对应的基因信息，核心只要一步函数</span><code>orthologs</code><span> 。</span></section><pre><code>install.packages(<span>"babelgene"</span>)<br>packageVersion(<span>"babelgene"</span>)<span>#[1] ‘22.9’</span><br><span>library</span>(babelgene)<br>orthologs(genes = c(<span>"TP53"</span>, <span>"EGFR"</span>, <span>"IL6"</span>, <span>"TGFB1"</span>, <span>"CD4"</span>), species = <span>"mouse"</span>)<br> <span>#  human_symbol human_entrez   human_ensembl taxon_id symbol entrez            ensembl</span><br><span># 1          CD4          920 ENSG00000010610    10090    Cd4  12504 ENSMUSG00000023274</span><br><span># 2         EGFR         1956 ENSG00000146648    10090   Egfr  13649 ENSMUSG00000020122</span><br><span># 3          IL6         3569 ENSG00000136244    10090    Il6  16193 ENSMUSG00000025746</span><br><span># 4        TGFB1         7040 ENSG00000105329    10090  Tgfb1  21803 ENSMUSG00000002603</span><br><span># 5         TP53         7157 ENSG00000141510    10090  Trp53  22059 ENSMUSG00000059552</span><br>                                                                                        <span># support support_n</span><br><span># 1 EggNOG|Ensembl|HGNC|HomoloGene|Inparanoid|NCBI|OMA|OrthoDB|OrthoMCL|Panther|PhylomeDB|Treefam        12</span><br><span># 2 EggNOG|Ensembl|HGNC|HomoloGene|Inparanoid|NCBI|OMA|OrthoDB|OrthoMCL|Panther|PhylomeDB|Treefam        12</span><br><span># 3                Ensembl|HGNC|HomoloGene|Inparanoid|NCBI|OMA|OrthoMCL|Panther|PhylomeDB|Treefam        10</span><br><span># 4 EggNOG|Ensembl|HGNC|HomoloGene|Inparanoid|NCBI|OMA|OrthoDB|OrthoMCL|Panther|PhylomeDB|Treefam        12</span><br><span># 5 EggNOG|Ensembl|HGNC|HomoloGene|Inparanoid|NCBI|OMA|OrthoDB|OrthoMCL|Panther|PhylomeDB|Treefam        12</span><br></code></pre><section><span>默认查询的物种是human，可以关闭该设置，查询其他物种基因对应的的人源基因信息：</span></section><pre><code>orthologs(genes = <span>"actc1b"</span>, species = <span>"fruit fly"</span>, human = <span>FALSE</span>)<br><span>#  human_symbol human_entrez   human_ensembl taxon_id symbol entrez     ensembl</span><br><span>#1         GCH1         2643 ENSG00000131979     7227     Pu  37415 FBgn0003162</span><br><span>#                                                                              support support_n</span><br><span>#1 EggNOG|Ensembl|HomoloGene|Inparanoid|OMA|OrthoDB|OrthoMCL|Panther|PhylomeDB|Treefam        10</span><br><br>orthologs(genes = <span>"gapdh"</span>, species = <span>"fruit fly"</span>, human = <span>FALSE</span>)<br><span>#Error in orthologs(genes = "GAPDH", species = "fruit fly", human = FALSE) : </span><br><span>#  no orthologs found or the genes are not valid</span><br><br>orthologs(genes = <span>"Gapdh"</span>, species = <span>"mouse"</span>, human = <span>FALSE</span>)<br><span>#human_symbol human_entrez   human_ensembl taxon_id symbol entrez            ensembl</span><br><span>#1        GAPDH         2597 ENSG00000111640    10090  Gapdh  14433 ENSMUSG00000057666</span><br><span>#                                                            support support_n</span><br><span>#1 Ensembl|HGNC|HomoloGene|NCBI|OMA|OrthoDB|OrthoMCL|Panther|Treefam         9</span><br></code></pre><section><span>也可以使用 NCBI Entrez 或者 Ensembl IDs 来查询：</span></section><pre><code>orthologs(genes = <span>"ENSG00000111640"</span>, species = <span>"mouse"</span>, human = <span>TRUE</span>)<br><span>#human_symbol human_entrez   human_ensembl taxon_id symbol entrez            ensembl</span><br><span>#1        GAPDH         2597 ENSG00000111640    10090  Gapdh  14433 ENSMUSG00000057666</span><br><span>#                                                            support support_n</span><br><span>#1 Ensembl|HGNC|HomoloGene|NCBI|OMA|OrthoDB|OrthoMCL|Panther|Treefam         9</span><br></code></pre><section><span>下面是babelgene包支持的物种：</span></section><pre><code>species()<br> <span>#   taxon_id                 scientific_name                                                             common_name</span><br><span># 1     28377             Anolis carolinensis                                             Carolina anole, green anole</span><br><span># 2      9913                      Bos taurus bovine, cattle, cow, dairy cow, domestic cattle, domestic cow, ox, oxen</span><br><span># 3      6239          Caenorhabditis elegans                                                                    &lt;NA&gt;</span><br><span># 4      9615          Canis lupus familiaris                                                               dog, dogs</span><br><span># 5      7955                     Danio rerio                       leopard danio, zebra danio, zebra fish, zebrafish</span><br><span># 6      7227         Drosophila melanogaster                                                               fruit fly</span><br><span># 7      9796                  Equus caballus                                           domestic horse, equine, horse</span><br><span># 8      9685                     Felis catus                                                 cat, cats, domestic cat</span><br><span># 9      9031                   Gallus gallus                            bantam, chicken, chickens, Gallus domesticus</span><br><span># 10     9544                  Macaca mulatta          rhesus macaque, rhesus macaques, Rhesus monkey, rhesus monkeys</span><br><span># 11    13616           Monodelphis domestica                                               gray short-tailed opossum</span><br><span># 12    10090                    Mus musculus                                                      house mouse, mouse</span><br><span># 13     9258        Ornithorhynchus anatinus                       duck-billed platypus, duckbill platypus, platypus</span><br><span># 14     9598                 Pan troglodytes                                                              chimpanzee</span><br><span># 15    10116               Rattus norvegicus                                        brown rat, Norway rat, rat, rats</span><br><span># 16     4932        Saccharomyces cerevisiae                            baker's yeast, brewer's yeast, S. cerevisiae</span><br><span># 17   284812 Schizosaccharomyces pombe 972h-                                                                    &lt;NA&gt;</span><br><span># 18     9823                      Sus scrofa                                             pig, pigs, swine, wild boar</span><br><span># 19     8364              Xenopus tropicalis                               tropical clawed frog, western clawed frog</span><br></code></pre><h2><span>2、<span>homologene</span></span></h2><p><span>如果是想进行其他物种的同源基因转换<span>（不仅是转换为人源基因）</span>，可以使用homologene包进行批量转换：</span></p><pre><code>install.packages(<span>'homologene'</span>)<br>packageVersion(<span>"homologene"</span>)<span>#[1] ‘1.4.68.19.3.27’</span><br><span>library</span>(homologene)<br><span>#可支持的物种如下：</span><br>homologene::taxData<br><span>#   tax_id                      name_txt</span><br><span>#1   10090                  Mus musculus</span><br><span>#2   10116             Rattus norvegicus</span><br><span>#3   28985          Kluyveromyces lactis</span><br><span>#4  318829            Magnaporthe oryzae</span><br><span>#5   33169         Eremothecium gossypii</span><br><span>#6    3702          Arabidopsis thaliana</span><br><span>#7    4530                  Oryza sativa</span><br><span>#8    4896     Schizosaccharomyces pombe</span><br><span>#9    4932      Saccharomyces cerevisiae</span><br><span>#10   5141             Neurospora crassa</span><br><span>#11   6239        Caenorhabditis elegans</span><br><span>#12   7165             Anopheles gambiae</span><br><span>#13   7227       Drosophila melanogaster</span><br><span>#14   7955                   Danio rerio</span><br><span>#15   8364 Xenopus (Silurana) tropicalis</span><br><span>#16   9031                 Gallus gallus</span><br><span>#17   9544                Macaca mulatta</span><br><span>#18   9598               Pan troglodytes</span><br><span>#19   9606                  Homo sapiens</span><br><span>#20   9615        Canis lupus familiaris</span><br><span>#21   9913                    Bos taurus</span><br></code></pre><p><span>使用homologene函数进行转换：第一个参数是要转换的基因，</span><code>inTax</code><span>是输入的基因列表所属的物种号，</span><code>outTax</code><span>是要转换成的物种号，</span><code>db</code><span>用于指定转换数据库，如果需要使用新版本的数据库，这个参数很重要。</span></p><pre><code>homologene(genes, inTax, outTax, db = homologene::homologeneData)<br></code></pre><p><span>以小鼠的基因为例。查找上表，10090是小鼠，9606是人：</span></p><pre><code>genelist &lt;- c(<span>"Acadm"</span>,<span>"Eno2"</span>,<span>"Acadvl"</span>)<br>homologene(genelist, inTax = <span>10090</span>, outTax = <span>9606</span>)<br><span>##   10090 9606 10090_ID 9606_ID</span><br><span>##1  Acadm  ACADM    11364      34</span><br><span>##2   Eno2   ENO2    13807    2026</span><br><span>##3 Acadvl ACADVL    11370      37</span><br></code></pre><p><span>对于像小鼠和人这种常见的物种，也可以使用函数</span><code>mouse2human()</code><span>和</span><code>human2mouse()</code><span>进行互相转换：</span></p><pre><code>mouse2human(genelist)<br><span># mouseGene humanGene mouseID humanID</span><br><span># 1     Acadm     ACADM   11364      34</span><br><span># 2      Eno2      ENO2   13807    2026</span><br><span># 3    Acadvl    ACADVL   11370      37</span><br>human2mouse(c(<span>"ACADM"</span>,<span>"ENO2"</span>,<span>"ACADVL"</span>))<br> <span>#  humanGene mouseGene humanID mouseID</span><br><span># 1     ACADM     Acadm      34   11364</span><br><span># 2      ENO2      Eno2    2026   13807</span><br><span># 3    ACADVL    Acadvl      37   11370</span><br></code></pre><h3><span><strong><span>使用新版本的转换数据库</span></strong></span></h3><p><span>使用更新的版本可以帮助匹配由于注释过时而无法匹配的基因。</span></p><pre><code>mouse2human(c(<span>'Mesd'</span>,<span>'Trp53rka'</span>,<span>'Cstdc4'</span>,<span>'Ifit3b'</span>))<br><span>## [1] mouseGene humanGene mouseID   humanID  </span><br><span>## &lt;0 rows&gt; (or 0-length row.names)</span><br></code></pre><section><span>需要指定新版本数据库，修改参数</span><code>db</code></section><pre><code>mouse2human(c(<span>'Mesd'</span>,<span>'Trp53rka'</span>,<span>'Cstdc4'</span>,<span>'Ifit3b'</span>),db = homologeneData2)<br><span>##   mouseGene humanGene mouseID humanID</span><br><span>## 1      Mesd      MESD   67943   23184</span><br><span>## 2  Trp53rka    TP53RK  381406  112858</span><br><span>## 3    Cstdc4      CSTA  433016    1475</span><br><span>## 4    Ifit3b     IFIT3  667370    3437</span><br></code></pre><section><span>此包的 GitHub 版本注释库每周更新一次，如果需要最新的注释，可以使用函数</span><code>updateHomologene()</code><span>获取最新信息。</span></section><section><span>下载需要时间很长，空间也比较大！！！！</span></section><pre><code>options(timeout = <span>10000</span>)<br>homologeneDataVeryNew = updateHomologene() <span># update the homologene database with the latest identifiers</span><br>mouse2human(c(<span>'Mesd'</span>,<span>'Trp53rka'</span>,<span>'Cstdc4'</span>,<span>'Ifit3b'</span>),db = homologeneDataVeryNew)<br>mouseGene humanGene mouseID humanID<br><span>##1      Mesd      MESD   67943   23184</span><br><span>##2  Trp53rka    TP53RK  381406  112858</span><br><span>##3    Cstdc4      CSTA  433016    1475</span><br><span>##4    Ifit3b     IFIT3  667370    3437</span><br></code></pre><p><span>此外，该homologene包也提供了相应函数用于更新过时的基因Symbol和identifier、访问DIOPT数据库来查找基因同源物/直系同源物等功能，详细介绍见github主页。</span></p><ul><li><section><span>https://github.com/oganm/homologene</span></section></li></ul><section><br></section><section><span></span></section><section><span></span></section><p><img data-ratio="0.05278592375366569" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/1LTeQhNfr8sUH75oYsoDaqjPCTiaukEmS8tWricW7LnLKKfIE9jKBexibqamsrlibaaXmuc2nicaYibfDFBNCmqX5mBw/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" data-type="png" data-w="341" src="https://mmbiz.qpic.cn/sz_mmbiz_png/1LTeQhNfr8sUH75oYsoDaqjPCTiaukEmS8tWricW7LnLKKfIE9jKBexibqamsrlibaaXmuc2nicaYibfDFBNCmqX5mBw/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"></p><section data-tools="135编辑器" data-id="116886" draggable="true"><section><section><section><section><strong data-brushtype="text">被炸熟的虾</strong></section></section></section><section><section><section data-width="35%"><section><img data-cropselx1="0" data-cropselx2="115" data-cropsely1="0" data-cropsely2="115" data-ratio="1" data-src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/dRYYdqiaan3JjDfj2H8p6gg3CB25AGthbwzrotao4ev5tIe0utthbZRK8yOoDOuTzOSoTSnPWn61IdDCnXsnaiag/640?wx_fmt=jpeg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" data-type="jpeg" data-w="258" data-width="100%" src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/dRYYdqiaan3JjDfj2H8p6gg3CB25AGthbwzrotao4ev5tIe0utthbZRK8yOoDOuTzOSoTSnPWn61IdDCnXsnaiag/640?wx_fmt=jpeg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"></section></section><section data-width="63%"><section><section><strong>自己的摸索，发现问题麻烦告诉作者，光速回来改正</strong><strong><img data-ratio="1" data-type="png" data-w="64" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/dRYYdqiaan3KLQGNxibvI4SdtUfxjINkz2DO8cGEPTgbcMJ357RvXJ7IvWU2p7anljpePpakI9oKu3icJxobBDp5w/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" src="https://mmbiz.qpic.cn/sz_mmbiz_png/dRYYdqiaan3KLQGNxibvI4SdtUfxjINkz2DO8cGEPTgbcMJ357RvXJ7IvWU2p7anljpePpakI9oKu3icJxobBDp5w/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"></strong></section></section></section></section></section></section></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/gjMjnfoWj9rQjiFWqEnz1w",target="_blank" rel="noopener noreferrer">原文链接</a>
