---
title: "单细胞测序最好的教程（十一）：差异表达基因分析｜或许比pseudobulk更优"
date: 2024-01-04T15:40:19Z
draft: ["false"]
tags: [
  "fetched",
  "单细胞天地"
]
categories: ["Acdemic"]
---
单细胞测序最好的教程（十一）：差异表达基因分析｜或许比pseudobulk更优 by 单细胞天地
------
<div><section data-style-type="5" data-tools="新媒体排版" data-id="2430070"><section data-style-type="5" data-tools="新媒体排版" data-id="2390348"><section><section powered-by="xiumi.us"><section><section><section powered-by="xiumi.us"><section><section><br></section><section><section><section powered-by="xiumi.us"><section><section><p>分享是一种态度</p></section></section></section></section></section></section></section></section><section><section powered-by="xiumi.us"><section><section><img data-ratio="0.8738095238095238" data-src="https://mmbiz.qpic.cn/mmbiz_gif/siaia0BDGJdjSnnb9ibXpFagGPWQ0JjSSTNVBZthROEhicfINuLcxX2Ro3Zb600LJhrzeYIb120tLjSVXEtLn14DwA/640?wx_fmt=gif" data-type="gif" data-w="420" width="100%" data-imgfileid="100035047" src="https://mmbiz.qpic.cn/mmbiz_gif/siaia0BDGJdjSnnb9ibXpFagGPWQ0JjSSTNVBZthROEhicfINuLcxX2Ro3Zb600LJhrzeYIb120tLjSVXEtLn14DwA/640?wx_fmt=gif"></section></section></section></section></section></section></section></section></section><section><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><blockquote data-tool="mdnice编辑器"><p>作者按</p><p>本章节主要讲解了单细胞数据的差异表达基因分析方法，详细对比了ttest与DEseq2在所有细胞进行差异表达分析的异同，以及为什么要使用元细胞分析的原因。本教程首发于<span>单细胞最好的中文教程</span><sup>[1]</sup>，未经授权许可，禁止转载。</p><p><span>全文字数|预计阅读时间</span>: 3000|5min</p><p>——Starlitnightly（星夜）</p></blockquote><h2 data-tool="mdnice编辑器"><span></span><span>1. 背景</span></h2><p data-tool="mdnice编辑器">我们在前面注释的章节中，研究了不同细胞的特异性marker（标记）基因，但很多时候，我们更关心在某一类细胞中，两种不同状态下的组别差异，例如药物治疗与未经药物治疗，肿瘤细胞与正常细胞（癌旁）细胞等。因此，我们希望能在单细胞水平上，进行差异表达分析。</p><figure data-tool="mdnice编辑器"><img data-imgfileid="100035123" data-ratio="0.45185185185185184" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQKJCc3sicGEXV0Crib6HPtyIv82m75ld3Hsobe0AnqeTtjqRpznYxBG4fGMl98KHT1n3wwBEen6cbg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQKJCc3sicGEXV0Crib6HPtyIv82m75ld3Hsobe0AnqeTtjqRpznYxBG4fGMl98KHT1n3wwBEen6cbg/640?wx_fmt=png&amp;from=appmsg"><figcaption>差异表达基因模型</figcaption></figure><p data-tool="mdnice编辑器">单细胞RNA-seq与批量RNA-seq数据相比，有着更强的稀疏性，例如dropout现象的普遍出现，这使得我们如果仅仅将每一个细胞视作样本进行差异表达分析，由于显著性检验的P值对于样本量的敏感度很高，因此如果使用全部细胞进行差异表达分析，那么分析结果中的显著性差异可能是不可靠的。我们在下面的对比实验会进一步说明这种现象。为了解决单细胞稀疏性与样本过大的问题，我们可以采用一种叫做伪Bulk（pseudo-bulk）的方法来聚合单细胞数据，从而进行差异表达分析。但这又引入另一个问题，最近的一项研究强调了伪Bulk的问题，其中推论统计应用于统计上不独立的生物复制。未能考虑重复（来自同一个体的细胞）的内在相关性会增加错误发现率（FDR）。因此，应在差异表达分析之前，应先应用批量效应校正或通过每个个体的总和、平均或随机效应（即伪Bulk生成）对个体内的细胞类型特异性表达值进行聚合，以解释样本内相关性。</p><p data-tool="mdnice编辑器">元细胞的概念（代表不同细胞状态的细胞组，其中元细胞内的变异是由于技术而非生物来源）被提出作为保持统计效用同时最大化有效数据分辨率的一种方式。与伪Bulk不同，SEACells 寻求以与数据模态无关的方式将单个细胞聚合成代表不同细胞状态的元细胞。使用计数矩阵作为输入，它提供每个元单元的每个单元权重、每个元单元的每个单元硬分配以及每个元单元的聚合计数作为输出，故在本教程中，我们将展示如何使用SEACells完成差异表达分析。</p><pre data-tool="mdnice编辑器"><span></span><code><span>import</span> omicverse <span>as</span> ov<br><span>import</span> scanpy <span>as</span> sc<br><span>import</span> scvelo <span>as</span> scv<br><br>ov.utils.ov_plot_set()<br></code></pre><pre data-tool="mdnice编辑器"><span></span><code>       ____            _     _    __                  <br>      / __ \____ ___  (_)___| |  / /__  _____________ <br>     / / / / __ `__ \/ / ___/ | / / _ \/ ___/ ___/ _ \ <br>    / /_/ / / / / / / / /__ | |/ /  __/ /  (__  )  __/ <br>    \____/_/ /_/ /_/_/\___/ |___/\___/_/  /____/\___/                                              <br>    <br>    Version: 1.5.5, Tutorials: https://omicverse.readthedocs.io/<br></code></pre><h2 data-tool="mdnice编辑器"><span></span><span>2. 加载数据</span></h2><p data-tool="mdnice编辑器">在这里，我们使用pertpy的演示数据Kang 数据集，它是来自 8 名狼疮患者 INF-β 治疗前后 6 小时前后的 10 倍基于 scRNA-seq 的外周血单核细胞 (PBMC) 数据（总共 16 个样本）</p><p data-tool="mdnice编辑器">下载地址：https://figshare.com/ndownloader/files/34464122</p><pre data-tool="mdnice编辑器"><span></span><code>adata = ov.read(<span>'data/kang.h5ad'</span>)<br>adata<br></code></pre><pre data-tool="mdnice编辑器"><span></span><code>    <span># AnnData object with n_obs × n_vars = 24673 × 15706</span><br>    <span>#     obs: 'nCount_RNA', 'nFeature_RNA', 'tsne1', 'tsne2', 'label', 'cluster', 'cell_type', 'replicate', 'nCount_SCT', 'nFeature_SCT', 'integrated_snn_res.0.4', 'seurat_clusters'</span><br>    <span>#     var: 'name'</span><br>    <span>#     obsm: 'X_pca', 'X_umap'</span><br></code></pre><pre data-tool="mdnice编辑器"><span></span><code>adata.X.max()<br></code></pre><p data-tool="mdnice编辑器">与别的方法不一样，我们在这里使用ttest方法计算差异表达基因，因此我们需要使用log对数化处理后的数据，因此我们对数据进行预处理</p><pre data-tool="mdnice编辑器"><span></span><code><span>#quantity control</span><br>adata=ov.pp.qc(adata,<br>              tresh={<span>'mito_perc'</span>: <span>0.2</span>, <span>'nUMIs'</span>: <span>500</span>, <span>'detected_genes'</span>: <span>250</span>})<br><span>#normalize and high variable genes (HVGs) calculated</span><br>adata=ov.pp.preprocess(adata,mode=<span>'shiftlog|pearson'</span>,n_HVGs=<span>2000</span>,)<br><br><span>#save the whole genes and filter the non-HVGs</span><br>adata.raw = adata<br>adata = adata[:, adata.var.highly_variable_features]<br><br><span>#scale the adata.X</span><br>ov.pp.scale(adata)<br><br><span>#Dimensionality Reduction</span><br>ov.pp.pca(adata,layer=<span>'scaled'</span>,n_pcs=<span>50</span>)<br><br>adata.obsm[<span>'X_mde'</span>]=ov.utils.mde(adata.obsm[<span>'scaled|original|X_pca'</span>])<br></code></pre><pre data-tool="mdnice编辑器"><span></span><code>ov.utils.embedding(adata,<br>                   basis=<span>'X_mde'</span>,<br>                    frameon=<span>'small'</span>,<br>                   color=[<span>'replicate'</span>,<span>'label'</span>,<span>'cell_type'</span>])<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100035122" data-ratio="0.2657407407407407" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQKJCc3sicGEXV0Crib6HPtyImpnH88Dnx2thaBbu63IXA7P7BX4gE12CCua9MBBvRyzCepDJfvCoHg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQKJCc3sicGEXV0Crib6HPtyImpnH88Dnx2thaBbu63IXA7P7BX4gE12CCua9MBBvRyzCepDJfvCoHg/640?wx_fmt=png&amp;from=appmsg"><figcaption>降维可视化图</figcaption></figure><h2 data-tool="mdnice编辑器"><span></span><span>3. 批次效应的校正</span></h2><p data-tool="mdnice编辑器">我们发现数据存在着一定的批次效应，我们这里使用scVU进行批次效应的校正。当然，你也可以使用别的方法，如harmony等，更多的批次效应校正的方法见omicverse的教程：https://omicverse.readthedocs.io/en/latest/Tutorials-single/t_single_batch/</p><pre data-tool="mdnice编辑器"><span></span><code>adata=ov.single.batch_correction(adata,batch_key=<span>'replicate'</span>,<br>                           methods=<span>'scVI'</span>,n_layers=<span>2</span>, n_latent=<span>30</span>, gene_likelihood=<span>"nb"</span>)<br>adata.obsm[<span>"X_mde_scVI"</span>] = ov.utils.mde(adata.obsm[<span>"X_scVI"</span>])<br></code></pre><pre data-tool="mdnice编辑器"><span></span><code><span>#     ...Begin using scVI to correct batch effect</span><br><br><br><span>#     GPU available: True (cuda), used: True</span><br><span>#     TPU available: False, using: 0 TPU cores</span><br><span>#     IPU available: False, using: 0 IPUs</span><br><span>#     HPU available: False, using: 0 HPUs</span><br><span>#     LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]</span><br><br><br><span>#     Epoch 326/326: 100%|██████████| 326/326 [13:22&lt;00:00,  2.47s/it, loss=599, v_num=1]</span><br>    <br><span>#     `Trainer.fit` stopped: `max_epochs=326` reached.</span><br><br><br><span>#     Epoch 326/326: 100%|██████████| 326/326 [13:22&lt;00:00,  2.46s/it, loss=599, v_num=1]</span><br><br><br><br><span># ```python</span><br><span># ov.utils.embedding(adata,</span><br><span>#                    basis='X_mde_scVI',</span><br><span>#                     frameon='small',</span><br><span>#                    color=['replicate','label','cell_type'])</span><br><br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100035121" data-ratio="0.2657407407407407" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQKJCc3sicGEXV0Crib6HPtyIQtZbLy6jSewMbpU3CKHZ5H3JQ1pHADnTrd6C3n2Ys52dWMF9S2u3Xw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQKJCc3sicGEXV0Crib6HPtyIQtZbLy6jSewMbpU3CKHZ5H3JQ1pHADnTrd6C3n2Ys52dWMF9S2u3Xw/640?wx_fmt=png&amp;from=appmsg"><figcaption>批次效应校正图</figcaption></figure><h2 data-tool="mdnice编辑器"><span></span><span>4. 差异表达分析（全细胞水平）</span></h2><p data-tool="mdnice编辑器">在使用元细胞分析前，我想先使用全细胞水平进行分析，以展示全细胞水平下的差异表达分析效果，在教程中，我们只分析CD4 T cells的差异表达基因，希望能通过CD4 T cells的差异来表明治疗前后免疫应答响应的变化。</p><p data-tool="mdnice编辑器">我们这里可以使用ttest或者是DESeq2两种模型，两种模型的效果我将分别演示：</p><h3 data-tool="mdnice编辑器"><span></span><span>4.1 基于ttest进行差异表达分析</span><span></span></h3><p data-tool="mdnice编辑器">对于ttest统计方法而言，数据要求满足正态分布的基本形式。中心极限定理，是指概率论中讨论随机变量和分布渐近于正态分布的定理，是数理统计学和误差分析的理论基础，指出了大量随机变量近似服从正态分布的条件。故我们使用原数据的对数标准化后的内容，来进行差异表达分析。</p><pre data-tool="mdnice编辑器"><span></span><code>test_adata=adata[adata.obs[<span>'cell_type'</span>].isin([<span>'CD4 T cells'</span>])]<br>dds=ov.bulk.pyDEG(test_adata.to_df(layer=<span>'lognorm'</span>).T)<br>dds.drop_duplicates_index()<br>print(<span>'... drop_duplicates_index success'</span>)<br></code></pre><pre data-tool="mdnice编辑器"><span></span><code>    <span># ... drop_duplicates_index success</span><br></code></pre><p data-tool="mdnice编辑器">我们选取label分别为<code>Ctrl</code>与<code>Stim</code>作为需要进行差异分析的两个组别</p><pre data-tool="mdnice编辑器"><span></span><code>treatment_groups=test_adata.obs[test_adata.obs[<span>'label'</span>]==<span>'stim'</span>].index.tolist()<br>control_groups=test_adata.obs[test_adata.obs[<span>'label'</span>]==<span>'ctrl'</span>].index.tolist()<br>dds.deg_analysis(treatment_groups,control_groups,method=<span>'ttest'</span>)<br></code></pre><p data-tool="mdnice编辑器">并且我们不指定差异表达倍数，由算法根据数据的分布自动计算合适的阈值</p><pre data-tool="mdnice编辑器"><span></span><code><span># -1 means automatically calculates</span><br>dds.foldchange_set(fc_threshold=<span>-1</span>,<br>                   pval_threshold=<span>0.05</span>,<br>                   logp_max=<span>10</span>)<br></code></pre><pre data-tool="mdnice编辑器"><span></span><code>    <span># ... Fold change threshold: 0.8351151943206787</span><br></code></pre><p data-tool="mdnice编辑器">我们使用自带的火山图函数<code>plot_volcano</code>来观察差异表达基因的分布</p><pre data-tool="mdnice编辑器"><span></span><code>dds.plot_volcano(title=<span>'DEG Analysis'</span>,figsize=(<span>4</span>,<span>4</span>),<br>                 plot_genes_num=<span>8</span>,plot_genes_fontsize=<span>12</span>,)<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100035120" data-ratio="1.1396468699839486" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQKJCc3sicGEXV0Crib6HPtyIDR9IZWHHI3I12WoiatUFfbvZGOOc1WC9X4iaAAYk9ZksffPkibWe328jw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="623" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQKJCc3sicGEXV0Crib6HPtyIDR9IZWHHI3I12WoiatUFfbvZGOOc1WC9X4iaAAYk9ZksffPkibWe328jw/640?wx_fmt=png&amp;from=appmsg"><figcaption>火山图1</figcaption></figure><p data-tool="mdnice编辑器">我们还可以使用自带的箱线图函数<code>plot_boxplot</code>来观察差异表达基因在不同组的差异情况</p><pre data-tool="mdnice编辑器"><span></span><code>dds.plot_boxplot(genes=[<span>'NELL2'</span>,<span>'TNFSF13B'</span>],treatment_groups=treatment_groups,<br>                control_groups=control_groups,figsize=(<span>2</span>,<span>3</span>),fontsize=<span>12</span>,<br>                 legend_bbox=(<span>2</span>,<span>0.55</span>))<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100035119" data-ratio="0.8280701754385965" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQKJCc3sicGEXV0Crib6HPtyIe0eGLTSotxKkINjn5xjbvFStkRRSFMURjzttyFa3nlPXzLXhdxgwtw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="570" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQKJCc3sicGEXV0Crib6HPtyIe0eGLTSotxKkINjn5xjbvFStkRRSFMURjzttyFa3nlPXzLXhdxgwtw/640?wx_fmt=png&amp;from=appmsg"><figcaption>箱线图1</figcaption></figure><p data-tool="mdnice编辑器">除此之外，我们还可以在低维流型图umap中，观察差异表达基因在不同组的分布情况</p><pre data-tool="mdnice编辑器"><span></span><code>ov.utils.embedding(test_adata,<br>                   basis=<span>'X_mde_scVI'</span>,<br>                    frameon=<span>'small'</span>,<br>                   color=[<span>'label'</span>,<span>'NELL2'</span>,<span>'TNFSF13B'</span>])<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100035126" data-ratio="0.30185185185185187" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQKJCc3sicGEXV0Crib6HPtyIFwfG8qiaiaosFjPDAOvUBAgicDEAYqMIvtqMTzMLIJnDMkE19ccke94icA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQKJCc3sicGEXV0Crib6HPtyIFwfG8qiaiaosFjPDAOvUBAgicDEAYqMIvtqMTzMLIJnDMkE19ccke94icA/640?wx_fmt=png&amp;from=appmsg"><figcaption>降维图1</figcaption></figure><h3 data-tool="mdnice编辑器"><span></span><span>4.2 基于DEseq2进行差异表达分析</span><span></span></h3><p data-tool="mdnice编辑器">DEseq2被广泛使用在差异表达分析的各种场合，得益于其负二项分布模型的设计。使得我们可以使用原始计数Counts进行直接分析。DESeq2将对原始reads进行建模，使用标准化因子(scale factor)来解释库深度的差异。然后，DESeq2估计基因的离散度，并缩小这些估计值以生成更准确的离散度估计，从而对reads count进行建模。最后，DESeq2拟合负二项分布的模型，并使用Wald检验或似然比检验进行假设检验。</p><p data-tool="mdnice编辑器">与ttest不同，使用DEseq2时不用考虑数据与正态分布之间的关系，也不用考虑数据特征。</p><pre data-tool="mdnice编辑器"><span></span><code>test_adata=adata[adata.obs[<span>'cell_type'</span>].isin([<span>'CD4 T cells'</span>])]<br>dds=ov.bulk.pyDEG(test_adata.to_df(layer=<span>'counts'</span>).T)<br>dds.drop_duplicates_index()<br>print(<span>'... drop_duplicates_index success'</span>)<br><br>treatment_groups=test_adata.obs[test_adata.obs[<span>'label'</span>]==<span>'stim'</span>].index.tolist()<br>control_groups=test_adata.obs[test_adata.obs[<span>'label'</span>]==<span>'ctrl'</span>].index.tolist()<br>dds.deg_analysis(treatment_groups,control_groups,method=<span>'DEseq2'</span>)<br></code></pre><pre data-tool="mdnice编辑器"><span></span><code>    <span># ... drop_duplicates_index success</span><br>    <span># Fitting size factors...</span><br>    <span># ... done in 0.20 seconds.</span><br>    <br>    <span># Fitting dispersions...</span><br>    <span># ... done in 3.69 seconds.</span><br>    <br>    <span># Fitting dispersion trend curve...</span><br>    <span># ... done in 0.60 seconds.</span><br>    <br>    <span># logres_prior=nan, sigma_prior=nan</span><br>    <span># Fitting MAP dispersions...</span><br>    <span># ... done in 73.18 seconds.</span><br>    <br>    <span># Fitting LFCs...</span><br>    <span># ... done in 299.53 seconds.</span><br>    <br>    <span># Refitting 5 outliers.</span><br>    <br>    <span># Fitting dispersions...</span><br>    <span># ... done in 0.09 seconds.</span><br>    <br>    <span># Fitting MAP dispersions...</span><br>    <span># ... done in 0.23 seconds.</span><br>    <br>    <span># Fitting LFCs...</span><br>    <span># ... done in 0.70 seconds.</span><br>    <br>    <span># Running Wald tests...</span><br>    <span># ... done in 71.47 seconds.</span><br>    <br>    <span># Log2 fold change &amp; Wald test p-value: condition Treatment vs Control</span><br><br></code></pre><pre data-tool="mdnice编辑器"><span></span><code><span># -1 means automatically calculates</span><br>dds.foldchange_set(fc_threshold=<span>1.2</span>,<br>                   pval_threshold=<span>0.05</span>,<br>                   logp_max=<span>10</span>)<br></code></pre><pre data-tool="mdnice编辑器"><span></span><code>    <span>#... Fold change threshold: 1.2</span><br></code></pre><pre data-tool="mdnice编辑器"><span></span><code>dds.plot_volcano(title=<span>'DEG Analysis'</span>,figsize=(<span>4</span>,<span>4</span>),<br>                 plot_genes_num=<span>8</span>,plot_genes_fontsize=<span>12</span>,)<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100035125" data-ratio="1.136" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQKJCc3sicGEXV0Crib6HPtyIrvQhk8iceSow4D5sy7EU2jOhoPt1khAUI8WCpaD5iaIp2eXPsp8zauKQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="625" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQKJCc3sicGEXV0Crib6HPtyIrvQhk8iceSow4D5sy7EU2jOhoPt1khAUI8WCpaD5iaIp2eXPsp8zauKQ/640?wx_fmt=png&amp;from=appmsg"><figcaption>火山图2</figcaption></figure><pre data-tool="mdnice编辑器"><span></span><code>dds.plot_boxplot(genes=[<span>'IFI6'</span>,<span>'RGCC'</span>],treatment_groups=treatment_groups,<br>                control_groups=control_groups,figsize=(<span>2</span>,<span>3</span>),fontsize=<span>12</span>,<br>                 legend_bbox=(<span>2</span>,<span>0.55</span>))<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100035124" data-ratio="0.8280701754385965" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQKJCc3sicGEXV0Crib6HPtyI8PSr92Ggfan0mN6zoQgTfuKiahLv1kGvhI9kTCicR6UiaicGKJVMMicEYQw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="570" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQKJCc3sicGEXV0Crib6HPtyI8PSr92Ggfan0mN6zoQgTfuKiahLv1kGvhI9kTCicR6UiaicGKJVMMicEYQw/640?wx_fmt=png&amp;from=appmsg"><figcaption>箱线图2</figcaption></figure><pre data-tool="mdnice编辑器"><span></span><code>ov.utils.embedding(test_adata,<br>                   basis=<span>'X_mde_scVI'</span>,<br>                    frameon=<span>'small'</span>,<br>                   color=[<span>'label'</span>,<span>'IFI6'</span>,<span>'RGCC'</span>])<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100035128" data-ratio="0.30185185185185187" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQKJCc3sicGEXV0Crib6HPtyIeuXnRuPwgXOzPibItno6RSVvib4pHvKqwuDV67et5O5fib4dibnYVq5Qfg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQKJCc3sicGEXV0Crib6HPtyIeuXnRuPwgXOzPibItno6RSVvib4pHvKqwuDV67et5O5fib4dibnYVq5Qfg/640?wx_fmt=png&amp;from=appmsg"><figcaption>降维图2</figcaption></figure><h2 data-tool="mdnice编辑器"><span></span><span>5. 基于元细胞的差异表达分析</span></h2><p data-tool="mdnice编辑器">我们可以看到，无论是使用ttest与DEseq2，都可以一定程度上计算出两个组别的细胞差异表达基因，并且也确实在两个组别中实现了分离。但是，这也带来了大量的生物学噪音。两种细胞并没有实现非常完美的分离，差异表达基因的表达在两类细胞中也有着一定的丰度。</p><p data-tool="mdnice编辑器">为了解决这一问题，扩大样本（细胞）的深度，我们使用SEACells聚合细胞，然后在元细胞水平上，执行差异表达分析。值得一提的是，SEACells聚合的元细胞在信号聚合和细胞分辨率之间实现了最佳平衡，并且它们捕获整个表型谱中的细胞状态，包括罕见状态。元细胞保留了样本之间微妙的生物学差异，这些差异通过替代方法作为批次效应被消除，因此，为数据集成提供了比稀疏单个细胞更好的起点。</p><h3 data-tool="mdnice编辑器"><span></span><span>5.1 元细胞初始化</span><span></span></h3><p data-tool="mdnice编辑器">在这里，我们使用<code>scVI</code>作为元细胞特征向量的初始化，你也可以使用<code>X_pca</code>或者是omicverse计算得到的<code>scaled|original|X_pca</code>来作为元细胞的初始输入。</p><pre data-tool="mdnice编辑器"><span></span><code>meta_obj=ov.single.MetaCell(adata,use_rep=<span>'X_scVI'</span>,n_metacells=<span>250</span>,<br>                           use_gpu=<span>True</span>)<br></code></pre><hr data-tool="mdnice编辑器"><pre data-tool="mdnice编辑器"><span></span><code>    <span># Welcome to SEACells GPU!</span><br>    <span># Computing kNN graph using scanpy NN ...</span><br>    <span># computing neighbors</span><br>    <span>#     finished: added to `.uns['neighbors']`</span><br>    <span>#     `.obsp['distances']`, distances for each pair of neighbors</span><br>    <span>#     `.obsp['connectivities']`, weighted adjacency matrix (0:00:03)</span><br>    <span># Computing radius for adaptive bandwidth kernel...</span><br><br><br><br>    <span>#   0%|          | 0/24528 [00:00&lt;?, ?it/s]</span><br><br><br>    <span># Making graph symmetric...</span><br>    <span># Parameter graph_construction = union being used to build KNN graph...</span><br>    <span># Computing RBF kernel...</span><br><br><br><br>    <span>#   0%|          | 0/24528 [00:00&lt;?, ?it/s]</span><br><br><br>    <span># Building similarity LIL matrix...</span><br><br><br><br>    <span>#   0%|          | 0/24528 [00:00&lt;?, ?it/s]</span><br><br><br>    <span># Constructing CSR matrix...</span><br><br></code></pre><p data-tool="mdnice编辑器">我们需要初始化元细胞的原型，也就是其在特征空间scVI上的初始位置，这里可能有一些难理解，如果我们在umap图上来理解的话，可以表示为umap图上的元细胞的位置，或许会更加通俗一些。</p><pre data-tool="mdnice编辑器"><span></span><code>meta_obj.initialize_archetypes()<br></code></pre><pre data-tool="mdnice编辑器"><span></span><code>    <span># Building kernel on X_scVI</span><br>    <span># Computing diffusion components from X_scVI for waypoint initialization ... </span><br>    <span># computing neighbors</span><br>    <span>#     finished: added to `.uns['neighbors']`</span><br>    <span>#     `.obsp['distances']`, distances for each pair of neighbors</span><br>    <span>#     `.obsp['connectivities']`, weighted adjacency matrix (0:00:02)</span><br>    <span># Done.</span><br>    <span># Sampling waypoints ...</span><br>    <span># Done.</span><br>    <span># Selecting 239 cells from waypoint initialization.</span><br>    <span># Initializing residual matrix using greedy column selection</span><br>    <span># Initializing f and g...</span><br><br><br>    <span># 100%|██████████| 21/21 [00:00&lt;00:00, 42.44it/s]</span><br>    <br>    <span># Selecting 11 cells from greedy initialization.</span><br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span>5.2 元细胞模型训练</span><span></span></h3><p data-tool="mdnice编辑器">初始完模型结构后，我们就需要对元细胞进行聚合，在这里我们通过训练SEACells模型来完成这一目的</p><pre data-tool="mdnice编辑器"><span></span><code>meta_obj.train(min_iter=<span>10</span>, max_iter=<span>50</span>)<br></code></pre><pre data-tool="mdnice编辑器"><span></span><code>    <span># Randomly initialized A matrix.</span><br>    <span># Setting convergence threshold at 0.28753</span><br>    <span># Starting iteration 1.</span><br>    <span># Completed iteration 1.</span><br>    <span># Converged after 8 iterations.</span><br>    <span># Converged after 9 iterations.</span><br>    <span># Starting iteration 10.</span><br>    <span># Completed iteration 10.</span><br>    <span># Converged after 10 iterations.</span><br></code></pre><p data-tool="mdnice编辑器">我们提供了一个保存与读取函数，避免重复计算</p><pre data-tool="mdnice编辑器"><span></span><code>meta_obj.save(<span>'seacells/model.pkl'</span>)<br>meta_obj.load(<span>'seacells/model.pkl'</span>)<br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span>5.3 预测元细胞</span><span></span></h3><p data-tool="mdnice编辑器">我们可以使用 <code>predicted</code> 来预测原始 scRNA-seq 数据的元胞。有两种方法可供选择，一种是 "soft"方法，另一种是 "hard"方法。</p><p data-tool="mdnice编辑器">在 "soft"方法中，汇总每个 SEACell 中的细胞，对所有原始数据求和 x 为属于一个 SEACell 的所有细胞分配权重。数据未标准化，伪原始聚合计数存储在 .layer['raw']中。与变量（.var）相关的属性会被复制过来，但每个 SEACell 的相关属性必须手动复制，因为某些属性可能需要求和或取平均值等，具体取决于属性。</p><p data-tool="mdnice编辑器">在 "hard"方法中，汇总每个 SEACell 中的单元格，对属于一个 SEACell 的所有单元格的所有原始数据求和。数据未经标准化处理，原始汇总计数存储在 .layer['raw']中。与变量（.var）相关的属性会被复制过来，但每个 SEACell 的相关属性必须手动复制，因为某些属性可能需要求和或取平均值等，具体取决于属性。</p><p data-tool="mdnice编辑器">我们首先需要串联细胞类型(cell_type)与组别(label)的标签用于预测。</p><pre data-tool="mdnice编辑器"><span></span><code>meta_obj.adata.obs[<span>'celltype-label'</span>]=[i+<span>'-'</span>+j <span>for</span> i,j <span>in</span> zip(meta_obj.adata.obs[<span>'cell_type'</span>],<br>                                                           meta_obj.adata.obs[<span>'label'</span>])]<br></code></pre><pre data-tool="mdnice编辑器"><span></span><code>ad=meta_obj.predicted(method=<span>'soft'</span>,celltype_label=<span>'celltype-label'</span>,<br>                     summarize_layer=<span>'lognorm'</span>)<br></code></pre><pre data-tool="mdnice编辑器"><span></span><code>  <span>#  100%|██████████| 250/250 [01:03&lt;00:00,  3.94it/s]</span><br></code></pre><pre data-tool="mdnice编辑器"><span></span><code>ad<br></code></pre><pre data-tool="mdnice编辑器"><span></span><code>    <span># AnnData object with n_obs × n_vars = 250 × 2000</span><br>    <span>#     obs: 'Pseudo-sizes', 'celltype', 'celltype_purity'</span><br></code></pre><pre data-tool="mdnice编辑器"><span></span><code><span>import</span> matplotlib.pyplot <span>as</span> plt<br>fig, ax = plt.subplots(figsize=(<span>4</span>,<span>4</span>))<br>ov.utils.embedding(<br>    meta_obj.adata,<br>    basis=<span>"X_mde_scVI"</span>,<br>    color=[<span>'cell_type'</span>],<br>    frameon=<span>'small'</span>,<br>    title=<span>"Meta cells"</span>,<br>    <span>#legend_loc='on data',</span><br>    legend_fontsize=<span>14</span>,<br>    legend_fontoutline=<span>2</span>,<br>    size=<span>10</span>,<br>    ax=ax,<br>    alpha=<span>0.2</span>,<br>    <span>#legend_loc='', </span><br>    add_outline=<span>False</span>, <br>    <span>#add_outline=True,</span><br>    outline_color=<span>'black'</span>,<br>    outline_width=<span>1</span>,<br>    show=<span>False</span>,<br>    <span>#palette=ov.utils.blue_color[:],</span><br>    <span>#legend_fontweight='normal'</span><br>)<br>ov.single._metacell.plot_metacells(ax,meta_obj.adata,<br>                                   use_rep=<span>'X_mde_scVI'</span>,color=<span>'#CB3E35'</span>,<br>                                  )<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100035127" data-ratio="0.6248648648648648" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQKJCc3sicGEXV0Crib6HPtyIlamzJJ7QdBJpxjaytk3ur3u2U0moupCUHgdJCJExO4uPfzFwvCxbJg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="925" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQKJCc3sicGEXV0Crib6HPtyIlamzJJ7QdBJpxjaytk3ur3u2U0moupCUHgdJCJExO4uPfzFwvCxbJg/640?wx_fmt=png&amp;from=appmsg"><figcaption>元细胞图</figcaption></figure><pre data-tool="mdnice编辑器"><span></span><code>sc.pp.highly_variable_genes(ad,  n_top_genes=<span>1500</span>, inplace=<span>True</span>)<br>sc.tl.pca(ad, use_highly_variable=<span>True</span>)<br>sc.pp.neighbors(ad, use_rep=<span>'X_pca'</span>)<br>sc.tl.umap(ad)<br></code></pre><pre data-tool="mdnice编辑器"><span></span><code>    <span># If you pass `n_top_genes`, all cutoffs are ignored.</span><br>    <span># extracting highly variable genes</span><br>    <span>#     finished (0:00:00)</span><br>    <span># --&gt; added</span><br>    <span>#     'highly_variable', boolean vector (adata.var)</span><br>    <span>#     'means', float vector (adata.var)</span><br>    <span>#     'dispersions', float vector (adata.var)</span><br>    <span>#     'dispersions_norm', float vector (adata.var)</span><br>    <span># computing PCA</span><br>    <span>#     on highly variable genes</span><br>    <span>#     with n_comps=50</span><br>    <span>#     finished (0:00:00)</span><br>    <span># computing neighbors</span><br>    <span>#     finished: added to `.uns['neighbors']`</span><br>    <span>#     `.obsp['distances']`, distances for each pair of neighbors</span><br>    <span>#     `.obsp['connectivities']`, weighted adjacency matrix (0:00:00)</span><br>    <span># computing UMAP</span><br>    <span>#     finished: added</span><br>    <span>#     'X_umap', UMAP coordinates (adata.obsm) (0:00:00)</span><br><br></code></pre><pre data-tool="mdnice编辑器"><span></span><code><span>import</span> matplotlib.pyplot <span>as</span> plt<br><span>from</span> matplotlib <span>import</span> patheffects<br>fig, ax = plt.subplots(figsize=(<span>4</span>,<span>4</span>))<br>ov.utils.embedding(<br>    ad,<br>    basis=<span>"X_umap"</span>,<br>    color=[<span>'celltype'</span>],<br>    frameon=<span>'small'</span>,<br>    title=<span>"metacells celltypes"</span>,<br>    <span>#legend_loc='on data',</span><br>    legend_fontsize=<span>14</span>,<br>    legend_fontoutline=<span>2</span>,<br>    <span>#size=10,</span><br>    ax=ax,<br>    legend_loc=<span>None</span>, add_outline=<span>False</span>, <br>    <span>#add_outline=True,</span><br>    outline_color=<span>'black'</span>,<br>    outline_width=<span>1</span>,<br>    show=<span>False</span>,<br>    <span>#palette=ov.palette()[12:],</span><br>    <span>#legend_fontweight='normal'</span><br>)<br>ov.utils.gen_mpl_labels(<br>    ad,<br>    <span>'celltype'</span>,<br>    exclude=(<span>"None"</span>,),  <br>    basis=<span>'X_umap'</span>,<br>    ax=ax,<br>    adjust_kwargs=dict(arrowprops=dict(arrowstyle=<span>'-'</span>, color=<span>'black'</span>)),<br>    text_kwargs=dict(fontsize= <span>12</span> ,weight=<span>'bold'</span>,<br>                     path_effects=[patheffects.withStroke(linewidth=<span>2</span>, foreground=<span>'w'</span>)] ),<br>)<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100035130" data-ratio="1.0433212996389891" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQKJCc3sicGEXV0Crib6HPtyImOfibSiaYcBEM1bz3ElYcAn5NhYGbPLeLXFxBe0DelIrvdzHEetxJdXg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="554" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQKJCc3sicGEXV0Crib6HPtyImOfibSiaYcBEM1bz3ElYcAn5NhYGbPLeLXFxBe0DelIrvdzHEetxJdXg/640?wx_fmt=png&amp;from=appmsg"><figcaption>元细胞可视化</figcaption></figure><pre data-tool="mdnice编辑器"><span></span><code>test_adata=ad[ad.obs[<span>'celltype'</span>].isin([<span>'CD4 T cells-stim'</span>,<span>'CD4 T cells-ctrl'</span>])]<br>dds_meta=ov.bulk.pyDEG(test_adata.to_df().T)<br>dds_meta.drop_duplicates_index()<br>print(<span>'... drop_duplicates_index success'</span>)<br><br>treatment_groups=test_adata.obs[test_adata.obs[<span>'celltype'</span>]==<span>'CD4 T cells-stim'</span>].index.tolist()<br>control_groups=test_adata.obs[test_adata.obs[<span>'celltype'</span>]==<span>'CD4 T cells-ctrl'</span>].index.tolist()<br>dds_meta.deg_analysis(treatment_groups,control_groups,method=<span>'ttest'</span>)<br><br><span># -1 means automatically calculates</span><br>dds_meta.foldchange_set(fc_threshold=<span>-1</span>,<br>                   pval_threshold=<span>0.05</span>,<br>                   logp_max=<span>10</span>)<br></code></pre><pre data-tool="mdnice编辑器"><span></span><code>   <span># ... drop_duplicates_index success</span><br>   <span># ... Fold change threshold: 1.4815978396550413</span><br></code></pre><pre data-tool="mdnice编辑器"><span></span><code>dds_meta.plot_volcano(title=<span>'DEG Analysis'</span>,figsize=(<span>4</span>,<span>4</span>),<br>                 plot_genes_num=<span>8</span>,plot_genes_fontsize=<span>12</span>,)<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100035131" data-ratio="1.1396468699839486" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQKJCc3sicGEXV0Crib6HPtyIQr0wJibFFlLKPNMwMAYkM78ibDA5pBOpe19xYaricSI8GFGQUsdHl78Kw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="623" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQKJCc3sicGEXV0Crib6HPtyIQr0wJibFFlLKPNMwMAYkM78ibDA5pBOpe19xYaricSI8GFGQUsdHl78Kw/640?wx_fmt=png&amp;from=appmsg"><figcaption>火山图3</figcaption></figure><pre data-tool="mdnice编辑器"><span></span><code>dds_meta.plot_boxplot(genes=[<span>'IFIT1'</span>,<span>'OSCP1'</span>],treatment_groups=treatment_groups,<br>                control_groups=control_groups,figsize=(<span>2</span>,<span>3</span>),fontsize=<span>12</span>,<br>                 legend_bbox=(<span>2</span>,<span>0.55</span>))<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100035129" data-ratio="0.8280701754385965" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQKJCc3sicGEXV0Crib6HPtyIicQfaxqeav0aAMnibuzluVupDfJ5zLg9iaVxeMFwS4icPk6j5w2HQsl61Q/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="570" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQKJCc3sicGEXV0Crib6HPtyIicQfaxqeav0aAMnibuzluVupDfJ5zLg9iaVxeMFwS4icPk6j5w2HQsl61Q/640?wx_fmt=png&amp;from=appmsg"><figcaption>箱线图3</figcaption></figure><pre data-tool="mdnice编辑器"><span></span><code>ov.utils.embedding(test_adata,<br>                   basis=<span>'X_umap'</span>,<br>                    frameon=<span>'small'</span>,<br>                   color=[<span>'IFIT1'</span>,<span>'OSCP1'</span>,<span>'celltype'</span>],<br>                  cmap=<span>'RdBu_r'</span>)<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100035133" data-ratio="0.275" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQKJCc3sicGEXV0Crib6HPtyIke6yedYficReVqWr145NTl9dZHT1wkNw9uPPibnr77NLS44vnIpkRwAA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQKJCc3sicGEXV0Crib6HPtyIke6yedYficReVqWr145NTl9dZHT1wkNw9uPPibnr77NLS44vnIpkRwAA/640?wx_fmt=png&amp;from=appmsg"><figcaption>降维图3</figcaption></figure><pre data-tool="mdnice编辑器"><span></span><code>ov.utils.embedding(adata,<br>                   basis=<span>'X_mde_scVI'</span>,<br>                    frameon=<span>'small'</span>,<br>                   color=[<span>'label'</span>,<span>'IFIT1'</span>,<span>'OSCP1'</span>])<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100035132" data-ratio="0.30185185185185187" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQKJCc3sicGEXV0Crib6HPtyIAA7dvYkosZic8jLdz7FibaPHcqWO9qhJDv5s4MvHOx8R2CicNd9CJcOng/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQKJCc3sicGEXV0Crib6HPtyIAA7dvYkosZic8jLdz7FibaPHcqWO9qhJDv5s4MvHOx8R2CicNd9CJcOng/640?wx_fmt=png&amp;from=appmsg"><figcaption>降维图4</figcaption></figure><p data-tool="mdnice编辑器">我们发现，IFIT1和OSCP1分别在stim和ctrl组中特异性下调与上调，其中IFIT1编码一种含有四肽重复序列的蛋白质，最初被鉴定为干扰素治疗诱导的。元细胞显示出了更优的差异基因的识别优势，并且排除了dropout的干扰，我们对比箱线图可得到相同的观点。</p><pre data-tool="mdnice编辑器"><span></span><code>test_adata=adata[adata.obs[<span>'cell_type'</span>].isin([<span>'CD4 T cells'</span>])]<br>treatment_groups=test_adata.obs[test_adata.obs[<span>'label'</span>]==<span>'stim'</span>].index.tolist()<br>control_groups=test_adata.obs[test_adata.obs[<span>'label'</span>]==<span>'ctrl'</span>].index.tolist()<br>dds.plot_boxplot(genes=[<span>'IFIT1'</span>,<span>'OSCP1'</span>],treatment_groups=treatment_groups,<br>                control_groups=control_groups,figsize=(<span>2</span>,<span>3</span>),fontsize=<span>12</span>,<br>                 legend_bbox=(<span>2</span>,<span>0.55</span>))<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100035138" data-ratio="0.8280701754385965" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQKJCc3sicGEXV0Crib6HPtyIicia247rNsuP5NiaYj4TOOHx17qT3RTRGVd8tBaq0LZQ2guXAZhxCIbNA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="570" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQKJCc3sicGEXV0Crib6HPtyIicia247rNsuP5NiaYj4TOOHx17qT3RTRGVd8tBaq0LZQ2guXAZhxCIbNA/640?wx_fmt=png&amp;from=appmsg"><figcaption>箱线图4</figcaption></figure><h2 data-tool="mdnice编辑器"><span></span><span>5. 总结</span></h2><p data-tool="mdnice编辑器">我们在对单细胞数据进行差异表达分析的时候，可以从<code>全细胞</code>和<code>元细胞</code>两个角度去考虑，通常来说为了避免生物学噪音和dropout的干扰，我们会选择元细胞作为分析策略来进行。但更多时候，我们会同时使用两种方法，并进行相互印证，来表明分析的准确性与可靠性。</p><h2 data-tool="mdnice编辑器"><span></span><span>6. 思考</span></h2><ul data-tool="mdnice编辑器"><li><section>我们为什么要使用元细胞来进行差异表达分析？</section></li><li><section>ttest与DESeq2的差异表达分析结果有什么不同？</section></li></ul><hr data-tool="mdnice编辑器"><h3 data-tool="mdnice编辑器"><span><span>文中链接</span></span></h3><section data-tool="mdnice编辑器"><span><span>[1]</span><p>单细胞最好的中文教程: <em>https://single-cell-tutorial.readthedocs.io/zh/latest/</em></p></span></section></section><p><br></p><section data-style-type="5" data-tools="新媒体排版" data-id="2440476"><section><section><section><section><img data-imgfileid="100035046" data-ratio="0.9495798319327731" data-src="https://mmbiz.qpic.cn/mmbiz_gif/09gp6SvPE04j3m2v7Hr889icHUyibTOHs8YuUibicl7ibRD0ZwG5pDTjBluRreZvuib1o3BibvLkicYhnA4YW7dQsjn0cA/640?wx_fmt=gif" data-type="gif" data-w="119" data-width="100%" src="https://mmbiz.qpic.cn/mmbiz_gif/09gp6SvPE04j3m2v7Hr889icHUyibTOHs8YuUibicl7ibRD0ZwG5pDTjBluRreZvuib1o3BibvLkicYhnA4YW7dQsjn0cA/640?wx_fmt=gif"></section><section data-brushtype="text">往期回顾</section><section><br></section></section></section></section><section><section data-autoskip="1"><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247515825&amp;idx=2&amp;sn=5122e66e005b04194ee21569d8c8245f&amp;chksm=ea1cb833dd6b312560d4da99a3ed73c7110d5ce84ae71bb8f9d3ab565de3f077521f0ff04ad0&amp;scene=21#wechat_redirect" textvalue="单细胞测序最好的教程（十）：万能的Transformer与细胞注释" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2"><span>单细胞测序最好的教程（十）：万能的Transformer与细胞注释</span></a><br></p><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247515808&amp;idx=1&amp;sn=271304f9dbf9a7e504f5e7644c207046&amp;chksm=ea1cb822dd6b313430cc7a76a713b603552598db95ec32fb66dfc1adbfd8d4ed622b44002a51&amp;scene=21#wechat_redirect" textvalue="单细胞测序最好的教程（九）: 发表在Science的细胞注释算法" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2"><span>单细胞测序最好的教程（九）: 发表在Science的细胞注释算法</span></a><br></p><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247515584&amp;idx=1&amp;sn=cdebf7564d705460fe9dc975731cd415&amp;chksm=ea1cbb42dd6b3254fb79fb6553ebfd4cdc501ffb6e1c5f67e035e45c6827e4c958b471a7102a&amp;scene=21#wechat_redirect" textvalue="单细胞测序最好的教程（八）: 基于marker的自动注释" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2"><span>单细胞测序最好的教程（八）: 基于marker的自动注释</span></a><br></p><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247515355&amp;idx=1&amp;sn=332fbca110279ed382f070dc2b206739&amp;chksm=ea1cba59dd6b334f27a633c5c1acd1b6378b5b1bee61e235a607345047e7b2d698a5004517c7&amp;scene=21#wechat_redirect" textvalue="单细胞测序最好的教程（七）: 数据整合与批次效应校正" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2"><span>单细胞测序最好的教程（七）: 数据整合与批次效应校正</span></a><br></p><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247515176&amp;idx=1&amp;sn=5fab89acd97c0b47b2d5c67044bd6463&amp;chksm=ea1cbaaadd6b33bc45778bbcf36b93962a32bb16f1b47117cd5f432bc97519c63332976792b3&amp;scene=21#wechat_redirect" textvalue="单细胞测序最好的教程（六）：细胞类型注释" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2"><span>单细胞测序最好的教程（六）：细胞类型注释</span></a><br></p></section></section><hr><p><br></p></section><section data-style-type="5" data-tools="新媒体排版" data-id="2440475"><hr><p><br></p><hr><section><p>如果你对单细胞转录组研究感兴趣，但又不知道如何入门，也许你可以关注一下下面的课程<span></span></p><p><br></p><ul><li><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247527207&amp;idx=1&amp;sn=fb9ca814003fc24e9ec8b1bcecbd1d56&amp;chksm=9b4b2b9cac3ca28afc5b68047e5f0587b6636d52879051decd573009e38313c5f7d6b0d1927d&amp;scene=21#wechat_redirect" textvalue="生信入门&amp;数据挖掘线上直播课2024年1月班" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1">生信入门&amp;数据挖掘线上直播课2024年1月班</a><br></p></li><li><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247524148&amp;idx=1&amp;sn=7806da6feb41a36493c519c1cfc1d3ac&amp;chksm=9b4bdf8fac3c569960369602f1ef26639cb366b250f233b2297d1f059471c0458335bfc0b829&amp;scene=21#wechat_redirect" textvalue="时隔5年，我们的生信技能树VIP学徒继续招生啦" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1">时隔5年，我们的生信技能树VIP学徒继续招生啦</a><br></p></li><li><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247526168&amp;idx=1&amp;sn=ebc4a9d53d675e3f7d20b1e2f97901b8&amp;chksm=9b4b27a3ac3caeb5ee0828c38f816c229067d1946be224bcaf4bac0dbdfc9eff863c621097e2&amp;scene=21#wechat_redirect" textvalue="生物信息学江湖的开创性产品-共享服务器" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1">生物信息学江湖的开创性产品-共享服务器</a></p></li></ul><p><img data-imgfileid="100035055" data-ratio="1" data-src="https://mmbiz.qpic.cn/mmbiz_gif/4TKeL1ZejtlKxOib5kmKX6ic6eX0w0WK5jvhtz9yBRsO3OI4yr6S5iaLNM7AbAeuPDHXMvDdur2DRz9wyiax4lEviag/640?wx_fmt=gif" data-type="gif" data-w="240" src="https://mmbiz.qpic.cn/mmbiz_gif/4TKeL1ZejtlKxOib5kmKX6ic6eX0w0WK5jvhtz9yBRsO3OI4yr6S5iaLNM7AbAeuPDHXMvDdur2DRz9wyiax4lEviag/640?wx_fmt=gif"><br></p><p><img data-imgfileid="100035053" data-ratio="0.05278592375366569" data-src="https://mmbiz.qpic.cn/mmbiz/4TKeL1Zejtlq03ZOSZiaTlic1MxgdKiaxTbOZ7ZSe0Xx1Ca8xF3L6Nyj1FYUajtYrSmRIHyZVSsAve0EAvEicZONpg/640?wx_fmt=jpeg" data-type="other" data-w="341" src="https://mmbiz.qpic.cn/mmbiz/4TKeL1Zejtlq03ZOSZiaTlic1MxgdKiaxTbOZ7ZSe0Xx1Ca8xF3L6Nyj1FYUajtYrSmRIHyZVSsAve0EAvEicZONpg/640?wx_fmt=jpeg"></p><p><strong><span>看完记得顺手点个</span></strong><span><strong><span>“在看”</span></strong></span><strong><span>哦！</span></strong></p></section><section><section data-id="93668"><section><section data-width="95%"><section><section><section data-width="38%"><section><section data-tools="135编辑器" data-id="93668"><section><section data-width="95%"><section><section><section data-width="61.8%"><section><section><section><p><br></p><span><strong data-burshtype="text"><img data-copyright="0" data-cropselx1="0" data-cropselx2="109" data-cropsely1="0" data-cropsely2="109" data-imgfileid="100035052" data-ratio="1" data-src="https://mmbiz.qpic.cn/mmbiz/siaia0BDGJdjRMGrkqo64BGKecYk4akuHpGHVQs7FeOpY7eWbIPGC1tRw5Tw0oEPmx053mR9FTVerWvhuZchIpZw/640?wx_fmt=jpeg" data-type="other" data-w="258" title="qrcode_for_gh_5a3c482ed99f_1280.jpg" src="https://mmbiz.qpic.cn/mmbiz/siaia0BDGJdjRMGrkqo64BGKecYk4akuHpGHVQs7FeOpY7eWbIPGC1tRw5Tw0oEPmx053mR9FTVerWvhuZchIpZw/640?wx_fmt=jpeg"><strong data-burshtype="text">生物</strong><strong data-burshtype="text"> | 单细胞 | 转录组丨资料</strong></strong></span></section><section><span><strong data-burshtype="text">每天都精彩</strong></span></section></section></section><section><section><section><section><section><section><p><span>长按扫码可关注</span></p></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/Ng5ZHzVo50-JgQcRJfJmSQ",target="_blank" rel="noopener noreferrer">原文链接</a>
