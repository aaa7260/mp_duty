---
title: "单细胞分析报错解决 Error: Cannot add more or fewer meta.features ..."
date: 2024-01-11T04:29:44Z
draft: ["false"]
tags: [
  "fetched",
  "医学生之学习生信"
]
categories: ["Acdemic"]
---
单细胞分析报错解决 Error: Cannot add more or fewer meta.features ... by 医学生之学习生信
------
<div><hr><section><blockquote><p><span>最近在果子老师的学习群里看到有同学在单细胞分析中使用</span><strong>FindVariableFeatures()</strong><span>函数或者</span><strong>SelectIntegrationFeatures()</strong><span>函数过程中出现下面的报错信息：</span><span>Error: Cannot add more or fewer meta.features information without values being named with feature names</span></p></blockquote></section><section><ul><li><li><li></ul><pre data-lang="nginx"><code><span><span>seu</span> &lt;- NormalizeData(seu)</span></code><code><span><br></span></code><code><span>seu &lt;- FindVariableFeatures(seu, selection.method = <span>"vst"</span>, nfeatures = <span>2000</span>)</span></code></pre></section><p><img data-backh="210" data-backw="578" data-galleryid="" data-imgfileid="100008577" data-ratio="0.3638888888888889" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/dgYTF46r3icabMJx0ymPh7lNZ5l470icrZoCeYlvuV81HrHJk0dPDEwoqFFibWDlxycVMbeBiaks65tpuB0S1tjY5Q/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/dgYTF46r3icabMJx0ymPh7lNZ5l470icrZoCeYlvuV81HrHJk0dPDEwoqFFibWDlxycVMbeBiaks65tpuB0S1tjY5Q/640?wx_fmt=png&amp;from=appmsg"><br></p><hr><p><span>原因在于</span><strong>meta.features</strong><span>的行名为NA缺失，</span><strong>meta.features</strong><span>存放在Seurat对象的RNA中，可以通过以下代码查看, 可以看到上图的NA</span><br></p><section><ul><li></ul><pre data-lang="css"><code><span><span>seu</span><span>[["RNA"]</span>]@<span>meta</span>.<span>features</span></span></code></pre></section><p><span>对于该报错，解决方案如下，恢复<strong>meta.features</strong>的</span><span>行</span><span>名：</span></p><section><ul><li><li><li><li></ul><pre data-lang="nginx"><code><span><span>seu</span> &lt;- NormalizeData(seu)</span></code><code><span>seu[[<span>"RNA"</span>]]<span>@meta</span>.features &lt;- data.frame(row.names = rownames(seu[[<span>"RNA"</span>]])) <span>#关于FindVariableFeatures报错的解决方法</span></span></code><code><span>seu &lt;- FindVariableFeatures(seu, selection.method = <span>"vst"</span>, nfeatures = <span>2000</span>)</span></code><code><span><br></span></code></pre></section><p><img data-backh="196" data-backw="575" data-croporisrc="https://mmbiz.qpic.cn/sz_mmbiz_png/dgYTF46r3icabMJx0ymPh7lNZ5l470icrZumCMrrTTZ9Ojl8CQZmJlgETm3HfhKDawzYnMb9oGADxQKNYHZ89I9g/0?wx_fmt=png&amp;from=appmsg" data-cropx1="0" data-cropx2="928.5294117647059" data-cropy1="160.14705882352945" data-cropy2="477.2058823529413" data-galleryid="" data-imgfileid="100008578" data-ratio="0.3415948275862069" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/dgYTF46r3icabMJx0ymPh7lNZ5l470icrZXvzuuFXxZvGqPiaXtfjkRrtjPeDaLYTzBkuZRF4KRhBPqNOsLDZQYsQ/640?wx_fmt=jpeg" data-type="jpeg" data-w="928" src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/dgYTF46r3icabMJx0ymPh7lNZ5l470icrZXvzuuFXxZvGqPiaXtfjkRrtjPeDaLYTzBkuZRF4KRhBPqNOsLDZQYsQ/640?wx_fmt=jpeg"></p><hr><p><span>可以看到解决了报错，为什么会出现这个报错呢，关于这一报错信息有人曾在Github上讨论过，原因是读取或者处理数据过程中使得</span><strong>meta.features</strong><span>的行名丢失了，把它恢复过来就可以。</span><br></p><section><ul><li><li><li></ul><pre data-lang="ruby"><code><span><span>https:</span>/<span>/github.com/satijalab</span><span>/seurat/issues</span><span>/2317</span></span></code><code><span><br></span></code><code><span><span>https:/</span><span>/github.com/satijalab</span><span>/seurat/issues</span><span>/3070</span></span></code></pre></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/wsr48JRFMaM0-uNku-phlw",target="_blank" rel="noopener noreferrer">原文链接</a>
