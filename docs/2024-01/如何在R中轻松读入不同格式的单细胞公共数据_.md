---
title: "如何在R中轻松读入不同格式的单细胞公共数据？"
date: 2024-01-23T04:45:37Z
draft: ["false"]
tags: [
  "fetched",
  "SCIPainter"
]
categories: ["Acdemic"]
---
如何在R中轻松读入不同格式的单细胞公共数据？ by SCIPainter
------
<div><section data-mpa-powered-by="yiban.io"><span>往期分享了一些可下载单细胞数据集的常用公共数据库，具体可戳<a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzA5NzQzOTgzMw==&amp;mid=2651007946&amp;idx=1&amp;sn=041434a680861dc7810883c1493926aa&amp;chksm=8b5752fcbc20dbea18249c2daa68f406fdc1e833b7113dffda9d5b2fff2c8cb1bb71849667d5&amp;scene=21#wechat_redirect" textvalue="《如何下载已发表单细胞数据为己所用？》" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2">《如何下载已发表单细胞数据为己所用？》</a>。</span></section><section><br></section><section><span>各大数据库中用来储存scRNA矩阵的文件格式有挺多，如10X的三个标准文件（MEX），h5，h5ad，RDS，loom等。那么我们如何在R中成功读入不同格式的scRNA文件，开启单细胞挖掘之旅？正好Seurat目前也已经到V5了，今天就来学习V5版本下常见单细胞数据格式的读入吧！</span><span></span></section><section mpa-from-tpl="t"><section mpa-from-tpl="t"><section data-mpa-template-schema="title" itemtype="https://mp.weixin.qq.com/voc/Section" itemscope="" mpa-from-tpl="t"><section data-mpa-template-title="" itemprop="title" mpa-from-tpl="t"><section mpa-from-tpl="t"><section mpa-from-tpl="t"><section mpa-from-tpl="t"><section mpa-from-tpl="t"><section mpa-from-tpl="t"><section mpa-from-tpl="t"><section mpa-from-tpl="t"><section mpa-from-tpl="t"><p><span><br mpa-from-tpl="t"></span></p><section data-mpa-template="t" mpa-from-tpl="t"><section data-mpa-template="t" mpa-from-tpl="t"><section data-mpa-template-schema="title" itemtype="https://mp.weixin.qq.com/voc/Section" itemscope="" mpa-from-tpl="t"><section data-mpa-template-title="" itemprop="title" mpa-from-tpl="t"><section mpa-from-tpl="t"><section mpa-from-tpl="t"><section mpa-from-tpl="t"><section mpa-from-tpl="t"><section mpa-from-tpl="t"><section mpa-from-tpl="t"><section mpa-from-tpl="t"><section mpa-from-tpl="t"><p><span><strong mpa-from-tpl="t" mpa-is-content="t">1.10X标准格式(MEX)</strong></span><em><strong mpa-from-tpl="t"></strong></em></p></section></section></section></section></section></section></section></section></section></section></section></section><p><br></p></section></section></section></section></section></section></section></section></section></section></section></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>#相关R包载入：</span><br mpa-from-tpl="t"><span>library</span>(Seurat)<br mpa-from-tpl="t"><span>library</span>(harmony)<br mpa-from-tpl="t"><span>library</span>(ggplot2)<br mpa-from-tpl="t"><br mpa-from-tpl="t"><span>#检查当前Seurat版本：</span><br mpa-from-tpl="t"><span>packageVersion</span> ('Seurat')</code></pre></section><section><span></span></section><section><img data-imgfileid="503526305" data-ratio="0.08888888888888889" data-src="https://mmbiz.qpic.cn/mmbiz_png/6kvRq2WRXpiaR66Bg3ZpV6ZpdPWibLp8CYfFsbcicmx5kkCttMTr5vXsd491o7BJ5z5cJzj7xU5SPx9dGia1RkZXDw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="765" src="https://mmbiz.qpic.cn/mmbiz_png/6kvRq2WRXpiaR66Bg3ZpV6ZpdPWibLp8CYfFsbcicmx5kkCttMTr5vXsd491o7BJ5z5cJzj7xU5SPx9dGia1RkZXDw/640?wx_fmt=png&amp;from=appmsg"></section><section><span><br mpa-from-tpl="t"></span></section><section data-mpa-template="t" mpa-from-tpl="t"><section data-mpa-template="t" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><p data-mid="">01</p></section></section><section data-mid="" mpa-from-tpl="t"><p data-mid=""><span>单样品读入</span></p></section></section></section></section></section><section><span>这里我们以GSE251912为例，单个样本标准文件读入V4和V5差别不大，大家下载需要的样品文件到本地，记得修改好文件夹名和文件名（barcodes.tsv.gz，features.tsv.gz，matrix.mtx.gz）。</span></section><section><span><br></span></section><section><img data-imgfileid="503526306" data-ratio="0.35555555555555557" data-src="https://mmbiz.qpic.cn/mmbiz_png/6kvRq2WRXpiaR66Bg3ZpV6ZpdPWibLp8CYOkmdmmTPommzRz7tLqxp4nwx0uqH6UruBcBdyF66ShnpAdgsr5NIEg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/6kvRq2WRXpiaR66Bg3ZpV6ZpdPWibLp8CYOkmdmmTPommzRz7tLqxp4nwx0uqH6UruBcBdyF66ShnpAdgsr5NIEg/640?wx_fmt=png&amp;from=appmsg"></section><section><br></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>#指定数据所在目录:</span><br mpa-from-tpl="t"><span>data_dir</span> &lt;- <span>"GSE251912/Cytokines/"</span><br mpa-from-tpl="t"><br mpa-from-tpl="t"><span>#列出目录下文件名:</span><br mpa-from-tpl="t"><span>list</span>.files(data_dir) <span>#三个文件缺一不可，名称需完全一致</span></code></pre></section><section><span></span></section><section><img data-imgfileid="503526307" data-ratio="0.0761478163493841" data-src="https://mmbiz.qpic.cn/mmbiz_png/6kvRq2WRXpiaR66Bg3ZpV6ZpdPWibLp8CYEFaE5TiccvLkXcHQOXQEvzHY4vTD96uZKIONCukyXNWjKchWHhCjf9A/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="893" src="https://mmbiz.qpic.cn/mmbiz_png/6kvRq2WRXpiaR66Bg3ZpV6ZpdPWibLp8CYEFaE5TiccvLkXcHQOXQEvzHY4vTD96uZKIONCukyXNWjKchWHhCjf9A/640?wx_fmt=png&amp;from=appmsg"></section><section><br></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>#使用Read10X读取数据：</span><br mpa-from-tpl="t"><span>cyto</span> &lt;- Read10X(data.dir = data_dir) <br mpa-from-tpl="t"><br mpa-from-tpl="t"><span>#根据组别名为细胞ID加上前缀：</span><br mpa-from-tpl="t"><span>colnames</span>(cyto) &lt;- paste('cyto', colnames(cyto), sep = '-')<br mpa-from-tpl="t"><span>head</span>(colnames(cyto))</code></pre></section><section><span></span></section><section><img data-imgfileid="503526308" data-ratio="0.14149947201689547" data-src="https://mmbiz.qpic.cn/mmbiz_png/6kvRq2WRXpiaR66Bg3ZpV6ZpdPWibLp8CYoibIpp6iaHFgFRkY0QibzYIPhciaVMlrGau7WHz59zTeKiaLzYvkukYdv8Q/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="947" src="https://mmbiz.qpic.cn/mmbiz_png/6kvRq2WRXpiaR66Bg3ZpV6ZpdPWibLp8CYoibIpp6iaHFgFRkY0QibzYIPhciaVMlrGau7WHz59zTeKiaLzYvkukYdv8Q/640?wx_fmt=png&amp;from=appmsg"></section><section><br></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>#创建seurat对象：</span><br mpa-from-tpl="t"><span>cyto</span> &lt;- CreateSeuratObject(counts = cyto, <br mpa-from-tpl="t">                           <span>project</span> = 'cytokines', <br mpa-from-tpl="t">                           <span>min</span>.cells = 5,<br mpa-from-tpl="t">                           <span>min</span>.features = 300)<br mpa-from-tpl="t"><br mpa-from-tpl="t"><span>dim</span>(cyto) <span>#查看基因数和细胞总数</span><br mpa-from-tpl="t"><span>head</span>(cyto@assays$RNA$counts)[,1:3]<br mpa-from-tpl="t"><span>head</span>(cyto@meta.data)<br mpa-from-tpl="t"><span>table</span>(cyto@meta.data$orig.ident)</code></pre></section><section><span></span></section><section><img data-imgfileid="503526309" data-ratio="0.5462962962962963" data-src="https://mmbiz.qpic.cn/mmbiz_png/6kvRq2WRXpiaR66Bg3ZpV6ZpdPWibLp8CYoFs98OJIlOMYUiaWB3SQLsjZTHqiaTKc5ONeKHubC2ia3MRlm7FGf1D3g/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/6kvRq2WRXpiaR66Bg3ZpV6ZpdPWibLp8CYoFs98OJIlOMYUiaWB3SQLsjZTHqiaTKc5ONeKHubC2ia3MRlm7FGf1D3g/640?wx_fmt=png&amp;from=appmsg"></section><section><span><br></span></section><section data-mpa-template="t" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><p data-mid="">02</p></section></section><section data-mid="" mpa-from-tpl="t"><p data-mid=""><span>多样品读入与合并</span></p></section></section></section></section><section><span></span></section><section><span><br mpa-from-tpl="t"></span></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>#先走一下v4版Seurat的merge：</span><br mpa-from-tpl="t"><span>data_dir</span> &lt;- 'GSE251912/Untreated/' <span>#再读入另一个untreated样品</span><br mpa-from-tpl="t"><span>unt</span> &lt;- Read10X(data.dir = data_dir) <br mpa-from-tpl="t"><span>colnames</span>(unt) &lt;- paste('unt', colnames(unt), sep = '-')<br mpa-from-tpl="t"><span>unt</span> &lt;- CreateSeuratObject(counts = unt, <br mpa-from-tpl="t">                          <span>project</span> = 'untreated', <br mpa-from-tpl="t">                          <span>min</span>.cells = 5, <br mpa-from-tpl="t">                          <span>min</span>.features = 300)<br mpa-from-tpl="t"><br mpa-from-tpl="t"><span>#将两个样品merge：</span><br mpa-from-tpl="t"><span>seurat_object</span> &lt;- merge(unt, cyto)</code></pre></section><section><span></span></section><section><img data-imgfileid="503526312" data-ratio="0.725925925925926" data-src="https://mmbiz.qpic.cn/mmbiz_png/6kvRq2WRXpiaR66Bg3ZpV6ZpdPWibLp8CYdmBwQqM41LMAhZ0icvp6icjj16ibiaHLlres427DN3I4ptkNZvkMC4nU4w/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/6kvRq2WRXpiaR66Bg3ZpV6ZpdPWibLp8CYdmBwQqM41LMAhZ0icvp6icjj16ibiaHLlres427DN3I4ptkNZvkMC4nU4w/640?wx_fmt=png&amp;from=appmsg"></section><section><br></section><section><span>可以看到按照v4的方法merge后每个样品的counts仍是独立表达矩阵，没有merge在一起，这样走不了后面的分析流程。下面我们换一种方法尝试。</span></section><section><br></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>#V5版merge：</span><br mpa-from-tpl="t"><span>rm</span>(list = ls()) <span>#清空当前工作环境</span><br mpa-from-tpl="t"><br mpa-from-tpl="t"><span>data_dir</span> &lt;- list.dirs('GSE251912/')[-1]<br mpa-from-tpl="t"><span>names</span>(data_dir) &lt;- list.files('GSE251912/', recursive = F) <span>#重命名</span><br mpa-from-tpl="t"><span>data_dir</span> <span>#直接一次性读取全部目标路径</span></code></pre></section><section><span></span></section><section><img data-imgfileid="503526310" data-ratio="0.13829787234042554" data-src="https://mmbiz.qpic.cn/mmbiz_png/6kvRq2WRXpiaR66Bg3ZpV6ZpdPWibLp8CYicL6zk1hKK3EFT3ibY5bXqeZA8doAibibpFxbOSCVlFFle7QbEvPI8VBSg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="752" src="https://mmbiz.qpic.cn/mmbiz_png/6kvRq2WRXpiaR66Bg3ZpV6ZpdPWibLp8CYicL6zk1hKK3EFT3ibY5bXqeZA8doAibibpFxbOSCVlFFle7QbEvPI8VBSg/640?wx_fmt=png&amp;from=appmsg"></section><section><br></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>merge</span> &lt;- Read10X(data.dir = data_dir) <span>#直接将多个样品统一读取为一个稀疏矩阵</span><br mpa-from-tpl="t"><span>seurat_object</span> &lt;- CreateSeuratObject(counts = merge, <br mpa-from-tpl="t">                                    <span>min</span>.cells = 5,<br mpa-from-tpl="t">                                    <span>min</span>.features = 300)</code></pre></section><section><span></span></section><section><img data-imgfileid="503526313" data-ratio="0.725925925925926" data-src="https://mmbiz.qpic.cn/mmbiz_png/6kvRq2WRXpiaR66Bg3ZpV6ZpdPWibLp8CYgGR3iaEIL8RgE2ticibu5kOGuianQsgesuCAb0wVduUduiaMh6K1BnVSvqQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/6kvRq2WRXpiaR66Bg3ZpV6ZpdPWibLp8CYgGR3iaEIL8RgE2ticibu5kOGuianQsgesuCAb0wVduUduiaMh6K1BnVSvqQ/640?wx_fmt=png&amp;from=appmsg"></section><section><br></section><section><span>这样就merge成功啦，甚至更简单！</span></section><section><span><br mpa-from-tpl="t"></span></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>#添加分组信息：</span><br mpa-from-tpl="t"><span>seurat_object</span>@meta.data$group &lt;- ifelse(seurat_object@meta.data$orig.ident == 'Cytokines',<br mpa-from-tpl="t">                                        '<span>Cytokines</span>','Untreated')<br mpa-from-tpl="t"><span>table</span>(seurat_object@meta.data$group)</code></pre></section><section><span></span></section><section><img data-imgfileid="503526311" data-ratio="0.20029239766081872" data-src="https://mmbiz.qpic.cn/mmbiz_png/6kvRq2WRXpiaR66Bg3ZpV6ZpdPWibLp8CYbDCgQw59Bqrld3aXYvrBn0Lqp13mmp0hn3Jiabs5ULGIh5UHz31LbFg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="684" src="https://mmbiz.qpic.cn/mmbiz_png/6kvRq2WRXpiaR66Bg3ZpV6ZpdPWibLp8CYbDCgQw59Bqrld3aXYvrBn0Lqp13mmp0hn3Jiabs5ULGIh5UHz31LbFg/640?wx_fmt=png&amp;from=appmsg"></section><section><br></section><p><span>可保存数据，或继续按需走Seurat后续流程。</span></p><section><br></section><section data-mpa-template="t" mpa-from-tpl="t"><section data-mpa-template="t" mpa-from-tpl="t"><section data-mpa-template-schema="title" itemtype="https://mp.weixin.qq.com/voc/Section" itemscope="" mpa-from-tpl="t"><section data-mpa-template-title="" itemprop="title" mpa-from-tpl="t"><section mpa-from-tpl="t"><section mpa-from-tpl="t"><section mpa-from-tpl="t"><section mpa-from-tpl="t"><section mpa-from-tpl="t"><section mpa-from-tpl="t"><section mpa-from-tpl="t"><section mpa-from-tpl="t"><p><span><strong mpa-from-tpl="t" mpa-is-content="t">2. h5格式</strong></span></p></section></section></section></section></section></section></section></section></section></section></section></section><section><br></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>#相关R包载入：</span><br mpa-from-tpl="t"><span>library</span>(hdf5r)<br mpa-from-tpl="t"><span>library</span>(stringr)<br mpa-from-tpl="t"><span>library</span>(data.table)</code></pre></section><p><span>h5格式可直接使用Read10X_h5函数读入，多样本的批量读入可能稍微麻烦点，可以选择使用lapply函数批量读入目录下所有h5，返回list先merge再创建Seurat对象。</span><span><p></p></span></p><section><br></section><section data-mpa-template="t" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><p data-mid="">01</p></section></section><section data-mid="" mpa-from-tpl="t"><p data-mid=""><span>单样品读入</span></p></section></section></section></section><section><span>这里我们以</span><span>GSE237611</span><span>为例，点击custom展开文件，勾选h5格式将其下载到本地。</span></section><section><span><br></span></section><section><img data-imgfileid="503526314" data-ratio="1.0296296296296297" data-src="https://mmbiz.qpic.cn/mmbiz_png/6kvRq2WRXpiaR66Bg3ZpV6ZpdPWibLp8CYzq1ibtgib32uj0lGe5BaUHDK64giaK03YDpMsicxicTwzhgwSXC8X1yT4MQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/6kvRq2WRXpiaR66Bg3ZpV6ZpdPWibLp8CYzq1ibtgib32uj0lGe5BaUHDK64giaK03YDpMsicxicTwzhgwSXC8X1yT4MQ/640?wx_fmt=png&amp;from=appmsg"></section><section><br></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>#使用Read10X_h5函数读入：</span><br mpa-from-tpl="t"><span>rm</span>(list = ls())<br mpa-from-tpl="t"><span>count</span> &lt;- Read10X_h5('GSE237611_RAW/GSM7634809_lib48853_raw_feature_bc_matrix.h5')<br mpa-from-tpl="t"><span>colnames</span>(count) &lt;- paste('GSM7634809', colnames(count), sep = '-')<br mpa-from-tpl="t"><span>head</span>(colnames(count))</code></pre></section><section><span></span></section><section><img data-imgfileid="503526317" data-ratio="0.12407407407407407" data-src="https://mmbiz.qpic.cn/mmbiz_png/6kvRq2WRXpiaR66Bg3ZpV6ZpdPWibLp8CYCWGFhFyHcSvuT7v8WQZXhdgp51JvofxXWsyv0eV9RTIBUJQ0ZIHgvg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/6kvRq2WRXpiaR66Bg3ZpV6ZpdPWibLp8CYCWGFhFyHcSvuT7v8WQZXhdgp51JvofxXWsyv0eV9RTIBUJQ0ZIHgvg/640?wx_fmt=png&amp;from=appmsg"></section><section><br></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>seurat_object</span> &lt;- CreateSeuratObject(counts = count, <br mpa-from-tpl="t">                                    <span>project</span> = 'responder',<br mpa-from-tpl="t">                                    <span>min</span>.cells = 5,<br mpa-from-tpl="t">                                    <span>min</span>.features = 300)<br mpa-from-tpl="t"><span>dim</span>(seurat_object)<br mpa-from-tpl="t"><span>head</span>(seurat_object@assays$RNA$counts)[,1:2]<br mpa-from-tpl="t"><span>head</span>(seurat_object@meta.data)<br mpa-from-tpl="t"><span>table</span>(seurat_object@meta.data$orig.ident)</code></pre></section><section><span></span></section><section><img data-imgfileid="503526319" data-ratio="0.6462962962962963" data-src="https://mmbiz.qpic.cn/mmbiz_png/6kvRq2WRXpiaR66Bg3ZpV6ZpdPWibLp8CYlX0jprGjlXm4tFxdPgJl1OQjict1ibsUZEibmc7GQ7wZ0WaKibbebELEQQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/6kvRq2WRXpiaR66Bg3ZpV6ZpdPWibLp8CYlX0jprGjlXm4tFxdPgJl1OQjict1ibsUZEibmc7GQ7wZ0WaKibbebELEQQ/640?wx_fmt=png&amp;from=appmsg"></section><section><span><br></span></section><section data-mpa-template="t" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><p data-mid="">02</p></section></section><section data-mid="" mpa-from-tpl="t"><p data-mid=""><span>多样品读入与合并</span></p></section></section></section></section><section><span></span></section><section><span><br mpa-from-tpl="t"></span></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>#设置文件路径：</span><br mpa-from-tpl="t"><span>rm</span>(list = ls())<br mpa-from-tpl="t"><span>data_dir</span> &lt;- 'GSE237611_RAW/' <br mpa-from-tpl="t"><span>samples</span> &lt;- list.files(data_dir)<br mpa-from-tpl="t"><span>samples</span></code></pre></section><section><span></span></section><section><img data-imgfileid="503526316" data-ratio="0.5018007202881153" data-src="https://mmbiz.qpic.cn/mmbiz_png/6kvRq2WRXpiaR66Bg3ZpV6ZpdPWibLp8CY8Jf6jCicKjSpQXhMk8QWQb3W28Uc9Kw8gl3tbibxcCEQfbWAuo61SAXg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="833" src="https://mmbiz.qpic.cn/mmbiz_png/6kvRq2WRXpiaR66Bg3ZpV6ZpdPWibLp8CY8Jf6jCicKjSpQXhMk8QWQb3W28Uc9Kw8gl3tbibxcCEQfbWAuo61SAXg/640?wx_fmt=png&amp;from=appmsg"></section><section><br></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>#读取目录下全部h5格式文件：</span><br mpa-from-tpl="t"><span>count_list</span> &lt;- lapply(samples, function(x){ <br mpa-from-tpl="t">  <span>print</span>(x) <br mpa-from-tpl="t">  <span>counts</span> = Read10X_h5(file.path(data_dir, x))<br mpa-from-tpl="t">  <span>return</span>(counts)<br mpa-from-tpl="t">}) <span>##返回一个list</span><br mpa-from-tpl="t"><br mpa-from-tpl="t"><span>#更改list中barcodes名称：</span><br mpa-from-tpl="t"><span>samples</span> &lt;- str_split(samples, <span>"_"</span>, simplify = T)[,1] <span>#样本名仅保留GSM编号</span><br mpa-from-tpl="t"><span>samples</span></code></pre></section><section><span></span></section><section><img data-imgfileid="503526315" data-ratio="0.11851851851851852" data-src="https://mmbiz.qpic.cn/mmbiz_png/6kvRq2WRXpiaR66Bg3ZpV6ZpdPWibLp8CYIIBPtU0eibU7mGSiawO7IRzOsRUu6KvOGQp1qBM4oVeFn3iaQhcibaRbcg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/6kvRq2WRXpiaR66Bg3ZpV6ZpdPWibLp8CYIIBPtU0eibU7mGSiawO7IRzOsRUu6KvOGQp1qBM4oVeFn3iaQhcibaRbcg/640?wx_fmt=png&amp;from=appmsg"></section><section><br></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>for</span> (i in 1:length(count_list)) {<br mpa-from-tpl="t">  <span>col</span> &lt;- colnames(count_list[[i]])<br mpa-from-tpl="t">  <span>colnames</span>(count_list[[i]]) &lt;- paste0(samples[i], <span>"_"</span>, col)<br mpa-from-tpl="t">}</code></pre></section><section><span></span></section><section><img data-imgfileid="503526318" data-ratio="0.9628205128205128" data-src="https://mmbiz.qpic.cn/mmbiz_png/6kvRq2WRXpiaR66Bg3ZpV6ZpdPWibLp8CYtQ5iaTObp9J8BOvPtHHmL2htVUq7ibCr6ORSPBHsMRwSQHZXjKHZAyXw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="780" src="https://mmbiz.qpic.cn/mmbiz_png/6kvRq2WRXpiaR66Bg3ZpV6ZpdPWibLp8CYtQ5iaTObp9J8BOvPtHHmL2htVUq7ibCr6ORSPBHsMRwSQHZXjKHZAyXw/640?wx_fmt=png&amp;from=appmsg"></section><section><br></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>#merge后创建seurat对象:</span><br mpa-from-tpl="t"><span>merge</span> &lt;- do.call(cbind, count_list)</code></pre></section><section><span></span></section><section><img data-imgfileid="503526321" data-ratio="0.3950310559006211" data-src="https://mmbiz.qpic.cn/mmbiz_png/6kvRq2WRXpiaR66Bg3ZpV6ZpdPWibLp8CYAtHsWRvESFLnVsB3lIYda8OPTDqFuy4ZqX7lukMvfNoC9a6GDo4NEg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="805" src="https://mmbiz.qpic.cn/mmbiz_png/6kvRq2WRXpiaR66Bg3ZpV6ZpdPWibLp8CYAtHsWRvESFLnVsB3lIYda8OPTDqFuy4ZqX7lukMvfNoC9a6GDo4NEg/640?wx_fmt=png&amp;from=appmsg"></section><section><br></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>seurat_object</span> &lt;- CreateSeuratObject(counts = merge,<br mpa-from-tpl="t">                                    <span>min</span>.cells = 5,<br mpa-from-tpl="t">                                    <span>min</span>.features = 300)</code></pre></section><section><span></span></section><section><img data-imgfileid="503526322" data-ratio="0.7916181606519208" data-src="https://mmbiz.qpic.cn/mmbiz_png/6kvRq2WRXpiaR66Bg3ZpV6ZpdPWibLp8CYAO1fUSUfBOq5jU7jPx2vhTIY9EqWIeFIq79Bo8vzibBNEBJctWaicMpg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="859" src="https://mmbiz.qpic.cn/mmbiz_png/6kvRq2WRXpiaR66Bg3ZpV6ZpdPWibLp8CYAO1fUSUfBOq5jU7jPx2vhTIY9EqWIeFIq79Bo8vzibBNEBJctWaicMpg/640?wx_fmt=png&amp;from=appmsg"></section><section><br></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>dim</span>(seurat_object)<br mpa-from-tpl="t"><span>head</span>(seurat_object@meta.data)<br mpa-from-tpl="t"><span>table</span>(seurat_object@meta.data$orig.ident)</code></pre></section><section><span></span></section><section><img data-imgfileid="503526324" data-ratio="0.48148148148148145" data-src="https://mmbiz.qpic.cn/mmbiz_png/6kvRq2WRXpiaR66Bg3ZpV6ZpdPWibLp8CYjP5Biap8lhkFodwN8Sc4icngTsljYI8ZpD2xUfI1gg42jteJTlfcgrZA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1053" src="https://mmbiz.qpic.cn/mmbiz_png/6kvRq2WRXpiaR66Bg3ZpV6ZpdPWibLp8CYjP5Biap8lhkFodwN8Sc4icngTsljYI8ZpD2xUfI1gg42jteJTlfcgrZA/640?wx_fmt=png&amp;from=appmsg"></section><section><br></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>#添加分组信息(根据GSE237611中Samples说明进行分组)：</span><br mpa-from-tpl="t"><span>seurat_object</span>@meta.data$group &lt;- ifelse(seurat_object@meta.data$orig.ident %in% c(<br mpa-from-tpl="t">  '<span>GSM7634809</span>', 'GSM7634810', 'GSM7634813', <br mpa-from-tpl="t">  '<span>GSM7634816</span>', 'GSM7634818', 'GSM7634819'),'R','NR')<br mpa-from-tpl="t"><span>table</span>(seurat_object@meta.data$group) <span>#R:responder;NR:non-responder</span></code></pre></section><section><span></span></section><section><img data-imgfileid="503526320" data-ratio="0.21656050955414013" data-src="https://mmbiz.qpic.cn/mmbiz_png/6kvRq2WRXpiaR66Bg3ZpV6ZpdPWibLp8CYv3mxwhPtFzmibj8bS5Wt06Pv1FfZribOfV1FDe6WMkXmdD3E7lcXmU9A/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="628" src="https://mmbiz.qpic.cn/mmbiz_png/6kvRq2WRXpiaR66Bg3ZpV6ZpdPWibLp8CYv3mxwhPtFzmibj8bS5Wt06Pv1FfZribOfV1FDe6WMkXmdD3E7lcXmU9A/640?wx_fmt=png&amp;from=appmsg"></section><section><br></section><section><span>可保存数据，或继续按需走Seurat后续流程。</span></section><section><br></section><section data-mpa-template="t" mpa-from-tpl="t"><section data-mpa-template="t" mpa-from-tpl="t"><section data-mpa-template-schema="title" itemtype="https://mp.weixin.qq.com/voc/Section" itemscope="" mpa-from-tpl="t"><section data-mpa-template-title="" itemprop="title" mpa-from-tpl="t"><section mpa-from-tpl="t"><section mpa-from-tpl="t"><section mpa-from-tpl="t"><section mpa-from-tpl="t"><section mpa-from-tpl="t"><section mpa-from-tpl="t"><section mpa-from-tpl="t"><section mpa-from-tpl="t"><p><span><strong mpa-from-tpl="t" mpa-is-content="t">3. RDS格式</strong></span><em><strong mpa-from-tpl="t"></strong></em></p></section></section></section></section></section></section></section></section></section></section></section></section><section><br></section><section><span>HTCA数据库中（</span><span>https://www.htcatlas.org/ download</span><span>）可下载数据格式为RDS, 这里我们以Lung为例。</span></section><section><br></section><section><img data-imgfileid="503526323" data-ratio="0.6046296296296296" data-src="https://mmbiz.qpic.cn/mmbiz_png/6kvRq2WRXpiaR66Bg3ZpV6ZpdPWibLp8CYRibxl4WaamCdwBMQbTDWGdiaibyVAmDiaClMvVO5PNFyrbuw0Hn89FBh5A/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/6kvRq2WRXpiaR66Bg3ZpV6ZpdPWibLp8CYRibxl4WaamCdwBMQbTDWGdiaibyVAmDiaClMvVO5PNFyrbuw0Hn89FBh5A/640?wx_fmt=png&amp;from=appmsg"></section><section><br></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>#使用readRDS函数直接读取即可：</span><br mpa-from-tpl="t"><span>rm</span>(list = ls())<br mpa-from-tpl="t"><span>seurat_object</span> &lt;- readRDS('RDS/HTCA_ADULT_LUNG.RDS') <br mpa-from-tpl="t"><span>seurat_object</span></code></pre></section><section><span></span></section><section><img data-imgfileid="503526325" data-ratio="0.16754478398314016" data-src="https://mmbiz.qpic.cn/mmbiz_png/6kvRq2WRXpiaR66Bg3ZpV6ZpdPWibLp8CYTaiadQKrHCRyMYfSmSv5cgqOiaH6SldWnGFIO9TCjia9LunCqQicCVkjkQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="949" src="https://mmbiz.qpic.cn/mmbiz_png/6kvRq2WRXpiaR66Bg3ZpV6ZpdPWibLp8CYTaiadQKrHCRyMYfSmSv5cgqOiaH6SldWnGFIO9TCjia9LunCqQicCVkjkQ/640?wx_fmt=png&amp;from=appmsg"></section><section><br></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>View</span>(seurat_object@meta.data)</code></pre></section><section><img data-imgfileid="503526327" data-ratio="0.5398148148148149" data-src="https://mmbiz.qpic.cn/mmbiz_png/6kvRq2WRXpiaR66Bg3ZpV6ZpdPWibLp8CYWkrscrDVV5bjWe1olFLBZpIic9nrdblaYFs99hVJ7uPALEB5s2ZE6rg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/6kvRq2WRXpiaR66Bg3ZpV6ZpdPWibLp8CYWkrscrDVV5bjWe1olFLBZpIic9nrdblaYFs99hVJ7uPALEB5s2ZE6rg/640?wx_fmt=png&amp;from=appmsg"></section><section><br></section><section data-mpa-template="t" mpa-from-tpl="t"><section data-mpa-template="t" mpa-from-tpl="t"><section data-mpa-template-schema="title" itemtype="https://mp.weixin.qq.com/voc/Section" itemscope="" mpa-from-tpl="t"><section data-mpa-template-title="" itemprop="title" mpa-from-tpl="t"><section mpa-from-tpl="t"><section mpa-from-tpl="t"><section mpa-from-tpl="t"><section mpa-from-tpl="t"><section mpa-from-tpl="t"><section mpa-from-tpl="t"><section mpa-from-tpl="t"><section mpa-from-tpl="t"><p><span><strong mpa-from-tpl="t" mpa-is-content="t">4. h5ad格式</strong></span><em><strong mpa-from-tpl="t"></strong></em></p></section></section></section></section></section></section></section></section></section></section></section></section><section><br></section><section><span>h5ad如果想在R中读入，可尝试将其先转换为h5seurat格式，再创建Seurat对象。这里用来测试的h5ad来自Science文献（10.1126/ science.abl4896）。</span></section><section><span><br></span></section><section><img data-imgfileid="503526328" data-ratio="0.4583333333333333" data-src="https://mmbiz.qpic.cn/mmbiz_png/6kvRq2WRXpiaR66Bg3ZpV6ZpdPWibLp8CYRjc9XEcr1PDY3zj00eJice9rjUsp2SaXpuH9AXuFibkJ09ogLTniaZjww/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/6kvRq2WRXpiaR66Bg3ZpV6ZpdPWibLp8CYRjc9XEcr1PDY3zj00eJice9rjUsp2SaXpuH9AXuFibkJ09ogLTniaZjww/640?wx_fmt=png&amp;from=appmsg"></section><section><br></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>#相关R包安装与载入：</span><br mpa-from-tpl="t"><span>remotes</span>::install_github('mojaveazure/seurat-disk')<br mpa-from-tpl="t"><span>library</span>(SeuratDisk)<br mpa-from-tpl="t"><br mpa-from-tpl="t"><span>#使用Convert函数进行转换</span><br mpa-from-tpl="t"><span>##将h5ad格式文件转换为h5seurat格式：</span><br mpa-from-tpl="t"><span>rm</span>(list = ls())<br mpa-from-tpl="t"><span>Convert</span>('TS_Bladder.h5ad/TS_Bladder.h5ad', <br mpa-from-tpl="t">        <span>dest</span> = 'h5seurat', <br mpa-from-tpl="t">        <span>overwrite</span> = F, <span>#是否覆盖源h5ad</span><br mpa-from-tpl="t">        <span>assay</span> = 'RNA')<br mpa-from-tpl="t"><span>##目录下新增了h5seurat格式文件</span><br mpa-from-tpl="t"><br mpa-from-tpl="t"><span>#使用LoadH5Seurat函数加载h5seurat文件,并创建Seurat对象：</span><br mpa-from-tpl="t"><span>seurat_object</span> &lt;- LoadH5Seurat('TS_Bladder.h5ad/TS_Bladder.h5seurat')<br mpa-from-tpl="t"><span>##这里出现error报错,可尝试将misc参数设置为FALSE</span></code></pre></section><section><span></span></section><section><img data-imgfileid="503526326" data-ratio="0.04986149584487535" data-src="https://mmbiz.qpic.cn/mmbiz_png/6kvRq2WRXpiaR66Bg3ZpV6ZpdPWibLp8CYzbvUo66hgYRCj1yYMd1oibowNu4wyK0icAvQL66knX0tnzIgMVjdepRQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="722" src="https://mmbiz.qpic.cn/mmbiz_png/6kvRq2WRXpiaR66Bg3ZpV6ZpdPWibLp8CYzbvUo66hgYRCj1yYMd1oibowNu4wyK0icAvQL66knX0tnzIgMVjdepRQ/640?wx_fmt=png&amp;from=appmsg"></section><section><br></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>seurat_object</span> &lt;- LoadH5Seurat('TS_Bladder.h5ad/TS_Bladder.h5seurat', <br mpa-from-tpl="t">                              <span>misc</span> = F) <span>#这样OK</span><br mpa-from-tpl="t"><br mpa-from-tpl="t"><span>#得到标准seurat对象,一般含作者聚类、注释等丰富信息</span><br mpa-from-tpl="t"><span>seurat_object</span> <br mpa-from-tpl="t"><span>table</span>(seurat_object@meta.data$method) <span>#测序方法</span><br mpa-from-tpl="t"><span>table</span>(seurat_object@meta.data$free_annotation) <span>#celltype注释</span><br mpa-from-tpl="t"><span>table</span>(seurat_object@meta.data$compartment) <span>#区室划分</span><br mpa-from-tpl="t"><span>table</span>(seurat_object@meta.data$gender) <span>#性别</span></code></pre></section><section><span></span></section><section><img data-imgfileid="503526329" data-ratio="0.9944444444444445" data-src="https://mmbiz.qpic.cn/mmbiz_png/6kvRq2WRXpiaR66Bg3ZpV6ZpdPWibLp8CYMoxicXLVZwUWIw7k0pcj2xNsutgh6ribpLesbcGtLyZZDicagnsFmIicrA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/6kvRq2WRXpiaR66Bg3ZpV6ZpdPWibLp8CYMoxicXLVZwUWIw7k0pcj2xNsutgh6ribpLesbcGtLyZZDicagnsFmIicrA/640?wx_fmt=png&amp;from=appmsg"></section><section><br></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>#可直接快捷查看目标信息，如UMAP聚类分群等等</span><br mpa-from-tpl="t"><span>##提取x/y轴坐标信息：</span><br mpa-from-tpl="t"><span>UMAP</span> &lt;- as.data.frame(seurat_object@reductions$umap@cell.embeddings)<br mpa-from-tpl="t"><br mpa-from-tpl="t"><span>##提取分组信息：</span><br mpa-from-tpl="t"><span>celltype</span> &lt;- seurat_object@meta.data$free_annotation <span>#提取celltype</span><br mpa-from-tpl="t"><span>compartment</span> &lt;- seurat_object@meta.data$compartment <span>#提取compartment</span><br mpa-from-tpl="t"><span>gender</span> &lt;- seurat_object@meta.data$gender <span>#提取性别</span><br mpa-from-tpl="t"><br mpa-from-tpl="t"><span>#将分组信息和坐标轴信息合并：</span><br mpa-from-tpl="t"><span>UMAP</span> &lt;- cbind(UMAP, celltype, compartment, gender)<br mpa-from-tpl="t"><span>View</span>(UMAP)</code></pre></section><section><span></span></section><section><img data-imgfileid="503526332" data-ratio="0.6796296296296296" data-src="https://mmbiz.qpic.cn/mmbiz_png/6kvRq2WRXpiaR66Bg3ZpV6ZpdPWibLp8CYUFJWcMd0vf5DwgamOtAoRrRTqhNL5dtXeaCsp8yjc0Kl3F9WgLDvlw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/6kvRq2WRXpiaR66Bg3ZpV6ZpdPWibLp8CYUFJWcMd0vf5DwgamOtAoRrRTqhNL5dtXeaCsp8yjc0Kl3F9WgLDvlw/640?wx_fmt=png&amp;from=appmsg"></section><section><br></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>#个性化UMAP图绘制：</span><br mpa-from-tpl="t"><span>install</span>.packages('tidydr')<br mpa-from-tpl="t"><span>library</span>(tidydr)<br mpa-from-tpl="t"><span>library</span>(dplyr)<br mpa-from-tpl="t"><span>library</span>(cols4all)<br mpa-from-tpl="t"><br mpa-from-tpl="t"><span>#自定义主题和配色：</span><br mpa-from-tpl="t"><span>mytheme</span> &lt;- theme_void() + theme(plot.margin = margin(5.5,15,5.5,5.5)) <br mpa-from-tpl="t"><span>mycol</span> &lt;- c4a('wright25',15)<br mpa-from-tpl="t"><br mpa-from-tpl="t"><span>#基于celltype：</span><br mpa-from-tpl="t"><span>p</span> &lt;- ggplot(data = UMAP, aes(x = umap_1, y = umap_2)) +<br mpa-from-tpl="t">  <span>##添加聚类散点：</span><br mpa-from-tpl="t">  <span>geom_point</span>(aes(color = celltype), size = 0.5, alpha = 0.8) + <br mpa-from-tpl="t">  <span>##添加置信区间：</span><br mpa-from-tpl="t">  <span>stat_ellipse</span>(aes(color = celltype, fill = celltype),<br mpa-from-tpl="t">               <span>level</span> = 0.95, linetype = 2, show.legend = F, geom = 'polygon', alpha = 0.1) +<br mpa-from-tpl="t">  <span>##箭头坐标系：</span><br mpa-from-tpl="t">  <span>mytheme</span> + theme_dr(xlength = 0.2, ylength = 0.2, <br mpa-from-tpl="t">                     <span>arrow</span> = grid::arrow(length = unit(0.1, <span>"inches"</span>), ends = 'last', type = <span>"closed"</span>)) + <br mpa-from-tpl="t">  <span>theme</span>(panel.grid = element_blank()) +<br mpa-from-tpl="t">  <span>##图例散点放大：</span><br mpa-from-tpl="t">  <span>guides</span>(color = guide_legend(override.aes = list(size = 5))) + <br mpa-from-tpl="t">  <span>##自定义配色：</span><br mpa-from-tpl="t">  <span>scale_color_manual</span>(values = mycol) +<br mpa-from-tpl="t">  <span>scale_fill_manual</span>(values = mycol)<br mpa-from-tpl="t"><span>p</span></code></pre></section><section><span></span></section><section><img data-imgfileid="503526333" data-ratio="0.637962962962963" data-src="https://mmbiz.qpic.cn/mmbiz_png/6kvRq2WRXpiaR66Bg3ZpV6ZpdPWibLp8CYKVSxdrfUXxp8bKrUoxzQnjkrLUrVRj2L41HPxKZInOxAJzmCo265KQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/6kvRq2WRXpiaR66Bg3ZpV6ZpdPWibLp8CYKVSxdrfUXxp8bKrUoxzQnjkrLUrVRj2L41HPxKZInOxAJzmCo265KQ/640?wx_fmt=png&amp;from=appmsg"></section><section><br></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>#or基于compartment或gender：</span><br mpa-from-tpl="t"><span>p1</span> &lt;- ggplot(data = UMAP, aes(x = umap_1, y = umap_2)) +<br mpa-from-tpl="t">  <span>geom_point</span>(aes(color = compartment), size = 0.5, alpha = 0.8) + <br mpa-from-tpl="t">  <span>mytheme</span> + theme_dr(xlength = 0.2, ylength = 0.2, <br mpa-from-tpl="t">                     <span>arrow</span> = grid::arrow(length = unit(0.1, <span>"inches"</span>), ends = 'last', type = <span>"closed"</span>)) + <br mpa-from-tpl="t">  <span>theme</span>(panel.grid = element_blank()) +<br mpa-from-tpl="t">  <span>guides</span>(color = guide_legend(override.aes = list(size = 5))) + <br mpa-from-tpl="t">  <span>scale_color_manual</span>(values = rev(mycol)) +<br mpa-from-tpl="t">  <span>scale_fill_manual</span>(values = rev(mycol))<br mpa-from-tpl="t"><span>p1</span></code></pre></section><section><span></span></section><section><img data-imgfileid="503526331" data-ratio="0.7240740740740741" data-src="https://mmbiz.qpic.cn/mmbiz_png/6kvRq2WRXpiaR66Bg3ZpV6ZpdPWibLp8CYBFmGsUcDZN9S729Qk5gg9QiaQ1bDTbdhytD1EDicuuWeEhNRxOrm2obg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/6kvRq2WRXpiaR66Bg3ZpV6ZpdPWibLp8CYBFmGsUcDZN9S729Qk5gg9QiaQ1bDTbdhytD1EDicuuWeEhNRxOrm2obg/640?wx_fmt=png&amp;from=appmsg"></section><section><br></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>#查看感兴趣基因的表达分布：</span><br mpa-from-tpl="t"><span>COL1A1</span> &lt;- FetchData(seurat_object, vars = 'COL1A1')<br mpa-from-tpl="t"><span>UMAP</span> &lt;- cbind(UMAP, COL1A1)<br mpa-from-tpl="t"><br mpa-from-tpl="t"><span>p2</span> &lt;- ggplot(data = UMAP, aes(x = umap_1, y = umap_2)) +<br mpa-from-tpl="t">  <span>geom_point</span>(aes(color = COL1A1), size = 0.5, alpha = 0.8) + <br mpa-from-tpl="t">  <span>mytheme</span> + theme_dr(xlength = 0.2, ylength = 0.2, <br mpa-from-tpl="t">                     <span>arrow</span> = grid::arrow(length = unit(0.1, <span>"inches"</span>), ends = 'last', type = <span>"closed"</span>)) + <br mpa-from-tpl="t">  <span>theme</span>(panel.grid = element_blank()) +<br mpa-from-tpl="t">  <span>scale_color_continuous_c4a_seq</span>('reds')<br mpa-from-tpl="t"><span>p2</span></code></pre></section><section><span></span></section><section><img data-imgfileid="503526334" data-ratio="0.8240740740740741" data-src="https://mmbiz.qpic.cn/mmbiz_png/6kvRq2WRXpiaR66Bg3ZpV6ZpdPWibLp8CYy2BRv5kopgGGnRbDYJQzUxKfHkCe9SfmKibHcB4MlxfYLRzicysSeoZw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/6kvRq2WRXpiaR66Bg3ZpV6ZpdPWibLp8CYy2BRv5kopgGGnRbDYJQzUxKfHkCe9SfmKibHcB4MlxfYLRzicysSeoZw/640?wx_fmt=png&amp;from=appmsg"></section><section><br></section><section><span>好啦，今日分享毕！</span></section><section><span><br></span></section><p><span>基迪奥的单细胞测序服务能力行业领先，目前已经积累了丰富的项目经验，产出的农医学单细胞文章案例丰富。如果您有</span><span>单细胞测序项目咨询</span><span>，欢迎扫描二维码填写信息，基迪奥为您定制单细胞解决方案。</span></p><section data-mpa-template="t" mpa-from-tpl="t"><p><br></p></section><section data-mpa-template="t" mpa-from-tpl="t"><section data-mpa-template="t" mpa-from-tpl="t"><section mpa-from-tpl="t"><section><section mpa-from-tpl="t"><section mpa-from-tpl="t"><section powered-by="xiumi.us" mpa-from-tpl="t"><section mpa-from-tpl="t"><section mpa-from-tpl="t"><svg viewbox="0 0 1 1" mpa-from-tpl="t"></svg></section></section></section></section><section mpa-from-tpl="t"><section powered-by="xiumi.us" mpa-from-tpl="t"><section mpa-from-tpl="t"><p><span><strong mpa-from-tpl="t" mpa-is-content="t">长按识别二维码填写相关信息：</strong></span></p></section></section></section></section></section></section></section></section><section><img data-imgfileid="503526330" data-ratio="0.934" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6k80muh9ATZ16d37JWd72K8jOMeNWlvGI9eF8BroM4ccSjMtPjeZQIZqBRwXfyff9pKc0YJAXQ4hA/640?wx_fmt=png" data-type="png" data-w="500" height="467" width="500" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6k80muh9ATZ16d37JWd72K8jOMeNWlvGI9eF8BroM4ccSjMtPjeZQIZqBRwXfyff9pKc0YJAXQ4hA/640?wx_fmt=png"></section><section><br></section><section data-mpa-template="t" mpa-from-tpl="t"><section data-mpa-template="t" mpa-from-tpl="t"><section mpa-from-tpl="t"><section><section mpa-from-tpl="t"><section mpa-from-tpl="t"><section powered-by="xiumi.us" mpa-from-tpl="t"><section mpa-from-tpl="t"><section mpa-from-tpl="t"><svg viewbox="0 0 1 1" mpa-from-tpl="t"></svg></section></section></section></section><section mpa-from-tpl="t"><section powered-by="xiumi.us" mpa-from-tpl="t"><section mpa-from-tpl="t"><p><span><strong mpa-from-tpl="t" mpa-is-content="t">咨询当地销售或拨打咨询电话：</strong></span></p></section></section></section></section></section></section></section></section><p><span>医学项目：020-84889324</span><br></p><section><span>农学项目：020-84889314</span></section><p><br></p><p><br></p><p><strong><span>*未经许可，不得以任何方式复制或抄袭本篇文章之部分或全部内容。版权所有，侵权必究。</span></strong></p><p><br></p><section data-tools="135编辑器" data-id="100625"><section><section><p><img data-cropselx1="0" data-cropselx2="554" data-cropsely1="0" data-cropsely2="784" data-galleryid="" data-imgfileid="503526335" data-ratio="1.4142857142857144" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/6kvRq2WRXphp8wG52Hicl9EOs4hy2SNTDic6xzz2fHaf3zyyMbvdW03p3KfUHwibCibMDicNED1yre2uHaAL4p5Z4Wg/640?wx_fmt=jpeg" data-type="gif" data-w="700" src="https://mmbiz.qpic.cn/mmbiz_jpg/6kvRq2WRXphp8wG52Hicl9EOs4hy2SNTDic6xzz2fHaf3zyyMbvdW03p3KfUHwibCibMDicNED1yre2uHaAL4p5Z4Wg/640?wx_fmt=jpeg"></p><section data-brushtype="text"><strong><span>基迪奥生物|专业定制测序服务</span></strong><br></section><section><section data-brushtype="text"><span><strong>联系方式：020-39341079；service@genedenovo.com</strong></span></section></section></section></section></section><section data-role="paragraph"><p><br></p></section><p><br></p><p><mp-style-type data-value="10000"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/RiTYTlFfqaF55WYkgaZ8MA",target="_blank" rel="noopener noreferrer">原文链接</a>
