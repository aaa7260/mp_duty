---
title: "v5 Seurat对象内部结构一览"
date: 2024-01-29T03:13:01Z
draft: ["false"]
tags: [
  "fetched",
  "SCIPainter"
]
categories: ["Acdemic"]
---
v5 Seurat对象内部结构一览 by SCIPainter
------
<div><section data-mpa-powered-by="yiban.io"><span>Seurat目前已经更新到v5，今天我们简单看下使用新版Seurat读取数据并创建的对象中有啥改变，帮助大家更好的理解与使用。<br></span></section><section><br></section><section><span>首先，看下Seurat对象内容总览：</span></section><section><br></section><section><img data-imgfileid="100051051" data-ratio="0.46111111111111114" data-type="png" data-w="1080" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6lf47VIt5qerjqMFPhht5y6fWkWmCqFkflF9swcI3bAthe1OcuEia0yiaKJRicGP59aIWIDkwf7Vq2VA/640?wx_fmt=png&amp;from=appmsg" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6lf47VIt5qerjqMFPhht5y6fWkWmCqFkflF9swcI3bAthe1OcuEia0yiaKJRicGP59aIWIDkwf7Vq2VA/640?wx_fmt=png&amp;from=appmsg"></section><section><span><br mpa-from-tpl="t"></span></section><section data-mpa-template="t" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><p data-mid="">1</p></section><section data-mid="" mpa-from-tpl="t"><img data-imgfileid="100051065" data-ratio="0.0457516339869281" data-w="306" data-src="https://mmbiz.qpic.cn/mmbiz_png/RWYKNtnymfR4EkuMtF9JCxFxTVibmianCIqY5JkWOqhYo27OKv8IKK3uyLVGicHNa3UDlQiaetkwxVxWocAc8eEBIw/640?wx_fmt=png" src="https://mmbiz.qpic.cn/mmbiz_png/RWYKNtnymfR4EkuMtF9JCxFxTVibmianCIqY5JkWOqhYo27OKv8IKK3uyLVGicHNa3UDlQiaetkwxVxWocAc8eEBIw/640?wx_fmt=png"></section><section data-mid="" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><p data-mid="">assays</p></section></section></section></section></section><p><br></p><section><span>储存一系列表达量矩阵，包括不同数据来源的原始表达量（count）、均一化（data）、归一化（scale.data）数据；储存数据特征，包括基因均值、离散系数等和高变基因列表等。</span></section><section><br></section><section><span>在v5中，assays的RNA下多了一层layers，并将counts、data以及scale.data归类到layers层级之下，这也是和v4最大的区别。</span></section><section><br></section><section><img data-imgfileid="100051054" data-ratio="0.6194444444444445" data-type="png" data-w="1080" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6lf47VIt5qerjqMFPhht5y69mJ5je4UQPMpkowLibm32IB1byeg4VibqIq8BMh9ibbkAy0O65dBwy8icQ/640?wx_fmt=png&amp;from=appmsg" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6lf47VIt5qerjqMFPhht5y69mJ5je4UQPMpkowLibm32IB1byeg4VibqIq8BMh9ibbkAy0O65dBwy8icQ/640?wx_fmt=png&amp;from=appmsg"></section><section><br></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>head</span>(seurat_object@assays$RNA@layers$counts) <span>#无基因名，仅表达量信息</span></code></pre></section><p><br></p><section><img data-imgfileid="100051050" data-ratio="0.2972222222222222" data-type="png" data-w="1080" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6lf47VIt5qerjqMFPhht5y6KrjcnRMMFCTEoMdP8qAzGyrZMYmELpsKHOUEDUGjWlfzyGOo7BUGIw/640?wx_fmt=png&amp;from=appmsg" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6lf47VIt5qerjqMFPhht5y6KrjcnRMMFCTEoMdP8qAzGyrZMYmELpsKHOUEDUGjWlfzyGOo7BUGIw/640?wx_fmt=png&amp;from=appmsg"></section><section><br></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>head</span>(seurat_object@assays$RNA$counts)</code></pre></section><p><br></p><section><img data-imgfileid="100051052" data-ratio="0.5055555555555555" data-type="png" data-w="1080" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6lf47VIt5qerjqMFPhht5y62zGa4NT0QJr9bIsrSmTDSDhTwHWy4DltvRHGxiaxMkRwm77jJobJoSg/640?wx_fmt=png&amp;from=appmsg" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6lf47VIt5qerjqMFPhht5y62zGa4NT0QJr9bIsrSmTDSDhTwHWy4DltvRHGxiaxMkRwm77jJobJoSg/640?wx_fmt=png&amp;from=appmsg"></section><section><br></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>#查看标准化稀疏矩阵：</span><br mpa-from-tpl="t"><span>head</span>(seurat_object@assays$RNA$data)</code></pre></section><p><br></p><section><span></span></section><section><img data-imgfileid="100051053" data-ratio="0.5055555555555555" data-type="png" data-w="1080" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6lf47VIt5qerjqMFPhht5y6y4koz0cSpTPtngmmNOthemeJw0UTXzNUBCNicz63HTricYoO6pBUyL3A/640?wx_fmt=png&amp;from=appmsg" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6lf47VIt5qerjqMFPhht5y6y4koz0cSpTPtngmmNOthemeJw0UTXzNUBCNicz63HTricYoO6pBUyL3A/640?wx_fmt=png&amp;from=appmsg"></section><section><br></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>#查看归一化数据：</span><br mpa-from-tpl="t"><span>seurat_object</span>@assays$RNA$scale.data[1:6,7:8]</code></pre></section><p><br></p><section><span></span></section><section><img data-imgfileid="100051055" data-ratio="0.19444444444444445" data-type="png" data-w="1080" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6lf47VIt5qerjqMFPhht5y6oleMNthic6JZItWwESsKFtJHLZ2tj0VKcvtLP0OzyvGZRbsXdJNImWA/640?wx_fmt=png&amp;from=appmsg" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6lf47VIt5qerjqMFPhht5y6oleMNthic6JZItWwESsKFtJHLZ2tj0VKcvtLP0OzyvGZRbsXdJNImWA/640?wx_fmt=png&amp;from=appmsg"></section><section><span><br></span></section><section><span>此外，新增cells、features等LogMap结构用于存储细胞条码和基因名。cells中存放每个单细胞的条形码信息，features中存放基因名信息。</span></section><section><span><br mpa-from-tpl="t"></span></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>#查看cells和features：</span><br mpa-from-tpl="t"><span>seurat_object</span>[['RNA']]<br mpa-from-tpl="t"><span>head</span>(Cells(seurat_object[['RNA']]))<br mpa-from-tpl="t"><span>head</span>(Features(seurat_object[['RNA']]))</code></pre></section><p><br></p><section><span></span></section><section><img data-imgfileid="100051056" data-ratio="0.31574074074074077" data-type="png" data-w="1080" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6lf47VIt5qerjqMFPhht5y6DXZg3JBtFTRX9HrW8tpnoyOMgKxZUVgib8Vsibc0jTiaWf3kp915MUMow/640?wx_fmt=png&amp;from=appmsg" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6lf47VIt5qerjqMFPhht5y6DXZg3JBtFTRX9HrW8tpnoyOMgKxZUVgib8Vsibc0jTiaWf3kp915MUMow/640?wx_fmt=png&amp;from=appmsg"></section><section><br></section><section><span>assays下的meta.data中包含了v4中meta.feature和var.features：</span></section><section><br></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>#查看assays下的meta.data：</span><br mpa-from-tpl="t"><span>head</span>(seurat_object@assays$RNA@meta.data)</code></pre></section><p><br></p><section><span></span></section><section><img data-imgfileid="100051058" data-ratio="0.5259259259259259" data-type="png" data-w="1080" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6lf47VIt5qerjqMFPhht5y6fSk9922s7UoANt5U982P7EQsF6ibcQc3JHAWRtNnQqyTln6lTEOH0TA/640?wx_fmt=png&amp;from=appmsg" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6lf47VIt5qerjqMFPhht5y6fSk9922s7UoANt5U982P7EQsF6ibcQc3JHAWRtNnQqyTln6lTEOH0TA/640?wx_fmt=png&amp;from=appmsg"></section><section><span><br mpa-from-tpl="t"></span></section><section data-mpa-template="t" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><p data-mid="">2</p></section><section data-mid="" mpa-from-tpl="t"><img data-imgfileid="100051070" data-ratio="0.0457516339869281" data-w="306" data-src="https://mmbiz.qpic.cn/mmbiz_png/RWYKNtnymfR4EkuMtF9JCxFxTVibmianCIqY5JkWOqhYo27OKv8IKK3uyLVGicHNa3UDlQiaetkwxVxWocAc8eEBIw/640?wx_fmt=png" src="https://mmbiz.qpic.cn/mmbiz_png/RWYKNtnymfR4EkuMtF9JCxFxTVibmianCIqY5JkWOqhYo27OKv8IKK3uyLVGicHNa3UDlQiaetkwxVxWocAc8eEBIw/640?wx_fmt=png"></section><section data-mid="" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><p data-mid="">meta.data</p></section></section></section></section></section><p><br></p><section><span>记录所有细胞的描述信息，如样本、UMI数、检测基因数、分群信息、细胞注释等：</span></section><section><br></section><section><img data-imgfileid="100051057" data-ratio="0.35833333333333334" data-type="png" data-w="1080" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6lf47VIt5qerjqMFPhht5y6icsjJYdgNVchX4FHLgZvBWunytTq2dPtPmSCgQjCNZicicdbSYhxJMOUw/640?wx_fmt=png&amp;from=appmsg" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6lf47VIt5qerjqMFPhht5y6icsjJYdgNVchX4FHLgZvBWunytTq2dPtPmSCgQjCNZicicdbSYhxJMOUw/640?wx_fmt=png&amp;from=appmsg"></section><section><br mpa-from-tpl="t"></section><section data-mpa-template="t" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><p data-mid="">3</p></section><section data-mid="" mpa-from-tpl="t"><img data-imgfileid="100051071" data-ratio="0.0457516339869281" data-w="306" data-src="https://mmbiz.qpic.cn/mmbiz_png/RWYKNtnymfR4EkuMtF9JCxFxTVibmianCIqY5JkWOqhYo27OKv8IKK3uyLVGicHNa3UDlQiaetkwxVxWocAc8eEBIw/640?wx_fmt=png" src="https://mmbiz.qpic.cn/mmbiz_png/RWYKNtnymfR4EkuMtF9JCxFxTVibmianCIqY5JkWOqhYo27OKv8IKK3uyLVGicHNa3UDlQiaetkwxVxWocAc8eEBIw/640?wx_fmt=png"></section><section data-mid="" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><p data-mid="">reduction</p></section></section></section></section></section><p><br></p><section><span>记录细胞的降维信息：</span></section><section><br></section><section><img data-imgfileid="100051059" data-ratio="0.5101851851851852" data-type="png" data-w="1080" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6lf47VIt5qerjqMFPhht5y66COFrLaXvGQXnlyhoRQxn7FLKdJiceXf9ibGZ8M19rDNVCUpgDzib842w/640?wx_fmt=png&amp;from=appmsg" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6lf47VIt5qerjqMFPhht5y66COFrLaXvGQXnlyhoRQxn7FLKdJiceXf9ibGZ8M19rDNVCUpgDzib842w/640?wx_fmt=png&amp;from=appmsg"><span></span></section><section><span><br mpa-from-tpl="t"></span></section><section data-mpa-template="t" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><p data-mid="">4</p></section><section data-mid="" mpa-from-tpl="t"><img data-imgfileid="100051074" data-ratio="0.0457516339869281" data-w="306" data-src="https://mmbiz.qpic.cn/mmbiz_png/RWYKNtnymfR4EkuMtF9JCxFxTVibmianCIqY5JkWOqhYo27OKv8IKK3uyLVGicHNa3UDlQiaetkwxVxWocAc8eEBIw/640?wx_fmt=png" src="https://mmbiz.qpic.cn/mmbiz_png/RWYKNtnymfR4EkuMtF9JCxFxTVibmianCIqY5JkWOqhYo27OKv8IKK3uyLVGicHNa3UDlQiaetkwxVxWocAc8eEBIw/640?wx_fmt=png"></section><section data-mid="" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><p data-mid="">others</p></section></section></section></section></section><p><br></p><section><span>active.ident</span><span>：当前默认的细胞注释信息</span></section><section><br></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>head</span>(seurat_object@active.ident)</code></pre></section><p><br></p><section><img data-imgfileid="100051060" data-ratio="0.1962962962962963" data-type="png" data-w="1080" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6lf47VIt5qerjqMFPhht5y6mxPQJricfKdxZXxNbsWsQWQU4y2ZfKibUpzibyyuXHFib9OBGTbbA58DyA/640?wx_fmt=png&amp;from=appmsg" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6lf47VIt5qerjqMFPhht5y6mxPQJricfKdxZXxNbsWsQWQU4y2ZfKibUpzibyyuXHFib9OBGTbbA58DyA/640?wx_fmt=png&amp;from=appmsg"></section><section><span><br></span></section><section><span>graphs</span><span>：细胞临近图</span></section><section><span>images</span><span>：图片信息，主要用于空间转录组</span></section><section><span>project.name</span><span>：项目名称，创建时命名</span></section><section><span>version</span><span>：创建该对象时使用的seurat版本</span></section><section><span>commands</span><span>：数据分析过程中的每个步骤使用的参数命令，包括命令执行的时间和日期</span></section><section><br></section><section><span>总体来说，变化主要体现在assays上，其它结构基本一致。好啦，今日分享毕！</span></section><section><span><br mpa-from-tpl="t"></span></section><section data-mpa-template="t" mpa-from-tpl="t"><section data-mpa-template="t" mpa-from-tpl="t"><section mpa-from-tpl="t"><section powered-by="xiumi.us" mpa-from-tpl="t"><section mpa-from-tpl="t"><section mpa-from-tpl="t"><section powered-by="xiumi.us" mpa-from-tpl="t"><section mpa-from-tpl="t"><section mpa-from-tpl="t"><svg viewbox="0 0 1 1" mpa-from-tpl="t"></svg></section></section></section></section><section mpa-from-tpl="t"><section powered-by="xiumi.us" mpa-from-tpl="t"><section mpa-from-tpl="t"><p><strong><span mpa-is-content="t">参考资料：</span></strong><span mpa-is-content="t"></span></p></section></section></section></section></section></section></section></section><section><span>https://satijalab.org/seurat/articles/announcements.html</span></section><section><span><br></span></section><section><span><br></span></section><p><strong><span>*未经许可，不得以任何方式复制或抄袭本篇文章之部分或全部内容。版权所有，侵权必究。</span></strong></p><p><br></p><section data-role="outer" label="Powered by 135editor.com"><section data-tools="135编辑器" data-id="105648"><section><section data-role="outer" label="Powered by 135editor.com"><section data-role="paragraph"><section data-role="outer" label="Powered by 135editor.com"><section data-tools="135编辑器" data-id="105648"><section><section><img data-ratio="0.8780487804878049" data-type="png" data-w="41" data-width="100%" data-imgfileid="100051062" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6kCKJYcEqEIfoJYG621mPJE8VibmibGU0Jxic9iabARVRH0FT6BNE8VAglWFXBPibFAU7a6tWGibSs8wyUg/640?wx_fmt=png" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6kCKJYcEqEIfoJYG621mPJE8VibmibGU0Jxic9iabARVRH0FT6BNE8VAglWFXBPibFAU7a6tWGibSs8wyUg/640?wx_fmt=png"></section><section><section><section data-width="35%"><section><section data-width="100%"><img data-imgfileid="100051063" data-ratio="1" data-type="jpeg" data-w="860" data-width="100%" title="SCIPainter 30cm二维码.jpg" data-src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/tgUVxVRjT6kCKJYcEqEIfoJYG621mPJEv5etCBwHicqbEPwnVrkpaasxqaVibM4mT2JdIuN6yTlYWDD4mL5A427A/640?wx_fmt=jpeg" src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/tgUVxVRjT6kCKJYcEqEIfoJYG621mPJEv5etCBwHicqbEPwnVrkpaasxqaVibM4mT2JdIuN6yTlYWDD4mL5A427A/640?wx_fmt=jpeg"></section></section></section><section data-width="50%"><section><section data-brushtype="text"><span><strong># SCIPainter</strong></span></section><section data-brushtype="text" hm_fix="361:593"><p>基迪奥旗下绘图公众号</p><p>分享科研绘图技能与工具</p><p>欢迎关注与转发~</p></section></section></section></section></section></section></section></section></section></section><section><br></section></section></section><section data-role="paragraph"><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><img data-ratio="1" data-type="gif" data-w="400" data-imgfileid="100051061" data-src="https://mmbiz.qpic.cn/sz_mmbiz_gif/tgUVxVRjT6kCKJYcEqEIfoJYG621mPJEgMd0aMPtmrDjiaX8sBhfhicVteeHf1JicexSpUbS3fdS9SiboUVN7guaPw/640?wx_fmt=gif" src="https://mmbiz.qpic.cn/sz_mmbiz_gif/tgUVxVRjT6kCKJYcEqEIfoJYG621mPJEgMd0aMPtmrDjiaX8sBhfhicVteeHf1JicexSpUbS3fdS9SiboUVN7guaPw/640?wx_fmt=gif"></section></section></section><section><section powered-by="xiumi.us"><section><p><span><strong>你的好友拍了拍你</strong></span></p><p><span><strong>并请你帮她点一下</strong></span><strong><span>“分享”</span></strong><span><strong><span>~</span></strong></span></p></section></section></section></section></section><p><br></p></section></section><section><span><br></span></section><p><mp-style-type data-value="10000"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/OT50BqSPvQPlnbEBBrpnIA",target="_blank" rel="noopener noreferrer">原文链接</a>
