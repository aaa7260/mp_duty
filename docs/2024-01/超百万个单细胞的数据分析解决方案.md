---
title: "超百万个单细胞的数据分析解决方案"
date: 2024-01-11T08:16:03Z
draft: ["false"]
tags: [
  "fetched",
  "单细胞天地"
]
categories: ["Acdemic"]
---
超百万个单细胞的数据分析解决方案 by 单细胞天地
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><blockquote data-tool="mdnice编辑器"><p>前面我们提到了：超百万个单细胞的数据集越来越多了，但是绝大部分人的电脑或者普通服务器会遇到的数据分析困难是内存不足，当然了，一味的增加内存到1T甚至几个T，倒也不是很贵。虽然解决了内存不足的问题，但是另外一个弊端是CPU的分析速度问题，超百万个单细胞的数据处理的每个步骤，降维聚类分群，都是耗时十几分钟甚至几个小时。这个时候就迫切需要一个神级大家解决方案，就是从CPU转为GPU。</p></blockquote><p data-tool="mdnice编辑器">位于美国加利福利亚的NVIDIA团队最近在预印本分享了他们的GPU一体化单细胞数据分析解决方案，标题是：《Accelerating single-cell genomic analysis with GPUs》，它们提出来的RAPIDS主要是3个模块：</p><ul data-tool="mdnice编辑器"><li><section>cuDF for dataframe manipulation,</section></li><li><section>cuML for machine learning algorithms,</section></li><li><section>cuGraph for accelerated graph analytics.</section></li></ul><p data-tool="mdnice编辑器">RAPIDS is an open-source suite of Python libraries that use GPU computing to accelerate data science workflows.</p><p data-tool="mdnice编辑器">如下所示的降维聚类分群流程：</p><p><img data-galleryid="" data-ratio="1.5447897623400366" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQospm1hM4PicKpcVlcrvASiaHMBPn1uic1oT7FHvCCQjGOpCNwBsphMjZN2AE2GtvBcvaG2YrKKKicKw/640?wx_fmt=png" data-type="png" data-w="1094" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQospm1hM4PicKpcVlcrvASiaHMBPn1uic1oT7FHvCCQjGOpCNwBsphMjZN2AE2GtvBcvaG2YrKKKicKw/640?wx_fmt=png"></p><figure data-tool="mdnice编辑器"><figcaption>降维聚类分群流程</figcaption></figure><p data-tool="mdnice编辑器">输入数据就是一个常规的表达量矩阵，列是细胞，可以有几百万个细胞，行是基因，通常是三五万个基因。它们会使用常规的Scanpy/AnnData格式存储，跟大家在CPU模式下的数据分析一模一样的，所以大家可以无缝切换到GPU摸索的单细胞数据分析。</p><p data-tool="mdnice编辑器">在10x的官方网站有一个超百万个单细胞的数据集 ：https://support.10xgenomics.com/single-cell-gene-expression/datasets/1.3.0/1M_neurons，简单的注册就可以下载，同样的降维聚类分群后很容易区分处理  major brain cell types (excitatory neurons, inhibitory neurons, astrocytes, oligodendrocytes, microglia, and pericytes) ，位于美国加利福利亚的NVIDIA团队就使用不同型号的GPU去跟传统的CPU进行对比：</p><p><img data-galleryid="" data-ratio="0.9522222222222222" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQospm1hM4PicKpcVlcrvASia5iaC10LyHdBRYb3oSjkHlSe3DhtuNTDO7FKoVTT8FlnmHh8BXV1uMpw/640?wx_fmt=png" data-type="png" data-w="1800" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQospm1hM4PicKpcVlcrvASia5iaC10LyHdBRYb3oSjkHlSe3DhtuNTDO7FKoVTT8FlnmHh8BXV1uMpw/640?wx_fmt=png"></p><figure data-tool="mdnice编辑器"><figcaption>不同型号的GPU去跟传统的CPU进行对比</figcaption></figure><p data-tool="mdnice编辑器">可以看到，本来应该是4小时的时间消耗，因为使用了 <em>NVIDIA DGX-1, or 1-8 V100 GPUs on a DGX-1.</em> 耗时可以缩短到几分钟。</p><p data-tool="mdnice编辑器">数据分析的代码是公开的，在：https://github.com/clara-parabricks/rapids-single-cell-examples ，而且数据也是公开可以获取的，所以理论上大家可以马上复现出来。但是，首先你需要有一个GPU哦！</p><p data-tool="mdnice编辑器">这个时候的，降维聚类分群步骤仍然是一样的，参考前面的例子：<a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247497956&amp;idx=1&amp;sn=5d4deb7cf7b7848b3e2273cbd663bb6a&amp;scene=21#wechat_redirect" data-linktype="2">人人都能学会的单细胞聚类分群注释</a>  ，这样的单细胞基础认知，也可以看基础10讲：</p><ul data-tool="mdnice编辑器"><li><section><a href="https://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247486076&amp;idx=1&amp;sn=52bb851d7dc23461233a2cf458736151&amp;scene=21#wechat_redirect" data-linktype="2">01. 上游分析流程</a></section></li><li><section><a href="https://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247486082&amp;idx=1&amp;sn=03cadceffb2c14ba95d97fe5caf38d94&amp;scene=21#wechat_redirect" data-linktype="2">02.课题多少个样品，测序数据量如何</a></section></li><li><section><a href="https://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247486088&amp;idx=1&amp;sn=3a115338ee4937d20caab78627237553&amp;scene=21#wechat_redirect" data-linktype="2">03. 过滤不合格细胞和基因（数据质控很重要）</a></section></li><li><section><a href="https://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247486096&amp;idx=1&amp;sn=1a99c4c5800b7e0287db3e8ef369fab8&amp;scene=21#wechat_redirect" data-linktype="2">04. 过滤线粒体核糖体基因</a></section></li><li><section><a href="https://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247486098&amp;idx=1&amp;sn=bf9a71df848d74fe665ce7d5e283d5ff&amp;scene=21#wechat_redirect" data-linktype="2">05. 去除细胞效应和基因效应</a></section></li><li><section><a href="https://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247486260&amp;idx=1&amp;sn=c6abf658de73594d1d77d8e1ffa7d153&amp;scene=21#wechat_redirect" data-linktype="2">06.单细胞转录组数据的降维聚类分群</a></section></li><li><section><a href="https://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247486271&amp;idx=1&amp;sn=638b434b6deee63206af1c0eeda175ab&amp;scene=21#wechat_redirect" data-linktype="2">07.单细胞转录组数据处理之细胞亚群注释</a></section></li><li><section><a href="https://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247486278&amp;idx=1&amp;sn=91250ef733833ff00371818b215dc124&amp;scene=21#wechat_redirect" data-linktype="2">08.把拿到的亚群进行更细致的分群</a></section></li><li><section><a href="https://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247486287&amp;idx=1&amp;sn=49627c638ff9c04418282c53518aa7c7&amp;scene=21#wechat_redirect" data-linktype="2">09.单细胞转录组数据处理之细胞亚群比例比较</a></section></li></ul></section><p><br></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/vO4zS8CPtZ8d_xM36fhVpQ",target="_blank" rel="noopener noreferrer">原文链接</a>
