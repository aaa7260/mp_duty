---
title: "探索AnnData数据对象，揭开它的"
date: 2024-01-25T00:14:10Z
draft: ["false"]
tags: [
  "fetched",
  "单细胞天地"
]
categories: ["Acdemic"]
---
探索AnnData数据对象，揭开它的 by 单细胞天地
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><blockquote data-tool="mdnice编辑器"><p>在前面的基于<strong>《 <a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247527976&amp;idx=2&amp;sn=fb9adbb501958fdade7071a5f43a66b1&amp;scene=21#wechat_redirect" data-linktype="2">scanpy库读取几种常见格式的单细胞数据文件汇总</a> 》</strong>，可以看出我们得到的都是一个<strong>AnnData</strong>数据对象，如上图所示，然而这个数据对象关系到我们后面的数据分析，比如质控，降维等。<code>AnnData</code> 最初是为 <code>scanpy</code> 这个用于单细胞数据分析的 Python 库设计的。它与 <code>scanpy</code> 紧密结合，可以无缝地在 <code>scanpy</code> 中使用。</p></blockquote><p><img data-galleryid="" data-imgfileid="100044356" data-ratio="0.19522776572668113" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wzc3UjPWNOxhzr16jcPEnDTGHXDFOleSgzrSic79yhAfxxv7mhBOPLKd9KDkefERQgYic26bgxQ9hZA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="461" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wzc3UjPWNOxhzr16jcPEnDTGHXDFOleSgzrSic79yhAfxxv7mhBOPLKd9KDkefERQgYic26bgxQ9hZA/640?wx_fmt=png&amp;from=appmsg"></p><p data-tool="mdnice编辑器">那么认识<strong>AnnData</strong>这个数据对象，会使我们更好的进行下一步分析。这个<strong>AnnData</strong>数据对象到底是什么呢？让我们一起来揭开它的神秘面纱，让我们对它有一个全面的认识！</p><p data-tool="mdnice编辑器">scanpy使用<strong>AnnData</strong>来存储要分析的单细胞测序数据，使用这种数据对象能使我们更快、更方便地操作数据，分析数据。类似于Seurat包的seurat对象，seurat对象也是用于存储单细胞数据，比如基因的表达矩阵等，如果你对seurat对象很熟悉，那么上手这个<strong>AnnData</strong>对象会比较快，流畅地使用<strong>AnnData</strong>这个数据对象。</p><p data-tool="mdnice编辑器">那<strong>AnnData</strong>到底长什么样子呢？别急呢！看下图，你就会知道：</p><p><img data-galleryid="" data-imgfileid="100044357" data-ratio="0.9915074309978769" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wzc3UjPWNOxhzr16jcPEnDT6gXumiaibWYKXrqLqHQhv57a6HtwZBfloCLLKgg2lsWSNCml5N5XY5Nw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="471" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wzc3UjPWNOxhzr16jcPEnDT6gXumiaibWYKXrqLqHQhv57a6HtwZBfloCLLKgg2lsWSNCml5N5XY5Nw/640?wx_fmt=png&amp;from=appmsg"></p><p data-tool="mdnice编辑器">快看，它原来长这个样子，是不是和你想象中的不一样呢！也许这样地看一眼，还不能全面认识它，那我们通过实战来进一步地认识它吧，摘掉它的神秘面纱，看清楚它！</p><p data-tool="mdnice编辑器"><strong>战前热身</strong>：</p><p data-tool="mdnice编辑器">实战需要用到<strong>scanpy</strong>这个Python库，需要安装这个库:</p><pre data-tool="mdnice编辑器"><span></span><code>pip install scanpy -i https://pypi.tuna.tsinghua.edu.cn/simple<br></code></pre><p data-tool="mdnice编辑器">如果你已经安装了这个库，就不用安装了。</p><p data-tool="mdnice编辑器"><strong>实战：</strong></p><p data-tool="mdnice编辑器">我使用scanpy内置的<strong>pbmc68k_reduced</strong>这个实例数据集进行探索，这是一个经过处理好的数据集，有利于我们进一步去探索。</p><pre data-tool="mdnice编辑器"><span></span><code><span>#加载scanpy库</span><br><span>import</span> scanpy <span>as</span>  sc<br><br><span>#加载pbmc68k_reduced内置数据集</span><br>adata=sc.datasets.pbmc68k_reduced()<br><br><span>#查看数据集</span><br>print(adata)<br></code></pre><p data-tool="mdnice编辑器"><strong>结果如下：</strong></p><pre data-tool="mdnice编辑器"><span></span><code>AnnData object <span>with</span> n_obs × n_vars = <span>700</span> × <span>765</span><br>    obs: <span>'bulk_labels'</span>, <span>'n_genes'</span>, <span>'percent_mito'</span>, <span>'n_counts'</span>, <span>'S_score'</span>, <span>'G2M_score'</span>, <span>'phase'</span>, <span>'louvain'</span><br>    var: <span>'n_counts'</span>, <span>'means'</span>, <span>'dispersions'</span>, <span>'dispersions_norm'</span>, <span>'highly_variable'</span><br>    uns: <span>'bulk_labels_colors'</span>, <span>'louvain'</span>, <span>'louvain_colors'</span>, <span>'neighbors'</span>, <span>'pca'</span>, <span>'rank_genes_groups'</span><br>    obsm: <span>'X_pca'</span>, <span>'X_umap'</span><br>    varm: <span>'PCs'</span><br>    obsp: <span>'distances'</span>, <span>'connectivities'</span><br></code></pre><p data-tool="mdnice编辑器">可以看出这数据集是一个<strong>AnnData数据对象</strong>，一共有<strong>700个细胞</strong>，<strong>765个基因</strong>。</p><p data-tool="mdnice编辑器">让我们进一步探索吧！</p><h4 data-tool="mdnice编辑器"><span></span>1. obs<span></span></h4><p data-tool="mdnice编辑器"><strong>AnnData的obs</strong>存储的是这个样本的所有细胞的信息，比如每一个细胞的线粒体比率；样本(所有细胞)的临床信息也可以保存在里面，比如样本(所有细胞)是normal还是disease。我们通过以下代码进一步探索：</p><pre data-tool="mdnice编辑器"><span></span><code><span>#查看pbmc68k_reduced这个数据集的obs前5行信息</span><br>print(adata.obs.head())<br></code></pre><p data-tool="mdnice编辑器"><strong>结果如下：</strong></p><pre data-tool="mdnice编辑器"><span></span><code>                      bulk_labels  n_genes  ...  phase  louvain<br>index                                       ...                <br>AAAGCCTGGCTAAC-1   CD14+ Monocyte     1003  ...     G1        1<br>AAATTCGATGCACA-1        Dendritic     1080  ...      S        1<br>AACACGTGGTCTTT-1         CD56+ NK     1228  ...     G1        3<br>AAGTGCACGTGCTA-1  CD4+/CD25 T Reg     1007  ...    G2M        9<br>ACACGAACGGAGTG-1        Dendritic     1178  ...     G1        2<br></code></pre><p data-tool="mdnice编辑器">可以看出obs保存每一个细胞的每列信息（ <strong>bulk_labels ，n_genes, ... ,phase ,louvain</strong>）,我们看<strong>bulk_labels</strong>这列的值，有<strong>NK、CD4+/CD25 T Reg</strong>的字样，可知这是免疫细胞，所以<strong>bulk_labels</strong>这列保存的是每个细胞是属于什么细胞类型，我们再看看<strong>phase</strong>这列的值，有<strong>G1、S、G2M</strong>字样，可知这是一个细胞周期（<strong>G1期、S期、G2M期</strong>），说明这列对应与每个细胞所处的细胞周期，比如第一行表示这个细胞属于<strong>G1</strong>期。</p><h4 data-tool="mdnice编辑器"><span></span>2.var<span></span></h4><p data-tool="mdnice编辑器"><strong>AnnData的var</strong>存储的是这个样本的所有基因信息，我们来查看一下：</p><pre data-tool="mdnice编辑器"><span></span><code><span>#查看pbmc68k_reduced这个数据集的var前5行信息</span><br>print(adata.var.head())<br></code></pre><p data-tool="mdnice编辑器"><strong>结果如下：</strong></p><pre data-tool="mdnice编辑器"><span></span><code>            n_counts     means  dispersions  dispersions_norm  highly_variable<br>index                                                                         <br>HES4     <span>1153.387451</span>  <span>0.592365</span>     <span>2.028047</span>          <span>2.771764</span>             <span>True</span><br>TNFRSF4   <span>304.358154</span>  <span>0.193332</span>     <span>1.760724</span>          <span>2.746426</span>             <span>True</span><br>SSU72    <span>2530.272705</span>  <span>1.019981</span>     <span>1.208284</span>         <span>-0.631160</span>            <span>False</span><br>PARK7    <span>7451.664062</span>  <span>1.828078</span>     <span>1.288261</span>         <span>-0.544716</span>            <span>False</span><br>RBP7      <span>272.811035</span>  <span>0.174943</span>     <span>1.842789</span>          <span>3.192285</span>             <span>True</span><br><br></code></pre><p data-tool="mdnice编辑器">可以看出这<strong>var</strong>里面有<strong>5列</strong>关于基因的信息，我们看<strong>highly_variable</strong>这列，可知这列是关于这些基因是否是高变基因的信息。</p><h4 data-tool="mdnice编辑器"><span></span>3.X<span></span></h4><p data-tool="mdnice编辑器"><strong>AnnData的X</strong>存储的是基因表达矩阵的数据，我们来查看一下：</p><pre data-tool="mdnice编辑器"><span></span><code>print(adata.X)<br></code></pre><p data-tool="mdnice编辑器"><strong>结果如下:</strong></p><pre data-tool="mdnice编辑器"><span></span><code>array([[<span>-0.326</span>, <span>-0.191</span>, <span>-0.728</span>, ..., <span>-0.21</span> , <span>-0.636</span>,  <span>4.011</span>],<br>       [ <span>1.171</span>, <span>-0.191</span>,  <span>0.795</span>, ..., <span>-0.21</span> ,  <span>2.63</span> , <span>-0.49</span> ],<br>       [<span>-0.326</span>, <span>-0.191</span>,  <span>0.483</span>, ..., <span>-0.21</span> ,  <span>0.663</span>, <span>-0.49</span> ],<br>       ...,<br>       [<span>-0.326</span>, <span>-0.191</span>, <span>-0.728</span>, ..., <span>-0.21</span> , <span>-0.636</span>,  <span>1.226</span>],<br>       [<span>-0.326</span>, <span>-0.191</span>, <span>-0.728</span>, ..., <span>-0.21</span> , <span>-0.636</span>, <span>-0.49</span> ],<br>       [<span>-0.326</span>, <span>-0.191</span>,  <span>0.148</span>, ..., <span>-0.21</span> , <span>-0.636</span>, <span>-0.49</span> ]],<br>      dtype=float32)<br></code></pre><p data-tool="mdnice编辑器">可以看出这是一个已经进行处理过的基因表达矩阵数据，由此可知<strong>AnnData的X</strong>存储的是细胞中所有基因的表达矩阵数据。</p><h4 data-tool="mdnice编辑器"><span></span>4.uns<span></span></h4><p data-tool="mdnice编辑器"><strong>AnnData的uns</strong>存储的是什么呢？我们来查看一下：</p><pre data-tool="mdnice编辑器"><span></span><code><span>#查看pbmc68k_reduced的uns信息</span><br>print(adata.uns)<br></code></pre><p data-tool="mdnice编辑器"><strong>结果如下：</strong></p><pre data-tool="mdnice编辑器"><span></span><code>{<span>'bulk_labels_colors'</span>: array([<span>'#1f77b4'</span>, <span>'#ff7f0e'</span>, <span>'#2ca02c'</span>, <span>'#d62728'</span>, <span>'#9467bd'</span>, <span>'#8c564b'</span>,<br>       <span>'#e377c2'</span>, <span>'#7f7f7f'</span>, <span>'#bcbd22'</span>, <span>'#17becf'</span>], dtype=<span>'&lt;U7'</span>), <span>'louvain'</span>: {<span>'params'</span>: {<span>'random_state'</span>: array([<span>0</span>], dtype=int64), <span>'resolution'</span>: array([<span>1</span>], dtype=int64)}}, <span>'louvain_colors'</span>: array([<span>'#023fa5'</span>, <span>'#7d87b9'</span>, <span>'#bec1d4'</span>, <span>'#d6bcc0'</span>, <span>'#bb7784'</span>, <span>'#8e063b'</span>,<br>       <span>'#4a6fe3'</span>, <span>'#8595e1'</span>, <span>'#b5bbe3'</span>, <span>'#e6afb9'</span>, <span>'#e07b91'</span>], dtype=<span>'&lt;U7'</span>), <span>'neighbors'</span>: {<span>'params'</span>: {<span>'method'</span>: <span>'umap'</span>, <span>'n_neighbors'</span>: array([<span>10</span>], dtype=int64)}}, <span>'pca'</span>: {<span>'variance'</span>: array([<span>30.928047</span> , <span>21.182432</span> , <span>14.686322</span> , <span>11.570731</span> ,  <span>9.232856</span> ,<br>        <span>7.3497834</span>,  <span>4.338316</span> ,  <span>3.197439</span> ,  <span>3.1584399</span>,  <span>2.910167</span> ,<br>        <span>2.649945</span> ,  <span>2.540031</span> ,  <span>2.4057367</span>,  <span>2.3872852</span>,  <span>2.2644212</span>,<br>        <span>2.2250588</span>,  <span>2.189688</span> ,  <span>2.134691</span> ,  <span>2.0775423</span>,  <span>2.0560663</span>,<br>        <span>2.007874</span> ,  <span>1.9969993</span>,  <span>1.9606696</span>,  <span>1.9441428</span>,  <span>1.9129871</span>,<br>        <span>1.9063067</span>,  <span>1.8529838</span>,  <span>1.8260264</span>,  <span>1.7946786</span>,  <span>1.7489465</span>,<br>        <span>1.7449841</span>,  <span>1.7298484</span>,  <span>1.70099</span>  ,  <span>1.6571085</span>,  <span>1.6406441</span>,<br>        <span>1.6235017</span>,  <span>1.6012688</span>,  <span>1.5806534</span>,  <span>1.5531204</span>,  <span>1.5331998</span>,<br>        <span>1.5166894</span>,  <span>1.4852371</span>,  <span>1.4748584</span>,  <span>1.4530103</span>,  <span>1.4340347</span>,<br>        <span>1.4083625</span>,  <span>1.375356</span> ,  <span>1.3701098</span>,  <span>1.356156</span> ,  <span>1.3449155</span>],<br>      dtype=float32), <span>'variance_ratio'</span>: array([<span>0.09770954</span>, <span>0.06692067</span>, <span>0.04639781</span>, <span>0.03655487</span>, <span>0.02916893</span>,<br>       <span>0.02321983</span>, <span>0.01370584</span>, <span>0.01010152</span>, <span>0.00997831</span>, <span>0.00919395</span>,<br>       <span>0.00837185</span>, <span>0.0080246</span> , <span>0.00760033</span>, <span>0.00754204</span>, <span>0.00715388</span>,<br>       <span>0.00702952</span>, <span>0.00691778</span>, <span>0.00674403</span>, <span>0.00656348</span>, <span>0.00649563</span>,<br>       <span>0.00634338</span>, <span>0.00630903</span>, <span>0.00619425</span>, <span>0.00614204</span>, <span>0.00604361</span>,<br>       <span>0.00602251</span>, <span>0.00585405</span>, <span>0.00576888</span>, <span>0.00566984</span>, <span>0.00552537</span>,<br>       <span>0.00551285</span>, <span>0.00546503</span>, <span>0.00537386</span>, <span>0.00523523</span>, <span>0.00518321</span>,<br>       <span>0.00512905</span>, <span>0.00505881</span>, <span>0.00499368</span>, <span>0.0049067</span> , <span>0.00484377</span>,<br>       <span>0.00479161</span>, <span>0.00469224</span>, <span>0.00465945</span>, <span>0.00459043</span>, <span>0.00453048</span>,<br>       <span>0.00444937</span>, <span>0.0043451</span> , <span>0.00432852</span>, <span>0.00428444</span>, <span>0.00424893</span>],<br>      dtype=float32)}, <span>'rank_genes_groups'</span>: {<span>'names'</span>: array([(<span>'RGS19'</span>, <span>'ITM2A'</span>, <span>'CAPG'</span>, <span>'CCL5'</span>, <span>'CD8B'</span>, <span>'C1QA'</span>, <span>'CD79A'</span>, <span>'PRSS57'</span>, <span>'GNLY'</span>, <span>'CST3'</span>),<br>       (<span>'HIST1H4C'</span>, <span>'RPL39'</span>, <span>'GABARAPL2'</span>, <span>'GNLY'</span>, <span>'CD8A'</span>, <span>'PSAP'</span>, <span>'CD79B'</span>, <span>'SNHG7'</span>, <span>'NKG7'</span>, <span>'LYZ'</span>), 。。。。。。<br>       (<span>'LDHB'</span>, <span>'SELT'</span>, <span>'SFPQ'</span>, <span>'MEAF6'</span>, <span>'IMPDH2'</span>, <span>'ADRBK1'</span>, <span>'PDAP1'</span>, <span>'DEK'</span>, <span>'CHST12'</span>, <span>'DNAJC1'</span>)],<br>      dtype=[(<span>'CD4+/CD25 T Reg'</span>, <span>'&lt;U200'</span>), (<span>'CD4+/CD45RA+/CD25- Naive T'</span>, <span>'&lt;U200'</span>), (<span>'CD4+/CD45RO+ Memory'</span>, <span>'&lt;U200'</span>), (<span>'CD8+ Cytotoxic T'</span>, <span>'&lt;U200'</span>), (<span>'CD8+/CD45RA+ Naive Cytotoxic'</span>, <span>'&lt;U200'</span>), (<span>'CD14+ Monocyte'</span>, <span>'&lt;U200'</span>), (<span>'CD19+ B'</span>, <span>'&lt;U200'</span>), (<span>'CD34+'</span>, <span>'&lt;U200'</span>), (<span>'CD56+ NK'</span>, <span>'&lt;U200'</span>), (<span>'Dendritic'</span>, <span>'&lt;U200'</span>)]), <span>'params'</span>: {<span>'groupby'</span>: <span>'bulk_labels'</span>, <span>'method'</span>: <span>'logreg'</span>, <span>'reference'</span>: <span>'rest'</span>, <span>'use_raw'</span>: array([ <span>True</span>])}, <span>'scores'</span>: array([(<span>0.36708045</span>, <span>0.21345432</span>, 。。。。。。。。<br>      dtype=[(<span>'CD4+/CD25 T Reg'</span>, <span>'&lt;f4'</span>), (<span>'CD4+/CD45RA+/CD25- Naive T'</span>, <span>'&lt;f4'</span>), (<span>'CD4+/CD45RO+ Memory'</span>, <span>'&lt;f4'</span>), (<span>'CD8+ Cytotoxic T'</span>, <span>'&lt;f4'</span>), (<span>'CD8+/CD45RA+ Naive Cytotoxic'</span>, <span>'&lt;f4'</span>), (<span>'CD14+ Monocyte'</span>, <span>'&lt;f4'</span>), (<span>'CD19+ B'</span>, <span>'&lt;f4'</span>), (<span>'CD34+'</span>, <span>'&lt;f4'</span>), (<span>'CD56+ NK'</span>, <span>'&lt;f4'</span>), (<span>'Dendritic'</span>, <span>'&lt;f4'</span>)])}}<br></code></pre><p data-tool="mdnice编辑器">哇! ！！这保存的数据这么多，是不是看晕了哈。</p><p data-tool="mdnice编辑器">没关系，我们把这些数据整理一下，选取有用的信息来看,其中的..............................表示数据太多了，省略很多行。</p><p data-tool="mdnice编辑器"><strong>整理结果如下：</strong></p><pre data-tool="mdnice编辑器"><span></span><code>{<span>'pca'</span>: {<span>'variance'</span>: array([<span>30.928047</span> , <span>21.182432</span> , <span>14.686322</span> , <span>11.570731</span> ,  <span>9.232856</span> ,<br>        ..........................................................<br>        <span>1.5166894</span>,  <span>1.4852371</span>,  <span>1.4748584</span>,  <span>1.4530103</span>,  <span>1.4340347</span>,<br>        <span>1.4083625</span>,  <span>1.375356</span> ,  <span>1.3701098</span>,  <span>1.356156</span> ,  <span>1.3449155</span>],<br>      dtype=float32)},<br> <span>'sores'</span>: array([<span>0.36708045</span>, <span>0.21345432</span>, <span>0.25056472</span>, <br>         .................................................................<br>         <span>0.47380558</span>,<span>0.49400362</span>, <span>0.42869335</span>, <span>0.38209128</span>, <span>0.16252884</span>, <span>0.27312252</span>, <span>0.5761109</span>])}<br></code></pre><p data-tool="mdnice编辑器">哈哈，这样是不是简洁了很多，我们再来看看。上面的**'variance'<strong>表示使用scanpy的pca降维函数进行特征降维时，得到的结果方差数据存在这里面；而这个</strong>'sores'<strong>表示的是在使用scanpy的细胞周期评估函数产生的得分数据。由此可知</strong>uns**存储的是一些非结构化metadata信息。</p><h4 data-tool="mdnice编辑器"><span></span>5.obsm<span></span></h4><p data-tool="mdnice编辑器">我们来看下<strong>obsm</strong>存储的是什么信息，代码如下：</p><pre data-tool="mdnice编辑器"><span></span><code>print(adata.obsm)<br></code></pre><p data-tool="mdnice编辑器"><strong>结果如下：</strong></p><pre data-tool="mdnice编辑器"><span></span><code>AxisArrays <span>with</span> keys: X_pca, X_umap<br></code></pre><p data-tool="mdnice编辑器">可以看出<strong>obsm</strong>存储的是pca数据和umap数据。</p><h4 data-tool="mdnice编辑器"><span></span>6.varm<span></span></h4><p data-tool="mdnice编辑器">我们来看下<strong>varm</strong>存储的是什么信息，代码如下：</p><pre data-tool="mdnice编辑器"><span></span><code>print(adata.varm)<br></code></pre><p data-tool="mdnice编辑器"><strong>结果如下：</strong></p><pre data-tool="mdnice编辑器"><span></span><code>AxisArrays <span>with</span> keys: PCs<br></code></pre><p data-tool="mdnice编辑器">可以看出<strong>varm</strong>存储的是一些关于进行pca时，产生的主成分信息，这个我们一般不会用到。</p><p data-tool="mdnice编辑器"><strong>经过实战，通过对AnnData的常用信息进行探索，应该对AnnData这个数据对象有了初步的全面认识吧！</strong></p><h3 data-tool="mdnice编辑器"><span></span>凭空创建一个<code>AnnData</code> 对象<span></span></h3><p data-tool="mdnice编辑器">下面是一个简单的示例，演示了如何创建和操作 <code>AnnData</code> 对象：</p><pre data-tool="mdnice编辑器"><span></span><code>import anndata<br>import numpy as np<br><br><span># 创建一个 AnnData 对象</span><br>adata = anndata.AnnData(X=np.random.rand(<span>10</span>, <span>5</span>), obs={<span>'sample_names'</span>: range(<span>10</span>)}, var={<span>'gene_names'</span>: range(<span>5</span>)})<br><br><span># 添加细胞和基因的元数据</span><br>adata.obs[<span>'cell_types'</span>] = [<span>'Type_A'</span>, <span>'Type_B'</span>] * <span>5</span><br>adata.var[<span>'gene_symbols'</span>] = [<span>'Gene_A'</span>, <span>'Gene_B'</span>, <span>'Gene_C'</span>, <span>'Gene_D'</span>, <span>'Gene_E'</span>]<br><br><span># 保存为 HDF5 文件</span><br>adata.write_h5ad(<span>'example.h5ad'</span>)<br><br><span># 从文件中读取 AnnData 对象</span><br>loaded_adata = anndata.read_h5ad(<span>'example.h5ad'</span>)<br><br><span># 打印信息</span><br>print(loaded_adata)<br></code></pre><p data-tool="mdnice编辑器">这只是一个简单的介绍，<code>AnnData</code> 的功能和灵活性远不止于此，具体的使用可以根据具体需求参考相关文档和教程。</p><h3 data-tool="mdnice编辑器"><span></span>读取3个文件组建<code>AnnData</code> 对象<span></span></h3><p data-tool="mdnice编辑器">单细胞表达量矩阵的多种文件格式，比如<strong>Matrix Market Exchange Format (MEX):</strong></p><ul data-tool="mdnice编辑器"><li><section><code>.mtx</code> 文件，该文件包含了一个稀疏矩阵，其中每一行代表一个基因，每一列代表一个细胞，而每个元素则表示基因在相应细胞中的表达量。</section></li><li><section>通常会有三个文件组成：<code>barcodes.tsv</code>（细胞标识）、<code>features.tsv</code>（基因标识）和 <code>matrix.mtx</code>（表达矩阵）。</section></li></ul><p data-tool="mdnice编辑器">在R或者Python编程语言里面的，这3个文件都是可以分开独立读取的。使用 Python 的 <code>scipy</code> 库或 R 的 <code>Matrix</code> 和 <code>data.table</code> 等库来分别读取这三个单细胞转录组文件。在Python里面是 <code>csv</code>, <code>os</code>, <code>gzip</code>, and <code>scipy.io</code> modules ，下面是 Python 代码示例：</p><pre data-tool="mdnice编辑器"><span></span><code>import scipy.io<br>import pandas as pd<br><br><span># 读取 matrix.mtx.gz 文件</span><br>matrix = scipy.io.mmread(<span>'matrix.mtx.gz'</span>)<br><br><span># 读取 barcodes.tsv.gz 文件</span><br>barcodes_df = pd.read_csv(<span>'barcodes.tsv.gz'</span>, header=None, names=[<span>'barcodes'</span>])<br><br><span># 读取 features.tsv.gz 文件</span><br>features_df = pd.read_csv(<span>'features.tsv.gz'</span>, header=None, names=[<span>'features'</span>])<br><br><span># 打印示例数据</span><br><span>print</span>(<span>"Matrix Shape:"</span>, matrix.shape)<br><span>print</span>(<span>"Barcodes DataFrame:"</span>)<br><span>print</span>(barcodes_df.head())<br><span>print</span>(<span>"Features DataFrame:"</span>)<br><span>print</span>(features_df.head())<br></code></pre><p data-tool="mdnice编辑器">3个文件分别读取后，就可以组建成为一个<code>AnnData</code> 对象。</p></section><p><br></p><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/E01wPnmT-fok8G0Nkw76og",target="_blank" rel="noopener noreferrer">原文链接</a>
