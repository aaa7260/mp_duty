---
title: "R|aplot包实现无缝拼图"
date: 2024-01-08T23:50:43Z
draft: ["false"]
tags: [
  "fetched",
  "被炸熟的虾"
]
categories: ["Acdemic"]
---
R|aplot包实现无缝拼图 by 被炸熟的虾
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com">点击关注了解更多哦</section><section><span>本期主要介绍如何利用</span><span>aplot</span><sup>[1]</sup><span>包进行</span><strong>ggplot2</strong><span>拼图。在拼图的过程中，常使用的package有</span><strong>patchwork</strong><span>、</span><strong>gridExtra</strong><span>、</span><strong>cowplot</strong><span>等，</span><strong>aplot</strong><span>一个优势在于图与图之间的间隙较短，因此在需要紧凑型拼图时，使用</span><strong>aplot</strong><span>包具有较大优势。该包由</span><strong>Yu叔</strong><span>团队开发。</span></section><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><p data-tool="mdnice编辑器"><img data-ratio="0.6666666666666666" data-type="png" data-w="900" data-src="https://mmbiz.qpic.cn/mmbiz_png/icp3keOEXvz3LfWlmVqW4QLrovS58KfiaibfI9lv5E7N1Q257L9lHribtAs8uzl2xcThwSZNj9udUqHHtcjERLpUag/640?wx_fmt=png" src="https://mmbiz.qpic.cn/mmbiz_png/icp3keOEXvz3LfWlmVqW4QLrovS58KfiaibfI9lv5E7N1Q257L9lHribtAs8uzl2xcThwSZNj9udUqHHtcjERLpUag/640?wx_fmt=png"></p><h2 data-tool="mdnice编辑器"><span></span>0、数据准备</h2><p data-tool="mdnice编辑器">以<strong>gcookbook</strong>包中的<strong>heightweight</strong>数据集为例，绘制散点图作为主图，绘制变量的密度图与箱线图作为附图。</p><pre data-tool="mdnice编辑器"><span></span><code>library(aplot)<br>heightweight &lt;- gcookbook::heightweight<br>head(heightweight)<br><span># sex ageYear ageMonth heightIn weightLb</span><br><span># 1   f   11.92      143     56.3     85.0</span><br><span># 2   f   12.92      155     62.3    105.0</span><br><span># 3   f   12.75      153     63.3    108.0</span><br><span># 4   f   13.42      161     59.0     92.0</span><br><span># 5   f   15.92      191     62.5    112.5</span><br><span># 6   f   14.25      171     62.5    112.0</span><br></code></pre><h2 data-tool="mdnice编辑器"><span></span>1、绘制主图</h2><pre data-tool="mdnice编辑器"><span></span><code>plot1 &lt;- <br>ggplot(heightweight, aes(heightIn, weightLb, color = sex)) + <br>  geom_point(size = 3) + <br>  geom_smooth(method = <span>"lm"</span>, show.legend = FALSE) +  <br>  scale_color_brewer(palette = <span>"Set1"</span>) + <br>  theme_classic(base_family = <span>"serif"</span>, base_size = 12) + <br>  theme(axis.text = element_text(colour = <span>"black"</span>, size = 12), <br>        axis.title = element_text(size = 12))<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.8333333333333334" data-type="png" data-w="600" data-src="https://mmbiz.qpic.cn/mmbiz_png/icp3keOEXvz3LfWlmVqW4QLrovS58KfiaibwY32vEZVRUhW3KNibQG5aFXH0gwk1zC5TzvrcmeqMIoiaOoEOCLnsu7w/640?wx_fmt=png" src="https://mmbiz.qpic.cn/mmbiz_png/icp3keOEXvz3LfWlmVqW4QLrovS58KfiaibwY32vEZVRUhW3KNibQG5aFXH0gwk1zC5TzvrcmeqMIoiaOoEOCLnsu7w/640?wx_fmt=png"></figure><h2 data-tool="mdnice编辑器"><span></span>2、绘图附图</h2><p data-tool="mdnice编辑器">分别绘制<code>heightIn</code>、<code>weightLb</code>变量的密度图与箱线图，置于主图的四周。</p><pre data-tool="mdnice编辑器"><span></span><code>plot_t &lt;-<br>ggplot(heightweight, aes(x = heightIn, fill = sex)) + <br>  geom_density(alpha = 0.6, show.legend = FALSE) + <br>  scale_fill_brewer(palette = <span>"Set1"</span>) + <br>  theme_bw(base_family = <span>"serif"</span>) + <br>  theme(axis.text = element_text(colour = <span>"black"</span>, size = 12)) + <br>  theme(axis.text.x = element_blank(),<br>        panel.grid = element_blank(),<br>        axis.ticks.x = element_blank(),<br>        axis.title.x = element_blank())<br><br>plot_l &lt;-<br>ggplot(heightweight, aes(y = weightLb, fill = sex)) + <br>  geom_density(alpha = 0.6, show.legend = FALSE) + <br>  scale_x_reverse(breaks = seq(0, 0.02, 0.01)) + <br>  scale_fill_brewer(palette = <span>"Set1"</span>) + <br>  theme_bw(base_family = <span>"serif"</span>) + <br>  theme(axis.text = element_text(colour = <span>"black"</span>, size = 12)) + <br>  theme(axis.text.y = element_blank(),<br>        panel.grid = element_blank(),<br>        axis.ticks.y = element_blank(),<br>        axis.title.y = element_blank())<br>        <br>plot_b &lt;- <br>ggplot(heightweight, aes(x = heightIn, y = sex, fill = sex)) + <br>  geom_boxplot( show.legend = FALSE) + <br>  scale_fill_brewer(palette = <span>"Set1"</span>) + <br>  theme_bw(base_family = <span>"serif"</span>) + <br>  theme(axis.text = element_text(colour = <span>"black"</span>, size = 12)) + <br>  theme(axis.text.y = element_blank(),<br>        axis.title = element_blank(),<br>        panel.grid = element_blank(),<br>        axis.ticks.y = element_blank(),<br>        axis.title.y = element_blank())<br><br>plot_r &lt;-<br>ggplot(heightweight, aes(y = weightLb, x = sex, fill = sex)) + <br>  geom_boxplot(show.legend = FALSE) + <br>  scale_fill_brewer(palette = <span>"Set1"</span>) + <br>  theme_bw(base_family = <span>"serif"</span>) + <br>  theme(axis.text = element_text(colour = <span>"black"</span>, size = 12)) + <br>  theme(axis.text.y = element_blank(),<br>        panel.grid = element_blank(),<br>        axis.ticks.y = element_blank(),<br>        axis.title.y = element_blank())<br><br>plot_t + plot_l  + plot_b + plot_r<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.8928571428571429" data-type="png" data-w="672" data-src="https://mmbiz.qpic.cn/mmbiz_png/icp3keOEXvz3LfWlmVqW4QLrovS58Kfiaibm7tV9Hht86c96ic4QPNWrDBEMIY9IjO4UPK7lsfheepx1hRc0LJ5npQ/640?wx_fmt=png" src="https://mmbiz.qpic.cn/mmbiz_png/icp3keOEXvz3LfWlmVqW4QLrovS58Kfiaibm7tV9Hht86c96ic4QPNWrDBEMIY9IjO4UPK7lsfheepx1hRc0LJ5npQ/640?wx_fmt=png"></figure><h2 data-tool="mdnice编辑器"><span></span>3、进行拼图</h2><p data-tool="mdnice编辑器">使用<strong>insert_()</strong> 系列函数进行拼图，根据需要调整<code>height</code>参数与<code>width</code>参数。</p><pre data-tool="mdnice编辑器"><span></span><code>plot1 %&gt;% insert_top(plot_t, height = 0.3) %&gt;% <br>  insert_left(plot_l, width = 0.3) %&gt;% <br>  insert_bottom(plot_b, height = 0.3) %&gt;% <br>  insert_right(plot_r, width = 0.3)<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.6666666666666666" data-type="png" data-w="900" data-src="https://mmbiz.qpic.cn/mmbiz_png/icp3keOEXvz3LfWlmVqW4QLrovS58KfiaibfI9lv5E7N1Q257L9lHribtAs8uzl2xcThwSZNj9udUqHHtcjERLpUag/640?wx_fmt=png" src="https://mmbiz.qpic.cn/mmbiz_png/icp3keOEXvz3LfWlmVqW4QLrovS58KfiaibfI9lv5E7N1Q257L9lHribtAs8uzl2xcThwSZNj9udUqHHtcjERLpUag/640?wx_fmt=png"></figure><h2 data-tool="mdnice编辑器"><span></span>其他</h2><p data-tool="mdnice编辑器">更多内容可关注微信公众号<strong>【日常分享的小懒猫】</strong>。</p><section><mp-common-profile data-pluginname="mpprofile" data-id="Mzg3NjcxNzA1OQ==" data-headimg="http://mmbiz.qpic.cn/mmbiz_png/icp3keOEXvz1Aj6GghPUiaekGRqnMLKFXan3WGXu3lXKbr3XR5r8rdnuupYN3Oiad3WgI9qts6iciabavAHhKrVeCfw/0?wx_fmt=png" data-nickname="日常分享的小懒猫" data-alias="zhangtongxue_2021" data-signature="学习记录|R语言|Python" data-from="0"></mp-common-profile></section><hr data-tool="mdnice编辑器"><h2 data-tool="mdnice编辑器"><span></span> 如有帮助请多多点赞哦！</h2><h3 data-tool="mdnice编辑器"><span>参考资料</span></h3><section data-tool="mdnice编辑器"><span><span>[1]</span><p>aplot: <em>"https://cran.r-project.org/web/packages/aplot/index.html",</em></p></span></section></section><p><br></p><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/qCBdBXVAt8RAWR8kyP4Raw",target="_blank" rel="noopener noreferrer">原文链接</a>
