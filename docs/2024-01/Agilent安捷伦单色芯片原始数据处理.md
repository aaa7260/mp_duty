---
title: "Agilent安捷伦单色芯片原始数据处理"
date: 2024-01-12T13:06:52Z
draft: ["false"]
tags: [
  "fetched",
  "生信菜鸟团"
]
categories: ["Acdemic"]
---
Agilent安捷伦单色芯片原始数据处理 by 生信菜鸟团
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><h2 data-tool="mdnice编辑器"><span></span><span>先看GSE的介绍：</span><span></span></h2><p data-tool="mdnice编辑器">做的是non-codingRNA，就是miRNA，lncRNA这种。</p><p data-tool="mdnice编辑器"><strong>实验设计</strong>：101乳腺癌+15癌旁正常组织</p><p data-tool="mdnice编辑器">platform芯片厂商：安捷伦agilent，我们之前介绍过它的双色芯片原始数据预处理，详情请回顾表达量芯片合集往期。</p><figure data-tool="mdnice编辑器"><img data-imgfileid="100035972" data-ratio="0.9648924122310306" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibxV09hibN7icarWLLJkUl0WvaF7wLyge3coHoCxggraiawXggqMiauTg4JC7ajs9RibGUjpib8SLn3mADg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="883" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibxV09hibN7icarWLLJkUl0WvaF7wLyge3coHoCxggraiawXggqMiauTg4JC7ajs9RibGUjpib8SLn3mADg/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器">下载raw data和series matrix（包含临床信息）</p><figure data-tool="mdnice编辑器"><img data-imgfileid="100035969" data-ratio="0.2626146788990826" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibxV09hibN7icarWLLJkUl0WvFxyMDJiczAj9NnNyXseTteYK2rgHXgZrug3xTsQCG0eg2JUUbjzFY6A/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="872" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibxV09hibN7icarWLLJkUl0WvFxyMDJiczAj9NnNyXseTteYK2rgHXgZrug3xTsQCG0eg2JUUbjzFY6A/640?wx_fmt=png&amp;from=appmsg"></figure><h2 data-tool="mdnice编辑器"><span></span><span>使用series_matrix</span><span></span></h2><p data-tool="mdnice编辑器">我们先尝试使用series_matrix做：</p><pre data-tool="mdnice编辑器"><span></span><code>rm(list=ls())<br><span>#GSE45666</span><br>GSE_number&lt;-<span>"GSE45666"</span><br><span>#1.1.1 尝试用seriesmatrix做</span><br><span>library</span>(dplyr)<br><span>library</span>(GEOquery)<br><span>library</span>(vioplot)<br>eSet&lt;-getGEO(filename = paste0(GSE_number,<span>"_series_matrix.txt.gz"</span>),getGPL = <span>F</span>)<br>exp&lt;-exprs(eSet)<br><span>#使用小提琴图检查表达量的分布</span><br>png(<span>"exp_series_matrix.png"</span>,width = <span>960</span>, height = <span>480</span>)<br>vioplot(exp)<br>dev.off()<br><span>#检查下表达矩阵中是否存在负值</span><br>min(exp)<br><span>#-53.94175，存在负值</span><br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100035971" data-ratio="0.5" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibxV09hibN7icarWLLJkUl0WvdFuW5iaZOhQjZnwfLuIUuvOSQeIKNmlibnw5nWBplG476ia37Yt0DW94w/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="960" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibxV09hibN7icarWLLJkUl0WvdFuW5iaZOhQjZnwfLuIUuvOSQeIKNmlibnw5nWBplG476ia37Yt0DW94w/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器">可以看到表达矩阵很奇怪，而且还有个恨天高的离群值，不知道做了什么预处理。</p><h2 data-tool="mdnice编辑器"><span></span><span>下载原始数据自己处理</span><span></span></h2><p data-tool="mdnice编辑器">我们把series_matrix的临床信息提取出来后，下载原始数据自己处理，以下是分组信息提取和数据读入：</p><p data-tool="mdnice编辑器">这里特别强调，对于单色芯片，注意将函数read.maimages的参数green.only设置成TRUE，参数other.columns是将表达量高于背景的探针存在EList的others中，后面我们会用到</p><pre data-tool="mdnice编辑器"><span></span><code><span>#1.1.2取group分组信息</span><br>pData(eSet)-&gt;pd<br>pd$`tissue type:ch1`-&gt;group<br>group[group!=<span>"Tumor"</span>]&lt;-<span>"Normal"</span><br>table(group)<br>factor(group,levels=c(<span>"Tumor"</span>,<span>"Normal"</span>))-&gt;group<br><br><span>#1.2 对芯片原始txt数据进行处理，GEO中显示平台是安捷伦</span><br><span>library</span>(limma)<br><span>library</span>(R.utils)<br><span>#循环解压缩，只能跑一次，这里用if注释掉了</span><br><span>if</span>(<span>F</span>){<br>  files&lt;-list.files(<span>'./RAW'</span>,pattern = <span>"txt"</span>,full.names = <span>T</span>,recursive = <span>F</span>)<br>  <span>for</span>(i <span>in</span> <span>1</span>:length(files)){<br>    gunzip(files[i], remove = <span>T</span>)<br>  }<br>}<br>txt&lt;-list.files(<span>'./RAW'</span>,pattern = <span>"txt"</span>,full.names = <span>T</span>,recursive = <span>F</span>)<br><span>library</span>(stringr)<br><span>#检查文件顺序是否与pd行一一对应</span><br>identical(str_split(str_split(txt,<span>"/"</span>,simplify = <span>T</span>)[,<span>3</span>],<span>"_"</span>,simplify = <span>T</span>)[,<span>1</span>],rownames(pd))<br><span>#[1] TRUE</span><br><br><span>#对于Agilent的gpr文件或者txt文件，可以使用limma的read.maimages来读取。</span><br><span>#需要注意的是，对于不同的文件source参数有多种选择：</span><br><span>#"generic", "agilent", "agilent.median", "agilent.mean", "arrayvision", "arrayvision.ARM", </span><br><span>#"arrayvision.MTM", "bluefuse", "genepix", "genepix.custom", "genepix.median", "imagene", </span><br><span>#"imagene9", "quantarray", "scanarrayexpress", "smd.old", "smd", "spot" or "spot.close.open"。</span><br><span>#对于单色芯片，注意将green.only设置成TRUE，参数other.columns是将表达量高于背景的探针存在EList的others中，后面我们会用到</span><br>raw_data &lt;- read.maimages(txt, <span>source</span>=<span>"agilent"</span>, green.only = <span>T</span>,<br>                          other.columns = <span>"gIsWellAboveBG"</span>)<br>save(raw_data,group,GSE_number,file=paste0(GSE_number,<span>"_raw_data.Rdata"</span>))<br></code></pre><p data-tool="mdnice编辑器">读入后我们检查质量欠佳的样本，先对表达矩阵其背景值画小提琴图进行检查</p><pre data-tool="mdnice编辑器"><span></span><code>load(paste0(GSE_number,<span>"_raw_data.Rdata"</span>))<br><span>#找到背景特别离群的那两个</span><br><span>#画两张过滤前的小提琴图进行检查</span><br>png(<span>"Eb_beforefilter.png"</span>)<br>vioplot(raw_data$Eb)<br>dev.off()<br>png(<span>"E_beforefilter.png"</span>)<br>vioplot(raw_data$E)<br>dev.off()<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100035968" data-ratio="1" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibxV09hibN7icarWLLJkUl0WvRqhDibh2CxIK4icFeCBAqNpKEhOJriagLpicicvOwnefHScHicXwCp1ZhvXA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="480" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibxV09hibN7icarWLLJkUl0WvRqhDibh2CxIK4icFeCBAqNpKEhOJriagLpicicvOwnefHScHicXwCp1ZhvXA/640?wx_fmt=png&amp;from=appmsg"></figure><figure data-tool="mdnice编辑器"><img data-imgfileid="100035970" data-ratio="1" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibxV09hibN7icarWLLJkUl0Wvflxf1icptrerfBEHQwKwfGepY9JEIlqiabTqkj2dwlxCdHy9wNuR3Tyg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="480" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibxV09hibN7icarWLLJkUl0Wvflxf1icptrerfBEHQwKwfGepY9JEIlqiabTqkj2dwlxCdHy9wNuR3Tyg/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器">可以看到两张图中大概有各一个样本是一枝独秀的状态，现在要找到这俩擎天柱对应的样本</p><pre data-tool="mdnice编辑器"><span></span><code>apply(raw_data$Eb, <span>2</span>, max)-&gt;rm<br>names(rm)&lt;-<span>1</span>:ncol(raw_data);<br>sort(rm,decreasing = <span>T</span>) %&gt;% head(.,<span>20</span>)<br><span>#可以看到大多数背景最大值都在几十，可以过滤掉前个或者前三个，这个标准看你自己</span><br><span>#这里我们过滤掉前两个，即第20，21个样本</span><br>rm[c(<span>20</span>,<span>21</span>)]<br><span>#20      21 </span><br><span>#65535.0   589.5 </span><br><br>apply(raw_data$E, <span>2</span>, max)-&gt;rm2<br>names(rm)&lt;-<span>1</span>:ncol(raw_data);<br>sort(rm2,decreasing = <span>T</span>) %&gt;% head(.,<span>20</span>)<br><span>#可以看到大多数表达量最大值都在几十万，第一个一百万的可以当离群值进行过滤</span><br><span>#滤掉第14个样本</span><br>rm2[<span>14</span>]<br><span>#14 </span><br><span>#1088780</span><br><br><span>#在EList对象中删去这两个离群样本</span><br>raw_data[,c(-<span>20</span>,-<span>21</span>,-<span>14</span>)]-&gt;raw_data<br><span>#在分组信息中也删去这部分离群值</span><br>group[c(-<span>20</span>,-<span>21</span>,-<span>14</span>)]-&gt;group<br><br><span>#画两张过滤后的小提琴图进行检查</span><br>png(<span>"Eb_filtered.png"</span>)<br>vioplot(raw_data$Eb)<br>dev.off()<br>png(<span>"E_filtered.png"</span>)<br>vioplot(raw_data$E)<br>dev.off()<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100035976" data-ratio="1" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibxV09hibN7icarWLLJkUl0WvIicRIIzRddPoLkiaAJGIf2MWos4RAfL2BicEKiaUuV0nr5rpxmtJJOxiaZA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="480" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibxV09hibN7icarWLLJkUl0WvIicRIIzRddPoLkiaAJGIf2MWos4RAfL2BicEKiaUuV0nr5rpxmtJJOxiaZA/640?wx_fmt=png&amp;from=appmsg"></figure><figure data-tool="mdnice编辑器"><img data-imgfileid="100035973" data-ratio="1" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibxV09hibN7icarWLLJkUl0Wv7BlJvR7HxZ8FHpO6HxCj12I9VjdQzZW4pCncXX0k563bRiarGzx2RNg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="480" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibxV09hibN7icarWLLJkUl0Wv7BlJvR7HxZ8FHpO6HxCj12I9VjdQzZW4pCncXX0k563bRiarGzx2RNg/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器">现在除去三个离群样本之后，我们开始对原始数据进行背景校正和芯片间的标准化</p><pre data-tool="mdnice编辑器"><span></span><code><span>#背景校正</span><br>dat&lt;-limma::backgroundCorrect(raw_data, method=<span>"normexp"</span>, offset=<span>25</span>)<br><span>#检查</span><br>png(<span>"E_backgroundCorrect.png"</span>, width = <span>960</span>, height = <span>480</span>)<br>boxplot(dat$E)<br>dev.off()<br><br>dat$genes$SystematicName %&gt;% head<br><span>#取前几个基因看看</span><br><span>#"hsa-miR-720"         "hsa-miR-587"        </span><br><span>#"hsa-miR-1236"        "hsa-miR-607"</span><br>dat$E[dat$genes$SystematicName==<span>"hsa-miR-720"</span>,] %&gt;% nrow<br><span>#16</span><br>dat$E[dat$genes$SystematicName==<span>"hsa-miR-587"</span>,] %&gt;% nrow<br><span>#16</span><br>dat$E[dat$genes$SystematicName==<span>"hsa-miR-1236"</span>,] %&gt;% nrow<br><span>#16</span><br>dat$E[dat$genes$SystematicName==<span>"hsa-miR-607"</span>,] %&gt;% nrow<br><span>#16</span><br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100035975" data-ratio="0.5" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibxV09hibN7icarWLLJkUl0WvWf7LduUk7MA624kAzQ3V9gogDVZjicz0siaDEzewoAQGtDkTmDR461uA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="960" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibxV09hibN7icarWLLJkUl0WvWf7LduUk7MA624kAzQ3V9gogDVZjicz0siaDEzewoAQGtDkTmDR461uA/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器">因为这个non_codingRNA芯片有十六个探针对应同一个miRNA，所以我们在标准化前进行过滤，过滤标准是：</p><ul data-tool="mdnice编辑器"><li><section>①过滤掉作为对照的探针</section></li><li><section>②过滤掉空探针（探针对应不到RNA或基因名）</section></li><li><section>③过滤掉低表达的探针</section></li></ul><p data-tool="mdnice编辑器">使用read.maimages函数的other.columns参数生成的结果，他存储在EList对象$other$gIsWellAboveBG中。</p><p data-tool="mdnice编辑器">然后合并相同miRNA的表达量</p><pre data-tool="mdnice编辑器"><span></span><code><span>#过滤不需要的探针</span><br>head(dat$genes)<br><span>#过滤不对应基因的对照</span><br>Control &lt;- dat$genes$ControlType!=<span>0</span>;table(Control)<br><span># Control</span><br><span># FALSE  TRUE </span><br><span># 15024   715 </span><br><span>#过滤没名字的,结果显示都有基因名称</span><br>NoSymbol &lt;- is.na(dat$genes$SystematicName);table(NoSymbol)<br><span># NoSymbol</span><br><span># FALSE </span><br><span># 15739 </span><br><span>#过滤掉在一半以下样本中不表达的</span><br>IsExpr &lt;- rowSums(dat$other$gIsWellAboveBG &gt; <span>0</span>) &gt;= ncol(dat)/<span>2</span>;table(IsExpr)<br><span># IsExpr</span><br><span># FALSE  TRUE </span><br><span># 11120  4619 </span><br><br>dat[!Control &amp; !NoSymbol &amp; IsExpr,]-&gt;dat<br>dim(dat)<br><span>#[1] 4404  113</span><br><span>#过滤完之后只有4404个基因产物了，当然这是non_coding RNA芯片，如果是蛋白质编码的mRNA芯片，应该在过滤后有2-3w个基因产物。</span><br><br><span>#合并行名相同的行，简单求和相加</span><br>duplicated(dat$genes$SystematicName) %&gt;% table<br>uniq_dat&lt;-dat[!duplicated(dat$genes$SystematicName),]<br>dup_dat&lt;-dat[duplicated(dat$genes$SystematicName),]<br><span>for</span>(i <span>in</span> <span>1</span>:nrow(uniq_dat)){<br>  probe&lt;-uniq_dat$genes$SystematicName[i]<br>  dup_probe&lt;-dup_dat$genes$SystematicName==probe<br><br>  <span>if</span>(sum(dup_probe)==<span>1</span>) {<br>    uniq_dat$E[i,]&lt;-uniq_dat$E[i,]+dup_dat$E[dup_probe,]<br>  }<br>  <br>  <span>if</span>(sum(dup_probe)&gt;<span>1</span>) {<br>    add&lt;-apply(dup_dat$E[dup_probe,],<span>2</span>,sum)<br>    uniq_dat$E[i,]&lt;-uniq_dat$E[i,]+add<br>  }<br>}<br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span>标准化：</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code><span>##芯片间标准化</span><br>uniq_dat&lt;-normalizeBetweenArrays(uniq_dat, method=<span>"quantile"</span>)<br>png(<span>"E_unique_normalized.png"</span>, width = <span>960</span>, height = <span>480</span>)<br>boxplot(uniq_dat$E)<br>dev.off()<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100035977" data-ratio="0.5" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibxV09hibN7icarWLLJkUl0Wvhbb8Xq23qgiaFR5icNAe9icrNByMOUqxcE7DHQNTjaIddhricEOvJkem6g/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="960" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibxV09hibN7icarWLLJkUl0Wvhbb8Xq23qgiaFR5icNAe9icrNByMOUqxcE7DHQNTjaIddhricEOvJkem6g/640?wx_fmt=png&amp;from=appmsg"></figure><h3 data-tool="mdnice编辑器"><span></span><span>检查样本间差异</span><span></span></h3><p data-tool="mdnice编辑器">使用PCA图粗略检查癌症样本和正常样本间是否存在差异</p><pre data-tool="mdnice编辑器"><span></span><code><span>#提取表达矩阵</span><br>uniq_dat$E-&gt;exp<br>colnames(exp)&lt;-str_split(str_split(colnames(exp),<span>"/"</span>,simplify = <span>T</span>)[,<span>3</span>],<span>"_"</span>,simplify = <span>T</span>)[,<span>1</span>]<br>rownames(exp)&lt;-uniq_dat$genes$SystematicName<br>exp[<span>1</span>:<span>4</span>,<span>1</span>:<span>4</span>]<br><span># GSM1111512 GSM1111513 GSM1111514 GSM1111515</span><br><span># hsa-miR-720   13.816347  11.545885  14.581312  14.581312</span><br><span># hsa-miR-376c   7.753673   9.482656   7.753673   6.924099</span><br><span># hsa-miR-320c  10.545763  10.358558   9.992067  11.244666</span><br><span># hsa-miR-551b   7.078702   8.831040   7.189362   7.015251</span><br><br><span>#检查质量</span><br>checkPCA&lt;-<span>function</span> (dat, group_list) <br>{<br>  dat = t(dat)<br>  dat = as.data.frame(dat)<br>  <span>library</span>(ggplot2)<br>  <span>library</span>(FactoMineR)<br>  <span>library</span>(factoextra)<br>  dat.pca &lt;- PCA(dat, graph = <span>FALSE</span>)<br>  p &lt;- fviz_pca_ind(dat.pca, geom.ind = <span>"point"</span>, col.ind = group_list, <br>                    addEllipses = <span>T</span>, legend.title = <span>"Groups"</span>)<br>  ggsave(<span>"PCAcheck.png"</span>, p, height = <span>5</span>, width = <span>5</span>)<br>  <span>return</span>(p)<br>}<br>checkPCA(dat$E,group)-&gt;p<br>p<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100035974" data-ratio="1" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibxV09hibN7icarWLLJkUl0Wvt3MwjHaYMcENaGffl95eWUDB2hP2Q3RK3g8uuiaxGepB2eDPJcjZ8Tg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibxV09hibN7icarWLLJkUl0Wvt3MwjHaYMcENaGffl95eWUDB2hP2Q3RK3g8uuiaxGepB2eDPJcjZ8Tg/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器">结果很理想，做差异表达分析</p><h3 data-tool="mdnice编辑器"><span></span><span>差异表达分析</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code><span>#2 差异表达分析</span><br>design &lt;- model.matrix(~<span>0</span>+group)<br>colnames(design) = levels(group)<br>rownames(design) = colnames(dat)<br><span>#makeContrasts创建比对矩阵，tumor比normal</span><br>contrast.matrix &lt;- makeContrasts(contrasts = <span>"Tumor-Normal"</span>, levels = design)<br>fit &lt;- lmFit(exp,design)<br>fit &lt;- contrasts.fit(fit, contrast.matrix)<br>fit &lt;- eBayes(fit,trend=<span>TRUE</span>,robust=<span>TRUE</span>)<br>topTable(fit)<br>deg = topTable(fit, coef = <span>1</span>, n = <span>Inf</span>)<br>deg[<span>1</span>,]<br><span>#取一个结果画箱线图来检查一下</span><br>write.csv(deg,file = <span>"deg.csv"</span>)<br></code></pre><p data-tool="mdnice编辑器">文章绘制了miRNA预测肿瘤的ROC曲线，这里我们从正文和supplementary图中批量复现四个结果比较好的</p><p data-tool="mdnice编辑器">文章正文：</p><figure data-tool="mdnice编辑器"><img data-imgfileid="100035981" data-ratio="0.43271767810026385" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibxV09hibN7icarWLLJkUl0WvJUQR9Ms82MDc9jInicwYbwIJJawOcicyp1CI1jwbAkXhHlBy1GFGziaNw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="758" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibxV09hibN7icarWLLJkUl0WvJUQR9Ms82MDc9jInicwYbwIJJawOcicyp1CI1jwbAkXhHlBy1GFGziaNw/640?wx_fmt=png&amp;from=appmsg"></figure><figure data-tool="mdnice编辑器"><img data-imgfileid="100035978" data-ratio="0.47277556440903057" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibxV09hibN7icarWLLJkUl0Wv95BgEI1vzhfEd40mfBtceZiaP9iaL8rYqwplBJkrvNZs5rqXR1PaJelg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="753" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibxV09hibN7icarWLLJkUl0Wv95BgEI1vzhfEd40mfBtceZiaP9iaL8rYqwplBJkrvNZs5rqXR1PaJelg/640?wx_fmt=png&amp;from=appmsg"></figure><figure data-tool="mdnice编辑器"><img data-imgfileid="100035980" data-ratio="0.4590542099192618" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibxV09hibN7icarWLLJkUl0WvRQicNqrLVGe3iazNBZoOa3Xibjg0N3mtOLegI7egK7EBSsGJsQZ9rwjXg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="867" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibxV09hibN7icarWLLJkUl0WvRQicNqrLVGe3iazNBZoOa3Xibjg0N3mtOLegI7egK7EBSsGJsQZ9rwjXg/640?wx_fmt=png&amp;from=appmsg"></figure><figure data-tool="mdnice编辑器"><img data-imgfileid="100035979" data-ratio="0.9348404255319149" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibxV09hibN7icarWLLJkUl0WvEraE6MeXPuEYEicAKmJlWdCAa8S7hU2OwP3Q7p5NYvNDWrUqsExffrw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="752" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibxV09hibN7icarWLLJkUl0WvEraE6MeXPuEYEicAKmJlWdCAa8S7hU2OwP3Q7p5NYvNDWrUqsExffrw/640?wx_fmt=png&amp;from=appmsg"></figure><pre data-tool="mdnice编辑器"><span></span><code><span>#ROC曲线</span><br><span>#logFC</span><br><span>#hsa-miR-139-5p  -1.4601660</span><br><span>library</span>(ggplot2)<br><span>library</span>(plotROC)<br><span>library</span>(patchwork)<br>Box_Roc&lt;-<span>function</span>(name){<br>  rocdf&lt;-data.frame(e=exp[name,],g=group)<br>  df&lt;-data.frame(a=as.vector(t(exp[name,])),b=group)<br>  p1 &lt;- ggplot(rocdf, aes(m = e, d = g)) + <br>    geom_roc(pointsize = <span>0</span>,<br>             labels = <span>F</span>)+<br>    coord_flip()+<br>    theme_bw()<br>  p2&lt;-ggplot(df,aes(x=b,y=a))+<br>    geom_boxplot(alpha = <span>2</span>,<br>                 size=<span>1</span>)+<br>    theme_classic(base_line_size = <span>1</span>)<br>  <span>#ggsave("degcheck.png")</span><br>  <span>return</span>(p1+p2)<br>}<br>names=c(<span>"hsa-let-7c"</span>,<span>"hsa-miR-99a"</span>,<span>"hsa-miR-100"</span>,<span>"hsa-miR-139-5p"</span>)<br>names %<span>in</span>% rownames(exp)<br><span>for</span> (i <span>in</span> names) {<br>  a&lt;-Box_Roc(i)<br>  ggsave(a,filename=paste0(i,<span>".png"</span>))<br>}<br></code></pre><p data-tool="mdnice编辑器">复现的箱线图和ROC曲线</p><figure data-tool="mdnice编辑器"><img data-imgfileid="100035982" data-ratio="0.6296296296296297" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibxV09hibN7icarWLLJkUl0WvicGmTLz9Hmn6nF1J8yZnCx9FaqozBCC0eouM3LRevIc437OHHP3cFNw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibxV09hibN7icarWLLJkUl0WvicGmTLz9Hmn6nF1J8yZnCx9FaqozBCC0eouM3LRevIc437OHHP3cFNw/640?wx_fmt=png&amp;from=appmsg"><figcaption>hsa-let-7c</figcaption></figure><figure data-tool="mdnice编辑器"><img data-imgfileid="100035984" data-ratio="0.6296296296296297" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibxV09hibN7icarWLLJkUl0Wvz4BEdcZJgpibcGQM6v3YvhmJKqDK0q8WmMtfFjCzZyzkOicvj7sDyz7A/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibxV09hibN7icarWLLJkUl0Wvz4BEdcZJgpibcGQM6v3YvhmJKqDK0q8WmMtfFjCzZyzkOicvj7sDyz7A/640?wx_fmt=png&amp;from=appmsg"><figcaption>hsa-miR-99a</figcaption></figure><figure data-tool="mdnice编辑器"><img data-imgfileid="100035985" data-ratio="0.6296296296296297" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibxV09hibN7icarWLLJkUl0Wv5eD0ibbTXWQGmP1k3DEekEV9SibxWnYRwTJm3slm3gYsC5oJDBhZTjCQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibxV09hibN7icarWLLJkUl0Wv5eD0ibbTXWQGmP1k3DEekEV9SibxWnYRwTJm3slm3gYsC5oJDBhZTjCQ/640?wx_fmt=png&amp;from=appmsg"><figcaption>hsa-miR-100</figcaption></figure><figure data-tool="mdnice编辑器"><img data-imgfileid="100035987" data-ratio="0.6296296296296297" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibxV09hibN7icarWLLJkUl0WvpkaAaKOZtbV1sMnHYhicfMWOoUDKu87z31weJo9R0k5K08Cv8DwlyPA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibxV09hibN7icarWLLJkUl0WvpkaAaKOZtbV1sMnHYhicfMWOoUDKu87z31weJo9R0k5K08Cv8DwlyPA/640?wx_fmt=png&amp;from=appmsg"><figcaption>hsa-miR-139-5p</figcaption></figure><p data-tool="mdnice编辑器">说明我们这个agilent单色芯片数据清洗的还是比较好的！</p><h4 data-tool="mdnice编辑器">文末友情宣传</h4><p data-tool="mdnice编辑器">强烈建议你推荐给身边的<strong>博士后以及年轻生物学PI</strong>，多一点数据认知，让他们的科研上一个台阶：</p><ul data-tool="mdnice编辑器"><li><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247526014&amp;idx=1&amp;sn=44afb387fc49b89276386e5182db7bc9&amp;chksm=9b4b26c5ac3cafd35616b2fe9df7fea664e59d75e9970feb322a477beb222ac023f7daebb3dc&amp;scene=21#wechat_redirect" textvalue="生物信息学马拉松授课（买一得‍五）" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1">生物信息学马拉松授课（买一得五）</a> ，你的生物信息学入门课</section></li><li><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247524148&amp;idx=1&amp;sn=7806da6feb41a36493c519c1cfc1d3ac&amp;chksm=9b4bdf8fac3c569960369602f1ef26639cb366b250f233b2297d1f059471c0458335bfc0b829&amp;scene=21#wechat_redirect" textvalue="时隔5年，我们的生信技能树VIP学徒继续招生啦" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1">时隔5年，我们的生信技能树VIP学徒继续招生啦</a><br></section></li><li><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247525661&amp;idx=2&amp;sn=a0662fa3a9ebc7c840d45049eaca2c8c&amp;chksm=9b4b25a6ac3cacb0e9ba90eeb97452a9ee4eaed6bbbab1133f7a4836631047451c0cf295c93b&amp;scene=21#wechat_redirect" textvalue="搭配GPU服务再升级—256线程2Tb内存服务器共享一年仍然是仅需800" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1">搭配GPU服务再升级—256线程2Tb内存服务器共享一年仍然是仅需800</a></section></li></ul></section><p><mp-style-type data-value="10000"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/DOJ6PmQm9so6EuOkSe62PQ",target="_blank" rel="noopener noreferrer">原文链接</a>
