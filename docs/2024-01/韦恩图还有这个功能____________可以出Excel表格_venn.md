---
title: "韦恩图还有这个功能。。。。。。。。。。。。可以出Excel表格 venn"
date: 2024-01-14T15:18:42Z
draft: ["false"]
tags: [
  "fetched",
  "生信小博士"
]
categories: ["Acdemic"]
---
韦恩图还有这个功能。。。。。。。。。。。。可以出Excel表格 venn by 生信小博士
------
<div><p><strong><span><span>主</span><span>要是本文代码还可以出venn图的excel表格，在文末。</span></span></strong></p><p><strong><span>大家好</span></strong><strong><span>，是不是有时候你画韦恩图的网页工具画出来的图特别丑，</span></strong><strong><span>就像这样，标签都看不到，或者在圆圈里面：</span></strong></p><p><img data-galleryid="" data-imgfileid="100002009" data-ratio="0.9943262411347518" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345SkvCSy3sBpXaRheNGicst2iaTZsWpIpGbcjFDUWlr81nhFPicXtga3Q8lWPicoZhvaLZLtRYlkl5tysuVA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="705" src="https://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345SkvCSy3sBpXaRheNGicst2iaTZsWpIpGbcjFDUWlr81nhFPicXtga3Q8lWPicoZhvaLZLtRYlkl5tysuVA/640?wx_fmt=png&amp;from=appmsg"></p><p><br></p><h3><span>输入数据<span></span></span></h3><p><strong><span>假如我们有三个list，或者向量、数据框也可以，list内容分别是m6a-seq的差异基因，RIP-seq的差异基因和 genecards中的你的目的基因集</span></strong></p><section><ul><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="swift"><code><span><br></span></code><code><span>gene_cards &lt;- data.frame(`<span>Gene</span> <span>Symbol</span>` = <span>c</span>(<span>"BRCA1"</span>, <span>"TP53"</span>, <span>"EGFR"</span>, <span>"ERBB2"</span>, <span>"KRAS"</span>, <span>"BRAF"</span>, <span>"ALK"</span>, <span>"RET"</span>, <span>"ROS1"</span>),</span></code><code><span>                         `<span>Gene</span> <span>Description</span>` = <span>c</span>(<span>"Breast cancer 1"</span>, <span>"Tumor protein p53"</span>, <span>"Epidermal growth factor receptor"</span>, <span>"Erb-B2 receptor tyrosine kinase 2"</span>, <span>"Kirsten rat sarcoma viral oncogene homolog"</span>, <span>"B-Raf proto-oncogene, serine/threonine kinase"</span>, <span>"Anaplastic lymphoma receptor tyrosine kinase"</span>, <span>"Ret proto-oncogene"</span>, <span>"ROS proto-oncogene 1, receptor tyrosine kinase"</span>),</span></code><code><span>                         stringsAsFactors = <span>FALSE</span>)</span></code><code><span><span>Rip_seq</span> &lt;- <span>c</span>(<span>"BRCA1"</span>, <span>"TP53"</span>, <span>"EGFR"</span>, <span>"AKT1"</span>, <span>"MTOR"</span>, <span>"CCND1"</span>, <span>"MYC"</span>)</span></code><code><span>m6A_seq &lt;- <span>c</span>(<span>"BRCA1"</span>, <span>"TP53"</span>, <span>"EGFR"</span>, <span>"ERBB2"</span>, <span>"KRAS"</span>, <span>"BRAF"</span>, <span>"AKT1"</span>, <span>"MTOR"</span>, <span>"CCND1"</span>, <span>"MYC"</span>)</span></code><code><span><br></span></code><code><span><br></span></code><code><span><br></span></code><code><span>genecards_intersect_with_m6a_rip &lt;- <span>Reduce</span>(intersect, list(gene_cards$`<span>Gene</span>.<span>Symbol</span>`, <span>Rip_seq</span>, m6A_seq))</span></code><code><span><span>print</span>(genecards_intersect_with_m6a_rip)</span></code><code><span><br></span></code></pre></section><p><img data-galleryid="" data-imgfileid="100002008" data-ratio="0.1814814814814815" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345SkvCSy3sBpXaRheNGicst2iaTZEX9FPecWOUYTs2eHFZM2PlHkW6CIfVoEyG5HtKJL6dvBePc11wOASQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345SkvCSy3sBpXaRheNGicst2iaTZEX9FPecWOUYTs2eHFZM2PlHkW6CIfVoEyG5HtKJL6dvBePc11wOASQ/640?wx_fmt=png&amp;from=appmsg"></p><h3><span>把输入数据变成list，绘制韦恩图</span></h3><p><strong><span>VennDiagram要求的输入数据就是list</span></strong></p><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="php"><code><span><span># 韦恩图</span></span></code><code><span>library(VennDiagram)</span></code><code><span>venn_list &lt;- <span>list</span>(<span>'Genecards'</span> = gene_cards$`Gene.Symbol`,</span></code><code><span>                  <span>'m6A_seq'</span> = m6A_seq, <span>'Rip_seq'</span> = Rip_seq)</span></code><code><span><br></span></code><code><span>venn_list</span></code><code><span><br></span></code><code><span>venn.diagram(venn_list, filename = <span>'venn2.png'</span>, imagetype = <span>'png'</span>, </span></code><code><span>             fill = c(<span>'red'</span>, <span>'blue'</span>,<span>'green'</span>), alpha = <span>0.30</span>,</span></code><code><span>             <span>#cat.col = rep('black', 3), </span></span></code><code><span>             <span># col = 'black',</span></span></code><code><span>             </span></code><code><span>             cex = <span>1.5</span>,  <span># 设置文本标签大小</span></span></code><code><span>             fontfamily = <span>"serif"</span>,  <span># 设置文本标签的字体</span></span></code><code><span>             fontface = <span>"bold"</span>,  <span># 设置文本标签的字体加粗</span></span></code><code><span>             cat.col = c(<span>"red"</span>, <span>"darkblue"</span>, <span>"darkgreen"</span>  ),  <span># 设置类别标签的颜色</span></span></code><code><span>             cat.cex = <span>1</span>   ,  <span># 设置类别标签大小</span></span></code><code><span>             <span># cat.pos = 0,  # 设置类别标签的位置</span></span></code><code><span>             cat.pos = c(<span>-60</span>,<span>60</span>,<span>180</span>) , <span># 设置类别标签的位置 (1,2,3,4,5  numeric  Vector giving the position (in degrees) of each category name along the circle, with 0 at 12 o'clock)</span></span></code><code><span>             margin  = <span>0.08</span>  <span>#调整标签距离最边缘的位置</span></span></code><code><span>             </span></code><code><span>)</span></code><code><span><br></span></code><code><span><br></span></code></pre></section><p><br></p><p><img data-galleryid="" data-imgfileid="100002010" data-ratio="0.28489208633093527" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345SkvCSy3sBpXaRheNGicst2iaTZcCqWrEJianvMbicwFYicn4mJNaXYTShIGrB9pNibpBLcJ20gtgjskSDHBg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="695" src="https://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345SkvCSy3sBpXaRheNGicst2iaTZcCqWrEJianvMbicwFYicn4mJNaXYTShIGrB9pNibpBLcJ20gtgjskSDHBg/640?wx_fmt=png&amp;from=appmsg"></p><p><img data-galleryid="" data-imgfileid="100002006" data-ratio="0.9899856938483548" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345SkvCSy3sBpXaRheNGicst2iaTZmiajNFTjm1NxiclMphl6AqTRX8LTRmHVZBZvnuqsZpOvD03xPLsfqtFw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="699" src="https://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345SkvCSy3sBpXaRheNGicst2iaTZmiajNFTjm1NxiclMphl6AqTRX8LTRmHVZBZvnuqsZpOvD03xPLsfqtFw/640?wx_fmt=png&amp;from=appmsg"></p><h3><span>输出韦恩图的excel表格</span></h3><p><strong><span>这个excel可以放在你的补充材料里，知道不同集合交集的结果是什么</span></strong></p><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="ruby"><code><span><br></span></code><code><span><br></span></code><code><span><br></span></code><code><span><br></span></code><code><span>inter &lt;- get.venn.partitions(venn_list)</span></code><code><span><span>for</span> (i <span>in</span> <span>1</span><span>:nrow</span>(inter)) inter[i,<span>'values'</span>] &lt;- paste(inter[[i,<span>'..values..'</span>]], collapse = <span>', '</span>)</span></code><code><span><span>#write.table(inter[-c(5, 6)] , 'venn_inter.txt', row.names = FALSE, sep = '\t', quote = FALSE)</span></span></code><code><span><br></span></code><code><span><br></span></code><code><span><span>for</span> (i <span>in</span> <span>1</span><span>:nrow</span>(inter)) inter[i,<span>'values'</span>] &lt;- paste(inter[[i,<span>'..values..'</span>]], collapse = <span>', '</span>)</span></code><code><span>openxlsx::write.xlsx(inter[-c(<span>5</span>, <span>6</span>)], <span>'venn_inter.xlsx'</span>, row.names = FALSE, sep = <span>','</span>, quote = FALSE)</span></code><code><span><br></span></code><code><span><br></span></code></pre></section><p><br></p><p><img data-galleryid="" data-imgfileid="100002007" data-ratio="0.4341692789968652" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345SkvCSy3sBpXaRheNGicst2iaTZeepXqwh9oXxicfz3osVmARKL2nRmB4W0skg2y6aiaGBFy0OKib7HfeNEQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="638" src="https://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345SkvCSy3sBpXaRheNGicst2iaTZeepXqwh9oXxicfz3osVmARKL2nRmB4W0skg2y6aiaGBFy0OKib7HfeNEQ/640?wx_fmt=png&amp;from=appmsg"></p><p><br></p><p><br></p><p><br></p><p><br></p><p><mp-style-type data-value="10000"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/v7HJ0AWW-IEhArJREkSuIw",target="_blank" rel="noopener noreferrer">原文链接</a>
