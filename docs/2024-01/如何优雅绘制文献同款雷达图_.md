---
title: "如何优雅绘制文献同款雷达图？"
date: 2024-01-19T04:03:16Z
draft: ["false"]
tags: [
  "fetched",
  "SCIPainter"
]
categories: ["Acdemic"]
---
如何优雅绘制文献同款雷达图？ by SCIPainter
------
<div><p data-mpa-powered-by="yiban.io"><span>上期我们通过复现学习了如何绘制玫瑰图，感兴趣可戳往期<a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzIyOTY3MDA3MA==&amp;mid=2247533814&amp;idx=1&amp;sn=0378783d05ab5108f74a54e033e7f082&amp;chksm=e8bd292fdfcaa0391831b73ba6eecb239ad22d22de41939f8fdd1cee039f1e60c2e596bd7485&amp;scene=21#wechat_redirect" textvalue="《如何优雅绘制花瓣玫瑰图？》" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2">《如何优雅绘制花瓣玫瑰图？》</a>。</span></p><p><span><br></span></p><p><img data-imgfileid="100050408" data-ratio="0.4877358490566038" data-type="png" data-w="1060" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mh5Yn5ouM3Xuw9g8HB2lFKvyeaH2qL6wcFOj0mrhMmJfIvLzzETb7cJYyIV1l7TA66Pl64ClRsQw/640?wx_fmt=png&amp;from=appmsg" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mh5Yn5ouM3Xuw9g8HB2lFKvyeaH2qL6wcFOj0mrhMmJfIvLzzETb7cJYyIV1l7TA66Pl64ClRsQw/640?wx_fmt=png&amp;from=appmsg"></p><p><br></p><p><span>如果想要将多个组别的花瓣图合并，在同一张图表中对这六个组别的数据进行多维度比较，可选择</span><span>雷达图</span><span>进行可视化呈现，如下图：</span></p><p><br></p><p><img data-imgfileid="100050410" data-ratio="0.5259259259259259" data-type="png" data-w="1080" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mh5Yn5ouM3Xuw9g8HB2lFKIZESibkDSrQfL3jSc3fiawXvc5ygwpUInY1JExuEFYTTYrna71fdNu0Q/640?wx_fmt=png&amp;from=appmsg" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mh5Yn5ouM3Xuw9g8HB2lFKIZESibkDSrQfL3jSc3fiawXvc5ygwpUInY1JExuEFYTTYrna71fdNu0Q/640?wx_fmt=png&amp;from=appmsg"></p><p><span>（<em>Nat Commun</em>，2024）</span></p><p><br></p><p><span>雷达图</span><span>又称为蜘蛛图，非常适合展示研究对象（单组或多组）在多个维度的属性值或得分，又或是用于展示不同样本、细胞亚群中目标基因的表达水平、微生物在不同环境中的丰度变化等等。</span></p><p><span><br></span></p><p><span>下面我们以上文雷达图复现为例，学习如何使用</span><span>ggradar包</span><span>绘制雷达图。案例数据来自文献</span><span>源数据</span><span>，有需要测试数据的童鞋可从文末【参考文献】处自行获取。</span></p><p><span><br mpa-from-tpl="t"></span></p><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>#相关R包安装与载入：</span><br mpa-from-tpl="t"><span>devtools</span>::install_github('ricardo-bion/ggradar')<br mpa-from-tpl="t"><span>library</span>(ggradar)<br mpa-from-tpl="t"><br mpa-from-tpl="t"><span>#载入本期测试数据：</span><br mpa-from-tpl="t"><span>dt</span> &lt;- read.csv('radar_test.csv', header = T, check.names = F)<br mpa-from-tpl="t"><span>dt</span>[1:6,1:3]</code></pre></section><p><br></p><p><img data-imgfileid="100050407" data-ratio="0.34358288770053474" data-type="png" data-w="748" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mh5Yn5ouM3Xuw9g8HB2lFKbMxQqOs5sVOaywLzQG5tHEhV20j5xmaiaf5w2h9aeJAviaWpOOWYePAA/640?wx_fmt=png&amp;from=appmsg" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mh5Yn5ouM3Xuw9g8HB2lFKbMxQqOs5sVOaywLzQG5tHEhV20j5xmaiaf5w2h9aeJAviaWpOOWYePAA/640?wx_fmt=png&amp;from=appmsg"></p><p><span><br mpa-from-tpl="t"></span></p><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>#查看数据范围区间：</span><br mpa-from-tpl="t"><span>range</span>(dt[,-1])</code></pre></section><p><span></span><br></p><p><img data-imgfileid="100050406" data-ratio="0.11276948590381426" data-type="png" data-w="603" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mh5Yn5ouM3Xuw9g8HB2lFKABNobge9sTic6R8WLkOhQUXC9cFic9FtiamqCibcfu2EPZBqKXm8954ticA/640?wx_fmt=png&amp;from=appmsg" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mh5Yn5ouM3Xuw9g8HB2lFKABNobge9sTic6R8WLkOhQUXC9cFic9FtiamqCibcfu2EPZBqKXm8954ticA/640?wx_fmt=png&amp;from=appmsg"></p><p><span><br mpa-from-tpl="t"></span></p><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>#单组雷达图绘制：</span><br mpa-from-tpl="t"><span>ggradar</span>(dt[1,],<br mpa-from-tpl="t">        <span>grid</span>.min = 11, <span>#最小网格线椭圆对应数值</span><br mpa-from-tpl="t">        <span>grid</span>.mid = 23.75, <span>#中间网格线椭圆对应数值</span><br mpa-from-tpl="t">        <span>grid</span>.max = 36.5) <span>#最大网格线椭圆对应数值</span><br mpa-from-tpl="t"><span>##根据数据限制网格线数值范围，若数据不在区间内(默认0-1)会报错；</span></code></pre></section><p><span></span><br></p><p><img data-imgfileid="100050461" data-ratio="0.7435185185185185" data-type="png" data-w="1080" height="803" width="1080" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6lzCibPnyV52xtfVSbCMMybkkSp5iaD9jdOeXicQ54a2gwmXOux3CnCaiceYc6mQouGYuuETmr9S0KaNw/640?wx_fmt=png" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6lzCibPnyV52xtfVSbCMMybkkSp5iaD9jdOeXicQ54a2gwmXOux3CnCaiceYc6mQouGYuuETmr9S0KaNw/640?wx_fmt=png"></p><p><br></p><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>#多组雷达图绘制：</span><br mpa-from-tpl="t"><span>ggradar</span>(dt,<br mpa-from-tpl="t">        <span>grid</span>.min = 11,<br mpa-from-tpl="t">        <span>grid</span>.mid = 23.75,<br mpa-from-tpl="t">        <span>grid</span>.max = 36.5)</code></pre></section><p><br></p><p><span></span></p><p><img data-imgfileid="100050411" data-ratio="0.5703703703703704" data-type="png" data-w="1080" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mh5Yn5ouM3Xuw9g8HB2lFKKh4ia2gxShW0sfiam4qXKptpbiblQDEjD92ueyZLia8d33AWvLicTzIiaHVA/640?wx_fmt=png&amp;from=appmsg" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mh5Yn5ouM3Xuw9g8HB2lFKKh4ia2gxShW0sfiam4qXKptpbiblQDEjD92ueyZLia8d33AWvLicTzIiaHVA/640?wx_fmt=png&amp;from=appmsg"></p><p><br></p><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>#雷达图参数优化：</span><br mpa-from-tpl="t"><span>mycol</span> &lt;- c('#cd4a33', '#eaa822', '#4ca7bd', '#88bd6d', '#354d7d', '#14927c') <span>#自定义配色</span><br mpa-from-tpl="t"><span>dt</span>$group &lt;- factor(dt$group, levels = dt$group) <span>#转化为因子,固定绘图顺序</span><br mpa-from-tpl="t"><br mpa-from-tpl="t"><span>ggradar</span>(dt,<br mpa-from-tpl="t">        <span>grid</span>.min = 5, <br mpa-from-tpl="t">        <span>grid</span>.mid = 20.75, <br mpa-from-tpl="t">        <span>grid</span>.max = 36.5, <br mpa-from-tpl="t">        <span>values</span>.radar = NA, <span>#不显示网格线椭圆对应数值，可不显示</span><br mpa-from-tpl="t">        <span>gridline</span>.mid.colour = 'grey', <span>#中间网格线颜色</span><br mpa-from-tpl="t">        <span>axis</span>.label.size = 5.5, <span>#文本标签大小</span><br mpa-from-tpl="t">        <span>group</span>.colours = mycol,<br mpa-from-tpl="t">        <span>group</span>.point.size = 4,<span>#点大小</span><br mpa-from-tpl="t">        <span>group</span>.line.width = 1, <span>#线宽</span><br mpa-from-tpl="t">        <span>background</span>.circle.colour = '#D7D6D1', <span>#背景填充色</span><br mpa-from-tpl="t">        <span>background</span>.circle.transparency = 0.2, <span>#背景填充不透明度</span><br mpa-from-tpl="t">        <span>legend</span>.position = 'bottom', <span>#图例位置</span><br mpa-from-tpl="t">        <span>legend</span>.text.size = 14 <span>#图例标签大小</span><br mpa-from-tpl="t">)</code></pre></section><p><br></p><p><img data-imgfileid="100050412" data-ratio="0.9268518518518518" data-type="png" data-w="1080" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mh5Yn5ouM3Xuw9g8HB2lFKm9UWcelfOpNtIria3IPt3tiatVr2G5qcGicZMBzKdpuqjhibnwlphqBaPw/640?wx_fmt=png&amp;from=appmsg" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mh5Yn5ouM3Xuw9g8HB2lFKm9UWcelfOpNtIria3IPt3tiatVr2G5qcGicZMBzKdpuqjhibnwlphqBaPw/640?wx_fmt=png&amp;from=appmsg"></p><p><br></p><p><span>ggradar包</span><span>中，只能添加三条背景椭圆网格线（等同于极坐标刻度），如果想像文献一样，显示多条网格，可后期在AI中添加。</span></p><p><span><br></span></p><p><span>打开AI（Adobe Illustrator），菜单栏</span><span>文件—打开</span><span>将上一步绘制好的雷达图（记得保存为矢量格式）导入AI。首先，使用</span><span>直线段</span><span>或</span><span>钢笔工具</span><span>计算下两个网格间的直线距离（便于计算所需偏移量），使用</span><span>直接选择工具</span><span>，选中椭圆线，菜单栏选择</span><span>对象—路径—偏移路径</span><span>。</span></p><p><span><br></span></p><p><img data-imgfileid="100050415" data-ratio="0.7518518518518519" data-type="png" data-w="1080" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mh5Yn5ouM3Xuw9g8HB2lFKUMC9lK8oTdjZB7vfxUwTF2nGI8h9spgXyTAgZfp2WPzdfVvRH0CQsA/640?wx_fmt=png&amp;from=appmsg" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mh5Yn5ouM3Xuw9g8HB2lFKUMC9lK8oTdjZB7vfxUwTF2nGI8h9spgXyTAgZfp2WPzdfVvRH0CQsA/640?wx_fmt=png&amp;from=appmsg"></p><p><br></p><p><span>根据所需要添加的椭圆线数量和直线距离计算需要的偏移量，点击确定即可。</span></p><p><br></p><p><img data-imgfileid="100050414" data-ratio="0.7305555555555555" data-type="png" data-w="1080" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mh5Yn5ouM3Xuw9g8HB2lFK6beicwaVMcGyeybeW1GIIUFUzMfy9qCUWAusaoHAq5sqRUSxH8kXRXQ/640?wx_fmt=png&amp;from=appmsg" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mh5Yn5ouM3Xuw9g8HB2lFK6beicwaVMcGyeybeW1GIIUFUzMfy9qCUWAusaoHAq5sqRUSxH8kXRXQ/640?wx_fmt=png&amp;from=appmsg"></p><p><br></p><p><span>最终效果如下：</span></p><p><br></p><p><img data-imgfileid="100050452" data-ratio="0.8055555555555556" data-type="png" data-w="1080" height="870" width="1080" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6lzCibPnyV52xtfVSbCMMybkZkghibosibeVVfY48y673wq7XBpicqtPuqmdpXcpghFY0BB9EE60lO4vA/640?wx_fmt=png" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6lzCibPnyV52xtfVSbCMMybkZkghibosibeVVfY48y673wq7XBpicqtPuqmdpXcpghFY0BB9EE60lO4vA/640?wx_fmt=png"></p><p><br></p><p><span>好啦，今日分享毕！</span></p><p><br></p><section data-mpa-template="t" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><img data-imgfileid="100050459" data-ratio="0.35" data-w="240" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/cTgc9k6fDSuLPN2ebKYFIGuEWWj7trS4mew8PialvQ7dTTFvWY724bj8ljbUe8YDzzR1jxryU0wdTyJW7YptC9Q/640?wx_fmt=png" src="https://mmbiz.qpic.cn/sz_mmbiz_png/cTgc9k6fDSuLPN2ebKYFIGuEWWj7trS4mew8PialvQ7dTTFvWY724bj8ljbUe8YDzzR1jxryU0wdTyJW7YptC9Q/640?wx_fmt=png"></section><section data-mid="" mpa-from-tpl="t"><p data-mid="" mpa-is-content="t">参考文献</p></section></section></section></section><p><br></p><section><span>Yang, X., Xiong, J., Du, T. et al. Diversifying crop rotation increases food production, reduces net greenhouse gas emissions and improves soil health. Nat Commun 15, 198 (2024).</span></section><p><span><br></span></p><p><span><br></span></p><p><strong><span>*未经许可，不得以任何方式复制或抄袭本篇文章之部分或全部内容。版权所有，侵权必究。</span></strong></p><p><br></p><section data-role="outer" label="Powered by 135editor.com"><section data-tools="135编辑器" data-id="105648"><section><section data-role="outer" label="Powered by 135editor.com"><section data-role="paragraph"><section data-role="outer" label="Powered by 135editor.com"><section data-tools="135编辑器" data-id="105648"><section><section><img data-ratio="0.8780487804878049" data-type="png" data-w="41" data-width="100%" data-imgfileid="100050454" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6kCKJYcEqEIfoJYG621mPJE8VibmibGU0Jxic9iabARVRH0FT6BNE8VAglWFXBPibFAU7a6tWGibSs8wyUg/640?wx_fmt=png" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6kCKJYcEqEIfoJYG621mPJE8VibmibGU0Jxic9iabARVRH0FT6BNE8VAglWFXBPibFAU7a6tWGibSs8wyUg/640?wx_fmt=png"></section><section><section><section data-width="35%"><section><section data-width="100%"><img data-imgfileid="100050457" data-ratio="1" data-type="jpeg" data-w="860" data-width="100%" title="SCIPainter 30cm二维码.jpg" data-src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/tgUVxVRjT6kCKJYcEqEIfoJYG621mPJEv5etCBwHicqbEPwnVrkpaasxqaVibM4mT2JdIuN6yTlYWDD4mL5A427A/640?wx_fmt=jpeg" src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/tgUVxVRjT6kCKJYcEqEIfoJYG621mPJEv5etCBwHicqbEPwnVrkpaasxqaVibM4mT2JdIuN6yTlYWDD4mL5A427A/640?wx_fmt=jpeg"></section></section></section><section data-width="50%"><section><section data-brushtype="text"><span><strong># SCIPainter</strong></span></section><section data-brushtype="text" hm_fix="361:593"><p>基迪奥旗下绘图公众号</p><p>分享科研绘图技能与工具</p><p>欢迎关注与转发~</p></section></section></section></section></section></section></section></section></section></section><section><br></section></section></section><section data-role="paragraph"><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><img data-ratio="1" data-type="gif" data-w="400" data-imgfileid="100050456" data-src="https://mmbiz.qpic.cn/sz_mmbiz_gif/tgUVxVRjT6kCKJYcEqEIfoJYG621mPJEgMd0aMPtmrDjiaX8sBhfhicVteeHf1JicexSpUbS3fdS9SiboUVN7guaPw/640?wx_fmt=gif" src="https://mmbiz.qpic.cn/sz_mmbiz_gif/tgUVxVRjT6kCKJYcEqEIfoJYG621mPJEgMd0aMPtmrDjiaX8sBhfhicVteeHf1JicexSpUbS3fdS9SiboUVN7guaPw/640?wx_fmt=gif"></section></section></section><section><section powered-by="xiumi.us"><section><p><span><strong>你的好友拍了拍你</strong></span></p><p><span><strong>并请你帮她点一下</strong></span><strong><span>“分享”</span></strong><span><strong><span>~</span></strong></span></p></section></section></section></section></section><p><br></p></section></section><p><span><br></span></p><p><mp-style-type data-value="10000"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/KYOqAPbSpYL66fuoPvUOQw",target="_blank" rel="noopener noreferrer">原文链接</a>
