---
title: "简单用python写一个核酸序列反向互补的脚本"
date: 2024-01-02T01:09:15Z
draft: ["false"]
tags: [
  "fetched",
  "水瓶之翼"
]
categories: ["Acdemic"]
---
简单用python写一个核酸序列反向互补的脚本 by 水瓶之翼
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><p data-tool="mdnice编辑器">最近浅学了一下 biopython 包，小试牛刀。</p><p data-tool="mdnice编辑器">我之前对核酸序列反向互补的方法一般是：在线网站、引物设计软件、TBtools工具、命令行工具seqkit等。如果能自己写个 pythoon 脚本只需要本地运行一行 python 代码就行了，比较实用，而且如果有其它个性化需求也可以随时修改脚本。</p><p data-tool="mdnice编辑器">所以这次实践的任务就是借助 biopython 包写一个名为 reverse_complement.py 的 python 脚本。预期结果是：输入待处理的核酸序列的 fasta 文件（里面可以含有1条或多条核酸序列，直接重命名为 seq.fasta），然后在 windows 终端运行<code>py reverse_complement.py</code>，就可以直接输出一个名为 new_seq.fasta 的文件，里面的序列都是已经经过反向互补或者其它操作的。暂时添加核酸序列常用的 5 种功能：反向互补、互补、反向、转换为 mRNA 序列、翻译为蛋白序列。</p><h2 data-tool="mdnice编辑器"><span>最终代码</span></h2><p data-tool="mdnice编辑器">下面是 reverse_complement.py 脚本中默认的代码，如果只需要进行序列反向互补，准备好 seq.fasta 序列文件后只需要在 windows 终端运行<code>py reverse_complement.py</code>即可。如果需要执行其它功能，只需要把反向互补操作对应的代码行注释掉，把需要执行的其它功能对应的代码行取消注释，因此实际上每次转换运行的仅仅是 8 行代码。</p><p data-tool="mdnice编辑器">需要注意的是，代码运行的前提是 windows 已经安装了 python3 以及 biopython 包。</p><pre data-tool="mdnice编辑器"><code><span>from</span> Bio <span>import</span> SeqIO<br><br>records = SeqIO.parse(<span>"seq.fasta"</span>,<span>"fasta"</span>)<br><br>record_list = []<br><span>for</span> record <span>in</span> records:<br>    <span>## 1. 反向互补</span><br>    new_seq = record.seq.reverse_complement()<br>    <span>## 2. 反向</span><br>    <span># new_seq = record.seq[::-1]</span><br>    <span>## 3. 互补</span><br>    <span># new_seq = record.seq.complement()</span><br>    <span>## 4. 转录</span><br>    <span># new_seq = record.seq.transcribe()</span><br>    <span>## 5. 翻译</span><br>    <span># new_seq = record.seq.translate()</span><br><br>    record.seq = new_seq<br>    record_list.append(record)<br><br>SeqIO.write(record_list,<span>"new_seq.fasta"</span>,<span>"fasta"</span>)<br></code></pre><h2 data-tool="mdnice编辑器"><span>代码解析</span></h2><p data-tool="mdnice编辑器">上面代码一共 21 行，下面详细解析一下每一行做了什么：</p><ul data-tool="mdnice编辑器"><li><section><p>第 1 行：从 biopython 包的 Bio 模块中导入 SeqIO 模块，用于解析 fasta 文件、输出 fasta 文件</p></section></li><li><section><p>第 2 行：空行，仅作为代码行区分用</p></section></li><li><section><p>第 3 行：使用 SeqIO 模块中定义的 parse() 函数解析 fasta 文件，该函数的参数有 2 个，第1个是输入的 fasta 文件的文件名，第2个是文件格式即 fasta。parse() 函数解析后可以得到1个迭代器对象，相当于1个列表，里面储存了 fasta 文件中每条序列的信息，这样才能实现批量转换，这里把它赋值给变量 records。（这个"列表"中每个元素代表1条序列的所有信息，储存了序列 id，序列描述信息，序列的碱基序列等信息，biopython 中称之为 SeqRecord 对象）</p></section></li><li><section><p>第 4 行：空行，仅作为代码行区分用</p></section></li><li><section><p>第 5 行：后面要执行的操作就是，把 fasta 文件中的每条序列依次进行转换，所以需要执行循环操作，每次循环完成转换后的序列需要把它储存在1个列表中后面才能输出，所以这一行代码定义了1个名为 record_list 的变量，初始化为空列表。</p></section></li><li><section><p>第 6 行：for 循环语句，该行代表从 records "列表"中循环取出1个元素，该元素信息暂存在 record 对象中，for语句块中即对这个对象进行操作。</p></section></li><li><section><p>第 7-8 行：第7行为第 1 个功能：反向互补的注释信息。第 8 行对 record 对象进行了反向互补操作，即对 record 对象的 .seq 属性执行 reverse_complement()即反向互补方法，反向互补后赋值给变量 new_seq。（前面说了，record 对象实际上在 biopython 中称为 SeqRecord 对象，<code>.seq</code>为 SeqRecord 对象的其中1个属性，代表碱基序列信息，<code>record.seq</code>相当于 biopython 中定义的 Seq 对象，因此可以使用 Seq 这个对象中定义的 <code>reverse_complement()</code> 方法进行序列的反向互补操作。（关于<code>reverse_complement()</code>方法我本来有一个疑问，那就是我不需要导入 Seq 类为什么就能直接调用该方法，去看了一下源代码发现 SeqIO 模块中导入了 SeqRecord 模块，而 SeqRecord 模块又导入了 Seq 类，因此可以直接使用反向互补的方法，因此实质上还是调用了 Seq 类中的方法。</p></section></li><li><section><p>第 9-10 行：同理，第 9 行为第 2 个功能：反向的注释信息。第 10 行对 record 对象进行了反向操作，不过因为 Seq 类中没有定义序列反向的方法，所以这里直接使用列表的基本功能进行序列反向操作，即通过下标索引从头到尾，然后将步长设置为-1即可完成序列的反向。</p></section></li><li><section><p>第 11-12 行：同理，第 11 行为第 3 个功能：互补的注释信息。第 12 行对 record 对象进行了互补操作，直接调用 Seq 类的 <code>complement()</code>方法。</p></section></li><li><section><p>第 13-14 行：同理，第 13 行为第 4 个功能：转录的注释信息。第 14 行对 record 对象进行了转录操作，直接调用 Seq 类的 <code>transcribe()</code>方法。（在 biopython 中，转录只是把输入序列的 T 碱基改成了 U 碱基）</p></section></li><li><section><p>第 15-16 行：同理，第 15 行为第 5 个功能：翻译的注释信息。第 16 行对 record 对象进行了翻译操作，直接调用 Seq 类的 <code>translate()</code>方法。对于翻译，暂时使用的是默认参数，一是使用标准密码子表进行翻译，如果是线粒体DNA等不是使用标准密码子表的还需要进一步设置参数；二是翻译后序列中终止密码子显示为<code>*</code>，且是从头到尾进行翻译，不管出现几个终止密码子，如果要更改终止密码子显示方式，或者遇到第 1 个终止密码子就停止翻译，还需要进一步设置参数。</p></section></li><li><section><p>第 17 行：空行，仅作为代码行区分用</p></section></li><li><section><p>第 18 行：对原来的序列进行更改，因为前面的操作只是将碱基序列进行了转换，暂时储存在 new_seq 变量中。前面已经说了<code>record.seq</code>为 SeqRecord 对象的其中1个属性，代表碱基序列信息，这一步直接更改其属性即完成了碱基序列更改，record 这个 SeqRecord 对象中储存的其它信息没有改变。完成这一行代码后 record 对应的序列已经是新的序列了。</p></section></li><li><section><p>第 19 行：调用列表基本方法 append()，将新的 record 对象添加进前面定义好的 record_list 列表中。</p></section></li><li><section><p>第 20 行：空行，仅作为代码行区分用</p></section></li><li><section><p>第 21 行：前面 for 循环结束后得到的是 1 个储存了每条转换后的序列的列表。只需要使用 SeqIO 模块的 write() 方法将里面的序列写入并输出到 1 个新的 fasta 文件中即可。write() 方法中含有 3 个参数，第 1 个参数 record_list 是储存了序列的列表，第 2 个参数"new_seq.fasta"是写入序列并输出的文件名称，第 3 个参数是文件格式即 fasta。</p></section></li></ul><h2 data-tool="mdnice编辑器"><span>脚本测试</span></h2><p data-tool="mdnice编辑器">自定义了 1 个简单的含有3条 fasta 核酸序列的文件测试了一下，能成功运行，且结果完全准确。</p><p data-tool="mdnice编辑器">seq.fasta 文件内容：</p><pre data-tool="mdnice编辑器"><code>&gt;seq1<br>ATGTTTGGGTAA<br>&gt;seq2<br>ATGTTTGGGTACTAA<br>&gt;seq3<br>ATGTTTGGGTACGGGCCCTAA<br></code></pre><h3 data-tool="mdnice编辑器"><span>1. 反向互补</span></h3><p data-tool="mdnice编辑器">脚本不用更改，直接运行：</p><figure data-tool="mdnice编辑器"><img data-imgfileid="100000889" data-ratio="0.09984639016897082" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/9qvDEYXFF7aBbiaZ7qI5pPIibq91g7M36B4XcVHXTpwG8wJCBR7Iyicsm3IUkV3I8nlS0CrXib7ibPU2KZT1HXzkqLw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="651" src="https://mmbiz.qpic.cn/sz_mmbiz_png/9qvDEYXFF7aBbiaZ7qI5pPIibq91g7M36B4XcVHXTpwG8wJCBR7Iyicsm3IUkV3I8nlS0CrXib7ibPU2KZT1HXzkqLw/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器">转换后 new_seq.fasta 文件内容：</p><figure data-tool="mdnice编辑器"><img data-imgfileid="100000893" data-ratio="0.536813922356091" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/9qvDEYXFF7aBbiaZ7qI5pPIibq91g7M36B3Vq3vjMicG3NLsqHkUo58KgH5ZvJWe4ziaKyLDDO2J53XTJYuKoaHudw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="747" src="https://mmbiz.qpic.cn/sz_mmbiz_png/9qvDEYXFF7aBbiaZ7qI5pPIibq91g7M36B3Vq3vjMicG3NLsqHkUo58KgH5ZvJWe4ziaKyLDDO2J53XTJYuKoaHudw/640?wx_fmt=png&amp;from=appmsg"></figure><h3 data-tool="mdnice编辑器"><span>2. 反向</span></h3><p data-tool="mdnice编辑器">取消注释对应功能的代码，注释其它功能代码，脚本更改为：</p><pre data-tool="mdnice编辑器"><code><span>from</span> Bio <span>import</span> SeqIO<br><br>records = SeqIO.parse(<span>"seq.fasta"</span>,<span>"fasta"</span>)<br><br>record_list = []<br><span>for</span> record <span>in</span> records:<br>    <span>## 1. 反向互补</span><br>    <span># new_seq = record.seq.reverse_complement()</span><br>    <span>## 2. 反向</span><br>    new_seq = record.seq[::<span>-1</span>]<br>    <span>## 3. 互补</span><br>    <span># new_seq = record.seq.complement()</span><br>    <span>## 4. 转录</span><br>    <span># new_seq = record.seq.transcribe()</span><br>    <span>## 5. 翻译</span><br>    <span># new_seq = record.seq.translate()</span><br><br>    record.seq = new_seq<br>    record_list.append(record)<br><br>SeqIO.write(record_list,<span>"new_seq.fasta"</span>,<span>"fasta"</span>)<br></code></pre><p data-tool="mdnice编辑器">转换后 new_seq.fasta 文件内容：</p><figure data-tool="mdnice编辑器"><img data-imgfileid="100000891" data-ratio="0.5710227272727273" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/9qvDEYXFF7aBbiaZ7qI5pPIibq91g7M36BNlxMtjoNDA9lINyGiaWbMPt2cSslf2iaI38TBBic6ezQaU4zHZqSQLicDQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="704" src="https://mmbiz.qpic.cn/sz_mmbiz_png/9qvDEYXFF7aBbiaZ7qI5pPIibq91g7M36BNlxMtjoNDA9lINyGiaWbMPt2cSslf2iaI38TBBic6ezQaU4zHZqSQLicDQ/640?wx_fmt=png&amp;from=appmsg"></figure><h3 data-tool="mdnice编辑器"><span>3. 互补</span></h3><p data-tool="mdnice编辑器">取消注释对应功能的代码，注释其它功能代码，脚本更改为：</p><pre data-tool="mdnice编辑器"><code><span>from</span> Bio <span>import</span> SeqIO<br><br>records = SeqIO.parse(<span>"seq.fasta"</span>,<span>"fasta"</span>)<br><br>record_list = []<br><span>for</span> record <span>in</span> records:<br>    <span>## 1. 反向互补</span><br>    <span># new_seq = record.seq.reverse_complement()</span><br>    <span>## 2. 反向</span><br>    <span># new_seq = record.seq[::-1]</span><br>    <span>## 3. 互补</span><br>    new_seq = record.seq.complement()<br>    <span>## 4. 转录</span><br>    <span># new_seq = record.seq.transcribe()</span><br>    <span>## 5. 翻译</span><br>    <span># new_seq = record.seq.translate()</span><br><br>    record.seq = new_seq<br>    record_list.append(record)<br><br>SeqIO.write(record_list,<span>"new_seq.fasta"</span>,<span>"fasta"</span>)<br></code></pre><p data-tool="mdnice编辑器">转换后 new_seq.fasta 文件内容：</p><figure data-tool="mdnice编辑器"><img data-imgfileid="100000892" data-ratio="0.5685714285714286" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/9qvDEYXFF7aBbiaZ7qI5pPIibq91g7M36BVNhPrDVgOFmJDartWiaKEc8YLIBXfyfc26KLECwibeu8KKOngSvB7vLg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="700" src="https://mmbiz.qpic.cn/sz_mmbiz_png/9qvDEYXFF7aBbiaZ7qI5pPIibq91g7M36BVNhPrDVgOFmJDartWiaKEc8YLIBXfyfc26KLECwibeu8KKOngSvB7vLg/640?wx_fmt=png&amp;from=appmsg"></figure><h3 data-tool="mdnice编辑器"><span>4. 转录</span></h3><p data-tool="mdnice编辑器">取消注释对应功能的代码，注释其它功能代码，脚本更改为：</p><pre data-tool="mdnice编辑器"><code><span>from</span> Bio <span>import</span> SeqIO<br><br>records = SeqIO.parse(<span>"seq.fasta"</span>,<span>"fasta"</span>)<br><br>record_list = []<br><span>for</span> record <span>in</span> records:<br>    <span>## 1. 反向互补</span><br>    <span># new_seq = record.seq.reverse_complement()</span><br>    <span>## 2. 反向</span><br>    <span># new_seq = record.seq[::-1]</span><br>    <span>## 3. 互补</span><br>    <span># new_seq = record.seq.complement()</span><br>    <span>## 4. 转录</span><br>    new_seq = record.seq.transcribe()<br>    <span>## 5. 翻译</span><br>    <span># new_seq = record.seq.translate()</span><br><br>    record.seq = new_seq<br>    record_list.append(record)<br><br>SeqIO.write(record_list,<span>"new_seq.fasta"</span>,<span>"fasta"</span>)<br></code></pre><p data-tool="mdnice编辑器">转换后 new_seq.fasta 文件内容：</p><figure data-tool="mdnice编辑器"><img data-imgfileid="100000890" data-ratio="0.5598290598290598" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/9qvDEYXFF7aBbiaZ7qI5pPIibq91g7M36BoadCbWFOBV51OBtA1I69msbWeaKGRiczOrqKtl6JB7r2qOyYjhwbCnA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="702" src="https://mmbiz.qpic.cn/sz_mmbiz_png/9qvDEYXFF7aBbiaZ7qI5pPIibq91g7M36BoadCbWFOBV51OBtA1I69msbWeaKGRiczOrqKtl6JB7r2qOyYjhwbCnA/640?wx_fmt=png&amp;from=appmsg"></figure><h3 data-tool="mdnice编辑器"><span>5. 翻译</span></h3><p data-tool="mdnice编辑器">取消注释对应功能的代码，注释其它功能代码，脚本更改为：</p><pre data-tool="mdnice编辑器"><code><span>from</span> Bio <span>import</span> SeqIO<br><br>records = SeqIO.parse(<span>"seq.fasta"</span>,<span>"fasta"</span>)<br><br>record_list = []<br><span>for</span> record <span>in</span> records:<br>    <span>## 1. 反向互补</span><br>    <span># new_seq = record.seq.reverse_complement()</span><br>    <span>## 2. 反向</span><br>    <span># new_seq = record.seq[::-1]</span><br>    <span>## 3. 互补</span><br>    <span># new_seq = record.seq.complement()</span><br>    <span>## 4. 转录</span><br>    <span># new_seq = record.seq.transcribe()</span><br>    <span>## 5. 翻译</span><br>    new_seq = record.seq.translate()<br><br>    record.seq = new_seq<br>    record_list.append(record)<br><br>SeqIO.write(record_list,<span>"new_seq.fasta"</span>,<span>"fasta"</span>)<br></code></pre><p data-tool="mdnice编辑器">转换后 new_seq.fasta 文件内容：</p><figure data-tool="mdnice编辑器"><img data-imgfileid="100000894" data-ratio="0.6807432432432432" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/9qvDEYXFF7aBbiaZ7qI5pPIibq91g7M36BsdK8fSiavecJu3c895HdQYEsqEj3qSP9MibEjIAMBRzJvzd2vGIOUvPw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="592" src="https://mmbiz.qpic.cn/sz_mmbiz_png/9qvDEYXFF7aBbiaZ7qI5pPIibq91g7M36BsdK8fSiavecJu3c895HdQYEsqEj3qSP9MibEjIAMBRzJvzd2vGIOUvPw/640?wx_fmt=png&amp;from=appmsg"></figure></section><p><br></p><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/jCP-7UrtMQLvQ5kH0sAkbg",target="_blank" rel="noopener noreferrer">原文链接</a>
