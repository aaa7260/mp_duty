---
title: "Scissor实操（二）：逻辑回归分析流程解读"
date: 2022-09-01T05:57:57Z
draft: ["false"]
tags: [
  "fetched",
  "生信宝库"
]
categories: ["Acdemic"]
---
Scissor实操（二）：逻辑回归分析流程解读 by 生信宝库
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><h2 data-tool="mdnice编辑器"><span></span><span>前言</span><span></span></h2><p data-tool="mdnice编辑器">在上一期推文：<a href="https://mp.weixin.qq.com/s?__biz=MzI4MjY5ODI1Nw==&amp;mid=2247486287&amp;idx=1&amp;sn=670cff633ff3cf4e948f3a1a445d4358&amp;chksm=eb94bc31dce3352721fdffab250478da7d1702a9878da7a7f660ad51581c7f3301332cdee4a2&amp;token=1773822788&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">Scissor实操（一）：利用Cox回归模型识别特征细胞</a>，Immugent介绍了如何使用Scissor对连续变量的表征(患者生存信息)进行关联分析，但我们知道在各种临床信息中还有一大类是分类变量。例如某个基因突变情况，不同阶段的肿瘤患者不同性别的肿瘤患者信息等等。那么在本篇推文中，Immugent将会介绍如何使用Scissor对分类变量的表型进行关联分析。</p><p data-tool="mdnice编辑器">此外，由于Scissor还有最后一部分内容不值当单独写一篇推文（所以生信宝库还是很良心的，从不坑蒙粉丝，哈哈），Immugent也会在文末进行介绍。</p><p data-tool="mdnice编辑器"><br></p><hr data-tool="mdnice编辑器"><h2 data-tool="mdnice编辑器"><span></span><span>代码展示</span><span></span></h2><p data-tool="mdnice编辑器">这次使用的也是来源于TCGA-LUAD的数据，只是本次演示的是如何使用Scissor对分类变量特征进行分析。</p><pre data-tool="mdnice编辑器"><code>load(url(paste0(location, <span>'TCGA_LUAD_exp2.RData'</span>)))<br>load(url(paste0(location, <span>'TCGA_LUAD_TP53_mutation.RData'</span>)))<br>table(TP53_mutation)<br><span>## TP53_mutation</span><br><span>##   0   1 </span><br><span>## 243 255</span><br></code></pre><p data-tool="mdnice编辑器">给定上述TP53突变= 1，野生型= 0的二元变量，下面在Scissor中使用family = 'binomial'来选择表型相关的细胞亚群:</p><pre data-tool="mdnice编辑器"><code>phenotype &lt;- TP53_mutation<br>tag &lt;- c(<span>'wild-type'</span>, <span>'TP53 mutant'</span>)<br>infos4 &lt;- Scissor(bulk_dataset, sc_dataset, phenotype, tag = tag, alpha = 0.5, <br>                 family = <span>"binomial"</span>, Save_file = <span>"Scissor_LUAD_TP53_mutation.RData"</span>)<br>infos5 &lt;- Scissor(bulk_dataset, sc_dataset, phenotype, tag = tag, alpha = 0.2, <br>                 family = <span>"binomial"</span>, Load_file = <span>"Scissor_LUAD_TP53_mutation.RData"</span>)                 <br></code></pre><p data-tool="mdnice编辑器">总共有414个Scissor+细胞与TP53突变相关，318个Scissor-细胞与野生型相关，下面可以使用UMAP可视化这些选定的细胞:</p><pre data-tool="mdnice编辑器"><code>Scissor_select &lt;- rep(0, ncol(sc_dataset))<br>names(Scissor_select) &lt;- colnames(sc_dataset)<br>Scissor_select[infos5<span>$Scissor_pos</span>] &lt;- 1<br>Scissor_select[infos5<span>$Scissor_neg</span>] &lt;- 2<br>sc_dataset &lt;- AddMetaData(sc_dataset, metadata = Scissor_select, col.name = <span>"scissor"</span>)<br>DimPlot(sc_dataset, reduction = <span>'umap'</span>, group.by = <span>'scissor'</span>, cols = c(<span>'grey'</span>,<span>'indianred1'</span>,<span>'royalblue'</span>), pt.size = 1.2, order = c(2,1))<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.9090909090909091" data-src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7ftg4neicKian1gtt015FbGsrJmpVDRLoJD7hPF1NmmSwcK8Bvl1ec9zYC0NPQ0zqHThHp6tbM6Copg/640?wx_fmt=png" data-type="png" data-w="1056" src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7ftg4neicKian1gtt015FbGsrJmpVDRLoJD7hPF1NmmSwcK8Bvl1ec9zYC0NPQ0zqHThHp6tbM6Copg/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">为了确定推断的表型-细胞关联是否可靠，可以使用reliability.test检验进行信度显著性检验。可靠性显著性检验的动机是:如果选择的单细胞和批量数据不适合表型与细胞的关联，相关性将是信息量较少，与表型标签的关联不佳。因此，相应的预测性能较差，与随机排列的标签没有显著区别。在本教程中，我们将测试上述应用程序中确定的关联，作为示例来展示如何运行reliability.test。</p><p data-tool="mdnice编辑器">下面选择了205个存活较差或较好的细胞。保存在Scissor中的Rdata可以作为测试输入:</p><pre data-tool="mdnice编辑器"><code>load(<span>'Scissor_LUAD_survival.RData'</span>)<br>numbers &lt;- length(infos1<span>$Scissor_pos</span>) + length(infos1<span>$Scissor_neg</span>)<br>result1 &lt;- reliability.test(X, Y, network, alpha = 0.05, family = <span>"cox"</span>, cell_num = numbers, n = 10, nfold = 10)<br>names(result1)<br><span>## [1] "statistic"         "p"                 "c_index_test_real" "c_index_test_back"</span><br></code></pre><pre data-tool="mdnice编辑器"><code>load(<span>'Scissor_LUAD_TP53_mutation.RData'</span>)<br>numbers &lt;- length(infos5<span>$Scissor_pos</span>) + length(infos5<span>$Scissor_neg</span>)<br>result2 &lt;- reliability.test(X, Y, network, alpha = 0.2, family = <span>"binomial"</span>, cell_num = numbers, n = 10, nfold = 10)<br><br></code></pre><p data-tool="mdnice编辑器">最后，我们可以使用函数求值，为每一个选择的单元格获取一些支持信息。以具有存活信息的LUAD癌细胞为例，我们可通过运行以下代码对205个“Scissor+”细胞进行评估:</p><pre data-tool="mdnice编辑器"><code>evaluate_summary &lt;- evaluate.cell(<span>'Scissor_LUAD_survival.RData'</span>, infos1, FDR = 0.05, bootstrap_n = 100)<br>evaluate_summary[1:5,1:4]<br></code></pre><pre data-tool="mdnice编辑器"><code>all(evaluate_summary$`Mean correlation` &amp; as.numeric(gsub(<span>'%'</span>,<span>''</span>,evaluate_summary$`Correlation &gt; 0`)) &gt; 50)<br><span>## [1] TRUE</span><br>evaluate_summary[1:5,5:10]<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.2728260869565217" data-src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7ftg4neicKian1gtt015FbGsrUKXmmKFCfx0JKC4OOhyzz3PYLYBJ1icxQpP7ZbJAhNOHawR7AGHIEQw/640?wx_fmt=png" data-type="png" data-w="920" src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7ftg4neicKian1gtt015FbGsrUKXmmKFCfx0JKC4OOhyzz3PYLYBJ1icxQpP7ZbJAhNOHawR7AGHIEQw/640?wx_fmt=png"></figure><hr data-tool="mdnice编辑器"><h2 data-tool="mdnice编辑器"><span></span><span>总结</span><span></span></h2><p data-tool="mdnice编辑器">到目前为止，Scissor软件相关的三篇推文就已经完全更新完毕。但是按照生信宝库送返送到嘴里的一贯做法，未来可能还会更新一篇推文，通过已经发表的文章介绍如何将Scissor运用到实际的文章分析中，敬请期待。</p><p data-tool="mdnice编辑器">总的来说，Scissor虽然有一些小bug，但是整体还是很稳健的，特别是对于解决单一表征为主的科学问题是非常合适的。未来可能还会出现比Scissor更好的分析软件，让我们拭目以待！</p><p data-tool="mdnice编辑器"><br></p><hr data-tool="mdnice编辑器"></section><p><br></p><p><img data-galleryid="" data-ratio="1" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/GL6g5Y3aR7f28iaAPOSZyaVreHSWoQket3gNW3WtOGwutAMDGYKSk6ZBOdhDUyS95mNMn5INvyOIibBSfHgzI6sQ/640?wx_fmt=jpeg" data-type="jpeg" data-w="258" src="https://mmbiz.qpic.cn/mmbiz_jpg/GL6g5Y3aR7f28iaAPOSZyaVreHSWoQket3gNW3WtOGwutAMDGYKSk6ZBOdhDUyS95mNMn5INvyOIibBSfHgzI6sQ/640?wx_fmt=jpeg"></p><h3 data-tool="mdnice编辑器"><span>关注下方公众号下回更新不迷路</span></h3><section><mp-common-profile data-id="MzI4MjY5ODI1Nw==" data-pluginname="mpprofile" data-headimg="http://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7f28iaAPOSZyaVreHSWoQketIFUzNSiayMfvqbyCD0TNcBv06SGnkaO1gXRsN9icoQ23IjMJ5ta3Jia9w/0?wx_fmt=png" data-nickname="生信宝库" data-alias="sxbk2020" data-signature="用于生信知识的收集与传播，以及生信人之间学习交流。本公众号各小编平时忙于科研，更新文章较其它同类型公众号较慢，但保持宁缺毋滥的本心，只更新对大家有用的推文。" data-from="2" data-is_biz_ban="0"></mp-common-profile><span></span></section></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/ymSFCfmW1jVTcXppY0eOPw",target="_blank" rel="noopener noreferrer">原文链接</a>
