---
title: "R中fasta文件的导入与导出"
date: 2023-07-21T05:40:38Z
draft: ["false"]
tags: [
  "fetched",
  "水瓶之翼"
]
categories: ["Acdemic"]
---
R中fasta文件的导入与导出 by 水瓶之翼
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><br><p data-tool="mdnice编辑器">遇到一个问题，我想批量修改fasta序列中<code>&gt;</code>后面的信息。所以找了个办法，那就是先导入R中，进行批量修改后再导出来。使用R包seqinr的read.fasta以及write.fasta函数即可搞定。</p><p data-tool="mdnice编辑器">修改之前的序列类似下面的格式(...代表碱基序列)：</p><pre data-tool="mdnice编辑器"><code>seq1<br>...<br>seq2<br>...<br>seq3<br>...<br>seq4<br>...<br></code></pre><p data-tool="mdnice编辑器">批量修改之后比如希望得到下面的格式：</p><pre data-tool="mdnice编辑器"><code>seq1_China_2018<br>...<br>seq2_China_2016<br>...<br>seq3_USA_2018<br>...<br>seq4_UK_2014<br>...<br></code></pre><hr data-tool="mdnice编辑器"><p data-tool="mdnice编辑器">下面就开始操作：</p><pre data-tool="mdnice编辑器"><code><span>#未安装seqinr包的话需要先安装</span><br><span># BiocManager::install("seqinr")</span><br><span>#加载包</span><br><span>library</span>(seqinr)<br><br><span>#读取原fasta文件 file1.fasta，forceDNAtolower参数设置了不要将碱基替换为小写</span><br>fa &lt;- read.fasta(<span>"file1.fasta"</span>,forceDNAtolower = <span>F</span>)<br></code></pre><p data-tool="mdnice编辑器">读进R后的fa变量是一个列表，储存了所有序列信息，列表的各个元素名称即各个序列<code>&gt;</code>后的注释信息。</p><hr data-tool="mdnice编辑器"><p data-tool="mdnice编辑器">如果需要把 new_name.txt 中的新的<code>&gt;</code>后的注释信息替换掉原来fasta文件中的信息：</p><pre data-tool="mdnice编辑器"><code>( new_name &lt;- read.table(<span>"new_name.txt"</span>) )<br></code></pre><pre data-tool="mdnice编辑器"><code><span>##                V1</span><br><span>## 1 seq1_China_2018</span><br><span>## 2 seq2_China_2016</span><br><span>## 3   seq3_USA_2018</span><br><span>## 4    seq4_UK_2014</span><br></code></pre><blockquote data-tool="mdnice编辑器"><p>需要注意的是新的名称的顺序应与原fasta文件的序列保持一一对应，否则序列的名称会与序列对不上（如果不对应只需要用merge函数处理一下即可）。</p></blockquote><hr data-tool="mdnice编辑器"><p data-tool="mdnice编辑器">接着只需要使用write.fasta函数导出即可。</p><ul data-tool="mdnice编辑器"><li><section>sequence参数输入碱基序列，因为没有更改原来导入的fasta文件的碱基序列，所以只需要传入fa变量即可。</section></li><li><section>names参数即设置输出的fasta文件<code>&gt;</code>后面的注释信息，即我们导入的new_name数据框的第一列。</section></li><li><section>nbchar参数代表设置输出的fasta文件每行的字符数，默认是60。</section></li><li><section>file.out参数即输出的新的fasta文件名称</section></li></ul><pre data-tool="mdnice编辑器"><code>write.fasta(sequences = fa,<br>            names = new_name$V1,<br>            nbchar = <span>70</span>,<br>            file.out = <span>"file2.fasta"</span>)<br></code></pre><hr data-tool="mdnice编辑器"><p data-tool="mdnice编辑器">最后看一下新的文件，已经完成了更改:</p><figure data-tool="mdnice编辑器"><img data-ratio="1.012962962962963" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/9qvDEYXFF7YKmJeDxZxicxl9450QSgl3ibFibBgAx51jYDhjPpbtKjysibHXHX2H3obvsiaqqk6Y6rrjhRk7t97lFcg/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/9qvDEYXFF7YKmJeDxZxicxl9450QSgl3ibFibBgAx51jYDhjPpbtKjysibHXHX2H3obvsiaqqk6Y6rrjhRk7t97lFcg/640?wx_fmt=png"></figure></section><p><br></p><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/dOkiy3-YK8749w8DS555fA",target="_blank" rel="noopener noreferrer">原文链接</a>
