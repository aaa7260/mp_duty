---
title: "如何绘制漂亮的“互作”条形图？"
date: 2023-07-06T03:11:23Z
draft: ["false"]
tags: [
  "fetched",
  "SCIPainter"
]
categories: ["Acdemic"]
---
如何绘制漂亮的“互作”条形图？ by SCIPainter
------
<div><section data-mpa-powered-by="yiban.io"><span>前段时间，我在<a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzIyOTY3MDA3MA==&amp;mid=2247513065&amp;idx=1&amp;sn=eb7a48dbc1d2c086d622cb01f4fcd183&amp;chksm=e8bdde30dfca57264c1f541a88d2e53ed08fb00b0a841e0b1a085b37fe99d48f99b34d2e7897&amp;scene=21#wechat_redirect" textvalue="《只因太美！挑战绘制大佬文章中的绝美“互作”热图》" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2">《只因太美！挑战绘制大佬文章中的绝美“互作”热图》</a>、</span><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzIyOTY3MDA3MA==&amp;mid=2247513334&amp;idx=1&amp;sn=0974b462af7547a32980d3eb0f0c39ea&amp;chksm=e8bdd92fdfca50391b74a324438ae9cc92e55bf114489199d8c9853ec41f34447002a8534838&amp;scene=21#wechat_redirect" textvalue="《如何绘制好看的“互作”网络泡泡图？》" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2"><span>《如何绘制好看的“互作”网络泡泡图？》</span></a><span>两篇文章中介绍过绘制“互作”热图、泡泡图的方法，其实，用相同思路也可以绘制类似的配对条形图，如下图。</span></section><section><span><br></span></section><section><img data-ratio="0.6552083333333333" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6lks4dO0iavscowS8um9h5fhofWiaQ4opkvsU3pQ6eOtyToL1HeGC8HQKb0uILey6B8VQkTrc1Nuvjg/640?wx_fmt=png" data-type="png" data-w="960" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6lks4dO0iavscowS8um9h5fhofWiaQ4opkvsU3pQ6eOtyToL1HeGC8HQKb0uILey6B8VQkTrc1Nuvjg/640?wx_fmt=png"></section><section><br></section><section><span>闲言少叙，下面就以具体的范例数据为例，介绍绘制互作条形图的方法。</span></section><section><br></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>#载入所需R包；</span><br mpa-from-tpl="t"><span>library</span>(ggplot2)<br mpa-from-tpl="t"><span>library</span>(tidyr)<br mpa-from-tpl="t"><span>library</span>(dplyr)</code></pre></section><p><br></p><p><br mpa-from-tpl="t"></p><section data-mpa-template="t" mpa-from-tpl="t"><section data-mpa-template="t" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><br mpa-from-tpl="t"></section></section><section data-mid="" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><p data-mid="">1.绘制第1个条形图</p></section></section></section></section></section></section></section></section><p><br></p><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>#读入数据；</span><br mpa-from-tpl="t"><span>hd1</span> &lt;- read.table(<span>"bar01.xls"</span>,header = T,sep = <span>"\t"</span>)<br mpa-from-tpl="t"><span>#预览数据；</span><br mpa-from-tpl="t"><span>head</span>(hd1,10)</code></pre></section><p><br></p><section><img data-ratio="0.5268571428571428" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6lks4dO0iavscowS8um9h5fh2n3rZHxgjIH0jeqP4ABPcornTLbr2PuqobxwcPe9oEamxqpOiaRTReg/640?wx_fmt=png" data-type="png" data-w="875" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6lks4dO0iavscowS8um9h5fh2n3rZHxgjIH0jeqP4ABPcornTLbr2PuqobxwcPe9oEamxqpOiaRTReg/640?wx_fmt=png"></section><section><br></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>#指定纵轴标签顺序,按照输入文件的顺序排序，否则默认按照首字母顺序；</span><br mpa-from-tpl="t"><span>hd1</span>$gene &lt;- factor(hd1$gene,levels = rev(unique(hd1$gene)),<br mpa-from-tpl="t">                   <span>ordered</span> = T)<br mpa-from-tpl="t"><span>#建立数据与图形（点）的映射关系，绘制对称条形图；</span><br mpa-from-tpl="t"><span>p1</span>&lt;-ggplot(hd1, aes(-expressions,gene))+<br mpa-from-tpl="t">  <span>geom_col</span>(fill=<span>"#c0e04c"</span>,width = 0.7)+<br mpa-from-tpl="t">  <span>labs</span>(x=<span>"Expressions"</span>,y=<span>""</span>)+<br mpa-from-tpl="t">  <span>scale_x_continuous</span>(position = <span>"bottom"</span>,<br mpa-from-tpl="t">                     <span>expand</span>=expansion(add = c(0.2,0.2)),<br mpa-from-tpl="t">                     <span>limits</span>=c(-15.1,0),<br mpa-from-tpl="t">                     <span>breaks</span> = c(-15,-10,-5, 0),<br mpa-from-tpl="t">                     <span>label</span> = c(<span>"15"</span>,<span>"10"</span>, <span>"5"</span>, <span>"0"</span>))+<br mpa-from-tpl="t">  <span>scale_y_discrete</span>(position = <span>"right"</span>)+<br mpa-from-tpl="t">  <span>theme</span>(panel.grid.minor.x = element_blank(),<br mpa-from-tpl="t">        <span>plot</span>.title = element_text(hjust = 0.5),<br mpa-from-tpl="t">        <span>axis</span>.title.x = element_text(size = 9),<br mpa-from-tpl="t">        <span>panel</span>.background = element_blank(),<br mpa-from-tpl="t">        <span>legend</span>.position = <span>"none"</span>)<br mpa-from-tpl="t"><span>p1</span></code></pre></section><p><br></p><section><img data-ratio="1.3550913838120104" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6lks4dO0iavscowS8um9h5fhuO7ZNTwA4ibr8oPlRqc78U29tVTAnbTTHjTRGicOznL9sFt5QHyEh04Q/640?wx_fmt=png" data-type="png" data-w="766" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6lks4dO0iavscowS8um9h5fhuO7ZNTwA4ibr8oPlRqc78U29tVTAnbTTHjTRGicOznL9sFt5QHyEh04Q/640?wx_fmt=png"></section><section><br></section><section data-mpa-template="t" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><br mpa-from-tpl="t"></section></section><section data-mid="" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><p data-mid="">2.绘制第2个条形图</p></section></section></section></section></section></section></section><section><span></span></section><section><br></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>#读入数据；</span><br mpa-from-tpl="t"><span>hd2</span> &lt;- read.table(<span>"bar02.xls"</span>,header = T,sep = <span>"\t"</span>)<br mpa-from-tpl="t"><span>#预览数据；</span><br mpa-from-tpl="t"><span>head</span>(hd2,10)</code></pre></section><p><br></p><section><img data-ratio="0.4766355140186916" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6lks4dO0iavscowS8um9h5fhWwvLnUzo2EeMePiae3BG7d0j1IZibP10icJw5KgOSjc5ta1jFxjjQ6Grw/640?wx_fmt=png" data-type="png" data-w="963" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6lks4dO0iavscowS8um9h5fhWwvLnUzo2EeMePiae3BG7d0j1IZibP10icJw5KgOSjc5ta1jFxjjQ6Grw/640?wx_fmt=png"></section><section><br></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>#指定纵轴标签顺序,按照输入文件的顺序排序，否则默认按照首字母顺序；</span><br mpa-from-tpl="t"><span>hd2</span>$gene &lt;- factor(hd2$gene,levels = rev(unique(hd2$gene)),<br mpa-from-tpl="t">                   <span>ordered</span> = T)<br mpa-from-tpl="t"><span>#建立数据与图形（点）的映射关系，绘制对称条形图；</span><br mpa-from-tpl="t"><span>p2</span>&lt;-ggplot(hd2, aes(expressions,gene))+<br mpa-from-tpl="t">  <span>geom_col</span>(fill=<span>"#FF99CC"</span>,width = 0.7)+<br mpa-from-tpl="t">  <span>labs</span>(x=<span>"Expressions"</span>,y=<span>""</span>)+<br mpa-from-tpl="t">  <span>scale_x_continuous</span>(position = <span>"bottom"</span>,<br mpa-from-tpl="t">                     <span>expand</span>=expansion(add = c(0.2,0.2)),<br mpa-from-tpl="t">                     <span>limits</span>=c(0,15.1),<br mpa-from-tpl="t">                     <span>breaks</span> = c(0,5,10, 15),<br mpa-from-tpl="t">                     <span>label</span> = c(<span>"0"</span>,<span>"5"</span>, <span>"10"</span>, <span>"15"</span>))+<br mpa-from-tpl="t">  <span>scale_y_discrete</span>(position = <span>"left"</span>)+<br mpa-from-tpl="t">  <span>theme</span>(panel.grid.minor.x = element_blank(),<br mpa-from-tpl="t">        <span>plot</span>.title = element_text(hjust = 0.5),<br mpa-from-tpl="t">        <span>axis</span>.title.x = element_text(size = 9),<br mpa-from-tpl="t">        <span>panel</span>.background = element_blank(),<br mpa-from-tpl="t">        <span>legend</span>.position = <span>"none"</span>)<br mpa-from-tpl="t"><span>p2</span></code></pre></section><p><br></p><section><img data-ratio="1.134054054054054" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6lks4dO0iavscowS8um9h5fhzKl1pxrNWQ4NyF4LLEGFDZoUWibKwjiaUdibia1RZb9IyDT28sI3Xfeq7A/640?wx_fmt=png" data-type="png" data-w="925" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6lks4dO0iavscowS8um9h5fhzKl1pxrNWQ4NyF4LLEGFDZoUWibKwjiaUdibia1RZb9IyDT28sI3Xfeq7A/640?wx_fmt=png"></section><section><br></section><section data-mpa-template="t" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><br mpa-from-tpl="t"></section></section><section data-mid="" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><p data-mid="">3.绘制连线图</p></section></section></section></section></section></section></section><section><span><br mpa-from-tpl="t"></span></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>#读入互作数据；</span><br mpa-from-tpl="t"><span>net</span> &lt;- read.csv(<span>"network.csv"</span>)<br mpa-from-tpl="t"><span>#预览数据；</span><br mpa-from-tpl="t"><span>head</span>(net,10)</code></pre></section><p><br></p><section><img data-ratio="0.46565656565656566" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6lks4dO0iavscowS8um9h5fhdRtlic9Y9kEggxyWe18L81VRCUpoXFMmiapic4OibpRAhiaqHlvJB2VQN2g/640?wx_fmt=png" data-type="png" data-w="990" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6lks4dO0iavscowS8um9h5fhdRtlic9Y9kEggxyWe18L81VRCUpoXFMmiapic4OibpRAhiaqHlvJB2VQN2g/640?wx_fmt=png"></section><section><br></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>#提取第1列纵坐标；</span><br mpa-from-tpl="t"><span>h1</span> &lt;- hd1$gene<br mpa-from-tpl="t"><span>sou</span> &lt;- net$source<br mpa-from-tpl="t"><span>y1</span> &lt;- NULL<br mpa-from-tpl="t"><span>for</span> (i in sou) {<br mpa-from-tpl="t">  <span>ys</span> &lt;- which(h1==i)<br mpa-from-tpl="t">  <span>y1</span> &lt;- c(y1,ys)<br mpa-from-tpl="t">}<br mpa-from-tpl="t"><span>net_y1</span> &lt;- length(h1)+1-y1<br mpa-from-tpl="t"><br mpa-from-tpl="t"><span>#提取第2列坐标；</span><br mpa-from-tpl="t"><span>h2</span> &lt;- hd2$gene<br mpa-from-tpl="t"><span>tar</span> &lt;- net$target<br mpa-from-tpl="t"><span>y2</span> &lt;- NULL<br mpa-from-tpl="t"><span>for</span> (i in tar) {<br mpa-from-tpl="t">  <span>yt</span> &lt;- which(h2==i)<br mpa-from-tpl="t">  <span>y2</span> &lt;- c(y2,yt)<br mpa-from-tpl="t">}<br mpa-from-tpl="t"><span>net_y2</span> &lt;- length(h2)+1-y2<br mpa-from-tpl="t"><br mpa-from-tpl="t"><span>#生成x轴坐标；</span><br mpa-from-tpl="t"><span>x1</span> &lt;- rep(2,length(tar))<br mpa-from-tpl="t"><span>x2</span> &lt;- rep(3,length(sou))<br mpa-from-tpl="t"><span>#生成坐标数据框；</span><br mpa-from-tpl="t"><span>df</span> &lt;- data.frame(sou,x1,net_y1,tar,x2,net_y2)<br mpa-from-tpl="t"><span>df</span></code></pre></section><p><br></p><section><img data-ratio="0.4557213930348259" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6lks4dO0iavscowS8um9h5fhlODT85ZXe7icWlwmvW5JMZTvCpjRGTnqW0IsNHtOyGxmXGBh7gEJWRQ/640?wx_fmt=png" data-type="png" data-w="1005" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6lks4dO0iavscowS8um9h5fhlODT85ZXe7icWlwmvW5JMZTvCpjRGTnqW0IsNHtOyGxmXGBh7gEJWRQ/640?wx_fmt=png"></section><section><br></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>#获取条形图1的基因数；</span><br mpa-from-tpl="t"><span>n</span>=length(hd1$gene)<br mpa-from-tpl="t"><span>#绘制连线图；</span><br mpa-from-tpl="t"><span>p_mid</span> &lt;- ggplot(df)+geom_segment(aes(x1,net_y1,xend=x2,yend=net_y2),<br mpa-from-tpl="t">                            <span>#linetype = "dashed",</span><br mpa-from-tpl="t">                            <span>size</span>=0.5,color=<span>"#FF99CC"</span>)+<br mpa-from-tpl="t">  <span>geom_point</span>(aes(x=x1,y=net_y1),size=3.5,<br mpa-from-tpl="t">             <span>fill</span>=<span>"#c0e04c"</span>,<br mpa-from-tpl="t">             <span>color</span>=<span>"tomato"</span>,<br mpa-from-tpl="t">             <span>stroke</span>=1,<br mpa-from-tpl="t">             <span>shape</span> = 21)+<br mpa-from-tpl="t">  <span>geom_point</span>(aes(x=x2,y=net_y2),size=3.5,<br mpa-from-tpl="t">             <span>fill</span>=<span>"#FF99CC"</span>,<br mpa-from-tpl="t">             <span>color</span>=<span>"tomato"</span>,<br mpa-from-tpl="t">             <span>stroke</span>=1,<br mpa-from-tpl="t">             <span>shape</span> = 21)+<br mpa-from-tpl="t">  <span>scale_y_continuous</span>(limits = c(1, n),expand = expansion(add=c(0.5,0.7)))+<br mpa-from-tpl="t">  <span>scale_x_continuous</span>(expand = expansion(0,0.1))+<br mpa-from-tpl="t">  <span>theme_void</span>()<br mpa-from-tpl="t"><span>p_mid</span></code></pre></section><p><br></p><section><img data-ratio="1.3858921161825726" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6lks4dO0iavscowS8um9h5fhSicqqm9YiaibXROW7ctWEck2BtR1tYt9ibtUXuzHQfxKwpNqCjOZLPQsgQ/640?wx_fmt=png" data-type="png" data-w="482" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6lks4dO0iavscowS8um9h5fhSicqqm9YiaibXROW7ctWEck2BtR1tYt9ibtUXuzHQfxKwpNqCjOZLPQsgQ/640?wx_fmt=png"></section><section><br></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>#水平拼图；</span><br mpa-from-tpl="t"><span>library</span>(patchwork)<br mpa-from-tpl="t"><span>p1</span>+p_mid+p2</code></pre></section><p><br></p><section><img data-ratio="0.6583333333333333" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6lks4dO0iavscowS8um9h5fh3vH2cnibAZQwV5W2ibElJGM9jLwtRJoKTop6U8CcSanD3DOx8ApzlIRQ/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6lks4dO0iavscowS8um9h5fh3vH2cnibAZQwV5W2ibElJGM9jLwtRJoKTop6U8CcSanD3DOx8ApzlIRQ/640?wx_fmt=png"></section><section><br></section><section><span>好啦，本次的绘图教程就分享到这里啦！</span></section><section><span><br></span></section><section><span><br></span></section><p><strong><span>*未经许可，不得以任何方式复制或抄袭本篇文章之部分或全部内容。版权所有，侵权必究。</span></strong></p><p><br></p><section data-role="outer" label="Powered by 135editor.com"><section data-tools="135编辑器" data-id="105648"><section><section data-role="outer" label="Powered by 135editor.com"><section data-role="paragraph"><section data-role="outer" label="Powered by 135editor.com"><section data-tools="135编辑器" data-id="105648"><section><section><img data-ratio="0.8780487804878049" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6kCKJYcEqEIfoJYG621mPJE8VibmibGU0Jxic9iabARVRH0FT6BNE8VAglWFXBPibFAU7a6tWGibSs8wyUg/640?wx_fmt=png" data-type="png" data-w="41" data-width="100%" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6kCKJYcEqEIfoJYG621mPJE8VibmibGU0Jxic9iabARVRH0FT6BNE8VAglWFXBPibFAU7a6tWGibSs8wyUg/640?wx_fmt=png"></section><section><section><section data-width="35%"><section><section data-width="100%"><img data-ratio="1" data-src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/tgUVxVRjT6kCKJYcEqEIfoJYG621mPJEv5etCBwHicqbEPwnVrkpaasxqaVibM4mT2JdIuN6yTlYWDD4mL5A427A/640?wx_fmt=jpeg" data-type="jpeg" data-w="860" data-width="100%" title="SCIPainter 30cm二维码.jpg" src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/tgUVxVRjT6kCKJYcEqEIfoJYG621mPJEv5etCBwHicqbEPwnVrkpaasxqaVibM4mT2JdIuN6yTlYWDD4mL5A427A/640?wx_fmt=jpeg"></section></section></section><section data-width="50%"><section><section data-brushtype="text"><span><strong># SCIPainter</strong></span></section><section data-brushtype="text" hm_fix="361:593"><p>基迪奥旗下绘图公众号</p><p>分享科研绘图技能与工具</p><p>欢迎关注与转发~</p></section></section></section></section></section></section></section></section></section></section><section><br></section></section></section><section data-role="paragraph"><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><img data-ratio="1" data-src="https://mmbiz.qpic.cn/sz_mmbiz_gif/tgUVxVRjT6kCKJYcEqEIfoJYG621mPJEgMd0aMPtmrDjiaX8sBhfhicVteeHf1JicexSpUbS3fdS9SiboUVN7guaPw/640?wx_fmt=gif" data-type="gif" data-w="400" src="https://mmbiz.qpic.cn/sz_mmbiz_gif/tgUVxVRjT6kCKJYcEqEIfoJYG621mPJEgMd0aMPtmrDjiaX8sBhfhicVteeHf1JicexSpUbS3fdS9SiboUVN7guaPw/640?wx_fmt=gif"></section></section></section><section><section powered-by="xiumi.us"><section><p><span><strong>你的好友拍了拍你</strong></span></p><p><span><strong>并请你帮她点一下</strong></span><strong><span>“分享”</span></strong><span><strong><span>~</span></strong></span></p></section></section></section></section></section><p><br></p></section></section><section><span><br></span></section><p><mp-style-type data-value="10000"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/4YZCqCRF21XepavYTNtbUg",target="_blank" rel="noopener noreferrer">原文链接</a>
