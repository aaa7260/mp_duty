---
title: "单细胞分析工具||COSG鉴定marker基因"
date: 2023-07-18T11:02:23Z
draft: ["false"]
tags: [
  "fetched",
  "单细胞天地"
]
categories: ["Acdemic"]
---
单细胞分析工具||COSG鉴定marker基因 by 单细胞天地
------
<div><section data-style-type="5" data-tools="新媒体排版" data-id="2430070"><section data-style-type="5" data-tools="新媒体排版" data-id="2390348"><section><section powered-by="xiumi.us"><section><section><section powered-by="xiumi.us"><section><section><br></section><section><section><section powered-by="xiumi.us"><section><section><p>分享是一种态度</p></section></section></section></section></section></section></section></section><section><section powered-by="xiumi.us"><section><section><img data-ratio="0.8738095238095238" data-src="https://mmbiz.qpic.cn/mmbiz_gif/siaia0BDGJdjSnnb9ibXpFagGPWQ0JjSSTNVBZthROEhicfINuLcxX2Ro3Zb600LJhrzeYIb120tLjSVXEtLn14DwA/640?wx_fmt=gif" data-type="gif" data-w="420" width="100%" src="https://mmbiz.qpic.cn/mmbiz_gif/siaia0BDGJdjSnnb9ibXpFagGPWQ0JjSSTNVBZthROEhicfINuLcxX2Ro3Zb600LJhrzeYIb120tLjSVXEtLn14DwA/640?wx_fmt=gif"></section></section></section></section></section></section></section></section></section><section><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><blockquote data-tool="mdnice编辑器"><p><span>COSG</span>(COSine similarity-based marker Gene identification)是由来自哈佛医学院和Broad研究所博后Ming Dai等人开发，旨在从余弦相似度的角度鉴定cluster的marker gene，于2021年12月被Briefings in Bioinformatics接收。目前已将此方法分别包装为R包与Python包，分别对应Seurat与Scanny分析流程。</p><ul><li><section><strong>Paper</strong>：https://doi.org/10.1093/bib/bbab579</section></li><li><section><strong>Github</strong>：https://github.com/genecell/COSG， https://github.com/genecell/COSGR</section></li></ul></blockquote><figure data-tool="mdnice编辑器"><img data-ratio="0.6940133037694013" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSJB5PfLhCC8iaiayVyzFOySIt6RAoeuEszia8axmapcY70PJnBMcL2ajzOQd7V5HOrOxbudMJICE9sg/640?wx_fmt=png" data-type="png" data-w="902" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSJB5PfLhCC8iaiayVyzFOySIt6RAoeuEszia8axmapcY70PJnBMcL2ajzOQd7V5HOrOxbudMJICE9sg/640?wx_fmt=png"></figure><h2 data-tool="mdnice编辑器"><span></span><span>1、分析思路</span></h2><ul data-tool="mdnice编辑器"><li><section>（1）准备好数据， 即标准化后的单细胞表达矩阵，并完成细胞聚类分析(scATAC， ST同理)；</section></li><li><section>（2）对cluster K模拟一个ideal marker  gene(仅在k表达，其余cluster不表达)；</section></li><li><section>（3）计算所有真实基因分别与该基因的余弦相似度，并进一步计算出COSG score；</section></li><li><section>（4）COSG score取值范围为0~1。<span>值越大，表示为cluster specific marker gene</span>；</section></li><li><section>（5）同理依次计算出其余cluster的marker gene。</section></li></ul><h2 data-tool="mdnice编辑器"><span></span><span>2、性能比较</span></h2><p data-tool="mdnice编辑器">文章主要与常用的Wilcoxon-test等分析方式在多种数据集上进行比较，概括如下：</p><p data-tool="mdnice编辑器">（1）在模拟的单细胞数据集中，COSG方法可以最大程度发现每个clutser的marker gene；</p><figure data-tool="mdnice编辑器"><img data-ratio="0.9745454545454545" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSJB5PfLhCC8iaiayVyzFOySIE2AEdfMKHGPXar79BiaQUYzfjOjKttjRkU6MlzDPkzI57HPAMWcDicHw/640?wx_fmt=png" data-type="png" data-w="550" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSJB5PfLhCC8iaiayVyzFOySIE2AEdfMKHGPXar79BiaQUYzfjOjKttjRkU6MlzDPkzI57HPAMWcDicHw/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">（2）在大规模单细胞数据中， COSG在保持精度的同时分析速度很快；</p><figure data-tool="mdnice编辑器"><img data-ratio="0.6636085626911316" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSJB5PfLhCC8iaiayVyzFOySIyJOS14iaMibpiajqOSvLaoQYLCaXIA7Cic8APJKW4DLHJYsSN2Tv0bI3jQ/640?wx_fmt=png" data-type="png" data-w="654" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSJB5PfLhCC8iaiayVyzFOySIyJOS14iaMibpiajqOSvLaoQYLCaXIA7Cic8APJKW4DLHJYsSN2Tv0bI3jQ/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">（3）COSG在scATAC以及空间转录组数据上也同样具有较优的表现</p><figure data-tool="mdnice编辑器"><img data-ratio="0.6115342763873776" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSJB5PfLhCC8iaiayVyzFOySI51cOuWbZrGm0YZIbCk9JJ6PInrjGLR47gDGR5UbeCtdEESAAtiaia1XA/640?wx_fmt=png" data-type="png" data-w="919" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSJB5PfLhCC8iaiayVyzFOySI51cOuWbZrGm0YZIbCk9JJ6PInrjGLR47gDGR5UbeCtdEESAAtiaia1XA/640?wx_fmt=png"></figure><h2 data-tool="mdnice编辑器"><span></span><span>3、代码实操</span></h2><pre data-tool="mdnice编辑器"><span></span><code>remotes::install_github(repo = <span>'genecell/COSGR'</span>)<br><br><span>library</span>(COSG)<br><span>library</span>(Seurat)<br><br><span>## 输入数据</span><br>data(<span>'pbmc_small'</span>,package=<span>'COSG'</span>)<br><br>dim(pbmc_small@assays$RNA@data)  <span>#标准化矩阵</span><br><span># [1] 230  80</span><br><br>table(Idents(pbmc_small)) <span>#聚类分群结果</span><br><span># 0  1  2 </span><br><span># 36 25 19 </span><br></code></pre><ul data-tool="mdnice编辑器"><li><section>R包的分析函数即为<code>cosg()</code>，默认参数如下</section></li></ul><pre data-tool="mdnice编辑器"><span></span><code>marker_cosg &lt;- cosg(<br>  pbmc_small,<br>  groups=<span>'all'</span>, <span>#考虑全部分组</span><br>  assay=<span>'RNA'</span>,<br>  slot=<span>'data'</span>,<br>  mu=<span>1</span>,         <span>#惩罚项参数，值越大</span><br>  remove_lowly_expressed=<span>TRUE</span>,   <span>#是否过滤低表达基因</span><br>  expressed_pct=<span>0.1</span>,             <span>#设置低表达的阈值</span><br>  n_genes_user=<span>100</span>      <span>#每个cluster定义Top-N个marker gene</span><br>)<br><br>head(marker_cosg$names,<span>3</span>)<br><span>#      0      1     2</span><br><span># 1  CD7 S100A8 MS4A1</span><br><span># 2 CCL5   TYMP CD79A</span><br><span># 3 GNLY S100A9 TCL1A</span><br>head(marker_cosg$scores,<span>3</span>)<br><span>#           0         1         2</span><br><span># 1 0.6391917 0.8954042 0.6922908</span><br><span># 2 0.6391267 0.8312083 0.5832425</span><br><span># 3 0.6328148 0.8120045 0.5757478</span><br></code></pre><ul data-tool="mdnice编辑器"><li><section>简单可视化一下</section></li></ul><pre data-tool="mdnice编辑器"><span></span><code>top_list&lt;-c()<br><span>for</span> (group <span>in</span> colnames(marker_cosg$names)){<br>  top_i&lt;-marker_cosg$names[group][<span>1</span>:<span>5</span>,<span>1</span>]<br>  top_list&lt;-c(top_list,top_i)<br>}<br><br>DotPlot(pbmc_small, <br>        assay = <span>'RNA'</span>,<br>        <span># scale=TRUE,</span><br>        features =  unique(top_list)) + RotatedAxis()<br><br>pbmc_small &lt;- ScaleData(pbmc_small, features = top_list)<br>DoHeatmap(pbmc_small, <br>          assay = <span>'RNA'</span>,<br>          features =  top_list) <br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.7310549777117384" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSJB5PfLhCC8iaiayVyzFOySIgPoyUg1aWu2qPibpQrb5jV35YMXKLKHVMaUTS2eTmpZ4VkiatiaYYwMXw/640?wx_fmt=png" data-type="png" data-w="673" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSJB5PfLhCC8iaiayVyzFOySIgPoyUg1aWu2qPibpQrb5jV35YMXKLKHVMaUTS2eTmpZ4VkiatiaYYwMXw/640?wx_fmt=png"></figure><figure data-tool="mdnice编辑器"><img data-ratio="0.6927803379416283" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSJB5PfLhCC8iaiayVyzFOySIskQRllM22QWzfrc4YLNIzVuIITPrC2PuDxnMzMcicgNBGoM13rexvSA/640?wx_fmt=png" data-type="png" data-w="651" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSJB5PfLhCC8iaiayVyzFOySIskQRllM22QWzfrc4YLNIzVuIITPrC2PuDxnMzMcicgNBGoM13rexvSA/640?wx_fmt=png"></figure></section><p><br></p><p><br></p><section data-style-type="5" data-tools="新媒体排版" data-id="2440476"><section><section><section><section><img data-ratio="0.9495798319327731" data-src="https://mmbiz.qpic.cn/mmbiz_gif/09gp6SvPE04j3m2v7Hr889icHUyibTOHs8YuUibicl7ibRD0ZwG5pDTjBluRreZvuib1o3BibvLkicYhnA4YW7dQsjn0cA/640?wx_fmt=gif" data-type="gif" data-w="119" data-width="100%" src="https://mmbiz.qpic.cn/mmbiz_gif/09gp6SvPE04j3m2v7Hr889icHUyibTOHs8YuUibicl7ibRD0ZwG5pDTjBluRreZvuib1o3BibvLkicYhnA4YW7dQsjn0cA/640?wx_fmt=gif"></section><section data-brushtype="text">往期回顾</section><section><br></section></section></section></section><section><section data-autoskip="1"><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247514120&amp;idx=1&amp;sn=c8892e9fcb5b3b07807a34ce9a69140a&amp;chksm=ea1cbe8add6b379cdd5555bdc4165f4ede4a915a24f7d34463c7f37df18cce27f44a09e79e79&amp;scene=21#wechat_redirect" textvalue="今年暑假一起学单细胞吧（附上游数据下载tips）" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2"><span>今年暑假一起学单细胞吧（附上游数据下载tips）</span></a><br></p><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247514069&amp;idx=2&amp;sn=4143cc016dc43bc6915a9c48b12e4834&amp;chksm=ea1cb157dd6b384117754cb142a3e5ea44978d07fd1c77b524d4fdd8b031beeb99145274a440&amp;scene=21#wechat_redirect" textvalue="病毒感染相关单细胞文献复现-2" linktype="text" imgurl="" imgdata="null" data-itemshowtype="11" tab="innerlink" data-linktype="2"><span>病毒感染相关单细胞文献复现-2</span></a><br></p><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247514065&amp;idx=1&amp;sn=35d91b3848f7730df50ed29c2b3bc25c&amp;chksm=ea1cb153dd6b38457e9135821478101023f55280948f4347d285545c919e62be8461759aa3e4&amp;scene=21#wechat_redirect" textvalue="842个单细胞数据集，超5000万个单细胞的数量" linktype="text" imgurl="" imgdata="null" data-itemshowtype="8" tab="innerlink" data-linktype="2"><span>842个单细胞数据集，超5000万个单细胞的数量</span></a><br></p><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247514057&amp;idx=1&amp;sn=6bf080b690315e5f809cc5a4ff0485c4&amp;chksm=ea1cb14bdd6b385d6b78c7775bafecde5c2b670ec0b8ee6f6a0b8d3064cedf243fd00ac73faa&amp;scene=21#wechat_redirect" textvalue="这近100种单细胞亚群的2348个标记基因好用吗" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2"><span>这近100种单细胞亚群的2348个标记基因好用吗</span></a><br></p><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247514049&amp;idx=1&amp;sn=cfbc99e27c70455d52b89f4af4ca07b3&amp;chksm=ea1cb143dd6b385566a145228f6acec1a8d10a4b26552ec84e578ac76216707f818b7442b153&amp;scene=21#wechat_redirect" textvalue="百创智造发布百创S系列空间单细胞分割技术Demo数据" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2"><span>百创智造发布百创S系列空间单细胞分割技术Demo数据</span></a><br></p></section></section><hr><p><br></p></section><section data-style-type="5" data-tools="新媒体排版" data-id="2440475"><hr><p><br></p><hr><section><p>如果你对单细胞转录组研究感兴趣，但又不知道如何入门，也许你可以关注一下下面的课程<span></span></p><p><br></p><ul><li><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247522996&amp;idx=1&amp;sn=83c6cfa48a2dce7d54b7eb11f13a0d85&amp;chksm=9b4bda0fac3c5319e0800cb3452480080e58315bafc035d8150d7cdfe4c062fbca34ec5c18e1&amp;scene=21#wechat_redirect" textvalue="生信入门&amp;数据挖掘线上直播课7月班" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1">生信入门&amp;数据挖掘线上直播课7月班</a></p></li><li><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247519765&amp;idx=2&amp;sn=6cb33654c7751f4c3df0f84743f77aaf&amp;chksm=9b4bceaeac3c47b8899afc00077b96357b87a4ed6b75e7c434ba14071fd6c8448e4c218de5e0&amp;scene=21#wechat_redirect" textvalue="144线程640Gb内存服务器共享一年仍然是仅需800" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1">144线程640Gb内存服务器共享一年仍然是仅需800</a></p></li><li><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247519765&amp;idx=1&amp;sn=ce5a8c8182f854c88043059f8c2cb9ff&amp;chksm=9b4bceaeac3c47b88c19941d43dbb1401f3a92206481a0afc41159927868199643f795d62a7e&amp;scene=21#wechat_redirect" textvalue="千呼万唤始出来的独享生物信息学云服务器" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1">千呼万唤始出来的独享生物信息学云服务器</a></p></li></ul><p><img data-ratio="1" data-src="https://mmbiz.qpic.cn/mmbiz_gif/4TKeL1ZejtlKxOib5kmKX6ic6eX0w0WK5jvhtz9yBRsO3OI4yr6S5iaLNM7AbAeuPDHXMvDdur2DRz9wyiax4lEviag/640?wx_fmt=gif" data-type="gif" data-w="240" src="https://mmbiz.qpic.cn/mmbiz_gif/4TKeL1ZejtlKxOib5kmKX6ic6eX0w0WK5jvhtz9yBRsO3OI4yr6S5iaLNM7AbAeuPDHXMvDdur2DRz9wyiax4lEviag/640?wx_fmt=gif"><br></p><p><img data-ratio="0.05278592375366569" data-src="https://mmbiz.qpic.cn/mmbiz/4TKeL1Zejtlq03ZOSZiaTlic1MxgdKiaxTbOZ7ZSe0Xx1Ca8xF3L6Nyj1FYUajtYrSmRIHyZVSsAve0EAvEicZONpg/640?wx_fmt=jpeg" data-type="other" data-w="341" src="https://mmbiz.qpic.cn/mmbiz/4TKeL1Zejtlq03ZOSZiaTlic1MxgdKiaxTbOZ7ZSe0Xx1Ca8xF3L6Nyj1FYUajtYrSmRIHyZVSsAve0EAvEicZONpg/640?wx_fmt=jpeg"></p><p><strong><span>看完记得顺手点个</span></strong><span><strong><span>“在看”</span></strong></span><strong><span>哦！</span></strong></p></section><section><section data-id="93668"><section><section data-width="95%"><section><section><section data-width="38%"><section><section data-tools="135编辑器" data-id="93668"><section><section data-width="95%"><section><section><section data-width="61.8%"><section><section><section><p><br></p><span><strong data-burshtype="text"><img data-copyright="0" data-cropselx1="0" data-cropselx2="109" data-cropsely1="0" data-cropsely2="109" data-ratio="1" data-src="https://mmbiz.qpic.cn/mmbiz/siaia0BDGJdjRMGrkqo64BGKecYk4akuHpGHVQs7FeOpY7eWbIPGC1tRw5Tw0oEPmx053mR9FTVerWvhuZchIpZw/640?wx_fmt=jpeg" data-type="other" data-w="258" title="qrcode_for_gh_5a3c482ed99f_1280.jpg" src="https://mmbiz.qpic.cn/mmbiz/siaia0BDGJdjRMGrkqo64BGKecYk4akuHpGHVQs7FeOpY7eWbIPGC1tRw5Tw0oEPmx053mR9FTVerWvhuZchIpZw/640?wx_fmt=jpeg"><strong data-burshtype="text">生物</strong><strong data-burshtype="text"> | 单细胞 | 转录组丨资料</strong></strong></span></section><section><span><strong data-burshtype="text">每天都精彩</strong></span></section></section></section><section><section><section><section><section><section><p><span>长按扫码可关注</span></p></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/x0zk66873PQ3O1MYNXc0oA",target="_blank" rel="noopener noreferrer">原文链接</a>
