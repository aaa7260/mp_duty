---
title: "R语言机器学习系列|使用Mfuzz包进行基因表达时间趋势分析并聚类分群"
date: 2023-07-09T10:40:52Z
draft: ["false"]
tags: [
  "fetched",
  "科研生信充电宝"
]
categories: ["Acdemic"]
---
R语言机器学习系列|使用Mfuzz包进行基因表达时间趋势分析并聚类分群 by 科研生信充电宝
------
<div><section><section powered-by="xiumi.us"><section><p><strong>R语言机器学习系列</strong></p></section></section><section powered-by="xiumi.us"><section><p>R</p></section></section><section powered-by="xiumi.us"><section><p><strong>使用Mfuzz包进行基因表达时间趋势分析并聚类分群</strong><br></p></section></section><section powered-by="xiumi.us"><p>- 07·09-</p></section><section powered-by="xiumi.us"><section><p>宜分享</p></section></section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><p><strong>使用Mfuzz包进行基因表达时间趋势分析并聚类分群</strong></p></section></section></section><section powered-by="xiumi.us"><section><p><span>Brief Introduction</span><br></p></section></section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><p><strong>01</strong></p></section></section></section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><p><strong>Mfuzz包简介：</strong></p></section></section></section></section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><img data-ratio="1" data-s="300,640" data-w="400" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/hN03ibG0t2HvAHVSfwTgY1USlhctfiaICic2iaMluCNHU2qDogB2oCFpGVGgM5WRcn3XLzibSUiayaPiczicJJAxJtvvWw/640?wx_fmt=jpeg" width="100%" src="https://mmbiz.qpic.cn/mmbiz_jpg/hN03ibG0t2HvAHVSfwTgY1USlhctfiaICic2iaMluCNHU2qDogB2oCFpGVGgM5WRcn3XLzibSUiayaPiczicJJAxJtvvWw/640?wx_fmt=jpeg"></section></section></section><section><section powered-by="xiumi.us"><section><svg viewbox="0 0 1 1"></svg></section></section></section><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><p><strong>什么是Mfuzz包？</strong></p></section></section></section></section></section><section powered-by="xiumi.us"><section><section><section powered-by="xiumi.us"><section><section><img data-ratio="1" data-s="300,640" data-w="270" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/hN03ibG0t2HvAHVSfwTgY1USlhctfiaICicCj0dVWsjvlvwDicW1Y60cib3ibf1C80wdfTGk2oD7l4WtLVJGZjR2qHvQ/640?wx_fmt=jpeg" width="100%" src="https://mmbiz.qpic.cn/mmbiz_jpg/hN03ibG0t2HvAHVSfwTgY1USlhctfiaICicCj0dVWsjvlvwDicW1Y60cib3ibf1C80wdfTGk2oD7l4WtLVJGZjR2qHvQ/640?wx_fmt=jpeg"></section></section></section></section><section><section powered-by="xiumi.us"><section><svg viewbox="0 0 1 1"></svg></section></section></section><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><section><p><strong>Mfuzz包是一个用于模糊聚</strong><strong>类（Fuzzy clustering）的R包，它提供了一套强大的工具，用于对基因表达数据进行聚类分析。模糊</strong>聚类是一种聚类方法，它允许样本在不同聚类簇之间具有模糊的隶属度，而不是严格地分配到一个确定的聚类簇中。</p></section></section></section></section></section></section></section></section><section powered-by="xiumi.us"><p><strong>Mfuzz包的主要功能包括以下几个方面：</strong></p><ol><li><p><strong>模糊C均值聚类算法（Fuzzy c-means clustering）：</strong>Mfuzz包实现了模糊C均值聚类算法，它是一种常用的模糊聚类算法。该算法通过最小化样本与聚类中心之间的距离，将样本分配到不同聚类簇中。在模糊C均值聚类中，每个样本可以属于多个聚类簇，而不是严格地属于一个特定的聚类簇。</p></li><li><p><strong>模糊聚类评估：</strong>Mfuzz包提供了一些方法来评估模糊聚类的质量。例如，可以使用模糊聚类分配矩阵（Fuzzy clustering allocation matrix）来度量样本在不同聚类簇之间的隶属度。此外，还可以计算模糊分割矩阵（Fuzzy partition matrix）和模糊鸢尾图（Fuzzy silhouette plot）来评估聚类的紧密性和分离性。</p></li><li><p><strong>可视化工具：</strong>Mfuzz包提供了一些可视化工具，用于直观地展示模糊聚类的结果。例如，可以绘制模糊聚类图形（Fuzzy clustering plots）来可视化聚类簇之间的相似性和差异性。还可以绘制基因的模糊聚类图（Fuzzy clustering heatmaps）来展示基因表达模式。</p></li></ol><p>模糊聚类在基因表达数据分析中具有广泛的应用。它可以帮助我们发现基因表达的模式和结构，识别不同条件下的表达模式相似的基因群，以及探索样本之间的相似性和差异性。</p><p><br></p><p><strong>您可以根据Mfuzz包的官方文档：</strong></p><p>https://www.bioconductor.org/packages/release/bioc/html/Mfuzz.html</p><p>和官方网站：</p><p>http://mfuzz.sysbiolab.eu</p><p>进一步了解Mfuzz包的功能和用法。这些资源将提供更详细的信息，包括函数的参数和用法示例。</p><p><br></p></section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><p><strong>02</strong></p></section></section></section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><p><strong>模糊C均值聚类算法简介：</strong></p></section></section></section></section><section powered-by="xiumi.us"><p><strong>模糊C均值聚类算法（Fuzzy c-means clustering）是一种常用的模糊聚类算法，用于将样本分配到不同聚类簇中。</strong>与传统的硬聚类方法（如k-means聚类）不同，模糊C均值聚类允许样本具有模糊的隶属度，即一个样本可以属于多个聚类簇，而不是严格地属于一个特定的聚类簇。<br></p><p><br></p><p><strong>模糊C均值聚类算法的原理如下：</strong></p><ol><li><p><strong>初始化：</strong>随机选择聚类中心（也称为原型向量）和一个模糊性指数（m）。</p></li><li><p><strong>计算样本的隶属度：</strong>对于每个样本，计算它对于每个聚类中心的隶属度。隶属度表示样本属于每个聚类的程度，通常使用模糊隶属度矩阵（fuzzy membership matrix）来表示。</p></li><li><p><strong>更新聚类中心：</strong>根据样本的隶属度，更新每个聚类中心的值，以使其更好地代表属于该聚类的样本。</p></li><li><p><strong>重复步骤2和步骤3</strong>，直到满足停止准则（例如最大迭代次数或聚类中心的变化小于某个阈值）。</p></li></ol><p><strong>在模糊C均值聚类中，模糊性指数（m）是一个控制模糊程度的参数，通常取大于1的值。</strong>较大的m值会导致更模糊的隶属度分配，即样本可以在多个聚类中心之间具有较高的隶属度。</p><p><br></p><p><strong>模糊C均值聚类算法的优势包括：</strong></p><ol><li><p><strong>模糊隶属度：</strong>与硬聚类方法相比，模糊C均值聚类可以提供样本属于不同聚类的程度，而不是仅仅给出样本所属的唯一聚类。</p></li><li><p><strong>对噪声和异常值的鲁棒性：</strong>由于模糊隶属度的存在，模糊C均值聚类对于噪声和异常值相对较为鲁棒，能够更好地处理这些数据的影响。</p></li><li><p><strong>适用于数据不确定性建模：</strong>模糊C均值聚类适用于需要考虑数据不确定性的情况，能够更好地反映数据的模糊性和多样性。</p></li><li><p><strong>软划分结果的解释性：</strong>模糊C均值聚类可以提供对样本所属聚类的模糊程度的信息，使结果更具解释性和可解释性。</p></li></ol><p>然而，模糊C均值聚类也存在一些挑战和限制，包括对初始聚类中心的敏感性、计算复杂度较高以及难以处理大规模数据集等。</p><p>总而言之，模糊C均值聚类是一种强大的聚类方法，可以用于处理样本属于多个聚类的情况，提供更多样化和模糊化的聚类结果。它在基因表达数据分析和其他领域中都具有广泛的应用。</p><p><br></p></section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><p><strong>03</strong></p></section></section></section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><p><strong>在聚类基因或蛋白时为什么使用Mfuzz：</strong></p></section></section></section></section><section powered-by="xiumi.us"><p>聚类是基因表达数据分析的重要工具，无论是在转录物水平还是在蛋白质水平。</p><p><br></p><p><strong>无监督分类通常可以揭示隐藏在基因表达数据集中的结构。</strong>目前应用的绝大多数聚类算法，使用的是<strong>硬聚类(hard partition)</strong>，即每个基因或蛋白质被精确地分配到一个聚类。对于可以区分开的数据，硬聚类是合适的。然而，这通常不适应于基因表达数据的情况，其中基因/蛋白质簇经常重叠。此外，硬聚类通常对噪声高度敏感。</p><p><br></p><p><strong>软聚类（soft partition）的优势：</strong></p><ol><li><p>它生成可访问的内部簇结构，即它表明相应的簇如何很好地代表基因/蛋白质。这些附加信息可用于搜索调控元件；<br></p></li><li><p>其次，可以定义cluster之间的整体关系，以及一个全局集群结构；<br></p></li><li><p>此外，软聚类具有更强的噪声鲁棒性，可以避免基因的预过滤。这可以防止从数据分析中排除生物学相关基因/蛋白质；<br></p></li></ol><p><br></p></section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><p><strong>04</strong></p></section></section></section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><p><strong>R实例：使用Mfuzz包进行基因表达</strong></p><p><strong>时间趋势分析并聚类分群</strong></p></section></section></section></section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><svg viewbox="0 0 1 1"></svg></section></section></section><section><section powered-by="xiumi.us"><section><p><strong>① 加载和安装包：</strong></p></section></section><section powered-by="xiumi.us"><section><svg viewbox="0 0 1 1"></svg></section></section></section></section><p powered-by="xiumi.us">现在，我们想要安装Mfuzz包：</p><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="python"><code><span><span># 清除变量</span></span></code><code><span>rm(<span>list</span> = ls())</span></code><code><span><span># 设置路径</span></span></code><code><span>setwd(<span>"D:\\2023_07_09_原创_使用Mfuzz包进行基因表达时间趋势分析并聚类分群"</span>)</span></code><code><span><span># 得到当前路径</span></span></code><code><span>getwd()</span></code><code><span><br></span></code><code><span><span># 安装Mfuzz包</span></span></code><code><span><span>if</span> (!requireNamespace(<span>"BiocManager"</span>, quietly = TRUE))</span></code><code><span>  install.packages(<span>"BiocManager"</span>)</span></code><code><span><br></span></code><code><span>BiocManager::install(<span>"Mfuzz"</span>)</span></code><code><span><span># 加载数据包</span></span></code><code><span>library(Mfuzz)</span></code></pre></section><p powered-by="xiumi.us"><br></p><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><svg viewbox="0 0 1 1"></svg></section></section></section><section><section powered-by="xiumi.us"><section><p><strong>② 导入基因在不同时间的表达量数据集：</strong></p></section></section><section powered-by="xiumi.us"><section><svg viewbox="0 0 1 1"></svg></section></section></section></section><p powered-by="xiumi.us">接下来，我们将使用一个示例数据集进行模糊聚类分析。</p><section><ul><li><li><li><li><li><li></ul><pre data-lang="python"><code><span><span># 导入xlsx格式数据</span></span></code><code><span>library(readxl)</span></code><code><span><span># 读取xlsx格式文件</span></span></code><code><span>data &lt;- read_excel(<span>"D:\\2023_07_09_原创_使用Mfuzz包进行基因表达时间趋势分析并聚类分群\\gene_expression.xlsx"</span>, sheet = <span>1</span>)</span></code><code><span><span># 查看数据前5行</span></span></code><code><span>head(data)</span></code></pre></section><section powered-by="xiumi.us"><section><img data-ratio="0.4152542372881356" data-s="300,640" data-w="590" data-src="https://mmbiz.qpic.cn/mmbiz_png/hN03ibG0t2HvAHVSfwTgY1USlhctfiaICicqQys9xxHibVke0p4ygSR35OgqDyQGDyfuIQgJDPBN45kiaCjj1G3QwwQ/640?wx_fmt=png" width="100%" src="https://mmbiz.qpic.cn/mmbiz_png/hN03ibG0t2HvAHVSfwTgY1USlhctfiaICicqQys9xxHibVke0p4ygSR35OgqDyQGDyfuIQgJDPBN45kiaCjj1G3QwwQ/640?wx_fmt=png"></section></section><section powered-by="xiumi.us"><p>可以看到我们的数据集是不同基因在Day1、Day15、Day30、Day45、Day60、Day75的表达量。</p><p><strong>注意：</strong>在导入数据时，应按照这样的结构导入数据，如果每一个样本有多个重复，请先计算平均值后再导入。</p><p>接下来，我们美化表格显示数据：</p></section><section><ul><li><li><li><li><li><li><li></ul><pre data-lang="python"><code><span><span># 加载显示表格的包</span></span></code><code><span>library(tidyverse)</span></code><code><span>library(broom)</span></code><code><span>library(broom.mixed)</span></code><code><span>library(gt)</span></code><code><span><span># 美化输出信息</span></span></code><code><span>head(data) %&gt;% gt() %&gt;% fmt_auto()</span></code></pre></section><section powered-by="xiumi.us"><section><img data-ratio="0.6138328530259366" data-s="300,640" data-w="694" data-src="https://mmbiz.qpic.cn/mmbiz_png/hN03ibG0t2HvAHVSfwTgY1USlhctfiaICic8d3wPwRpCjcpgHaZfiadlwEdpeeicC7Vys2XhS8D8aSfiatNGADIgMIxg/640?wx_fmt=png" width="100%" src="https://mmbiz.qpic.cn/mmbiz_png/hN03ibG0t2HvAHVSfwTgY1USlhctfiaICic8d3wPwRpCjcpgHaZfiadlwEdpeeicC7Vys2XhS8D8aSfiatNGADIgMIxg/640?wx_fmt=png"></section></section><p powered-by="xiumi.us"><br></p><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><svg viewbox="0 0 1 1"></svg></section></section></section><section><section powered-by="xiumi.us"><section><p><strong>③ 数据格式转换：</strong></p></section></section><section powered-by="xiumi.us"><section><svg viewbox="0 0 1 1"></svg></section></section></section></section><p powered-by="xiumi.us">接下来，我们将data转为matrix格式，并且基因名作为行名：</p><section><ul><li><li><li><li><li><li><li></ul><pre data-lang="python"><code><span><span># 将第一列作为行名</span></span></code><code><span>data &lt;- <span>as</span>.data.frame(data, stringsAsFactors = FALSE) <span># 将数据转换为数据框对象</span></span></code><code><span>rownames(data)&lt;-data[,<span>1</span>] <span>#将数据框的第一列作为行名</span></span></code><code><span>data&lt;-data[,-<span>1</span>] <span>#将数据框的第一列删除，只留下剩余的列作为数据</span></span></code><code><span>head(data) </span></code><code><span><span># 将data转为matrix</span></span></code><code><span>data &lt;- <span>as</span>.matrix(data)</span></code></pre></section><p powered-by="xiumi.us"><br></p><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><svg viewbox="0 0 1 1"></svg></section></section></section><section><section powered-by="xiumi.us"><section><p><strong>④ 构建Mfuzz对象并进行预处理：</strong></p></section></section><section powered-by="xiumi.us"><section><svg viewbox="0 0 1 1"></svg></section></section></section></section><p powered-by="xiumi.us">接下来，我们将构建Mfuzz对象，并处理缺失值或者异常值，最后再标准化数据。</p><section><ul><li><li><li><li><li><li><li><li></ul><pre data-lang="python"><code><span><span>#构建Mfuzz对象</span></span></code><code><span>mfuzz_class &lt;- new(<span>'ExpressionSet'</span>,exprs = data)</span></code><code><span><br></span></code><code><span><span>#预处理缺失值或者异常值</span></span></code><code><span>mfuzz_class &lt;- <span>filter</span>.NA(mfuzz_class, thres = <span>0.25</span>)</span></code><code><span>mfuzz_class &lt;- fill.NA(mfuzz_class, mode = <span>'mean'</span>)</span></code><code><span><span># 基因过滤</span></span></code><code><span>mfuzz_class &lt;- <span>filter</span>.std(mfuzz_class, <span>min</span>.std = <span>0</span>)</span></code></pre></section><section powered-by="xiumi.us"><section><img data-ratio="0.7760097919216646" data-s="300,640" data-w="817" data-src="https://mmbiz.qpic.cn/mmbiz_png/hN03ibG0t2HvAHVSfwTgY1USlhctfiaICicziaicXAjYpQfYSYfcLbLh5ovhbb0cWqgwWHNgYaaxSbb1DibFeEDc1VrA/640?wx_fmt=png" width="100%" src="https://mmbiz.qpic.cn/mmbiz_png/hN03ibG0t2HvAHVSfwTgY1USlhctfiaICicziaicXAjYpQfYSYfcLbLh5ovhbb0cWqgwWHNgYaaxSbb1DibFeEDc1VrA/640?wx_fmt=png"></section></section><p powered-by="xiumi.us">过滤阈值是指定的，目前没有严格的过滤程序存在，因此我们避免了对基因数据进行任何先前的过滤。这可以防止可能具有生物学重要性的基因丢失。</p><section><ul><li><li></ul><pre data-lang="python"><code><span><span>#标准化数据</span></span></code><code><span>mfuzz_class &lt;- standardise(mfuzz_class)</span></code></pre></section><p powered-by="xiumi.us"><br></p><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><svg viewbox="0 0 1 1"></svg></section></section></section><section><section powered-by="xiumi.us"><section><p><strong>⑤ 使用Mfuzz进行聚类：</strong></p></section></section><section powered-by="xiumi.us"><section><svg viewbox="0 0 1 1"></svg></section></section></section></section><p powered-by="xiumi.us">接下来，我们将使用一个示例数据集进行模糊聚类分析。</p><section><ul><li><li><li><li><li><li><li></ul><pre data-lang="python"><code><span><span># Mfuzz 基于 fuzzy c-means 的算法进行聚类</span></span></code><code><span><span>#需手动定义目标聚类群的个数，例如这里我们设定为 10，即期望获得 10 组聚类群</span></span></code><code><span><span>#需要设定随机数种子，以避免再次运行时获得不同的结果</span></span></code><code><span><span>set</span>.seed(<span>123</span>)</span></code><code><span>cluster_num &lt;- <span>10</span></span></code><code><span><span># 将使用mfuzz包中的mfuzz函数进行模糊聚类</span></span></code><code><span>mfuzz_cluster &lt;- mfuzz(mfuzz_class, c = cluster_num, m = mestimate(mfuzz_class))</span></code></pre></section><section powered-by="xiumi.us"><p><strong>注意：</strong><span><strong>对于模糊c均值聚类，需要事先选择m和聚类个数c。</strong></span></p><p><br></p></section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><svg viewbox="0 0 1 1"></svg></section></section></section><section><section powered-by="xiumi.us"><section><p><strong>⑥ 聚类结果可视化：</strong></p></section></section><section powered-by="xiumi.us"><section><svg viewbox="0 0 1 1"></svg></section></section></section></section><p powered-by="xiumi.us">接下来，我们对聚类结果进行可视化展示。</p><section><ul><li><li><li><li></ul><pre data-lang="python"><code><span><span># Mfuzz聚类可视化作图</span></span></code><code><span><span>#time.labels 参数设置时间轴，需要和原基因表达数据集中的列对应</span></span></code><code><span><span>#颜色、线宽、坐标轴、字体等细节也可以添加其他参数调整，此处略，详见函数帮助</span></span></code><code><span>mfuzz.plot2(mfuzz_class, cl = mfuzz_cluster, mfrow = c(<span>2</span>, <span>5</span>), time.labels = colnames(data))</span></code></pre></section><section powered-by="xiumi.us"><section><img data-ratio="0.4074074074074074" data-s="300,640" data-w="1080" data-src="https://mmbiz.qpic.cn/mmbiz_png/hN03ibG0t2HvAHVSfwTgY1USlhctfiaICicoU0zVhnPRsAuoGDa2N4KML1l2XfZSNJyiaOu2geHcAwgolHNPnEtjuw/640?wx_fmt=png" width="100%" src="https://mmbiz.qpic.cn/mmbiz_png/hN03ibG0t2HvAHVSfwTgY1USlhctfiaICicoU0zVhnPRsAuoGDa2N4KML1l2XfZSNJyiaOu2geHcAwgolHNPnEtjuw/640?wx_fmt=png"></section></section><section powered-by="xiumi.us"><p><strong>注意：</strong>聚类通常用于揭示基因表达的调控机制。众所周知，基因的调节通常不是以on-off的方式进行的，而是以循序渐进的方式进行的，这使得更好控制基因的功能。聚类算法应该能区分基因与主要聚类模式的紧密程度。</p><p><strong>软聚类（soft cluster）</strong>是这个目的的一个很好的候选方法，因为它可以将基因i 在聚类j中分配一个 <strong><span>membership μij</span></strong>。<strong>membership的值可以在0到1之间连续变化。这个特性使得soft cluster能够提供更多关于基因表达数据结构的信息。</strong></p><p>对于软聚类（soft cluster），聚类中心Cj是所有聚类成员的加权的结果，显示了聚类的整体表达模式。<strong>隶属度μij表示聚类cj对基因i的代表程度。μij值较低表明cj对基因i的表达较差。μij值较大，说明基因i的表达与簇质心cj高度相关。</strong><span><strong>membership μij在mfuzzy .plot生成的图中以颜色编码。这有助于识别基因簇中的时间模式。</strong></span><br></p><p><br></p></section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><svg viewbox="0 0 1 1"></svg></section></section></section><section><section powered-by="xiumi.us"><section><p><strong>⑦ 聚类结果提取：</strong></p></section></section><section powered-by="xiumi.us"><section><svg viewbox="0 0 1 1"></svg></section></section></section></section><section powered-by="xiumi.us"><p>接下来继续在上述已获得的聚类结果中，提取10个聚类群中包含的gene集合。</p><p><strong>7.1 查看每个聚类群中各自包含的gene数量</strong></p></section><section><ul><li><li><li><li></ul><pre data-lang="python"><code><span><span># 查看每个聚类群中各自包含的gene数量</span></span></code><code><span>cluster_size &lt;- mfuzz_cluster$size</span></code><code><span>names(cluster_size) &lt;- <span>1</span>:cluster_num</span></code><code><span>cluster_size</span></code></pre></section><section powered-by="xiumi.us"><section><img data-ratio="0.15274949083503056" data-s="300,640" data-w="491" data-src="https://mmbiz.qpic.cn/mmbiz_png/hN03ibG0t2HvAHVSfwTgY1USlhctfiaICica6doI1VE2jazhc4rEicy4ibyhjEEyPic1MPQaD45TpzxfBgYEDqY9UzTQ/640?wx_fmt=png" width="100%" src="https://mmbiz.qpic.cn/mmbiz_png/hN03ibG0t2HvAHVSfwTgY1USlhctfiaICica6doI1VE2jazhc4rEicy4ibyhjEEyPic1MPQaD45TpzxfBgYEDqY9UzTQ/640?wx_fmt=png"></section></section><section powered-by="xiumi.us"><p><br></p><p><strong>7.2 查看每个gene所属的聚类群</strong></p></section><section><ul><li><li></ul><pre data-lang="python"><code><span><span>#查看每个gene所属的聚类群</span></span></code><code><span>head(mfuzz_cluster$cluster)</span></code></pre></section><section powered-by="xiumi.us"><section><img data-ratio="0.12248322147651007" data-s="300,640" data-w="596" data-src="https://mmbiz.qpic.cn/mmbiz_png/hN03ibG0t2HvAHVSfwTgY1USlhctfiaICicjqdMIiaB25H3BuMQsTKiahibT76DVdibx3gdHo0rw764GTurWvXkhD2LxA/640?wx_fmt=png" width="100%" src="https://mmbiz.qpic.cn/mmbiz_png/hN03ibG0t2HvAHVSfwTgY1USlhctfiaICicjqdMIiaB25H3BuMQsTKiahibT76DVdibx3gdHo0rw764GTurWvXkhD2LxA/640?wx_fmt=png"></section></section><section powered-by="xiumi.us"><p><br></p><p><strong>7.3 查看各gene的 membership 值</strong></p><p>Mfuzz 通过计算一个叫 membership 的统计量判断蛋白质所属的聚类群，以最大的 membership 值为准</p></section><section><ul><li><li><li></ul><pre data-lang="python"><code><span><span># Mfuzz 通过计算一个叫 membership 的统计量判断蛋白质所属的聚类群，以最大的 membership 值为准</span></span></code><code><span><span># 查看各gene的 membership 值</span></span></code><code><span>head(mfuzz_cluster$membership)</span></code></pre></section><section powered-by="xiumi.us"><p><strong>注意：</strong><strong><span>membership也可以表示向量之间的相似性。</span></strong>如果两个基因表达载体对一个特定的c簇具有较高的membership，则它们通常彼此相似。这是定义集群核心的基础。我们证明membership大于所选阈值α的基因属于聚类的α-核心。</p><p><strong><br></strong></p><p><strong>7.4 提取所有gene所属的聚类群导出</strong></p></section><section><ul><li><li><li><li><li></ul><pre data-lang="python"><code><span><span>#最后，提取所有gene所属的聚类群，并和它们的原始表达值整合在一起</span></span></code><code><span>gene_cluster &lt;- mfuzz_cluster$cluster</span></code><code><span>gene_cluster &lt;- cbind(data[names(gene_cluster), ], gene_cluster)</span></code><code><span>head(gene_cluster)</span></code><code><span>write.csv(gene_cluster, <span>'gene_cluster.csv'</span>)</span></code></pre></section><section powered-by="xiumi.us"><section><img data-ratio="0.5537037037037037" data-s="300,640" data-w="1080" data-src="https://mmbiz.qpic.cn/mmbiz_png/hN03ibG0t2HvAHVSfwTgY1USlhctfiaICicLqfDKHL3ubC7IFFRz6Ft3WQXvcfChibaHQribILpsXLeRo7RQetH6QibQ/640?wx_fmt=png" width="100%" src="https://mmbiz.qpic.cn/mmbiz_png/hN03ibG0t2HvAHVSfwTgY1USlhctfiaICicLqfDKHL3ubC7IFFRz6Ft3WQXvcfChibaHQribILpsXLeRo7RQetH6QibQ/640?wx_fmt=png"></section></section><section powered-by="xiumi.us"><p><br></p><p><strong>7.5 提取分析过程中标准化后的表达值并导出</strong></p></section><section><ul><li><li><li><li><li><li></ul><pre data-lang="python"><code><span><span># 提取分析过程中标准化后的表达值（绘制曲线图用的那个值，而非原始蛋白表达值）</span></span></code><code><span>gene_cluster &lt;- mfuzz_cluster$cluster</span></code><code><span>gene_standard &lt;- mfuzz_class@assayData$exprs</span></code><code><span>gene_standard_cluster &lt;- cbind(gene_standard[names(gene_cluster), ], gene_cluster)</span></code><code><span>head(gene_standard_cluster)</span></code><code><span>write.csv(gene_standard_cluster, <span>'gene_standard_cluster.csv'</span>)</span></code></pre></section><section powered-by="xiumi.us"><section><img data-ratio="0.5862745098039216" data-s="300,640" data-w="1020" data-src="https://mmbiz.qpic.cn/mmbiz_png/hN03ibG0t2HvAHVSfwTgY1USlhctfiaICicUjk1Hmu1xYYx0gI8lg7iaibLIss7kkZqWgjDtm6aDAicicMm41WOOMTGxA/640?wx_fmt=png" width="100%" src="https://mmbiz.qpic.cn/mmbiz_png/hN03ibG0t2HvAHVSfwTgY1USlhctfiaICicUjk1Hmu1xYYx0gI8lg7iaibLIss7kkZqWgjDtm6aDAicicMm41WOOMTGxA/640?wx_fmt=png"></section></section><p powered-by="xiumi.us"><br></p><p powered-by="xiumi.us"><strong>现在：</strong></p><section powered-by="xiumi.us"><p><br></p><p>长按扫码关注：<strong>科研生信充电宝</strong></p></section><section powered-by="xiumi.us"><section><img data-ratio="1" data-s="300,640" data-w="258" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/hN03ibG0t2HvAHVSfwTgY1USlhctfiaICicJnjG0iaBkCPX69yXktWIAzeF01iaM0bz51dYYrdtRuYeQ6zZIm15y5bA/640?wx_fmt=jpeg" width="100%" src="https://mmbiz.qpic.cn/mmbiz_jpg/hN03ibG0t2HvAHVSfwTgY1USlhctfiaICicJnjG0iaBkCPX69yXktWIAzeF01iaM0bz51dYYrdtRuYeQ6zZIm15y5bA/640?wx_fmt=jpeg"></section></section><section powered-by="xiumi.us"><p><strong><span>10元赞赏本文，即喜欢作者~</span></strong></p><p><strong><span><br></span></strong></p><p><strong><span>即可直接解锁：</span></strong></p><p><br></p><p><strong><span>《使用Mfuzz包进行基因表达时间趋势分析并聚类分群》全套代码和源文件</span></strong></p><p><br></p><p><span>看到这里你还不心动吗？</span><br></p><p><span><br></span></p><p><span>赶紧关注、转发、点赞、分享，领取你的专属福利吧~</span></p></section><section powered-by="xiumi.us"><p><br></p><p><br></p><p>好啦，以上就是今天推文的全部内容啦！<br></p><p><br></p><p><br></p></section><section powered-by="xiumi.us"><p>今天的分享就到这里啦~<br></p><p><br></p><p><span><strong>另外，本公众号建立了R语言和Python学习分享群，联系后台，拉您入群。</strong></span></p><p><span><strong><br></strong></span></p></section><p powered-by="xiumi.us">或直接添加小编，拉您入群：</p><section powered-by="xiumi.us"><section><img data-ratio="1.3642105263157895" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/hN03ibG0t2HvAHVSfwTgY1USlhctfiaICicQnOnqjLYyTPtghTjXsgeIqrTCs7Pl9yk4N6cjib6MBkSFwdme9UaibrQ/640?wx_fmt=jpeg" data-w="950" width="100%" src="https://mmbiz.qpic.cn/mmbiz_jpg/hN03ibG0t2HvAHVSfwTgY1USlhctfiaICicQnOnqjLYyTPtghTjXsgeIqrTCs7Pl9yk4N6cjib6MBkSFwdme9UaibrQ/640?wx_fmt=jpeg"></section></section><p powered-by="xiumi.us"><br></p><section powered-by="xiumi.us"><p><br></p><p><br></p><p>版权声明：本文内容由互联网用户自发贡献，版权归作者所有，本公众号不拥有所有权，也不承担相关法律责任。</p><p>如果您发现本公众号中有涉嫌抄袭的内容，欢迎发送邮件至：kysxcdb@163.com 进行举报，一经查实，本公众号将立刻删除涉嫌侵权内容。</p></section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><p><strong>BIOINFOR</strong></p></section></section></section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><img data-ratio="1" data-s="300,640" data-w="258" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/hN03ibG0t2HvAHVSfwTgY1USlhctfiaICicJnjG0iaBkCPX69yXktWIAzeF01iaM0bz51dYYrdtRuYeQ6zZIm15y5bA/640?wx_fmt=jpeg" width="100%" src="https://mmbiz.qpic.cn/mmbiz_jpg/hN03ibG0t2HvAHVSfwTgY1USlhctfiaICicJnjG0iaBkCPX69yXktWIAzeF01iaM0bz51dYYrdtRuYeQ6zZIm15y5bA/640?wx_fmt=jpeg"></section></section><section powered-by="xiumi.us"><section><p>微信号｜科研生信充电宝</p></section></section><section powered-by="xiumi.us"><section><p><span><strong> · BIOINFOR · </strong></span></p></section></section><p powered-by="xiumi.us"><br></p></section></section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><svg viewbox="0 0 1 1"></svg></section></section></section><section><section powered-by="xiumi.us"><section><p><strong>永远相信美好的事情</strong></p></section></section></section><section><section powered-by="xiumi.us"><section><svg viewbox="0 0 1 1"></svg></section></section></section><section><section powered-by="xiumi.us"><section><p><strong>即将发生</strong></p></section></section></section><section><section powered-by="xiumi.us"><section><svg viewbox="0 0 1 1"></svg></section></section></section></section></section><p><mp-style-type data-value="10000"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/wi8eR2iuhbWge5UGs2nQGA",target="_blank" rel="noopener noreferrer">原文链接</a>
