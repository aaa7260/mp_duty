---
title: "[会员专享] ggplot2组合绘制相关性箱线图"
date: 2023-07-01T23:10:41Z
draft: ["false"]
tags: [
  "fetched",
  "R语言数据分析指南"
]
categories: ["Acdemic"]
---
[会员专享] ggplot2组合绘制相关性箱线图 by R语言数据分析指南
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><h3 data-tool="mdnice编辑器"><span></span><span><span></span>欢迎关注R语言数据分析指南</span><span></span></h3><blockquote data-tool="mdnice编辑器"><span>❝</span><p>最近有朋友询问一张论文图的绘制方法，其本质为箱线图与棒棒糖图的结合并结合了统计分析，下面小编就通过一个案例来进行展示结果仅供参考，希望各位观众老爷能够喜欢。<strong>「数据+代码已经上传2023VIP群，加群的观众老爷请自行下载」</strong></p><span>❞</span></blockquote><figure data-tool="mdnice编辑器"><img data-ratio="0.38055555555555554" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAa7jF3l6YYUJgPTIZs7LJHZqIysFTveJj9AJS9C60xbydvtNNoh5oFjGg3K3v1VGYwpia5kvqVk7dw/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAa7jF3l6YYUJgPTIZs7LJHZqIysFTveJj9AJS9C60xbydvtNNoh5oFjGg3K3v1VGYwpia5kvqVk7dw/640?wx_fmt=png"></figure><h3 data-tool="mdnice编辑器"><span></span><span><span></span>复现图</span><span></span></h3><figure data-tool="mdnice编辑器"><img data-ratio="0.7272727272727273" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAa7jF3l6YYUJgPTIZs7LJHZt2UETa6886roj8MbQbeQv3lvhUk4rqwRZ45An0B5IHgfn6ltmPpBFg/640?wx_fmt=png" data-type="png" data-w="891" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAa7jF3l6YYUJgPTIZs7LJHZt2UETa6886roj8MbQbeQv3lvhUk4rqwRZ45An0B5IHgfn6ltmPpBFg/640?wx_fmt=png"></figure><blockquote data-tool="mdnice编辑器"><span>❝</span><p>上方的棒棒糖图为对基因内两组之间进行相关性分析的结果展示</p><span>❞</span></blockquote><h3 data-tool="mdnice编辑器"><span></span><span><span></span>关注下方公众号下回更新不迷路</span><span></span></h3><section><mp-common-profile data-pluginname="mpprofile" data-id="Mzg3MzQzNTYzMw==" data-headimg="http://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZF0rpeZII9Ltl26VbVagriczTria1fib3XgjwwHEHFjPzkmGpqWDVVHBSzhENictUM2iavAKiaM5lc9USw/0?wx_fmt=png" data-nickname="R语言数据分析指南" data-alias="YanJANtwo" data-signature="R语言重症爱好者，喜欢绘制各种精美的图表，喜欢的小伙伴可以关注我，跟我一起学习" data-from="0" data-is_biz_ban="0"></mp-common-profile></section><h3 data-tool="mdnice编辑器"><span></span><span><span></span>加载R包</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code><span>library</span>(tidyverse)<br><span>library</span>(ggprism)<br><span>library</span>(rstatix)<br><span>library</span>(ggpubr)<br><span>library</span>(magrittr)<br><span>library</span>(MetBrewer)<br><span>library</span>(patchwork)<br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span><span></span>数据清洗</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code>df &lt;- read_tsv(<span>"data.xls"</span>) %&gt;% select(<span>1</span>:<span>10</span>,cluster) %&gt;% <br>  select(-ID) %&gt;% <br>  pivot_longer(-cluster)<br><br>df$name &lt;- factor(df$name,levels = df$name %&gt;% unique())<br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span><span></span>统计分析</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code>df_p_val1 &lt;- df %&gt;% group_by(name) %&gt;%<br>  wilcox_test(value ~ cluster) %&gt;%<br>  adjust_pvalue(p.col = <span>"p"</span>, method = <span>"bonferroni"</span>) %&gt;%<br>  add_significance(p.col = <span>"p.adj"</span>) %&gt;% <br>  add_xy_position(x = <span>"name"</span>, dodge = <span>0.8</span>)<br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span><span></span>绘制显著性箱线图</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code>p1 &lt;- df %&gt;% ggplot(aes(name,value))+<br>  stat_boxplot(geom=<span>"errorbar"</span>,aes(fill=cluster),<br>               position=position_dodge(width=<span>0.6</span>),width=<span>0.1</span>)+<br>  geom_boxplot(aes(fill=cluster),position=position_dodge(width =<span>0.6</span>),width=<span>0.4</span>)+<br>  stat_pvalue_manual(df_p_val1,label = <span>"p.adj.signif"</span>,label.size=<span>4</span>,hide.ns = <span>T</span>,<br>                     tip.length = <span>0.01</span>)+<br>  scale_size_continuous(range=c(<span>1</span>,<span>3</span>))+<br>  scale_fill_manual(values=c(<span>"#3CB2EC"</span>,<span>"#9C8D58"</span>))+<br>  labs(x=<span>NULL</span>,y=<span>NULL</span>)+<br>  theme_test()+<br>  theme(plot.margin=unit(c(<span>0</span>,<span>0.5</span>,<span>0.5</span>,<span>0.5</span>),units=,<span>"cm"</span>),<br>        axis.line = element_line(color = <span>"black"</span>,size = <span>0.3</span>),<br>        panel.grid.minor = element_blank(),<br>        panel.grid.major = element_line(size = <span>0.2</span>,color = <span>"#e5e5e5"</span>),<br>        axis.text.y = element_text(color=<span>"black"</span>,size=<span>8</span>),<br>        axis.text.x = element_text(margin = margin(t = <span>2</span>),color=<span>"black"</span>,size=<span>8</span>),<br>        legend.position = <span>"none"</span>)+<br>  coord_cartesian()<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.39119804400978" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAa7jF3l6YYUJgPTIZs7LJHZTtDfPNKu4USpQq2EU2lQP1uGaskD0SXMdGIjFWcF2OnflUl2uicAsnw/640?wx_fmt=png" data-type="png" data-w="818" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAa7jF3l6YYUJgPTIZs7LJHZTtDfPNKu4USpQq2EU2lQP1uGaskD0SXMdGIjFWcF2OnflUl2uicAsnw/640?wx_fmt=png"></figure><blockquote data-tool="mdnice编辑器"><span>❝</span><p>关于如何计算组内相关性及绘图请继续往后看，有需要学习个性化数据可视化的朋友，欢迎到小编的<strong>「淘宝店铺」</strong> <strong>「R语言数据分析指南」</strong>购买<strong>「2023年度会员文档」</strong>同步更新中 <code>初始价格99元7</code>月3日将调整价格为<strong>「149元」</strong>，内容主要包括各种<strong>「高分论文的图表分析复现以及一些个性化图表的绘制」</strong>均包含数据+代码；按照往年数据小编年产出约在150+以上</p><span>❞</span></blockquote><p data-tool="mdnice编辑器">购买后微信发小编订单截图即邀请进新的会员交流群，小编的文档为按年售卖，只包含当年度的<strong>「除系列课程外」</strong>的文档，有需要往年文档的朋友也可下单购买，需要了解更多信息的朋友欢迎交流咨询。</p><h3 data-tool="mdnice编辑器"><span></span><span><span></span>淘宝扫一扫</span><span></span></h3><figure data-tool="mdnice编辑器"></figure><h3 data-tool="mdnice编辑器"><span></span><span><span></span>2023会员群案例展示</span><span></span></h3><p data-tool="mdnice编辑器"><img data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAa7jF3l6YYUJgPTIZs7LJHZU3hCJ51lib9VXblTTfWapnjYfcic5YjNWoFasxZdSvLoKDibhp1iavvrqw/640?wx_fmt=png" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAa7jF3l6YYUJgPTIZs7LJHZU3hCJ51lib9VXblTTfWapnjYfcic5YjNWoFasxZdSvLoKDibhp1iavvrqw/640?wx_fmt=png"><img data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAa7jF3l6YYUJgPTIZs7LJHZJXbc0mUVarSYBuz16Hic1bLLC9G1ZNUwPPl356qiaw5PoUzUfvtBuDkw/640?wx_fmt=png" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAa7jF3l6YYUJgPTIZs7LJHZJXbc0mUVarSYBuz16Hic1bLLC9G1ZNUwPPl356qiaw5PoUzUfvtBuDkw/640?wx_fmt=png"><img data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAa7jF3l6YYUJgPTIZs7LJHZhPrE1ckPCWqgNeTeLEko0fkvMJsGd7xooNQqXiaTp7hvVZ5nvibmiacSg/640?wx_fmt=png" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAa7jF3l6YYUJgPTIZs7LJHZhPrE1ckPCWqgNeTeLEko0fkvMJsGd7xooNQqXiaTp7hvVZ5nvibmiacSg/640?wx_fmt=png"><img data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAa7jF3l6YYUJgPTIZs7LJHZE2FXc2Xg3JLVQTiacTegOIH0uiaIYtr7c09nZVWsjV1ibfOwWsU71kMeg/640?wx_fmt=png" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAa7jF3l6YYUJgPTIZs7LJHZE2FXc2Xg3JLVQTiacTegOIH0uiaIYtr7c09nZVWsjV1ibfOwWsU71kMeg/640?wx_fmt=png"><img data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAa7jF3l6YYUJgPTIZs7LJHZdic5utjA9e16icVsG8u2W6HvpySoeYmlPd8hW0gvrMffyicibkyEf1rWkg/640?wx_fmt=png" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAa7jF3l6YYUJgPTIZs7LJHZdic5utjA9e16icVsG8u2W6HvpySoeYmlPd8hW0gvrMffyicibkyEf1rWkg/640?wx_fmt=png"><img data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAa7jF3l6YYUJgPTIZs7LJHZW0a1NlvbunS5dSAfhIY6w6XLfRial4CnfVdNZWLZiavCXHhspIgibS9dg/640?wx_fmt=png" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAa7jF3l6YYUJgPTIZs7LJHZW0a1NlvbunS5dSAfhIY6w6XLfRial4CnfVdNZWLZiavCXHhspIgibS9dg/640?wx_fmt=png"><img data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAa7jF3l6YYUJgPTIZs7LJHZsH9LSHlaVePVlyYBNewDqJ8mT8XbDEAArSIJs20w1D9kp0PlWBKDkg/640?wx_fmt=png" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAa7jF3l6YYUJgPTIZs7LJHZsH9LSHlaVePVlyYBNewDqJ8mT8XbDEAArSIJs20w1D9kp0PlWBKDkg/640?wx_fmt=png"><img data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAa7jF3l6YYUJgPTIZs7LJHZU7XzuBbTJWWlrJ7dHed3Wjw264HpcOWFW0uIr3M1evFXYRoSq3m4nA/640?wx_fmt=png" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAa7jF3l6YYUJgPTIZs7LJHZU7XzuBbTJWWlrJ7dHed3Wjw264HpcOWFW0uIr3M1evFXYRoSq3m4nA/640?wx_fmt=png"></p><h3 data-tool="mdnice编辑器"><span></span><span><span></span>文档内容展示</span><span></span></h3><p data-tool="mdnice编辑器"><img data-ratio="0.475" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAa7jF3l6YYUJgPTIZs7LJHZbNK4fwsOEbZbJwMlwc0icMTVcmOXqtKr0mfSsrSjtCicyic27Hkqf3Pyw/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAa7jF3l6YYUJgPTIZs7LJHZbNK4fwsOEbZbJwMlwc0icMTVcmOXqtKr0mfSsrSjtCicyic27Hkqf3Pyw/640?wx_fmt=png"><img data-ratio="0.44722222222222224" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAa7jF3l6YYUJgPTIZs7LJHZ8ianKqkLhHaqEXpK4BZp3WAz082ib7bZ9344dHG46zFLic3whH9eMiaXDg/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAa7jF3l6YYUJgPTIZs7LJHZ8ianKqkLhHaqEXpK4BZp3WAz082ib7bZ9344dHG46zFLic3whH9eMiaXDg/640?wx_fmt=png"></p><h3 data-tool="mdnice编辑器"><span></span><span><span></span>分组计算相关性</span><span></span></h3><p><mp-pay-preview-filter data-offset="26"></mp-pay-preview-filter></p></section></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/jmnevSlgxFroyqIOGxmjrw",target="_blank" rel="noopener noreferrer">原文链接</a>
