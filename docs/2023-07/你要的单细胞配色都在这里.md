---
title: "你要的单细胞配色都在这里"
date: 2023-07-23T09:30:18Z
draft: ["false"]
tags: [
  "fetched",
  "TOP生物信息"
]
categories: ["Acdemic"]
---
你要的单细胞配色都在这里 by TOP生物信息
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><p data-tool="mdnice编辑器">本文共计1564字，阅读大约需要5分钟，目录如下：</p><ul><li><p><strong><span>颜色挑选-自定义颜色集合</span></strong></p></li><ul><li><p>color()函数或者Snipaste软件取色</p></li><li><p>RImagePalette包识别颜色</p></li></ul><li><p><strong><span>颜色挑选-已定义颜色集合</span></strong></p></li><ul><li><p>RColorBrewer包</p></li><li><p>ggsci包</p></li><li><p>paletteer包</p></li><li><p>cols4all包</p></li></ul><li><p><strong><span>已发表文章的配色参考</span></strong></p></li><li><p><strong><span>代码及文献参考</span></strong></p></li><li><p><span><strong>获取测试数据</strong></span></p></li></ul><p><br></p><p><span>本文设置了</span><span><strong>讨论区</strong></span><span>，点击</span><span><strong>文末的阅读原文</strong></span><span>即可进入，大家可以把自己觉得不错的配色方案留在讨论区，相互交流学习！</span><br></p><h2 data-tool="mdnice编辑器"><span></span><span>颜色挑选-自定义颜色集合</span></h2><h3 data-tool="mdnice编辑器"><span></span>color()函数或者Snipaste软件取色<span></span></h3><p data-tool="mdnice编辑器">使用<code>color()</code>函数查看颜色的完整列表，也可以下载并安装Snipaste截图软件（下载链接：https://zh.snipaste.com/）获取感兴趣的颜色向量后进行自定义配色。</p><pre data-tool="mdnice编辑器"><span></span><code>length(colors()) <span>#657种颜色</span><br>show_col(colors()[<span>1</span>:<span>100</span>])<br><span>#配色来自：Nat Med. 2019 Aug;25(8):1251-1259. </span><br>mycolor&lt;-c(<span>"#80d7e1"</span>,<span>"#e4cbf2"</span>,<span>"#ffb7ba"</span>,<span>"#bf5046"</span>,<span>"#b781d2"</span>,<span>"#ece7a3"</span>,<br>            <span>"#f5cbe1"</span>,<span>"#e6e5e3"</span>,<span>"#d2b5ab"</span>,<span>"#d9e3f5"</span>,<span>"#f29432"</span>,<span>"#9c9895"</span>)<br>show_col(mycolor)<br>DimPlot(pbmc5k, reduction = <span>"umap"</span>,label=<span>T</span>)+ NoLegend() <span>#读入任意创建好的seurat对象即可</span><br>DimPlot(pbmc5k, reduction = <span>"umap"</span>,cols=mycolor,label=<span>T</span>)+ NoLegend()<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.4425925925925926" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/WThoCmvVu2Z0btEAluu57xNGa4iczXkib0qr1UqGKb7U9Z1TBzb6KqeA5U4S2xicJonqHUc0cWGyTPpo7iaIBzWUQg/640?wx_fmt=jpeg" data-type="jpeg" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_jpg/WThoCmvVu2Z0btEAluu57xNGa4iczXkib0qr1UqGKb7U9Z1TBzb6KqeA5U4S2xicJonqHUc0cWGyTPpo7iaIBzWUQg/640?wx_fmt=jpeg"><figcaption>图1</figcaption></figure><h3 data-tool="mdnice编辑器"><span></span>RImagePalette包识别颜色<span></span></h3><p data-tool="mdnice编辑器">如果不想手动识别颜色，可以下载图片后使用RImagePalette包获取颜色向量，图片的背景颜色等也会识别，使用时可以多设置一些颜色数量用于挑选。</p><pre data-tool="mdnice编辑器"><span></span><code>devtools::install_github(<span>"joelcarlson/RImagePalette"</span>)<br><span>library</span>(RImagePalette)<br><span>#加载图片</span><br>lifeAquatic &lt;- jpeg::readJPEG(<span>"color.jpg"</span>)<span>#UMAP图片来自：Nat Med. 2019 Aug;25(8):1251-1259. </span><br>display_image(lifeAquatic)<br><span>#可以调整n的值来得到不同数量的颜色</span><br>mycolor &lt;- image_palette(lifeAquatic, n=<span>16</span>) <br>show_col(mycolor)<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.48055555555555557" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/WThoCmvVu2Z0btEAluu57xNGa4iczXkib0vrPuFyjydatrysL5UKZKLicU9TxmBiaglFk2yJicnDL8kfX8X671cNNSQ/640?wx_fmt=jpeg" data-type="jpeg" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_jpg/WThoCmvVu2Z0btEAluu57xNGa4iczXkib0vrPuFyjydatrysL5UKZKLicU9TxmBiaglFk2yJicnDL8kfX8X671cNNSQ/640?wx_fmt=jpeg"><figcaption>图2</figcaption></figure><h2 data-tool="mdnice编辑器"><span></span><span>颜色挑选-已定义颜色集合</span></h2><h3 data-tool="mdnice编辑器"><span></span>RColorBrewer包<span></span></h3><p data-tool="mdnice编辑器">RColorBrewer包主要有三种类型的配色方案。</p><ul data-tool="mdnice编辑器"><li><section>sequential：生成渐变的颜色，标记连续型数据大小，可选择颜色种类范围是3~9；</section></li><li><section>diverging：分散的，两头重，中间浅，标记数据离群点，可选择颜色种类范围是3~11；</section></li><li><section>qualitative：离散的，生成彼此差异明显的颜色，标记分类变量。可选择颜色种类，最小是3，最大根据每个色板的不同。</section></li></ul><pre data-tool="mdnice编辑器"><span></span><code><span>library</span>(RColorBrewer)<br>display.brewer.all()<br><span>#调用单个调色板</span><br>mycolor&lt;-brewer.pal(<span>9</span>, <span>"Set1"</span>)<br><span>#调用多个调色板合并</span><br>b1&lt;-brewer.pal(<span>9</span>, <span>"Set1"</span>)<br>b2&lt;-brewer.pal(<span>8</span>, <span>"Set2"</span>)<br>mycolor&lt;-c(b1,b2) <br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.7374245472837022" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/WThoCmvVu2Z0btEAluu57xNGa4iczXkib08QwCU4TwA7uFzOcHiboGXf8cZd0QtFWia4yiahFOoibQEtn2oNcoULqP3Q/640?wx_fmt=jpeg" data-type="jpeg" data-w="994" src="https://mmbiz.qpic.cn/mmbiz_jpg/WThoCmvVu2Z0btEAluu57xNGa4iczXkib08QwCU4TwA7uFzOcHiboGXf8cZd0QtFWia4yiahFOoibQEtn2oNcoULqP3Q/640?wx_fmt=jpeg"><figcaption>图3</figcaption></figure><h3 data-tool="mdnice编辑器"><span></span>ggsci包<span></span></h3><p data-tool="mdnice编辑器">ggsci包收集了期刊、数据可视化库、电视节目和科幻电影中使用的颜色，可以使用<code>vignette("ggsci")</code>查看配色方案，同时ggsci也支持将调色板的颜色单独提取。</p><pre data-tool="mdnice编辑器"><span></span><code><span>library</span>(<span>"ggsci"</span>)<br>vignette(<span>"ggsci"</span>)<br>DimPlot(pbmc5k, reduction = <span>"umap"</span>,label=<span>T</span>)+ scale_color_nejm()+NoLegend()<br>mycolor&lt;-pal_nejm(<span>"default"</span>, alpha = <span>0.5</span>)(<span>8</span>) <br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.33425925925925926" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/WThoCmvVu2Z0btEAluu57xNGa4iczXkib0xcDeRg8MzMibdCKhtUkZjS2WciaYZaiaM5rQu0p0yC2sFXkH2nzu4h3ZA/640?wx_fmt=jpeg" data-type="jpeg" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_jpg/WThoCmvVu2Z0btEAluu57xNGa4iczXkib0xcDeRg8MzMibdCKhtUkZjS2WciaYZaiaM5rQu0p0yC2sFXkH2nzu4h3ZA/640?wx_fmt=jpeg"><figcaption>图4</figcaption></figure><h3 data-tool="mdnice编辑器"><span></span>paletteer包<span></span></h3><p data-tool="mdnice编辑器">paletteer包包括来自68个不同R包的2569个调色板，可以使用<code>palettes_d_name</code>、<code>palettes_c_name</code>和<code>palette s_dynamic_name</code>函数调用相应的R包和配色，并且可以直接显示颜色。</p><pre data-tool="mdnice编辑器"><span></span><code>install.packages(<span>"paletteer"</span>)<br><span>library</span>(paletteer)  <br>paletteer_c(<span>"scico::berlin"</span>, n = <span>10</span>)<br>paletteer_d(<span>"RColorBrewer::Paired"</span>,n=<span>12</span>)<br>paletteer_dynamic(<span>"cartography::green.pal"</span>, <span>20</span>)<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.17780938833570412" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/WThoCmvVu2Z0btEAluu57xNGa4iczXkib0Vjjibw9daLxs6pGeVJ1bFDltqBfMEicymg1he2Rd1Ltt00TvqA68Hx5g/640?wx_fmt=jpeg" data-type="jpeg" data-w="703" src="https://mmbiz.qpic.cn/mmbiz_jpg/WThoCmvVu2Z0btEAluu57xNGa4iczXkib0Vjjibw9daLxs6pGeVJ1bFDltqBfMEicymg1he2Rd1Ltt00TvqA68Hx5g/640?wx_fmt=jpeg"><figcaption>图5</figcaption></figure><h3 data-tool="mdnice编辑器"><span></span>cols4all包<span></span></h3><p data-tool="mdnice编辑器">cols4all包整合了多个配色R包，还提供了交互面板，可以直观地浏览和选择所有色板，选择合适的颜色。</p><pre data-tool="mdnice编辑器"><span></span><code>remotes::install_github(<span>"mtennekes/cols4all"</span>)<br><span>library</span>(cols4all)<br><span>#交互面板</span><br>c4a_gui()<br><span>#可以通过函数提取配色(色板名称+所需颜色数量)</span><br>mycolor &lt;-c4a(<span>"light24"</span>, <span>9</span>)<br></code></pre><h6 data-tool="mdnice编辑器"><span></span><img data-ratio="0.43333333333333335" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/WThoCmvVu2Z0btEAluu57xNGa4iczXkib0sAAxyJHleoXWUacYyULzH34iavIPl7etAqsUUQWqtOpZiajdBpic9gqbg/640?wx_fmt=jpeg" data-type="jpeg" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_jpg/WThoCmvVu2Z0btEAluu57xNGa4iczXkib0sAAxyJHleoXWUacYyULzH34iavIPl7etAqsUUQWqtOpZiajdBpic9gqbg/640?wx_fmt=jpeg"><span></span></h6><h2 data-tool="mdnice编辑器"><span></span><span>已发表文章的配色参考</span></h2><p data-tool="mdnice编辑器">除了使用<code>DimPlot</code>函数中的cols参数调用颜色外，还可以通过参考ggplot2的用法使用<code>scale_color_XX()</code>等函数调用调色板，在这里也提供了一些文章中配色。</p><pre data-tool="mdnice编辑器"><span></span><code><span>#配色来自：Nat Med. 2019 Aug;25(8):1251-1259. </span><br>mycolor1&lt;-c(<span>"#80d7e1"</span>,<span>"#e4cbf2"</span>,<span>"#ffb7ba"</span>,<span>"#bf5046"</span>,<span>"#b781d2"</span>,<span>"#ece7a3"</span>,<br>            <span>"#f5cbe1"</span>,<span>"#e6e5e3"</span>,<span>"#d2b5ab"</span>,<span>"#d9e3f5"</span>,<span>"#f29432"</span>,<span>"#9c9895"</span>)<br>show_col(mycolor1,labels = <span>F</span>)<br><span>#配色来自：Immunity. 2020 May 19;52(5):808-824.e7.</span><br>mycolor2&lt;-c(<span>"#e41e25"</span>,<span>"#307eb9"</span>,<span>"#4cb049"</span>,<span>"#974e9e"</span>,<span>"#f57f21"</span>,<span>"#f4ed35"</span>,<br>            <span>"#a65527"</span>,<span>"#9bc7e0"</span>,<span>"#b11f2b"</span>,<span>"#f6b293"</span>)<br>show_col(mycolor2,labels = <span>F</span>)<br><span>#配色来自：Cell. 2019 Oct 31;179(4):829-845.e20.</span><br>mycolor3&lt;-c(<span>"#b38a8f"</span>,<span>"#bba6a6"</span>,<span>"#d5b3a5"</span>,<span>"#e69db8"</span>,<span>"#c5ae8d"</span>,<span>"#87b2d4"</span>,<br>            <span>"#babb72"</span>,<span>"#4975a5"</span>,<span>"#499994"</span>,<span>"#8e8786"</span>,<span>"#93a95d"</span>,<span>"#f19538"</span>,<br>            <span>"#fcba75"</span>,<span>"#8ec872"</span>,<span>"#ad9f35"</span>,<span>"#8ec872"</span>,<span>"#d07794"</span>,<span>"#ff9796"</span>,<br>            <span>"#b178a3"</span>,<span>"#e56464"</span>,<span>"#6cb25e"</span>,<span>"#ca9abe"</span>,<span>"#d6b54c"</span>) <br>DimPlot(pbmc5k, reduction = <span>"umap"</span>,group.by=<span>'seurat_clusters'</span>,label=<span>T</span>)+scale_color_manual(values = mycolor1)+NoLegend()<br>DimPlot(pbmc5k, reduction = <span>"umap"</span>,group.by=<span>'seurat_clusters'</span>,label=<span>T</span>)+scale_color_manual(values = mycolor2)+NoLegend()<br>DimPlot(pbmc5k, reduction = <span>"umap"</span>,group.by=<span>'seurat_clusters'</span>,label=<span>T</span>)+scale_color_manual(values = mycolor3)+NoLegend()<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.4962962962962963" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/WThoCmvVu2Z0btEAluu57xNGa4iczXkib05x3Iwia6jibNjXTwrqsZnW7eS0H2SsSSmPUwUIrKyjVwOYwHASKniaKicg/640?wx_fmt=jpeg" data-type="jpeg" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_jpg/WThoCmvVu2Z0btEAluu57xNGa4iczXkib05x3Iwia6jibNjXTwrqsZnW7eS0H2SsSSmPUwUIrKyjVwOYwHASKniaKicg/640?wx_fmt=jpeg"><figcaption>图7</figcaption></figure><h2 data-tool="mdnice编辑器"><span></span><span>代码及文献参考</span></h2><p data-tool="mdnice编辑器">https://colorbrewer2.org/</p><p data-tool="mdnice编辑器">https://www.rdocumentation.org/packages/RImagePalette/versions/0.1.1</p><p data-tool="mdnice编辑器">https://www.rdocumentation.org/packages/ggsci/versions/3.0.0</p><p data-tool="mdnice编辑器">https://www.rdocumentation.org/packages/paletteer/versions/1.5.0</p><p data-tool="mdnice编辑器">https://cran.r-project.org/web/packages/cols4all/vignettes/intro.html</p><p data-tool="mdnice编辑器">https://zhuanlan.zhihu.com/p/557588070</p><p data-tool="mdnice编辑器">Yost KE et al. Clonal replacement of tumor-specific T cells following PD-1 blockade. Nat Med. 2019 Aug;25(8):1251-1259. doi: 10.1038/s41591-019-0522-3. Epub 2019 Jul 29. PMID: 31359002; PMCID: PMC6689255.</p><p data-tool="mdnice编辑器">Milner JJ et al. Heterogenous Populations of Tissue-Resident CD8+ T Cells Are Generated in Response to Infection and Malignancy. Immunity. 2020 May 19;52(5):808-824.e7. doi: 10.1016/j.immuni.2020.04.007. PMID: 32433949; PMCID: PMC7784612.</p><p data-tool="mdnice编辑器">Zhang Q et al. Landscape and Dynamics of Single Immune Cells in Hepatocellular Carcinoma. Cell. 2019 Oct 31;179(4):829-845.e20. doi: 10.1016/j.cell.2019.10.003. PMID: 31675496.</p><h2 data-tool="mdnice编辑器"><span></span><span>获取测试数据</span></h2><p data-tool="mdnice编辑器">链接：https://pan.baidu.com/s/1aAH52f9AjXL4Jk3TVl6_cQ?pwd=bfcm</p><p data-tool="mdnice编辑器">提取码：bfcm</p></section><section><mp-common-profile data-pluginname="mpprofile" data-weui-theme="light" data-id="MzkzMzE5NTM4NA==" data-headimg="http://mmbiz.qpic.cn/mmbiz_png/WThoCmvVu2aJMzXzvekL6pv5hnSGnwsxWcOUF8av7a9VEiaicBGia4CRy0DUOeaFuFZY2BPLmRQSf4lkibg5l31Ttw/0?wx_fmt=png" data-nickname="TOP生物信息" data-alias="" data-signature="在读博士生，研究方向为癌症基因组、肿瘤免疫、单细胞组学" data-from="0" data-is_biz_ban="0"></mp-common-profile></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/E2q0Klj5RureOf4ISeKpOg",target="_blank" rel="noopener noreferrer">原文链接</a>
