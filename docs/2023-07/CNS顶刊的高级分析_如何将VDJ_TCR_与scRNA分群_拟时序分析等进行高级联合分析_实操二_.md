---
title: "CNS顶刊的高级分析：如何将VDJ(TCR)与scRNA分群，拟时序分析等进行高级联合分析（实操二）"
date: 2023-07-16T23:51:54Z
draft: ["false"]
tags: [
  "fetched",
  "R语言生信医学统计与科研"
]
categories: ["Acdemic"]
---
CNS顶刊的高级分析：如何将VDJ(TCR)与scRNA分群，拟时序分析等进行高级联合分析（实操二） by R语言生信医学统计与科研
------
<div><p>一、引言</p><p>在前面的章节中，我们讲解了基本的TCR分析（<a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzkyNTQzNDIwOA==&amp;mid=2247484615&amp;idx=1&amp;sn=2a8d05b4dc59929ad4bf998afccf2b82&amp;chksm=c1c7ecc8f6b065dedc4e6d6cb409de3ad588a30efbecb4356bc186e637d37d28a32d104fc273&amp;scene=21#wechat_redirect" textvalue="CNS顶刊的高级分析：如何将VDJ(TCR)与scRNA分群，拟时序分析等进行高级联合分析（实操一）" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2">CNS顶刊的高级分析：如何将VDJ(TCR)与scRNA分群，拟时序分析等进行高级联合分析（实操一）</a>）和基础的整合分析（<a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzkyNTQzNDIwOA==&amp;mid=2247484593&amp;idx=1&amp;sn=1a0b78ffef85a3fa8eae14b37e56ba1e&amp;chksm=c1c7ecbef6b065a8ff68b6a2de0796fbb8d416b514cf3edd72a81d3a3bba8c219c556aaa7c50&amp;scene=21#wechat_redirect" textvalue="如何进行单细胞转录组（scRNA）和单细胞免疫组库（single VDJ）的整合分析（实操）" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2">如何进行单细胞转录组（scRNA）和单细胞免疫组库（single VDJ）的整合分析（实操）</a>），接下来我们进行高级分析。<br></p><p>二、实操分析</p><p>2.1 数据准备阶段<br></p><section><ul><li><li><li><li><li><li><li></ul><pre data-lang="apache"><code><span><span># 加载 R 包</span></span></code><code><span><span>library</span>(scRepertoire)</span></code><code><span><span>library</span>(Seurat)</span></code><code><span><br></span></code><code><span><span># 加载数据</span></span></code><code><span><span>combined</span> &lt;- readRDS(<span>"./TCR_expression.rds"</span>)</span></code><code><span><span>scRNA</span> &lt;- readRDS(<span>"./scRNA_expression.rds"</span>)</span></code></pre></section><p>2.2 scRNA和VDJ的整合</p><p>接下来，我们可以使用combineExpression()函数获取克隆信息并将其添加到Seurat对象中。重要的是，VDJ数据对象中“barcode”列中的名称（内容）必须与Seurat对象中的barcode（列名称：colnames(Seurat-object)可以查看或者获得）一一对应。否则，将无法进行合并。</p><p><img data-galleryid="" data-ratio="0.5466666666666666" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/e4qfpSBibv0CQ4uNUIfTvsT4oasUr4kQfEZT1BN06ZBhvFoicvFsvb1M3ib8zp4Bx1tG3icemZDuFkMrzoIDgIJ0MA/640?wx_fmt=png" data-type="png" data-w="1050" src="https://mmbiz.qpic.cn/mmbiz_png/e4qfpSBibv0CQ4uNUIfTvsT4oasUr4kQfEZT1BN06ZBhvFoicvFsvb1M3ib8zp4Bx1tG3icemZDuFkMrzoIDgIJ0MA/640?wx_fmt=png"></p><p>我们可以调用cloneCall参数，指定要用于展示的克隆型：（1）VDJC基因；（2）CDR3氨基酸序列；（3）CDR3核苷酸序列；（4）VDJC基因和CDR3核苷酸序列。调用 group.by 变量，根据组计算克隆型的频率。如果 group.by 为空值，将计算单个run的克隆型频率。</p><p>我们可以使用不同的频率计算方式为克隆型进行分类，当设置proportion为TRUE时，将使用相对比例，为FALSE将使用绝对频率来定义克隆类型组，cloneTypes参数用于指定bin的图例名称。默认情况下，cloneTypes被设置为cloneTypes=c(Rare = 1e-4, Small = 0.001, Medium = 0.01, Large = 0.1, Hyperexpanded = 1)。下面你可以看到一个使用绝对频率作为扩展分配的例子。</p><section><ul><li><li><li><li><li><li><li></ul><pre data-lang="xml"><code><span>seurat <span>&lt;<span>-</span> <span>combineExpression</span>(<span>combined</span>, <span>scRNA</span>, </span></span></code><code><span>                            <span>cloneCall</span>=<span>"gene"</span>, </span></code><code><span>                            <span>group.by</span> = <span>"sample"</span>, </span></code><code><span>                            <span>proportion</span> = <span>FALSE,</span> </span></code><code><span>                            <span>cloneTypes</span>=<span>c(</span></span></code><code><span>                              <span>Single</span>=<span>1,</span> <span>Small</span>=<span>5,</span> <span>Medium</span>=<span>20,</span></span></code><code><span>                              Large=100, Hyperexpanded=500))</span></code></pre></section><p>如果你已经进行了TCR/BCR富集，或者想同时添加 γ-δ T细胞和 α-β T细胞的信息，现在我们可以只做一个列表并使用combineExpression()。值得注意：如果有重复的条形码(如果一个细胞同时有Ig和TCR)，免疫受体信息将不会被添加。我们也做了一个统计，大约有5-6%的条形码重叠。</p><section><ul><li><li><li><li><li><li><li><li><li></ul><pre data-lang="properties"><code><span><span>#This is an example of the process, will not be evaluated during knit</span></span></code><code><span><span>TCR</span> <span>&lt;- combineTCR(...)</span></span></code><code><span><span>BCR</span> <span>&lt;- combineBCR(...)</span></span></code><code><span><span>list.receptors</span> <span>&lt;- c(TCR, BCR)</span></span></code><code><span><br></span></code><code><span><span>seurat</span> <span>&lt;- combineExpression(list.receptors, </span></span></code><code><span>                            <span>seurat,</span> <span></span></span></code><code><span>                            <span>cloneCall</span>=<span>"gene", </span></span></code><code><span>                            <span>proportion</span> = <span>TRUE)</span></span></code></pre></section><p>2.3 克隆亚型分析<br></p><p>接下来，我们先探究一下外周血和肿瘤之间的细胞分布情况。<br></p><section><ul><li><li><li><li><li><li><li></ul><pre data-lang="cs"><code><span>colorblind_vector &lt;- colorRampPalette(rev(c(<span>"#0D0887FF"</span>, <span>"#47039FFF"</span>, </span></code><code><span>              <span>"#7301A8FF"</span>, <span>"#9C179EFF"</span>, <span>"#BD3786FF"</span>, <span>"#D8576BFF"</span>,</span></code><code><span>              <span>"#ED7953FF"</span>,<span>"#FA9E3BFF"</span>, <span>"#FDC926FF"</span>, <span>"#F0F921FF"</span>)))</span></code><code><span><br></span></code><code><span>DimPlot(seurat, <span>group</span>.<span>by</span> = <span>"Type"</span>) + NoLegend() +</span></code><code><span>    scale_color_manual(values=colorblind_vector(<span>2</span>)) + </span></code><code><span>    theme(plot.title = element_blank())</span></code></pre></section><p><img data-galleryid="" data-ratio="0.6950276243093922" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/e4qfpSBibv0CQ4uNUIfTvsT4oasUr4kQf1r5TN9azatzKgLWUduuSys2nuQmJv2icZ14d41FNHic0tGCoUhDSpD8g/640?wx_fmt=png" data-type="png" data-w="905" src="https://mmbiz.qpic.cn/mmbiz_png/e4qfpSBibv0CQ4uNUIfTvsT4oasUr4kQf1r5TN9azatzKgLWUduuSys2nuQmJv2icZ14d41FNHic0tGCoUhDSpD8g/640?wx_fmt=png"></p><p>（1）我们基于合并数据后的Seurat对象中的meta属性中的 clonoType 列，展示不同细胞克隆型分类。<br></p><section><ul><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="cs"><code><span>slot(seurat, <span>"meta.data"</span>)$cloneType &lt;- factor(</span></code><code><span>  slot(seurat, <span>"meta.data"</span>)$cloneType, </span></code><code><span>  levels = c(<span>"Hyperexpanded (100 &lt; X &lt;= 500)"</span>, </span></code><code><span>             <span>"Large (20 &lt; X &lt;= 100)"</span>, </span></code><code><span>             <span>"Medium (5 &lt; X &lt;= 20)"</span>, </span></code><code><span>             <span>"Small (1 &lt; X &lt;= 5)"</span>, </span></code><code><span>             <span>"Single (0 &lt; X &lt;= 1)"</span>, NA))</span></code><code><span><br></span></code><code><span>DimPlot(seurat, <span>group</span>.<span>by</span> = <span>"cloneType"</span>) +</span></code><code><span>  scale_color_manual(values = colorblind_vector(<span>5</span>), na.<span>value</span>=<span>"grey"</span>) + </span></code><code><span>  theme(plot.title = element_blank())</span></code></pre></section><p><img data-galleryid="" data-ratio="0.6894273127753304" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/e4qfpSBibv0CQ4uNUIfTvsT4oasUr4kQfoPC9rk50ibHhzmHoiblShpqjmJjjaib5OWGSmyyEFmxyNVkpAxKmd0ntQ/640?wx_fmt=png" data-type="png" data-w="908" src="https://mmbiz.qpic.cn/mmbiz_png/e4qfpSBibv0CQ4uNUIfTvsT4oasUr4kQfoPC9rk50ibHhzmHoiblShpqjmJjjaib5OWGSmyyEFmxyNVkpAxKmd0ntQ/640?wx_fmt=png"></p><p>（2）展示特定克隆亚型的分布规律<br></p><p>可以基于cloneCall参数设置基于哪个单位（aa, nt, gene, gene+nt）的克隆亚型；sequence参数设置具体的克隆亚型序列。<br></p><section><ul><li><li><li><li><li><li></ul><pre data-lang="cs"><code><span>seurat &lt;- highlightClonotypes(seurat, </span></code><code><span>                              cloneCall= <span>"aa"</span>, </span></code><code><span>                              sequence = c(<span>"CAVNGGSQGNLIF_CSAEREDTDTQYF"</span>, </span></code><code><span>                                           <span>"NA_CATSATLRVVAEKLFF"</span>))</span></code><code><span>DimPlot(seurat, <span>group</span>.<span>by</span> = <span>"highlight"</span>) + </span></code><code><span>  theme(plot.title = element_blank())</span></code></pre></section><p><img data-galleryid="" data-ratio="0.6784140969162996" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/e4qfpSBibv0CQ4uNUIfTvsT4oasUr4kQfRgNRBqmv55ewPywE3WpKbOneloMXaREoQSIOkBec1mtdR3Nbpy3Aew/640?wx_fmt=png" data-type="png" data-w="908" src="https://mmbiz.qpic.cn/mmbiz_png/e4qfpSBibv0CQ4uNUIfTvsT4oasUr4kQfRgNRBqmv55ewPywE3WpKbOneloMXaREoQSIOkBec1mtdR3Nbpy3Aew/640?wx_fmt=png"></p><p>（3）不同分组（或样本，或细胞群体）中克隆亚型的比例或绝对数量</p><p>基于<span>occupiedscRep</span><span>ertoire()</span>函数，借助 x.axis 参数指定 Seurat对象中 meta 属性的列名，proportion参数设置克隆亚型的比例或绝对数量，label参数设置是否展示数值，进一步统计不同 x.axis 中的克隆亚型的细胞数量。<br></p><section><ul><li><li><li></ul><pre data-lang="nginx"><code><span><span>p1</span> &lt;- occupiedscRepertoire(seurat, x.axis = <span>"ident"</span>)</span></code><code><span>p2 &lt;- occupiedscRepertoire(seurat, x.axis = <span>"Patient"</span>)</span></code><code><span>p1 + p2</span></code></pre></section><p><img data-galleryid="" data-ratio="0.7015590200445434" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/e4qfpSBibv0CQ4uNUIfTvsT4oasUr4kQfboibO0hTARAavIBTEqn9IoZ2kIGM76F2PibtzpyoVcWHRn9JsDYF4iayA/640?wx_fmt=png" data-type="png" data-w="898" src="https://mmbiz.qpic.cn/mmbiz_png/e4qfpSBibv0CQ4uNUIfTvsT4oasUr4kQfboibO0hTARAavIBTEqn9IoZ2kIGM76F2PibtzpyoVcWHRn9JsDYF4iayA/640?wx_fmt=png"></p><p>（4）不同样本分组情况下，克隆亚型的变化规律<br></p><p>我们可以基于Seurat对象的meta属性，借助alluvialClonotypes()函数查看多个类别的克隆类型的变化规律。为了加快速度，我们实际上在使用alluvialClonotypes()之前将seurat对象子集化。</p><section><ul><li><li><li><li><li><li><li><li><li></ul><pre data-lang="swift"><code><span>alluvialClonotypes(</span></code><code><span>   seurat, cloneCall = <span>"gene"</span>, </span></code><code><span>   # <span>The</span> columns that will separate the proportional visualizations.</span></code><code><span>   y.axes = <span>c</span>(<span>"Patient"</span>, <span>"ident"</span>, <span>"Type"</span>), </span></code><code><span>   # <span>The</span> column header or clonotype(s) to be highlighted.</span></code><code><span>   # color 设置要高亮的特定克隆亚型或者<span>Seurat</span>对象中的meta属性的不同</span></code><code><span>   # 取值（列名）</span></code><code><span>   color = <span>"TRAV12-2.TRAJ42.TRAC_TRBV20-1.TRBD2.TRBJ2-3.TRBC2"</span>) + </span></code><code><span> scale_fill_manual(values = <span>c</span>(<span>"grey"</span>, colorblind_vector(<span>2</span>)[<span>2</span>]))</span></code></pre></section><p><img data-galleryid="" data-ratio="0.713495575221239" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/e4qfpSBibv0CQ4uNUIfTvsT4oasUr4kQfDib9R7EatNY769hkWDC1ic19svCFbRCuicfHQlL9TKbD5wfuP4vBnh8ZA/640?wx_fmt=png" data-type="png" data-w="904" src="https://mmbiz.qpic.cn/mmbiz_png/e4qfpSBibv0CQ4uNUIfTvsT4oasUr4kQfDib9R7EatNY769hkWDC1ic19svCFbRCuicfHQlL9TKbD5wfuP4vBnh8ZA/640?wx_fmt=png"></p><section><ul><li><li><li><li></ul><pre data-lang="swift"><code><span># 基于 meta 属性中的 ident 列</span></code><code><span>alluvialClonotypes(seurat, cloneCall = <span>"gene"</span>, </span></code><code><span>                   y.axes = <span>c</span>(<span>"Patient"</span>, <span>"ident"</span>, <span>"Type"</span>), </span></code><code><span>                   color = <span>"ident"</span>)</span></code></pre></section><p><img data-galleryid="" data-ratio="0.7034178610804851" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/e4qfpSBibv0CQ4uNUIfTvsT4oasUr4kQfXm11n2D6bfBCRic9WjovtV2BvxpibJ1x0eibjayLyPRxwkN0OD3icMNtAQ/640?wx_fmt=png" data-type="png" data-w="907" src="https://mmbiz.qpic.cn/mmbiz_png/e4qfpSBibv0CQ4uNUIfTvsT4oasUr4kQfXm11n2D6bfBCRic9WjovtV2BvxpibJ1x0eibjayLyPRxwkN0OD3icMNtAQ/640?wx_fmt=png"></p><p>（5）基于弦图的不同分组之间的克隆亚型的变化规律<br></p><p>我们基于Seurat对象中的meta属性的列名，借助getCirclize()函数和chordDiagram()函数，展示不同组（样本）中的克隆亚型的变化。</p><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="ruby"><code><span>library(circlize)</span></code><code><span>library(scales)</span></code><code><span><br></span></code><code><span>circles &lt;- getCirclize(seurat, </span></code><code><span>                       group.by = <span>"ident"</span>)</span></code><code><span><br></span></code><code><span><span>#Just assigning the normal colors to each cluster</span></span></code><code><span>grid.cols &lt;- scales::hue_pal()(length(unique(seurat@active.ident)))</span></code><code><span>names(grid.cols) &lt;- levels(seurat@active.ident)</span></code><code><span><br></span></code><code><span><span>#Graphing the chord diagram</span></span></code><code><span>circlize::chordDiagram(circles,</span></code><code><span>                       <span>self</span>.link = <span>1</span>, </span></code><code><span>                       grid.col = grid.cols)</span></code></pre></section><p><img data-galleryid="" data-ratio="0.8611111111111112" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/e4qfpSBibv0CQ4uNUIfTvsT4oasUr4kQfwooqdibv4u7hcdbd857a6X1UKG4m6RQsRC6UNfnpMGTuRHoiaKoibJ4PQ/640?wx_fmt=png" data-type="png" data-w="684" src="https://mmbiz.qpic.cn/mmbiz_png/e4qfpSBibv0CQ4uNUIfTvsT4oasUr4kQfwooqdibv4u7hcdbd857a6X1UKG4m6RQsRC6UNfnpMGTuRHoiaKoibJ4PQ/640?wx_fmt=png"></p><section><ul><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="apache"><code><span><span># 仅展示肿瘤特异性的克隆亚型的变化</span></span></code><code><span><span>subset</span> &lt;- subset(seurat, Type == <span>"T"</span>)</span></code><code><span><br></span></code><code><span><span>circles</span> &lt;- getCirclize(subset, group.by = <span>"ident"</span>)</span></code><code><span><br></span></code><code><span><span>grid</span>.cols &lt;- scales::hue_pal()(length(unique(subset@active.ident)))</span></code><code><span><span>names</span>(grid.cols) &lt;- levels(subset@active.ident)</span></code><code><span><br></span></code><code><span><span>chordDiagram</span>(circles, self.link = 1, </span></code><code><span>             <span>grid</span>.col = grid.cols, directional = 1, </span></code><code><span>             <span>direction</span>.type =  <span>"arrows"</span>,</span></code><code><span>             <span>link</span>.arr.type = <span>"big.arrow"</span>)</span></code></pre></section><p><img data-galleryid="" data-ratio="0.8947368421052632" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/e4qfpSBibv0CQ4uNUIfTvsT4oasUr4kQfbj6qD8f6Ce56JkXYWBNpDGPiaGjqlAMs3QYIyDeyfE4ItfQibBicjicjeA/640?wx_fmt=png" data-type="png" data-w="703" src="https://mmbiz.qpic.cn/mmbiz_png/e4qfpSBibv0CQ4uNUIfTvsT4oasUr4kQfbj6qD8f6Ce56JkXYWBNpDGPiaGjqlAMs3QYIyDeyfE4ItfQibBicjicjeA/640?wx_fmt=png"></p><p>（6）具有不同功能和克隆性的T细胞亚群之间的动态关系</p><p>综合STARTRAC分析为全面剖析癌证中的T细胞特性提供了一种强大的方法，并可以为其他癌症中T细胞的动态关系提供见解。STARTRAC定义了描述T细胞动力学的四个指标（如下：<span>https://doi.org/10.1038/s41586-018-0694-x</span>）。</p><p><img data-galleryid="" data-ratio="0.4824654622741764" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/e4qfpSBibv0BrLq7ZVocaRfQJtbCA1Chz6ktsz9YZIE8y1CVDlQys4t7jsGs2TxPiadXicDvVFqD4rAq651r72LWQ/640?wx_fmt=png" data-type="png" data-w="941" src="https://mmbiz.qpic.cn/mmbiz_png/e4qfpSBibv0BrLq7ZVocaRfQJtbCA1Chz6ktsz9YZIE8y1CVDlQys4t7jsGs2TxPiadXicDvVFqD4rAq651r72LWQ/640?wx_fmt=png"></p><p>Tissue distribution：STARTRAC-dist，通过观察到的细胞数量与随机期望的比值(Ro/e)估计的簇的组织偏好（富集程度）；</p><p>Clonal expansion：STARTRAC-expa，簇的克隆扩展程度（可以表示为该克隆亚型的增殖性），定义为“1 -均匀度（evenness）”，均匀度（evenness）为其TCR分布的归一化香农熵;</p><p>Cross-tissue migration：STARTRAC-migr，一个克隆簇的迁移潜力，通过其跨组织克隆型的平均熵估计；</p><p>State transition：STARTRAC-tran，一个克隆簇的发育转变潜力（推测发育轨迹），由两个不同功能簇的克隆型的平均熵估计。</p><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="kotlin"><code><span># Usage</span></code><code><span>StartracDiversity(</span></code><code><span>  sc,</span></code><code><span>  type = <span>"Type"</span>,</span></code><code><span>  sample = NULL,</span></code><code><span>  <span>by</span> = <span>"overall"</span>,</span></code><code><span>  exportTable = FALSE</span></code><code><span>)</span></code><code><span># Arguments</span></code><code><span># 经combineExpression()转化后的seurat或SCE对象。</span></code><code><span># 对于SCE对象，集群变量必须在“cluster”下的元数据中。</span></code><code><span>sc: The seurat or SCE <span>object</span> to visualize after combineExpression(). For SCE objects, the cluster variable must be <span>in</span> the meta <span>data</span> under <span>"cluster"</span>.</span></code><code><span># Seurat对象的meta属性（元数据）中的列标题给出细胞的来源，</span></code><code><span># 而不是患者样本id</span></code><code><span>type: The column header <span>in</span> the meta <span>data</span> that gives the <span>where</span> the cells were derived from, not the patient sample IDs</span></code><code><span># Seurat对象的meta属性（元数据）中对应个体样本或患者的列标题。</span></code><code><span>sample: The column header corresponding to individual samples or patients.</span></code><code><span># 按总体(所有样本)或按特定组进行指定子集的分析方法</span></code><code><span><span>by</span>: Method to subset the indices <span>by</span> either overall (across all samples) or <span>by</span> specific group</span></code><code><span># 导出可视化时的表格</span></code><code><span>exportTable: Returns the <span>data</span> frame used <span>for</span> forming the graph</span></code></pre></section><section><ul><li><li><li><li></ul><pre data-lang="bash"><code><span>StartracDiversity(seurat, </span></code><code><span>                  <span>type</span> = <span>"Type"</span>, </span></code><code><span>                  sample = <span>"Patient"</span>, </span></code><code><span>                  by = <span>"overall"</span>)</span></code></pre></section><p><img data-galleryid="" data-ratio="0.5689277899343544" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/e4qfpSBibv0BrLq7ZVocaRfQJtbCA1Chzlq0hf6NkV0DmYHEGN8nMowxrvMSCEZdcxpziaj43o8TcowHvpGboyzQ/640?wx_fmt=png" data-type="png" data-w="914" src="https://mmbiz.qpic.cn/mmbiz_png/e4qfpSBibv0BrLq7ZVocaRfQJtbCA1Chzlq0hf6NkV0DmYHEGN8nMowxrvMSCEZdcxpziaj43o8TcowHvpGboyzQ/640?wx_fmt=png"></p><p>（7）不同细胞亚群的克隆多样性分析<br></p><p>对于那些希望能够更好地使用Seurat对象中的元数据来执行scRepertoire提供的分析的用户，还可以选择使用expressionlist()函数，该函数将接受元数据并按集群将数据输出为列表。</p><section><ul><li><li><li></ul><pre data-lang="perl"><code><span>combined2 &lt;- expression2List(seurat, </span></code><code><span>                             <span>split</span>.by = <span>"ident"</span>)</span></code><code><span><span>length</span>(combined2) <span>#now listed by cluster</span></span></code></pre></section><section><ul><li><li></ul><pre data-lang="shell"><code><span><span>&gt;</span> length(combined2) <span>#now listed by cluster</span></span></code><code><span>[1] 18</span></code></pre></section><p>（a）计算不同细胞群体的克隆多样性：<br></p><section><ul><li><li></ul><pre data-lang="javascript"><code><span>clonalDiversity(combined2, </span></code><code><span>                cloneCall = <span>"nt"</span>)</span></code></pre></section><p> 或者</p><section><ul><li><li><li></ul><pre data-lang="cs"><code><span>clonalDiversity(seurat, </span></code><code><span>                split.<span>by</span> = <span>"ident"</span>, </span></code><code><span>                cloneCall = <span>"nt"</span>)</span></code></pre></section><p><img data-galleryid="" data-ratio="0.5670665212649946" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/e4qfpSBibv0BrLq7ZVocaRfQJtbCA1ChzJj9LSSriabbrOxAib3Y1q8GQzcSLHAZF2UuGytc4A8IGEMhRwvK5P1QA/640?wx_fmt=png" data-type="png" data-w="917" src="https://mmbiz.qpic.cn/mmbiz_png/e4qfpSBibv0BrLq7ZVocaRfQJtbCA1ChzJj9LSSriabbrOxAib3Y1q8GQzcSLHAZF2UuGytc4A8IGEMhRwvK5P1QA/640?wx_fmt=png"></p><p>（b）不同细胞群体中克隆亚型的比例<br></p><section><ul><li><li><li><li><li></ul><pre data-lang="properties"><code><span><span>p2</span> <span>&lt;- clonalHomeostasis(combined2, </span></span></code><code><span>                        <span>cloneCall</span> = <span>"nt")</span></span></code><code><span><span>p3</span> <span>&lt;- clonalProportion(combined2, </span></span></code><code><span>                       <span>cloneCall</span> = <span>"nt")</span></span></code><code><span><span>p2</span> <span>+ p3</span></span></code></pre></section><p><img data-galleryid="" data-ratio="0.5570321151716501" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/e4qfpSBibv0BrLq7ZVocaRfQJtbCA1ChzoBwjRKzpyzOgAvUNRAqlvW8JBv1S0TG20Wg4hXGsg6u7X1xxEpaqLA/640?wx_fmt=png" data-type="png" data-w="903" src="https://mmbiz.qpic.cn/mmbiz_png/e4qfpSBibv0BrLq7ZVocaRfQJtbCA1ChzoBwjRKzpyzOgAvUNRAqlvW8JBv1S0TG20Wg4hXGsg6u7X1xxEpaqLA/640?wx_fmt=png"></p><p>（c）不同细胞群体的克隆亚型的重叠分析<br></p><section><ul><li><li><li></ul><pre data-lang="javascript"><code><span>clonalOverlap(combined2, </span></code><code><span>              cloneCall=<span>"aa"</span>, </span></code><code><span>              method=<span>"overlap"</span>)</span></code></pre></section><p><img data-galleryid="" data-ratio="0.57" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/e4qfpSBibv0BrLq7ZVocaRfQJtbCA1Chzlgbibu3AXszrC5MvWTpBqlr4SiadsbHvhicgXFUngh7MA7FNc8G2L3oicg/640?wx_fmt=png" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/e4qfpSBibv0BrLq7ZVocaRfQJtbCA1Chzlgbibu3AXszrC5MvWTpBqlr4SiadsbHvhicgXFUngh7MA7FNc8G2L3oicg/640?wx_fmt=png"></p><p><br></p><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/uZthPEXq58p87W8JoJ2BZA",target="_blank" rel="noopener noreferrer">原文链接</a>
