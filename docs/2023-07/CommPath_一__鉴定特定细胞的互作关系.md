---
title: "CommPath（一）：鉴定特定细胞的互作关系"
date: 2023-07-05T03:05:39Z
draft: ["false"]
tags: [
  "fetched",
  "生信宝库"
]
categories: ["Acdemic"]
---
CommPath（一）：鉴定特定细胞的互作关系 by 生信宝库
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><h2 data-tool="mdnice编辑器"><span></span><span>前言</span></h2><p data-tool="mdnice编辑器">Immugent在前一期推文：<a href="https://mp.weixin.qq.com/s?__biz=MzI4MjY5ODI1Nw==&amp;mid=2247488387&amp;idx=1&amp;sn=c8bdef66616b1bbfc652ac94a30048e0&amp;chksm=eb94a4fddce32debaebfeb2cf7678b02709f14cf2e759b672168aeff6802def8b200b06ce6e9&amp;token=1258729581&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">CommPath:细胞通讯分析的百宝箱</a>中，已经介绍了CommPath包的基本功能框架，并且对比了CommPath和其它用于细胞通讯分析软件的对比。那么从本期推文开始，Immugent就将通过代码实操的方式来介绍CommPath包的使用技巧。</p><p data-tool="mdnice编辑器">在使用CommPath包之前，我们需要准备相应的输入文件，一般是选择高变基因的表达矩阵和细胞注释信息作为输入。为了方便大家复现，Immugent在教程中使用的数据均是同一套模拟数据。</p><p data-tool="mdnice编辑器"><br></p><hr data-tool="mdnice编辑器"><h2 data-tool="mdnice编辑器"><span></span><span>代码流程</span></h2><p data-tool="mdnice编辑器">第一步，安装CommPath包和导入数据。</p><pre data-tool="mdnice编辑器"><code>devtools::install_github(<span>"yingyonghui/CommPath"</span>)<br>library(CommPath)<br><br><span># load(url("https://figshare.com/ndownloader/files/35185522"))</span><br>load(<span>"path_to_download/HCC.tumor.3k.RData"</span>)<br></code></pre><p data-tool="mdnice编辑器">第二步，创建CommPath对象，鉴定差异信号</p><pre data-tool="mdnice编辑器"><code>tumor.obj &lt;- createCommPath(expr.mat = tumor.expr, <br>  cell.info = tumor.label, <br>  species = <span>"hsapiens"</span>)<br>    <br>tumor.obj &lt;- findLRmarker(object = tumor.obj, method = <span>"wilcox.test"</span>)<br><br><span># To find significant LR pairs</span><br>tumor.obj &lt;- findLRpairs(object = tumor.obj,<br>  logFC.thre = 0, <br>  p.thre = 0.01)<br></code></pre><p data-tool="mdnice编辑器">第三步，可视化。</p><pre data-tool="mdnice编辑器"><code><span># To show the counts of LR associations among all clusters</span><br><span># Here we set the parameter "filter" as FALSE, which means that those LR interactions are identified only based on their expression profiles, not filtered by pathways in the receiver cells (as described in the later sections)</span><br>pdf(<span>'circosPlot.count.nonfiltered.pdf'</span>,height=6,width=6)<br>circosPlot(object = tumor.obj, filter=FALSE)<br>dev.off()<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="1" data-src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7fqurJlesYDPlsbsAO5gllKIGRXCH6h8wkkPscXic7PdpXvBaUICWUuTibQ2IPFzMJBR07aqDl9MwkA/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7fqurJlesYDPlsbsAO5gllKIGRXCH6h8wkkPscXic7PdpXvBaUICWUuTibQ2IPFzMJBR07aqDl9MwkA/640?wx_fmt=png"></figure><pre data-tool="mdnice编辑器"><code><span># To show the overall interaction intensity of LR interactions among all clusters</span><br>pdf(<span>'circosPlot.intensity.nonfiltered.pdf'</span>,height=6,width=6)<br>circosPlot(object = tumor.obj, plot=<span>"intensity"</span>, filter=FALSE)<br>dev.off()<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="1.0018518518518518" data-src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7fqurJlesYDPlsbsAO5gllKicvQldyjEDsQ0tm04qngWxdictL9Vyw5kicv52rniaUD1S82vFY305AYOQ/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7fqurJlesYDPlsbsAO5gllKicvQldyjEDsQ0tm04qngWxdictL9Vyw5kicv52rniaUD1S82vFY305AYOQ/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">展示特殊细胞类型的信号。</p><pre data-tool="mdnice编辑器"><code>select.ident = <span>'Endothelial'</span><br>pdf(<span>'circosPlot.Endothelial.count.filtered.pdf'</span>,height=6,width=6)<br>circosPlot(object = tumor.obj, select.ident = select.ident, filter=TRUE)<br>dev.off()<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.9981481481481481" data-src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7fqurJlesYDPlsbsAO5gllKr55DsrqNOIm0j7pghSqeibjeicuyyxQtGBU791SKHgdhrTlU7jwDdHHw/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7fqurJlesYDPlsbsAO5gllKr55DsrqNOIm0j7pghSqeibjeicuyyxQtGBU791SKHgdhrTlU7jwDdHHw/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">展示特殊的细胞信号。</p><pre data-tool="mdnice编辑器"><code><span># To find upstream clusters and ligands for the selected cluster and receptor </span><br>select.ident = <span>"Endothelial"</span><br>select.receptor = <span>"ACKR1"</span><br><br>ident.up.dat &lt;- findLigand(object = tumor.obj, <br>    select.ident = select.ident, <br>    select.receptor = select.receptor)<br>head(ident.up.dat)<br><br><span># To find downstream clusters and receptors for the selected cluster and ligand </span><br>select.ident = <span>"Endothelial"</span><br>select.ligand = <span>"CXCL12"</span><br><br>ident.down.dat &lt;- findReceptor(object = tumor.obj, <br>    select.ident = select.ident, <br>    select.ligand = select.ligand)<br>head(ident.down.dat)<br></code></pre><pre data-tool="mdnice编辑器"><code><span># To investigate the upstream clusters which release ligands to the selected cluster</span><br>pdf(<span>'dotPlot.ligand.Endothelial.pdf'</span>,height=5,width=10)<br>dotPlot.LR(object = tumor.obj, receptor.ident = select.ident)<br>dev.off()<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.5" data-src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7fqurJlesYDPlsbsAO5gllKxex3ibORl74qAftEGVnEicIvTQibkHNbhhtYuwuoAy6nkzSz8qYpUhiblw/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7fqurJlesYDPlsbsAO5gllKxex3ibORl74qAftEGVnEicIvTQibkHNbhhtYuwuoAy6nkzSz8qYpUhiblw/640?wx_fmt=png"></figure><pre data-tool="mdnice编辑器"><code><span># To investigate the downstream clusters which express receptors for the selected cluster</span><br>pdf(<span>'dotPlot.receptor.Endothelial.pdf'</span>,height=5,width=10.5)<br>dotPlot.LR(object = tumor.obj, ligand.ident = select.ident)<br>dev.off()<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.4759259259259259" data-src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7fqurJlesYDPlsbsAO5gllK3d2ZRLfA3AFsfk8ecG5lBic4ZiaOxckkhZWycghniaIAO88Wf0omRI2TQ/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7fqurJlesYDPlsbsAO5gllK3d2ZRLfA3AFsfk8ecG5lBic4ZiaOxckkhZWycghniaIAO88Wf0omRI2TQ/640?wx_fmt=png"></figure><hr data-tool="mdnice编辑器"><h2 data-tool="mdnice编辑器"><span></span><span>说在最后</span></h2><p data-tool="mdnice编辑器">生物信息学作为目前在生命科学领域最活跃的领域之一，为我们提供了不断迭代更新的强大工具。从上面的分析结果，我们就可以看出CommPath包对之前细胞通讯分析存在的问题进行了优化。这包括在计算差异信号通路，以及差异通路的个性化展示上均有所体现。当然，本期内容只是对CommPath包最基础的功能进行展示，后续还会介绍如何将这些通路和功能通路相关联。</p><p data-tool="mdnice编辑器">好啦，本期分享到这里就结束了，我们下期再会~~</p><p data-tool="mdnice编辑器"><br></p><hr data-tool="mdnice编辑器"></section><p><img data-ratio="1" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/GL6g5Y3aR7eUr3zZytdDPl7kPJBscWxTDlwbSxRjmMoYpSCSmlGicFibnLH3pvictSibFwekOaooibv9Ria0zSCrC2icg/640?wx_fmt=jpeg" data-type="jpeg" data-w="344" src="https://mmbiz.qpic.cn/mmbiz_jpg/GL6g5Y3aR7eUr3zZytdDPl7kPJBscWxTDlwbSxRjmMoYpSCSmlGicFibnLH3pvictSibFwekOaooibv9Ria0zSCrC2icg/640?wx_fmt=jpeg"></p><h3 data-tool="mdnice编辑器"><span>关注下方公众号下回更新不迷路</span></h3><section><br></section><section><mp-common-profile data-pluginname="mpprofile" data-weui-theme="light" data-id="MzI4MjY5ODI1Nw==" data-headimg="http://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7f0yanILMQZCnw1duTMROQRvgDqVjlYcrljTRy1E4ZLppLG6zicdd3h0IwjLpxnum1V5KsowibJM1sw/0?wx_fmt=png" data-nickname="生信宝库" data-alias="sxbk2020" data-signature="本公众号只用于生信知识的收集与传播，以及生信人之间互相交流和学习，不会涉及任何商业利益。本公众号各小编平时忙于科研，更新文章较其它同类型公众号较慢，但保持宁缺毋滥的本心，只更新对大家有用的推文。" data-from="2" data-is_biz_ban="0"></mp-common-profile></section><p><br></p><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/qz4SyDTNJDiMLTNs_ecSpw",target="_blank" rel="noopener noreferrer">原文链接</a>
