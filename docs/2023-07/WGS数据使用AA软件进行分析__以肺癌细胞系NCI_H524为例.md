---
title: "WGS数据使用AA软件进行分析--以肺癌细胞系NCI-H524为例"
date: 2023-07-26T22:53:30Z
draft: ["false"]
tags: [
  "fetched",
  "东林的扯淡小屋"
]
categories: ["Acdemic"]
---
WGS数据使用AA软件进行分析--以肺癌细胞系NCI-H524为例 by 东林的扯淡小屋
------
<div><p><img data-galleryid="" data-ratio="0.5675925925925925" data-s="300,640" data-type="png" data-w="1080" data-src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBpZSgkQBrKuhaBH1BFAWeK6OLjRVJpr5fCZF27IXtGfN2Vl5nV8icAv7GnSclcxBc95GGkxcRw8F9A/640?wx_fmt=png" src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBpZSgkQBrKuhaBH1BFAWeK6OLjRVJpr5fCZF27IXtGfN2Vl5nV8icAv7GnSclcxBc95GGkxcRw8F9A/640?wx_fmt=png"></p><p><img data-galleryid="" data-ratio="0.5675925925925925" data-s="300,640" data-type="png" data-w="1080" data-src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBpZSgkQBrKuhaBH1BFAWeK6I8CpOo1wf6Vf1TcicFaCO69ULqJs8jeeDOZXm4dlDkeib1zOTeQXzxXQ/640?wx_fmt=png" src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBpZSgkQBrKuhaBH1BFAWeK6I8CpOo1wf6Vf1TcicFaCO69ULqJs8jeeDOZXm4dlDkeib1zOTeQXzxXQ/640?wx_fmt=png"></p><p><img data-galleryid="" data-ratio="0.5675925925925925" data-s="300,640" data-type="png" data-w="1080" data-src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBpZSgkQBrKuhaBH1BFAWeK6ZngW2DhCXOpuDApeafZuOZBCrqzRRTtdBibjMrw3evY6GvyzdEWfbUA/640?wx_fmt=png" src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBpZSgkQBrKuhaBH1BFAWeK6ZngW2DhCXOpuDApeafZuOZBCrqzRRTtdBibjMrw3evY6GvyzdEWfbUA/640?wx_fmt=png"></p><p>#下载数据<br></p><section><ul><li><li></ul><pre data-lang="swift"><code><span>wget -<span>c</span> https:<span>//sra-pub-run-odp.s3.amazonaws.com/sra/SRR8670694/SRR8670694</span></span></code><code><span>fastq-<span>dump</span> --<span>split</span>-files --gzip <span>SRR8670694</span>.sra</span></code></pre></section><p><img data-ratio="0.1537037037037037" data-type="png" data-w="1080" data-src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBpZSgkQBrKuhaBH1BFAWeK6xmYcQUH6vTzHjtic4euNGliaGLPNiaUniaxyQekcclp61ibFzQULyKabawQ/640?wx_fmt=png" src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBpZSgkQBrKuhaBH1BFAWeK6xmYcQUH6vTzHjtic4euNGliaGLPNiaUniaxyQekcclp61ibFzQULyKabawQ/640?wx_fmt=png"></p><p><img data-ratio="0.4994511525795829" data-type="png" data-w="911" data-src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBpZSgkQBrKuhaBH1BFAWeK6aeKfPenISxrTYJECGYNxLGx9I3pRgetKbicumHtmCWBH68JudXH5y6A/640?wx_fmt=png" src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBpZSgkQBrKuhaBH1BFAWeK6aeKfPenISxrTYJECGYNxLGx9I3pRgetKbicumHtmCWBH68JudXH5y6A/640?wx_fmt=png"></p><p>#数据过滤</p><section><ul><li><li><li></ul><pre data-lang="properties"><code><span><span>conda activate rnaseq</span></span></code><code><span><br></span></code><code><span><span>trim_galore -q 25 --phred33 --length 36 --paired  -j 70 SRR8670694_1.fastq.gz SRR8670694_2.fastq.gz  -o ./clean</span></span></code></pre></section><p><img data-ratio="0.3416666666666667" data-type="png" data-w="1080" data-src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBpZSgkQBrKuhaBH1BFAWeK6ctesSOqibztRSdkUHzN7PCpfYPzJHk8yM5nSB11tTK6Zdzrgqm7LACQ/640?wx_fmt=png" src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBpZSgkQBrKuhaBH1BFAWeK6ctesSOqibztRSdkUHzN7PCpfYPzJHk8yM5nSB11tTK6Zdzrgqm7LACQ/640?wx_fmt=png"></p><section><ul><li><li><li><li></ul><pre data-lang="properties"><code><span><span>conda</span> <span>activate WGS</span></span></code><code><span><span>#成功运行：</span></span></code><code><span><span>python</span> <span>/data/yudonglin/software/AmpliconArchitect/AmpliconSuite-pipeline/PrepareAA.py -s SRR8670694_sample  -t 60 --cnvkit_dir /home/yudonglin/miniconda3/envs/WGS/bin/cnvkit.py --fastqs SRR8670694_1_val_1.fq.gz SRR8670694_2_val_2.fq.gz --ref hg38 --run_AA</span></span></code><code><span><br></span></code></pre></section><p><img data-galleryid="" data-ratio="0.5953703703703703" data-s="300,640" data-type="png" data-w="1080" data-src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBpZSgkQBrKuhaBH1BFAWeK6X2uwf4C0ogKdiah0wWMB3H8ib3icWa3DWfqO6K86ECehK14E8Cfd1YsEQ/640?wx_fmt=png" src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBpZSgkQBrKuhaBH1BFAWeK6X2uwf4C0ogKdiah0wWMB3H8ib3icWa3DWfqO6K86ECehK14E8Cfd1YsEQ/640?wx_fmt=png"></p><p><span>2023-07-23 05:03:14.697320</span></p><p><span>PrepareAA version 0.1203.13</span></p><p><span><br></span></p><p><span>Running PrepareAA on sample: SRR8670694_sample</span></p><p><span>Running pipeline on SRR8670694_1_val_1.fq.gz SRR8670694_2_val_2.fq.gz</span></p><p><span>/data3/yudonglin/A549-3/clean/SRR8670694_sample</span></p><p><span>Checking for ref index</span></p><p><span><br></span></p><p><span>Performing alignment and sorting</span></p><p><span>{ bwa mem -K 10000000 -t 60 /data/yudonglin/software/AmpliconArchitect/data_repo/GRCh38/GCA_000001405.15_GRCh38_no_alt_analysis_set.fa SRR8670694_1_val_1.fq.gz SRR8670694_2_val_2.fq.gz | samtools view -Shu - | samtools sort -m 4G -@4 -o /data3/yudonglin/A549-3/clean/SRR8670694_sample.cs.bam -; } 2&gt;/data3/yudonglin/A549-3/clean/SRR8670694_sample_aln_stage.stderr</span></p><p><span><br></span></p><p><span>Performing duplicate removal &amp; indexing</span></p><p><span>samtools rmdup -s /data3/yudonglin/A549-3/clean/SRR8670694_sample.cs.bam /data3/yudonglin/A549-3/clean/SRR8670694_sample.cs.rmdup.bam</span></p><p><span>samtools: /home/yudonglin/miniconda3/envs/WGS/bin/../lib/libtinfow.so.6: no version information available (required by samtools)</span></p><p><span>samtools: /home/yudonglin/miniconda3/envs/WGS/bin/../lib/libncursesw.so.6: no version information available (required by samtools)</span></p><p><span>samtools: /home/yudonglin/miniconda3/envs/WGS/bin/../lib/libncursesw.so.6: no version information available (required by samtools)</span></p><p><span><br></span></p><p><span>Running samtools index</span></p><p><span>samtools index /data3/yudonglin/A549-3/clean/SRR8670694_sample.cs.rmdup.bam</span></p><p><span>samtools: /home/yudonglin/miniconda3/envs/WGS/bin/../lib/libtinfow.so.6: no version information available (required by samtools)</span></p><p><span>samtools: /home/yudonglin/miniconda3/envs/WGS/bin/../lib/libncursesw.so.6: no version information available (required by samtools)</span></p><p><span>samtools: /home/yudonglin/miniconda3/envs/WGS/bin/../lib/libncursesw.so.6: no version information available (required by samtools)</span></p><p><span>Removing temp BAM</span></p><p><span>samtools: /home/yudonglin/miniconda3/envs/WGS/bin/../lib/libtinfow.so.6: no version information available (required by samtools)</span></p><p><span>samtools: /home/yudonglin/miniconda3/envs/WGS/bin/../lib/libncursesw.so.6: no version information available (required by samtools)</span></p><p><span>samtools: /home/yudonglin/miniconda3/envs/WGS/bin/../lib/libncursesw.so.6: no version information available (required by samtools)</span></p><p><span>/data3/yudonglin/A549-3/clean/SRR8670694_sample.cs.rmdup.bam: 1022810262 + 0 properly paired (88.22% : N/A)</span></p><p><span>WARNING: BAM FILE PROPERLY PAIRED RATE IS BELOW 95%.</span></p><p><span>Quality of data may be insufficient for AA analysis. Poorly controlled insert size distribution during sample prep can cause high fractions of read pairs to be marked as discordant during alignment. Artifactual short SVs and long runtimes may occur!</span></p><p><span><br></span></p><p><span><br></span></p><p><span>Running CNVKit batch</span></p><p><span>python3 /home/yudonglin/miniconda3/envs/WGS/bin/cnvkit.py batch -m wgs -r /data/yudonglin/software/AmpliconArchitect/data_repo/GRCh38/GRCh38_cnvkit_filtered_ref.cnn -p 60 -d /data3/yudonglin/A549-3/clean/SRR8670694_sample_cnvkit_output/ /data3/yudonglin/A549-3/clean/SRR8670694_sample.cs.rmdup.bam</span></p><p><span>CNVkit 0.9.10.dev0</span></p><p><span>Wrote /data3/yudonglin/A549-3/clean/SRR8670694_sample_cnvkit_output/GRCh38_cnvkit_filtered_ref.target-tmp.bed with 568558 regions</span></p><p><span>Wrote /data3/yudonglin/A549-3/clean/SRR8670694_sample_cnvkit_output/GRCh38_cnvkit_filtered_ref.antitarget-tmp.bed with 0 regions</span></p><p><span>Running 1 samples in 60 processes (that's 60 processes per bam)</span></p><p><span>Running the CNVkit pipeline on /data3/yudonglin/A549-3/clean/SRR8670694_sample.cs.rmdup.bam ...</span></p><p><span>Processing reads in SRR8670694_sample.cs.rmdup.bam</span></p><p><span>Time: 216.363 seconds (6943300 reads/sec, 2628 bins/sec)</span></p><p><span>Summary: #bins=568558, #reads=1502274039, mean=2642.2529, min=0.0, max=606025.4705882353 </span></p><p><span>Percent reads in regions: 129.640 (of 1158804890 mapped)</span></p><p><span>Wrote /data3/yudonglin/A549-3/clean/SRR8670694_sample_cnvkit_output/SRR8670694_sample.cs.rmdup.targetcoverage.cnn with 568558 regions</span></p><p><span>Skip processing SRR8670694_sample.cs.rmdup.bam with empty regions file /data3/yudonglin/A549-3/clean/SRR8670694_sample_cnvkit_output/GRCh38_cnvkit_filtered_ref.antitarget-tmp.bed</span></p><p><span>Wrote /data3/yudonglin/A549-3/clean/SRR8670694_sample_cnvkit_output/SRR8670694_sample.cs.rmdup.antitargetcoverage.cnn with 0 regions</span></p><p><span>Processing target: SRR8670694_sample.cs.rmdup</span></p><p><span>Keeping 566505 of 568558 bins</span></p><p><span>Correcting for GC bias...</span></p><p><span>Processing antitarget: SRR8670694_sample.cs.rmdup</span></p><p><span>Wrote /data3/yudonglin/A549-3/clean/SRR8670694_sample_cnvkit_output/SRR8670694_sample.cs.rmdup.cnr with 566505 regions</span></p><p><span>Segmenting /data3/yudonglin/A549-3/clean/SRR8670694_sample_cnvkit_output/SRR8670694_sample.cs.rmdup.cnr ...</span></p><p><span>Segmenting with method 'cbs', significance threshold 1e-06, in 60 processes</span></p><p><span>Smoothing overshot at 1 / 19505 indices: (-1.321697573382838, 7.849425428882503) vs. original (-1.609781885385645, 7.817937509394677)</span></p><p><span>Smoothing overshot at 2 / 17667 indices: (-27.049602998688012, 1.9048589458504748) vs. original (-25.1983685108177, 2.1253636039981085)</span></p><p><span>Smoothing overshot at 11 / 7049 indices: (-26.288755393159832, 2.618149238619435) vs. original (-25.068497981035453, 1.9035427835484244)</span></p><p><span>Smoothing overshot at 6 / 7464 indices: (-27.171883912648997, 2.934957575643578) vs. original (-24.922008989382192, 2.2795211205607)</span></p><p><span>Smoothing overshot at 2 / 5172 indices: (-11.364506253155607, 1.1378445459701272) vs. original (-25.257363073869485, 1.038324612692872)</span></p><p><span>Smoothing overshot at 18 / 1974 indices: (-25.200136795298555, 0.5372737865749664) vs. original (-24.321409203916218, 1.090893821291573)</span></p><p><span>Smoothing overshot at 51 / 3151 indices: (-25.337007954954007, 0.5936791531093732) vs. original (-24.318305724090017, 1.1472571176966293)</span></p><p><span>Post-processing /data3/yudonglin/A549-3/clean/SRR8670694_sample_cnvkit_output/SRR8670694_sample.cs.rmdup.cns ...</span></p><p><span>Wrote /data3/yudonglin/A549-3/clean/SRR8670694_sample_cnvkit_output/SRR8670694_sample.cs.rmdup.cns with 828 regions</span></p><p><span>Applying filter 'ci'</span></p><p><span>Filtered by 'ci' from 828 to 246 rows</span></p><p><span>Calling copy number with thresholds: -1.1 =&gt; 0, -0.25 =&gt; 1, 0.2 =&gt; 2, 0.7 =&gt; 3</span></p><p><span>Wrote /data3/yudonglin/A549-3/clean/SRR8670694_sample_cnvkit_output/SRR8670694_sample.cs.rmdup.call.cns with 246 regions</span></p><p><span>Significant hits in 8316/566505 bins (1.47%)</span></p><p><span>Wrote /data3/yudonglin/A549-3/clean/SRR8670694_sample_cnvkit_output/SRR8670694_sample.cs.rmdup.bintest.cns with 8316 regions</span></p><p><span><br></span></p><p><span>Running CNVKit segment</span></p><p><span>python3 /home/yudonglin/miniconda3/envs/WGS/bin/cnvkit.py segment /data3/yudonglin/A549-3/clean/SRR8670694_sample_cnvkit_output/SRR8670694_sample.cs.rmdup.cnr  -p 60 -m cbs -o /data3/yudonglin/A549-3/clean/SRR8670694_sample_cnvkit_output/SRR8670694_sample.cs.rmdup.cns</span></p><p><span>Segmenting with method 'cbs', significance threshold 0.0001, in 60 processes</span></p><p><span>Smoothing overshot at 1 / 19505 indices: (-1.3216986799771169, 7.849427274274742) vs. original (-1.60978, 7.81794)</span></p><p><span>Smoothing overshot at 2 / 17667 indices: (-27.049587363116196, 1.9048587070968932) vs. original (-25.1984, 2.12536)</span></p><p><span>Smoothing overshot at 6 / 7464 indices: (-27.171875589582953, 2.934957572862511) vs. original (-24.922, 2.27952)</span></p><p><span>Smoothing overshot at 2 / 5172 indices: (-11.36452854288826, 1.137845722521361) vs. original (-25.2574, 1.03832)</span></p><p><span>Smoothing overshot at 11 / 7049 indices: (-26.288746304090807, 2.618151661749489) vs. original (-25.0685, 1.90354)</span></p><p><span>Smoothing overshot at 18 / 1974 indices: (-25.200134183129684, 0.5372743545007284) vs. original (-24.3214, 1.09089)</span></p><p><span>Smoothing overshot at 51 / 3151 indices: (-25.337024731855248, 0.5936791794311227) vs. original (-24.3183, 1.14726)</span></p><p><span>Wrote /data3/yudonglin/A549-3/clean/SRR8670694_sample_cnvkit_output/SRR8670694_sample.cs.rmdup.cns with 981 regions</span></p><p><span><br></span></p><p><span>Cleaning up temporary files</span></p><p><span>rm /data3/yudonglin/A549-3/clean/SRR8670694_sample_cnvkit_output//*tmp.bed /data3/yudonglin/A549-3/clean/SRR8670694_sample_cnvkit_output//*.cnn /data3/yudonglin/A549-3/clean/SRR8670694_sample_cnvkit_output//*target.bed</span></p><p><span>rm: cannot remove '/data3/yudonglin/A549-3/clean/SRR8670694_sample_cnvkit_output//*target.bed': No such file or directory</span></p><p><span>gzip -f /data3/yudonglin/A549-3/clean/SRR8670694_sample_cnvkit_output/SRR8670694_sample.cs.rmdup.cnr</span></p><p><span><br></span></p><p><span>Running amplified_intervals</span></p><p><span>python /data/yudonglin/software/AmpliconArchitect/src/amplified_intervals.py --ref GRCh38 --bed /data3/yudonglin/A549-3/clean//SRR8670694_sample.cs.rmdup_CNV_CALLS_pre_filtered.bed --bam /data3/yudonglin/A549-3/clean/SRR8670694_sample.cs.rmdup.bam --gain 4.5 --cnsize_min 50000 --out /data3/yudonglin/A549-3/clean/SRR8670694_sample_AA_CNV_SEEDS</span></p><p><span>Global ref name is GRCh38</span></p><p><span>read length: 96.11004886900893 insert size: 345.02664366910676 insert std dev: 51.59025753467995 max_insert: 499.7974162731466 percent proper: 0.909206083584083 num_sdevs 3</span></p><p><span>coverage stats (32.645319068895446, 34.472737693749586, 11.478340283610251, 33.526761233375204, 34.13671911103693, 15.171939492282174, 96.11004886900893, 345.02664366910676, 51.59025753467995, 190.2558710650669, 499.7974162731466, 4, 0.909206083584083, 3, 90789268091) 992</span></p><p><span>pair support 4</span></p><p><span>python /data/yudonglin/software/AmpliconArchitect/src/AmpliconArchitect.py --ref GRCh38 --downsample 10 --bed /data3/yudonglin/A549-3/clean/SRR8670694_sample_AA_CNV_SEEDS.bed --bam /data3/yudonglin/A549-3/clean/SRR8670694_sample.cs.rmdup.bam --runmode FULL --extendmode EXPLORE --insert_sdevs 3.0 --out /data3/yudonglin/A549-3/clean/SRR8670694_sample_AA_results//SRR8670694_sample</span></p><p><span>[root:INFO]	Commandline: /data/yudonglin/software/AmpliconArchitect/src/AmpliconArchitect.py --ref GRCh38 --downsample 10 --bed /data3/yudonglin/A549-3/clean/SRR8670694_sample_AA_CNV_SEEDS.bed --bam /data3/yudonglin/A549-3/clean/SRR8670694_sample.cs.rmdup.bam --runmode FULL --extendmode EXPLORE --insert_sdevs 3.0 --out /data3/yudonglin/A549-3/clean/SRR8670694_sample_AA_results//SRR8670694_sample </span></p><p><span>[root:INFO]	AmpliconArchitect version 1.3.r2</span></p><p><span><br></span></p><p><span>[root:INFO]	Python version 3.10.6 | packaged by conda-forge | (main, Aug 22 2022, 20:35:26) [GCC 10.4.0]</span></p><p><span><br></span></p><p><span>[root:INFO]	#TIME 0.195	Loading libraries and reference annotations for: GRCh38</span></p><p><span>Global ref name is GRCh38</span></p><p><span>[root:INFO]	#TIME 2.080	Initiating bam_to_breakpoint object for: /data3/yudonglin/A549-3/clean/SRR8670694_sample.cs.rmdup.bam</span></p><p><span>[root:INFO]	#TIME 2.080	Reusing cstats from /data/yudonglin/software/AmpliconArchitect/data_repo/coverage.stats</span></p><p><span>[root:INFO]	#TIME 2.081	Exploring interval: chr3	108875571	109295572</span></p><p><span>[root:INFO]	#TIME 69.616	 Calculating coverage meanshift segmentation</span></p><p><span>[root:INFO]	#TIME 153.884	 Detecting breakpoint edges (interval neighbors)</span></p><p><span>[root:INFO]	#TIME 168.124	 Selecting neighbors</span></p><p><span>[root:INFO]	#TIME 168.124	Exploring interval: chr8	125643827	126518820</span></p><p><span>[root:INFO]	#TIME 535.100	 Calculating coverage meanshift segmentation</span></p><p><span>[root:INFO]	#TIME 3988.971	 Detecting breakpoint edges (interval neighbors)</span></p><p><span>[root:INFO]	#TIME 18509.240	 Selecting neighbors</span></p><p><span>[root:INFO]	#TIME 18646.842	 New neighbor: chr3	111445238	111655737	158 (weight=158)</span></p><p><span>[root:INFO]	#TIME 18646.842	 New neighbor: chr8	120418251	120658750	1224 (weight=1224)</span></p><p><span>[root:INFO]	#TIME 18646.842	 New neighbor: chr8	126990680	127001179	8 (weight=8)</span></p><p><span>[root:INFO]	#TIME 18647.346	 New neighbor: chr8	127228812	127918806	1428 (weight=1428)</span></p><p><span>[root:INFO]	#TIME 18647.847	 Calculating coverage meanshift segmentation</span></p><p><span>[root:INFO]	#TIME 18706.512	 Detecting breakpoint edges (interval neighbors)</span></p><p><span>[root:INFO]	#TIME 19583.759	 Selecting neighbors</span></p><p><span>[root:INFO]	#TIME 19584.250	 Calculating coverage meanshift segmentation</span></p><p><span>[root:INFO]	#TIME 19596.280	 Detecting breakpoint edges (interval neighbors)</span></p><p><span>[root:INFO]	#TIME 19660.941	 Selecting neighbors</span></p><p><span>[root:INFO]	#TIME 19683.451	 Calculating coverage meanshift segmentation</span></p><p><span>[root:INFO]	#TIME 19683.465	 Detecting breakpoint edges (interval neighbors)</span></p><p><span>[root:INFO]	#TIME 19683.963	 Selecting neighbors</span></p><p><span>[root:INFO]	#TIME 19683.963	Exploring interval: chr8	127228812	127918806</span></p><p><span>[root:INFO]	#TIME 19685.445	 Calculating coverage meanshift segmentation</span></p><p><span>[root:INFO]	#TIME 19708.337	 Detecting breakpoint edges (interval neighbors)</span></p><p><span>[root:INFO]	#TIME 34246.139	 Selecting neighbors</span></p><p><span>[root:INFO]	#TIME 34307.060	 New neighbor: chr3	111445238	111655737	158 (weight=158)</span></p><p><span>[root:INFO]	#TIME 34307.060	 New neighbor: chr8	120418251	120658750	1224 (weight=1224)</span></p><p><span>[root:INFO]	#TIME 34307.060	 New neighbor: chr8	125543827	126618820	1428 (weight=1428)</span></p><p><span>[root:INFO]	#TIME 34307.060	 New neighbor: chr8	126990680	127001179	8 (weight=8)</span></p><p><span>[root:INFO]	#TIME 34307.061	Interval sets for amplicons determined: </span></p><p><span>[root:INFO]	[amplicon1]	chr3:108875571-109315572</span></p><p><span>[root:INFO]	[amplicon2]	chr3:111445238-111655737,chr8:120418251-120658750,chr8:125543827-126618820,chr8:126990680-127001179,chr8:127128812-128018806</span></p><p><span>[root:INFO]	#TIME 34307.062	Reconstructing amplicon1</span></p><p><span>[root:INFO]	#TIME 34307.062	 Calculating coverage meanshift segmentation</span></p><p><span>[root:INFO]	#TIME 34307.062	 Detecting breakpoint edges (interval filter vertices)</span></p><p><span>[root:INFO]	#TIME 34307.063	 Building breakpoint graph</span></p><p><span>[root:INFO]	#TIME 34307.114	 Optimizing graph copy number flow</span></p><p><span>Traceback (most recent call last):</span></p><p><span>  File "/data/yudonglin/software/AmpliconArchitect/src/AmpliconArchitect.py", line 321, in &lt;module&gt;</span></p><p><span>    bamFileb2b.interval_filter_vertices(ilist, amplicon_name=amplicon_name, runmode=args.runmode)</span></p><p><span>  File "/data/yudonglin/software/AmpliconArchitect/src/bam_to_breakpoint.py", line 2192, in interval_filter_vertices</span></p><p><span>    task.putSCeval(opro, oprjo, oprfo, oprgo, oprho)</span></p><p><span>  File "/data/yudonglin/software/mosek/8/tools/platform/linux64x86/python/3/mosek/__init__.py", line 2181, in putSCeval</span></p><p><span>    __load_scopt__()</span></p><p><span>  File "/data/yudonglin/software/mosek/8/tools/platform/linux64x86/python/3/mosek/__init__.py", line 951, in __load_scopt__</span></p><p><span>    __scopt__ = __library_factory__(os.path.join(__dlldir__,__makelibname('mosekscopt%d_%d' % (mskmajorver.value,mskminorver.value))))</span></p><p><span>  File "/home/yudonglin/miniconda3/envs/WGS/lib/python3.10/posixpath.py", line 76, in join</span></p><p><span>    a = os.fspath(a)</span></p><p><span>TypeError: expected str, bytes or os.PathLike object, not NoneType</span></p><p><span>Completed</span></p><p><span><br></span></p><p><span>2023-07-23 20:16:21.340538</span></p><p><img data-galleryid="" data-ratio="0.5993071593533488" data-s="300,640" data-type="png" data-w="866" data-src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBpZSgkQBrKuhaBH1BFAWeK6GAKb9iaRiatQb8817hjIdcCe9dlATlapCtHUOOtKUFSoCysjOQOORJzA/640?wx_fmt=png" src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBpZSgkQBrKuhaBH1BFAWeK6GAKb9iaRiatQb8817hjIdcCe9dlATlapCtHUOOtKUFSoCysjOQOORJzA/640?wx_fmt=png"></p><p><img data-galleryid="" data-ratio="0.2959738846572361" data-s="300,640" data-type="png" data-w="919" data-src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBpZSgkQBrKuhaBH1BFAWeK6ibSKuIXEewY4pTIRBGI0dQpLkApJ0mzRJvK1crlObcqWQntynFsrTvw/640?wx_fmt=png" src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBpZSgkQBrKuhaBH1BFAWeK6ibSKuIXEewY4pTIRBGI0dQpLkApJ0mzRJvK1crlObcqWQntynFsrTvw/640?wx_fmt=png"></p><p>分析结果，好像没有什么结果hhh。</p><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="properties"><code><span><span>wget</span> <span>-c https://sra-pub-run-odp.s3.amazonaws.com/sra/SRR8670694/SRR8670694</span></span></code><code><span><span>fastq-dump</span> <span>--split-files --gzip SRR8670694.sra </span></span></code><code><span><br></span></code><code><span><span>conda</span> <span>activate rnaseq</span></span></code><code><span><br></span></code><code><span><span>trim_galore</span> <span>-q 25 --phred33 --length 36 --paired  -j 70 SRR8670694_1.fastq.gz SRR8670694_2.fastq.gz  -o ./clean</span></span></code><code><span><br></span></code><code><span><br></span></code><code><span><span>cd</span> <span>clean</span></span></code><code><span><span>bwa</span> <span>mem -q /data/yudonglin/reference/human/hg38/bwa/hg38.fa SRR8670694_1_val_1.fq.gz SRR8670694_2_val_2.fq.gz &gt; SRR8670694.sam -t 60</span></span></code><code><span><span>samtools</span> <span>sort -o sorted_SRR8670694.bam SRR8670694.sam -@ 60</span></span></code><code><span><span>samtools</span> <span>index sorted_SRR8670694.bam</span></span></code><code><span><span>#提取八号染色体的结果145,138,636</span></span></code><code><span><span>samtools</span> <span>view -hb -@ 8 -b sorted_SRR8670694.bam chr8:0-145,138,636   &gt; chr8.region.bam</span></span></code><code><span><span>samtools</span> <span>index  chr8.region.bam</span></span></code><code><span><br></span></code><code><span><span>conda</span> <span>activate rnaseq</span></span></code><code><span><span>cd</span> <span>/data3/yudonglin/A549-3/clean</span></span></code><code><span><span>samtools</span> <span>view -hb -@ 8 -b sorted_SRR8670694.bam chr2:20,100,000-20,200,000   &gt; target.region.bam</span></span></code><code><span><span>samtools</span> <span>index target.region.bam</span></span></code><code><span><span>#https://www.jianshu.com/p/20d785fc172e</span></span></code><code><span><br></span></code><code><span><span>chr3</span>  <span>108875571  109295572  6.017690882354896  /data3/yudonglin/A549-3/clean//SRR8670694_sample.cs.rmdup_CNV_CALLS_pre_filtered.bed</span></span></code><code><span><span>chr8</span>  <span>125643827  126518820  223.6389796995142  /data3/yudonglin/A549-3/clean//SRR8670694_sample.cs.rmdup_CNV_CALLS_pre_filtered.bed</span></span></code><code><span><span>chr8</span>  <span>127228812  127918806  177.1392370514879  /data3/yudonglin/A549-3/clean//SRR8670694_sample.cs.rmdup_CNV_CALLS_pre_filtered.bed</span></span></code><code><span><br></span></code><code><span><span>samtools</span> <span>view -hb -@ 8 -b sorted_SRR8670694.bam chr3:108875571-109295572   &gt; target.region.bam</span></span></code><code><span><span>samtools</span> <span>index target.region.bam</span></span></code><code><span><br></span></code><code><span><br></span></code><code><span><br></span></code><code><span><br></span></code><code><span><span>conda</span> <span>activate WGS</span></span></code><code><span><span>#成功运行：</span></span></code><code><span><span>python</span> <span>/data/yudonglin/software/AmpliconArchitect/AmpliconSuite-pipeline/PrepareAA.py -s SRR8670694_sample  -t 60 --cnvkit_dir /home/yudonglin/miniconda3/envs/WGS/bin/cnvkit.py --fastqs SRR8670694_1_val_1.fq.gz SRR8670694_2_val_2.fq.gz --ref hg38 --run_AA</span></span></code><code><span><br></span></code></pre></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/PqZWZ1e_vK5AuY1XIgUD3g",target="_blank" rel="noopener noreferrer">原文链接</a>
