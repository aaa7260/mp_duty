---
title: "跟着nature学绘图之绘制组合版环饼图"
date: 2022-12-04T01:14:54Z
draft: ["false"]
tags: [
  "fetched",
  "R语言数据分析指南"
]
categories: ["Acdemic"]
---
跟着nature学绘图之绘制组合版环饼图 by R语言数据分析指南
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><h3 data-tool="mdnice编辑器"><span><span></span>欢迎关注R语言数据分析指南</span><span></span></h3><blockquote data-tool="mdnice编辑器"><span>❝</span><p>本节来复现<strong>「nature medicine」</strong>上的一张图，此图将饼图与环状条形图进行了组合也别有一番风格，小编稍微写了一些代码有更高需求的可以在此基础上进行进一步的拓展；<strong>「数据+代码已经上传VIP群，加群的观众老爷请自行下载」</strong></p><span>❞</span></blockquote><h3 data-tool="mdnice编辑器"><span></span><span><span></span>原文</span><span></span></h3><blockquote data-tool="mdnice编辑器"><span>❝</span><p>Data-driven identification of post-acute SARS-CoV-2 infection subphenotypes</p><span>❞</span></blockquote><blockquote data-tool="mdnice编辑器"><span>❝</span><p><code>有需要学习数据可视化的朋友欢迎加入小编2022年度VIP群</code>，目前群内已经上传公众号文档<strong>「数据+代码约270篇」</strong>，<code>VIP交流群(1)已经500人满员</code>,随着内容不断增多，为了更好的创做内容现在进群需<strong>「付费149元」</strong>双年底临近小编也做一波优惠活动 <strong>「从即日起至12月底无需转发文档到朋友圈积赞，可直接已129元的价格入群」</strong></p><span>❞</span><span><br></span><span><br></span></blockquote><h3 data-tool="mdnice编辑器"><span><p><img data-galleryid="" data-ratio="0.542332268370607" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAbicBoQwwPjJckcjjYxzO0ySWj3crKXoYDvu0DR2CDUJm7FpALzMHtycxhEoQzVhSdWeJUqgVHcibVw/640?wx_fmt=png" data-type="png" data-w="1252" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAbicBoQwwPjJckcjjYxzO0ySWj3crKXoYDvu0DR2CDUJm7FpALzMHtycxhEoQzVhSdWeJUqgVHcibVw/640?wx_fmt=png"></p><span><br></span>淘宝店铺个性化绘图服务</span><span></span></h3><blockquote data-tool="mdnice编辑器"><span>❝</span><p>最近有部分观众老爷找小编做个性化绘图，为了给观众老爷提供更加优质的服务；小编开通了 <strong>「淘宝店铺(R语言数据分析指南)」</strong> ，有特殊绘图需求的欢迎关注咨询(<strong>「由于小编时间精力有限有需求的请及时下单」</strong>)</p><span>❞</span></blockquote><h3 data-tool="mdnice编辑器"><span></span><span><span></span>加载R包</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code>library(tidyverse)<br>library(readxl)<br>library(camcorder)<br>library(ggtext)<br>library(ggsci)<br>library(cowplot)<br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span><span></span>数据清洗</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code>df &lt;- read_excel(<span>"41591_2022_2116_MOESM5_ESM.xlsx"</span>) %&gt;% <br>  select(1,2,3,group_2) %&gt;% <br>  rownames_to_column(var=<span>"ID"</span>) %&gt;% <br>  mutate_at(vars(c(S1)),~str_split(.,<span>" "</span>,simplify=T)[,1]) %&gt;%<br>  mutate(group_3 = rep(LETTERS[1:4], <span>times</span>=c(5,12,10,11))) %&gt;% <br>  mutate(S1=as.numeric(S1),ID=as.numeric(ID)) %&gt;% <br>  group_by(group_2) %&gt;% <br>  mutate(per=S1/sum(S1)*10) %&gt;% <br>  arrange(desc(per)) %&gt;% <br>  ungroup()<br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span><span></span>绘制饼图</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code>p &lt;- df %&gt;% <br>  ggplot(aes(x=<span>""</span>,y=per,fill=group_3))+<br>  geom_col()+ coord_polar(<span>"y"</span>)+<br>  scale_fill_npg()+<br>  theme_void()+<br>  theme(legend.position = <span>"non"</span>)<br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span><span></span>绘制环状条图</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code>p2 &lt;- ggplot(df) +<br><span># 设置刻度线</span><br>  annotate(<span>"segment"</span>, x = -Inf, xend = Inf, y = seq(0,10,1), yend = seq(0,10,1),<br>           size = rep(c(0.25, 0.1),length.out =11), alpha = 0.5)+<br> <span># 添加标签 </span><br>  annotate(<span>"label"</span>, x = 0, y = seq(0,10,1), label = seq(0,10,1),color=<span>"black"</span>,<br>           size = 3, fill = <span>"#FEF8FA"</span>,label.padding = unit(0.1,<span>"lines"</span>),<br>           label.size = 0)+<br>  geom_col(aes(x = ID, y =per, fill = group_2),position = <span>"dodge"</span>, width=0.6)+<br>  scale_y_continuous(limits = c(-4,10)) +<br>  scale_x_continuous(limits = c(-0.5,38.5), breaks = 1:38.5) +<br>  scale_fill_manual(values=c(<span>"#709AE1FF"</span>,<span>"#8A9197FF"</span>,<span>"#D2AF81FF"</span>,<span>"#FD7446FF"</span>,<br>                    <span>"#D5E4A2FF"</span>,<span>"#197EC0FF"</span>,<span>"#F05C3BFF"</span>,<span>"#46732EFF"</span>,<br>                    <span>"#71D0F5FF"</span>,<span>"#075149FF"</span>,<span>"#C80813FF"</span>,<span>"#91331FFF"</span>))+<br>  coord_polar()+<br>  theme_minimal() +<br>  theme(<br>    legend.position = <span>"none"</span>,<br>    plot.background =element_blank(),<br>    panel.background = element_blank(),<br>    panel.grid = element_blank(),<br>    axis.text.y = element_blank(),<br>    axis.title = element_blank(),<br>    axis.text.x = element_blank())<br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span><span></span>拼图</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code>ggdraw(p2)+<br>  draw_plot(p,scale=0.23,x=0,y=0)<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.9402298850574713" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAbicBoQwwPjJckcjjYxzO0ySq0H6S4jgbf7NvUxupMkebZMgfs0tP0GGKjVl21cLibIj9ibvWexywrxQ/640?wx_fmt=png" data-type="png" data-w="870" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAbicBoQwwPjJckcjjYxzO0ySq0H6S4jgbf7NvUxupMkebZMgfs0tP0GGKjVl21cLibIj9ibvWexywrxQ/640?wx_fmt=png"></figure><blockquote data-tool="mdnice编辑器"><span>❝</span><p>好了本节介绍到此结束，整个代码还是非常简洁的，<code>喜欢的观众老爷欢迎分析转发</code>，<strong>「当然更推荐大家加入我的VIP交流群」</strong>一定让你感受到物超所值，<strong>「添加小编微信请备注来意，以便高效处理」</strong>，</p><span>❞</span></blockquote><h3 data-tool="mdnice编辑器"><span></span><span><span></span>小编微信</span><span></span></h3><p><img data-galleryid="" data-ratio="1" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/EibnicgwScTAaNu6sU2UCYkxFq9ibq75wuaO0lqFoYz1icUo4jh3N2icAWECmibgPvqyReur0FCp7JNKO0icnRAsbO9ug/640?wx_fmt=jpeg" data-type="jpeg" data-w="430" src="https://mmbiz.qpic.cn/mmbiz_jpg/EibnicgwScTAaNu6sU2UCYkxFq9ibq75wuaO0lqFoYz1icUo4jh3N2icAWECmibgPvqyReur0FCp7JNKO0icnRAsbO9ug/640?wx_fmt=jpeg"></p><h3 data-tool="mdnice编辑器"><span></span><span><span></span>关注下方公众号下回更新不迷路</span><span></span></h3><section><mp-common-profile data-pluginname="mpprofile" data-weui-theme="light" data-id="Mzg3MzQzNTYzMw==" data-headimg="http://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZF0rpeZII9Ltl26VbVagriczTria1fib3XgjwwHEHFjPzkmGpqWDVVHBSzhENictUM2iavAKiaM5lc9USw/0?wx_fmt=png" data-nickname="R语言数据分析指南" data-alias="YanJANtwo" data-signature="R语言重症爱好者，喜欢绘制各种精美的图表，喜欢的小伙伴可以关注我，跟我一起学习" data-from="0" data-is_biz_ban="0"></mp-common-profile></section><p><img data-galleryid="" data-ratio="0.3193449334698055" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAYib6Vf5Lfu4s64dJIEWhdGMvrcDEx2Rxgd91TOF5sjqy47Wqf2cTO1c5Nhdibh8G5IhOnR53j6XKrw/640?wx_fmt=png" data-type="png" data-w="1954" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAYib6Vf5Lfu4s64dJIEWhdGMvrcDEx2Rxgd91TOF5sjqy47Wqf2cTO1c5Nhdibh8G5IhOnR53j6XKrw/640?wx_fmt=png"></p><p><br></p><section><section><section><section><p data-mid="">往期推荐</p></section></section><section><section><a href="http://mp.weixin.qq.com/s?__biz=Mzg3MzQzNTYzMw==&amp;mid=2247500179&amp;idx=1&amp;sn=4ca961df6024251d315713cceefdf388&amp;chksm=cee2990df995101bc3fa4f1c945e65849be0fb312e6d63204bcfd5aeb2530c08cb9b42c032a7&amp;scene=21#wechat_redirect" data-linktype="2"><section><p>跟着nature学绘图之特殊主题热图</p></section></a></section><section><a href="http://mp.weixin.qq.com/s?__biz=Mzg3MzQzNTYzMw==&amp;mid=2247500160&amp;idx=1&amp;sn=678c9a8647467cb46f0ccc362e65b20e&amp;chksm=cee2991ef9951008d563abb4bfc507388a67ec6d020e7fd6c519542c0b2a28e3e6a7db88eb15&amp;scene=21#wechat_redirect" data-linktype="2"><section><p>R语言优雅的绘制地图附带经纬线</p></section></a></section><section><a href="http://mp.weixin.qq.com/s?__biz=Mzg3MzQzNTYzMw==&amp;mid=2247500139&amp;idx=1&amp;sn=7eb4f0d1a18a01fe45223bd3e969cefc&amp;chksm=cee299f5f99510e3de9d85f6d15a96301b2d34450743c9f904b510e5d0c39d54995f4424380c&amp;scene=21#wechat_redirect" data-linktype="2"><section><p>[会员专享] ggplot2绘制组合版环状热图</p></section></a></section><section><a href="http://mp.weixin.qq.com/s?__biz=Mzg3MzQzNTYzMw==&amp;mid=2247500118&amp;idx=1&amp;sn=ea21ba9638c7c606ff32b42e8e0a2393&amp;chksm=cee299c8f99510de17bb4bc07c1d12b8c77ad1c22e7438398ada0871e469e2c7be06ae71b803&amp;scene=21#wechat_redirect" data-linktype="2"><section><p>ggsector:帮助你轻松的绘制扇形</p></section></a></section><section><a href="http://mp.weixin.qq.com/s?__biz=Mzg3MzQzNTYzMw==&amp;mid=2247500111&amp;idx=1&amp;sn=71cd3e2d0c422aa708b987e82fffc7c1&amp;chksm=cee299d1f99510c7c32eda6a4682fac5a1a38fcdcd2b4895237e2b6e5169537176a5acfcbf6e&amp;scene=21#wechat_redirect" data-linktype="2"><section><p>[会员专享] ggplot2绘制多元回归方差分解热图(含全套代码)</p></section></a></section><section><a href="http://mp.weixin.qq.com/s?__biz=Mzg3MzQzNTYzMw==&amp;mid=2247500039&amp;idx=1&amp;sn=550ccefbbf044e9165a4915a4658a2cb&amp;chksm=cee29999f995108fd781f8f93c8950ca40177ba75bf21fc4749dd7c6f32b186d62d4292cc333&amp;scene=21#wechat_redirect" data-linktype="2"><section><p>ggplot2优雅的绘制轨道图</p></section></a></section><section><a href="http://mp.weixin.qq.com/s?__biz=Mzg3MzQzNTYzMw==&amp;mid=2247500015&amp;idx=1&amp;sn=4b059fe57f649977502bd7b1513bac51&amp;chksm=cee29871f9951167fbd87fa58efa5e97b0c49a91b5e871c0bc5fe3c69abbf77560d780fc7855&amp;scene=21#wechat_redirect" data-linktype="2"><section><p>[nmicrobiol图表复现] ggtree绘制离散型环状热图</p></section></a></section><section><a href="http://mp.weixin.qq.com/s?__biz=Mzg3MzQzNTYzMw==&amp;mid=2247499989&amp;idx=1&amp;sn=9d62c41b230f451402a63308b8a29c88&amp;chksm=cee2984bf995115dc1760b22ecd46df437e7dac904660e92338d20b408d8cea174c34f1bc476&amp;scene=21#wechat_redirect" data-linktype="2"><section><p>R语言版基因家族分析课程-正式上线了</p></section></a></section><section><a href="http://mp.weixin.qq.com/s?__biz=Mzg3MzQzNTYzMw==&amp;mid=2247499966&amp;idx=1&amp;sn=2e2324b1564959582afd2993b2a2f1ab&amp;chksm=cee29820f9951136be6b310757938786858f0d32a7c0c63d1af870f158df5f52dfa1e2dc17bd&amp;scene=21#wechat_redirect" data-linktype="2"><section><p>ggplot2优雅绘制时间趋势变化散点图</p></section></a></section><section><a href="http://mp.weixin.qq.com/s?__biz=Mzg3MzQzNTYzMw==&amp;mid=2247499949&amp;idx=1&amp;sn=2fa3f5d209aa93c5ac95ec3caa064909&amp;chksm=cee29833f9951125ef42e4a1179760baa942daa0b999e98eb3dd90f1a6022ce5b624a41eda50&amp;scene=21#wechat_redirect" data-linktype="2"><section><p>ggplot2绘制趋势变化堆砌条形图</p></section></a></section><section><a href="http://mp.weixin.qq.com/s?__biz=Mzg3MzQzNTYzMw==&amp;mid=2247499934&amp;idx=1&amp;sn=d181a67407e1cccd74287cc4a9b49dfb&amp;chksm=cee29800f9951116305baf628d8c4be9f302344d8ceafe2633807443a5dbbc5ee9a179c84a05&amp;scene=21#wechat_redirect" data-linktype="2"><section><p>[会员专享] 详谈R中桑基图的绘制细节</p></section></a></section></section></section></section><p><br></p><br></section><p><br></p><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/6V9MkgRY2JD_sKqx_su7MQ",target="_blank" rel="noopener noreferrer">原文链接</a>
