---
title: "scanpy和Seurat单细胞分析对比"
date: 2023-11-16T02:11:41Z
draft: ["false"]
tags: [
  "fetched",
  "生信技能树"
]
categories: ["Acdemic"]
---
scanpy和Seurat单细胞分析对比 by 生信技能树
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><blockquote data-tool="mdnice编辑器"><p>曾老师已经是V4的版本的Seurat流程做出来了大量的公共数据集的单细胞转录组降维聚类分群流程，100多个公共单细胞数据集全部的处理，链接：https://pan.baidu.com/s/1MzfqW07P9ZqEA_URQ6rLbA?pwd=3heo</p><p>但是最近<span>S</span><span>eurat版本问题，导致好多人使用我们的标准代码失败了，首先是可以参考我们前面的降级方式：</span><a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247526354&amp;idx=1&amp;sn=a4fb075968d8a78ecda292067ba18204&amp;scene=21#wechat_redirect" data-linktype="2">假如你不喜欢最新版的Seurat包的单细胞理念</a>，其次也可以干脆就转为Python的单细胞scanpy流程</p></blockquote></section><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><h3 data-tool="mdnice编辑器"><span></span><span></span><span>scanpy和seurat分析代码比较</span><span></span></h3><p data-tool="mdnice编辑器">尝试把曾老师的<strong>单细胞seurat分析的代码转换成scanpy版本的，包括样品读取，质控，harmony去除批次效应，降维聚类，marker鉴定。</strong></p><h3 data-tool="mdnice编辑器"><span></span><span></span><span>seurat版本的R代码</span><span></span></h3><p data-tool="mdnice编辑器">先看看seurat版本的R代码，<strong>里面调用了另外几个文件，lib.R，qc.R，harmony.R，check-all-markers.R</strong>，这几个文件以前应该都有分享过.<span>scRNA_scripts文件夹的r代码都在上面的百度云网盘链接（https://pan.baidu.com/s/1MzfqW07P9ZqEA_URQ6rLbA?pwd=3heo）里面哦：</span></p><pre data-tool="mdnice编辑器"><span></span><code>rm(list=ls())<br>options(stringsAsFactors = F) <br><span>source</span>(<span>'scRNA_scripts/lib.R'</span>)<br><br><span>###### step1:导入数据 ######   </span><br><span># 付费环节 800 元人民币</span><br><br>dir=<span>'GSE189357_RAW/output/'</span> <br>samples=list.files( dir  )<br>samples <br><br>library(data.table)<br>sceList = lapply(samples,<span>function</span>(pro){ <br>  <span># pro=samples[1] </span><br>  <span>print</span>(pro) <br>  sce=CreateSeuratObject(counts =  Read10X(file.path(dir,pro) ) ,<br>                         project =  pro ,<br>                         min.cells = 5,<br>                         min.features = 300,)<br>  <br>  <span>return</span>(sce)<br>})<br><br>names(sceList)  <br><br>library(stringr)<br><span># samples=gsub('.txt.gz','',str_split(samples,'_',simplify = T)[,2])</span><br>samples<br><br>names(sceList) =  samples<br><br>sce.all &lt;- merge(sceList[[1]], y= sceList[ -1 ] ,<br>                 add.cell.ids =  samples) <br><br>as.data.frame(sce.all@assays<span>$RNA</span>@counts[1:10, 1:2])<br>head(sce.all@meta.data, 10)<br>table(sce.all@meta.data<span>$orig</span>.ident) <br> <br><br><span>###### step2:QC质控 ######</span><br>dir.create(<span>"./1-QC"</span>)<br>setwd(<span>"./1-QC"</span>)<br><span># 如果过滤的太狠，就需要去修改这个过滤代码</span><br><span>source</span>(<span>'../scRNA_scripts/qc.R'</span>)<br>sce.all.filt = basic_qc(sce.all)<br><span>print</span>(dim(sce.all))<br><span>print</span>(dim(sce.all.filt))<br>setwd(<span>'../'</span>)<br><br><br>sp=<span>'human'</span><br><br><span>###### step3: harmony整合多个单细胞样品 ######</span><br>dir.create(<span>"2-harmony"</span>)<br>getwd()<br>setwd(<span>"2-harmony"</span>)<br><span>source</span>(<span>'../scRNA_scripts/harmony.R'</span>)<br><span># 默认 ScaleData 没有添加"nCount_RNA", "nFeature_RNA"</span><br><span># 默认的</span><br>sce.all.int = run_harmony(sce.all.filt)<br>setwd(<span>'../'</span>)<br><br><span>###### step4: 降维聚类分群和看标记基因库 ######</span><br><span># 原则上分辨率是需要自己肉眼判断，取决于个人经验</span><br><span># 为了省力，我们直接看  0.1和0.8即可</span><br>table(Idents(sce.all.int))<br>table(sce.all.int<span>$seurat_clusters</span>)<br>table(sce.all.int<span>$RNA_snn_res</span>.0.1) <br>table(sce.all.int<span>$RNA_snn_res</span>.0.8) <br><br>getwd()<br>dir.create(<span>'check-by-0.1'</span>)<br>setwd(<span>'check-by-0.1'</span>)<br>sel.clust = <span>"RNA_snn_res.0.1"</span><br>sce.all.int &lt;- SetIdent(sce.all.int, value = sel.clust)<br>table(sce.all.int@active.ident) <br><br><span>source</span>(<span>'../scRNA_scripts/check-all-markers.R'</span>)<br>setwd(<span>'../'</span>) <br>getwd()<br><br>dir.create(<span>'check-by-0.8'</span>)<br>setwd(<span>'check-by-0.8'</span>)<br>sel.clust = <span>"RNA_snn_res.0.8"</span><br>sce.all.int &lt;- SetIdent(sce.all.int, value = sel.clust)<br>table(sce.all.int@active.ident) <br><span>source</span>(<span>'../scRNA_scripts/check-all-markers.R'</span>)<br>setwd(<span>'../'</span>) <br>getwd()<br><br>dir.create(<span>'check-by-0.5'</span>)<br>setwd(<span>'check-by-0.5'</span>)<br>sel.clust = <span>"RNA_snn_res.0.5"</span><br>sce.all.int &lt;- SetIdent(sce.all.int, value = sel.clust)<br>table(sce.all.int@active.ident) <br><span>source</span>(<span>'../scRNA_scripts/check-all-markers.R'</span>)<br>setwd(<span>'../'</span>) <br>getwd()<br><br>last_markers_to_check<br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span></span><span>scanpy版本的python代码</span><span></span></h3><p data-tool="mdnice编辑器">安装各种库的时候，直接pip install scanpy即可</p><p data-tool="mdnice编辑器">如果是在jupyter notebook或者jupyter lab里，需要在前面加上！，命令行里就不用</p><p data-tool="mdnice编辑器">!pip install scanpy</p><pre data-tool="mdnice编辑器"><span></span><code><span>#安装导入需要的模块</span><br>import scanpy as sc<br>import numpy as np <br>import pandas as pd <br>from glob import glob<br>import re<br>import seaborn as sns<br>import matplotlib.pyplot as plt <br>from tqdm import tqdm<br>import os<br>from collections import Counter<br>import time<br>import cosg as cosg<br>%matplotlib inline<br></code></pre><pre data-tool="mdnice编辑器"><span></span><code><span># 开始计时</span><br>a = time.perf_counter()<br></code></pre><p data-tool="mdnice编辑器">scanpy下的read_10x_mtx函数读取数据，传入文件夹路径，保证文件夹下还是这三个文件即可</p><p data-tool="mdnice编辑器"><img data-ratio="0.39779005524861877" data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wyZKL3gyoCJBpZFEZg9wd1RzCp9wVEnmpLenUhxrWZfasibTaSLtn8fHV6JicMkQPbX5BRPjM4KfswQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="181" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wyZKL3gyoCJBpZFEZg9wd1RzCp9wVEnmpLenUhxrWZfasibTaSLtn8fHV6JicMkQPbX5BRPjM4KfswQ/640?wx_fmt=png&amp;from=appmsg">循环读取9个单细胞数据，用字典进行存储，key为样本名，value为scanpy读取后的对象</p><p data-tool="mdnice编辑器">用scanpy下的concat函数进行多个样本的合并</p><p data-tool="mdnice编辑器">scanpy对象结构参考下图</p><p data-tool="mdnice编辑器">adata.var是行为gene，列为统计指标的矩阵，进行完各种分析之后，大概如下图，刚读完数据的时候，只有行名，没有列</p><p data-tool="mdnice编辑器"><img data-ratio="0.23867069486404835" data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wyZKL3gyoCJBpZFEZg9wd1RaiapwkHicV0wP9PFhsTsAntZz8mCYEpbPor7V8uVbZYHmQa3SRYANpAA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="662" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wyZKL3gyoCJBpZFEZg9wd1RaiapwkHicV0wP9PFhsTsAntZz8mCYEpbPor7V8uVbZYHmQa3SRYANpAA/640?wx_fmt=png&amp;from=appmsg">adata.obs是行为细胞，列为统计指标的矩阵<img data-ratio="0.24756756756756756" data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wyZKL3gyoCJBpZFEZg9wd1R0UoIDaQ1KL5xaca6vLWiaJXR90tLicjDUoDDxaHIvibQkyXkovElguQ2w/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="925" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wyZKL3gyoCJBpZFEZg9wd1R0UoIDaQ1KL5xaca6vLWiaJXR90tLicjDUoDDxaHIvibQkyXkovElguQ2w/640?wx_fmt=png&amp;from=appmsg">adata.uns里面存放的是非结构化的数据，都是字典的形式</p><p data-tool="mdnice编辑器"><img data-ratio="0.08137254901960785" data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wyZKL3gyoCJBpZFEZg9wd1RR8cw1iaTFNLu9g6ic60ibDgRvial4oxoNwWp3KqqNEuEDlPJsUhAdckMsg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1020" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wyZKL3gyoCJBpZFEZg9wd1RR8cw1iaTFNLu9g6ic60ibDgRvial4oxoNwWp3KqqNEuEDlPJsUhAdckMsg/640?wx_fmt=png&amp;from=appmsg">比如sample color，存放的是每个样品对应的颜色，pca里面存放有降维后的主成分的信息，louvain 0.01_colors里面存放的就是0.01的分辨率下每个cluster对应的颜色</p><p data-tool="mdnice编辑器"><img data-ratio="0.16318785578747627" data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wyZKL3gyoCJBpZFEZg9wd1RjbzZ1ticQ0LCCddY9eBbygCMEG1ibVnnVLBLIW6G9icfJ5omWFueqsnfg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="527" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wyZKL3gyoCJBpZFEZg9wd1RjbzZ1ticQ0LCCddY9eBbygCMEG1ibVnnVLBLIW6G9icfJ5omWFueqsnfg/640?wx_fmt=png&amp;from=appmsg">adata.X里面存放的是表达矩阵，行为cell，列为gene</p><figure data-tool="mdnice编辑器"><img data-ratio="0.8281036834924966" data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wyZKL3gyoCJBpZFEZg9wd1RSmEfTkLG1icrxCfod9Lra4gLibk1mJyvjiahTKqIFqNpzCp2smEZibFZdQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="733" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wyZKL3gyoCJBpZFEZg9wd1RSmEfTkLG1icrxCfod9Lra4gLibk1mJyvjiahTKqIFqNpzCp2smEZibFZdQ/640?wx_fmt=png&amp;from=appmsg"></figure><pre data-tool="mdnice编辑器"><span></span><code><span>### Step1 批量读取单细胞数据</span><br><span># 字符串前面加上r之后，路径里的/和\就不用特意修改了</span><br>path = r<span>'F:\新建文件夹\2022-GSE189357-LUAD-单细胞-疾病进展\GSE189357_RAW\output'</span><br>files = glob(path + <span>'\*'</span>)<br><br><span># tqdm用来显示进度条，不加也可以</span><br>data_dic = {}<br><span>for</span> i <span>in</span> tqdm(files):<br>    sample_name = i.split(<span>'\\'</span>)[-1]<br>    <span># cache=True 会存储读取文件时候的缓存，下次再读取就很快了</span><br>    adata = sc.read_10x_mtx(i,var_names=<span>'gene_symbols'</span>,cache=True)<br>    adata.var_names_make_unique()<br>    adata.obs_names_make_unique()<br>    data_dic[sample_name] = adata<br>    <br>adata = sc.concat(data_dic,label=<span>'sample'</span>,axis=0)<br>adata.obs_names_make_unique()<br><br>os.getcwd()<br><br>work_dir = r<span>'F:新建文件夹/'</span><br>os.chdir(work_dir)<br></code></pre><p data-tool="mdnice编辑器">qc部分，参考曾老师seurat里qc.R脚本写的</p><p data-tool="mdnice编辑器">这里只考虑了human gene，都是大写的</p><pre data-tool="mdnice编辑器"><span></span><code><span>#计算比例和标准质控  </span><br>def basic_qc(adata):<br>    <span># 计算线粒体基因比例</span><br>    adata.var[<span>'mt'</span>] = adata.var_names.str.startswith(<span>'MT-'</span>)<br>    sc.pp.calculate_qc_metrics(adata, qc_vars=[<span>'mt'</span>], percent_top=None, log1p=False, inplace=True)<br>    mt_gene = adata.var.index[adata.var_names.str.startswith(<span>'MT-'</span>)]<br>    <span>print</span>(<span>'线粒体gene：'</span>,mt_gene)<br>    <span># 计算核糖体基因比例</span><br>    adata.var[<span>'rp'</span>] = [True <span>if</span> i.startswith(<span>'RPL'</span>) or i.startswith(<span>'RPS'</span>) <span>else</span> False <span>for</span> i <span>in</span> adata.var_names]<br>    sc.pp.calculate_qc_metrics(adata, qc_vars=[<span>'rp'</span>], percent_top=None, log1p=False, inplace=True)<br>    rp_gene = [i <span>for</span> i <span>in</span> adata.var_names <span>if</span> i.startswith(<span>'RPL'</span>) or i.startswith(<span>'RPS'</span>)]<br>    <span>print</span>(<span>'核糖体gene：'</span>,rp_gene)<br>    <span># 计算红血细胞基因比例</span><br>    adata.var[<span>'hb'</span>] = [True <span>if</span> i.startswith(<span>'HB'</span>) and not i.startswith(<span>'HBP'</span>) <span>else</span> False <span>for</span> i <span>in</span> adata.var_names]<br>    sc.pp.calculate_qc_metrics(adata, qc_vars=[<span>'hb'</span>], percent_top=None, log1p=False, inplace=True)<br>    hb_gene = [i <span>for</span> i <span>in</span> adata.var_names <span>if</span> i.startswith(<span>'HB'</span>) and not i.startswith(<span>'HBP'</span>)]<br>    <span>print</span>(<span>'红血细胞gene：'</span>,hb_gene)<br>    <br>    <span># 可视化细胞各gene比例</span><br>    <span>if</span> not os.path.isdir(<span>'qc'</span>):<br>        os.mkdir(<span>'qc'</span>)<br>    <br>    sc.pl.violin(adata,keys=[<span>'n_genes_by_counts'</span>,<span>'total_counts'</span>],groupby=<span>'sample'</span>,show = False)<br>    plt.savefig(<span>'qc/vlnplot1.pdf'</span>)<br>    sc.pl.violin(adata,keys=[<span>'pct_counts_mt'</span>,<span>'pct_counts_rp'</span>,<span>'pct_counts_hb'</span>],groupby=<span>'sample'</span>,show = False)<br>    plt.savefig(<span>'qc/vlnplot2.pdf'</span>)<br>    sc.pl.scatter(adata,x=<span>'total_counts'</span>, y=<span>'n_genes_by_counts'</span>,color=<span>'sample'</span>,show = False)<br>    plt.savefig(<span>'qc/scatterplot.pdf'</span>)<br>    sc.pl.highest_expr_genes(adata,n_top=20,show = False)<br>    plt.savefig(<span>'qc/TOP20_most_expressed_gene.pdf'</span>)<br>    <br>    <span># 过滤</span><br>    <span>print</span>(<span>'过滤前：'</span>,adata.shape)<br>    adata = adata[adata.obs.n_genes_by_counts &lt; 6000, :]<br>    adata = adata[adata.obs.pct_counts_mt &lt; 20, :]<br>    adata = adata[adata.obs.pct_counts_rp &gt; 3, :]<br>    adata = adata[adata.obs.pct_counts_hb &lt; 1, :]<br>    <span>print</span>(<span>'过滤后：'</span>,adata.shape)<br>    <br>    <span># 可视化过滤后的结果</span><br>    sc.pl.violin(adata,keys=[<span>'n_genes_by_counts'</span>,<span>'total_counts'</span>],groupby=<span>'sample'</span>,show = False)<br>    plt.savefig(<span>'qc/vlnplot1_filtered.pdf'</span>)<br>    sc.pl.violin(adata,keys=[<span>'pct_counts_mt'</span>,<span>'pct_counts_rp'</span>,<span>'pct_counts_hb'</span>],groupby=<span>'sample'</span>,show = False)<br>    plt.savefig(<span>'qc/vlnplot2_filtered.pdf'</span>)<br>    <span>return</span> adata<br></code></pre><pre data-tool="mdnice编辑器"><span></span><code><span>#harmony整合</span><br><br>def run_harmony(adata):<br>    <span># normalize</span><br>    sc.pp.normalize_total(adata, target_sum=1e4)<br>    sc.pp.log1p(adata)<br>    adata.raw = adata<br>    <span># 找高变gene</span><br>    sc.pp.highly_variable_genes(adata, min_mean=0.0125, max_mean=3, min_disp=0.5)<br>    <span># 只保留高变gene</span><br>    adata = adata[:, adata.var.highly_variable]<br>    <span># 根据线粒体gene进行regress</span><br>    sc.pp.regress_out(adata, <span>'pct_counts_mt'</span>)<br>    <span># scale</span><br>    sc.pp.scale(adata)<br>    <span># pca</span><br>    sc.tl.pca(adata, svd_solver=<span>'arpack'</span>)<br>    sc.external.pp.harmony_integrate(adata,key=<span>'sample'</span>)<br>    <br>    sc.pp.neighbors(adata, n_neighbors=10, n_pcs=20,use_rep=<span>'X_pca_harmony'</span>)<br>    sc.tl.umap(adata)<br>    <br>    <span># 设置不同分辨率</span><br>    <span>for</span> i <span>in</span> [0.01, 0.05, 0.1, 0.2, 0.3, 0.5,0.8,1]:<br>        sc.tl.louvain(adata,resolution=i,key_added=<span>'louvain {}'</span>.format(i))<br>    <span>if</span> not os.path.isdir(<span>'harmony'</span>):<br>     os.mkdir(<span>'harmony'</span>)<br>    sc.pl.umap(adata,color=[<span>'louvain 0.01'</span>,<span>'louvain 0.1'</span>,<span>'louvain 0.2'</span>],show = False)<br>    plt.savefig(<span>'harmony/resolution_low.pdf'</span>)<br>    sc.pl.umap(adata,color=[<span>'louvain 0.5'</span>,<span>'louvain 0.8'</span>,<span>'louvain 1'</span>],show = False)<br>    plt.savefig(<span>'harmony/resolution_high.pdf'</span>)<br>    <span>return</span> adata<br></code></pre><pre data-tool="mdnice编辑器"><span></span><code>def run_harmony(adata):<br>    <span># normalize</span><br>    sc.pp.normalize_total(adata, target_sum=1e4)<br>    sc.pp.log1p(adata)<br>    adata.raw = adata<br>    <span># 找高变gene</span><br>    sc.pp.highly_variable_genes(adata, min_mean=0.0125, max_mean=3, min_disp=0.5)<br>    <span># 只保留高变gene</span><br>    adata = adata[:, adata.var.highly_variable]<br>    <span># 根据线粒体gene进行regress</span><br>    sc.pp.regress_out(adata, <span>'pct_counts_mt'</span>)<br>    <span># scale</span><br>    sc.pp.scale(adata)<br>    <span># pca</span><br>    sc.tl.pca(adata, svd_solver=<span>'arpack'</span>)<br>    sc.external.pp.harmony_integrate(adata,key=<span>'sample'</span>)<br>    <br>    sc.pp.neighbors(adata, n_neighbors=10, n_pcs=20,use_rep=<span>'X_pca_harmony'</span>)<br>    sc.tl.umap(adata)<br>    <br>    <span># 设置不同分辨率</span><br>    <span>for</span> i <span>in</span> [0.01, 0.05, 0.1, 0.2, 0.3, 0.5,0.8,1]:<br>        sc.tl.louvain(adata,resolution=i,key_added=<span>'louvain {}'</span>.format(i))<br>    <span>if</span> not os.path.isdir(<span>'harmony'</span>):<br>     os.mkdir(<span>'harmony'</span>)<br>    sc.pl.umap(adata,color=[<span>'louvain 0.01'</span>,<span>'louvain 0.1'</span>,<span>'louvain 0.2'</span>],show = False)<br>    plt.savefig(<span>'harmony/resolution_low.pdf'</span>)<br>    sc.pl.umap(adata,color=[<span>'louvain 0.5'</span>,<span>'louvain 0.8'</span>,<span>'louvain 1'</span>],show = False)<br>    plt.savefig(<span>'harmony/resolution_high.pdf'</span>)<br>    <span>return</span> adata<br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span></span><span>结果展示</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code>adata = basic_qc(adata)<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.4607645875251509" data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wyZKL3gyoCJBpZFEZg9wd1RrdAY8FZDTcGiaWzWcEcg2z2KdLxqWcNIECyhXnJ3jBtZO4MuM3RNYVQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="994" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wyZKL3gyoCJBpZFEZg9wd1RrdAY8FZDTcGiaWzWcEcg2z2KdLxqWcNIECyhXnJ3jBtZO4MuM3RNYVQ/640?wx_fmt=png&amp;from=appmsg"></figure><figure data-tool="mdnice编辑器"><img data-ratio="0.5567226890756303" data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wyZKL3gyoCJBpZFEZg9wd1RxHuxkIEvguNlA4nE9vTOyibdYF3F4mdBNb1gStJUIQ2ibMcrYE5Q0WQQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="476" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wyZKL3gyoCJBpZFEZg9wd1RxHuxkIEvguNlA4nE9vTOyibdYF3F4mdBNb1gStJUIQ2ibMcrYE5Q0WQQ/640?wx_fmt=png&amp;from=appmsg"></figure><figure data-tool="mdnice编辑器"><img data-ratio="0.9883720930232558" data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wyZKL3gyoCJBpZFEZg9wd1RxSu1q2SOEtFlO334qZqhTHgWaqIicbicD6icXeSjusBR7NrWWVEfliaiaBw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="344" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wyZKL3gyoCJBpZFEZg9wd1RxSu1q2SOEtFlO334qZqhTHgWaqIicbicD6icXeSjusBR7NrWWVEfliaiaBw/640?wx_fmt=png&amp;from=appmsg"></figure><pre data-tool="mdnice编辑器"><span></span><code>adata = run_harmony(adata)<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.42933333333333334" data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wyZKL3gyoCJBpZFEZg9wd1RUuDTibDicLYiaPSPJGfSIzutYpeWG7Yf1jic4ZvjwkiakIQnmiacofa0tdiag/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="750" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wyZKL3gyoCJBpZFEZg9wd1RUuDTibDicLYiaPSPJGfSIzutYpeWG7Yf1jic4ZvjwkiakIQnmiacofa0tdiag/640?wx_fmt=png&amp;from=appmsg"></figure><pre data-tool="mdnice编辑器"><span></span><code>check_markers(0.1)<br>check_markers(0.3)<br>check_markers(0.8)<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.5637149028077754" data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wyZKL3gyoCJBpZFEZg9wd1RHTPla85OX1sKgwx75pkc4WicgAfZcOzepl2RoTW5icybkMDRc24ZXluw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="463" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wyZKL3gyoCJBpZFEZg9wd1RHTPla85OX1sKgwx75pkc4WicgAfZcOzepl2RoTW5icybkMDRc24ZXluw/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器"><img data-ratio="0.6684118673647469" data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wyZKL3gyoCJBpZFEZg9wd1RxZmkwJfRfdKxY4hARlRCPa1Gr7hEuviar7jM79LSoB8vPS1LQJdl85w/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="573" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wyZKL3gyoCJBpZFEZg9wd1RxZmkwJfRfdKxY4hARlRCPa1Gr7hEuviar7jM79LSoB8vPS1LQJdl85w/640?wx_fmt=png&amp;from=appmsg"><strong>运行完耗时1021s</strong></p></section><h4 data-tool="mdnice编辑器">文末友情宣传</h4><p data-tool="mdnice编辑器">强烈建议你推荐给身边的<strong>博士后以及年轻生物学PI</strong>，多一点数据认知，让他们的科研上一个台阶：</p><ul data-tool="mdnice编辑器"><li><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247526014&amp;idx=1&amp;sn=44afb387fc49b89276386e5182db7bc9&amp;chksm=9b4b26c5ac3cafd35616b2fe9df7fea664e59d75e9970feb322a477beb222ac023f7daebb3dc&amp;scene=21#wechat_redirect" textvalue="生物信息学马拉松授课（买一得‍五）" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1">生物信息学马拉松授课（买一得五）</a> ，你的生物信息学入门课</section></li><li><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247524148&amp;idx=1&amp;sn=7806da6feb41a36493c519c1cfc1d3ac&amp;chksm=9b4bdf8fac3c569960369602f1ef26639cb366b250f233b2297d1f059471c0458335bfc0b829&amp;scene=21#wechat_redirect" textvalue="时隔5年，我们的生信技能树VIP学徒继续招生啦" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1">时隔5年，我们的生信技能树VIP学徒继续招生啦</a><br></section></li><li><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247522831&amp;idx=2&amp;sn=1744efdf428465425a145ff3a982198b&amp;chksm=9b4bdab4ac3c53a28fbecbbff4f254f470b54a7a20468bb753b295b930315e1ec45bcbabc10b&amp;scene=21#wechat_redirect" textvalue="144线程640Gb内存服务器共享一年‍仍然是仅需800" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1">144线程640Gb内存服务器共享一年仍然是仅需800</a></section></li><li><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247519765&amp;idx=1&amp;sn=ce5a8c8182f854c88043059f8c2cb9ff&amp;chksm=9b4bceaeac3c47b88c19941d43dbb1401f3a92206481a0afc41159927868199643f795d62a7e&amp;scene=21#wechat_redirect" textvalue="千呼万唤始出来的独享生物信息学云服务器" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1">千呼万唤始出来的独享生物信息学云服务器</a></section></li><li><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247519765&amp;idx=1&amp;sn=ce5a8c8182f854c88043059f8c2cb9ff&amp;chksm=9b4bceaeac3c47b88c19941d43dbb1401f3a92206481a0afc41159927868199643f795d62a7e&amp;scene=21#wechat_redirect" textvalue="千呼万唤始出来的独享生物信息学云服务器" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1"></a><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247524275&amp;idx=1&amp;sn=fa592ee29f636f34387491d0fceadd8e&amp;chksm=9b4bdf08ac3c561e0881974b3817beb0a0e514dc1a8df4c34c2b6653da6fa78e09acb03c70c2&amp;scene=21#wechat_redirect" textvalue="生信技能树知识整理实习生又又又开放申请啦" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1">生信技能树知识整理实习生又又又开放申请啦</a><span><strong>（不招了，谢谢）</strong></span></section></li><li><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247524432&amp;idx=1&amp;sn=5b33b0c6807a9e6939c332c58fabff89&amp;chksm=9b4b20ebac3ca9fdb3d8bfaf2bef5552f64eb70e7fae557cc7197fb1a23b3e8bc31b585bf829&amp;scene=21#wechat_redirect" textvalue="生信共享办公室出租" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1">生信共享办公室出租</a></p></li></ul><p><br></p><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/JtBn0iEW2N9GBK5Oj0UJqQ",target="_blank" rel="noopener noreferrer">原文链接</a>
