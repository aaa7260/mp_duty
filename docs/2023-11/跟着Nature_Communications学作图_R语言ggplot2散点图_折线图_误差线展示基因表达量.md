---
title: "跟着Nature Communications学作图：R语言ggplot2散点图/折线图/误差线展示基因表达量"
date: 2023-11-21T23:47:59Z
draft: ["false"]
tags: [
  "fetched",
  "小明的数据分析笔记本"
]
categories: ["Acdemic"]
---
跟着Nature Communications学作图：R语言ggplot2散点图/折线图/误差线展示基因表达量 by 小明的数据分析笔记本
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-mpa-powered-by="yiban.io"><h2 data-tool="mdnice编辑器"><span></span><span>论文</span><span> </span></h2><blockquote data-tool="mdnice编辑器"><p>Genomic insights into local adaptation andfuture climate-induced vulnerability of akeystone forest tree in East Asia</p></blockquote><p data-tool="mdnice编辑器">https://www.nature.com/articles/s41467-022-34206-8</p><p data-tool="mdnice编辑器">论文的代码链接</p><p data-tool="mdnice编辑器">https://github.com/jingwanglab/Populus_genomic_prediction_climate_vulnerability</p><p data-tool="mdnice编辑器">今天的推文我们尝试复现一下论文中的figure3e和figure3i</p><figure data-tool="mdnice编辑器"><img data-imgfileid="100012720" data-ratio="0.6701846965699209" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/t1wZDoUyFk6S2CmbEx1YhklyRWeStKapnmM8KXSkQTicibibe5dnqMPILAZV3wLTfVEelVqnpu07vavGKkwS87XUw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="379" src="https://mmbiz.qpic.cn/sz_mmbiz_png/t1wZDoUyFk6S2CmbEx1YhklyRWeStKapnmM8KXSkQTicibibe5dnqMPILAZV3wLTfVEelVqnpu07vavGKkwS87XUw/640?wx_fmt=png&amp;from=appmsg"><figcaption>image.png</figcaption></figure><figure data-tool="mdnice编辑器"><img data-imgfileid="100012724" data-ratio="0.6896551724137931" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/t1wZDoUyFk6S2CmbEx1YhklyRWeStKapX96ekARTSEqFXfDtSicNLcIbx8qm4FOvB31ut2MX7aGJwLxtsUjiacaQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="377" src="https://mmbiz.qpic.cn/sz_mmbiz_png/t1wZDoUyFk6S2CmbEx1YhklyRWeStKapX96ekARTSEqFXfDtSicNLcIbx8qm4FOvB31ut2MX7aGJwLxtsUjiacaQ/640?wx_fmt=png&amp;from=appmsg"><figcaption>image.png</figcaption></figure><h2 data-tool="mdnice编辑器"><span></span><span>figure3e的示例数据</span><span> </span></h2><figure data-tool="mdnice编辑器"><img data-imgfileid="100012721" data-ratio="0.5292841648590022" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/t1wZDoUyFk6S2CmbEx1YhklyRWeStKapfSmib3Ls4Jn0ODQL6EUp6ZK6e6rIXj9KZvlMLn2nDvs16mc4Cgqln6Q/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="461" src="https://mmbiz.qpic.cn/sz_mmbiz_png/t1wZDoUyFk6S2CmbEx1YhklyRWeStKapfSmib3Ls4Jn0ODQL6EUp6ZK6e6rIXj9KZvlMLn2nDvs16mc4Cgqln6Q/640?wx_fmt=png&amp;from=appmsg"><figcaption>image.png</figcaption></figure><h2 data-tool="mdnice编辑器"><span></span><span>读取数据并作图</span><span> </span></h2><pre data-tool="mdnice编辑器"><span></span><code>p1&lt;-ggplot(data = dat.fig3e,aes(x=hour,y=relative_expression))+<br>  geom_point(aes(color=base),size=5)+<br>  geom_line(aes(color=base),<br>            show.legend = FALSE)+<br>  geom_errorbar(aes(ymin=relative_expression-STD,<br>                    ymax=relative_expression+STD,color=base),<br>                width=0.4)+<br>  theme_bw(base_size = 20)+<br>  theme(panel.grid = element_blank(),<br>        legend.position = c(0.2,0.8))+<br>  scale_color_manual(values = c(<span>"ALT"</span>=<span>"#a2c0e4"</span>,<br>                                <span>"REF"</span>=<span>"#2d52a2"</span>),<br>                     labels=c(<span>"CC"</span>,<span>"TC"</span>),<br>                     name=NULL)+<br>  labs(x=<span>"Time since submergence stress"</span>,<br>       y=<span>"Expression"</span>)<br><br>p1<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100012723" data-ratio="0.9478079331941545" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/t1wZDoUyFk6S2CmbEx1YhklyRWeStKaprHOHPIJBN73eT6z5ibuuO55TPNCgK1vrDxwTLV2ayGp6nOcuaZoAVDw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="958" src="https://mmbiz.qpic.cn/sz_mmbiz_png/t1wZDoUyFk6S2CmbEx1YhklyRWeStKaprHOHPIJBN73eT6z5ibuuO55TPNCgK1vrDxwTLV2ayGp6nOcuaZoAVDw/640?wx_fmt=png&amp;from=appmsg"><figcaption>image.png</figcaption></figure><h2 data-tool="mdnice编辑器"><span></span><span>figure3i 数据截图</span><span> </span></h2><figure data-tool="mdnice编辑器"><img data-imgfileid="100012722" data-ratio="0.5221987315010571" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/t1wZDoUyFk6S2CmbEx1YhklyRWeStKapWSNUEO7Lzyw1mV6JVgWA6Wd56mhA4NbkA9Zz5n0mjv0CzZD5DAMiadQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="473" src="https://mmbiz.qpic.cn/sz_mmbiz_png/t1wZDoUyFk6S2CmbEx1YhklyRWeStKapWSNUEO7Lzyw1mV6JVgWA6Wd56mhA4NbkA9Zz5n0mjv0CzZD5DAMiadQ/640?wx_fmt=png&amp;from=appmsg"><figcaption>image.png</figcaption></figure><p data-tool="mdnice编辑器">作图代码基本和fig3e的一致</p><p data-tool="mdnice编辑器">但是这里的时间跨度从0,1,2,3突然跨到24，这样出图不是很好看，我们把24改成4，然后在坐标轴标签上再改为24</p><pre data-tool="mdnice编辑器"><span></span><code>p2&lt;-ggplot(data = dat.fig3i,aes(x=hour,y=relative_expression))+<br>  geom_point(aes(color=base),size=5)+<br>  geom_line(aes(color=base),<br>            show.legend = FALSE)+<br>  geom_errorbar(aes(ymin=relative_expression-STD,<br>                    ymax=relative_expression+STD,color=base),<br>                width=0.2)+<br>  theme_bw(base_size = 20)+<br>  theme(panel.grid = element_blank(),<br>        legend.position = c(0.2,0.8))+<br>  scale_color_manual(values = c(<span>"ALT"</span>=<span>"#e1c4c4"</span>,<br>                                <span>"REF"</span>=<span>"#b0383f"</span>),<br>                     labels=c(<span>"AA"</span>,<span>"GG"</span>),<br>                     name=NULL)+<br>  labs(x=<span>"Time since heat stress"</span>,<br>       y=<span>"Expression"</span>)+<br>  scale_x_continuous(breaks = 0:4,<br>                     labels = paste0(c(0,1,2,3,24),<span>"h"</span>))<br>p2<br><br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100012728" data-ratio="0.9474237644584648" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/t1wZDoUyFk6S2CmbEx1YhklyRWeStKapHxaYplHsQ1xGbbwRhsCI3G3Xt8RuUPjBc2oIuQNqGw6r3cA5EY73YA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="951" src="https://mmbiz.qpic.cn/sz_mmbiz_png/t1wZDoUyFk6S2CmbEx1YhklyRWeStKapHxaYplHsQ1xGbbwRhsCI3G3Xt8RuUPjBc2oIuQNqGw6r3cA5EY73YA/640?wx_fmt=png&amp;from=appmsg"><figcaption>image.png</figcaption></figure><h2 data-tool="mdnice编辑器"><span></span><span>最后是将两个图组合到一起</span><span> </span></h2><pre data-tool="mdnice编辑器"><span></span><code>library(patchwork)<br><br>p1+p2<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100012729" data-ratio="0.42685185185185187" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/t1wZDoUyFk6S2CmbEx1YhklyRWeStKapqTT2vXNjyb3cXyytnjCb6t5HsYa2GB2gEQDedVUK3gWTcVfG2P5yXg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/t1wZDoUyFk6S2CmbEx1YhklyRWeStKapqTT2vXNjyb3cXyytnjCb6t5HsYa2GB2gEQDedVUK3gWTcVfG2P5yXg/640?wx_fmt=png&amp;from=appmsg"><figcaption>image.png</figcaption></figure><blockquote data-tool="mdnice编辑器"><p>示例数据和代码可以给推文打赏一元获取</p></blockquote><p data-tool="mdnice编辑器"><strong>欢迎大家关注我的公众号</strong></p><p data-tool="mdnice编辑器"><strong>小明的数据分析笔记本</strong><br></p><section><mp-common-profile data-pluginname="mpprofile" data-id="MzI3NzQ3MTcxMg==" data-headimg="http://mmbiz.qpic.cn/mmbiz_png/t1wZDoUyFk5t1sOnM0iabvBhnfIj5YpyqrMib0E1MGCd9ibcYxaOPZd0GWhQBDvK2BPEwsicQxd6y5MHLfphnwHnow/0?wx_fmt=png" data-nickname="小明的数据分析笔记本" data-alias="" data-signature="分享R语言和python在生物信息领域做数据分析和数据可视化的简单小例子；偶尔会分享一些组学数据处理相关的内容" data-from="0" data-is_biz_ban="0"></mp-common-profile></section><p data-tool="mdnice编辑器"><strong></strong></p><blockquote data-tool="mdnice编辑器"><p>小明的数据分析笔记本 公众号 主要分享：1、R语言和python做数据分析和数据可视化的简单小例子；2、园艺植物相关转录组学、基因组学、群体遗传学文献阅读笔记；3、生物信息学入门学习资料及自己的学习笔记！</p></blockquote></section><p><br></p><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/-Sz6WHAJ-k9w9M7VUDTB8w",target="_blank" rel="noopener noreferrer">原文链接</a>
