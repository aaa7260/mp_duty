---
title: "R中稀奇古怪的代码报错"
date: 2023-11-11T14:01:13Z
draft: ["false"]
tags: [
  "fetched",
  "R语言数据分析指南"
]
categories: ["Acdemic"]
---
R中稀奇古怪的代码报错 by R语言数据分析指南
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><h3 data-tool="mdnice编辑器"><span></span><span><span></span>欢迎关注R语言数据分析指南</span><span></span></h3><blockquote data-tool="mdnice编辑器"><span>❝</span><p>最近偶尔遇到个别朋友询问运行代码报错的情况，各种情况都有但是长久的情景几乎是一致。本节来解答一下遇到这些该如何执行。个人观点仅供参考</p><span>❞</span></blockquote><h3 data-tool="mdnice编辑器"><span></span><span><span></span>关于永久群内容的说明</span><span></span></h3><blockquote data-tool="mdnice编辑器"><span>❝</span><p>给予长期支持我们的忠实读者们一个特别待遇：凡是购买过小编2022年或2023年VIP会员文档的朋友们，<strong>「将自动获得2024年及以后的绘图资料和代码更新，无需额外付费。」</strong>目前这两年的会员文档已累记卖出1500+，质量方面各位无需担忧**。简要概括就是只要购买任意1年的会员内容，后面公众号所更新的绘图文档均会在已经加入的会员群内分享。</p><span>❞</span></blockquote><h3 data-tool="mdnice编辑器"><span></span><span><span></span>案例1</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code>rlang::last_trace()<br></code></pre><p data-tool="mdnice编辑器">没有明显的错误出现，但是却有跟rlang相关的字符，这多半是tidyverse版本的问题，此时重新安装tidyverse即可</p><h3 data-tool="mdnice编辑器"><span></span><span><span></span>案例2</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code>Error in voronoi_treemap(hoursPerDayCombined ~ Category + Subcategory,  : <br>  could not find function "voronoi_treemap"<br></code></pre><p data-tool="mdnice编辑器">遇到上述情况多半是未加载需要的包，可通过网络检索该函数即可得知所对应的R包</p><h3 data-tool="mdnice编辑器"><span></span><span><span></span>案例3</span><span></span></h3><blockquote data-tool="mdnice编辑器"><span>❝</span><p>一堆警告信息就是报错不出图，遇到这种情况多半是所使用的R包作者进行了更新，这种情况尤其是在<strong>「github」</strong>上发布的R包常出现，因此可去作者github主页查看最新的更新情况，一般都会有案例说明。</p><span>❞</span></blockquote><h3 data-tool="mdnice编辑器"><span></span><span><span></span>案例4</span><span></span></h3><blockquote data-tool="mdnice编辑器"><span>❝</span><p>毫无头绪的报错，数据处理后就是无结果反馈。这种情况就比较复杂了，有可能是R包之间函数冲突，有可能是版本问题，更甚者是电脑性能的问题。下面举个实际例子来进行说明</p><span>❞</span></blockquote><h3 data-tool="mdnice编辑器"><span></span><span><span></span>案例图</span><span></span></h3><figure data-tool="mdnice编辑器"><img data-ratio="0.8842592592592593" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAaEoqeSmcAxfINlG72bMHiclbSia2524K4cG7UJY2MqN2XyrF6hZwNdKvT30GfibJHCfHw9HmqOo26BQ/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAaEoqeSmcAxfINlG72bMHiclbSia2524K4cG7UJY2MqN2XyrF6hZwNdKvT30GfibJHCfHw9HmqOo26BQ/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">此图为小编2023年9月25日公众号发布的一篇文档图，此次在原有代码的基础上做了简化，代码如下</p><h3 data-tool="mdnice编辑器"><span></span><span><span></span>加载R包</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code>library(tidyverse)<br>library(ggtext)<br>library(glue)<br>#install.packages("rcartocolor")<br>library(rcartocolor)<br># devtools::install_github("AllanCameron/VoronoiPlus")<br>library(VoronoiPlus)<br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span><span></span>导入数据</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code>all_countries &lt;- read_csv(<span>"all_countries.csv"</span>)<br>country_regions &lt;- read_csv(<span>"country_regions.csv"</span>)<br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span><span></span>数据清洗</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code>au_data &lt;- all_countries |&gt; <br>  select(Category, Subcategory, hoursPerDayCombined, country_iso3) |&gt; <br>  left_join(country_regions, by = <span>"country_iso3"</span>) |&gt; <br>  filter(country_name == <span>"Australia"</span>) |&gt; <br>  select(Category, Subcategory, hoursPerDayCombined)<br><br>au_vor &lt;- voronoi_treemap(hoursPerDayCombined ~ Category + Subcategory,<br>                          data = au_data)<br><br>set.seed(<span>1234</span>)<br>groups &lt;- filter(au_vor, level == <span>1</span>)<br><br>subgroups &lt;- filter(au_vor, level == <span>2</span>) |&gt; <br>  group_by(group) |&gt; <br>  mutate(alpha = runif(<span>1</span>, <span>0</span>, <span>0.6</span>)) |&gt; <br>  ungroup()<br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span><span></span>定义颜色</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code>cols_vec = rcartocolor::carto_pal(length(unique(au_data$Category))+<span>1</span>, <span>"Prism"</span>)[<span>1</span>:length(unique(au_data$Category))]<br>names(cols_vec) = unique(au_data$Category)<br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span><span></span>数据可视化</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code>ggplot() +<br>  geom_polygon(data = groups,mapping = aes(x = x, y = y, group = group, fill = group),<br>               colour = <span>"white"</span>,linewidth = <span>5</span>) +<br>  geom_polygon(data = subgroups,<br>               mapping = aes(x = x, y = y, group = group, alpha = alpha),<br>               fill = <span>"#fafafa"</span>,colour = <span>"#fafafa"</span>,linewidth = <span>0.3</span>) +<br>  geom_text(data = groups %&gt;% group_by(group) %&gt;% <br>              summarize(x = mean(x), y = mean(y)),<br>            aes(label=group,x,y),color=<span>"black"</span>) +<br>  scale_alpha_identity() +<br>  scale_fill_manual(values = cols_vec) +<br>  coord_equal() +<br>  theme_void(base_size = <span>12</span>) +<br>  theme(legend.position = <span>"non"</span>,<br>    plot.background = element_rect(fill = <span>"white"</span>, colour = <span>"white"</span>),<br>    panel.background = element_rect(fill = <span>"white"</span>, colour = <span>"white"</span>),<br>    plot.margin = margin(<span>10</span>, <span>10</span>, <span>10</span>, <span>10</span>))<br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span><span></span>代码问题</span><span></span></h3><blockquote data-tool="mdnice编辑器"><span>❝</span><p>最近有朋友反馈此图运行代码有问题，但是部分朋友表示可以正常出图，小编很是疑惑；一番检查后终于是找到了问题所在，此段代码小编在一台高性能电脑上可以丝滑出图，但是放到5年前的老电脑上就会出现如下报错，果然R代码的报错真是难以让人琢磨，<strong>「也许这就是提示该换电脑了」</strong></p><span>❞</span></blockquote><figure data-tool="mdnice编辑器"><img data-ratio="0.2687074829931973" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/EibnicgwScTAaEoqeSmcAxfINlG72bMHiclyOQpCU6pZR9vrHSF7AcwnRiarTDt7WxO2lHoZiaicxSEsCbwiaAPMibzqdw/640?wx_fmt=jpeg" data-type="jpeg" data-w="882" src="https://mmbiz.qpic.cn/mmbiz_jpg/EibnicgwScTAaEoqeSmcAxfINlG72bMHiclyOQpCU6pZR9vrHSF7AcwnRiarTDt7WxO2lHoZiaicxSEsCbwiaAPMibzqdw/640?wx_fmt=jpeg"></figure><h3 data-tool="mdnice编辑器"><span></span><span><span></span>2023案例图展示</span><span></span></h3><p data-tool="mdnice编辑器"><img data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAaEoqeSmcAxfINlG72bMHiclIALlCSMpr9hJIVtibWBK9vLvGkDicJnWYOdcGvlmtfeqmA1194KGU5UA/640?wx_fmt=png" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAaEoqeSmcAxfINlG72bMHiclIALlCSMpr9hJIVtibWBK9vLvGkDicJnWYOdcGvlmtfeqmA1194KGU5UA/640?wx_fmt=png"><img data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAaEoqeSmcAxfINlG72bMHicl0OON6vu2HKcQYYTp8n7Q4ic6EVtaKliaRQbVbjZIuSdggFhcvmWjSxYg/640?wx_fmt=png" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAaEoqeSmcAxfINlG72bMHicl0OON6vu2HKcQYYTp8n7Q4ic6EVtaKliaRQbVbjZIuSdggFhcvmWjSxYg/640?wx_fmt=png"><img data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAaEoqeSmcAxfINlG72bMHiclx0qRe3bXk8Ria6dbUleKTzAto5GqKGOHkqO6URxicBtLY86ULZeWwyAA/640?wx_fmt=png" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAaEoqeSmcAxfINlG72bMHiclx0qRe3bXk8Ria6dbUleKTzAto5GqKGOHkqO6URxicBtLY86ULZeWwyAA/640?wx_fmt=png"><img data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAaEoqeSmcAxfINlG72bMHiclrJUS1wB0VICUVtuqPyxLuAyiab0hgIEMj88A96NlCSiaTjiaFIMBaV8Bw/640?wx_fmt=png" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAaEoqeSmcAxfINlG72bMHiclrJUS1wB0VICUVtuqPyxLuAyiab0hgIEMj88A96NlCSiaTjiaFIMBaV8Bw/640?wx_fmt=png"><img data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAaEoqeSmcAxfINlG72bMHiclBHvLBwda4CQ0yWxY67CwEcqEbT8AhsFdOVicYFjcsX0fXUXEgPUIBPA/640?wx_fmt=png" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAaEoqeSmcAxfINlG72bMHiclBHvLBwda4CQ0yWxY67CwEcqEbT8AhsFdOVicYFjcsX0fXUXEgPUIBPA/640?wx_fmt=png"><img data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAaEoqeSmcAxfINlG72bMHicl0BLX2FaTlD5a5vvKq602jfwGJJmcdaM8203UDpWKCDvgIFojjNUgVQ/640?wx_fmt=png" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAaEoqeSmcAxfINlG72bMHicl0BLX2FaTlD5a5vvKq602jfwGJJmcdaM8203UDpWKCDvgIFojjNUgVQ/640?wx_fmt=png"><img data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAaEoqeSmcAxfINlG72bMHiclKbNYia5N3pfPcQrP4LwS4HvmWXXggvuoSMwAjSyusPlG7LoIWklpjbA/640?wx_fmt=png" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAaEoqeSmcAxfINlG72bMHiclKbNYia5N3pfPcQrP4LwS4HvmWXXggvuoSMwAjSyusPlG7LoIWklpjbA/640?wx_fmt=png"><img data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAaEoqeSmcAxfINlG72bMHicl5Yk6h2VGgXWiae8T1Hic3ichW7oTqsticuZEHCtFAOaxOaKn4iaNyujB29A/640?wx_fmt=png" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAaEoqeSmcAxfINlG72bMHicl5Yk6h2VGgXWiae8T1Hic3ichW7oTqsticuZEHCtFAOaxOaKn4iaNyujB29A/640?wx_fmt=png"><img data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAaEoqeSmcAxfINlG72bMHiclvUa3xIfWINFazpibgnbrwmCReCMGZ7QenzQK17Dbdk2MuLlTSuAUc9w/640?wx_fmt=png" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAaEoqeSmcAxfINlG72bMHiclvUa3xIfWINFazpibgnbrwmCReCMGZ7QenzQK17Dbdk2MuLlTSuAUc9w/640?wx_fmt=png"><img data-ratio="0.6175925925925926" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAaEoqeSmcAxfINlG72bMHiclQpicWqSby77hIUEmhdqLcnOHlTprP6HUPIicGW2nWTXXZ93c0v8uJstQ/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAaEoqeSmcAxfINlG72bMHiclQpicWqSby77hIUEmhdqLcnOHlTprP6HUPIicGW2nWTXXZ93c0v8uJstQ/640?wx_fmt=png"></p><blockquote data-tool="mdnice编辑器"><span>❝</span><p>有需要学习数据可视化的朋友，欢迎到小编的<strong>「淘宝店铺」</strong> <strong>「R语言数据分析指南」</strong>下单购买，内容主要包括各种<strong>「高分论文的图表分析复现以及一些个性化图表的绘制」</strong>均包含数据+代码；</p><span>❞</span></blockquote><p data-tool="mdnice编辑器">购买后微信发小编订单截图即邀请进新的会员交流群，无论购买那一年的会员文档都将获取<strong>「2024年及以后更新的绘图文档」</strong>，早买早享受，需要了解更多信息的朋友欢迎淘宝店铺交流咨询。</p><h3 data-tool="mdnice编辑器"><span></span><span><span></span>淘宝扫一扫</span><span></span></h3><p><img data-croporisrc="https://mmbiz.qpic.cn/mmbiz_jpg/EibnicgwScTAbHbWpAoGOP2icXGDsjm40BJLkh8ib9mUkNvxOiaxmz74xZd3kcSPXu7OvzZ4KJgLyMxiaS53SV4k3DuA/0?wx_fmt=jpeg" data-cropx1="118.89075630252101" data-cropx2="1067.5399159663866" data-cropy1="386.3949579831933" data-cropy2="1867.5756302521008" data-galleryid="" data-ratio="1.559536354056902" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/EibnicgwScTAaEoqeSmcAxfINlG72bMHiclvtFC9qK7hd08zq2KvUwHrwjHM7YMnDRk4yZI6TdplI5lRCdYne0mBQ/640?wx_fmt=jpeg" data-type="jpeg" data-w="949" src="https://mmbiz.qpic.cn/mmbiz_jpg/EibnicgwScTAaEoqeSmcAxfINlG72bMHiclvtFC9qK7hd08zq2KvUwHrwjHM7YMnDRk4yZI6TdplI5lRCdYne0mBQ/640?wx_fmt=jpeg"></p><h3 data-tool="mdnice编辑器"><span></span><span><span></span>淘宝店铺(有需要欢迎关注)</span><span></span></h3><p><img data-galleryid="" data-ratio="1.0210420841683367" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/EibnicgwScTAbvhPDLGT8NaialEsht92PTYNJWpmVLfoYGic1uha5FyBrDCibibZCLjiazgvpT1XcdwibfVywD2el0VAgg/640?wx_fmt=jpeg" data-type="jpeg" data-w="998" src="https://mmbiz.qpic.cn/mmbiz_jpg/EibnicgwScTAbvhPDLGT8NaialEsht92PTYNJWpmVLfoYGic1uha5FyBrDCibibZCLjiazgvpT1XcdwibfVywD2el0VAgg/640?wx_fmt=jpeg"></p><h3 data-tool="mdnice编辑器"><span></span><span><span></span>关注下方公众号下回更新不迷路</span><span></span></h3><section><mp-common-profile data-pluginname="mpprofile" data-id="Mzg3MzQzNTYzMw==" data-headimg="http://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZF0rpeZII9Ltl26VbVagriczTria1fib3XgjwwHEHFjPzkmGpqWDVVHBSzhENictUM2iavAKiaM5lc9USw/0?wx_fmt=png" data-nickname="R语言数据分析指南" data-alias="YanJANtwo" data-signature="R语言重症爱好者，喜欢绘制各种精美的图表，喜欢的小伙伴可以关注我，跟我一起学习" data-from="0" data-is_biz_ban="0"></mp-common-profile></section><p data-tool="mdnice编辑器"><br></p></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/rZ5-dit05lJUfurlB37zLg",target="_blank" rel="noopener noreferrer">原文链接</a>
