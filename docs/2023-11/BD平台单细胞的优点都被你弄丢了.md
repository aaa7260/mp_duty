---
title: "BD平台单细胞的优点都被你弄丢了"
date: 2023-11-11T08:57:09Z
draft: ["false"]
tags: [
  "fetched",
  "单细胞天地"
]
categories: ["Acdemic"]
---
BD平台单细胞的优点都被你弄丢了 by 单细胞天地
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><blockquote data-tool="mdnice编辑器"><p>因为众所周知的原因（详见：<a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247525708&amp;idx=1&amp;sn=ba37c684839bd909bb7ed0f98cefaf13&amp;scene=21#wechat_redirect" data-linktype="2"> 很抱歉我这里没有朝九晚五 </a>，以及<a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247525953&amp;idx=1&amp;sn=3d50570a5c8aa766d7a57a28d09431e3&amp;scene=21#wechat_redirect" data-linktype="2">得了吧，不缺你这点关注</a> ），我现在是没有实习生了。但是我还有学徒，所以可以在培养 他们的同时，给他们布置一些数据分析实战任务。</p></blockquote><p data-tool="mdnice编辑器">这次我给学徒布置了一个非小细胞肺癌的免疫治疗的单细胞转录组数据，文章是2023的《Tumor microenvironment remodeling  after neoadjuvant immunotherapy in non-small cell lung cancer revealed by single-cell RNA sequencing》，因为我注意到里面的降维聚类分群有大量的中性粒细胞，如下所示：</p><p><img data-galleryid="" data-ratio="0.7830188679245284" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjTH95epGvBklwYibNlSP3AoM9icusOY5ExoIMAM79yA7QhvSsicaw8DrfFhKlTqW2s3DIIhz6uyU07YA/640?wx_fmt=png" data-type="png" data-w="848" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjTH95epGvBklwYibNlSP3AoM9icusOY5ExoIMAM79yA7QhvSsicaw8DrfFhKlTqW2s3DIIhz6uyU07YA/640?wx_fmt=png"></p><figure data-tool="mdnice编辑器"><figcaption>大量的中性粒细胞</figcaption></figure><p data-tool="mdnice编辑器">这个中性粒细胞是BD平台的特色，很容易检索到：</p><p><img data-galleryid="" data-ratio="0.8009259259259259" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjTH95epGvBklwYibNlSP3AoMOWBIUMqpksm6icwPicegeOY2tibhBAEPyqhWKhY7CXiaNsYxRhKxtxbDBQ/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjTH95epGvBklwYibNlSP3AoMOWBIUMqpksm6icwPicegeOY2tibhBAEPyqhWKhY7CXiaNsYxRhKxtxbDBQ/640?wx_fmt=png"></p><figure data-tool="mdnice编辑器"><figcaption>这个中性粒细胞是BD平台的特色</figcaption></figure><p data-tool="mdnice编辑器">而且它的数据是公开的，在GSE207422，链接是；https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE207422</p><pre data-tool="mdnice编辑器"><span></span><code>Supplementary file Size Download File <span>type</span>/resource<br>GSE207422_NSCLC_bulk_RNAseq_log2TPM.txt.gz 5.4 Mb (ftp)(http) TXT<br>GSE207422_NSCLC_bulk_RNAseq_metadata.xlsx 11.8 Kb (ftp)(http) XLSX<br>GSE207422_NSCLC_scRNAseq_UMI_matrix.txt.gz 175.5 Mb (ftp)(http) TXT<br>GSE207422_NSCLC_scRNAseq_metadata.xlsx 11.1 Kb (ftp)(http) XLSX<br></code></pre><p data-tool="mdnice编辑器">有了上面的文件，很容易根据我教大家的单细胞转录组数据分析流程来完成上面的图表复现。但是我拿到了学徒给我的结果后就傻眼了，完全是看不到中性粒细胞啊， 也就是说BD平台单细胞的优点都被你弄丢了。。。</p><p><img data-galleryid="" data-ratio="1.175" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjTH95epGvBklwYibNlSP3AoMsHeUbqEqjlRv0FFCgENJKhg0LneBc7XwqoUmSKOnSBykLoFEGRdibUg/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjTH95epGvBklwYibNlSP3AoMsHeUbqEqjlRv0FFCgENJKhg0LneBc7XwqoUmSKOnSBykLoFEGRdibUg/640?wx_fmt=png"></p><figure data-tool="mdnice编辑器"><figcaption>完全是看不到中性粒细胞</figcaption></figure><p data-tool="mdnice编辑器">通常我们拿到了肿瘤相关的单细胞转录组的表达量矩阵后的第一层次降维聚类分群通常是：</p><ul data-tool="mdnice编辑器"><li><section>immune (CD45+,PTPRC),</section></li><li><section>epithelial/cancer (EpCAM+,EPCAM),</section></li><li><section>stromal (CD10+,MME,fibo or CD31+,PECAM1,endo)</section></li></ul><p data-tool="mdnice编辑器">参考我前面介绍过 <a href="https://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247488940&amp;idx=1&amp;sn=1cc8a8a74715087939b9721c0881775d&amp;scene=21#wechat_redirect" data-linktype="2">CNS图表复现08—肿瘤单细胞数据第一次分群通用规则</a>，这3大单细胞亚群构成了肿瘤免疫微环境的复杂。绝大部分文章都是抓住免疫细胞亚群进行细分，包括淋巴系（T,B,NK细胞）和髓系（单核，树突，巨噬，粒细胞）的两大类作为第二次细分亚群。但是也有不少文章是抓住stromal 里面的fibo 和endo进行细分，并且编造生物学故事的。</p><p data-tool="mdnice编辑器">我们前面已经对免疫细胞里面的髓系和B细胞细分亚群进行了简单的介绍：</p><ul data-tool="mdnice编辑器"><li><section><a href="https://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247506948&amp;idx=1&amp;sn=025d7f91abfa1b68d7910c86cf709e43&amp;scene=21#wechat_redirect" data-linktype="2">B细胞细分亚群</a></section></li><li><section><a href="https://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247506971&amp;idx=1&amp;sn=f0242285e2c827d922f938d9858d4ffe&amp;scene=21#wechat_redirect" data-linktype="2">髓系免疫细胞细分亚群</a></section></li></ul><p data-tool="mdnice编辑器">但是之前的髓系免疫细胞细分的时候其实并没有中性粒细胞亚群，它也一直不在我们分享的单细胞数据处理代码里面。这次既然是学徒失败了，那我们就一起看看是不是学徒的哪个步骤有问题。。。。</p><h3 data-tool="mdnice编辑器"><span></span>首先查看中性粒细胞的特异性基因<span></span></h3><p data-tool="mdnice编辑器">我把分辨率调很高，发现也是没有中性粒细胞的特异性基因的高表达亚群，如下所示：</p><p><img data-galleryid="" data-ratio="0.33796296296296297" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjTH95epGvBklwYibNlSP3AoMb8Xaw5yjW1TQDJMhkrs0BpMbIFLbqxbLkyJe7q8l2IXMoycy72K0Sw/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjTH95epGvBklwYibNlSP3AoMb8Xaw5yjW1TQDJMhkrs0BpMbIFLbqxbLkyJe7q8l2IXMoycy72K0Sw/640?wx_fmt=png"></p><figure data-tool="mdnice编辑器"><figcaption>分辨率调很高</figcaption></figure><p data-tool="mdnice编辑器">如果要查看中性粒细胞的特异性基因代码也很简单：</p><pre data-tool="mdnice编辑器"><span></span><code>th=theme(axis.text.x = element_text(angle = <span>45</span>, <br>                                    vjust = <span>0.5</span>, hjust=<span>0.5</span>))  <br>myeloids = list(<br>  Mac=c(<span>"C1QA"</span>,<span>"C1QB"</span>,<span>"C1QC"</span>,<span>"SELENOP"</span>,<span>"RNASE1"</span>,<span>"DAB2"</span>,<span>"LGMN"</span>,<span>"PLTP"</span>,<span>"MAF"</span>,<span>"SLCO2B1"</span>),<br>  mono=c(<span>"VCAN"</span>,<span>"FCN1"</span>,<span>"CD300E"</span>,<span>"S100A12"</span>,<span>"EREG"</span>,<span>"APOBEC3A"</span>,<span>"STXBP2"</span>,<span>"ASGR1"</span>,<span>"CCR2"</span>,<span>"NRG1"</span>),<br>  neutrophils =  c(<span>"FCGR3B"</span>,<span>"CXCR2"</span>,<span>"SLC25A37"</span>,<span>"G0S2"</span>,<span>"CXCR1"</span>,<span>"ADGRG3"</span>,<span>"PROK2"</span>,<span>"STEAP4"</span>,<span>"CMTM2"</span> ),<br>  pDC = c(<span>"GZMB"</span>,<span>"SCT"</span>,<span>"CLIC3"</span>,<span>"LRRC26"</span>,<span>"LILRA4"</span>,<span>"PACSIN1"</span>,<span>"CLEC4C"</span>,<span>"MAP1A"</span>,<span>"PTCRA"</span>,<span>"C12orf75"</span>),<br>  DC1 = c(<span>"CLEC9A"</span>,<span>"XCR1"</span>,<span>"CLNK"</span>,<span>"CADM1"</span>,<span>"ENPP1"</span>,<span>"SNX22"</span>,<span>"NCALD"</span>,<span>"DBN1"</span>,<span>"HLA-DOB"</span>,<span>"PPY"</span>),<br>  DC2=c( <span>"CD1C"</span>,<span>"FCER1A"</span>,<span>"CD1E"</span>,<span>"AL138899.1"</span>,<span>"CD2"</span>,<span>"GPAT3"</span>,<span>"CCND2"</span>,<span>"ENHO"</span>,<span>"PKIB"</span>,<span>"CD1B"</span>),<br>  DC3 =  c(<span>"HMSD"</span>,<span>"ANKRD33B"</span>,<span>"LAD1"</span>,<span>"CCR7"</span>,<span>"LAMP3"</span>,<span>"CCL19"</span>,<span>"CCL22"</span>,<span>"INSM1"</span>,<span>"TNNT2"</span>,<span>"TUBB2B"</span>)<br>)<br>p &lt;- DotPlot(sce.all, features = myeloids,<br>             assay=<span>'RNA'</span> ,group.by = <span>'celltype'</span> )  +th<br><br>p<br>ggsave(plot=p, filename=<span>"check_myeloids_marker_by_celltype.pdf"</span>,width = <span>15</span>) <br>p &lt;- DotPlot(sce.all, features = myeloids,<br>             assay=<span>'RNA'</span> ,group.by = <span>'RNA_snn_res.0.8'</span> )  +th<br><br>p<br>ggsave(plot=p, filename=<span>"check_myeloids_marker_by_RNA_snn_res.0.8.pdf"</span>,<br>       width = <span>15</span>) <br></code></pre><p data-tool="mdnice编辑器">可以看到，我使用了 RNA_snn_res.0.8 这样的分辨率，仍然是看不到特异性中性粒细胞亚群。</p><p data-tool="mdnice编辑器">这就让我很诧异，前些天就遇到了：<a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247525067&amp;idx=1&amp;sn=acba7512887f0b4def526dcfc56caf74&amp;scene=21#wechat_redirect" data-linktype="2">BD单细胞转录组分析怕不是一个笑话吧</a>，是那个数据集GSE201088的文章作者自己把bd单细胞转录组数据分析做错了，并不是bd单细胞本身问题， 这次难道又是文章作者问题？</p><p data-tool="mdnice编辑器">但是我细看2023的《Tumor microenvironment remodeling  after neoadjuvant immunotherapy in non-small cell lung cancer revealed by single-cell RNA sequencing》，文章里面其实是有数量不少的中性粒细胞啊，那就是学徒自己的数据处理问题。但是学徒使用的是我的标准代码，这个代码我处理了市面上一千多个单细胞公共数据集，没有遇到问题，这次怎么就不对了呢？</p><p data-tool="mdnice编辑器">我就帮学徒打开我的代码调试了一下，发现出现在过滤参数，文章描述的有如下所示的 过滤：</p><p><img data-galleryid="" data-ratio="0.8752941176470588" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjTH95epGvBklwYibNlSP3AoMbQ0WKpvNvCRKn58xgQP8ibTwOVWU9EEyGp2iaraZo1M2hEbBuhnatRIg/640?wx_fmt=png" data-type="png" data-w="850" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjTH95epGvBklwYibNlSP3AoMbQ0WKpvNvCRKn58xgQP8ibTwOVWU9EEyGp2iaraZo1M2hEbBuhnatRIg/640?wx_fmt=png"></p><figure data-tool="mdnice编辑器"><figcaption>过滤参数</figcaption></figure><p data-tool="mdnice编辑器">可以看到，里面其实是并没有核糖体的阈值，而我们的标准代码里面：</p><pre data-tool="mdnice编辑器"><span></span><code>  <span>#过滤指标2:线粒体/核糖体基因比例(根据上面的violin图)</span><br>  selected_mito &lt;- WhichCells(input_sce.filt, expression = percent_mito &lt; <span>25</span>)<br>  selected_ribo &lt;- WhichCells(input_sce.filt, expression = percent_ribo &gt; <span>3</span>)<br>  selected_hb &lt;- WhichCells(input_sce.filt, expression = percent_hb &lt; <span>1</span> )<br></code></pre><p data-tool="mdnice编辑器">只需要我注释掉这个核糖体过滤的代码，接下来的降维聚类分群就正常了，如下所示：</p><p><img data-galleryid="" data-ratio="1.0740740740740742" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjTH95epGvBklwYibNlSP3AoM4SiaIv8ztwhlY27nqbBdBgMibUFkpaBMQefqsZ3OmYjmeTWuia34F3L0A/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjTH95epGvBklwYibNlSP3AoM4SiaIv8ztwhlY27nqbBdBgMibUFkpaBMQefqsZ3OmYjmeTWuia34F3L0A/640?wx_fmt=png"></p><figure data-tool="mdnice编辑器"><figcaption>降维聚类分群就正常了</figcaption></figure><p data-tool="mdnice编辑器">可以看到是非常清晰的中性粒细胞的特异性基因的高表达亚群，如下所示：</p><p><img data-galleryid="" data-ratio="0.3527777777777778" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjTH95epGvBklwYibNlSP3AoM61oJ7PRdCU5yTscdosBaQsvjib4FBDc3emS8RInRAgyibHHvmQywzy5g/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjTH95epGvBklwYibNlSP3AoM61oJ7PRdCU5yTscdosBaQsvjib4FBDc3emS8RInRAgyibHHvmQywzy5g/640?wx_fmt=png"></p><figure data-tool="mdnice编辑器"><figcaption> </figcaption></figure><p data-tool="mdnice编辑器">仍然是手动定义了单细胞亚群的生物学名字：</p><pre data-tool="mdnice编辑器"><span></span><code> <span>#定义细胞亚群        </span><br>  celltype[celltype$ClusterID %<span>in</span>% c( <span>0</span>,<span>17</span>,<span>19</span>,<span>21</span> ),<span>2</span>]=<span>'Tcells'</span> <br>  celltype[celltype$ClusterID %<span>in</span>% c( <span>3</span> ),<span>2</span>]=<span>'Bcells'</span> <br>  celltype[celltype$ClusterID %<span>in</span>% c( <span>7</span> ),<span>2</span>]=<span>'plasma'</span> <br>  celltype[celltype$ClusterID %<span>in</span>% c( <span>2</span>,<span>5</span>,<span>6</span>   ),<span>2</span>]= <span>'myeloids'</span> <span># </span><br>  celltype[celltype$ClusterID %<span>in</span>% c( <span>1</span>,<span>23</span>),<span>2</span>]=<span>'neutrophils'</span><br>  <br>  celltype[celltype$ClusterID %<span>in</span>% c( <span>14</span>),<span>2</span>]=<span>'mast'</span><br>  celltype[celltype$ClusterID %<span>in</span>% c( <span>11</span> ),<span>2</span>]=<span>'stromal'</span> <br>  celltype[celltype$ClusterID %<span>in</span>% c( <span>20</span> ),<span>2</span>]=<span>'endo'</span><br>  celltype[celltype$ClusterID %<span>in</span>% c(<span>8</span>,<span>12</span>,<span>16</span>,<span>22</span>),<span>2</span>]=<span>'cycle'</span>   <br></code></pre><h3 data-tool="mdnice编辑器"><span></span>初学者不仔细就容易遇到各种各样的问题<span></span></h3><p data-tool="mdnice编辑器">我们五年前就系统性整理了全部的单细胞转录组数据分析代码，它理论上是可以应用于几乎所有的单细胞数据集，因为几乎所有的单细胞转录组数据都来源于10x单细胞平台，但是这样的bd单细胞平台，就需要一定程度的自定义了。。。。</p><p data-tool="mdnice编辑器">核心代码如下所示：</p><pre data-tool="mdnice编辑器"><span></span><code><span>## </span><br><span>### ---------------</span><br><span>###</span><br><span>### Create: Jianming Zeng</span><br><span>### Date:  2023-01-16 20:53:22</span><br><span>### Email: jmzeng1314@163.com</span><br><span>### Blog: http://www.bio-info-trainee.com/</span><br><span>### Forum:  http://www.biotrainee.com/thread-1376-1-1.html</span><br><span>### CAFS/SUSTC/Eli Lilly/University of Macau</span><br><span>### Update Log: 2023-01-16  First version </span><br><span>###</span><br><span>### ---------------</span><br><br><br>rm(list=ls())<br>options(stringsAsFactors = <span>F</span>) <br><span>source</span>(<span>'scRNA_scripts/lib.R'</span>)<br><span>library</span>(readxl)<br><br><span>###### step1:导入数据 ######   </span><br><span># 付费环节 800 元人民币</span><br>ct=fread( <span>'GSE207422_RAW/GSE207422_NSCLC_scRNAseq_UMI_matrix.txt.gz'</span>,<br>          data.table = <span>F</span>)<br>ct[<span>1</span>:<span>4</span>,<span>1</span>:<span>4</span>]<br>ct[nrow(ct),<span>1</span>:<span>4</span>]<br>rownames(ct)=ct[,<span>1</span>]<br>ct=ct[,-<span>1</span>]<br>ct[<span>1</span>:<span>4</span>,<span>1</span>:<span>4</span>]<br>ct1 = ct<br>s &lt;- colnames(ct1)<br>s[<span>1</span>:<span>10</span>]<br>s1 = substr(s, <span>1</span>, <span>11</span>)<br>s1[<span>1</span>:<span>10</span>]<br>table(s1)<br>colnames(ct1) = s1<br>dim(ct1)<br><span># [1] 24292 92330</span><br><span># 这个时候的细胞数量跟文章一致</span><br><span># After quality control and removal of doublets, </span><br><span># transcriptomes from 92,330 cells with a median of 1256 genes per cell </span><br><span># were used for further analyses.</span><br><br>meta &lt;- read_excel(<span>"GSE207422_RAW/GSE207422_NSCLC_scRNAseq_metadata.xlsx"</span>)<br><br>sce.all = CreateSeuratObject(counts =  ct1 , <br>                             min.cells = <span>5</span>,<br>                             min.features = <span>500</span>)<br>sce.all<br>as.data.frame(sce.all@assays$RNA@counts[<span>1</span>:<span>10</span>, <span>1</span>:<span>2</span>])<br>head(sce.all@meta.data, <span>10</span>)<br>table(sce.all@meta.data$orig.ident) <br><br>s = colnames(sce.all)<br>s1 = substr(s, <span>1</span>, <span>11</span>)<br>s1[<span>1</span>:<span>10</span>]<br>table(s1)<br>sce.all$orig.ident = s1<br>table(sce.all$orig.ident )<br><br><br>s1 = gsub(c(<span>'BD_immune01|BD_immune05|BD_immune08'</span>),<span>"Pre-treatment"</span>,s1)<br>table(s1)<br>s2 = gsub(<span>"BD_immune.*$"</span>, <span>"Post-treatment"</span>, s1) <span>#第一个空格直达结尾替换成b</span><br>table(s2)<br><br>phe=str_split(  colnames(sce.all) ,<span>'_'</span>,simplify = <span>T</span>)<br>head(phe)<br>table(phe[,<span>1</span>]) <br><br>sce.all$group = s2<br>head(sce.all@meta.data) <br>table(sce.all$group)<br>table(sce.all$orig.ident)<br>gplots::balloonplot(table(sce.all$group,sce.all$orig.ident))<br><br><br><span>###### step2:QC质控 ######</span><br>dir.create(<span>"./1-QC"</span>)<br>setwd(<span>"./1-QC"</span>)<br><span># 如果过滤的太狠，就需要去修改这个过滤代码</span><br><span>source</span>(<span>'../scRNA_scripts/qc.R'</span>)<br>sce.all.filt = basic_qc(sce.all)<br>print(dim(sce.all))<br>print(dim(sce.all.filt))<br>setwd(<span>'../'</span>)<br><br><br>sp=<span>'human'</span><br><br><span>###### step3: harmony整合多个单细胞样品 ######</span><br>dir.create(<span>"2-harmony"</span>)<br>getwd()<br>setwd(<span>"2-harmony"</span>)<br><span>source</span>(<span>'../scRNA_scripts/harmony.R'</span>)<br><span># 默认 ScaleData 没有添加"nCount_RNA", "nFeature_RNA"</span><br><span># 默认的</span><br>sce.all.int = run_harmony(sce.all.filt)<br>setwd(<span>'../'</span>)<br><br><span>###### step4: 降维聚类分群和看标记基因库 ######</span><br><span># 原则上分辨率是需要自己肉眼判断，取决于个人经验</span><br><span># 为了省力，我们直接看  0.1和0.8即可</span><br>table(Idents(sce.all.int))<br>table(sce.all.int$seurat_clusters)<br>table(sce.all.int$RNA_snn_res.0.1) <br>table(sce.all.int$RNA_snn_res.0.8) <br><br>getwd()<br>dir.create(<span>'check-by-0.1'</span>)<br>setwd(<span>'check-by-0.1'</span>)<br>sel.clust = <span>"RNA_snn_res.0.1"</span><br>sce.all.int &lt;- SetIdent(sce.all.int, value = sel.clust)<br>table(sce.all.int@active.ident) <br><br><span>source</span>(<span>'../scRNA_scripts/check-all-markers.R'</span>)<br>setwd(<span>'../'</span>) <br>getwd()<br><br>dir.create(<span>'check-by-0.8'</span>)<br>setwd(<span>'check-by-0.8'</span>)<br>sel.clust = <span>"RNA_snn_res.0.8"</span><br>sce.all.int &lt;- SetIdent(sce.all.int, value = sel.clust)<br>table(sce.all.int@active.ident) <br><span>source</span>(<span>'../scRNA_scripts/check-all-markers.R'</span>)<br>setwd(<span>'../'</span>) <br>getwd()<br><br>last_markers_to_check<br><br></code></pre><p data-tool="mdnice编辑器">上面的代码需要用到 scRNA_scripts 文件夹里面的几个R脚本，它已经被我运用到一千多个单细胞公共数据集，没有遇到问题！但是，<strong>最近Seurat包出现了V5的更新了，而我前面的代码都是V4，就尴尬了！！！</strong></p></section><h4 data-tool="mdnice编辑器">文末友情宣传</h4><p data-tool="mdnice编辑器">强烈建议你推荐给身边的<strong>博士后以及年轻生物学PI</strong>，多一点数据认知，让他们的科研上一个台阶：</p><ul data-tool="mdnice编辑器"><li><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247526014&amp;idx=1&amp;sn=44afb387fc49b89276386e5182db7bc9&amp;chksm=9b4b26c5ac3cafd35616b2fe9df7fea664e59d75e9970feb322a477beb222ac023f7daebb3dc&amp;scene=21#wechat_redirect" textvalue="生物信息学马拉松授课（买一得‍五）" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1">生物信息学马拉松授课（买一得五）</a> ，你的生物信息学入门课</section></li><li><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247524148&amp;idx=1&amp;sn=7806da6feb41a36493c519c1cfc1d3ac&amp;chksm=9b4bdf8fac3c569960369602f1ef26639cb366b250f233b2297d1f059471c0458335bfc0b829&amp;scene=21#wechat_redirect" textvalue="时隔5年，我们的生信技能树VIP学徒继续招生啦" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1">时隔5年，我们的生信技能树VIP学徒继续招生啦</a><br></section></li><li><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247522831&amp;idx=2&amp;sn=1744efdf428465425a145ff3a982198b&amp;chksm=9b4bdab4ac3c53a28fbecbbff4f254f470b54a7a20468bb753b295b930315e1ec45bcbabc10b&amp;scene=21#wechat_redirect" textvalue="144线程640Gb内存服务器共享一年‍仍然是仅需800" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1">144线程640Gb内存服务器共享一年仍然是仅需800</a></section></li><li><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247519765&amp;idx=1&amp;sn=ce5a8c8182f854c88043059f8c2cb9ff&amp;chksm=9b4bceaeac3c47b88c19941d43dbb1401f3a92206481a0afc41159927868199643f795d62a7e&amp;scene=21#wechat_redirect" textvalue="千呼万唤始出来的独享生物信息学云服务器" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1">千呼万唤始出来的独享生物信息学云服务器</a></section></li><li><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247519765&amp;idx=1&amp;sn=ce5a8c8182f854c88043059f8c2cb9ff&amp;chksm=9b4bceaeac3c47b88c19941d43dbb1401f3a92206481a0afc41159927868199643f795d62a7e&amp;scene=21#wechat_redirect" textvalue="千呼万唤始出来的独享生物信息学云服务器" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1"></a><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247524275&amp;idx=1&amp;sn=fa592ee29f636f34387491d0fceadd8e&amp;chksm=9b4bdf08ac3c561e0881974b3817beb0a0e514dc1a8df4c34c2b6653da6fa78e09acb03c70c2&amp;scene=21#wechat_redirect" textvalue="生信技能树知识整理实习生又又又开放申请啦" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1">生信技能树知识整理实习生又又又开放申请啦</a><span><strong>（不招了，谢谢）</strong></span></section></li><li><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247524432&amp;idx=1&amp;sn=5b33b0c6807a9e6939c332c58fabff89&amp;chksm=9b4b20ebac3ca9fdb3d8bfaf2bef5552f64eb70e7fae557cc7197fb1a23b3e8bc31b585bf829&amp;scene=21#wechat_redirect" textvalue="生信共享办公室出租" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1">生信共享办公室出租</a></p></li></ul><p><br></p><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/D9WeCiFd_kwXv-hMFaAAFw",target="_blank" rel="noopener noreferrer">原文链接</a>
