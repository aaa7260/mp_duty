---
title: "高亮某些通路？"
date: 2023-11-03T08:44:08Z
draft: ["false"]
tags: [
  "fetched",
  "YuLabSMU"
]
categories: ["Acdemic"]
---
高亮某些通路？ by YuLabSMU
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-mpa-powered-by="yiban.io"><p data-tool="mdnice编辑器">经常有人会在我们富集分析生成的点图再去用AI去修图，因为要高亮某些选中的通路，以便于让人一眼就看到它，也有助于解说嘛。</p><p data-tool="mdnice编辑器">其实这个一点都不难，完全是代码可实现的，而且是<code>clusterProfiler</code>出来的点图可以实现的。因为我们给了一个参数，可以格式化label的输出，这就是那个指定长度（就是用来给太长的通路描述加换行）的功能，它能接收一个函数，用于任意去label进行操作。</p><p data-tool="mdnice编辑器">好了，你现在知道有个后门了，但你不知道走了后面都能干啥。看这个题目，你知道能高亮了，但又不知道该怎么高亮。虽然说的有点绕口，但就是这样。</p><p data-tool="mdnice编辑器">答案就在我们的书里啊：</p><p><img data-galleryid="" data-ratio="0.7502930832356389" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/MPBFtnFrw4kc1OyfwHOybkJMRQP6jwDJf506W1ZzOVqsyhnRVUAwAcuORpnFqpYyamu7bMZHaTwZ1Mp4PLWJVA/640?wx_fmt=jpeg" data-type="jpeg" data-w="1706" src="https://mmbiz.qpic.cn/mmbiz_jpg/MPBFtnFrw4kc1OyfwHOybkJMRQP6jwDJf506W1ZzOVqsyhnRVUAwAcuORpnFqpYyamu7bMZHaTwZ1Mp4PLWJVA/640?wx_fmt=jpeg"></p><p data-tool="mdnice编辑器">这是230页出的图，代码就在229页里，我一直说，这本书不仅仅是树的可视化，书中的可视化知识是可以各种应用的，就算你不懂怎么干，你起码也得知道能干，起码开开眼界也是有用的。</p><p data-tool="mdnice编辑器">接下来我们就来抄一下书中的作业吧。</p><p data-tool="mdnice编辑器">先跑一个富集分析：</p><pre data-tool="mdnice编辑器"><span></span><code><span>require</span>(DOSE)<br>data(geneList)<br>de = names(geneList)[<span>1</span>:<span>100</span>]<br>x = enrichDO(de)<br></code></pre><p data-tool="mdnice编辑器">我们定义一个函数，把有包含<code>cancer</code>的结果给格式化上个颜色。</p><pre data-tool="mdnice编辑器"><span></span><code>f &lt;- <span>function</span>(ids) {<br>    i &lt;- grepl(<span>'cancer'</span>, ids)<br>    ids[i] &lt;- paste0(<span>"&lt;i style='color:#009E73'&gt;"</span>, ids[i], <span>"&lt;/i&gt;"</span>)<br>    <span>return</span>(ids)<br>}<br></code></pre><p data-tool="mdnice编辑器">接下来是画图，把这个函数传给<code>dotplot</code>，那么就实现格式化了，当然这个格式化要能够渲染出来，我们需要用到<code>ggtext</code>包，通过<code>theme</code>来解析格式化的代码。</p><pre data-tool="mdnice编辑器"><span></span><code><span>require</span>(ggplot2)<br><span>require</span>(ggtext)<br><span>require</span>(enrichplot)<br>dotplot(x, label_format=f) + theme(axis.text.y = element_markdown())<br></code></pre><p><img data-galleryid="" data-ratio="1.0625" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/MPBFtnFrw4kc1OyfwHOybkJMRQP6jwDJgCWVynwvEBM8zRkNibOTlK2u4C03Wc8OK3pg7k7wxe3XONPHCGZpZug/640?wx_fmt=png" data-type="png" data-w="688" src="https://mmbiz.qpic.cn/mmbiz_png/MPBFtnFrw4kc1OyfwHOybkJMRQP6jwDJgCWVynwvEBM8zRkNibOTlK2u4C03Wc8OK3pg7k7wxe3XONPHCGZpZug/640?wx_fmt=png"></p><p data-tool="mdnice编辑器">我们可以指定想要高亮的结果，比如这里我就只高亮第一和第二个：</p><pre data-tool="mdnice编辑器"><span></span><code>f2 &lt;- <span>function</span>(ids) {<br>    ids[<span>1</span>] &lt;- paste0(<span>"&lt;i style='color:#009E73'&gt;"</span>, ids[<span>1</span>], <span>"&lt;/i&gt;"</span>)<br>    ids[<span>2</span>] &lt;- paste0(<span>"&lt;i style='color:#0072B2'&gt;**"</span>, ids[<span>2</span>], <span>"**&lt;/i&gt;"</span>)<br>    <span>return</span>(ids)<br>} <br><br>dotplot(x, label_format=f2) + theme(axis.text.y = element_markdown())<br></code></pre><p><img data-galleryid="" data-ratio="1.0625" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/MPBFtnFrw4kc1OyfwHOybkJMRQP6jwDJZy26asSnfVud6Ficxt5T3eO0h9EUFO0iaFeXSqRjjkicw9hR6exE2yrnQ/640?wx_fmt=png" data-type="png" data-w="688" src="https://mmbiz.qpic.cn/mmbiz_png/MPBFtnFrw4kc1OyfwHOybkJMRQP6jwDJZy26asSnfVud6Ficxt5T3eO0h9EUFO0iaFeXSqRjjkicw9hR6exE2yrnQ/640?wx_fmt=png"></p><p data-tool="mdnice编辑器">再上个彩虹图吧：</p><pre data-tool="mdnice编辑器"><span></span><code>f3 &lt;- <span>function</span>(ids) {<br>    <span># cols &lt;- rcartocolor::carto_pal(length(ids), "Vivid")</span><br>    <span># cols &lt;- colorspace::rainbow_hcl(length(ids))</span><br>    cols &lt;- rainbow(length(ids))<br>    ids &lt;- paste0(<span>"&lt;i style='color:"</span>, cols, <span>"'&gt;**"</span>, ids, <span>"**&lt;/i&gt;"</span>)<br>    <span>return</span>(ids)    <br>}<br><br>dotplot(x, label_format=f3) + theme(axis.text.y = element_markdown())<br></code></pre><p><img data-galleryid="" data-ratio="1.0625" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/MPBFtnFrw4kc1OyfwHOybkJMRQP6jwDJxKJliaz6USGpve4fNs6LlXmic3lED7zUubgLvfe9zdKwAZianKLCA5etQ/640?wx_fmt=png" data-type="png" data-w="688" src="https://mmbiz.qpic.cn/mmbiz_png/MPBFtnFrw4kc1OyfwHOybkJMRQP6jwDJxKJliaz6USGpve4fNs6LlXmic3lED7zUubgLvfe9zdKwAZianKLCA5etQ/640?wx_fmt=png"></p><p data-tool="mdnice编辑器">最后再放一个广告词：</p><blockquote data-tool="mdnice编辑器"><p>书中的可视化知识是可以各种应用的，就算你不懂怎么干，你起码也得知道能干，起码开开眼界也是有用的。</p></blockquote><p data-tool="mdnice编辑器">现在双11，有活动，优惠截至到11号：</p><p><img data-galleryid="" data-ratio="1.8886043533930859" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/MPBFtnFrw4kc1OyfwHOybkJMRQP6jwDJlqjticvOT5ia6M3NtNNJVIkR9vfBcIja0uHSicUyW6d7LIPzBZaJS3yDQ/640?wx_fmt=jpeg" data-type="jpeg" data-w="1562" src="https://mmbiz.qpic.cn/mmbiz_jpg/MPBFtnFrw4kc1OyfwHOybkJMRQP6jwDJlqjticvOT5ia6M3NtNNJVIkR9vfBcIja0uHSicUyW6d7LIPzBZaJS3yDQ/640?wx_fmt=jpeg"></p></section><p><mp-style-type data-value="10000"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/1C2qN7glQbkJvZc2Ia36Nw",target="_blank" rel="noopener noreferrer">原文链接</a>
