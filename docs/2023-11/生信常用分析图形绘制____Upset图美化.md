---
title: "生信常用分析图形绘制 -- Upset图美化"
date: 2023-11-17T04:54:22Z
draft: ["false"]
tags: [
  "fetched",
  "生信师兄"
]
categories: ["Acdemic"]
---
生信常用分析图形绘制 -- Upset图美化 by 生信师兄
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-mpa-powered-by="yiban.io"><blockquote data-tool="mdnice编辑器"><span>❝</span><p>已经付费加群的小伙伴无需二次付费，等待师兄后续更新即可！</p><span>❞</span></blockquote><figure data-tool="mdnice编辑器"><img data-imgfileid="100022022" data-ratio="0.4287037037037037" data-src="https://mmbiz.qpic.cn/mmbiz_png/tHXjIUmmhG6yyBb7FrYpt5uSpvtGnmRzQqqE2BVibDgicftJIk1WIT9RoIceYLcPmibKghiawVcFJzWuDkWoQSianlw/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/tHXjIUmmhG6yyBb7FrYpt5uSpvtGnmRzQqqE2BVibDgicftJIk1WIT9RoIceYLcPmibKghiawVcFJzWuDkWoQSianlw/640?wx_fmt=png"><figcaption><span></span>封面</figcaption></figure><p data-tool="mdnice编辑器">有了R语言的基础，以及ggplot2绘图基础，我们的<strong>「生信常用分析图形」</strong>的绘制就可以提上日程了！本系列，师兄就开始带着大家一起学习如何用R语言绘制我们自己的各种分析图吧！</p><blockquote data-tool="mdnice编辑器"><span>❝</span><p>由于本系列的所有分析代码均为师兄细心整理和详细注释而成的，所以本系列中<strong>「部分教程需要收费」</strong>的哦！付费即可获取对应小节的绘图数据和代码！</p><p>本系列所有代码和示例数据将会和跟着高分SCI学做图系列放在一起，扫描下方二维码添加师兄微信，<strong>「付费189元」</strong>，即可加入生信绘图交流群<strong>「（随着群内绘图资源的增加，入群费用也会随之增加，1群￥99 -- 已满，2群￥149 -- 已满，3群￥169 -- 已满，4群￥179 -- 已满）。群内不仅提供生信常用图形系列的代码，还会提供本系列后续所有Figure的实例数据和代码，师兄会在文章更新后第一时间上传。」</strong> 此外，群内可以讨论绘图上的疑问，我也会在闲暇的时候给小伙伴们答疑！</p><p>当然了！如果你还想白嫖，师兄的文章中代码已经写的很清楚了！但是师兄还是希望你点个赞再走呗！</p><p><strong>「优惠方式：点赞+在看，并转发这两个系列任意一篇文章至朋友圈，集赞30个，即可享受￥159入群！」</strong></p><span>❞</span></blockquote><figure data-tool="mdnice编辑器"><img data-cropselx1="0" data-cropselx2="245" data-cropsely1="0" data-cropsely2="243" data-imgfileid="100022023" data-ratio="1.027434842249657" data-src="https://mmbiz.qpic.cn/mmbiz_png/tHXjIUmmhG4yczDHHxcphKQKffuqK99Y4vkHH3njIRnju3TicRd4cQYiaqGabV0RibStMUzZQu91RQ6GhKFuEgFkA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="729" src="https://mmbiz.qpic.cn/mmbiz_png/tHXjIUmmhG4yczDHHxcphKQKffuqK99Y4vkHH3njIRnju3TicRd4cQYiaqGabV0RibStMUzZQu91RQ6GhKFuEgFkA/640?wx_fmt=png&amp;from=appmsg"><figcaption><span></span>师兄微信</figcaption></figure><h4 data-tool="mdnice编辑器"><span></span><span><span></span>系列内容包括：</span><span></span></h4><ul data-tool="mdnice编辑器"><li><section>各种类型的热图你学会了吗？</section></li><ul><li><section>普通热图</section></li><li><section>环形热图</section></li></ul><li><section>解锁火山图真谛！</section></li><ul><li><section>plot函数就能画火山图？</section></li><li><section>高级函数绘制火山图--ggplot2、ggpurb</section></li></ul><li><section>经典富集分析及气泡图、柱状图绘制</section></li><ul><li><section>气泡图绘制</section></li><li><section>柱状图绘制</section></li></ul><li><section>富集分析圈图</section></li><li><section>富集分析弦图</section></li><li><section>绘制一张可以打动审稿人的桑基图</section></li><li><section>生存分析 -- KM曲线图</section></li><li><section>基础PCA图</section></li><li><section>云雨图</section></li><li><section>韦恩图</section></li><li><section>环形互作网络图</section></li><li><section>相互作用网络图</section></li><li><section>聚类树美化</section></li><li><section>富集分析气泡图进阶版</section></li><li><section>mantel test相关性图</section></li><li><section>词云图</section></li><li><section>瀑布图</section></li><li><section>森林图</section></li><li><section>曼哈顿图</section></li><li><section>哑铃图</section></li><li><section>三线表</section></li><li><section>嵌套圈图</section></li><li><section>列线图</section></li><li><section>蜂群图</section></li><li><section>箱线图+贝塞尔曲线</section></li><li><section>矩阵散点图</section></li><li><section>交互式热图</section></li><li><section>三元相图</section></li><li><section>Upset图美化</section></li><li><section>等等，想到再继续补充！！！</section></li></ul><p data-tool="mdnice编辑器">话不多说，直接上图！</p><h3 data-tool="mdnice编辑器"><span></span><span><span></span>效果预览</span><span></span></h3><figure data-tool="mdnice编辑器"><img data-imgfileid="100022021" data-ratio="0.5" data-src="https://mmbiz.qpic.cn/mmbiz_png/tHXjIUmmhG6yyBb7FrYpt5uSpvtGnmRzCeQhyoZnYNXIGhXJ3Vl9dYPYib45LAT6reWHKk8DXJjCCa9j159B6iaA/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/tHXjIUmmhG6yyBb7FrYpt5uSpvtGnmRzCeQhyoZnYNXIGhXJ3Vl9dYPYib45LAT6reWHKk8DXJjCCa9j159B6iaA/640?wx_fmt=png"><figcaption><span></span>效果预览</figcaption></figure><h3 data-tool="mdnice编辑器"><span></span><span><span></span>绘图群附加福利</span><span></span></h3><p data-tool="mdnice编辑器">凡是<strong>「已经加群」</strong>的小伙伴，你们在看文献的时候如果看到好看的Figure，可以发到群里！师兄会及时关注的，<strong>「如果被师兄选中，就会在推文中更新！」</strong></p><h4 data-tool="mdnice编辑器"><span></span><span><span></span>Figure的要求如下（被选中的前提）：</span><span></span></h4><ul data-tool="mdnice编辑器"><li><section>首先肯定是要符合大众审美的，在图形样式上要过关。</section></li><li><section>新颖独特，有与常见图形不一样的地方。</section></li><li><section>有一定难度，太简单的大家都会做，没什么挑战性哈！</section></li></ul><h4 data-tool="mdnice编辑器"><span></span><span><span></span>往期选中案例</span><span></span></h4><figure data-tool="mdnice编辑器"><img data-imgfileid="100022028" data-ratio="1.075" data-src="https://mmbiz.qpic.cn/mmbiz_png/tHXjIUmmhG6yyBb7FrYpt5uSpvtGnmRz5txMKLibpXbCLiaCc6eO6ZkjXSPZHn2mNf364MNPGvddbyXTibXC0pCOg/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/tHXjIUmmhG6yyBb7FrYpt5uSpvtGnmRz5txMKLibpXbCLiaCc6eO6ZkjXSPZHn2mNf364MNPGvddbyXTibXC0pCOg/640?wx_fmt=png"><figcaption><span></span>往期选中案例01</figcaption></figure><figure data-tool="mdnice编辑器"><img data-imgfileid="100022027" data-ratio="0.4935185185185185" data-src="https://mmbiz.qpic.cn/mmbiz_png/tHXjIUmmhG6yyBb7FrYpt5uSpvtGnmRzXk43ys47Jcg1tpLdsOkoPf3ZE0YometjjdOkogr56kzKIiavY9PaZYg/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/tHXjIUmmhG6yyBb7FrYpt5uSpvtGnmRzXk43ys47Jcg1tpLdsOkoPf3ZE0YometjjdOkogr56kzKIiavY9PaZYg/640?wx_fmt=png"><figcaption><span></span>往期选中案例</figcaption></figure><h3 data-tool="mdnice编辑器"><span></span><span><span></span>R包、数据载入及基础绘图</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code><span># 载入R包：</span><br><span>require</span>(ggplot2)<br><span>require</span>(plyr)<br><span>require</span>(gridExtra)<br><span>require</span>(grid)<br><br><span># 载入R包自带数据集：</span><br>movies &lt;- read.csv(system.file(<span>"extdata"</span>, <span>"movies.csv"</span>, package = <span>"UpSetR"</span>),<br>                   header=<span>TRUE</span>, sep=<span>";"</span> )<br><br><span>########## 基础绘图 ----------------</span><br>pdf(<span>"plot1.pdf"</span>, height = <span>5</span>, width = <span>7</span>)<br>upset(movies,<br>      <span># 数据集数量：</span><br>      nsets = <span>7</span>,<br>      <span># 柱形的最大数目：</span><br>      nintersects = <span>30</span>,<br>      <span># 柱形图与矩阵图大小比例：</span><br>      mb.ratio = c(<span>0.5</span>, <span>0.5</span>),<br>      <span># 柱形的排序方式：freq -- 柱形高度排序；degree -- 数据集的数量排序；</span><br>      order.by = c(<span>"freq"</span>, <span>"degree"</span>), decreasing = c(<span>TRUE</span>, <span>FALSE</span>))<br>dev.off()<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100022025" data-ratio="0.7138888888888889" data-src="https://mmbiz.qpic.cn/mmbiz_png/tHXjIUmmhG6yyBb7FrYpt5uSpvtGnmRzMQqHPyzxrk3FaeHRULaufD1aicsiapu8ZBtD0SN5k8o6SXlqtZunVD2Q/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/tHXjIUmmhG6yyBb7FrYpt5uSpvtGnmRzMQqHPyzxrk3FaeHRULaufD1aicsiapu8ZBtD0SN5k8o6SXlqtZunVD2Q/640?wx_fmt=png"><figcaption><span></span>基础绘图</figcaption></figure><h3 data-tool="mdnice编辑器"><span></span><span><span></span>图形美化</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code><span>########## 美化 -------------------</span><br>pdf(<span>"plot2.pdf"</span>, height = <span>5</span>, width = <span>7</span>)<br>upset(movies,<br>      <span># 数据集数量：</span><br>      nsets = <span>5</span>,<br>      <span># 柱形图与矩阵图大小比例：</span><br>      mb.ratio = c(<span>0.6</span>, <span>0.4</span>),<br>      <span># 修改左侧柱形颜色：</span><br>      sets.bar.color = c(<span>"#006bba"</span>, <span>"#d4550e"</span>, <span>"#00a6dc"</span>, <span>"#67a330"</span>, <span>"#f88a53"</span>),<br>      <span># 柱形排序：</span><br>      order.by = <span>"freq"</span>, decreasing = <span>T</span>,<br>      <span># 修改条形的颜色和矩阵散点的颜色：</span><br>      queries = list(list(query = intersects, params = list(<span>"Drama"</span>),<br>                          color= <span>"#006bba"</span>, active = <span>T</span>)),<br>      <span># 矩形散点的阴影颜色：</span><br>      shade.color = <span>NA</span><br>      )<br>dev.off()<br><br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100022024" data-ratio="0.7138888888888889" data-src="https://mmbiz.qpic.cn/mmbiz_png/tHXjIUmmhG6yyBb7FrYpt5uSpvtGnmRzJnm9AHbsnfOATTiaaEs70MdjaKibTYGDj12NoRvCqdZXsol3VtyUzrtQ/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/tHXjIUmmhG6yyBb7FrYpt5uSpvtGnmRzJnm9AHbsnfOATTiaaEs70MdjaKibTYGDj12NoRvCqdZXsol3VtyUzrtQ/640?wx_fmt=png"><figcaption><span></span>美化</figcaption></figure><h3 data-tool="mdnice编辑器"><span></span><span><span></span>批量修改颜色</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code><span>######### 批量修改 ---------------</span><br><span># 先创建颜色，有多少个柱子就设置多少个颜色：</span><br><span>library</span>(RColorBrewer)<br><br>colors &lt;- colorRampPalette(brewer.pal(<span>9</span>, <span>"Set1"</span>))(<span>27</span>)<br><br>query_list &lt;- list()<br><br>tmp &lt;- unique(movies[, c(<span>"Drama"</span>, <span>"Comedy"</span>, <span>"Action"</span>, <span>"Thriller"</span>, <span>"Romance"</span>)])<br>tmp &lt;- tmp[rowSums(tmp) != <span>0</span>, ]<br><br><span>for</span> (i <span>in</span> <span>1</span>:<span>27</span>) {<br>  query_list[[i]] &lt;- list(query = intersects,<br>                          params = list(colnames(tmp)[which(tmp[i,] == <span>1</span>)]),<br>                          color= colors[i], active = <span>T</span>)<br>}<br><br>pdf(<span>"plot.pdf"</span>, height = <span>3</span>, width = <span>6</span>)<br>upset(movies,<br>      <span># 数据集数量：</span><br>      nsets = <span>5</span>,<br>      <span># 柱形图与矩阵图大小比例：</span><br>      mb.ratio = c(<span>0.65</span>, <span>0.35</span>),<br>      <span># 修改左侧柱形颜色：</span><br>      sets.bar.color = colors[sample(<span>1</span>:<span>27</span>, <span>5</span>)],<br>      <span># 柱形排序：</span><br>      order.by = <span>"freq"</span>, decreasing = <span>T</span>,<br>      <span># 修改条形的颜色和矩阵散点的颜色：</span><br>      queries = query_list,<br>      <span># 矩形散点的阴影颜色：</span><br>      shade.color = <span>NA</span><br>)<br>dev.off()<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.5" data-src="https://mmbiz.qpic.cn/mmbiz_png/tHXjIUmmhG6yyBb7FrYpt5uSpvtGnmRzracBE4H7a97ibaIMsq7ibVmTpGASUaX7KJ4uK5IsRk2sibCjcSZZhJ7fA/640?wx_fmt=png" data-type="png" data-w="1080" data-imgfileid="100022026" src="https://mmbiz.qpic.cn/mmbiz_png/tHXjIUmmhG6yyBb7FrYpt5uSpvtGnmRzracBE4H7a97ibaIMsq7ibVmTpGASUaX7KJ4uK5IsRk2sibCjcSZZhJ7fA/640?wx_fmt=png"><figcaption><span></span>效果展示</figcaption><figcaption><br></figcaption><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><h3 data-tool="mdnice编辑器"><span>优惠方式</span></h3><blockquote data-tool="mdnice编辑器"><span>❝</span><p><strong>「优惠方式」</strong> <span>点赞+在看，并转发这两个系列任意一篇文章至朋友圈，集赞30个，即可享受￥159入群！</span></p><p>以上就是本期的全部内容啦！<span>欢迎点赞，在看，收藏 + 转发！</span> 师兄会尽快更新哦！制作不易，您的支持将成为师兄继续更新的十足动力！</p><span>❞</span></blockquote><h3 data-tool="mdnice编辑器"><span><span></span>往期系列概览 -- 点击直达</span></h3><figure data-tool="mdnice编辑器"><a href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzkzMDE4NTc5NA==&amp;action=getalbum&amp;album_id=2878209887242141696#wechat_redirect" data-linktype="1"><span><img data-ratio="0.1685185185185185" data-type="png" data-w="1080" data-src="https://mmbiz.qpic.cn/mmbiz_png/tHXjIUmmhG4cCDpTMeuybr3I2R2hdcNuXPwToKEysJmPbCpTD6NJ0SgNqwSmWnv5Te1XbqicRKS5suzDeD07fzA/640?wx_fmt=png" data-imgfileid="100022030" src="https://mmbiz.qpic.cn/mmbiz_png/tHXjIUmmhG4cCDpTMeuybr3I2R2hdcNuXPwToKEysJmPbCpTD6NJ0SgNqwSmWnv5Te1XbqicRKS5suzDeD07fzA/640?wx_fmt=png"></span></a></figure><figure data-tool="mdnice编辑器"><a href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzkzMDE4NTc5NA==&amp;action=getalbum&amp;album_id=2158515492607590402#wechat_redirect" data-linktype="1"><span><img data-imgfileid="100022031" data-ratio="0.1685185185185185" data-src="https://mmbiz.qpic.cn/mmbiz_png/tHXjIUmmhG4cCDpTMeuybr3I2R2hdcNu6A85Xwr4z6vFVszmX4l3uTmbzC1We57EyuB7bdJMtIuZjd941NTSJA/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/tHXjIUmmhG4cCDpTMeuybr3I2R2hdcNu6A85Xwr4z6vFVszmX4l3uTmbzC1We57EyuB7bdJMtIuZjd941NTSJA/640?wx_fmt=png"></span></a></figure><figure data-tool="mdnice编辑器"><a href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzkzMDE4NTc5NA==&amp;action=getalbum&amp;album_id=2140091930632880131#wechat_redirect" data-linktype="1"><span><img data-imgfileid="100022032" data-ratio="0.1685185185185185" data-src="https://mmbiz.qpic.cn/mmbiz_png/tHXjIUmmhG4cCDpTMeuybr3I2R2hdcNuTlozD6GoUicKl0JSloqxTvTaJDvoic9PQM7msUY2SUWVc1ZMeluZBNYw/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/tHXjIUmmhG4cCDpTMeuybr3I2R2hdcNuTlozD6GoUicKl0JSloqxTvTaJDvoic9PQM7msUY2SUWVc1ZMeluZBNYw/640?wx_fmt=png"></span></a></figure><figure data-tool="mdnice编辑器"><a href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzkzMDE4NTc5NA==&amp;action=getalbum&amp;album_id=2870584987207712770#wechat_redirect" data-linktype="1"><span><img data-imgfileid="100022029" data-ratio="0.1685185185185185" data-src="https://mmbiz.qpic.cn/mmbiz_png/tHXjIUmmhG4cCDpTMeuybr3I2R2hdcNuRz4cOqwWYK5ny52hUqzbUITsSISF7WmzoicYquElUqRibjpts0W78f1Q/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/tHXjIUmmhG4cCDpTMeuybr3I2R2hdcNuRz4cOqwWYK5ny52hUqzbUITsSISF7WmzoicYquElUqRibjpts0W78f1Q/640?wx_fmt=png"></span></a></figure></section><p><br></p><figcaption><br></figcaption></figure><ol data-tool="mdnice编辑器"></ol></section><p><mp-style-type data-value="10000"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/6-9FzWtmpIU0BAh47lTP2w",target="_blank" rel="noopener noreferrer">原文链接</a>
