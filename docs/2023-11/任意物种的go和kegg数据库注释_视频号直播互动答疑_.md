---
title: "任意物种的go和kegg数据库注释（视频号直播互动答疑）"
date: 2023-11-10T03:01:27Z
draft: ["false"]
tags: [
  "fetched",
  "生信技能树"
]
categories: ["Acdemic"]
---
任意物种的go和kegg数据库注释（视频号直播互动答疑） by 生信技能树
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><p data-tool="mdnice编辑器">本文分享内容如下：</p><ul data-tool="mdnice编辑器"><li><section>六大安装R包的方法</section></li><li><section>解决此次clusterProfiler包安装的方法</section></li><li><section>物种注释的三层境界</section></li><li><section>举个小绵羊注释的例子</section></li></ul><h2 data-tool="mdnice编辑器"><span></span><span>一、六大安装R包的方法</span><span> </span></h2><ul data-tool="mdnice编辑器"><li><section>1 从CRAN安装</section></li></ul><pre data-tool="mdnice编辑器"><span></span><code><span># 1 directly download from CRAN</span><br><span># mirror for cran：https://mirrors.ustc.edu.cn/CRAN/; https://mirrors.tuna.tsinghua.edu.cn/CRAN/</span><br>options(repos=<span>"https://mirrors.tuna.tsinghua.edu.cn/CRAN/"</span>)<br><br>install.packages(<span>"ggplot2"</span>, repos=<span>"https://mirrors.ustc.edu.cn/CRAN/"</span>)<br>install.packages(<span>"tidyverse"</span>)<br>library(ggplot2)<br></code></pre><ul data-tool="mdnice编辑器"><li><section>2 从Bioconductor安装</section></li></ul><pre data-tool="mdnice编辑器"><span></span><code><span># 2 downlaod packages from bioconductor</span><br><span># mirror for bioc: https://mirrors.ustc.edu.cn/bioc/; http://mirrors.ustc.edu.cn/bioc/</span><br><span># options(BioC_mirror="http://mirrors.ustc.edu.cn/bioc/")</span><br><br><span>if</span> (!requireNamespace(<span>"BiocManager"</span>))  install.packages(<span>"BiocManager"</span>)<br>BiocManager::available() <span># find packages</span><br>BiocManager::install() <span># update packages</span><br>BiocManager::install(c(<span>"ape"</span>, <span>"ggtree"</span>)) <span># install packages</span><br></code></pre><ul data-tool="mdnice编辑器"><li><section>3 从Github安装</section></li></ul><pre data-tool="mdnice编辑器"><span></span><code><span># 3 download packages from github</span><br>install.packages(<span>"devtools"</span>, repos=<span>"https://mirrors.ustc.edu.cn/CRAN/"</span>)<br>install.packages(<span>"githubinstall"</span>)<br>library(devtools)<br>library(githubinstall)<br><br><span># There is an install_github function to install R packages hosted on GitHub in the **devtools** package. But it requests developer’s name.</span><br>install_github(<span>"DeveloperName/PackageName"</span>)<br>eg: <br>devtools::install_github(<span>"twitter/AnomalyDetection"</span>)<br>devtools::install_github(<span>'dviraran/SingleR'</span>)<br><br><span># The **githubinstall** package provides a function githubinstall. It does not need developer’s name.</span><br>githubinstall(<span>"PackageName"</span>)<br>eg: githubinstall(<span>"AnomalyDetection"</span>)<br></code></pre><ul data-tool="mdnice编辑器"><li><section>4 从网页安装</section></li></ul><pre data-tool="mdnice编辑器"><span></span><code><span># 4 download from URL</span><br>packageurl &lt;- <span>"http://cran.r-project.org/src/contrib/Archive/ggplot2/ggplot2_0.9.1.tar.gz"</span><br>packageurl &lt;- <span>"http://cran.r-project.org/src/contrib/Archive/gridExtra/gridExtra_0.9.1.tar.gz"</span><br>install.packages(packageurl, repos=NULL, <span>type</span>=<span>"source"</span>)<br><br>packageurl &lt;- <span>"http://www.bioconductor.org/packages/2.11/bioc/src/contrib/ggbio_1.6.6.tar.gz"</span><br>packageurl &lt;- <span>"http://cran.r-project.org/src/contrib/Archive/ggplot2/ggplot2_1.0.1.tar.gz"</span><br>install.packages(packageurl, repos=NULL, <span>type</span>=<span>"source"</span>)<br></code></pre><ul data-tool="mdnice编辑器"><li><section>5 用函数从本地安装</section></li></ul><pre data-tool="mdnice编辑器"><span></span><code><span># 5 download from local</span><br>download.file(<span>"http://bioconductor.org/packages/release/bioc/src/contrib/BiocInstaller_1.20.1.tar.gz"</span>,<span>"BiocInstaller_1.20.1.tar.gz"</span>)<br>install.packages(<span>"BiocInstaller_1.20.1.tar.gz"</span>, repos = NULL, <span>type</span>=<span>"source"</span>)<br><br><span>## Install the package from local</span><br>devtools::install_local(<span>"C:/Users/whbio/Desktop/temp/SingleR-master.zip"</span>) <br>library(SingleR) <br><br>Notice：下载压缩包到本地，指定压缩包目录，然后用R函数安装<br></code></pre><ul data-tool="mdnice编辑器"><li><section>6 用R从本地安装</section></li></ul><pre data-tool="mdnice编辑器"><span></span><code><span># 6 Download from R</span><br><span># sudo R CMD INSTALL package.tar.gz</span><br><br>Notice：下载压缩包到本地，然后用R软件安装<br></code></pre><h2 data-tool="mdnice编辑器"><span></span><span>二、解决此次clusterProfiler包安装的方法</span><span> </span></h2><p data-tool="mdnice编辑器">Error如下</p><pre data-tool="mdnice编辑器"><span></span><code>&gt; library(clusterProfiler)<br>Error: package or namespace load failed <span>for</span> ‘clusterProfiler’:<br>  <span>'namespace:HPO.db'</span>没有出口‘HPOGENE’这个对象<br></code></pre><ul data-tool="mdnice编辑器"><li><section>Try1：从Bioconductor下载HPO压缩到到本地，FAILED</section></li></ul><p data-tool="mdnice编辑器">在确认一系列依赖包顺利安装并下载压缩包后，从本地安装此包。</p><pre data-tool="mdnice编辑器"><span></span><code><span># dependenct packages: AnnotationDbi, AnnotationHub, BiocFileCache, DBI, methods, utils</span><br>dependency_packages &lt;- c(<span>'AnnotationDbi'</span>, <span>'AnnotationHub'</span>, <span>'BiocFileCache'</span>, <span>'DBI'</span>, <span>'methods'</span>, <span>'utils'</span>)<br>inst = lapply(dependency_packages, library, character.only = TRUE)<br><br><span># install from local</span><br>install.packages(<span>"D:/2023_softwares/Installation_softwares/R/R-4.3.0/library/HPO.db_0.99.2.tar.gz"</span>, <br>                 repos = NULL, <span>type</span>=<span>"source"</span>)<br></code></pre><ul data-tool="mdnice编辑器"><li><section>Try2: 下载包的旧版本到本地，再次安装，SUCCESS</section></li></ul><p data-tool="mdnice编辑器">包的下载地址为：https://github.com/huerqiang/HPO.db_MPO.db</p><pre data-tool="mdnice编辑器"><span></span><code><span># https://github.com/huerqiang/HPO.db_MPO.db</span><br>install.packages(<span>'D:/2023_softwares/Installation_softwares/R/R-4.3.0/library/HPO.db_MPO.db-main/HPO.db_0.99.0.tar.gz'</span>)<br>install.packages(<span>'D:/2023_softwares/Installation_softwares/R/R-4.3.0/library/HPO.db_MPO.db-main/MPO.db_0.99.0.tar.gz'</span>)<br><br>library(clusterProfiler)<br></code></pre><h2 data-tool="mdnice编辑器"><span></span><span>三、物种注释的三层境界</span><span> </span></h2><p data-tool="mdnice编辑器">模仿张敬信老师写循环的三层境界，注释也有三层境界。</p><ul data-tool="mdnice编辑器"><li><section>第一层：经典模式生物</section></li></ul><p data-tool="mdnice编辑器">如果是常见人鼠物种，直接指定物种名称即可，so easy！</p><pre data-tool="mdnice编辑器"><span></span><code><span># 直接指定物种名</span><br>go_organism &lt;- <span>"org.Hs.eg.db"</span> <span># org.Hs.eg.db / org.Mm.eg.db / org.Gg.eg.db</span><br>kegg_organism &lt;- <span>'hsa'</span> <span># hsa / mmu / gga</span><br></code></pre><ul data-tool="mdnice编辑器"><li><section>第二层：非模式生物，但OrgDb库可检索</section></li></ul><hr data-tool="mdnice编辑器"><p data-tool="mdnice编辑器">网页查找OrgDb库</p><p data-tool="mdnice编辑器">1、Bioconductor提供19种物种OrgDb包  （图1）<br>https://bioconductor.org/packages/release/BiocViews.html#___OrgDb</p><p data-tool="mdnice编辑器">2、GOC（Gene Ontology Consortium）提供39种不同模型生物的GAF格式的注释信息   （图2）<br>http://current.geneontology.org/products/pages/downloads.html</p><p data-tool="mdnice编辑器">3、Bioconductor的Annotationhub数据库提供了6126种物种   （图3）<br>https://annotationhub.bioconductor.org/species直接搜索自己所研究的物种的拉丁学名，即可找到对应的sqlite文件，下载到本地即可。如何使用sqlite格式文件呢？</p><p data-tool="mdnice编辑器">4、KEGG物种注释库提供真核生物968种，细菌8073种，古菌421种，共9462种物种信息 （图4）<br>https://www.genome.jp/kegg/catalog/org_list.html</p><p data-tool="mdnice编辑器">除此之外，还有下面的查找方法：<br>NCBI的基因ftp数据库：ftp://ftp.ncbi.nlm.nih.gov/gene/DATA/<br>包含gene2go,gene2ensembl,gene2pubmed等，每天或每周更新，包含所有物种的信息。</p><p data-tool="mdnice编辑器"><br></p><p><img data-galleryid="" data-ratio="0.6869834710743802" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/9YXSPb9ydSZW70mxek19K3JtCayF86FIeQ91FPTcvoiaxFsd2PKl81TtqJicGxLXokQVssEQjx3zxsoiajgVpYvqg/640?wx_fmt=jpeg" data-type="png" data-w="968" src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/9YXSPb9ydSZW70mxek19K3JtCayF86FIeQ91FPTcvoiaxFsd2PKl81TtqJicGxLXokQVssEQjx3zxsoiajgVpYvqg/640?wx_fmt=jpeg"></p><p>图1</p><p><br></p><p><img data-galleryid="" data-ratio="0.3731481481481482" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/9YXSPb9ydSZW70mxek19K3JtCayF86FI8648I8EwVjddQsygHg1kL59BXzcXw6NGug7giax31w2C3LRu2g5vjpg/640?wx_fmt=jpeg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/9YXSPb9ydSZW70mxek19K3JtCayF86FI8648I8EwVjddQsygHg1kL59BXzcXw6NGug7giax31w2C3LRu2g5vjpg/640?wx_fmt=jpeg"></p><p>图2</p><p><br></p><p><img data-galleryid="" data-ratio="0.4759259259259259" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/9YXSPb9ydSZW70mxek19K3JtCayF86FIrnh7eRK9O8MBR367a3EAqIGR7aLIUfzhQX8jFB3hURm68ZWmNZQeZA/640?wx_fmt=jpeg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/9YXSPb9ydSZW70mxek19K3JtCayF86FIrnh7eRK9O8MBR367a3EAqIGR7aLIUfzhQX8jFB3hURm68ZWmNZQeZA/640?wx_fmt=jpeg"></p><p>图3</p><p><br></p><p><img data-galleryid="" data-ratio="0.7519553072625699" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/9YXSPb9ydSZW70mxek19K3JtCayF86FIaB5xiaslPevsVjpDGEeqjzb2eMkekQCnzZOaDsHIAqsbvJ0C2FtCnIw/640?wx_fmt=jpeg" data-type="png" data-w="895" src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/9YXSPb9ydSZW70mxek19K3JtCayF86FIaB5xiaslPevsVjpDGEeqjzb2eMkekQCnzZOaDsHIAqsbvJ0C2FtCnIw/640?wx_fmt=jpeg"></p><p>图4</p><p><br></p><hr data-tool="mdnice编辑器"><p data-tool="mdnice编辑器">R函数查找OrgDb库</p><p data-tool="mdnice编辑器">1、GO注释库</p><pre data-tool="mdnice编辑器"><span></span><code><span># 1 用R包AnnotationHub检索</span><br>library(AnnotationHub)<br>ah = AnnotationHub()<br><br><span># 2 非模式物种，以毛果杨为例</span><br>query(ah, <span>"Populus_trichocarpa"</span>)<br><span>#           title                              </span><br><span># AH10434 | hom.Populus_trichocarpa.inp8.sqlite</span><br><span># AH66282 | org.Populus_trichocarpa.eg.sqlite </span><br><br><span># 3 下载对应的文件org.xx.eg.db.sqlite</span><br>populus &lt;- ah[[<span>'AH66282'</span>]]<br><span># &gt; populus &lt;- hub[['AH66282']]</span><br><span># downloading 1 resources</span><br><span># retrieving 1 resource</span><br><br><span># 4 保存变量</span><br>saveDb(populus, file = <span>"populus.orgdb"</span>)<br><span># loadDb(file = "populus.orgdb")</span><br><br><span># 5 查看变量</span><br>columns(populus)<br>length(keys(populus)) <span># 37273</span><br>head(keys(populus, keytype=<span>"REFSEQ"</span>))<br><br><span># 6 使用变量</span><br><span># mydf &lt;- bitr(x$SYMBOL, fromType="SYMBOL", toType="ENTREZID", populus)</span><br><span># ====================================================================</span><br></code></pre><p data-tool="mdnice编辑器">2、KEGG注释库</p><pre data-tool="mdnice编辑器"><span></span><code><span># KEGG物种名检索</span><br>library(clusterProfiler)<br>search_kegg_organism(<span>'ece'</span>, by=<span>'kegg_code'</span>)<br>ecoli &lt;- search_kegg_organism(<span>'Escherichia coli'</span>, by=<span>'scientific_name'</span>)<br>dim(ecoli)<br></code></pre><p data-tool="mdnice编辑器">Taxonomy 分类数据库是NCBI公共序列数据库中所有生物的策划分类和命名法，包含地球上大概10%的物种。可以看到不同的分类下的分布情况，总体包含有789855条物种信息。</p><p data-tool="mdnice编辑器"><span>目前可以直接检索解决的物种中GO注释有6184种（19+39+6126），KEGG注释有9462种。</span><br>如果你的物种着实罕见，欢迎分享物种名，一起找一找。</p><ul data-tool="mdnice编辑器"><li><section>第三层：非模式生物，自建OrgDb库</section></li></ul><p data-tool="mdnice编辑器">如果物种实在稀缺，用R包AnnotationForge自建OrgDb库。<br>参见参考链接[3]和[4]，尤其是[4]。因为写得太好，所以不画蛇添足了。</p><h2 data-tool="mdnice编辑器"><span></span><span>四、举个小绵羊注释的例子</span><span> </span></h2><p data-tool="mdnice编辑器">可爱的小绵羊名字为Ovis aries（sheep）</p><ul data-tool="mdnice编辑器"><li><section>1、R函数查找OrgDb库</section></li></ul><pre data-tool="mdnice编辑器"><span></span><code>library(AnnotationHub)<br>hub = AnnotationHub::AnnotationHub()<br></code></pre><p data-tool="mdnice编辑器">一个大大的Error出现，ok，尝试网页搜索，直接下载。<img data-galleryid="" data-ratio="0.24058919803600654" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/9YXSPb9ydSZW70mxek19K3JtCayF86FI1mb2BjMnqotzGzvBGaJ9xMjEibUicqgwr7QVO1gVibIk70BXrIGaUKSnw/640?wx_fmt=png" data-type="png" data-w="611" src="https://mmbiz.qpic.cn/sz_mmbiz_png/9YXSPb9ydSZW70mxek19K3JtCayF86FI1mb2BjMnqotzGzvBGaJ9xMjEibUicqgwr7QVO1gVibIk70BXrIGaUKSnw/640?wx_fmt=png"></p><p data-tool="mdnice编辑器">在Annotationhub数据库中输入Ovis aries，下载org.Ovis_aries.eg.sqlite</p><p data-tool="mdnice编辑器">或者shell下执行<code>axel -n 20 https://bioconductorhubs.blob.core.windows.net/annotationhub/ncbi/uniprot/3.15/org.Ovis_aries.eg.sqlite</code>。<img data-galleryid="" data-ratio="0.39537037037037037" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/9YXSPb9ydSZW70mxek19K3JtCayF86FIK0Qwm0u2O6vnsoQ2trTcjfft404C5YVQXKckQLj6l8nUEnGSOI7ibzw/640?wx_fmt=jpeg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/9YXSPb9ydSZW70mxek19K3JtCayF86FIK0Qwm0u2O6vnsoQ2trTcjfft404C5YVQXKckQLj6l8nUEnGSOI7ibzw/640?wx_fmt=jpeg"></p><p data-tool="mdnice编辑器">如果网络顺利后，可以尝试R中如下安装</p><pre data-tool="mdnice编辑器"><span></span><code>sheep &lt;- AnnotationHub::AnnotationHub()[[<span>"AH101101"</span>]]<br>saveDb(sheep, file = <span>"sheep.orgdb"</span>)<br>loadDb(file = <span>"sheep.orgdb"</span>)<br></code></pre><p data-tool="mdnice编辑器">KEGG注释物种输入Ovis aries，得到物种名为oas<img data-galleryid="" data-ratio="0.42322834645669294" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/9YXSPb9ydSZW70mxek19K3JtCayF86FI45Ez7gQvVEyarHh56aDQQ04jDV4wsQicy4vrQsHsGT9I1jledV9OIGA/640?wx_fmt=png" data-type="png" data-w="1016" src="https://mmbiz.qpic.cn/sz_mmbiz_png/9YXSPb9ydSZW70mxek19K3JtCayF86FI45Ez7gQvVEyarHh56aDQQ04jDV4wsQicy4vrQsHsGT9I1jledV9OIGA/640?wx_fmt=png"></p><ul data-tool="mdnice编辑器"><li><section>2、基因ID转换</section></li></ul><pre data-tool="mdnice编辑器"><span></span><code><span>library</span>(clusterProfiler)<br><span>library</span>(AnnotationHub)<br><span>library</span>(AnnotationDbi)<br><span>library</span>(ggplot2)<br><span>library</span>(ggpubr)<br><span>library</span>(ggsci)<br><br><span># Read genelist</span><br>setwd(r<span>"(E:\Year_2023\Annual_small_work\Work_November\2023-11-07_test)"</span>)<br>load(<span>'BigData.Rdata'</span>)<br>head(target_gene)<br><span>## [1] "XP_011988802.3" "XP_042099641.1" "XP_042099639.1" "XP_042099640.1" "XP_011988809.3" "XP_011988797.3"</span><br><br><span># Read OrgDb</span><br>sheep &lt;- loadDb(file=<span>'./OrgDb/org.Ovis_aries.eg.sqlite'</span>)<br><br><span># 指定物种名 Ovis aries (sheep)test</span><br>go_organism &lt;- sheep <span># org.Hs.eg.db / org.Mm.eg.db / org.Gg.eg.db</span><br>kegg_organism &lt;- <span>'oas'</span> <span># hsa / mmu / gga</span><br><br>columns(go_organism)<br><span>##  [1] "ACCNUM"      "ALIAS"       "CHR"         "ENSEMBL"     "ENTREZID"    "EVIDENCE"    "EVIDENCEALL" "GENENAME"    "GID"         "GO"         </span><br><span>## [11] "GOALL"       "ONTOLOGY"    "ONTOLOGYALL" "PMID"        "REFSEQ"      "SYMBOL"      "UNIGENE"</span><br>head(keys(go_organism, keytype=<span>"REFSEQ"</span>))<br><span>## [1] "NM_001009189.1" "NM_001009191.1" "NM_001009192.2" "NM_001009194.1" "NM_001009195.1" "NM_001009196.1"</span><br><br><span># 转基因ID</span><br>eg &lt;- bitr(target_gene, fromType=<span>"REFSEQ"</span>, toType=<span>"ENTREZID"</span>, OrgDb=go_organism) <br>head(eg)<br><span>##           REFSEQ  ENTREZID</span><br><span>## 1 XP_011988802.3 101105639</span><br><span>## 2 XP_042099641.1 101105639</span><br><span>## 3 XP_042099639.1 101105639</span><br><span>## 4 XP_042099640.1 101105639</span><br><span>## 5 XP_011988809.3 101105639</span><br><span>## 6 XP_011988797.3 101105639</span><br>genelist &lt;- eg$ENTREZID<br><br><span># Notice: fromType类型</span><br></code></pre><ul data-tool="mdnice编辑器"><li><section>3、GO富集分析</section></li></ul><pre data-tool="mdnice编辑器"><span></span><code>ego &lt;- enrichGO(genelist,<br>                OrgDb = go_organism,<br>                keyType = <span>"GID"</span>,<br>                ont = <span>"ALL"</span>,<br>                qvalueCutoff = <span>0.05</span>,<br>                pvalueCutoff = <span>0.05</span>)<br><br>dim(ego@result)<br><span>## [1] 120  10</span><br>ego@result[<span>1</span>:<span>2</span>, ]<br><span>##            ONTOLOGY         ID                                    Description GeneRatio  BgRatio       pvalue     p.adjust       qvalue</span><br><span>## GO:0006091       BP GO:0006091 generation of precursor metabolites and energy     13/51 120/4831 1.529984e-10 1.040389e-07 8.181391e-08</span><br><span>## GO:0005975       BP GO:0005975                 carbohydrate metabolic process     12/51 149/4831 2.681084e-08 9.115685e-06 7.168372e-06</span><br><span>##                                                                                                                           geneID Count</span><br><span>## GO:0006091 101115777/101115434/443005/101113198/443086/101109163/101108778/443091/101120193/442998/101111501/100270719/100216440    13</span><br><span>## GO:0005975              101118831/101108630/101115777/443005/101113198/443086/101109163/443091/443089/442998/101111501/100216440    12</span><br></code></pre><ul data-tool="mdnice编辑器"><li><section>4、KEGG富集分析</section></li></ul><pre data-tool="mdnice编辑器"><span></span><code>kk_df &lt;- enrichKEGG(genelist, <br>                    organism = kegg_organism, <br>                    keyType = <span>'kegg'</span>, <span># one of "kegg", 'ncbi-geneid', 'ncbi-proteinid' and 'uniprot'</span><br>                    pvalueCutoff = <span>0.05</span>,pAdjustMethod = <span>'BH'</span>,<br>                    minGSSize = <span>10</span>,maxGSSize = <span>500</span>,<br>                    qvalueCutoff = <span>0.2</span>,use_internal_data = <span>FALSE</span>)<br>dim(kk_df@result)<br><span>## [1] 168  11</span><br>kk_df@result[<span>1</span>:<span>2</span>, ]<br><span>##                category               subcategory       ID                  Description GeneRatio  BgRatio       pvalue     p.adjust       qvalue</span><br><span>## oas05012 Human Diseases Neurodegenerative disease oas05012            Parkinson disease    25/118 332/9556 1.887259e-13 3.170594e-11 2.026320e-11</span><br><span>## oas00010     Metabolism   Carbohydrate metabolism oas00010 Glycolysis / Gluconeogenesis    11/118  72/9556 1.018531e-09 8.555661e-08 5.467904e-08</span><br><span>##                                                                                                                                                                                                                                                 geneID</span><br><span>## oas05012 101118037/101115434/101116188/101105620/101118985/100270717/105614945/101110188/101115230/443016/443296/100135694/443297/101122127/101108778/101112274/101113030/121820456/443230/105614854/101116338/101115216/101121036/101116512/100270719</span><br><span>## oas00010                                                                                                                                             443005/101113460/101113198/443086/114108635/114110581/101108127/443089/101108565/443489/100216440</span><br><span>##          Count</span><br><span>## oas05012    25</span><br><span>## oas00010    11</span><br></code></pre><ul data-tool="mdnice编辑器"><li><section>5、保存运行结果</section></li></ul><pre data-tool="mdnice编辑器"><span></span><code>res.go = DOSE::setReadable(ego, OrgDb = go_organism, keyType = <span>'ENTREZID'</span>) <span># 按需替换ENTREZID为SYMBOL</span><br>res.kegg = DOSE::setReadable(kk_df, OrgDb = go_organism, keyType = <span>'ENTREZID'</span>) <span># 按需替换ENTREZID为SYMBOL</span><br><br>writexl::write_xlsx(list(<span>'GO注释结果'</span> = res.go@result, <span>'KEGG注释结果'</span> = res.kegg@result), <span>'GO-KEGG注释结果.xlsx'</span>)<br></code></pre><ul data-tool="mdnice编辑器"><li><section>6、简单可视化</section></li></ul><pre data-tool="mdnice编辑器"><span></span><code>dotplot(ego)<br></code></pre><p data-tool="mdnice编辑器"><img data-galleryid="" data-ratio="0.7138888888888889" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/9YXSPb9ydSZW70mxek19K3JtCayF86FISOQL2icsMyuuZibIAkTKRwNh8FkRQH3JHibAoMiau5Tdfcr23dwiaTv7cag/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/9YXSPb9ydSZW70mxek19K3JtCayF86FISOQL2icsMyuuZibIAkTKRwNh8FkRQH3JHibAoMiau5Tdfcr23dwiaTv7cag/640?wx_fmt=png"><br></p><p><br></p><pre data-tool="mdnice编辑器"><span></span><code>dotplot(kk_df)</code></pre><p><img data-galleryid="" data-ratio="0.7138888888888889" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/9YXSPb9ydSZW70mxek19K3JtCayF86FIvoWDcxkjXwb4qIUxjrzclaQGs0SvLEwxcMzsB70IUkPzUJ68Wqb2hw/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/9YXSPb9ydSZW70mxek19K3JtCayF86FIvoWDcxkjXwb4qIUxjrzclaQGs0SvLEwxcMzsB70IUkPzUJ68Wqb2hw/640?wx_fmt=png"></p><p><br></p><pre data-tool="mdnice编辑器"><span></span><code>ego@result %&gt;%<br>  dplyr::group_by(ONTOLOGY) %&gt;%<br>  <span># 为便于图形展示，提取部分子集</span><br>  dplyr::slice_head(n = <span>5</span>) %&gt;%<br>  ggplot(aes(x = reorder(Description, Count), y = Count)) +<br>  geom_bar(stat = <span>"identity"</span>, aes(fill = ONTOLOGY), alpha = <span>1</span>) +<br>  facet_grid(ONTOLOGY ~ . , scale=<span>"free"</span>, space=<span>"free_x"</span>, margins = <span>F</span>) +<br>  labs(y = <span>"Number of Genes"</span>, x = <span>"Term"</span>)+<br>  coord_flip() + theme_classic(base_size = <span>16</span>) +<br>  scale_y_continuous(expand = c(<span>0</span>,<span>0</span>)) +<br>  scale_fill_simpsons() +<br>  geom_text(aes(label=Count), hjust=<span>1.2</span>, color=<span>"white"</span>) <br></code></pre><p data-tool="mdnice编辑器"><br></p><p><img data-galleryid="" data-ratio="0.6121031746031746" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/9YXSPb9ydSZW70mxek19K3JtCayF86FIRwakMLDXRWpRbcFhfYwb4rmkgfEPibpiciavazyMgKAgFABibDWgkzWOmg/640?wx_fmt=png" data-type="png" data-w="1008" src="https://mmbiz.qpic.cn/sz_mmbiz_png/9YXSPb9ydSZW70mxek19K3JtCayF86FIRwakMLDXRWpRbcFhfYwb4rmkgfEPibpiciavazyMgKAgFABibDWgkzWOmg/640?wx_fmt=png"></p><p><br></p><p><span>查找的资料越多，越发现自己的无知，推荐一个哈佛大学转录组的课程吧，见参考链接[6]。</span><br></p><p data-tool="mdnice编辑器">只是简单地写个总结，没曾想被狗粮喂饱(狗粮见参考链接[4]的主页)。呼朋引伴后，被投喂了更多狗粮。Ok，为人类高质量爱情喝彩！</p><h2 data-tool="mdnice编辑器"><span></span><span>Reference</span><span> </span></h2><p data-tool="mdnice编辑器">[1] 生信分析：常用文件数据库地址（GO,uniref）https://www.jianshu.com/p/7c108b851fa3</p><p data-tool="mdnice编辑器">[2] 用AnnotationHub获取非模式物种注释信息https://www.bioinfo-scrounger.com/archives/512/</p><p data-tool="mdnice编辑器">[3] 富集分析：（四）clusterProfiler：不同物种的GO+KEGG富集分析https://zhuanlan.zhihu.com/p/536082841</p><p data-tool="mdnice编辑器">[4] 208-详细回顾非模式物种注释构建过程https://www.jieandze1314.com/post/cnposts/208/</p><p data-tool="mdnice编辑器">[5] Biomedical Knowledge Mining using GOSemSim and clusterProfilerhttps://yulab-smu.top/biomedical-knowledge-mining-book/index.html</p><p data-tool="mdnice编辑器">[6] Differential gene expression workshop using Salmon countshttps://hbctraining.github.io/DGE_workshop_salmon_online/</p></section><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><h3 data-tool="mdnice编辑器"><span></span><span>视频号直播互动答疑</span><span></span></h3><p data-tool="mdnice编辑器">本文代码是可以复制粘贴后在自己的项目中使用的，如果大家测试过程遇到了困难，欢迎明晚七点参与直播互动哈</p><section><mp-common-videosnap data-pluginname="mpvideosnap" data-headimgurl="https://wx.qlogo.cn/finderhead/PiajxSqBRaEI7scvWIPdECSfnUpSjTib9Y7RI14r1VVzxaA57PjcCERw/0" data-username="v2_060000231003b20faec8c7e1881bcad2ca06ec35b07788412aec898c89eb1e34f9a354475e8c@finder" data-nickname="生信技能树" data-desc="将在11月10日 19:00 直播" data-livewording="预约" data-intro="任意物种的go和kegg数据库注释" data-type="live" data-status="0" data-noticeid="finderlivenotice-v2_060000231003b20faec8c7e1881bcad2ca06ec35b07788412aec898c89eb1e34f9a354475e8c@finder-1699531167204541-270435234"></mp-common-videosnap></section></section><h4 data-tool="mdnice编辑器">文末友情宣传</h4><p data-tool="mdnice编辑器">强烈建议你推荐给身边的<strong>博士后以及年轻生物学PI</strong>，多一点数据认知，让他们的科研上一个台阶：</p><ul data-tool="mdnice编辑器"><li><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247526014&amp;idx=1&amp;sn=44afb387fc49b89276386e5182db7bc9&amp;chksm=9b4b26c5ac3cafd35616b2fe9df7fea664e59d75e9970feb322a477beb222ac023f7daebb3dc&amp;scene=21#wechat_redirect" textvalue="生物信息学马拉松授课（买一得‍五）" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1">生物信息学马拉松授课（买一得五）</a> ，你的生物信息学入门课</section></li><li><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247524148&amp;idx=1&amp;sn=7806da6feb41a36493c519c1cfc1d3ac&amp;chksm=9b4bdf8fac3c569960369602f1ef26639cb366b250f233b2297d1f059471c0458335bfc0b829&amp;scene=21#wechat_redirect" textvalue="时隔5年，我们的生信技能树VIP学徒继续招生啦" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1">时隔5年，我们的生信技能树VIP学徒继续招生啦</a><br></section></li><li><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247522831&amp;idx=2&amp;sn=1744efdf428465425a145ff3a982198b&amp;chksm=9b4bdab4ac3c53a28fbecbbff4f254f470b54a7a20468bb753b295b930315e1ec45bcbabc10b&amp;scene=21#wechat_redirect" textvalue="144线程640Gb内存服务器共享一年‍仍然是仅需800" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1">144线程640Gb内存服务器共享一年仍然是仅需800</a></section></li><li><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247519765&amp;idx=1&amp;sn=ce5a8c8182f854c88043059f8c2cb9ff&amp;chksm=9b4bceaeac3c47b88c19941d43dbb1401f3a92206481a0afc41159927868199643f795d62a7e&amp;scene=21#wechat_redirect" textvalue="千呼万唤始出来的独享生物信息学云服务器" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1">千呼万唤始出来的独享生物信息学云服务器</a></section></li><li><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247519765&amp;idx=1&amp;sn=ce5a8c8182f854c88043059f8c2cb9ff&amp;chksm=9b4bceaeac3c47b88c19941d43dbb1401f3a92206481a0afc41159927868199643f795d62a7e&amp;scene=21#wechat_redirect" textvalue="千呼万唤始出来的独享生物信息学云服务器" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1"></a><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247524275&amp;idx=1&amp;sn=fa592ee29f636f34387491d0fceadd8e&amp;chksm=9b4bdf08ac3c561e0881974b3817beb0a0e514dc1a8df4c34c2b6653da6fa78e09acb03c70c2&amp;scene=21#wechat_redirect" textvalue="生信技能树知识整理实习生又又又开放申请啦" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1">生信技能树知识整理实习生又又又开放申请啦</a><span><strong>（不招了，谢谢）</strong></span></section></li><li><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247524432&amp;idx=1&amp;sn=5b33b0c6807a9e6939c332c58fabff89&amp;chksm=9b4b20ebac3ca9fdb3d8bfaf2bef5552f64eb70e7fae557cc7197fb1a23b3e8bc31b585bf829&amp;scene=21#wechat_redirect" textvalue="生信共享办公室出租" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1">生信共享办公室出租</a></p></li></ul><p><br></p><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/av5TWUyqWMpM8xpbFp2NlQ",target="_blank" rel="noopener noreferrer">原文链接</a>
