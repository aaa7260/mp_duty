---
title: "你的Seurat空转无法配色？原来是这个点略有不同"
date: 2023-11-12T10:37:35Z
draft: ["false"]
tags: [
  "fetched",
  "生信作曲家"
]
categories: ["Acdemic"]
---
你的Seurat空转无法配色？原来是这个点略有不同 by 生信作曲家
------
<div><section><blockquote><p><span></span><span></span><span></span><span><span></span></span></p><p><span><span>生信作曲家一直致力于构建国内</span><span><strong>和谐、开放、可持续</strong></span><span><strong>的生物信息交流平台</strong>。生信作曲家的目标是<strong>为每个科研人扫清科研路上的一切障碍，让生物信息学人人可做</strong>。目前，生信作曲家已推出</span><span><strong>"</strong><strong>跟着一区文章学通机器学习”、</strong></span><span><strong>"</strong><strong>跟着一区文章学通单细胞</strong><strong>"、"空间转录组从入门到精通”、孟德尔随机化实战”</strong><span><strong>、</strong></span><strong>Bootstrap<span><strong>、</strong></span>NATMI、CIBERSORTx、hdWGCNA、NTP、metaVIPER算法</strong></span><span>等多种强力教程，同时也兼具数据整理、可视化等核心入门技术教学，开办</span></span><strong><span>单细胞孟德尔发文计划MR、</span></strong><span><span><strong>肿瘤发文计划RS、max，非肿瘤发文计划note、ultra、pro、时空百宝箱计划sp</strong><strong>和五一创新发文计划pro</strong></span><span><strong>等、生信中秋分享会、小年夜分享会、暑期集训营和冬季集训营</strong>等多次。辅导同学实现纯生信SCI发表硕果累累，帮助同学实现医学事业路上的理想与追求。</span></span></p></blockquote><h3><span>问题描述</span></h3><pre><code>mycol = c(<span>"#A0C2E7"</span>,<span>"#6894B9"</span>,<span>"#8798A6"</span>,<span>"#E0D9E0"</span>, <span>"#EDBAA7"</span>,<span>"#FADB7F"</span>,<span>"#F3B646"</span>,<span>"#EF9749"</span>, <span>"#B27466"</span>,<span>"#646F3F"</span>,<span>"#899678"</span>,<span>"#C2BC9A"</span>,<span>"#868A63"</span>,<span>"#C4C3BE"</span>,<span>"#DFA0A6"</span>,<span>"#98B3D9"</span>, <span>"#E4BE92"</span>,<span>"#CB6B7A"</span>,<span>"#D5CBDA"</span>,<span>"#f1707d"</span>,<span>"#f15536"</span>,<span>"#ef5767"</span>,<span>"#ae716e"</span>,<span>"#cb8e85"</span>,<span>"#cf8878"</span>,<span>"#c86f67"</span>,<span>"#f1ccb8"</span>,<span>"#f2debd"</span>,<span>"#b8d38f"</span>,<span>"#ddff95"</span>,<span>"#ff9b6a"</span>,<span>"#f1b8f1"</span>,<span>"#d9b8f1"</span>,<span>"#f1ccb8"</span>,<span>"#f1f1b8"</span>,<span>"#b8f1ed"</span>,<span>"#e7dbca"</span>,<span>"#e26538"</span>,<span>"#f3d751"</span>,<span>"#fd803a"</span>,<span>"#fe997b"</span>,<br><br><br>SpatialDimPlot(sample_seurat,<br> group.by = <span>"opt_clust"</span>,    <span>## opt_clust为seurat_clusters</span><br> label = <span>TRUE</span>,<br> label.size = <span>0</span>,<br> stroke = <span>0</span>,<br> label.box = <span>F</span>,<br>cols = mycolor[<span>15</span>:<span>40</span>]<br> )<br></code></pre><p>我们发现在Seurat版本大于4.1.0的时候，无法直接输入vector格式的数据进行上色，虽然已经设置颜色，但提示没法找到mycol</p><figure><figcaption><img data-ratio="0.30092592592592593" data-type="png" data-w="1080" data-src="https://mmbiz.qpic.cn/mmbiz_png/mo60jlFOtaBy1IDfZP7zV3iaAY1N6ApCKxJDwJXib8ebhvqekr9ymED60g21W8yjvhQa78SSVXvFWiaLSsRl6myLQ/640?wx_fmt=png" src="https://mmbiz.qpic.cn/mmbiz_png/mo60jlFOtaBy1IDfZP7zV3iaAY1N6ApCKxJDwJXib8ebhvqekr9ymED60g21W8yjvhQa78SSVXvFWiaLSsRl6myLQ/640?wx_fmt=png"></figcaption></figure><p><span><strong>其实这是4.1以上seurat的常见问题，以上为seurat 4.4.0的报错</strong></span></p><p>4.0的seurat并不会报错。查阅资料：https://github.com/satijalab/seurat/issues/6179</p><p>发现我们在新版本的seurat（以seurat 4.4.0为例）上, 我们需要给我们的向量<span><strong>命名</strong></span>即可，<strong>每个颜色要对应到我们group.by的组</strong></p><pre><code>Idents(sample_seurat) = sample_seurat$opt_clust <span># opt_clust为seurat clusters.</span><br>colors = mycol[<span>15</span>:<span>25</span>]<br><br>names(colors) &lt;- Idents(sample_seurat) %&gt;% levels() <span>## 命名非常重要</span><br><br>spatial_embedding &lt;- SpatialDimPlot(<br> sample_seurat,<br> images = <span>"slice1"</span>,<br> group.by = c(<span>"opt_clust"</span>),<br> pt.size.factor = <span>1.15</span>,<br> label = <span>TRUE</span>,<br> label.size = <span>6</span>,<br> repel = <span>TRUE</span>,<br> combine = <span>FALSE</span>,<br> cols = colors)<br><br>spatial_embedding  <span>## 成功！</span><br></code></pre><figure><figcaption><img data-ratio="0.8759259259259259" data-type="png" data-w="1080" data-src="https://mmbiz.qpic.cn/mmbiz_png/mo60jlFOtaBy1IDfZP7zV3iaAY1N6ApCKE0y2vRJbtaJYtxiaNIwktticV0ibmH7xxXCCway82tpNHJmvlpJYskMiaA/640?wx_fmt=png" src="https://mmbiz.qpic.cn/mmbiz_png/mo60jlFOtaBy1IDfZP7zV3iaAY1N6ApCKE0y2vRJbtaJYtxiaNIwktticV0ibmH7xxXCCway82tpNHJmvlpJYskMiaA/640?wx_fmt=png"><br><br></figcaption><section><h3><span>后记</span></h3><p>配色一般不会用原始配色了，所以学习配色是必须的！</p></section><figcaption><br></figcaption></figure></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/azUm_I1e41nCIyQ8ubfU4Q",target="_blank" rel="noopener noreferrer">原文链接</a>
