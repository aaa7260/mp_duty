---
title: "infercnv 三回首：深入理解infercnv为何能发nature"
date: 2023-11-18T03:45:50Z
draft: ["false"]
tags: [
  "fetched",
  "生信小博士"
]
categories: ["Acdemic"]
---
infercnv 三回首：深入理解infercnv为何能发nature by 生信小博士
------
<div><p><span>大家好，不知你是否还记得，前两次关于infercnv的介绍。请看这里：</span></p><p><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247525967&amp;idx=1&amp;sn=c0b059b4aec399bf76380b9ae9b1d4ac&amp;scene=21#wechat_redirect" textvalue="肿瘤单细胞转录组拷贝数分析结果解读和应用" linktype="text" imgurl="" imgdata="null" tab="innerlink" data-linktype="2"><span>肿瘤单细胞转录组拷贝数分析结果解读和应用</span></a></p><p><a href="https://mp.weixin.qq.com/s?__biz=Mzg2NDcxMzYwNg==&amp;mid=2247484156&amp;idx=1&amp;sn=32ddcaac03b419c97a5ac2185b93118a&amp;chksm=ce646c15f913e503ea5b0a31e1530c144dbb9b4a61cd10224d0f14a9d73ba2a1e4727a2ad3f5&amp;token=1681830731&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2"><span>单细胞拷贝数变异 infercnv再回首</span></a></p><hr><p><span>如果下载了示例数据，并且你已经跑了上述代码，不难得到这张图：</span></p><p><img data-galleryid="" data-imgfileid="100000588" data-ratio="0.927485380116959" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345Skv7fg2VuLx6nSEqcgOcHONicUXepxx99S7yfsWAck69DKHvibEQuaZNUibKqhic08fnkbuNGicECN7dUiaQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="855" src="https://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345Skv7fg2VuLx6nSEqcgOcHONicUXepxx99S7yfsWAck69DKHvibEQuaZNUibKqhic08fnkbuNGicECN7dUiaQ/640?wx_fmt=png&amp;from=appmsg"></p><p><span>高考作文问<strong>你对这张图的理解</strong>。</span></p><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><p>01</p></section></section></section></section></section></section><section powered-by="xiumi.us"><section><img data-ratio="1.21580547112462" data-s="300,640" data-w="329" data-src="https://mmbiz.qpic.cn/sz_mmbiz_gif/MVPvEL7Qg0EgrwdibaKqfTqpyFcSD7uE2JcEGETKYmdVA1UNUhbaXBa2qqazjc44k52ezTYYvRyoGAIOgrUNVhg/640?wx_fmt=gif" width="100%" data-imgfileid="100000587" src="https://mmbiz.qpic.cn/sz_mmbiz_gif/MVPvEL7Qg0EgrwdibaKqfTqpyFcSD7uE2JcEGETKYmdVA1UNUhbaXBa2qqazjc44k52ezTYYvRyoGAIOgrUNVhg/640?wx_fmt=gif"></section></section><p><span></span><span></span></p><hr><p><span><span>关于我对infercnv的理解：其实结果是哪种图真的不重要，重点是对图形的解读。比如<strong>本文中出现的第一张图</strong>，里面有个绿色圈圈，可以看到<span>柱子里</span>深灰和浅灰部分（就是我标注的A 和B部分）的突变图景肉眼几乎不可分辨，但是却被分属于两群不同的细胞群。</span></span></p><p><img data-galleryid="" data-imgfileid="100000584" data-ratio="0.08851224105461393" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345Skv7fg2VuLx6nSEqcgOcHONicZM70Bdba4bIQyXcV84YqOwGibZK6IDU3Th07IZENZ3oZJPcfib44H8ag/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="531" src="https://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345Skv7fg2VuLx6nSEqcgOcHONicZM70Bdba4bIQyXcV84YqOwGibZK6IDU3Th07IZENZ3oZJPcfib44H8ag/640?wx_fmt=png&amp;from=appmsg"></p><p><span><span>这就说明：通过肉眼观察，从A和B的突变图景上来看，A和B的突变图景是一致的，那么我们就可以把A亚群细胞与B亚群细胞合并，把他们当作恶性细胞。</span></span></p><p><strong><span>但是 </span></strong><span>柱子里所有</span><span>的深</span><span>灰和浅灰  所对应的组别别是seurat分群里面的2群和4群</span><br></p><p><img data-galleryid="" data-imgfileid="100000585" data-ratio="0.3802521008403361" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345Skv7fg2VuLx6nSEqcgOcHONicMlGnLBYmjicpW1QCPMJDhOY60gdX2BI8D43oFlHCcxM6zmvHhzicic2xg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="952" src="https://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345Skv7fg2VuLx6nSEqcgOcHONicMlGnLBYmjicpW1QCPMJDhOY60gdX2BI8D43oFlHCcxM6zmvHhzicic2xg/640?wx_fmt=png&amp;from=appmsg"></p><p><strong><span>这就提示我们本文中的seurat分群结果并不一定能把恶性细胞单纯分出来<br>（也许我们在seurat里可以把所有分辨率都试一下，理论上应该可以分出恶性细胞）。所以我们要对seurat的分群结果进行重新命名，2群和4群中我画出来的A和B是恶性细胞，但是<strong><span>2群和4群中</span></strong>剩下的其他部分细胞不是。</span></strong></p><hr><p><span><span>其实，你仔细去看这张图的话，最左边还有一根柱子，这个柱子不同的颜色对应着infercnv突变图景的聚类结果。你会发现最左边的柱子上存在A1 和B1部分（用红字标出来的部分）正好对应着A1和B1部分的细胞。这里的<span>A1 和B</span><span>1的聚类结果就是我们想要定义的恶性细胞。我们可以通过代码获取<span>A1</span><span>和B1</span><span>部</span><span>分细胞id（这是一个思考题，如何获取细胞id见文末），进而命名为恶性细胞。</span></span></span></span></p><p><img data-galleryid="" data-imgfileid="100000586" data-ratio="0.4064814814814815" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345Skv7fg2VuLx6nSEqcgOcHONicr9dARKVJTtO8uHTlFkbfkRpVbfwgcv24XEiarPtLjlIwl5NXH2VvevQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345Skv7fg2VuLx6nSEqcgOcHONicr9dARKVJTtO8uHTlFkbfkRpVbfwgcv24XEiarPtLjlIwl5NXH2VvevQ/640?wx_fmt=png&amp;from=appmsg"></p><hr><p><strong><span>就本数据集而言</span></strong><span><span><strong>，通过这样的分析，大家能明白为啥我们要做cnvscore了吗：因为单纯通过seruat分群，只能找出2群和4群为恶性细胞。但实际上只有<strong>2群和4群中的A部分和B部分为恶性细胞。    </strong></strong></span><strong><strong>所以说infercnv备受CNS青睐，是因为它精准的预测恶性细胞的能力，而这种能力是普通的降维聚类分群所达不到的(</strong></strong></span><span>感兴趣的同学可以在seurat中把分辨率调大一点再试试</span><span><strong><strong>)。</strong></strong></span><strong><strong></strong></strong></p><p><span><span><strong><strong>致敬！</strong></strong></span></span></p><p>Anoop P. Patel, Itay Tirosh, et al. Single-cell RNA-seq highlights intratumoral heterogeneity in primary glioblastoma. <strong>Science</strong>. 2014 Jun 20: 1396-1401</p><p>Tirosh I et al. Dissecting the multicellular ecosystem of metastatic melanoma by single-cell RNA-seq. <strong>Science</strong>. 2016 Apr 8;352(6282):189-96</p><p>Tirosh I et al. Single-cell RNA-seq supports a developmental hierarchy in human oligodendroglioma. <strong>Nature</strong>. 2016 Nov 10;539(7628):309-313. PubMed PMID: 27806376; PubMed Central PMCID: PMC5465819.</p><p>Venteicher AS, Tirosh I, et al. Decoupling genetics, lineages, and microenvironment in IDH-mutant gliomas by single-cell RNA-seq. <strong>Science</strong>. 2017 Mar 31;355(6332).PubMed PMID: 28360267; PubMed Central PMCID: PMC5519096.</p><p>Puram SV, Tirosh I, et al. Single-Cell Transcriptomic Analysis of Primary and Metastatic Tumor Ecosystems in Head and Neck Cancer.<strong> Cell</strong>. 2017 Dec 14;171(7):1611-1624.e24. PubMed PMID: 29198524; PubMed Central PMCID: PMC5878932.</p><hr><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><p>02</p></section></section></section></section></section></section><section powered-by="xiumi.us"><section><img data-imgfileid="100000590" data-ratio="1.21580547112462" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_gif/MVPvEL7Qg0EgrwdibaKqfTqpyFcSD7uE2JcEGETKYmdVA1UNUhbaXBa2qqazjc44k52ezTYYvRyoGAIOgrUNVhg/640?wx_fmt=gif" data-w="329" width="100%" src="https://mmbiz.qpic.cn/sz_mmbiz_gif/MVPvEL7Qg0EgrwdibaKqfTqpyFcSD7uE2JcEGETKYmdVA1UNUhbaXBa2qqazjc44k52ezTYYvRyoGAIOgrUNVhg/640?wx_fmt=gif"></section></section><p><span><span>ok，我这里只是稍带了一下infercnv的厉害之处，下面我们进入第二个问题，</span></span><span>你知道为什么为什么有的文章会使用另外一种图吗？</span><span>：</span></p><p><img data-galleryid="" data-imgfileid="100000589" data-ratio="0.688622754491018" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345Skv7fg2VuLx6nSEqcgOcHONic1I1qlfw17vVm5XvkALySeibM6xCFliaZ7xaMye4u0icCN6wgrdSroMOaA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="668" src="https://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345Skv7fg2VuLx6nSEqcgOcHONic1I1qlfw17vVm5XvkALySeibM6xCFliaZ7xaMye4u0icCN6wgrdSroMOaA/640?wx_fmt=png&amp;from=appmsg"></p><hr><p><span><span>大家可以看到最左边的柱子，本文第一个图是多色的，而这个只有靛青色。你知道这分别代表什么意思吗？欢迎来稿，说出你的见解，下期见分晓~。</span></span></p><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><p>2.5<br></p></section></section></section></section></section></section><section powered-by="xiumi.us"><section><img data-imgfileid="100000591" data-ratio="1.21580547112462" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_gif/MVPvEL7Qg0EgrwdibaKqfTqpyFcSD7uE2JcEGETKYmdVA1UNUhbaXBa2qqazjc44k52ezTYYvRyoGAIOgrUNVhg/640?wx_fmt=gif" data-w="329" width="100%" src="https://mmbiz.qpic.cn/sz_mmbiz_gif/MVPvEL7Qg0EgrwdibaKqfTqpyFcSD7uE2JcEGETKYmdVA1UNUhbaXBa2qqazjc44k52ezTYYvRyoGAIOgrUNVhg/640?wx_fmt=gif"></section></section><p><span><span><span>有的时候还会出现下面这种图，看着就很诡异：</span></span></span></p><p><img data-galleryid="" data-imgfileid="100000593" data-ratio="0.9339622641509434" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345Skv7fg2VuLx6nSEqcgOcHONic5PcILMTwtKvibrjF7QrFu9ShhIbCBicQhbkbQwbAsxBTyBiaJflu5YW1g/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="848" src="https://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345Skv7fg2VuLx6nSEqcgOcHONic5PcILMTwtKvibrjF7QrFu9ShhIbCBicQhbkbQwbAsxBTyBiaJflu5YW1g/640?wx_fmt=png&amp;from=appmsg"></p><p><span><span><span>但是真不用害怕，这些图都是正常的，这是由于参数的原因！你要学会找到你到底需要哪一张图。</span></span></span></p><p><span>出现各种奇怪的图，基本就两个原因：</span><span>1.参数原</span><span>因（cluster_by_groups和leiden_resolution参数<strong>特别重要</strong>）</span><span>  2.细胞数量原因 。详情见官方链接</span><span>https://www.youtube.com/watch?v=-qOcHAavZT8</span><span></span></p><p><span><span><span><br></span></span></span></p><hr><p><span><span><span></span></span></span></p><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><p>03</p></section></section></section></section></section></section><section powered-by="xiumi.us"><section><img data-imgfileid="100000592" data-ratio="1.21580547112462" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_gif/MVPvEL7Qg0EgrwdibaKqfTqpyFcSD7uE2JcEGETKYmdVA1UNUhbaXBa2qqazjc44k52ezTYYvRyoGAIOgrUNVhg/640?wx_fmt=gif" data-w="329" width="100%" src="https://mmbiz.qpic.cn/sz_mmbiz_gif/MVPvEL7Qg0EgrwdibaKqfTqpyFcSD7uE2JcEGETKYmdVA1UNUhbaXBa2qqazjc44k52ezTYYvRyoGAIOgrUNVhg/640?wx_fmt=gif"></section></section><p><span><span><span></span></span></span></p><p><strong><span><span><span>下面列举七种不同参数出的不同结果</span></span></span></strong></p><p><span><span><strong><span>当然你可以在每个代码里面都加上 denoise=T参数 进行降噪处理</span></strong></span></span><span><span><strong><span><br></span></strong></span></span></p><hr><p><strong><span><span>接下来就展示一下不同的代码参数，所获得的突变图景，稍有差别。</span></span></strong></p><p><strong><span><span></span></span></strong></p><section><section powered-by="xiumi.us"><section><p><strong>0</strong></p></section></section></section><section><section powered-by="xiumi.us"><section><strong><svg viewbox="0 0 1 1"></svg></strong></section></section></section><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><strong><img data-imgfileid="100000594" data-ratio="0.954" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/6UmgNV3YbzNOcZp9aDMibd0S8S3pCp6dqHnswC5kOrrAWRwKAF0PoUfVKqkQTjh1kwQb3HyXWU5Z2DyWfSOdSicw/640?wx_fmt=png" data-w="500" width="100%" src="https://mmbiz.qpic.cn/sz_mmbiz_png/6UmgNV3YbzNOcZp9aDMibd0S8S3pCp6dqHnswC5kOrrAWRwKAF0PoUfVKqkQTjh1kwQb3HyXWU5Z2DyWfSOdSicw/640?wx_fmt=png"></strong></section></section></section><section><section powered-by="xiumi.us"><section><strong><img data-imgfileid="100000595" data-ratio="0.954" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/6UmgNV3YbzNOcZp9aDMibd0S8S3pCp6dqHnswC5kOrrAWRwKAF0PoUfVKqkQTjh1kwQb3HyXWU5Z2DyWfSOdSicw/640?wx_fmt=png" data-w="500" width="100%" src="https://mmbiz.qpic.cn/sz_mmbiz_png/6UmgNV3YbzNOcZp9aDMibd0S8S3pCp6dqHnswC5kOrrAWRwKAF0PoUfVKqkQTjh1kwQb3HyXWU5Z2DyWfSOdSicw/640?wx_fmt=png">                     </strong></section></section><section powered-by="xiumi.us"><section><strong><br></strong></section></section><section powered-by="xiumi.us"><section><strong><br></strong></section></section><section powered-by="xiumi.us"><strong><br></strong></section></section></section></section><p><br></p><p><em><span>如果没有cluster_by_groups=T参数的话,图形丑且不能用。</span></em></p><section><ul><li><li><li><li><li><li></ul><pre data-lang="cpp"><code><span>  <span># cutoff=1 works well for Smart-seq2, and cutoff=0.1 works well for 10x Genomics</span></span></code><code><span>  infercnv_obj2 = infercnv::run(infercnv_obj,</span></code><code><span>                                cutoff=<span>0.1</span>, # cutoff=<span>1</span> works well <span>for</span> Smart-seq2, <span>and</span> cutoff=<span>0.1</span> works well <span>for</span> <span>10</span>x Genomics</span></code><code><span>                                out_dir= <span>"infercnv_output_noclusterbygroup"</span>,  # dir is <span>auto</span>-created <span>for</span> storing outputs</span></code><code><span>                               # cluster_by_groups=T ,   # cluster</span></code><code><span>                                hclust_method=<span>"ward.D2"</span>, plot_steps=F)</span></code></pre></section><section><p><img data-galleryid="" data-imgfileid="100000598" data-ratio="1.238826815642458" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345Skv7fg2VuLx6nSEqcgOcHONicgZQibk3ian7ZqHP4Ry3egcsv4EWfAMKY3icE0MkopJeNEKiboRIDJaPSOA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="716" src="https://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345Skv7fg2VuLx6nSEqcgOcHONicgZQibk3ian7ZqHP4Ry3egcsv4EWfAMKY3icE0MkopJeNEKiboRIDJaPSOA/640?wx_fmt=png&amp;from=appmsg"></p><p><img data-galleryid="" data-imgfileid="100000597" data-ratio="1.0423728813559323" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345Skv7fg2VuLx6nSEqcgOcHONicfVzoMycretnxVaEaHs7RVHJKUqvmgF5fBHKTRuCibYt37TWsiancyGicg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="826" src="https://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345Skv7fg2VuLx6nSEqcgOcHONicfVzoMycretnxVaEaHs7RVHJKUqvmgF5fBHKTRuCibYt37TWsiancyGicg/640?wx_fmt=png&amp;from=appmsg"></p><hr><section powered-by="xiumi.us"><br></section></section><p><strong><span><span>后面都加上这个参数：<br></span></span></strong></p><section><section powered-by="xiumi.us"><section><p><strong>1</strong></p></section></section></section><section><section powered-by="xiumi.us"><section><strong><svg viewbox="0 0 1 1"></svg></strong></section></section></section><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><strong><img data-imgfileid="100000596" data-ratio="0.954" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/6UmgNV3YbzNOcZp9aDMibd0S8S3pCp6dqHnswC5kOrrAWRwKAF0PoUfVKqkQTjh1kwQb3HyXWU5Z2DyWfSOdSicw/640?wx_fmt=png" data-w="500" width="100%" src="https://mmbiz.qpic.cn/sz_mmbiz_png/6UmgNV3YbzNOcZp9aDMibd0S8S3pCp6dqHnswC5kOrrAWRwKAF0PoUfVKqkQTjh1kwQb3HyXWU5Z2DyWfSOdSicw/640?wx_fmt=png"></strong></section></section></section><section><section powered-by="xiumi.us"><section><strong><img data-imgfileid="100000599" data-ratio="0.954" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/6UmgNV3YbzNOcZp9aDMibd0S8S3pCp6dqHnswC5kOrrAWRwKAF0PoUfVKqkQTjh1kwQb3HyXWU5Z2DyWfSOdSicw/640?wx_fmt=png" data-w="500" width="100%" src="https://mmbiz.qpic.cn/sz_mmbiz_png/6UmgNV3YbzNOcZp9aDMibd0S8S3pCp6dqHnswC5kOrrAWRwKAF0PoUfVKqkQTjh1kwQb3HyXWU5Z2DyWfSOdSicw/640?wx_fmt=png"></strong></section></section></section></section></section><p><br></p><section><ul><li><li><li><li><li><li><li></ul><pre data-lang="cpp"><code><span> <span># cutoff=1 works well for Smart-seq2, and cutoff=0.1 works well for 10x Genomics</span></span></code><code><span>  infercnv_obj2 = infercnv::run(infercnv_obj,</span></code><code><span>                                cutoff=<span>0.1</span>, # cutoff=<span>1</span> works well <span>for</span> Smart-seq2, <span>and</span> cutoff=<span>0.1</span> works well <span>for</span> <span>10</span>x Genomics</span></code><code><span>                                out_dir= <span>"infercnv_output"</span>,  # dir is <span>auto</span>-created <span>for</span> storing outputs</span></code><code><span>                                cluster_by_groups=T ,   # cluster</span></code><code><span>                                hclust_method=<span>"ward.D2"</span>, plot_steps=F)</span></code><code><span>  </span></code></pre></section><p><img data-galleryid="" data-imgfileid="100000602" data-ratio="1.1290760869565217" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345Skv7fg2VuLx6nSEqcgOcHONicdh3Z7aCzH84jrCNbWlu5DLDOTk1DvlanPoAnhwkZHLqJ7QzPukHATw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="736" src="https://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345Skv7fg2VuLx6nSEqcgOcHONicdh3Z7aCzH84jrCNbWlu5DLDOTk1DvlanPoAnhwkZHLqJ7QzPukHATw/640?wx_fmt=png&amp;from=appmsg"></p><p><img data-galleryid="" data-imgfileid="100000603" data-ratio="0.9383647798742139" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345Skv7fg2VuLx6nSEqcgOcHONicK0g14JXuVUjoXjb3FEmhm4GV7GozQ15pXVLyoGF9AxzKkH0O4s8CibQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="795" src="https://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345Skv7fg2VuLx6nSEqcgOcHONicK0g14JXuVUjoXjb3FEmhm4GV7GozQ15pXVLyoGF9AxzKkH0O4s8CibQ/640?wx_fmt=png&amp;from=appmsg"></p><p><strong><strong></strong></strong></p><section><section powered-by="xiumi.us"><section><p><strong>2</strong></p></section></section></section><section><section powered-by="xiumi.us"><section><strong><svg viewbox="0 0 1 1"></svg></strong></section></section></section><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><strong><img data-imgfileid="100000601" data-ratio="0.954" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/6UmgNV3YbzNOcZp9aDMibd0S8S3pCp6dqHnswC5kOrrAWRwKAF0PoUfVKqkQTjh1kwQb3HyXWU5Z2DyWfSOdSicw/640?wx_fmt=png" data-w="500" width="100%" src="https://mmbiz.qpic.cn/sz_mmbiz_png/6UmgNV3YbzNOcZp9aDMibd0S8S3pCp6dqHnswC5kOrrAWRwKAF0PoUfVKqkQTjh1kwQb3HyXWU5Z2DyWfSOdSicw/640?wx_fmt=png"></strong></section></section></section><section><section powered-by="xiumi.us"><section><strong><img data-imgfileid="100000600" data-ratio="0.954" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/6UmgNV3YbzNOcZp9aDMibd0S8S3pCp6dqHnswC5kOrrAWRwKAF0PoUfVKqkQTjh1kwQb3HyXWU5Z2DyWfSOdSicw/640?wx_fmt=png" data-w="500" width="100%" src="https://mmbiz.qpic.cn/sz_mmbiz_png/6UmgNV3YbzNOcZp9aDMibd0S8S3pCp6dqHnswC5kOrrAWRwKAF0PoUfVKqkQTjh1kwQb3HyXWU5Z2DyWfSOdSicw/640?wx_fmt=png"></strong></section></section></section></section></section><section><ul><li><li><li><li><li><li></ul><pre data-lang="cpp"><code><span> infercnv_obj2 = infercnv::run(infercnv_obj,</span></code><code><span>                                cutoff=<span>0.1</span>, # cutoff=<span>1</span> works well <span>for</span> Smart-seq2, <span>and</span> cutoff=<span>0.1</span> works well <span>for</span> <span>10</span>x Genomics</span></code><code><span>                                out_dir= <span>"infercnv_output2"</span>,  # dir is <span>auto</span>-created <span>for</span> storing outputs</span></code><code><span>                                cluster_by_groups=T ,   # cluster</span></code><code><span>                                leiden_resolution = <span>0.01</span>,</span></code><code><span>                                hclust_method=<span>"ward.D2"</span>, plot_steps=F)</span></code></pre></section><p><img data-galleryid="" data-imgfileid="100000606" data-ratio="1.0341151385927505" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345Skv7fg2VuLx6nSEqcgOcHONicCbNYRENbjAUv3IFvFiaKbZh2NqSFYUEmia5qJQGUAIrJ32QTQvocLqww/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="938" src="https://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345Skv7fg2VuLx6nSEqcgOcHONicCbNYRENbjAUv3IFvFiaKbZh2NqSFYUEmia5qJQGUAIrJ32QTQvocLqww/640?wx_fmt=png&amp;from=appmsg"></p><p><img data-galleryid="" data-imgfileid="100000605" data-ratio="0.9193954659949622" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345Skv7fg2VuLx6nSEqcgOcHONicIT3yiaADI38351PvQPgkvLf4pmj5kbG64ibc6klffQVpRRVXGicAJjvDg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="794" src="https://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345Skv7fg2VuLx6nSEqcgOcHONicIT3yiaADI38351PvQPgkvLf4pmj5kbG64ibc6klffQVpRRVXGicAJjvDg/640?wx_fmt=png&amp;from=appmsg"></p><p><br></p><section><section powered-by="xiumi.us"><section><p><strong>3</strong></p></section></section></section><section><section powered-by="xiumi.us"><section><strong><svg viewbox="0 0 1 1"></svg></strong></section></section></section><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><strong><img data-imgfileid="100000608" data-ratio="0.954" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/6UmgNV3YbzNOcZp9aDMibd0S8S3pCp6dqHnswC5kOrrAWRwKAF0PoUfVKqkQTjh1kwQb3HyXWU5Z2DyWfSOdSicw/640?wx_fmt=png" data-w="500" width="100%" src="https://mmbiz.qpic.cn/sz_mmbiz_png/6UmgNV3YbzNOcZp9aDMibd0S8S3pCp6dqHnswC5kOrrAWRwKAF0PoUfVKqkQTjh1kwQb3HyXWU5Z2DyWfSOdSicw/640?wx_fmt=png"></strong></section></section></section><section><section powered-by="xiumi.us"><section><strong><img data-imgfileid="100000604" data-ratio="0.954" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/6UmgNV3YbzNOcZp9aDMibd0S8S3pCp6dqHnswC5kOrrAWRwKAF0PoUfVKqkQTjh1kwQb3HyXWU5Z2DyWfSOdSicw/640?wx_fmt=png" data-w="500" width="100%" src="https://mmbiz.qpic.cn/sz_mmbiz_png/6UmgNV3YbzNOcZp9aDMibd0S8S3pCp6dqHnswC5kOrrAWRwKAF0PoUfVKqkQTjh1kwQb3HyXWU5Z2DyWfSOdSicw/640?wx_fmt=png"></strong></section></section></section></section></section><section><ul><li><li><li><li><li><li><li></ul><pre data-lang="cpp"><code><span>  infercnv_obj2 = infercnv::run(infercnv_obj,</span></code><code><span>                                cutoff=<span>0.1</span>, # cutoff=<span>1</span> works well <span>for</span> Smart-seq2, <span>and</span> cutoff=<span>0.1</span> works well <span>for</span> <span>10</span>x Genomics</span></code><code><span>                                out_dir= <span>"infercnv_outputres0.6"</span>,  # dir is <span>auto</span>-created <span>for</span> storing outputs</span></code><code><span>                                cluster_by_groups=T ,   # cluster</span></code><code><span>                                leiden_resolution = <span>0.6</span>,</span></code><code><span>                                hclust_method=<span>"ward.D2"</span>, plot_steps=F)</span></code><code><span>  </span></code></pre></section><p><img data-galleryid="" data-imgfileid="100000607" data-ratio="0.9232704402515723" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345Skv7fg2VuLx6nSEqcgOcHONic8OgaY3l4wt22SXqx9WwiawjepBbTgfZUE4nTA3Hd8mr744IPvVibL4TA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="795" src="https://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345Skv7fg2VuLx6nSEqcgOcHONic8OgaY3l4wt22SXqx9WwiawjepBbTgfZUE4nTA3Hd8mr744IPvVibL4TA/640?wx_fmt=png&amp;from=appmsg"></p><p><strong><strong></strong></strong></p><section><section powered-by="xiumi.us"><section><p><strong>4</strong></p></section></section></section><section><section powered-by="xiumi.us"><section><strong><svg viewbox="0 0 1 1"></svg></strong></section></section></section><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><strong><img data-imgfileid="100000609" data-ratio="0.954" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/6UmgNV3YbzNOcZp9aDMibd0S8S3pCp6dqHnswC5kOrrAWRwKAF0PoUfVKqkQTjh1kwQb3HyXWU5Z2DyWfSOdSicw/640?wx_fmt=png" data-w="500" width="100%" src="https://mmbiz.qpic.cn/sz_mmbiz_png/6UmgNV3YbzNOcZp9aDMibd0S8S3pCp6dqHnswC5kOrrAWRwKAF0PoUfVKqkQTjh1kwQb3HyXWU5Z2DyWfSOdSicw/640?wx_fmt=png"></strong></section></section></section><section><section powered-by="xiumi.us"><section><strong><img data-imgfileid="100000611" data-ratio="0.954" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/6UmgNV3YbzNOcZp9aDMibd0S8S3pCp6dqHnswC5kOrrAWRwKAF0PoUfVKqkQTjh1kwQb3HyXWU5Z2DyWfSOdSicw/640?wx_fmt=png" data-w="500" width="100%" src="https://mmbiz.qpic.cn/sz_mmbiz_png/6UmgNV3YbzNOcZp9aDMibd0S8S3pCp6dqHnswC5kOrrAWRwKAF0PoUfVKqkQTjh1kwQb3HyXWU5Z2DyWfSOdSicw/640?wx_fmt=png"></strong></section></section></section></section></section><section><ul><li><li><li><li><li><li><li><li></ul><pre data-lang="php"><code><span>  infercnv_obj2 = infercnv::run(infercnv_obj,</span></code><code><span>                                cutoff=<span>0.1</span>, <span># cutoff=1 works well for Smart-seq2, and cutoff=0.1 works well for 10x Genomics</span></span></code><code><span>                                out_dir= <span>"infercnv_outputres0.01"</span>,  <span># dir is auto-created for storing outputs</span></span></code><code><span>                                cluster_by_groups=T ,   <span># cluster</span></span></code><code><span>                                leiden_resolution = <span>0.01</span>,</span></code><code><span>                                HMM = <span>TRUE</span>,</span></code><code><span>                                 plot_steps=F)</span></code><code><span>                                <span>#subcluster</span></span></code></pre></section><p><img data-galleryid="" data-imgfileid="100000613" data-ratio="1.0233545647558386" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345Skv7fg2VuLx6nSEqcgOcHONic9NWwXwoKz8fNcsvYia70h3bvhQQZakcmYEX8wzTn0oibMMREfMQro1NQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="942" src="https://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345Skv7fg2VuLx6nSEqcgOcHONic9NWwXwoKz8fNcsvYia70h3bvhQQZakcmYEX8wzTn0oibMMREfMQro1NQ/640?wx_fmt=png&amp;from=appmsg"></p><p><img data-galleryid="" data-imgfileid="100000612" data-ratio="1.0063157894736843" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345Skv7fg2VuLx6nSEqcgOcHONic4QYYWAwppFmVbhibY0MKVibcu6NLvzvOgvibc6leQOhB3ibF2VHlhKL7Aw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="950" src="https://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345Skv7fg2VuLx6nSEqcgOcHONic4QYYWAwppFmVbhibY0MKVibcu6NLvzvOgvibc6leQOhB3ibF2VHlhKL7Aw/640?wx_fmt=png&amp;from=appmsg"></p><p><br></p><section><section powered-by="xiumi.us"><section><p><strong>5</strong></p></section></section></section><section><section powered-by="xiumi.us"><section><strong><svg viewbox="0 0 1 1"></svg></strong></section></section></section><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><strong><img data-imgfileid="100000610" data-ratio="0.954" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/6UmgNV3YbzNOcZp9aDMibd0S8S3pCp6dqHnswC5kOrrAWRwKAF0PoUfVKqkQTjh1kwQb3HyXWU5Z2DyWfSOdSicw/640?wx_fmt=png" data-w="500" width="100%" src="https://mmbiz.qpic.cn/sz_mmbiz_png/6UmgNV3YbzNOcZp9aDMibd0S8S3pCp6dqHnswC5kOrrAWRwKAF0PoUfVKqkQTjh1kwQb3HyXWU5Z2DyWfSOdSicw/640?wx_fmt=png"></strong></section></section></section><section><section powered-by="xiumi.us"><section><strong><img data-imgfileid="100000615" data-ratio="0.954" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/6UmgNV3YbzNOcZp9aDMibd0S8S3pCp6dqHnswC5kOrrAWRwKAF0PoUfVKqkQTjh1kwQb3HyXWU5Z2DyWfSOdSicw/640?wx_fmt=png" data-w="500" width="100%" src="https://mmbiz.qpic.cn/sz_mmbiz_png/6UmgNV3YbzNOcZp9aDMibd0S8S3pCp6dqHnswC5kOrrAWRwKAF0PoUfVKqkQTjh1kwQb3HyXWU5Z2DyWfSOdSicw/640?wx_fmt=png"></strong></section></section></section></section></section><section><ul><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="nginx"><code><span>  <span>infercnv_obj2</span> = infercnv::run(infercnv_obj,</span></code><code><span>                                cutoff=<span>0</span>.<span>1</span>,  <span># use 1 for smart-seq, 0.1 for 10x-genomics</span></span></code><code><span>                                out_dir=<span>"infercnv_output_mycodes"</span>,  <span># dir is auto-created for storing outputs</span></span></code><code><span>                                analysis_mode=<span>"subclusters"</span>, <span># 更好方法，按照 cnv 亚群进行预测，而不是样本。能更好的区分肿瘤异质性。</span></span></code><code><span>                                cluster_by_groups=T,  <span># 根据细胞类型对肿瘤细胞执行单独的聚类，如 cell annotations 文件中定义的那样</span></span></code><code><span>                                denoise=T,  <span># 去噪处理</span></span></code><code><span>                                num_threads=<span>18</span>, <span># 设置线程数, 多线程运行，加快计算速度</span></span></code><code><span>                                HMM=T,</span></code><code><span>                              <span>#  hclust_method="ward.D2", </span></span></code><code><span>                                plot_steps=F</span></code><code><span>                                )</span></code><code><span>  </span></code></pre></section><p><img data-galleryid="" data-imgfileid="100000618" data-ratio="1.0852017937219731" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345Skv7fg2VuLx6nSEqcgOcHONicP1q06ia32Hu7EoJytfMOmCQkSN1s4jyTia44jdwKRNc0Y71n5NfJVr2Q/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="892" src="https://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345Skv7fg2VuLx6nSEqcgOcHONicP1q06ia32Hu7EoJytfMOmCQkSN1s4jyTia44jdwKRNc0Y71n5NfJVr2Q/640?wx_fmt=png&amp;from=appmsg"></p><p><img data-galleryid="" data-imgfileid="100000617" data-ratio="1.0168776371308017" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345Skv7fg2VuLx6nSEqcgOcHONicu6AkTOJzvou7JnWiar1KFpYG14lGEkmcWuCUT33UH717fo2ibYSD8QmA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="948" src="https://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345Skv7fg2VuLx6nSEqcgOcHONicu6AkTOJzvou7JnWiar1KFpYG14lGEkmcWuCUT33UH717fo2ibYSD8QmA/640?wx_fmt=png&amp;from=appmsg"></p><p><br></p><section><section powered-by="xiumi.us"><section><p><strong>6</strong></p></section></section></section><section><section powered-by="xiumi.us"><section><strong><svg viewbox="0 0 1 1"></svg></strong></section></section></section><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><strong><img data-imgfileid="100000614" data-ratio="0.954" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/6UmgNV3YbzNOcZp9aDMibd0S8S3pCp6dqHnswC5kOrrAWRwKAF0PoUfVKqkQTjh1kwQb3HyXWU5Z2DyWfSOdSicw/640?wx_fmt=png" data-w="500" width="100%" src="https://mmbiz.qpic.cn/sz_mmbiz_png/6UmgNV3YbzNOcZp9aDMibd0S8S3pCp6dqHnswC5kOrrAWRwKAF0PoUfVKqkQTjh1kwQb3HyXWU5Z2DyWfSOdSicw/640?wx_fmt=png"></strong></section></section></section><section><section powered-by="xiumi.us"><section><strong><img data-imgfileid="100000616" data-ratio="0.954" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/6UmgNV3YbzNOcZp9aDMibd0S8S3pCp6dqHnswC5kOrrAWRwKAF0PoUfVKqkQTjh1kwQb3HyXWU5Z2DyWfSOdSicw/640?wx_fmt=png" data-w="500" width="100%" src="https://mmbiz.qpic.cn/sz_mmbiz_png/6UmgNV3YbzNOcZp9aDMibd0S8S3pCp6dqHnswC5kOrrAWRwKAF0PoUfVKqkQTjh1kwQb3HyXWU5Z2DyWfSOdSicw/640?wx_fmt=png"></strong></section></section></section></section></section><section><ul><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="cpp"><code><span><br></span></code><code><span>  </span></code><code><span>  infercnv_obj2 = infercnv::run(infercnv_obj,</span></code><code><span>                                cutoff=<span>0.1</span>, # cutoff=<span>1</span> works well <span>for</span> Smart-seq2, <span>and</span> cutoff=<span>0.1</span> works well <span>for</span> <span>10</span>x Genomics</span></code><code><span>                                out_dir= <span>"infercnv_outputres0.1"</span>,  # dir is <span>auto</span>-created <span>for</span> storing outputs</span></code><code><span>                                cluster_by_groups=T ,   # cluster</span></code><code><span>                                leiden_resolution = <span>0.1</span>,</span></code><code><span>                                #hclust_method=<span>"HMM"</span>,</span></code><code><span>                               plot_steps=F)</span></code><code><span>  </span></code></pre></section><p><img data-galleryid="" data-imgfileid="100000623" data-ratio="1.0020898641588296" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345Skv7fg2VuLx6nSEqcgOcHONicfMiaOlnXBX9wZqRNiamsKObMqy98xjwcSUKLMbqovoOTficOJuLaDaABA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="957" src="https://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345Skv7fg2VuLx6nSEqcgOcHONicfMiaOlnXBX9wZqRNiamsKObMqy98xjwcSUKLMbqovoOTficOJuLaDaABA/640?wx_fmt=png&amp;from=appmsg"></p><p><img data-galleryid="" data-imgfileid="100000622" data-ratio="1.197560975609756" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345Skv7fg2VuLx6nSEqcgOcHONicl6iaXW4Jv9Ja7f7j5mvJxkDAMfnKc6WQ6eAibBIoiaEoibEVJRNC4mCITw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="820" src="https://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345Skv7fg2VuLx6nSEqcgOcHONicl6iaXW4Jv9Ja7f7j5mvJxkDAMfnKc6WQ6eAibBIoiaEoibEVJRNC4mCITw/640?wx_fmt=png&amp;from=appmsg"></p><p><br></p><section><section powered-by="xiumi.us"><section><p><strong>7</strong></p></section></section></section><section><section powered-by="xiumi.us"><section><strong><svg viewbox="0 0 1 1"></svg></strong></section></section></section><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><strong><img data-ratio="0.954" data-s="300,640" data-w="500" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/6UmgNV3YbzNOcZp9aDMibd0S8S3pCp6dqHnswC5kOrrAWRwKAF0PoUfVKqkQTjh1kwQb3HyXWU5Z2DyWfSOdSicw/640?wx_fmt=png" width="100%" data-imgfileid="100000619" src="https://mmbiz.qpic.cn/sz_mmbiz_png/6UmgNV3YbzNOcZp9aDMibd0S8S3pCp6dqHnswC5kOrrAWRwKAF0PoUfVKqkQTjh1kwQb3HyXWU5Z2DyWfSOdSicw/640?wx_fmt=png"></strong></section></section></section><section><section powered-by="xiumi.us"><section><strong><img data-ratio="0.954" data-s="300,640" data-w="500" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/6UmgNV3YbzNOcZp9aDMibd0S8S3pCp6dqHnswC5kOrrAWRwKAF0PoUfVKqkQTjh1kwQb3HyXWU5Z2DyWfSOdSicw/640?wx_fmt=png" width="100%" data-imgfileid="100000620" src="https://mmbiz.qpic.cn/sz_mmbiz_png/6UmgNV3YbzNOcZp9aDMibd0S8S3pCp6dqHnswC5kOrrAWRwKAF0PoUfVKqkQTjh1kwQb3HyXWU5Z2DyWfSOdSicw/640?wx_fmt=png"></strong></section></section></section></section></section><section><ul><li><li><li><li><li><li></ul><pre data-lang="cpp"><code><span> infercnv_obj2 = infercnv::run(infercnv_obj,</span></code><code><span>                                cutoff=<span>0.1</span>, # cutoff=<span>1</span> works well <span>for</span> Smart-seq2, <span>and</span> cutoff=<span>0.1</span> works well <span>for</span> <span>10</span>x Genomics</span></code><code><span>                                out_dir= <span>"infercnv_outputres0.2"</span>,  # dir is <span>auto</span>-created <span>for</span> storing outputs</span></code><code><span>                                cluster_by_groups=T ,   # cluster</span></code><code><span>                                leiden_resolution = <span>0.2</span>,</span></code><code><span>                                HMM = TRUE, plot_steps=F)</span></code></pre></section><p><img data-galleryid="" data-imgfileid="100000621" data-ratio="1.034518828451883" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345Skv7fg2VuLx6nSEqcgOcHONic53A7uRhcr7ugReEicgZU2qmt0T3wtyfD7fkD2tKk1gK6ggXtdibs5sYw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="956" src="https://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345Skv7fg2VuLx6nSEqcgOcHONic53A7uRhcr7ugReEicgZU2qmt0T3wtyfD7fkD2tKk1gK6ggXtdibs5sYw/640?wx_fmt=png&amp;from=appmsg"></p><p><img data-galleryid="" data-imgfileid="100000624" data-ratio="1.4130434782608696" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345Skv7fg2VuLx6nSEqcgOcHONictXdicDGGKxNvWlF0y9pro5Bs6bchvEWiaslQstqxhgYDXEpk176hW6Ig/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="690" src="https://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345Skv7fg2VuLx6nSEqcgOcHONictXdicDGGKxNvWlF0y9pro5Bs6bchvEWiaslQstqxhgYDXEpk176hW6Ig/640?wx_fmt=png&amp;from=appmsg"></p><p><br></p><hr><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><p>04</p></section></section></section></section></section></section><section powered-by="xiumi.us"><section><img data-imgfileid="100000625" data-ratio="1.21580547112462" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_gif/MVPvEL7Qg0EgrwdibaKqfTqpyFcSD7uE2JcEGETKYmdVA1UNUhbaXBa2qqazjc44k52ezTYYvRyoGAIOgrUNVhg/640?wx_fmt=gif" data-w="329" width="100%" src="https://mmbiz.qpic.cn/sz_mmbiz_gif/MVPvEL7Qg0EgrwdibaKqfTqpyFcSD7uE2JcEGETKYmdVA1UNUhbaXBa2qqazjc44k52ezTYYvRyoGAIOgrUNVhg/640?wx_fmt=gif"></section></section><p><span><strong><span>题外话</span></strong><span>：</span></span><span>如果超过5k个细胞，不建议用r跑程序。如果超过1w个恶性细胞，普通电脑（我的OMEN游戏本）根本带不起来哈。2w个恶性细胞的话，普通服务器带不起来哈，得用高性能计算。当然你可以设置HMM=F，这样内存消耗会小很多，然后再试试。<br></span></p><p><span><span>如果使用python的话，应该会快很多，可能内存要求不那么高，我目前还没有试验~。哪天来个超大数据集，说不定会逼得我用python。</span></span><br></p><p><strong><span><span>本文中的<span>思考题，提示</span>：如果想获取<span>A1和B1部分细胞id，你可以检查以下圈出来的这两个文件，可以根据里面的行名获取<strong><span>A1和B1部分细胞id。欢迎来稿，使用详细代码写出如何获取这些恶性细胞的id。</span></strong></span></span></span></strong><span><span><br></span></span></p><p><img data-galleryid="" data-imgfileid="100000626" data-ratio="0.41759259259259257" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345Skv7fg2VuLx6nSEqcgOcHONicwuu8wXtic3VXg473sxibcr3nexOgQswgAbezXjgl2VaDkjkYCgfN7bPg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345Skv7fg2VuLx6nSEqcgOcHONicwuu8wXtic3VXg473sxibcr3nexOgQswgAbezXjgl2VaDkjkYCgfN7bPg/640?wx_fmt=png&amp;from=appmsg"></p><p><br></p><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/IujcPhKM1SHKgPLTwGyZfg",target="_blank" rel="noopener noreferrer">原文链接</a>
