---
title: "免疫浸润分析算法，哪种更好？"
date: 2023-11-12T23:08:33Z
draft: ["false"]
tags: [
  "fetched",
  "生信碱移"
]
categories: ["Acdemic"]
---
免疫浸润分析算法，哪种更好？ by 生信碱移
------
<div><section data-tool="markdown编辑器" data-website="https://markdown.com.cn/editor"><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><img data-ratio="1.0324675324675325" data-src="https://mmbiz.qpic.cn/mmbiz_gif/lN9Tp5oiaqHFn9Rg6MwMU3ukMR9ROPh7bf7QWHEMwhUBUwSUKFsV8oK9noHic3jLaeJVQewHJcLq1cTXVAat35Tw/640?wx_fmt=gif&amp;tp=wxpic&amp;wxfrom=5&amp;wx_lazy=1" data-type="gif" data-w="154" src="https://mmbiz.qpic.cn/mmbiz_gif/lN9Tp5oiaqHFn9Rg6MwMU3ukMR9ROPh7bf7QWHEMwhUBUwSUKFsV8oK9noHic3jLaeJVQewHJcLq1cTXVAat35Tw/640?wx_fmt=gif&amp;tp=wxpic&amp;wxfrom=5&amp;wx_lazy=1"></section></section></section></section></section><section><section powered-by="xiumi.us"><section><p><span>老铁们快点击蓝字 <strong>关注起来</strong></span></p></section></section></section><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><img data-ratio="1.0324675324675325" data-src="https://mmbiz.qpic.cn/mmbiz_gif/lN9Tp5oiaqHFn9Rg6MwMU3ukMR9ROPh7bf7QWHEMwhUBUwSUKFsV8oK9noHic3jLaeJVQewHJcLq1cTXVAat35Tw/640?wx_fmt=gif&amp;tp=wxpic&amp;wxfrom=5&amp;wx_lazy=1" data-type="gif" data-w="154" src="https://mmbiz.qpic.cn/mmbiz_gif/lN9Tp5oiaqHFn9Rg6MwMU3ukMR9ROPh7bf7QWHEMwhUBUwSUKFsV8oK9noHic3jLaeJVQewHJcLq1cTXVAat35Tw/640?wx_fmt=gif&amp;tp=wxpic&amp;wxfrom=5&amp;wx_lazy=1"></section></section></section></section></section></section></section></section></section><section data-mpa-powered-by="yiban.io" data-darkmode-bgcolor-16095509242984="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16095509242984="rgb(255, 255, 255)" data-style='white-space: normal; max-width: 100%; letter-spacing: 0.544px; text-size-adjust: auto; background-color: rgb(255, 255, 255); font-family: "Helvetica Neue", Helvetica, "Hiragino Sans GB", "Microsoft YaHei", Arial, sans-serif; box-sizing: border-box !important; overflow-wrap: break-word !important;'><section data-darkmode-bgcolor-16095509242984="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16095509242984="rgb(255, 255, 255)"><section data-darkmode-bgcolor-16095509242984="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16095509242984="rgb(255, 255, 255)"><section data-id="85660" data-custom="rgb(117, 117, 118)" data-color="rgb(117, 117, 118)" data-darkmode-bgcolor-16095509242984="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16095509242984="rgb(255, 255, 255)"><section data-darkmode-bgcolor-16095509242984="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16095509242984="rgb(255, 255, 255)"><section data-darkmode-bgcolor-16095509242984="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16095509242984="rgb(255, 255, 255)"><section data-darkmode-bgcolor-16095509242984="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16095509242984="rgb(255, 255, 255)"><section data-darkmode-bgcolor-16095509242984="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16095509242984="rgb(255, 255, 255)"><section data-darkmode-bgcolor-16095509242984="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16095509242984="rgb(255, 255, 255)"><section data-id="85660" data-custom="rgb(117, 117, 118)" data-color="rgb(117, 117, 118)" data-darkmode-bgcolor-16095509242984="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16095509242984="rgb(255, 255, 255)"><section data-darkmode-bgcolor-16095509242984="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16095509242984="rgb(255, 255, 255)" data-style="margin-top: 2em; padding-top: 0.5em; padding-bottom: 0.5em; max-width: 100%; border-style: solid none; text-decoration: inherit; border-top-color: rgb(204, 204, 204); border-bottom-color: rgb(204, 204, 204); border-top-width: 1px; border-bottom-width: 1px; box-sizing: border-box !important; overflow-wrap: break-word !important;"><p data-darkmode-bgcolor-16095509242984="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16095509242984="rgb(255, 255, 255)"><span>生信碱移</span></p><section><strong>NC: 各种免疫浸润分析工具的<strong>比较</strong></strong></section></section></section></section></section></section></section></section></section></section></section></section><blockquote data-type="2" data-url="" data-author-name="" data-content-utf8-length="68" data-source-title="" data-darkmode-bgcolor-16095509242984="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16095509242984="rgb(255, 255, 255)" data-darkmode-color-16095509242984="rgba(163, 163, 163, 0.498)" data-darkmode-original-color-16095509242984="rgba(0, 0, 0, 0.498)" data-style='color: rgba(0, 0, 0, 0.498); white-space: normal; max-width: 100%; letter-spacing: 0.544px; font-family: -apple-system-font, system-ui, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif; background-color: rgb(255, 255, 255); box-sizing: border-box !important; overflow-wrap: break-word !important;'><p><span>肿瘤微环境复杂多变，包括免疫细胞、血管和基质，它在癌症的发展、进展和转移中起着关键作用。目前有几种计算方法可用于通过解析整体RNA测序数据来估计TME内的细胞类型。尽管如此，以前对TME解析方法性能的基准测试研究要么集中在可能影响解析的技术方面（例如RNA测序数据转换和标准化或基因标记选择），要么关注总体解析性能，这并没有全面调查生物学和样本异质性对TME解析技术的影响。在这项研究中，作者全面基准测试了可变肿瘤纯度、缺失细胞类型及上皮和免疫细胞类型系谱对计算TME解析性能的影响。他们们评估了三组最近开发的解析方法的性能：七种基于单细胞的方法（CIBERSORTx, MuSiC, Bisque, DWLS, CPM, BayesPrism, hspe）、基于特征基因的方法（EPIC）和基于深度学习的方法（Scaden）。</span></p><p><span>Title: Performance of tumour microenvironment deconvolution methods in breast cancer using single-cell simulated bulk mixtures</span></p><section><span>DOI：</span><span>10.1038/s41467-023-41385-5</span></section></blockquote></section><section data-tool="markdown编辑器" data-website="https://markdown.com.cn/editor"><p><span>肿瘤微环境（TME）内的细胞可以影响肿瘤发展并影响治疗反应。计算方法已被开发出来，用于从整体RNA测序（bulk RNA-seq）中解析TME。</span></p><p><span><span>来自</span>澳大利亚的研究者利用公开乳腺肿瘤的单细胞RNA测序（scRNA-seq）分析，模拟了数千种整体混合物，代表肿瘤纯度和细胞谱系，以比较九种TME解析方法（<strong>BayesPrism、Scaden、CIBERSORTx、MuSiC、DWLS、hspe、CPM、Bisque和EPIC</strong>）的性能。</span><span>该项研究于今年9月份发表于《<strong><span>Nature Communications</span></strong>》</span><span><strong><span>[IF:16.6]</span></strong></span><span>，题为："<strong><span>Performance of tumour microenvironment deconvolution methods in breast cancer using single-cell simulated bulk mixtures<span>"</span></span></strong>，使用单细胞模拟散装混合物进行乳腺癌肿瘤微环境反卷积方法的性能。</span><span></span></p><section><span>作者指出，某些方法在解析高肿瘤纯度混合物方面更为稳健。随着肿瘤纯度的增加，大多数方法倾向于将正常上皮误判为癌上皮，这一发现在两个独立数据集中得到验证。不仅如此，乳腺癌的分子亚型会影响这种误判。<strong>BayesPrism和DWLS在假阳性和假阴性的综合数量上最少，且在解析粒细胞性免疫谱系方面表现最佳</strong>。作者的发现强调了对更罕见细胞类型进行更多单细胞特征分析的需求，并建议在解析TME时应考虑肿瘤细胞组成<span>。</span></span></section><section><span><img data-backh="840" data-backw="518" data-ratio="1.6222222222222222" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/LvUIqvYKCeUxzOicw8f9nhDaiarYZZVUFXf3icUe9M1t2svmUJ1ynkEVg4KYic1uV5lYaxsrAjiccx4NEVmfNskz7Ew/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/LvUIqvYKCeUxzOicw8f9nhDaiarYZZVUFXf3icUe9M1t2svmUJ1ynkEVg4KYic1uV5lYaxsrAjiccx4NEVmfNskz7Ew/640?wx_fmt=png"></span></section><p>▲ <strong>图1：研究的实验设计</strong>。使用scRNA-seq乳腺癌数据，在不同生物条件下对九种基于转录组的TME解析方法的性能进行基准测试的工作流程。<span><strong>a</strong></span> 来自Wu等人的带注释scRNA-seq数据被过采样，以便在每个患者中，较少的细胞类型的细胞数量与最丰富的细胞类型的数量相匹配。<span><strong>b</strong></span> 过采样的scRNA-seq数据被分配给训练数据（n=18位患者）和测试数据（n=8位患者）。训练数据用于生成人工整体混合物或单细胞参考矩阵作为不同TME解析方法的输入（左侧区块）。测试数据用于生成不同基准测试调查（肿瘤纯度、正常上皮细胞系、免疫细胞谱系）的人工整体混合物（右侧区块）。<span><strong>c</strong></span> 在每项调查中，使用Bray-Curtis不相似性、Aitchison距离、均方根误差（RMSE）和Pearson's r评估了九种基准测试方法的总体解析性能，而预测单个组分的性能使用RMSE评估。ER+：雌激素受体阳性，HER2+：人表皮生长因子受体2阳性，TME：肿瘤微环境，TNBC：三阴性乳腺癌，RMSE：均方根误差，scRNA-seq：单细胞RNA测序。</p><p data-class="mbImgTitle"><span></span></p><section><img data-backh="818" data-backw="518" data-ratio="1.5796296296296297" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/LvUIqvYKCeUxzOicw8f9nhDaiarYZZVUFXmJ7Gj2ZOJZgKKm6VVZiaXDaVYmR1ByVv8IRQkkK0C1Dic9vPiaJ5Gw1Rw/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/LvUIqvYKCeUxzOicw8f9nhDaiarYZZVUFXmJ7Gj2ZOJZgKKm6VVZiaXDaVYmR1ByVv8IRQkkK0C1Dic9vPiaJ5Gw1Rw/640?wx_fmt=png"></section><section>▲ <strong>图2：不同肿瘤纯度对反卷积的影响</strong>。<span><strong>a</strong></span> 在预测与实际细胞组成之间，针对7种肿瘤纯度水平（从5%到95%）进行的Bray-Curtis不相似度分析显示，解卷积方法按其Bray-Curtis不相似度中值的降序排列<span>，Bray-Curtis值越高</span>，其表现越差。每个纯度水平下有2000个人工总体样本。图形当中，每个箱形图代表了50%的Bray-Curtis值中间区间，包括第一四分位数（Q1）、中位数和第三四分位数（Q3）。箱形图的上下须分别代表了Bray-Curtis值的最大值和最小值，但排除了异常值。异常值是指超出Q1或Q3 1.5倍四分位距的Bray-Curtis值。<span><strong>b</strong></span> <span>按细胞类型汇总</span>展示了预测与实际细胞组成之间的中位均方根误差（RMSE）。图中显示了7种肿瘤纯度水平（从5%到95%）。红色越深，RMSE值越高，表现越差。主要细胞类型（y轴）分为三类：上皮细胞（正常上皮和癌症上皮）、免疫细胞（T细胞、B细胞和髓系细胞）和间质细胞（内皮细胞、CAFs、PVL和浆母细胞）。CAFs指癌相关成纤维细胞，PVL指类脉管细胞，RMSE即均方根误差。<span><strong>c</strong></span> 基于拷贝数变异得出的肿瘤纯度（癌症上皮比例，y轴）与预测的肿瘤纯度（x轴）的散点图，采用线性尺度；<span><strong>d</strong></span> 预测的淋巴细胞（T细胞和B细胞，y轴）与Saltz等人估计的肿瘤浸润淋巴细胞（TIL，x轴）的对数尺度散点图。每个点代表TCGA乳腺癌患者的一个混合样本，其颜色代表相关的分子亚型。虚线45度对角线代表完美预测，即预测比例与实际比例相匹配。每个子图都标注了相关系数（r）和均方根误差（rmse）。</section><section><span><img data-backh="541" data-backw="518" data-ratio="1.0435185185185185" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/LvUIqvYKCeUxzOicw8f9nhDaiarYZZVUFXNaeWP48CYJ8T0eI8KhVDibGCnxVhIRTib8pgMfLqzE9dcuF484ZCJcPA/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/LvUIqvYKCeUxzOicw8f9nhDaiarYZZVUFXNaeWP48CYJ8T0eI8KhVDibGCnxVhIRTib8pgMfLqzE9dcuF484ZCJcPA/640?wx_fmt=png"><p>▲<strong> 图3：正常上皮谱系和分子亚型对解卷积的影响</strong>。<span><strong>a</strong></span> 展示了预测与实际细胞组成之间的均方根误差（RMSE），并按分子亚型（HER2+、ER+和TNBC）进行汇总。红色越深，表示RMSE值越高，表现越差。细胞类型（y轴）分为四类：癌症上皮、正常上皮（腺泡前体细胞、成熟腺泡和肌上皮细胞）、免疫细胞（T细胞、B细胞和髓系细胞）和间质细胞（内皮细胞、CAFs、PVL和浆母细胞）。CAFs即癌相关成纤维细胞，PVL指类脉管细胞，RMSE为均方根误差。<span><strong>b</strong></span> 展示了七种方法（BayesPrism、Scaden、MuSiC、CBX、DWLS、hspe和EPIC）对癌症上皮和正常上皮细胞的三个次要亚型（汇总按分子亚型：HER2+、ER+和TNBC）的原始预测误差。较高的正值和较低的负值原始预测误差代表性能较差。混合物以50%的固定纯度合成，使用正常上皮细胞的三种次要细胞类型和其他八种主要细胞类型（癌症上皮、T细胞、B细胞、髓系、内皮、CAFs、浆母细胞和PVL）。每个箱形图代表了原始预测误差的中间50%区间，包括第一四分位数（Q1）、中位数和第三四分位数（Q3）。箱形图的上下须分别代表原始预测误差的最大值和最小值，但排除了异常值。</p></span></section><section><img data-backh="479" data-backw="518" data-ratio="0.924074074074074" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/LvUIqvYKCeUxzOicw8f9nhDaiarYZZVUFXHs3L3pzoiaSK0miaYgLjaNMYwibY3DaWQKXCBuzfSA8Wwe1NQxX53XuUw/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/LvUIqvYKCeUxzOicw8f9nhDaiarYZZVUFXHs3L3pzoiaSK0miaYgLjaNMYwibY3DaWQKXCBuzfSA8Wwe1NQxX53XuUw/640?wx_fmt=png"></section><section>▲ <strong>图4：通过假阳性和假阴性率评估的九种解卷积方法的性能</strong>。<span><strong>a</strong></span> 混淆矩阵展示了所有九种方法在预测细胞类型在混合物中的存在（≥0.1%）或缺失（&lt;0.1%）的性能。对于每个混淆矩阵，x轴表示预测的存在/缺失，y轴表示实际的存在/缺失，假阳性、真阳性、假阴性和真阴性的数量是跨所有细胞类型汇总的。<span><strong>b</strong></span> 当细胞类型在混合物中缺失时预测其存在。假阳性的三个水平的百分比占总数假阳性和真阴性（实际比例&lt;0.1%）的百分比。每个条形上方显示了所有细胞类型的假阳性数量。<span><strong>c</strong></span> 当细胞类型在混合物中存在时预测其缺失。假阴性的三个水平的百分比占总数假阴性和真阳性（预测比例&lt;0.1%）的百分比。每个条形上方显示了所有细胞类型的假阴性数量。图例（b和c）展示了真阴性、假阳性、真阳性和假阴性预测的定义。算法在预测存在/缺失方面越准确，假阳性率和假阴性率就越低。</section><p><span><img data-backh="648" data-backw="518" data-ratio="1.2518518518518518" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/LvUIqvYKCeUxzOicw8f9nhDaiarYZZVUFXhunKzm6Pzowp5icXhIUkZo6rMcOnCkdIz3XxhBjMJ54V2R2ic1xnCib0Q/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/LvUIqvYKCeUxzOicw8f9nhDaiarYZZVUFXhunKzm6Pzowp5icXhIUkZo6rMcOnCkdIz3XxhBjMJ54V2R2ic1xnCib0Q/640?wx_fmt=png"></span></p><p>▲ <strong>图5: 免疫谱系对解卷积的影响。</strong><span><strong>a</strong></span> 免疫细胞在主要、次要和子集细胞类型中的关系。<span><strong>b, c</strong></span> 在50%肿瘤纯度水平下，包含T细胞、B细胞和髓系细胞的23种子集细胞类型的2000个混合物中，预测和实际组成之间的艾奇森距离。<span>b</span>展示了使用全部细胞类型，而c展示免疫细胞类型的九种方法在2000个混合物中艾奇森距离的中位数。浅蓝绿色代表艾奇森距离较小，性能较好。<span><strong>d, e</strong></span> 分别显示了BayesPrism和DWLS在预测与实际细胞比例之间的均方根误差（RMSE，红色）和相对比例误差（RPE，橙色），按主要、次要和子集细胞类型汇总。红色和橙色的深度代表更高的RMSE和RPE值，性能较差。癌症上皮、正常上皮、内皮、CAFs、PVL和浆母细胞类型用于所有三个水平的人工总体模拟，因此，在谱系水平上有三组RMSE和RPE值。一些次要免疫细胞类型，如NK细胞或记忆B细胞，没有任何子集细胞类型，因此在子集水平上重复使用，导致在次要和子集水平上有两组RMSE和RPE值。</p><section><span>总体而言，作者发现BayesPrism、MuSiC、DWLS、CBX和Scaden是</span><strong><span>对TME变化生物条件</span></strong><span>最具鲁棒性的解卷积方法。其中，四种方法BayesPrism、MuSiC、DWLS和Scaden，在</span><strong><span>使用整体RNA测序预测肿瘤纯度方面</span></strong><span>也表现最佳。虽然这四种方法都能抵抗不同肿瘤纯度水平的变化，但BayesPrism和DWLS在</span><strong><span>更高的细胞类型粒度上</span></strong><span>显示出最大的弹性。</span></section><p><span>在这项研究中用于分析的R和Python代码可以在以下网址找到：https://github.com/MedicalGenomicsLab/deconvolution_benchmarking</span></p><p><span><strong><span><strong><span>BayesPrism和DWLS或许是最优</span></strong></span></strong></span></p><p><span><strong><span><strong><span>铁子们可以试试<img data-ratio="1" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/LvUIqvYKCeUkwLnZTx9EQHh4ic8G1InZ5mKH8tAsZV1ByThwicjibTxfF6nlTdeCM9OIIFbLg33RMxy63D5XfCX4A/640?wx_fmt=png" data-type="png" data-w="128" src="https://mmbiz.qpic.cn/sz_mmbiz_png/LvUIqvYKCeUkwLnZTx9EQHh4ic8G1InZ5mKH8tAsZV1ByThwicjibTxfF6nlTdeCM9OIIFbLg33RMxy63D5XfCX4A/640?wx_fmt=png"></span></strong></span></strong></span></p><p><br></p><section><mp-common-profile data-pluginname="mpprofile" data-id="MzkyNTIzMzYyMA==" data-headimg="http://mmbiz.qpic.cn/mmbiz_png/LvUIqvYKCeXYZNMxRMnjiaicO2a27jDZ2FgQga8TdeQcsGRJRIn2IInkKtfcbbMXOBSViaPXpTOBulUlNzd11pzow/0?wx_fmt=png" data-nickname="生信碱移" data-alias="liudoufu307" data-signature="春来秋至，分享我的所见与所识" data-from="0" data-is_biz_ban="0"></mp-common-profile></section><section><strong><span>END~</span></strong><br></section><p><span><strong>仅供粉丝老铁们参考</strong></span></p><p><strong>如有侵权或错误，请联系删除改正～</strong></p></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/X__wt_9DkcjWqkS--EkK2g",target="_blank" rel="noopener noreferrer">原文链接</a>
