---
title: "[会员专享]R优雅的一图展示三份数据"
date: 2023-11-01T23:17:52Z
draft: ["false"]
tags: [
  "fetched",
  "R语言数据分析指南"
]
categories: ["Acdemic"]
---
[会员专享]R优雅的一图展示三份数据 by R语言数据分析指南
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><h3 data-tool="mdnice编辑器"><span></span><span><span></span>欢迎关注R语言数据分析指南</span><span></span></h3><blockquote data-tool="mdnice编辑器"><span>❝</span><p>小编最近帮朋友绘制一张图稍有启发，其主要内容为<strong>「如何通过一张图来展示三份数据之间的关系」</strong>，比如将常见的转录组、生理指标、代谢组等三组数据用一张图进行呈现。小编将通过一个案例进行演示，这里展示的图形仅用于示范目的，整个过程仅参考。希望对各位观众老爷能有所帮助。<strong>「完整的数据代码已经整合上传到2023VIP交流群」</strong>，加群的观众老爷可自行下载，有需要的朋友可关注文末介绍加入VIP交流群。</p><span>❞</span></blockquote><h3 data-tool="mdnice编辑器"><span></span><span><span></span>图形展示</span><span></span></h3><figure data-tool="mdnice编辑器"><img data-ratio="1.048148148148148" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZWzicXMr3uibNMQ6ESvEq4oa6vRN3ia0lTeWMQMxgB2sR5CEFVokte50um5Yl1aX6GUzsyw0A32JnQg/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZWzicXMr3uibNMQ6ESvEq4oa6vRN3ia0lTeWMQMxgB2sR5CEFVokte50um5Yl1aX6GUzsyw0A32JnQg/640?wx_fmt=png"></figure><h3 data-tool="mdnice编辑器"><span></span><span><span></span>图形解读</span><span></span></h3><blockquote data-tool="mdnice编辑器"><span>❝</span><p>数据为随意构造不太合理，仅作展示用；热图可以看做同一批样本基因与代谢物之间的关系，网络图则可以看做理化指标与代谢物之间的关系。这样通过数据分析三组数据在一张图中呈现了出来，当然绘制此图不难，只需要针对linkET包构建好数据即可，难点在于如何针对样本数据进行聚类，根据聚类调整图形，这是一个小细节，后面在做介绍。下面来看一下图形绘制过程：</p><span>❞</span></blockquote><h3 data-tool="mdnice编辑器"><span></span><span><span></span>加载R包</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code><span>library</span>(psych)<br><span>library</span>(reshape2)<br><span>library</span>(tidyverse)<br><span>library</span>(magrittr)<br><span>library</span>(linkET)<br><span>library</span>(ggtext)<br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span><span></span>导入数据</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code>env &lt;- read_tsv(<span>"env.tsv"</span>)<br>spe &lt;- read_tsv(<span>"spe.tsv"</span>)<br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span><span></span>相关性分析</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code>pp &lt;- corr.test(env,spe,method=<span>"pearson"</span>,adjust = <span>"fdr"</span>)<br>cor &lt;- pp$r<br>pvalue &lt;- pp$p<br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span><span></span>数据整合</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code>df1 &lt;- melt(cor) %&gt;% mutate(pvalue=melt(pvalue)[,3],<br>                            p_signif=symnum(pvalue, corr = FALSE, na = FALSE,<br>                                            cutpoints = c(0, 0.01, 0.05, 0.1, 1), <br>                                            symbols = c(<span>"**"</span>,<span>"*"</span>, <span>""</span>, <span>" "</span>))) %&gt;% <br>  set_colnames(c(<span>"taxa"</span>,<span>"gene"</span>,<span>"r"</span>,<span>"p"</span>,<span>"p_signif"</span>))<br><br>pp2 &lt;- corr.test(spe,env,method=<span>"pearson"</span>,adjust = <span>"fdr"</span>)<br>cor &lt;- pp2<span>$r</span><br>pvalue &lt;- pp2<span>$p</span><br><br>df2 &lt;- melt(cor) %&gt;% mutate(pvalue=melt(pvalue)[,3],<br>                            p_signif=symnum(pvalue, corr = FALSE, na = FALSE,  <br>                                            cutpoints = c(0,0.01, 0.05, 0.1, 1), <br>                                            symbols = c(<span>"**"</span>,<span>"*"</span>, <span>""</span>, <span>" "</span>))) %&gt;% <br>  set_colnames(c(<span>"taxa"</span>,<span>"VFA"</span>,<span>"r"</span>,<span>"p"</span>,<span>"p_signif"</span>))<br></code></pre><blockquote data-tool="mdnice编辑器"><span>❝</span><p>本节内容介绍到此结束，过程仅供参考；完整版的代码可到小编的2023VIP交流群中查看，有需要欢迎到小编的<strong>「淘宝店铺」</strong> <strong>「R语言数据分析指南」</strong>购买<strong>「2023年度会员文档」</strong>同步更新中<strong>「售价149元」</strong>，内容主要包括各种<strong>「高分论文的图表分析复现以及一些个性化图表的绘制」</strong>均包含数据+代码；按照往年数据小编年产出约在150+以上</p><span>❞</span></blockquote><p data-tool="mdnice编辑器">购买后微信发小编订单截图即邀请进新的会员交流群，小编的文档为按年售卖，只包含当年度的<strong>「除系列课程外」</strong>的文档，有需要往年文档的朋友也可下单购买，需要了解更多信息的朋友欢迎淘宝店铺交流咨询。</p><h3 data-tool="mdnice编辑器"><span></span><span><span></span>淘宝扫一扫</span><span></span></h3><p><img data-croporisrc="https://mmbiz.qpic.cn/mmbiz_jpg/EibnicgwScTAbHbWpAoGOP2icXGDsjm40BJLkh8ib9mUkNvxOiaxmz74xZd3kcSPXu7OvzZ4KJgLyMxiaS53SV4k3DuA/0?wx_fmt=jpeg" data-cropx1="118.16856492027335" data-cropx2="1068.888382687927" data-cropy1="392.1047835990889" data-cropy2="1904.125284738041" data-galleryid="" data-ratio="1.591578947368421" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/EibnicgwScTAZWzicXMr3uibNMQ6ESvEq4oa9Vn9BDmHPWfAhXibLbib4myhbrZdM4nibN6UlomCg2RB6rsnGelVVddQQ/640?wx_fmt=jpeg" data-type="jpeg" data-w="950" src="https://mmbiz.qpic.cn/mmbiz_jpg/EibnicgwScTAZWzicXMr3uibNMQ6ESvEq4oa9Vn9BDmHPWfAhXibLbib4myhbrZdM4nibN6UlomCg2RB6rsnGelVVddQQ/640?wx_fmt=jpeg"></p><h3 data-tool="mdnice编辑器"><span></span><span><span></span>关注下方公众号下回更新不迷路</span><span></span></h3><section><mp-common-profile data-pluginname="mpprofile" data-id="Mzg3MzQzNTYzMw==" data-headimg="http://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZF0rpeZII9Ltl26VbVagriczTria1fib3XgjwwHEHFjPzkmGpqWDVVHBSzhENictUM2iavAKiaM5lc9USw/0?wx_fmt=png" data-nickname="R语言数据分析指南" data-alias="YanJANtwo" data-signature="R语言重症爱好者，喜欢绘制各种精美的图表，喜欢的小伙伴可以关注我，跟我一起学习" data-from="0" data-is_biz_ban="0"></mp-common-profile></section></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/BYrtqZluDLLOTmfAsFvZAg",target="_blank" rel="noopener noreferrer">原文链接</a>
