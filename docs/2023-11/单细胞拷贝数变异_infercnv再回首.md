---
title: "单细胞拷贝数变异 infercnv再回首"
date: 2023-11-18T04:43:36Z
draft: ["false"]
tags: [
  "fetched",
  "生信小博士"
]
categories: ["Acdemic"]
---
单细胞拷贝数变异 infercnv再回首 by 生信小博士
------
<div><p>上周Jimmy老师直播了infercnv，并给出了代码。今天我就复现一下，同时与官方推荐参数得到的结果对比一下。</p><hr><p><img data-galleryid="" data-ratio="0.18181818181818182" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345SktNutrxxTO8uZUVLZlTxRq69iaicia1Nc9euesyedViaIlcHxKLUhf4WruVcBoLqH3MatfUibY6K4o4PMw/640?wx_fmt=png" data-type="png" data-w="319" src="https://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345SktNutrxxTO8uZUVLZlTxRq69iaicia1Nc9euesyedViaIlcHxKLUhf4WruVcBoLqH3MatfUibY6K4o4PMw/640?wx_fmt=png"></p><p><strong>首先是input部分：</strong></p><ol><li><p>细胞聚类文件：<br></p><p><br></p><p><img data-galleryid="" data-ratio="0.45463917525773195" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345SktNutrxxTO8uZUVLZlTxRq64yicqNmM3wnuogRPgHp3QxicFhggtZSFcEqmPwkDKDL66VOzYpib6WCIg/640?wx_fmt=png" data-type="png" data-w="970" src="https://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345SktNutrxxTO8uZUVLZlTxRq64yicqNmM3wnuogRPgHp3QxicFhggtZSFcEqmPwkDKDL66VOzYpib6WCIg/640?wx_fmt=png"></p></li></ol><p><br></p><p>2.基因坐标文件：<br></p><p><img data-galleryid="" data-ratio="0.5117647058823529" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345SktNutrxxTO8uZUVLZlTxRq6NKp2Yt0AsibAOIqFeI8cQ71CEToR1IkI61s4FVlichNrIBfP3uiaF0ibAQ/640?wx_fmt=png" data-type="png" data-w="340" src="https://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345SktNutrxxTO8uZUVLZlTxRq6NKp2Yt0AsibAOIqFeI8cQ71CEToR1IkI61s4FVlichNrIBfP3uiaF0ibAQ/640?wx_fmt=png"></p><p>3.表达矩阵文件：<br></p><p><img data-galleryid="" data-ratio="0.431640625" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345SktNutrxxTO8uZUVLZlTxRq6jiao1kVTibwW601vgkwtHduRspdWEl7TOhZyGpyMeVpXfWhvHjBbRiawQ/640?wx_fmt=png" data-type="png" data-w="1024" src="https://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345SktNutrxxTO8uZUVLZlTxRq6jiao1kVTibwW601vgkwtHduRspdWEl7TOhZyGpyMeVpXfWhvHjBbRiawQ/640?wx_fmt=png"></p><p><img data-galleryid="" data-ratio="0.21585903083700442" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345SktNutrxxTO8uZUVLZlTxRq6YUVqL9RvxKnwvicwhARTlJreUHNnGLnomlhePicbWsrJExiaOmbRSIu2g/640?wx_fmt=png" data-type="png" data-w="227" src="https://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345SktNutrxxTO8uZUVLZlTxRq6YUVqL9RvxKnwvicwhARTlJreUHNnGLnomlhePicbWsrJExiaOmbRSIu2g/640?wx_fmt=png"></p><p>   注意：<span>ref-1和ref-2是用了做refence group。他们分别代表Endo和Mast细胞，各500个。spike-1和spike-2<span>分别代表</span><span>Endo和Mast细胞，各300个，用于掺入epi，评判之后的infercnv的效果。</span></span></p><p><img data-galleryid="" data-ratio="0.15217391304347827" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345SktNutrxxTO8uZUVLZlTxRq6ibIUJu4sFLFfP2yoPRXUnJup4oER1iakXROW3ickte0mvyYD2sibw6ia49A/640?wx_fmt=png" data-type="png" data-w="368" src="https://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345SktNutrxxTO8uZUVLZlTxRq6ibIUJu4sFLFfP2yoPRXUnJup4oER1iakXROW3ickte0mvyYD2sibw6ia49A/640?wx_fmt=png"></p><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="php"><code><span> <span># duplicate 'row.names' are not allowed</span></span></code><code><span>  library(infercnv)</span></code><code><span>  infercnv_obj = CreateInfercnvObject(raw_counts_matrix=expFile,</span></code><code><span>                                      annotations_file=groupFiles,</span></code><code><span>                                      delim=<span>"\t"</span>,</span></code><code><span>                                      gene_order_file= geneFile,</span></code><code><span>                                      ref_group_names=c(<span>'ref-1'</span>,</span></code><code><span>                                                        <span>'ref-2'</span>))  <span>## 这个取决于自己的分组信息里面的</span></span></code><code><span>  </span></code><code><span>  </span></code><code><span>  <span># cutoff=1 works well for Smart-seq2, and cutoff=0.1 works well for 10x Genomics</span></span></code><code><span>  infercnv_obj2 = infercnv::run(infercnv_obj,</span></code><code><span>                                cutoff=<span>0.1</span>, <span># cutoff=1 works well for Smart-seq2, and cutoff=0.1 works well for 10x Genomics</span></span></code><code><span>                                out_dir= <span>"infercnv_output_recalculate"</span>,  <span># dir is auto-created for storing outputs</span></span></code><code><span>                                cluster_by_groups=T ,   <span># cluster</span></span></code><code><span>                                hclust_method=<span>"ward.D2"</span>, plot_steps=F)</span></code><code><span>  </span></code></pre></section><p><span></span></p><p><img data-galleryid="" data-ratio="0.19133574007220217" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345SktNutrxxTO8uZUVLZlTxRq6nScJVlZlfzmxn2iaHdIN0YWD2mwuGibWqoEzakWKyibyvQW6qYsA9B2iaQ/640?wx_fmt=png" data-type="png" data-w="277" src="https://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345SktNutrxxTO8uZUVLZlTxRq6nScJVlZlfzmxn2iaHdIN0YWD2mwuGibWqoEzakWKyibyvQW6qYsA9B2iaQ/640?wx_fmt=png"></p><p>所有输出的文件如下：<br></p><p><img data-galleryid="" data-ratio="0.8785982478097623" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345SktNutrxxTO8uZUVLZlTxRq6icE5jHMC1Prvhibhldjibk7pf9uYPajEZI6KemV7ibbBBql8umDVJsibxXw/640?wx_fmt=png" data-type="png" data-w="799" src="https://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345SktNutrxxTO8uZUVLZlTxRq6icE5jHMC1Prvhibhldjibk7pf9uYPajEZI6KemV7ibbBBql8umDVJsibxXw/640?wx_fmt=png"></p><p>其中最关键的文件：</p><p><img data-galleryid="" data-ratio="0.13406593406593406" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345SktNutrxxTO8uZUVLZlTxRq6h750RF3DZo2IgMibbb1Cxu9icm8uk5dH7DLTRumEb3k4d4icslU2Vu2SQ/640?wx_fmt=png" data-type="png" data-w="455" src="https://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345SktNutrxxTO8uZUVLZlTxRq6h750RF3DZo2IgMibbb1Cxu9icm8uk5dH7DLTRumEb3k4d4icslU2Vu2SQ/640?wx_fmt=png"></p><p>infer.png的结果如下：</p><p><img data-galleryid="" data-ratio="0.9427645788336934" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345SktNutrxxTO8uZUVLZlTxRq6coxS7b3Y63MV52oTqXCx8WpjnqD76sqsVFTJImwpbPCr4zpH6JQGhA/640?wx_fmt=png" data-type="png" data-w="926" src="https://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345SktNutrxxTO8uZUVLZlTxRq6coxS7b3Y63MV52oTqXCx8WpjnqD76sqsVFTJImwpbPCr4zpH6JQGhA/640?wx_fmt=png"></p><p>代码已经上传至百度云，自行下载：<a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247525967&amp;idx=1&amp;sn=c0b059b4aec399bf76380b9ae9b1d4ac&amp;scene=21#wechat_redirect" textvalue="单细胞转录组拷贝数分析结果解读和应用" linktype="text" imgurl="" imgdata="null" tab="innerlink" data-linktype="2"><span>单细胞转录组拷贝数分析结果解读和应用</span></a></p><p>详解的结果解读，可以参考这个链接<span>：</span><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=Mzg2NDcxMzYwNg==&amp;mid=2247484117&amp;idx=1&amp;sn=e2ca8bd3865fec13cc46a5f0fad98fd4&amp;chksm=ce646c3cf913e52ace25173ff84f1dd5137d0122b07d1931b8f9d7d6d1d96e192a3bcbf6a307&amp;scene=21#wechat_redirect" textvalue="infercnv官方全流程" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2"><span>infercnv官方全流程</span><span></span></a></p><p><br></p><p><img data-galleryid="" data-ratio="0.18461538461538463" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345SktNutrxxTO8uZUVLZlTxRq6uxPILEx3oOzIT6JicamQ7kCf5w7zEKAVQEia2422TnDmLRtibvicZGreLQ/640?wx_fmt=png" data-type="png" data-w="260" src="https://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345SktNutrxxTO8uZUVLZlTxRq6uxPILEx3oOzIT6JicamQ7kCf5w7zEKAVQEia2422TnDmLRtibvicZGreLQ/640?wx_fmt=png"></p><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="nginx"><code><span> <span># create the infercnv object</span></span></code><code><span>  <span>infercnv_obj</span> = CreateInfercnvObject(raw_counts_matrix=expFile,  <span># 可以直接提供矩阵对象</span></span></code><code><span>                                      annotations_file=groupFiles,</span></code><code><span>                                      delim=<span>"\t"</span>,</span></code><code><span>                                      gene_order_file=geneFile,</span></code><code><span>                                      ref_group_names=c(<span>'ref-1'</span>,</span></code><code><span>                                                        <span>'ref-2'</span>))  <span># 用于设置参考组，正常的细胞类型组别</span></span></code><code><span>  </span></code><code><span>  </span></code><code><span>  </span></code><code><span>  </span></code><code><span>  <span>5</span></span></code><code><span>  <span># perform infercnv operations to reveal cnv signal</span></span></code><code><span>  infercnv_obj = infercnv::run(infercnv_obj,</span></code><code><span>                               cutoff=<span>0</span>.<span>1</span>,  <span># use 1 for smart-seq, 0.1 for 10x-genomics</span></span></code><code><span>                               out_dir=<span>"infercnv_output_mycodes"</span>,  <span># dir is auto-created for storing outputs</span></span></code><code><span>                               analysis_mode=<span>"subclusters"</span>, <span># 更好方法，按照 cnv 亚群进行预测，而不是样本。能更好的区分肿瘤异质性。</span></span></code><code><span>                               cluster_by_groups=T,  <span># 根据细胞类型对肿瘤细胞执行单独的聚类，如 cell annotations 文件中定义的那样</span></span></code><code><span>                               denoise=T,  <span># 去噪处理</span></span></code><code><span>                               num_threads=<span>40</span>, <span># 设置线程数, 多线程运行，加快计算速度</span></span></code><code><span>                               HMM=F,</span></code><code><span>                               hclust_method=<span>"ward.D2"</span>, plot_steps=F) <span># 是否基于 HMM 预测 CNV,选择 F 会加快运算速度</span></span></code><code><span>  </span></code></pre></section><p>这里多了一个降噪的参数<span> denoise=T,  </span><span># 去噪处理</span></p><p><span>referece组别是不是干净了一些？</span></p><p><img data-galleryid="" data-ratio="0.9319196428571429" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345SktNutrxxTO8uZUVLZlTxRq6RDcQKbNJnGYIZRct3n92HPFibM6fy2GwubjXl0X3pnfszibLm8H1LaQQ/640?wx_fmt=png" data-type="png" data-w="896" src="https://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345SktNutrxxTO8uZUVLZlTxRq6RDcQKbNJnGYIZRct3n92HPFibM6fy2GwubjXl0X3pnfszibLm8H1LaQQ/640?wx_fmt=png"></p><p><br></p><p><img data-galleryid="" data-ratio="0.1864406779661017" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345SktNutrxxTO8uZUVLZlTxRq6E21BAL3Uzwo0vAJhgnpZ59bxbL9hgbGibx4IDtbBHNC0I4DcLc3dwbw/640?wx_fmt=png" data-type="png" data-w="295" src="https://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345SktNutrxxTO8uZUVLZlTxRq6E21BAL3Uzwo0vAJhgnpZ59bxbL9hgbGibx4IDtbBHNC0I4DcLc3dwbw/640?wx_fmt=png"></p><p>已经得到上述的结果了 ，如何用数据判断，如何获取CNV score进而判断细胞是否恶性呢？<br></p><ol><li><p>cnv score 存储在infer_CNV_obj@expr.data</p></li><li><p>jimmy老师提出一种CNV score的算法，供大家参考：</p><p><br></p><p>代码如下<br></p><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="cs"><code><span> <span>if</span>(T){</span></code><code><span>    tmp1 = expr[,infer_CNV_obj@reference_grouped_cell_indices$`<span>ref</span><span>-1</span>`]</span></code><code><span>    </span></code><code><span>    dim(tmp1)</span></code><code><span>    head(tmp1)[,<span>1</span>:<span>9</span>]</span></code><code><span>    </span></code><code><span>    tmp2 = expr[,infer_CNV_obj@reference_grouped_cell_indices$`<span>ref</span><span>-2</span>`]</span></code><code><span>    tmp= cbind(tmp1,tmp2)</span></code><code><span>    </span></code><code><span>    dim(tmp)</span></code><code><span>    head(tmp)[,<span>1</span>:<span>9</span>]</span></code><code><span>    </span></code><code><span>    down=mean(rowMeans(tmp)) - <span>2</span> * mean( apply(tmp, <span>1</span>, sd))</span></code><code><span>    up=mean(rowMeans(tmp)) + <span>2</span> * mean( apply(tmp, <span>1</span>, sd))</span></code><code><span>    oneCopy=up-down</span></code><code><span>    oneCopy</span></code><code><span>  </span></code><code><span>    a1= down- <span>2</span>*oneCopy</span></code><code><span>    a2= down- <span>1</span>*oneCopy</span></code><code><span>    down;up</span></code><code><span>    a3= up +  <span>1</span>*oneCopy</span></code><code><span>    a4= up + <span>2</span>*oneCopy </span></code><code><span>    </span></code><code><span>    cnv_score_table&lt;-infer_CNV_obj@expr.data</span></code><code><span>    cnv_score_table[<span>1</span>:<span>4</span>,<span>1</span>:<span>4</span>]</span></code><code><span>    dim(cnv_score_table)</span></code><code><span>    </span></code><code><span>    cnv_score_mat &lt;- <span>as</span>.matrix(cnv_score_table)</span></code><code><span>    <span># Scoring</span></span></code><code><span>    cnv_score_table[cnv_score_mat &gt; <span>0</span> &amp; cnv_score_mat &lt; a2] &lt;- <span>"A"</span> <span>#complete loss. 2pts</span></span></code><code><span>    cnv_score_table[cnv_score_mat &gt;= a2 &amp; cnv_score_mat &lt; down] &lt;- <span>"B"</span> <span>#loss of one copy. 1pts</span></span></code><code><span>    cnv_score_table[cnv_score_mat &gt;= down &amp; cnv_score_mat &lt;  up ] &lt;- <span>"C"</span> <span>#Neutral. 0pts</span></span></code><code><span>    cnv_score_table[cnv_score_mat &gt;= up  &amp; cnv_score_mat &lt;= a3] &lt;- <span>"D"</span> <span>#addition of one copy. 1pts</span></span></code><code><span>    cnv_score_table[cnv_score_mat &gt; a3  &amp; cnv_score_mat &lt;= a4 ] &lt;- <span>"E"</span> <span>#addition of two copies. 2pts</span></span></code><code><span>    cnv_score_table[cnv_score_mat &gt; a4] &lt;- <span>"F"</span> <span>#addition of more than two copies. 2pts</span></span></code><code><span>    </span></code><code><span>    <span># Check</span></span></code><code><span>    table(cnv_score_table[,<span>1</span>])</span></code><code><span>    <span># Replace with score </span></span></code><code><span>    cnv_score_table_pts &lt;- <span>cnv_score_table</span></span></code><code><span>    <span>rm</span>(<span>cnv_score_mat</span>)</span></code><code><span>    # </span></code><code><span><span>    cnv_score_table_pts[cnv_score_table</span> == <span>"A"</span>] &lt;- <span>2</span></span></code><code><span>    cnv_score_table_pts[cnv_score_table == <span>"B"</span>] &lt;- <span>1</span></span></code><code><span>    cnv_score_table_pts[cnv_score_table == <span>"C"</span>] &lt;- <span>0</span></span></code><code><span>    cnv_score_table_pts[cnv_score_table == <span>"D"</span>] &lt;- <span>1</span></span></code><code><span>    cnv_score_table_pts[cnv_score_table == <span>"E"</span>] &lt;- <span>2</span></span></code><code><span>    cnv_score_table_pts[cnv_score_table == <span>"F"</span>] &lt;- <span>2</span></span></code><code><span>    </span></code><code><span>    <span># Scores are stored in “cnv_score_table_pts”. Use colSums to add up scores for each cell and store as vector </span></span></code><code><span>    cnv_score_table_pts[<span>1</span>:<span>4</span>,<span>1</span>:<span>4</span>]</span></code><code><span>    tmp  = apply(cnv_score_table_pts, <span>1</span>, <span>as</span>.numeric)</span></code><code><span>    tmp[<span>1</span>:<span>4</span>,<span>1</span>:<span>4</span>]</span></code><code><span>    rownames(tmp)  = colnames(cnv_score_table_pts) </span></code><code><span>    cell_scores_CNV &lt;- <span>as</span>.data.frame(rowSums(tmp))</span></code><code><span>    colnames(cell_scores_CNV) &lt;- <span>"cnv_score"</span></span></code><code><span>    head(cell_scores_CNV)</span></code><code><span>    <span>#write.csv(x = cell_scores_CNV, file = "cnv_scores.csv")</span></span></code><code><span>    </span></code><code><span>  }</span></code><code><span>  </span></code></pre></section><p>然后每个细胞都会有一个cnvscore，就可以画图比较辣</p><p><br></p><p><img data-galleryid="" data-ratio="0.563076923076923" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345SktNutrxxTO8uZUVLZlTxRq6hw8Up7mS3w0bM5v1Ywpz9HDDpzBymHHym2VBuejp45ZmYaSv1CMb5Q/640?wx_fmt=png" data-type="png" data-w="325" src="https://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345SktNutrxxTO8uZUVLZlTxRq6hw8Up7mS3w0bM5v1Ywpz9HDDpzBymHHym2VBuejp45ZmYaSv1CMb5Q/640?wx_fmt=png"></p></li></ol><p><br></p><p><img data-galleryid="" data-ratio="0.5717213114754098" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345SktNutrxxTO8uZUVLZlTxRq6M6L9S6I0cFXdlPfOiaq7MtmibvZHrRkbTAUBEyUhiaS59bGwZibWRsRFOg/640?wx_fmt=png" data-type="png" data-w="976" src="https://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345SktNutrxxTO8uZUVLZlTxRq6M6L9S6I0cFXdlPfOiaq7MtmibvZHrRkbTAUBEyUhiaS59bGwZibWRsRFOg/640?wx_fmt=png"></p><section><ul><li><li><li></ul><pre><code><span>  ggplot(meta, aes(x=celltype  , y=totalCNV, fill=celltype  )) +</span></code><code><span>    geom_boxplot()</span></code><code><span><br></span></code></pre></section><p><br></p><p><img data-galleryid="" data-ratio="0.7654639175257731" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345SktNutrxxTO8uZUVLZlTxRq68KPOIa9H8fO8q34HEf6N48ibTy8OofU2MYFFicgRRgNMqia670ZEstI1w/640?wx_fmt=png" data-type="png" data-w="776" src="https://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345SktNutrxxTO8uZUVLZlTxRq68KPOIa9H8fO8q34HEf6N48ibTy8OofU2MYFFicgRRgNMqia670ZEstI1w/640?wx_fmt=png"></p><p><strong>有意思的是，如果使用colSums计算得分的话，画出来是这样的：</strong></p><p><img data-galleryid="" data-ratio="0.3812375249500998" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345SktNutrxxTO8uZUVLZlTxRq6OrNjRdUJfqAgm45qHoh5fhXKQvmthAreibP3acHXibYaCGgBLw3SFibXQ/640?wx_fmt=png" data-type="png" data-w="501" src="https://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345SktNutrxxTO8uZUVLZlTxRq6OrNjRdUJfqAgm45qHoh5fhXKQvmthAreibP3acHXibYaCGgBLw3SFibXQ/640?wx_fmt=png"></p><p><img data-galleryid="" data-ratio="0.8659003831417624" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345SktNutrxxTO8uZUVLZlTxRq6MXGduYBvRKNEl7zs03TddPAgxubLUK5iaHJSpNfeByume7ucx4nXVkw/640?wx_fmt=png" data-type="png" data-w="783" src="https://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345SktNutrxxTO8uZUVLZlTxRq6MXGduYBvRKNEl7zs03TddPAgxubLUK5iaHJSpNfeByume7ucx4nXVkw/640?wx_fmt=png"></p><p>方法优劣，自行评判。个人感觉Jimmy老师的方法更好些。<br></p><p><br></p><p><img data-galleryid="" data-ratio="0.13380281690140844" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345SktNutrxxTO8uZUVLZlTxRq6NNV4jic2QRrB03jS5DKmDaR30E0suMkZkavzWuTAB5odAO2nH0DPfYg/640?wx_fmt=png" data-type="png" data-w="426" src="https://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345SktNutrxxTO8uZUVLZlTxRq6NNV4jic2QRrB03jS5DKmDaR30E0suMkZkavzWuTAB5odAO2nH0DPfYg/640?wx_fmt=png"></p><p>如果我们使用加了denoise参数，最后来计算cnv score，结果会一样吗？</p><p>降噪之后，使用Jimmy老师的方法，趋势没有变化</p><p><img data-galleryid="" data-ratio="0.8794233289646134" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345SktNutrxxTO8uZUVLZlTxRq6ocaY41EIibibyGM7miagl7wdyMKpOlicML8scCTgTPNib1bglPN85Mlcvyw/640?wx_fmt=png" data-type="png" data-w="763" src="https://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345SktNutrxxTO8uZUVLZlTxRq6ocaY41EIibibyGM7miagl7wdyMKpOlicML8scCTgTPNib1bglPN85Mlcvyw/640?wx_fmt=png"></p><p><strong>下面可以看到降噪、不降噪，最后得到的cnv score其实相关性很高的</strong><br></p><p><img data-galleryid="" data-ratio="0.42883211678832117" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345SktNutrxxTO8uZUVLZlTxRq6VKm2QDpgCtd39oHSjtdR8UDuFG1dWLicpyCm4ib8ibypmdpQn4ABTctfg/640?wx_fmt=png" data-type="png" data-w="548" src="https://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345SktNutrxxTO8uZUVLZlTxRq6VKm2QDpgCtd39oHSjtdR8UDuFG1dWLicpyCm4ib8ibypmdpQn4ABTctfg/640?wx_fmt=png"></p><p><strong>但是降噪之后和colsum计算得到的分数相关性就比较低了</strong><br></p><p><img data-galleryid="" data-ratio="0.33948863636363635" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345SktNutrxxTO8uZUVLZlTxRq6oQWg6W3OlQuRJN1FbnPAynpewQNAjl6MVO9aJvHabwryjQgYMdVnTg/640?wx_fmt=png" data-type="png" data-w="704" src="https://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345SktNutrxxTO8uZUVLZlTxRq6oQWg6W3OlQuRJN1FbnPAynpewQNAjl6MVO9aJvHabwryjQgYMdVnTg/640?wx_fmt=png"></p><p><img data-galleryid="" data-ratio="0.3151515151515151" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345SktNutrxxTO8uZUVLZlTxRq6WMfKpjQEQ1Cw7icapIOWicMeyXSLONnDxVa8NeKpAJdAyMTGlJ78eIEA/640?wx_fmt=png" data-type="png" data-w="165" src="https://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345SktNutrxxTO8uZUVLZlTxRq6WMfKpjQEQ1Cw7icapIOWicMeyXSLONnDxVa8NeKpAJdAyMTGlJ78eIEA/640?wx_fmt=png"></p><p>1.推荐Jimmy老师计算cnv分数的方法</p><p>2.是否降噪，对趋势没啥影响</p><section><mp-common-profile data-pluginname="mpprofile" data-id="Mzg2NDcxMzYwNg==" data-headimg="http://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345Sks7JhVxUX46ZKxPSob6ptqIZgnIEnHOn5VMwCX8sN6MQy1Pq4XXFEOJ6grAmsoQugyCDKOZictDBHA/0?wx_fmt=png" data-nickname="生信小博士" data-alias="youngyoung_leelee" data-signature="从R语言开始，学习生信。" data-from="0" data-is_biz_ban="0"></mp-common-profile></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/vMAf_bMqlOcKYGJ95DFPbw",target="_blank" rel="noopener noreferrer">原文链接</a>
