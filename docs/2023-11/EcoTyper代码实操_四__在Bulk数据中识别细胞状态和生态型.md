---
title: "EcoTyper代码实操（四）：在Bulk数据中识别细胞状态和生态型"
date: 2023-11-16T03:36:03Z
draft: ["false"]
tags: [
  "fetched",
  "生信宝库"
]
categories: ["Acdemic"]
---
EcoTyper代码实操（四）：在Bulk数据中识别细胞状态和生态型 by 生信宝库
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><h2 data-tool="mdnice编辑器"><span></span><span>前言</span></h2><p data-tool="mdnice编辑器">EcoTyper是一个基于机器学习的工具，能够从Bulk、单细胞、以及空间分辨率的基因表达数据中大规模地识别并验证细胞状态和生态型。我们在前面的推文中介绍了EcoTyper的分析框架和部分实操，感兴趣的小伙伴可以先阅读这一部分哦。</p><h3 data-tool="mdnice编辑器"><span></span><span>EcoTyper推文汇总</span><span></span></h3><blockquote data-tool="mdnice编辑器"><blockquote><p><a href="https://mp.weixin.qq.com/s?__biz=MzI4MjY5ODI1Nw==&amp;mid=2247489413&amp;idx=1&amp;sn=83a74ef4e0a9f2e513d945dc346200bf&amp;chksm=eb94a0fbdce329ed8d34357df3724081e7e6a0b535ac82f094f9afedcdac02ace84823de1edf&amp;token=348825747&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">EcoTyper：识别肿瘤中各种细胞的生态位-实体肿瘤</a></p><p><a href="https://mp.weixin.qq.com/s?__biz=MzI4MjY5ODI1Nw==&amp;mid=2247489492&amp;idx=1&amp;sn=306534b8bd80b5f957110462abb7b6a9&amp;chksm=eb94a0aadce329bcfee7e34f9cd968fc393aaf873b827538c8eaa66e540e30b62b9208681783&amp;token=348825747&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">EcoTyper：识别肿瘤中各种细胞的生态位-血液肿瘤</a></p><p><a href="https://mp.weixin.qq.com/s?__biz=MzI4MjY5ODI1Nw==&amp;mid=2247489529&amp;idx=1&amp;sn=e7b1452490c777117eeb4be50e26d9b0&amp;chksm=eb94a087dce329916ba2beb66a281c1f2b03daf83f38734e153f4adaaa4a6cebd47d659652ab&amp;token=483235345&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">EcoTyper代码实操（一）：从Bulk数据恢复细胞状态和生态型</a></p><p><a href="https://mp.weixin.qq.com/s?__biz=MzI4MjY5ODI1Nw==&amp;mid=2247489662&amp;idx=1&amp;sn=4168ed7dd4059fdcc6ebd0bdbae2fa5b&amp;chksm=eb94af00dce3261653fa9ea4f31b4bc3f5eac7cc74791e6db7f2e2ee9f7363f04dec8a346b98&amp;token=339534183&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">EcoTyper代码实操（二）：从scRNA-seq数据恢复细胞状态和生态型</a></p><p><a href="https://mp.weixin.qq.com/s?__biz=MzI4MjY5ODI1Nw==&amp;mid=2247489689&amp;idx=1&amp;sn=efea829a42c57a6c594fffd309a5b5c7&amp;chksm=eb94afe7dce326f1a6f3def2dd89b1237792da81ccf2f14c634a81adb48a8656fc53c6442d88&amp;token=45542777&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">EcoTyper代码实操（三）：从空间转录组学数据恢复细胞状态和生态型</a></p></blockquote></blockquote><p data-tool="mdnice编辑器">EcoTyper的代码实操主要分为6个部分：</p><figure data-tool="mdnice编辑器"><img data-ratio="0.6134328358208955" data-src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7dA5Jh9yT3kicnxLhZtoZ40M17FS9gW9ppxZibRregu1Lib4icWrIOVHv520xERlKpMrqekQ7ibP3q1vibg/640?wx_fmt=png" data-type="png" data-w="670" src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7dA5Jh9yT3kicnxLhZtoZ40M17FS9gW9ppxZibRregu1Lib4icWrIOVHv520xERlKpMrqekQ7ibP3q1vibg/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">那么，今天让我们一起来学习一下它的第四个部分——<strong>De novo Discovery of Cell States and Ecotypes in Bulk Data</strong></p><ul data-tool="mdnice编辑器"><li><section>EcoTyper的分析框架：</section></li></ul><ol data-tool="mdnice编辑器"><li><section>Cell Type Fraction Estimation：估计组织中的主要细胞谱系（cell lineage）的比例。它使用 CIBERSORTx Fractions 模块，该模块基于signature matrix估算细胞比例。</section></li><li><section>Cell Type Expression Purification：这一步骤使用 CIBERSORTx HiRes 模块从Bulk组织转录组中提取细胞类型特定的基因表达谱。它利用前一步骤估算的细胞比例，生成每种细胞类型的基因表达谱。</section></li><li><section>Cell State Discovery：EcoTyper 使用非负矩阵分解（NMF）识别细胞状态。这个过程包括选择适当数量的细胞状态，使用 NMF 算法分解表达谱，并提取每个细胞状态的特征基因。</section></li><li><section>Choosing the Number of Cell States：基于Cophenetic系数确定细胞状态的数量。该系数在细胞状态数目变化时量化分类稳定性，通过这种方式选择最适合的细胞状态数。</section></li><li><section>Extracting Cell State Information：提取用于后续分析的细胞状态信息。</section></li><li><section>Cell State QC Filter：过滤掉不合格的细胞状态。</section></li><li><section>Advanced Cell State QC Filter：在多种肿瘤类型的情况下，EcoTyper推荐使用高级过滤器，它可以检测到具有异常低方差和高表达的标志基因的不良质量细胞状态。</section></li><li><section>Ecotype Discovery：识别细胞状态在样本中的共现模式，即生态型或细胞群。EcoTyper使用Jaccard指数来量化每对细胞状态在样本中的重叠程度，并应用层次聚类确定生态型。</section></li></ol><hr data-tool="mdnice编辑器"><h2 data-tool="mdnice编辑器"><span></span><span>代码流程</span></h2><h3 data-tool="mdnice编辑器"><span></span><span>1.准备环境和数据</span><span></span></h3><h5 data-tool="mdnice编辑器"><span></span>下载 EcoTyper<span></span></h5><pre data-tool="mdnice编辑器"><code>wget https://github.com/digitalcytometry/ecotyper/archive/refs/heads/master.zip<br>unzip master.zip<br><span>cd</span> ecotyper-master<br><span>#EcoTyper是一个独立的软件，用R实现，但并不是R包哦。</span><br></code></pre><h5 data-tool="mdnice编辑器"><span></span>R环境准备：<span></span></h5><p data-tool="mdnice编辑器"><img data-ratio="0.19219653179190752" data-src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7dA5Jh9yT3kicnxLhZtoZ40Mia96M0e0X4iaAicPGhJ7qfnL9V54WUfPCAbuHiaVEMkc69DePNv2VSYmIg/640?wx_fmt=png" data-type="png" data-w="692" src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7dA5Jh9yT3kicnxLhZtoZ40Mia96M0e0X4iaAicPGhJ7qfnL9V54WUfPCAbuHiaVEMkc69DePNv2VSYmIg/640?wx_fmt=png">这是官网推荐的R和R包版本，但是小编用的最新的R版本，并且安装相应最新版本的R包也是很顺利的。</p><pre data-tool="mdnice编辑器"><code>install.packages(c(<span>"RColorBrewer"</span>,<span>"cluster"</span>, <span>"circlize"</span>,<span>"cowplot"</span>,<span>"data.table"</span>,<span>"doParallel"</span>,<span>"ggplot2"</span>,<span>"grid"</span>, <span>"reshape2"</span>, <span>"viridis"</span>,<span>"config"</span>,<span>"argparse"</span>,<span>"colorspace"</span>, <span>"plyr"</span>))<br>BiocManager::install(<span>"ComplexHeatmap"</span>)<br>BiocManager::install(<span>"Biobase"</span>)<br>BiocManager::install(<span>"NMF"</span>)<br></code></pre><h5 data-tool="mdnice编辑器"><span></span>其他：<span></span></h5><p data-tool="mdnice编辑器">安装Docker。</p><p data-tool="mdnice编辑器">获取CIBERSORTx Fractions和CIBERSORTx HiRes模块的Docker容器，这两个模块可以从CIBERSORTx网站获取，需要按照网站上的说明进行安装。</p><p data-tool="mdnice编辑器">获取运行Docker容器所需的token，这也可以从CIBERSORTx网站获取。</p><h5 data-tool="mdnice编辑器"><span></span>输入数据：<span></span></h5><ol data-tool="mdnice编辑器"><li><section>表达谱数据：TCGA部分肺腺癌（LUAD）和肺鳞癌（LUSC）的数据（bulk-tissue expression matrix）。数据存储在<code>example_data/bulk_lung_data.txt</code>中。</section></li></ol><p data-tool="mdnice编辑器"><img data-ratio="0.10419681620839363" data-src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7dA5Jh9yT3kicnxLhZtoZ40MNBhBgzXtf7iaIDiclJyaTKIw0icoxdiaIgcZD2Zib48nMA4S9vXOBhOyYpg/640?wx_fmt=png" data-type="png" data-w="691" src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7dA5Jh9yT3kicnxLhZtoZ40MNBhBgzXtf7iaIDiclJyaTKIw0icoxdiaIgcZD2Zib48nMA4S9vXOBhOyYpg/640?wx_fmt=png">2. 样本注释文件，数据存储在<code>example_data/bulk_lung_annotation.txt</code>。</p><figure data-tool="mdnice编辑器"><img data-ratio="0.17027417027417027" data-src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7dA5Jh9yT3kicnxLhZtoZ40Mj2FM9y6brAgxgIfN3TQqfhVw3EMz0cdTiaibL3NicxGeItL5EwkknXBRA/640?wx_fmt=png" data-type="png" data-w="693" src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7dA5Jh9yT3kicnxLhZtoZ40Mj2FM9y6brAgxgIfN3TQqfhVw3EMz0cdTiaibL3NicxGeItL5EwkknXBRA/640?wx_fmt=png"></figure><ol start="3" data-tool="mdnice编辑器"><li><section>细胞类型比例文件，数据存储在<code>example_data/bulk_fractions_example.txt</code>。</section></li></ol><figure data-tool="mdnice编辑器"><img data-ratio="0.18958031837916064" data-src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7dA5Jh9yT3kicnxLhZtoZ40M1FW4tTP6pgQJUKeibAsPJFJFauiaDPZHUubtibWicLD1l5NQKhq1SyZicuQ/640?wx_fmt=png" data-type="png" data-w="691" src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7dA5Jh9yT3kicnxLhZtoZ40M1FW4tTP6pgQJUKeibAsPJFJFauiaDPZHUubtibWicLD1l5NQKhq1SyZicuQ/640?wx_fmt=png"></figure><h3 data-tool="mdnice编辑器"><span></span><span>2.discovery scripts</span><span></span></h3><p data-tool="mdnice编辑器"><code>EcoTyper_discovery_bulk.R</code>脚本用于在空间转录组数据中恢复细胞状态和生态型。</p><pre data-tool="mdnice编辑器"><code>Rscript EcoTyper_discovery_bulk.R -h<br></code></pre><p data-tool="mdnice编辑器">此脚本接受 YAML 格式的配置文件作为输入文件（config_discovery_bulk.yml）。</p><figure data-tool="mdnice编辑器"><img data-ratio="0.550682261208577" data-src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7dA5Jh9yT3kicnxLhZtoZ40M8BcPExrTicSDswKCd2icm6Myt67Z7PFeDdecvDvGaG1aicvR5UByDehpA/640?wx_fmt=png" data-type="png" data-w="1026" src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7dA5Jh9yT3kicnxLhZtoZ40M8BcPExrTicSDswKCd2icm6Myt67Z7PFeDdecvDvGaG1aicvR5UByDehpA/640?wx_fmt=png"></figure><h5 data-tool="mdnice编辑器"><span></span>参数详解：<span></span></h5><ul data-tool="mdnice编辑器"><li><section><p>Discovery dataset name : "MyDiscovery"</p><p>#发现数据集名称</p></section></li><li><section><p>Expression matrix : "example_data/bulk_lung_data.txt"</p><p>#The expression matrix should be in the TPM or FPKM space for bulk RNA-seq and non-logarithmic (exponential) space for microarrays.</p></section></li><li><section><p>Expression type : "RNA-seq"</p><p>#Possible values: "RNA-seq", "Affymetrix", "Other"</p></section></li><li><section><p>Number of NMF restarts : 5</p><p>#NMF重新启动次数参数，这是一个非常耗时的过程，这里建议至少设置为50。</p></section></li><li><section><p>Maximum number of states per cell type : 20</p><p>#每种细胞类型可能的状态数量的上限。</p></section></li><li><section><p>Cophenetic coefficient cutoff : 0.95</p><p>#取值范围为[0,1]，较低的值会得到较多的细胞状态数量。</p></section></li><li><section><p>Minimum number of states in ecotypes : 3</p><p>#少于3种细胞状态的生态型被过滤掉</p></section></li></ul><h5 data-tool="mdnice编辑器"><span></span>运行脚本：<span></span></h5><pre data-tool="mdnice编辑器"><code>Rscript EcoTyper_discovery_bulk.R -c config_discovery_bulk.yml<br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span>3.结果解读</span><span></span></h3><p data-tool="mdnice编辑器">输出的结果包括3类，rank_plot图、各种细胞类型的细胞状态以及生态型。让我们来逐各学习一下。</p><figure data-tool="mdnice编辑器"><img data-ratio="2.0906040268456376" data-src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7dA5Jh9yT3kicnxLhZtoZ40MRrqMt8LNC4o9ibgY9iaXBXGup5MvjogAQYZjLwcicxkmDwbFu2q1S4c7g/640?wx_fmt=png" data-type="png" data-w="298" src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7dA5Jh9yT3kicnxLhZtoZ40MRrqMt8LNC4o9ibgY9iaXBXGup5MvjogAQYZjLwcicxkmDwbFu2q1S4c7g/640?wx_fmt=png"></figure><ol data-tool="mdnice编辑器"><li><section>rank_plot（Cophenetic系数图）:横向虚线表示配置文件中提供的Cophenetic系数截断值（Cophenetic coefficient cutoff field）。红色的垂直虚线表示基于提供的Cophenetic系数截断值自动选择的状态数量。注意这些图表示在应用步骤6和7中的低质量状态筛选之前获得的状态数量。因此最终结果可能包含较少的状态。</section></li></ol><figure data-tool="mdnice编辑器"><img data-ratio="0.8225108225108225" data-src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7dA5Jh9yT3kicnxLhZtoZ40MjHmgXia7I0sEDqH6VvBAe84fOHJR7K5DWBqSuzXcx1ia8FS6GW1Vcuog/640?wx_fmt=png" data-type="png" data-w="693" src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7dA5Jh9yT3kicnxLhZtoZ40MjHmgXia7I0sEDqH6VvBAe84fOHJR7K5DWBqSuzXcx1ia8FS6GW1Vcuog/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">接下来，我们以内皮细胞为例展示ecotyper识别的细胞状态结果</p><ol start="2" data-tool="mdnice编辑器"><li><section>state_abundances.txt：包含了在每个样本中每种细胞状态的相对丰度信息。</section></li></ol><figure data-tool="mdnice编辑器"><img data-ratio="0.16329479768786126" data-src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7dA5Jh9yT3kicnxLhZtoZ40MuADYGfUgQIGrMRJO3eyvtEl2Mjrjd6PzialsOprf00dialTB6A1jmphQ/640?wx_fmt=png" data-type="png" data-w="692" src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7dA5Jh9yT3kicnxLhZtoZ40MuADYGfUgQIGrMRJO3eyvtEl2Mjrjd6PzialsOprf00dialTB6A1jmphQ/640?wx_fmt=png"></figure><ol start="3" data-tool="mdnice编辑器"><li><section>state_assignment.txt：每个样本被分配到具有最高推断丰度的细胞状态的信息，也就是每个样本的主要细胞状态。</section></li></ol><figure data-tool="mdnice编辑器"><img data-ratio="0.29711751662971175" data-src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7dA5Jh9yT3kicnxLhZtoZ40M0mm10dRGl1bKcb5eUmVws2deFZDNe9eYYxicUW0oZhKuibA3Ac6TnyLw/640?wx_fmt=png" data-type="png" data-w="451" src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7dA5Jh9yT3kicnxLhZtoZ40M0mm10dRGl1bKcb5eUmVws2deFZDNe9eYYxicUW0oZhKuibA3Ac6TnyLw/640?wx_fmt=png"></figure><ol start="4" data-tool="mdnice编辑器"><li><section><p>state_assignment_heatmap.png/pdf:展示在每个细胞状态中具有最高 log2 FC的基因的表达情况，这些基因被称为细胞状态特异性标记基因。列代表发现数据集中的样本，而行代表了每个细胞状态的标记基因。所选的标记基因显示在热图的左侧。热图按照细胞状态的分配进行排序，顶部的颜色条显示了给定样本的主要状态。<img data-ratio="0.7761989342806395" data-src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7dA5Jh9yT3kicnxLhZtoZ40MC6Nmqgs15fmmEvQLibkiaDo4jhRexpbdwRM6hw02IbW0SOxSpzO6pYWA/640?wx_fmt=png" data-type="png" data-w="563" src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7dA5Jh9yT3kicnxLhZtoZ40MC6Nmqgs15fmmEvQLibkiaDo4jhRexpbdwRM6hw02IbW0SOxSpzO6pYWA/640?wx_fmt=png"></p></section></li><li><section><p>"heatmap_data.txt" 是输出热图 "state_assignment_heatmap" 中所显示的热图的基础数据。这些数据包括了基因的表达水平，经过标准化处理，用于展示不同细胞状态中基因表达的变化。通常，每一列代表了发现数据集中的一个样本，而每一行代表了每个细胞状态的标志基因。</p></section></li></ol><figure data-tool="mdnice编辑器"><img data-ratio="0.10838150289017341" data-src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7dA5Jh9yT3kicnxLhZtoZ40Ms2oBicknMq1FCbhxZHTE0ic0TggjZadUHQLh0uHdHOSgXdsC3TRfyh3A/640?wx_fmt=png" data-type="png" data-w="692" src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7dA5Jh9yT3kicnxLhZtoZ40Ms2oBicknMq1FCbhxZHTE0ic0TggjZadUHQLh0uHdHOSgXdsC3TRfyh3A/640?wx_fmt=png"></figure><ol start="6" data-tool="mdnice编辑器"><li><section>"heatmap_top_ann.txt" 是用户提供的注释文件与细胞状态相关的信息的整合。只有被分配到主要细胞状态的样本才会包含在这个文件中。</section></li></ol><figure data-tool="mdnice编辑器"><img data-ratio="0.13872832369942195" data-src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7dA5Jh9yT3kicnxLhZtoZ40MRmILyaDHsfdcsYz3ZDSdTyORiaOv0UgAIMTmjZxBmaVia9ozEFG5PmRQ/640?wx_fmt=png" data-type="png" data-w="692" src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7dA5Jh9yT3kicnxLhZtoZ40MRmILyaDHsfdcsYz3ZDSdTyORiaOv0UgAIMTmjZxBmaVia9ozEFG5PmRQ/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">生态型部分输出的结果</p><ol start="7" data-tool="mdnice编辑器"><li><section>"ecotype_abundance.txt" 文件包含了在发现数据集中的每个生态型（ecotype）相对丰度的信息。</section></li></ol><figure data-tool="mdnice编辑器"><img data-ratio="0.11271676300578035" data-src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7dA5Jh9yT3kicnxLhZtoZ40MMacaavQVjKhPRfunicdpmA0Ufic0T76VRrn9lT4cH9diazaWibFEbxz20Q/640?wx_fmt=png" data-type="png" data-w="692" src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7dA5Jh9yT3kicnxLhZtoZ40MMacaavQVjKhPRfunicdpmA0Ufic0T76VRrn9lT4cH9diazaWibFEbxz20Q/640?wx_fmt=png"></figure><ol start="8" data-tool="mdnice编辑器"><li><section>"ecotype_assignment.txt" 文件包含了将发现数据集中的样本分配到各个生态型的信息。未被分配到任何生态型的样本将从该文件中被过滤掉。</section></li></ol><figure data-tool="mdnice编辑器"><img data-ratio="0.15007215007215008" data-src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7dA5Jh9yT3kicnxLhZtoZ40MbSF0RVpLb7ysq6ehUPFgGcWu4Ih7TNCCHFmoWl8808ibVedqVIKibAag/640?wx_fmt=png" data-type="png" data-w="693" src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7dA5Jh9yT3kicnxLhZtoZ40MbSF0RVpLb7ysq6ehUPFgGcWu4Ih7TNCCHFmoWl8808ibVedqVIKibAag/640?wx_fmt=png"></figure><ol start="9" data-tool="mdnice编辑器"><li><section>"heatmap_assigned_samples_viridis.pdf/png" 展示了EcoTyper推断出的细胞状态分数的热图，这些细胞状态分配给了被分配到生态型的样本。</section></li></ol><figure data-tool="mdnice编辑器"><img data-ratio="0.7256944444444444" data-src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7dA5Jh9yT3kicnxLhZtoZ40M6cVicaaJLCZosS6CVkTPM7TuWMPLM8B3dPMljulwVZWA2GDcOiaHTBKg/640?wx_fmt=png" data-type="png" data-w="576" src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7dA5Jh9yT3kicnxLhZtoZ40M6cVicaaJLCZosS6CVkTPM7TuWMPLM8B3dPMljulwVZWA2GDcOiaHTBKg/640?wx_fmt=png"></figure><ol start="10" data-tool="mdnice编辑器"><li><section>nclusters_jaccard.png/pdf:"initial clusters" 指的是通过对Jaccard指数矩阵进行聚类获得的初始簇的数量。这个数量通常是通过应用平均轮廓（average silhouette）方法来选择的。</section></li></ol><figure data-tool="mdnice编辑器"><img data-ratio="0.9853300733496333" data-src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7dA5Jh9yT3kicnxLhZtoZ40M5M5g1Cc8qZGnYNnsdBDhYydvibfmNSSYvPRSZyuLx4Qwg2ibJdSXVOww/640?wx_fmt=png" data-type="png" data-w="409" src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7dA5Jh9yT3kicnxLhZtoZ40M5M5g1Cc8qZGnYNnsdBDhYydvibfmNSSYvPRSZyuLx4Qwg2ibJdSXVOww/640?wx_fmt=png"></figure><ol start="11" data-tool="mdnice编辑器"><li><section>jaccard_matrix.png/pdf:包含至少3个细胞状态的生态型的Jaccard指数矩阵的热图。</section></li></ol><figure data-tool="mdnice编辑器"><img data-ratio="1.0179640718562875" data-src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7dA5Jh9yT3kicnxLhZtoZ40MVSNEUVwVdq2Y1iaXY6KLe8DhO1dNSCThtziaT0vprU8b2JzOicibHszYhw/640?wx_fmt=png" data-type="png" data-w="501" src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7dA5Jh9yT3kicnxLhZtoZ40MVSNEUVwVdq2Y1iaXY6KLe8DhO1dNSCThtziaT0vprU8b2JzOicibHszYhw/640?wx_fmt=png"></figure><hr data-tool="mdnice编辑器"><h2 data-tool="mdnice编辑器"><span></span><span>小结</span></h2><p data-tool="mdnice编辑器">在本期推文中，我们介绍了如何使用EcoTyper从Bulk组织表达数据中<code>从头发现细胞状态和生态系统</code>。我们将在下期推文中继续和大家学习EcoTyper更为常用的实操技巧--De novo Discovery of Cell States and Ecotypes in scRNA-seq Data，关于今天的学习内容，感兴趣的小伙伴快来用起来吧~</p><p data-tool="mdnice编辑器">好啦，本期的分享到这里就结束了，我们下期再会~</p><hr data-tool="mdnice编辑器"></section><p><img data-ratio="1" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/GL6g5Y3aR7eUr3zZytdDPl7kPJBscWxTDlwbSxRjmMoYpSCSmlGicFibnLH3pvictSibFwekOaooibv9Ria0zSCrC2icg/640?wx_fmt=jpeg" data-type="jpeg" data-w="344" src="https://mmbiz.qpic.cn/mmbiz_jpg/GL6g5Y3aR7eUr3zZytdDPl7kPJBscWxTDlwbSxRjmMoYpSCSmlGicFibnLH3pvictSibFwekOaooibv9Ria0zSCrC2icg/640?wx_fmt=jpeg"></p><h3 data-tool="mdnice编辑器"><span>关注下方公众号下回更新不迷路</span></h3><section><br></section><section><mp-common-profile data-pluginname="mpprofile" data-weui-theme="light" data-id="MzI4MjY5ODI1Nw==" data-headimg="http://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7f0yanILMQZCnw1duTMROQRvgDqVjlYcrljTRy1E4ZLppLG6zicdd3h0IwjLpxnum1V5KsowibJM1sw/0?wx_fmt=png" data-nickname="生信宝库" data-alias="sxbk2020" data-signature="本公众号只用于生信知识的收集与传播，以及生信人之间互相交流和学习，不会涉及任何商业利益。本公众号各小编平时忙于科研，更新文章较其它同类型公众号较慢，但保持宁缺毋滥的本心，只更新对大家有用的推文。" data-from="2" data-is_biz_ban="0"></mp-common-profile></section><p><br></p><p><br></p><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/mGfHHPg7YzDx3wv7fjTgWg",target="_blank" rel="noopener noreferrer">原文链接</a>
