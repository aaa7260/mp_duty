---
title: "人人都需掌握的单细胞分群聚类分析&Marker基因的可视化"
date: 2023-11-13T13:04:23Z
draft: ["false"]
tags: [
  "fetched",
  "生信菜鸟团"
]
categories: ["Acdemic"]
---
人人都需掌握的单细胞分群聚类分析&Marker基因的可视化 by 生信菜鸟团
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><blockquote data-tool="mdnice编辑器"><p>一年内应该是大家不需要最新版的就是V5版本的SeuratObject 和Seurat，所以都回去吧，回到v4版本哈...</p></blockquote></section><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><p data-tool="mdnice编辑器">          批量转录组测序可以为组织或细胞系的整体基因表达提供信息但无法解析不同细胞间的异质性问题；单细胞测序则可提供每个单个细胞的基因表达特征，允许研究者探索细胞类型、细胞状态、细胞亚群等更细致的分子特征。由于单细胞测序数据具有高度异质性，因此需要特定的数据分析方法来处理和解释数据，如聚类分析、降维算法等。这里意味着单细胞测序分析要比批量转录组的分析更为发杂。 </p><p data-tool="mdnice编辑器">         在未成为生信技能树的学徒之前，我从老没有接触过单细胞测序分析，今天有幸和优秀的老师学习，也很庆幸能把我学习到的知识传播给更多的初学者，一起见证我们彼此的成长！好啦，言归正传，今天我们先跟着健明老师学习一下单细胞分群聚类分析&amp;Marker基因的可视化。</p><blockquote data-type="1" data-url="https://mp.weixin.qq.com/s/ECmmCNXfgbD9CHdbidLetw" data-author-name="生信技能树" data-content-utf8-length="19" data-source-title="轻松一挖就节约10万经费"><section><section>学徒作业题目：轻松一挖就节约10万经费</section></section><section data-json="%7B%22type%22%3A%22inner%22%2C%22source%22%3A%22url%22%2C%22digest%22%3A%22%22%2C%22digestLen%22%3A19%2C%22text%22%3A%22%E5%AD%A6%E5%BE%92%E4%BD%9C%E4%B8%9A%E9%A2%98%E7%9B%AE%EF%BC%9A%E8%BD%BB%E6%9D%BE%E4%B8%80%E6%8C%96%E5%B0%B1%E8%8A%82%E7%BA%A610%E4%B8%87%E7%BB%8F%E8%B4%B9%22%2C%22article%22%3A%7B%22title%22%3A%22%E8%BD%BB%E6%9D%BE%E4%B8%80%E6%8C%96%E5%B0%B1%E8%8A%82%E7%BA%A610%E4%B8%87%E7%BB%8F%E8%B4%B9%22%2C%22url%22%3A%22https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FECmmCNXfgbD9CHdbidLetw%22%2C%22nickname%22%3A%22%E7%94%9F%E4%BF%A1%E6%8A%80%E8%83%BD%E6%A0%91%22%2C%22authorName%22%3A%22%E7%94%9F%E4%BF%A1%E6%8A%80%E8%83%BD%E6%A0%91%22%7D%2C%22hasReportOverSize%22%3Afalse%2C%22editorReportData%22%3A%5B%5D%7D"><span>生信技能树，公众号：生信技能树<a href="https://mp.weixin.qq.com/s/ECmmCNXfgbD9CHdbidLetw">轻松一挖就节约10万经费</a></span></section></blockquote><p><br></p><p data-tool="mdnice编辑器">以公共数据集GSE182434为例，代码和结果如下：</p><p data-tool="mdnice编辑器"><strong>#安装软件</strong></p><pre data-tool="mdnice编辑器"><span></span><code>rm(list=ls())<br>options(stringsAsFactors = F)<br>getwd()<br>library(Seurat)<br>library(ggplot2)<br><span>#install.packages(c('clustree'))</span><br>library(clustree)<br>library(cowplot)<br>library(dplyr)<br>library(patchwork)<br></code></pre><p data-tool="mdnice编辑器"><strong>#读入matix数据</strong></p><pre data-tool="mdnice编辑器"><span></span><code>library(data.table)<br>dat=fread( <span>"GSE182434_raw_count_matrix.txt.gz"</span>,data.table = F)<br>dim(dat)<br>dat[1:4,1:4]<br>rownames(dat)=dat[,1]<br>dat=dat[,-1]<br>dat[1:4,1:4]<br>annotation = fread( <span>"GSE182434_cell_annotation.txt.gz"</span>,data.table = F)<br>annotation[1:4,1:4]<br>table(annotation<span>$Patient</span>,annotation<span>$CellType</span>)<br></code></pre><p data-tool="mdnice编辑器"><strong>#筛选相关案例病人样本（DLBCL002 、DLBCL007、 DLBCL008、DLBCL111）</strong></p><pre data-tool="mdnice编辑器"><span></span><code><span>#筛选条件①、四个样本 ：DLBCL002 、DLBCL007、 DLBCL008、DLBCL111</span><br><span>#筛选条件②、CD8+细胞</span><br>sample = c(<span>"DLBCL002"</span>,<span>"DLBCL007"</span>,<span>"DLBCL008"</span>,<span>"DLBCL111"</span>)<br>CellType = <span>"T cells CD8"</span><br>annotation = annotation[annotation<span>$Patient</span> %<span>in</span>% sample,]<br>annotation = annotation[annotation<span>$CellType</span> %<span>in</span>% CellType,]<br>dim(annotation)  <span>#4个样本，一共5千个CD8细胞</span><br>dat = dat[,annotation<span>$ID</span>]<br>dat[1:5,1:5]<br>dim(dat)<br>View(dat)<br>View(annotation)<br></code></pre><p data-tool="mdnice编辑器"><strong>#创建Seurat对象</strong></p><pre data-tool="mdnice编辑器"><span></span><code>library(Seurat)<br>sce &lt;- CreateSeuratObject(counts = dat, <br>                          project = <span>"sce"</span>, <span>#项目名称</span><br>                          min.cells = 3, <br>                          min.features = 200)<br>sce <br>View(sce<span>$nCount_RNA</span>)<br>View(sce<span>$nFeature_RNA</span>)<br>View(sce<span>$orig</span>.ident)<br><br>sce<span>$orig</span>.ident&lt;-annotation<span>$Patient</span> <span>#修改sce 矩阵样本的分组信息</span><br>View(sce<span>$orig</span>.ident)<br></code></pre><p data-tool="mdnice编辑器"><strong>#识别表达量高变的基因</strong></p><pre data-tool="mdnice编辑器"><span></span><code>sce = FindVariableFeatures(sce,selection.method = <span>"vst"</span>, nfeatures = 2000)<span>#它们在某些细胞中高表达，而在其他细胞中低表达，在下游分析中关注这些基因有助于突出单细胞数据集中的生物信号。</span><br><span>#在 Seurat 中的过程，通过直接建模单细胞数据中固有的均值-方差关系来改进以前的版本，并在FindVariableFeatures()函数中实现。默认情况下，为每个数据集返回 2,000 个特征基因用于下游分析。</span><br>鉴别前10的高变基因。<br>top10 &lt;- head(VariableFeatures(sce), 10)<br>画出没有标签的高变基因图<br>plot1 &lt;- VariableFeaturePlot(sce)<br>加入前十个标签<br>plot2 &lt;- LabelPoints(plot = plot1, points = top10, repel = TRUE)<br>plot1 + plot2<br></code></pre><p><img data-galleryid="" data-ratio="0.5361111111111111" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibNRNTlcoGGpFicEZsicmCpmeTz7MKF1dKoRYPt9BrGeaSlfiaVwSFwvjiarHibnFGXaFGMIejDZsGEq3A/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibNRNTlcoGGpFicEZsicmCpmeTz7MKF1dKoRYPt9BrGeaSlfiaVwSFwvjiarHibnFGXaFGMIejDZsGEq3A/640?wx_fmt=png"></p><p data-tool="mdnice编辑器">#简单画一个DimPlot，判断是否要harmony</p><pre data-tool="mdnice编辑器"><span></span><code>sce = NormalizeData(sce, normalization.method = <span>"LogNormalize"</span>, scale.factor = 10000)<br>sce = FindVariableFeatures(sce)<br>sce = ScaleData(sce, vars.to.regress = c(<span>"nFeature_RNA"</span>, <span>"percent_mito"</span>))<br>sce = RunPCA(sce, npcs = 20)<span>#PCA降维，对高变基因降维</span><br><span>print</span>(sce [[<span>"pca"</span>]], dims = 1:5, nfeatures = 5)<span>#展示一部分结果</span><br>VizDimLoadings(sce , dims = 1:2, reduction = <span>"pca"</span>)<span>##点图形式展示</span><br>DimPlot(sce, reduction = <span>"pca"</span>)<span>#投影的降维图</span><br>DimHeatmap(sce, dims = 1:15, cells = 500, balanced = TRUE)<span>#DimHeatmap()允许轻松探索数据集中异质性的主要来源，并且在尝试决定要包括哪些 PC 以进行进一步的下游分析时非常有用。单元格和特征都根据其 PCA 分数排序。</span><br></code></pre><p><img data-galleryid="" data-ratio="0.5388888888888889" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibNRNTlcoGGpFicEZsicmCpmeWGuxS0ms6dor1sO94lnHNg9ao6orLEnjzg3eIlsJv9iaibjDTrod1ic2Q/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibNRNTlcoGGpFicEZsicmCpmeWGuxS0ms6dor1sO94lnHNg9ao6orLEnjzg3eIlsJv9iaibjDTrod1ic2Q/640?wx_fmt=png"></p><p><img data-galleryid="" data-ratio="0.9586776859504132" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibNRNTlcoGGpFicEZsicmCpmeXHN8fmJwqmoGfITMcJluLbusibkeucaGe1sWmFYQhhuFnFOPUcmA5IA/640?wx_fmt=png" data-type="png" data-w="847" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibNRNTlcoGGpFicEZsicmCpmeXHN8fmJwqmoGfITMcJluLbusibkeucaGe1sWmFYQhhuFnFOPUcmA5IA/640?wx_fmt=png"></p><p><img data-galleryid="" data-ratio="1.1529411764705881" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibNRNTlcoGGpFicEZsicmCpmeSCaQU6k1TqicAianebyj6pg92Mp1S93FfURMa2VdbhSHhia0REjD4tacQ/640?wx_fmt=png" data-type="png" data-w="850" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibNRNTlcoGGpFicEZsicmCpmeSCaQU6k1TqicAianebyj6pg92Mp1S93FfURMa2VdbhSHhia0REjD4tacQ/640?wx_fmt=png"></p><p data-tool="mdnice编辑器"><strong>##非线性降维</strong></p><pre data-tool="mdnice编辑器"><span></span><code><span>#Seurat 提供了多种非线性降维技术，例如 tSNE 和 UMAP，以可视化和探索这些数据集。这些算法的目标是学习数据的底层流形，以便将相似的单元格放在低维空间中。上面确定的基于图形的集群中的单元格应该在这些降维图上共同定位。作为 UMAP 和 tSNE 的输入，我们建议使用相同的 PC 作为聚类分析的输入。</span><br>sce = RunTSNE(sce, npcs = 20)<br>sce = Runtsne(sce, dims = 1:10)<br>sce = RunUMAP(sce, dims = 1:10)<br>sce = FindNeighbors(sce, dims = 1:20, k.param = 60, prune.SNN = 1/15)  <span>#这个dims要和PCA的npcs对应起来。</span><br>DimPlot(sce,reduction = <span>"umap"</span>,label=T,group.by = <span>"orig.ident"</span>)<br>ggsave(filename=<span>"no_harmony_DimPlot.pdf"</span>)<br></code></pre><p><img data-galleryid="" data-ratio="0.7829614604462475" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibNRNTlcoGGpFicEZsicmCpmeqYcgTwNaqlcQg5BTzcaxib2q0OicPMicW9Oofwk6ib9aia25b1Ogl4O5YqA/640?wx_fmt=png" data-type="png" data-w="986" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibNRNTlcoGGpFicEZsicmCpmeqYcgTwNaqlcQg5BTzcaxib2q0OicPMicW9Oofwk6ib9aia25b1Ogl4O5YqA/640?wx_fmt=png"></p><p data-tool="mdnice编辑器"><strong>#需要 harmony 去批次 因为是主动筛选4个样本出来的</strong></p><pre data-tool="mdnice编辑器"><span></span><code>library(harmony)<br>sce &lt;- RunHarmony(sce, <span>"orig.ident"</span>)<br>names(sce@reductions)<br>sce = RunUMAP(sce,  dims = 1:15, reduction = <span>"harmony"</span>)<br>sce = RunTSNE(sce, npcs = 20,reduction = <span>"harmony"</span>)<br>sce = FindNeighbors(sce, reduction = <span>"harmony"</span>, dims = 1:15)<br>DimPlot(sce,reduction = <span>"umap"</span>,label=T,group.by = <span>"orig.ident"</span>)<br>ggsave(filename=<span>"harmony_DimPlot.pdf"</span>)<br></code></pre><p><img data-galleryid="" data-ratio="0.7908629441624365" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibNRNTlcoGGpFicEZsicmCpmekarbAfyKf9vYRepjoXtdNMEcic9ibAoOAqKP6Kasf1Z3EXp3icMkh1ftg/640?wx_fmt=png" data-type="png" data-w="985" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibNRNTlcoGGpFicEZsicmCpmekarbAfyKf9vYRepjoXtdNMEcic9ibAoOAqKP6Kasf1Z3EXp3icMkh1ftg/640?wx_fmt=png"></p><p data-tool="mdnice编辑器">##(1)设置分辨率</p><pre data-tool="mdnice编辑器"><span></span><code><span>#分辨率分类</span><br><span>#文中是分了6群</span><br><span>#设置不同的分辨率，观察分群效果(选择哪一个？)</span><br><span>for</span> (res <span>in</span> c(0.01, 0.05, 0.1,0.15, 0.2, 0.3, 0.4,0.45,0.5,0.8,0.9,1)) {<br>  sce=FindClusters(sce, resolution = res, algorithm = 1)<br>}<span>#细胞分类</span><br>colnames(sce@meta.data)<br>apply(sce@meta.data[,grep(<span>"RNA_snn_res"</span>,colnames(sce@meta.data))],2,table)<br><span>#0.8</span><br></code></pre><h2 data-tool="mdnice编辑器"><span></span>(2)可视化高低分辨率的分群情况</h2><pre data-tool="mdnice编辑器"><span></span><code>p1_dim = plot_grid(ncol = 4, DimPlot(sce, reduction = <span>"tsne"</span>, group.by = <span>"RNA_snn_res.0.01"</span>) + <br>                     ggtitle(<span>"louvain_0.01"</span>), DimPlot(sce, reduction = <span>"tsne"</span>, group.by = <span>"RNA_snn_res.0.05"</span>) + <br>                     ggtitle(<span>"louvain_0.05"</span>), DimPlot(sce, reduction = <span>"tsne"</span>, group.by = <span>"RNA_snn_res.0.1"</span>) + <br>                     ggtitle(<span>"louvain_0.1"</span>), DimPlot(sce, reduction = <span>"tsne"</span>, group.by = <span>"RNA_snn_res.0.2"</span>) + <br>                     ggtitle(<span>"louvain_0.2"</span>))<br>p1_dim<br><br>p1_dim = plot_grid(ncol = 5, DimPlot(sce, reduction = <span>"tsne"</span>, group.by = <span>"RNA_snn_res.0.3"</span>) + <br>                     ggtitle(<span>"louvain_0.3"</span>),DimPlot(sce, reduction = <span>"tsne"</span>, group.by = <span>"RNA_snn_res.0.5"</span>) + <br>                     ggtitle(<span>"louvain_0.5"</span>),DimPlot(sce, reduction = <span>"tsne"</span>, group.by = <span>"RNA_snn_res.0.8"</span>) + <br>                     ggtitle(<span>"louvain_0.8"</span>), DimPlot(sce, reduction = <span>"tsne"</span>, group.by = <span>"RNA_snn_res.0.9"</span>) + <br>                     ggtitle(<span>"louvain_0.9"</span>),DimPlot(sce, reduction = <span>"tsne"</span>, group.by = <span>"RNA_snn_res.1"</span>) + <br>                     ggtitle(<span>"louvain_1"</span>))<br>p1_dim<br></code></pre><p><img data-galleryid="" data-ratio="0.3055555555555556" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibNRNTlcoGGpFicEZsicmCpmeBzb5d07ETRkPcDriahA64b0icqJGpqAhM3yDKGibcbCJjv8Jfu4I2dsZg/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibNRNTlcoGGpFicEZsicmCpmeBzb5d07ETRkPcDriahA64b0icqJGpqAhM3yDKGibcbCJjv8Jfu4I2dsZg/640?wx_fmt=png"></p><p><img data-galleryid="" data-ratio="0.21944444444444444" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibNRNTlcoGGpFicEZsicmCpmeFuUzyHEEJV96u5yegEuFxxqQia9XqKGtiaGSaDPrFibJhRIzjKthX9U1g/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibNRNTlcoGGpFicEZsicmCpmeFuUzyHEEJV96u5yegEuFxxqQia9XqKGtiaGSaDPrFibJhRIzjKthX9U1g/640?wx_fmt=png"></p><p data-tool="mdnice编辑器">##(3)聚类树</p><pre data-tool="mdnice编辑器"><span></span><code>p2_tree = clustree(sce@meta.data, prefix = <span>"RNA_snn_res."</span>)<br>p2_tree<br>ggsave(plot = p2_tree, filename=<span>"Tree_diff_resolution.pdf"</span>,width = 10,height = 11)<br></code></pre><p><img data-galleryid="" data-ratio="1.0645833333333334" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibNRNTlcoGGpFicEZsicmCpmeRfaXzCkfxydjQfM4n8ichIq1h5Q4c2xwU8IdribwClWwP03RGYicQUXCw/640?wx_fmt=png" data-type="png" data-w="480" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibNRNTlcoGGpFicEZsicmCpmeRfaXzCkfxydjQfM4n8ichIq1h5Q4c2xwU8IdribwClWwP03RGYicQUXCw/640?wx_fmt=png"></p><p data-tool="mdnice编辑器">##(4)分群</p><pre data-tool="mdnice编辑器"><span></span><code><span>#最后分群选择的resolution=0.4，细胞聚类为7群。</span><br>sce1 &lt;- FindClusters(sce, resolution = 0.4) <br>p1 &lt;- DimPlot(sce1, reduction = <span>"umap"</span>, label = TRUE, repel = TRUE)<br>p1 <br><br>p2 &lt;- DimPlot(sce1, reduction = <span>"umap"</span>, group.by = <span>"orig.ident"</span>)<br>p2<br><br><span>#也可以单独观察每个样本中细胞的聚类情况</span><br>p3=DimPlot(sce1, reduction = <span>"umap"</span>, split.by = <span>"orig.ident"</span>)<br>p3<br><br></code></pre><p><img data-galleryid="" data-ratio="0.7854454203262233" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibNRNTlcoGGpFicEZsicmCpmeUswCKf8xF3XicOG5PCqg8m0kuBM5sg5gKRUNma28nQpc4sCLdobQUiaQ/640?wx_fmt=png" data-type="png" data-w="797" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibNRNTlcoGGpFicEZsicmCpmeUswCKf8xF3XicOG5PCqg8m0kuBM5sg5gKRUNma28nQpc4sCLdobQUiaQ/640?wx_fmt=png"></p><p><img data-galleryid="" data-ratio="0.7809762202753442" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibNRNTlcoGGpFicEZsicmCpmeWwCQG9LibiaSKhOlgoUFpBW0IjZpOrNeHy11L0bSnEanSAGd3NwF0Fow/640?wx_fmt=png" data-type="png" data-w="799" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibNRNTlcoGGpFicEZsicmCpmeWwCQG9LibiaSKhOlgoUFpBW0IjZpOrNeHy11L0bSnEanSAGd3NwF0Fow/640?wx_fmt=png"></p><p><img data-galleryid="" data-ratio="0.375" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibNRNTlcoGGpFicEZsicmCpmemTTV79iavekzYmC1wIib0WxticWvkpl9ebz5FADwJhOj3VG3dFDVfyrEw/640?wx_fmt=png" data-type="png" data-w="1000" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibNRNTlcoGGpFicEZsicmCpmemTTV79iavekzYmC1wIib0WxticWvkpl9ebz5FADwJhOj3VG3dFDVfyrEw/640?wx_fmt=png"></p><p data-tool="mdnice编辑器"><strong>#提取各个细胞类型的marker gene</strong></p><pre data-tool="mdnice编辑器"><span></span><code><span>#利用 FindMarkers 命令，可以找到找到各个细胞类型中与其他类别的差异表达基因，作为该细胞类型的生物学标记基因。其中ident.1参数设置待分析的细胞类别，min.pct表示该基因表达数目占该类细胞总数的比例</span><br><span>#install.packages("metap")</span><br>library(metap)<br><span>#1_find all markers of cluster 1</span><br>cluster1.markers &lt;- FindMarkers(sce, ident.1 = 6, min.pct = 0.25)<br>head(cluster1.markers, n = 5)<br><span>#利用 DoHeatmap 命令可以可视化marker基因的表达</span><br>pbmc.markers &lt;- FindAllMarkers(sce, only.pos = TRUE, min.pct = 0.25)<br><span>#2_以cluster 6为例寻找conserved marker</span><br>DefaultAssay(sce1) &lt;- <span>"RNA"</span><br>nk.markers &lt;- FindConservedMarkers(sce1, ident.1 = 6, grouping.var = <span>"orig.ident"</span>, verbose = FALSE)<br>nk.markers <span>#对每个cluster执行上述操作，就能找出所有细胞类的conserved marker</span><br>View(nk.markers)<br>head(nk.markers, n = 9)<br><span>#对marker在不同细胞中的丰度进行可视化</span><br>p4=FeaturePlot(sce1, features = c(<span>"RPL41"</span>, <span>"RPL30"</span>, <span>"RPS15A"</span>, <span>"RPS27"</span>, <span>"RPS12"</span>, <span>"RPS28"</span>, <span>"RPLP1"</span>,<br><span>"RPLP10"</span>, <span>"RPS26"</span>), min.cutoff = <span>"q9"</span>)<br>ggsave(plot = p4, filename=<span>"FeaturePlot_conserved_marker.pdf"</span>,width = 10,height = 11)<br></code></pre><p><img data-galleryid="" data-ratio="0.6155440414507772" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibNRNTlcoGGpFicEZsicmCpmeAs1MIFgLChia6ZIhKburia0fLUcEUSqbHH6dLIqxrCrsnIMYy01syw3w/640?wx_fmt=png" data-type="png" data-w="965" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibNRNTlcoGGpFicEZsicmCpmeAs1MIFgLChia6ZIhKburia0fLUcEUSqbHH6dLIqxrCrsnIMYy01syw3w/640?wx_fmt=png"></p><p data-tool="mdnice编辑器"><strong>#探索感兴趣的基因</strong></p><pre data-tool="mdnice编辑器"><span></span><code><span>#Seurat提供了许多方法使我们能够方便的探索感兴趣的基因在各个细胞类型中的表达情况</span><br>VlnPlot(sce1, features = c(<span>"RPL41"</span>, <span>"RPL30"</span>)) <span>#这里，我们随便选了两个基因</span><br></code></pre></section><p><img data-galleryid="" data-ratio="0.5134575569358178" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibNRNTlcoGGpFicEZsicmCpme3C30loKbKfbkIM8ra4u9ficZdOgE4EZgPfibrGsztzR1rVtkiaryYTVkg/640?wx_fmt=png" data-type="png" data-w="966" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibNRNTlcoGGpFicEZsicmCpme3C30loKbKfbkIM8ra4u9ficZdOgE4EZgPfibrGsztzR1rVtkiaryYTVkg/640?wx_fmt=png"></p><h4 data-tool="mdnice编辑器">文末友情宣传</h4><p data-tool="mdnice编辑器">强烈建议你推荐给身边的<strong>博士后以及年轻生物学PI</strong>，多一点数据认知，让他们的科研上一个台阶：</p><ul data-tool="mdnice编辑器"><li><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247524930&amp;idx=5&amp;sn=19d5eb52cbba6389c6238cd7943d96c7&amp;chksm=9b4b22f9ac3cabefa5c0436a6e723c3ad447fd67bdd2f9d500043220c5e97e6934b6015977e3&amp;scene=21#wechat_redirect" textvalue="生物信息学马拉松授课（买一得‍五）" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1">生物信息学马拉松授课（买一得五）</a> ，你的生物信息学入门课</section></li><li><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247524148&amp;idx=1&amp;sn=7806da6feb41a36493c519c1cfc1d3ac&amp;chksm=9b4bdf8fac3c569960369602f1ef26639cb366b250f233b2297d1f059471c0458335bfc0b829&amp;scene=21#wechat_redirect" textvalue="时隔5年，我们的生信技能树VIP学徒继续招生啦" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1">时隔5年，我们的生信技能树VIP学徒继续招生啦</a><br></section></li><li><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247522831&amp;idx=2&amp;sn=1744efdf428465425a145ff3a982198b&amp;chksm=9b4bdab4ac3c53a28fbecbbff4f254f470b54a7a20468bb753b295b930315e1ec45bcbabc10b&amp;scene=21#wechat_redirect" textvalue="144线程640Gb内存服务器共享一年‍仍然是仅需800" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1">144线程640Gb内存服务器共享一年仍然是仅需800</a></section></li><li><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247519765&amp;idx=1&amp;sn=ce5a8c8182f854c88043059f8c2cb9ff&amp;chksm=9b4bceaeac3c47b88c19941d43dbb1401f3a92206481a0afc41159927868199643f795d62a7e&amp;scene=21#wechat_redirect" textvalue="千呼万唤始出来的独享生物信息学云服务器" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1">千呼万唤始出来的独享生物信息学云服务器</a></section></li><li><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247519765&amp;idx=1&amp;sn=ce5a8c8182f854c88043059f8c2cb9ff&amp;chksm=9b4bceaeac3c47b88c19941d43dbb1401f3a92206481a0afc41159927868199643f795d62a7e&amp;scene=21#wechat_redirect" textvalue="千呼万唤始出来的独享生物信息学云服务器" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1"></a><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247524275&amp;idx=1&amp;sn=fa592ee29f636f34387491d0fceadd8e&amp;chksm=9b4bdf08ac3c561e0881974b3817beb0a0e514dc1a8df4c34c2b6653da6fa78e09acb03c70c2&amp;scene=21#wechat_redirect" textvalue="生信技能树知识整理实习生又又又开放申请啦" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1">生信技能树知识整理实习生又又又开放申请啦</a></section></li><li><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247524432&amp;idx=1&amp;sn=5b33b0c6807a9e6939c332c58fabff89&amp;chksm=9b4b20ebac3ca9fdb3d8bfaf2bef5552f64eb70e7fae557cc7197fb1a23b3e8bc31b585bf829&amp;scene=21#wechat_redirect" textvalue="生信共享办公室出租" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1">生信共享办公室出租</a></p></li></ul><p><br></p><p><mp-style-type data-value="10000"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/svMiBgsR6xGRA-ZExdp9FQ",target="_blank" rel="noopener noreferrer">原文链接</a>
