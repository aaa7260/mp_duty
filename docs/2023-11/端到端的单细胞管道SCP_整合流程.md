---
title: "端到端的单细胞管道SCP-整合流程"
date: 2023-11-22T12:55:11Z
draft: ["false"]
tags: [
  "fetched",
  "单细胞天地"
]
categories: ["Acdemic"]
---
端到端的单细胞管道SCP-整合流程 by 单细胞天地
------
<div><section data-style-type="5" data-tools="新媒体排版" data-id="2430070"><section data-style-type="5" data-tools="新媒体排版" data-id="2390348"><section><section powered-by="xiumi.us"><section><section><section powered-by="xiumi.us"><section><section><br></section><section><section><section powered-by="xiumi.us"><section><section><p>分享是一种态度</p></section></section></section></section></section></section></section></section><section><section powered-by="xiumi.us"><section><section><img data-ratio="0.8738095238095238" data-src="https://mmbiz.qpic.cn/mmbiz_gif/siaia0BDGJdjSnnb9ibXpFagGPWQ0JjSSTNVBZthROEhicfINuLcxX2Ro3Zb600LJhrzeYIb120tLjSVXEtLn14DwA/640?wx_fmt=gif" data-type="gif" data-w="420" width="100%" data-imgfileid="100033771" src="https://mmbiz.qpic.cn/mmbiz_gif/siaia0BDGJdjSnnb9ibXpFagGPWQ0JjSSTNVBZthROEhicfINuLcxX2Ro3Zb600LJhrzeYIb120tLjSVXEtLn14DwA/640?wx_fmt=gif"></section></section></section></section></section></section></section></section></section><section><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><blockquote data-tool="mdnice编辑器"><p>举杯邀明月，对影成三人</p></blockquote><p data-tool="mdnice编辑器">本章介绍SCP中对于单细胞数据的整合流程，适用于批次效应显著的多样本或多批次数据。</p><ul data-tool="mdnice编辑器"><li><section>主要函数： Integration_SCP；</section></li><li><section>SCP版本：0.5.6；Seurat版本：v4.4.0；</section></li></ul><h1 data-tool="mdnice编辑器"><span></span><span>Integration_SCP函数</span></h1><p data-tool="mdnice编辑器"><code>Integration_SCP</code>是针对具有批次效应单细胞数据整合流程。在前处理的一般步骤上与<code>Standard_SCP</code>相同（例如数据标准化、高变异基因检测等），其余步骤根据各批次整合算法的原理和官方教程进行了规范和调整。</p><p data-tool="mdnice编辑器">整合流程共包括了一个非矫正（Uncorrected）流程，以及11个算法（Seurat，scVI，MNN，fastMNN，Harmony，Scanorama，BBKNN，CSS，LIGER，Conos，ComBat）的整合流程。</p><p data-tool="mdnice编辑器"><code>Integration_SCP</code>函数在参数上整体与<code>Standard_SCP</code>相同，具体参数说明请查阅<span>Integration_SCP函数文档</span><sup>[1]</sup>，以下为一些特殊的参数选项：</p><ol data-tool="mdnice编辑器"><li><section><p>输入可以是一个包含有批次信息的Seurat对象（<code>srtMerge</code>），也可以是一个包含了多个Seurat对象的<code>list</code>（<code>srtList</code>），两者均需要指定<code>batch</code>参数。注意当输入为<code>list</code>时，要确保<code>list</code>中的每个Seurat对象均包含有指定的<code>batch</code>信息。</p></section></li><li><section><p><code>HVF_source</code>参数：<code>HVF_source</code>可以指定HVF的来源，选项分别为<code>global</code>或<code>separete</code>。</p><p>默认值：<code>HVF_source="separate"</code> <code>HVF_min_intersection=1</code></p></section></li></ol><ul><li><section><p><code>HVF_source="global"</code>，意味着将所有批次的细胞合并在一起，进行高变基因检测，也就是说在<code>Seurat::FindVariableFeatures</code>检测HVF过程里，将使用所有批次所有细胞基因的均值和方差拟合loess模型，<span>这种方法得到的HVF一般会导致后续分析具有较大的批次效应</span>；</p></section></li><li><section><p><code>HVF_source="separate"</code>，意味着高变基因检测分别在各自批次的细胞中进行，然后使用<code>Seurat::SelectIntegrationFeatures</code>筛选用于整合的高变基因，此外还可以指定一个额外参数<code>HVF_min_intersection</code>，来进一步要求需要至少在N个批次中被检测为高变基因，N越大HVF数量越小，<span>这种方法得到的HVF一般会减小批次效应（见后续）</span>。</p></section></li></ul><li><section><p>各整合算法一般会输出矫正后的embedding、graph、feature-cellmatrix<span>至少一项</span>，同时输出多项的时候<span>按顺序优先使用</span>，其中：</p></section></li><ul><li><section>整合算法若只输出矫正后的feature-cellmatrix的话，意味着前处理没有进行线性降维，需要对矫正后矩阵进一步做线性降维，例如Seurat、MNN、ComBat等，此时<code>linear_reduction_dims_use</code>用于控制最终要使用的线性降维后向量空间的维度，默认将使用自动估计的内在维度；</section></li><li><section>矫正后的embedding理论上应当使用所有的dims（默认，一般情况下效果最好），当矫正效果不佳时也可以手动指定，例如<code>scVI_dims_use</code>、<code>fastMNN_dims_use</code>、<code>Harmony_dims_use</code>、<code>Scanorama_dims_use</code>、<code>CSS_dims_use</code>、<code>LIGER_dims_use</code>等；</section></li></ul><li><section><p>除了一般步骤可以传递额外参数外，各整合算法主要函数的参数也可以通过<code>Integration_SCP</code>进行传递：</p><section><table><thead><tr><th>整合算法</th><th>参数名称</th><th>对应函数</th></tr></thead><tbody><tr><td>Seurat</td><td>FindIntegrationAnchors_params</td><td>Seurat::FindIntegrationAnchors</td></tr><tr><td>Seurat</td><td>IntegrateData_params</td><td>Seurat::IntegrateData</td></tr><tr><td>Seurat</td><td>IntegrateEmbeddings_params</td><td>Seurat::IntegrateEmbeddings</td></tr><tr><td>scVI</td><td>SCVI_params</td><td>scvi.model.SCVI*</td></tr><tr><td>scVI</td><td>PEAKVI_params</td><td>scvi.model.PEAKVI*</td></tr><tr><td>MNN</td><td>mnnCorrect_params</td><td>batchelor::mnnCorrect</td></tr><tr><td>fastMNN</td><td>fastMNN_params</td><td>batchelor::fastMNN</td></tr><tr><td>Harmony</td><td>RunHarmony_params</td><td>harmony::RunHarmony</td></tr><tr><td>Scanorama</td><td>Scanorama_params</td><td>scanorama.correct*</td></tr><tr><td>BBKNN</td><td>bbknn_params</td><td>bbknn.matrix.bbknn*</td></tr><tr><td>CSS</td><td>CSS_params</td><td>simspec::cluster_sim_spectrum</td></tr><tr><td>LIGER</td><td>optimizeALS_params</td><td>rliger::optimizeALS</td></tr><tr><td>LIGER</td><td>quantilenorm_params</td><td>rliger::quantile_norm</td></tr><tr><td>Conos</td><td>buildGraph_params</td><td>conos::Conos</td></tr><tr><td>ComBat</td><td>ComBat_params</td><td>sva::ComBat</td></tr></tbody></table></section></section></li><p data-tool="mdnice编辑器"><em>*表示该函数为python函数</em></p><h1 data-tool="mdnice编辑器"><span></span><span>函数示例</span></h1><p data-tool="mdnice编辑器">使用下采样后的8个成人胰腺单细胞数据集为例，该数据中共含有8个样本，5种单细胞建库技术平台，通过在R中运行<code>?panc8_sub</code>来查看该示例数据相关信息。</p><pre data-tool="mdnice编辑器"><span></span><code><span>library</span>(SCP)<br><span>library</span>(Seurat)<br>data(<span>"panc8_sub"</span>)<br>panc8_sub<br><span>##&gt; An object of class Seurat </span><br><span>##&gt; 13716 features across 1600 samples within 1 assay </span><br><span>##&gt; Active assay: RNA (13716 features, 0 variable features)</span><br>head(panc8_sub[[]])<br><span>##&gt;          orig.ident nCount_RNA nFeature_RNA   tech replicate assigned_cluster</span><br><span>##&gt; D71_58          D71   9915.908         3669 celseq    celseq             &lt;NA&gt;</span><br><span>##&gt; D102_7         D102   8003.868         3300 celseq    celseq             &lt;NA&gt;</span><br><span>##&gt; D3en4_73      D3en4   6643.200         3024 celseq    celseq             &lt;NA&gt;</span><br><span>##&gt; D73_92          D73   6503.113         2901 celseq    celseq             &lt;NA&gt;</span><br><span>##&gt; D1713_56      D1713  11674.000         4156 celseq    celseq             &lt;NA&gt;</span><br><span>##&gt; D1713_19      D1713   5161.300         2150 celseq    celseq             &lt;NA&gt;</span><br><span>##&gt;          celltype dataset</span><br><span>##&gt; D71_58      alpha  celseq</span><br><span>##&gt; D102_7       beta  celseq</span><br><span>##&gt; D3en4_73   ductal  celseq</span><br><span>##&gt; D73_92       beta  celseq</span><br><span>##&gt; D1713_56   ductal  celseq</span><br><span>##&gt; D1713_19     beta  celseq</span><br>table(panc8_sub$dataset, panc8_sub$tech)<br><span>##&gt;             </span><br><span>##&gt;              celseq celseq2 fluidigmc1 indrop smartseq2</span><br><span>##&gt;   celseq        200       0          0      0         0</span><br><span>##&gt;   celseq2         0     200          0      0         0</span><br><span>##&gt;   fluidigmc1      0       0        200      0         0</span><br><span>##&gt;   indrop1         0       0          0    200         0</span><br><span>##&gt;   indrop2         0       0          0    200         0</span><br><span>##&gt;   indrop3         0       0          0    200         0</span><br><span>##&gt;   indrop4         0       0          0    200         0</span><br><span>##&gt;   smartseq2       0       0          0      0       200</span><br></code></pre><h2 data-tool="mdnice编辑器"><span></span><span>查看批次效应</span></h2><p data-tool="mdnice编辑器">我们可以用<code>Integration_SCP</code>中的Uncorrected流程观察批次效应，这里指定<code>Integration_SCP</code>中的待矫正的批次变量为<code>tech</code>：</p><pre data-tool="mdnice编辑器"><span></span><code>panc8_sub &lt;- Integration_SCP(<br>  srtMerge = panc8_sub, batch = <span>"tech"</span>,<br>  integration_method = <span>"Uncorrected"</span><br>)<br><br><span>#&gt; [2023-10-30 09:17:39] Start Uncorrected_integrate</span><br><span>#&gt; [2023-10-30 09:17:39] Spliting srtMerge into srtList by column tech... ...</span><br><span>#&gt; [2023-10-30 09:17:40] Checking srtList... ...</span><br><span>#&gt; Data 1/5 of the srtList is raw_normalized_counts. Perform NormalizeData(LogNormalize) on the data ...</span><br><span>#&gt; Perform FindVariableFeatures on the data 1/5 of the srtList...</span><br><span>#&gt; Data 2/5 of the srtList is raw_normalized_counts. Perform NormalizeData(LogNormalize) on the data ...</span><br><span>#&gt; Perform FindVariableFeatures on the data 2/5 of the srtList...</span><br><span>#&gt; Data 3/5 of the srtList is raw_normalized_counts. Perform NormalizeData(LogNormalize) on the data ...</span><br><span>#&gt; Perform FindVariableFeatures on the data 3/5 of the srtList...</span><br><span>#&gt; Data 4/5 of the srtList is raw_counts. Perform NormalizeData(LogNormalize) on the data ...</span><br><span>#&gt; Perform FindVariableFeatures on the data 4/5 of the srtList...</span><br><span>#&gt; Data 5/5 of the srtList is raw_counts. Perform NormalizeData(LogNormalize) on the data ...</span><br><span>#&gt; Perform FindVariableFeatures on the data 5/5 of the srtList...</span><br><span>#&gt; Use the separate HVF from srtList...</span><br><span>#&gt; [2023-10-30 09:17:44] Finished checking.</span><br><span>#&gt; [2023-10-30 09:17:45] Perform integration(Uncorrected) on the data...</span><br><span>#&gt; [2023-10-30 09:17:45] Start Standard_SCP</span><br><span>#&gt; [2023-10-30 09:17:45] Checking srtList... ...</span><br><span>#&gt; Data 1/1 of the srtList has been log-normalized.</span><br><span>#&gt; [2023-10-30 09:17:46] Finished checking.</span><br><span>#&gt; [2023-10-30 09:17:46] Perform ScaleData on the data...</span><br><span>#&gt; [2023-10-30 09:17:47] Perform linear dimension reduction (pca) on the data...</span><br><span>#&gt; [2023-10-30 09:17:48] Perform FindClusters (louvain) on the data...</span><br><span>#&gt; [2023-10-30 09:17:48] Reorder clusters...</span><br><span>#&gt; [2023-10-30 09:17:48] Perform nonlinear dimension reduction (umap) on the data...</span><br><span>#&gt; [2023-10-30 09:17:57] Standard_SCP done</span><br><span>#&gt; Elapsed time: 11.43 secs </span><br><span>#&gt; [2023-10-30 09:17:57] Uncorrected_integrate done</span><br><span>#&gt; Elapsed time: 17.83 secs</span><br><br>CellDimPlot(panc8_sub, group.by = c(<span>"tech"</span>, <span>"celltype"</span>))<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100033933" data-ratio="0.5" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQG4qypcDFyK3gTBFz5pmh0VVWXINuptKIfFoTNGfQHibVGPolJlXtYBFVOctSAicP3zCrqeT19kwng/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQG4qypcDFyK3gTBFz5pmh0VVWXINuptKIfFoTNGfQHibVGPolJlXtYBFVOctSAicP3zCrqeT19kwng/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器">注意在流程运行时的提示，<code>panc8_sub</code>各批次间细胞数据的处理程度是不同的，有两个数据集是原始counts（<code>raw_counts</code>），有三个数据集经过了标准化但是没有经过log转换（<code>raw_normalized_counts</code>，比如fpkm，tpm之类的数据），所以在前处理中均进行了<code>NormalizeData(LogNormalize)</code>操作，在之后的示例中该操作将不再进行。</p><p data-tool="mdnice编辑器">结果中批次效应比较明显：各细胞类型均被<code>tech</code>所分割。使用”global”HVF或者Standard_SCP能观察到更大的批次效应，这两者的结果其实是一致的：</p><pre data-tool="mdnice编辑器"><span></span><code>panc8_sub &lt;- Integration_SCP(<br>  srtMerge = panc8_sub, batch = <span>"tech"</span>,<br>  integration_method = <span>"Uncorrected"</span>,<br>  HVF_source = <span>"global"</span><br>)<br><br><br>p1 &lt;- CellDimPlot(panc8_sub, group.by = c(<span>"tech"</span>, <span>"celltype"</span>))<br>panc8_sub &lt;- Standard_SCP(panc8_sub)<br><br><br>p2 &lt;- CellDimPlot(panc8_sub, group.by = c(<span>"tech"</span>, <span>"celltype"</span>))<br>p1 / p2<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100033937" data-ratio="0.8" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQG4qypcDFyK3gTBFz5pmh0dVVcC0qWibLuXshKQurXNKk3WOlibrLPCM4t1JicL6BUGu13OpRKg5Fbg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQG4qypcDFyK3gTBFz5pmh0dVVcC0qWibLuXshKQurXNKk3WOlibrLPCM4t1JicL6BUGu13OpRKg5Fbg/640?wx_fmt=png&amp;from=appmsg"></figure><h2 data-tool="mdnice编辑器"><span></span><span>使用整合算法去除批次效应</span></h2><p data-tool="mdnice编辑器">整合算法的调用只需要在<code>Integration_SCP</code>中指定<code>integration_method</code>参数：</p><pre data-tool="mdnice编辑器"><span></span><code>panc8_sub &lt;- Integration_SCP(<br>  srtMerge = panc8_sub, batch = <span>"tech"</span>,<br>  integration_method = <span>"Seurat"</span><br>)<br><br><br><br>CellDimPlot(panc8_sub, group.by = c(<span>"tech"</span>, <span>"celltype"</span>))<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100033934" data-ratio="0.5" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQG4qypcDFyK3gTBFz5pmh0N4K5f1MF4ylDqBFC2Lyn9XeOSRfD6dCryDpYrJAoibib0ZgU2D81ics9A/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQG4qypcDFyK3gTBFz5pmh0N4K5f1MF4ylDqBFC2Lyn9XeOSRfD6dCryDpYrJAoibib0ZgU2D81ics9A/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器">结果中的批次效应被矫正了：相同细胞类型成群，细胞群之间的区分也比较明显。返回的Seurat对象新增的graphs、reductions、clusters等名称前缀均为所使用的整合算法：</p><pre data-tool="mdnice编辑器"><span></span><code>Graphs(panc8_sub)<br><span>##&gt; [1] "Uncorrectedpca_KNN" "Uncorrectedpca_SNN" "Standardpca_KNN"   </span><br><span>##&gt; [4] "Standardpca_SNN"    "Seurat_KNN"         "Seurat_SNN"</span><br>Reductions(panc8_sub)<br><span>##&gt;  [1] "Uncorrectedpca"    "UncorrectedUMAP2D" "UncorrectedUMAP3D"</span><br><span>##&gt;  [4] "Standardpca"       "StandardpcaUMAP2D" "StandardpcaUMAP3D"</span><br><span>##&gt;  [7] "StandardUMAP2D"    "StandardUMAP3D"    "Seuratpca"        </span><br><span>##&gt; [10] "SeuratUMAP2D"      "SeuratUMAP3D"</span><br>colnames(panc8_sub@meta.data)<br><span>##&gt;  [1] "orig.ident"                 "tech"                      </span><br><span>##&gt;  [3] "replicate"                  "assigned_cluster"          </span><br><span>##&gt;  [5] "celltype"                   "dataset"                   </span><br><span>##&gt;  [7] "Uncorrectedpca_SNN_res.0.6" "Uncorrectedclusters"       </span><br><span>##&gt;  [9] "Standardpca_SNN_res.0.6"    "ident"                     </span><br><span>##&gt; [11] "Standardpcaclusters"        "Standardclusters"          </span><br><span>##&gt; [13] "nCount_RNA"                 "nFeature_RNA"              </span><br><span>##&gt; [15] "Seurat_SNN_res.0.6"         "Seuratclusters"</span><br></code></pre><p data-tool="mdnice编辑器">对于一些整合流程而言（例如Seurat），可以尝试指定不同数量的HVF和dims：</p><pre data-tool="mdnice编辑器"><span></span><code>panc8_sub &lt;- Integration_SCP(<br>  srtMerge = panc8_sub, batch = <span>"tech"</span>,<br>  integration_method = <span>"Seurat"</span>,<br>  nHVF = <span>3000</span>, linear_reduction_dims_use = <span>1</span>:<span>50</span><br>)<br><br><br>CellDimPlot(panc8_sub, group.by = c(<span>"tech"</span>, <span>"celltype"</span>))<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100033935" data-ratio="0.5" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQG4qypcDFyK3gTBFz5pmh0gGwjibomJRfCvfNQT1ptndngmaNUe1A5ML4ibUWBwkI6EpoWOLjxM2Fg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQG4qypcDFyK3gTBFz5pmh0gGwjibomJRfCvfNQT1ptndngmaNUe1A5ML4ibUWBwkI6EpoWOLjxM2Fg/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器">也可以通过传入额外参数来控制整合过程，例如使用Seurat的<span>rpca整合流程</span><sup>[2]</sup>:</p><pre data-tool="mdnice编辑器"><span></span><code>panc8_sub &lt;- Integration_SCP(<br>  srtMerge = panc8_sub, batch = <span>"tech"</span>,<br>  integration_method = <span>"Seurat"</span>,<br>  FindIntegrationAnchors_params = list(reduction = <span>"rpca"</span>)<br>)<br><br>CellDimPlot(panc8_sub, group.by = c(<span>"tech"</span>, <span>"celltype"</span>))<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100033936" data-ratio="0.5" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQG4qypcDFyK3gTBFz5pmh0jlrSMnribhpoOq9vibWWtseNEqpV05IfemF5YUQp29Dbic6J9eXmWqU0w/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQG4qypcDFyK3gTBFz5pmh0jlrSMnribhpoOq9vibWWtseNEqpV05IfemF5YUQp29Dbic6J9eXmWqU0w/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器">我们可以比较不同整合算法下的表现，这里为了保证可比性，对于所有在整合前或整合后使用线性降维的算法，统一使用前50个维度进行后续的非线性降维和聚类：</p><pre data-tool="mdnice编辑器"><span></span><code>integration_methods &lt;- c(<br>  <span>"Uncorrected"</span>, <span>"Seurat"</span>, <span>"scVI"</span>, <span>"MNN"</span>, <span>"fastMNN"</span>, <span>"Harmony"</span>,<br>  <span>"Scanorama"</span>, <span>"BBKNN"</span>, <span>"CSS"</span>, <span>"LIGER"</span>, <span>"Conos"</span>, <span>"ComBat"</span><br>)<br>plist1 &lt;- list()<br><span>for</span> (method <span>in</span> integration_methods) {<br>  panc8_sub &lt;- Integration_SCP(<br>    srtMerge = panc8_sub, batch = <span>"tech"</span>,<br>    integration_method = method,<br>    linear_reduction_dims_use = <span>1</span>:<span>50</span>,<br>    nonlinear_reduction = <span>"umap"</span><br>  )<br>  plist1[[method]] &lt;- CellDimPlot(panc8_sub,<br>    group.by = <span>"celltype"</span>,<br>    reduction = paste0(method, <span>"UMAP2D"</span>),<br>    xlab = <span>""</span>, ylab = <span>""</span>, title = method,<br>    legend.position = <span>"none"</span>, theme_use = <span>"theme_blank"</span><br>  )<br>}<br><br><br>patchwork::wrap_plots(plotlist = plist1)<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100033942" data-ratio="1" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQG4qypcDFyK3gTBFz5pmh0A1LnkehbulKV4gficCNpwqKxZib6XI9DAiboBphPSKRGqdeRpLcQVD09Q/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQG4qypcDFyK3gTBFz5pmh0A1LnkehbulKV4gficCNpwqKxZib6XI9DAiboBphPSKRGqdeRpLcQVD09Q/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器">与<code>Standard_SCP</code>略有不同的是，<code>Integration_SCP</code>单次只能使用一种线性降维方法以及多种非线性降维方法，以Seurat整合流程为例：</p><pre data-tool="mdnice编辑器"><span></span><code>panc8_sub &lt;- Integration_SCP(<br>  srtMerge = panc8_sub, batch = <span>"tech"</span>,<br>  integration_method = <span>"Seurat"</span>,<br>  linear_reduction_dims_use = <span>1</span>:<span>50</span>,<br>  nonlinear_reduction = c(<span>"umap"</span>, <span>"tsne"</span>, <span>"dm"</span>, <span>"phate"</span>, <span>"pacmap"</span>, <span>"trimap"</span>, <span>"largevis"</span>, <span>"fr"</span>)<br>)<br><br><br><br>plist2 &lt;- lapply(c(<span>"umap"</span>, <span>"tsne"</span>, <span>"dm"</span>, <span>"phate"</span>, <span>"pacmap"</span>, <span>"trimap"</span>, <span>"largevis"</span>, <span>"fr"</span>), <span>function</span>(nr) {<br>  CellDimPlot(panc8_sub,<br>    group.by = <span>"celltype"</span>,<br>    reduction = paste0(<span>"Seurat"</span>, nr, <span>"2D"</span>),<br>    xlab = <span>""</span>, ylab = <span>""</span>, title = nr,<br>    legend.position = <span>"none"</span>,<br>    theme_use = <span>"theme_blank"</span><br>  )<br>})<br>patchwork::wrap_plots(plotlist = plist2)<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100033940" data-ratio="0.8" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQG4qypcDFyK3gTBFz5pmh02EicH7bd4O6PGEw0gw2l8ibCfSKpAIAdHJExUMZMYiacRWl0Q0iaYbxpxw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQG4qypcDFyK3gTBFz5pmh02EicH7bd4O6PGEw0gw2l8ibCfSKpAIAdHJExUMZMYiacRWl0Q0iaYbxpxw/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器">另外注意，BBKNN和Conos流程的整合输出均为graph，所以非线性降维方法只能使用<code>umap</code>或者<code>fr</code>，例如：</p><pre data-tool="mdnice编辑器"><span></span><code>panc8_sub &lt;- Integration_SCP(<br>  srtMerge = panc8_sub, batch = <span>"tech"</span>,<br>  integration_method = <span>"BBKNN"</span>,<br>  linear_reduction_dims_use = <span>1</span>:<span>50</span>,<br>  nonlinear_reduction = c(<span>"umap"</span>, <span>"fr"</span>)<br>)<br><br><br><br>plist3 &lt;- lapply(c(<span>"umap"</span>, <span>"fr"</span>), <span>function</span>(nr) {<br>  CellDimPlot(panc8_sub,<br>    group.by = <span>"celltype"</span>,<br>    reduction = paste0(<span>"BBKNN"</span>, nr, <span>"2D"</span>),<br>    xlab = <span>""</span>, ylab = <span>""</span>, title = nr,<br>    legend.position = <span>"none"</span>,<br>    theme_use = <span>"theme_blank"</span><br>  )<br>})<br>patchwork::wrap_plots(plotlist = plist3)<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100033939" data-ratio="0.3" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQG4qypcDFyK3gTBFz5pmh0W6zfxeMVCFy3sI6iak6g9Uwp28LWUpiboaWvHZmJaj5y5DUo6llfibN6Q/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQG4qypcDFyK3gTBFz5pmh0W6zfxeMVCFy3sI6iak6g9Uwp28LWUpiboaWvHZmJaj5y5DUo6llfibN6Q/640?wx_fmt=png&amp;from=appmsg"></figure><h2 data-tool="mdnice编辑器"><span></span><span>合理地选择HVF可以减小批次效应</span></h2><p data-tool="mdnice编辑器">之前提到使用 HVF_source="separate" 结合<code>HVF_min_intersection</code>来检测HVF，用于下游分析时会减小批次效应。这里我们使用Uncorrected流程来说明<code>HVF_min_intersection</code>参数对结果的影响。因为数据包含了5种单细胞建库技术平台，<code>HVF_min_intersection</code>最小为1，最大为5：</p><pre data-tool="mdnice编辑器"><span></span><code>plist4 &lt;- list()<br><span>for</span> (i <span>in</span> <span>1</span>:<span>5</span>) {<br>  panc8_sub &lt;- Integration_SCP(<br>    srtMerge = panc8_sub, batch = <span>"tech"</span>,<br>    integration_method = <span>"Uncorrected"</span>,<br>    HVF_min_intersection = i<br>  )<br>  plist4[[i]] &lt;- CellDimPlot(panc8_sub,<br>    group.by = <span>"celltype"</span>,<br>    reduction = <span>"UncorrectedUMAP2D"</span>,<br>    xlab = <span>""</span>, ylab = <span>""</span>,<br>    title = paste0(<span>"HVF_min_intersection="</span>, i),<br>    legend.position = <span>"none"</span>,<br>    theme_use = <span>"theme_blank"</span><br>  )<br>}<br><br><br>patchwork::wrap_plots(plotlist = plist4)<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100033938" data-ratio="0.6" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQG4qypcDFyK3gTBFz5pmh0c8clSb8e0WjUxoLZJBeQXXULXQJQC5NjiaVFwE6sMVBDmuUEyMibwKiaw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQG4qypcDFyK3gTBFz5pmh0c8clSb8e0WjUxoLZJBeQXXULXQJQC5NjiaVFwE6sMVBDmuUEyMibwKiaw/640?wx_fmt=png&amp;from=appmsg"></figure><pre data-tool="mdnice编辑器"><span></span><code>panc8_sub &lt;- Integration_SCP(<br>  srtMerge = panc8_sub, batch = <span>"tech"</span>,<br>  integration_method = <span>"Uncorrected"</span>,<br>  HVF_min_intersection = 5,<br>  scale_within_batch = TRUE<br>)<br><span>#&gt; [2023-11-21 16:45:52] Start Uncorrected_integrate</span><br><span>#&gt; [2023-11-21 16:45:53] Spliting srtMerge into srtList by column tech... ...</span><br><span>#&gt; [2023-11-21 16:46:37] Checking srtList... ...</span><br><span>#&gt; Data 1/5 of the srtList has been log-normalized.</span><br><span>#&gt; Perform FindVariableFeatures on the data 1/5 of the srtList...</span><br><span>#&gt; Data 2/5 of the srtList has been log-normalized.</span><br><span>#&gt; Perform FindVariableFeatures on the data 2/5 of the srtList...</span><br><span>#&gt; Data 3/5 of the srtList has been log-normalized.</span><br><span>#&gt; Perform FindVariableFeatures on the data 3/5 of the srtList...</span><br><span>#&gt; Data 4/5 of the srtList has been log-normalized.</span><br><span>#&gt; Perform FindVariableFeatures on the data 4/5 of the srtList...</span><br><span>#&gt; Data 5/5 of the srtList has been log-normalized.</span><br><span>#&gt; Perform FindVariableFeatures on the data 5/5 of the srtList...</span><br><span>#&gt; Use the separate HVF from srtList...</span><br><span>#&gt; [2023-11-21 16:46:43] Finished checking.</span><br><span>#&gt; [2023-11-21 16:46:49] Perform integration(Uncorrected) on the data...</span><br><span>#&gt; [2023-11-21 16:46:49] Perform ScaleData on the data...</span><br><span>#&gt; [2023-11-21 16:46:50] Perform linear dimension reduction (pca) on the data...</span><br><span>#&gt; [2023-11-21 16:46:51] Perform FindClusters (louvain) on the data...</span><br><span>#&gt; [2023-11-21 16:46:51] Reorder clusters...</span><br><span>#&gt; [2023-11-21 16:46:52] Perform nonlinear dimension reduction (umap) on the data...</span><br><span>#&gt; [2023-11-21 16:47:04] Uncorrected_integrate done</span><br><span>#&gt; Elapsed time: 1.19 mins</span><br><br>CellDimPlot(panc8_sub,<br>  group.by = c(<span>"tech"</span>, <span>"celltype"</span>),<br>  title = <span>"scale_within_batch"</span><br>)<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100033941" data-ratio="0.5" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQG4qypcDFyK3gTBFz5pmh07nzicicChBXnw8CbdypClrO5D8icVEnKn3Lyy0UHM5via6RjwbEvdzaNKA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQG4qypcDFyK3gTBFz5pmh07nzicicChBXnw8CbdypClrO5D8icVEnKn3Lyy0UHM5via6RjwbEvdzaNKA/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器">图上可以看出，随着<code>HVF_min_intersection</code>升高，批次效应逐渐减小，<code>HVF_min_intersection=5</code>时批次效应几乎消除，如果再结合批次内的scale策略，此时结果已经媲美整合算法。</p><h3 data-tool="mdnice编辑器"><span></span><span>为什么不用整合算法，仅仅选择一部分HVF就可以达到这种效果？</span><span></span></h3><p data-tool="mdnice编辑器">实际上，一个数据集中的HVF反应的是整个数据集内的，也就是该数据集所有的<span>细胞和细胞之间差异较大的基因（稳定方差后依然高于预期方差的基因）</span>，这些HVF可以用来表征、衡量和代表这个数据集。</p><h3 data-tool="mdnice编辑器"><span></span><span>什么样的基因在细胞之间变异较大？</span><span></span></h3><ul data-tool="mdnice编辑器"><li><section><span>细胞类型的主要marker</span>，或者是<span>细胞状态的marker</span>（例如反应分化程度、细胞周期等相关的基因，表达较稳定）；</section></li><li><section><span>随机的，或是具有较大变异的、但无关紧要的噪声基因</span>（可能是由于生物因素导致、也可能是细胞建库测序技术或其他批次因素导致的表达波动）等等。</section></li></ul><p data-tool="mdnice编辑器">对于每个数据集来讲，所检测到的HVF组成并不相同，尤其是在批次效应较大数据集之间。可以预期的是，<span>大概率上，各批次中的噪声基因是不同的，但是细胞状态或细胞类型的组成有重叠甚至完全相同</span>。</p><p data-tool="mdnice编辑器">因此，<span>当使用所有数据集HVF的交集时，保留下的基因大部分也就是各细胞类型、反应细胞主要特征的marker了，这些marker在各批次中的表达特异性是保守的（比如基因GCG在任何批次中均在Alpha细胞中最高表达）</span>，借助它们从而达到去除噪声、去除批次效应的效果。</p><p data-tool="mdnice编辑器">进一步思考，如果先单独分析各数据集间的细胞类型，鉴定出批次之间保守的各细胞类型marker，用这些基因进行整合应该也可以达到去批次效应的目的。这种方式相对于全局的无监督整合方法而言，更加依赖于每个数据集内部的标注，所以是一种<span>半监督整合（semi-supervisedintegration）</span>。</p><h3 data-tool="mdnice编辑器"><span></span><span>那么简单地测试一下？</span><span></span></h3><p data-tool="mdnice编辑器">由于<code>panc8_sub</code>已经包含有细胞类型的信息，我们跳过单独分析的步骤，直接使用<code>RunDEtest</code>来检测介于各批次间的细胞类型保守marker（<code>markers_type = "conserved"</code>），然后筛选出变异较大的marker作为候选HVF（<code>p_val_adj &lt; 0.05 &amp; avg_log2FC &gt; 3</code>）。<code>RunDEtest</code>可以系统鉴定差异基因、保守基因或者扰动基因等，在后续章节中将会详细说明该函数。</p><pre data-tool="mdnice编辑器"><span></span><code>panc8_sub &lt;- RunDEtest(panc8_sub, group_by = <span>"celltype"</span>, grouping.var = <span>"tech"</span>, markers_type = <span>"conserved"</span>)<br><br><br>conserved &lt;- dplyr::filter(panc8_sub@tools$DEtest_celltype$ConservedMarkers_wilcox, p_val_adj &lt; <span>0.05</span> &amp; avg_log2FC &gt; <span>3</span>)<br>ht &lt;- GroupHeatmap(panc8_sub,<br>  slot = <span>"data"</span>,<br>  features = conserved$gene, feature_split = conserved$group1,<br>  group.by = <span>"tech"</span>, split.by = <span>"celltype"</span>, within_groups = <span>TRUE</span><br>)<br>ht$plot<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100033946" data-ratio="0.5" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQG4qypcDFyK3gTBFz5pmh0OYGL0KttAyBFN8cusRmAiaykkQFTUIQBEe3l7YMggkyErFUyAZLmt9A/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQG4qypcDFyK3gTBFz5pmh0OYGL0KttAyBFN8cusRmAiaykkQFTUIQBEe3l7YMggkyErFUyAZLmt9A/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器">使用这些批次间保守的细胞类型marker作为HVF，进行Uncorrected整合：</p><pre data-tool="mdnice编辑器"><span></span><code>panc8_sub &lt;- Integration_SCP(<br>  srtMerge = panc8_sub, batch = <span>"tech"</span>,<br>  integration_method = <span>"Uncorrected"</span>,<br>  HVF = conserved$gene<br>)<br><br><br>CellDimPlot(panc8_sub, group.by = c(<span>"tech"</span>, <span>"celltype"</span>))<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100033947" data-ratio="0.5" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQG4qypcDFyK3gTBFz5pmh0DnCCEZDgDxfR3Un0HgGV95iaulAnTyUpBuzbb8QgMPucfYkre0zDDicA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQG4qypcDFyK3gTBFz5pmh0DnCCEZDgDxfR3Un0HgGV95iaulAnTyUpBuzbb8QgMPucfYkre0zDDicA/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器">可以看见，使用了974个批次间保守的细胞类型marker，也可以消除批次效应，达到相同细胞类型被聚在一起的效果。</p><h3 data-tool="mdnice编辑器"><span></span><span>简化到极致呢？</span><span></span></h3><p data-tool="mdnice编辑器">选择更少、表达更特异的marker作为HVF，应当也可以达到整合的效果。</p><p data-tool="mdnice编辑器">这里我们为各组选择top3的marker，实际情况中还可以手动为每种细胞类型指定特异的marker：</p><pre data-tool="mdnice编辑器"><span></span><code>top &lt;- conserved %&gt;%<br>  dplyr::group_by(group1) %&gt;%<br>  dplyr::top_n(3, avg_log2FC)<br>table(top<span>$group1</span>)<br><span>#&gt; </span><br><span>#&gt;              alpha               beta             ductal             acinar </span><br><span>#&gt;                  3                  3                  3                  3 </span><br><span>#&gt; activated_stellate              gamma              delta            epsilon </span><br><span>#&gt;                  3                  3                  3                  0 </span><br><span>#&gt;               mast        endothelial         macrophage quiescent_stellate </span><br><span>#&gt;                  0                  3                  3                  3 </span><br><span>#&gt;            schwann </span><br><span>#&gt;                  3</span><br><br>panc8_sub &lt;- Integration_SCP(<br>  srtMerge = panc8_sub, batch = <span>"tech"</span>,<br>  integration_method = <span>"Uncorrected"</span>,<br>  HVF = top<span>$gene</span>,<br>  scale_within_batch = TRUE<br>)<br><span>#&gt; [2023-11-21 16:48:36] Start Uncorrected_integrate</span><br><span>#&gt; [2023-11-21 16:48:36] Spliting srtMerge into srtList by column tech... ...</span><br><span>#&gt; [2023-11-21 16:49:19] Checking srtList... ...</span><br><span>#&gt; Data 1/5 of the srtList has been log-normalized.</span><br><span>#&gt; Data 2/5 of the srtList has been log-normalized.</span><br><span>#&gt; Data 3/5 of the srtList has been log-normalized.</span><br><span>#&gt; Data 4/5 of the srtList has been log-normalized.</span><br><span>#&gt; Data 5/5 of the srtList has been log-normalized.</span><br><span>#&gt; [2023-11-21 16:49:20] Finished checking.</span><br><span>#&gt; [2023-11-21 16:49:25] Perform integration(Uncorrected) on the data...</span><br><span>#&gt; [2023-11-21 16:49:25] Perform ScaleData on the data...</span><br><span>#&gt; [2023-11-21 16:49:25] Perform linear dimension reduction (pca) on the data...</span><br><span>#&gt; [2023-11-21 16:49:29] Perform FindClusters (louvain) on the data...</span><br><span>#&gt; [2023-11-21 16:49:29] Reorder clusters...</span><br><span>#&gt; [2023-11-21 16:49:30] Perform nonlinear dimension reduction (umap) on the data...</span><br><span>#&gt; [2023-11-21 16:49:42] Uncorrected_integrate done</span><br><span>#&gt; Elapsed time: 1.1 mins</span><br>CellDimPlot(panc8_sub, group.by = c(<span>"tech"</span>, <span>"celltype"</span>))<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100033944" data-ratio="0.5" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQG4qypcDFyK3gTBFz5pmh0Mtx7NtYBx302MREHbmGlpoFTKVk1NFC3R2UuUJiaLJ79ewgFfxYialLA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQG4qypcDFyK3gTBFz5pmh0Mtx7NtYBx302MREHbmGlpoFTKVk1NFC3R2UuUJiaLJ79ewgFfxYialLA/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器">实际上，因为使用HVF数量很少，已经不需要线性降维这一步骤了，直接使用这些HVF运行UMAP即可：</p><pre data-tool="mdnice编辑器"><span></span><code>panc8_sub %&gt;%<br>  RunUMAP(features = top<span>$gene</span>) %&gt;%<br>  CellDimPlot(group.by = c(<span>"tech"</span>, <span>"celltype"</span>), reduction = <span>"umap"</span>)<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100033945" data-ratio="0.5" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQG4qypcDFyK3gTBFz5pmh0ojP9iaQOUNn8ARLypnfYWzpybjVQIVo7uKMoCfJKMiblUqsT0b8tPLzg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQG4qypcDFyK3gTBFz5pmh0ojP9iaQOUNn8ARLypnfYWzpybjVQIVo7uKMoCfJKMiblUqsT0b8tPLzg/640?wx_fmt=png&amp;from=appmsg"></figure><h1 data-tool="mdnice编辑器"><span></span><span>总结</span></h1><p data-tool="mdnice编辑器">单细胞数据中所存在的批次效应，反应出的是一些特征（基因）在批次间的表达波动。这类波动主要来源于各类非生物学因素，在分析中会造成许多干扰：</p><ul data-tool="mdnice编辑器"><li><section><p>一方面，这些基因的波动会直接影响数据间的比较，需要借助整合算法来排除它们对于细胞邻近关系的干扰；</p></section></li><li><section><p>另一方面，在个别数据集中由这类基因所产生的结论是无法轻易外推的，因为它们极有可能是某些批次因素产生的不可重复的结果。</p></section></li></ul><p data-tool="mdnice编辑器">因此，批次效应相关的基因可以视为噪声，在数据集间的整合、比较或映射时需要排除其干扰，在其他下游分析中也需谨慎对待；</p><p data-tool="mdnice编辑器">单细胞数据整合的目标是在相同类型或状态的细胞之间建立邻近关系，另外对于细胞谱系分化的数据集而言，例如胚胎发生或者精子发生过程，还需要进一步连接不同分化状态的细胞，从而保持细胞分群和分化路径在数据集间的一致性。</p><p data-tool="mdnice编辑器">要实现这种统一，也就是要排除批次效应的影响，除了使用整合算法，<span>最简单、最朴素的思想是利用一些关键的、批次间保守的特征（基因）来进行整合，正如我们所常做的，在整合后利用marker来确定各群细胞的细胞类型那样</span>。本章节最后的例子也可以看出，仅使用几十个基因，便足以用一般的单细胞流程实现批次间的整合。</p><hr data-tool="mdnice编辑器"><h3 data-tool="mdnice编辑器"><span>参考资料</span></h3><section data-tool="mdnice编辑器"><span><span>[1] </span><p>Integration_SCP函数文档: <em>https://zhanghao-njmu.github.io/SCP/reference/Integration_SCP.html</em></p></span><span><span>[2] </span><p>rpca整合流程: <em>https://satijalab.org/seurat/articles/integration_rpca</em></p></span></section></section><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><br></section><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><br></section><section data-style-type="5" data-tools="新媒体排版" data-id="2440476"><section><section><section><section><img data-imgfileid="100033767" data-ratio="0.9495798319327731" data-src="https://mmbiz.qpic.cn/mmbiz_gif/09gp6SvPE04j3m2v7Hr889icHUyibTOHs8YuUibicl7ibRD0ZwG5pDTjBluRreZvuib1o3BibvLkicYhnA4YW7dQsjn0cA/640?wx_fmt=gif" data-type="gif" data-w="119" data-width="100%" src="https://mmbiz.qpic.cn/mmbiz_gif/09gp6SvPE04j3m2v7Hr889icHUyibTOHs8YuUibicl7ibRD0ZwG5pDTjBluRreZvuib1o3BibvLkicYhnA4YW7dQsjn0cA/640?wx_fmt=gif"></section><section data-brushtype="text">往期回顾</section><section><br></section></section></section></section><section><section data-autoskip="1"><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247516911&amp;idx=1&amp;sn=94259ac2862e09c10cc3a7e71d241a85&amp;chksm=ea1c846ddd6b0d7b507c0f18f3219e6c65e81019c77972354a4310a7180345193e85902356e0&amp;scene=21#wechat_redirect" textvalue="端到端的单细胞管道SCP-细胞质控" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2"><span>端到端的单细胞管道SCP-细胞质控</span></a></p><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247516824&amp;idx=1&amp;sn=86f24a931da03ccb5b5e60fc016bfc5c&amp;chksm=ea1c841add6b0d0c56b29df0031264a484f9f00feb5910438db2b5e2f5c7ef01a32eafbd0206&amp;scene=21#wechat_redirect" textvalue="端到端的单细胞管道SCP-标准流程" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2"><span>端到端的单细胞管道SCP-标准流程</span></a></p><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247516309&amp;idx=1&amp;sn=7fd2a66dac92f22feab668c632f8b650&amp;chksm=ea1c8617dd6b0f014d8c5904ef1b18e5ea467503545a5c319e45c0e5e9728e8b809c6e9741cb&amp;scene=21#wechat_redirect" textvalue="端到端的单细胞管道SCP-快速开始" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2"><span>端到端的单细胞管道SCP-快速开始</span></a></p><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247516039&amp;idx=1&amp;sn=9a706da8bacc5801eae7a03b4ccc5c36&amp;chksm=ea1cb905dd6b3013a30c140a8c919b53cb61ce502b335700dbf17e91f09a70b845379255f99c&amp;scene=21#wechat_redirect" textvalue="端到端的单细胞管道SCP-安装" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2"><span>端到端的单细胞管道SCP-安装</span></a></p><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247516307&amp;idx=1&amp;sn=f5239a1179f17fe5477200e6127e8bab&amp;chksm=ea1c8611dd6b0f07954ac24b18dad02e56f096d7b49f5c3d829cb4e6395b763f78e8ebd3e808&amp;scene=21#wechat_redirect" textvalue="SCP—为单细胞分析设计的端到端解决方案" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2"><span>SCP—为单细胞分析设计的端到端解决方案</span></a></p></section></section><hr><p><br></p></section><section data-style-type="5" data-tools="新媒体排版" data-id="2440475"><hr><p><br></p><hr><section><p>如果你对单细胞转录组研究感兴趣，但又不知道如何入门，也许你可以关注一下下面的课程<span></span></p><p><br></p><ul><li><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247526014&amp;idx=1&amp;sn=44afb387fc49b89276386e5182db7bc9&amp;chksm=9b4b26c5ac3cafd35616b2fe9df7fea664e59d75e9970feb322a477beb222ac023f7daebb3dc&amp;scene=21#wechat_redirect" textvalue="生信入门&amp;数据挖掘线上直播课11月班" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1">生信入门&amp;数据挖掘线上直播课11月班</a><br></p></li><li><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247524148&amp;idx=1&amp;sn=7806da6feb41a36493c519c1cfc1d3ac&amp;chksm=9b4bdf8fac3c569960369602f1ef26639cb366b250f233b2297d1f059471c0458335bfc0b829&amp;scene=21#wechat_redirect" textvalue="时隔5年，我们的生信技能树VIP学徒继续招生啦" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1">时隔5年，我们的生信技能树VIP学徒继续招生啦</a><br></p></li><li><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247525661&amp;idx=2&amp;sn=a0662fa3a9ebc7c840d45049eaca2c8c&amp;chksm=9b4b25a6ac3cacb0e9ba90eeb97452a9ee4eaed6bbbab1133f7a4836631047451c0cf295c93b&amp;scene=21#wechat_redirect" textvalue="搭配GPU服务再升级—256线程2Tb内存服务器共享一年仍然是仅需800" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1">搭配GPU服务再升级—256线程2Tb内存服务器共享一年仍然是仅需800</a></p></li></ul><p><img data-imgfileid="100033769" data-ratio="1" data-src="https://mmbiz.qpic.cn/mmbiz_gif/4TKeL1ZejtlKxOib5kmKX6ic6eX0w0WK5jvhtz9yBRsO3OI4yr6S5iaLNM7AbAeuPDHXMvDdur2DRz9wyiax4lEviag/640?wx_fmt=gif" data-type="gif" data-w="240" src="https://mmbiz.qpic.cn/mmbiz_gif/4TKeL1ZejtlKxOib5kmKX6ic6eX0w0WK5jvhtz9yBRsO3OI4yr6S5iaLNM7AbAeuPDHXMvDdur2DRz9wyiax4lEviag/640?wx_fmt=gif"><br></p><p><img data-imgfileid="100033770" data-ratio="0.05278592375366569" data-src="https://mmbiz.qpic.cn/mmbiz/4TKeL1Zejtlq03ZOSZiaTlic1MxgdKiaxTbOZ7ZSe0Xx1Ca8xF3L6Nyj1FYUajtYrSmRIHyZVSsAve0EAvEicZONpg/640?wx_fmt=jpeg" data-type="other" data-w="341" src="https://mmbiz.qpic.cn/mmbiz/4TKeL1Zejtlq03ZOSZiaTlic1MxgdKiaxTbOZ7ZSe0Xx1Ca8xF3L6Nyj1FYUajtYrSmRIHyZVSsAve0EAvEicZONpg/640?wx_fmt=jpeg"></p><p><strong><span>看完记得顺手点个</span></strong><span><strong><span>“在看”</span></strong></span><strong><span>哦！</span></strong></p></section><section><section data-id="93668"><section><section data-width="95%"><section><section><section data-width="38%"><section><section data-tools="135编辑器" data-id="93668"><section><section data-width="95%"><section><section><section data-width="61.8%"><section><section><section><p><br></p><span><strong data-burshtype="text"><img data-copyright="0" data-cropselx1="0" data-cropselx2="109" data-cropsely1="0" data-cropsely2="109" data-imgfileid="100033768" data-ratio="1" data-src="https://mmbiz.qpic.cn/mmbiz/siaia0BDGJdjRMGrkqo64BGKecYk4akuHpGHVQs7FeOpY7eWbIPGC1tRw5Tw0oEPmx053mR9FTVerWvhuZchIpZw/640?wx_fmt=jpeg" data-type="other" data-w="258" title="qrcode_for_gh_5a3c482ed99f_1280.jpg" src="https://mmbiz.qpic.cn/mmbiz/siaia0BDGJdjRMGrkqo64BGKecYk4akuHpGHVQs7FeOpY7eWbIPGC1tRw5Tw0oEPmx053mR9FTVerWvhuZchIpZw/640?wx_fmt=jpeg"><strong data-burshtype="text">生物</strong><strong data-burshtype="text"> | 单细胞 | 转录组丨资料</strong></strong></span></section><section><span><strong data-burshtype="text">每天都精彩</strong></span></section></section></section><section><section><section><section><section><section><p><span>长按扫码可关注</span></p></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/mQCAEHyq4R46KFKtn6SPDA",target="_blank" rel="noopener noreferrer">原文链接</a>
