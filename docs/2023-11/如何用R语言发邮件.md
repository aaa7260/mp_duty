---
title: "如何用R语言发邮件"
date: 2023-11-16T01:14:22Z
draft: ["false"]
tags: [
  "fetched",
  "Biomamba 生信基地"
]
categories: ["Acdemic"]
---
如何用R语言发邮件 by Biomamba 生信基地
------
<div><section data-support="96编辑器" data-style-id="50500"><section><section><section><section><section><br></section><section><p><strong data-form="0" data-num="1">01 写在前面</strong></p></section></section></section></section><section><section><section><span>有时我们需要批量或者设置某种条件来发送邮件，比如我下文想要依赖Rshiny来收集大家的信息后发送邮件，显然这时人肉来发送是不现实的，依赖R包sendmailR[1]则可以轻松完成这个操作。</span></section></section></section></section></section><section><br></section><section data-support="96编辑器" data-style-id="50500"><section><section><section><section><section><br></section><section><p><strong data-form="0" data-num="1">02 R语言发邮件</strong></p></section></section></section></section><section><section><section>首先我们需要登录进入邮箱页面，开通smtp服务，这里我们以163邮箱为例展示。</section><p><img data-galleryid="" data-ratio="0.6372795969773299" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/ImlBFVOwwpwfxOffURLc43IBxF6ukZJGhIQXfOI6IjD7BNxcjUuptQy2dXyK1NhVTWgDgf7tr8bQGRm1hEdOcw/640?wx_fmt=png" data-type="png" data-w="794" src="https://mmbiz.qpic.cn/mmbiz_png/ImlBFVOwwpwfxOffURLc43IBxF6ukZJGhIQXfOI6IjD7BNxcjUuptQy2dXyK1NhVTWgDgf7tr8bQGRm1hEdOcw/640?wx_fmt=png"></p><p><img data-galleryid="" data-ratio="0.5876840696117804" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/ImlBFVOwwpwfxOffURLc43IBxF6ukZJGy77Lnog9XG4Iee3FlDPibroYwYJzibPuhQb1wyWVdv0ibogvjEKJniasKA/640?wx_fmt=png" data-type="png" data-w="747" src="https://mmbiz.qpic.cn/mmbiz_png/ImlBFVOwwpwfxOffURLc43IBxF6ukZJGy77Lnog9XG4Iee3FlDPibroYwYJzibPuhQb1wyWVdv0ibogvjEKJniasKA/640?wx_fmt=png"></p><p><img data-galleryid="" data-ratio="0.6333333333333333" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/ImlBFVOwwpwfxOffURLc43IBxF6ukZJGmKzyp09QJO2ryxibn9DTQlYCZJ9klXCysGFssX3ZU65Snia69MaEUu0g/640?wx_fmt=png" data-type="png" data-w="750" src="https://mmbiz.qpic.cn/mmbiz_png/ImlBFVOwwpwfxOffURLc43IBxF6ukZJGmKzyp09QJO2ryxibn9DTQlYCZJ9klXCysGFssX3ZU65Snia69MaEUu0g/640?wx_fmt=png"></p><p><br></p><section>进入R语言发送邮件</section><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="javascript"><code><span># 安装并加载R包</span></code><code><span><span>if</span>(!<span>require</span>(devtools))install.packages(<span>'devtools'</span>)</span></code><code><span><span>if</span>(!<span>require</span>(sendmailR))install_github(<span>"olafmersmann/sendmailR"</span>)</span></code><code><span><br></span></code><code><span>sendmailR::sendmail(<span>from</span>=<span>"发送者邮箱"</span>, </span></code><code><span>         to=c(<span>"接收者邮箱"</span>), </span></code><code><span>         subject=<span>"邮件标题"</span>, </span></code><code><span>         msg=mime_part(<span>"Biomamba邮件内容"</span>), </span></code><code><span>         engine = <span>"curl"</span>, </span></code><code><span>         engineopts = list(username = <span>"发送邮箱名"</span>, password = <span>"刚才复制的授权码"</span>), </span></code><code><span>         control=list(smtpServer=<span>"smtp.163.com:465"</span>, # <span>163</span>邮箱发送端的IP和端口，其它邮箱的选择可见：https:<span>//zhuanlan.zhihu.com/p/618281679#:~:text=Smtp%2FPOP3%E9%82%AE%E7%AE%B1%E5%9C%B0%E5%9D%80%E5%92%8C%E7%AB%AF%E5%8F%A3%E6%80%BB%E7%BB%93%EF%BC%88163%2F126%2FQQ%EF%BC%89%201%20163.com%3A%20%E6%8E%A5%E6%94%B6%E9%82%AE%E4%BB%B6%E6%9C%8D%E5%8A%A1%E5%99%A8%EF%BC%9A%20pop.163.com%20%E6%8E%A5%E6%94%B6%E7%AB%AF%E5%8F%A3%EF%BC%9A%20110%E6%88%96995%20%28%E4%BD%BF%E7%94%A8ssl%E6%97%B6%29,POP3%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%9C%B0%E5%9D%80%3A%20pop.x263.net%20%EF%BC%88%E7%AB%AF%E5%8F%A3%EF%BC%9A110%EF%BC%89%20SMTP%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%9C%B0%E5%9D%80%3A%20smtp.x263.net%20%EF%BC%88%E7%AB%AF%E5%8F%A3%EF%BC%9A25%EF%BC%89%2021cn.com%3A%20</span></span></code><code><span>          verbose = TRUE) </span></code><code><span>)</span></code></pre></section><p><br></p><section>然后，我就光速地收到了这封邮件：</section><p><img data-galleryid="" data-ratio="0.725925925925926" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/ImlBFVOwwpwfxOffURLc43IBxF6ukZJGlywm42nPVdAK9WQSYfRPTIjwb1MfueblqSJz27qwHxaibicMEmY6CIDw/640?wx_fmt=jpeg" data-type="jpeg" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_jpg/ImlBFVOwwpwfxOffURLc43IBxF6ukZJGlywm42nPVdAK9WQSYfRPTIjwb1MfueblqSJz27qwHxaibicMEmY6CIDw/640?wx_fmt=jpeg"></p><section>所以，如果想循环给多个账号发送邮件的话也很简单：<br></section><section><ul><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="php"><code><span>my_rec &lt;- c("接收者邮箱1","接收者邮箱2","接收者邮箱3",.....)</span></code><code><span><br></span></code><code><span>sendmailR::sendmail(from="发送者邮箱", </span></code><code><span>         to="my_rec", </span></code><code><span>         subject="邮件标题", </span></code><code><span>         msg=mime_part("Biomamba邮件内容"), </span></code><code><span>         engine = "curl", </span></code><code><span>         engineopts = list(username = "你的邮箱名", password = "刚才复制的授权码"), </span></code><code><span>         control=list(smtpServer="smtp.163.com:465", # 163邮箱发送端的IP和端口</span></code><code><span>          verbose = TRUE) </span></code><code><span>)</span></code></pre></section><p><br></p><section>如果你需要转发多封邮件内容，加一个循环就好：<br></section><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="php"><code><span>my_rec &lt;- c(<span>"接收者邮箱1"</span>,<span>"接收者邮箱2"</span>,<span>"接收者邮箱3"</span>,.....)</span></code><code><span>my_context &lt;- c(<span>"邮件1内容"</span>,<span>"邮件2内容"</span>,<span>"邮件3内容"</span>,.....)</span></code><code><span><br></span></code><code><span><br></span></code><code><span><span>for</span>(temp_con in my_context){</span></code><code><span><br></span></code><code><span>sendmailR::sendmail(from=<span>"发送者邮箱"</span>, </span></code><code><span>         to=<span>"my_rec"</span>, </span></code><code><span>         subject=<span>"邮件标题"</span>, </span></code><code><span>         msg=mime_part(temp_con), </span></code><code><span>         engine = <span>"curl"</span>, </span></code><code><span>         engineopts = <span>list</span>(username = <span>"你的邮箱名"</span>, password = <span>"刚才复制的授权码"</span>), </span></code><code><span>         control=<span>list</span>(smtpServer=<span>"smtp.163.com:465"</span>, <span># 163邮箱发送端的IP和端口</span></span></code><code><span>          verbose = <span>TRUE</span>) </span></code><code><span>)</span></code><code><span><br></span></code><code><span>}</span></code></pre></section><section><br></section></section></section></section></section><section><br></section><section data-support="96编辑器" data-style-id="50500"><section><section><section><section><section><br></section><section><p><strong data-form="0" data-num="1">03 shinyApp中的应用</strong></p></section></section></section></section><section><section><section><span>对于我来说，我希望能把这个模块集成在shiny中(我们之前很多的在线工具也是依赖shiny开发的：</span><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247504403&amp;idx=1&amp;sn=43e081157d0f6623955a19f691f679ac&amp;chksm=9b3cab43ac4b2255af9cf7e0e3f2c97f8d28b5bb7dca82c99822046015d6556dd1cf127ce358&amp;scene=21#wechat_redirect" textvalue="Biomamba的在线工具合集" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2">Biomamba的在线工具合集</a><span>)，这样大家留下自己的邮箱我就可以给大家发资料。我也真的去创建了这样的一个示例页面，大家可以访问：</span><span>http://biomamba.com:34038/scRNA_list</span></section><section><span>留下邮箱并确认：</span></section><p><img data-galleryid="" data-ratio="0.27836134453781514" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/ImlBFVOwwpwfxOffURLc43IBxF6ukZJGHoBaqtbib9AbfxP47Eic8zm2SnvibJgJ8QibVstGDus4LmIOk9a9vViacUw/640?wx_fmt=png" data-type="png" data-w="952" src="https://mmbiz.qpic.cn/mmbiz_png/ImlBFVOwwpwfxOffURLc43IBxF6ukZJGHoBaqtbib9AbfxP47Eic8zm2SnvibJgJ8QibVstGDus4LmIOk9a9vViacUw/640?wx_fmt=png"></p><section>成功收到邮件：</section><section><img data-galleryid="" data-ratio="0.8157407407407408" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/ImlBFVOwwpwfxOffURLc43IBxF6ukZJGbQ2FGo3V1FKmEM4ZuDsFLUpcoRJ6gvUMLQIjWSN8Umibdm6CibJHNjcQ/640?wx_fmt=jpeg" data-type="jpeg" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_jpg/ImlBFVOwwpwfxOffURLc43IBxF6ukZJGbQ2FGo3V1FKmEM4ZuDsFLUpcoRJ6gvUMLQIjWSN8Umibdm6CibJHNjcQ/640?wx_fmt=jpeg"></section><p><br></p><section>上面这个shiny App的源码也分享给大家(需要服务器挂shiny可以看这里：<a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247503869&amp;idx=1&amp;sn=142f8c7ba8620815a8770773df077f12&amp;chksm=9b3cb6adac4b3fbb1acdf7593df06af5ac77d1fe9c0144c999de7109bd063b76080a33c50e0d&amp;scene=21#wechat_redirect" textvalue="有root权限的共享服务器,报我名字立减200￥" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2"><span>有root权限的共享服务器</span></a>)：</section><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="php"><code><span><span>if</span>(!<span>require</span>(sendmailR))install_github(<span>"olafmersmann/sendmailR"</span>)</span></code><code><span>mail_result &lt;- <span>NULL</span></span></code><code><span><br></span></code><code><span>server &lt;- <span><span>function</span><span>(input, output, session)</span> </span>{</span></code><code><span><br></span></code><code><span>  observeEvent(input$my_send, {</span></code><code><span>    mail_result &lt;- sendmailR::sendmail(</span></code><code><span>      from = <span>"发送邮箱"</span>, </span></code><code><span>      to = c(<span>as</span>.character(input$user_mail)), </span></code><code><span>      subject = <span>"Biomamba单细胞教程集锦"</span>, </span></code><code><span>      msg = mime_part(<span>"您好，最新的集锦可见推送：https://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247503465&amp;idx=1&amp;sn=e62ea7c78885c6959a535c2f1a10cd6d&amp;chksm=9b3cb739ac4b3e2ffb60d625dc83b0b914d2956a64a6e8400712920dd2ac4c9f11e4e7752d74&amp;token=195202228&amp;lang=zh_CN#rd"</span>), </span></code><code><span>      engine = <span>"curl"</span>, </span></code><code><span>      engineopts = <span>list</span>(username = <span>"发送邮箱"</span>, password = <span>"授权码"</span>), </span></code><code><span>      control = <span>list</span>(smtpServer = <span>"smtp.163.com:465"</span>, verbose = <span>TRUE</span>) </span></code><code><span>    )</span></code><code><span><br></span></code><code><span>    <span>if</span> (! is.<span>null</span>(mail_result)) {</span></code><code><span>      output$myout &lt;- renderText(<span>'邮箱已发送'</span>)</span></code><code><span>    } <span>else</span> {</span></code><code><span>      output$myout &lt;- renderText(<span>'邮件发送失败'</span>)</span></code><code><span>    }</span></code><code><span>  })</span></code><code><span>  </span></code><code><span>}</span></code><code><span><br></span></code><code><span>ui &lt;- fluidPage(</span></code><code><span>  <span>"欢迎大家关注公众号 Biomamba基地\n在下面留下您的邮箱可以获得单细胞最新推送集锦:"</span>,</span></code><code><span>  textInput(inputId = <span>'user_mail'</span>,label = <span>'请留下您的邮箱'</span>),</span></code><code><span>  actionButton(<span>"my_send"</span>, <span>"点击发送"</span>, <span><span>class</span> = "<span>btn</span>-<span>success</span>"),</span></span></code><code><span>  <span>textOutput</span>('<span>myout</span>')</span></code><code><span>)</span></code></pre></section></section></section></section></section><section><span>参考：</span></section><section><span>[1]https://github.com/olafmersmann/sendmailR<br></span></section><section><span>[2]https://zhuanlan.zhihu.com/p/618281679<br></span></section><p><br></p><section><section><section data-support="96编辑器" data-style-id="27326"><section><section><section><section><section><section><section data-support="96编辑器" data-style-id="34887"><section><section><section data-support="96编辑器" data-style-id="36531"><section data-align="title"><section><section><img data-ratio="0.5106382978723404" data-src="https://mmbiz.qpic.cn/mmbiz_png/Ljib4So7yuWiaFyWDMZJ2713X3DwiaQicG5O8mjlC4kPOluxibs4oDot7AXe0RgoXgMeiaB3KYViadIQqXRoRicyian7KUg/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" data-w="47" data-width="100%" src="https://mmbiz.qpic.cn/mmbiz_png/Ljib4So7yuWiaFyWDMZJ2713X3DwiaQicG5O8mjlC4kPOluxibs4oDot7AXe0RgoXgMeiaB3KYViadIQqXRoRicyian7KUg/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"></section><section><section><section><p><strong>如何联系我们</strong><br></p></section></section><section><img data-ratio="1.163265306122449" data-src="https://mmbiz.qpic.cn/mmbiz_png/Ljib4So7yuWiaFyWDMZJ2713X3DwiaQicG5OSxqKNRib39TuLic5NT2iaJaI0mIicuvjMZlRPvlqPfgjzg001qlRJTBDRA/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" data-w="49" data-width="100%" src="https://mmbiz.qpic.cn/mmbiz_png/Ljib4So7yuWiaFyWDMZJ2713X3DwiaQicG5OSxqKNRib39TuLic5NT2iaJaI0mIicuvjMZlRPvlqPfgjzg001qlRJTBDRA/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"></section></section></section></section></section><section data-support="96编辑器" data-style-id="34624"><section><section><section><img data-ratio="0.2463768115942029" data-w="138" data-src="https://mmbiz.qpic.cn/mmbiz_gif/Ljib4So7yuWiaC0oer2QpXIolHVU3Xibtm9BNWiav660mHaB5qEd1dibMibUicNYmAzBBiadQP2s7HArdUxoWL5cDkTEbQ/640?wx_fmt=gif&amp;wxfrom=5&amp;wx_lazy=1" src="https://mmbiz.qpic.cn/mmbiz_gif/Ljib4So7yuWiaC0oer2QpXIolHVU3Xibtm9BNWiav660mHaB5qEd1dibMibUicNYmAzBBiadQP2s7HArdUxoWL5cDkTEbQ/640?wx_fmt=gif&amp;wxfrom=5&amp;wx_lazy=1"></section><section><section>公众号后台消息更新不及时，超过48h便不许回复读者消息，这里给大家留一下领取资料及免费服务器(<a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247503869&amp;idx=1&amp;sn=142f8c7ba8620815a8770773df077f12&amp;chksm=9b3cb6adac4b3fbb1acdf7593df06af5ac77d1fe9c0144c999de7109bd063b76080a33c50e0d&amp;scene=21#wechat_redirect" textvalue="有root权限的共享服务器,报我名字立减200￥" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1">有root权限的共享服务器</a>)的<span><strong>微信号</strong></span>，方便各位随时交流、提建议（科研任务繁重，回复不及时请见谅）。此外呼声一直很高的<strong><span>交流群</span></strong>也建好了，欢迎大家入群讨论：</section><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247492981&amp;idx=1&amp;sn=aed903c4b853113d8c89e13848ea3365&amp;chksm=9b3c9c25ac4b1533feb5f42f94ab4b6023a160313db4bc6a2f142e54d26627e3ea94b53e9031&amp;scene=21#wechat_redirect" textvalue="永久免费的千人生信、科研交流群" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1">永久免费的千人生信、科研交流群</a></p><section><span>大家可以阅读完这几篇之后添加</span></section><section><span><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247493329&amp;idx=1&amp;sn=597870b7f7ce10346da3561e7c281627&amp;chksm=9b3c9f81ac4b169794088ce9abbcacb5f18e9fd174fc0d7e28da62d78facadf3100ef38aaf22&amp;scene=21#wechat_redirect" textvalue="给生信入门初学者的小贴士" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1">给生信入门初学者的小贴士</a><br></span></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247488966&amp;idx=1&amp;sn=9e9e7659b4cf00ac3173d21e88e1602b&amp;chksm=9b3f6c96ac48e580efe53f966430f6598785e5c5c6bcc20f5eef019e723e49baaaea6d73fb7b&amp;scene=21#wechat_redirect" textvalue="如何搜索公众号过往发布内容" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1">如何搜索公众号过往发布内容</a></section><p><img data-galleryid="" data-ratio="0.4357976653696498" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/ImlBFVOwwpx6Htt0YEibg4Pn7N7fFUdclZQH9RX6YAUqQG98l3jcz9XjCiatucDpyE0o10sotnD7jiaEIFDOmv8Yw/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" data-type="png" data-w="1028" src="https://mmbiz.qpic.cn/mmbiz_png/ImlBFVOwwpx6Htt0YEibg4Pn7N7fFUdclZQH9RX6YAUqQG98l3jcz9XjCiatucDpyE0o10sotnD7jiaEIFDOmv8Yw/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"></p></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section><section><section><section><img data-ratio="0.7619047619047619" data-w="84" data-width="80%" data-src="https://mmbiz.qpic.cn/mmbiz_gif/Ljib4So7yuWhFTIP7DCMLPwWh8Yhjs079f1vMqlYdExqbWaZVJyiawKkr21EDSNW740b4yMzkeHxFJULTpZGzYwQ/640?wx_fmt=gif&amp;wxfrom=5&amp;wx_lazy=1" src="https://mmbiz.qpic.cn/mmbiz_gif/Ljib4So7yuWhFTIP7DCMLPwWh8Yhjs079f1vMqlYdExqbWaZVJyiawKkr21EDSNW740b4yMzkeHxFJULTpZGzYwQ/640?wx_fmt=gif&amp;wxfrom=5&amp;wx_lazy=1"></section><section><span>您点的每个赞和在看，我都认真当成了喜欢</span></section></section></section><section><br></section><p><br></p><p><br></p><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/k31ROwdbnHOUdcfEn2HcWg",target="_blank" rel="noopener noreferrer">原文链接</a>
