---
title: "一篇NC文献部分复现——小鼠正常肺和纤维化肺细胞的 scRNA-seq 分析"
date: 2023-11-28T04:18:34Z
draft: ["false"]
tags: [
  "fetched",
  "单细胞天地"
]
categories: ["Acdemic"]
---
一篇NC文献部分复现——小鼠正常肺和纤维化肺细胞的 scRNA-seq 分析 by 单细胞天地
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><blockquote data-tool="mdnice编辑器"><span>❝</span><p>应群里小伙伴要求，挑了一篇NC的文章来复现，文章中所用的单细胞数据集比较多，按照文章思路选用GSE132771数据集 （小鼠正常肺和纤维化肺细胞的 scRNA-seq 分析）来做复现。</p><span>❞</span></blockquote><h4 data-tool="mdnice编辑器"><span></span>文章简介：<span></span></h4><p data-tool="mdnice编辑器">胶原生成细胞 （Collagen-producing cells）维持肺的复杂结构并驱动肺纤维化的病理性瘢痕形成。文章中进行scRNA-seq，以鉴定正常和纤维化肺中所有胶原生成细胞，在小鼠肺的不同隔室中具有不同解剖定位的多个胶原生成亚群的特征，一个以表达<strong>「Cthrc1」</strong> (collagen triple helixrepeat containing 1) 为特征的亚群出现在纤维化肺中，表达最高水平的胶原。</p><h4 data-tool="mdnice编辑器"><span></span>文章数据集：<span></span></h4><p data-tool="mdnice编辑器">作者把小鼠和人样本上传到一块了，这里我们先选取他们的小鼠样本来做复现。</p><p data-tool="mdnice编辑器">只用GSM3891612-GSM3891619的样本</p><figure data-tool="mdnice编辑器"><img data-imgfileid="100034298" data-ratio="2.05609756097561" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9dY5WGbWn5XsbKoDvcOTeiaLj9zhnZRiajPZBh6N2J02gwy6WOZSALiahnvhsUSKgmQzSewOiaR6ZOUA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="410" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9dY5WGbWn5XsbKoDvcOTeiaLj9zhnZRiajPZBh6N2J02gwy6WOZSALiahnvhsUSKgmQzSewOiaR6ZOUA/640?wx_fmt=png&amp;from=appmsg"></figure><h4 data-tool="mdnice编辑器"><span></span>样本处理：<span></span></h4><p data-tool="mdnice编辑器">使用Col1a1-EGFP (Col-GFP) 报告小鼠收集小鼠肺中所有的胶原生成细胞，通过气管内灌注博来霉素诱导2只Col-GFP小鼠肺纤维化，并用博来霉素治疗14天后，而后制备肺单细胞悬液，同时以2只未处理的Col-GFP小鼠作为对照。</p><h4 data-tool="mdnice编辑器"><span></span>复现的图：<span></span></h4><figure data-tool="mdnice编辑器"><img data-imgfileid="100034302" data-ratio="0.9619921363040629" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9dY5WGbWn5XsbKoDvcOTeiaQauibGmjLOt6YfolHqoSiapavvUyoTgfMlU3VRiclRnDUnLfVI85xicwAQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="763" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9dY5WGbWn5XsbKoDvcOTeiaQauibGmjLOt6YfolHqoSiapavvUyoTgfMlU3VRiclRnDUnLfVI85xicwAQ/640?wx_fmt=png&amp;from=appmsg"></figure><h4 data-tool="mdnice编辑器"><span></span>导入数据<span></span></h4><pre data-tool="mdnice编辑器"><span></span><code>rm(list=ls())<br>options(stringsAsFactors = <span>F</span>) <br><span>library</span>(harmony)<br><span>library</span>(ggsci)<br><span>library</span>(dplyr) <br><span>library</span>(future)<br><span>library</span>(Seurat)<br><span>library</span>(clustree)<br><span>library</span>(cowplot)<br><span>library</span>(data.table)<br><span>library</span>(dplyr)<br><span>library</span>(ggplot2)<br><span>library</span>(patchwork)<br><span>library</span>(stringr)<br><br><span>###### step1:导入数据 ######   </span><br>dir=<span>'../GSE132771/'</span> <br>samples=list.files( dir )<br>samples <br>sceList = lapply(samples,<span>function</span>(pro){ <br>  <span># pro=samples[1] </span><br>  print(pro)  <br>  sce = CreateSeuratObject(counts =  Read10X(file.path(dir,pro )) ,<br>                          project = gsub(<span>'^GSM[0-9]*_'</span>,<span>''</span>,<br>                                         gsub(<span>'filtered_feature_bc_matrix'</span>,<span>''</span>,pro) )  ,<span># pro, #</span><br>                          min.cells = <span>5</span>,<br>                          min.features = <span>500</span> )<br>  print(sce)<br>  cid = tail(colnames(sce)[order(sce$nFeature_RNA)],<span>8000</span>)<br>  sce$nFeature_RNA[cid]<br>  sce=sce[,colnames(sce) %<span>in</span>% cid]<br>  print(sce)<br>  <span>return</span>(sce)<br>})<br>names(sceList) <br><br>sce.all=merge(x=sceList[[<span>1</span>]],<br>              y=sceList[ -<span>1</span> ],<br>              add.cell.ids =  gsub(<span>'^GSM[0-9]*_'</span>,<span>''</span>,<br>               gsub(<span>'filtered_feature_bc_matrix'</span>,<span>''</span>,samples))) <br><br>as.data.frame(sce.all@assays$RNA@counts[<span>1</span>:<span>10</span>, <span>1</span>:<span>2</span>])<br>head(sce.all@meta.data, <span>10</span>)<br>table(sce.all$orig.ident) <br><span># 分组信息，通常是隐含在文件名，样品名字里面</span><br>phe=str_split( colnames(sce.all),<span>'[-_]'</span>,simplify = <span>T</span>)<br>head(phe)<br>table(phe[,<span>2</span>])<br>sce.all$group= phe[,<span>2</span>]<br><br>table(sce.all@meta.data$group)<br>table(sce.all@meta.data$orig.ident)<br>sce.all$sample&lt;-ifelse(grepl(<span>"GSM3891612|GSM3891613|GSM3891614|GSM3891615"</span>,sce.all$orig.ident),<br>                       <span>"Bleomycin"</span>,<span>"Untreated"</span>)<br>table(sce.all$sample)<br><br>sce.all$sample2&lt;-ifelse(grepl(<span>"GSM3891612|GSM3891613|GSM3891616|GSM3891617"</span>,sce.all$orig.ident),<br>                        <span>"GFPp"</span>,<span>"GFPn"</span>)<br>table(sce.all$sample2)<br><br>as.data.frame(sce.all@assays$RNA@counts[<span>1</span>:<span>10</span>, <span>1</span>:<span>2</span>])<br>head(sce.all@meta.data, <span>10</span>)<br></code></pre><h4 data-tool="mdnice编辑器"><span></span>质控步骤见该合集早期推文<span></span></h4><h4 data-tool="mdnice编辑器"><span></span>降维分群及harmony<span></span></h4><pre data-tool="mdnice编辑器"><span></span><code>dir.create(<span>"2-harmony"</span>)<br>getwd()<br>setwd(<span>"2-harmony"</span>)<br><br><span># sce.all=readRDS("../1-QC/sce.all_qc.rds")</span><br>sce=sce.all <br>sce<br>sce &lt;- NormalizeData(sce, <br>                         normalization.method = <span>"LogNormalize"</span>,<br>                         scale.factor = <span>1e4</span>) <br>sce &lt;- FindVariableFeatures(sce)<br>sce &lt;- ScaleData(sce)<br>sce &lt;- RunPCA(sce, features = VariableFeatures(object = sce))<br><br><span>library</span>(harmony)<br>seuratObj &lt;- RunHarmony(sce, <span>"orig.ident"</span>)<br>names(seuratObj@reductions)<br>seuratObj &lt;- RunUMAP(seuratObj,  dims = <span>1</span>:<span>15</span>, <br>                     reduction = <span>"harmony"</span>)<br>DimPlot(seuratObj,reduction = <span>"umap"</span>,label=<span>T</span> ) <br><br>sce=seuratObj<br>sce &lt;- FindNeighbors(sce, reduction = <span>"harmony"</span>,<br>                     dims = <span>1</span>:<span>15</span>) <br>sce.all=sce<br><span>#设置不同的分辨率，观察分群效果(选择哪一个？)</span><br><span>for</span> (res <span>in</span> c(<span>0.01</span>, <span>0.05</span>, <span>0.1</span>, <span>0.2</span>, <span>0.3</span>, <span>0.5</span>,<span>0.8</span>,<span>1</span>)) {<br>  sce.all=FindClusters(sce.all, <span>#graph.name = "CCA_snn",</span><br>                       resolution = res, algorithm = <span>1</span>)<br>}<br>colnames(sce.all@meta.data)<br>apply(sce.all@meta.data[,grep(<span>"RNA_snn"</span>,colnames(sce.all@meta.data))],<span>2</span>,table)<br>head(colnames(sce.all))<br>table(sce.all$orig.ident)<br>table(sce.all$group)<br><br><span>#接下来分析，按照分辨率为0.1进行 </span><br>sel.clust = <span>"RNA_snn_res.0.1"</span><br>sce.all &lt;- SetIdent(sce.all, value = sel.clust)<br>table(sce.all@active.ident) <br>saveRDS(sce.all, <span>"sce.all_int.rds"</span>)<br>getwd()<br>setwd(<span>'../'</span>)<br><br>dir.create(<span>"3-cell"</span>)<br>setwd(<span>"3-cell/"</span>)  <br>getwd()<br>DimPlot(sce.all, reduction = <span>"umap"</span>,<br>        group.by = <span>"sample2"</span>,label = <span>T</span>) <br>ggsave(<span>'umap_by_RNA_snn_res.0.1_GFP.pdf'</span>,width=<span>6</span>,height=<span>5</span>)<br>DimPlot(sce.all, reduction = <span>"umap"</span>, group.by = <span>"seurat_clusters"</span>,label = <span>T</span>) <br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100034300" data-ratio="0.8407185628742515" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9dY5WGbWn5XsbKoDvcOTeiaB0b4znktlBBceSjrRyE9QFzSGzmaRWEKPgFtG9YUjKibT59fgSkk40Q/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="835" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9dY5WGbWn5XsbKoDvcOTeiaB0b4znktlBBceSjrRyE9QFzSGzmaRWEKPgFtG9YUjKibT59fgSkk40Q/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器">之后利用文章给出的marker gene来给细胞亚群命名。<img data-imgfileid="100034301" data-ratio="0.8395061728395061" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9dY5WGbWn5XsbKoDvcOTeiaoRicUy7sTjnt1h1lJBCm7YxyWufcvx5wDdxOOnOuCMIsOP3YXia6lQ4A/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="729" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9dY5WGbWn5XsbKoDvcOTeiaoRicUy7sTjnt1h1lJBCm7YxyWufcvx5wDdxOOnOuCMIsOP3YXia6lQ4A/640?wx_fmt=png&amp;from=appmsg"></p><pre data-tool="mdnice编辑器"><span></span><code>DimPlot(sce.all, reduction = <span>"umap"</span>, group.by = <span>"RNA_snn_res.0.1"</span>,label = <span>T</span>) <br>ggsave(<span>'umap_by_RNA_snn_res.0.1.pdf'</span>,width=<span>6</span>,height=<span>5</span>)<br>sce.all<br><br><span>library</span>(ggplot2) <br>genes_to_check=c(<span>"PECAM1"</span>,<span>"TEK"</span>,<span>"PTPRC"</span>,<span>"VAV1"</span>,<span>"EPCAM"</span>,<span>"CDH1"</span>,<span>"CD3E"</span>,<span>"CD19"</span>,<br>                 <span>"ITGAX"</span>,<span>"SIGLE-CF"</span>,<span>"CD68"</span>,<span>"CCR2"</span>,<span>"LY6G"</span>,<span>"MSIN"</span>,<span>"CD86"</span>,<span>"ITGAE"</span>,<br>                 <span>"NKG7"</span>,<span>"GZMB"</span>,<span>"PDGFRA"</span>,<span>"TCF21"</span>,<span>"CDH11"</span>)<br><span>library</span>(stringr)  <br>genes_to_check=str_to_title(unique(genes_to_check))<br>genes_to_check<br>p_all_markers &lt;- DotPlot(sce.all, features = genes_to_check,<br>                         assay=<span>'RNA'</span>)  + coord_flip()<br><br>p_all_markers<br>ggsave(plot=p_all_markers, filename=<span>"check_all_marker_by_seurat_cluster.pdf"</span>,width=<span>6</span>,height=<span>8</span>)<br><br>genes_to_check = c(<span>'PTPRC'</span>, <span>'CD3D'</span>, <span>'CD3E'</span>, <span>'CD4'</span>,<span>'CD8A'</span>,<span>'CD19'</span>, <span>'CD79A'</span>, <span>'MS4A1'</span> ,<br>                   <span>'IGHG1'</span>, <span>'MZB1'</span>, <span>'SDC1'</span>,<br>                   <span>'CD68'</span>, <span>'CD163'</span>, <span>'CD14'</span>, <br>                   <span>'TPSAB1'</span> , <span>'TPSB2'</span>,  <span># mast cells,</span><br>                   <span>'MKI67'</span>,<span>'TOP2A'</span>,<span>'KLRC1'</span>,<br>                   <span>'RCVRN'</span>,<span>'FPR1'</span> , <span>'ITGAM'</span> ,<br>                   <span>'FGF7'</span>,<span>'MME'</span>, <span>'ACTA2'</span>,<br>                   <span>'PECAM1'</span>, <span>'VWF'</span>,    <br>                   <span>'KLRB1'</span>,<span>'NCR1'</span>, <span># NK </span><br>                   <span>'EPCAM'</span> , <span>'KRT19'</span>, <span>'PROM1'</span>, <span>'ALDH1A1'</span>,<br>                   <span>'MKI67'</span> ,<span>'TOP2A'</span>,<span>"SiS"</span>,<span>"OLFM4"</span>,<span>"MUC2"</span>,<span>"CHGA"</span>,<span>"LYZ1"</span>,<span>"DCLK1"</span> )<br>genes_to_check=str_to_title(unique(genes_to_check))<br>genes_to_check<br>p_all_markers2 &lt;- DotPlot(sce.all, features = genes_to_check,<br>                         assay=<span>'RNA'</span>)  + coord_flip()<br>p_all_markers2+p_all_markers<br>ggsave(<span>'markers_gene.pdf'</span>,width = <span>16</span>,height = <span>8</span>)<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100034299" data-ratio="1.0414438502673797" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9dY5WGbWn5XsbKoDvcOTeiaQ65wW9VkLu3NhW2DmbsXtY5P3A3ZNiaPxhOkjYrf4jfdE7icQyf17kWg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="748" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9dY5WGbWn5XsbKoDvcOTeiaQ65wW9VkLu3NhW2DmbsXtY5P3A3ZNiaPxhOkjYrf4jfdE7icQyf17kWg/640?wx_fmt=png&amp;from=appmsg"></figure><pre data-tool="mdnice编辑器"><span></span><code><span># 需要自行看图,定细胞亚群：</span><br><span># 文章里面的 ：  </span><br>  <span># 0：Mesenchymal</span><br>  <span># 1,7: Endo</span><br>  <span># 8,10,11,12: Epi</span><br>  <span># 3: Hematopoietic, NK-T</span><br>  <span># 4,6: Myeloid and Macrophage</span><br>  <span># 5: B</span><br>  <span># 2：fibo</span><br>  <span># 9: cycling </span><br><br><br>celltype=data.frame(ClusterID=<span>0</span>:<span>12</span> ,<br>                      celltype= <span>0</span>:<span>12</span>) <br>  <span>#定义细胞亚群        </span><br>  celltype[celltype$ClusterID %<span>in</span>% c( <span>0</span>),<span>2</span>]=<span>'Mesenchymal'</span> <br>  celltype[celltype$ClusterID %<span>in</span>% c( <span>1</span>,<span>7</span> ),<span>2</span>]=<span>'Endo'</span> <br>  celltype[celltype$ClusterID %<span>in</span>% c( <span>8</span>,<span>10</span>,<span>11</span>,<span>12</span>   ),<span>2</span>]= <span>'Epi'</span> <span># 'myeloids'   </span><br>  celltype[celltype$ClusterID %<span>in</span>% c( <span>3</span>  ),<span>2</span>]=<span>'T'</span> <span># 'myeloids'  </span><br>  celltype[celltype$ClusterID %<span>in</span>% c( <span>4</span>,<span>6</span>  ),<span>2</span>]=<span>'Myeloid and Macrophage'</span> <span># 'myeloids' </span><br>  celltype[celltype$ClusterID %<span>in</span>% c( <span>5</span> ),<span>2</span>]=<span>'B'</span><br>  celltype[celltype$ClusterID %<span>in</span>% c( <span>2</span> ),<span>2</span>]=<span>'fibo'</span><br>  celltype[celltype$ClusterID %<span>in</span>% c(<span>9</span>),<span>2</span>]=<span>'cycling'</span><br><br>head(celltype)<br>celltype<br>table(celltype$celltype)<br><br>sce.all@meta.data$celltype = <span>"NA"</span><br><span>for</span>(i <span>in</span> <span>1</span>:nrow(celltype)){<br>  sce.all@meta.data[which(sce.all@meta.data$RNA_snn_res.0.1 == celltype$ClusterID[i]),<span>'celltype'</span>] &lt;- celltype$celltype[i]}<br>table(sce.all@meta.data$celltype)<br><br><br>th=theme(axis.text.x = element_text(angle = <span>45</span>, <br>                                    vjust = <span>0.5</span>, hjust=<span>0.5</span>)) <br><br><span>library</span>(patchwork)<br>p_all_markers=DotPlot(sce.all, features = genes_to_check,<br>                      assay=<span>'RNA'</span> ,group.by = <span>'celltype'</span> )  + coord_flip()+th<br>p_umap=DimPlot(sce.all, reduction = <span>"umap"</span>, group.by = <span>"celltype"</span>,label = <span>T</span>,label.box = <span>T</span>)<br>p_all_markers+p_umap<br>ggsave(<span>'markers_umap_by_celltype.pdf'</span>,width = <span>16</span>,height = <span>8</span>)<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100034307" data-ratio="0.49907407407407406" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9dY5WGbWn5XsbKoDvcOTeiamWzRIV8Y2283lk0QJgIbmuBpETU17LbGENB8bmhjojIymzaZvicKiboQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9dY5WGbWn5XsbKoDvcOTeiamWzRIV8Y2283lk0QJgIbmuBpETU17LbGENB8bmhjojIymzaZvicKiboQ/640?wx_fmt=png&amp;from=appmsg"></figure><pre data-tool="mdnice编辑器"><span></span><code>expr &lt;- sce.all@assays$RNA@data<br>gene_expression &lt;- expr %&gt;% .[<span>"Col1a1"</span>,] %&gt;% as.data.frame()<br>colnames(gene_expression) &lt;- <span>"Col1a1"</span><br>gene_expression$cell &lt;- rownames(gene_expression)<br><span>#Col1a1 postive</span><br>gene_expression_sel &lt;- gene_expression[which(gene_expression$Col1a1&gt;<span>0</span>),]<br>Col1a1 &lt;- sce.all[,rownames(gene_expression_sel)]<br><br>FeaturePlot(sce.all,c(<span>'Col1a1'</span>))<br>ggsave(<span>'umap_Col1a1.pdf'</span>,height = <span>7</span>,width = <span>8</span>)<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100034303" data-ratio="0.865414710485133" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9dY5WGbWn5XsbKoDvcOTeia3V58wH43Riah2dDcm8kroaVc742prRd0UpkgQXFwdUE53QAZaxkLibtQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="639" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9dY5WGbWn5XsbKoDvcOTeia3V58wH43Riah2dDcm8kroaVc742prRd0UpkgQXFwdUE53QAZaxkLibtQ/640?wx_fmt=png&amp;from=appmsg"></figure><pre data-tool="mdnice编辑器"><span></span><code>setwd(<span>"../"</span>)<br>dir.create(<span>"./4-umap"</span>)<br>setwd(<span>"4-umap/"</span>)<br><span>#对Col1a1重新降维分群</span><br>sce&lt;-Col1a1<br>sce &lt;- NormalizeData(sce, <br>                     normalization.method = <span>"LogNormalize"</span>,<br>                     scale.factor = <span>1e4</span>) <br>sce &lt;- FindVariableFeatures(sce)<br>sce &lt;- ScaleData(sce)<br>sce &lt;- RunPCA(sce, features = VariableFeatures(object = sce))<br><br><span>library</span>(harmony)<br>seuratObj &lt;- RunHarmony(sce, <span>"orig.ident"</span>)<br>names(seuratObj@reductions)<br>seuratObj &lt;- RunUMAP(seuratObj,  dims = <span>1</span>:<span>15</span>, <br>                     reduction = <span>"harmony"</span>)<br>DimPlot(seuratObj,reduction = <span>"umap"</span>,label=<span>T</span> ) <br>ggsave(<span>'umap_Col1a1.pdf'</span>,height = <span>7</span>,width = <span>8</span>)<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100034304" data-ratio="0.860062893081761" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9dY5WGbWn5XsbKoDvcOTeiaJpEr9F1gnSSjYSshBfXSDKqhGMibPkvrUP7btnHp6FTDqGsLZhRTVXg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="636" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9dY5WGbWn5XsbKoDvcOTeiaJpEr9F1gnSSjYSshBfXSDKqhGMibPkvrUP7btnHp6FTDqGsLZhRTVXg/640?wx_fmt=png&amp;from=appmsg"></figure><pre data-tool="mdnice编辑器"><span></span><code>DimPlot(sce, reduction = <span>"umap"</span>,<br>        group.by = <span>"sample"</span>,label = <span>T</span>) <br>ggsave(<span>'umap_by_group.pdf'</span>,height = <span>7</span>,width = <span>8</span>)<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100034306" data-ratio="0.8647798742138365" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9dY5WGbWn5XsbKoDvcOTeia6icRrHBiaYh20DDUvs6ibjWe50hxhF3pTlpZx8rKHoXKFJICkJO6EteZA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="636" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9dY5WGbWn5XsbKoDvcOTeia6icRrHBiaYh20DDUvs6ibjWe50hxhF3pTlpZx8rKHoXKFJICkJO6EteZA/640?wx_fmt=png&amp;from=appmsg"></figure><pre data-tool="mdnice编辑器"><span></span><code>gene&lt;-c(<span>"Col1a1"</span>,<span>"Acta2"</span>,<span>"Pdgfra"</span>,<span>"Pdgfrb"</span>,<span>"Myh11"</span>,<span>"Mcam"</span>,<span>"Cspg4"</span>)<br><br>p&lt;-FeaturePlot(sce,features = gene,reduction = <span>"umap"</span>,<br>               pt.size = <span>1</span>,label = <span>F</span>,label.size = <span>5</span>,cols = c(<span>"lightgrey"</span>,<span>"blue"</span>))+<br>              scale_x_continuous(<span>""</span>)+scale_y_continuous(<span>""</span>)+<br>              theme_bw()+ <span>#改变ggplot2的主题</span><br>               theme( <span>#进一步修改主题</span><br>               panel.grid.major = element_blank(),<br>               panel.grid.minor = element_blank(), <span>#去掉背景线</span><br>              plot.title = element_text(hjust = <span>0.5</span>,size=<span>15</span>) <span>#改变标题位置和字体大小</span><br>              );p<br><br>ggsave(<span>'featureplot.pdf'</span>,height = <span>8</span>,width = <span>8</span>)<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100034305" data-ratio="0.9962121212121212" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9dY5WGbWn5XsbKoDvcOTeiaEXcVlufqZUW3FZqRomVkuIM0CJClzQFMrgQuOuU9pC6eHRDj5FglSw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="792" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9dY5WGbWn5XsbKoDvcOTeiaEXcVlufqZUW3FZqRomVkuIM0CJClzQFMrgQuOuU9pC6eHRDj5FglSw/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器">推文就先复现到这里了。</p><h3 data-tool="mdnice编辑器"><span></span><span>微信交流群</span><span></span></h3><p data-tool="mdnice编辑器">如果你也想参与到群里的讨论中，给我提出一些推文更新建议的话欢迎入群。同时你也可以得到我前期更新的所有数据及代码，在群里我会把代码分享给大家，而且大家可以在群里「提出自己感兴趣的单细胞文献」<strong>「我们尽可能优先选择大家的数据集去复现和实战，也欢迎大家在群里分享更多其它资料，咱们一起进步，」</strong>「比较高级的单细胞分析」**我们也会一起尝试， 相信你肯定是会不虚此行哈。</p><p data-tool="mdnice编辑器">附上之前推文的链接 <a href="https://mp.weixin.qq.com/s?__biz=MzUzMTEwODk0Ng==&amp;mid=2247512238&amp;idx=1&amp;sn=e0c6dc2ea0e089aabb78133e50fb5d7f&amp;scene=21#wechat_redirect" data-linktype="2">为爱发电不可取（单细胞周更需要你的支持）</a></p><p data-tool="mdnice编辑器"><strong>「「目前群里已经有近400人，所以你想要进群的话就需要添加我的微信，私聊给我发99元的红包，我把你拉进群里。」」</strong></p><p data-tool="mdnice编辑器">我们这个群是真正的付费交流群，提供数据，代码，学习资料，也会跟大家互动交流，还会坚持进行创作至少一年。如果介意99元的门槛且不认可我们知识分享的理念，<strong>「请不要加我好友」</strong>。</p><figure data-tool="mdnice编辑器"><img data-imgfileid="100034312" data-ratio="1" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9dY5WGbWn5XsbKoDvcOTeia6Mx66DgncOZ9EKcvRf8VTP9icLXiacxXkkyFnF6N7fyPUZBL5SC0Eh7g/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="172" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9dY5WGbWn5XsbKoDvcOTeia6Mx66DgncOZ9EKcvRf8VTP9icLXiacxXkkyFnF6N7fyPUZBL5SC0Eh7g/640?wx_fmt=png&amp;from=appmsg"></figure></section><p><br></p><p><mp-style-type data-value="10000"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/Jw6tK4ByfdDbnQXBZSC75A",target="_blank" rel="noopener noreferrer">原文链接</a>
