---
title: "GEO芯片最大值竟然出现60多？需要log2转换吗？"
date: 2023-01-07T14:59:41Z
draft: ["false"]
tags: [
  "fetched",
  "生信作曲家"
]
categories: ["Acdemic"]
---
GEO芯片最大值竟然出现60多？需要log2转换吗？ by 生信作曲家
------
<div><section><h3><span>前言</span></h3><blockquote><p><span></span><span>生信作曲家一直致力于构建国内</span><span><strong>和谐、开放、可持续</strong></span><span><strong>的生物信息交流平台</strong>。生信作曲家的目标是<strong>为每个科研人扫清科研路上的一切障碍，让生物信息学人人可做</strong>。目前，生信作曲家已推出</span><span><strong>"</strong><strong>跟着一区文章学通机器学习</strong><strong>"</strong></span><span>，<strong>"</strong><strong>跟着一区文章学通单细胞</strong><strong>"</strong><strong>，Bootstrap，CIBERSORTx, NTP, TICPE，metaVIPER算法</strong></span><span>等多种强力教程，同时也兼具</span><strong><span>GEO数据库</span></strong><span>，</span><span><strong>ICGC数据库</strong></span><span>数据整理等核心入门技术教学，开办</span><span><strong>暑期</strong><strong>发文计划RS,max,ultra，7天发文A计划</strong><strong>，五一创新发文计划pro</strong></span><span><strong>，生信中秋分享会、小年夜分享会、暑期集训营和冬季集训营</strong>等多次。辅导同学实现纯生信SCI发表硕果累累，帮助同学实现医学事业路上的理想与追求。</span></p></blockquote><p>有同学向我们提出问题，<span><strong>同学遇到的GEO芯片最大值竟然是60多（GSE25097）？</strong></span>这种情况似乎log2（会最大值仅6左右），不log2都不对，似乎不太符合要么10几，要么几千几万的一般情况。同学发文应该如何处理？</p><p><br></p><p>在尝试从原始数据（cel格式)开始处理后，同学进而又遇到了一系列奇怪而棘手的问题。</p><p><br></p><p><img data-galleryid="" data-ratio="0.6964285714285714" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/mo60jlFOtaCrO4tdoDaIPSeBIP6AXRcia8Y0ZGJqoZgLQFMuSVMQCGaCtlpI11FtFpq7TgLAVoEMTXlBMuFOSKQ/640?wx_fmt=png" data-type="png" data-w="504" src="https://mmbiz.qpic.cn/mmbiz_png/mo60jlFOtaCrO4tdoDaIPSeBIP6AXRcia8Y0ZGJqoZgLQFMuSVMQCGaCtlpI11FtFpq7TgLAVoEMTXlBMuFOSKQ/640?wx_fmt=png"></p><h3><span>问题详情和解决</span></h3><pre><code><span>## 尝试直接下载</span><br>setwd(<span>'d:/work/stroke_mito/'</span>)<br><span>library</span>(GEOquery)<br>Sys.setenv(<span>"VROOM_CONNECTION_SIZE"</span>=<span>131072</span>*<span>9</span>)<br>gset=getGEO(<span>'GSE25097'</span>,getGPL = <span>F</span>,destdir = <span>'.'</span>)<br><br>exprSet=exprs(gset[[<span>1</span>]])<br><br>max(exprSet)<br>setwd(<span>'d:/work/stroke_mito/'</span>)<br><span>library</span>(GEOquery)<br>Sys.setenv(<span>"VROOM_CONNECTION_SIZE"</span>=<span>131072</span>*<span>9</span>)<br>gset=getGEO(<span>'GSE25097'</span>,getGPL = <span>F</span>,destdir = <span>'.'</span>)<br><br>exprSet=exprs(gset[[<span>1</span>]])<br><br>max(exprSet)<br><br><br><span><strong><span>## 发现很奇怪，60多，取不取log都不太对</span><br><span>## 考虑使用原始数据</span></strong></span><br></code></pre><figure><figcaption><img data-ratio="0.1351063829787234" data-src="https://mmbiz.qpic.cn/mmbiz_png/mo60jlFOtaCrO4tdoDaIPSeBIP6AXRciaXy0NIOBY2keHhEFXic7kVaMdmm1vJrwsBjchpuCcQXBRDXqG5r3h6qA/640?wx_fmt=png" data-type="png" data-w="940" src="https://mmbiz.qpic.cn/mmbiz_png/mo60jlFOtaCrO4tdoDaIPSeBIP6AXRciaXy0NIOBY2keHhEFXic7kVaMdmm1vJrwsBjchpuCcQXBRDXqG5r3h6qA/640?wx_fmt=png"></figcaption></figure><pre><code><span>#library(affy)</span><br>setwd(<span>'d:/work/stroke_mito/'</span>)<br><span>library</span>(affy)<br><span># cel文件存放的路径（下载所有cel文件后，不需要彻底解压），此处以两个为例</span><br>dir_cels &lt;- <span>"./hcc/"</span>  <br></code></pre><figure><figcaption><img data-ratio="0.30879345603271985" data-src="https://mmbiz.qpic.cn/mmbiz_png/mo60jlFOtaCrO4tdoDaIPSeBIP6AXRciampItgGRyGPRSdjMMAegoWVabCrl2N3o0Ryk24iaB5WNwaRKhMJlt1zw/640?wx_fmt=png" data-type="png" data-w="978" src="https://mmbiz.qpic.cn/mmbiz_png/mo60jlFOtaCrO4tdoDaIPSeBIP6AXRciampItgGRyGPRSdjMMAegoWVabCrl2N3o0Ryk24iaB5WNwaRKhMJlt1zw/640?wx_fmt=png"></figcaption></figure><pre><code><span># 读取readaffy</span><br>affy &lt;- ReadAffy(celfile.path = dir_cels)<br><span># rma标准化（推荐）</span><br>gset &lt;- rma(affy)  <span><strong><span>### 发现报错！！！！（问题不简单）</span></strong></span><br><span>'getOption("repos")'</span> replaces Bioconductor standard<br>repositories, see <span>'?repositories'</span> <span>for</span> details<br><br>replacement repositories:<br>    CRAN: https://cran.rstudio.com/<br><br>Error <span>in</span> getCdfInfo(object) : <br>  Could not obtain CDF environment, problems encountered:<br>Specified environment does not contain RM-HU01Aa520485<br>Library - package rmhu01aa520485cdf not installed<br>Bioconductor - rmhu01aa520485cdf not available<br></code></pre><figure><figcaption><img data-ratio="0.40823970037453183" data-src="https://mmbiz.qpic.cn/mmbiz_png/mo60jlFOtaCrO4tdoDaIPSeBIP6AXRcia3sPXadFVpnYicMGTEvVn36dKKS3WiaDsFibZWaKd7EqIqTwttJ1WQgf2A/640?wx_fmt=png" data-type="png" data-w="1068" src="https://mmbiz.qpic.cn/mmbiz_png/mo60jlFOtaCrO4tdoDaIPSeBIP6AXRcia3sPXadFVpnYicMGTEvVn36dKKS3WiaDsFibZWaKd7EqIqTwttJ1WQgf2A/640?wx_fmt=png"><br></figcaption></figure><pre><code><span>#国内外检索，参照https://support.bioconductor.org/p/118435/</span><br><span>## 缺少cdf环境是关键！问题难度大，解决复杂</span><br><br>BiocManager::install(<span>'makecdfenv'</span>,update = <span>F</span>,ask = <span>F</span>)<br><span>library</span>(makecdfenv)<br><span>## 去GPL下载下载文件，注意文件是GPL给的！！，下载好后放到文件夹下</span><br><span>## 用GPL10687_RM-HU01Aa520485_custom_MMPM.cdf.gz创建 rmhu01aa520485cdf包</span><br><span>## https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GPL10687</span><br>make.cdf.package(<span>"GPL10687_RM-HU01Aa520485_custom_MMPM.cdf.gz"</span>,<br>                 <span>"rmhu01aa520485cdf"</span>, compress=<span>TRUE</span>, species=<span>"Homo_sapiens"</span>)<br><br><br>BiocManager::install(<span>"AnnotationDbi"</span>)<br><br><span># 通过创建的rmhu01aa520485cdf包，来创建环境</span><br>install.packages(<span>"rmhu01aa520485cdf"</span>, repos=<span>NULL</span>, type=<span>"source"</span>)<br><br><span># 如此才能顺利运行,</span><br>affy &lt;- ReadAffy(celfile.path = dir_cels)<br><span># rma标准化（推荐）</span><br>gset &lt;- rma(affy)<br>exprSet=exprs(gset)<br>max(exprSet)<br></code></pre><figure><figcaption><img data-ratio="0.31346989447548107" data-src="https://mmbiz.qpic.cn/mmbiz_png/mo60jlFOtaCrO4tdoDaIPSeBIP6AXRciapFOLnXXEAafsnRfnUkg7Vxcjzs1JUgmvTT78j0ibgFkgbvNOZ7GTx7Q/640?wx_fmt=png" data-type="png" data-w="1611" src="https://mmbiz.qpic.cn/mmbiz_png/mo60jlFOtaCrO4tdoDaIPSeBIP6AXRciapFOLnXXEAafsnRfnUkg7Vxcjzs1JUgmvTT78j0ibgFkgbvNOZ7GTx7Q/640?wx_fmt=png"><br><br><img data-ratio="0.30654515327257664" data-src="https://mmbiz.qpic.cn/mmbiz_png/mo60jlFOtaCrO4tdoDaIPSeBIP6AXRciaFm3svUIHiaJicbzTzePEs4Hcf3OkIO3icQy9I8LTXibdEZTChWbH2WZLcQ/640?wx_fmt=png" data-type="png" data-w="1207" src="https://mmbiz.qpic.cn/mmbiz_png/mo60jlFOtaCrO4tdoDaIPSeBIP6AXRciaFm3svUIHiaJicbzTzePEs4Hcf3OkIO3icQy9I8LTXibdEZTChWbH2WZLcQ/640?wx_fmt=png"><br><br></figcaption></figure><figure><figcaption><img data-ratio="0.3609467455621302" data-src="https://mmbiz.qpic.cn/mmbiz_png/mo60jlFOtaCrO4tdoDaIPSeBIP6AXRciablqI2ePWparHkdHMj1ROd4qZpDdl2sicH9P23X6VaFeGKbewfwQTDWQ/640?wx_fmt=png" data-type="png" data-w="1183" src="https://mmbiz.qpic.cn/mmbiz_png/mo60jlFOtaCrO4tdoDaIPSeBIP6AXRciablqI2ePWparHkdHMj1ROd4qZpDdl2sicH9P23X6VaFeGKbewfwQTDWQ/640?wx_fmt=png"></figcaption></figure><figure><figcaption><br></figcaption></figure><p><span><strong>如此，最大值成功到了14点多，不需要再log了</strong></span></p><figure><figcaption><img data-ratio="0.6641414141414141" data-src="https://mmbiz.qpic.cn/mmbiz_png/mo60jlFOtaCrO4tdoDaIPSeBIP6AXRciaDUqnxUSq4LRknDDawRGKcN6r1fAYBdhgOsnU99zGM11MKgSMUD9qEA/640?wx_fmt=png" data-type="png" data-w="1188" src="https://mmbiz.qpic.cn/mmbiz_png/mo60jlFOtaCrO4tdoDaIPSeBIP6AXRciaDUqnxUSq4LRknDDawRGKcN6r1fAYBdhgOsnU99zGM11MKgSMUD9qEA/640?wx_fmt=png"></figcaption></figure><h3><span>后记</span></h3><p>解决此类问题<span>，<strong>检索是关键</strong></span>！否则很难凭自己的能力解决。另外60多的最大值应考虑原始数据来</p><p>交流更多，备注 加群</p><p><img data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/mo60jlFOtaB9Vq4TQbMtR81HOfuhy7jkZsUypgwNYHTiaEFuvXNqI8z2nlDYc7tbrJ4o7W7dAgqRQPp2lDqfLbA/640?wx_fmt=png" data-type="png" data-ratio="1" data-w="512" src="https://mmbiz.qpic.cn/mmbiz_png/mo60jlFOtaB9Vq4TQbMtR81HOfuhy7jkZsUypgwNYHTiaEFuvXNqI8z2nlDYc7tbrJ4o7W7dAgqRQPp2lDqfLbA/640?wx_fmt=png"></p><p><br></p></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/4quBz8gHlbIqLsyefOIf0w",target="_blank" rel="noopener noreferrer">原文链接</a>
