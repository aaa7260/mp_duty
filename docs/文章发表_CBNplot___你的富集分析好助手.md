---
title: "文章发表：CBNplot - 你的富集分析好助手"
date: 2022-08-28T02:44:54Z
draft: ["false"]
tags: [
  "fetched",
  "老俊俊的生信笔记"
]
categories: ["Duty"]
---
文章发表：CBNplot - 你的富集分析好助手 by 老俊俊的生信笔记
------
<div><p data-mpa-powered-by="yiban.io"><img data-galleryid="" data-ratio="0.3128205128205128" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/MPBFtnFrw4l81f0ibLmYmiaaTH2hHaFv63Qxge3IvQKSDasRQqgPSGgGFjL5bTQteI1KrRMUQ3dwpXUS8G5JiaRyQ/640?wx_fmt=png" data-type="png" data-w="780" src="https://mmbiz.qpic.cn/mmbiz_png/MPBFtnFrw4l81f0ibLmYmiaaTH2hHaFv63Qxge3IvQKSDasRQqgPSGgGFjL5bTQteI1KrRMUQ3dwpXUS8G5JiaRyQ/640?wx_fmt=png"></p><p><br></p><p>我们在《<a target="_blank" href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzI5NjUyNzkxMg==&amp;action=getalbum&amp;album_id=1300603819033788419&amp;scene=173&amp;from_msgid=2247491934&amp;from_itemidx=1&amp;count=3&amp;nolastread=1#wechat_redirect" textvalue="YuLab文章" linktype="text" imgurl="" imgdata="null" tab="innerlink" data-linktype="2">YuLab文章</a>》系列中，都是列我们是第一作者（含共同）或通讯作者（含共同）的文章，挂名的我是不会拿出来说的，这次破例，为什么呢？因为这个CBNplot包是clusterProfiler的扩展包，而且我觉得挺重要的。因为正如我说的《<a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzI5NjUyNzkxMg==&amp;mid=2247489886&amp;idx=1&amp;sn=1c3d9c91988ac8499733010480c34d47&amp;chksm=ec43a819db34210f0f60641d5fcafffca50a2cd9bfc3dcf6b8b71cba5fa8ff7012aefddcebfe&amp;scene=21#wechat_redirect" textvalue="所有人都在做富集，但没人在意它的结果" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2">所有人都在做富集，但没人在意它的结果</a>》，对于这个问题，我试图通过设计一些可视化方法来解决。而Noriaki Sato则通过贝叶斯推断来给出一个调控的网络，这个网络可以是通路之间的关系，也可以是基因之间的关系。这样子富集分析的结果，就不再是一堆通路的列表，而是把这一堆通路给组织起来，成为一个有向（调控方向）的网络。那么我们要从富集分析中找分子机制，就更直接、容易、且不再是主观选择了。<br></p><p>这个包的输入，就是clusterProfiler系列包的输出，它内部再调用bnlearn包来做贝叶斯推断，然后画网络图，则借鉴了我们enrichplot包的emapplot代码。另外如果你做的是肿瘤相关的，可以利用Dependency Map (DepMap)的数据在推断时进行加权。这个包大概就做了这些事情。最终出一个下面这样的图：</p><p><img data-galleryid="" data-ratio="0.9393491124260355" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/MPBFtnFrw4l81f0ibLmYmiaaTH2hHaFv63ZOC04pk3HVqL2u8WZgWzbtSrsia59FjhC09xAw40xC0jXNMsYHFgRLQ/640?wx_fmt=png" data-type="png" data-w="676" src="https://mmbiz.qpic.cn/mmbiz_png/MPBFtnFrw4l81f0ibLmYmiaaTH2hHaFv63ZOC04pk3HVqL2u8WZgWzbtSrsia59FjhC09xAw40xC0jXNMsYHFgRLQ/640?wx_fmt=png"></p><p>作者一开始联系我，说借鉴了我的代码，希望得到我的许可以及指导。我在里面的贡献主要就是对可视化提出了一些建议。<a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzI5NjUyNzkxMg==&amp;mid=2247491150&amp;idx=2&amp;sn=2bca032e5328337b703447d350759656&amp;chksm=ec43af09db34261f151905907c52026bb9cdbedaec7c307db81407ac78f6372f076edf57b6b2&amp;scene=21#wechat_redirect" textvalue="ggVennDiagram文章发表" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2">ggVennDiagram</a>包我作为文章的共同作者，也是类似的贡献。CBNplot文章发表后，我们课题组成员进行了测试，发现它不支持通用的富集分析结果，于是我们又给它提交了PR，现在是支持的，也就是说clusterProfiler, DOSE, ReactomePA, meshes，MicrobiomeProfiler（没错，我们还有做宏基因组的）等包所做的富集分析结果都是支持的。</p><p>我想大家更没有理由不用clusterProfiler系列包了，因为我们还能下一步，这是其它软件所没有的。而这个下一步，对机制解说，太有用了。<br></p><p>4月份我们推送了《<a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzI5NjUyNzkxMg==&amp;mid=2247491876&amp;idx=1&amp;sn=3aa4cf181a9aabb9a30b33710c5f98c7&amp;chksm=ec405063db37d9757a42ae1781a16155cd0b60887c21accff688ed6c99a2411e2e44a7e4d8dd&amp;scene=21#wechat_redirect" textvalue="文章发表：肠菌在辅助诊断骨折相关感染" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2">文章发表：肠菌在辅助诊断骨折相关感染</a>》，五月份又推送了《<a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzI5NjUyNzkxMg==&amp;mid=2247491934&amp;idx=1&amp;sn=8fee846572cb0bc337b228150080f047&amp;chksm=ec405019db37d90f5c4c316f3f67ceb625e597a849adffbe81599935c762e5451a4e5f0eb5d2&amp;scene=21#wechat_redirect" textvalue="文章发表：第一篇Editorial article" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2">文章发表：第一篇Editorial article</a>》，这个月拿这篇来凑数，看看下个月，我们还能不能有文章推送，持续出点小文章，证明我们能吃这碗饭，至于说大文章，我们还没那个本事。能在学术圈跑跑龙套，已然很开心。</p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/pWeOT1oBp4CKNPp9I9FQkA",target="_blank" rel="noopener noreferrer">原文链接</a>
