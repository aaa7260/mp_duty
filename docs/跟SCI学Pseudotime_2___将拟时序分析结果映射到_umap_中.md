---
title: "跟SCI学Pseudotime 2 | 将拟时序分析结果映射到 umap 中"
date: 2022-12-12T14:20:19Z
draft: ["false"]
tags: [
  "fetched",
  "生信补给站"
]
categories: ["Acdemic"]
---
跟SCI学Pseudotime 2 | 将拟时序分析结果映射到 umap 中 by 生信补给站
------
<div><section data-tools="新媒体管家" data-label="powered by xmt.cn"><br></section><p><br></p><p><span>偶然见到一张将拟时序分析的结果映射到umap中的图（https://www.jianshu.com/p/e2f0dc8a485c），想了下只需要获取 时序分析的结果 + umap的位置信息 ，使用ggplot2是不是就可以绘制了？</span><br></p><p><img data-ratio="1.2041522491349481" data-src="https://mmbiz.qpic.cn/mmbiz_png/Y21ubvXhTjDTXoRMN703eS0r0pNQXguiaic5lROINMkxZ0dM4GnTDMbQHp2VMdomUpdglic5wxpGOJVPhYuRKDVGg/640?wx_fmt=png" data-type="png" data-w="289" width="371.5" src="https://mmbiz.qpic.cn/mmbiz_png/Y21ubvXhTjDTXoRMN703eS0r0pNQXguiaic5lROINMkxZ0dM4GnTDMbQHp2VMdomUpdglic5wxpGOJVPhYuRKDVGg/640?wx_fmt=png"></p><section><mp-common-profile data-weui-theme="light" data-id="MzIyNDI1MzgzOQ==" data-pluginname="mpprofile" data-headimg="http://mmbiz.qpic.cn/mmbiz_png/Y21ubvXhTjCh1HyEjoPcBiaKy86NdKGZtju9o0oDBPicVK0lcoovRfticNuwPSj0Kib8cxqaVfBcTVCDAJ5icptybsg/0?wx_fmt=png" data-nickname="生信补给站" data-alias="Bioinfo_R_Python" data-signature="生信，R语言， Python，数据处理、统计检验、模型构建、数据可视化，我输出您输入！" data-from="1" data-is_biz_ban="0"></mp-common-profile></section><section data-mpa-template="t" mpa-from-tpl="t"><section data-style-type="1" data-tools="新媒体排版" data-id="13005" mpa-from-tpl="t"><section mpa-from-tpl="t"><section mpa-from-tpl="t"><section mpa-from-tpl="t"><br></section><section mpa-from-tpl="t"><p>一 加载数据 R包<span></span></p></section></section></section></section></section><p><br></p><p><span>使用上篇推文得到的拟时序分析的结果，也可后台回复 “</span><span><strong>时序</strong></span><span>”获取。</span></p><p><span><br></span></p><p><span>尽可能的熟悉单细胞分析中常见的数据都存在哪，记不住的可以多使用 str 函数查看<br></span></p><pre data-language="r">library(monocle)<br>library(Seurat)<br>library(ggplot2)<br><br>#载入数据<br>load("HSMM_anno.RData")<br><br>#查看umap的位置信息<br>head(pbmc@reductions$umap@cell.embeddings)<br><br>#查看cell的Pseudotime 信息<br>head(HSMM@phenoData@data)<br></pre><p><br></p><p><img data-galleryid="" data-ratio="0.42680776014109345" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/Y21ubvXhTjDTXoRMN703eS0r0pNQXguiaBkbEEXBd9piah3Uqqxk4rOsW1gyUDicdBQISPf2K2cyj5q1iaEVe9tnmA/640?wx_fmt=png" data-type="png" data-w="1134" src="https://mmbiz.qpic.cn/mmbiz_png/Y21ubvXhTjDTXoRMN703eS0r0pNQXguiaBkbEEXBd9piah3Uqqxk4rOsW1gyUDicdBQISPf2K2cyj5q1iaEVe9tnmA/640?wx_fmt=png"></p><p><br></p><h4><strong>1.2 结合Pseudotime 和 umap</strong></h4><p>将Pseudotime信息添加到pbmc的meta.data中</p><pre data-language="r">pbmc@meta.data$Pseudotime &lt;- HSMM@phenoData@data$Pseudotime <br>head(pbmc@meta.data)<br></pre><p><img data-galleryid="" data-ratio="0.29159369527145357" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/Y21ubvXhTjDTXoRMN703eS0r0pNQXguiaWOre1Tuekl92S253OYsHpjlyRznkRn5jA6lffYMoEWTjJVZxMw7zbw/640?wx_fmt=png" data-type="png" data-w="1142" src="https://mmbiz.qpic.cn/mmbiz_png/Y21ubvXhTjDTXoRMN703eS0r0pNQXguiaWOre1Tuekl92S253OYsHpjlyRznkRn5jA6lffYMoEWTjJVZxMw7zbw/640?wx_fmt=png"></p><p><br></p><section data-mpa-template="t" mpa-from-tpl="t"><section data-style-type="1" data-tools="新媒体排版" data-id="13005" mpa-from-tpl="t"><section mpa-from-tpl="t"><section mpa-from-tpl="t"><section mpa-from-tpl="t"><span></span></section><section mpa-from-tpl="t"><p>二 <span>Pse</span><span>udotime</span><span>映射到umap</span></p></section></section></section></section></section><p><br></p><p><strong><span>2.1 划分Pseudotime</span></strong><span></span><br></p><p>考虑到Pseudotime是连续型的 ，绘制到umap上颜色类型太多了，暂时“任性”的分为6类（没有啥参考）。</p><pre data-language="r">#将Pseudotime分类<br>p3 &lt;- plot_cell_trajectory(HSMM, color_by = "Pseudotime")+<br>  scale_color_gradientn(values = seq(0,1,0.2),<br>                        colours = c('blue','cyan','green','yellow','orange','red'))<br>p3<br></pre><p><img data-galleryid="" data-ratio="0.7911949685534592" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/Y21ubvXhTjDTXoRMN703eS0r0pNQXguiaGWSRPvG54ic3hoJiag0PLmFXibv2krwicibFZTDSHKa1c8d8naOSadibeYRw/640?wx_fmt=png" data-type="png" data-w="795" src="https://mmbiz.qpic.cn/mmbiz_png/Y21ubvXhTjDTXoRMN703eS0r0pNQXguiaGWSRPvG54ic3hoJiag0PLmFXibv2krwicibFZTDSHKa1c8d8naOSadibeYRw/640?wx_fmt=png"></p><h4><strong>2.2 Pseudotime映射到umap图</strong><br></h4><pre data-language="r">#提取位置和Pseudotime信息<br>mydata&lt;- FetchData(pbmc,vars = c("UMAP_1","UMAP_2","Pseudotime"))<br><br>p &lt;- ggplot(mydata,aes(x = UMAP_1,y =UMAP_2,colour = Pseudotime))+<br>  geom_point(size = 1)+<br>  scale_color_gradientn(values = seq(0,1,0.2),<br>                        colours = c('blue','cyan','green','yellow','orange','red'))<br><br>p4 &lt;- p + theme_bw() + theme(panel.border = element_blank(), <br>                             panel.grid.major = element_blank(),<br>                             panel.grid.minor = element_blank(), <br>                             axis.line = element_line(colour = "black"))<br><p>p4</p><p><br></p><p>p3 / p4<br></p></pre><p><img data-galleryid="" data-ratio="0.7931904161412359" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/Y21ubvXhTjDTXoRMN703eS0r0pNQXguiacj2oE6tHGz3FnPrXlkrwsExmH7H3ROeKInIKPT95Rbp77UJpyjxjXA/640?wx_fmt=png" data-type="png" data-w="793" src="https://mmbiz.qpic.cn/mmbiz_png/Y21ubvXhTjDTXoRMN703eS0r0pNQXguiacj2oE6tHGz3FnPrXlkrwsExmH7H3ROeKInIKPT95Rbp77UJpyjxjXA/640?wx_fmt=png"></p><p>OK，完成拟时序分析结果的映射。是不是觉得其实只要知道需要的数据都在哪，然后使用ggplot2 或者 基础函数就能解决问题。<br></p><p><br></p><p><span>你用，或者不用我。</span></p><p><span>数据就在那里，不藏不躲。</span></p><p><br></p><p><br></p><p><strong>PS：后台回复“时序”即可获取本文测试的Rdata文件。</strong><br></p><p><br></p><section data-style-type="7" data-tools="新媒体排版" data-id="9190"><p><span data-txtless="spin" data-txtlessp="120">◆ </span><span></span><span>◆ </span><span></span><span data-txtless="spin" data-txtlessp="-120">◆  <span data-txtless="spin" data-txtlessp="120">◆ </span><span>◆</span></span><span></span></p></section><p cid="n94" mdtype="paragraph"><span md-inline="plain"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzIyNDI1MzgzOQ==&amp;mid=2650398215&amp;idx=1&amp;sn=730225fb5ba3a51ceb8df0a531632515&amp;chksm=f01cbce7c76b35f1bebbf327d78a51d859770a46ae1329d362e3b705c4f8765ee2dc461d24dc&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1" wah-hotarea="click">更多精心内容详见：精心整理（含图PLUS版）|R语言生信分析，可视化</a>（R统计，ggplot2绘图，生信图形可视化汇总）</span></p><p><img data-fileid="502915157" data-galleryid="" data-ratio="0.5313111545988258" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/Y21ubvXhTjDXiaYNDhfvaXrwmS2dFxufyyPlFGu6ZGUmoqYblsiaEeIqj6pSq2D3uz8jG0HQBpqOkOME4pKftQcQ/640?wx_fmt=png" data-type="png" data-w="1022" src="https://mmbiz.qpic.cn/mmbiz_png/Y21ubvXhTjDXiaYNDhfvaXrwmS2dFxufyyPlFGu6ZGUmoqYblsiaEeIqj6pSq2D3uz8jG0HQBpqOkOME4pKftQcQ/640?wx_fmt=png"></p><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/TvB_DYeFWtOIBQ0cL6_P6g",target="_blank" rel="noopener noreferrer">原文链接</a>
