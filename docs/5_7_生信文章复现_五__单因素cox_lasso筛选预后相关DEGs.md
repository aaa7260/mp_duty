---
title: "5.7+生信文章复现（五）：单因素cox+lasso筛选预后相关DEGs"
date: 2022-09-18T02:53:33Z
draft: ["false"]
tags: [
  "fetched",
  "SCIPainter"
]
categories: ["Acdemic"]
---
5.7+生信文章复现（五）：单因素cox+lasso筛选预后相关DEGs by SCIPainter
------
<div><p data-mpa-powered-by="yiban.io"><br></p><section><span>无代码的TCGA纯生信文章复现学习：</span></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzIyOTY3MDA3MA==&amp;mid=2247501235&amp;idx=1&amp;sn=b9f8a426cffa93e91e2654bc8f968d45&amp;chksm=e8bda86adfca217c408dc87147158166ea4a258d5c8c472adeecb7d1d449202b301f9e630e83&amp;scene=21#wechat_redirect" textvalue="《5+纯生信文章全图复现！无代码新手友好》" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1"><span>《5+纯生信文章全图复现！无代码新手友好》</span></a></section><section><br></section><section><span>基于R语言的TCGA纯生信文章（预后风险模型构建）复现学习：</span></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzA5NzQzOTgzMw==&amp;mid=2650949968&amp;idx=1&amp;sn=af6661c04dd3c926bdcfb9cf948f0e1f&amp;chksm=8b563066bc21b97098f02aa70b7d4d65baa504aa586340d274b92e3ae606ca56b4d4f9613f38&amp;scene=21#wechat_redirect" textvalue="《5.7+生信文章复现（一）：TCGA表达矩阵+临床信息清洗》" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1"><span>《5.7+生信文章复现（一）：TCGA表达矩阵+临床信息清洗》</span></a></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzIyOTY3MDA3MA==&amp;mid=2247501626&amp;idx=1&amp;sn=57db35c511b3aa08bbb3e2d3135b6ce1&amp;chksm=e8bdaae3dfca23f55e9566342f5c07144c7bfe46ed80a7ed414948c77bd5647834ce2482c4dd&amp;scene=21#wechat_redirect" textvalue="《5.7+生信文章复现（二）：ICGC表达矩阵清洗》" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1"><span>《5.7+生信文章复现（二）：ICGC表达矩阵清洗》</span></a></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzIyOTY3MDA3MA==&amp;mid=2247502169&amp;idx=1&amp;sn=c4e8c58b231cfd151c040901ba5a82d9&amp;chksm=e8bda480dfca2d962c9d0cd93f932150dd6821e028d5adcb0e73139c91383d3b83eff6a87e67&amp;scene=21#wechat_redirect" textvalue="《5.7+生信文章复现（三）：ICGC临床信息清洗》" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1"><span>《5.7+生信文章复现（三）：ICGC临床信息清洗》</span></a></section><section><a href="https://mp.weixin.qq.com/s?__biz=MzA5NzQzOTgzMw==&amp;mid=2650954237&amp;idx=1&amp;sn=6a88f8f97332c79c952344872c4072db&amp;scene=21#wechat_redirect" textvalue="5.7+生信文章复现（四）：DESeq2差异基因筛选" target="_blank" localeditorid="3jshiznjwd600000000"><span>《5.7+生信文章复现（四）：DESeq2差异基因筛选》</span></a><span>​</span></section><section><br></section><section data-role="title" data-tools="135编辑器" data-id="103367"><section><section><section><br></section><section><img data-ratio="0.6" data-type="png" data-w="45" data-width="100%" data-src="https://mmbiz.qpic.cn/mmbiz_png/6kvRq2WRXphZ8sJbJBibk8bIwnwdlxqiaGTtd7PiaicXTQaibWOWdvzjgv5tYkv8yY6ObrbPmJ8D3RybacPE48bQWUA/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" src="https://mmbiz.qpic.cn/mmbiz_png/6kvRq2WRXphZ8sJbJBibk8bIwnwdlxqiaGTtd7PiaicXTQaibWOWdvzjgv5tYkv8yY6ObrbPmJ8D3RybacPE48bQWUA/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"></section><section><br></section></section></section></section><section><span>复现文章：</span></section><section><span><br></span></section><section><img data-ratio="0.45586297760210803" data-type="png" data-w="1518" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mFwDvWPVmtEcw88P4kTC45MtWVwrQCnf2HLgSia994V2NMODGMch9rvKHPbpOCzGIyltXiaSbicq6Aw/640?wx_fmt=png" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mFwDvWPVmtEcw88P4kTC45MtWVwrQCnf2HLgSia994V2NMODGMch9rvKHPbpOCzGIyltXiaSbicq6Aw/640?wx_fmt=png"></section><section><span><strong><em><span>Frontiers in oncology</span></em><span>, IF= 5.738，2022</span></strong></span></section><section><br></section><section><span>在前几期中，我们学习了两个公共数据库（TCGA+ICGC）表达矩阵和临床信息清洗，以及DESeq2筛选DEHGs（差异缺氧相关基因），今天我们学习如何从DEHGs中进一步筛选与预后相关的DEHGs。</span></section><section><span><br></span></section><section><span><strong><span>预后DEHGs筛选流程：</span></strong></span></section><section><span>1. 将TCGA总队列1:1拆分为训练集和测试集；</span></section><section><span>2. 单因素cox比例风险回归，筛选候选的预后DEHGs；</span></section><section><span>3. Lasso回归，十折交叉检验筛选最佳λ值，并获取最佳模型使用基因作为最终预后DEHGs，用于下一步预后模型构建。</span></section><section><br></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><section><span>#相关R包和数据载入：</span><br mpa-from-tpl="t"><span>library</span>(stringr)<br mpa-from-tpl="t"><span>library</span>(caret)<br mpa-from-tpl="t"><span>library</span>(survminer)<br mpa-from-tpl="t"><span>library</span>(survival)<br mpa-from-tpl="t"><span>#载入TCGA表达矩阵和临床信息表格(第1期整理)：</span><br mpa-from-tpl="t"><span>load</span>('02_exp_cl_fpkm.Rdata') <span>#第1期我们整理的是counts表达矩阵，这里我们使用fpkm，数据下载和整理方式完全相同，因此不再赘述</span><br mpa-from-tpl="t"><span>#载入筛选的66个DEHGs(第4期整理)：</span><br mpa-from-tpl="t"><span>load</span>('03_DEHG.Rdata')<br mpa-from-tpl="t"><span>#矩阵自检，如果是character则需转换为numeric：</span><br mpa-from-tpl="t"><span>exp2</span> &lt;- apply(exp,2,as.numeric)<br mpa-from-tpl="t"><span>row</span>.names(exp2) &lt;- row.names(exp)<br mpa-from-tpl="t"><span>#构建差异缺氧相关基因DEHG表达矩阵：</span><br mpa-from-tpl="t"><span>exp</span> &lt;- exp2[DEHG,]<br mpa-from-tpl="t"><span>exp</span> &lt;- log2(exp+1) <span>#取log(FPKM+1)进行后续分析</span></section></pre></section><section><br></section><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><p><strong><span><strong><span>一、临床信息清洗补充</span></strong></span></strong></p></section></section></section></section></section><section><section><section powered-by="xiumi.us"><section><section><img data-ratio="1.7542662" data-type="png" data-w="293" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mFwDvWPVmtEcw88P4kTC45NLtYr9biabru6xRPKYcvZ6ichibibRb1VKRHRy0XAydGLVSXibLZGdokeOw/640?wx_fmt=png" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mFwDvWPVmtEcw88P4kTC45NLtYr9biabru6xRPKYcvZ6ichibibRb1VKRHRy0XAydGLVSXibLZGdokeOw/640?wx_fmt=png"></section></section></section></section></section><section><br></section><section><span>在正式今天的内容前，我们在第一期整理的临床数据上稍微做点小补充。</span></section><section><br></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><p><span>#OS单位从天转换为年：</span><br mpa-from-tpl="t"><span>cl2</span> &lt;- cl<br mpa-from-tpl="t"><span>cl2</span>$OS &lt;- round(cl$OS/365,2) <span>#单位年，保留2位小数</span><br mpa-from-tpl="t"><span>#T satge去掉细分：</span><br mpa-from-tpl="t"><span>cl2</span>$`T stage` &lt;- substr(cl$`T stage`,1,2)<br mpa-from-tpl="t"><span>#将总分期中的小写转换为大写：</span><br mpa-from-tpl="t"><span>cl2</span>$`Clinical stage` &lt;- gsub(pattern = <span>"i"</span>, replacement = <span>"I"</span>, cl2$`Clinical stage`)<br mpa-from-tpl="t"><span>cl2</span>$`Clinical stage` &lt;- gsub(pattern = <span>"v"</span>, replacement = <span>"V"</span>, cl2$`Clinical stage`)<br mpa-from-tpl="t"><span>cl</span> &lt;- cl2<br mpa-from-tpl="t"><span>exp</span> &lt;- exp<br mpa-from-tpl="t"><span>View</span>(exp)</p></pre></section><section><img data-ratio="0.48484848484848486" data-type="png" data-w="1353" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mFwDvWPVmtEcw88P4kTC45x9JxzkEicwqoreFv5FrnVn7XsjEl2lzMiblv379zO0VsVuHw1lp0wIXw/640?wx_fmt=png" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mFwDvWPVmtEcw88P4kTC45x9JxzkEicwqoreFv5FrnVn7XsjEl2lzMiblv379zO0VsVuHw1lp0wIXw/640?wx_fmt=png"></section><section><br></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><p><span>View</span>(cl)</p></pre></section><section><span></span></section><section><img data-ratio="0.48660714285714285" data-type="png" data-w="1344" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mFwDvWPVmtEcw88P4kTC45RtOTWllTnpSrx46g2YQ5RZukOULceXBnuoYdLMN8fnqpZZkcUqQWLg/640?wx_fmt=png" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mFwDvWPVmtEcw88P4kTC45RtOTWllTnpSrx46g2YQ5RZukOULceXBnuoYdLMN8fnqpZZkcUqQWLg/640?wx_fmt=png"></section><section><br></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><p><span>save</span>(exp,cl,file = c('02_exp_cl_fpkm2.Rdata')) <span>#保存一下更新后的所需数据</span></p></pre></section><section><span>补充完毕！</span></section><section><span><br></span></section><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><p><strong><span><strong><span>二、TCGA训练集和测试集队列拆分</span></strong></span></strong></p></section></section></section></section></section><section><section><section powered-by="xiumi.us"><section><section><img data-ratio="1.7542662" data-type="png" data-w="293" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mFwDvWPVmtEcw88P4kTC45NLtYr9biabru6xRPKYcvZ6ichibibRb1VKRHRy0XAydGLVSXibLZGdokeOw/640?wx_fmt=png" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mFwDvWPVmtEcw88P4kTC45NLtYr9biabru6xRPKYcvZ6ichibibRb1VKRHRy0XAydGLVSXibLZGdokeOw/640?wx_fmt=png"></section></section></section></section></section><section><br></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><p><span>#1.训练集和测试集队列拆分(1:1)：</span><br mpa-from-tpl="t"><span>set</span>.seed(123)<br mpa-from-tpl="t"><span>inA</span> &lt;- createDataPartition(cl2$status, p = 0.5,times = 1,list = F)<br mpa-from-tpl="t"><span>#训练集：</span><br mpa-from-tpl="t"><span>train_exp</span> &lt;- exp[,inA]<br mpa-from-tpl="t"><span>train_cl</span> &lt;- cl2[inA,]<br mpa-from-tpl="t"><span>#测试集：</span><br mpa-from-tpl="t"><span>test_exp</span> &lt;- exp[,-inA]<br mpa-from-tpl="t"><span>test_cl</span> &lt;- cl2[-inA,]<br mpa-from-tpl="t"><span>#切割后两个队列患者生死比例保持基本一致：</span><br mpa-from-tpl="t"><span>prop</span>.table(table(train_cl$status))<br mpa-from-tpl="t"><span>prop</span>.table(table(test_cl$status))</p></pre></section><section><img data-ratio="0.31593038821954483" data-type="png" data-w="747" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mFwDvWPVmtEcw88P4kTC45eruZ0CnvFDsujsibebq0eNayVQMuFfn5BnG2JePXZAicPzrfzYWSfX0Q/640?wx_fmt=png" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mFwDvWPVmtEcw88P4kTC45eruZ0CnvFDsujsibebq0eNayVQMuFfn5BnG2JePXZAicPzrfzYWSfX0Q/640?wx_fmt=png"></section><section><span><br></span></section><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><p><strong><span><strong><span>三、单因素cox筛选预后相关候选DEHGs</span></strong></span></strong></p></section></section></section></section></section><section><section><section powered-by="xiumi.us"><section><section><img data-ratio="1.7542662" data-type="png" data-w="293" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mFwDvWPVmtEcw88P4kTC45NLtYr9biabru6xRPKYcvZ6ichibibRb1VKRHRy0XAydGLVSXibLZGdokeOw/640?wx_fmt=png" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mFwDvWPVmtEcw88P4kTC45NLtYr9biabru6xRPKYcvZ6ichibibRb1VKRHRy0XAydGLVSXibLZGdokeOw/640?wx_fmt=png"></section></section></section></section></section><section><br></section><section><span>用一个循环对矩阵进行批量单因素cox：</span></section><section><br></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><p><span>cox</span> &lt;- apply(<br mpa-from-tpl="t"><span>train_exp</span>,1,function(x){<br mpa-from-tpl="t"><span>train_cl</span>$gene &lt;- as.numeric(x)<br mpa-from-tpl="t"><span>cox_genes</span> &lt;- coxph(Surv(OS, status) ~ gene, data = train_cl)<br mpa-from-tpl="t"><span>coef</span> &lt;- coef(cox_genes)<span> #回归系数</span><br mpa-from-tpl="t"><span>SE</span> &lt;- sqrt(diag(vcov(cox_genes))) <span>#标准误</span><br mpa-from-tpl="t"><span>HR</span> &lt;- exp(coef) <span>#风险比</span><br mpa-from-tpl="t"><span>cox_need</span> &lt;- cbind(HR = HR,<br mpa-from-tpl="t"><span>HR</span>.95L = exp(coef - qnorm(.975, 0, 1) * SE),<br mpa-from-tpl="t"><span>HR</span>.95H = exp(coef + qnorm(.975, 0, 1) * SE),<br mpa-from-tpl="t"><span>pvalue</span> = 1 - pchisq((coef/SE)^2, 1))<br mpa-from-tpl="t"><span>return</span>(cox_need['gene',])<br mpa-from-tpl="t">}<br mpa-from-tpl="t">)<br mpa-from-tpl="t"><span>unicox</span> &lt;- t(cox)<br mpa-from-tpl="t"><span>head</span>(unicox)</p></pre></section><section><img data-ratio="0.31593038821954483" data-type="png" data-w="747" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mFwDvWPVmtEcw88P4kTC45LicXHq5pbEuxtFBsgQxfTgNo4a1cNAZefqDjMIksjU9fvEk6N1EUBOw/640?wx_fmt=png" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mFwDvWPVmtEcw88P4kTC45LicXHq5pbEuxtFBsgQxfTgNo4a1cNAZefqDjMIksjU9fvEk6N1EUBOw/640?wx_fmt=png"></section><section><br></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><p><span>#提取预后差异基因列表(p&lt;0.05)：</span><br mpa-from-tpl="t"><span>diff_unicox</span> &lt;- unicox[unicox[,4]&lt;0.05,]<br mpa-from-tpl="t"><span>dim</span>(diff_unicox) <span>#从66个差异基因中筛选出了25个候选预后DEHGs</span><br mpa-from-tpl="t"><span>table</span>(diff_unicox[,1]&lt;1) <span>#18个风险因子，7个保护因子</span><br mpa-from-tpl="t"><span>head</span>(diff_unicox)</p></pre></section><section><img data-ratio="0.5341365461847389" data-type="png" data-w="747" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mFwDvWPVmtEcw88P4kTC45f6ibGVb94rHpiaM8ENU6ZL2dne0KSHz7baryVr4LuA0tS4pJ5QBzdaLg/640?wx_fmt=png" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mFwDvWPVmtEcw88P4kTC45f6ibGVb94rHpiaM8ENU6ZL2dne0KSHz7baryVr4LuA0tS4pJ5QBzdaLg/640?wx_fmt=png"></section><section><br></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><p><span>#保存所需数据并清空工作环境：</span><br mpa-from-tpl="t"><span>save</span>(train_exp,train_cl,test_exp,test_cl,diff_unicox,file = '04_diff_unicox.Rdata')<br mpa-from-tpl="t"><span>rm</span>(list = ls())</p></pre></section><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><p><strong><span><strong><span>四、Lasso回归：十折交叉检验筛选最佳λ并获取最终DEHGs</span></strong></span></strong></p></section></section></section></section></section><section><section><section powered-by="xiumi.us"><section><section><img data-ratio="1.7542662" data-type="png" data-w="293" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mFwDvWPVmtEcw88P4kTC45NLtYr9biabru6xRPKYcvZ6ichibibRb1VKRHRy0XAydGLVSXibLZGdokeOw/640?wx_fmt=png" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mFwDvWPVmtEcw88P4kTC45NLtYr9biabru6xRPKYcvZ6ichibibRb1VKRHRy0XAydGLVSXibLZGdokeOw/640?wx_fmt=png"></section></section></section></section></section><section><br></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><p><span>#继续载入lasso回归所需R包：</span><br mpa-from-tpl="t"><span>library</span>(glmnet)<br mpa-from-tpl="t"><span>#载入训练集队列及候选预后DEHGs：</span><br mpa-from-tpl="t"><span>load</span>('04_diff_unicox.Rdata')<br mpa-from-tpl="t"><span>#简化训练集队列命名：</span><br mpa-from-tpl="t"><span>exp</span> &lt;- train_exp<br mpa-from-tpl="t"><span>cl</span> &lt;- train_cl<br mpa-from-tpl="t"><span>#构建候选预后DEHGs表达矩阵：</span><br mpa-from-tpl="t"><span>exp</span> &lt;- exp[rownames(diff_unicox),]<br mpa-from-tpl="t"><span>#使用lasso回归进一步收缩单因素cox筛选的25个候选DEHGs：</span><br mpa-from-tpl="t"><span>x</span> &lt;- t(exp)<br mpa-from-tpl="t"><span>y</span> &lt;- data.matrix(Surv(time = cl$OS,event = cl$status))<br mpa-from-tpl="t"><span>x</span>[1:6,1:6]<br mpa-from-tpl="t"><span>head</span>(y)</p></pre></section><section><img data-ratio="0.43113207547169813" data-type="png" data-w="1060" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mFwDvWPVmtEcw88P4kTC45unibciasC8Pvl3K1vX1BZbYiaicKPAUlPgxnzabNRPD4ZrzDFwzgT3WicnA/640?wx_fmt=png" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mFwDvWPVmtEcw88P4kTC45unibciasC8Pvl3K1vX1BZbYiaicKPAUlPgxnzabNRPD4ZrzDFwzgT3WicnA/640?wx_fmt=png"></section><section><br></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><p><span>#构建模型：</span><br mpa-from-tpl="t"><span>fit</span> &lt;- glmnet(x, y, family = 'cox', type.measure = <span>"deviance"</span>, nfolds = 10)<br mpa-from-tpl="t"><span>plot</span>(fit,xvar = 'lambda',label = T) <span>#候选DEHGs的lasso系数</span></p></pre></section><section><img data-ratio="0.956369982547993" data-type="png" data-w="1146" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mFwDvWPVmtEcw88P4kTC45YHALmea0WVJKlyglL5P0rDVLSQ1V1tGS4FIW3vXEH8beTnLO0YGiamQ/640?wx_fmt=png" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mFwDvWPVmtEcw88P4kTC45YHALmea0WVJKlyglL5P0rDVLSQ1V1tGS4FIW3vXEH8beTnLO0YGiamQ/640?wx_fmt=png"></section><section><br></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><p><span>#十折交叉检验筛选最佳lambda：</span><br mpa-from-tpl="t"><span>set</span>.seed(007)<br mpa-from-tpl="t"><span>lasso_fit</span> &lt;- cv.glmnet(x, y, family = 'cox', type.measure = 'deviance', nfolds = 10)<br mpa-from-tpl="t"><span>plot</span>(lasso_fit)</p></pre></section><section><img data-ratio="0.956369982547993" data-type="png" data-w="1146" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mFwDvWPVmtEcw88P4kTC45jsjgoeXLUX0RibeIIDjAnkWbiapus1G35NW1K7rGIyott2ibSgNDXT75A/640?wx_fmt=png" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mFwDvWPVmtEcw88P4kTC45jsjgoeXLUX0RibeIIDjAnkWbiapus1G35NW1K7rGIyott2ibSgNDXT75A/640?wx_fmt=png"></section><section><br></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><p><span>#提取最佳λ值(这里选择1se对应lambda)：</span><br mpa-from-tpl="t"><span>lambda</span>.1se &lt;- lasso_fit$lambda.1se<br mpa-from-tpl="t"><span>lambda</span>.1se</p></pre></section><section><img data-ratio="0.08835341365461848" data-type="png" data-w="747" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mFwDvWPVmtEcw88P4kTC45PIgbEF0Fg7XwNEexDib8IgBcZavwOV7JP8c6iaSV3JVI9lxDV3dPrStg/640?wx_fmt=png" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mFwDvWPVmtEcw88P4kTC45PIgbEF0Fg7XwNEexDib8IgBcZavwOV7JP8c6iaSV3JVI9lxDV3dPrStg/640?wx_fmt=png"></section><section><br></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><p><span>#使用1se的lambda重新建模：</span><br mpa-from-tpl="t"><span>model_lasso_1se</span> &lt;- glmnet(x, y, family = 'cox', type.measure = 'deviance', nfolds = 10,lambda = lambda.1se)<br mpa-from-tpl="t"><span>#拎出建模使用基因：</span><br mpa-from-tpl="t"><span>gene_1se</span> &lt;- rownames(model_lasso_1se$beta)[as.numeric(model_lasso_1se$beta)!=0]<span>#as.numeric后"."会转化为0</span><br mpa-from-tpl="t"><span>gene_1se</span> <span>#筛选出7个</span></p></pre></section><section><img data-ratio="0.0500848896434635" data-type="png" data-w="1178" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mFwDvWPVmtEcw88P4kTC450el8DOe3Pc6Ve35ib0F4AXFZy656bZDH0yrrh8UIRqwUbn2KoXtCqow/640?wx_fmt=png" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mFwDvWPVmtEcw88P4kTC450el8DOe3Pc6Ve35ib0F4AXFZy656bZDH0yrrh8UIRqwUbn2KoXtCqow/640?wx_fmt=png"></section><section><br></section><section><span>使用Lasso收缩后获得的7个基因作为最终预后相关DEHGs，用于下一步预后模型构建。</span></section><section><br></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><p><span>#保存所需数据：</span><br mpa-from-tpl="t"><span>save</span>(gene_1se,file = c('05_lasso_gene_1se.Rdata'))</p></pre></section><section><span>更多TCGA相关内容可戳</span><span><a target="_blank" href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzA5NzQzOTgzMw==&amp;action=getalbum&amp;album_id=2198925128133066755&amp;scene=21#wechat_redirect" textvalue="#TCGA数据库" linktype="text" imgurl="" imgdata="null" tab="innerlink" data-linktype="2">#TCGA数据库</a></span><span>，今天的分享就到这里！</span></section><section><br></section><section data-role="paragraph"><section><section hm_fix="368:481"><section><img data-ratio="0.8181818181818182" data-type="png" data-w="44" data-width="100%" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mFwDvWPVmtEcw88P4kTC45N6q9ebYugE8toCrZiayicej9XPojQpF40fWCyCYOe2Jfvzf7XvibsDt3A/640?wx_fmt=png" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mFwDvWPVmtEcw88P4kTC45N6q9ebYugE8toCrZiayicej9XPojQpF40fWCyCYOe2Jfvzf7XvibsDt3A/640?wx_fmt=png"></section><section><section data-brushtype="text"><strong><span>参考文献</span></strong></section><section data-width="100%"><br></section></section></section></section></section><section><span>Ning X, Li N, Qi Y, et al. Identification of a Hypoxia-Related Gene Model for Predicting the Prognosis and Formulating the Treatment Strategies in Kidney Renal Clear Cell Carcinoma[J]. Frontiers in oncology, 2022, 11: 806264.</span></section><p><span><br></span></p><p><span><strong><span>*未经许可，不得以任何方式复制或抄袭本篇文章之部分或全部内容。版权所有，侵权必究。</span></strong></span></p><p><br></p><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><svg viewbox="0 0 1 1"></svg></section></section></section><section><section powered-by="xiumi.us"><section><svg viewbox="0 0 1 1"></svg></section></section></section><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><svg viewbox="0 0 1 1"></svg></section></section><section powered-by="xiumi.us"><section><svg viewbox="0 0 1 1"></svg></section></section><section powered-by="xiumi.us"><section><svg viewbox="0 0 1 1"></svg></section></section></section></section></section><section><section powered-by="xiumi.us"><section><svg viewbox="0 0 1 1"></svg></section></section></section><section><section powered-by="xiumi.us"><section><svg viewbox="0 0 1 1"></svg></section></section></section></section></section><section><span></span></section><section><br></section><section><span>SCIPainter，是由广州基迪奥生物运营的绘图公号。如果你想了解</span><span><strong><span>组学前沿技术</span></strong></span><span>、</span><span><strong><span>精彩组学文章解读</span></strong></span><span>、</span><strong><span>测序项目问题咨询</span></strong><span>等等，可以关注<strong>基迪奥官方账号</strong>。我们的愿望是，基迪奥助您达到更高的科研领域。</span></section><section><mp-common-profile data-pluginname="mpprofile" data-id="MzA5NzQzOTgzMw==" data-headimg="http://mmbiz.qpic.cn/mmbiz_png/6kvRq2WRXpiadbSLFQicLXEWj2GOlicE5ib53jkfcjIxv63JnP68reVXewhA5Ay8YglUjot7zV2NAdvDU2SfjH1Mwg/0?wx_fmt=png" data-nickname="基迪奥生物" data-alias="gene-denovo" data-signature="广州基迪奥生物官方公众号，小奥每天分享前沿组学知识、实用生信软件技巧、酷炫绘图技能。我们的目标是，助您达到更高的科研领域。" data-from="0"></mp-common-profile></section><section><span></span></section><p><span><br></span></p><section data-role="outer" label="Powered by 135editor.com"><section data-tools="135编辑器" data-id="105648"><section><section data-role="outer" label="Powered by 135editor.com"><section data-role="paragraph"><section data-role="outer" label="Powered by 135editor.com"><section data-tools="135编辑器" data-id="105648"><section><section><img data-ratio="0.8928571428571429" data-type="png" data-w="41" data-width="100%" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6kCKJYcEqEIfoJYG621mPJE8VibmibGU0Jxic9iabARVRH0FT6BNE8VAglWFXBPibFAU7a6tWGibSs8wyUg/640?wx_fmt=png" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6kCKJYcEqEIfoJYG621mPJE8VibmibGU0Jxic9iabARVRH0FT6BNE8VAglWFXBPibFAU7a6tWGibSs8wyUg/640?wx_fmt=png"></section><section><section><section data-width="35%"><section><section data-width="100%"><img data-ratio="1" data-type="jpeg" data-w="860" data-width="100%" title="SCIPainter 30cm二维码.jpg" data-src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/tgUVxVRjT6kCKJYcEqEIfoJYG621mPJEv5etCBwHicqbEPwnVrkpaasxqaVibM4mT2JdIuN6yTlYWDD4mL5A427A/640?wx_fmt=jpeg" src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/tgUVxVRjT6kCKJYcEqEIfoJYG621mPJEv5etCBwHicqbEPwnVrkpaasxqaVibM4mT2JdIuN6yTlYWDD4mL5A427A/640?wx_fmt=jpeg"></section></section></section><section data-width="50%"><section><section data-brushtype="text"><strong># SCIPainter</strong></section><section data-brushtype="text" hm_fix="361:593"><p>基迪奥旗下绘图公众号</p><p>分享科研绘图技能与工具</p><p>欢迎关注与转发~</p></section></section></section></section></section></section></section></section></section></section><section><br></section></section></section><section data-role="paragraph"><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><img data-ratio="1" data-type="gif" data-w="400" data-src="https://mmbiz.qpic.cn/sz_mmbiz_gif/tgUVxVRjT6kCKJYcEqEIfoJYG621mPJEgMd0aMPtmrDjiaX8sBhfhicVteeHf1JicexSpUbS3fdS9SiboUVN7guaPw/640?wx_fmt=gif" src="https://mmbiz.qpic.cn/sz_mmbiz_gif/tgUVxVRjT6kCKJYcEqEIfoJYG621mPJEgMd0aMPtmrDjiaX8sBhfhicVteeHf1JicexSpUbS3fdS9SiboUVN7guaPw/640?wx_fmt=gif"></section></section></section><section><section powered-by="xiumi.us"><section><p><span><strong>你的好友拍了拍你</strong></span></p><p><span><strong>并请你帮她点一下</strong></span><span><strong><span>“分享”</span></strong></span><span><strong><span>~</span></strong></span></p></section></section></section></section></section><p><br></p></section></section></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/ajiNpTDQdfNGY_WgNBVlBQ",target="_blank" rel="noopener noreferrer">原文链接</a>
