---
title: "答读者问(8)：如何批量查询marker基因(对应的蛋白)会不会在膜上表达？"
date: 2023-02-13T01:08:54Z
draft: ["false"]
tags: [
  "fetched",
  "TOP生物信息"
]
categories: ["Acdemic"]
---
答读者问(8)：如何批量查询marker基因(对应的蛋白)会不会在膜上表达？ by TOP生物信息
------
<div><section><mp-common-profile data-pluginname="mpprofile" data-weui-theme="light" data-id="MzkzMzE5NTM4NA==" data-headimg="http://mmbiz.qpic.cn/mmbiz_png/WThoCmvVu2aJMzXzvekL6pv5hnSGnwsxWcOUF8av7a9VEiaicBGia4CRy0DUOeaFuFZY2BPLmRQSf4lkibg5l31Ttw/0?wx_fmt=png" data-nickname="TOP生物信息" data-alias="" data-signature="在读博士生，研究方向为癌症基因组、肿瘤免疫、单细胞组学" data-from="0" data-is_biz_ban="0"></mp-common-profile></section><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><figure data-tool="mdnice编辑器"><img data-ratio="0.8993174061433447" data-src="https://mmbiz.qpic.cn/mmbiz_png/WThoCmvVu2bJucwFygKE8zqqIiatDvnKe8DOyvGJHr5UyyL1H6xEYiblYmfjTt4EJA60QerVhHECdUIpw7jicRJmw/640?wx_fmt=png" data-type="png" data-w="586" src="https://mmbiz.qpic.cn/mmbiz_png/WThoCmvVu2bJucwFygKE8zqqIiatDvnKe8DOyvGJHr5UyyL1H6xEYiblYmfjTt4EJA60QerVhHECdUIpw7jicRJmw/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">做实验的朋友们对这个问题应该是很感兴趣的，因为涉及到后续能不能实验验证。</p><p data-tool="mdnice编辑器">一般的做法是拿基因名或者蛋白名去查文献，查网站。我知道的：<code>uniprot</code>、<code>PDB</code>、<code>the human protein atlas</code>都能查到蛋白质表达定位相关的信息。网址分别如下：</p><ul data-tool="mdnice编辑器"><li><section>https://www.uniprot.org/</section></li><li><section>https://www.rcsb.org/</section></li><li><section>https://www.proteinatlas.org/</section></li></ul><p data-tool="mdnice编辑器">以<code>uniprot</code>为例，假设我想查询<strong>「CD79B」</strong>这个基因/蛋白，网站输入基因名，在结果页面的左侧菜单栏，点击<code>Subcellular location</code></p><figure data-tool="mdnice编辑器"><img data-ratio="0.3585790884718499" data-src="https://mmbiz.qpic.cn/mmbiz_png/WThoCmvVu2bJucwFygKE8zqqIiatDvnKewo24DqMqbJ9fpWyxmonPeptAMq75t9MDvL8wzQeRicibczgdRic6jibmicg/640?wx_fmt=png" data-type="png" data-w="1492" src="https://mmbiz.qpic.cn/mmbiz_png/WThoCmvVu2bJucwFygKE8zqqIiatDvnKewo24DqMqbJ9fpWyxmonPeptAMq75t9MDvL8wzQeRicibczgdRic6jibmicg/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">之后，蛋白的亚细胞定位就显示出来了：有两个参考结果：<strong>「uniprot annotation」</strong>和<strong>「GO annotation」</strong></p><figure data-tool="mdnice编辑器"><img data-ratio="0.43922829581993567" data-src="https://mmbiz.qpic.cn/mmbiz_png/WThoCmvVu2bJucwFygKE8zqqIiatDvnKeIAPsw9oQtqicTEKicfdFB2VKbQ2Rqj0IVoplr81BJiaibOCJnOEX7ACTNw/640?wx_fmt=png" data-type="png" data-w="1555" src="https://mmbiz.qpic.cn/mmbiz_png/WThoCmvVu2bJucwFygKE8zqqIiatDvnKeIAPsw9oQtqicTEKicfdFB2VKbQ2Rqj0IVoplr81BJiaibOCJnOEX7ACTNw/640?wx_fmt=png"></figure><figure data-tool="mdnice编辑器"><img data-ratio="0.5835667600373483" data-src="https://mmbiz.qpic.cn/mmbiz_png/WThoCmvVu2bJucwFygKE8zqqIiatDvnKeT5JsoSmZxM5UyfngFaJkOc8OUW12pegBibY0b4ZBx5Ha5IfVGBrGPxA/640?wx_fmt=png" data-type="png" data-w="1071" src="https://mmbiz.qpic.cn/mmbiz_png/WThoCmvVu2bJucwFygKE8zqqIiatDvnKeT5JsoSmZxM5UyfngFaJkOc8OUW12pegBibY0b4ZBx5Ha5IfVGBrGPxA/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">两个参考结果的意思差不多，都说的是<code>膜蛋白</code>。</p><blockquote data-tool="mdnice编辑器"><span>❝</span><p>但是如果我把这个方法发给他，我<code>内心会不安</code>，因为一个一个查太耗时间了。</p><span>❞</span></blockquote><p data-tool="mdnice编辑器">所以就写了这篇帖子，教他如何批量查询。先来看看最初的marker gene表格：</p><figure data-tool="mdnice编辑器"><img data-ratio="0.47882136279926335" data-src="https://mmbiz.qpic.cn/mmbiz_png/WThoCmvVu2bJucwFygKE8zqqIiatDvnKesyB1Biap9PfFuB3ZPibwbOAriauoiaFsibEajkicXGS9iaumibnqGJNUFAsdXg/640?wx_fmt=png" data-type="png" data-w="543" src="https://mmbiz.qpic.cn/mmbiz_png/WThoCmvVu2bJucwFygKE8zqqIiatDvnKesyB1Biap9PfFuB3ZPibwbOAriauoiaFsibEajkicXGS9iaumibnqGJNUFAsdXg/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">然后开整</p><pre data-tool="mdnice编辑器"><span></span><code><span># install.packages("UniprotR")</span><br><span># BiocManager::install("GenomicAlignments")</span><br>library(UniprotR)<br>library(tidyverse)<br>library(org.Hs.eg.db)<br>markerdf=read.csv(<span>"test_marker_gene.csv"</span>,header = T) <span>#Seurat::FindAllMarkers得到的数据框</span><br>namedf=clusterProfiler::bitr(markerdf<span>$gene</span>,fromType=<span>"SYMBOL"</span>, toType=c(<span>"UNIPROT"</span>), OrgDb=<span>"org.Hs.eg.db"</span>) <span>#会有一对多的情况</span><br><br>namedf<span>$s_c</span>=<span>""</span><br>namedf<span>$go_c</span>=<span>""</span><br><span>for</span> (i <span>in</span> 1:nrow(namedf)) {<br>  go_cellular_component &lt;- GetProteinAnnontate(ProteinAccList = namedf<span>$UNIPROT</span>[i],columns = <span>"go_c"</span>)<br>  <br>  subcellular_location_res=GetSubcellular_location(ProteinAccList = namedf<span>$UNIPROT</span>[i])<br>  subcellular_location_res=subcellular_location_res[,1]<br>  <br>  namedf<span>$go_c</span>[i] = go_cellular_component<br>  namedf<span>$s_c</span>[i] = subcellular_location_res<br>  <span>print</span>(i)<br>}<br>colnames(namedf)[1]=<span>"gene"</span><br>markerdf2=markerdf%&gt;%left_join(namedf,by = <span>"gene"</span>)<br></code></pre><p data-tool="mdnice编辑器">最后的表格是这样的：<img data-ratio="0.39782244556113905" data-src="https://mmbiz.qpic.cn/mmbiz_png/WThoCmvVu2bJucwFygKE8zqqIiatDvnKe086cVpDRIkFcWhlngnxLibcoSC6NwuicPFRiauLOMHKhuajKN0ySDAb0w/640?wx_fmt=png" data-type="png" data-w="1194" src="https://mmbiz.qpic.cn/mmbiz_png/WThoCmvVu2bJucwFygKE8zqqIiatDvnKe086cVpDRIkFcWhlngnxLibcoSC6NwuicPFRiauLOMHKhuajKN0ySDAb0w/640?wx_fmt=png"></p><p data-tool="mdnice编辑器">代码很容易，使用起来应该没有什么难度。<img data-ratio="0.5080091533180778" data-src="https://mmbiz.qpic.cn/mmbiz_png/WThoCmvVu2bJucwFygKE8zqqIiatDvnKeWDbnmra31yAXiaBph6Yse7EdxEqLVRWxGXZL338uBh1MngPRsrCjk3Q/640?wx_fmt=png" data-type="png" data-w="437" src="https://mmbiz.qpic.cn/mmbiz_png/WThoCmvVu2bJucwFygKE8zqqIiatDvnKeWDbnmra31yAXiaBph6Yse7EdxEqLVRWxGXZL338uBh1MngPRsrCjk3Q/640?wx_fmt=png"></p><p data-tool="mdnice编辑器">这种批量的方法用到的R包，<code>UniprotR</code>，其实是通过API的方法访问Uniprot网站获取信息。</p><p data-tool="mdnice编辑器">我上一次讲的<a href="https://mp.weixin.qq.com/s?__biz=MzkzMzE5NTM4NA==&amp;mid=2247486605&amp;idx=1&amp;sn=8730718857f61c6ee6db7418bc9ed7f1&amp;chksm=c251779af526fe8c9c511abb1f4523a6b2c4021d48577ca4f3cf92c6373596eddb29e754e4e6&amp;token=603551624&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2"><strong>「如何获取kegg通路的基因列表」</strong></a>，也是用的这类方法，涉及到的R包是<code>KEGGREST</code>。</p><blockquote data-tool="mdnice编辑器"><span>❝</span><p>并不是每次给读者答疑我都会写帖子，网上很容易搜到答案的，我不想写。</p><span>❞</span></blockquote><p data-tool="mdnice编辑器">ok,这一期的答疑就到这里，祝大家生活愉快！</p><h2 data-tool="mdnice编辑器"><span></span><span>往期答疑</span><span></span></h2><p data-tool="mdnice编辑器"><a href="https://mp.weixin.qq.com/s?__biz=MzkzMzE5NTM4NA==&amp;mid=2247485276&amp;idx=1&amp;sn=4141980d801dd15ce6d425899ba12ba8&amp;chksm=c2517c4bf526f55d3ce2fca9b54fd3c2ac53f898bb3df23d3653bfbfceb5cedafb1339255ca2&amp;token=603551624&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">答读者问(7)：关于doublet</a></p><p data-tool="mdnice编辑器"><a href="https://mp.weixin.qq.com/s?__biz=MzkzMzE5NTM4NA==&amp;mid=2247485294&amp;idx=1&amp;sn=6efb6ca4998a4ae293d80d746303164b&amp;chksm=c2517c79f526f56f679621a979fee86a40b8cdd8cca9f3ddf0fff151e395c0eb5ad053791f5e&amp;token=603551624&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">答读者问(6)：单细胞TPM矩阵如何分析？</a></p><p data-tool="mdnice编辑器"><a href="https://mp.weixin.qq.com/s?__biz=MzkzMzE5NTM4NA==&amp;mid=2247484387&amp;idx=1&amp;sn=3ffbfb6338645aade34bc83af7c237b3&amp;chksm=c25178f4f526f1e2cd0c375d79df89ef5f41d47ccd3e7ce4aad2cbfe94a7909868c2a5e0913e&amp;scene=21#wechat_redirect" data-linktype="2">答读者问(5)：提取monocle2的拟时序/坐标重新画图</a></p><p data-tool="mdnice编辑器"><a href="https://mp.weixin.qq.com/s?__biz=MzkzMzE5NTM4NA==&amp;mid=2247484331&amp;idx=1&amp;sn=c5de13fe781d62dfba010945a9a538c5&amp;chksm=c25178bcf526f1aabfc52b97dfb60535cdbd8c6bdaff6c327d09fa71e011139338c475a6b69c&amp;scene=21#wechat_redirect" data-linktype="2">答读者问(4)：inferCNV的几个问题</a></p><p data-tool="mdnice编辑器"><a href="https://mp.weixin.qq.com/s?__biz=MzkzMzE5NTM4NA==&amp;mid=2247484310&amp;idx=2&amp;sn=0b0fbf1e06032eaafed4720271df821a&amp;chksm=c2517881f526f197c4932e3eb725f303c86aa5b826e79a4be8bfcbe6d5732384958c66bbc4bb&amp;scene=21#wechat_redirect" data-linktype="2">答读者问(2)：细胞cluster没有聚在一起；去不去批次效应</a></p><p data-tool="mdnice编辑器"><a href="https://mp.weixin.qq.com/s?__biz=MzkzMzE5NTM4NA==&amp;mid=2247484310&amp;idx=1&amp;sn=c6d0d8426b74abd1f037e2b63e068077&amp;chksm=c2517881f526f19715d53eba2416da1d1f8c43e648a7d300fe0fa23b5fcd8769e990299228cc&amp;scene=21#wechat_redirect" data-linktype="2">答读者问(1)：非模式物种找marker；如何根据marker定义细胞类型</a></p></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/XyjlQ33yE4o6ricbe8ZqnA",target="_blank" rel="noopener noreferrer">原文链接</a>
