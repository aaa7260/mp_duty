---
title: "[会员专享]图表复现再谈个性化热图绘制"
date: 2023-06-09T11:54:28Z
draft: ["false"]
tags: [
  "fetched",
  "R语言数据分析指南"
]
categories: ["Acdemic"]
---
[会员专享]图表复现再谈个性化热图绘制 by R语言数据分析指南
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><h3 data-tool="mdnice编辑器"><span></span><span><span></span>欢迎关注R语言数据分析指南</span><span></span></h3><blockquote data-tool="mdnice编辑器"><span>❝</span><p>最近在群里看到一张图，其本质仍然是相关性热图作者在图形布局上做了一些细微的改动使得整体看来有些许特别之处；下面小编就来复现一下，数据为自己构建仅供参考。<strong>「数据+代码已经上传2023VIP群，加群的观众老爷请自行下载」</strong></p><span>❞</span></blockquote><h3 data-tool="mdnice编辑器"><span></span><span><span></span>关注下方公众号下回更新不迷路</span><span></span></h3><section><mp-common-profile data-pluginname="mpprofile" data-id="Mzg3MzQzNTYzMw==" data-headimg="http://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZF0rpeZII9Ltl26VbVagriczTria1fib3XgjwwHEHFjPzkmGpqWDVVHBSzhENictUM2iavAKiaM5lc9USw/0?wx_fmt=png" data-nickname="R语言数据分析指南" data-alias="YanJANtwo" data-signature="R语言重症爱好者，喜欢绘制各种精美的图表，喜欢的小伙伴可以关注我，跟我一起学习" data-from="0" data-is_biz_ban="0"></mp-common-profile></section><h3 data-tool="mdnice编辑器"><span></span><span><span></span>原图</span><span></span></h3><figure data-tool="mdnice编辑器"><img data-ratio="0.9592696629213483" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZdHveibUSj6o9u28xPKXyia7qn0eJbibhwKerib3B2ibLtwnHdYglfW9mVpEOqxaDMst8uicsnwDJjllow/640?wx_fmt=png" data-type="png" data-w="712" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZdHveibUSj6o9u28xPKXyia7qn0eJbibhwKerib3B2ibLtwnHdYglfW9mVpEOqxaDMst8uicsnwDJjllow/640?wx_fmt=png"></figure><h3 data-tool="mdnice编辑器"><span></span><span><span></span>论文</span><span></span></h3><blockquote data-tool="mdnice编辑器"><span>❝</span><p>Environmental DNA metabarcoding reveals the influence of human activities on microeukaryotic plankton along the Chinese coastline</p><span>❞</span></blockquote><h3 data-tool="mdnice编辑器"><span></span><span><span></span>复现结果</span><span></span></h3><figure data-tool="mdnice编辑器"><img data-ratio="0.6833333333333333" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZdHveibUSj6o9u28xPKXyia7Uhiam52Fcric1YQxFdWjGhUYcq7YQ9Rzv0NDMqKg5Oic1ga5u8vd0lZRQ/640?wx_fmt=png" data-type="png" data-w="960" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZdHveibUSj6o9u28xPKXyia7Uhiam52Fcric1YQxFdWjGhUYcq7YQ9Rzv0NDMqKg5Oic1ga5u8vd0lZRQ/640?wx_fmt=png"></figure><h3 data-tool="mdnice编辑器"><span></span><span><span></span>加载R包</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code><span>library</span>(tidyverse)<br><span>library</span>(linkET)<br><span>library</span>(RColorBrewer)<br><span>library</span>(ggtext)<br><span>library</span>(magrittr)<br><span>library</span>(psych)<br><span>library</span>(reshape)<br><span>library</span>(cowplot)<br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span><span></span>导入数据</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code>table1 &lt;- read.delim(<span>"env.xls"</span>,header =<span>T</span>,sep=<span>"\t"</span>,row.names = <span>1</span>,check.names = <span>F</span>)<br><br>table2 &lt;- read.delim(<span>"genus.xls"</span>,header =<span>T</span>,sep=<span>"\t"</span>,row.names = <span>1</span>,check.names = <span>F</span>) %&gt;% <br>  t() %&gt;% as.data.frame()<br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span><span></span>数据整合</span><span></span></h3><blockquote data-tool="mdnice编辑器"><span>❝</span><p>此处跟以往一样还是进行相关性分析最终将数据整合</p><span>❞</span></blockquote><pre data-tool="mdnice编辑器"><span></span><code>pp &lt;- corr.test(table1,table2,method=<span>"pearson"</span>,adjust = <span>"fdr"</span>)<br><br>cor &lt;- pp$r<br>pvalue &lt;- pp$p<br><br>df &lt;- melt(cor) %&gt;% mutate(pvalue=melt(pvalue)[,<span>3</span>],<br>                     p_signif=symnum(pvalue, corr = <span>FALSE</span>, na = <span>FALSE</span>,  <br>                                     cutpoints = c(<span>0</span>, <span>0.001</span>, <span>0.01</span>, <span>0.05</span>, <span>0.1</span>, <span>1</span>), <br>                                     symbols = c(<span>"***"</span>, <span>"**"</span>, <span>"*"</span>, <span>""</span>, <span>" "</span>))) %&gt;% <br>  set_colnames(c(<span>"env"</span>,<span>"genus"</span>,<span>"r"</span>,<span>"p"</span>,<span>"p_signif"</span>))<br><br><span># 整合分组文件</span><br>cordata &lt;- df %&gt;% left_join(.,read_tsv(<span>'annotation.xls'</span>),by=c(<span>"genus"</span>)) %&gt;% <br>  select(group,env:p,-genus) %&gt;% <br>  set_colnames(c(<span>"spc"</span>,<span>"env"</span>,<span>"r"</span>,<span>"p"</span>)) %&gt;% <br>  mutate(rd = cut(r, breaks = c(-<span>Inf</span>, <span>0</span>, <span>0.4</span>, <span>Inf</span>),<br>                  labels = c(<span>"&lt; 0"</span>, <span>"0 - 0.4"</span>, <span>"&gt;= 0.4"</span>)),<br>         pd = cut(p, breaks = c(-<span>Inf</span>, <span>0.05</span>, <span>Inf</span>),<br>                  labels = c(<span>"&lt; 0.05"</span>,<span>"&gt;= 0.05"</span>)))<br></code></pre><blockquote data-tool="mdnice编辑器"><span>❝</span><p>有需要学习个性化数据可视化的朋友，欢迎到小编的<strong>「淘宝店铺」</strong> <strong>「R语言数据分析指南」</strong>购买<strong>「2023年度会员文档」</strong>同步更新中 <code>初始价格99元</code>6月后将调整价格为<strong>「149元」</strong>，内容主要包括各种<strong>「高分论文的图表分析复现以及一些个性化图表的绘制」</strong>均包含数据+代码；按照往年数据小编年产出约在150+以上</p><span>❞</span></blockquote><p data-tool="mdnice编辑器">购买后微信发小编订单截图即邀请进新的会员交流群，小编的文档为按年售卖，只包含当年度的<strong>「除系列课程外」</strong>的文档，有需要往年文档的朋友也可下单购买，需要了解更多信息的朋友欢迎交流咨询。</p><h3 data-tool="mdnice编辑器"><span></span><span><span></span>淘宝扫一扫</span><span></span></h3><figure data-tool="mdnice编辑器"><img data-ratio="1.6136783733826248" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZdHveibUSj6o9u28xPKXyia76ES60EicLFNAMVw2GmfzsZWwJMN5NdMXd5dYVEW0UBO7vruRZbmfHqQ/640?wx_fmt=png" data-type="png" data-w="541" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZdHveibUSj6o9u28xPKXyia76ES60EicLFNAMVw2GmfzsZWwJMN5NdMXd5dYVEW0UBO7vruRZbmfHqQ/640?wx_fmt=png"></figure><h3 data-tool="mdnice编辑器"><span></span><span><span></span>2023会员群精彩内容</span><span></span></h3><p data-tool="mdnice编辑器"><img data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZdHveibUSj6o9u28xPKXyia73VicMfIK3UTiaKepgHPODWCCy4xJRylZhD3YKkfxNe3ckOtBru5hP6TQ/640?wx_fmt=png" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZdHveibUSj6o9u28xPKXyia73VicMfIK3UTiaKepgHPODWCCy4xJRylZhD3YKkfxNe3ckOtBru5hP6TQ/640?wx_fmt=png"><img data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZdHveibUSj6o9u28xPKXyia7Iw2pclyEj4xsibw7HAhqRnNG5hicialuhJY6rQ0bkNF4npNb9n1aKZx5w/640?wx_fmt=png" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZdHveibUSj6o9u28xPKXyia7Iw2pclyEj4xsibw7HAhqRnNG5hicialuhJY6rQ0bkNF4npNb9n1aKZx5w/640?wx_fmt=png"><img data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZdHveibUSj6o9u28xPKXyia73UL95yGGn3gzuAbH9r1qnJDUM97Q4XgnUOosgwLmbZ1gw1jtlu1kRA/640?wx_fmt=png" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZdHveibUSj6o9u28xPKXyia73UL95yGGn3gzuAbH9r1qnJDUM97Q4XgnUOosgwLmbZ1gw1jtlu1kRA/640?wx_fmt=png"><img data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZdHveibUSj6o9u28xPKXyia7UB7KpFxU0icNVicfnR1g2Kqg2nc1D85RRIHIXyKzN72nk26ibr1iaAUtPg/640?wx_fmt=png" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZdHveibUSj6o9u28xPKXyia7UB7KpFxU0icNVicfnR1g2Kqg2nc1D85RRIHIXyKzN72nk26ibr1iaAUtPg/640?wx_fmt=png"><img data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZdHveibUSj6o9u28xPKXyia7ysO8WNLiba2mZkqGM36mNxSpo6glusVg67iaiaibk6FPIT1DicGvibwAeK0Q/640?wx_fmt=png" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZdHveibUSj6o9u28xPKXyia7ysO8WNLiba2mZkqGM36mNxSpo6glusVg67iaiaibk6FPIT1DicGvibwAeK0Q/640?wx_fmt=png"><img data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZdHveibUSj6o9u28xPKXyia7o0f57icDkdCOdvkQu3XJZSXqBAfHkz0sRHKmd2W9UZicIWEvlYmIFib6Q/640?wx_fmt=png" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZdHveibUSj6o9u28xPKXyia7o0f57icDkdCOdvkQu3XJZSXqBAfHkz0sRHKmd2W9UZicIWEvlYmIFib6Q/640?wx_fmt=png"></p><h3 data-tool="mdnice编辑器"><span></span><span><span></span>数据可视化</span><span></span></h3><p><mp-pay-preview-filter data-offset="24"></mp-pay-preview-filter></p></section></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/l18ff281kv7Fb04RczqWIw",target="_blank" rel="noopener noreferrer">原文链接</a>
