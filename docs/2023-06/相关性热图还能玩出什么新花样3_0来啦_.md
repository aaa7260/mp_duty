---
title: "相关性热图还能玩出什么新花样3.0来啦！"
date: 2023-06-14T03:26:46Z
draft: ["false"]
tags: [
  "fetched",
  "SCIPainter"
]
categories: ["Acdemic"]
---
相关性热图还能玩出什么新花样3.0来啦！ by SCIPainter
------
<div><section data-mpa-powered-by="yiban.io"><span>如何展示相关性结果？一般会选择使用corrplot包绘制相关性热图，往期教程可戳：</span><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzIyOTY3MDA3MA==&amp;mid=2247512207&amp;idx=1&amp;sn=c41c39c16cfe23a6df845a64cd71c071&amp;chksm=e8bddd56dfca5440db83f4bd828723bb88e4ee277d6c5c38639f698ab77d1f9668f5f1cb0021&amp;scene=21#wechat_redirect" textvalue="《相关性热图还能玩出什么新花样？造作起来！》" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2"><span>《相关性热图还能玩出什么新花样？造作起来！》</span></a><br></section><section><br></section><section><span>除了相关性热图，相关性矩阵也是文献会采用的方式，如下：</span></section><section><span><br></span></section><section><img data-ratio="0.9722222222222222" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mFXEjjRGOJLIEhLgLbDsxS3KvricDwA1gxuUbVfpcnqtkeibvNtGDCqiceMCpdia4TVulRtaoo80Hjrg/640?wx_fmt=png" data-type="png" data-w="540" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mFXEjjRGOJLIEhLgLbDsxS3KvricDwA1gxuUbVfpcnqtkeibvNtGDCqiceMCpdia4TVulRtaoo80Hjrg/640?wx_fmt=png"></section><section><span>（<em>Nat Immunol</em>，2023）</span></section><section><br></section><section><span>相关性矩阵非常灵活，能适配更多数据类型和应用情景，比如，同一个矩阵中上/下三角位置以及对角线处都可放置不同图表（下图左），还可以在同一个格子中对不同组进行直观比较（下图右）：</span></section><section><span><br></span></section><section><img data-ratio="0.43703703703703706" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mFXEjjRGOJLIEhLgLbDsxSLXKk4lz5s1j8X63JlnmHhYYbMysJgeC8265a7ut4qHs4PlYJNduakQ/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mFXEjjRGOJLIEhLgLbDsxSLXKk4lz5s1j8X63JlnmHhYYbMysJgeC8265a7ut4qHs4PlYJNduakQ/640?wx_fmt=png"></section><section><br></section><section><span>今天分享一个相关性矩阵绘制R包</span><strong><span>corrmorant</span></strong><span>，不管是上述相关性矩阵还是下面的相关性热图，全都能轻松拿捏，任你自由组合！</span></section><section><br></section><section><img data-ratio="0.4398148148148148" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mFXEjjRGOJLIEhLgLbDsxSX2047pkVqaKHsDgeBAf5yLicfOTkkZcYAXp7EzTqT4ia64kTuJlL3M5Q/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mFXEjjRGOJLIEhLgLbDsxSX2047pkVqaKHsDgeBAf5yLicfOTkkZcYAXp7EzTqT4ia64kTuJlL3M5Q/640?wx_fmt=png"></section><section><br></section><p><br></p><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>#相关R包安装与载入：</span><br mpa-from-tpl="t"><span>remotes</span>::install_github(<span>"r-link/corrmorant"</span>)<br mpa-from-tpl="t"><span>library</span>(corrmorant)<br mpa-from-tpl="t"><span>library</span>(ggplot2)<br mpa-from-tpl="t"><span>library</span>(cols4all)<br mpa-from-tpl="t"><br mpa-from-tpl="t"><span>#测试数据：</span><br mpa-from-tpl="t"><span>dt</span> &lt;- drosera <span>#数据集展示了三种非洲茅属植物的叶和叶柄大小</span><br mpa-from-tpl="t"><span>head</span>(dt)<br mpa-from-tpl="t"><span>table</span>(dt$species)<br mpa-from-tpl="t"><span>table</span>(dt$variety)</code></pre></section><p><br></p><section><br></section><section><img data-ratio="0.425" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mFXEjjRGOJLIEhLgLbDsxSbjcIDticiaedBEzVso5RhFRojP0TUUXt7twKCowg8N5E8hl3xbwYX5jw/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mFXEjjRGOJLIEhLgLbDsxSbjcIDticiaedBEzVso5RhFRojP0TUUXt7twKCowg8N5E8hl3xbwYX5jw/640?wx_fmt=png"></section><p><br></p><p><br mpa-from-tpl="t"></p><section data-mpa-template="t" mpa-from-tpl="t"><section data-mpa-template="t" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><br mpa-from-tpl="t"></section><section data-mid="" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><br mpa-from-tpl="t"></section><section data-mid="" mpa-from-tpl="t"><br mpa-from-tpl="t"></section><section data-mid="" mpa-from-tpl="t"><p data-mid="">1. 相关性矩阵绘制</p></section><section data-mid="" mpa-from-tpl="t"><br mpa-from-tpl="t"></section><section data-mid="" mpa-from-tpl="t"><br mpa-from-tpl="t"></section></section></section></section></section></section><p><br></p><p><br></p><section><span>首先，我们在下三角放置散点和拟合曲线，上三角放置相关性系数，对角线添加直方图：</span></section><section><br></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>p</span> &lt;- ggcorrm(dt,<br mpa-from-tpl="t">             <span>corr_method</span> = c('pearson')) + <span>#分析方法选择,可选'pearson','kendall' or 'spearman'</span><br mpa-from-tpl="t">  <span>lotri</span>(geom_point()) + <span>#下三角区域添加散点图</span><br mpa-from-tpl="t">  <span>lotri</span>(geom_smooth(method = 'lm')) + <span>#下三角区域添加拟合曲线</span><br mpa-from-tpl="t">  <span>utri_corrtext</span>(corr_size = TRUE) + <span>#上三角区域添加相关性系数</span><br mpa-from-tpl="t">  <span>dia_names</span>(y_pos = 0.15) + <span>#对角线区域添加分类标签</span><br mpa-from-tpl="t">  <span>dia_histogram</span>(lower = 0.3, upper = 0.98, color = 'grey30') <span>#对角线区域添加直方图</span><br mpa-from-tpl="t"><span>p</span></code></pre></section><p><br></p><section><br></section><section><img data-ratio="0.9944444444444445" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mFXEjjRGOJLIEhLgLbDsxSlauQCzicyZicnutrBe8qicic0VJHP3kYPhopZOh7Rlg20gXqqmW86ay6MQ/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mFXEjjRGOJLIEhLgLbDsxSlauQCzicyZicnutrBe8qicic0VJHP3kYPhopZOh7Rlg20gXqqmW86ay6MQ/640?wx_fmt=png"></section><section><br></section><section><span>对角线位置放置核密度曲线也是不错的展示方式：</span></section><section><br></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>#颜色自定义+区域图表更换：</span><br mpa-from-tpl="t"><span>p1</span> &lt;- ggcorrm(data = dt,<br mpa-from-tpl="t">              <span>corr_method</span> = c('pearson')) + <br mpa-from-tpl="t">  <span>lotri</span>(geom_point(alpha = 0.3)) + <br mpa-from-tpl="t">  <span>lotri</span>(geom_smooth(method = 'lm',<br mpa-from-tpl="t">                    <span>fill</span> = '#FBB4AE',color = '#F0027F')) + <br mpa-from-tpl="t">  <span>utri_corrtext</span>(corr_size = FALSE) + <span>#逻辑值为TRUE时，按照相关性强弱调整系数文本大小；FALSE则按相同大小显示</span><br mpa-from-tpl="t">  <span>dia_names</span>(y_pos = 0.15, size = 3.5) + <br mpa-from-tpl="t">  <span>dia_density</span>(lower = 0.3, upper = 0.98,<br mpa-from-tpl="t">              <span>fill</span> = '#F0027F', color = '#F0027F', alpha = 0.3) <span>#对角线区域添加核密度曲线</span><br mpa-from-tpl="t"><span>p1</span></code></pre></section><p><br></p><section><br></section><section><img data-ratio="0.9981481481481481" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mFXEjjRGOJLIEhLgLbDsxSAPtpA8AGJ15PxxCOkthLIibyywmJ0bgiavWVKBNwEUJIDaDS7Ds2NpsQ/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mFXEjjRGOJLIEhLgLbDsxSAPtpA8AGJ15PxxCOkthLIibyywmJ0bgiavWVKBNwEUJIDaDS7Ds2NpsQ/640?wx_fmt=png"></section><section><span><br></span></section><section><span><br></span></section><section data-mpa-template="t" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><br mpa-from-tpl="t"></section><section data-mid="" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><br mpa-from-tpl="t"></section><section data-mid="" mpa-from-tpl="t"><br mpa-from-tpl="t"></section><section data-mid="" mpa-from-tpl="t"><p data-mid="">2. 组别映射</p></section><section data-mid="" mpa-from-tpl="t"><br mpa-from-tpl="t"></section><section data-mid="" mpa-from-tpl="t"><br mpa-from-tpl="t"></section></section></section></section></section><section><br></section><section><br></section><section><span>当数据存在不同组别时，可通过颜色映射进行直观比较：</span></section><section><br></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>p2</span> &lt;- ggcorrm(data = dt, <br mpa-from-tpl="t">              <span>mapping</span> = aes(color = species, fill = species)) + <br mpa-from-tpl="t">  <span>lotri</span>(geom_point(alpha = 0.3)) +<br mpa-from-tpl="t">  <span>lotri</span>(geom_smooth(method = 'lm')) +<br mpa-from-tpl="t">  <span>utri_corrtext</span>(nrow = 2, #<br mpa-from-tpl="t">                <span>squeeze</span> = 0.5, <span>#存在多标签时，用于调整宽/高比例</span><br mpa-from-tpl="t">                <span>corr_size</span> = F) + <br mpa-from-tpl="t">  <span>dia_names</span>(y_pos = 0.15, size = 3.5) +<br mpa-from-tpl="t">  <span>dia_density</span>(lower = 0.3, upper = 0.98,<br mpa-from-tpl="t">              <span>alpha</span> = 0.6)<br mpa-from-tpl="t"><span>p2</span></code></pre></section><p><br></p><section><br></section><section><img data-ratio="0.7722222222222223" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mFXEjjRGOJLIEhLgLbDsxSGZAhF5CcMtWXEibOV6icZJTgNDY2s1RuRYWfYwvxRWNQC7PZtDe1GyYQ/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mFXEjjRGOJLIEhLgLbDsxSGZAhF5CcMtWXEibOV6icZJTgNDY2s1RuRYWfYwvxRWNQC7PZtDe1GyYQ/640?wx_fmt=png"></section><section><br></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>#自定义分类颜色：</span><br mpa-from-tpl="t"><span>c4a_gui</span>()<br mpa-from-tpl="t"><span>mycol</span> &lt;- c4a('10',3)<br mpa-from-tpl="t"><br mpa-from-tpl="t"><span>p3</span> &lt;- p2 +<br mpa-from-tpl="t">  <span>scale_color_manual</span>(values = mycol) +<br mpa-from-tpl="t">  <span>scale_fill_manual</span>(values = mycol)<br mpa-from-tpl="t"><span>p3</span></code></pre></section><p><br></p><section><br></section><section><img data-ratio="0.7722222222222223" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mFXEjjRGOJLIEhLgLbDsxSzlSicuSPPRdH7xTl1DkWHMTvzW2zMzeldiaEUZpj5OSh2eDvHBcSbk5Q/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mFXEjjRGOJLIEhLgLbDsxSzlSicuSPPRdH7xTl1DkWHMTvzW2zMzeldiaEUZpj5OSh2eDvHBcSbk5Q/640?wx_fmt=png"></section><section><br></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>#自定义主题相关参数：</span><br mpa-from-tpl="t"><span>mytheme1</span> &lt;- theme(<br mpa-from-tpl="t">  <span>axis</span>.text = element_text(size = 7),<br mpa-from-tpl="t">  <span>strip</span>.text = element_text(size = 10),<br mpa-from-tpl="t">  <span>legend</span>.text = element_text(size = 9),<br mpa-from-tpl="t">  <span>legend</span>.title = element_text(size = 10)<br mpa-from-tpl="t">)<br mpa-from-tpl="t"><br mpa-from-tpl="t"><span>p4</span> &lt;- p3 + mytheme1<br mpa-from-tpl="t"><span>p4</span></code></pre></section><p><br></p><section><br></section><section><img data-ratio="0.7435185185185185" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mFXEjjRGOJLIEhLgLbDsxSwnhHB1V8r4fuzXHhkl2CvBicdLjjYjRLWoS3La4nsKUvQlsU0kPtvGA/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mFXEjjRGOJLIEhLgLbDsxSwnhHB1V8r4fuzXHhkl2CvBicdLjjYjRLWoS3La4nsKUvQlsU0kPtvGA/640?wx_fmt=png"></section><section><br></section><section><span>PS：三个区域可布局函数大家可参考下图，结合自己的数据和背景需求灵活布局。</span></section><section><span><br></span></section><section><img data-ratio="1.6425925925925926" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mFXEjjRGOJLIEhLgLbDsxScL7O40SO6Kic8oomaiaseHohKiaXxaotn8wLyJFvxhPobmZxox28kYqfQ/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mFXEjjRGOJLIEhLgLbDsxScL7O40SO6Kic8oomaiaseHohKiaXxaotn8wLyJFvxhPobmZxox28kYqfQ/640?wx_fmt=png"></section><section><span>（函数一览）</span></section><section><br></section><section><br></section><section data-mpa-template="t" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><br mpa-from-tpl="t"></section><section data-mid="" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><br mpa-from-tpl="t"></section><section data-mid="" mpa-from-tpl="t"><br mpa-from-tpl="t"></section><section data-mid="" mpa-from-tpl="t"><p data-mid="">3. 相关性热图绘制</p></section><section data-mid="" mpa-from-tpl="t"><br mpa-from-tpl="t"></section><section data-mid="" mpa-from-tpl="t"><br mpa-from-tpl="t"></section></section></section></section></section><section><span><br></span></section><section><span>下面再来看看如何绘制带热图的相关性矩阵。</span></section><section><br></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>df</span> &lt;- mtcars <span>#使用mtcars测试</span><br mpa-from-tpl="t"><span>head</span>(df)</code></pre></section><p><br></p><section><br></section><section><img data-ratio="0.21388888888888888" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mFXEjjRGOJLIEhLgLbDsxSz6hzS5PIS03IxWczopr3tvYbfhEVqotNUkBmxxsjGiaPAIUOMePezsA/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mFXEjjRGOJLIEhLgLbDsxSz6hzS5PIS03IxWczopr3tvYbfhEVqotNUkBmxxsjGiaPAIUOMePezsA/640?wx_fmt=png"></section><section><br></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>p5</span> &lt;- ggcorrm(data = df, <br mpa-from-tpl="t">              <span>mapping</span> = aes(color = .corr, fill = .corr), <br mpa-from-tpl="t">              <span>corr_method</span> = c('pearson'),<br mpa-from-tpl="t">              <span>rescale</span> = 'by_sd') + <br mpa-from-tpl="t">  <span>lotri_heatcircle</span>(alpha = 1, color = 'grey') + <span>#下三角区域添加圆形热图</span><br mpa-from-tpl="t">  <span>utri_corrtext</span>(squeeze = 0.6, corr_size = F) +<br mpa-from-tpl="t">  <span>dia_names</span>(y_pos = 0.5, size = 5, color = 'black')<br mpa-from-tpl="t"><span>p5</span></code></pre></section><p><br></p><section><br></section><section><img data-ratio="0.9944444444444445" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mFXEjjRGOJLIEhLgLbDsxSlhKibr4VJfzCYdtrTplBGKDILtfWcf0hHmP7Wccr2QDR1pqjG5PbialA/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mFXEjjRGOJLIEhLgLbDsxSlhKibr4VJfzCYdtrTplBGKDILtfWcf0hHmP7Wccr2QDR1pqjG5PbialA/640?wx_fmt=png"></section><section><br></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>#使用内置色板：</span><br mpa-from-tpl="t"><span>p6</span> &lt;- p5 +<br mpa-from-tpl="t">  <span>scale_color_corr</span>(aesthetics = c(<span>"fill"</span>, <span>"color"</span>),<br mpa-from-tpl="t">                   <span>option</span> = 'D') <span>#提供A-D四种内置渐变配色可选</span><br mpa-from-tpl="t"><span>p6</span></code></pre></section><p><br></p><section><br></section><section><img data-ratio="0.8574074074074074" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mFXEjjRGOJLIEhLgLbDsxSUxqCibGK012XU0PY2Dbia3NN35p4eUPyQqTPtiakL07nN3PKCBss3j3Gg/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mFXEjjRGOJLIEhLgLbDsxSUxqCibGK012XU0PY2Dbia3NN35p4eUPyQqTPtiakL07nN3PKCBss3j3Gg/640?wx_fmt=png"></section><section><br></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>#也可自定义渐变配色：</span><br mpa-from-tpl="t"><span>p7</span> &lt;- p5 +<br mpa-from-tpl="t">  <span>scale_colour_gradient2</span>(aesthetics = c(<span>"fill"</span>, <span>"color"</span>),<br mpa-from-tpl="t">                         <span>limits</span> = c(-1, 1),<br mpa-from-tpl="t">                         <span>low</span> = '#06a7cd',<br mpa-from-tpl="t">                         <span>mid</span> = <span>"white"</span>,<br mpa-from-tpl="t">                         <span>high</span> = '#e74a32')<br mpa-from-tpl="t"><span>p7</span></code></pre></section><p><br></p><section><br></section><section><img data-ratio="0.8574074074074074" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mFXEjjRGOJLIEhLgLbDsxSVibowia39SSPSTibUibChQ71axoIPHGoDITUl1dp5ia5DUUICqukKucGJWQ/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mFXEjjRGOJLIEhLgLbDsxSVibowia39SSPSTibUibChQ71axoIPHGoDITUl1dp5ia5DUUICqukKucGJWQ/640?wx_fmt=png"></section><section><br></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>#主题参数美化：</span><br mpa-from-tpl="t"><span>mytheme2</span> &lt;- theme(<br mpa-from-tpl="t">  <span>axis</span>.text = element_blank(),<br mpa-from-tpl="t">  <span>axis</span>.ticks = element_blank(),<br mpa-from-tpl="t">  <span>strip</span>.text = element_blank(),<br mpa-from-tpl="t">  <span>legend</span>.text = element_text(size = 10),<br mpa-from-tpl="t">  <span>legend</span>.title = element_text(size = 12)<br mpa-from-tpl="t">)<br mpa-from-tpl="t"><br mpa-from-tpl="t"><span>p8</span> &lt;- p7 + mytheme2<br mpa-from-tpl="t"><span>p8</span></code></pre></section><p><br></p><section><br></section><section><img data-ratio="0.8888888888888888" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mFXEjjRGOJLIEhLgLbDsxSDGeqyJ5gBO2BhOR5hktHo4TTIawflG9QFAsqFCuW3PXwrkxSCLX9Pw/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mFXEjjRGOJLIEhLgLbDsxSDGeqyJ5gBO2BhOR5hktHo4TTIawflG9QFAsqFCuW3PXwrkxSCLX9Pw/640?wx_fmt=png"></section><section><br></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>#其它样式组合</span><br mpa-from-tpl="t"><span>##上下三角区域颠倒+添加相关性热图背景色块</span><br mpa-from-tpl="t"><span>p9</span> &lt;- ggcorrm(data = df, <br mpa-from-tpl="t">              <span>corr_method</span> = c('pearson'),<br mpa-from-tpl="t">              <span>rescale</span> = 'by_sd') + <br mpa-from-tpl="t">  <span>utri_heatcircle</span>(alpha = 1) + <br mpa-from-tpl="t">  <span>lotri_heatmap</span>(alpha = 0.6) + <br mpa-from-tpl="t">  <span>lotri_corrtext</span>(nrow = 2, squeeze = 0.6, corr_size = F) +<br mpa-from-tpl="t">  <span>dia_names</span>(y_pos = 0.5, size = 5, color = 'black') +<br mpa-from-tpl="t">  <span>scale_colour_gradient2</span>(aesthetics = c(<span>"fill"</span>, <span>"color"</span>),<br mpa-from-tpl="t">                         <span>limits</span> = c(-1, 1),<br mpa-from-tpl="t">                         <span>low</span> = '#06a7cd',<br mpa-from-tpl="t">                         <span>mid</span> = 'white',<br mpa-from-tpl="t">                         <span>high</span> = '#e74a32') +<br mpa-from-tpl="t">  <span>mytheme2</span><br mpa-from-tpl="t"><span>p9</span></code></pre></section><p><br></p><section><br></section><section><img data-ratio="0.8888888888888888" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mFXEjjRGOJLIEhLgLbDsxSUwZ6lHlhjQ5Fto1ficVRCnhQ8ZQHG9eH4oantzX3auRicTo69JhHkFKA/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mFXEjjRGOJLIEhLgLbDsxSUwZ6lHlhjQ5Fto1ficVRCnhQ8ZQHG9eH4oantzX3auRicTo69JhHkFKA/640?wx_fmt=png"></section><section><br></section><section><span>更多细节感兴趣可结合作者说明文档自行探索。好啦，今天的分享就到这里！</span></section><section><span><br mpa-from-tpl="t"></span></section><section data-mpa-template="t" mpa-from-tpl="t"><section data-mpa-template="t" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><br></section><section data-mid="" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><p data-mid="">参考资料&amp;文献</p></section></section></section></section></section></section><p><br></p><section><span>参考资料：</span></section><section><span>https://github.com/r-link/corrmorant</span></section><section><br></section><section><span>参考文献：</span></section><section><span>Kwok, A.J., Allcock, A., Ferreira, R.C. et al. Neutrophils and emergency granulopoiesis drive immune suppression and an extreme response endotype during sepsis. Nat Immunol 24, 767–779 (2023).</span></section><section><span><br></span></section><section><span><br></span></section><p><strong><span>*未经许可，不得以任何方式复制或抄袭本篇文章之部分或全部内容。版权所有，侵权必究。</span></strong></p><p><br></p><section data-role="outer" label="Powered by 135editor.com"><section data-tools="135编辑器" data-id="105648"><section><section data-role="outer" label="Powered by 135editor.com"><section data-role="paragraph"><section data-role="outer" label="Powered by 135editor.com"><section data-tools="135编辑器" data-id="105648"><section><section><img data-ratio="0.8780487804878049" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6kCKJYcEqEIfoJYG621mPJE8VibmibGU0Jxic9iabARVRH0FT6BNE8VAglWFXBPibFAU7a6tWGibSs8wyUg/640?wx_fmt=png" data-type="png" data-w="41" data-width="100%" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6kCKJYcEqEIfoJYG621mPJE8VibmibGU0Jxic9iabARVRH0FT6BNE8VAglWFXBPibFAU7a6tWGibSs8wyUg/640?wx_fmt=png"></section><section><section><section data-width="35%"><section><section data-width="100%"><img data-ratio="1" data-src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/tgUVxVRjT6kCKJYcEqEIfoJYG621mPJEv5etCBwHicqbEPwnVrkpaasxqaVibM4mT2JdIuN6yTlYWDD4mL5A427A/640?wx_fmt=jpeg" data-type="jpeg" data-w="860" data-width="100%" title="SCIPainter 30cm二维码.jpg" src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/tgUVxVRjT6kCKJYcEqEIfoJYG621mPJEv5etCBwHicqbEPwnVrkpaasxqaVibM4mT2JdIuN6yTlYWDD4mL5A427A/640?wx_fmt=jpeg"></section></section></section><section data-width="50%"><section><section data-brushtype="text"><span><strong># SCIPainter</strong></span></section><section data-brushtype="text" hm_fix="361:593"><p>基迪奥旗下绘图公众号</p><p>分享科研绘图技能与工具</p><p>欢迎关注与转发~</p></section></section></section></section></section></section></section></section></section></section><section><br></section></section></section><section data-role="paragraph"><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><img data-ratio="1" data-src="https://mmbiz.qpic.cn/sz_mmbiz_gif/tgUVxVRjT6kCKJYcEqEIfoJYG621mPJEgMd0aMPtmrDjiaX8sBhfhicVteeHf1JicexSpUbS3fdS9SiboUVN7guaPw/640?wx_fmt=gif" data-type="gif" data-w="400" src="https://mmbiz.qpic.cn/sz_mmbiz_gif/tgUVxVRjT6kCKJYcEqEIfoJYG621mPJEgMd0aMPtmrDjiaX8sBhfhicVteeHf1JicexSpUbS3fdS9SiboUVN7guaPw/640?wx_fmt=gif"></section></section></section><section><section powered-by="xiumi.us"><section><p><span><strong>你的好友拍了拍你</strong></span></p><p><span><strong>并请你帮她点一下</strong></span><strong><span>“分享”</span></strong><span><strong><span>~</span></strong></span></p></section></section></section></section></section><p><br></p></section></section><section><span><br></span></section><p><mp-style-type data-value="10000"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/x1yAEhNtS1Vr7pkTqpbwrw",target="_blank" rel="noopener noreferrer">原文链接</a>
