---
title: "手把手带你复现NC图表之Figure6"
date: 2023-06-17T08:12:14Z
draft: ["false"]
tags: [
  "fetched",
  "单细胞天地"
]
categories: ["Acdemic"]
---
手把手带你复现NC图表之Figure6 by 单细胞天地
------
<div><section data-style-type="5" data-tools="新媒体排版" data-id="2430070"><section data-style-type="5" data-tools="新媒体排版" data-id="2390348"><section><section powered-by="xiumi.us"><section><section><section powered-by="xiumi.us"><section><section><br></section><section><section><section powered-by="xiumi.us"><section><section><p>分享是一种态度</p></section></section></section></section></section></section></section></section><section><section powered-by="xiumi.us"><section><section><img data-ratio="0.8738095238095238" data-src="https://mmbiz.qpic.cn/mmbiz_gif/siaia0BDGJdjSnnb9ibXpFagGPWQ0JjSSTNVBZthROEhicfINuLcxX2Ro3Zb600LJhrzeYIb120tLjSVXEtLn14DwA/640?wx_fmt=gif" data-type="gif" data-w="420" width="100%" src="https://mmbiz.qpic.cn/mmbiz_gif/siaia0BDGJdjSnnb9ibXpFagGPWQ0JjSSTNVBZthROEhicfINuLcxX2Ro3Zb600LJhrzeYIb120tLjSVXEtLn14DwA/640?wx_fmt=gif"></section></section></section></section></section></section></section></section></section><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><h2 data-tool="mdnice编辑器"><span></span><span>复现文章信息：</span></h2><blockquote data-tool="mdnice编辑器"><p><span>题目</span>：<strong>Single-cell analysis reveals prognostic fibroblast subpopulations linked to molecular and immunological subtypes of lung cancer</strong><br><span>期刊</span>：Nature Communications<br><span>日期</span>：2023年1月31日<br><span>DOI</span>: 10.1038/s41467-023-35832-6</p></blockquote><figure data-tool="mdnice编辑器"><img data-ratio="1.337037037037037" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQ6FQPybiaic5ojHIHrTuNoLd6T9RdOEoQAdKVfDMCLokqGW0qx0RDVE5OEHR8ia1OJId5qKbpVsB2Rg/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQ6FQPybiaic5ojHIHrTuNoLd6T9RdOEoQAdKVfDMCLokqGW0qx0RDVE5OEHR8ia1OJId5qKbpVsB2Rg/640?wx_fmt=png"></figure><h2 data-tool="mdnice编辑器"><span></span><span>复现图——Figure 6</span></h2><figure data-tool="mdnice编辑器"><img data-ratio="1.0075757575757576" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQ6FQPybiaic5ojHIHrTuNoLdok78VzGsIMtwxicrqeysr9vVX9Q3hoiaA7H0ibHD9dVfZbsNACKmRchLg/640?wx_fmt=png" data-type="png" data-w="792" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQ6FQPybiaic5ojHIHrTuNoLdok78VzGsIMtwxicrqeysr9vVX9Q3hoiaA7H0ibHD9dVfZbsNACKmRchLg/640?wx_fmt=png"><figcaption>使用多个NSCLC队列进行生存分析</figcaption></figure><h3 data-tool="mdnice编辑器"><span></span><span>R包载入与数据准备</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code>options(stringsAsFactors = <span>F</span>)<br>pardefault &lt;- par()<br><span>library</span>(Seurat)<br><span>library</span>(tidyverse)<br><span>library</span>(ggpubr)<br><span>library</span>(ggsci)<br><span>library</span>(survival)<br><span>library</span>(survminer)<br><span>library</span>(forestmodel)<br>data_directory &lt;- <span>"H:\\文献复现\\6\\"</span> <br><span>source</span>(paste0(data_directory, <span>"0_NewFunctions.R"</span>))<br><br>load(paste0(data_directory, <span>"BulkData_Zenodo.Rdata"</span>))<br>load(paste0(data_directory, <span>"IntegratedFibs_Zenodo.Rdata"</span>))<br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span>LUAD单变量COX回归</span><span></span></h3><p data-tool="mdnice编辑器">为了检测肌成纤维细胞丰度作为LUAD患者分层预后生物标志物的可能性，使用TCGA-LUAD数据集测试</p><pre data-tool="mdnice编辑器"><span></span><code><span>#为了研究将肌成纤维细胞丰度作为LUAD患者分层的预后生物标志物的潜力，我们使用TCGA-LUAD数据集作为测试队列，以确定将样本分类为肌成纤维细胞高和低的最佳阈值</span><br><br>ys2test &lt;- rev(seq(<span>1</span>,<span>10</span>, by = <span>1</span>))<br>cox.zph_OK &lt;- list()<br><span>for</span>(DS <span>in</span> levels(Merged.LUADtraits$Dataset.factor)[]){<br>  surv_data &lt;- Merged.LUADtraits[Merged.LUADtraits$Sample.Subtype == <span>"LUAD"</span> &amp;<br>                               Merged.LUADtraits$Dataset.factor == DS, ]<br>  <br>  cox.zph_p = <span>0</span><br>  <span>for</span>(i <span>in</span> ys2test){<br>    <span>if</span> (cox.zph_p &lt; <span>0.05</span>) {<br>      split_data &lt;- survSplit(Surv(OS_YEARS, OS) ~ <br>                                Myo_Fibs.pct,<br>                              zero = -<span>0.1</span>,<br>                              data = surv_data[!is.na(surv_data$OS_YEARS), ],<br>                              cut = i, episode = <span>"tgroup"</span>, id = <span>"id"</span>)<br>      model.coxph2 &lt;- coxph(Surv(OS_YEARS, OS) ~ <br>                              Myo_Fibs.pct,<br>                            data = split_data[split_data$tgroup == <span>1</span>,])<br>      cox.zph_res = cox.zph(model.coxph2)<br>      cox.zph_res.sum = c(i, cox.zph_res$table[<span>1</span>,<span>3</span>])<br>      cox.zph_p &lt;- cox.zph_res$table[<span>1</span>,<span>3</span>]<br>      names(cox.zph_res.sum) &lt;- c(<span>"OS_YEARS"</span>, <span>"cox.zph_p"</span>)<br>    }<br>    cox.zph_OK[[DS]] &lt;- cox.zph_res.sum<br>  }<br>}<br>do.call(rbind, cox.zph_OK)<br>max_year &lt;- min(do.call(rbind, cox.zph_OK)[,<span>1</span>])<br><span>#分别对每个数据集进行Cox回归分析</span><br>split_data &lt;- list()<br><span>for</span>(DS <span>in</span> levels(Merged.LUADtraits$Dataset.factor)[]){<br>  surv_data &lt;- Merged.LUADtraits[Merged.LUADtraits$Sample.Subtype == <span>"LUAD"</span> &amp;<br>                               Merged.LUADtraits$Dataset.factor == DS, ]<br>  split_data[[DS]] &lt;- survSplit(Surv(OS_YEARS, OS) ~ <br>                                  Myo_Fibs.pct + Alveolar_Fibs.pct + Adventitial_Fibs.pct,<br>                                zero = -<span>0.1</span>,<br>                                data = surv_data[!is.na(surv_data$OS_YEARS), ],<br>                                cut = max_year, episode = <span>"tgroup"</span>, id = <span>"id"</span>)<br>}<br>Myo_cox.res &lt;- list()<br>Myo_cox.res[[<span>"TCGA"</span>]]  &lt;- coxph(Surv(OS_YEARS, OS) ~ <br>                                  scale(Myo_Fibs.pct),<br>                                data =  split_data[[<span>"TCGA"</span>]][split_data[[<span>"TCGA"</span>]]$tgroup == <span>1</span>,])<br>Myo_cox.res[[<span>"GSE68465"</span>]]  &lt;- coxph(Surv(OS_YEARS, OS) ~ <br>                                     scale(Myo_Fibs.pct),<br>                                   data =  split_data[[<span>"GSE68465"</span>]][split_data[[<span>"GSE68465"</span>]]$tgroup == <span>1</span>,])<br>Myo_cox.res[[<span>"GSE31210"</span>]]  &lt;- coxph(Surv(OS_YEARS, OS) ~ <br>                                     scale(Myo_Fibs.pct),<br>                                   data =  split_data[[<span>"GSE31210"</span>]][split_data[[<span>"GSE31210"</span>]]$tgroup == <span>1</span>,])<br>Myo_cox.res[[<span>"GSE72094"</span>]]  &lt;- coxph(Surv(OS_YEARS, OS) ~ <br>                                      scale(Myo_Fibs.pct),<br>                                    data =  split_data[[<span>"GSE72094"</span>]][split_data[[<span>"GSE72094"</span>]]$tgroup == <span>1</span>,])<br>forestmodel::forest_model(model_list = Myo_cox.res, panels = panels)<br>Myo_LUAD_Zscores &lt;- list()<br><span>for</span>(DS <span>in</span> names(Myo_cox.res)){<br>  Myo_LUAD_Zscores[[DS]] &lt;- summary(Myo_cox.res[[DS]])$coefficients[<span>4</span>:<span>5</span>]<br>}<br>Myo_LUAD_pvals &lt;- list()<br><span>for</span>(DS <span>in</span> names(Myo_cox.res)){<br>  Myo_LUAD_pvals[[DS]] &lt;- summary(Myo_cox.res[[DS]])$coefficients[<span>5</span>]<br>}<br>Myo_LUAD_pvals<br>metap::sumz(unlist(Myo_LUAD_pvals))<br>Alveolar_cox.res &lt;- list()<br>Alveolar_cox.res[[<span>"TCGA"</span>]]  &lt;- coxph(Surv(OS_YEARS, OS) ~ <br>                                  scale(Alveolar_Fibs.pct),<br>                                data =  split_data[[<span>"TCGA"</span>]][split_data[[<span>"TCGA"</span>]]$tgroup == <span>1</span>,])<br>Alveolar_cox.res[[<span>"GSE68465"</span>]]  &lt;- coxph(Surv(OS_YEARS, OS) ~ <br>                                     scale(Alveolar_Fibs.pct),<br>                                   data =  split_data[[<span>"GSE68465"</span>]][split_data[[<span>"GSE68465"</span>]]$tgroup == <span>1</span>,])<br>Alveolar_cox.res[[<span>"GSE31210"</span>]]  &lt;- coxph(Surv(OS_YEARS, OS) ~ <br>                                     scale(Alveolar_Fibs.pct),<br>                                   data =  split_data[[<span>"GSE31210"</span>]][split_data[[<span>"GSE31210"</span>]]$tgroup == <span>1</span>,])<br>Alveolar_cox.res[[<span>"GSE72094"</span>]]  &lt;- coxph(Surv(OS_YEARS, OS) ~ <br>                                      scale(Alveolar_Fibs.pct),<br>                                    data =  split_data[[<span>"GSE72094"</span>]][split_data[[<span>"GSE72094"</span>]]$tgroup == <span>1</span>,])<br><br>forestmodel::forest_model(model_list = Alveolar_cox.res, panels = panels)<br>Alveolar_LUAD_Zscores &lt;- list()<br><span>for</span>(DS <span>in</span> names(Alveolar_cox.res)){<br>  Alveolar_LUAD_Zscores[[DS]] &lt;- summary(Alveolar_cox.res[[DS]])$coefficients[<span>4</span>:<span>5</span>]<br>}<br>Alveolar_LUAD_pvals &lt;- list()<br><span>for</span>(DS <span>in</span> names(Alveolar_cox.res)){<br>  Alveolar_LUAD_pvals[[DS]] &lt;- summary(Alveolar_cox.res[[DS]])$coefficients[<span>5</span>]<br>}<br>Alveolar_LUAD_pvals<br>metap::sumz(unlist(Alveolar_LUAD_pvals))<br>Adventitial_cox.res &lt;- list()<br>Adventitial_cox.res[[<span>"TCGA"</span>]]  &lt;- coxph(Surv(OS_YEARS, OS) ~ <br>                                  scale(Adventitial_Fibs.pct),<br>                                data =  split_data[[<span>"TCGA"</span>]][split_data[[<span>"TCGA"</span>]]$tgroup == <span>1</span>,])<br>Adventitial_cox.res[[<span>"GSE68465"</span>]]  &lt;- coxph(Surv(OS_YEARS, OS) ~ <br>                                     scale(Adventitial_Fibs.pct),<br>                                   data =  split_data[[<span>"GSE68465"</span>]][split_data[[<span>"GSE68465"</span>]]$tgroup == <span>1</span>,])<br>Adventitial_cox.res[[<span>"GSE31210"</span>]]  &lt;- coxph(Surv(OS_YEARS, OS) ~ <br>                                     scale(Adventitial_Fibs.pct),<br>                                   data =  split_data[[<span>"GSE31210"</span>]][split_data[[<span>"GSE31210"</span>]]$tgroup == <span>1</span>,])<br>Adventitial_cox.res[[<span>"GSE72094"</span>]]  &lt;- coxph(Surv(OS_YEARS, OS) ~ <br>                                      scale(Adventitial_Fibs.pct),<br>                                    data =  split_data[[<span>"GSE72094"</span>]][split_data[[<span>"GSE72094"</span>]]$tgroup == <span>1</span>,])<br>forestmodel::forest_model(model_list = Adventitial_cox.res, panels = panels)<br>Adventitial_LUAD_Zscores &lt;- list()<br><span>for</span>(DS <span>in</span> names(Adventitial_cox.res)){<br>  Adventitial_LUAD_Zscores[[DS]] &lt;- summary(Adventitial_cox.res[[DS]])$coefficients[<span>4</span>:<span>5</span>]<br>}<br><br>LUAD_zScores.df &lt;- data.frame(Z = do.call(rbind, Myo_LUAD_Zscores)[,<span>1</span>],<br>                              p = do.call(rbind, Myo_LUAD_Zscores)[,<span>2</span>],<br>                              SubPop = <span>"Myo"</span>,<br>                              DS = rownames(do.call(rbind, Myo_LUAD_Zscores)))<br>LUAD_zScores.df &lt;- rbind(LUAD_zScores.df,<br>                         data.frame(Z = do.call(rbind, Alveolar_LUAD_Zscores)[,<span>1</span>],<br>                                    p = do.call(rbind, Alveolar_LUAD_Zscores)[,<span>2</span>],<br>                                    SubPop = <span>"Alveolar"</span>,<br>                                    DS = rownames(do.call(rbind, Alveolar_LUAD_Zscores))))<br>LUAD_zScores.df &lt;- rbind(LUAD_zScores.df,<br>                         data.frame(Z = do.call(rbind, Adventitial_LUAD_Zscores)[,<span>1</span>],<br>                                    p = do.call(rbind, Adventitial_LUAD_Zscores)[,<span>2</span>],<br>                                    SubPop = <span>"Adventitial"</span>,<br>                                    DS = rownames(do.call(rbind, Adventitial_LUAD_Zscores))))<br>LUAD_zScores.df$Subtype &lt;- <span>"LUAD"</span><br>reshape2::melt(LUAD_zScores.df, id.vars = c(<span>"SubPop"</span>, <span>"DS"</span>), measure.vars = <span>"Z"</span>) %&gt;%<br>  ggplot(aes(y = value, x = SubPop, fill = SubPop)) +<br>  geom_boxplot(outlier.shape = <span>NA</span>) +<br>  geom_point(size = <span>1</span>) + <br>  theme_pubr(base_size = <span>7</span>) +<br>  scale_fill_manual(values = Fibs_col.palette) +<br>  geom_hline(yintercept = <span>0</span>, linetype = <span>"dashed"</span>) +<br>  ylab(<span>"Good Survival &lt;- CoxPH Zscore -&gt; Poor Survival"</span>) +<br>  theme(axis.title.y = element_blank()) +<br>  coord_flip()<br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span>LUSC单变量COX回归</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code>ys2test &lt;- rev(seq(<span>1</span>,<span>10</span>, by = <span>1</span>))<br>cox.zph_OK &lt;- list()<br><span>for</span>(DS <span>in</span> unique(Merged.LUSCtraits$Dataset)){<br>  surv_data &lt;- Merged.LUSCtraits[Merged.LUSCtraits$Sample.Subtype == <span>"LUSC"</span> &amp;<br>                                   Merged.LUSCtraits$Dataset == DS, ]<br>  cox.zph_p = <span>0</span><br>  <span>for</span>(i <span>in</span> ys2test){<br>    <span>if</span> (cox.zph_p &lt; <span>0.05</span>) {<br>      split_data &lt;- survSplit(Surv(OS_YEARS, OS) ~ <br>                                Myo_Fibs.pct,<span># + Stage_4cat + Age,</span><br>                              zero = -<span>0.1</span>,<br>                              data = surv_data[!is.na(surv_data$OS_YEARS), ],<br>                              cut = i, episode = <span>"tgroup"</span>, id = <span>"id"</span>)<br>      model.coxph2 &lt;- coxph(Surv(OS_YEARS, OS) ~ <br>                              Myo_Fibs.pct,<br>                            data = split_data[split_data$tgroup == <span>1</span>,])<br>      cox.zph_res = cox.zph(model.coxph2)<br>      cox.zph_res.sum = c(i, cox.zph_res$table[<span>1</span>,<span>3</span>])<br>      cox.zph_p &lt;- cox.zph_res$table[<span>1</span>,<span>3</span>]<br>      names(cox.zph_res.sum) &lt;- c(<span>"OS_YEARS"</span>, <span>"cox.zph_p"</span>)<br>    }<br>    cox.zph_OK[[DS]] &lt;- cox.zph_res.sum<br>  }<br>}<br>do.call(rbind, cox.zph_OK)<br>max_year &lt;- <span>4</span><br><span>#分别对每个数据集进行Cox回归分析</span><br>split_data &lt;- list()<br><span>for</span>(DS <span>in</span> unique(Merged.LUSCtraits$Dataset)[]){<br>  surv_data &lt;- Merged.LUSCtraits[Merged.LUSCtraits$Sample.Subtype == <span>"LUSC"</span> &amp;<br>                                   Merged.LUSCtraits$Dataset == DS, ]<br>  split_data[[DS]] &lt;- survSplit(Surv(OS_YEARS, OS) ~ <br>                                  Myo_Fibs.pct + Alveolar_Fibs.pct + Adventitial_Fibs.pct,<br>                                zero = -<span>0.1</span>,<br>                                data = surv_data[!is.na(surv_data$OS_YEARS), ],<br>                                cut = max_year, episode = <span>"tgroup"</span>, id = <span>"id"</span>)<br>}<br>Myo_cox.res &lt;- list()<br>Myo_cox.res[[<span>"TCGA"</span>]]  &lt;- coxph(Surv(OS_YEARS, OS) ~ <br>                                  scale(Myo_Fibs.pct),<br>                                data =  split_data[[<span>"TCGA"</span>]][split_data[[<span>"TCGA"</span>]]$tgroup == <span>1</span>,])<br>Myo_cox.res[[<span>"GSE157009"</span>]]  &lt;- coxph(Surv(OS_YEARS, OS) ~ <br>                                     scale(Myo_Fibs.pct),<br>                                   data =  split_data[[<span>"GSE157009"</span>]][split_data[[<span>"GSE157009"</span>]]$tgroup == <span>1</span>,])<br>Myo_cox.res[[<span>"GSE157010"</span>]]  &lt;- coxph(Surv(OS_YEARS, OS) ~ <br>                                     scale(Myo_Fibs.pct),<br>                                   data =  split_data[[<span>"GSE157010"</span>]][split_data[[<span>"GSE157010"</span>]]$tgroup == <span>1</span>,])<br>Myo_cox.res[[<span>"GSE4573"</span>]]  &lt;- coxph(Surv(OS_YEARS, OS) ~ <br>                                      scale(Myo_Fibs.pct),<br>                                    data =  split_data[[<span>"GSE4573"</span>]][split_data[[<span>"GSE4573"</span>]]$tgroup == <span>1</span>,])<br>forestmodel::forest_model(model_list = Myo_cox.res, panels = panels)<br>Myo_LUSC_Zscores &lt;- list()<br><span>for</span>(DS <span>in</span> names(Myo_cox.res)){<br>  Myo_LUSC_Zscores[[DS]] &lt;- summary(Myo_cox.res[[DS]])$coefficients[<span>4</span>:<span>5</span>]<br>}<br>Alveolar_cox.res &lt;- list()<br>Alveolar_cox.res[[<span>"TCGA"</span>]]  &lt;- coxph(Surv(OS_YEARS, OS) ~ <br>                                  scale(Alveolar_Fibs.pct),<br>                                data =  split_data[[<span>"TCGA"</span>]][split_data[[<span>"TCGA"</span>]]$tgroup == <span>1</span>,])<br>Alveolar_cox.res[[<span>"GSE157009"</span>]]  &lt;- coxph(Surv(OS_YEARS, OS) ~ <br>                                       scale(Alveolar_Fibs.pct),<br>                                     data =  split_data[[<span>"GSE157009"</span>]][split_data[[<span>"GSE157009"</span>]]$tgroup == <span>1</span>,])<br>Alveolar_cox.res[[<span>"GSE157010"</span>]]  &lt;- coxph(Surv(OS_YEARS, OS) ~ <br>                                       scale(Alveolar_Fibs.pct),<br>                                     data =  split_data[[<span>"GSE157010"</span>]][split_data[[<span>"GSE157010"</span>]]$tgroup == <span>1</span>,])<br>Alveolar_cox.res[[<span>"GSE4573"</span>]]  &lt;- coxph(Surv(OS_YEARS, OS) ~ <br>                                     scale(Alveolar_Fibs.pct),<br>                                   data =  split_data[[<span>"GSE4573"</span>]][split_data[[<span>"GSE4573"</span>]]$tgroup == <span>1</span>,])<br>forestmodel::forest_model(model_list = Alveolar_cox.res, panels = panels)<br>Alveolar_LUSC_Zscores &lt;- list()<br><span>for</span>(DS <span>in</span> names(Alveolar_cox.res)){<br>  Alveolar_LUSC_Zscores[[DS]] &lt;- summary(Alveolar_cox.res[[DS]])$coefficients[<span>4</span>:<span>5</span>]<br>}<br>Adventitial_cox.res &lt;- list()<br>Adventitial_cox.res[[<span>"TCGA"</span>]]  &lt;- coxph(Surv(OS_YEARS, OS) ~ <br>                                  scale(Adventitial_Fibs.pct),<br>                                data =  split_data[[<span>"TCGA"</span>]][split_data[[<span>"TCGA"</span>]]$tgroup == <span>1</span>,])<br>Adventitial_cox.res[[<span>"GSE157009"</span>]]  &lt;- coxph(Surv(OS_YEARS, OS) ~ <br>                                       scale(Adventitial_Fibs.pct),<br>                                     data =  split_data[[<span>"GSE157009"</span>]][split_data[[<span>"GSE157009"</span>]]$tgroup == <span>1</span>,])<br>Adventitial_cox.res[[<span>"GSE157010"</span>]]  &lt;- coxph(Surv(OS_YEARS, OS) ~ <br>                                       scale(Adventitial_Fibs.pct),<br>                                     data =  split_data[[<span>"GSE157010"</span>]][split_data[[<span>"GSE157010"</span>]]$tgroup == <span>1</span>,])<br>Adventitial_cox.res[[<span>"GSE4573"</span>]]  &lt;- coxph(Surv(OS_YEARS, OS) ~ <br>                                     scale(Adventitial_Fibs.pct),<br>                                   data =  split_data[[<span>"GSE4573"</span>]][split_data[[<span>"GSE4573"</span>]]$tgroup == <span>1</span>,])<br>forestmodel::forest_model(model_list = Adventitial_cox.res, panels = panels)<br>Adventitial_LUSC_Zscores &lt;- list()<br><span>for</span>(DS <span>in</span> names(Adventitial_cox.res)){<br>  Adventitial_LUSC_Zscores[[DS]] &lt;- summary(Adventitial_cox.res[[DS]])$coefficients[<span>4</span>:<span>5</span>]<br>}<br>LUSC_zScores.df &lt;- data.frame(Z = do.call(rbind, Myo_LUSC_Zscores)[,<span>1</span>],<br>                              p = do.call(rbind, Myo_LUSC_Zscores)[,<span>2</span>],<br>                              SubPop = <span>"Myo"</span>,<br>                              DS = rownames(do.call(rbind, Myo_LUSC_Zscores)))<br>LUSC_zScores.df &lt;- rbind(LUSC_zScores.df,<br>                         data.frame(Z = do.call(rbind, Alveolar_LUSC_Zscores)[,<span>1</span>],<br>                                    p = do.call(rbind, Alveolar_LUSC_Zscores)[,<span>2</span>],<br>                                    SubPop = <span>"Alveolar"</span>,<br>                                    DS = rownames(do.call(rbind, Alveolar_LUSC_Zscores))))<br>LUSC_zScores.df &lt;- rbind(LUSC_zScores.df,<br>                         data.frame(Z = do.call(rbind, Adventitial_LUSC_Zscores)[,<span>1</span>],<br>                                    p = do.call(rbind, Adventitial_LUSC_Zscores)[,<span>2</span>],<br>                                    SubPop = <span>"Adventitial"</span>,<br>                                    DS = rownames(do.call(rbind, Adventitial_LUSC_Zscores))))<br>LUSC_zScores.df$Subtype &lt;- <span>"LUSC"</span><br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span>Figure 6A</span><span></span></h3><p data-tool="mdnice编辑器">散点图显示使用不同截点按肌成纤维细胞丰度对TCGA中LUAD25样本进行二分的标准化对数秩生存统计量（与总生存率的相关性）的变化。</p><pre data-tool="mdnice编辑器"><span></span><code>Fig_6A &lt;- <br>  data.frame(stat = LUAD.Opt_cut$Myo_Fibs.pct$stats,<br>             x = LUAD.Opt_cut$Myo_Fibs.pct$cuts) %&gt;%<br>  ggplot(aes(x = x, y = stat, colour = x &lt; LUAD.Opt_cut$cutpoint[<span>1</span>,<span>1</span>])) +<br>  geom_point(size = <span>2</span>) +<br>  theme_pubr(base_size = <span>15</span>) +<br>  theme(legend.position = <span>"none"</span>) +<br>  scale_colour_manual(values =  c(pal_d3()(<span>3</span>)[<span>3</span>], <span>"grey70"</span>)) +<br>  xlab(<span>"Myo (% of all fibroblasts)"</span>) +<br>  ylab(<span>"Standardized Log-Rank statistic"</span>) +<br>  geom_vline(xintercept = LUAD.Opt_cut$cutpoint[<span>1</span>,<span>1</span>], <br>             linetype = <span>"dashed"</span>) +<br>  annotate(<span>"label"</span>, y = <span>1</span>, size = <span>5</span>,<br>           label = paste(<span>"Max ranked\nCutpoint ="</span>,<br>                         signif(LUAD.Opt_cut$cutpoint[<span>1</span>,<span>1</span>],<span>3</span>)),<br>           x =  LUAD.Opt_cut$cutpoint[<span>1</span>,<span>1</span>],<br>           label.size = <span>NA</span>)<br><br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.75" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQ6FQPybiaic5ojHIHrTuNoLd0Yk8vibTEGo8Yt89oy15aThJR1ds1IPJTIA0sdpykcwjweicRUEzaLtA/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQ6FQPybiaic5ojHIHrTuNoLd0Yk8vibTEGo8Yt89oy15aThJR1ds1IPJTIA0sdpykcwjweicRUEzaLtA/640?wx_fmt=png"><figcaption>Fig_6A</figcaption></figure><h3 data-tool="mdnice编辑器"><span></span><span>Figure 6B</span><span></span></h3><p data-tool="mdnice编辑器">显示TCGA-LUAD中25样品中肌成纤维细胞丰度测量值分布的密度图</p><pre data-tool="mdnice编辑器"><span></span><code>Fig_6B &lt;- <br>  Opt_cut.plot$Myo_Fibs.pct$distribution +<br>  theme_pubr(base_size = <span>15</span>) +<br>  scale_fill_manual(values =  c(pal_d3()(<span>3</span>)[<span>3</span>], <span>"grey70"</span>))+<br>  scale_colour_manual(values =  c(pal_d3()(<span>3</span>)[<span>3</span>], <span>"grey70"</span>)) +<br>  theme(legend.position = <span>"none"</span>, plot.title = element_blank()) +<br>  xlab(<span>"Myo (% of all fibroblasts)"</span>)<br>Fig_6B <br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.75" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQ6FQPybiaic5ojHIHrTuNoLdvdsic3gicYWfv3DibKelzWUcTdmqGmk6kP53CZ0lf1jAiatrhHKBvDRxyw/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQ6FQPybiaic5ojHIHrTuNoLdvdsic3gicYWfv3DibKelzWUcTdmqGmk6kP53CZ0lf1jAiatrhHKBvDRxyw/640?wx_fmt=png"></figure><h3 data-tool="mdnice编辑器"><span></span><span>Figure 6C</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code><span>#生存曲线数据整理</span><br>Myo.ggsurvplot_list &lt;- list()<br><span>for</span>(i <span>in</span> levels(Merged.LUADtraits$Dataset.factor)){<br>  cox_res &lt;- summary(coxph(Surv(OS_YEARS, OS) ~ Myo_cat,<br>                           data = Merged.LUADtraits[Merged.LUADtraits$Sample.Subtype == <span>"LUAD"</span> &amp;<br>                                                      Merged.LUADtraits$Dataset.factor == i, ]))<br>  Myo.ggsurvplot_list[[i]] &lt;- ggsurvplot(survfit(Surv(OS_YEARS, OS) ~ Myo_cat,<br>                                                 data = Merged.LUADtraits[Merged.LUADtraits$Sample.Subtype == <span>"LUAD"</span> &amp;<br>                                                                            Merged.LUADtraits$Dataset.factor == i, ]),<br>                                         main = i,<br>                                         pval = signif(cox_res$logtest[<span>3</span>],<span>3</span>), pval.coord = c(<span>0</span>,<span>0.15</span>), pval.size = <span>10</span>,<br>                                         conf.int = <span>F</span>, <br>                                         risk.table = <span>TRUE</span>, risk.table.title = element_blank(),<br>                                         risk.table.fontsize = <span>5</span>,tables.height = <span>0.4</span>,<br>                                         risk.table.pos = <span>"in"</span>,<br>                                         font.tickslab = <span>17</span>,<br>                                         censor.shape = <span>124</span>, censor.size = <span>4</span>,<br>                                         legend.labs = c(<span>"Low"</span>, <span>"High"</span>),<br>                                         palette = c(<span>"grey70"</span>,pal_d3()(<span>3</span>)[<span>3</span>]),<br>                                         ggtheme = theme_pubr(base_size = <span>17</span>),<br>                                         risk.table.y.col = <span>T</span>,<br>                                         legend = c(<span>0.85</span>,<span>0.85</span>), legend.title = element_blank())<br>  Myo.ggsurvplot_list[[i]]$plot &lt;- Myo.ggsurvplot_list[[i]]$plot + <br>    ggtitle(i) + ylab(<span>"Overall Survival Rate"</span>) +<br>    theme(axis.text.x = element_blank(), axis.title.x =  element_blank(),<br>          plot.margin = margin(b= <span>0</span>)) +<br>    coord_cartesian(xlim = c(-<span>0.3</span>,<span>NA</span>))<br>  <br>  Myo.ggsurvplot_list[[i]]$table &lt;- Myo.ggsurvplot_list[[i]]$table + xlab(<span>"Time (Years)"</span>)+<br>    theme(plot.margin = margin(t = <span>0</span>), plot.background = element_blank()) +<br>    coord_cartesian(xlim = c(-<span>0.3</span>,<span>NA</span>))<br>}<br><span>#Kaplan-Meier图显示TCGA-LUAD中25队列患者生存率，按肌成纤维细胞丰度使用二分最佳临界点分层</span><br>Fig_6C &lt;- <br>  ggarrange(Myo.ggsurvplot_list$TCGA$plot + theme(plot.title = element_blank()),<br>            Myo.ggsurvplot_list$TCGA$table,<br>            ncol = <span>1</span>, nrow = <span>2</span>, heights = c(<span>0.7</span>,<span>0.3</span>), align = <span>"v"</span>,<br>            common.legend = <span>T</span>, legend = <span>"none"</span>)<br><br><br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.75" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQ6FQPybiaic5ojHIHrTuNoLdqE3PtWVBBOmFe9XT1xdYLMQiaJIQZfREc1jPibiaPfMCFHzlez1ECXWvw/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQ6FQPybiaic5ojHIHrTuNoLdqE3PtWVBBOmFe9XT1xdYLMQiaJIQZfREc1jPibiaPfMCFHzlez1ECXWvw/640?wx_fmt=png"><figcaption>Fig_6C</figcaption></figure><h3 data-tool="mdnice编辑器"><span></span><span>Figure 6D</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code><span>#将该阈值应用于三个验证队列，证明了一致的显著患者分层</span><br>Fig_6D &lt;- <br>  ggarrange(Myo.ggsurvplot_list$GSE72094$plot, Myo.ggsurvplot_list$GSE31210$plot,<br>           Myo.ggsurvplot_list$GSE68465$plot,<br>          Myo.ggsurvplot_list$GSE72094$table,  Myo.ggsurvplot_list$GSE31210$table,<br>           Myo.ggsurvplot_list$GSE68465$table,<br>          ncol = <span>3</span>, nrow = <span>2</span>, heights = c(<span>0.7</span>,<span>0.3</span>), align = <span>"v"</span>,<br>          common.legend = <span>T</span>, legend = <span>"none"</span>)<br><br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.6555555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQ6FQPybiaic5ojHIHrTuNoLdKgGlx4pwxmFRBRx3MDq4pLxw2M2LDBh7kE3xq4LgctKVxdbx7Yic8Cw/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQ6FQPybiaic5ojHIHrTuNoLdKgGlx4pwxmFRBRx3MDq4pLxw2M2LDBh7kE3xq4LgctKVxdbx7Yic8Cw/640?wx_fmt=png"><figcaption>Fig_6D</figcaption></figure><h3 data-tool="mdnice编辑器"><span></span><span>Figure 6E</span><span></span></h3><p data-tool="mdnice编辑器">散点图显示使用不同截点按肺泡成纤维细胞丰度对TCGA中LUAD25样本进行二分的标准化对数秩生存统计量（与总生存率的相关性）的变化。</p><pre data-tool="mdnice编辑器"><span></span><code>Fig_6E &lt;- <br>  data.frame(stat = LUAD.Opt_cut$Alveolar_Fibs.pct$stats,<br>             x = LUAD.Opt_cut$Alveolar_Fibs.pct$cuts) %&gt;%<br>  ggplot(aes(x = x, y = stat, colour = x &lt; LUAD.Opt_cut$cutpoint[<span>2</span>,<span>1</span>])) +<br>  geom_point(size = <span>2</span>) +<br>  theme_pubr(base_size = <span>15</span>) +<br>  theme(legend.position = <span>"none"</span>) +<br>  scale_colour_manual(values =  c(pal_d3()(<span>3</span>)[<span>1</span>], <span>"grey70"</span>)) +<br>  xlab(<span>"Alveolar (% of all fibroblasts)"</span>) +<br>  ylab(<span>"Standardized Log-Rank statistic"</span>) +<br>  geom_vline(xintercept = LUAD.Opt_cut$cutpoint[<span>2</span>,<span>1</span>], <br>             linetype = <span>"dashed"</span>) +<br>  annotate(<span>"label"</span>, y = <span>1</span>, size = <span>5</span>,<br>           label = paste(<span>"Max ranked\nCutpoint ="</span>,<br>                         signif(LUAD.Opt_cut$cutpoint[<span>2</span>,<span>1</span>],<span>3</span>)),<br>           x =  LUAD.Opt_cut$cutpoint[<span>2</span>,<span>1</span>],<br>           label.size = <span>NA</span>)<br><br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.6555555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQ6FQPybiaic5ojHIHrTuNoLdkDZiccILx6iacy1Y5FSjrYzibhdS7ZfteKQkwBvtf723qOzlQcdRJs78w/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQ6FQPybiaic5ojHIHrTuNoLdkDZiccILx6iacy1Y5FSjrYzibhdS7ZfteKQkwBvtf723qOzlQcdRJs78w/640?wx_fmt=png"><figcaption>Fig_6E</figcaption></figure><h3 data-tool="mdnice编辑器"><span></span><span>Figure 6F</span><span></span></h3><p data-tool="mdnice编辑器">显示TCGA-LUAD中25样品中肺泡成纤维细胞丰度测量值分布的密度图</p><pre data-tool="mdnice编辑器"><span></span><code>Fig_6F &lt;- <br>  Opt_cut.plot$Alveolar_Fibs.pct$distribution +<br>  theme_pubr(base_size = <span>15</span>) +<br>  scale_fill_manual(values =  c(pal_d3()(<span>3</span>)[<span>1</span>], <span>"grey70"</span>))+<br>  scale_colour_manual(values =  c(pal_d3()(<span>3</span>)[<span>1</span>], <span>"grey70"</span>)) +<br>  theme(legend.position = <span>"none"</span>, plot.title = element_blank()) +<br>  xlab(<span>"Alveolar (% of all fibroblasts)"</span>)<br><br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.6555555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQ6FQPybiaic5ojHIHrTuNoLdMU1P2QABibpXHibIBqGdAraptq4vytuqkH7A0pV3wZpreRcGwZ20clRg/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQ6FQPybiaic5ojHIHrTuNoLdMU1P2QABibpXHibIBqGdAraptq4vytuqkH7A0pV3wZpreRcGwZ20clRg/640?wx_fmt=png"><figcaption>Fig_6F</figcaption></figure><h3 data-tool="mdnice编辑器"><span></span><span>Figure 6G</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code><span>#生存曲线数据整理</span><br>Alv.ggsurvplot_list &lt;- list()<br><span>for</span>(i <span>in</span> levels(Merged.LUADtraits$Dataset.factor)){<br>  cox_res &lt;- summary(coxph(Surv(OS_YEARS, OS) ~ Alv_cat,<br>                           data = Merged.LUADtraits[Merged.LUADtraits$Sample.Subtype == <span>"LUAD"</span> &amp;<br>                                                      Merged.LUADtraits$Dataset.factor == i, ]))<br>  Alv.ggsurvplot_list[[i]] &lt;- ggsurvplot(survfit(Surv(OS_YEARS, OS) ~ Alv_cat,<br>                                                 data = Merged.LUADtraits[Merged.LUADtraits$Sample.Subtype == <span>"LUAD"</span> &amp;<br>                                                                            Merged.LUADtraits$Dataset.factor == i, ]),<br>                                         main = i,<br>                                         pval = <span>T</span>, pval.coord = c(<span>0</span>,<span>0.15</span>), pval.size = <span>10</span>,<br>                                         conf.int = <span>F</span>, <br>                                         risk.table = <span>TRUE</span>, risk.table.title = element_blank(),<br>                                         risk.table.fontsize = <span>5</span>,tables.height = <span>0.4</span>,<br>                                         risk.table.pos = <span>"in"</span>,<br>                                         font.tickslab = <span>17</span>,<br>                                         censor.shape = <span>124</span>, censor.size = <span>4</span>,<br>                                         legend.labs = c(<span>"Low"</span>, <span>"High"</span>),<br>                                         palette = c(<span>"grey70"</span>,pal_d3()(<span>3</span>)[<span>1</span>]),<br>                                         ggtheme = theme_pubr(base_size = <span>17</span>),<br>                                         risk.table.y.col = <span>T</span>,<br>                                         legend = c(<span>0.85</span>,<span>0.85</span>), legend.title = element_blank())<br>  Alv.ggsurvplot_list[[i]]$plot &lt;- Alv.ggsurvplot_list[[i]]$plot + <br>    ggtitle(i) + ylab(<span>"Overall Survival Rate"</span>) +<br>    theme(axis.text.x = element_blank(), axis.title.x =  element_blank(),<br>      plot.margin = margin(b= <span>0</span>)) +<br>    coord_cartesian(xlim = c(-<span>0.3</span>,<span>NA</span>))<br>  <br>  Alv.ggsurvplot_list[[i]]$table &lt;- Alv.ggsurvplot_list[[i]]$table + xlab(<span>"Time (Years)"</span>)+<br>    theme(plot.margin = margin(t = <span>0</span>), plot.background = element_blank()) +<br>    coord_cartesian(xlim = c(-<span>0.3</span>,<span>NA</span>))<br>}<br><span>#Kaplan-Meier图显示TCGA-LUAD中25队列患者生存率，按肺泡成纤维细胞丰度使用二分最佳临界点分层</span><br>Fig_6G &lt;- <br>  ggarrange(Alv.ggsurvplot_list$TCGA$plot + theme(plot.title = element_blank()),<br>            Alv.ggsurvplot_list$TCGA$table,<br>            ncol = <span>1</span>, nrow = <span>2</span>, heights = c(<span>0.7</span>,<span>0.3</span>), align = <span>"v"</span>,<br>            common.legend = <span>T</span>, legend = <span>"none"</span>)<br><br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.6555555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQ6FQPybiaic5ojHIHrTuNoLdiaSRN1vQnrBQd52OjUyDvFgrnVybsSUQttSqzCm6p8Alc1Uf5MIHERg/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQ6FQPybiaic5ojHIHrTuNoLdiaSRN1vQnrBQd52OjUyDvFgrnVybsSUQttSqzCm6p8Alc1Uf5MIHERg/640?wx_fmt=png"><figcaption>Fig_6G</figcaption></figure><h3 data-tool="mdnice编辑器"><span></span><span>Figure 6H</span><span></span></h3><p data-tool="mdnice编辑器">将该阈值应用于三个验证队列，证明了一致的显著患者分层</p><pre data-tool="mdnice编辑器"><span></span><code>Fig_6H &lt;- <br>  ggarrange(Alv.ggsurvplot_list$GSE72094$plot, Alv.ggsurvplot_list$GSE31210$plot,<br>          Alv.ggsurvplot_list$GSE68465$plot,<br>          Alv.ggsurvplot_list$GSE72094$table,  Alv.ggsurvplot_list$GSE31210$table,<br>          Alv.ggsurvplot_list$GSE68465$table,<br>          ncol = <span>3</span>, nrow = <span>2</span>, heights = c(<span>0.7</span>,<span>0.3</span>), align = <span>"v"</span>,<br>          common.legend = <span>T</span>, legend = <span>"none"</span>)<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.6555555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQ6FQPybiaic5ojHIHrTuNoLdrz0XKIk79XGjO5gKGdZCOdE2N83GVF8wYTmoYA6hQDiaRZngoUjEmIQ/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQ6FQPybiaic5ojHIHrTuNoLdrz0XKIk79XGjO5gKGdZCOdE2N83GVF8wYTmoYA6hQDiaRZngoUjEmIQ/640?wx_fmt=png"><figcaption>Fig_6H</figcaption></figure><h3 data-tool="mdnice编辑器"><span></span><span>多变量分类分析</span><span></span></h3><p data-tool="mdnice编辑器">森林图显示协变量独立风险比和上述分析的所有LUAD患者队列的4年总生存率多变量COX回归分析的校正p值，使用肌成纤维细胞丰度、疾病分期和患者年龄作为自变量</p><pre data-tool="mdnice编辑器"><span></span><code>max_year &lt;- <span>4</span><br>surv_data &lt;- Merged.LUADtraits[Merged.LUADtraits$Dataset.factor %<span>in</span>% c(<span>"TCGA"</span>, <span>"GSE68465"</span>, <span>"GSE72094"</span>, <span>"GSE31210"</span>), ]<br>split_data &lt;- survSplit(Surv(OS_YEARS, OS) ~ <br>                          Myo_cat + Stage_4cat + Age,<br>                        zero = -<span>0.1</span>,<br>                        data = surv_data[!is.na(surv_data$OS_YEARS), ],<br>                        cut = max_year, episode = <span>"tgroup"</span>, id = <span>"id"</span>)<br>names(split_data)[<span>1</span>:<span>2</span>] &lt;- c(<span>"Myo"</span>, <span>"Stage"</span>)<br>Myo_cox.res &lt;- coxph(Surv(OS_YEARS, OS) ~ <br>                       Myo + Stage + Age,<br>                     data =  split_data[split_data$tgroup == <span>1</span>,])<br>summary(Myo_cox.res)$coefficients<br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span>Figure 6I</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code>Fig_6I &lt;- forest_model(Myo_cox.res,<br>                       format_options = forest_model_format_options(<br>                         banded = <span>T</span>, text_size = <span>5</span>, point_size = <span>4</span>)) <br><br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.6555555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQ6FQPybiaic5ojHIHrTuNoLdQ3Biat8NhQ1KEicOyPAFGWCaZicqAbzlfBYHAYDuOZSia3w26bwIDQhDJw/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQ6FQPybiaic5ojHIHrTuNoLdQ3Biat8NhQ1KEicOyPAFGWCaZicqAbzlfBYHAYDuOZSia3w26bwIDQhDJw/640?wx_fmt=png"><figcaption>Fig_6I</figcaption></figure><h3 data-tool="mdnice编辑器"><span></span><span>Figure 6J</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code><span>#森林图显示协变量独立风险比（±95%置信区间）和上述所有LUAD患者队列4年总生存率的多变量考克斯回归分析的校正p值，使用肺泡成纤维细胞丰度、疾病分期和患者年龄作为自变量</span><br>surv_data &lt;- Merged.LUADtraits[Merged.LUADtraits$Dataset.factor %<span>in</span>% c(<span>"TCGA"</span>, <span>"GSE68465"</span>, <span>"GSE72094"</span>, <span>"GSE31210"</span>), ]<br>split_data &lt;- survSplit(Surv(OS_YEARS, OS) ~ <br>                          Alv_cat + Stage_4cat + Age,<br>                        zero = -<span>0.1</span>,<br>                        data = surv_data[!is.na(surv_data$OS_YEARS), ],<br>                        cut = max_year, episode = <span>"tgroup"</span>, id = <span>"id"</span>)<br>names(split_data)[<span>1</span>:<span>2</span>] &lt;- c(<span>"Alveolar"</span>, <span>"Stage"</span>)<br>Alv_cox.res &lt;- coxph(Surv(OS_YEARS, OS) ~ <br>                       Alveolar + Stage + Age,<br>                     data =  split_data[split_data$tgroup == <span>1</span>,])<br><br>Fig_6J &lt;- forest_model(Alv_cox.res,<br>                    format_options = forest_model_format_options(<br>                      banded = <span>T</span>, text_size = <span>2.5</span>, point_size = <span>1</span>)) <br><br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.6555555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQ6FQPybiaic5ojHIHrTuNoLd7avORDN9iaH6gtO9gUfGrRWRYyc1iaEiavWfNpSEWewTaFqKphib74h1VA/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQ6FQPybiaic5ojHIHrTuNoLd7avORDN9iaH6gtO9gUfGrRWRYyc1iaEiavWfNpSEWewTaFqKphib74h1VA/640?wx_fmt=png"><figcaption>Fig_6J</figcaption></figure><h2 data-tool="mdnice编辑器"><span></span><span>Figure 6</span></h2><p data-tool="mdnice编辑器">多个LUAD数据集中，肺泡和表皮成纤维细胞丰度与更好的总生存率相关。这种关联在肺泡成纤维细胞中尤其一致，在所有分析的数据集中都是显著的。因此，采用与上述相同的方法来测试将肺泡成纤维细胞丰度作为预后标志物的可能性。同样，这表明将LUAD队列分为肺泡成纤维细胞高或低在分层总生存率方面始终有效,并且这种关联与疾病分期和患者年龄无关。</p></section><section><p><br></p><section data-style-type="5" data-tools="新媒体排版" data-id="2440476"><section><section><section><section><img data-ratio="0.9495798319327731" data-src="https://mmbiz.qpic.cn/mmbiz_gif/09gp6SvPE04j3m2v7Hr889icHUyibTOHs8YuUibicl7ibRD0ZwG5pDTjBluRreZvuib1o3BibvLkicYhnA4YW7dQsjn0cA/640?wx_fmt=gif" data-type="gif" data-w="119" data-width="100%" src="https://mmbiz.qpic.cn/mmbiz_gif/09gp6SvPE04j3m2v7Hr889icHUyibTOHs8YuUibicl7ibRD0ZwG5pDTjBluRreZvuib1o3BibvLkicYhnA4YW7dQsjn0cA/640?wx_fmt=gif"></section><section data-brushtype="text">往期回顾</section><section><br></section></section></section></section><section><section data-autoskip="1"><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247513446&amp;idx=1&amp;sn=88fbdfe38b95cb851a4c36af199a4302&amp;chksm=ea1cb3e4dd6b3af2bdf1458af9bd3f62950202411d4c770aaec5010737434e34f360697c6083&amp;scene=21#wechat_redirect" textvalue="手把手带你复现NC图表之Figure5" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2"><span>手把手带你复现NC图表之Figure5</span></a><br></p><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247513381&amp;idx=1&amp;sn=b95f12df59b2eef3f85cbf829cf29cab&amp;chksm=ea1cb3a7dd6b3ab18ca6484d5db6f5222625012966d708a82ff89d135519e4284f60e1c6910c&amp;scene=21#wechat_redirect" textvalue="手把手带你复现NC图表之Figure 4" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2"><span>手把手带你复现NC图表之Figure 4</span></a><br></p><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247513310&amp;idx=1&amp;sn=5aa8db2bdc7c6ca1b1bdb6d1a9863130&amp;chksm=ea1cb25cdd6b3b4a2edf5a6c816f9e5ac46f6667dabe4adc2995a3db7a98e065c044004487d0&amp;scene=21#wechat_redirect" textvalue="手把手带你复现NC图表之Figure 3" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2"><span>手把手带你复现NC图表之Figure 3</span></a><br></p><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247513202&amp;idx=1&amp;sn=3f8a4947cce8596f454fb82090f599e0&amp;chksm=ea1cb2f0dd6b3be68237d48393e535a8399b9e0e8a091dcc225b3bce2100c6fc4d31a0fd027b&amp;scene=21#wechat_redirect" textvalue="手把手带你复现NC图表之Figure 2" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2"><span>手把手带你复现NC图表之Figure 2</span></a><br></p><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247513057&amp;idx=1&amp;sn=6f737f0a5ae7795645a42894897f7b87&amp;chksm=ea1cb563dd6b3c7567db78011efb52823c1f6bc94a760cc11ef8a07d3d5d6c779e4813c4d523&amp;scene=21#wechat_redirect" textvalue="手把手带你复现NC图表之Figure 1" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2"><span>手把手带你复现NC图表之Figure 1</span></a></p></section></section><hr><p><br></p></section><section data-style-type="5" data-tools="新媒体排版" data-id="2440475"><hr><p><br></p><hr><section><p>如果你对单细胞转录组研究感兴趣，但又不知道如何入门，也许你可以关注一下下面的课程<span></span></p><p><br></p><ul><li><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247522216&amp;idx=1&amp;sn=7e8a61383489f4a2c68172c4c436fa83&amp;chksm=9b4bd713ac3c5e0525da8dc1d038854366c4ad643396d3ee67f1e8a117c3657530043dda1b8d&amp;scene=21#wechat_redirect" textvalue="生信入门&amp;数据挖掘线上直播课6月班" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1">生信入门&amp;数据挖掘线上直播课6月班</a><br></p></li><li><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247519765&amp;idx=2&amp;sn=6cb33654c7751f4c3df0f84743f77aaf&amp;chksm=9b4bceaeac3c47b8899afc00077b96357b87a4ed6b75e7c434ba14071fd6c8448e4c218de5e0&amp;scene=21#wechat_redirect" textvalue="144线程640Gb内存服务器共享一年仍然是仅需800" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1">144线程640Gb内存服务器共享一年仍然是仅需800</a></p></li><li><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247519765&amp;idx=1&amp;sn=ce5a8c8182f854c88043059f8c2cb9ff&amp;chksm=9b4bceaeac3c47b88c19941d43dbb1401f3a92206481a0afc41159927868199643f795d62a7e&amp;scene=21#wechat_redirect" textvalue="千呼万唤始出来的独享生物信息学云服务器" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1">千呼万唤始出来的独享生物信息学云服务器</a></p></li></ul><p><img data-ratio="1" data-src="https://mmbiz.qpic.cn/mmbiz_gif/4TKeL1ZejtlKxOib5kmKX6ic6eX0w0WK5jvhtz9yBRsO3OI4yr6S5iaLNM7AbAeuPDHXMvDdur2DRz9wyiax4lEviag/640?wx_fmt=gif" data-type="gif" data-w="240" src="https://mmbiz.qpic.cn/mmbiz_gif/4TKeL1ZejtlKxOib5kmKX6ic6eX0w0WK5jvhtz9yBRsO3OI4yr6S5iaLNM7AbAeuPDHXMvDdur2DRz9wyiax4lEviag/640?wx_fmt=gif"><br></p><p><img data-ratio="0.05278592375366569" data-src="https://mmbiz.qpic.cn/mmbiz/4TKeL1Zejtlq03ZOSZiaTlic1MxgdKiaxTbOZ7ZSe0Xx1Ca8xF3L6Nyj1FYUajtYrSmRIHyZVSsAve0EAvEicZONpg/640?wx_fmt=jpeg" data-type="other" data-w="341" src="https://mmbiz.qpic.cn/mmbiz/4TKeL1Zejtlq03ZOSZiaTlic1MxgdKiaxTbOZ7ZSe0Xx1Ca8xF3L6Nyj1FYUajtYrSmRIHyZVSsAve0EAvEicZONpg/640?wx_fmt=jpeg"></p><p><strong><span>看完记得顺手点个</span></strong><span><strong><span>“在看”</span></strong></span><strong><span>哦！</span></strong></p></section><section><section data-id="93668"><section><section data-width="95%"><section><section><section data-width="38%"><section><section data-tools="135编辑器" data-id="93668"><section><section data-width="95%"><section><section><section data-width="61.8%"><section><section><section><p><br></p><span><strong data-burshtype="text"><img data-copyright="0" data-cropselx1="0" data-cropselx2="109" data-cropsely1="0" data-cropsely2="109" data-ratio="1" data-src="https://mmbiz.qpic.cn/mmbiz/siaia0BDGJdjRMGrkqo64BGKecYk4akuHpGHVQs7FeOpY7eWbIPGC1tRw5Tw0oEPmx053mR9FTVerWvhuZchIpZw/640?wx_fmt=jpeg" data-type="other" data-w="258" title="qrcode_for_gh_5a3c482ed99f_1280.jpg" src="https://mmbiz.qpic.cn/mmbiz/siaia0BDGJdjRMGrkqo64BGKecYk4akuHpGHVQs7FeOpY7eWbIPGC1tRw5Tw0oEPmx053mR9FTVerWvhuZchIpZw/640?wx_fmt=jpeg"><strong data-burshtype="text">生物</strong><strong data-burshtype="text"> | 单细胞 | 转录组丨资料</strong></strong></span></section><section><span><strong data-burshtype="text">每天都精彩</strong></span></section></section></section><section><section><section><section><section><section><p><span>长按扫码可关注</span></p></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/nMFP9Lab-x66tLCBtD3UsA",target="_blank" rel="noopener noreferrer">原文链接</a>
