---
title: "一键轻松可视化你的质粒图谱！"
date: 2023-06-28T03:49:51Z
draft: ["false"]
tags: [
  "fetched",
  "SCIPainter"
]
categories: ["Acdemic"]
---
一键轻松可视化你的质粒图谱！ by SCIPainter
------
<div><section data-mpa-powered-by="yiban.io"><span>除了使用SnapGene，在R中也能轻松绘制质粒图谱！</span><br></section><section><br></section><section><span>今天分享一个R包</span><strong><span>plasmapR</span></strong><span>，可以帮助轻松解析带注释的GenBank序列文件并绘制质粒图谱。</span></section><section><span><br></span></section><section><img data-ratio="0.8202247191011236" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6kNicaIOdGdJ3eTia1H0xPZteuibmsibpNwXicg1q5OXLJicUtu2qjCIm91X7JaiaqA1tF4cTQBXZVb84CTA/640?wx_fmt=png" data-type="png" data-w="1068" height="876" width="1068" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6kNicaIOdGdJ3eTia1H0xPZteuibmsibpNwXicg1q5OXLJicUtu2qjCIm91X7JaiaqA1tF4cTQBXZVb84CTA/640?wx_fmt=png"></section><section><span><br></span></section><section><span>话不多说，下面进入今天的正题！</span><br></section><section><br></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>#相关R包安装与载入：</span><br mpa-from-tpl="t"><span>devtools</span>::install_github(<span>"bradyajohnston/plasmapr"</span>)<br mpa-from-tpl="t"><span>library</span>(plasmapR)<br mpa-from-tpl="t"><span>library</span>(ggplot2)<br mpa-from-tpl="t"><span>library</span>(cols4all)</code></pre></section><p><br></p><section><span></span></section><section data-mpa-template="t" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><br></section><section data-mid="" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><p data-mid="">1. 使用内置数据测试</p></section></section><section data-mid="" mpa-from-tpl="t"><br></section></section></section></section><p><br></p><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>#R包内置数据读取：</span><br mpa-from-tpl="t"><span>dt</span> &lt;- system.file('extdata', 'petm20.gb', package = <span>"plasmapR"</span>)<br mpa-from-tpl="t"><span>dt</span> &lt;- read_gb(dt) #list<br mpa-from-tpl="t"><br mpa-from-tpl="t"><span>#质粒图谱可视化：</span><br mpa-from-tpl="t"><span>p</span> &lt;- plot_plasmid(dt, <br mpa-from-tpl="t">                  <span>name</span> = 'pETM-20', <span>#质粒名,显示在中心位置</span><br mpa-from-tpl="t">                  <span>label_wrap</span> = 20) <span>#标签长度（若实际大于设定长度则跨行）</span><br mpa-from-tpl="t"><span>p</span></code></pre></section><p><br></p><section><img data-ratio="0.762962962962963" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6kNicaIOdGdJ3eTia1H0xPZteN1S0S1JyE1n1I2ic3vE7gh4Q2chf0JbNOXwK2z9AhsoribUdZick7pgow/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6kNicaIOdGdJ3eTia1H0xPZteN1S0S1JyE1n1I2ic3vE7gh4Q2chf0JbNOXwK2z9AhsoribUdZick7pgow/640?wx_fmt=png"></section><section><br></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>p1</span> &lt;- plot_plasmid(dt, <br mpa-from-tpl="t">                   <span>name</span> = 'pETM-20', <br mpa-from-tpl="t">                   <span>label_wrap</span> = 10) <span>#跨行显示标签</span><br mpa-from-tpl="t"><span>p1</span></code></pre></section><p><br></p><section><img data-ratio="0.8323970037453183" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6kNicaIOdGdJ3eTia1H0xPZteicPUtictw5rtWuk7fj7s1iax6F7iaEUzYGFRn2XU0RpKxWAsH6MKdeyqOw/640?wx_fmt=png" data-type="png" data-w="1068" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6kNicaIOdGdJ3eTia1H0xPZteicPUtictw5rtWuk7fj7s1iax6F7iaEUzYGFRn2XU0RpKxWAsH6MKdeyqOw/640?wx_fmt=png"></section><section><br></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>#提取数据框：</span><br mpa-from-tpl="t"><span>df</span> &lt;- as.data.frame(dt)<br mpa-from-tpl="t"><span>head</span>(df)</code></pre></section><p><br></p><section><img data-ratio="0.23632993512511585" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6kNicaIOdGdJ3eTia1H0xPZte8JW9XFplkspzT6f6bvpWibicOr2fkr4xXOPC1B2hic1JTqXwK3EzW7Mibg/640?wx_fmt=png" data-type="png" data-w="1079" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6kNicaIOdGdJ3eTia1H0xPZte8JW9XFplkspzT6f6bvpWibicOr2fkr4xXOPC1B2hic1JTqXwK3EzW7Mibg/640?wx_fmt=png"></section><section><br></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>#可视化特定特征:</span><br mpa-from-tpl="t"><span>##以CDS为例：</span><br mpa-from-tpl="t"><span>p2</span> &lt;- plot_plasmid(df[df$type =='CDS',],<br mpa-from-tpl="t">                   <span>name</span> = 'pETM-20')<br mpa-from-tpl="t"><span>p2</span></code></pre></section><p><br></p><section><img data-ratio="0.854586129753915" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6kNicaIOdGdJ3eTia1H0xPZteSn0GiaztpeTonc2ntBLibQPJug3ZRPL8ku5bfVD1tRzLVib15iaysnMyXg/640?wx_fmt=png" data-type="png" data-w="894" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6kNicaIOdGdJ3eTia1H0xPZteSn0GiaztpeTonc2ntBLibQPJug3ZRPL8ku5bfVD1tRzLVib15iaysnMyXg/640?wx_fmt=png"></section><section><br></section><section data-mpa-template="t" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><br></section><section data-mid="" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><p data-mid="">2. 目标质粒GenBank文件获取与实测</p></section></section><section data-mid="" mpa-from-tpl="t"><br></section></section></section></section><section><span></span></section><section><span><br></span></section><section><span>学习了如何调用R包，下面我们再结合实例测试。这里以</span><strong><span>agggene</span></strong><span>（全球质粒共享信息库）为例进行目标质粒的查询与注释序列下载。</span></section><section><br></section><section><strong><span>agggene链接：</span></strong><span>https://www.addgene.org/</span></section><section><span><br></span></section><section><span>进入网站首页，可根据背景检索目标质粒的名称、关键词或对应编号等，这里我们输入质粒名</span><span>pFYF1548 EMX1</span><span>（或编号</span><span>47508</span><span>）</span></section><section><span><br></span></section><section><img data-ratio="0.8092592592592592" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6kNicaIOdGdJ3eTia1H0xPZteDcvVQWgycjeic5YlZmd9X46ibYDYMcc7hee0RoXXazRI5Qz0QDwXvURw/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6kNicaIOdGdJ3eTia1H0xPZteDcvVQWgycjeic5YlZmd9X46ibYDYMcc7hee0RoXXazRI5Qz0QDwXvURw/640?wx_fmt=png"></section><section><br></section><section><span>点击</span><span>in Plasmids</span><span>；</span></section><section><br></section><section><img data-ratio="0.8092592592592592" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6kNicaIOdGdJ3eTia1H0xPZteuB3BLtWibXFdstKViaQSBM6NFGR62NtcYtXVEyyXyJTvh0anzMMjC9Hw/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6kNicaIOdGdJ3eTia1H0xPZteuB3BLtWibXFdstKViaQSBM6NFGR62NtcYtXVEyyXyJTvh0anzMMjC9Hw/640?wx_fmt=png"></section><section><br></section><section><span>可看到该质粒概述信息，点击名称进入详情页；</span></section><section><br></section><section><img data-ratio="0.8092592592592592" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6kNicaIOdGdJ3eTia1H0xPZteDo0cXU9Bp621nUPr1dkoml0wSVoywrmhib9ZF3P0gWvskry9orKZNgg/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6kNicaIOdGdJ3eTia1H0xPZteDo0cXU9Bp621nUPr1dkoml0wSVoywrmhib9ZF3P0gWvskry9orKZNgg/640?wx_fmt=png"></section><section><br></section><section><span>为了获取更详细序列信息，点击</span><span>View all sequences</span><span>；</span></section><section><br></section><section><img data-ratio="0.8092592592592592" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6kNicaIOdGdJ3eTia1H0xPZteXHR0xLMZyE7hwicpw5uZnNHbnuJdVF1xvibRX7tM0bZrpgic0fjLzke6Q/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6kNicaIOdGdJ3eTia1H0xPZteXHR0xLMZyE7hwicpw5uZnNHbnuJdVF1xvibRX7tM0bZrpgic0fjLzke6Q/640?wx_fmt=png"></section><section><br></section><section><span>点击下方的GenBank即可。将下载的文件放置到当前Rstudio工作目录后，即可开始下一步。</span></section><section><br></section><section><img data-ratio="0.8092592592592592" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6kNicaIOdGdJ3eTia1H0xPZteKdSk2Wqk2ND4NlkpvLcgEuVtuun7pJoIkujibD9byicEe5WzwRZ3oKZQ/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6kNicaIOdGdJ3eTia1H0xPZteKdSk2Wqk2ND4NlkpvLcgEuVtuun7pJoIkujibD9byicEe5WzwRZ3oKZQ/640?wx_fmt=png"></section><section><br></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>#载入上一步获取的GenBank文件：</span><br mpa-from-tpl="t"><span>##质粒名：pFYF1548 EMX1</span><br mpa-from-tpl="t"><span>gb</span> &lt;- read_gb('addgene-plasmid-47508-sequence-67677.gbk')<br mpa-from-tpl="t"><br mpa-from-tpl="t"><span>#图谱可视化：</span><br mpa-from-tpl="t"><span>p3</span> &lt;- plot_plasmid(gb, <br mpa-from-tpl="t">                   <span>name</span> = 'pFYF1548 EMX1')<br mpa-from-tpl="t"><span>p3</span></code></pre></section><p><br></p><section><img data-ratio="0.9592476489028213" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6kNicaIOdGdJ3eTia1H0xPZte2FlA7hgUJvbNPuwxSPtOxVcfkq1XpfLPvNBMBvDr9WJgFJSteyJuAg/640?wx_fmt=png" data-type="png" data-w="957" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6kNicaIOdGdJ3eTia1H0xPZte2FlA7hgUJvbNPuwxSPtOxVcfkq1XpfLPvNBMBvDr9WJgFJSteyJuAg/640?wx_fmt=png"></section><section><br></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>#自定义配色：</span><br mpa-from-tpl="t"><span>c4a_gui</span>()<br mpa-from-tpl="t"><span>mycol1</span> &lt;- c4a('pastel1',5) <span>#适合明亮、较浅的色板</span><br mpa-from-tpl="t"><span>mycol2</span> &lt;- c4a('classic10light',8)<br mpa-from-tpl="t"><br mpa-from-tpl="t"><span>p3</span> + scale_fill_manual(values = mycol1)</code></pre></section><p><br></p><section><img data-ratio="0.9592476489028213" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6kNicaIOdGdJ3eTia1H0xPZten4RcJTSX0CEm3L61geCHjGYAEmDmib3Ql1m9z3HzZ5zXurNCrK8Q6zw/640?wx_fmt=png" data-type="png" data-w="957" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6kNicaIOdGdJ3eTia1H0xPZten4RcJTSX0CEm3L61geCHjGYAEmDmib3Ql1m9z3HzZ5zXurNCrK8Q6zw/640?wx_fmt=png"></section><section><br></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>p3</span> + scale_fill_manual(values = rev(mycol2))</code></pre></section><p><br></p><section><img data-ratio="0.9592476489028213" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6kNicaIOdGdJ3eTia1H0xPZteLRJAancA9LyDic3LQ2uha0FXI2vibR5aVl5aDcXR1v7YjU9vF91Egypw/640?wx_fmt=png" data-type="png" data-w="957" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6kNicaIOdGdJ3eTia1H0xPZteLRJAancA9LyDic3LQ2uha0FXI2vibR5aVl5aDcXR1v7YjU9vF91Egypw/640?wx_fmt=png"></section><section><br></section><section><span>该R包目前还处于开发阶段，使用起来参数很简单，想要更个性化需要自己结合ggplot2调整，特定酶切位点信息也需要自行添加（AI等软件都可）。感兴趣可以继续保持关注。</span></section><section><span><br></span></section><section><span>好啦，今天的分享就到这里！</span></section><section><br></section><section data-mpa-template="t" mpa-from-tpl="t"><section data-mpa-template="t" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><p data-mid=""><span>参考资料</span></p></section><section data-mid="" mpa-from-tpl="t"><img data-ratio="1" data-src="https://mmbiz.qpic.cn/mmbiz_png/vc97NTD91nichhsqn9r4V0BTMlJr4n2GSWicoibJxeoUlCIJKkaM4TPnehNRGUlPrianrjBHpaxFgibXYBH6znib7Mibw/640?wx_fmt=png" data-w="38" src="https://mmbiz.qpic.cn/mmbiz_png/vc97NTD91nichhsqn9r4V0BTMlJr4n2GSWicoibJxeoUlCIJKkaM4TPnehNRGUlPrianrjBHpaxFgibXYBH6znib7Mibw/640?wx_fmt=png"></section></section></section></section></section><p><br></p><section><span>https://github.com/BradyAJohnston/plasmapR</span></section><section><br></section><section><br></section><p><strong><span>*未经许可，不得以任何方式复制或抄袭本篇文章之部分或全部内容。版权所有，侵权必究。</span></strong></p><p><br></p><section data-role="outer" label="Powered by 135editor.com"><section data-tools="135编辑器" data-id="105648"><section><section data-role="outer" label="Powered by 135editor.com"><section data-role="paragraph"><section data-role="outer" label="Powered by 135editor.com"><section data-tools="135编辑器" data-id="105648"><section><section><img data-ratio="0.8780487804878049" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6kCKJYcEqEIfoJYG621mPJE8VibmibGU0Jxic9iabARVRH0FT6BNE8VAglWFXBPibFAU7a6tWGibSs8wyUg/640?wx_fmt=png" data-type="png" data-w="41" data-width="100%" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6kCKJYcEqEIfoJYG621mPJE8VibmibGU0Jxic9iabARVRH0FT6BNE8VAglWFXBPibFAU7a6tWGibSs8wyUg/640?wx_fmt=png"></section><section><section><section data-width="35%"><section><section data-width="100%"><img data-ratio="1" data-src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/tgUVxVRjT6kCKJYcEqEIfoJYG621mPJEv5etCBwHicqbEPwnVrkpaasxqaVibM4mT2JdIuN6yTlYWDD4mL5A427A/640?wx_fmt=jpeg" data-type="jpeg" data-w="860" data-width="100%" title="SCIPainter 30cm二维码.jpg" src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/tgUVxVRjT6kCKJYcEqEIfoJYG621mPJEv5etCBwHicqbEPwnVrkpaasxqaVibM4mT2JdIuN6yTlYWDD4mL5A427A/640?wx_fmt=jpeg"></section></section></section><section data-width="50%"><section><section data-brushtype="text"><span><strong># SCIPainter</strong></span></section><section data-brushtype="text" hm_fix="361:593"><p>基迪奥旗下绘图公众号</p><p>分享科研绘图技能与工具</p><p>欢迎关注与转发~</p></section></section></section></section></section></section></section></section></section></section><section><br></section></section></section><section data-role="paragraph"><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><img data-ratio="1" data-src="https://mmbiz.qpic.cn/sz_mmbiz_gif/tgUVxVRjT6kCKJYcEqEIfoJYG621mPJEgMd0aMPtmrDjiaX8sBhfhicVteeHf1JicexSpUbS3fdS9SiboUVN7guaPw/640?wx_fmt=gif" data-type="gif" data-w="400" src="https://mmbiz.qpic.cn/sz_mmbiz_gif/tgUVxVRjT6kCKJYcEqEIfoJYG621mPJEgMd0aMPtmrDjiaX8sBhfhicVteeHf1JicexSpUbS3fdS9SiboUVN7guaPw/640?wx_fmt=gif"></section></section></section><section><section powered-by="xiumi.us"><section><p><span><strong>你的好友拍了拍你</strong></span></p><p><span><strong>并请你帮她点一下</strong></span><strong><span>“分享”</span></strong><span><strong><span>~</span></strong></span></p></section></section></section></section></section><p><br></p></section></section><section><br></section><p><mp-style-type data-value="10000"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/BYSWwoT6ylK9sKuaL9wD9Q",target="_blank" rel="noopener noreferrer">原文链接</a>
