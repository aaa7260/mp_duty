---
title: "Python的转录组学分析框架与生态"
date: 2023-06-30T02:35:57Z
draft: ["false"]
tags: [
  "fetched",
  "生信技能树"
]
categories: ["Acdemic"]
---
Python的转录组学分析框架与生态 by 生信技能树
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><blockquote data-tool="mdnice编辑器"><p>2023的4月份，看到了NBT的文章：《The scverse project provides a computational ecosystem for single-cell omics data analysis》，是<strong>单细胞领域跟Seurat齐名的scanpy团队的fabian，他号召业内人士建立一个 Python single-cell analysis ecosystem ，希望囊括全部的使用了Python开发的单细胞数据分析工具：</strong></p><p><img data-galleryid="" data-ratio="0.7145631067961165" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wwxkUGz7SOz2zKw1q2aapZpdNeL05gb8pY5L59YOoNkzeiaibdic0dQ93JHIicicbibxMiaYnd0nvYBRDTqQ/640?wx_fmt=png" data-type="png" data-w="1030" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wwxkUGz7SOz2zKw1q2aapZpdNeL05gb8pY5L59YOoNkzeiaibdic0dQ93JHIicicbibxMiaYnd0nvYBRDTqQ/640?wx_fmt=png"></p></blockquote><blockquote data-tool="mdnice编辑器">虽然佩服，但是fabian远在欧洲，很难直接沟通交流。但是国内学者在同一时间也有意打造Python的转录组学分析框架与生态，值得宣传和鼓励：<span></span></blockquote></section><p data-tool="mdnice编辑器">2023年6月7日，来自北京科技大学，清华大学与中山大学的研究者在biorxiv上发布了一篇题为“OmicVerse: A single pipeline for exploring the entire transcriptome universe” 的研究工作，<span>该框架的提出解决了RNAseq分析诸多问题：</span></p><ul data-tool="mdnice编辑器"><li><section><span>解决了单细胞转录组学与bulk转录组学分析中不同算法的格式不一致，运算过慢以及不够美观的可视化问题；</span></section></li><li><section><span>除此之外，该框架还提出了一种名为“BulkTrajBlend”的单细胞插补算法，用于解决单细胞测序中由于技术限制（如通量，细胞类型）导致的细胞分化的中断问题。</span></section></li></ul><p data-tool="mdnice编辑器">我们邀请到了论文的第一作者来介绍整个工作。</p><ul data-tool="mdnice编辑器"><li><section>代码仓库：https://github.com/Starlitnightly/omicverse/</section></li><li><section>框架教程：https://omicverse.readthedocs.io/en/latest/</section></li></ul><hr data-tool="mdnice编辑器"><h2 data-tool="mdnice编辑器"><span>引言</span></h2><p data-tool="mdnice编辑器"><span><strong>omicverse</strong></span>是在我大三保研做Bulk RNA-seq时提出的，当时为了自己的方便，就把差异表达分析（DEG），加权基因共表达分析（WGCNA），通路富集分析（GSEA）等整合进了一个叫Pyomic的包中方便自己调用，当时的野心很大，想把整个组学分析都用Python来完成<strong>（笑）</strong>。</p><p data-tool="mdnice编辑器">现在博士一年级，也做了快两年的单细胞分析，中途用了很多包，<strong>但不同的包之间，对于格式的需求往往是不一样的</strong>，而且有的包本身并<strong>没有好好利用GPU的计算优势</strong>，并且大部分的<strong>包所作的图与CNS上的图差别还是比较大的</strong>。所以我就把当时的Pyomic给捡了起来，把我做分析用到的所有包都塞进了omicverse里面，统一了它们的输入输出，并对部分可以优化的算法进行了优化，以及给出了一些新的可视化函数来帮助研究人员呈现结果。可能你会想，这不就是一个整合的包吗？但其实不是。</p><ul data-tool="mdnice编辑器"><li><section>我通过大量的基准测试，以及相关的paper，<strong>整理出了一套最适的Python单细胞分析流程，Bulk RNA-seq分析流程与可视化。</strong></section></li><li><section>我提出了一种新的生物学算法<strong>“BulkTrajBlend”，解决了单细胞测序中由于通量限制导致的细胞不连续现象。</strong></section></li></ul><figure data-tool="mdnice编辑器"><img data-backh="274" data-backw="474" data-ratio="0.5787037037037037" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/UGxk62Z8n3QHGW7ib5P0WAZYibnUrjysYngu7pnUkWib6qIBxZtGZLlufiaXBaD8jXpVIO9VLibroJUfU55ibMLRMyKg/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/UGxk62Z8n3QHGW7ib5P0WAZYibnUrjysYngu7pnUkWib6qIBxZtGZLlufiaXBaD8jXpVIO9VLibroJUfU55ibMLRMyKg/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"><figcaption>图1｜omicverse的概述</figcaption></figure><hr data-tool="mdnice编辑器"><h2 data-tool="mdnice编辑器"><span>Bulk RNA-seq</span></h2><p data-tool="mdnice编辑器">整个框架由三部分构成，分别是Bulk RNA-seq，singel cell RNA-seq以及Bulk2Single部分。</p><p data-tool="mdnice编辑器">omicverse提出了一套完整的Bulk RNA-seq分析流程，包括基因ID比对，差异表达分析（ttest，wliconx，DESeq2），通路富集分析，基因共表达模块分析。</p><p data-tool="mdnice编辑器">在Supplementary Note里面，我们通过阿尔茨海默症的RNA-seq数据演示了整个分析。</p><p data-tool="mdnice编辑器"><code>Bulk RNA-seq分析教程：</code>https://omicverse.readthedocs.io/en/latest/Tutorials-bulk/t_deseq2/</p><figure data-tool="mdnice编辑器"><img data-backh="340" data-backw="474" data-ratio="0.7175925925925926" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/UGxk62Z8n3QHGW7ib5P0WAZYibnUrjysYnAc8DWmS5f43oMzhb4BblJEu50za7aDoEv6YKFGYky9OImXH122dzCQ/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/UGxk62Z8n3QHGW7ib5P0WAZYibnUrjysYnAc8DWmS5f43oMzhb4BblJEu50za7aDoEv6YKFGYky9OImXH122dzCQ/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"><figcaption>图2｜Bulk RNA-seq的分析效果</figcaption></figure><hr data-tool="mdnice编辑器"><h2 data-tool="mdnice编辑器"><span>single cell RNA-seq</span></h2><p data-tool="mdnice编辑器">对于单细胞分析，omicverse也提供了一套完整的分析框架，包括<code>单</code>细胞质控与预处理,细胞类型自动注释，细胞分化轨迹推断，亚群差异表达分析，细胞通路打分AUCell，药物反应预测，细胞通讯分析。我们应用结直肠癌的单细胞数据来完成了分析的实验。</p><p data-tool="mdnice编辑器"><code>单细胞RNA-seq分析教程：</code>https://omicverse.readthedocs.io/en/latest/Tutorials-single/t_cellanno/</p><figure data-tool="mdnice编辑器"><img data-backh="259" data-backw="474" data-ratio="0.5453703703703704" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/UGxk62Z8n3QHGW7ib5P0WAZYibnUrjysYn464LxIEyUtu27qiaibt6HRWADB53ascFXicGRN73uliaXrjA9MYaVx6c2w/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/UGxk62Z8n3QHGW7ib5P0WAZYibnUrjysYn464LxIEyUtu27qiaibt6HRWADB53ascFXicGRN73uliaXrjA9MYaVx6c2w/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"></figure><figure data-tool="mdnice编辑器"><img data-backh="397" data-backw="474" data-ratio="0.837037037037037" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/UGxk62Z8n3QHGW7ib5P0WAZYibnUrjysYnUJz03vNdNXPViaNOibRKeX0GJcXicU6to7MmosibuPE2ubI6jOp3mPhyZQ/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/UGxk62Z8n3QHGW7ib5P0WAZYibnUrjysYnUJz03vNdNXPViaNOibRKeX0GJcXicU6to7MmosibuPE2ubI6jOp3mPhyZQ/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"><figcaption>图3&amp;图4｜单细胞RNA-seq的分析效果</figcaption></figure><hr data-tool="mdnice编辑器"><h2 data-tool="mdnice编辑器"><span>scRNA-seq与scATAC-seq联合分析</span></h2><p data-tool="mdnice编辑器">在去年，来自北京大学的高歌课题组提出了一种名为GLUE的算法，将两个不同的组学层嵌入到一个低维空间中，文章发表在Nature Biotechnology。在2018年，多组学算法MOFA的提出解决了斑马鱼内胚层命运的分化问题，文章发表在Nature上。但MOFA受限于一个样本多个组学层，GLUE恰好可以解决不同组学层的整合问题，故我们将GLUE与MOFA的联合分析整合进了omicverse中。我们在Supplementary中应用阿尔兹海默症证明分析的可靠性。</p><p data-tool="mdnice编辑器"><code>多组学分析教程：</code>https://omicverse.readthedocs.io/en/latest/Tutorials-single/t_mofa_glue/</p><figure data-tool="mdnice编辑器"><img data-backh="285" data-backw="474" data-ratio="0.6018518518518519" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/UGxk62Z8n3QHGW7ib5P0WAZYibnUrjysYn6LzyKHm3VQHibZlm7avHqY1qyICzrEgbbRWIEhibjjumev9iawwWQJbYA/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/UGxk62Z8n3QHGW7ib5P0WAZYibnUrjysYn6LzyKHm3VQHibZlm7avHqY1qyICzrEgbbRWIEhibjjumev9iawwWQJbYA/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"><figcaption>图5｜多组学整合效果</figcaption></figure><hr data-tool="mdnice编辑器"><h2 data-tool="mdnice编辑器"><span>从Bulk RNA-seq生成Single RNA-seq</span></h2><p data-tool="mdnice编辑器">2022年，浙江大学范晓辉课题组提出了BulkSpace算法，该算法利用解卷积与深度随机森林模型解决了从Bulk RNA-seq生成空间转录组数据的问题。我们将该算法拆解成两个部分：bulk2single与single2spatial，并且我们改进了single2spatial部分，因为原作者是想用深度随机森林完成分类问题，我们改成了神经网络完成分类问题，充分利用了GPU加速。我们对比了优化前后的算法，分类与生成效果一致，同时速度大幅提升。我们在阿尔茨海默症和PDAC数据上给出了算法的分析框架。</p><p data-tool="mdnice编辑器"><code>Bulk2single分析教程：</code>https://omicverse.readthedocs.io/en/latest/Tutorials-bulk2single/t_bulk2single/</p><figure data-tool="mdnice编辑器"><img data-backh="353" data-backw="474" data-ratio="0.7444444444444445" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/UGxk62Z8n3QHGW7ib5P0WAZYibnUrjysYne3qcvdic8icylAH0OXKSUdEgkzIYtwrcUDSl5m8MHmOALgycWgN5LicWw/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/UGxk62Z8n3QHGW7ib5P0WAZYibnUrjysYne3qcvdic8icylAH0OXKSUdEgkzIYtwrcUDSl5m8MHmOALgycWgN5LicWw/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"><figcaption>图6｜Bulk2single分析效果</figcaption></figure><hr data-tool="mdnice编辑器"><h2 data-tool="mdnice编辑器"><span>结语</span></h2><p data-tool="mdnice编辑器">我个人很喜欢这项工作，它减少了我很多的代码量。在论文的最后部分我是这么写的。我希望构建一个基于Python的转录组学分析框架与生态，但仅凭我一人之力可能还有很多问题没有发现，欢迎对omicverse感兴趣的研究人员在github上面提相关的issue或者pr，帮助omicverse变得更好。</p><p data-tool="mdnice编辑器"><span><strong>github地址：https://github.com/Starlitnightly/omicverse/</strong></span></p><p><img data-galleryid="" data-ratio="0.6648148148148149" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wwxkUGz7SOz2zKw1q2aapZpy07ybq1egMbduLQnHp5SpdSfarW0icmjg3jmTJibAWrt9iaib1Tp4icKAsg/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wwxkUGz7SOz2zKw1q2aapZpy07ybq1egMbduLQnHp5SpdSfarW0icmjg3jmTJibAWrt9iaib1Tp4icKAsg/640?wx_fmt=png"></p><blockquote data-tool="mdnice编辑器"><blockquote><p>我们的目标是在Python环境中创建一个适用于bulk/singel RNA-seq分析和优美可视化的生态系统。用户可以利用Python社区的机器学习模型和专业知识，使用单一编程语言进行全面的转录组分析。随着OmicVerse不断发展，我们预计会进行持续更新，引入新的算法、功能和模型。OmicVerse预计将受益于bulk/singel RNA-seq社区，促进新模型的原型开发，建立跨组学分析的标准，以及加强科学发现的流程。</p></blockquote></blockquote><p data-tool="mdnice编辑器">参考文献：</p><p data-tool="mdnice编辑器">[1] Zeng Z, Ma Y, Hu L, Xiong Y, Du H. OmicVerse: A single pipeline for exploring the entire transcriptome universe. Cold Spring Harbor Laboratory; 2023.</p><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><h3 data-tool="mdnice编辑器"><span></span>写在文末<span></span></h3><p data-tool="mdnice编辑器">如果你也擅长Python，想在生物信息学工具开发路上找到同道中人，那么这个Python的转录组学分析框架与生态交流群请不要错过。因为交流群名额限制，所以仅限于有Python开发能力的小伙伴进群，大家可以去 github地址：https://github.com/Starlitnightly/omicverse/ 进行star操作，然后申请入群哈。需要发邮件给 starlitnightly@163.com 并且告知自己的github账号哈。</p><p data-tool="mdnice编辑器">如果是前面的200人，有Python开发能力的小伙伴可以直接扫描下面的二维码哈。</p><p><img data-galleryid="" data-ratio="1.1917808219178083" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wwxkUGz7SOz2zKw1q2aapZp2sQvpsRjRDqJpd6L2KTWTziaruRqBUre5uKxFyUcQELZXLSFmCLvEwA/640?wx_fmt=png" data-type="png" data-w="292" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wwxkUGz7SOz2zKw1q2aapZp2sQvpsRjRDqJpd6L2KTWTziaruRqBUre5uKxFyUcQELZXLSFmCLvEwA/640?wx_fmt=png"></p><p data-tool="mdnice编辑器">（友情提示：交流群有门槛，沟通有难度，慎入！！！）<br></p></section><p><br></p><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/vq9dBOH_qDZlg-7hLsu9Dg",target="_blank" rel="noopener noreferrer">原文链接</a>
