---
title: "当clusterProfiler遇见stringdb..."
date: 2023-06-07T01:30:44Z
draft: ["false"]
tags: [
  "fetched",
  "YuLabSMU"
]
categories: ["Acdemic"]
---
当clusterProfiler遇见stringdb... by YuLabSMU
------
<div><p data-mpa-powered-by="yiban.io"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzI5NjUyNzkxMg==&amp;mid=2247492813&amp;idx=1&amp;sn=0fa7fbe32f1fb534f226561f03009ca5&amp;chksm=ec40558adb37dc9cc52914436f71d29c50911204b3c672c391cc22367b0ff0425483ec680736&amp;scene=21#wechat_redirect" textvalue="你已选中了添加链接的内容" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="1"><span><img data-backh="333" data-backw="578" data-galleryid="" data-ratio="0.575" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/MPBFtnFrw4lhX0gicBOzP0mia9Bo8eaInx4jOEhAZVK9qWicOgpnIHf0tHFSgOj3iaG2EiblP6WtbeF7saHTjNoUkfg/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/MPBFtnFrw4lhX0gicBOzP0mia9Bo8eaInx4jOEhAZVK9qWicOgpnIHf0tHFSgOj3iaG2EiblP6WtbeF7saHTjNoUkfg/640?wx_fmt=png"></span></a></p><p>上次搞的ProjectYulab，还是有小伙伴响应的。当前最好的一个案例就是我说支持PPI网络的，直接上截图。</p><p><img data-backh="3640" data-backw="398" data-croporisrc="https://mmbiz.qpic.cn/mmbiz_jpg/MPBFtnFrw4lhX0gicBOzP0mia9Bo8eaInxDmrZ3tH6MBOria8icFyJECdT3CbMP3hU9JZd3J0B6rcSiafxFTKAV45ug/640?wx_fmt=jpeg" data-cropx1="44.844290657439444" data-cropx2="788.5121107266436" data-cropy1="0" data-cropy2="6805.1211072664355" data-ratio="9.146505376344086" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/MPBFtnFrw4laxfj3ZL7OcebCCyyicLgJQOmjIg2avwZB5oTdYbg5IAU09wtlYxF0Kia4dSrpWyb2Vo7wm1appTRQ/640?wx_fmt=jpeg" data-type="jpeg" data-w="744" src="https://mmbiz.qpic.cn/mmbiz_jpg/MPBFtnFrw4laxfj3ZL7OcebCCyyicLgJQOmjIg2avwZB5oTdYbg5IAU09wtlYxF0Kia4dSrpWyb2Vo7wm1appTRQ/640?wx_fmt=jpeg"></p><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><p data-tool="mdnice编辑器"><span>那么在当前github版本的</span><code>clusterProfiler</code><span>中，我们把这块功能给加进去了。</span><span>直接上实例吧。</span></p><pre data-tool="mdnice编辑器"><span></span><code>require(aplot)<br>require(ggplot2)<br>require(clusterProfiler)<br><br>genes &lt;- c(<span>"TP53"</span>, <span>"BRCA1"</span>, <span>"BRCA2"</span>, <span>"S100A6"</span>)<br>g1 &lt;- getPPI(genes, taxID=<span>"9606"</span>)<br>plot(g1)<br></code></pre></section><p><img data-backh="510" data-backw="578" data-galleryid="" data-ratio="0.8820754716981132" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/MPBFtnFrw4laxfj3ZL7OcebCCyyicLgJQIGiaECk6GsRKnLGexkaWZbbLmlaib7mBtBWhu7YXfbicHu4hic7hp3GkeA/640?wx_fmt=png" data-type="png" data-w="636" src="https://mmbiz.qpic.cn/mmbiz_png/MPBFtnFrw4laxfj3ZL7OcebCCyyicLgJQIGiaECk6GsRKnLGexkaWZbbLmlaib7mBtBWhu7YXfbicHu4hic7hp3GkeA/640?wx_fmt=png"></p><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><p data-tool="mdnice编辑器">一条<code>plot</code>指令就出图了。当然这只是<code>igraph</code>默认的画图，我们留待以后再加强一下画图的功能。</p><p data-tool="mdnice编辑器">新加入的<code>getPPI</code>函数，你的输入只需要基因向量，以及相应的物种ID即可。</p><p data-tool="mdnice编辑器">而这个物种ID，我们也搞了一个函数<code>getTaxID</code>来帮助你获取。</p><pre data-tool="mdnice编辑器"><span></span><code>&gt; getTaxID(<span>"Homo sapiens"</span>)<br>[1] <span>"9606"</span><br></code></pre><p data-tool="mdnice编辑器">那么你肯定要问，你想把一些相互作用的蛋白也纳入进去呢？这有何难，用参数<code>add_nodes</code>指令数量就可以了。</p><pre data-tool="mdnice编辑器"><span></span><code>g2 &lt;- getPPI(genes, taxID=<span>'9606'</span>, add_nodes=10)<br>plot(g2)<br></code></pre></section><p><img data-backh="517" data-backw="578" data-galleryid="" data-ratio="0.8933764135702746" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/MPBFtnFrw4laxfj3ZL7OcebCCyyicLgJQPBibia1YFNN1IZ4eFBobTr8KCuDZKgtNNsoudlYPj47dCP8xXlfn6yqQ/640?wx_fmt=png" data-type="png" data-w="619" src="https://mmbiz.qpic.cn/mmbiz_png/MPBFtnFrw4laxfj3ZL7OcebCCyyicLgJQPBibia1YFNN1IZ4eFBobTr8KCuDZKgtNNsoudlYPj47dCP8xXlfn6yqQ/640?wx_fmt=png"></p><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><hr data-tool="mdnice编辑器"><p data-tool="mdnice编辑器">接下来，你肯定要问，那和富集分析有什么关系？</p><p data-tool="mdnice编辑器">我们来跑个例子吧。</p><pre data-tool="mdnice编辑器"><span></span><code>data(geneList, package=<span>"DOSE"</span>)<br>de = names(geneList)[1:100]<br><br>x = enrichKEGG(de)      <br>y = setReadable(x, <span>'org.Hs.eg.db'</span>, <span>'ENTREZID'</span>)<br></code></pre><p data-tool="mdnice编辑器">然后我们拿第一条富集的结果出来看。</p><pre data-tool="mdnice编辑器"><span></span><code>&gt; y[1,]<br>               ID Description GeneRatio  BgRatio       pvalue    p.adjust<br>hsa04110 hsa04110  Cell cycle     12/58 157/8398 5.077653e-10 6.14396e-08<br>               qvalue<br>hsa04110 5.719041e-08<br>                                                                        geneID<br>hsa04110 CDC45/CDC20/CCNB2/NDC80/CCNA2/CDK1/MAD2L1/CDT1/TTK/AURKB/CHEK1/TRIP13<br>         Count<br>hsa04110    12<br></code></pre><p data-tool="mdnice编辑器">假如我就想看看富集于某个通路的基因其编码的蛋白质之间是个什么样的相互作用，那么现在就很简单了。富集分析的结果直接可以做为<code>getPPI</code>的输入，然后可以传一下富集分析中的第几条通路，是想要看的。</p><pre data-tool="mdnice编辑器"><span></span><code>g = getPPI(y, 1)<br>plot(g)<br></code></pre><p><img data-backh="521" data-backw="558" data-galleryid="" data-ratio="0.9336734693877551" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/MPBFtnFrw4laxfj3ZL7OcebCCyyicLgJQfvydDSmn8YaiaRbcRkicjicFbaJPbr94rct4icWnnTRsQ7j3xxxTDLDp4Q/640?wx_fmt=png" data-type="png" data-w="588" src="https://mmbiz.qpic.cn/mmbiz_png/MPBFtnFrw4laxfj3ZL7OcebCCyyicLgJQfvydDSmn8YaiaRbcRkicjicFbaJPbr94rct4icWnnTRsQ7j3xxxTDLDp4Q/640?wx_fmt=png"></p><p data-tool="mdnice编辑器">要加蛋白进入，同样指定一下数目，就加进去了。</p><pre data-tool="mdnice编辑器"><span></span><code>g2 = getPPI(y, 1, add_nodes=10)<br>plot(g2)<br></code></pre><p><img data-backh="489" data-backw="558" data-galleryid="" data-ratio="0.8758169934640523" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/MPBFtnFrw4laxfj3ZL7OcebCCyyicLgJQRDpYUh0IpEaH8vRz1KoG6IYDsyKALffMscrIARwkkzyiaNoyCz1zQjQ/640?wx_fmt=png" data-type="png" data-w="612" src="https://mmbiz.qpic.cn/mmbiz_png/MPBFtnFrw4laxfj3ZL7OcebCCyyicLgJQRDpYUh0IpEaH8vRz1KoG6IYDsyKALffMscrIARwkkzyiaNoyCz1zQjQ/640?wx_fmt=png"></p><p data-tool="mdnice编辑器">那么你还想问，能不能几条通路的基因一起进去做PPI网络，这当然可以。</p><p data-tool="mdnice编辑器">聪明的你可能已经发现，为什么这些PPI网络都这么高度连通？因为stringdb就是这样，它默认是会把功能相关的（比如同表达）也做给连上边，如果我们就只要相互作用，那么边会少一些的，这个可能通过参数设定。</p><pre data-tool="mdnice编辑器"><span></span><code>g4 = getPPI(y, 1:3, network_type = <span>"physical"</span>)<br>plot(g4)<br></code></pre><p><img data-backh="468" data-backw="558" data-galleryid="" data-ratio="0.8387622149837134" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/MPBFtnFrw4laxfj3ZL7OcebCCyyicLgJQ5k4X8dyembjWIAWv6DSn06ibxJQZV38VqfwlZ2zANwCMZgicE3p56RMg/640?wx_fmt=png" data-type="png" data-w="614" src="https://mmbiz.qpic.cn/mmbiz_png/MPBFtnFrw4laxfj3ZL7OcebCCyyicLgJQ5k4X8dyembjWIAWv6DSn06ibxJQZV38VqfwlZ2zANwCMZgicE3p56RMg/640?wx_fmt=png"></p><p data-tool="mdnice编辑器">最后的最后，我们再配合一个<code>aplot</code>，那么我们就可以拼出来不同的通路相应的PPI了。</p><pre data-tool="mdnice编辑器"><span></span><code>pp &lt;- list(<br>    ~plot(getPPI(y, 1, network_type = <span>"physical"</span>)),<br>    ~plot(getPPI(y, 2, network_type = <span>"physical"</span>))<br>)<br>names(pp) &lt;- y<span>$Description</span>[1:2]<br><br>pg &lt;- plot_list(gglist = pp, ncol=1)<br>pg<br></code></pre><p><img data-galleryid="" data-ratio="1.072150072150072" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/MPBFtnFrw4laxfj3ZL7OcebCCyyicLgJQRPwssmgu35Pu95496hF6OBSOeicxvmLJWZUNxULZQpSTjQnnsZfkjRA/640?wx_fmt=png" data-type="png" data-w="693" src="https://mmbiz.qpic.cn/mmbiz_png/MPBFtnFrw4laxfj3ZL7OcebCCyyicLgJQRPwssmgu35Pu95496hF6OBSOeicxvmLJWZUNxULZQpSTjQnnsZfkjRA/640?wx_fmt=png"></p><p data-tool="mdnice编辑器">当然需要强调一下的是，我们还可以自己搞点基于<code>ggplot2</code>画网络图的函数，然后画图会更好一些。感觉是应该这样搞一下，以后网络图就可以成为了大家富集分析结果的一张子图了。</p><p data-tool="mdnice编辑器">好了，再回到开头，然后可以有更多的小伙伴加入到ProjectYulab中来，练练手还是不错的。</p></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/bGPP0Y8lI2qJ1KKvKD6e3Q",target="_blank" rel="noopener noreferrer">原文链接</a>
