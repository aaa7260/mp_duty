---
title: "【综合测评】单细胞基因集打分方法"
date: 2023-06-14T04:57:10Z
draft: ["false"]
tags: [
  "fetched",
  "TOP生物信息"
]
categories: ["Acdemic"]
---
【综合测评】单细胞基因集打分方法 by TOP生物信息
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><h2 data-tool="mdnice编辑器"><span>写在前面</span><span> </span></h2><section>囧！从单细胞大会才回来，明天又要主打一个陪伴，当个导游，再次出门了！</section><section>在间隔在家休整的这一天，我把之前单细胞基因集合打分专辑中最关键的软件测评加急整理了下，以下就是测试的情况。</section><section>测试的方面可能会不是非常全面，但是希望能抛砖引玉，给大家一个思路，去横评同类软件的思路和方法。</section><h2 data-tool="mdnice编辑器"><span></span><span>横向测评</span><span> </span></h2><section>是的，横向进行测评了，目前测试的工具包括了：AddModuleScore、AUCell、gsva、ssgsea、zscore、plage、JAS_likelihood、JAS_oddsratio、singscore、VISION、UCell共11种方法。</section><section>之前这些方法都进行了介绍和部分测试，今天主打的横向测试主要是运行时间，消耗资源，打分之间的相似程度等情况。</section><h3 data-tool="mdnice编辑器"><span></span>运行时间<span></span></h3><section>运行时间其实和纳入计算的细胞数目是存在一定联系的，因此，设置了若干个细胞数目进行测试，同时记录每个软件的运行时间，最终结果如下图，由于GSVA运行时间实在太慢，非常离谱的时间（GSVA仅仅1000个细胞运行就要15分钟以上），因此就没有在下图中画出来的。</section><section>可以看出来，从最快到最慢排序：AddModuleScore、AUCell、singscore、UCell、plage、zscore、JAS_likelihood、JAS_oddsratio、ssgsea、VISION、gsva。</section><figure data-tool="mdnice编辑器"><figcaption><br></figcaption><p><img data-galleryid="" data-ratio="0.9289693593314763" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/NZV5ovF8kLuM3gq5YshibdrCAHqU7JVT5NwZr81LxKjChctnxIkhdwJZlchibvZo8GgmWhKLTGvicFSkpice2AKMWw/640?wx_fmt=png" data-type="png" data-w="718" src="https://mmbiz.qpic.cn/mmbiz_png/NZV5ovF8kLuM3gq5YshibdrCAHqU7JVT5NwZr81LxKjChctnxIkhdwJZlchibvZo8GgmWhKLTGvicFSkpice2AKMWw/640?wx_fmt=png"></p></figure><h3 data-tool="mdnice编辑器"><span></span>相似程度<span></span></h3><section>实在很难度量方法和真实的情况之间的比较，这里仅仅是比较方法之间的差异或者相似程度。</section><section>这里使用的是相关性进行度量，一般相关性程度越高，结果相似程度越高，然后以热图进行展示。</section><section>PLAGE其实数值与其他打分是相反的，故而相关性是负值。如果仅仅以相似程度看，其实<span>11种方法还是非常相近的。</span></section><figure data-tool="mdnice编辑器"><p><img data-galleryid="" data-ratio="0.9925149700598802" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/NZV5ovF8kLuM3gq5YshibdrCAHqU7JVT5wW1UiayJFDpFdI5yIYicibV8sdxDGhibKPmmJDdPao2amicjGBmNibHV6ACg/640?wx_fmt=png" data-type="png" data-w="668" src="https://mmbiz.qpic.cn/mmbiz_png/NZV5ovF8kLuM3gq5YshibdrCAHqU7JVT5wW1UiayJFDpFdI5yIYicibV8sdxDGhibKPmmJDdPao2amicjGBmNibHV6ACg/640?wx_fmt=png"></p><figcaption><br></figcaption></figure><section>为了让结果更加清晰，去掉PLAGE再进行热图绘制，图例发生了改变，但是整体的相关性还是基本都是大于0.8的。比较远的是zscore的方法，剩下方法其实相似程度还是较高的。但是还是存在一定的差别。这个和每个打分方法的取值范围是有关的。可以看到UCell、AddModuleScore和VISION还是比较接近的。</section><figure data-tool="mdnice编辑器"><p><img data-galleryid="" data-ratio="0.9985052316890882" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/NZV5ovF8kLuM3gq5YshibdrCAHqU7JVT59A7rAgD8nJvqD2jcXw667bCIAkxGfr6hLwdiaWOW1JQ2wQD4deAicGLA/640?wx_fmt=png" data-type="png" data-w="669" src="https://mmbiz.qpic.cn/mmbiz_png/NZV5ovF8kLuM3gq5YshibdrCAHqU7JVT59A7rAgD8nJvqD2jcXw667bCIAkxGfr6hLwdiaWOW1JQ2wQD4deAicGLA/640?wx_fmt=png"></p><figcaption><br></figcaption></figure><section>为了更加细化，还对每个方法进行了散点图的绘制。</section><section>由于实在太多，这里就展示部分结果：</section><p data-tool="mdnice编辑器"><strong>AddModuleScore vs UCell：</strong></p><figure data-tool="mdnice编辑器"><p><img data-galleryid="" data-ratio="0.8847682119205298" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/NZV5ovF8kLuM3gq5YshibdrCAHqU7JVT5WzmuTe2Qwsk0yKx9TIxBEGgYAEXLUp7MvicVCQrTIQxPEKXrRicJzB6Q/640?wx_fmt=png" data-type="png" data-w="755" src="https://mmbiz.qpic.cn/mmbiz_png/NZV5ovF8kLuM3gq5YshibdrCAHqU7JVT5WzmuTe2Qwsk0yKx9TIxBEGgYAEXLUp7MvicVCQrTIQxPEKXrRicJzB6Q/640?wx_fmt=png"></p><figcaption><br></figcaption></figure><p data-tool="mdnice编辑器"><strong>AddModuleScore vs VISION：</strong></p><figure data-tool="mdnice编辑器"><p><img data-galleryid="" data-ratio="0.884" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/NZV5ovF8kLuM3gq5YshibdrCAHqU7JVT5zR2eAWDTia8Hk9mBf9MiaMMk6Rx7EozOiaATmjnDUzE8B7C71dysXgosQ/640?wx_fmt=png" data-type="png" data-w="750" src="https://mmbiz.qpic.cn/mmbiz_png/NZV5ovF8kLuM3gq5YshibdrCAHqU7JVT5zR2eAWDTia8Hk9mBf9MiaMMk6Rx7EozOiaATmjnDUzE8B7C71dysXgosQ/640?wx_fmt=png"></p><figcaption><br></figcaption></figure><p data-tool="mdnice编辑器"><strong>UCell vs VISION：</strong></p><figure data-tool="mdnice编辑器"><p><img data-galleryid="" data-ratio="0.9880418535127056" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/NZV5ovF8kLuM3gq5YshibdrCAHqU7JVT5lephbE2hwzTrBPwSs8gPqDogicok41jGu4pxLPmqhAlSA4fo8Tger2w/640?wx_fmt=png" data-type="png" data-w="669" src="https://mmbiz.qpic.cn/mmbiz_png/NZV5ovF8kLuM3gq5YshibdrCAHqU7JVT5lephbE2hwzTrBPwSs8gPqDogicok41jGu4pxLPmqhAlSA4fo8Tger2w/640?wx_fmt=png"></p><figcaption><br></figcaption></figure><h2 data-tool="mdnice编辑器"><span></span><span>总结</span><span> </span></h2><section>经历了这么多测试后，总结了基本的情况，如下表，运行时间和资源消耗只是个相对度量情况评估，整体来说，除却GSVA的方法实在太慢，剩余的方法其实计算速度都还是可以接受的。</section><p><img data-galleryid="" data-ratio="0.5737142857142857" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/NZV5ovF8kLuM3gq5YshibdrCAHqU7JVT5IAZo52Yrt5r7eRxqibymylE5rE7iaB2fzWNSLUAwp0QHakCCCvAzPqWQ/640?wx_fmt=png" data-type="png" data-w="875" src="https://mmbiz.qpic.cn/mmbiz_png/NZV5ovF8kLuM3gq5YshibdrCAHqU7JVT5IAZo52Yrt5r7eRxqibymylE5rE7iaB2fzWNSLUAwp0QHakCCCvAzPqWQ/640?wx_fmt=png"></p><section>考虑到单细胞打分的情况，最理想的状态应该是一种运行时间快、计算资源消耗小，不受seed和纳入细胞数的影响（即每个细胞打分是相对独立的），此外最好能适配seurat的对象。目前适配seurat对象的方法是UCell和AddModuleScore。</section><section><span><strong>因此，根据目前整体情况来说，首推UCell、其次是AddModuleScore，VISION也还可以。</strong></span></section><section>但是需要注意的是UCell打分存在一个缺陷是它打分后的分数数值分布是大于等于0的，而且很多分值存在0的情况，也就是稀疏性被保留在打分的数据分布特征中，这个有好有坏，毕竟数据分布呈现这类特征，往往做组间比较就不太适合正态分布的一些方法。</section><section>AddModuleScore的数据分布就不是，它可以从负值开始。这里可能会有人疑惑，为什么打分会有负值，这个取决于每个算法本身的情况，有些人很难理解负值的意义，其实如果对数学有很深的理解，就知道负值不负值其实是无所谓的，这个在数轴上的相对值的情况。只要能体现不同细胞这些分值的相对大小即可。负值只是在我们定义的数轴位于0点的相对位置罢了，不必纠结是否是负值，而是要考虑不同细胞间的相对大小，因为最终我们对基因集的打分，都是要考虑不同细胞群，不同组之间的相对大小，从而描述实验组与对照组的相对功能变化情况。</section><section>最不推荐的方法是GSVA，实在慢的出奇，尤其细胞数目超过2000后，计算慢到以小时开始计量，而且随着细胞数增多，计算时间呈指数增长，能不用别用！！！</section><section>额外说下：基于单细胞数据开发的：AddModuleScore、UCell、JASMINE。其余很多都是从bulk或芯片数据的方法中移植过来的。</section><section>然后这里需要说明，横向测评也只是作为一种参看，不是绝对的，但是我个人的意见，目前我个人是首推UCell，其次是AddModuleScore的。其他方法我很少使用，并不代表不使用，这个就是具体问题具体分析，没有定论，这个看你数据最终的情况了，我是默认使用UCell，如果结果和实际情况有些相左，我才会使用其他方法，这个需要和其他分析结果一并看待，最终确定，毕竟基因集合打分的方法都是一些算法模型进行的。</section><section><br></section></section><section><mp-common-profile data-pluginname="mpprofile" data-weui-theme="light" data-id="Mzg2MzE4NDg5NQ==" data-headimg="http://mmbiz.qpic.cn/mmbiz_png/NZV5ovF8kLtWP4qv9fhGqZDbadhvsMNMI47p4tKOJ11RbySmiarSb64uFUzlEk8N9giauMkJJhYZy1jhzibNRMpQQ/0?wx_fmt=png" data-nickname="止水的小分享" data-alias="zsdxfx" data-signature="本公众号旨在分享个人在生物信息学、化学生物等科学领域的一些学习体会心得和方法介绍，不足之处，还请海涵！相互切磋，共同进步！" data-from="0" data-is_biz_ban="0"></mp-common-profile></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/1Tp4XsnLKJfFDmqvDDixJQ",target="_blank" rel="noopener noreferrer">原文链接</a>
