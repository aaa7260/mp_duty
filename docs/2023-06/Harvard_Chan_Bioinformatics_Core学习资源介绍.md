---
title: "Harvard Chan Bioinformatics Core学习资源介绍"
date: 2023-06-14T04:55:50Z
draft: ["false"]
tags: [
  "fetched",
  "生信菜鸟团"
]
categories: ["Acdemic"]
---
Harvard Chan Bioinformatics Core学习资源介绍 by 生信菜鸟团
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><blockquote data-tool="mdnice编辑器"><p>本周转录组专辑将给大家带来来自(Harvard Chan Bioinformatics Core)https://github.com/hbctraining的学习资源，并以其中的“差异基因表达（DGE）分析”部分为例进行介绍</p></blockquote><p data-tool="mdnice编辑器">https://github.com/hbctraining/Training-modules</p><p data-tool="mdnice编辑器">这个仓库有2-3小时的教学材料，包括与生物信息学数据分析相关的各种主题的实践研讨会。研讨会将引导参与者使用R/RStudio或Linux进行不同类型的分析</p><figure data-tool="mdnice编辑器"><img data-ratio="0.8181818181818182" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9VKdpAAuwjhoPBiaVfBf4HkvViaBhAe8ed6QjPVrZs9F948UuW8cawuAtlHDBbdicWMSHmibjlSia3haw/640?wx_fmt=png" data-type="png" data-w="1034" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9VKdpAAuwjhoPBiaVfBf4HkvViaBhAe8ed6QjPVrZs9F948UuW8cawuAtlHDBbdicWMSHmibjlSia3haw/640?wx_fmt=png"></figure><figure data-tool="mdnice编辑器"><img data-ratio="1.7309594460929774" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9VKdpAAuwjhoPBiaVfBf4Hk02AfhKeiabMFGibnnicbudXOurQK5XQ4KhdNAJ1ZxCyq9GqdjJMUVia3yQ/640?wx_fmt=png" data-type="png" data-w="1011" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9VKdpAAuwjhoPBiaVfBf4Hk02AfhKeiabMFGibnnicbudXOurQK5XQ4KhdNAJ1ZxCyq9GqdjJMUVia3yQ/640?wx_fmt=png"></figure><hr data-tool="mdnice编辑器"><p data-tool="mdnice编辑器">我们这次将跟着bulk RNA-seq的差异基因表达（DGE）分析部分进行学习</p><ul data-tool="mdnice编辑器"><li><section>bulk RNA-seq</section></li></ul><figure data-tool="mdnice编辑器"><img data-ratio="0.38981481481481484" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9VKdpAAuwjhoPBiaVfBf4HkmjIZAGDaytzhuVdWqqxqSoxIUQ903qhmS7IySTZ1d04DaSfxfiaYCnQ/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9VKdpAAuwjhoPBiaVfBf4HkmjIZAGDaytzhuVdWqqxqSoxIUQ903qhmS7IySTZ1d04DaSfxfiaYCnQ/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">Setting up for Success: Everything you need to know when planning an RNA-seq experiment</p><p data-tool="mdnice编辑器">https://hbctraining.github.io/Training-modules/planning_successful_rnaseq</p><figure data-tool="mdnice编辑器"><img data-ratio="0.9520333680917622" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9VKdpAAuwjhoPBiaVfBf4Hk3amZs8Mhl9YLmhwL200FbvSVtdZwq5TtDRH6L59cBsxru6OQeDlVEw/640?wx_fmt=png" data-type="png" data-w="959" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9VKdpAAuwjhoPBiaVfBf4Hk3amZs8Mhl9YLmhwL200FbvSVtdZwq5TtDRH6L59cBsxru6OQeDlVEw/640?wx_fmt=png"></figure><ul data-tool="mdnice编辑器"><li><section>差异基因表达（DGE）分析部分</section></li></ul><p data-tool="mdnice编辑器">Differential gene expression (DGE) analysis. Materials for short, half-day workshops.</p><p data-tool="mdnice编辑器">https://hbctraining.github.io/Training-modules/planning_successful_rnaseq/lessons/sample_level_QC.html</p><hr data-tool="mdnice编辑器"><p data-tool="mdnice编辑器">RNA-seq工作流程的下一步是差异表达分析，差异表达的目的是确定哪些基因在不同条件下以不同水平表达，这些基因可以提供对受感兴趣条件影响的过程的生物学见解</p><p data-tool="mdnice编辑器">接下来我们将描述端到端基因水平RNA-seq差异表达工作流程中的步骤</p><blockquote data-tool="mdnice编辑器"><p>“end-to-end gene-level”指的是一种从头到尾的基因水平RNA-seq差异表达分析工作流程。这意味着该工作流程包括从RNA-seq原始数据清洗、组装、定量等过程，直到最终从条件之间不同水平的表达检测到差异基因。</p></blockquote><figure data-tool="mdnice编辑器"><img data-ratio="1.4083129584352079" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9VKdpAAuwjhoPBiaVfBf4HkUZ6cgMLwW9vibFxTnx8N8XZzxxPrt1tSBWUk4rrJ9H1Zz7XrdLxzP0g/640?wx_fmt=png" data-type="png" data-w="409" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9VKdpAAuwjhoPBiaVfBf4HkUZ6cgMLwW9vibFxTnx8N8XZzxxPrt1tSBWUk4rrJ9H1Zz7XrdLxzP0g/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">那么，计数（count）数据实际上代表什么呢？用于差异表达分析的计数数据表示源自特定基因的序列读取（reads）次数。计数次数越高，与该基因相关的读数越多，并且假设该基因在样本中的表达水平越高。</p><figure data-tool="mdnice编辑器"><img data-ratio="0.39572192513368987" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9VKdpAAuwjhoPBiaVfBf4HkeN77CS8TN2heZqVQPHpiaP9JHSAHBjPsbtPmc7cBGI2pNInKyr6FmIQ/640?wx_fmt=png" data-type="png" data-w="748" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9VKdpAAuwjhoPBiaVfBf4HkeN77CS8TN2heZqVQPHpiaP9JHSAHBjPsbtPmc7cBGI2pNInKyr6FmIQ/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">差异表达(DE)分析步骤以绿色显示在下面的流程图中。首先，需要对计数数据进行<strong>归一化</strong>，以说明样本之间文库大小和RNA组成的差异。然后，我们将使用归一化计数在基因和样本水平上绘制一些<strong>QC</strong>图。最后，使用您感兴趣的工具进行<strong>差异表达分析</strong></p><figure data-tool="mdnice编辑器"><img data-ratio="0.7208413001912046" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9VKdpAAuwjhoPBiaVfBf4HkAeEibZ9iaXbOPFkk67juI9YRcHM1s6rY47p5KSQjEMfCQiaiaUXjhlicn7g/640?wx_fmt=png" data-type="png" data-w="523" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9VKdpAAuwjhoPBiaVfBf4HkAeEibZ9iaXbOPFkk67juI9YRcHM1s6rY47p5KSQjEMfCQiaiaUXjhlicn7g/640?wx_fmt=png"></figure><h2 data-tool="mdnice编辑器"><span></span>1.Normalization</h2><p data-tool="mdnice编辑器">DE分析工作流程的第一步是计数归一化，这对于准确比较样本之间的基因表达是必要的。</p><p data-tool="mdnice编辑器">除了许多其他因素（“不感兴趣”）外，每个基因的映射读数计数与RNA的表达成比例（“感兴趣的”）。归一化是缩放原始计数值以考虑“不感兴趣”因素的过程。通过这种方式，样品之间和样品内部的表达水平更具可比性。</p><p data-tool="mdnice编辑器">归一化过程中经常考虑的主要因素有：</p><ul data-tool="mdnice编辑器"><li><section>测序深度：</section></li></ul><p data-tool="mdnice编辑器">考虑测序深度对于比较样本之间的基因表达是必要的。在下面的例子中，相对于样品B，每个基因在样品A中的表达似乎增加了一倍，然而这是样品A具有两倍测序深度的结果。</p><figure data-tool="mdnice编辑器"><img data-ratio="0.5045871559633027" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9VKdpAAuwjhoPBiaVfBf4HkiaeszayrLPLEeb6eJyyicuzah2eWXA20b1iawic7OgZPt1H1NOxI58Wtyg/640?wx_fmt=png" data-type="png" data-w="545" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9VKdpAAuwjhoPBiaVfBf4HkiaeszayrLPLEeb6eJyyicuzah2eWXA20b1iawic7OgZPt1H1NOxI58Wtyg/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">注：在上图中，每个粉红色和绿色的矩形代表一个与基因对齐的读数（read）。用虚线连接表示连接一个横跨内含子的read。</p><ul data-tool="mdnice编辑器"><li><section>基因长度</section></li></ul><p data-tool="mdnice编辑器">考虑基因长度对于比较同一样本中不同基因之间的表达是必要的。在本例中，基因X和基因Y具有相似的表达水平，但由于基因X较长，因此映射到基因X的读数数将远多于映射到基因Y的读数数。</p><figure data-tool="mdnice编辑器"><img data-ratio="0.7467532467532467" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9VKdpAAuwjhoPBiaVfBf4HkzQiarBv26hwc6XpnRVUibcbbXNtW7naLtoK7iaia2Cz8zsBjEdXxjpz6Aw/640?wx_fmt=png" data-type="png" data-w="308" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9VKdpAAuwjhoPBiaVfBf4HkzQiarBv26hwc6XpnRVUibcbbXNtW7naLtoK7iaia2Cz8zsBjEdXxjpz6Aw/640?wx_fmt=png"></figure><ul data-tool="mdnice编辑器"><li><section>样本RNA组成</section></li></ul><p data-tool="mdnice编辑器">样本之间的一些高度差异表达的基因、样本之间表达的基因数量的差异或污染的存在可能会扭曲某些类型的标准化方法。为了准确比较样本之间的表达，建议考虑样本RNA组成，这在进行差异表达分析时尤为重要。</p><blockquote data-tool="mdnice编辑器"><p>Differential expression analysis for sequence count data</p><p>https://genomebiology.biomedcentral.com/articles/10.1186/gb-2010-11-10-r106<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="22px" height="22px" viewbox="0 0 32 32" enable-background="new 0 0 32 32"><image width="32" height="32" x="0" y="0"></image></svg></p></blockquote><p data-tool="mdnice编辑器">在本例中，如果我们将每个样本除以计数总数以进行归一化，则计数将被差异表达基因大大扭曲，差异表达基因占据样本A的大部分计数，而不是样本B的大部分计数。样本A的大多数其他基因将被更大数量的总计数所除，并且似乎比样本B中的相同基因表达更少。</p><blockquote data-tool="mdnice编辑器"><p>个人理解：差异表达基因占据样本大部分计数的基因，因为range大，所以scale大，缩放尺度更大</p></blockquote><figure data-tool="mdnice编辑器"><img data-ratio="0.9576427255985267" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9VKdpAAuwjhoPBiaVfBf4HkgLiaIcPEtP18MGbwicy0qgkmbgHFpscepBicMMvS8biacJWibmjOTtmXn7g/640?wx_fmt=png" data-type="png" data-w="543" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9VKdpAAuwjhoPBiaVfBf4HkgLiaIcPEtP18MGbwicy0qgkmbgHFpscepBicMMvS8biacJWibmjOTtmXn7g/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">归一化对于差异表达分析至关重要，对于探索性数据分析、数据可视化以及在样本之间或样本内探索或比较计数时，归一化也是必要的。</p><h3 data-tool="mdnice编辑器"><span></span>Common normalization methods<span></span></h3><p data-tool="mdnice编辑器">Several common normalization methods exist to account for these differences:</p><figure data-tool="mdnice编辑器"><img data-ratio="1.1125198098256734" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/iaRJcrq2Los9VKdpAAuwjhoPBiaVfBf4Hk0KoMDOh1iceIxFbcSwiab0z5JMg9e0y4ukCehW6gM26Z7Lib1m1HKLDOA/640?wx_fmt=jpeg" data-type="jpeg" data-w="631" src="https://mmbiz.qpic.cn/mmbiz_jpg/iaRJcrq2Los9VKdpAAuwjhoPBiaVfBf4Hk0KoMDOh1iceIxFbcSwiab0z5JMg9e0y4ukCehW6gM26Z7Lib1m1HKLDOA/640?wx_fmt=jpeg"></figure><p data-tool="mdnice编辑器">DESeq2's median of ratios</p><p data-tool="mdnice编辑器">https://genomebiology.biomedcentral.com/articles/10.1186/gb-2010-11-10-r106</p><p data-tool="mdnice编辑器">EdgeR's trimmed mean of M values (TMM)</p><p data-tool="mdnice编辑器">https://genomebiology.biomedcentral.com/articles/10.1186/gb-2010-11-3-r25</p><h3 data-tool="mdnice编辑器"><span></span>RPKM/FPKM（不建议用于样本间比较）<span></span></h3><p data-tool="mdnice编辑器">虽然TPM和RPKM/FPKM标准化方法都考虑了测序深度和基因长度，但不推荐使用RPKM/FPMM。原因是RPKM/FPKM方法输出的归一化计数值在样本之间不可比较。</p><p data-tool="mdnice编辑器">使用RPKM/FPKM归一化，<strong>每个样本的RPKM/FBKM归一化计数的总数将不同</strong>。因此，您无法在样本之间平等地比较每个基因的归一化计数。</p><p data-tool="mdnice编辑器"><strong>RPKM-normalized counts table</strong>:</p><figure data-tool="mdnice编辑器"><img data-ratio="0.41919191919191917" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9VKdpAAuwjhoPBiaVfBf4HkMfbvz2fb2PiaJTL1iaVcA8MwUcic6gQRic1yOvpqomKBbsxPQb1aY9swRw/640?wx_fmt=png" data-type="png" data-w="792" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9VKdpAAuwjhoPBiaVfBf4HkMfbvz2fb2PiaJTL1iaVcA8MwUcic6gQRic1yOvpqomKBbsxPQb1aY9swRw/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">例如，在上表中，即使RPKM计数值相同，SampleA与XCR1相关联的计数比例（5.5/1000000）也大于sampleB（5.5/150000）。因此，我们不能直接比较样本A和样本B之间XCR1（或任何其他基因）的计数，因为样本之间归一化计数的总数不同。</p><blockquote data-tool="mdnice编辑器"><p>注：StatQuest的这段视频更详细地展示了如果需要对测序深度和基因长度进行标准化，为什么应该使用TPM来代替RPKM/FPKM。</p><p>RPKM, FPKM and TPM, clearly explained</p><p>https://www.rna-seqblog.com/rpkm-fpkm-and-tpm-clearly-explained/</p></blockquote><h2 data-tool="mdnice编辑器"><span></span>2.Quality Control</h2><p data-tool="mdnice编辑器">差异表达分析流程的下一步是QC，包括样本水平和基因水平的步骤，对计数数据进行QC检查，以帮助我们确保样本/重复看起来良好。</p><figure data-tool="mdnice编辑器"><img data-ratio="0.5839874411302983" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9VKdpAAuwjhoPBiaVfBf4HkTj8iaGicDJ8Zf09OQ4CibyrwtLoOaiaMSH3LvCR6rSQuJFAB0ZY8XrEibYQ/640?wx_fmt=png" data-type="png" data-w="637" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9VKdpAAuwjhoPBiaVfBf4HkTj8iaGicDJ8Zf09OQ4CibyrwtLoOaiaMSH3LvCR6rSQuJFAB0ZY8XrEibYQ/640?wx_fmt=png"></figure><h3 data-tool="mdnice编辑器"><span></span>①Sample-level QC<span></span></h3><p data-tool="mdnice编辑器">RNA-seq分析中有用的初始步骤通常是评估样本之间的总体相似性：</p><ul data-tool="mdnice编辑器"><li><section>哪些样本彼此相似，哪些不同？</section></li><li><section>这是否符合实验设计的预期？</section></li><li><section>数据集中变化的主要来源是什么？</section></li></ul><p data-tool="mdnice编辑器"><strong>Log2变换的归一化计数用于使用主成分分析（PCA）和层次聚类来评估样本之间的相似性。</strong>使用log2变换旨在调节平均值的方差，从而改善这些可视化方法的距离/聚类。</p><figure data-tool="mdnice编辑器"><img data-ratio="0.6290097629009763" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9VKdpAAuwjhoPBiaVfBf4HkM2azIicb9Z2xNfowS1wUUZ7OJmZuIp83p1mp7tyiccLcM9AOaYyaz4nA/640?wx_fmt=png" data-type="png" data-w="717" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9VKdpAAuwjhoPBiaVfBf4HkM2azIicb9Z2xNfowS1wUUZ7OJmZuIp83p1mp7tyiccLcM9AOaYyaz4nA/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">样本水平的QC使我们能够看到我们的重复聚集在一起的情况，并观察我们的实验条件是否代表了数据变化的主要来源。执行样本水平QC还可以识别任何样本异常值，可能需要对其进行探索，以确定是否需要在DE分析之前删除这些异常值。</p><figure data-tool="mdnice编辑器"><img data-ratio="0.3628731343283582" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9VKdpAAuwjhoPBiaVfBf4HkcEccAoEsjuEbGx69ArQE1YusShRpvZXwBHGNn9ASwwwTRlakzlx6ZQ/640?wx_fmt=png" data-type="png" data-w="1072" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9VKdpAAuwjhoPBiaVfBf4HkcEccAoEsjuEbGx69ArQE1YusShRpvZXwBHGNn9ASwwwTRlakzlx6ZQ/640?wx_fmt=png"></figure><h4 data-tool="mdnice编辑器"><span></span>Principal Component Analysis (PCA)<span></span></h4><p data-tool="mdnice编辑器">https://hbctraining.github.io/DGE_workshop/lessons/principal_component_analysis.html</p><p data-tool="mdnice编辑器">主成分分析（PCA）是一种降维技术，它可以发现数据集中最大的变化量，并将其分配给主成分。解释数据集中最大变化量的主成分（PC）是PC1，而解释第二大变化量的PC是PC2，依此类推。</p><p data-tool="mdnice编辑器">通常，我们关注PC1和PC2（它们解释了数据中最大的变化量），并将它们相互对照。在理想的实验中，我们希望每个样本组的所有复制都聚集在一起，而样本组在主成分分析图中分开，如下所示。</p><figure data-tool="mdnice编辑器"><img data-ratio="0.23981481481481481" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9VKdpAAuwjhoPBiaVfBf4HkZYkwDgkFtFYlrTj4Y4eMYftmLmpcm2JPrGy6AyPqxBUSX3u15CmR1Q/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9VKdpAAuwjhoPBiaVfBf4HkZYkwDgkFtFYlrTj4Y4eMYftmLmpcm2JPrGy6AyPqxBUSX3u15CmR1Q/640?wx_fmt=png"></figure><h5 data-tool="mdnice编辑器"><span></span>Example PCA<span></span></h5><p data-tool="mdnice编辑器">In this example, the metadata for the experiment is displayed below. The main condition of interest is <code>treatment</code>.</p><figure data-tool="mdnice编辑器"><img data-ratio="0.6266375545851528" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9VKdpAAuwjhoPBiaVfBf4Hk9LnVe6NNTYrl5a07VNgOpknnnj8BTLoXo3n4picC1AVdYak1w4Hk4hQ/640?wx_fmt=png" data-type="png" data-w="916" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9VKdpAAuwjhoPBiaVfBf4Hk9LnVe6NNTYrl5a07VNgOpknnnj8BTLoXo3n4picC1AVdYak1w4Hk4hQ/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">当在PC1和PC2上进行可视化时，我们没有看到样本因处理treatment而分离，因此我们决定探索数据中存在的其他变异来源。我们希望我们已经在元数据表中包括了所有可能的已知变化源，并且我们可以使用这些因素来为PCA图着色。</p><blockquote data-tool="mdnice编辑器"><p><a href="https://mp.weixin.qq.com/s?__biz=MzUzMTEwODk0Ng==&amp;mid=2247512469&amp;idx=1&amp;sn=364469f90477204a6319cd57211e8264&amp;chksm=fa4574a8cd32fdbe68badc2b6c922a164ce3be815877c5e4fed59628c72fd590f0a140752831&amp;scene=21&amp;cur_album_id=2545418429466607617#wechat_redirect" data-linktype="2">使用TPM/FPKM/RPKM进行差异分析真的可以消除系统误差吗？</a></p><p>在之前的一篇推文中我们也进行了类似的逐步PCA分析，探索主要的变异来源，只不过我们聚焦在PC1得分高低分组上，而非样本信息</p></blockquote><figure data-tool="mdnice编辑器"><img data-ratio="0.5355555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9VKdpAAuwjhoPBiaVfBf4HkhLA7UJHkrM3ic2r9mw8fc4mAicu6l6jBHQiaM5abicolTiciaGCw1QXn9ryg/640?wx_fmt=png" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9VKdpAAuwjhoPBiaVfBf4HkhLA7UJHkrM3ic2r9mw8fc4mAicu6l6jBHQiaM5abicolTiciaGCw1QXn9ryg/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">我们从cage因素开始，但cage因素似乎不能解释PC1或PC2的变化。</p><figure data-tool="mdnice编辑器"><img data-ratio="0.5263157894736842" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9VKdpAAuwjhoPBiaVfBf4HkUF17z4yadU2IicMMzSAYF0WuPPlY4OEUFMibMHtbrG92mNAGtjM7koJw/640?wx_fmt=png" data-type="png" data-w="893" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9VKdpAAuwjhoPBiaVfBf4HkUF17z4yadU2IicMMzSAYF0WuPPlY4OEUFMibMHtbrG92mNAGtjM7koJw/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">然后，我们根据sex因素进行着色，这似乎可以在PC2上分离样本。这是一个值得注意的好信息，因为我们可以在下游使用它来解释模型中由于性别而产生的变化，并对其进行回归。</p><figure data-tool="mdnice编辑器"><img data-ratio="0.5331833520809899" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9VKdpAAuwjhoPBiaVfBf4Hky7tLFyD0gCTFY3NTrYWibsicTMl8PMvHmUBUYHTxMK2pA2O35iawpV5Iw/640?wx_fmt=png" data-type="png" data-w="889" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9VKdpAAuwjhoPBiaVfBf4Hky7tLFyD0gCTFY3NTrYWibsicTMl8PMvHmUBUYHTxMK2pA2O35iawpV5Iw/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">接下来我们探究strain因素，发现它解释了PC1的变异。</p><figure data-tool="mdnice编辑器"><img data-ratio="0.5363128491620112" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9VKdpAAuwjhoPBiaVfBf4Hkoicuz5icEiayHxmc6EBXS56CLictwzqBiaqYp3CquQ1OwibKpcwhz3Mic9Ubg/640?wx_fmt=png" data-type="png" data-w="895" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9VKdpAAuwjhoPBiaVfBf4Hkoicuz5icEiayHxmc6EBXS56CLictwzqBiaqYp3CquQ1OwibKpcwhz3Mic9Ubg/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">通过在我们的模型中说明识别PC1和PC2的变异来源，应该能够检测到更多因实际治疗treatment而差异表达的基因。</p><p data-tool="mdnice编辑器">令人担忧的是，我们看到两个样本没有与正确的菌株聚类。这将表明可能存在<strong>sample swap</strong>，应进行调查以确定这些样本是否确实是标记菌株。如果我们发现确实存在样本标记switch，我们可以交换元数据中的样本。然而，如果我们认为它们被正确标记或不确定，我们可以从数据集中删除该样本。</p><blockquote data-tool="mdnice编辑器"><p>“Sample swap”指的是样品混淆，也就是在实验中分不清不同的样品或者错误地标记了不同的样品。在基因表达分析中，若存在样品混淆，会导致对样品分类的错误分组，使所得结论不准确。所以，在分析基因表达差异前，需要确认样品是否正确，并校正或排除样品混淆。</p></blockquote><figure data-tool="mdnice编辑器"><img data-ratio="0.5102925243770314" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9VKdpAAuwjhoPBiaVfBf4HkSJpvKMewGsnReEFjkMwLcGY7fV9l4vHQIPBL5vc2ELlnq6enHwOTMQ/640?wx_fmt=png" data-type="png" data-w="923" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9VKdpAAuwjhoPBiaVfBf4HkSJpvKMewGsnReEFjkMwLcGY7fV9l4vHQIPBL5vc2ELlnq6enHwOTMQ/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">尽管如此，我们还没有发现治疗是否是strain和sex后变异的主要来源。因此，我们研究了PC3和PC4，看看治疗是否推动了这两种PC所代表的变异。</p><figure data-tool="mdnice编辑器"><img data-ratio="0.49890829694323147" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9VKdpAAuwjhoPBiaVfBf4HkcCFMK9cqiarVeFB5iaZhdp7QqYCMf4AcOaTzNserBRlw3nTMGAwTUvXw/640?wx_fmt=png" data-type="png" data-w="916" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9VKdpAAuwjhoPBiaVfBf4HkcCFMK9cqiarVeFB5iaZhdp7QqYCMf4AcOaTzNserBRlw3nTMGAwTUvXw/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">我们发现样本通过在PC3上的treatment而分离，在模型中我们可以回归出驱使PC1和PC2的变异。</p><p data-tool="mdnice编辑器">综上，即使你的样本没有通过PC1或PC2分离，或者你不能确定变异的来源，你仍然可以从差异分析分析中获得生物学相关的结果，所以如果你没有获得大量的DE基因，不要感到惊讶。为了使检测差异表达基因的工具更有效，如果你能识别出主要的、已知的变异源，最好说明它们（如上述案例中的sex和strain）；这包括批处理效应。</p><blockquote data-tool="mdnice编辑器"><p><a href="https://mp.weixin.qq.com/s?__biz=MzUzMTEwODk0Ng==&amp;mid=2247513115&amp;idx=1&amp;sn=dbcbb4ff2963b496d7420c6d9acbbf7e&amp;chksm=fa457126cd32f830efa9497bbe194215833e5e117fc88fb294ec2887c531f64cd69cf1488b2e&amp;scene=21&amp;cur_album_id=2545418429466607617#wechat_redirect" data-linktype="2">明明PCA区分非常好，但是差异基因数量很少？</a></p><p>在之前的一篇推文，我们讨论了差异表达基因数量很少的各种原因，阅读了这个教程后，还可以加上“当前实验分组下，造成差异最主要的因素并不是实验处理”</p></blockquote><p data-tool="mdnice编辑器">有关PCA计算的详细信息，可以浏览StatQuest的视频。</p><p data-tool="mdnice编辑器">https://www.youtube.com/watch?v=_UVHneBUBW0</p><p data-tool="mdnice编辑器"><strong>Exercise</strong></p><p data-tool="mdnice编辑器">下图是根据样本组Ctrl和Sci以及以下时间点：0h、2h、8h和16h，生成的</p><figure data-tool="mdnice编辑器"><img data-ratio="0.7744774477447744" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9VKdpAAuwjhoPBiaVfBf4HkXUic5WNq9Sz0T43e07U719OZjT31YySZ0jjNMXVj8suQLpGdbmM4h0Q/640?wx_fmt=png" data-type="png" data-w="909" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9VKdpAAuwjhoPBiaVfBf4HkXUic5WNq9Sz0T43e07U719OZjT31YySZ0jjNMXVj8suQLpGdbmM4h0Q/640?wx_fmt=png"></figure><ul data-tool="mdnice编辑器"><li><section>确定解释PC1和PC2表示的变化的来源。</section></li><li><section>样本组分开得好吗？</section></li><li><section>每个样本组的重复是否聚集在一起？</section></li><li><section>数据中是否有异常值？</section></li><li><section>我们是否应该对数据集中的样本有任何其他顾虑？</section></li></ul><h4 data-tool="mdnice编辑器"><span></span>Hierarchical Clustering Heatmap<span></span></h4><p data-tool="mdnice编辑器">与主成分分析类似，层次聚类是识别数据集中强模式和潜在异常值的另一种互补方法。热图显示了数据集中样本的所有成对组合的基因表达的相关性。由于大多数基因没有差异表达，样本之间通常具有高度相关性（值高于0.80）。低于0.80的样本可能表明您的数据和/或样本污染中存在异常值。</p><p data-tool="mdnice编辑器">层次树可以基于归一化的基因表达值来指示哪些样本彼此更相似。色块表示数据中的子结构，您希望看到您的重复聚集在一起，作为每个样本组的一个块。此外，我们希望看到样本聚类与主成分分析图中观察到的分组相似。</p><p data-tool="mdnice编辑器">在下面的图中，我们会有点担心“Wt_3”和“KO_3”样本没有与其他重复聚类。我们想探索主成分分析，看看我们是否看到了相同的样本聚类。</p><figure data-tool="mdnice编辑器"><img data-ratio="0.615877080665813" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9VKdpAAuwjhoPBiaVfBf4HkzWM6LP5ybC7Tpk28jc9QId8IO7E5AMCthVKibp9fh4DEichQ7tWdaqYQ/640?wx_fmt=png" data-type="png" data-w="781" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9VKdpAAuwjhoPBiaVfBf4HkzWM6LP5ybC7Tpk28jc9QId8IO7E5AMCthVKibp9fh4DEichQ7tWdaqYQ/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器"><strong>Exercise</strong></p><p data-tool="mdnice编辑器">下图是用样本组“Mov10_oe”、“Irer_kd”和“Mov110_kd”进行的实验生成的。</p><figure data-tool="mdnice编辑器"><img data-ratio="0.6920583468395461" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9VKdpAAuwjhoPBiaVfBf4HkecVCKsaDhvia6oJVnRicS04icWwmEqezZ2Wm5sTS8Hkia8FKbTSicFd1j2g/640?wx_fmt=png" data-type="png" data-w="617" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9VKdpAAuwjhoPBiaVfBf4HkecVCKsaDhvia6oJVnRicS04icWwmEqezZ2Wm5sTS8Hkia8FKbTSicFd1j2g/640?wx_fmt=png"></figure><ul data-tool="mdnice编辑器"><li><section>本组分开得好吗？</section></li><li><section>每个样本组的重复是否聚集在一起？</section></li><li><section>数据中是否有异常值？</section></li><li><section>我们是否应该对数据集中的样本有任何其他顾虑？</section></li></ul><h3 data-tool="mdnice编辑器"><span></span>②Gene-level QC<span></span></h3><p data-tool="mdnice编辑器">除了检查样本/重复聚集在一起的情况外，还有更多的QC步骤。在差异表达分析之前，省略被检测为差异表达的可能性很小或根本没有的基因是有益的。这将增加检测差异表达基因的能力。被过滤的基因分为三类：</p><ul data-tool="mdnice编辑器"><li><section>所有样本中计数为零的基因</section></li><li><section>具有低平均归一化计数的基因</section></li><li><section>具有极端计数异常值的基因</section></li></ul><blockquote data-tool="mdnice编辑器"><p><a href="https://mp.weixin.qq.com/s?__biz=MzUzMTEwODk0Ng==&amp;mid=2247513115&amp;idx=1&amp;sn=dbcbb4ff2963b496d7420c6d9acbbf7e&amp;chksm=fa457126cd32f830efa9497bbe194215833e5e117fc88fb294ec2887c531f64cd69cf1488b2e&amp;scene=21&amp;cur_album_id=2545418429466607617#wechat_redirect" data-linktype="2">明明PCA区分非常好，但是差异基因数量很少？</a></p><p>在这篇推文中，我们讨论了不同过滤标准对结果的影响</p><p>在转录组专辑中我们之前使用raw counts进行差异分析，过滤低表达基因一般标准是这样的：</p><pre><span></span><code>keep &lt;- rowSums(rawcount&gt;0) &gt;= floor(0.5*ncol(rawcount)) <br></code></pre><p>而我目前进行的qc和读过的一些文章，绝大多数没有考虑具有极端计数异常值基因的过滤，具体的过滤标准一般是怎样的，还需进行广泛地阅读</p></blockquote><figure data-tool="mdnice编辑器"><img data-ratio="0.2936763129689175" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9VKdpAAuwjhoPBiaVfBf4Hka0BHbtC0iaKKdWElFGBUeiaicsafdibMeVNsXwLBHVVj1OQ23byynuBf5w/640?wx_fmt=png" data-type="png" data-w="933" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9VKdpAAuwjhoPBiaVfBf4Hka0BHbtC0iaKKdWElFGBUeiaicsafdibMeVNsXwLBHVVj1OQ23byynuBf5w/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器"><strong>默认情况下，DESeq2将执行此过滤；然而，其他DE工具，如EdgeR不会。</strong></p><p data-tool="mdnice编辑器">过滤是一个必要的步骤，即使您使用的是limma-voom和/或edgeR的准似然方法。使用这些工具时，请务必遵循预过滤步骤，如Bioconductor上的用户指南所述。</p><blockquote data-tool="mdnice编辑器"><p><a href="https://mp.weixin.qq.com/s?__biz=MzUzMTEwODk0Ng==&amp;mid=2247506796&amp;idx=1&amp;sn=aa02ccb3fde52260672471bcf80e70ff&amp;chksm=fa451e51cd329747e366f74458d935b73d6dad06ab6e9a83d1c3c88693c406b50c28678eae41&amp;scene=21&amp;cur_album_id=2545418429466607617#wechat_redirect" data-linktype="2">三种转录组差异分析方法及区别你会了吗？</a></p></blockquote><hr data-tool="mdnice编辑器"><h3 data-tool="mdnice编辑器"><span></span>tips:<span></span></h3><p data-tool="mdnice编辑器">以上，就是本期的正文内容，其实大部分知识点我们公众号之前都讲过，其他更多内容，感兴趣的读者可以自行学习</p><p data-tool="mdnice编辑器">本文中值得学习的几点：</p><ul data-tool="mdnice编辑器"><li><section><p>计数数据归一化时强调RNA组成</p></section></li><li><section><p>各种归一化方法使用建议</p></section></li></ul><figure data-tool="mdnice编辑器"><img data-ratio="1.1125198098256734" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/iaRJcrq2Los9VKdpAAuwjhoPBiaVfBf4Hk0KoMDOh1iceIxFbcSwiab0z5JMg9e0y4ukCehW6gM26Z7Lib1m1HKLDOA/640?wx_fmt=jpeg" data-type="jpeg" data-w="631" src="https://mmbiz.qpic.cn/mmbiz_jpg/iaRJcrq2Los9VKdpAAuwjhoPBiaVfBf4Hk0KoMDOh1iceIxFbcSwiab0z5JMg9e0y4ukCehW6gM26Z7Lib1m1HKLDOA/640?wx_fmt=jpeg"></figure><ul data-tool="mdnice编辑器"><li><section><p>在样本水平QC逐步PCA探索真正影响差异表达的因素</p></section></li><li><section><p>在基因水平QC强调了具有极端计数异常值的基因</p></section></li></ul><br data-tool="mdnice编辑器"><p data-tool="mdnice编辑器">很多推文我们都是用markdown来写的</p><figure data-tool="mdnice编辑器"><img data-ratio="1.4276923076923076" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9VKdpAAuwjhoPBiaVfBf4HkeZmUowjKca8Mpv8wcAGMrqU8mVdzU0pJuLKztnkMVQfwv3g7deNQHw/640?wx_fmt=png" data-type="png" data-w="325" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9VKdpAAuwjhoPBiaVfBf4HkeZmUowjKca8Mpv8wcAGMrqU8mVdzU0pJuLKztnkMVQfwv3g7deNQHw/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">这里给大家推荐一个插件可以更好地在PC端阅读markdown编写的文章：</p><p data-tool="mdnice编辑器">https://greasyfork.org/zh-CN/scripts/406337-toc-bar-auto-generating-table-of-content</p><figure data-tool="mdnice编辑器"><img data-ratio="0.37037037037037035" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9VKdpAAuwjhoPBiaVfBf4Hk2rQh9LQRPKwoWuQ1IsRP4csdiaMFFmqH7oiakUo6d41g5xjeSP8NUoHg/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9VKdpAAuwjhoPBiaVfBf4Hk2rQh9LQRPKwoWuQ1IsRP4csdiaMFFmqH7oiakUo6d41g5xjeSP8NUoHg/640?wx_fmt=png"></figure></section><p><img data-galleryid="" data-ratio="0.23796296296296296" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9VKdpAAuwjhoPBiaVfBf4HktZxHKsQuTXeq9DaEKGZxAuyvo2TJIiaHoIU30eyoYVA3icvKtz6xwozQ/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9VKdpAAuwjhoPBiaVfBf4HktZxHKsQuTXeq9DaEKGZxAuyvo2TJIiaHoIU30eyoYVA3icvKtz6xwozQ/640?wx_fmt=png"></p><p><mp-style-type data-value="10000"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/AvpKaUbGEhFpDgkGbYC9Dw",target="_blank" rel="noopener noreferrer">原文链接</a>
