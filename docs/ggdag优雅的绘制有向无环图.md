---
title: "ggdag优雅的绘制有向无环图"
date: 2023-01-21T09:28:04Z
draft: ["false"]
tags: [
  "fetched",
  "R语言数据分析指南"
]
categories: ["Acdemic"]
---
ggdag优雅的绘制有向无环图 by R语言数据分析指南
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><blockquote data-tool="mdnice编辑器"><span>❝</span><p>本节来介绍一款R包<strong>「ggdag」</strong>可以用来<strong>「绘制向无环图」</strong>并且此包还兼容ggplot2语法用起来很是方便，此包的功能看起来在实际的数据分析中貌似作用不大，但也许能满足某些朋友的特殊需求;下面来介绍该R包的一个小例子。</p><span>❞</span></blockquote><h3 data-tool="mdnice编辑器"><span></span><span><span></span>官方文档</span><span></span></h3><blockquote data-tool="mdnice编辑器"><span>❝</span><p>https://github.com/malcolmbarrett/ggdag</p><span>❞</span></blockquote><blockquote data-tool="mdnice编辑器"><span>❝</span><p><code>有需要学习数据可视化案例的朋友欢迎购买小编2023的VIP文档</code>，<strong>「初始价格依然是99元」</strong>随着人数增多后期会调整价格；有需要的朋友欢迎到小编的淘宝店铺<strong>「R语言数据分析指南」</strong>下单。<br>付费后小编会邀请分享文档链接，小编每次更新后会同步内容。<strong>「期待大家都能真正掌握R语言数据分析及可视化的能力」</strong></p><span>❞</span></blockquote><h3 data-tool="mdnice编辑器"><span></span><span><span></span>淘宝店铺个性化绘图服务</span><span></span></h3><blockquote data-tool="mdnice编辑器"><span>❝</span><p>有需要找小编做个性化绘图的朋友欢关注<strong>「淘宝店铺(R语言数据分析指南)」</strong> 有需求者可咨询下单。</p><span>❞</span></blockquote><h3 data-tool="mdnice编辑器"><span></span><span><span></span>加载R包</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code><span>library</span>(tidyverse)<br>install.packages(<span>"ggdag"</span>)<br><span>library</span>(ggdag)<br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span><span></span>构建数据</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code>tidy_ggdag &lt;- dagify(<br>  y ~ x + z2 + w2 + w1,x ~ z1 + w1 + w2,z1 ~ w1 + v,z2 ~ w2 + v,w1 ~ ~w2,<br>  exposure = <span>"x"</span>,outcome = <span>"y"</span>) %&gt;% tidy_dagitty()<br>  <br>tidy_ggdag<br></code></pre><pre data-tool="mdnice编辑器"><span></span><code><span># A tibble: 13 × 8</span><br>   name      x      y direction to     xend   yend circular<br>   &lt;chr&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;fct&gt;     &lt;chr&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;lgl&gt;   <br> <span>1</span> v     -<span>4.40</span> -<span>1.65</span>  -&gt;        z1    -<span>3.53</span> -<span>0.543</span> <span>FALSE</span>   <br> <span>2</span> v     -<span>4.40</span> -<span>1.65</span>  -&gt;        z2    -<span>3.29</span> -<span>2.53</span>  <span>FALSE</span>   <br> <span>3</span> w1    -<span>2.64</span> -<span>0.979</span> -&gt;        x     -<span>2.04</span> -<span>0.783</span> <span>FALSE</span>   <br> <span>4</span> w1    -<span>2.64</span> -<span>0.979</span> -&gt;        y     -<span>2.52</span> -<span>1.91</span>  <span>FALSE</span>   <br> <span>5</span> w1    -<span>2.64</span> -<span>0.979</span> -&gt;        z1    -<span>3.53</span> -<span>0.543</span> <span>FALSE</span>   <br> <span>6</span> w1    -<span>2.64</span> -<span>0.979</span> &lt;-&gt;       w2    -<span>1.90</span> -<span>1.95</span>  <span>FALSE</span>   <br> <span>7</span> w2    -<span>1.90</span> -<span>1.95</span>  -&gt;        x     -<span>2.04</span> -<span>0.783</span> <span>FALSE</span>   <br> <span>8</span> w2    -<span>1.90</span> -<span>1.95</span>  -&gt;        y     -<span>2.52</span> -<span>1.91</span>  <span>FALSE</span>   <br> <span>9</span> w2    -<span>1.90</span> -<span>1.95</span>  -&gt;        z2    -<span>3.29</span> -<span>2.53</span>  <span>FALSE</span>   <br><span>10</span> x     -<span>2.04</span> -<span>0.783</span> -&gt;        y     -<span>2.52</span> -<span>1.91</span>  <span>FALSE</span>   <br><span>11</span> y     -<span>2.52</span> -<span>1.91</span>  <span>NA</span>        <span>NA</span>    <span>NA</span>    <span>NA</span>     <span>FALSE</span>   <br><span>12</span> z1    -<span>3.53</span> -<span>0.543</span> -&gt;        x     -<span>2.04</span> -<span>0.783</span> <span>FALSE</span>   <br><span>13</span> z2    -<span>3.29</span> -<span>2.53</span>  -&gt;        y     -<span>2.52</span> -<span>1.91</span>  <span>FALSE</span>  <br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span><span></span>绘制有向无环图</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code>ggdag(tidy_ggdag) +theme_dag()<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.8076335877862595" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZrPX2kniac57xDLXJFZQCMH9GJIFCA2Lu9jsbiaibjTbbG9STqIbSmGKoibFKeOaOegbtlpHZq1KMCWQ/640?wx_fmt=png" data-type="png" data-w="655" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZrPX2kniac57xDLXJFZQCMH9GJIFCA2Lu9jsbiaibjTbbG9STqIbSmGKoibFKeOaOegbtlpHZq1KMCWQ/640?wx_fmt=png"></figure><blockquote data-tool="mdnice编辑器"><span>❝</span><p>除了上述的语法，此款R包还兼容<strong>「ggplot2,ggraph」</strong>等R包，因此可以对图形进行更多的自定义操作，下面是官方的一个小栗子</p><span>❞</span></blockquote><pre data-tool="mdnice编辑器"><span></span><code>dagify(m ~ x + y) %&gt;% tidy_dagitty() %&gt;%<br>  node_dconnected(<span>"x"</span>, <span>"y"</span>, controlling_for = <span>"m"</span>) %&gt;%<br>  ggplot(aes(x = x,y = y,xend = xend,yend = yend,<br>    shape = adjusted,col = d_relationship)) +<br>  geom_dag_edges(end_cap = ggraph::circle(<span>10</span>, <span>"mm"</span>)) +<br>  geom_dag_collider_edges() + <span>#添加虚线链接</span><br>  geom_dag_point() +<br>  geom_dag_text(col = <span>"white"</span>) +<br>  theme_dag() +<br>  scale_adjusted() +<br>  expand_plot(expand_y = expansion(c(<span>0.2</span>, <span>0.2</span>))) +<br>  scale_color_viridis_d(<br>    name = <span>"d-relationship"</span>,<br>    na.value = <span>"grey85"</span>,begin = <span>.35</span>)<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.8076335877862595" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZrPX2kniac57xDLXJFZQCMHV9T1rWj7bGr1OC2AcLIicn5icicKOeNd0RpVgPBzibiay9wY2fm1UyKAwrw/640?wx_fmt=png" data-type="png" data-w="655" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZrPX2kniac57xDLXJFZQCMHV9T1rWj7bGr1OC2AcLIicn5icicKOeNd0RpVgPBzibiay9wY2fm1UyKAwrw/640?wx_fmt=png"></figure><blockquote data-tool="mdnice编辑器"><span>❝</span><p>上面只是两个很简单的例子介绍，更多优雅的案例期待各位朋友的探索；好了本节介绍到此结束，此款R包还有更多的功能，更多详细的内容请参考作者官方文档，<code>喜欢的观众老爷欢迎分享转发</code>，<strong>「当然更推荐大家加入我的VIP交流群」</strong>扫描下方二维码加小编微信<strong>「付费99元」</strong>后邀请进群，<strong>「一定让你感受到物超所值」</strong>，<strong>「添加小编微信请备注来意，以便高效处理」</strong></p><span>❞</span></blockquote><h3 data-tool="mdnice编辑器"><span></span><span><span></span>小编微信</span><span></span></h3><p><img data-galleryid="" data-ratio="1" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/EibnicgwScTAaNu6sU2UCYkxFq9ibq75wuaO0lqFoYz1icUo4jh3N2icAWECmibgPvqyReur0FCp7JNKO0icnRAsbO9ug/640?wx_fmt=jpeg" data-type="jpeg" data-w="430" src="https://mmbiz.qpic.cn/mmbiz_jpg/EibnicgwScTAaNu6sU2UCYkxFq9ibq75wuaO0lqFoYz1icUo4jh3N2icAWECmibgPvqyReur0FCp7JNKO0icnRAsbO9ug/640?wx_fmt=jpeg"></p><h3 data-tool="mdnice编辑器"><span></span><span><span></span>关注下方公众号下回更新不迷路</span><span></span></h3><section><mp-common-profile data-pluginname="mpprofile" data-weui-theme="light" data-id="Mzg3MzQzNTYzMw==" data-headimg="http://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZF0rpeZII9Ltl26VbVagriczTria1fib3XgjwwHEHFjPzkmGpqWDVVHBSzhENictUM2iavAKiaM5lc9USw/0?wx_fmt=png" data-nickname="R语言数据分析指南" data-alias="YanJANtwo" data-signature="R语言重症爱好者，喜欢绘制各种精美的图表，喜欢的小伙伴可以关注我，跟我一起学习" data-from="0" data-is_biz_ban="0"></mp-common-profile><p><br></p><section><section><section><section><p data-mid="">往期推荐</p></section></section><section><section><a href="http://mp.weixin.qq.com/s?__biz=Mzg3MzQzNTYzMw==&amp;mid=2247500967&amp;idx=1&amp;sn=d9a155bfd49d317c05586defc2177ff4&amp;chksm=cee29c39f995152fd73518702e89d951e247330a1ab6e9faaf8ad271f8d49eb5e6500dd78439&amp;scene=21#wechat_redirect" data-linktype="2"><section><p>ggreverse逆向操作你的绘图代码</p></section></a></section><section><a href="http://mp.weixin.qq.com/s?__biz=Mzg3MzQzNTYzMw==&amp;mid=2247500946&amp;idx=1&amp;sn=e49e07f1bb9cc1db61fb14a9ca329ac8&amp;chksm=cee29c0cf995151a97482cda424769c81f0df123b42837425c6b4e751940f6c9a2c2390151f5&amp;scene=21#wechat_redirect" data-linktype="2"><section><p>[会员专享] NC图表复现之cirzlize绘制基因组图</p></section></a></section><section><a href="http://mp.weixin.qq.com/s?__biz=Mzg3MzQzNTYzMw==&amp;mid=2247500914&amp;idx=1&amp;sn=e9e5e212aa54c6316fdada59bff5a439&amp;chksm=cee29cecf99515fa58f7ccdd1f9d5d31c470b9bfac488038e9789e17452678a5c5fa1f284735&amp;scene=21#wechat_redirect" data-linktype="2"><section><p>DrugSim2DR优雅的绘制化合物结构图</p></section></a></section><section><a href="http://mp.weixin.qq.com/s?__biz=Mzg3MzQzNTYzMw==&amp;mid=2247500898&amp;idx=1&amp;sn=0ae69d8cba84515e53b254433588fd8e&amp;chksm=cee29cfcf99515eaa0bdea0c167a5b60e6c2f818109a8af594de3c05056b45e8ecd536aa87a1&amp;scene=21#wechat_redirect" data-linktype="2"><section><p>funkyheatmap优雅的可视化数据框热图</p></section></a></section><section><a href="http://mp.weixin.qq.com/s?__biz=Mzg3MzQzNTYzMw==&amp;mid=2247500867&amp;idx=1&amp;sn=8209cf587e3f593cbc5c8e5250c454ed&amp;chksm=cee29cddf99515cb8599de9d6b071f3a54bfbcea687f80ce0b5383537e40583f6f9cd72e53e3&amp;scene=21#wechat_redirect" data-linktype="2"><section><p>ggplot2带你组合绘制桑基图+富集分析图</p></section></a></section><section><a href="http://mp.weixin.qq.com/s?__biz=Mzg3MzQzNTYzMw==&amp;mid=2247500843&amp;idx=1&amp;sn=675fde94ff0ac2ccf4890647c62d6f68&amp;chksm=cee29cb5f99515a337e5ce5a908db79e0a7eff68d4a47955ea1692e12a4e2f126bd74d921d6c&amp;scene=21#wechat_redirect" data-linktype="2"><section><p>[会员专享] NC图表复现之华夫热图</p></section></a></section><section><a href="http://mp.weixin.qq.com/s?__biz=Mzg3MzQzNTYzMw==&amp;mid=2247500787&amp;idx=1&amp;sn=1870a6965333bfc6a57ba688d39c9f96&amp;chksm=cee29b6df995127bb517d9485bd793f3c02954b3063b17cffbd5fce5d87c23ecd1fd55ced844&amp;scene=21#wechat_redirect" data-linktype="2"><section><p>R语言统计分析|批量单变量Cox回归分析</p></section></a></section><section><a href="http://mp.weixin.qq.com/s?__biz=Mzg3MzQzNTYzMw==&amp;mid=2247500768&amp;idx=1&amp;sn=62b7c2159f7fb4c83679be5f4629c985&amp;chksm=cee29b7ef995126829d96196fc7e60f93332e90e1c4bc9122f3d7153e19189c302e1c61bd97b&amp;scene=21#wechat_redirect" data-linktype="2"></a><section><a href="http://mp.weixin.qq.com/s?__biz=Mzg3MzQzNTYzMw==&amp;mid=2247500768&amp;idx=1&amp;sn=62b7c2159f7fb4c83679be5f4629c985&amp;chksm=cee29b7ef995126829d96196fc7e60f93332e90e1c4bc9122f3d7153e19189c302e1c61bd97b&amp;scene=21#wechat_redirect" data-linktype="2"></a><p><a href="http://mp.weixin.qq.com/s?__biz=Mzg3MzQzNTYzMw==&amp;mid=2247500768&amp;idx=1&amp;sn=62b7c2159f7fb4c83679be5f4629c985&amp;chksm=cee29b7ef995126829d96196fc7e60f93332e90e1c4bc9122f3d7153e19189c302e1c61bd97b&amp;scene=21#wechat_redirect" data-linktype="2">[会员专享] 再谈ggplot2绘制森林图</a></p></section></section></section></section></section></section></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/2pQPjZ1wl-7x9VwB_26B-A",target="_blank" rel="noopener noreferrer">原文链接</a>
