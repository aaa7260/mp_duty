---
title: "TCGA 同源重组缺陷（HRD）"
date: 2023-01-21T10:48:55Z
draft: ["false"]
tags: [
  "fetched",
  "生信星球"
]
categories: ["Acdemic"]
---
TCGA 同源重组缺陷（HRD） by 生信星球
------
<div><section data-mpa-powered-by="yiban.io"><img data-ratio="1" data-type="png" data-w="20" width="20px" data-src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHrDic8XGmJ0b7oibVJajb0emLBHSvuibGG49ooBgtaAibE3TNJ00iaHviaMtdIKQJfCwtUfuHicDImtSfIxg/640?wx_fmt=png" src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHrDic8XGmJ0b7oibVJajb0emLBHSvuibGG49ooBgtaAibE3TNJ00iaHviaMtdIKQJfCwtUfuHicDImtSfIxg/640?wx_fmt=png"><img data-ratio="1" data-type="png" data-w="20" width="20px" data-src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHrDic8XGmJ0b7oibVJajb0emLPukRHCbicy4pNKeEv9qd7aWSfsx7roib2od3xPrRPicw3a0kbn0uQ6JmQ/640?wx_fmt=png" src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHrDic8XGmJ0b7oibVJajb0emLPukRHCbicy4pNKeEv9qd7aWSfsx7roib2od3xPrRPicw3a0kbn0uQ6JmQ/640?wx_fmt=png"><span> 今天是生信星球陪你的<span><strong>第893天</strong></span></span><img data-ratio="1" data-type="png" data-w="20" width="20px" data-src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHrDic8XGmJ0b7oibVJajb0emLBHSvuibGG49ooBgtaAibE3TNJ00iaHviaMtdIKQJfCwtUfuHicDImtSfIxg/640?wx_fmt=png" src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHrDic8XGmJ0b7oibVJajb0emLBHSvuibGG49ooBgtaAibE3TNJ00iaHviaMtdIKQJfCwtUfuHicDImtSfIxg/640?wx_fmt=png"></section><hr><p><span><span>   </span><span>大神一句话，菜鸟跑半年。我不是大神，但我可以缩短你走弯路的半年~</span></span></p><p><span>   就像歌儿唱的那样，如果你不知道该往哪儿走，就留在这学点生信好不好~</span></p><p><span>   这里有豆豆和花花的学习历程，从新手到进阶，生信路上有你有我!</span></p><p>哈哈，大年三十在学习，快给我点赞。</p><section><h3><span>0.背景知识</span></h3><p>最近在研读新的文献O(∩_∩)O。</p><p>Genomic, epigenomic, and transcriptomic signatures for telomerase complex components: a pan‐cancer analysis</p><p>其中提到：</p><blockquote><p>Genomic instability included aneuploidy, somatic total mutation burden (TMB), somatic copy number alterations (SCNA), loss of heterozygosity (LOH), and homologous recombination deficiency (HRD).</p><p>基因组不稳定性包括非整倍性、体细胞总突变负荷（TMB）、体细胞拷贝数改变（SCNA）、杂合性丧失（LOH）和同源重组缺陷（HRD）。</p></blockquote><p><strong>同源重组修复</strong>（homologous recombination repair，HRR）是DNA双链断裂（double strand break，DSB）的首选修复方式。</p><p><strong>同源重组修复缺陷</strong>（homologous recombination deficiency，HRD）通常指细胞水平上的HRR功能障碍状态，可由HRR相关基因胚系突变或体细胞突变以及表观遗传失活等诸多因素导致，常存在于多种恶性肿瘤中，其中在卵巢癌、乳腺癌、胰腺导管癌、前列腺癌等肿瘤中尤其突出。</p><p><strong>杂合性缺失</strong>（loss of heterozygosity，LOH）:大于15 Mb且小于整个染色体长度的杂合性缺失；</p><p><strong>端粒等位基因不平衡</strong>（telomeric allelic imbalance，TAI）:延伸到其中一个亚端粒但不超过着丝粒且大于11 Mb的等位基因不平衡的染色体片段；</p><p><strong>大片段迁移</strong>（large-scale state transition，LST）:两个相邻区域（两个区域长度均大于等于10 Mb，且区域间距小于3 Mb）之间的染色体断裂位点，肿瘤基因组截断点的总数可以用来描述基因组的不稳定性。</p><blockquote><p>中国抗癌协会肿瘤标志专业委员会遗传性肿瘤标志物协作组, 中华医学会病理学分会分子病理学组 . 同源重组修复缺陷临床检测与应用专家共识（2021版）[J]. 中国癌症防治杂志, 2021, 13(4): 329-338.</p></blockquote><p>经过查找搜寻，找到了HRD的数据计算结果。在：</p><p>https://gdc.cancer.gov/about-data/publications/PanCan-DDR-2018</p><p><strong>DNA damage repair</strong> (DDR)</p><p>给出了一组tsv，和一个大的xls文件,这是关于DNA损伤修复所有的资料，非常之齐全。</p><pre><code><span>dir</span>(<span>"TCGA_DDR_Data_Resources/"</span>)<br></code></pre><pre><code>##  <span>[1]</span> "<span>DDRscores</span><span>.tsv</span>"          "<span>GeneAlterations</span><span>.tsv</span>"    "<span>GeneDeletions</span><span>.tsv</span>"     <br>##  <span>[4]</span> "<span>GeneMutations</span><span>.tsv</span>"      "<span>Genes</span><span>.tsv</span>"              "<span>GeneSilencing</span><span>.tsv</span>"     <br>##  <span>[7]</span> "<span>PathwayAlterations</span><span>.tsv</span>" "<span>PathwayDeletions</span><span>.tsv</span>"   "<span>PathwayMembership</span><span>.tsv</span>" <br>## <span>[10]</span> "<span>PathwayMutations</span><span>.tsv</span>"   "<span>Pathways</span><span>.tsv</span>"           "<span>PathwaySilencing</span><span>.tsv</span>"  <br>## <span>[13]</span> "<span>Samples</span><span>.tsv</span>"            "<span>Scores</span><span>.tsv</span>"<br></code></pre><p>对这些文件的描述在pdf文件里，可以在上面的网址里下载到。</p><p>DDRscores.tsv</p><p>Data table listing the scores of the 43 DDR footprints and the RRPA-based DDR score across all samples (n=9,125).</p><p>The order of the genes, pathways, samples and footprint scores in these TSV files are as given in Genes.tsv, Pathways.tsv, Samples.tsv and Scores.tsv</p><h3><span>1.获得DDRscores表格</span></h3><pre><code>sc = read.delim(<span>"TCGA_DDR_Data_Resources/DDRscores.tsv"</span>,header = F)<br>s = read.delim(<span>"TCGA_DDR_Data_Resources/Samples.tsv"</span>,header = F)<br>cl = read.delim(<span>"TCGA_DDR_Data_Resources/Scores.tsv"</span>,header = F)<br>rownames(sc) = s$V1<br>colnames(sc) = cl$V1<br>colnames(sc)<br><br><span>##  [1] <span>"mutLoad_silent"</span>         <span>"mutLoad_nonsilent"</span>      <span>"mutSig1"</span>               </span><br><span>##  [4] <span>"mutSig2"</span>                <span>"mutSig3"</span>                <span>"mutSig4"</span>               </span><br><span>##  [7] <span>"mutSig5"</span>                <span>"mutSig6"</span>                <span>"mutSig7"</span>               </span><br><span>## [10] <span>"mutSig8"</span>                <span>"mutSig9"</span>                <span>"mutSig10"</span>              </span><br><span>## [13] <span>"mutSig11"</span>               <span>"mutSig12"</span>               <span>"mutSig13"</span>              </span><br><span>## [16] <span>"mutSig14"</span>               <span>"mutSig15"</span>               <span>"mutSig16"</span>              </span><br><span>## [19] <span>"mutSig17"</span>               <span>"mutSig18"</span>               <span>"mutSig19"</span>              </span><br><span>## [22] <span>"mutSig20"</span>               <span>"mutSig21"</span>               <span>"CNA_n_segs"</span>            </span><br><span>## [25] <span>"CNA_frac_altered "</span>      <span>"CNA_n_focal_amp_del"</span>    <span>"aneuploidy_score"</span>      </span><br><span>## [28] <span>"aneuploidy_score_prime"</span> <span>"LOH_n_seg"</span>              <span>"LOH_frac_altered "</span>     </span><br><span>## [31] <span>"purity"</span>                 <span>"ploidy"</span>                 <span>"genome_doublings"</span>      </span><br><span>## [34] <span>"subclonal_frac"</span>         <span>"HRD_TAI"</span>                <span>"HRD_LST"</span>               </span><br><span>## [37] <span>"HRD_LOH"</span>                <span>"HRD_Score"</span>              <span>"eCARD"</span>                 </span><br><span>## [40] <span>"PARPi7"</span>                 <span>"PARPi7_bin"</span>             <span>"RPS"</span>                   </span><br><span>## [43] <span>"tp53_score"</span>             <span>"rppa_ddr_score"</span></span><br><br><span># HDR分数</span><br>scores = sc[,<span>35</span>:<span>38</span>]<br>head(scores)<br><br><span>##                 HRD_TAI HRD_LST HRD_LOH HRD_Score</span><br><span>## TCGA-OR-A5J1-01       3       2       2         7</span><br><span>## TCGA-OR-A5J2-01       4       2       3         9</span><br><span>## TCGA-OR-A5J3-01       0       0       0         0</span><br><span>## TCGA-OR-A5J5-01       2       2       4         8</span><br><span>## TCGA-OR-A5J6-01       3       1       1         5</span><br><span>## TCGA-OR-A5J7-01      10       8       3        21</span><br><br>nrow(scores)<br><br><span>## [1] 9125</span><br></code></pre><h3><span>2. 加上癌症类型画个图看看</span></h3><pre><code>head(s)<br><span><br>#</span><span><span>#                V1  V2</span></span><br><span>#</span><span><span># 1 TCGA-OR-A5J1-01 ACC</span></span><br><span>#</span><span><span># 2 TCGA-OR-A5J2-01 ACC</span></span><br><span>#</span><span><span># 3 TCGA-OR-A5J3-01 ACC</span></span><br><span>#</span><span><span># 4 TCGA-OR-A5J5-01 ACC</span></span><br><span>#</span><span><span># 5 TCGA-OR-A5J6-01 ACC</span></span><br><span>#</span><span><span># 6 TCGA-OR-A5J7-01 ACC</span></span><br><span><br>identical(s$</span><span>V1,rownames(scores))</span><br><span><br>#</span><span><span># [1] TRUE</span></span><br><br>scores = cbind(s,scores)<br>colnames(scores)[1:2] = c("Id","Project")<br>library(tidyverse)<br>dat = drop_na(scores,HRD_Score)<br>su = group_by(dat,Project) %&gt;% <br>  summarise(a = median(HRD_Score)) %&gt;% <br>  arrange(desc(a))<br><span>dat$</span><span>Project = factor(dat<span>$Project</span>,levels = su<span>$Project</span>)</span><br>library(ggplot2)<br>library(RColorBrewer)<br>mypalette &lt;- colorRampPalette(brewer.pal(8,"Set1"))<br>ggplot(dat,aes(x = Project,y = HRD_Score,fill = Project))+<br>  geom_boxplot()+<br>  theme_bw()+<br>  theme(axis.text.x = element_text(vjust = 1,hjust = 1,angle = 45),legend.position = "bottom")+<br>  scale_fill_manual(values = mypalette(33))+<br>  guides (fill=guide_legend (nrow=3, byrow=TRUE))<br></code></pre><figure><img data-ratio="0.8" data-src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHq0gUYwextUCf78ZEchJlIusBLhCFRW02tciaKMxjDKTG79BsVvHnicQQz7RT6AxJyicHthEb8bbXS4g/640?wx_fmt=png" data-type="png" data-w="1240" title="" src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHq0gUYwextUCf78ZEchJlIusBLhCFRW02tciaKMxjDKTG79BsVvHnicQQz7RT6AxJyicHthEb8bbXS4g/640?wx_fmt=png"></figure><pre><code><span># ggplot legend number of rows</span><br></code></pre><p>这个数据本身就是全部癌症样本啦。可以看到HRD分数最高的是卵巢癌。</p><h3><span>3. 对表格列名的注释</span></h3><pre><code>xs = rio::import_list(<span>"TCGA_DDR_Data_Resources.xlsx"</span>)<br>names(xs)<br><br><span>##  [1] <span>"DDR genes and pathways"</span>          <span>"DDR gene alterations ONCOPRINT"</span> </span><br><span>##  [3] <span>"DDR gene mutations"</span>              <span>"DDR deep deletions"</span>             </span><br><span>##  [5] <span>"DDR epigenetic silencing"</span>        <span>"DDR gene alterations"</span>           </span><br><span>##  [7] <span>"DDR footprint summary"</span>           <span>"DDR footprints"</span>                 </span><br><span>##  [9] <span>"DDR pathway alterations ONCOPR "</span> <span>"DDR pathway mutations "</span>         </span><br><span>## [11] <span>"DDR pathway deletions"</span>           <span>"DDR pathway silencing"</span>          </span><br><span>## [13] <span>"DDR pathway alterations"</span>         <span>"ME CO analysis core pathways"</span>   </span><br><span>## [15] <span>"ME CO analysis inclusive pathw "</span> <span>"DDR Survival Univariate"</span>        </span><br><span>## [17] <span>"DDR Survival Multivariate"</span>       <span>"DDR gene fusions"</span>               </span><br><span>## [19] <span>"TP53 predictor"</span></span><br><br>xs[[<span>7</span>]][<span>14</span>:<span>17</span>,<span>1</span>]<br><span>## [1] <span>"TAI"</span>       <span>"LST"</span>       <span>"HRD LOH"</span>   <span>"HRD Score"</span></span><br>xs[[<span>7</span>]][<span>14</span>:<span>17</span>,<span>2</span>]<br><span>## [1] <span>"number of subchromosomal regions with allelic imbalance extending to the telomere"</span>           </span><br><span>## [2] <span>"number of chromosomal breaks between adjacent regions of at least 10Mb"</span>                      </span><br><span>## [3] <span>"the number of LOH regions of intermediate size (&gt; 15MB but &lt; whole chromosome in length)"</span>    </span><br><span>## [4] <span>"Homologous recombination deficiency score calculated from three scores (TAI + LST + HRD LOH)"</span></span><br></code></pre></section><p><span></span></p><section><blockquote><section><span>如果因为代码看不懂，而跟不上正文的节奏，可以来找我，系统学习。我的</span><span>课程都是循环开课。</span><span>下一期的时间，点进去咨询微信咯</span><br></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU4NjU4ODQ2MQ==&amp;mid=2247492627&amp;idx=1&amp;sn=614671537676eece45244aa1cbe94b15&amp;chksm=fdfbac51ca8c25475c71ed3b7b3506391a8d08149acfd62d0666193e382b33634382bef4f80d&amp;scene=21#wechat_redirect" textvalue="产假结束，核酸尚阴，期待遇见2023年的你" linktype="text" imgurl="" imgdata="null" data-itemshowtype="11" tab="innerlink" data-linktype="2">产假结束，核酸尚阴，期待遇见2023年的你</a><br></section></blockquote></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/hq1uj1KIXUaz7yxK5uvAIw",target="_blank" rel="noopener noreferrer">原文链接</a>
