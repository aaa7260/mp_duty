---
title: "projectLSI：将你的单细胞或bulk转录组数据映射到参考数据集中"
date: 2022-09-03T01:36:58Z
draft: ["false"]
tags: [
  "fetched",
  "bioinfomics"
]
categories: ["Acdemic"]
---
projectLSI：将你的单细胞或bulk转录组数据映射到参考数据集中 by bioinfomics
------
<div><p data-mpa-powered-by="yiban.io"><img data-ratio="0.19672131147540983" data-type="gif" data-w="610" data-src="https://mmbiz.qpic.cn/mmbiz_gif/Ljib4So7yuWjHdD2cB6FcZUySYkEX7xSSThSjicSruG1S1pdficyrOavnIEicO4e5ZsFpr8eWELBLibC9XYehs7yJ6Q/640?wx_fmt=gif&amp;wxfrom=5&amp;wx_lazy=1" src="https://mmbiz.qpic.cn/mmbiz_gif/Ljib4So7yuWjHdD2cB6FcZUySYkEX7xSSThSjicSruG1S1pdficyrOavnIEicO4e5ZsFpr8eWELBLibC9XYehs7yJ6Q/640?wx_fmt=gif&amp;wxfrom=5&amp;wx_lazy=1"><span></span></p><section data-support="96编辑器" data-style-id="8500"><section><section><img data-ratio="0.9533333333333334" data-src="https://mmbiz.qpic.cn/mmbiz_gif/yqVAqoZvDibGCdKnmricD9lgfsyaABUCp3BcafMOpbqVQ57ClzSyicSLMIq3FJh9LXGtlpIaReXJQ5OcHZtAV2m7Q/640?wx_fmt=gif&amp;wxfrom=5&amp;wx_lazy=1" data-type="gif" data-w="300" src="https://mmbiz.qpic.cn/mmbiz_gif/yqVAqoZvDibGCdKnmricD9lgfsyaABUCp3BcafMOpbqVQ57ClzSyicSLMIq3FJh9LXGtlpIaReXJQ5OcHZtAV2m7Q/640?wx_fmt=gif&amp;wxfrom=5&amp;wx_lazy=1"></section></section><section><section><section><section><section><qqmusic musicid="326069453" mid="002RlZ9n4095zu" albumurl="https://y.gtimg.cn/music/photo_new/T002R68x68M0000009UZRV4CRrmv.jpg" audiourl="http://isure6.stream.qqmusic.qq.com/C200002RlZ9n4095zu.m4a?guid=2000000052&amp;vkey=C77E98E73F975295290FC13B53FDA868599613CA888AABCB3C7248EF8D07192894566AE8001D85AB2A3D85806A9C3666F77D060079B5CEB8&amp;uin=0&amp;fromtag=175" music_name="花好月圆夜" singer="任贤齐;杨千嬅 - 东方卫视中秋梦幻夜" play_length="218" src="/mp/readtemplate?t=app_editor/music&amp;singer=%E4%BB%BB%E8%B4%A4%E9%BD%90%3B%E6%9D%A8%E5%8D%83%E5%AC%85%20-%20%E4%B8%9C%E6%96%B9%E5%8D%AB%E8%A7%86%E4%B8%AD%E7%A7%8B%E6%A2%A6%E5%B9%BB%E5%A4%9C&amp;music_name=%E8%8A%B1%E5%A5%BD%E6%9C%88%E5%9C%86%E5%A4%9C&amp;albumurl=https%3A%2F%2Fy.gtimg.cn%2Fmusic%2Fphoto_new%2FT002R68x68M0000009UZRV4CRrmv.jpg&amp;musictype=1" musictype="1" otherid="002RlZ9n4095zu" albumid="0009UZRV4CRrmv" jumpurlkey="" data-pluginname="insertaudio"></qqmusic></section></section></section></section></section></section><section><section data-support="96编辑器" data-style-id="26168"><section><section><br></section><section><mp-common-profile data-index="0" data-id="MzUzNzYwOTM1NA==" data-headimg="http://mmbiz.qpic.cn/mmbiz_png/zN67RpvO3kaXpySS2epnAdkmtEhiaM9aialia7tlR0NHI3lzJOWQ6c2o2vMZB0BuX8QO9YO9rtf1Cpk7TZaw63jUA/0?wx_fmt=png" data-nickname="bioinfomics" data-alias="" data-signature="记录并分享个人生信学习的技巧和经验，在学习中成长，在分享中进步！" data-origin_num="368" data-is_biz_ban="0" data-isban="0" data-from="2"></mp-common-profile></section><p><img data-ratio="0.11424100156494522" data-src="https://mmbiz.qpic.cn/mmbiz_gif/Ljib4So7yuWiaMArGTHZ6TNc7h6HTsh9nNxWsZHiapK6rO8puD1LjwzGcA80hM15GWBakhnUpTwYRrAHPwJ29ZAlw/640?wx_fmt=gif&amp;wxfrom=5&amp;wx_lazy=1" data-type="gif" data-w="639" src="https://mmbiz.qpic.cn/mmbiz_gif/Ljib4So7yuWiaMArGTHZ6TNc7h6HTsh9nNxWsZHiapK6rO8puD1LjwzGcA80hM15GWBakhnUpTwYRrAHPwJ29ZAlw/640?wx_fmt=gif&amp;wxfrom=5&amp;wx_lazy=1"></p></section></section></section><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><h2 data-tool="mdnice编辑器"><span></span><span>简介</span></h2><p data-tool="mdnice编辑器">在单细胞数据分析过程中，我们经常会遇到不同样本之间整合的批次效应和细胞类型注释的困难，projectLSI包利用term frequency–inverse document frequency (TF-IDF) transformation and latent semantic indexing (LSI)算法进行数据降维转换，可以将query的单细胞或bulk转录组数据集映射到reference参考数据集中以消除潜在的批次效应，同时也可以利用bulk转录组数据验证单细胞注释分群的结果。</p><h2 data-tool="mdnice编辑器"><span></span><span>R包安装</span></h2><pre data-tool="mdnice编辑器"><span></span><code>devtools::install_github(<span>"sajuukLyu/projectLSI"</span>)<br></code></pre><h2 data-tool="mdnice编辑器"><span></span><span>实例演示</span></h2><p data-tool="mdnice编辑器">接下来，我们将使用两个单细胞转录组数据集pbmc3k和pbmc4k，以及一个bulk转录组数据集bulk.data进行实例演示projectLSI包的使用流程。我们将以pbmc3k数据集作为参考数据集，使用projectLSI程序将pbmc4k和bulk.data数据集映射到参考数据集中。</p><h3 data-tool="mdnice编辑器"><span></span><span></span><span>加载所需R包和示例数据集</span><span></span></h3><p data-tool="mdnice编辑器"><code>pbmc3k</code> and <code>pbmc4k</code> datasets are from package TENxPBMCData, and <code>bulk.data</code> is part of GSE74246.</p><pre data-tool="mdnice编辑器"><span></span><code>library(Seurat)<br>library(projectLSI)<br>library(patchwork)<br><br>data(pbmc3k)<br>data(pbmc4k)<br>data(bulk.data)<br><br>pbmc3k<br><span>## An object of class Seurat </span><br><span>## 32738 features across 2700 samples within 1 assay </span><br><span>## Active assay: RNA (32738 features)</span><br>pbmc4k<br><span>## An object of class Seurat </span><br><span>## 33694 features across 4340 samples within 1 assay </span><br><span>## Active assay: RNA (33694 features)</span><br><br>bulk.data[1:5,1:5]<br> <span>#        CD4T_1 CD4T_2 CD4T_3 CD4T_4 CD8T_1</span><br><span>#A1BG          0      3      7      4      0</span><br><span>#A1BG-AS1      3      1      1      3      0</span><br><span>#A1CF         10     15      3      0      1</span><br><span>#A2M         141    273    870     92    351</span><br><span>#A2M-AS1      14     23    154     18     31</span><br>dim(bulk.data)<br><span>## [1] 25498    20</span><br>names(bulk.data)<br><span># [1] "CD4T_1" "CD4T_2" "CD4T_3" "CD4T_4" "CD8T_1" "CD8T_2" "CD8T_3" "CD8T_4"</span><br><span># [9] "NK_1"   "NK_2"   "NK_3"   "NK_4"   "B_1"    "B_2"    "B_3"    "B_4"</span><br><span># [17] "Mono_1" "Mono_2" "Mono_3" "Mono_4"</span><br></code></pre><h4 data-tool="mdnice编辑器"><span></span>单细胞数据预处理<span></span></h4><pre data-tool="mdnice编辑器"><span></span><code><span># for pbmc3k</span><br><span># 计算线粒体含量</span><br>pbmc3k<span>$pct</span>.mt &lt;- PercentageFeatureSet(pbmc3k, pattern = <span>"^MT-"</span>)<br><span># 数据质控</span><br>FeatureScatter(pbmc3k, feature1 = <span>"nCount_RNA"</span>, feature2 = <span>"pct.mt"</span>) +<br>FeatureScatter(pbmc3k, feature1 = <span>"nCount_RNA"</span>, feature2 = <span>"nFeature_RNA"</span>)<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.4166666666666667" data-src="https://mmbiz.qpic.cn/mmbiz_png/zN67RpvO3kZWpRdyicAHZ2cJgEeruB5MqRTDCp5w7jO0icUJgB8swl3iaibc6LcnJSk5p5ccuhC2CR6mRTvNeVDAPg/640?wx_fmt=png" data-type="png" data-w="1200" src="https://mmbiz.qpic.cn/mmbiz_png/zN67RpvO3kZWpRdyicAHZ2cJgEeruB5MqRTDCp5w7jO0icUJgB8swl3iaibc6LcnJSk5p5ccuhC2CR6mRTvNeVDAPg/640?wx_fmt=png"><figcaption>image.png</figcaption></figure><pre data-tool="mdnice编辑器"><span></span><code><span># 质控过滤</span><br>pbmc3k &lt;- subset(pbmc3k, subset = nFeature_RNA &gt; 200 &amp; nFeature_RNA &lt; 2500 &amp; pct.mt &lt; 5)<br><span># 数据标准化</span><br>pbmc3k &lt;- NormalizeData(pbmc3k)<br><span>## Performing log-normalization</span><br><span>## 0%   10   20   30   40   50   60   70   80   90   100%</span><br><span>## [----|----|----|----|----|----|----|----|----|----|</span><br><span>## **************************************************|</span><br><span># 筛选高变异基因</span><br>pbmc3k &lt;- FindVariableFeatures(pbmc3k, nfeatures = 2000)<br><span>## Calculating gene variances</span><br><span>## 0%   10   20   30   40   50   60   70   80   90   100%</span><br><span>## [----|----|----|----|----|----|----|----|----|----|</span><br><span>## **************************************************|</span><br><span>## Calculating feature variances of standardized and clipped values</span><br><span>## 0%   10   20   30   40   50   60   70   80   90   100%</span><br><span>## [----|----|----|----|----|----|----|----|----|----|</span><br><span>## **************************************************|</span><br><br><span># for pbmc4k</span><br>pbmc4k<span>$pct</span>.mt &lt;- PercentageFeatureSet(pbmc4k, pattern = <span>"^MT-"</span>)<br>FeatureScatter(pbmc4k, feature1 = <span>"nCount_RNA"</span>, feature2 = <span>"pct.mt"</span>) +<br>FeatureScatter(pbmc4k, feature1 = <span>"nCount_RNA"</span>, feature2 = <span>"nFeature_RNA"</span>)<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.4166666666666667" data-src="https://mmbiz.qpic.cn/mmbiz_png/zN67RpvO3kZWpRdyicAHZ2cJgEeruB5MqGSKtzSkUoSFgL7tTIT1cL6FLvswY4WWvOyLbAQmbeaKktKOR2RGuAw/640?wx_fmt=png" data-type="png" data-w="1200" src="https://mmbiz.qpic.cn/mmbiz_png/zN67RpvO3kZWpRdyicAHZ2cJgEeruB5MqGSKtzSkUoSFgL7tTIT1cL6FLvswY4WWvOyLbAQmbeaKktKOR2RGuAw/640?wx_fmt=png"><figcaption>image.png</figcaption></figure><pre data-tool="mdnice编辑器"><span></span><code>pbmc4k &lt;- subset(pbmc4k, subset = nFeature_RNA &gt; 200 &amp; nFeature_RNA &lt; 3500 &amp; pct.mt &lt; 8)<br>pbmc4k &lt;- NormalizeData(pbmc4k)<br><span>## Performing log-normalization</span><br><span>## 0%   10   20   30   40   50   60   70   80   90   100%</span><br><span>## [----|----|----|----|----|----|----|----|----|----|</span><br><span>## **************************************************|</span><br>pbmc4k &lt;- FindVariableFeatures(pbmc4k, nfeatures = 2000)<br><span>## Calculating gene variances</span><br><span>## 0%   10   20   30   40   50   60   70   80   90   100%</span><br><span>## [----|----|----|----|----|----|----|----|----|----|</span><br><span>## **************************************************|</span><br><span>## Calculating feature variances of standardized and clipped values</span><br><span>## 0%   10   20   30   40   50   60   70   80   90   100%</span><br><span>## [----|----|----|----|----|----|----|----|----|----|</span><br><span>## **************************************************|</span><br></code></pre><h4 data-tool="mdnice编辑器"><span></span>进行线性降维处理<span></span></h4><p data-tool="mdnice编辑器">这里，我们将使用projectLSI包对标准化的数据进行TF-IDF和LSI线性降维处理。注意，我们使用筛选出的高变异基因作为输入。</p><pre data-tool="mdnice编辑器"><span></span><code><span># 使用calcLSI函数进行线性降维</span><br>pbmc3k.lsi &lt;- calcLSI(pbmc3k[[<span>"RNA"</span>]]@data[VariableFeatures(pbmc3k), ])<br>pbmc3k.lsi<span>$matSVD</span>[1:5,1:5]<br> <span>#                          PC_1          PC_2          PC_3         PC_4</span><br><span>#3k_AAACATACAACCAC-1 -0.03787607 -1.038326e-02 -0.0009909208  0.005607445</span><br><span>#3k_AAACATTGAGCTAC-1 -0.03799807 -4.920159e-05  0.0066228430 -0.018501420</span><br><span>#3k_AAACATTGATCAGC-1 -0.03885814 -8.351669e-03 -0.0021662553  0.005449835</span><br><br><span># 将LSI降维信息添加到seurat对象中</span><br>pbmc3k[[<span>"pca"</span>]] &lt;- CreateDimReducObject(<br>  embeddings = pbmc3k.lsi<span>$matSVD</span>,<br>  loadings = pbmc3k.lsi<span>$fLoad</span>,<br>  assay = <span>"RNA"</span>,<br>  stdev = pbmc3k.lsi<span>$sdev</span>,<br>  key = <span>"PC_"</span>)<br><br>ElbowPlot(pbmc3k)<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.5555555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/zN67RpvO3kZWpRdyicAHZ2cJgEeruB5MqTamWvpN52oszjsf27vawugqYREw11olF2HicYp8p4JgWsOj2HknEK0w/640?wx_fmt=png" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/zN67RpvO3kZWpRdyicAHZ2cJgEeruB5MqTamWvpN52oszjsf27vawugqYREw11olF2HicYp8p4JgWsOj2HknEK0w/640?wx_fmt=png"><figcaption>image.png</figcaption></figure><h4 data-tool="mdnice编辑器"><span></span>细胞聚类分群<span></span></h4><pre data-tool="mdnice编辑器"><span></span><code>pbmc3k &lt;- FindNeighbors(pbmc3k, dims = 1:10)<br><span>## Computing nearest neighbor graph</span><br><span>## Computing SNN</span><br><br>pbmc3k &lt;- FindClusters(pbmc3k, resolution = 0.6)<br><span>## Modularity Optimizer version 1.3.0 by Ludo Waltman and Nees Jan van Eck</span><br><span>## </span><br><span>## Number of nodes: 2638</span><br><span>## Number of edges: 97177</span><br><span>## </span><br><span>## Running Louvain algorithm...</span><br><span>## 0%   10   20   30   40   50   60   70   80   90   100%</span><br><span>## [----|----|----|----|----|----|----|----|----|----|</span><br><span>## **************************************************|</span><br><span>## Maximum modularity in 10 random starts: 0.8542</span><br><span>## Number of communities: 9</span><br><span>## Elapsed time: 0 seconds</span><br></code></pre><h4 data-tool="mdnice编辑器"><span></span>UMAP降维可视化<span></span></h4><p data-tool="mdnice编辑器">Notice that ret_model parameter should be TRUE for later projection.</p><pre data-tool="mdnice编辑器"><span></span><code>set.seed(42)<br>umap.pbmc3k &lt;- uwot::umap(pbmc3k.lsi<span>$matSVD</span>[, 1:10],<br>                          n_neighbors = 30,<br>                          min_dist = 0.5,<br>                          metric = <span>"euclidean"</span>,<br>                          ret_model = T,<br>                          verbose = T)<br><span>## 00:58:06 UMAP embedding parameters a = 0.583 b = 1.334</span><br><span>## 00:58:06 Read 2638 rows and found 10 numeric columns</span><br><span>## 00:58:06 Using Annoy for neighbor search, n_neighbors = 30</span><br><span>## 00:58:06 Building Annoy index with metric = euclidean, n_trees = 50</span><br><span>## 0%   10   20   30   40   50   60   70   80   90   100%</span><br><span>## [----|----|----|----|----|----|----|----|----|----|</span><br><span>## **************************************************|</span><br><span>## 00:58:06 Writing NN index file to temp file /tmp/RtmpbWcqgH/file17b95ca52051</span><br><span>## 00:58:06 Searching Annoy index using 8 threads, search_k = 3000</span><br><span>## 00:58:06 Annoy recall = 100%</span><br><span>## 00:58:07 Commencing smooth kNN distance calibration using 8 threads</span><br><span>## 00:58:07 Initializing from normalized Laplacian + noise</span><br><span>## Spectral initialization failed to converge, using random initialization instead</span><br><span>## 00:58:07 Commencing optimization for 500 epochs, with 110674 positive edges</span><br><span>## 0%   10   20   30   40   50   60   70   80   90   100%</span><br><span>## [----|----|----|----|----|----|----|----|----|----|</span><br><span>## **************************************************|</span><br><span>## 00:58:12 Optimization finished</span><br><br><span># 提取UMAP降维信息</span><br>umap.pbmc3k.emb &lt;- umap.pbmc3k<span>$embedding</span><br>rownames(umap.pbmc3k.emb) &lt;- colnames(pbmc3k)<br>colnames(umap.pbmc3k.emb) &lt;- paste0(<span>"UMAP_"</span>, seq_len(ncol(umap.pbmc3k.emb)))<br>head(umap.pbmc3k.emb)<br><span>#                       UMAP_1    UMAP_2</span><br><span>#3k_AAACATACAACCAC-1   4.462377  1.675100</span><br><span>#3k_AAACATTGAGCTAC-1  -1.583569 -9.764045</span><br><span>#3k_AAACATTGATCAGC-1   7.612832  1.880275</span><br><br><span># 将UMAP降维信息添加到seurat对象中</span><br>pbmc3k[[<span>"umap"</span>]] &lt;- CreateDimReducObject(<br>  embeddings = umap.pbmc3k.emb,<br>  assay = <span>"RNA"</span>,<br>  key = <span>"UMAP_"</span>)<br><br>DimPlot(pbmc3k, label = T)<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.8571428571428571" data-src="https://mmbiz.qpic.cn/mmbiz_png/zN67RpvO3kZWpRdyicAHZ2cJgEeruB5MqSXOrib5WEzZMgRj37IVypIZLSMGRkqJw2icj19Fwlrs81RYN7HcZFEGA/640?wx_fmt=png" data-type="png" data-w="700" src="https://mmbiz.qpic.cn/mmbiz_png/zN67RpvO3kZWpRdyicAHZ2cJgEeruB5MqSXOrib5WEzZMgRj37IVypIZLSMGRkqJw2icj19Fwlrs81RYN7HcZFEGA/640?wx_fmt=png"><figcaption>image.png</figcaption></figure><pre data-tool="mdnice编辑器"><span></span><code><span># 查看marker基因的表达情况</span><br>FeaturePlot(pbmc3k, c(<span>"MS4A1"</span>, <span>"GNLY"</span>, <span>"CD3E"</span>,<br>                      <span>"CD14"</span>, <span>"FCER1A"</span>, <span>"FCGR3A"</span>,<br>                      <span>"LYZ"</span>, <span>"PPBP"</span>, <span>"CD8A"</span>), order = T)<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="1" data-src="https://mmbiz.qpic.cn/mmbiz_png/zN67RpvO3kZWpRdyicAHZ2cJgEeruB5Mqss6rzJ3TlibZU0Lf2EWEj9ib1vUhpXsyRBP3qYUBQqhqy3SBBTibpDLAw/640?wx_fmt=png" data-type="png" data-w="1200" src="https://mmbiz.qpic.cn/mmbiz_png/zN67RpvO3kZWpRdyicAHZ2cJgEeruB5Mqss6rzJ3TlibZU0Lf2EWEj9ib1vUhpXsyRBP3qYUBQqhqy3SBBTibpDLAw/640?wx_fmt=png"><figcaption>image.png</figcaption></figure><h4 data-tool="mdnice编辑器"><span></span>细胞类型注释<span></span></h4><figure data-tool="mdnice编辑器"><img data-ratio="0.9649415692821369" data-src="https://mmbiz.qpic.cn/mmbiz_png/zN67RpvO3kZWpRdyicAHZ2cJgEeruB5MqOOVu7yqYUDQGSRXIqTBq57FRHO9ibreFlibcsFYBw227ibaqblPbibV6wQ/640?wx_fmt=png" data-type="png" data-w="599" src="https://mmbiz.qpic.cn/mmbiz_png/zN67RpvO3kZWpRdyicAHZ2cJgEeruB5MqOOVu7yqYUDQGSRXIqTBq57FRHO9ibreFlibcsFYBw227ibaqblPbibV6wQ/640?wx_fmt=png"><figcaption>image.png</figcaption></figure><pre data-tool="mdnice编辑器"><span></span><code>new.cluster.ids &lt;- c(<span>"Naive CD4 T"</span>, <span>"Memory CD4 T"</span>, <span>"CD14+ Mono"</span>,<br>                     <span>"B"</span>, <span>"NK"</span>, <span>"FCGR3A+ Mono"</span>,<br>                     <span>"CD8 T"</span>, <span>"DC"</span>, <span>"Platelet"</span>)<br>names(new.cluster.ids) &lt;- levels(pbmc3k)<br>pbmc3k &lt;- RenameIdents(pbmc3k, new.cluster.ids)<br><br>DimPlot(pbmc3k, label = T) + NoLegend()<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.8" data-src="https://mmbiz.qpic.cn/mmbiz_png/zN67RpvO3kZWpRdyicAHZ2cJgEeruB5MqMuEbkQYcceflyAFBbn74nLWy7AVFYicwMrXlPRGUaicKHZicWKyt1UicJg/640?wx_fmt=png" data-type="png" data-w="1000" src="https://mmbiz.qpic.cn/mmbiz_png/zN67RpvO3kZWpRdyicAHZ2cJgEeruB5MqMuEbkQYcceflyAFBbn74nLWy7AVFYicwMrXlPRGUaicKHZicWKyt1UicJg/640?wx_fmt=png"><figcaption>image.png</figcaption></figure><h4 data-tool="mdnice编辑器"><span></span>将query单细胞数据集映射到参考数据集中<span></span></h4><p data-tool="mdnice编辑器">接下来，我们将使用projectLSI函数将pbmc4k查询数据集映射到参考数据集pbmc3k中。</p><pre data-tool="mdnice编辑器"><span></span><code>matSVD.pbmc4k &lt;- projectLSI(pbmc4k[[<span>"RNA"</span>]]@data, pbmc3k.lsi)<br>head(matSVD.pbmc4k)<br><span>#                            PC_1        PC_2          PC_3        PC_4</span><br><span>#4k_AAACCTGAGAAGGCCT-1 -0.03410563  0.02377144  0.0002275122 0.001904910</span><br><span>#4k_AAACCTGAGACAGACC-1 -0.03532231  0.02358280  0.0023570705 0.001242694</span><br><span>#4k_AAACCTGAGATAGTCA-1 -0.03497681  0.02380977  0.0012423880 0.002034311</span><br><br>pbmc4k[[<span>"pca"</span>]] &lt;- CreateDimReducObject(<br>  embeddings = matSVD.pbmc4k,<br>  loadings = pbmc3k.lsi<span>$fLoad</span>,<br>  assay = <span>"RNA"</span>,<br>  key = <span>"PC_"</span>)<br><br><span># cluster cells using projected LSI</span><br>pbmc4k &lt;- FindNeighbors(pbmc4k, dims = 1:10)<br><span>## Computing nearest neighbor graph</span><br><span>## Computing SNN</span><br>pbmc4k &lt;- FindClusters(pbmc4k, resolution = 0.6)<br><span>## Modularity Optimizer version 1.3.0 by Ludo Waltman and Nees Jan van Eck</span><br><span>## </span><br><span>## Number of nodes: 4284</span><br><span>## Number of edges: 154662</span><br><span>## </span><br><span>## Running Louvain algorithm...</span><br><span>## 0%   10   20   30   40   50   60   70   80   90   100%</span><br><span>## [----|----|----|----|----|----|----|----|----|----|</span><br><span>## **************************************************|</span><br><span>## Maximum modularity in 10 random starts: 0.8670</span><br><span>## Number of communities: 10</span><br><span>## Elapsed time: 0 seconds</span><br><br><span># perform UMAP using first 10 PCs, just like pbmc3k</span><br>umap.pbmc4k.proj &lt;- uwot::umap_transform(matSVD.pbmc4k[, 1:10], umap.pbmc3k, verbose = T)<br><span>## 01:37:48 Read 4284 rows and found 10 numeric columns</span><br><span>## 01:37:48 Processing block 1 of 1</span><br><span>## 01:37:48 Writing NN index file to temp file /tmp/RtmpbWcqgH/file17b933607747</span><br><span>## 01:37:48 Searching Annoy index using 8 threads, search_k = 3000</span><br><span>## 01:37:48 Commencing smooth kNN distance calibration using 8 threads</span><br><span>## 01:37:48 Initializing by weighted average of neighbor coordinates using 8 threads</span><br><span>## 01:37:48 Commencing optimization for 167 epochs, with 128520 positive edges</span><br><span>## 0%   10   20   30   40   50   60   70   80   90   100%</span><br><span>## [----|----|----|----|----|----|----|----|----|----|</span><br><span>## **************************************************|</span><br><span>## 01:37:50 Finished</span><br><br>head(umap.pbmc4k.proj)<br><span>#          [,1]       [,2]</span><br><span>#[1,] -11.620971  1.3273895</span><br><span>#[2,] -12.708588 -0.8110412</span><br><span>#[3,] -12.193903 -0.9287748</span><br>rownames(umap.pbmc4k.proj) &lt;- colnames(pbmc4k)<br>colnames(umap.pbmc4k.proj) &lt;- paste0(<span>"UMAP_"</span>, seq_len(ncol(umap.pbmc4k.proj)))<br><br>pbmc4k[[<span>"umap"</span>]] &lt;- CreateDimReducObject(<br>  embeddings = umap.pbmc4k.proj,<br>  assay = <span>"RNA"</span>,<br>  key = <span>"UMAP_"</span>)<br><br>DimPlot(pbmc4k, label = T)<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.8571428571428571" data-src="https://mmbiz.qpic.cn/mmbiz_png/zN67RpvO3kZWpRdyicAHZ2cJgEeruB5MqDRNmuaiaoqOibMhwBYLca3bjouvMcO55Eb3S9KcD0VopXLqhicxDcfIgw/640?wx_fmt=png" data-type="png" data-w="700" src="https://mmbiz.qpic.cn/mmbiz_png/zN67RpvO3kZWpRdyicAHZ2cJgEeruB5MqDRNmuaiaoqOibMhwBYLca3bjouvMcO55Eb3S9KcD0VopXLqhicxDcfIgw/640?wx_fmt=png"><figcaption>image.png</figcaption></figure><pre data-tool="mdnice编辑器"><span></span><code>FeaturePlot(pbmc4k, c(<span>"MS4A1"</span>, <span>"GNLY"</span>, <span>"CD3E"</span>,<br>                      <span>"CD14"</span>, <span>"FCER1A"</span>, <span>"FCGR3A"</span>,<br>                      <span>"LYZ"</span>, <span>"PPBP"</span>, <span>"CD8A"</span>), order = T)<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="1" data-src="https://mmbiz.qpic.cn/mmbiz_png/zN67RpvO3kZWpRdyicAHZ2cJgEeruB5MqFgPzMkBHTBAQFfzjvyHoOJyT4qgFcQtPSy9Bwnd3PPHcSdLh99Dv8w/640?wx_fmt=png" data-type="png" data-w="1200" src="https://mmbiz.qpic.cn/mmbiz_png/zN67RpvO3kZWpRdyicAHZ2cJgEeruB5MqFgPzMkBHTBAQFfzjvyHoOJyT4qgFcQtPSy9Bwnd3PPHcSdLh99Dv8w/640?wx_fmt=png"><figcaption>image.png</figcaption></figure><pre data-tool="mdnice编辑器"><span></span><code>new.cluster.ids &lt;- c(<span>"Naive CD4 T"</span>, <span>"CD14+ Mono"</span>, <span>"B"</span>, <span>"Memory CD4 T"</span>,<br>                     <span>"CD8 T"</span>, <span>"CD14+ Mono"</span>, <span>"NK"</span>, <span>"FCGR3A+ Mono"</span>,<br>                     <span>"DC"</span>, <span>"Platelet"</span>)<br>names(new.cluster.ids) &lt;- levels(pbmc4k)<br>pbmc4k &lt;- RenameIdents(pbmc4k, new.cluster.ids)<br><br>DimPlot(pbmc4k, label = T) + NoLegend()<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.8" data-src="https://mmbiz.qpic.cn/mmbiz_png/zN67RpvO3kZWpRdyicAHZ2cJgEeruB5MqicmKQDUtUGuA9p5Y9RoSr1wWibsymnAJkpc5C2Fc0lzRpricrmeCoeSQA/640?wx_fmt=png" data-type="png" data-w="1000" src="https://mmbiz.qpic.cn/mmbiz_png/zN67RpvO3kZWpRdyicAHZ2cJgEeruB5MqicmKQDUtUGuA9p5Y9RoSr1wWibsymnAJkpc5C2Fc0lzRpricrmeCoeSQA/640?wx_fmt=png"><figcaption>image.png</figcaption></figure><p data-tool="mdnice编辑器">接下来，我们将映射好的pbmc4k和pbmc3k数据集合并到一起进行展示</p><pre data-tool="mdnice编辑器"><span></span><code>pbmc7k &lt;- merge(pbmc3k, pbmc4k)<br><br>pbmc7k[[<span>"umap"</span>]] &lt;- CreateDimReducObject(<br>  embeddings = rbind(pbmc3k[[<span>"umap"</span>]]@cell.embeddings,<br>                     pbmc4k[[<span>"umap"</span>]]@cell.embeddings),<br>  assay = <span>"RNA"</span>, key = <span>"UMAP_"</span>)<br><br>DimPlot(pbmc7k, label = T) + NoLegend()<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.8" data-src="https://mmbiz.qpic.cn/mmbiz_png/zN67RpvO3kZWpRdyicAHZ2cJgEeruB5MqaPdTZGAZf7JZpINPWK0c05sd1ia0BD3t3uhSfrBupniaInpcXibklOGtg/640?wx_fmt=png" data-type="png" data-w="1000" src="https://mmbiz.qpic.cn/mmbiz_png/zN67RpvO3kZWpRdyicAHZ2cJgEeruB5MqaPdTZGAZf7JZpINPWK0c05sd1ia0BD3t3uhSfrBupniaInpcXibklOGtg/640?wx_fmt=png"><figcaption>image.png</figcaption></figure><pre data-tool="mdnice编辑器"><span></span><code>pbmc7k<span>$celltype</span> &lt;- Idents(pbmc7k)<br>Idents(pbmc7k) &lt;- pbmc7k<span>$orig</span>.ident<br>DimPlot(pbmc7k)<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.8571428571428571" data-src="https://mmbiz.qpic.cn/mmbiz_png/zN67RpvO3kZWpRdyicAHZ2cJgEeruB5Mq2lRLLFMa0j9rsCGoOxsicmwk0ia5LicE6icWzz4lzwibEt7Sjcw8mvo2XnQ/640?wx_fmt=png" data-type="png" data-w="700" src="https://mmbiz.qpic.cn/mmbiz_png/zN67RpvO3kZWpRdyicAHZ2cJgEeruB5Mq2lRLLFMa0j9rsCGoOxsicmwk0ia5LicE6icWzz4lzwibEt7Sjcw8mvo2XnQ/640?wx_fmt=png"><figcaption>image.png</figcaption></figure><p data-tool="mdnice编辑器">可以看到，pbmc4k和参考数据集pbmc3k的细胞类型重叠的很好，不存在明显的批次效应。</p><h4 data-tool="mdnice编辑器"><span></span>将bulk转录组数据映射到参考数据集中<span></span></h4><p data-tool="mdnice编辑器">接下来，我们将使用projectLSI包将bulk转录组数据映射到单细胞参考数据集中。首先，我们将使用psudoSC函数将bulk转录组数据进行down-sampleing重取样构建psudo-single-cell数据。</p><pre data-tool="mdnice编辑器"><span></span><code><span># 设置n=100每个样本重取样100次</span><br>psudo.all &lt;- psudoSC(bulk.data, n = 100, depth = 3000)<br><span>## downsampling counts...</span><br><span>## merging all samples...</span><br>dim(psudo.all)<br><span>## [1] 25498  2000</span><br><br>psudo.all[1:5,1:5]<br><span>#5 x 5 sparse Matrix of class "dgCMatrix"</span><br><span>#         CD4T_1_1 CD4T_1_2 CD4T_1_3 CD4T_1_4 CD4T_1_5</span><br><span>#A1BG            .        .        .        .        .</span><br><span>#A1BG-AS1        .        .        .        .        .</span><br><span>#A1CF            .        .        .        .        .</span><br></code></pre><pre data-tool="mdnice编辑器"><span></span><code><span># 构建seurat对象</span><br>psudo.so &lt;- CreateSeuratObject(psudo.all, project = <span>"bulk"</span>)<br><span># 数据标准化</span><br>psudo.so &lt;- NormalizeData(psudo.so)<br><span>## Performing log-normalization</span><br><span>## 0%   10   20   30   40   50   60   70   80   90   100%</span><br><span>## [----|----|----|----|----|----|----|----|----|----|</span><br><span>## **************************************************|</span><br>Idents(psudo.so) &lt;- rep(c(<span>"CD4T.bulk"</span>, <span>"CD8T.bulk"</span>, <span>"NK.bulk"</span>, <span>"B.bulk"</span>, <span>"Mono.bulk"</span>), rep(400, 5))<br>table(Idents(psudo.so))<br><span>#CD4T.bulk CD8T.bulk   NK.bulk    B.bulk Mono.bulk</span><br><span>#      400       400       400       400       400</span><br><br><span># 使用projectLSI函数进行数据映射</span><br>bulk.matSVD &lt;- projectLSI(psudo.so[[<span>"RNA"</span>]]@data, pbmc3k.lsi)<br>head(bulk.matSVD)<br><span>#                PC_1        PC_2          PC_3          PC_4        PC_5</span><br><span>#CD4T_1_1 -0.03980147 -0.01410879 -0.0014396458  5.488960e-04 0.011402060</span><br><span>#CD4T_1_2 -0.04032496 -0.01581425  0.0003935543  1.469935e-03 0.009831236</span><br><span>#CD4T_1_3 -0.04006459 -0.01520021  0.0001330849  4.762865e-04 0.009996544</span><br><br>umap.bulk.proj &lt;- uwot::umap_transform(bulk.matSVD[, 1:10], umap.pbmc3k, verbose = T)<br><span>## 13:16:17 Read 2000 rows and found 10 numeric columns</span><br><span>## 13:16:17 Processing block 1 of 1</span><br><span>## 13:16:17 Writing NN index file to temp file /tmp/RtmplGf1gl/file1a6a91b3753</span><br><span>## 13:16:17 Searching Annoy index using 8 threads, search_k = 3000</span><br><span>## 13:16:17 Commencing smooth kNN distance calibration using 8 threads</span><br><span>## 13:16:17 Initializing by weighted average of neighbor coordinates using 8 threads</span><br><span>## 13:16:17 Commencing optimization for 167 epochs, with 60000 positive edges</span><br><span>## 0%   10   20   30   40   50   60   70   80   90   100%</span><br><span>## [----|----|----|----|----|----|----|----|----|----|</span><br><span>## **************************************************|</span><br><span>## 13:16:18 Finished</span><br>rownames(umap.bulk.proj) &lt;- colnames(psudo.so)<br>colnames(umap.bulk.proj) &lt;- paste0(<span>"UMAP_"</span>, seq_len(ncol(umap.bulk.proj)))<br>psudo.so[[<span>"umap"</span>]] &lt;- CreateDimReducObject(<br>  embeddings = umap.bulk.proj,<br>  assay = <span>"RNA"</span>,<br>  key = <span>"UMAP_"</span>)<br><br>DimPlot(psudo.so, label = T)<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.8571428571428571" data-src="https://mmbiz.qpic.cn/mmbiz_png/zN67RpvO3kZWpRdyicAHZ2cJgEeruB5MqKJH7ED6mANWldCkMY8phWxaE6f2Bq3ElqRLG8KETpqDmdHjlO3uAow/640?wx_fmt=png" data-type="png" data-w="700" src="https://mmbiz.qpic.cn/mmbiz_png/zN67RpvO3kZWpRdyicAHZ2cJgEeruB5MqKJH7ED6mANWldCkMY8phWxaE6f2Bq3ElqRLG8KETpqDmdHjlO3uAow/640?wx_fmt=png"><figcaption>image.png</figcaption></figure><p data-tool="mdnice编辑器">接下来，我们将映射好的bulk转录组数据和pbmc3k参考数据集合并到一起进行展示</p><pre data-tool="mdnice编辑器"><span></span><code>pbmc.mix &lt;- merge(pbmc3k, psudo.so)<br><br>pbmc.mix[[<span>"umap"</span>]] &lt;- CreateDimReducObject(<br>  embeddings = rbind(pbmc3k[[<span>"umap"</span>]]@cell.embeddings,<br>                     psudo.so[[<span>"umap"</span>]]@cell.embeddings),<br>  assay = <span>"RNA"</span>, key = <span>"UMAP_"</span>)<br><br>DimPlot(pbmc.mix, label = T) + NoLegend()<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.8" data-src="https://mmbiz.qpic.cn/mmbiz_png/zN67RpvO3kZWpRdyicAHZ2cJgEeruB5Mqic6hmv71XFXtVbyZLKcEPPmBAEsNiccZmQibKYsia7UMTdA63z2AVKEHibg/640?wx_fmt=png" data-type="png" data-w="1000" src="https://mmbiz.qpic.cn/mmbiz_png/zN67RpvO3kZWpRdyicAHZ2cJgEeruB5Mqic6hmv71XFXtVbyZLKcEPPmBAEsNiccZmQibKYsia7UMTdA63z2AVKEHibg/640?wx_fmt=png"><figcaption>image.png</figcaption></figure><p data-tool="mdnice编辑器">可以看到，bulk转录数据与单细胞参考数据集的细胞类型可以很好的重叠在一起，虽然bulk转录组数据中的CD8 T细胞与单细胞数据中存在一定的偏差，但其他的细胞类型注释的很好。</p></section><p><span><strong><span>往期精彩</span></strong></span></p><p><br></p><table interlaced="disabled" width="677"><tbody><tr><td width="305" valign="top"><section data-mpa-template="t" data-from="yb-recommend-list"><section data-mpa-template="t" data-from="yb-recommend" data-recommend-article-type="normal" data-recomment-template-id="1" data-recommend-article-id="2247488516_1" data-recommend-article-time="1619830800" data-recommend-article-cover="http://mmbiz.qpic.cn/mmbiz_jpg/zN67RpvO3kb0oPywKj5ssX9wonFaBt7czmPAnXLnTczkqXGWPwcmQh3h1a4pRU2iaW6BjkevIcz3Zj1CqTaciapQ/0?wx_fmt=jpeg" data-recommend-article-title="R语言数据可视化绘图合集" data-recommend-article-content-url="http://mp.weixin.qq.com/s?__biz=MzUzNzYwOTM1NA==&amp;mid=2247488516&amp;idx=1&amp;sn=c15e31044918cab8533956d7ddcd293f&amp;chksm=fae501e1cd9288f7df43ba5d0e4082add3b57540b02c55826112d8fdae308df28a6148cf0fb8#rd"><a href="http://mp.weixin.qq.com/s?__biz=MzUzNzYwOTM1NA==&amp;mid=2247488516&amp;idx=1&amp;sn=c15e31044918cab8533956d7ddcd293f&amp;chksm=fae501e1cd9288f7df43ba5d0e4082add3b57540b02c55826112d8fdae308df28a6148cf0fb8&amp;scene=21#wechat_redirect" data-linktype="1" wah-hotarea="click"><section data-recommend-type="normal" data-recommend-tid="1" data-mid=""><section data-mid=""><section data-mid="">   <span data-positionback="static"><img data-ratio="0.42424242424242425" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/zN67RpvO3kb0oPywKj5ssX9wonFaBt7czmPAnXLnTczkqXGWPwcmQh3h1a4pRU2iaW6BjkevIcz3Zj1CqTaciapQ/640?wx_fmt=jpeg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" data-type="jpeg" data-w="891" src="https://mmbiz.qpic.cn/mmbiz_jpg/zN67RpvO3kb0oPywKj5ssX9wonFaBt7czmPAnXLnTczkqXGWPwcmQh3h1a4pRU2iaW6BjkevIcz3Zj1CqTaciapQ/640?wx_fmt=jpeg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"></span></section><section data-mid=""><p data-recommend-title="t" data-mid="">R语言数据可视化绘图合集</p></section></section></section></a></section></section><p><br></p></td><td width="329" valign="top"><section data-mpa-template="t" data-from="yb-recommend-list"><section data-mpa-template="t" data-from="yb-recommend" data-recommend-article-type="normal" data-recomment-template-id="1" data-recommend-article-id="2247488516_2" data-recommend-article-time="1619830800" data-recommend-article-cover="http://mmbiz.qpic.cn/mmbiz_jpg/zN67RpvO3kYyR3nRxd8ibuicE7IBAGYibTEDupP52DicNZumTUlF4LjMgqcQ8HO5vWSyMtvdl1DX8FLlFKIlN1fIwA/0?wx_fmt=jpeg" data-recommend-article-title="ggpubr包系列绘图教程合集" data-recommend-article-content-url="http://mp.weixin.qq.com/s?__biz=MzUzNzYwOTM1NA==&amp;mid=2247488516&amp;idx=2&amp;sn=0681d1d46c7d1206553f22f269606bf6&amp;chksm=fae501e1cd9288f7c90e095e22896bdc79fdb9f171a422431b300acfbf3f4d0b911a45be1e0e#rd"><a href="http://mp.weixin.qq.com/s?__biz=MzUzNzYwOTM1NA==&amp;mid=2247488516&amp;idx=2&amp;sn=0681d1d46c7d1206553f22f269606bf6&amp;chksm=fae501e1cd9288f7c90e095e22896bdc79fdb9f171a422431b300acfbf3f4d0b911a45be1e0e&amp;scene=21#wechat_redirect" data-linktype="1" wah-hotarea="click"><section data-recommend-type="normal" data-recommend-tid="1" data-mid=""><section data-mid=""><section data-mid=""><span data-positionback="static"><img data-ratio="0.425" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/zN67RpvO3kYyR3nRxd8ibuicE7IBAGYibTEDupP52DicNZumTUlF4LjMgqcQ8HO5vWSyMtvdl1DX8FLlFKIlN1fIwA/640?wx_fmt=jpeg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" data-type="jpeg" data-w="1280" src="https://mmbiz.qpic.cn/mmbiz_jpg/zN67RpvO3kYyR3nRxd8ibuicE7IBAGYibTEDupP52DicNZumTUlF4LjMgqcQ8HO5vWSyMtvdl1DX8FLlFKIlN1fIwA/640?wx_fmt=jpeg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"></span></section><section data-mid=""><p data-recommend-title="t" data-mid="">ggpubr包系列绘图教程合集</p></section></section></section></a></section></section><p><br></p></td></tr><tr><td width="305" valign="top"><section data-mpa-template="t" data-from="yb-recommend-list"><section data-mpa-template="t" data-from="yb-recommend" data-recommend-article-type="normal" data-recomment-template-id="1" data-recommend-article-id="2247487655_2" data-recommend-article-time="1618362000" data-recommend-article-cover="http://mmbiz.qpic.cn/mmbiz_jpg/zN67RpvO3kbHdjxSiceia8kDo2iaUQeAcFX0WXUrUOyFvLbsqRxJFYES4JOjrSia4rs0uzae8oiau9tYPDF0zaC3H3Q/0?wx_fmt=jpeg" data-recommend-article-title="单细胞组学系列学习笔记" data-recommend-article-content-url="http://mp.weixin.qq.com/s?__biz=MzUzNzYwOTM1NA==&amp;mid=2247487655&amp;idx=2&amp;sn=f066151ca2149d18db32efbcbe34da44&amp;chksm=fae50542cd928c5481bf302bf6417e00750f42ff5fb8482921a4dc86848449e389d2bdea0c5b#rd"><a href="http://mp.weixin.qq.com/s?__biz=MzUzNzYwOTM1NA==&amp;mid=2247487655&amp;idx=2&amp;sn=f066151ca2149d18db32efbcbe34da44&amp;chksm=fae50542cd928c5481bf302bf6417e00750f42ff5fb8482921a4dc86848449e389d2bdea0c5b&amp;scene=21#wechat_redirect" data-linktype="1" wah-hotarea="click"><section data-recommend-type="normal" data-recommend-tid="1" data-mid=""><section data-mid=""><section data-mid=""><span data-positionback="static"><img data-ratio="0.4274099883855981" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/zN67RpvO3kbHdjxSiceia8kDo2iaUQeAcFX0WXUrUOyFvLbsqRxJFYES4JOjrSia4rs0uzae8oiau9tYPDF0zaC3H3Q/640?wx_fmt=jpeg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" data-type="jpeg" data-w="861" src="https://mmbiz.qpic.cn/mmbiz_jpg/zN67RpvO3kbHdjxSiceia8kDo2iaUQeAcFX0WXUrUOyFvLbsqRxJFYES4JOjrSia4rs0uzae8oiau9tYPDF0zaC3H3Q/640?wx_fmt=jpeg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"></span></section><section data-mid=""><p data-recommend-title="t" data-mid="">单细胞组学系列学习笔记</p></section></section></section></a></section></section><p><br></p></td><td width="329" valign="top"><section data-mpa-template="t" data-from="yb-recommend-list"><section data-mpa-template="t" data-from="yb-recommend" data-recommend-article-type="normal" data-recomment-template-id="1" data-recommend-article-id="2247487618_1" data-recommend-article-time="1618102800" data-recommend-article-cover="http://mmbiz.qpic.cn/mmbiz_jpg/zN67RpvO3kbLib5Pib7WHiao7rA2AB5vvYj1WfOQgOvyyfe78xiaUUlfzOPpRggpqXchZgtKeQib223wpw4cicFb5HcA/0?wx_fmt=jpeg" data-recommend-article-title="NBIS系列单细胞转录组数据分析实战汇总" data-recommend-article-content-url="http://mp.weixin.qq.com/s?__biz=MzUzNzYwOTM1NA==&amp;mid=2247487618&amp;idx=1&amp;sn=edb715d2d6c899ba778944d1c385dc05&amp;chksm=fae50567cd928c71db88b48cc4a32975cae2aa05d53a523d942de772d97fb7b6c52042362784#rd"><a href="http://mp.weixin.qq.com/s?__biz=MzUzNzYwOTM1NA==&amp;mid=2247487618&amp;idx=1&amp;sn=edb715d2d6c899ba778944d1c385dc05&amp;chksm=fae50567cd928c71db88b48cc4a32975cae2aa05d53a523d942de772d97fb7b6c52042362784&amp;scene=21#wechat_redirect" data-linktype="1" wah-hotarea="click"><section data-recommend-type="normal" data-recommend-tid="1" data-mid=""><section data-mid=""><section data-mid=""><span data-positionback="static"><img data-ratio="0.4258064516129032" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/zN67RpvO3kbLib5Pib7WHiao7rA2AB5vvYj1WfOQgOvyyfe78xiaUUlfzOPpRggpqXchZgtKeQib223wpw4cicFb5HcA/640?wx_fmt=jpeg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" data-type="jpeg" data-w="1240" src="https://mmbiz.qpic.cn/mmbiz_jpg/zN67RpvO3kbLib5Pib7WHiao7rA2AB5vvYj1WfOQgOvyyfe78xiaUUlfzOPpRggpqXchZgtKeQib223wpw4cicFb5HcA/640?wx_fmt=jpeg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"></span></section><section data-mid=""><p data-recommend-title="t" data-mid="">NBIS系列单细胞转录组数据分析实战汇总</p></section></section></section></a></section></section><p><br></p></td></tr><tr><td width="305" valign="top"><section data-mpa-template="t" data-from="yb-recommend-list"><section data-mpa-template="t" data-from="yb-recommend" data-recommend-article-type="normal" data-recomment-template-id="1" data-recommend-article-id="2247487655_1" data-recommend-article-time="1618362000" data-recommend-article-cover="http://mmbiz.qpic.cn/mmbiz_jpg/zN67RpvO3kZDcPibIC5qgyHRzrclxrnrN1pjtRBOXsrpQrY6lg6U6IXVSldVopD8JKUrWPibrcp8ohjia0cf50gGA/0?wx_fmt=jpeg" data-recommend-article-title="单细胞ATAC-seq系列学习笔记汇总" data-recommend-article-content-url="http://mp.weixin.qq.com/s?__biz=MzUzNzYwOTM1NA==&amp;mid=2247487655&amp;idx=1&amp;sn=e801738ea8983e2e805bcfe53a7cba37&amp;chksm=fae50542cd928c547f7337ff6cf56e1d977b7070f9822a42be9e4d2ec9866392ad5e415e901e#rd"><a href="http://mp.weixin.qq.com/s?__biz=MzUzNzYwOTM1NA==&amp;mid=2247487655&amp;idx=1&amp;sn=e801738ea8983e2e805bcfe53a7cba37&amp;chksm=fae50542cd928c547f7337ff6cf56e1d977b7070f9822a42be9e4d2ec9866392ad5e415e901e&amp;scene=21#wechat_redirect" data-linktype="1" wah-hotarea="click"><section data-recommend-type="normal" data-recommend-tid="1" data-mid=""><section data-mid=""><section data-mid=""><span data-positionback="static"><img data-ratio="0.42463235294117646" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/zN67RpvO3kZDcPibIC5qgyHRzrclxrnrN1pjtRBOXsrpQrY6lg6U6IXVSldVopD8JKUrWPibrcp8ohjia0cf50gGA/640?wx_fmt=jpeg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" data-type="jpeg" data-w="544" src="https://mmbiz.qpic.cn/mmbiz_jpg/zN67RpvO3kZDcPibIC5qgyHRzrclxrnrN1pjtRBOXsrpQrY6lg6U6IXVSldVopD8JKUrWPibrcp8ohjia0cf50gGA/640?wx_fmt=jpeg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"></span></section><section data-mid=""><p data-recommend-title="t" data-mid="">单细胞ATAC-seq系列学习笔记汇总</p></section></section></section></a></section></section><p><br></p></td><td width="329" valign="top"><section data-mpa-template="t" data-from="yb-recommend-list"><section data-mpa-template="t" data-from="yb-recommend" data-recommend-article-type="normal" data-recomment-template-id="1" data-recommend-article-id="2247484741_1" data-recommend-article-time="1590370821" data-recommend-article-cover="http://mmbiz.qpic.cn/mmbiz_jpg/zN67RpvO3kYF6ZuHSNCCibBbZZX3MP2Y4bKibHGcDwT0Udtl7RzdHriaWSjTk21lpG4GyURgr9iceSdabBf7TLIlYA/0?wx_fmt=jpeg" data-recommend-article-title="单细胞转录组细胞类型注释分析合集" data-recommend-article-content-url="http://mp.weixin.qq.com/s?__biz=MzUzNzYwOTM1NA==&amp;mid=2247484741&amp;idx=1&amp;sn=9af890d2818364585e875ea6db40bcf5&amp;chksm=fae510a0cd9299b6ee8102d9a5b02a79de2ee1f7428df13820a09f7204c13d46a25d7bdb0cc2#rd"><a href="http://mp.weixin.qq.com/s?__biz=MzUzNzYwOTM1NA==&amp;mid=2247484741&amp;idx=1&amp;sn=9af890d2818364585e875ea6db40bcf5&amp;chksm=fae510a0cd9299b6ee8102d9a5b02a79de2ee1f7428df13820a09f7204c13d46a25d7bdb0cc2&amp;scene=21#wechat_redirect" data-linktype="1" wah-hotarea="click"><section data-recommend-type="normal" data-recommend-tid="1" data-mid=""><section data-mid=""><section data-mid=""><span data-positionback="static"><img data-ratio="0.42526071842410196" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/zN67RpvO3kYF6ZuHSNCCibBbZZX3MP2Y4bKibHGcDwT0Udtl7RzdHriaWSjTk21lpG4GyURgr9iceSdabBf7TLIlYA/640?wx_fmt=jpeg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" data-type="jpeg" data-w="863" src="https://mmbiz.qpic.cn/mmbiz_jpg/zN67RpvO3kYF6ZuHSNCCibBbZZX3MP2Y4bKibHGcDwT0Udtl7RzdHriaWSjTk21lpG4GyURgr9iceSdabBf7TLIlYA/640?wx_fmt=jpeg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"></span></section><section data-mid=""><p data-recommend-title="t" data-mid="">单细胞转录组细胞类型注释分析合集</p></section></section></section></a></section></section><p><br></p></td></tr></tbody></table><hr><p><br></p><section><section data-support="96编辑器" data-style-id="26447"><section><section><p><img data-ratio="0.3013698630136986" data-type="png" data-w="73" data-src="https://mmbiz.qpic.cn/mmbiz_png/Ljib4So7yuWhfCqNHudKzrzLa7N6AHjuj6I6JpVhXoRib49RZUbb6RFNyg3hPqx0lWTIUmxsFKic7jyXqtHFJdTjQ/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" src="https://mmbiz.qpic.cn/mmbiz_png/Ljib4So7yuWhfCqNHudKzrzLa7N6AHjuj6I6JpVhXoRib49RZUbb6RFNyg3hPqx0lWTIUmxsFKic7jyXqtHFJdTjQ/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"></p><section><section><p><span>END</span></p></section></section></section><section><section data-width="100%"><br></section></section></section></section><section><p><img data-ratio="0.18450184501845018" data-src="https://mmbiz.qpic.cn/mmbiz_gif/Ljib4So7yuWjxeI3XgRP3wgibhKUDTa1f0BdT8o4KqgJkoXRN06qzUTkX3L4f2Aib70QwMVQrXwibK5maqSMjKn2cg/640?wx_fmt=gif&amp;wxfrom=5&amp;wx_lazy=1" data-type="gif" data-w="1084" src="https://mmbiz.qpic.cn/mmbiz_gif/Ljib4So7yuWjxeI3XgRP3wgibhKUDTa1f0BdT8o4KqgJkoXRN06qzUTkX3L4f2Aib70QwMVQrXwibK5maqSMjKn2cg/640?wx_fmt=gif&amp;wxfrom=5&amp;wx_lazy=1"></p></section><section><section><section><img data-ratio="0.4807692307692308" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/Ljib4So7yuWh8iaqgpukRp5PIl9Ry3420ia2Y7wtDicl9jsomQfyHMQV6NLnhFUsxSFkyrU5fJNTicGLkggYjODFE3g/640?wx_fmt=jpeg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" data-type="jpeg" data-w="260" data-width="100%" src="https://mmbiz.qpic.cn/mmbiz_jpg/Ljib4So7yuWh8iaqgpukRp5PIl9Ry3420ia2Y7wtDicl9jsomQfyHMQV6NLnhFUsxSFkyrU5fJNTicGLkggYjODFE3g/640?wx_fmt=jpeg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"></section><section><section><img data-ratio="1" data-src="https://mmbiz.qpic.cn/mmbiz_png/zN67RpvO3kaEicGflVWvBy3yRYiaib3OZK23x7fWOgyIM3ZGibbR1EOypU9V8QMZLoaD87dxq7qBeaAjG1CvicjAZ3g/640?wx_fmt=jpeg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" data-type="jpeg" data-w="500" data-width="100%" src="https://mmbiz.qpic.cn/mmbiz_png/zN67RpvO3kaEicGflVWvBy3yRYiaib3OZK23x7fWOgyIM3ZGibbR1EOypU9V8QMZLoaD87dxq7qBeaAjG1CvicjAZ3g/640?wx_fmt=jpeg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"></section></section></section></section><p><br></p><section><section><section><section>▼</section><section>更多精彩推荐，请关注我们</section><section>▼</section></section></section><section><section><section><section><img data-ratio="0.7892156862745098" data-src="https://mmbiz.qpic.cn/mmbiz_png/Ljib4So7yuWgu59cF8IicIGFoyibHSjIGianb6juia3uErwqHfibPGIwxKSdoDVMYH5WbicbfkQy0bPVb1G59VnBDKic5g/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" data-type="png" data-w="204" data-width="100%" src="https://mmbiz.qpic.cn/mmbiz_png/Ljib4So7yuWgu59cF8IicIGFoyibHSjIGianb6juia3uErwqHfibPGIwxKSdoDVMYH5WbicbfkQy0bPVb1G59VnBDKic5g/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"></section><section><section>把时间交给阅读</section></section><section><img data-ratio="1.3" data-src="https://mmbiz.qpic.cn/mmbiz_png/zN67RpvO3kaEicGflVWvBy3yRYiaib3OZK2PUmTjUla50yMwEzVrajwwhcpmc5fUYCu1XTBLu8nay0ib9OLDeXQ5hA/640?wx_fmt=jpeg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" data-type="jpeg" data-w="500" data-width="100%" src="https://mmbiz.qpic.cn/mmbiz_png/zN67RpvO3kaEicGflVWvBy3yRYiaib3OZK2PUmTjUla50yMwEzVrajwwhcpmc5fUYCu1XTBLu8nay0ib9OLDeXQ5hA/640?wx_fmt=jpeg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"></section></section></section></section></section></section><section data-support="96编辑器" data-style-id="25142"><section><section><section><img data-ratio="0.7619047619047619" data-src="https://mmbiz.qpic.cn/mmbiz_gif/Ljib4So7yuWhFTIP7DCMLPwWh8Yhjs079f1vMqlYdExqbWaZVJyiawKkr21EDSNW740b4yMzkeHxFJULTpZGzYwQ/640?wx_fmt=gif&amp;wxfrom=5&amp;wx_lazy=1" data-type="gif" data-w="84" data-width="80%" src="https://mmbiz.qpic.cn/mmbiz_gif/Ljib4So7yuWhFTIP7DCMLPwWh8Yhjs079f1vMqlYdExqbWaZVJyiawKkr21EDSNW740b4yMzkeHxFJULTpZGzYwQ/640?wx_fmt=gif&amp;wxfrom=5&amp;wx_lazy=1"></section><section><span>您点的每个赞，我都认真当成了喜欢</span></section></section></section></section></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/TgKx0XDB62nvbtG6hwU0xg",target="_blank" rel="noopener noreferrer">原文链接</a>
