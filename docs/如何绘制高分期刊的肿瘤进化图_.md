---
title: "如何绘制高分期刊的肿瘤进化图？"
date: 2022-10-30T03:02:08Z
draft: ["false"]
tags: [
  "fetched",
  "SCIPainter"
]
categories: ["Acdemic"]
---
如何绘制高分期刊的肿瘤进化图？ by SCIPainter
------
<div><p data-mpa-powered-by="yiban.io"><span><strong><span>肿瘤进化/演变图</span></strong></span><span>，属于堆叠面积图的一种，水平轴用于展示演变时间，颜色形状表示基因型（或其它亚型），垂直轴高度对应于相应时间点的基因型频率（或相对丰度），后代的基因型显示从分支中出现，如下面这个案例：</span></p><p><span><br></span></p><p><img data-ratio="1.1227701993704093" data-type="png" data-w="953" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mH9iac56znhu6EkicWojqHMaFMpLsWsgTxGCnoWWs0mMAqd19Lq56Xsm7Lt7w7T5jA4sA6eCtsSeKg/640?wx_fmt=png" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mH9iac56znhu6EkicWojqHMaFMpLsWsgTxGCnoWWs0mMAqd19Lq56Xsm7Lt7w7T5jA4sA6eCtsSeKg/640?wx_fmt=png"></p><p><span>（<em>nature cancer</em>，2021）</span></p><p><br></p><p><span>该图显示了两个分组（对照组d，治疗组e）小鼠随时间的肿瘤演变。展示了三个时间点的克隆组成：（1）原发性诊断性白血病；（2）异种移植第0天(骨髓抽吸)；（3）异种移植第28天(骨髓全部收获)。</span></p><p><span><br></span></p><p><span>那么这类图表如何绘制？可以尝试下</span><span>ggmuller</span><span>这个R包。核心函数</span><span>get_Muller_df（）</span><span>会构造一个特殊排序的数据帧，从而辅助我们快速绘图。</span></p><p><br></p><p><span>需要将自己的数据整理为</span><strong><span>两个数据框</span><span>：</span></strong></p><p><span>1. 定义系统发育的邻接矩阵（长数据，列名固定为“Parent”和“Identity”）；</span></p><p><span>2. 不同基因型频率随时间推移变化数据框（长数据，列名固定为"Generation"、"Identity"、"Population" 和"Fitness"）。</span></p><p><br mpa-from-tpl="t"></p><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><p><span>#相关R包下载与载入：</span><br mpa-from-tpl="t"><span>install</span>.packages('ggmuller')<br mpa-from-tpl="t"><span>library</span>(ggmuller)<br mpa-from-tpl="t"><span>library</span>(ggplot2)<br mpa-from-tpl="t"><span>library</span>(cols4all)<br mpa-from-tpl="t"><span>#测试数据创建：</span><br mpa-from-tpl="t"><span>#1.创建邻接矩阵：</span><br mpa-from-tpl="t"><span>#分支型系统发育，clone_A产生clone_B和clone_C，然后clone_B产生clone_D和clone_E，依此类推；</span><br mpa-from-tpl="t"><span>edges</span> &lt;- data.frame(Parent = paste0(<span>"clone_"</span>, LETTERS[c(rep(1:3, each = 2), 2, 5)]),<br mpa-from-tpl="t"><span>Identity</span> = paste0(<span>"clone_"</span>, LETTERS[2:9]))<br mpa-from-tpl="t"><span>head</span>(edges)</p></pre></section><p><img data-ratio="0.3152909336941813" data-type="png" data-w="739" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mH9iac56znhu6EkicWojqHMaq8C3sYOPpG23MOLQW6fl4jibqZalZywGjdbaSFo01EIMqVibaztNX3SQ/640?wx_fmt=png" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mH9iac56znhu6EkicWojqHMaq8C3sYOPpG23MOLQW6fl4jibqZalZywGjdbaSFo01EIMqVibaztNX3SQ/640?wx_fmt=png"></p><p><br mpa-from-tpl="t"></p><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><p><span>#2.构建基因型群体随时间变化的数据框:</span><br mpa-from-tpl="t"><span>pop_seq</span> &lt;- function(gens, lambda, start_gen) c(rep(0, start_gen),<br mpa-from-tpl="t"><span>exp</span>(lambda * gens[0:(length(gens) - start_gen)]))<br mpa-from-tpl="t"><span>lambda</span> &lt;- 0.1<br mpa-from-tpl="t"><span>gens</span> &lt;- 0:150 <span>#时间点</span><br mpa-from-tpl="t"><span>fitnesses</span> &lt;- c(1, 2, 2.2, 2.5, 3, 3.2, 3.5, 3.5, 3.8)<br mpa-from-tpl="t"><span>pop</span> &lt;- data.frame(Generation = rep(gens, 9),<br mpa-from-tpl="t"><span>Identity</span> = paste0(<span>"clone_"</span>, LETTERS[rep(1:9, each = length(gens))]),<br mpa-from-tpl="t"><span>Population</span> = c(1E2 * pop_seq(gens, fitnesses[1]*lambda, 0),<br mpa-from-tpl="t"><span>pop_seq</span>(gens, fitnesses[2]*lambda, 0),<br mpa-from-tpl="t"><span>pop_seq</span>(gens, fitnesses[3]*lambda, 10),<br mpa-from-tpl="t"><span>pop_seq</span>(gens, fitnesses[4]*lambda, 20),<br mpa-from-tpl="t"><span>pop_seq</span>(gens, fitnesses[5]*lambda, 30),<br mpa-from-tpl="t"><span>pop_seq</span>(gens, fitnesses[6]*lambda, 40),<br mpa-from-tpl="t"><span>pop_seq</span>(gens, fitnesses[7]*lambda, 50),<br mpa-from-tpl="t"><span>pop_seq</span>(gens, fitnesses[8]*lambda, 50),<br mpa-from-tpl="t"><span>pop_seq</span>(gens, fitnesses[9]*lambda, 60)),<br mpa-from-tpl="t"><span>Fitness</span> = rep(fitnesses, each = length(gens)))<br mpa-from-tpl="t"><span>head</span>(pop)</p></pre></section><p><img data-ratio="0.3152909336941813" data-type="png" data-w="739" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mH9iac56znhu6EkicWojqHMap6AGe8g9wXeZXwmzu7jhTt5sCJT3WAl8IvSkzQMscN1D8s0GaTYOUg/640?wx_fmt=png" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mH9iac56znhu6EkicWojqHMap6AGe8g9wXeZXwmzu7jhTt5sCJT3WAl8IvSkzQMscN1D8s0GaTYOUg/640?wx_fmt=png"></p><p><br mpa-from-tpl="t"></p><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><p><span>#3.get_Muller_df()合并数据：</span><br mpa-from-tpl="t"><span>Muller_df</span> &lt;- get_Muller_df(edges, pop)<br mpa-from-tpl="t"><span>head</span>(Muller_df) <span>#如果是自身数据，按照标准格式整理(列名固定)，最后用get_Muller_df合并即可</span></p></pre></section><p><img data-ratio="0.21836925960637302" data-type="png" data-w="1067" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mH9iac56znhu6EkicWojqHMaoQknLjM73FBAFwtRaiaS6VD37veJZVkpf835MC4mzibqAke1XSiagPJwQ/640?wx_fmt=png" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mH9iac56znhu6EkicWojqHMaoQknLjM73FBAFwtRaiaS6VD37veJZVkpf835MC4mzibqAke1XSiagPJwQ/640?wx_fmt=png"></p><p><br mpa-from-tpl="t"></p><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><p><span>#创建离散型色板备用：</span><br mpa-from-tpl="t"><span>mycol1</span> &lt;- c4a(<span>"muted"</span>, 9)<br mpa-from-tpl="t"><span>mycol2</span> &lt;- c4a(<span>"paired"</span>, 9)<br mpa-from-tpl="t"><span>mycol3</span> &lt;- c4a(<span>"set3"</span>, 9)<br mpa-from-tpl="t"><span>#4.肿瘤进化图绘制：</span><br mpa-from-tpl="t"><span>#默认按基因型着色：</span><br mpa-from-tpl="t"><span>p</span> &lt;- Muller_plot(Muller_df, add_legend = TRUE,<br mpa-from-tpl="t"><span>xlab</span> = <span>"Time"</span>, ylab = <span>"Proportion"</span>,<br mpa-from-tpl="t"><span>palette</span> = mycol2) +<br mpa-from-tpl="t"><span>theme_classic</span>()<br mpa-from-tpl="t"><span>p</span></p></pre></section><p><img data-ratio="0.6430260047281324" data-type="png" data-w="1269" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mH9iac56znhu6EkicWojqHMaXRLpruV3vjhCh2rQlZZpAhKl1kHJDa2pfR29vQSgUAjtMic3cibndqrQ/640?wx_fmt=png" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mH9iac56znhu6EkicWojqHMaXRLpruV3vjhCh2rQlZZpAhKl1kHJDa2pfR29vQSgUAjtMic3cibndqrQ/640?wx_fmt=png"></p><p><br mpa-from-tpl="t"></p><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><p><span>#也可以选择按照Fitness着色：</span><br mpa-from-tpl="t"><span>p1</span> &lt;- Muller_plot(Muller_df, add_legend = TRUE,<br mpa-from-tpl="t"><span>xlab</span> = <span>"Time"</span>, ylab = <span>"Proportion"</span>,<br mpa-from-tpl="t"><span>colour_by</span> = <span>"Fitness"</span>) +<br mpa-from-tpl="t"><span>theme_classic</span>()<br mpa-from-tpl="t"><span>p1</span></p></pre></section><p><img data-ratio="0.6430260047281324" data-type="png" data-w="1269" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mH9iac56znhu6EkicWojqHMaichFKiaianpIkcrP2sF7icUq20ciaEInApfQ6Y4CygJhnSfbSIuR7ZcCwPA/640?wx_fmt=png" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mH9iac56znhu6EkicWojqHMaichFKiaianpIkcrP2sF7icUq20ciaEInApfQ6Y4CygJhnSfbSIuR7ZcCwPA/640?wx_fmt=png"></p><p><br mpa-from-tpl="t"></p><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><p><span>#还可设置cutoff排除稀有性：</span><br mpa-from-tpl="t"><span>Muller_df_censored</span> &lt;- get_Muller_df(edges, pop, cutoff = 0.2)<br mpa-from-tpl="t"><span>p2</span> &lt;- Muller_plot(Muller_df_censored, add_legend = TRUE,<br mpa-from-tpl="t"><span>xlab</span> = <span>"Time"</span>, ylab = <span>"Proportion"</span>,<br mpa-from-tpl="t"><span>palette</span> = mycol1) +<br mpa-from-tpl="t"><span>theme_classic</span>()<br mpa-from-tpl="t"><span>p2</span><span></span></p></pre></section><p><img data-ratio="0.6430260047281324" data-type="png" data-w="1269" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mH9iac56znhu6EkicWojqHMaIrDLgwaxZO8EJIPWsfENwIq9SqNciautz4SL0JDcrzHZibCiaoJEw8bNw/640?wx_fmt=png" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mH9iac56znhu6EkicWojqHMaIrDLgwaxZO8EJIPWsfENwIq9SqNciautz4SL0JDcrzHZibCiaoJEw8bNw/640?wx_fmt=png"></p><p><br></p><p><span>关于这个R包更多的说明、范例以及使用方法，可以参考文末的官方资料。今天的分享就到这里！</span></p><p><span><br></span></p><section data-role="paragraph"><section><section hm_fix="368:481"><section><img data-ratio="0.8181818181818182" data-type="png" data-w="44" data-width="100%" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mH9iac56znhu6EkicWojqHMafQ0brrhKPgA8Gnrjft1IzksDOOBxNALHftntjqJJ0vOu1griaZHZAxQ/640?wx_fmt=png" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mH9iac56znhu6EkicWojqHMafQ0brrhKPgA8Gnrjft1IzksDOOBxNALHftntjqJJ0vOu1griaZHZAxQ/640?wx_fmt=png"></section><section><section data-brushtype="text"><strong><span>参考资料</span></strong></section><section data-width="100%"><br></section></section></section></section></section><p><span>https://cran.r-project.org/web/packages/ggmuller/vignettes/ggmuller.html</span></p><p><br></p><section data-role="paragraph"><section><section hm_fix="368:481"><section><img data-ratio="0.8181818181818182" data-type="png" data-w="44" data-width="100%" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mH9iac56znhu6EkicWojqHMafQ0brrhKPgA8Gnrjft1IzksDOOBxNALHftntjqJJ0vOu1griaZHZAxQ/640?wx_fmt=png" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mH9iac56znhu6EkicWojqHMafQ0brrhKPgA8Gnrjft1IzksDOOBxNALHftntjqJJ0vOu1griaZHZAxQ/640?wx_fmt=png"></section><section><section data-brushtype="text"><strong><span>参考文献</span></strong></section><section data-width="100%"><br></section></section></section></section></section><p><span>Turati V A, Guerra-Assunção J A, Potter N E, et al. Chemotherapy induces canalization of cell state in childhood B-cell precursor acute lymphoblastic leukemia[J]. Nature Cancer, 2021, 2(8): 835-852.</span></p><section><span><br></span></section><section><span><strong><span>*未经许可，不得以任何方式复制或抄袭本篇文章之部分或全部内容。版权所有，侵权必究。</span></strong></span></section><section><br></section><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><svg viewbox="0 0 1 1"></svg></section></section></section><section><section powered-by="xiumi.us"><section><svg viewbox="0 0 1 1"></svg></section></section></section><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><svg viewbox="0 0 1 1"></svg></section></section><section powered-by="xiumi.us"><section><svg viewbox="0 0 1 1"></svg></section></section><section powered-by="xiumi.us"><section><svg viewbox="0 0 1 1"></svg></section></section></section></section></section><section><section powered-by="xiumi.us"><section><svg viewbox="0 0 1 1"></svg></section></section></section><section><section powered-by="xiumi.us"><section><svg viewbox="0 0 1 1"></svg></section></section></section></section></section><section><br></section><section><span>SCIPainter，是由广州基迪奥生物运营的绘图公号。如果你想了解</span><span><strong><span>组学前沿技术</span></strong></span><span>、</span><span><strong><span>精彩组学文章解读</span></strong></span><span>、</span><strong><span>测序项目问题咨询</span></strong><span>等等，可以关注<strong>基迪奥官方账号</strong>。我们的愿望是，基迪奥助您达到更高的科研领域。</span></section><section><mp-common-profile data-pluginname="mpprofile" data-id="MzA5NzQzOTgzMw==" data-headimg="http://mmbiz.qpic.cn/mmbiz_png/6kvRq2WRXpiadbSLFQicLXEWj2GOlicE5ib53jkfcjIxv63JnP68reVXewhA5Ay8YglUjot7zV2NAdvDU2SfjH1Mwg/0?wx_fmt=png" data-nickname="基迪奥生物" data-alias="gene-denovo" data-signature="广州基迪奥生物官方公众号，小奥每天分享前沿组学知识、实用生信软件技巧、酷炫绘图技能。我们的目标是，助您达到更高的科研领域。" data-from="0"></mp-common-profile></section><section><span></span></section><p><span><br></span></p><section data-role="outer" label="Powered by 135editor.com"><section data-tools="135编辑器" data-id="105648"><section><section data-role="outer" label="Powered by 135editor.com"><section data-role="paragraph"><section data-role="outer" label="Powered by 135editor.com"><section data-tools="135编辑器" data-id="105648"><section><section><img data-ratio="0.8928571428571429" data-type="png" data-w="41" data-width="100%" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6kCKJYcEqEIfoJYG621mPJE8VibmibGU0Jxic9iabARVRH0FT6BNE8VAglWFXBPibFAU7a6tWGibSs8wyUg/640?wx_fmt=png" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6kCKJYcEqEIfoJYG621mPJE8VibmibGU0Jxic9iabARVRH0FT6BNE8VAglWFXBPibFAU7a6tWGibSs8wyUg/640?wx_fmt=png"></section><section><section><section data-width="35%"><section><section data-width="100%"><img data-ratio="1" data-type="jpeg" data-w="860" data-width="100%" title="SCIPainter 30cm二维码.jpg" data-src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/tgUVxVRjT6kCKJYcEqEIfoJYG621mPJEv5etCBwHicqbEPwnVrkpaasxqaVibM4mT2JdIuN6yTlYWDD4mL5A427A/640?wx_fmt=jpeg" src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/tgUVxVRjT6kCKJYcEqEIfoJYG621mPJEv5etCBwHicqbEPwnVrkpaasxqaVibM4mT2JdIuN6yTlYWDD4mL5A427A/640?wx_fmt=jpeg"></section></section></section><section data-width="50%"><section><section data-brushtype="text"><strong># SCIPainter</strong></section><section data-brushtype="text" hm_fix="361:593"><p>基迪奥旗下绘图公众号</p><p>分享科研绘图技能与工具</p><p>欢迎关注与转发~</p></section></section></section></section></section></section></section></section></section></section><section><br></section></section></section><section data-role="paragraph"><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><img data-ratio="1" data-type="gif" data-w="400" data-src="https://mmbiz.qpic.cn/sz_mmbiz_gif/tgUVxVRjT6kCKJYcEqEIfoJYG621mPJEgMd0aMPtmrDjiaX8sBhfhicVteeHf1JicexSpUbS3fdS9SiboUVN7guaPw/640?wx_fmt=gif" src="https://mmbiz.qpic.cn/sz_mmbiz_gif/tgUVxVRjT6kCKJYcEqEIfoJYG621mPJEgMd0aMPtmrDjiaX8sBhfhicVteeHf1JicexSpUbS3fdS9SiboUVN7guaPw/640?wx_fmt=gif"></section></section></section><section><section powered-by="xiumi.us"><section><p><span><strong>你的好友拍了拍你</strong></span></p><p><span><strong>并请你帮她点一下</strong></span><span><strong><span>“分享”</span></strong></span><span><strong><span>~</span></strong></span></p></section></section></section></section></section><p><br></p></section></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/ts8mMMll36-LxHxDfbdWRg",target="_blank" rel="noopener noreferrer">原文链接</a>
