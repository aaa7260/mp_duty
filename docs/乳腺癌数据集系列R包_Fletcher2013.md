---
title: "乳腺癌数据集系列R包：Fletcher2013"
date: 2022-10-11T04:52:04Z
draft: ["false"]
tags: [
  "fetched",
  "生信菜鸟团"
]
categories: ["Acdemic"]
---
乳腺癌数据集系列R包：Fletcher2013 by 生信菜鸟团
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><p data-tool="mdnice编辑器">芯片数据集是一片广袤的海洋，大多数时候我们做数据挖掘，相当于大海捞针。于是一些学者合并同类项，将相同芯片平台或是类似设计的数据集进行了包装，开发成为new package，我们可以在这样的包里直接找到想要的数据集，分析的步骤也被大大简化。</p><p data-tool="mdnice编辑器">其实类似的包并不少，<span>Jimmy老师推荐过几个乳腺癌</span><span>的表达量数据集的包，都在生信菜鸟团的论坛里<span>(</span><span>bio-info-trainee.</span><span>com</span><span>)</span>。分别是【了解5个乳腺癌表达数据集|</span>你还缺乳腺癌表达量数据集吗？】后面又有同学推荐了这个【这里的乳腺癌表达量矩阵数据集更多】 ，做乳腺癌相关的同学可以去论坛找找看。</p><p data-tool="mdnice编辑器">今天推荐的Fletcher2013，也是乳腺癌数据集相关的包，一起来看看吧</p><p data-tool="mdnice编辑器">想不到吧，Fletcher2013是一个兄弟包，有a还有b，(●'◡'●)，先看看a吧~</p><blockquote data-tool="mdnice编辑器"><p><strong>Package</strong> ‘Fletcher2013a’</p><p><strong>Title</strong> Gene expression data from breast cancer cells under FGFR2 signalling perturbation 【 http://dx.doi.org/10.1038/ncomms3464】</p><p><strong>Version</strong> 1.32.0</p><p><strong>Author</strong> Mauro Castro, Michael Fletcher, Florian Markowetz and Kerstin Meyer.</p><p><strong>Description</strong> The package Fletcher2013a <em>contains time-course gene expression data from MCF7 cells treated under different experimental systems</em> in order to perturb FGFR2 signalling.</p></blockquote><p data-tool="mdnice编辑器">看描述，这个包把这篇文献自己的数据集包装进去了，可以作为内置数据直接使用</p><p data-tool="mdnice编辑器">好不好用呢，那还得上手试试看才晓得</p><h2 data-tool="mdnice编辑器"><span> </span><span></span><span>Fletcher2013a</span><span></span><span> </span></h2><h3 data-tool="mdnice编辑器"><span></span>安装包<span></span></h3><pre data-tool="mdnice编辑器"><span></span><code><span>##安装包</span><br>BiocManager::install(<span>"Fletcher2013a"</span>)<br>browseVignettes(<span>"Fletcher2013a"</span>)<span>##查看版本</span><br><span>library</span>(Fletcher2013a)<br><span>library</span>(GEOquery)<br></code></pre><h3 data-tool="mdnice编辑器"><span></span>实操<span></span></h3><p data-tool="mdnice编辑器">以Exp1为例，这是对它的描述⬇</p><blockquote data-tool="mdnice编辑器"><p>The data consists of 46 microarray samples from MCF-7 cells treated under <strong>different conditions, at 3 time points</strong> (0, 6 and 24 h).</p><p>The data have been normalized (RMA algorithm) and are presented in the form of an exprSet object.</p><p>The experiment was carried out on 4 Humanv4 arrays using 12 samples per array.</p><p>The original arrays contain 48324 features, with an average of 22 beads per feature (Standard Deviation of 5).</p></blockquote><pre data-tool="mdnice编辑器"><span></span><code><span># 以Exp1为例 ---------------------------------------</span><br>data(Exp1)<br>gexp&lt;-exprs(Exp1)<br>geneids&lt;-fData(Exp1)<br>targets&lt;-pData(Exp1)<br>mycontrasts&lt;-notes(Exp1)$contrasts<br></code></pre><p data-tool="mdnice编辑器">运行完以上的代码，你会发现表达量矩阵，分组信息，探针注释都已尽在掌握，就看你拿它们怎么办了</p><p data-tool="mdnice编辑器">具体的信息在官方的帮助文档里都有介绍，框起来的是组别信息：</p><figure data-tool="mdnice编辑器"><img data-ratio="0.5309973045822103" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Losibp2qedXpkxUib224X5FpKnETFT9Hen1bo70oqhuJIJd7SCMWmsqxeCBfuUSVgVicyxvdVdNHEJylQw/640?wx_fmt=png" data-type="png" data-w="742" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Losibp2qedXpkxUib224X5FpKnETFT9Hen1bo70oqhuJIJd7SCMWmsqxeCBfuUSVgVicyxvdVdNHEJylQw/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">但是如果加上不同时间序列的话，组别就会更多，那这个时候的多组别差异基因分析该如何可视化呢？</p><p data-tool="mdnice编辑器">我找到了这两篇帖子，兜兜转转还是生信技能树</p><blockquote data-tool="mdnice编辑器"><p>多分组的差异分析只需要合理设置design矩阵即可- https://cloud.tencent.com/developer/article/1853983</p><p>多次差异分析难道就需要多个火山图吗 -https://cloud.tencent.com/developer/article/1853989?from=article.detail.1853983</p></blockquote><h4 data-tool="mdnice编辑器"><span></span>构建desig矩阵<span></span></h4><pre data-tool="mdnice编辑器"><span></span><code><span>##这时我们已经获得了矩阵、探针注释和分组信息，应该是可以做差异分析</span><br><br><span>##构建desig矩阵</span><br>group_list&lt;-targets$Target<br><br>design=model.matrix(~factor( group_list ))<br>qw=gsub(<span>"\\(.*\\)"</span>,<span>""</span>,colnames(design)[<span>2</span>:ncol(design)])<br>qw1=gsub(<span>"factor"</span>,<span>""</span>,qw)<br>colnames(design)[<span>2</span>:ncol(design)]=qw1<br>head(design)<br><br></code></pre><h4 data-tool="mdnice编辑器"><span></span>差异分析结果可视化<span></span></h4><pre data-tool="mdnice编辑器"><span></span><code><span>#limma差异分析</span><br>glm = lmFit(gexp, design = design ) <br>glm = eBayes(glm)<br><br><br><span># 差异分析结果可视化 ---------------------------------</span><br><span>#参考：https://cloud.tencent.com/developer/article/1853989?from=article.detail.1853983</span><br>testResults &lt;- decideTests(glm, method=<span>"hierarchical"</span>,adjust.method=<span>"BH"</span>, p.value=<span>0.05</span>)[,-<span>1</span>]<br>significantGenes &lt;- sapply(<span>1</span>:ncol(testResults), <span>function</span>(j){<br>  c &lt;- glm$coefficients[testResults[,j]!=<span>0</span>,j+<span>1</span>]<br>  table(cut(c, breaks=c(-<span>2</span>,seq(-<span>1.5</span>,<span>1.5</span>,l=<span>7</span>),<span>2</span>)))<br>})<br>colnames(significantGenes) &lt;- colnames(testResults)<br><span># Barplot</span><br><span># author mg14 , https://rdrr.io/github/mg14/mg14/ </span><br>rotatedLabel &lt;- <span>function</span>(x0 = seq_along(labels), y0 = rep(par(<span>"usr"</span>)[<span>3</span>], length(labels)), labels, pos = <span>1</span>, cex=<span>1</span>, srt=<span>45</span>, <span>...</span>) {<br>  w &lt;- strwidth(labels, units=<span>"user"</span>, cex=cex)<br>  h &lt;- strheight(labels, units=<span>"user"</span>,cex=cex)<br>  u &lt;- par(<span>'usr'</span>)<br>  p &lt;- par(<span>'plt'</span>)<br>  f &lt;- par(<span>"fin"</span>)<br>  xpd &lt;- par(<span>"xpd"</span>)<br>  par(xpd=<span>NA</span>)<br>  text(x=x0 + ifelse(pos==<span>1</span>, -<span>1</span>,<span>1</span>) * w/<span>2</span>*cos(srt/<span>360</span>*<span>2</span>*base::pi), y = y0 + ifelse(pos==<span>1</span>, -<span>1</span>,<span>1</span>) * w/<span>2</span> *sin(srt/<span>360</span>*<span>2</span>*base::pi) * (u[<span>4</span>]-u[<span>3</span>])/(u[<span>2</span>]-u[<span>1</span>]) / (p[<span>4</span>]-p[<span>3</span>]) * (p[<span>2</span>]-p[<span>1</span>])* f[<span>1</span>]/f[<span>2</span>] , labels, las=<span>2</span>, cex=cex, pos=pos, adj=<span>1</span>, srt=srt,<span>...</span>)<br>  par(xpd=xpd)<br>}<br><br>par(bty=<span>"n"</span>, mgp = c(<span>2.5</span>,<span>.33</span>,<span>0</span>), mar=c(<span>3</span>,<span>3.3</span>,<span>2</span>,<span>0</span>)+<span>.1</span>, las=<span>2</span>, tcl=-<span>.25</span>)<br>b &lt;- barplot(significantGenes, las=<span>2</span>, ylab = <span>"Differentially expressed genes"</span>, <br>             col=brewer.pal(<span>8</span>,<span>"RdYlBu"</span>), <br>             legend.text=<span>TRUE</span>,args.legend = list(x = <span>"topright"</span>, cex=<span>0.5</span>,title=<span>"log2 FC"</span>),<br>             border=<span>0</span>, xaxt=<span>"n"</span>)<span>#, col = set1[simple.annot[names(n)]], border=NA)</span><br>print(b)<br>rotatedLabel(x0=b, y0=rep(<span>10</span>, ncol(significantGenes)),<br>             labels=colnames(significantGenes), cex=<span>.7</span>, srt=<span>45</span>, <br>             font=ifelse(grepl(<span>"[[:lower:]]"</span>, colnames(design))[-<span>1</span>], <span>1</span>,<span>3</span>) )<br><br>clip(<span>0</span>,<span>30</span>,<span>0</span>,<span>1000</span>)<br><span># text(b+0.2, colSums(n)+50, colSums(n), pos=3, cex=.7, srt=90)</span><br>x0 &lt;- <span>21.5</span><br>image(x=x0+c(<span>0</span>,<span>0.8</span>), y=par(<span>"usr"</span>)[<span>4</span>]+seq(-<span>100</span>,<span>100</span>,l=<span>9</span>), z=matrix(<span>1</span>:<span>8</span>, ncol=<span>8</span>), col=brewer.pal(<span>8</span>,<span>"RdYlBu"</span>), add=<span>TRUE</span>)<br>text(x=x0+<span>1.5</span>, y=par(<span>"usr"</span>)[<span>4</span>]+seq(-<span>50</span>,<span>50</span>,l=<span>3</span>), format(seq(-<span>1</span>,<span>1</span>,l=<span>3</span>),<span>2</span>), cex=<span>0.66</span>)<br>lines(x=rep(x0+<span>.8</span>,<span>2</span>), y=par(<span>"usr"</span>)[<span>4</span>]+c(-<span>75</span>,<span>75</span>))<br>segments(x0+<span>.8</span>,par(<span>"usr"</span>)[<span>4</span>]+seq(-<span>75</span>,<span>75</span>,l=<span>7</span>),x0+<span>.9</span>,par(<span>"usr"</span>)[<span>4</span>]+seq(-<span>75</span>,<span>75</span>,l=<span>7</span>))<br>text(x0+<span>.8</span>, par(<span>"usr"</span>)[<span>4</span>]+<span>125</span>, <span>"log2 FC"</span>, cex=<span>.66</span>)<br>rotatedLabel(b-<span>0.1</span>, colSums(significantGenes), colSums(significantGenes), pos=<span>3</span>, cex=, srt=<span>45</span>)<br><br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.7700296735905044" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Losibp2qedXpkxUib224X5FpKnEwE2EyMc5vLBxhd4Aicz6ElzfxoN6KwdaUnkDAFsBFEHAzfELvjcSzBg/640?wx_fmt=png" data-type="png" data-w="674" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Losibp2qedXpkxUib224X5FpKnEwE2EyMc5vLBxhd4Aicz6ElzfxoN6KwdaUnkDAFsBFEHAzfELvjcSzBg/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">为什么是8个“column”呢？</p><p data-tool="mdnice编辑器">其实前面的mycontrasts就告诉我们了</p><blockquote data-tool="mdnice编辑器"><p>mycontrasts ##竟然有8次组间比较？</p><section><table><thead><tr><th><strong>t6.E2-t6.UT</strong></th><th><strong>t6.E2FGF10-t6.E2</strong></th></tr></thead><tbody><tr><td><strong>t6.E2FGF10PD-t6.E2</strong></td><td><strong>t24.E2-t24.UT</strong></td></tr><tr><td><strong>t24.E2FGF10-t24.E2</strong></td><td><strong>t24.E2FGF10PD-t24.E2</strong></td></tr><tr><td><strong>t6.UT-t0.UT</strong></td><td><strong>t24.UT-t6.UT</strong></td></tr></tbody></table></section></blockquote><p data-tool="mdnice编辑器">这样的柱形图可以将比较复杂的组间差异分析结果更清楚地展现出来，值得借鉴~</p><p data-tool="mdnice编辑器">最后，例行来看看分组情况吧</p><h4 data-tool="mdnice编辑器"><span></span>主成分分析<span></span></h4><pre data-tool="mdnice编辑器"><span></span><code>gexp=t(gexp)<span>#画PCA图时要求是行名时样本名，列名时探针名，因此此时需要转换</span><br>gexp=as.data.frame(gexp)<span>#将matrix转换为data.frame </span><br><span>library</span>(<span>"FactoMineR"</span>)<span>#画主成分分析图需要加载这两个包</span><br><span>library</span>(<span>"factoextra"</span>)<br>dat.pca &lt;- PCA(gexp , graph = <span>FALSE</span>)<span>#现在dat最后一列是group_list，需要重新赋值给一个dat.pca,这个矩阵是不含有分组信息的</span><br>fviz_pca_ind(dat.pca,<br>             geom.ind = <span>"point"</span>, <span># show points only (nbut not "text")</span><br>             col.ind =  group_list, <span># color by groups </span><br>             addEllipses = <span>T</span>,<br>             legend.title = <span>"Groups"</span><br>)<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.5280312907431551" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Losibp2qedXpkxUib224X5FpKnEXibs20O3uD5mVMbnGsIdgF2ibxpTra9RlXEC5xF75rqztTlMSjMrxkVg/640?wx_fmt=png" data-type="png" data-w="1534" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Losibp2qedXpkxUib224X5FpKnEXibs20O3uD5mVMbnGsIdgF2ibxpTra9RlXEC5xF75rqztTlMSjMrxkVg/640?wx_fmt=png"><figcaption>我的pca</figcaption></figure><p data-tool="mdnice编辑器">下面的这个函数效果与之类似</p><pre data-tool="mdnice编辑器"><span></span><code>Fletcher2013pipeline.pca(Exp1)<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="1.0121317157712304" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Losibp2qedXpkxUib224X5FpKnEXkxNRumcqLGVrKKNlak19mIbrBiaBK4oPPKdlsPVgbfY5icWibLjnia71Q/640?wx_fmt=png" data-type="png" data-w="577" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Losibp2qedXpkxUib224X5FpKnEXkxNRumcqLGVrKKNlak19mIbrBiaBK4oPPKdlsPVgbfY5icWibLjnia71Q/640?wx_fmt=png"><figcaption>人家的pca</figcaption></figure><p data-tool="mdnice编辑器">看起来还是人家的组间分得更清晰一些</p><p data-tool="mdnice编辑器">如果想要特定的组间差异基因结果，可以按照</p><pre data-tool="mdnice编辑器"><span></span><code>diff1=topTable(glm, coef=<span>2</span>, n=<span>Inf</span>)<br>diff2=topTable(glm, coef=<span>3</span>, n=<span>Inf</span>)<br></code></pre><p data-tool="mdnice编辑器">其中，coef这个参数的描述如下：</p><figure data-tool="mdnice编辑器"><img data-ratio="0.5615183246073299" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Losibp2qedXpkxUib224X5FpKnENXL7TbNN54BqqeFQtWThKAjAaLIsRAjO5lRr57wcZ7JZdfahU4tQDw/640?wx_fmt=png" data-type="png" data-w="764" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Losibp2qedXpkxUib224X5FpKnENXL7TbNN54BqqeFQtWThKAjAaLIsRAjO5lRr57wcZ7JZdfahU4tQDw/640?wx_fmt=png"><figcaption>参数说明</figcaption></figure><p data-tool="mdnice编辑器">得到差异结果后，其余流程和二分组数据是一样的，相信大家都不陌生啦！</p><hr data-tool="mdnice编辑器"><p data-tool="mdnice编辑器">接下来再看看Fletcher2013a的pro版本</p><h2 data-tool="mdnice编辑器"><span> </span><span></span><span>Fletcher2013b</span><span></span><span> </span></h2><blockquote data-tool="mdnice编辑器"><p>This package reproduces the systems biology analysis for the data in package Fletcher2013a using RTN.</p><p>该软件包使用RTN对Fletcher2013a软件包中的数据进行了系统生物学分析。</p></blockquote><p data-tool="mdnice编辑器">分析步骤很简单</p><pre data-tool="mdnice编辑器"><span></span><code>rm(list = ls())<br><br><span># BiocManager::install("Fletcher2013b")</span><br><span>library</span>(Fletcher2013b)<br><span>library</span>(pheatmap)<br><br><span>##试试看</span><br>hits &lt;- Fletcher2013pipeline.deg(what=<span>"Exp1"</span>)<br>mra1 &lt;- Fletcher2013pipeline.mra1st(hits=hits$E2FGF10)  <span>##选一组看看</span><br></code></pre><h3 data-tool="mdnice编辑器"><span></span>一个小插曲<span></span></h3><pre data-tool="mdnice编辑器"><span></span><code><span>#参考https://zhuanlan.zhihu.com/p/434990993</span><br><span>##挑几个感兴趣的转录因子</span><br>risk.tfs=c(<span>"PTTG1"</span>,<span>"SPDEF"</span>,<span>"ESR1"</span>,<span>"GATA3"</span>,<span>"FOXA1"</span>)<br><span>##对regulon评分</span><br>rtnlist=tni.gsea2(rtni1st,regulatoryElements = risk.tfs)<br>regact=tni.get(rtnlist,what = <span>"regulonActivity"</span>)<br>anno=tni.get(rtnlist,what = <span>"colAnnotation"</span>)<br><br>colnames(anno)<br>attribs=c(<span>"ER+"</span>,<span>"ER-"</span>,<span>"PR+"</span>,<span>"PR-"</span>,<span>"LumA"</span>, <span>"LumB"</span>, <span>"Basal"</span>,<span>"Her2"</span>,<span>"Normal"</span>)<br>annot=anno[,attribs]<br><span>##画图看看</span><br>pheatmap(t(regact$differential),<br>         main = <span>"samples of Exp1_E2FGF10"</span>,<br>         annotation_col = annot,show_colnames = <span>F</span>,annotation_legend = <span>FALSE</span>,<br>         clustering_method = <span>"ward.D2"</span>,fontsize_row = <span>6</span>,<br>         clustering_distance_rows = <span>"correlation"</span>,clustering_distance_cols = <span>"correlation"</span> )<br><br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.5224171539961013" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Losibp2qedXpkxUib224X5FpKnErAQnUMOldx87uNZDX6ia3L6IMKdcgOth22libuqa761BhZOyom8MQXrw/640?wx_fmt=png" data-type="png" data-w="1539" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Losibp2qedXpkxUib224X5FpKnErAQnUMOldx87uNZDX6ia3L6IMKdcgOth22libuqa761BhZOyom8MQXrw/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">可以直接得到一个转录因子调控热图，省了不少事啊！</p><h3 data-tool="mdnice编辑器"><span></span>Fletcher2013b.pipelines系列函数<span></span></h3><blockquote data-tool="mdnice编辑器"><blockquote><p>A pipeline to reproduce results for Fletcher et al. 2013.</p><p><span>这个包的pipeline系列函数，把数据的全套流程都封装起来，看起来也是也非常方便，要是可以用来分析自己的数据就太好了，可惜不行。</span><span>。</span><span>。</span></p></blockquote></blockquote><pre data-tool="mdnice编辑器"><span></span><code>Fletcher2013pipeline.mra1st(hits, minRegulonSize=<span>20</span>, idtype=<span>"probeid"</span>,<br>pAdjustMethod=<span>"holm"</span>,tnet=<span>"dpi"</span>, eps=<span>0</span>, pValueCutoff=<span>1e-4</span>, verbose=<span>TRUE</span>, <span>...</span>)<br><br>Fletcher2013pipeline.mra2nd(hits, minRegulonSize=<span>20</span>, idtype=<span>"probeid"</span>,<br>pAdjustMethod=<span>"holm"</span>,tnet=<span>"dpi"</span>, eps=<span>0</span>, pValueCutoff=<span>1e-4</span>, verbose=<span>TRUE</span>, <span>...</span>)<br><br>Fletcher2013pipeline.mraNormals(hits, minRegulonSize=<span>20</span>, idtype=<span>"probeid"</span>,<br>pAdjustMethod=<span>"holm"</span>,tnet=<span>"dpi"</span>, eps=<span>0</span>, pValueCutoff=<span>1e-4</span>, verbose=<span>TRUE</span>, <span>...</span>)<br><br>Fletcher2013pipeline.mraTALL(hits, minRegulonSize=<span>20</span>, idtype=<span>"probeid"</span>,<br>pAdjustMethod=<span>"holm"</span>, tnet=<span>"dpi"</span>, eps=<span>0</span>, pValueCutoff=<span>0.01</span>, verbose=<span>TRUE</span>, <span>...</span>)<br><br>Fletcher2013pipeline.consensusnet()<br>Fletcher2013pipeline.enrichmap()<br></code></pre><h2 data-tool="mdnice编辑器"><span> </span><span></span><span>小结</span><span></span><span> </span></h2><p data-tool="mdnice编辑器">总的来讲，Fletcher2013a和Fletcher2013b实现了对自身数据集的包装和分析，并且是基于MCF-7的人乳腺癌细胞株进行了不同时间序列下不同药物的干预，或许可作为你的数据挖掘验证的一部分哦！</p><span>- END -</span></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/etLLz5LjdzDsZkJkkpJ_SQ",target="_blank" rel="noopener noreferrer">原文链接</a>
