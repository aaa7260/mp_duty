---
title: "怎么提取KEGG数据库特定通路的基因列表?"
date: 2023-03-28T07:43:41Z
draft: ["false"]
tags: [
  "fetched",
  "东林的扯淡小屋"
]
categories: ["Acdemic"]
---
怎么提取KEGG数据库特定通路的基因列表? by 东林的扯淡小屋
------
<div><p>上网搜索相关资料是第一步，相信有人已经有相关的研究，我们只需要找到别人怎么做，自己依样画瓢就可以啦！<br></p><p><br></p><p>首先需要确定具体的pathway ID：</p><p>假设我们对人类的wnt信号通路感兴趣，以此为例。</p><p>KEGG: Kyoto Encyclopedia of Genes and Genomes</p><p><span>https://www.kegg.jp/</span></p><p><img data-ratio="0.7691342534504392" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBo1KnVQ5sUK7BW21AjrjdeBxM7N2zhepa3y5C7GYOYhbX3nwyJ9gb4gFuXTHJC8AlmLbGyT053vnw/640?wx_fmt=png" data-type="png" data-w="797" src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBo1KnVQ5sUK7BW21AjrjdeBxM7N2zhepa3y5C7GYOYhbX3nwyJ9gb4gFuXTHJC8AlmLbGyT053vnw/640?wx_fmt=png"></p><p>点进通路：</p><p>选择基因：</p><p><img data-ratio="0.8506787330316742" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBo1KnVQ5sUK7BW21AjrjdeBGib6khRMpCiaAknpL8ajzHWUVhiautWiahGgbuFVBnIHclia2c4VDTG9xVQ/640?wx_fmt=png" data-type="png" data-w="663" src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBo1KnVQ5sUK7BW21AjrjdeBGib6khRMpCiaAknpL8ajzHWUVhiautWiahGgbuFVBnIHclia2c4VDTG9xVQ/640?wx_fmt=png"></p><p><img data-ratio="0.6829865361077111" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBo1KnVQ5sUK7BW21AjrjdeBASOqPyyL4UqA1PFHhgic9Eswjiar54K2tmjzavh0ZDibAAKguL3cMn8UQ/640?wx_fmt=png" data-type="png" data-w="817" src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBo1KnVQ5sUK7BW21AjrjdeBASOqPyyL4UqA1PFHhgic9Eswjiar54K2tmjzavh0ZDibAAKguL3cMn8UQ/640?wx_fmt=png"></p><p><br></p><p><br></p><p>或者选择通路：<br></p><p><img data-ratio="0.779373368146214" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBo1KnVQ5sUK7BW21AjrjdeB4JziawfzXqRIpFLDImUVPicQRr1qj5x36L0PKQxZPf86yFAWl3ocX4EQ/640?wx_fmt=png" data-type="png" data-w="766" src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBo1KnVQ5sUK7BW21AjrjdeB4JziawfzXqRIpFLDImUVPicQRr1qj5x36L0PKQxZPf86yFAWl3ocX4EQ/640?wx_fmt=png"></p><p><img data-ratio="0.5226438188494492" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBo1KnVQ5sUK7BW21AjrjdeBw9ZCDjgYbfIehagU9tsup4CVPD7z1avByKEgt5wDibU4dwXHWiaEfnBQ/640?wx_fmt=png" data-type="png" data-w="817" src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBo1KnVQ5sUK7BW21AjrjdeBw9ZCDjgYbfIehagU9tsup4CVPD7z1avByKEgt5wDibU4dwXHWiaEfnBQ/640?wx_fmt=png"></p><p><img data-ratio="0.520068317677199" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBo1KnVQ5sUK7BW21AjrjdeBlQDaC0kEjEicW0JrXuVxucltt4SVeUg4EVZ30QibHwhibk0h0miatao3og/640?wx_fmt=png" data-type="png" data-w="1171" src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBo1KnVQ5sUK7BW21AjrjdeBlQDaC0kEjEicW0JrXuVxucltt4SVeUg4EVZ30QibHwhibk0h0miatao3og/640?wx_fmt=png"></p><p><img data-ratio="0.5198618307426598" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBo1KnVQ5sUK7BW21AjrjdeB0WoIZQibsm0X8ZxkERicmyml2QNiclpicpzCrwoLvDOEGdVcmnIG2oibF2Q/640?wx_fmt=png" data-type="png" data-w="1158" src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBo1KnVQ5sUK7BW21AjrjdeB0WoIZQibsm0X8ZxkERicmyml2QNiclpicpzCrwoLvDOEGdVcmnIG2oibF2Q/640?wx_fmt=png"></p><p><img data-ratio="0.7129300118623962" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBo1KnVQ5sUK7BW21AjrjdeBfReU7zq3Dia08h8ibib39pY1HTd32lNR9J2DFpCzqJzxFm4gX0gMdcf8A/640?wx_fmt=png" data-type="png" data-w="843" src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBo1KnVQ5sUK7BW21AjrjdeBfReU7zq3Dia08h8ibib39pY1HTd32lNR9J2DFpCzqJzxFm4gX0gMdcf8A/640?wx_fmt=png"></p><p>最后确定具体ID：hsa04310</p><p><br></p><p><br></p><p>在R studio操作：<br></p><p>首先安装相关的包：<br></p><p><span>if (!requireNamespace("BiocManager", quietly = TRUE))</span></p><p><span>  install.packages("BiocManager")</span></p><p><br></p><p><span>BiocManager::install("KEGGREST")</span></p><p><span><br></span></p><p><span><br></span></p><p>然后导入：包含了KEGG数据库的19个子数据库，其中gene是我们关注的。<br></p><p>library(KEGGREST)</p><p>listDatabases()</p><p><img data-ratio="0.11714975845410629" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBo1KnVQ5sUK7BW21AjrjdeB6Ayec8hurRHydNNXlqgDzZibhlzyia00jG9X3QwaHcw20EZ88En6ibeKQ/640?wx_fmt=png" data-type="png" data-w="828" src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBo1KnVQ5sUK7BW21AjrjdeB6Ayec8hurRHydNNXlqgDzZibhlzyia00jG9X3QwaHcw20EZ88En6ibeKQ/640?wx_fmt=png"></p><p>观察相关的信息，使用 keggGet 函数获取信号通路 hsa04310的信息：</p><p>org &lt;- keggList("organism")</p><p>head(org)</p><p>keggGet('hsa04310')</p><p><img data-ratio="0.5405092592592593" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBo1KnVQ5sUK7BW21AjrjdeB2yAVITtTCcLBHGCckEiboE7NE09w95ZMAPBKvrSq7nX6qdXrhzQ6Vww/640?wx_fmt=png" data-type="png" data-w="864" src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBo1KnVQ5sUK7BW21AjrjdeB2yAVITtTCcLBHGCckEiboE7NE09w95ZMAPBKvrSq7nX6qdXrhzQ6Vww/640?wx_fmt=png"></p><p><br></p><p>gs &lt;- keggGet('hsa04310') </p><p>gs[[1]]$GENE#得到gene对象</p><p><img data-ratio="0.7595993322203672" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBo1KnVQ5sUK7BW21AjrjdeBJrS0g6y1cxj05UZsEXvRdb3YERk8GubB9X86JW6licY0kqTwAZ7uQEg/640?wx_fmt=png" data-type="png" data-w="599" src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBo1KnVQ5sUK7BW21AjrjdeBJrS0g6y1cxj05UZsEXvRdb3YERk8GubB9X86JW6licY0kqTwAZ7uQEg/640?wx_fmt=png"></p><p>genes &lt;- unlist(lapply(gs[[1]]$GENE,function(x) strsplit(x,';')[[1]][1]))</p><p>gene_list&lt;-genes[1:length(genes)%%2 ==0]</p><p>gene_list</p><p>write.csv(file="genelist",gene_list)#得到基因名列表，并存储于csv文件。</p><p><img data-ratio="0.5545905707196029" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBo1KnVQ5sUK7BW21AjrjdeBEaXyg2E0TCdnGrvHzRqkK4v0bjDKtuiaM9W8xBZRSILdBqL8aaqq8aQ/640?wx_fmt=png" data-type="png" data-w="806" src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBo1KnVQ5sUK7BW21AjrjdeBEaXyg2E0TCdnGrvHzRqkK4v0bjDKtuiaM9W8xBZRSILdBqL8aaqq8aQ/640?wx_fmt=png"></p><p><br></p><p>打开：wnt pathway的所有基因<br></p><p><img data-ratio="1.856777493606138" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBo1KnVQ5sUK7BW21AjrjdeBw25icudkzdINUq18oRSqXOOF9otbwSSYibHu7u2MvmWl0estpsDzeiaiaA/640?wx_fmt=png" data-type="png" data-w="391" src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBo1KnVQ5sUK7BW21AjrjdeBw25icudkzdINUq18oRSqXOOF9otbwSSYibHu7u2MvmWl0estpsDzeiaiaA/640?wx_fmt=png"></p><p><br></p><p><br></p><p><br></p><p><br></p><p><br></p><p><br></p><p>参考资料：</p><p>如何使用R语言找出某一个通路的所有基因名字</p><p>https://www.jianshu.com/p/16919d753fb2</p><p>KEGG数据库的rest API - 简书</p><p>https://www.jianshu.com/p/9aef626abf94</p><p><br></p><p><br></p><p>完整代码：</p><p><span>if (!requireNamespace("BiocManager", quietly = TRUE))</span></p><p><span>  install.packages("BiocManager")</span></p><p><br></p><p><span>BiocManager::install("KEGGREST")</span></p><p><br></p><p><br></p><p><br></p><p><span>library(KEGGREST)</span></p><p><span>listDatabases()</span></p><p><br></p><p><span>## ----get_organisms------------------------------------------------------------</span></p><p><span>org &lt;- keggList("organism")</span></p><p><span>head(org)</span></p><p><span>keggGet('hsa04310')</span></p><p><span>gs &lt;- keggGet('hsa04310') </span></p><p><span>gs[[1]]$GENE</span></p><p><span>genes &lt;- unlist(lapply(gs[[1]]$GENE,function(x) strsplit(x,';')[[1]][1]))</span></p><p><span>gene_list&lt;-genes[1:length(genes)%%2 ==0]</span></p><p><span>gene_list</span></p><p><span>write.csv(file="genelist",gene_list)</span></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/7-KmssILIQGF-MqjxYgcsQ",target="_blank" rel="noopener noreferrer">原文链接</a>
