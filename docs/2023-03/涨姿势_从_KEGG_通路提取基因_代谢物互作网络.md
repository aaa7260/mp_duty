---
title: "涨姿势！从 KEGG 通路提取基因-代谢物互作网络"
date: 2023-03-28T07:29:32Z
draft: ["false"]
tags: [
  "fetched",
  "生信益站"
]
categories: ["Acdemic"]
---
涨姿势！从 KEGG 通路提取基因-代谢物互作网络 by 生信益站
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><img data-ratio="0.2777777777777778" data-src="https://mmbiz.qpic.cn/mmbiz_gif/mhoJzVKWSibibK1nibg3nH1SUpgfQWD4O2GBaobGaMc4Tiau6YIpyQcSibAFPa2ia449WqUx2fWRXTXLXfjXcI4cmkBA/640?wx_fmt=gif" data-type="gif" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_gif/mhoJzVKWSibibK1nibg3nH1SUpgfQWD4O2GBaobGaMc4Tiau6YIpyQcSibAFPa2ia449WqUx2fWRXTXLXfjXcI4cmkBA/640?wx_fmt=gif"><section><mp-common-profile data-pluginname="mpprofile" data-weui-theme="light" data-id="MzU1NTk0MTUxMg==" data-headimg="http://mmbiz.qpic.cn/mmbiz_png/mhoJzVKWSibicV5ezibIjic3zhPgzQcTD8N0hm3q2fO2QgBoVFIuRWy6BKffGjfXOzI7foLDlyrHWfRUMkicOCSKq4g/0?wx_fmt=png" data-nickname="生信益站" data-alias="" data-signature="生物信息或基因测序数据分析、软件算法、科研绘图、Python/Perl/R代码分享。" data-from="0" data-is_biz_ban="0"></mp-common-profile></section><blockquote data-tool="mdnice编辑器"><span>❝</span><p>分享一个简单的示例，使用<code>KEGGgraph</code>包从<code>KGML</code>文件中提取<code>基因-代谢物</code>互作网络。</p><span>❞</span></blockquote><h2 data-tool="mdnice编辑器"><span></span><span>引言</span><span></span></h2><p data-tool="mdnice编辑器">自 1995 年首次推出以来，KEGG PATHWAY 已被广泛用作了解生物通路和细胞过程功能的参考知识库。来自 KEGG 的知识已被广泛领域的大量工作证明具有巨大价值。</p><p data-tool="mdnice编辑器">通路在 KEGG 服务器端以图形的形式存储和呈现，其中<code>节点</code>是分子（蛋白质、化合物等），<code>边</code>代表节点之间的关系类型，例如活化或磷酸化。图的性质激发了科研人员使用 R 和 Bioconductor 中实现的强大图工具来研究它们的兴趣，包括<code>graph、RBGL、Rgraphviz</code>。虽然通过手动解析几乎不可能查询图形特征，但目前缺少一种原生且直接的客户端工具来解析通路并随后使用 R 中的图形工具对其进行分析。</p><p data-tool="mdnice编辑器">为了解决这个问题，作者开发了开源软件包 <code>KEGGgraph</code>，用于 KEGG 通路和图形对象之间的接口，以及分析、剖析和可视化这些图形的工具集合。</p><p data-tool="mdnice编辑器">该软件包需要 <code>KGML</code>（KEGG <code>XML</code>）文件，可以从 KEGG REST Web 服务（<code>https://rest.kegg.jp/</code>）下载这些文件，而无需出于学术目的获得许可。</p><h2 data-tool="mdnice编辑器"><span></span><span>KGML 格式简介</span><span></span></h2><p data-tool="mdnice编辑器">如下图所示，KGML 主要记录了 3 种互作关系：</p><ol data-tool="mdnice编辑器"><li><section>蛋白之间的互作关系，通过 relation 关联不同的 gene/protein/compound;</section></li><li><section>化合物/代谢物 compound 之间的相互反应，通过 reacton 关联不同的 compound;</section></li><li><section>pathwat-pathway 之间的相互关系。</section></li></ol><figure data-tool="mdnice编辑器"><img data-ratio="0.7292817679558011" data-src="https://mmbiz.qpic.cn/mmbiz_png/mhoJzVKWSibibK1nibg3nH1SUpgfQWD4O2GFlXyAcD8aQa2T3wmn7j3M7gz8l7B6oD1t5OGnqXD5nicHkTTkafGwZw/640?wx_fmt=png" data-type="png" data-w="724" src="https://mmbiz.qpic.cn/mmbiz_png/mhoJzVKWSibibK1nibg3nH1SUpgfQWD4O2GFlXyAcD8aQa2T3wmn7j3M7gz8l7B6oD1t5OGnqXD5nicHkTTkafGwZw/640?wx_fmt=png"><figcaption><span></span>KGML文件构成图</figcaption></figure><p data-tool="mdnice编辑器">KGML 详细说明：</p><ul data-tool="mdnice编辑器"><li><section>https://www.genome.jp/kegg/xml/docs/</section></li></ul><p data-tool="mdnice编辑器">KGML 文件（hsa04310，Wnt 信号通路）开头格式如下：</p><pre data-tool="mdnice编辑器"><span></span><code>&lt;?xml version=<span>"1.0"</span>?&gt;<br>&lt;!DOCTYPE pathway SYSTEM <span>"https://www.kegg.jp/kegg/xml/KGML_v0.7.2_.dtd"</span>&gt;<br>&lt;!-- Creation date: May 20, 2022 15:03:12 +0900 (GMT+9) --&gt;<br>&lt;pathway name=<span>"path:hsa04310"</span> org=<span>"hsa"</span> number=<span>"04310"</span><br>         title=<span>"Wnt signaling pathway"</span><br>         image=<span>"https://www.kegg.jp/kegg/pathway/hsa/hsa04310.png"</span><br>         link=<span>"https://www.kegg.jp/kegg-bin/show_pathway?hsa04310"</span>&gt;<br></code></pre><p data-tool="mdnice编辑器">以<code>relation</code>为关键字，从 KGML 检索互作关系：</p><pre data-tool="mdnice编辑器"><span></span><code>&lt;relation entry1=<span>"87"</span> entry2=<span>"88"</span> <span>type</span>=<span>"PPrel"</span>&gt;<br>        &lt;subtype name=<span>"activation"</span> value=<span>"--&amp;gt;"</span>/&gt;<br>    &lt;/relation&gt;<br>    &lt;relation entry1=<span>"88"</span> entry2=<span>"85"</span> <span>type</span>=<span>"PPrel"</span>&gt;<br>        &lt;subtype name=<span>"activation"</span> value=<span>"--&amp;gt;"</span>/&gt;<br>    &lt;/relation&gt;<br>    &lt;relation entry1=<span>"73"</span> entry2=<span>"71"</span> <span>type</span>=<span>"PPrel"</span>&gt;<br>        &lt;subtype name=<span>"activation"</span> value=<span>"--&amp;gt;"</span>/&gt;<br>    &lt;/relation&gt;<br>    &lt;relation entry1=<span>"48"</span> entry2=<span>"49"</span> <span>type</span>=<span>"PPrel"</span>&gt;<br>        &lt;subtype name=<span>"activation"</span> value=<span>"--&amp;gt;"</span>/&gt;<br>    &lt;/relation&gt;<br>    &lt;relation entry1=<span>"55"</span> entry2=<span>"54"</span> <span>type</span>=<span>"PPrel"</span>&gt;<br>        &lt;subtype name=<span>"phosphorylation"</span> value=<span>"+p"</span>/&gt;<br>    &lt;/relation&gt;<br>    &lt;relation entry1=<span>"54"</span> entry2=<span>"49"</span> <span>type</span>=<span>"PPrel"</span>&gt;<br>        &lt;subtype name=<span>"inhibition"</span> value=<span>"--|"</span>/&gt;<br>        &lt;subtype name=<span>"phosphorylation"</span> value=<span>"+p"</span>/&gt;<br>    &lt;/relation&gt;<br>    &lt;relation entry1=<span>"85"</span> entry2=<span>"77"</span> <span>type</span>=<span>"PPrel"</span>&gt;<br>        &lt;subtype name=<span>"indirect effect"</span> value=<span>"..&amp;gt;"</span>/&gt;<br>    &lt;/relation&gt;<br>    &lt;relation entry1=<span>"68"</span> entry2=<span>"65"</span> <span>type</span>=<span>"PPrel"</span>&gt;<br>        &lt;subtype name=<span>"indirect effect"</span> value=<span>"..&amp;gt;"</span>/&gt;<br>    &lt;/relation&gt;<br>    &lt;relation entry1=<span>"36"</span> entry2=<span>"33"</span> <span>type</span>=<span>"PPrel"</span>&gt;<br>        &lt;subtype name=<span>"indirect effect"</span> value=<span>"..&amp;gt;"</span>/&gt;<br>    &lt;/relation&gt;<br>    &lt;relation entry1=<span>"33"</span> entry2=<span>"29"</span> <span>type</span>=<span>"PPrel"</span>&gt;<br>        &lt;subtype name=<span>"indirect effect"</span> value=<span>"..&amp;gt;"</span>/&gt;<br>    &lt;/relation&gt;<br>    &lt;relation entry1=<span>"31"</span> entry2=<span>"28"</span> <span>type</span>=<span>"PPrel"</span>&gt;<br>        &lt;subtype name=<span>"indirect effect"</span> value=<span>"..&amp;gt;"</span>/&gt;<br>    &lt;/relation&gt;<br>    &lt;relation entry1=<span>"26"</span> entry2=<span>"25"</span> <span>type</span>=<span>"PPrel"</span>&gt;<br>        &lt;subtype name=<span>"indirect effect"</span> value=<span>"..&amp;gt;"</span>/&gt;<br>    &lt;/relation&gt;<br>    &lt;relation entry1=<span>"86"</span> entry2=<span>"88"</span> <span>type</span>=<span>"PPrel"</span>&gt;<br>        &lt;subtype name=<span>"inhibition"</span> value=<span>"--|"</span>/&gt;<br>    &lt;/relation&gt;<br>    &lt;relation entry1=<span>"86"</span> entry2=<span>"85"</span> <span>type</span>=<span>"PPrel"</span>&gt;<br>        &lt;subtype name=<span>"inhibition"</span> value=<span>"--|"</span>/&gt;<br>    &lt;/relation&gt;<br>    &lt;relation entry1=<span>"83"</span> entry2=<span>"88"</span> <span>type</span>=<span>"PPrel"</span>&gt;<br>        &lt;subtype name=<span>"inhibition"</span> value=<span>"--|"</span>/&gt;<br>    &lt;/relation&gt;<br>    &lt;relation entry1=<span>"82"</span> entry2=<span>"88"</span> <span>type</span>=<span>"PPrel"</span>&gt;<br>        &lt;subtype name=<span>"inhibition"</span> value=<span>"--|"</span>/&gt;<br>    &lt;/relation&gt;<br>    &lt;relation entry1=<span>"81"</span> entry2=<span>"84"</span> <span>type</span>=<span>"PPrel"</span>&gt;<br>        &lt;subtype name=<span>"inhibition"</span> value=<span>"--|"</span>/&gt;<br>    &lt;/relation&gt;<br>    &lt;relation entry1=<span>"79"</span> entry2=<span>"77"</span> <span>type</span>=<span>"PPrel"</span>&gt;<br>        &lt;subtype name=<span>"inhibition"</span> value=<span>"--|"</span>/&gt;<br>    &lt;/relation&gt;<br>    &lt;relation entry1=<span>"76"</span> entry2=<span>"77"</span> <span>type</span>=<span>"PPrel"</span>&gt;<br>        &lt;subtype name=<span>"inhibition"</span> value=<span>"--|"</span>/&gt;<br>    &lt;/relation&gt;<br>    &lt;relation entry1=<span>"77"</span> entry2=<span>"74"</span> <span>type</span>=<span>"PPrel"</span>&gt;<br>        &lt;subtype name=<span>"inhibition"</span> value=<span>"--|"</span>/&gt;<br>    &lt;/relation&gt;<br>    &lt;relation entry1=<span>"53"</span> entry2=<span>"71"</span> <span>type</span>=<span>"PPrel"</span>&gt;<br>        &lt;subtype name=<span>"inhibition"</span> value=<span>"--|"</span>/&gt;<br>    &lt;/relation&gt;<br>    &lt;relation entry1=<span>"47"</span> entry2=<span>"49"</span> <span>type</span>=<span>"PPrel"</span>&gt;<br>        &lt;subtype name=<span>"inhibition"</span> value=<span>"--|"</span>/&gt;<br>    &lt;/relation&gt;<br>    &lt;relation entry1=<span>"52"</span> entry2=<span>"71"</span> <span>type</span>=<span>"PPrel"</span>&gt;<br>        &lt;subtype name=<span>"inhibition"</span> value=<span>"--|"</span>/&gt;<br>    &lt;/relation&gt;<br>    &lt;relation entry1=<span>"45"</span> entry2=<span>"49"</span> <span>type</span>=<span>"PPrel"</span>&gt;<br>        &lt;subtype name=<span>"inhibition"</span> value=<span>"--|"</span>/&gt;<br>    &lt;/relation&gt;<br>    &lt;relation entry1=<span>"46"</span> entry2=<span>"49"</span> <span>type</span>=<span>"PPrel"</span>&gt;<br>        &lt;subtype name=<span>"inhibition"</span> value=<span>"--|"</span>/&gt;<br>    &lt;/relation&gt;<br>    &lt;relation entry1=<span>"50"</span> entry2=<span>"49"</span> <span>type</span>=<span>"PPrel"</span>&gt;<br>        &lt;subtype name=<span>"binding/association"</span> value=<span>"---"</span>/&gt;<br>    &lt;/relation&gt;<br>    &lt;relation entry1=<span>"51"</span> entry2=<span>"49"</span> <span>type</span>=<span>"PPrel"</span>&gt;<br>        &lt;subtype name=<span>"binding/association"</span> value=<span>"---"</span>/&gt;<br>    &lt;/relation&gt;<br>    &lt;relation entry1=<span>"51"</span> entry2=<span>"71"</span> <span>type</span>=<span>"PPrel"</span>&gt;<br>        &lt;subtype name=<span>"binding/association"</span> value=<span>"---"</span>/&gt;<br>    &lt;/relation&gt;<br>    &lt;relation entry1=<span>"72"</span> entry2=<span>"73"</span> <span>type</span>=<span>"PPrel"</span>&gt;<br>        &lt;subtype name=<span>"binding/association"</span> value=<span>"---"</span>/&gt;<br>    &lt;/relation&gt;<br>    &lt;relation entry1=<span>"72"</span> entry2=<span>"74"</span> <span>type</span>=<span>"PPrel"</span>&gt;<br>        &lt;subtype name=<span>"inhibition"</span> value=<span>"--|"</span>/&gt;<br>    &lt;/relation&gt;<br>    &lt;relation entry1=<span>"72"</span> entry2=<span>"71"</span> <span>type</span>=<span>"PPrel"</span>&gt;<br>        &lt;subtype name=<span>"phosphorylation"</span> value=<span>"+p"</span>/&gt;<br>    &lt;/relation&gt;<br>    &lt;relation entry1=<span>"84"</span> entry2=<span>"85"</span> <span>type</span>=<span>"PPrel"</span>&gt;<br>        &lt;subtype name=<span>"binding/association"</span> value=<span>"---"</span>/&gt;<br>    &lt;/relation&gt;<br>    &lt;relation entry1=<span>"69"</span> entry2=<span>"80"</span> <span>type</span>=<span>"PPrel"</span>&gt;<br>        &lt;subtype name=<span>"binding/association"</span> value=<span>"---"</span>/&gt;<br>    &lt;/relation&gt;<br>    &lt;relation entry1=<span>"69"</span> entry2=<span>"77"</span> <span>type</span>=<span>"PPrel"</span>&gt;<br>        &lt;subtype name=<span>"binding/association"</span> value=<span>"---"</span>/&gt;<br>    &lt;/relation&gt;<br>    &lt;relation entry1=<span>"69"</span> entry2=<span>"74"</span> <span>type</span>=<span>"PPrel"</span>&gt;<br>        &lt;subtype name=<span>"binding/association"</span> value=<span>"---"</span>/&gt;<br>    &lt;/relation&gt;<br>    &lt;relation entry1=<span>"69"</span> entry2=<span>"70"</span> <span>type</span>=<span>"PPrel"</span>&gt;<br>        &lt;subtype name=<span>"binding/association"</span> value=<span>"---"</span>/&gt;<br>    &lt;/relation&gt;<br>    &lt;relation entry1=<span>"69"</span> entry2=<span>"71"</span> <span>type</span>=<span>"PPrel"</span>&gt;<br>        &lt;subtype name=<span>"binding/association"</span> value=<span>"---"</span>/&gt;<br>    &lt;/relation&gt;<br>    &lt;relation entry1=<span>"56"</span> entry2=<span>"69"</span> <span>type</span>=<span>"PPrel"</span>&gt;<br>        &lt;subtype name=<span>"binding/association"</span> value=<span>"---"</span>/&gt;<br>    &lt;/relation&gt;<br>    &lt;relation entry1=<span>"77"</span> entry2=<span>"78"</span> <span>type</span>=<span>"PPrel"</span>&gt;<br>        &lt;subtype name=<span>"binding/association"</span> value=<span>"---"</span>/&gt;<br>    &lt;/relation&gt;<br>    &lt;relation entry1=<span>"75"</span> entry2=<span>"77"</span> <span>type</span>=<span>"PPrel"</span>&gt;<br>        &lt;subtype name=<span>"binding/association"</span> value=<span>"---"</span>/&gt;<br>    &lt;/relation&gt;<br>    &lt;relation entry1=<span>"74"</span> entry2=<span>"75"</span> <span>type</span>=<span>"PPrel"</span>&gt;<br>        &lt;subtype name=<span>"binding/association"</span> value=<span>"---"</span>/&gt;<br>    &lt;/relation&gt;<br>    &lt;relation entry1=<span>"56"</span> entry2=<span>"71"</span> <span>type</span>=<span>"PPrel"</span>&gt;<br>        &lt;subtype name=<span>"binding/association"</span> value=<span>"---"</span>/&gt;<br>    &lt;/relation&gt;<br>    &lt;relation entry1=<span>"70"</span> entry2=<span>"71"</span> <span>type</span>=<span>"PPrel"</span>&gt;<br>        &lt;subtype name=<span>"binding/association"</span> value=<span>"---"</span>/&gt;<br>    &lt;/relation&gt;<br>    &lt;relation entry1=<span>"70"</span> entry2=<span>"77"</span> <span>type</span>=<span>"PPrel"</span>&gt;<br>        &lt;subtype name=<span>"binding/association"</span> value=<span>"---"</span>/&gt;<br>    &lt;/relation&gt;<br>    &lt;relation entry1=<span>"61"</span> entry2=<span>"70"</span> <span>type</span>=<span>"PPrel"</span>&gt;<br>        &lt;subtype name=<span>"binding/association"</span> value=<span>"---"</span>/&gt;<br>    &lt;/relation&gt;<br>    &lt;relation entry1=<span>"60"</span> entry2=<span>"71"</span> <span>type</span>=<span>"PPrel"</span>&gt;<br>        &lt;subtype name=<span>"ubiquitination"</span> value=<span>"+u"</span>/&gt;<br>    &lt;/relation&gt;<br>    &lt;relation entry1=<span>"61"</span> entry2=<span>"71"</span> <span>type</span>=<span>"PPrel"</span>&gt;<br>        &lt;subtype name=<span>"ubiquitination"</span> value=<span>"+u"</span>/&gt;<br>    &lt;/relation&gt;<br>    &lt;relation entry1=<span>"66"</span> entry2=<span>"33"</span> <span>type</span>=<span>"PPrel"</span>&gt;<br>        &lt;subtype name=<span>"activation"</span> value=<span>"--&amp;gt;"</span>/&gt;<br>    &lt;/relation&gt;<br>    &lt;relation entry1=<span>"66"</span> entry2=<span>"77"</span> <span>type</span>=<span>"PPrel"</span>&gt;<br>        &lt;subtype name=<span>"inhibition"</span> value=<span>"--|"</span>/&gt;<br>    &lt;/relation&gt;<br>    &lt;relation entry1=<span>"38"</span> entry2=<span>"36"</span> <span>type</span>=<span>"PPrel"</span>&gt;<br>        &lt;subtype name=<span>"activation"</span> value=<span>"--&amp;gt;"</span>/&gt;<br>    &lt;/relation&gt;<br>    &lt;relation entry1=<span>"32"</span> entry2=<span>"33"</span> <span>type</span>=<span>"PPrel"</span>&gt;<br>        &lt;subtype name=<span>"binding/association"</span> value=<span>"---"</span>/&gt;<br>    &lt;/relation&gt;<br>    &lt;relation entry1=<span>"31"</span> entry2=<span>"32"</span> <span>type</span>=<span>"PPrel"</span>&gt;<br>        &lt;subtype name=<span>"dissociation"</span> value=<span>"-+-"</span>/&gt;<br>    &lt;/relation&gt;<br>    &lt;relation entry1=<span>"31"</span> entry2=<span>"30"</span> <span>type</span>=<span>"PPrel"</span>&gt;<br>        &lt;subtype name=<span>"activation"</span> value=<span>"--&amp;gt;"</span>/&gt;<br>    &lt;/relation&gt;<br>    &lt;relation entry1=<span>"29"</span> entry2=<span>"28"</span> <span>type</span>=<span>"PPrel"</span>&gt;<br>        &lt;subtype name=<span>"activation"</span> value=<span>"--&amp;gt;"</span>/&gt;<br>    &lt;/relation&gt;<br>    &lt;relation entry1=<span>"25"</span> entry2=<span>"24"</span> <span>type</span>=<span>"PPrel"</span>&gt;<br>        &lt;subtype name=<span>"compound"</span> value=<span>"12"</span>/&gt;<br>    &lt;/relation&gt;<br>    &lt;relation entry1=<span>"25"</span> entry2=<span>"23"</span> <span>type</span>=<span>"PPrel"</span>&gt;<br>        &lt;subtype name=<span>"compound"</span> value=<span>"12"</span>/&gt;<br>    &lt;/relation&gt;<br>    &lt;relation entry1=<span>"25"</span> entry2=<span>"22"</span> <span>type</span>=<span>"PPrel"</span>&gt;<br>        &lt;subtype name=<span>"compound"</span> value=<span>"12"</span>/&gt;<br>    &lt;/relation&gt;<br>    &lt;relation entry1=<span>"23"</span> entry2=<span>"21"</span> <span>type</span>=<span>"PPrel"</span>&gt;<br>        &lt;subtype name=<span>"dephosphorylation"</span> value=<span>"-p"</span>/&gt;<br>    &lt;/relation&gt;<br>    &lt;relation entry1=<span>"71"</span> entry2=<span>"49"</span> <span>type</span>=<span>"PPrel"</span>&gt;<br>        &lt;subtype name=<span>"activation"</span> value=<span>"--&amp;gt;"</span>/&gt;<br>    &lt;/relation&gt;<br>    &lt;relation entry1=<span>"33"</span> entry2=<span>"37"</span> <span>type</span>=<span>"PPrel"</span>&gt;<br>        &lt;subtype name=<span>"binding/association"</span> value=<span>"---"</span>/&gt;<br>    &lt;/relation&gt;<br>    &lt;relation entry1=<span>"34"</span> entry2=<span>"37"</span> <span>type</span>=<span>"PPrel"</span>&gt;<br>        &lt;subtype name=<span>"binding/association"</span> value=<span>"---"</span>/&gt;<br>    &lt;/relation&gt;<br>    &lt;relation entry1=<span>"33"</span> entry2=<span>"34"</span> <span>type</span>=<span>"PPrel"</span>&gt;<br>        &lt;subtype name=<span>"binding/association"</span> value=<span>"---"</span>/&gt;<br>    &lt;/relation&gt;<br>    &lt;relation entry1=<span>"27"</span> entry2=<span>"26"</span> <span>type</span>=<span>"PPrel"</span>&gt;<br>        &lt;subtype name=<span>"activation"</span> value=<span>"--&amp;gt;"</span>/&gt;<br>    &lt;/relation&gt;<br>    &lt;relation entry1=<span>"49"</span> entry2=<span>"44"</span> <span>type</span>=<span>"GErel"</span>&gt;<br>        &lt;subtype name=<span>"expression"</span> value=<span>"--&amp;gt;"</span>/&gt;<br>    &lt;/relation&gt;<br>    &lt;relation entry1=<span>"49"</span> entry2=<span>"43"</span> <span>type</span>=<span>"GErel"</span>&gt;<br>        &lt;subtype name=<span>"expression"</span> value=<span>"--&amp;gt;"</span>/&gt;<br>    &lt;/relation&gt;<br>    &lt;relation entry1=<span>"49"</span> entry2=<span>"42"</span> <span>type</span>=<span>"GErel"</span>&gt;<br>        &lt;subtype name=<span>"expression"</span> value=<span>"--&amp;gt;"</span>/&gt;<br>    &lt;/relation&gt;<br>    &lt;relation entry1=<span>"49"</span> entry2=<span>"41"</span> <span>type</span>=<span>"GErel"</span>&gt;<br>        &lt;subtype name=<span>"expression"</span> value=<span>"--&amp;gt;"</span>/&gt;<br>    &lt;/relation&gt;<br>    &lt;relation entry1=<span>"49"</span> entry2=<span>"40"</span> <span>type</span>=<span>"GErel"</span>&gt;<br>        &lt;subtype name=<span>"expression"</span> value=<span>"--&amp;gt;"</span>/&gt;<br>    &lt;/relation&gt;<br>    &lt;relation entry1=<span>"49"</span> entry2=<span>"39"</span> <span>type</span>=<span>"GErel"</span>&gt;<br>        &lt;subtype name=<span>"expression"</span> value=<span>"--&amp;gt;"</span>/&gt;<br>    &lt;/relation&gt;<br>    &lt;relation entry1=<span>"74"</span> entry2=<span>"71"</span> <span>type</span>=<span>"PPrel"</span>&gt;<br>        &lt;subtype name=<span>"inhibition"</span> value=<span>"--|"</span>/&gt;<br>        &lt;subtype name=<span>"phosphorylation"</span> value=<span>"+p"</span>/&gt;<br>    &lt;/relation&gt;<br>    &lt;relation entry1=<span>"88"</span> entry2=<span>"84"</span> <span>type</span>=<span>"PPrel"</span>&gt;<br>        &lt;subtype name=<span>"activation"</span> value=<span>"--&amp;gt;"</span>/&gt;<br>    &lt;/relation&gt;<br>    &lt;relation entry1=<span>"165"</span> entry2=<span>"84"</span> <span>type</span>=<span>"PPrel"</span>&gt;<br>        &lt;subtype name=<span>"activation"</span> value=<span>"--&amp;gt;"</span>/&gt;<br>        &lt;subtype name=<span>"binding/association"</span> value=<span>"---"</span>/&gt;<br>    &lt;/relation&gt;<br>    &lt;relation entry1=<span>"165"</span> entry2=<span>"85"</span> <span>type</span>=<span>"PPrel"</span>&gt;<br>        &lt;subtype name=<span>"activation"</span> value=<span>"--&amp;gt;"</span>/&gt;<br>        &lt;subtype name=<span>"binding/association"</span> value=<span>"---"</span>/&gt;<br>    &lt;/relation&gt;<br>    &lt;relation entry1=<span>"165"</span> entry2=<span>"77"</span> <span>type</span>=<span>"PPrel"</span>&gt;<br>        &lt;subtype name=<span>"activation"</span> value=<span>"--&amp;gt;"</span>/&gt;<br>    &lt;/relation&gt;<br>    &lt;relation entry1=<span>"169"</span> entry2=<span>"84"</span> <span>type</span>=<span>"PPrel"</span>&gt;<br>        &lt;subtype name=<span>"inhibition"</span> value=<span>"--|"</span>/&gt;<br>    &lt;/relation&gt;<br>    &lt;relation entry1=<span>"172"</span> entry2=<span>"84"</span> <span>type</span>=<span>"PPrel"</span>&gt;<br>        &lt;subtype name=<span>"inhibition"</span> value=<span>"--|"</span>/&gt;<br>    &lt;/relation&gt;<br>    &lt;relation entry1=<span>"175"</span> entry2=<span>"33"</span> <span>type</span>=<span>"PPrel"</span>&gt;<br>        &lt;subtype name=<span>"binding/association"</span> value=<span>"---"</span>/&gt;<br>    &lt;/relation&gt;<br>    &lt;relation entry1=<span>"176"</span> entry2=<span>"88"</span> <span>type</span>=<span>"PPrel"</span>&gt;<br>        &lt;subtype name=<span>"inhibition"</span> value=<span>"--|"</span>/&gt;<br>    &lt;/relation&gt;<br>    &lt;relation entry1=<span>"65"</span> entry2=<span>"63"</span> <span>type</span>=<span>"PPrel"</span>&gt;<br>        &lt;subtype name=<span>"binding/association"</span> value=<span>"---"</span>/&gt;<br>    &lt;/relation&gt;<br>    &lt;relation entry1=<span>"63"</span> entry2=<span>"62"</span> <span>type</span>=<span>"PPrel"</span>&gt;<br>        &lt;subtype name=<span>"binding/association"</span> value=<span>"---"</span>/&gt;<br>    &lt;/relation&gt;<br>    &lt;relation entry1=<span>"62"</span> entry2=<span>"61"</span> <span>type</span>=<span>"PPrel"</span>&gt;<br>        &lt;subtype name=<span>"binding/association"</span> value=<span>"---"</span>/&gt;<br>    &lt;/relation&gt;<br>    &lt;relation entry1=<span>"64"</span> entry2=<span>"62"</span> <span>type</span>=<span>"PPrel"</span>&gt;<br>        &lt;subtype name=<span>"binding/association"</span> value=<span>"---"</span>/&gt;<br>    &lt;/relation&gt;<br>    &lt;relation entry1=<span>"65"</span> entry2=<span>"71"</span> <span>type</span>=<span>"PPrel"</span>&gt;<br>        &lt;subtype name=<span>"binding/association"</span> value=<span>"---"</span>/&gt;<br>    &lt;/relation&gt;<br>    &lt;relation entry1=<span>"36"</span> entry2=<span>"35"</span> <span>type</span>=<span>"PPrel"</span>&gt;<br>        &lt;subtype name=<span>"binding/association"</span> value=<span>"---"</span>/&gt;<br>    &lt;/relation&gt;<br>    &lt;relation entry1=<span>"60"</span> entry2=<span>"59"</span> <span>type</span>=<span>"PPrel"</span>&gt;<br>        &lt;subtype name=<span>"binding/association"</span> value=<span>"---"</span>/&gt;<br>    &lt;/relation&gt;<br>    &lt;relation entry1=<span>"59"</span> entry2=<span>"58"</span> <span>type</span>=<span>"PPrel"</span>&gt;<br>        &lt;subtype name=<span>"binding/association"</span> value=<span>"---"</span>/&gt;<br>    &lt;/relation&gt;<br>    &lt;relation entry1=<span>"58"</span> entry2=<span>"57"</span> <span>type</span>=<span>"PPrel"</span>&gt;<br>        &lt;subtype name=<span>"binding/association"</span> value=<span>"---"</span>/&gt;<br>    &lt;/relation&gt;<br>    &lt;relation entry1=<span>"36"</span> entry2=<span>"180"</span> <span>type</span>=<span>"PPrel"</span>&gt;<br>        &lt;subtype name=<span>"binding/association"</span> value=<span>"---"</span>/&gt;<br>    &lt;/relation&gt;<br>    &lt;relation entry1=<span>"36"</span> entry2=<span>"181"</span> <span>type</span>=<span>"PPrel"</span>&gt;<br>        &lt;subtype name=<span>"binding/association"</span> value=<span>"---"</span>/&gt;<br>    &lt;/relation&gt;<br>    &lt;relation entry1=<span>"26"</span> entry2=<span>"182"</span> <span>type</span>=<span>"PPrel"</span>&gt;<br>        &lt;subtype name=<span>"binding/association"</span> value=<span>"---"</span>/&gt;<br>    &lt;/relation&gt;<br>    &lt;relation entry1=<span>"187"</span> entry2=<span>"186"</span> <span>type</span>=<span>"PPrel"</span>&gt;<br>    &lt;/relation&gt;<br>    &lt;relation entry1=<span>"187"</span> entry2=<span>"184"</span> <span>type</span>=<span>"PPrel"</span>&gt;<br>        &lt;subtype name=<span>"inhibition"</span> value=<span>"--|"</span>/&gt;<br>    &lt;/relation&gt;<br>    &lt;relation entry1=<span>"187"</span> entry2=<span>"185"</span> <span>type</span>=<span>"PPrel"</span>&gt;<br>        &lt;subtype name=<span>"inhibition"</span> value=<span>"--|"</span>/&gt;<br>    &lt;/relation&gt;<br>    &lt;relation entry1=<span>"184"</span> entry2=<span>"85"</span> <span>type</span>=<span>"PPrel"</span>&gt;<br>        &lt;subtype name=<span>"inhibition"</span> value=<span>"--|"</span>/&gt;<br>    &lt;/relation&gt;<br>    &lt;relation entry1=<span>"185"</span> entry2=<span>"85"</span> <span>type</span>=<span>"PPrel"</span>&gt;<br>        &lt;subtype name=<span>"inhibition"</span> value=<span>"--|"</span>/&gt;<br>    &lt;/relation&gt;<br>    &lt;relation entry1=<span>"198"</span> entry2=<span>"49"</span> <span>type</span>=<span>"PPrel"</span>&gt;<br>        &lt;subtype name=<span>"inhibition"</span> value=<span>"--|"</span>/&gt;<br>    &lt;/relation&gt;<br>    &lt;relation entry1=<span>"199"</span> entry2=<span>"88"</span> <span>type</span>=<span>"PPrel"</span>&gt;<br>        &lt;subtype name=<span>"inhibition"</span> value=<span>"--|"</span>/&gt;<br>    &lt;/relation&gt;<br>    &lt;relation entry1=<span>"199"</span> entry2=<span>"84"</span> <span>type</span>=<span>"PPrel"</span>&gt;<br>        &lt;subtype name=<span>"inhibition"</span> value=<span>"--|"</span>/&gt;<br>    &lt;/relation&gt;<br></code></pre><p data-tool="mdnice编辑器">可以看到，互作关系通过<code>type</code>属性记录，比如 PPrel、GErel 啥的。解释如下：</p><section data-tool="mdnice编辑器"><table><thead><tr><th>attribute value</th><th>explanation</th></tr></thead><tbody><tr><td>ECrel</td><td>enzyme-enzyme relation, indicating two enzymes catalyzing successive reaction steps</td></tr><tr><td>PPrel</td><td>protein-protein interaction, such as binding and modification</td></tr><tr><td>GErel</td><td>gene expression interaction, indicating relation of transcription factor and target gene product</td></tr><tr><td>PCrel</td><td>protein-compound interaction</td></tr><tr><td>maplink</td><td>link to another map</td></tr></tbody></table></section><blockquote data-tool="mdnice编辑器"><span>❝</span><p>⚠️ 每个通路记录的互作关系类型，是不一样的。可能 a 通路只有 <code>ECrel、PPrel</code> 两种互作类型，b 通路则有 <code>PPrel、GErel</code> 等类型。</p><span>❞</span></blockquote><p data-tool="mdnice编辑器">可以看出，我们从每个通路里提取这些<code>relation</code>，便可以重构蛋白/基因-代谢物-通路之间的网络。</p><p data-tool="mdnice编辑器">那么如何下载 KGML 文件呢？关于 KGML 文件的下载，下文会讲。</p><h2 data-tool="mdnice编辑器"><span></span><span>解析 KGML 文件</span><span></span></h2><h4 data-tool="mdnice编辑器"><span></span><span><span></span>R 包安装</span><span></span></h4><pre data-tool="mdnice编辑器"><span></span><code><span>if</span> (!require(<span>"BiocManager"</span>, quietly = TRUE))<br>    install.packages(<span>"BiocManager"</span>)<br><br>BiocManager::install(<span>"KEGGgraph"</span>)<br></code></pre><h4 data-tool="mdnice编辑器"><span></span><span><span></span>下载 KGML</span><span></span></h4><p data-tool="mdnice编辑器">方法 1：通过 KEGG API（爬虫）下载：</p><ul data-tool="mdnice编辑器"><li><section>http://rest.kegg.jp/get/hsa04310/kgml</section></li></ul><p data-tool="mdnice编辑器">方法 2：手动从官网下载：</p><ul data-tool="mdnice编辑器"><li><section>https://www.genome.jp/pathway/hsa04310</section></li></ul><figure data-tool="mdnice编辑器"><img data-ratio="0.46472019464720193" data-src="https://mmbiz.qpic.cn/mmbiz_png/mhoJzVKWSibibK1nibg3nH1SUpgfQWD4O2GuqFkic8N1V82xNmqYTQ2HCIXJnC9IlGUkFAwDbFdMbyekfYdbb0fniaQ/640?wx_fmt=png" data-type="png" data-w="1644" src="https://mmbiz.qpic.cn/mmbiz_png/mhoJzVKWSibibK1nibg3nH1SUpgfQWD4O2GuqFkic8N1V82xNmqYTQ2HCIXJnC9IlGUkFAwDbFdMbyekfYdbb0fniaQ/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">方法 3：使用 KEGGgraph：</p><pre data-tool="mdnice编辑器"><span></span><code><span># library(KEGGgraph)</span><br>tmp &lt;- <span>"hsa04310.xml"</span><br>retrieveKGML(pathwayid=<span>"04310"</span>, organism=<span>"hsa"</span>, destfile=tmp)<br></code></pre><p data-tool="mdnice编辑器">下文采用第 3 种方法进行下载。</p><h4 data-tool="mdnice编辑器"><span></span><span><span></span>解析 KGML</span><span></span></h4><p data-tool="mdnice编辑器">加载 R 包：</p><pre data-tool="mdnice编辑器"><span></span><code>library(KEGGgraph)<br></code></pre><p data-tool="mdnice编辑器">使用<code>方法3</code>下载<code>hsa04310.xml</code>，然后进行解析：</p><pre data-tool="mdnice编辑器"><span></span><code><span># 解析或读取KGML文件（xml格式）</span><br>&gt; mapkG &lt;- parseKGML2Graph(<span>"hsa04310.xml"</span>,expandGenes=TRUE, genesOnly = TRUE)<br><br>&gt; mapkG<br>A graphNEL graph with directed edges<br>Number of Nodes = 170<br>Number of Edges = 1015<br><br><span># 查看节点</span><br>&gt; nodes(mapkG)<br>[1] <span>"hsa:1738"</span>  <span>"hsa:4967"</span>  <span>"hsa:55753"</span> <span>"hsa:1743"</span>  <span>"hsa:8801"</span>  <span>"hsa:8802"</span><br>[7] <span>"hsa:8803"</span>  <span>"hsa:3417"</span>  <span>"hsa:3418"</span>  <span>"hsa:3419"</span>  <span>"hsa:3420"</span>  <span>"hsa:3421"</span><br>[13] <span>"hsa:47"</span>    <span>"hsa:2271"</span>  <span>"hsa:48"</span>    <span>"hsa:50"</span>    <span>"hsa:1431"</span>  <span>"hsa:4190"</span><br>[19] <span>"hsa:4191"</span>  <span>"hsa:5091"</span>  <span>"hsa:5160"</span>  <span>"hsa:5161"</span>  <span>"hsa:5162"</span>  <span>"hsa:1737"</span><br>[25] <span>"hsa:5105"</span>  <span>"hsa:5106"</span>  <span>"hsa:6389"</span>  <span>"hsa:6390"</span>  <span>"hsa:6391"</span>  <span>"hsa:6392"</span><br><br><span># 查看边</span><br>&gt;  edges(mapkG)<br>$`hsa:23236`<br> [1] <span>"hsa:815"</span>  <span>"hsa:816"</span>  <span>"hsa:817"</span>  <span>"hsa:818"</span>  <span>"hsa:5530"</span> <span>"hsa:5532"</span> <span>"hsa:5533"</span> <span>"hsa:5534"</span><br> [9] <span>"hsa:5535"</span> <span>"hsa:5578"</span> <span>"hsa:5579"</span> <span>"hsa:5582"</span><br><br>$`hsa:5330`<br> [1] <span>"hsa:815"</span>  <span>"hsa:816"</span>  <span>"hsa:817"</span>  <span>"hsa:818"</span>  <span>"hsa:5530"</span> <span>"hsa:5532"</span> <span>"hsa:5533"</span> <span>"hsa:5534"</span><br> [9] <span>"hsa:5535"</span> <span>"hsa:5578"</span> <span>"hsa:5579"</span> <span>"hsa:5582"</span><br><br>$`hsa:5331`<br> [1] <span>"hsa:815"</span>  <span>"hsa:816"</span>  <span>"hsa:817"</span>  <span>"hsa:818"</span>  <span>"hsa:5530"</span> <span>"hsa:5532"</span> <span>"hsa:5533"</span> <span>"hsa:5534"</span><br> [9] <span>"hsa:5535"</span> <span>"hsa:5578"</span> <span>"hsa:5579"</span> <span>"hsa:5582"</span><br><br>...<br></code></pre><p data-tool="mdnice编辑器"><code>expandGenes = TRUE</code> 展开基因，每个基因作为一个节点，因为会存在一个 KO 多个基因的情况。</p><p data-tool="mdnice编辑器"><code>genesOnly</code> 控制是否将其他类型的 entry，比如<code>compound</code>，展现在 network 中，默认值为<code>TRUE</code>，如果想研究<code>基因-代谢物</code>的互作，可以改为<code>FALSE</code>。</p><p data-tool="mdnice编辑器">通过<code>parseKGML2Graph</code>这一步，便获取了基因/蛋白间的互作网络。</p><h4 data-tool="mdnice编辑器"><span></span><span><span></span>导出网络数据</span><span></span></h4><pre data-tool="mdnice编辑器"><span></span><code>mapkNodes &lt;- nodes(mapkG)<br>mapkEdges &lt;- edges(mapkG)<br><br>mapkEdges &lt;- mapkEdges[sapply(mapkEdges, length) &gt; <span>0</span>]<br><br>ddd &lt;- lapply(<span>1</span>:length(mapkEdges), <span>function</span>(t){<br>    name &lt;- names(mapkEdges)[t]<br>    len  &lt;- length(mapkEdges[[t]])<br>    do.call(rbind, lapply(<span>1</span>:len, <span>function</span>(n){<br>        c(name, mapkEdges[[t]][n])<br>    }))<br>})<br><br>res &lt;- data.frame(do.call(rbind, ddd))<br><br>write.table(res,  <span>"edges.txt"</span>, sep = <span>"\t"</span>, row.names = <span>F</span>, col.names = <span>F</span>, quote = <span>F</span>)<br>write.table(mapkNodes, <span>"nodes.txt"</span>, sep = <span>"\t"</span>, row.names = <span>F</span>, col.names = <span>F</span>, quote = <span>F</span>)<br></code></pre><p data-tool="mdnice编辑器">后面就可以进行网络可视化啦！不管是使用 R 还是 cytoscape 都可以。示例图如下：</p><figure data-tool="mdnice编辑器"><img data-ratio="0.8080438756855576" data-src="https://mmbiz.qpic.cn/mmbiz_png/mhoJzVKWSibibK1nibg3nH1SUpgfQWD4O2GfibPSDHhG1H2Tbb8icXiat9cXzKWeMKNWwaAI33Au30sicflfObNRT9uSg/640?wx_fmt=png" data-type="png" data-w="1094" src="https://mmbiz.qpic.cn/mmbiz_png/mhoJzVKWSibibK1nibg3nH1SUpgfQWD4O2GfibPSDHhG1H2Tbb8icXiat9cXzKWeMKNWwaAI33Au30sicflfObNRT9uSg/640?wx_fmt=png"></figure><h2 data-tool="mdnice编辑器"><span></span><span>联系站长</span><span></span></h2><blockquote data-tool="mdnice编辑器"><span>❝</span><p>OK，今天的分享到此为止。您的<code>关注、点赞、在看、转发</code>是对站长最大的鼓励和支持哈。</p><span>❞</span></blockquote><blockquote data-tool="mdnice编辑器"><span>❝</span><p>最后，欢迎各位童鞋来 QQ 群 <code>837738558</code> 进行<code>交流学习</code>、<code>唠嗑、资料共享</code>。</p><span>❞</span></blockquote><figure data-tool="mdnice编辑器"><img data-ratio="1.2248062015503876" data-src="https://mmbiz.qpic.cn/mmbiz_png/mhoJzVKWSibibK1nibg3nH1SUpgfQWD4O2G1FvF8BS6RyPhCF4RkOe6qy1ADyZZ9Mr78rhPic1EqniaTdgibj0qssI4A/640?wx_fmt=png" data-type="png" data-w="516" src="https://mmbiz.qpic.cn/mmbiz_png/mhoJzVKWSibibK1nibg3nH1SUpgfQWD4O2G1FvF8BS6RyPhCF4RkOe6qy1ADyZZ9Mr78rhPic1EqniaTdgibj0qssI4A/640?wx_fmt=png"><figcaption><span></span>我们的企鹅群</figcaption><figcaption><br></figcaption></figure></section><section><mp-common-profile data-pluginname="mpprofile" data-weui-theme="light" data-id="MzU1NTk0MTUxMg==" data-headimg="http://mmbiz.qpic.cn/mmbiz_png/mhoJzVKWSibicV5ezibIjic3zhPgzQcTD8N0hm3q2fO2QgBoVFIuRWy6BKffGjfXOzI7foLDlyrHWfRUMkicOCSKq4g/0?wx_fmt=png" data-nickname="生信益站" data-alias="" data-signature="生物信息或基因测序数据分析、软件算法、科研绘图、Python/Perl/R代码分享。" data-from="0" data-is_biz_ban="0"></mp-common-profile></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/HcbLpa-N1NFEdJ6gLCIEqw",target="_blank" rel="noopener noreferrer">原文链接</a>
