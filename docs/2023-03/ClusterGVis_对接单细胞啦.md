---
title: "ClusterGVis 对接单细胞啦"
date: 2023-03-11T13:50:35Z
draft: ["false"]
tags: [
  "fetched",
  "老俊俊的生信笔记"
]
categories: ["Acdemic"]
---
ClusterGVis 对接单细胞啦 by 老俊俊的生信笔记
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-mpa-powered-by="yiban.io"><h4 data-tool="mdnice编辑器"><span></span></h4><section><mp-common-profile data-pluginname="mpprofile" data-weui-theme="light" data-id="MzkyMTI1MTYxNA==" data-headimg="http://mmbiz.qpic.cn/mmbiz_png/G5jjcE4usey42oX5qyLTVibLRO9dz8ic5G4TpEHQc9rICYlpS4MHg6Et8cgXrQDqibvibXombicTro8t9cekJRlDBcw/0?wx_fmt=png" data-nickname="老俊俊的生信笔记" data-alias="JunJunLab" data-signature="老俊俊的生信技能和知识分享,我不是巨人,但你可以站在我的肩膀上更进一步!" data-from="0" data-is_biz_ban="0"></mp-common-profile></section></section><section><p><img data-ratio="0.2" data-src="https://mmbiz.qpic.cn/mmbiz_gif/f5u8u3lDeLchGaIcFTOuEzUYJyA2UibBrEGgY7cmj81kUv4XyFIK8Juq8VMFesnjFmm3s8mnb1W5ht3DV65VcFQ/640?wx_fmt=gif" data-type="gif" data-w="640" src="https://mmbiz.qpic.cn/mmbiz_gif/f5u8u3lDeLchGaIcFTOuEzUYJyA2UibBrEGgY7cmj81kUv4XyFIK8Juq8VMFesnjFmm3s8mnb1W5ht3DV65VcFQ/640?wx_fmt=gif"><br></p></section><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><h4 data-tool="mdnice编辑器"><span></span></h4><h2 data-tool="mdnice编辑器"><span><span>1</span></span><span>引言</span></h2><blockquote data-tool="mdnice编辑器"><p><strong>ClusterGVis</strong> 输入你的表达矩阵,便可以为你聚类,富集分析,最后绘图。对于 <strong>bulk-RNA</strong> 的表达矩阵比较友好,但是对于单细胞数据来说,还得自己费点功夫去整理表达矩阵以及相关数据。对于大多数单细胞的分析人员就已经望而却步了。不如用 <strong>seurat</strong> 自带的 <strong>doHeatmap</strong> 画算了。为了解决这个问题,于是增加了一些修改,使其更方便的对接单细胞的数据。此外还增加了可以改变 <strong>cluster</strong> 顺序的功能。</p></blockquote><blockquote data-tool="mdnice编辑器"><p>增加了 <strong>prepareDataFromscRNA</strong> 函数来整理准备单细胞的数据,作为 <strong>ClusterGVis</strong> 下游的输入。</p></blockquote><p data-tool="mdnice编辑器"><strong>github 链接:</strong></p><blockquote data-tool="mdnice编辑器"><p><strong>https://github.com/junjunlab/ClusterGVis</strong></p></blockquote><p data-tool="mdnice编辑器"><strong>测试数据链接:</strong></p><blockquote data-tool="mdnice编辑器"><p><em>链接：https://pan.baidu.com/s/1i6aOIGsDKxkmYGcPls9YVg提取码：7htg</em></p></blockquote><h2 data-tool="mdnice编辑器"><span><span>2</span></span><span>安装</span></h2><p data-tool="mdnice编辑器">重新安装获取新功能:</p><pre data-tool="mdnice编辑器"><span></span><code><span># Note: please update your ComplexHeatmap to the latest version!</span><br><span># install.packages("devtools")</span><br>devtools::install_github(<span>"junjunlab/ClusterGVis"</span>)<br></code></pre><h2 data-tool="mdnice编辑器"><span><span>3</span></span><span>使用示例</span></h2><p data-tool="mdnice编辑器">先给单细胞注释一下 <strong>(上游参考自己的或者网上教程,不再赘述)</strong> ,然后找个 marker 基因:</p><pre data-tool="mdnice编辑器"><span></span><code><span>library</span>(ClusterGVis)<br><span>library</span>(org.Hs.eg.db)<br><br><span># add cell type</span><br>new.cluster.ids &lt;- c(<span>"Naive CD4 T"</span>, <span>"CD14+ Mono"</span>, <span>"Memory CD4 T"</span>, <span>"B"</span>, <span>"CD8 T"</span>, <span>"FCGR3A+ Mono"</span>,<br>                     <span>"NK"</span>, <span>"DC"</span>, <span>"Platelet"</span>)<br>names(new.cluster.ids) &lt;- levels(pbmc)<br>pbmc &lt;- RenameIdents(pbmc, new.cluster.ids)<br><br><span># find markers for every cluster compared to all remaining cells</span><br><span># report only the positive ones</span><br>pbmc.markers.all &lt;- Seurat::FindAllMarkers(pbmc,<br>                               only.pos = <span>TRUE</span>,<br>                               min.pct = <span>0.25</span>,<br>                               logfc.threshold = <span>0.25</span>)<br><br><span># get top 10 genes</span><br>pbmc.markers &lt;- pbmc.markers.all %&gt;%<br>  dplyr::group_by(cluster) %&gt;%<br>  dplyr::top_n(n = <span>20</span>, wt = avg_log2FC)<br><br><span># check</span><br>head(pbmc.markers)<br><br><span># # A tibble: 6 × 7</span><br><span># # Groups:   cluster [1]</span><br><span>#       p_val avg_log2FC pct.1 pct.2 p_val_adj cluster     gene</span><br><span>#       &lt;dbl&gt;      &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt; &lt;fct&gt;       &lt;chr&gt;</span><br><span>#   1 1.81e-144      0.735 1     0.991 2.48e-140 Naive CD4 T RPS12</span><br><span># 2 5.51e-123      0.744 0.997 0.975 7.55e-119 Naive CD4 T RPS25</span><br><span># 3 3.66e-117      0.744 0.994 0.971 5.02e-113 Naive CD4 T RPL9</span><br><span># 4 2.75e-116      0.740 0.996 0.964 3.77e-112 Naive CD4 T RPL31</span><br><span># 5 3.86e-110      0.779 0.99  0.977 5.29e-106 Naive CD4 T RPS3A</span><br><span># 6 1.74e-109      1.07  0.897 0.593 2.39e-105 Naive CD4 T LDHB</span><br></code></pre><p data-tool="mdnice编辑器">准备数据:</p><blockquote data-tool="mdnice编辑器"><p><strong>prepareDataFromscRNA</strong> 需要数据你的 <strong>seurat</strong> 对象及差异结果即可。<strong>showAverage</strong> 参数设为 <em>TRUE</em> 则表示对 <strong>基因细胞亚群一样的细胞取均值进行绘图,否则就是所有细胞进行绘图</strong>。默认使用 seurat 对象的 <strong>RNA</strong> <strong>assay</strong> 的 <strong>data</strong> 数据。</p></blockquote><pre data-tool="mdnice编辑器"><span></span><code><span># prepare data from seurat object</span><br>st.data &lt;- prepareDataFromscRNA(object = pbmc,<br>                                diffData = pbmc.markers,<br>                                showAverage = <span>TRUE</span>)<br><br><span># check</span><br>str(st.data)<br><br><span># List of 5</span><br><span># $ wide.res:'data.frame': 147 obs. of  11 variables:</span><br><span>#   ..$ gene        : chr [1:147] "RPS12" "RPS25" "RPL9" "RPL31" ...</span><br><span># ..$ Naive CD4 T : num [1:147] 1.64 1.57 1.48 1.63 1.57 ...</span><br><span># ..$ CD14+ Mono  : num [1:147] -0.458 -0.536 -0.746 -0.712 -0.872 ...</span><br><span># ..$ Memory CD4 T: num [1:147] 1.128 1.135 0.822 0.983 0.759 ...</span><br><span># ..$ B           : num [1:147] 0.517 0.671 0.979 0.671 0.936 ...</span><br><span># ..$ CD8 T       : num [1:147] 0.426 0.417 0.557 0.445 0.397 ...</span><br><span># ..$ FCGR3A+ Mono: num [1:147] -0.592 -0.627 -0.679 -0.836 -0.776 ...</span><br><span># ..$ NK          : num [1:147] -0.897 -0.768 -0.478 -0.403 -0.251 ...</span><br><span># ..$ DC          : num [1:147] -0.3 -0.371 -0.359 -0.265 -0.2 ...</span><br><span># ..$ Platelet    : num [1:147] -1.46 -1.49 -1.58 -1.51 -1.56 ...</span><br><span># ..$ cluster     : chr [1:147] "1" "1" "1" "1" ...</span><br><span># $ long.res:'data.frame': 1323 obs. of  5 variables:</span><br><span>#   ..$ cluster     : chr [1:1323] "1" "1" "1" "1" ...</span><br><span># ..$ gene        : chr [1:1323] "RPS12" "RPS25" "RPL9" "RPL31" ...</span><br><span># ..$ cell_type   : Factor w/ 9 levels "Naive CD4 T",..: 1 1 1 1 1 1 1 1 1 1 ...</span><br><span># ..$ norm_value  : num [1:1323] 1.64 1.57 1.48 1.63 1.57 ...</span><br><span># ..$ cluster_name: Factor w/ 9 levels "cluster 1 (20)",..: 1 1 1 1 1 1 1 1 1 1 ...</span><br><span># $ type    : chr "scRNAdata"</span><br><span># $ geneMode: chr "average"</span><br><span># $ geneType: chr "unique|_"</span><br></code></pre><blockquote data-tool="mdnice编辑器"><p>可以看到整理成 <strong>clusterData</strong> 函数输出的结果一样。包括一个长数据和一个宽数据的数据框。你也可以拿这个数据去自己绘图。</p></blockquote><p data-tool="mdnice编辑器">顺便对 marker 基因做个富集分析,我们 p 值取大一点:</p><pre data-tool="mdnice编辑器"><span></span><code><span># enrich for clusters</span><br>enrich &lt;- enrichCluster(object = st.data,<br>                        OrgDb = org.Hs.eg.db,<br>                        type = <span>"BP"</span>,<br>                        organism = <span>"hsa"</span>,<br>                        pvalueCutoff = <span>0.5</span>,<br>                        topn = <span>5</span>,<br>                        seed = <span>5201314</span>)<br><br><span># check</span><br>head(enrich)<br><br><span>#         group                                          Description       pvalue    ratio</span><br><span># GO:0002181    C1                              cytoplasmic translation 8.388814e-11 38.88889</span><br><span># GO:0030217    C1                               T cell differentiation 2.220845e-07 33.33333</span><br><span># GO:0045061    C1                              thymic T cell selection 1.103890e-06 16.66667</span><br><span># GO:0033077    C1                     T cell differentiation in thymus 1.163815e-06 22.22222</span><br><span># GO:0030098    C1                           lymphocyte differentiation 1.694887e-06 33.33333</span><br><span># GO:0032103    C2 positive regulation of response to external stimulus 3.957596e-10 45.00000</span><br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span>绘图</span><span></span></h3><p data-tool="mdnice编辑器">画个折线图:</p><pre data-tool="mdnice编辑器"><span></span><code><span># add gene name</span><br>markGenes = unique(pbmc.markers$gene)[sample(<span>1</span>:length(unique(pbmc.markers$gene)),<span>40</span>,<br>                                             replace = <span>F</span>)]<br><br><span># line plot</span><br>visCluster(object = st.data,<br>           plot.type = <span>"line"</span>)<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.8487467588591184" data-src="https://mmbiz.qpic.cn/mmbiz_png/G5jjcE4usewnIJNhic7zqmEHNjfCYj9SJDlNAROkicthgbBDl9oyGyvV4FGiaNicBYEB4hFRexVrOI3jiacndawxhhw/640?wx_fmt=png" data-type="png" data-w="1157" src="https://mmbiz.qpic.cn/mmbiz_png/G5jjcE4usewnIJNhic7zqmEHNjfCYj9SJDlNAROkicthgbBDl9oyGyvV4FGiaNicBYEB4hFRexVrOI3jiacndawxhhw/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">热图:</p><blockquote data-tool="mdnice编辑器"><p><strong>cluster.order</strong> 参数调整聚类顺序。</p></blockquote><pre data-tool="mdnice编辑器"><span></span><code><span># heatmap plot</span><br>pdf(<span>'sc1.pdf'</span>,height = <span>10</span>,width = <span>6</span>,onefile = <span>F</span>)<br>visCluster(object = st.data,<br>           plot.type = <span>"heatmap"</span>,<br>           column_names_rot = <span>45</span>,<br>           markGenes = markGenes,<br>           cluster.order = c(<span>1</span>:<span>9</span>))<br>dev.off()<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="1.6597353497164462" data-src="https://mmbiz.qpic.cn/mmbiz_png/G5jjcE4usewnIJNhic7zqmEHNjfCYj9SJElWDLSHvfQtHUBWV9cZBfwAJAYW5h2RZjT9pgJrGKY7LzDzIS6rtibA/640?wx_fmt=png" data-type="png" data-w="529" src="https://mmbiz.qpic.cn/mmbiz_png/G5jjcE4usewnIJNhic7zqmEHNjfCYj9SJElWDLSHvfQtHUBWV9cZBfwAJAYW5h2RZjT9pgJrGKY7LzDzIS6rtibA/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">添加富集注释:</p><pre data-tool="mdnice编辑器"><span></span><code><span># add bar plot</span><br>pdf(<span>'sc2.pdf'</span>,height = <span>10</span>,width = <span>14</span>,onefile = <span>F</span>)<br>visCluster(object = st.data,<br>           plot.type = <span>"both"</span>,<br>           column_names_rot = <span>45</span>,<br>           show_row_dend = <span>F</span>,<br>           markGenes = markGenes,<br>           markGenes.side = <span>"left"</span>,<br>           annoTerm.data = enrich,<br>           line.side = <span>"left"</span>,<br>           cluster.order = c(<span>1</span>:<span>9</span>),<br>           go.col = rep(jjAnno::useMyCol(<span>"stallion"</span>,n = <span>9</span>),each = <span>5</span>),<br>           add.bar = <span>T</span>)<br>dev.off()<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.707258064516129" data-src="https://mmbiz.qpic.cn/mmbiz_png/G5jjcE4usewnIJNhic7zqmEHNjfCYj9SJET0icqMjW5kZmujKavgD87lelOXHQiaGN4HzibmvghzWQjoHXfbliaDROg/640?wx_fmt=png" data-type="png" data-w="1240" src="https://mmbiz.qpic.cn/mmbiz_png/G5jjcE4usewnIJNhic7zqmEHNjfCYj9SJET0icqMjW5kZmujKavgD87lelOXHQiaGN4HzibmvghzWQjoHXfbliaDROg/640?wx_fmt=png"></figure><h3 data-tool="mdnice编辑器"><span></span><span>基因名重复问题</span><span></span></h3><blockquote data-tool="mdnice编辑器"><p>你会发现我们每个亚群取了 20,marker 基因绘图,但是从图里看到有些亚群并没有 20 个基因,原因是差异分析时,有多个一样的基因在多个亚群同时是表达差异的。默认会对其进行去重。可能富集的时候会少基因,当然你也可以使用 <strong>keep.uniqGene=FALSE</strong> 来保留重复基因。</p></blockquote><pre data-tool="mdnice编辑器"><span></span><code><span># retain duplicate diff gene in multiple clusters</span><br>st.data &lt;- prepareDataFromscRNA(object = pbmc,<br>                                diffData = pbmc.markers,<br>                                showAverage = <span>TRUE</span>,<br>                                keep.uniqGene = <span>FALSE</span>,<br>                                sep = <span>"_"</span>)<br><br><span># check</span><br>df &lt;- st.data$wide.res<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.2261904761904762" data-src="https://mmbiz.qpic.cn/mmbiz_png/G5jjcE4usewnIJNhic7zqmEHNjfCYj9SJY1RcHO0S6ZpypQZPqiaJ4NRLIA97koPxQKY0QnmKB0lfj0EvsMv2Oiaw/640?wx_fmt=png" data-type="png" data-w="1092" src="https://mmbiz.qpic.cn/mmbiz_png/G5jjcE4usewnIJNhic7zqmEHNjfCYj9SJY1RcHO0S6ZpypQZPqiaJ4NRLIA97koPxQKY0QnmKB0lfj0EvsMv2Oiaw/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">比如 <strong>CD3D</strong> 这个基因有三个重复,<strong>表示在三个亚群都有显著性差异</strong>。</p><pre data-tool="mdnice编辑器"><span></span><code><span># line plot</span><br>visCluster(object = st.data,<br>           plot.type = <span>"line"</span>)<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.8614035087719298" data-src="https://mmbiz.qpic.cn/mmbiz_png/G5jjcE4usewnIJNhic7zqmEHNjfCYj9SJsZ26sNFGaz2q5xia7apzb0pte4l2vbxYp8VdTV3z1qVibLicQlic7hjhiaQ/640?wx_fmt=png" data-type="png" data-w="1140" src="https://mmbiz.qpic.cn/mmbiz_png/G5jjcE4usewnIJNhic7zqmEHNjfCYj9SJsZ26sNFGaz2q5xia7apzb0pte4l2vbxYp8VdTV3z1qVibLicQlic7hjhiaQ/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">我们再来看折线图数量就都是 20 了。</p><p data-tool="mdnice编辑器">这些基因在热图上也都会展示:</p><pre data-tool="mdnice编辑器"><span></span><code><span># heatmap plot</span><br>pdf(<span>'sc3.pdf'</span>,height = <span>10</span>,width = <span>6</span>,onefile = <span>F</span>)<br>visCluster(object = st.data,<br>           plot.type = <span>"heatmap"</span>,<br>           column_names_rot = <span>45</span>,<br>           markGenes = c(<span>"CD3D"</span>,<span>"CD3D_1"</span>,<span>"CD3D_2"</span>),<br>           cluster.order = c(<span>1</span>:<span>9</span>))<br>dev.off()<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="1.6749049429657794" data-src="https://mmbiz.qpic.cn/mmbiz_png/G5jjcE4usewnIJNhic7zqmEHNjfCYj9SJEN7DmsUavexmxWneic65wTv66cyLgN19mZSDhYKuuwVFIWd3wokMSWQ/640?wx_fmt=png" data-type="png" data-w="526" src="https://mmbiz.qpic.cn/mmbiz_png/G5jjcE4usewnIJNhic7zqmEHNjfCYj9SJEN7DmsUavexmxWneic65wTv66cyLgN19mZSDhYKuuwVFIWd3wokMSWQ/640?wx_fmt=png"></figure><h3 data-tool="mdnice编辑器"><span></span><span>绘制所有细胞</span><span></span></h3><blockquote data-tool="mdnice编辑器"><p>当然你也可以展示所有细胞基因的表达热图。可能绘图需要一点时间。</p></blockquote><pre data-tool="mdnice编辑器"><span></span><code><span># no average cells</span><br>pbmc.markers1 &lt;- pbmc.markers.all %&gt;%<br>  dplyr::group_by(cluster) %&gt;%<br>  dplyr::top_n(n = <span>6</span>, wt = avg_log2FC)<br><br><span># retain duplicate diff gene in multiple clusters</span><br>st.data &lt;- prepareDataFromscRNA(object = pbmc,<br>                                diffData = pbmc.markers1,<br>                                showAverage = <span>FALSE</span>)<br><br><span># check</span><br>str(st.data)<br><span># List of 4</span><br><span># $ wide.res:'data.frame': 51 obs. of  2640 variables:</span><br><span>#   ..$ gene                         : chr [1:51] "LEF1" "PRKCQ-AS1" "CD3D" "LDHB" ...</span><br><span># ..$ AAACGCTGTAGCCA-1|Naive CD4 T : num [1:51] -0.434 -0.439 0.718 -1.314 -0.479 ...</span><br><span># ..$ AAACTTGATCCAGA-1|Naive CD4 T : num [1:51] -0.434 -0.439 0.763 1.225 2.914 ...</span><br><span># ..$ AAAGAGACGAGATA-1|Naive CD4 T : num [1:51] -0.434 1.927 1.67 1.044 -0.479 ...</span><br><span># .. [list output truncated]</span><br><span># $ long.res:'data.frame': 134538 obs. of  5 variables:</span><br><span>#   ..$ cluster     : chr [1:134538] "1" "1" "1" "1" ...</span><br><span># ..$ gene        : chr [1:134538] "LEF1" "PRKCQ-AS1" "CD3D" "LDHB" ...</span><br><span># ..$ cell_type   : chr [1:134538] "Naive CD4 T" "Naive CD4 T" "Naive CD4 T" "Naive CD4 T" ...</span><br><span># ..$ norm_value  : num [1:134538] -0.434 -0.439 0.718 -1.314 -0.479 ...</span><br><span># ..$ cluster_name: Factor w/ 9 levels "cluster 1 (6)",..: 1 1 1 1 1 1 1 1 1 1 ...</span><br><span># $ type    : chr "scRNAdata"</span><br><span># $ geneMode: chr "all"</span><br><span># $ geneType: chr "unique|_"</span><br></code></pre><p data-tool="mdnice编辑器">热图:</p><blockquote data-tool="mdnice编辑器"><p>记得设置 <strong>show_column_names = F</strong>。</p></blockquote><pre data-tool="mdnice编辑器"><span></span><code><span># heatmap plot</span><br>pdf(<span>'sc4.pdf'</span>,height = <span>10</span>,width = <span>8</span>,onefile = <span>F</span>)<br>visCluster(object = st.data,<br>           plot.type = <span>"heatmap"</span>,<br>           markGenes = unique(pbmc.markers1$gene),<br>           column_title_rot = <span>45</span>,<br>           cluster.order = <span>1</span>:<span>9</span>,<br>           show_column_names = <span>F</span>)<br>dev.off()<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="1.2485795454545454" data-src="https://mmbiz.qpic.cn/mmbiz_png/G5jjcE4usewnIJNhic7zqmEHNjfCYj9SJic5ziblZP5iaPiaGDiaFN7HPFjxej5CTfwjiazyVAYM8X0B4kLfe7yeiboHfQ/640?wx_fmt=png" data-type="png" data-w="704" src="https://mmbiz.qpic.cn/mmbiz_png/G5jjcE4usewnIJNhic7zqmEHNjfCYj9SJic5ziblZP5iaPiaGDiaFN7HPFjxej5CTfwjiazyVAYM8X0B4kLfe7yeiboHfQ/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">改变亚群顺序和修改注释颜色:</p><pre data-tool="mdnice编辑器"><span></span><code><span># change celltype order and color</span><br>pdf(<span>'sc5.pdf'</span>,height = <span>10</span>,width = <span>8</span>,onefile = <span>F</span>)<br>visCluster(object = st.data,<br>           plot.type = <span>"heatmap"</span>,<br>           markGenes = unique(pbmc.markers1$gene),<br>           column_title_rot = <span>45</span>,<br>           cluster.order = <span>1</span>:<span>9</span>,<br>           show_column_names = <span>F</span>,<br>           sample.cell.order = rev(new.cluster.ids),<br>           sample.col = jjAnno::useMyCol(<span>"paired"</span>,n = <span>9</span>))<br>dev.off()<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="1.2352112676056337" data-src="https://mmbiz.qpic.cn/mmbiz_png/G5jjcE4usewnIJNhic7zqmEHNjfCYj9SJbAbPNyc9QaQqeQgnDsqEf0vWxFZQiaJf7X7FVx0tJpAommamKeVuuSA/640?wx_fmt=png" data-type="png" data-w="710" src="https://mmbiz.qpic.cn/mmbiz_png/G5jjcE4usewnIJNhic7zqmEHNjfCYj9SJbAbPNyc9QaQqeQgnDsqEf0vWxFZQiaJf7X7FVx0tJpAommamKeVuuSA/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">添加富集注释:</p><pre data-tool="mdnice编辑器"><span></span><code><span># add GO annotation</span><br>pdf(<span>'sc6.pdf'</span>,height = <span>12</span>,width = <span>16</span>,onefile = <span>F</span>)<br>visCluster(object = st.data,<br>           plot.type = <span>"both"</span>,<br>           column_title_rot = <span>45</span>,<br>           markGenes = unique(pbmc.markers1$gene),<br>           markGenes.side = <span>"left"</span>,<br>           annoTerm.data = enrich,<br>           show_column_names = <span>F</span>,<br>           line.side = <span>"left"</span>,<br>           cluster.order = c(<span>1</span>:<span>9</span>),<br>           add.bar = <span>T</span>)<br>dev.off()<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.7474489795918368" data-src="https://mmbiz.qpic.cn/mmbiz_png/G5jjcE4usewnIJNhic7zqmEHNjfCYj9SJr7IAvTcHibghIk2jO8oSFICQQFQP02VCEf1Vm2wsNNrGXY49OZ0WCVw/640?wx_fmt=png" data-type="png" data-w="1176" src="https://mmbiz.qpic.cn/mmbiz_png/G5jjcE4usewnIJNhic7zqmEHNjfCYj9SJr7IAvTcHibghIk2jO8oSFICQQFQP02VCEf1Vm2wsNNrGXY49OZ0WCVw/640?wx_fmt=png"></figure><h2 data-tool="mdnice编辑器"><span><span>4</span></span><span>结尾</span></h2><blockquote data-tool="mdnice编辑器"><p><strong>如果有任何疑问或者建议,欢迎在 github 留言!</strong></p></blockquote><hr data-tool="mdnice编辑器"><p data-tool="mdnice编辑器">欢迎加入生信交流群。加我微信我也拉你进 <strong>微信群聊</strong> <strong>老俊俊生信交流群</strong> <strong>(微信交流群需收取 20 元入群费用,一旦交费,拒不退还!(防止骗子和便于管理))</strong> 。QQ 群可免费加入, 记得进群按格式修改备注哦。</p><section data-tool="mdnice编辑器"><section><p><strong>老俊俊微信：</strong></p><figure><img data-ratio="1" data-src="https://mmbiz.qpic.cn/mmbiz_png/G5jjcE4usewnIJNhic7zqmEHNjfCYj9SJeHBNXlGEWWBk1uSiamEE7yIlWQBMUvH6Gk7XEaqc6vISCMAwAtyAj2Q/640?wx_fmt=png" data-type="png" data-w="430" src="https://mmbiz.qpic.cn/mmbiz_png/G5jjcE4usewnIJNhic7zqmEHNjfCYj9SJeHBNXlGEWWBk1uSiamEE7yIlWQBMUvH6Gk7XEaqc6vISCMAwAtyAj2Q/640?wx_fmt=png"></figure><figure><img data-ratio="1.3668430335097002" data-src="https://mmbiz.qpic.cn/mmbiz_png/G5jjcE4usewnIJNhic7zqmEHNjfCYj9SJRsTSsialf90KXqY53KqjX5OATMc2TVCiaEPKKZ1iaUpIfEdO1fWyIPHLg/640?wx_fmt=png" data-type="png" data-w="567" src="https://mmbiz.qpic.cn/mmbiz_png/G5jjcE4usewnIJNhic7zqmEHNjfCYj9SJRsTSsialf90KXqY53KqjX5OATMc2TVCiaEPKKZ1iaUpIfEdO1fWyIPHLg/640?wx_fmt=png"></figure></section><section><p><strong>知识星球：</strong></p><figure><img data-ratio="1.5896226415094339" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/G5jjcE4usewnIJNhic7zqmEHNjfCYj9SJiaojHuFeZOGic8cpR24e0ic8gXU8a8P6006d0sJKnGHnRkCFw3w4ficwTQ/640?wx_fmt=jpeg" data-type="jpeg" data-w="1060" src="https://mmbiz.qpic.cn/mmbiz_jpg/G5jjcE4usewnIJNhic7zqmEHNjfCYj9SJiaojHuFeZOGic8cpR24e0ic8gXU8a8P6006d0sJKnGHnRkCFw3w4ficwTQ/640?wx_fmt=jpeg"></figure></section></section><hr data-tool="mdnice编辑器"><p data-tool="mdnice编辑器"><br></p><center data-tool="mdnice编辑器"><strong> 往期回顾目录</strong></center><blockquote data-tool="mdnice编辑器"><p><br></p><center><strong><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247508288&amp;idx=1&amp;sn=749071718786c08fc380247fa69d25ce&amp;chksm=c1849b31f6f312271573bf922caf4e7cbce0add38f4da9e45540197da45ab35a3bdcbf93c2e2&amp;token=715702970&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">About BioSeqUtils</a></strong></center><strong><center><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247508252&amp;idx=1&amp;sn=d7461dc312dba82b1a795331955e9fac&amp;chksm=c1849b6df6f3127b4a4e9bcad885fff6eb4b69dc62ca29dc90d0935a39f2c160c6c78ea761e9&amp;token=1422368458&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">基因特征序列提取 R 包 BioSeqUtils</a></center></strong><strong><center><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247508219&amp;idx=1&amp;sn=6e27204e5a3d6bb79eb0ced2ca7e9272&amp;chksm=c1849a8af6f3139c62ae324ee45cab8cc951ef37dd18a512703d822c61f9c3e3dfa15fe49c2f&amp;token=420358871&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">关于 chatGPT 无法连接的问题</a></center></strong><strong><center><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247508197&amp;idx=1&amp;sn=a3af647485066ec8d27aba73b2bc6801&amp;chksm=c1849a94f6f31382a80f69c768d380710c9ef4cd4f348ba3258f545fea1831c38f1d1cf086ca&amp;token=282299666&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">问问 chatGPT 来提取最长转录本及基因序列</a></center></strong><strong><center><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247508126&amp;idx=1&amp;sn=99fb4220166f8865762a6c2eb495ebe4&amp;chksm=c1849aeff6f313f98b412186a5139e72ebb147f1899c00e7919899be6849f604667d987a1090&amp;token=603865019&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">GseaVis 一键对接 GSEA 软件结果并可视化</a></center></strong><strong><center><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247507943&amp;idx=1&amp;sn=2dc950650892f93a53eb1ef9abab6555&amp;chksm=c184e596f6f36c8073acb3b614897062249c9b51c3aff4657dc9156670a9ff7a99df78dc7787&amp;token=603865019&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">同学你又在画 GSEA?</a></center></strong><strong><center><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247507849&amp;idx=1&amp;sn=9b1a2afe2afce59cb22e3e3994a915d2&amp;chksm=c184e5f8f6f36cee333855c25536ec92c5770d7d58220af9eb75c3a04a5bce088b8bb1205b41&amp;token=495330596&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">R 语言中的 S3/S4 类</a></center></strong><strong><center><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247507821&amp;idx=1&amp;sn=183615ca33d377c497db95632819dddb&amp;chksm=c184e51cf6f36c0a29d0c6a074eb6aadeddf5d1a2284860f2dcd6c4a6b370d0352acba806dcc&amp;token=495330596&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">transPlotR 展示代表性转录本</a></center></strong><strong><center><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247507775&amp;idx=1&amp;sn=fd045c97d302621d4760dbed6cf0929c&amp;chksm=c184e54ef6f36c584b7a06b422c6a822f308c511b1bd8e2911720f4667303e7d45ff0979a5d1&amp;token=158906776&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">云雨一下?</a></center></strong><strong><center><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247507735&amp;idx=1&amp;sn=d8236c12a07beecc5d6c181b196a9a78&amp;chksm=c184e566f6f36c7072f382be27259127b4fa9c0b1228c891f5cfc35869861b3d9b8f6e9b0824&amp;token=158906776&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">bugs 报告和修复</a></center><center><br></center></strong></blockquote></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/FN1hlOWRWJ6XsmB_LxZpfA",target="_blank" rel="noopener noreferrer">原文链接</a>
