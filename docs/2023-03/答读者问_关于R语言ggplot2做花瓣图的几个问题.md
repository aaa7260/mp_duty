---
title: "答读者问：关于R语言ggplot2做花瓣图的几个问题"
date: 2023-03-18T01:33:11Z
draft: ["false"]
tags: [
  "fetched",
  "小明的数据分析笔记本"
]
categories: ["Acdemic"]
---
答读者问：关于R语言ggplot2做花瓣图的几个问题 by 小明的数据分析笔记本
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-mpa-powered-by="yiban.io"><figure data-tool="mdnice编辑器"><img data-ratio="0.48954489544895446" data-src="https://mmbiz.qpic.cn/mmbiz_png/t1wZDoUyFk7T18V7nGHTtBFgV76K7UXjqE8qwTujPtI6SuWhiaWvBL8E6StFcMEGsCJ27927rjoLDXW8QrHqRaA/640?wx_fmt=png" data-type="png" data-w="813" src="https://mmbiz.qpic.cn/mmbiz_png/t1wZDoUyFk7T18V7nGHTtBFgV76K7UXjqE8qwTujPtI6SuWhiaWvBL8E6StFcMEGsCJ27927rjoLDXW8QrHqRaA/640?wx_fmt=png"><figcaption>image.png</figcaption></figure><blockquote data-tool="mdnice编辑器"><p>有读者在公众号留言问到之前在公众号分享的R语言ggplot做花瓣图的代码相关问题，首先非常感谢这位读者能够这么认真的看我分享的内容，今天的推文主要回答一下这几个问题</p></blockquote><h2 data-tool="mdnice编辑器"><span></span><span>先回答第二个问题</span><span></span><span> </span></h2><blockquote data-tool="mdnice编辑器"><p>df1模拟生成中，1:18, 10, 180这些是怎么决定的呢？是应为df里面分组数量决定的吗？总是用180除以分组数量等分圆吗？</p></blockquote><p data-tool="mdnice编辑器">我这里的花瓣图是通过构造正弦函数的数据，然后画图展示正弦函数，然后再利用R语言ggplot2的极坐标实现的，</p><p data-tool="mdnice编辑器">比如</p><p data-tool="mdnice编辑器">y=sin(x) 在0到pi这个区间内就是一个峰</p><p data-tool="mdnice编辑器">y = sin(2x)在0到pi这个区间内是2个峰，但是2个峰有正有负，所以我们取绝对值</p><p data-tool="mdnice编辑器">所以就是最终出图有几个花瓣，我们就用y=sin(几x)的函数，比如最终有8个花瓣，就是用y=sin(8x)的函数</p><p data-tool="mdnice编辑器">ggplot2画图是点，然后连线，这里x的取值越多，y值也会越多，最终呈现出来的线也会越平滑，这里我选择每个峰值用30个点来链接（你可以增加这个或者减少这个），如果是8个变量，x的取值范围就是1到8*30也就是1到240</p><p data-tool="mdnice编辑器">8个变量构造数据的代码如下</p><pre data-tool="mdnice编辑器"><span></span><code>library(ggplot2)<br>x&lt;-1:(8*30)<br>x<br>y&lt;-abs(sin(8*(x/(8*30))*pi))<br>ggplot(data = data.frame(x=x,y=y),<br>       aes(x=x,y=y))+<br>  geom_point()<br><br>ggplot(data = data.frame(x=x,y=y),<br>       aes(x=x,y=y))+<br>  geom_point()+<br>  coord_polar()<br></code></pre><p data-tool="mdnice编辑器">出图效果如下</p><figure data-tool="mdnice编辑器"><img data-ratio="0.667741935483871" data-src="https://mmbiz.qpic.cn/mmbiz_png/t1wZDoUyFk7T18V7nGHTtBFgV76K7UXjNO7V5emheyXFdqTGokoTicHOoM31iaGjtAWc7YmaN0cLZibXj8sapSOSg/640?wx_fmt=png" data-type="png" data-w="1240" src="https://mmbiz.qpic.cn/mmbiz_png/t1wZDoUyFk7T18V7nGHTtBFgV76K7UXjNO7V5emheyXFdqTGokoTicHOoM31iaGjtAWc7YmaN0cLZibXj8sapSOSg/640?wx_fmt=png"><figcaption>image.png</figcaption></figure><figure data-tool="mdnice编辑器"><img data-ratio="1.0387779083431257" data-src="https://mmbiz.qpic.cn/mmbiz_png/t1wZDoUyFk7T18V7nGHTtBFgV76K7UXjTmBnpkVersViay1CFGs2W0n0do3JOHzoNz2GTzCB5wyEh5jXzpMeiceg/640?wx_fmt=png" data-type="png" data-w="851" src="https://mmbiz.qpic.cn/mmbiz_png/t1wZDoUyFk7T18V7nGHTtBFgV76K7UXjTmBnpkVersViay1CFGs2W0n0do3JOHzoNz2GTzCB5wyEh5jXzpMeiceg/640?wx_fmt=png"><figcaption>image.png</figcaption></figure><p data-tool="mdnice编辑器">我们把点图的函数换成面积图的函数就会出现如下效果</p><pre data-tool="mdnice编辑器"><span></span><code>ggplot(data = data.frame(x=x,y=y),<br>       aes(x=x,y=y))+<br>  geom_area()<br><br>ggplot(data = data.frame(x=x,y=y),<br>       aes(x=x,y=y))+<br>  geom_area()+<br>  coord_polar()<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.8163816381638164" data-src="https://mmbiz.qpic.cn/mmbiz_png/t1wZDoUyFk7T18V7nGHTtBFgV76K7UXjDvUlfrPibzz6XXeEm3MrZqg1iaicvibY3pj7ib8KKdVu4TFMbprNejo4y3w/640?wx_fmt=png" data-type="png" data-w="1111" src="https://mmbiz.qpic.cn/mmbiz_png/t1wZDoUyFk7T18V7nGHTtBFgV76K7UXjDvUlfrPibzz6XXeEm3MrZqg1iaicvibY3pj7ib8KKdVu4TFMbprNejo4y3w/640?wx_fmt=png"><figcaption>image.png</figcaption></figure><figure data-tool="mdnice编辑器"><img data-ratio="0.8248436103663985" data-src="https://mmbiz.qpic.cn/mmbiz_png/t1wZDoUyFk7T18V7nGHTtBFgV76K7UXj3RS2hZEp8opMa3W3lEV3Aj3FoBApqxTwn4slicjgxzyY50neWazxZibQ/640?wx_fmt=png" data-type="png" data-w="1119" src="https://mmbiz.qpic.cn/mmbiz_png/t1wZDoUyFk7T18V7nGHTtBFgV76K7UXj3RS2hZEp8opMa3W3lEV3Aj3FoBApqxTwn4slicjgxzyY50neWazxZibQ/640?wx_fmt=png"><figcaption>image.png</figcaption></figure><p data-tool="mdnice编辑器">为了给每个峰都映射一个颜色，我么还得给数据增加一个分组，8个变量，每个变量30个值，生成这个的代码是，这里的变量我就直接用ABCD这些字母代替了</p><pre data-tool="mdnice编辑器"><span></span><code>rep(LETTERS[1:8],each=30)<br></code></pre><pre data-tool="mdnice编辑器"><span></span><code>ggplot(data = data.frame(x=x,y=y,group=rep(LETTERS[1:8],each=30)),<br>       aes(x=x,y=y))+<br>  geom_area(aes(fill=group))<br><br>ggplot(data = data.frame(x=x,y=y,group=rep(LETTERS[1:8],each=30)),<br>       aes(x=x,y=y))+<br>  geom_area(aes(fill=group))+<br>  coord_polar()<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.8348375451263538" data-src="https://mmbiz.qpic.cn/mmbiz_png/t1wZDoUyFk7T18V7nGHTtBFgV76K7UXjUibZnvQGjEt1wCa1kWKf485jHMMz1AKvJGGKNsWYCqGOZib0qoH94nSw/640?wx_fmt=png" data-type="png" data-w="1108" src="https://mmbiz.qpic.cn/mmbiz_png/t1wZDoUyFk7T18V7nGHTtBFgV76K7UXjUibZnvQGjEt1wCa1kWKf485jHMMz1AKvJGGKNsWYCqGOZib0qoH94nSw/640?wx_fmt=png"><figcaption>image.png</figcaption></figure><figure data-tool="mdnice编辑器"><img data-ratio="0.8236363636363636" data-src="https://mmbiz.qpic.cn/mmbiz_png/t1wZDoUyFk7T18V7nGHTtBFgV76K7UXjAKPH7YSGMac9Oicj5WScakYqYpS1oUoWuZ5ftxdWaEsZszoCKPJWcxw/640?wx_fmt=png" data-type="png" data-w="1100" src="https://mmbiz.qpic.cn/mmbiz_png/t1wZDoUyFk7T18V7nGHTtBFgV76K7UXjAKPH7YSGMac9Oicj5WScakYqYpS1oUoWuZ5ftxdWaEsZszoCKPJWcxw/640?wx_fmt=png"><figcaption>image.png</figcaption></figure><h2 data-tool="mdnice编辑器"><span></span><span>然后是第三个问题</span><span></span><span> </span></h2><blockquote data-tool="mdnice编辑器"><p>您的这个玫瑰图的代码，在作图这里按您的模拟数据df2中并不存在x的列了，怎么还能x=x呢？</p></blockquote><p data-tool="mdnice编辑器">这个推文里的代码 对应是10个变量，每个峰使用18个点，所以x生成的就是1:180</p><p data-tool="mdnice编辑器">这个代码是</p><pre data-tool="mdnice编辑器"><span></span><code>library(tidyverse)<br>library(ggplot2)<br><br>set.seed(123456)<br><br>df&lt;-data.frame(x=LETTERS[1:10],<br>               y=sample(1:20,10))<br>df<br><br>x&lt;-1:180<br>x<br>y&lt;-sin(10*x*pi/180)<br><br>df1&lt;-data.frame(x1=x,<br>                y1=abs(y),<br>                var=gl(10,18,labels = LETTERS[1:10]))<br>head(df1)<br>merge(df1,df,by.x = <span>'var'</span>,by.y = <span>'x'</span>) %&gt;% <br>  mutate(new_y=y1*y) -&gt; df2<br><br>ggplot(data=df2,aes(x=x,y=new_y))+<br>  geom_area(aes(fill=var),<br>            alpha=0.8,<br>            color=<span>"black"</span>,<br>            show.legend = F)+<br>  coord_polar()+<br>  theme_bw()+<br>  theme(axis.text.y = element_blank(),<br>        axis.ticks = element_blank(),<br>        panel.border = element_blank(),<br>        axis.title = element_blank())+<br>  scale_x_continuous(breaks = seq(9,180,18),<br>                     labels = df<span>$x</span>)+<br>  geom_text(data=df,aes(x=seq(9,180,18),<br>                        y=y+1,<br>                        label=y))<br></code></pre><p data-tool="mdnice编辑器">df这个数据集</p><figure data-tool="mdnice编辑器"><img data-ratio="1.8602941176470589" data-src="https://mmbiz.qpic.cn/mmbiz_png/t1wZDoUyFk7T18V7nGHTtBFgV76K7UXjldYOG8Rk5zHeBUFw46fe9WaubAHiaNvzQ0Tk4zjQyD9EI02eJEicMicww/640?wx_fmt=png" data-type="png" data-w="136" src="https://mmbiz.qpic.cn/mmbiz_png/t1wZDoUyFk7T18V7nGHTtBFgV76K7UXjldYOG8Rk5zHeBUFw46fe9WaubAHiaNvzQ0Tk4zjQyD9EI02eJEicMicww/640?wx_fmt=png"><figcaption>image.png</figcaption></figure><p data-tool="mdnice编辑器">df1这个数据集</p><figure data-tool="mdnice编辑器"><img data-ratio="0.8767772511848341" data-src="https://mmbiz.qpic.cn/mmbiz_png/t1wZDoUyFk7T18V7nGHTtBFgV76K7UXjhy8GhaMNhsdFeGxAbP9ibgjD0KntGAdEl3PqJBZic2y65jU4kO7OGMpQ/640?wx_fmt=png" data-type="png" data-w="211" src="https://mmbiz.qpic.cn/mmbiz_png/t1wZDoUyFk7T18V7nGHTtBFgV76K7UXjhy8GhaMNhsdFeGxAbP9ibgjD0KntGAdEl3PqJBZic2y65jU4kO7OGMpQ/640?wx_fmt=png"><figcaption>image.png</figcaption></figure><p data-tool="mdnice编辑器">合并以后生成df2这个数据集</p><figure data-tool="mdnice编辑器"><img data-ratio="0.5705329153605015" data-src="https://mmbiz.qpic.cn/mmbiz_png/t1wZDoUyFk7T18V7nGHTtBFgV76K7UXjqDgpyN2YdbVOfSnbJqXcoNsP3CuHtVKiaia84vwsONds0oa6jqb3M5yw/640?wx_fmt=png" data-type="png" data-w="319" src="https://mmbiz.qpic.cn/mmbiz_png/t1wZDoUyFk7T18V7nGHTtBFgV76K7UXjqDgpyN2YdbVOfSnbJqXcoNsP3CuHtVKiaia84vwsONds0oa6jqb3M5yw/640?wx_fmt=png"><figcaption>image.png</figcaption></figure><p data-tool="mdnice编辑器">df2这个数据集确实没有了x这个变量，但是用如下画图代码也能够画出来图</p><pre data-tool="mdnice编辑器"><span></span><code>ggplot(data=df2,aes(x=x,y=new_y))+<br>  geom_area(aes(fill=var),<br>            alpha=0.8,<br>            color=<span>"black"</span>,<br>            show.legend = F)+<br>  coord_polar()+<br>  theme_bw()+<br>  theme(axis.text.y = element_blank(),<br>        axis.ticks = element_blank(),<br>        panel.border = element_blank(),<br>        axis.title = element_blank())+<br>  scale_x_continuous(breaks = seq(9,180,18),<br>                     labels = df<span>$x</span>)+<br>  geom_text(data=df,aes(x=seq(9,180,18),<br>                        y=y+1,<br>                        label=y))<br></code></pre><p data-tool="mdnice编辑器">把x换成x1也能出图</p><pre data-tool="mdnice编辑器"><span></span><code>ggplot(data=df2,aes(x=x1,y=new_y))+<br>  geom_area(aes(fill=var),<br>            alpha=0.8,<br>            color=<span>"black"</span>,<br>            show.legend = F)+<br>  coord_polar()+<br>  theme_bw()+<br>  theme(axis.text.y = element_blank(),<br>        axis.ticks = element_blank(),<br>        panel.border = element_blank(),<br>        axis.title = element_blank())+<br>  scale_x_continuous(breaks = seq(9,180,18),<br>                     labels = df<span>$x</span>)+<br>  geom_text(data=df,aes(x=seq(9,180,18),<br>                        y=y+1,<br>                        label=y))<br></code></pre><p data-tool="mdnice编辑器">这个是为啥我暂时也想不明白了。如果有人知道这个原因，欢迎大家留言</p><p data-tool="mdnice编辑器">（这里我突然想明白了，正常情况下是应该写x=x1的，写x=x之所以没有报错，是因为我们在构造数据的时候写了x&lt;-1:180，这里的x实际是使用了这个x）</p><h2 data-tool="mdnice编辑器"><span></span><span>问题1</span><span></span><span> </span></h2><blockquote data-tool="mdnice编辑器"><p>方不方便用点常见的数据，比如土壤理化这类的出个教程呢？因为感觉您做这张图的确比普通的极坐标图好看很多</p></blockquote><p data-tool="mdnice编辑器">如果方便的话，可以发我一个示例数据，我用示例数据再写一个推文</p><p data-tool="mdnice编辑器">欢迎大家关注我的公众号</p><p data-tool="mdnice编辑器"><strong>小明的数据分析笔记本</strong></p><section><mp-common-profile data-pluginname="mpprofile" data-weui-theme="light" data-id="MzI3NzQ3MTcxMg==" data-headimg="http://mmbiz.qpic.cn/mmbiz_png/t1wZDoUyFk5t1sOnM0iabvBhnfIj5YpyqrMib0E1MGCd9ibcYxaOPZd0GWhQBDvK2BPEwsicQxd6y5MHLfphnwHnow/0?wx_fmt=png" data-nickname="小明的数据分析笔记本" data-alias="" data-signature="数据分析和数据可视化有意思的简单小例子~石榴研究生的笔记本" data-from="0" data-is_biz_ban="0"></mp-common-profile></section><p data-tool="mdnice编辑器"></p><blockquote data-tool="mdnice编辑器"><p>小明的数据分析笔记本 公众号 主要分享：1、R语言和python做数据分析和数据可视化的简单小例子；2、园艺植物相关转录组学、基因组学、群体遗传学文献阅读笔记；3、生物信息学入门学习资料及自己的学习笔记！</p></blockquote><p data-tool="mdnice编辑器"><strong>微信公众号好像又有改动，如果没有将这个公众号设为星标的话，会经常错过公众号的推文，个人建议将 小明的数据分析笔记本 公众号添加星标，添加方法是</strong></p><h2 data-tool="mdnice编辑器"><span></span><span>点开公众号的页面，右上角有三个点</span><span></span><span> </span></h2><figure data-tool="mdnice编辑器"><img data-ratio="0.996694214876033" data-src="https://mmbiz.qpic.cn/mmbiz_png/t1wZDoUyFk7T18V7nGHTtBFgV76K7UXj1ibg1ktavt9AAtI3m40cTZIjJDuMnm9OIXWt8GSspiaPvFXyAqdOj1Tg/640?wx_fmt=png" data-type="png" data-w="605" src="https://mmbiz.qpic.cn/mmbiz_png/t1wZDoUyFk7T18V7nGHTtBFgV76K7UXj1ibg1ktavt9AAtI3m40cTZIjJDuMnm9OIXWt8GSspiaPvFXyAqdOj1Tg/640?wx_fmt=png"><figcaption>image.png</figcaption></figure><h2 data-tool="mdnice编辑器"><span></span><span>点击三个点，会跳出界面</span><span></span><span> </span></h2><figure data-tool="mdnice编辑器"><img data-ratio="2.137987012987013" data-src="https://mmbiz.qpic.cn/mmbiz_png/t1wZDoUyFk7T18V7nGHTtBFgV76K7UXjsrVJol2BLEzpnmA9bd6ybvh4AjEZ2nianjFias0kjDqWEbAdrwymfPSA/640?wx_fmt=png" data-type="png" data-w="616" src="https://mmbiz.qpic.cn/mmbiz_png/t1wZDoUyFk7T18V7nGHTtBFgV76K7UXjsrVJol2BLEzpnmA9bd6ybvh4AjEZ2nianjFias0kjDqWEbAdrwymfPSA/640?wx_fmt=png"><figcaption>image.png</figcaption></figure><h2 data-tool="mdnice编辑器"><span></span><span>直接点击 设为星标 就可以了</span><span></span><span> </span></h2><figure data-tool="mdnice编辑器"><img data-ratio="0.4282258064516129" data-src="https://mmbiz.qpic.cn/mmbiz_png/t1wZDoUyFk7T18V7nGHTtBFgV76K7UXjk6WmwmrNq8ia7QLeNXzHxVia8TkC57BGJjNuM8oGKFgpH89atbrXb6LQ/640?wx_fmt=png" data-type="png" data-w="1240" src="https://mmbiz.qpic.cn/mmbiz_png/t1wZDoUyFk7T18V7nGHTtBFgV76K7UXjk6WmwmrNq8ia7QLeNXzHxVia8TkC57BGJjNuM8oGKFgpH89atbrXb6LQ/640?wx_fmt=png"><figcaption>image.png</figcaption></figure></section><p><br></p><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/m1ssdif4mT5bYo-T4l1wbQ",target="_blank" rel="noopener noreferrer">原文链接</a>
