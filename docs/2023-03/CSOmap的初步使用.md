---
title: "CSOmap的初步使用"
date: 2023-03-17T00:23:02Z
draft: ["false"]
tags: [
  "fetched",
  "东林的扯淡小屋"
]
categories: ["Acdemic"]
---
CSOmap的初步使用 by 东林的扯淡小屋
------
<div><p>原始版本是MATLAB写的，所以其实对于一般人来说不太友好。<br></p><p>https://github.com/zhongguojie1998/CSOmap</p><p><img data-galleryid="" data-ratio="0.5675925925925925" data-s="300,640" data-type="png" data-w="1080" data-src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBrTKDVNBEiaoqZyP0icwKG7a0wIicicjsx6xNONW5PS9o73kavYmb7elgGiaibQT3ib6ysljUIvMPFM6iaP1Q/640?wx_fmt=png" src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBrTKDVNBEiaoqZyP0icwKG7a0wIicicjsx6xNONW5PS9o73kavYmb7elgGiaibQT3ib6ysljUIvMPFM6iaP1Q/640?wx_fmt=png"></p><p>我问了一下通讯作者任仙文老师，他说有R版本的。<br></p><p>https://github.com/lijxug/CSOmapR</p><section><ul><li><li><li><li><li></ul><pre data-lang="cpp"><code><span><span># install.packages(<span>"devtools"</span>)</span></span></code><code><span>devtools::install_github(<span>"lijxug/CSOmapR"</span>)</span></code><code><span><br></span></code><code><span><span># install CSOmapR.demo package for easy-loading demo data</span></span></code><code><span><span># devtools::install_github(<span>"lijxug/CSOmapR.demo"</span>)</span></span></code></pre></section><p><img data-galleryid="" data-ratio="0.2462962962962963" data-s="300,640" data-type="png" data-w="1080" data-src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBrTKDVNBEiaoqZyP0icwKG7a0yG7wtrmdxZIaR8wTEOLyFG05yOeDgyMlFaV6FHicfKAgGGzPqAjicMkA/640?wx_fmt=png" src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBrTKDVNBEiaoqZyP0icwKG7a0yG7wtrmdxZIaR8wTEOLyFG05yOeDgyMlFaV6FHicfKAgGGzPqAjicMkA/640?wx_fmt=png"></p><p><img data-galleryid="" data-ratio="0.7648148148148148" data-s="300,640" data-type="png" data-w="1080" data-src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBrTKDVNBEiaoqZyP0icwKG7a0nuNQg3LEd7E8ibGwTCF8zdcR3pEAbCpslicGMmtrbiasMicLzAAHg7ljhQ/640?wx_fmt=png" src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBrTKDVNBEiaoqZyP0icwKG7a0nuNQg3LEd7E8ibGwTCF8zdcR3pEAbCpslicGMmtrbiasMicLzAAHg7ljhQ/640?wx_fmt=png"></p><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="css"><code><span><span>library</span>(<span>CSOmapR</span>)</span></code><code><span><span>library</span>(<span>CSOmapR</span><span>.demo</span>)</span></code><code><span><span>invisible</span>(<span>TPM</span>)</span></code><code><span><span>invisible</span>(<span>LR</span>)</span></code><code><span><span>invisible</span>(<span>labelData</span>)</span></code><code><span><span>affinityMat</span> = <span>getAffinityMat</span>(<span>TPM</span>, <span>LR</span>, <span>verbose</span> = <span>T</span>)</span></code><code><span><br></span></code><code><span><span>coords_res</span> = <span>runExactTSNE_R</span>(</span></code><code><span>  <span>X</span> = <span>affinityMat</span>,</span></code><code><span>  <span>no_dims</span> = 3,</span></code><code><span>  <span>max_iter</span> = 1000,</span></code><code><span>  <span>verbose</span> = <span>T</span></span></code><code><span>)</span></code><code><span><span>coords</span> = <span>coords_res</span>$<span>Y</span></span></code><code><span><span>rownames</span>(<span>coords</span>) &lt;<span>-</span> <span>colnames</span>(<span>TPM</span>)</span></code><code><span><span>colnames</span>(<span>coords</span>) &lt;<span>-</span> <span>c</span>('<span>x</span>', '<span>y</span>', '<span>z</span>')</span></code><code><span><span>require</span>(<span>dplyr</span>)</span></code><code><span># <span>arrange</span> <span>data</span></span></code><code><span><span>coords_tbl</span> = <span>bind_cols</span>(<span>cellName</span> = <span>rownames</span>(<span>coords</span>), <span>as</span><span>.data</span><span>.frame</span>(<span>coords</span>))</span></code><code><span><br></span></code><code><span><span>join_vec</span> = <span>setNames</span>(<span>colnames</span>(<span>labelData</span>)<span>[1]</span>, <span>nm</span> = <span>colnames</span>(<span>coords_tbl</span>)<span>[1]</span>)</span></code><code><span><span>cellinfo_tbl</span> = <span>left_join</span>(<span>coords_tbl</span>, <span>labelData</span>, <span>by</span> = <span>join_vec</span>)</span></code><code><span><br></span></code><code><span><span>density_obj</span> = <span>getDensity3D</span>(<span>cellinfo_tbl</span>$<span>x</span>, <span>cellinfo_tbl</span>$<span>y</span>, <span>cellinfo_tbl</span>$<span>z</span>)</span></code><code><span><span>cellinfo_tbl</span> = <span>cellinfo_tbl</span> %&gt;% <span>mutate</span>(<span>density</span> = <span>density_obj</span>)</span></code><code><span><br></span></code><code><span><span>p_3Ddensity</span> = <span>plot3D</span>(<span>cellinfo_tbl</span>, <span>color_by</span> = "<span>density</span>", <span>title</span> = "3<span>D</span> <span>density</span>")</span></code><code><span><br></span></code><code><span><span>signif_results</span> = <span>getSignificance</span>(<span>coords</span>, <span>labels</span> = <span>cellinfo_tbl</span>$<span>labels</span>, <span>verbose</span> = <span>T</span>)</span></code><code><span><span>contribution_list</span> = <span>getContribution</span>(<span>TPM</span>, <span>LR</span>, <span>signif_results</span>$<span>detailed_connections</span>)</span></code><code><span><br></span></code></pre></section><p><img data-galleryid="" data-ratio="0.7018518518518518" data-s="300,640" data-type="png" data-w="1080" data-src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBrTKDVNBEiaoqZyP0icwKG7a0Vuo0yTmW4EibrOCWnjlyrTJjzv9DNzJ4tsrC3YhpRMMAIL0nEqqpDhQ/640?wx_fmt=png" src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBrTKDVNBEiaoqZyP0icwKG7a0Vuo0yTmW4EibrOCWnjlyrTJjzv9DNzJ4tsrC3YhpRMMAIL0nEqqpDhQ/640?wx_fmt=png"></p><p><img data-galleryid="" data-ratio="0.7768518518518519" data-s="300,640" data-type="png" data-w="1080" data-src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBrTKDVNBEiaoqZyP0icwKG7a0btrib6mxnYfUibsK6W9uKWAK2m4b3S18TIam4VrzAXdjwCEWaXhIFBicQ/640?wx_fmt=png" src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBrTKDVNBEiaoqZyP0icwKG7a0btrib6mxnYfUibsK6W9uKWAK2m4b3S18TIam4VrzAXdjwCEWaXhIFBicQ/640?wx_fmt=png"></p><p><img data-galleryid="" data-ratio="1.3102981029810299" data-s="300,640" data-type="png" data-w="738" data-src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBpXBukWPvjhgwqzbzqRYrXZlleAJ3AkbibynA0ybE0a56wcfKHV9uRoOiaBGGClvzTjsDuwyoVEzM6w/640?wx_fmt=png" src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBpXBukWPvjhgwqzbzqRYrXZlleAJ3AkbibynA0ybE0a56wcfKHV9uRoOiaBGGClvzTjsDuwyoVEzM6w/640?wx_fmt=png"></p><p><img data-galleryid="" data-ratio="0.721327967806841" data-s="300,640" data-type="png" data-w="994" data-src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBpXBukWPvjhgwqzbzqRYrXZicKU56LQ5pCyTtqiary8fUM8RESufhqqlR5L0eKeib8slSkUHa8xQBzsA/640?wx_fmt=png" src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBpXBukWPvjhgwqzbzqRYrXZicKU56LQ5pCyTtqiary8fUM8RESufhqqlR5L0eKeib8slSkUHa8xQBzsA/640?wx_fmt=png"></p><p><img data-galleryid="" data-ratio="0.7814814814814814" data-s="300,640" data-type="png" data-w="1080" data-src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBpXBukWPvjhgwqzbzqRYrXZvNU4r7V3vtvicqRm23SxUicibJtGdtHJOmXvRNb1CY1FCqsLXZrjQWNFQ/640?wx_fmt=png" src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBpXBukWPvjhgwqzbzqRYrXZvNU4r7V3vtvicqRm23SxUicibJtGdtHJOmXvRNb1CY1FCqsLXZrjQWNFQ/640?wx_fmt=png"></p><p>参考链接：https://github.com/lijxug/CSOmapR</p><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/cZuosUQxyx4Lz1QGolVZ-A",target="_blank" rel="noopener noreferrer">原文链接</a>
