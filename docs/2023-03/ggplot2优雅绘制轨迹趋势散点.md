---
title: "ggplot2优雅绘制轨迹趋势散点"
date: 2023-03-31T16:05:16Z
draft: ["false"]
tags: [
  "fetched",
  "R语言数据分析指南"
]
categories: ["Acdemic"]
---
ggplot2优雅绘制轨迹趋势散点 by R语言数据分析指南
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><h3 data-tool="mdnice编辑器"><span></span><span><span></span>欢迎关注R语言数据分析指南</span><span></span></h3><blockquote data-tool="mdnice编辑器"><span>❝</span><p>本节来介绍如何使用使用ggplot2来绘制带有轨迹的散点图。整张图均使用R代码进行绘制，<strong>「数据+代码已经上传2023VIP群，加群的观众老爷请自行下载」</strong></p><span>❞</span></blockquote><blockquote data-tool="mdnice编辑器"><span>❝</span><p>有需要学习个性化数据可视化的朋友，欢迎到小编的<strong>「淘宝店铺」</strong> <strong>「R语言数据分析指南」</strong>购买<strong>「2023年度会员」</strong> <code>初始价格99元</code>，内容主要包括各种<strong>「高分论文的图表分析复现以及一些个性化图表的绘制」</strong>均包含数据+代码；按照往年数据小编年产出约在150+以上</p><span>❞</span></blockquote><p data-tool="mdnice编辑器">购买后微信发小编订单截图即邀请进新的会员交流群，小编的文档为按年售卖，只包含当年度的<strong>「除系列课程外」</strong>的文档，有需要往年文档的朋友也可下单购买，需要了解更多信息的朋友欢迎交流咨询，<strong>「添加小编微信请备注，以提高沟通效率」</strong></p><h3 data-tool="mdnice编辑器"><span></span><span><span></span>加载R包</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code><span>library</span>(tidyverse)<br><span>library</span>(ggforce)<br><span># install.packages("janitor")</span><br><span>library</span>(janitor)<br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span><span></span>导入数据</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code><span># 读取 age.txt 文件，并将列名变为小写字母形式</span><br>age &lt;- read_csv(<span>"age.txt"</span>) %&gt;% janitor::clean_names()<br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span><span></span>数据清洗</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code><span># 创建新的数据框 age_new，选取前20行数据，并新增一列 median_age_2，计算方法是 median_age - difference</span><br>age_new &lt;- age %&gt;%  head(<span>20</span>) %&gt;% mutate(median_age_2 = median_age - difference)<br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span><span></span>数据可视化</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code>age_new %&gt;% ggplot() +<br>  ggforce::geom_link(aes(x = median_age,y = reorder(name, -index), <span># 绘制线段，x轴为median_age，y轴为name（按index从大到小排序）</span><br>      xend = median_age_2,yend = name, <span># xend为median_age_2，yend为name</span><br>      size = after_stat(index), <span># 线段的宽度，按照index的值来设置</span><br>      alpha = after_stat(index)),color = <span>"#709AE1FF"</span>) + <span># 线段的颜色和透明度</span><br>  geom_point( <span># 绘制点</span><br>    aes(x = median_age_2, y = name), <span># x轴为median_age_2，y轴为name</span><br>    color = <span>"#709AE1FF"</span>,shape = <span>21</span>,size = <span>6</span>,fill = <span>"#F3F3F3"</span>) + <span># 点的颜色、形状、大小和填充色</span><br>  geom_vline(xintercept = <span>26.3</span>, linetype = <span>"dashed"</span>) + <span># 绘制虚线，x轴截距为26.3</span><br>  geom_vline(xintercept = <span>28</span>, linetype = <span>"dashed"</span>) + <span># 绘制虚线，x轴截距为28</span><br>  geom_text( <span># 绘制文本标签</span><br>    data = data.frame(x = <span>26.4</span>, y = <span>10</span>,label = <span>"Median 2006-10"</span>), <span># 文本标签的位置和内容</span><br>    mapping = aes(x = x, y = y, label = label), <span># 映射x轴、y轴和标签内容</span><br>    inherit.aes = <span>FALSE</span>,size = <span>3</span>,angle = <span>90</span>,face=<span>"bold"</span>) + <span># 文本标签的大小、旋转角度和字体样式</span><br>  geom_text(data = data.frame(x = <span>28.1</span>, y = <span>12</span>,<br>                      label = <span>"Median 2015-19"</span>),<br>    mapping = aes(x = x, y = y, label = label),<br>    inherit.aes = <span>FALSE</span>,size = <span>3</span>,angle = <span>90</span>,face=<span>"bold"</span>) + <span># 第二个文本标签的位置、内容和样式</span><br>  theme_classic()+ <span># 使用经典主题</span><br>  theme(<br>    legend.position = <span>"none"</span>, <span># 不显示图例</span><br>    panel.grid.major.x = element_blank(), <span># 不显示x轴的网格线</span><br>    panel.grid.minor = element_blank(), <span># 不显示y轴的网格线</span><br>    axis.text = element_text(size = <span>7.7</span>,face=<span>"bold"</span>), <span># 坐标轴标签的字体大小和样式</span><br>    axis.title.y = element_blank(),<br>    axis.title.x = element_text(size = <span>9</span>))<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.8205128205128205" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZIickdfGAeBzJVfLIkOEO7YaeMIJEHTdjVWPB0TsH6OeMLOFRq2RdmMLVwlsaiaIakAEqc6HBvqOrg/640?wx_fmt=png" data-type="png" data-w="897" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZIickdfGAeBzJVfLIkOEO7YaeMIJEHTdjVWPB0TsH6OeMLOFRq2RdmMLVwlsaiaIakAEqc6HBvqOrg/640?wx_fmt=png"></figure><blockquote data-tool="mdnice编辑器"><span>❝</span><p>可以看到非常简单的一个小例子那么本节介绍到此结束，喜欢的观众老爷欢迎分享转发。有学习需求者欢迎到小编<strong>「淘宝店铺 R语言数据分析指南」</strong> 购买小编2023年的VIP文档，已有不少朋友学以至用用到了论文当中，<strong>「加小编微信请备注信息及来意，无需要请勿扰」</strong></p><span>❞</span></blockquote><h3 data-tool="mdnice编辑器"><span></span><span><span></span>小编微信</span><span></span></h3><p><img data-galleryid="" data-ratio="1" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/EibnicgwScTAaNu6sU2UCYkxFq9ibq75wuaO0lqFoYz1icUo4jh3N2icAWECmibgPvqyReur0FCp7JNKO0icnRAsbO9ug/640?wx_fmt=jpeg" data-type="jpeg" data-w="430" src="https://mmbiz.qpic.cn/mmbiz_jpg/EibnicgwScTAaNu6sU2UCYkxFq9ibq75wuaO0lqFoYz1icUo4jh3N2icAWECmibgPvqyReur0FCp7JNKO0icnRAsbO9ug/640?wx_fmt=jpeg"></p><h3 data-tool="mdnice编辑器"><span></span><span><span></span>关注下方公众号下回更新不迷路</span><span></span></h3><section><mp-common-profile data-pluginname="mpprofile" data-weui-theme="light" data-id="Mzg3MzQzNTYzMw==" data-headimg="http://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZF0rpeZII9Ltl26VbVagriczTria1fib3XgjwwHEHFjPzkmGpqWDVVHBSzhENictUM2iavAKiaM5lc9USw/0?wx_fmt=png" data-nickname="R语言数据分析指南" data-alias="YanJANtwo" data-signature="R语言重症爱好者，喜欢绘制各种精美的图表，喜欢的小伙伴可以关注我，跟我一起学习" data-from="0" data-is_biz_ban="0"></mp-common-profile></section><h3 data-tool="mdnice编辑器"><span></span><span><span></span>往期精彩内容</span><span></span></h3></section><p><br></p><section><a href="http://mp.weixin.qq.com/s?__biz=Mzg3MzQzNTYzMw==&amp;mid=2247502232&amp;idx=1&amp;sn=508a0e19b2f146892c3d9f650931c6c9&amp;chksm=cee29106f9951810b3bd673d6ce7bdb3ccbcea1aca30ef71490e1cfbf89abd001d43be560c34&amp;scene=21#wechat_redirect" data-linktype="1"><section><section><section data-mid=""><span data-positionback="static"><img data-ratio="0.42424242424242425" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/EibnicgwScTAbFFvtzcfQHregzr0rfQsbKqN4Kbb7OxSmG5iaYliatFSdJOU6Tj0WGiaS3qUzfG12FdbshtLZER4hnw/640?wx_fmt=jpeg" data-w="1023" src="https://mmbiz.qpic.cn/mmbiz_jpg/EibnicgwScTAbFFvtzcfQHregzr0rfQsbKqN4Kbb7OxSmG5iaYliatFSdJOU6Tj0WGiaS3qUzfG12FdbshtLZER4hnw/640?wx_fmt=jpeg"></span></section><section data-mid=""><p>[会员专享]ggplot2构建图层注释拟合曲线</p></section></section></section></a></section><p><br></p><section><a href="http://mp.weixin.qq.com/s?__biz=Mzg3MzQzNTYzMw==&amp;mid=2247502113&amp;idx=1&amp;sn=09b4d599c107006ba38dfc0d6c7fcd35&amp;chksm=cee291bff99518a9cb831b22c3cb7f9ff91f4dda416866a2fe8a25b6dc34e1c921624290b5e4&amp;scene=21#wechat_redirect" data-linktype="1"><section><section><section data-mid=""><span data-positionback="static"><img data-ratio="0.4253968253968254" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/EibnicgwScTAZgNYvTU7yAEwCZoyGPyExlicpcR0IrWa2bVXg06dLj51fpzqj77ZUZic4Mhz4fQFa5tiaBGFicoic7UTA/640?wx_fmt=jpeg" data-w="945" src="https://mmbiz.qpic.cn/mmbiz_jpg/EibnicgwScTAZgNYvTU7yAEwCZoyGPyExlicpcR0IrWa2bVXg06dLj51fpzqj77ZUZic4Mhz4fQFa5tiaBGFicoic7UTA/640?wx_fmt=jpeg"></span></section><section data-mid=""><p>[会员专享] ggplot2绘制局部放大柱状图</p></section></section></section></a></section><p><br></p><section><a href="http://mp.weixin.qq.com/s?__biz=Mzg3MzQzNTYzMw==&amp;mid=2247502179&amp;idx=1&amp;sn=c1e2f83f814391ae04669414497c8204&amp;chksm=cee291fdf99518eb48deb5e8fc2fb30a9fe9b9220b152710d2b787f728a56b533c783f0e43bd&amp;scene=21#wechat_redirect" data-linktype="1"><section><section><section data-mid=""><span data-positionback="static"><img data-ratio="0.42547033285094066" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/EibnicgwScTAbJwviciaUHrLUTliclsSWDIKWdRXZs3iaZ0pFWDJIZouzWRecXSQL9SYjFhLabaEmjG5gVAQy9nXtpibQ/640?wx_fmt=jpeg" data-w="691" src="https://mmbiz.qpic.cn/mmbiz_jpg/EibnicgwScTAbJwviciaUHrLUTliclsSWDIKWdRXZs3iaZ0pFWDJIZouzWRecXSQL9SYjFhLabaEmjG5gVAQy9nXtpibQ/640?wx_fmt=jpeg"></span></section><section data-mid=""><p>R优雅的给图表添加背景图</p></section></section></section></a></section><p><br></p><section><a href="http://mp.weixin.qq.com/s?__biz=Mzg3MzQzNTYzMw==&amp;mid=2247501979&amp;idx=1&amp;sn=1fb4129af9b5faf4e7bbe93852ae4e45&amp;chksm=cee29005f99519130378ef4a3751f67fbd2612e9f40fd1139cfe6ee593a73c466204c488ebf1&amp;scene=21#wechat_redirect" data-linktype="1"><section><section><section data-mid=""><span data-positionback="static"><img data-ratio="0.42555438225976766" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/EibnicgwScTAZKWCt0ib0F4P2F8xD4FYAWnSPQHn1jOBd5ASBEEtj2vicPTtk7ax2XkFvibTMkXNo2GPZLsjicKolYkQ/640?wx_fmt=jpeg" data-w="947" src="https://mmbiz.qpic.cn/mmbiz_jpg/EibnicgwScTAZKWCt0ib0F4P2F8xD4FYAWnSPQHn1jOBd5ASBEEtj2vicPTtk7ax2XkFvibTMkXNo2GPZLsjicKolYkQ/640?wx_fmt=jpeg"></span></section><section data-mid=""><p>R语言优雅的绘制交互式物种组成图</p></section></section></section></a></section><p><br></p><section><a href="http://mp.weixin.qq.com/s?__biz=Mzg3MzQzNTYzMw==&amp;mid=2247501935&amp;idx=1&amp;sn=67925856510ed27850408609b51d717a&amp;chksm=cee290f1f99519e738572111448fdab5c77032018396eaea25e15eb14fd7362a83b5d015b43e&amp;scene=21#wechat_redirect" data-linktype="1"><section><section><section data-mid=""><span data-positionback="static"><img data-ratio="0.42444444444444446" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/EibnicgwScTAZAIkWYpHVp5MWtibb8MKh2Qy6yb7icZD0159BFZMR7uw0qch6NP0I3ibtEOUFPvPFXjtgvKnJQkSoBA/640?wx_fmt=jpeg" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_jpg/EibnicgwScTAZAIkWYpHVp5MWtibb8MKh2Qy6yb7icZD0159BFZMR7uw0qch6NP0I3ibtEOUFPvPFXjtgvKnJQkSoBA/640?wx_fmt=jpeg"></span></section><section data-mid=""><p>[会员专享] ggplot2绘制个性化注释哑铃图</p></section></section></section></a></section><p><br></p><section><a href="http://mp.weixin.qq.com/s?__biz=Mzg3MzQzNTYzMw==&amp;mid=2247501813&amp;idx=1&amp;sn=5b33aa351542c8308251e17cb050b2eb&amp;chksm=cee29f6bf995167d65afe5d141453e2916813908c89451fa8ed3f57b93d27b5fc495b43823c6&amp;scene=21#wechat_redirect" data-linktype="1"><section><section><section data-mid=""><span data-positionback="static"><img data-ratio="0.42407407407407405" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/EibnicgwScTAYwcHE3ZyxozdntkibV6Gn4K8SbfzvLe7GViaU6PZoXhBYjSl3RhdG82nNlHuyzOJgiczBvhQLqyxMiag/640?wx_fmt=jpeg" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_jpg/EibnicgwScTAYwcHE3ZyxozdntkibV6Gn4K8SbfzvLe7GViaU6PZoXhBYjSl3RhdG82nNlHuyzOJgiczBvhQLqyxMiag/640?wx_fmt=jpeg"></span></section><section data-mid=""><p>[会员专享] nature communications图表复现之个性化地图绘制</p></section></section></section></a></section><p><br></p><section><a href="http://mp.weixin.qq.com/s?__biz=Mzg3MzQzNTYzMw==&amp;mid=2247501701&amp;idx=1&amp;sn=18a8bb98c074811e39a4319f18b4e13f&amp;chksm=cee29f1bf995160dadd8a541246dc99f06b0880858c08ab17c29aa2b0ff0ebf3d2f1e94d3b3a&amp;scene=21#wechat_redirect" data-linktype="1"><section><section><section data-mid=""><span data-positionback="static"><img data-ratio="0.4246031746031746" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/EibnicgwScTAaoMwzmdV8FwdibYsLwtBDwiaxGibIeX5uLeLryiciaiavQgBuCkRFsYtbIicibLKjaTEWqe4LbdAic76gAqFg/640?wx_fmt=jpeg" data-w="756" src="https://mmbiz.qpic.cn/mmbiz_jpg/EibnicgwScTAaoMwzmdV8FwdibYsLwtBDwiaxGibIeX5uLeLryiciaiavQgBuCkRFsYtbIicibLKjaTEWqe4LbdAic76gAqFg/640?wx_fmt=jpeg"></span></section><section data-mid=""><p>[会员专享]ggplot2高度自定义绘制游泳图</p></section></section></section></a></section><p><br></p><section><a href="http://mp.weixin.qq.com/s?__biz=Mzg3MzQzNTYzMw==&amp;mid=2247501630&amp;idx=1&amp;sn=ae4076f0c916403a07321e8be5d10af9&amp;chksm=cee29fa0f99516b69e50632fd85b4d26d8440c6a115e14f3b2a5515aa19c5f4046ad3d41bac1&amp;scene=21#wechat_redirect" data-linktype="1"><section><section><section data-mid=""><span data-positionback="static"><img data-ratio="0.425" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/EibnicgwScTAZ8uSib3RQgZUFmxC1CFHPIHST2IV7u8v8n9zKD0ZqNb56mQOvicpM7YchfiaONRdenoX7RCSczLDCow/640?wx_fmt=jpeg" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_jpg/EibnicgwScTAZ8uSib3RQgZUFmxC1CFHPIHST2IV7u8v8n9zKD0ZqNb56mQOvicpM7YchfiaONRdenoX7RCSczLDCow/640?wx_fmt=jpeg"></span></section><section data-mid=""><p>[会员专享] R优雅绘制组合版circos图</p></section></section></section></a></section><p><br></p><section><a href="http://mp.weixin.qq.com/s?__biz=Mzg3MzQzNTYzMw==&amp;mid=2247501425&amp;idx=1&amp;sn=e4023be2f4e69312474222c2b9d2499a&amp;chksm=cee29eeff99517f932eeaea90e1d79dafd7997c68fc70312815e3454d371aae27fce11768779&amp;scene=21#wechat_redirect" data-linktype="1"><section><section><section data-mid=""><span data-positionback="static"><img data-ratio="0.425" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/EibnicgwScTAaTsiaAXVLAoxX8VR6EE4RRXCPiarXOiaxQ96Tm86wg6PvQZvhw60h2pttsPY1q31ibjoiag8GSOeKOX5Q/640?wx_fmt=jpeg" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_jpg/EibnicgwScTAaTsiaAXVLAoxX8VR6EE4RRXCPiarXOiaxQ96Tm86wg6PvQZvhw60h2pttsPY1q31ibjoiag8GSOeKOX5Q/640?wx_fmt=jpeg"></span></section><section data-mid=""><p>[会员专享] nature biotechnology图表复现高端个性化组合图</p></section></section></section></a></section><p><br></p><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/cRyJktYIfGK6DEh0k6MskA",target="_blank" rel="noopener noreferrer">原文链接</a>
