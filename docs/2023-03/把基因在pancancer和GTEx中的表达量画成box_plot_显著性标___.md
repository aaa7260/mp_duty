---
title: "把基因在pancancer和GTEx中的表达量画成box plot，显著性标***"
date: 2023-03-08T01:37:27Z
draft: ["false"]
tags: [
  "fetched",
  "小丫画图"
]
categories: ["Acdemic"]
---
把基因在pancancer和GTEx中的表达量画成box plot，显著性标*** by 小丫画图
------
<div><p>小伙伴问：感谢小丫带我们打开xena魔盒，有一个问题，FigureYa55pancancer_violin的图能不能画成box plot？</p><p>小丫答：可参考FigureYa12box的画法，能让R水平上一个台阶。</p><p><br></p><p>问：懒，能不能用它的输出文件easy_input.csv作为输入，直接画出boxplot？想要无缝对接。</p><p>答：能。感谢Chris Lou帮忙更新，今天分享ggpubr版，下次分享纯ggplot2的解决方案。</p><p><br></p><p><span>用ggpubr画带***的box plot</span><br></p><p>【优点】打包了，用法简单</p><p>【缺点】打包了，徒增学习成本，修改细节不便<br></p><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="apache"><code><span><span>library</span>(ggpubr)</span></code><code><span><span># 读入FigureYa55pancancer_violin的输出文件easy_input.csv</span></span></code><code><span><span># 包含某一基因在TCGA的33种癌症和GTEx正常组织里的表达量</span></span></code><code><span><span>tcga_gtex</span> &lt;- read.csv(<span>"easy_input.csv"</span>, row.names = 1, header = T, as.is = F)</span></code><code><span><br></span></code><code><span><span># 设置纵坐标title</span></span></code><code><span><span>ylabname</span> &lt;- paste0(<span>"TP53"</span>, <span>"expression"</span>)</span></code><code><span><span># 修改列名，更易理解，便于套用</span></span></code><code><span><span>colnames</span>(tcga_gtex) &lt;- c(<span>"Tissues"</span>, <span>"Groups"</span>, <span>"Gene"</span>)</span></code><code><span><br></span></code><code><span><span># 开始画图</span></span></code><code><span><span>p2</span> &lt;- ggboxplot(tcga_gtex, x = <span>"Tissues"</span>, y = <span>"Gene"</span>, fill = 'Groups',</span></code><code><span>                <span>ylab</span> = ylabname, #纵坐标title</span></code><code><span>                <span>color</span> = <span>"Groups"</span>, #两组用不同颜色</span></code><code><span>                <span>palette</span> = <span>"jco"</span>, #用JCO的配色方案</span></code><code><span>                <span>#add = "jitter", #画散点</span></span></code><code><span>                <span>#shape = "Groups", #两组散点用不同形状</span></span></code><code><span>                <span>ggtheme</span> = theme_minimal())</span></code><code><span><span># 计算p value</span></span></code><code><span><span># 方法可选"holm", "hochberg", "hommel", "bonferroni", "BH", "BY", "fdr"</span></span></code><code><span><span>anno_df</span> &lt;- compare_means(Gene ~ Groups, group.by = <span>"Tissues"</span>, data = tcga_gtex,</span></code><code><span>                         <span>p</span>.adjust.method = <span>"holm"</span>)</span></code><code><span><br></span></code><code><span><span># 标注p value</span></span></code><code><span><span>p3</span> &lt;- p2 + stat_pvalue_manual(anno_df, x = <span>"Tissues"</span>, y.position = 15, </span></code><code><span>                              <span>label</span> = <span>"p.signif"</span>, </span></code><code><span>                              <span>position</span> = position_dodge(0.8))</span></code><code><span><span>p3</span></span></code><code><span><br></span></code><code><span><span># 保存到pdf文件，矢量图</span></span></code><code><span><span>ggsave</span>(<span>"pancancer_ggpubr.pdf"</span>, width = 14, height = 5)</span></code></pre></section><p>画出的box plot</p><p><img data-src="https://mmbiz.qpic.cn/mmbiz_png/fTGTY7BwuzfDjy2SKDTRu9pNWjHkwGEkZlCRpwv6pxxiashSnIjeNqqBh1eHiakEGYVyiaS1wLibe8vibvdueDLAN5w/640?wx_fmt=png" data-type="png" data-ratio="0.33796296296296297" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/fTGTY7BwuzfDjy2SKDTRu9pNWjHkwGEkZlCRpwv6pxxiashSnIjeNqqBh1eHiakEGYVyiaS1wLibe8vibvdueDLAN5w/640?wx_fmt=png"></p><p>用add = "jitter"加散点的效果<br></p><p><img data-src="https://mmbiz.qpic.cn/mmbiz_png/fTGTY7BwuzfDjy2SKDTRu9pNWjHkwGEk7oPh6YmeETibb8NibfXt4EzjMGjkKRRibdQUVTvfds2ztQZ1tkAkianbgg/640?wx_fmt=png" data-type="png" data-ratio="0.3333333333333333" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/fTGTY7BwuzfDjy2SKDTRu9pNWjHkwGEk7oPh6YmeETibb8NibfXt4EzjMGjkKRRibdQUVTvfds2ztQZ1tkAkianbgg/640?wx_fmt=png"></p><p>图中p value 转 * 规则：<br></p><ul><li><p><code>ns</code>: p &gt; 0.05</p></li><li><p><code>*</code>: p &lt;= 0.05</p></li><li><p><code>**</code>: p &lt;= 0.01</p></li><li><p><code>***</code>: p &lt;= 0.001</p></li><li><p><code>****</code>: p &lt;= 0.0001</p></li></ul><p><br></p><p><span>怎样获得easy_input.csv文件？</span></p><p>点击左下角“阅读原文”，付款，留邮箱。</p><p>带你从xena下载数据开始，到提取基因在33种癌症中的表达量，不怕TCGA的normal太少，用GTEx的正常组织作为对照，输出easy_input.csv文件。</p><p><br></p><p>一个问题一种解法一篇推文，轻松更，如果你喜欢这种方式，就请点个“在看”鼓励小丫这样更新吧～</p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/dZrjsVuHMcqOTFKWajeHQg",target="_blank" rel="noopener noreferrer">原文链接</a>
