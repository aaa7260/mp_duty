---
title: "分割式小提琴图--双分类变量的箱线图升级版"
date: 2023-03-07T10:41:00Z
draft: ["false"]
tags: [
  "fetched",
  "生信星球"
]
categories: ["Acdemic"]
---
分割式小提琴图--双分类变量的箱线图升级版 by 生信星球
------
<div><section data-tools="新媒体管家" data-label="powered by xmt.cn"><br></section><p><img data-ratio="1" data-src="https://res.wx.qq.com/mpres/htmledition/images/icon/common/emotion_panel/emoji_wx/2_06.png" data-w="20" width="20px" src="https://res.wx.qq.com/mpres/htmledition/images/icon/common/emotion_panel/emoji_wx/2_06.png"><span> 今天是生信星球陪你的<span><strong>第575天</strong></span></span><img data-ratio="1" data-src="https://res.wx.qq.com/mpres/htmledition/images/icon/common/emotion_panel/smiley/smiley_56.png" data-w="20" width="20px" src="https://res.wx.qq.com/mpres/htmledition/images/icon/common/emotion_panel/smiley/smiley_56.png"></p><hr><p><span><span>   </span><span>大神一句话，菜鸟跑半年。我不是大神，但我可以缩短你走弯路的半年~</span></span></p><p><span><span>   就像歌儿唱的那样，如果你不知道该往哪儿走，就留在这学点生信好不好~</span></span></p><p><span>   这里有豆豆和花花的学习历程，从新手到进阶，生信路上有你有我！</span></p><section><blockquote><p>花花写于2020-3-24</p></blockquote><h3><span>起因</span></h3><p><span>以前写的箱线图教程：</span><br></p><section><figure><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU4NjU4ODQ2MQ==&amp;mid=2247485661&amp;idx=1&amp;sn=517e813562caad8f4fe0016d5b7475e9&amp;chksm=fdf8409fca8fc98996a1e17610ba2d934e501ad18aeef041e34cf331a5979fab09fdbd6210bc&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2">箱线图走一个</a></figure><figure><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU4NjU4ODQ2MQ==&amp;mid=2247487188&amp;idx=1&amp;sn=4b8313a80db5867d05bedc17f0a08044&amp;chksm=fdf84696ca8fcf80d184b056ff0f22061a5b38afbd4cf47edefa78d3dfeb7d17188b46b6eff5&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2">批量绘制配对样本差异基因的箱线图</a><br></figure><figure><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU4NjU4ODQ2MQ==&amp;mid=2247487197&amp;idx=1&amp;sn=4f562feda620a457139e1cde8b5820f3&amp;chksm=fdf8469fca8fcf89ad23d0b81bd832e10de4376c6075149ae990132228854a3b0c2c67d120ea&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2">两种方法批量绘制差异基因箱线图（朋友圈无奖竞答公布答案）</a></figure><figure><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU4NjU4ODQ2MQ==&amp;mid=2247487321&amp;idx=1&amp;sn=9d44f98e9ae0e3e8f69ac8a3771213be&amp;chksm=fdf8471bca8fce0d9e3a6dbe120c8642d61913bd289fe5e73d20e5345630ec02420404da62ee&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2">教你画双分类变量的箱线图</a><br></figure></section><p>上次提到了双分类变量的箱线图，形如：<br></p><figure><img data-ratio="0.7306451612903225" data-src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHqjXibKHpj6E6iamhZiakLCibHSRFyXbqvHTQI3dEch5wjgvzAjvFmoURDpEVDUT153xibht2IFhEyFadA/640?wx_fmt=png" data-type="png" data-w="1240" title="" src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHqjXibKHpj6E6iamhZiakLCibHSRFyXbqvHTQI3dEch5wjgvzAjvFmoURDpEVDUT153xibht2IFhEyFadA/640?wx_fmt=png"></figure><p>今天无意间在群里看到这个图：<br></p><figure><img data-ratio="0.5967741935483871" data-src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHqjXibKHpj6E6iamhZiakLCibHSCrlmgayZhVEkayaDPhtibSPsiaC9dPUXLf7BCZIrJxq7eUZoCdyt2oeg/640?wx_fmt=png" data-type="png" data-w="1240" title="" src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHqjXibKHpj6E6iamhZiakLCibHSCrlmgayZhVEkayaDPhtibSPsiaC9dPUXLf7BCZIrJxq7eUZoCdyt2oeg/640?wx_fmt=png"></figure><br>看起来正是分组箱线图的美化版哦~对美图毫无免疫力的我就开始仿画了~<br>搜到了一个关键函数：geom_split_violin<br>发现这个函数并不出自ggplot2，而是扩展出来的，找到了它的网页。<br>该函数链接出自：<p><br></p><blockquote><p>https://raw.githubusercontent.com/EasyChart/Beautiful-Visualization-with-R/27afccac06c6e33841dfae1ce83963571cd5c43f/%E7%AC%AC5%E7%AB%A0%20%E6%95%B0%E6%8D%AE%E5%88%86%E5%B8%83%E5%9E%8B%E5%9B%BE%E8%A1%A8/%E5%9B%BE5-2-10%20%E5%8F%8C%E6%95%B0%E6%8D%AE%E7%B3%BB%E5%88%97%E7%9A%84%E5%88%86%E5%B8%83%E5%9E%8B%E5%9B%BE%E8%A1%A8.R<br>作者在github分享，可自由参考</p></blockquote><h3><span>成果</span></h3><p>分别经历了出图、配色、去边框（图I）、加中心点（图II），加标准差和p值（图III）以及加标准差和显著性，可根据需求自由选择。<br></p><figure><img data-ratio="0.6024193548387097" data-src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHqjXibKHpj6E6iamhZiakLCibHSiaKqhRuSSibbZWBDBemaSdtCHGBR57Trdrx67vCjP7c9BDJWkvlSGhKw/640?wx_fmt=png" data-type="png" data-w="1240" title="" src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHqjXibKHpj6E6iamhZiakLCibHSiaKqhRuSSibbZWBDBemaSdtCHGBR57Trdrx67vCjP7c9BDJWkvlSGhKw/640?wx_fmt=png"></figure><h3><span>代码</span></h3><p>对应的代码为：</p></section><p><mp-pay-preview-filter></mp-pay-preview-filter></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/rNsLPuCqqdAfye2qg4GuZQ",target="_blank" rel="noopener noreferrer">原文链接</a>
