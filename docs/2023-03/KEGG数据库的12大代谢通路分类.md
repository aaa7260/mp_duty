---
title: "KEGG数据库的12大代谢通路分类"
date: 2023-03-28T07:39:40Z
draft: ["false"]
tags: [
  "fetched",
  "生信技能树"
]
categories: ["Acdemic"]
---
KEGG数据库的12大代谢通路分类 by 生信技能树
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><blockquote data-tool="mdnice编辑器"><p>最近看到不少文章，从kegg数据库里面的下载了86个代谢通路的1660个基因，然后就针对这些代谢基因集做后续分析。</p></blockquote><p data-tool="mdnice编辑器">其实这样的KEGG数据库的12大代谢通路数据挖掘文章很多，其中一个佼佼者是复旦大学邵志敏团队三阴性乳腺癌的代谢组学文章，文献标题是：《Metabolic-Pathway-Based Subtyping of Triple- Negative Breast Cancer Reveals Potential Therapeutic Targets》，其数据挖掘仅仅是一个引子，后续仍然是有大量真实病人自己的代谢组数据做支撑。如下所示，可以看到在the tumor samples versus paired normal samples  in the FUSCC cohort. 的差异分析里面，统计学显著（upregulated or downregulated (FDR &lt; 0.05)）的失调代谢通路，在 10 metabolic categories  分类展示 ：</p><p><img data-galleryid="" data-ratio="0.8136020151133502" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wzFKPuBweQByO5dMzLmCEC7YAkibOb88icTFNpAENrXuJBgaJRcic4zzWHDSYF9YZVNXDkQUaWyJ3S3w/640?wx_fmt=png" data-type="png" data-w="794" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wzFKPuBweQByO5dMzLmCEC7YAkibOb88icTFNpAENrXuJBgaJRcic4zzWHDSYF9YZVNXDkQUaWyJ3S3w/640?wx_fmt=png"></p><figure data-tool="mdnice编辑器"><figcaption>分类展示失调代谢通路</figcaption></figure><p data-tool="mdnice编辑器">现在就给大家演示一下如何获取KEGG数据库的12大代谢通路以及其分类，首先KEGG官网在：https://www.genome.jp/kegg/pathway.html</p><p data-tool="mdnice编辑器">进入官网就可以看到12大代谢通路分类，列表如下所示：</p><ul data-tool="mdnice编辑器"><li><section>Carbohydrate</section></li><li><section>Energy</section></li><li><section>Lipid</section></li><li><section>Nucleotide</section></li><li><section>Amino acid</section></li><li><section>Other amino</section></li><li><section>Glycan</section></li><li><section>Cofactor/vitamin</section></li><li><section>Terpenoid/PK</section></li><li><section>Other secondary metabolite</section></li><li><section>Xenobiotics</section></li><li><section>Chemical structure</section></li></ul><p data-tool="mdnice编辑器">其中Nucleotide这个分类的通路是最少了，仅仅是嘌呤和嘧啶的这两个不同通路。</p><h3 data-tool="mdnice编辑器"><span></span><span>通过KEGGREST包来探索KEGG数据库的12大代谢通路</span><span></span></h3><p data-tool="mdnice编辑器">正常情况下，大家安装R包应该是都问题不大了。这里BiocManager安装"KEGGREST"即可，代码如下所示：</p><pre data-tool="mdnice编辑器"><span></span><code><span>#BiocManager安装"KEGGREST"，</span><br><span>if</span> (!requireNamespace(<span>"BiocManager"</span>, quietly = <span>TRUE</span>))<br>  install.packages(<span>"BiocManager"</span>)<br>BiocManager::install(<span>"KEGGREST"</span>)<br><br><span>#加载"KEGGREST"</span><br><span>library</span>(KEGGREST) <span>#用于提取通路及基因信息</span><br></code></pre><p data-tool="mdnice编辑器">然后查询 人类 在KEGG数据库中的缩写</p><pre data-tool="mdnice编辑器"><span></span><code><span>library</span>(KEGGREST) <span>#用于提取通路及基因信息</span><br><span>#获取KEGG数据库收录的所有物种的清单</span><br>org &lt;- keggList(<span>'organism'</span>) <br><span># 在中国大陆地区耗时2-3分钟，在海外耗时一秒钟不到。</span><br>head(org) <br><span># 查询 人类  在KEGG数据库中的缩写</span><br><span>library</span>(stringr)<br>org[str_detect(org[,<span>3</span>],<span>"human"</span>),] <br></code></pre><p data-tool="mdnice编辑器">当然，也可以<strong>网页查询</strong>。https://www.genome.jp/kegg/catalog/org_list.html ，可以看到，人类  在KEGG数据库对应的缩写为“<strong>hsa</strong>”</p><p data-tool="mdnice编辑器">接下来获取人类的KEGG数据库的全部通路及基因集：</p><pre data-tool="mdnice编辑器"><span></span><code>hsa_path &lt;- keggLink(<span>"pathway"</span>,<span>"hsa"</span>) <br><span>#得到字符型向量。元素名为基因id，元素为通路名</span><br><span># 因为是在线获取，所以根据网络情况，耗时4-10分钟不等</span><br><span>#查看hsa_path的前6个</span><br>length(hsa_path)<br>hsa_path[<span>1</span>:<span>6</span>] <br>length(unique(names(hsa_path)))<br>length(unique(hsa_path))<br><br>&gt; length(unique(names(hsa_path)))<br>[<span>1</span>] <span>8114</span><br>&gt; length(unique(hsa_path))<br>[<span>1</span>] <span>345</span><br>&gt; <br></code></pre><p data-tool="mdnice编辑器">可以看到人类的KEGG通路有 345 条，涉及到的基因数量是 8114 个（2022-02-20查询）。</p><p data-tool="mdnice编辑器">另外，这个KEGGREST包的函数并不多，值得摸索学习：</p><pre data-tool="mdnice编辑器"><span></span><code>keggConv Convert KEGG identifiers to/from outside identifiers<br>keggFind Finds entries with matching query keywords or other query data <span>in</span> a given database<br>keggGet Retrieves given database entries<br>keggInfo Displays the current statistics of a given database<br>keggLink Find related entries by using database cross-references.<br>keggList Returns a list of entry identifiers and associated definition <span>for</span> a given database or a given <span>set</span> of database entries.<br></code></pre><p data-tool="mdnice编辑器">另外，通过观察KEGG官网 ：https://www.genome.jp/kegg/pathway.html 的12大代谢通路，可以看到通路的id都是00开头，所以很容易使用下面的代码进行批量查询 ：</p><pre data-tool="mdnice编辑器"><span></span><code>meta= unique(hsa_path)[grepl(<span>'hsa00'</span>,unique(hsa_path))]<br>hsa_info &lt;- lapply(meta, keggGet)  <br><br>nm=unlist(lapply( hsa_info , <span>function</span>(x) x[[<span>1</span>]]$NAME))<br><span>library</span>(stringr)<br>genes = unlist(lapply( hsa_info , <span>function</span>(x) {<br>  g = x[[<span>1</span>]]$GENE<br>  paste(str_split(g[seq(<span>2</span>,length(g),by=<span>2</span>)],<span>';'</span>,simplify = <span>T</span>)[,<span>1</span>],collapse =<span>';'</span>)<br>}))<br>df =data.frame(<br>  hsa= meta,<br>  nm=nm,<br>  genes =genes<br>)<br></code></pre><p data-tool="mdnice编辑器">得到的 84个通路和对应的基因组成的表格如下所示：</p><p><img data-galleryid="" data-ratio="0.4689880304678999" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wzFKPuBweQByO5dMzLmCEC7MbNttC9ricicRcWfJYibN2UnW3Ln3uPZPqdHibWt1iaI3St6CjTs10gs9Tw/640?wx_fmt=png" data-type="png" data-w="1838" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wzFKPuBweQByO5dMzLmCEC7MbNttC9ricicRcWfJYibN2UnW3Ln3uPZPqdHibWt1iaI3St6CjTs10gs9Tw/640?wx_fmt=png"></p><figure data-tool="mdnice编辑器"><figcaption>84个通路和对应的基因</figcaption></figure><p data-tool="mdnice编辑器">但是很多文章说的是kegg数据库里面的下载了86个代谢通路的1660个基因，所以我重新认真看了看 KEGG官网 ：https://www.genome.jp/kegg/pathway.html 的12大代谢通路，发现有一些通路居然是01开头，并不是00开头，让我有点费解  ， 就是这个 1.12 Chemical structure transformation maps</p><pre data-tool="mdnice编辑器"><span></span><code> 01060  Biosynthesis of plant secondary metabolites<br> 01061  Biosynthesis of phenylpropanoids<br> 01062  Biosynthesis of terpenoids and steroids<br> 01063  Biosynthesis of alkaloids derived from shikimate pathway<br> 01064  Biosynthesis of alkaloids derived from ornithine, lysine and nicotinic acid<br> 01065  Biosynthesis of alkaloids derived from histidine and purine<br> 01066  Biosynthesis of alkaloids derived from terpenoid and polyketide<br> 01070  Biosynthesis of plant hormones<br></code></pre><p data-tool="mdnice编辑器">但是我去查询01开头的，并没有发现前面的  1.12 Chemical structure transformation maps  ：</p><pre data-tool="mdnice编辑器"><span></span><code>&gt; unique(hsa_path)[grepl(<span>'hsa01'</span>,unique(hsa_path))]<br> [1] <span>"path:hsa01040"</span> <span>"path:hsa01100"</span> <span>"path:hsa01200"</span> <span>"path:hsa01210"</span><br> [5] <span>"path:hsa01212"</span> <span>"path:hsa01230"</span> <span>"path:hsa01240"</span> <span>"path:hsa01250"</span><br> [9] <span>"path:hsa01521"</span> <span>"path:hsa01522"</span> <span>"path:hsa01523"</span> <span>"path:hsa01524"</span><br></code></pre><p data-tool="mdnice编辑器">所以这个并不是导致kegg数据库里面的通路数量和基因数量产生冲突的原因！</p><p data-tool="mdnice编辑器">聪明的读者朋友们，你们知道为什么吗？</p></section><p>不过，我看作者在后面的热图展现的时候，剩下来的就7大代谢通路里面的几十个细节展现：<br></p><p><img data-galleryid="" data-ratio="0.49210206561360875" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wzFKPuBweQByO5dMzLmCEC7GRSRgvh5SfZyVZkkmV2BaJIamZgsMgs4nDpEWWXXfBJqgZIecV65icA/640?wx_fmt=png" data-type="png" data-w="1646" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wzFKPuBweQByO5dMzLmCEC7GRSRgvh5SfZyVZkkmV2BaJIamZgsMgs4nDpEWWXXfBJqgZIecV65icA/640?wx_fmt=png"></p><p><br></p><p>所以，个别通路的通路缺失应该是无伤大雅。</p><h3 data-tool="mdnice编辑器"><span>写在文末</span></h3><p data-tool="mdnice编辑器">我在《生信技能树》，《生信菜鸟团》，《单细胞天地》的大量推文教程里面共享的代码都是复制粘贴即可使用的， 有任何疑问欢迎留言讨论，也可以发邮件给我，详细描述你遇到的困难的前因后果给我，我的邮箱地址是 jmzeng1314@163.com</p><p data-tool="mdnice编辑器">如果你确实觉得我的教程对你的科研课题有帮助，让你茅塞顿开，或者说你的课题大量使用我的技能，烦请日后在发表自己的成果的时候，加上一个简短的致谢，如下所示：</p><pre data-tool="mdnice编辑器"><span></span><code>We thank Dr.Jianming Zeng(University of Macau), and all the members of his bioinformatics team, biotrainee, <span>for</span> generously sharing their experience and codes.<br></code></pre><p data-tool="mdnice编辑器">十年后我环游世界各地的高校以及科研院所（当然包括中国大陆）的时候，如果有这样的情谊，我会优先见你</p><p><br></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/VapK1ocpdaSgN5kv_wKUtw",target="_blank" rel="noopener noreferrer">原文链接</a>
