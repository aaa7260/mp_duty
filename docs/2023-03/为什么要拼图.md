---
title: "为什么要拼图"
date: 2023-03-06T10:37:21Z
draft: ["false"]
tags: [
  "fetched",
  "生信技能树"
]
categories: ["Acdemic"]
---
为什么要拼图 by 生信技能树
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><blockquote data-tool="mdnice编辑器"><p>常见期刊其实都有图表数量的限制，比如：</p></blockquote><section data-tool="mdnice编辑器"><table><thead><tr><th>Journal</th><th>Impact Factor</th><th>Number of Figures</th></tr></thead><tbody><tr><td><em>Nature Cancer</em></td><td>60.72</td><td>5-8</td></tr><tr><td><em>Science</em></td><td>47.73</td><td>6</td></tr><tr><td><em>Cancer Cell</em></td><td>31.74</td><td>8</td></tr><tr><td><em>Journal of Clinical Oncology</em></td><td>44.54</td><td>6</td></tr><tr><td><em>JAMA Oncology</em></td><td>31.78</td><td>5</td></tr><tr><td><em>Cell Host and Microbe</em></td><td>21.02</td><td>7</td></tr></tbody></table></section><p data-tool="mdnice编辑器">虽然说一图胜千言，但是成百上千张图就是另外一种啰嗦了，尤其是单细胞时代，很容易跑出来成百上千个图，这个时候首先需要继续汇总信息，其次需要把关键图表拼接起来，这样的话虽然期刊只允许我们给七八张图，但是每个图里面还是可以有十几个小图。</p><p data-tool="mdnice编辑器">比如2022的一个卵巢癌单细胞文章就是如此：</p><p><img data-galleryid="" data-ratio="0.9106002554278416" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wxaextb1mu4W49QwuliaZ8xAibbzqjibWOT07I4H9TMHerV0dJ2z4xqOh0vAeTr7e4gtIxtIHkzibGY2g/640?wx_fmt=png" data-type="png" data-w="1566" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wxaextb1mu4W49QwuliaZ8xAibbzqjibWOT07I4H9TMHerV0dJ2z4xqOh0vAeTr7e4gtIxtIHkzibGY2g/640?wx_fmt=png"></p><figure data-tool="mdnice编辑器"><figcaption>2022的一个卵巢癌单细胞文章</figcaption></figure><p data-tool="mdnice编辑器">同样的，我们做常规的表达量差异分析，比如芯片或者转录组数据，都是会有起码三张图， 我在生信技能树的教程：<a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247491228&amp;idx=1&amp;sn=34fed09dec0f8c27bd408ba8476d9133&amp;scene=21#wechat_redirect" data-linktype="2">《你确定你的差异基因找对了吗？》</a>提到过，必须要对你的<strong>转录水平的全局表达矩阵</strong>做好质量控制，最好是看到<strong>标准3张图</strong>：</p><ul data-tool="mdnice编辑器"><li><section>左边的热图，说明我们实验的两个分组，normal和npc的很多基因表达量是有明显差异的</section></li><li><section>中间的PCA图，说明我们的normal和npc两个分组非常明显的差异</section></li><li><section>右边的层次聚类也是如此，说明我们的normal和npc两个分组非常明显的差异</section></li></ul><p data-tool="mdnice编辑器">如果分组在3张图里面体现不出来，<strong>实际上后续差异分析是有风险的</strong>。这个时候需要根据你自己不合格的3张图，仔细探索哪些样本是离群点，自行查询中间过程可能的问题所在，或者检查是否有其它混杂因素，都是会影响我们的差异分析结果的生物学解释。比如发表于2021年9月27日，美国康奈尔医学院<strong>周乔</strong>课题组在<em><strong>Cell Stem Cell</strong></em> 期刊，文章标题是：《SATB2 preserves colon stem cell identity and mediates ileum-colon conversion via enhancer remodeling》，在线阅读链接 是：https://doi.org/10.1016/j.stem.2021.09.004 在附件就提到了这样的三张图：</p><p><img data-galleryid="" data-ratio="0.36631779257849667" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wxaextb1mu4W49QwuliaZ8xACQzQZAqNicR78GTwsOmfz6pRS9W8a4cDJnDmzW33gTicm14z2K1ibJIjg/640?wx_fmt=png" data-type="png" data-w="2102" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wxaextb1mu4W49QwuliaZ8xACQzQZAqNicR78GTwsOmfz6pRS9W8a4cDJnDmzW33gTicm14z2K1ibJIjg/640?wx_fmt=png"></p><figure data-tool="mdnice编辑器"><figcaption>表达量矩阵分析一定要三张图</figcaption></figure><p data-tool="mdnice编辑器">每个子图都是独立的绘图代码，然后就可以拼接</p><h3 data-tool="mdnice编辑器"><span></span>Using <code>cowplot</code> to arrange figures<span></span></h3><p data-tool="mdnice编辑器">The main function to combine figures using <code>cowplot</code> is <code>plot_grid()</code>. Let's check out the help documentation using <code>?plot_grid()</code>. The first and most important parameter is the list of plots we want to combine, <code>plotlist</code>.</p><p data-tool="mdnice编辑器">Let's check out the basic use of this function by calling the plots we want to combine and by providing labels using the <code>labels</code> argument.</p><pre data-tool="mdnice编辑器"><span></span><code>plot_grid(pca,volcano,hmap,sc, labels=<span>"AUTO"</span>)<br></code></pre><p data-tool="mdnice编辑器">或者复杂一点的 In general, there seem to be more options for plot customization (without adding ggplot2 layers) with <code>cowplot</code>.</p><pre data-tool="mdnice编辑器"><span></span><code>plot_grid(pca,volcano,hmap,sc, labels=<span>"AUTO"</span>,<br>           label_size = 14, <br>          label_fontface  = <span>"bold.italic"</span>, label_colour  =<span>"blue"</span>,<br>          label_fontfamily =<span>"Times New Roman"</span>,<br>                   label_y=0.25)<br></code></pre><p data-tool="mdnice编辑器">拼图效果如下所示：</p><p><img data-galleryid="" data-ratio="0.977088948787062" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wxaextb1mu4W49QwuliaZ8xAwIIlABs3juicZ0I8XhWYR0iaouI3PLFIf9kjHo966tZVW09O7IbBVtSg/640?wx_fmt=png" data-type="png" data-w="1484" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wxaextb1mu4W49QwuliaZ8xAwIIlABs3juicZ0I8XhWYR0iaouI3PLFIf9kjHo966tZVW09O7IbBVtSg/640?wx_fmt=png"></p><figure data-tool="mdnice编辑器"><figcaption> </figcaption></figure><h2 data-tool="mdnice编辑器"><span></span>强烈推荐 <code>patchwork</code></h2><blockquote data-tool="mdnice编辑器"><p>The goal of patchwork is to make it ridiculously simple to combine separate ggplots into the same graphic. As such it tries to solve the same problem as gridExtra::grid.arrange() and cowplot::plot_grid but using an API that incites exploration and iteration, and scales to arbitrily complex layouts. ---Thomas Lin Pederson, Patchwork documentation.</p></blockquote><p data-tool="mdnice编辑器">Patchwork allows users to combine plots using simple mathematic operations such as <code>+</code> and <code>/</code>.</p><p data-tool="mdnice编辑器">所以，上面的4个图拼接起来，也是超级简单的语法：<code>pca + volcano + hmap + sc</code></p></section><h4 data-tool="mdnice编辑器">文末友情宣传</h4><p data-tool="mdnice编辑器">强烈建议你推荐给身边的<strong>博士后以及年轻生物学PI</strong>，多一点数据认知，让他们的科研上一个台阶：</p><ul data-tool="mdnice编辑器"><li><section><a href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247519543&amp;idx=1&amp;sn=b9290a55d50c038bcc6e97d53a88b1c5&amp;chksm=9b4bcd8cac3c449aaa16dbf518578e9c7a4e67fe4122ae7c4fb115ddb2a843a976fa3462dcea&amp;scene=21#wechat_redirect" data-linktype="2">生物信息学马拉松授课（买一得五）</a> ，你的生物信息学入门课</section></li><li><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247519765&amp;idx=2&amp;sn=6cb33654c7751f4c3df0f84743f77aaf&amp;chksm=9b4bceaeac3c47b8899afc00077b96357b87a4ed6b75e7c434ba14071fd6c8448e4c218de5e0&amp;scene=21#wechat_redirect" textvalue="144线程640Gb内存服务器共享一年仍然是仅需800" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1">144线程640Gb内存服务器共享一年仍然是仅需800</a></section></li><li><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247519765&amp;idx=1&amp;sn=ce5a8c8182f854c88043059f8c2cb9ff&amp;chksm=9b4bceaeac3c47b88c19941d43dbb1401f3a92206481a0afc41159927868199643f795d62a7e&amp;scene=21#wechat_redirect" textvalue="千呼万唤始出来的独享生物信息学云服务器" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1">千呼万唤始出来的独享生物信息学云服务器</a></section></li></ul><p><br></p><p><br></p><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/4cQIzoBCbQRn5v14B8mpEQ",target="_blank" rel="noopener noreferrer">原文链接</a>
