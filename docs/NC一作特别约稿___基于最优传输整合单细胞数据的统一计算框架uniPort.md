---
title: "NC一作特别约稿 | 基于最优传输整合单细胞数据的统一计算框架uniPort"
date: 2022-12-21T02:43:27Z
draft: ["false"]
tags: [
  "fetched",
  "生信编程自修室"
]
categories: ["Acdemic"]
---
NC一作特别约稿 | 基于最优传输整合单细胞数据的统一计算框架uniPort by 生信编程自修室
------
<div><section data-tool="markdown编辑器" data-website="https://markdown.com.cn/editor"><p data-tool="markdown.com.cn编辑器">多模态数据的整合计算是数据科学和机器学习研究的热点问题。其中，整合单细胞多模态测序数据， 进行全面挖掘和解析，提供细胞全面的分子视图，是单细胞数据分析的基础和核心环节之一。但由于不同模态数据集间样本（细胞）缺少匹配信息，同时由于数据集间存在异质性，因而使数据整合非常具有挑战性。</p><p><img data-galleryid="" data-ratio="0.35144927536231885" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/rWiaFvFngFbQvZf0R33icIeFOXG76fmR1AHNGuB7CsxDROAj2uKMZjYH6mNsTibia1pRRjy3QvpGz21icYCyX47naLw/640?wx_fmt=png" data-type="png" data-w="1656" src="https://mmbiz.qpic.cn/mmbiz_png/rWiaFvFngFbQvZf0R33icIeFOXG76fmR1AHNGuB7CsxDROAj2uKMZjYH6mNsTibia1pRRjy3QvpGz21icYCyX47naLw/640?wx_fmt=png"></p><p data-tool="markdown.com.cn编辑器">2022 年 12 月 1 日，同济大学控制科学与工程系洪奕光教授、中国科学院数学与系统科学研究院万林研究院共同通讯在《自然·通讯》（Nature Communications）期刊在线发表了题为“一种基于最优传输整合单细胞数据的统一计算框架”（A unified computational framework for single-cell data integration with optimal transport）的研究论文。该论文基于耦合变分自编器（VAE）的深度学习技术和小批量非平衡最优传输（Minibatch-UOT）技术，提出了一种准确、高效、适用于整合大规模多模态异质数据的统一计算框架 uniPort。</p><p><img data-galleryid="" data-ratio="0.7767857142857143" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/rWiaFvFngFbQvZf0R33icIeFOXG76fmR1AntSd79cvsztrXHO7zAlLN84IicFviaghKmfnLkDs125ic06OmcPNuZKew/640?wx_fmt=png" data-type="png" data-w="672" src="https://mmbiz.qpic.cn/mmbiz_png/rWiaFvFngFbQvZf0R33icIeFOXG76fmR1AntSd79cvsztrXHO7zAlLN84IicFviaghKmfnLkDs125ic06OmcPNuZKew/640?wx_fmt=png"></p><p data-tool="markdown.com.cn编辑器">具体来说，uniPort 输入两个模态的公共基因/特征到共享的编码器里，将两个模态映射到同一个隐空间，然后通过一个共同的解码器分别重构出输入的数据。这里作者给每个模态分别采用了一个 Dataset-Specific Batch Norm（DSBN）层用于模态建模。此外，作者还引入了两个模态独有的解码器，用于解码出非公共的基因。因为除了公共基因外，一些非公共的高变基因，也对识别细胞状态或类型具有积极的作用，这里把他们单独编码，希望使得隐空间能有更好的聚类结果。但是，由于两个数据集固有的异质性，例如批次效应或模态之间的差异等，而引入的数据集特有的基因来调整聚类，会进一步扩大异质性，导致两个数据集的隐空间分布差异变大。所以这里作者引入小批量非平衡最优传输损失对齐隐空间分布。</p><p data-tool="markdown.com.cn编辑器"><span>uniPort 有以下几点优势：</span></p><section data-tool="markdown编辑器" data-website="https://markdown.com.cn/editor"><ul data-tool="markdown.com.cn编辑器"><li><section><p>利用多模态数据集的公共高变基因以及各个数据集的特有高度可变基因进行系统建模，从而在模型训练过程中能够对异质细胞群体在隐空间中进行高精度的鉴定与分离；</p></section></li><li><section><p>采用了新型耦合 VAE 神经网络模型，增强了方法的非线性校正能力，并利用耦合 VAE 的泛化能力构建了跨模态在线预测的参考图谱；</p></section></li><li><section><p>最小化 Minibatch-UOT 损失，一方面满足了大规模数据的计算需求，一方面实现了对异质数据集的内嵌结构对齐，解决了其他基于自编码器的多模态数据整合方法依赖样本匹配先验信息的局限；</p></section></li><li><section><p>输出全局最优传输的概率转移矩阵，即细胞-细胞匹配矩阵，为空间异质数据的反卷积提供了灵活与有效的迁移学习基础；</p></section></li></ul></section><p data-tool="markdown.com.cn编辑器"><br></p><h3 data-tool="markdown.com.cn编辑器"><span></span>uniPort 用于 scATAC 和 scRNA 数据整合<span></span></h3><p data-tool="markdown.com.cn编辑器">作者在一个细胞配对的 scATAC 和 scRNA（PBMC 数据集），和两个细胞未配对的 scATAC 和 scRNA 数据集（基于微流体的 PBMC 数据集和小鼠脾脏数据集）上对 uniPort 进行了基准测试，均取得了良好的整合效果。</p><p><img data-galleryid="" data-ratio="0.557919621749409" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/rWiaFvFngFbQvZf0R33icIeFOXG76fmR1AjibCAyY3Wzjyb8154JqgdZ9uroI48zTNDY8OLicWvCfX44tr1GKMMRHg/640?wx_fmt=png" data-type="png" data-w="846" src="https://mmbiz.qpic.cn/mmbiz_png/rWiaFvFngFbQvZf0R33icIeFOXG76fmR1AjibCAyY3Wzjyb8154JqgdZ9uroI48zTNDY8OLicWvCfX44tr1GKMMRHg/640?wx_fmt=png"></p><h3 data-tool="markdown.com.cn编辑器"><span></span>uniPort 用于 MERFISH 基因插补<span></span></h3><p data-tool="markdown.com.cn编辑器">为了探索 uniPort 的基因插补能力，作者按照 gimVI 的方案从 scRNA 中插补 MERFISH 中缺失的基因。具体来说，首先随机选择 MERFISH 中 80%的基因作为训练基因，保留剩余的 20%基因作为测试基因。将上述步骤重复十二次，得到 12 个训练和测试基因集。之后，用每个训练基因集训练 uniPort 网络，然后插补相应的测试基因集。作者将 uniPort 的结果与两种最先进的基因插补方法 gimVI 和 Tangram 进行比较，性能评估采用真实测试基因值和预测值 Spearman 相关系数的中位数和平均值，以及 Pearson 相关系数的中位数和平均值。结果表明，uniPort 在 MERFISH 数据集上的基因插补效果更好。</p><p><img data-galleryid="" data-ratio="0.6666666666666666" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/rWiaFvFngFbQvZf0R33icIeFOXG76fmR1AiaGo71oNJeIIAB6reKYM7iaBF90ZNr7Lyc9utibJEmXfz3cjPloRduVEg/640?wx_fmt=png" data-type="png" data-w="1416" src="https://mmbiz.qpic.cn/mmbiz_png/rWiaFvFngFbQvZf0R33icIeFOXG76fmR1AiaGo71oNJeIIAB6reKYM7iaBF90ZNr7Lyc9utibJEmXfz3cjPloRduVEg/640?wx_fmt=png"></p><h3 data-tool="markdown.com.cn编辑器"><span></span>uniPort 用于空间数据去卷积<span></span></h3><p data-tool="markdown.com.cn编辑器">此外，作者通过整合单细胞与空转数据，将 RNA 的细胞标签迁移到空转数据上，从而解析空间数据的细胞群分布。在小鼠大脑前额叶的 10X Visium 切片中，我们能准确描绘出典型的组织结构，例如皮质层 L2/3 至 L6 神经元的分布层次清晰，并且 L6 神经元的三个亚类也能有较好的位置区分。此外，一些非神经元的支持细胞，也有较好的空间解析，例如少突胶质细胞和星形胶质细胞等都有很好的位置分布。</p><p><img data-galleryid="" data-ratio="0.4881720430107527" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/rWiaFvFngFbQvZf0R33icIeFOXG76fmR1AZFQZIicyJpYGkYM5IABgphJmQicmkFpyibFbctTWrKVu9QDz1zRJC9iamw/640?wx_fmt=png" data-type="png" data-w="930" src="https://mmbiz.qpic.cn/mmbiz_png/rWiaFvFngFbQvZf0R33icIeFOXG76fmR1AZFQZIicyJpYGkYM5IABgphJmQicmkFpyibFbctTWrKVu9QDz1zRJC9iamw/640?wx_fmt=png"></p><p data-tool="markdown.com.cn编辑器">在免疫高度浸润且弥散分布的乳腺癌空间转录组数据中，uniPort 依然能很好地解析肿瘤微环境的主要细胞构成，包括 T,B 细胞，髓系细胞，成纤维细胞和肿瘤上皮细胞，细胞的位置均与标记基因的表达分布一致。并且我们依据 T 和 B 细胞的共定位标记出目前新兴的三级淋巴结构，这是一项在癌症治疗中，新发掘的具有积极预后作用的指征。</p><p><img data-galleryid="" data-ratio="0.739454094292804" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/rWiaFvFngFbQvZf0R33icIeFOXG76fmR1AgjuTqtAxlWHypTPWtENhdbhM05hGqdYicx7CR5VLI5rxdcwzTpjABHg/640?wx_fmt=png" data-type="png" data-w="806" src="https://mmbiz.qpic.cn/mmbiz_png/rWiaFvFngFbQvZf0R33icIeFOXG76fmR1AgjuTqtAxlWHypTPWtENhdbhM05hGqdYicx7CR5VLI5rxdcwzTpjABHg/640?wx_fmt=png"></p><p data-tool="markdown.com.cn编辑器">为了探究 uniPort 更为广谱的应用，我们采用了 Spot 直径更大的空间数据与单细胞 RNA 数据整合，解析胰腺导管腺癌微环境的主要细胞组成，包括两类异质性较强的肿瘤细胞和实质细胞群。针对两类异质性较大的肿瘤细胞亚群，我们证明了其在功能及恶性程度上具有较大异质性，并且两类肿瘤区域内的细胞组成也有显著差异，证明肿瘤亚群 B 类是恶性程度较低的亚群。</p><p><img data-galleryid="" data-ratio="0.5288888888888889" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/rWiaFvFngFbQvZf0R33icIeFOXG76fmR1A2dIFib3t9bKpbGPLG6Ge7qCwNeA4yOHYeI84dk8lqXJ3yxqQfGBJ53g/640?wx_fmt=png" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/rWiaFvFngFbQvZf0R33icIeFOXG76fmR1A2dIFib3t9bKpbGPLG6Ge7qCwNeA4yOHYeI84dk8lqXJ3yxqQfGBJ53g/640?wx_fmt=png"></p><p data-tool="markdown.com.cn编辑器">综上所述，该工作开发了单细胞多模态数据整合统一的计算框架 uniPort，可以将不同模态的单细胞测序数据映射到统一的细胞嵌入空间，并利用最优传输消除生物学差异和模态间的异质性。该方法将对生物医学中单细胞测序数据的精确解析提供基础支持。</p><p data-tool="markdown.com.cn编辑器"><strong>关注下方公众号</strong>，下回更新不迷路。也欢迎小伙伴的积极投稿，本公众号永久免费为大家宣传自己或自己课题组新发表的生信相关工作。</p><section><mp-common-profile data-pluginname="mpprofile" data-weui-theme="light" data-id="MzU3MTY3ODA2Mw==" data-headimg="http://mmbiz.qpic.cn/mmbiz_png/rWiaFvFngFbQynpMRF2zxfbyAAKD7HObpc4ewnMg5WRK5u69FSRHb6aZreFxa2T6mKOKNKoltuuFDQtvh9VFdibQ/0?wx_fmt=png" data-nickname="生信编程自修室" data-alias="bio-informatics" data-signature="专注python、R语言编程、数据可视化、生物信息多组学分析" data-from="0" data-is_biz_ban="0"></mp-common-profile></section></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/CuDr63AFGti4ttk3zsH2xw",target="_blank" rel="noopener noreferrer">原文链接</a>
