---
title: "如何进行配对差异检验并作图？"
date: 2022-09-06T10:54:04Z
draft: ["false"]
tags: [
  "fetched",
  "SCIPainter"
]
categories: ["Acdemic"]
---
如何进行配对差异检验并作图？ by SCIPainter
------
<div><section data-mpa-powered-by="yiban.io"><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><section><section powered-by="xiumi.us"><section><section><svg viewbox="0 0 1 1"></svg></section></section></section><section powered-by="xiumi.us"><section><section><svg viewbox="0 0 1 1"></svg></section></section></section></section><section><section powered-by="xiumi.us"><section><section><svg viewbox="0 0 1 1"></svg></section></section></section></section><section><section powered-by="xiumi.us"><section><p><strong>点击蓝字 关注我们</strong></p></section></section></section><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><section><svg viewbox="0 0 1 1"></svg></section></section></section></section><section><section powered-by="xiumi.us"><section><section><svg viewbox="0 0 1 1"></svg></section></section></section></section></section></section></section><section powered-by="xiumi.us"><section><section><svg viewbox="0 0 1 1"></svg></section></section></section></section></section></section></section></section></section><section><span>常</span><span>见的配对差异检验方法主要是T检验和wilcox检验。</span><span>废话不多说，下面就为大家介绍如何使用rstatix包进行常见的配对差异检验并绘制配对箱形图。</span><br></section><p><br></p><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><img data-ratio="0.8216704" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6kD0ICDF1zD8x0W6ul7Nkcy79s6RHPnW7xH7gEdLjIyxNO8ghiaxyd4306Uic8ibhk8ndvgTDK642ByQ/640?wx_fmt=png" data-type="png" data-w="443" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6kD0ICDF1zD8x0W6ul7Nkcy79s6RHPnW7xH7gEdLjIyxNO8ghiaxyd4306Uic8ibhk8ndvgTDK642ByQ/640?wx_fmt=png"></section></section></section></section></section><section><section powered-by="xiumi.us"><section><p><strong>1. 整理数据</strong></p></section></section></section></section></section><p><br></p><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><section><span>#载入相关的R包；</span><br mpa-from-tpl="t"><span>library</span>(dplyr)<br mpa-from-tpl="t"><span>library</span>(rstatix)<br mpa-from-tpl="t"><span>library</span>(ggplot2)<br mpa-from-tpl="t"><br mpa-from-tpl="t"><span>#读入数据；</span><br mpa-from-tpl="t"><span>dt</span> &lt;- read.csv(<span>"box.csv"</span>)<br mpa-from-tpl="t"><span>#预览数据；</span><br mpa-from-tpl="t"><span>head</span>(dt)</section></pre></section><p><img data-ratio="0.2915750915750916" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6kD0ICDF1zD8x0W6ul7NkcyttHSKQGSkExd1vwg9RMhM9TSibHianYmdxVlCQcXbR03SMr2ERtChLzw/640?wx_fmt=png" data-type="png" data-w="1365" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6kD0ICDF1zD8x0W6ul7NkcyttHSKQGSkExd1vwg9RMhM9TSibHianYmdxVlCQcXbR03SMr2ERtChLzw/640?wx_fmt=png"></p><p><br></p><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><p><span>#查看数据框维度；</span><br mpa-from-tpl="t"><span>dim</span>(dt)<br mpa-from-tpl="t"><span>#[1] 21 7</span><br mpa-from-tpl="t"><br mpa-from-tpl="t"><span>#载入reshape2；</span><br mpa-from-tpl="t"><span>library</span>(reshape2)<br mpa-from-tpl="t"><span>#将“宽数据”转成“长数据”；</span><br mpa-from-tpl="t"><span>df</span> &lt;- melt(dt,id.vars=<span>"sex"</span>,<br mpa-from-tpl="t"><span>measure</span>.vars = c(<span>"CK_1"</span>,<span>"MAN_1"</span>,<span>"CK_2"</span>,<span>"MAN_2"</span>,<span>"CK_3"</span>,<span>"MAN_3"</span>),<br mpa-from-tpl="t"><span>variable</span>.name = <span>"Group"</span>,<br mpa-from-tpl="t"><span>value</span>.name = <span>"Expression"</span>)<br mpa-from-tpl="t"><span>#id.vars表示不需要合并的列；</span><br mpa-from-tpl="t"><span>#measure.vars表示需要合并的列；</span><br mpa-from-tpl="t"><span>#variable.name表示列名合并后的新列名；</span><br mpa-from-tpl="t"><span>#value.name表示数值合并后的新列名。</span><br mpa-from-tpl="t"><br mpa-from-tpl="t"><span>#提取行数,计算亚组元素个数；</span><br mpa-from-tpl="t"><span>n</span> &lt;- dim(dt)[1]<br mpa-from-tpl="t"><span>#新增配对分组（亚组）信息；</span><br mpa-from-tpl="t"><span>df</span>$Group2 &lt;- c(1:n,1:n,<br mpa-from-tpl="t"> <span>seq</span>(from=31,to=51,by=1),<br mpa-from-tpl="t"> <span>seq</span>(from=31,to=51,by=1),<br mpa-from-tpl="t"> <span>seq</span>(from=61,to=81,by=1),<br mpa-from-tpl="t"> <span>seq</span>(from=61,to=81,by=1))</p></pre></section><p><img data-cropselx1="0" data-cropselx2="578" data-cropsely1="0" data-cropsely2="253" data-ratio="0.34536784741144416" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6kD0ICDF1zD8x0W6ul7NkcyAGlWZVjjwaKQ0zBqw6jIhVFAqCwX2fmNqVibQicgIiacmKUJNBhRcYHzQ/640?wx_fmt=png" data-type="png" data-w="1468" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6kD0ICDF1zD8x0W6ul7NkcyAGlWZVjjwaKQ0zBqw6jIhVFAqCwX2fmNqVibQicgIiacmKUJNBhRcYHzQ/640?wx_fmt=png"></p><p><br></p><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><img data-ratio="0.8216704" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6kD0ICDF1zD8x0W6ul7Nkcy79s6RHPnW7xH7gEdLjIyxNO8ghiaxyd4306Uic8ibhk8ndvgTDK642ByQ/640?wx_fmt=png" data-type="png" data-w="443" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6kD0ICDF1zD8x0W6ul7Nkcy79s6RHPnW7xH7gEdLjIyxNO8ghiaxyd4306Uic8ibhk8ndvgTDK642ByQ/640?wx_fmt=png"></section></section></section></section></section><section><section powered-by="xiumi.us"><section><p><strong>2. 统计检验</strong></p></section></section></section></section></section><p><br></p><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><p><span>#矫正pvalue的方法可选择："holm", "hochberg", "hommel", "bonferroni", "BH", "BY", "fdr", "none";</span><br mpa-from-tpl="t"><span>#先做配对的t检验；</span><br mpa-from-tpl="t"><span>df_t</span> &lt;- df %&gt;% t_test(Expression ~ Group,<br mpa-from-tpl="t"><span>comparisons</span> = list(c(<span>"CK_1"</span>, <span>"MAN_1"</span>),<br mpa-from-tpl="t"><span>c</span>(<span>"CK_2"</span>, <span>"MAN_2"</span>),<br mpa-from-tpl="t"><span>c</span>(<span>"CK_3"</span>, <span>"MAN_3"</span>)),<br mpa-from-tpl="t"><span>p</span>.adjust.method=<span>"bonferroni"</span>,<br mpa-from-tpl="t"><span>paired</span> = T)<br mpa-from-tpl="t"><span>#查看检验结果；</span><br mpa-from-tpl="t"><span>df_t</span></p></pre></section><p><img data-ratio="0.2318181818181818" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6kD0ICDF1zD8x0W6ul7NkcyNDPe2SGgJ8EmBOQufdWh1NXRtyQCkDpDlQT2DNS91aFR8iaytgmibKRQ/640?wx_fmt=png" data-type="png" data-w="1540" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6kD0ICDF1zD8x0W6ul7NkcyNDPe2SGgJ8EmBOQufdWh1NXRtyQCkDpDlQT2DNS91aFR8iaytgmibKRQ/640?wx_fmt=png"></p><p><br mpa-from-tpl="t"></p><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><p><span>#先做配对的wilcox检验；</span><br mpa-from-tpl="t"><span>df_w</span> &lt;- df %&gt;% wilcox_test(Expression ~ Group,<br mpa-from-tpl="t"><span>comparisons</span> = list(c(<span>"CK_1"</span>, <span>"MAN_1"</span>),<br mpa-from-tpl="t"><span>c</span>(<span>"CK_2"</span>, <span>"MAN_2"</span>),<br mpa-from-tpl="t"><span>c</span>(<span>"CK_3"</span>, <span>"MAN_3"</span>)),<br mpa-from-tpl="t"><span>p</span>.adjust.method=<span>"bonferroni"</span>,<br mpa-from-tpl="t"><span>paired</span> = T)<br mpa-from-tpl="t"><span>#查看检验结果；</span><br mpa-from-tpl="t"><span>df_w</span></p></pre></section><p><img data-ratio="0.236328125" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6kD0ICDF1zD8x0W6ul7NkcytaMLJyMWgPxncVln0eUWCzfm2kKlicGtSU9zKxoJIAFDrjuWxsicJMnA/640?wx_fmt=png" data-type="png" data-w="1536" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6kD0ICDF1zD8x0W6ul7NkcytaMLJyMWgPxncVln0eUWCzfm2kKlicGtSU9zKxoJIAFDrjuWxsicJMnA/640?wx_fmt=png"></p><p><br></p><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><img data-ratio="0.8216704" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6kD0ICDF1zD8x0W6ul7Nkcy79s6RHPnW7xH7gEdLjIyxNO8ghiaxyd4306Uic8ibhk8ndvgTDK642ByQ/640?wx_fmt=png" data-type="png" data-w="443" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6kD0ICDF1zD8x0W6ul7Nkcy79s6RHPnW7xH7gEdLjIyxNO8ghiaxyd4306Uic8ibhk8ndvgTDK642ByQ/640?wx_fmt=png"></section></section></section></section></section><section><section powered-by="xiumi.us"><section><p><strong>3. 绘制图表</strong></p></section></section></section></section></section><p><br></p><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><p><span>#建立图形映射；</span><br mpa-from-tpl="t"><span>p1</span> &lt;- ggplot(df,aes(Group,Expression,fill=Group,colour=Group))<br mpa-from-tpl="t"><span>p1</span></p></pre></section><p><img data-ratio="1.0074257425742574" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6kD0ICDF1zD8x0W6ul7NkcyjaGia5kDJoo5k91c8IW77SSYcRD2CgP3MBtIkyYJQgbymzoVBvlSTJQ/640?wx_fmt=png" data-type="png" data-w="1212" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6kD0ICDF1zD8x0W6ul7NkcyjaGia5kDJoo5k91c8IW77SSYcRD2CgP3MBtIkyYJQgbymzoVBvlSTJQ/640?wx_fmt=png"></p><p><br mpa-from-tpl="t"></p><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><p><span>#绘制箱型图；</span><br mpa-from-tpl="t"><span>p2</span> &lt;- p1+geom_boxplot(show.legend = FALSE,<br mpa-from-tpl="t"><span>alpha</span>=0.7,<br mpa-from-tpl="t"><span>width</span>=0.4)<br mpa-from-tpl="t"><span>p2</span></p></pre></section><p><img data-ratio="1.0081900081900081" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6kD0ICDF1zD8x0W6ul7NkcyXhVJ7LbibGn0LNpqwFSIp6mNDN3wRWdyPTCiaSagCdnZaaENVyo6gEkQ/640?wx_fmt=png" data-type="png" data-w="1221" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6kD0ICDF1zD8x0W6ul7NkcyXhVJ7LbibGn0LNpqwFSIp6mNDN3wRWdyPTCiaSagCdnZaaENVyo6gEkQ/640?wx_fmt=png"></p><p><br></p><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><section><span>#添加散点和连线；</span><br mpa-from-tpl="t"><span>p3</span> &lt;- p2+geom_line(aes(group = Group2), color = alpha(<span>"red"</span>,0.2), lwd = 0.5)+<br mpa-from-tpl="t">  <span>geom_point</span>(show.legend = FALSE,size=1)<br mpa-from-tpl="t"><span>p3</span></section></pre></section><p><img data-cropselx1="0" data-cropselx2="578" data-cropsely1="0" data-cropsely2="581" data-ratio="1.0074196207749382" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6kD0ICDF1zD8x0W6ul7Nkcy7r9ayEyEvlatAcRYeibycbqEXCoWGRZwpFq7en2iamQVxhZO9icQbsjkw/640?wx_fmt=png" data-type="png" data-w="1213" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6kD0ICDF1zD8x0W6ul7Nkcy7r9ayEyEvlatAcRYeibycbqEXCoWGRZwpFq7en2iamQVxhZO9icQbsjkw/640?wx_fmt=png"></p><p><br></p><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><p><span>#使用主题；</span><br mpa-from-tpl="t"><span>p3</span>+theme_classic()</p></pre></section><p><img data-cropselx1="0" data-cropselx2="578" data-cropsely1="0" data-cropsely2="586" data-ratio="1.0165700082850042" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6kD0ICDF1zD8x0W6ul7NkcydsNLRWQgIESeuPXOlda4PGPn3Tiaia04fjvic1DUI2waKiag2Syn9Dh9nQ/640?wx_fmt=png" data-type="png" data-w="1207" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6kD0ICDF1zD8x0W6ul7NkcydsNLRWQgIESeuPXOlda4PGPn3Tiaia04fjvic1DUI2waKiag2Syn9Dh9nQ/640?wx_fmt=png"></p><p><br></p><section><span><strong><span>*未经许可，不得以任何方式复制或抄袭本篇文章之部分或全部内容。版权所有，侵权必究。</span></strong></span></section><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><svg viewbox="0 0 1 1"></svg></section></section></section><section><section powered-by="xiumi.us"><section><svg viewbox="0 0 1 1"></svg></section></section></section><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><svg viewbox="0 0 1 1"></svg></section></section><section powered-by="xiumi.us"><section><svg viewbox="0 0 1 1"></svg></section></section><section powered-by="xiumi.us"><section><svg viewbox="0 0 1 1"></svg></section></section></section></section></section><section><section powered-by="xiumi.us"><section><svg viewbox="0 0 1 1"></svg></section></section></section><section><section powered-by="xiumi.us"><section><svg viewbox="0 0 1 1"></svg></section></section></section></section></section><section><br></section><section><span>SCIPainter，是由广州基迪奥生物运营的绘图公号。如果你想了解</span><span><strong><span>组学前沿技术</span></strong></span><span>、</span><span><strong><span>精彩组学文章解读</span></strong></span><span>、</span><strong><span>测序项目问题咨询</span></strong><span>等等，可以关注<strong>基迪奥官方账号</strong>。我们的愿望是，基迪奥助您达到更高的科研领域。</span></section><section><mp-common-profile data-pluginname="mpprofile" data-id="MzA5NzQzOTgzMw==" data-headimg="http://mmbiz.qpic.cn/mmbiz_png/6kvRq2WRXpiadbSLFQicLXEWj2GOlicE5ib53jkfcjIxv63JnP68reVXewhA5Ay8YglUjot7zV2NAdvDU2SfjH1Mwg/0?wx_fmt=png" data-nickname="基迪奥生物" data-alias="gene-denovo" data-signature="广州基迪奥生物官方公众号，小奥每天分享前沿组学知识、实用生信软件技巧、酷炫绘图技能。我们的目标是，助您达到更高的科研领域。" data-from="0" data-is_biz_ban="0"></mp-common-profile></section><p><br></p><section data-role="outer" label="Powered by 135editor.com"><section data-tools="135编辑器" data-id="105648"><section><section data-role="outer" label="Powered by 135editor.com"><section data-role="paragraph"><section data-role="outer" label="Powered by 135editor.com"><section data-tools="135编辑器" data-id="105648"><section><section><img data-ratio="0.8928571428571429" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6kCKJYcEqEIfoJYG621mPJE8VibmibGU0Jxic9iabARVRH0FT6BNE8VAglWFXBPibFAU7a6tWGibSs8wyUg/640?wx_fmt=png" data-type="png" data-w="41" data-width="100%" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6kCKJYcEqEIfoJYG621mPJE8VibmibGU0Jxic9iabARVRH0FT6BNE8VAglWFXBPibFAU7a6tWGibSs8wyUg/640?wx_fmt=png"></section><section><section><section data-width="35%"><section><section data-width="100%"><img data-ratio="1" data-src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/tgUVxVRjT6kCKJYcEqEIfoJYG621mPJEv5etCBwHicqbEPwnVrkpaasxqaVibM4mT2JdIuN6yTlYWDD4mL5A427A/640?wx_fmt=jpeg" data-type="jpeg" data-w="860" data-width="100%" title="SCIPainter 30cm二维码.jpg" src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/tgUVxVRjT6kCKJYcEqEIfoJYG621mPJEv5etCBwHicqbEPwnVrkpaasxqaVibM4mT2JdIuN6yTlYWDD4mL5A427A/640?wx_fmt=jpeg"></section></section></section><section data-width="50%"><section><section data-brushtype="text"><strong># SCIPainter</strong></section><section data-brushtype="text" hm_fix="361:593"><p>基迪奥旗下绘图公众号</p><p>分享科研绘图技能与工具</p><p>欢迎关注与转发~</p></section></section></section></section></section></section></section></section></section></section><section><br></section></section></section><section data-role="paragraph"><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><img data-ratio="1" data-src="https://mmbiz.qpic.cn/sz_mmbiz_gif/tgUVxVRjT6kCKJYcEqEIfoJYG621mPJEgMd0aMPtmrDjiaX8sBhfhicVteeHf1JicexSpUbS3fdS9SiboUVN7guaPw/640?wx_fmt=gif" data-type="gif" data-w="400" src="https://mmbiz.qpic.cn/sz_mmbiz_gif/tgUVxVRjT6kCKJYcEqEIfoJYG621mPJEgMd0aMPtmrDjiaX8sBhfhicVteeHf1JicexSpUbS3fdS9SiboUVN7guaPw/640?wx_fmt=gif"></section></section></section><section><section powered-by="xiumi.us"><section><p><span><strong>你的好友拍了拍你</strong></span></p><p><span><strong>并请你帮她点一下</strong></span><span><strong><span>“分享”</span></strong></span><span><strong><span>~</span></strong></span></p></section></section></section></section></section><p><br></p></section></section></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/cO_P5cZjRsRJL5wR-GHQxw",target="_blank" rel="noopener noreferrer">原文链接</a>
