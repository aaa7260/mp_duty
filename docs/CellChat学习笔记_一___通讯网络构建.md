---
title: "CellChat学习笔记【一】——通讯网络构建"
date: 2022-11-18T10:10:00Z
draft: ["false"]
tags: [
  "fetched",
  "单细胞天地"
]
categories: ["Acdemic"]
---
CellChat学习笔记【一】——通讯网络构建 by 单细胞天地
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><p data-tool="mdnice编辑器"><strong><code>细胞通讯</code></strong><span>是指细胞与细胞之间的联系。细胞和人类一样，多细胞生物的很多细胞会相互作用，形成“细胞社会”，在这个社会里，细胞与细胞之间会发生相互作用和信息的传递，细胞建立通讯联络是必需的。如生物体的生长发育、分化、各种组织器官的形成、组织的维持以及它们各种生理活动的协调。经典的例子莫过于 </span><strong>神经细胞之间的神经递质的传递与接收</strong><span>。</span></p><section><br></section><p data-tool="mdnice编辑器">细胞与细胞之间的通讯有三种形式：</p><ul data-tool="mdnice编辑器"><li><section><p>细胞之间的直接接触；</p></section></li><li><section><p>细胞之间通过其间的胞外基质相互联系；</p></section></li><li><section><p>细胞之间通过分子间的相互作用产生联系。</p></section></li></ul><p data-tool="mdnice编辑器">在这个过程中，<strong>“受体-配体”</strong>的概念十分重要，什么是受体，什么是配体？受体与配体之间结合的结果是受体被激活，并产生受体激活后续信号传递的基本步骤。在单细胞分析当中，不同细胞类型之间的通讯可能会对某些生物学过程具有重要意义，因此利用单细胞数据进行细胞通讯分析是单细胞高级分析的一大重点。</p><h1 data-tool="mdnice编辑器"><span></span>CellChat</h1><p data-tool="mdnice编辑器"><strong>CellChat</strong>是一款2021年发表于<strong><code>Nature Communications</code></strong>的单细胞细胞通讯分析工具。</p><h1 data-tool="mdnice编辑器"><span></span>CellChat上游分析</h1><h2 data-tool="mdnice编辑器"><span></span><span>安装 CellChat</span><span> </span></h2><pre data-tool="mdnice编辑器"><code>devtools::install_github(<span>"sqjin/CellChat"</span>)<br></code></pre><h2 data-tool="mdnice编辑器"><span></span><span>细胞通讯分析</span><span> </span></h2><p data-tool="mdnice编辑器">这里我们使用 <strong>pbmc3k</strong> 的公共数据集为例来一起学习如何利用 <strong><code>CellChat</code></strong> 进行细胞通讯分析。</p><h3 data-tool="mdnice编辑器"><span></span>数据输入<span></span></h3><p data-tool="mdnice编辑器"><strong><code>CellChat</code></strong> 需要的输入文件包括：</p><ul data-tool="mdnice编辑器"><li><section><strong>细胞的基因表达矩阵（已经经过normalize的）</strong></section></li></ul><p data-tool="mdnice编辑器">不同的基因作为行名，细胞ID作为列名。这一点和<code>Seurat</code>对象的结构是保持一致的。</p><ul data-tool="mdnice编辑器"><li><section><strong>细胞的metadata信息</strong></section></li></ul><p data-tool="mdnice编辑器">细胞层面的信息，这里可以是我们上游分析的注释信息，可以直接把<code>SeuratObject</code>的metadata提取出来使用。</p><p data-tool="mdnice编辑器">所以我们的输入文件可以这样准备：</p><pre data-tool="mdnice编辑器"><code><span>library</span>(CellChat)<br><span>library</span>(Seurat)<br><span>library</span>(SeuratData)<br><br>data(<span>"pbmc3k.final"</span>)<br><br>data &lt;- GetAssayData(object = pbmc3k.final, slot = <span>'data'</span>)<br>meta &lt;- pbmc3k.final@meta.data<br></code></pre><p data-tool="mdnice编辑器">这里涉及到一个小知识点：<code>SeuratObject</code>中<code>RNA assay</code>中不同<code>slot</code>所存储的是什么值：</p><ul data-tool="mdnice编辑器"><li><section><p><strong><code>counts</code></strong>：原始的基因counts数，也就是简单reads计数的结果，对于<code>10X Genomics</code>平台数据来说，这是<code>cellranger</code>运行的结果；</p></section></li><li><section><p><strong><code>data</code><strong>：这是原始表达矩阵经过质控之后进行<code>NormalizeData()</code>的数据，<code>NormalizeData</code>去除了不同细胞之间测序深度的差异，同时对结果进行了对数化，</strong>这个数据是<code>CellChat</code>想要的数据</strong>。</p></section></li><li><section><p><strong><code>scale.data</code></strong>：这是函数<code>ScaleData()</code>运行的结果，主要是将每个基因的表达量转换成了符合标准正态分布的数据，从而降低部分细胞异常表达值的影响。</p></section></li></ul><p data-tool="mdnice编辑器"><strong>因为实际上我们在使用<code>CellChat</code>时是都已经默认上游的处理已经完成了，所以我在这里不打算介绍<code>CellChat</code>本身自带的函数去normalize原始counts的分析。</strong></p><h3 data-tool="mdnice编辑器"><span></span>创建CellChat对象<span></span></h3><p data-tool="mdnice编辑器"><code>CellChat</code>对象和<code>Seurat</code>对象很像，我们可以这样来进行创建：</p><pre data-tool="mdnice编辑器"><code>cellchat &lt;- createCellChat(object = data,<br>                           meta = meta,<br>                           group.by = <span>'seurat_annotations'</span>)<br></code></pre><pre data-tool="mdnice编辑器"><code><span>## The cell groups used for CellChat analysis are  Naive CD4 T Memory CD4 T CD14+ Mono B CD8 T FCGR3A+ Mono NK DC Platelet</span><br></code></pre><p data-tool="mdnice编辑器">这里的<code>group.by</code>参数是不可少的，来自于我们的<code>metadata</code>的列名，我们一般指定为细胞类型注释的结果，这是有利于我们的分析结果的。</p><p data-tool="mdnice编辑器"><strong>除此之外，不得不介绍的还有这个函数不仅仅支持将你自己提取的表达矩阵作为输入，还支持直接用<code>SeuratObject</code>作为输入，不过需要注意的是，如果是多组样本整合的<code>SeuratObject</code>，我们不能利用<code>integrated assay</code>作为输入，因为其含有负值，所以我们可用下面的这段代码实现和前面代码一样的目的：</strong></p><pre data-tool="mdnice编辑器"><code>cellchat &lt;- createCellChat(object = pbmc3k.final,<br>                           meta = meta,<br>                           group.by = <span>'seurat_annotations'</span>,<br>                           assay = <span>'RNA'</span>)<br></code></pre><p data-tool="mdnice编辑器">此外还有一个参数<code>do.sparse</code>不要去改动它（默认为<code>TRUE</code>），用稀疏矩阵处理单细胞数据能够节省更多的空间和时间。</p><p data-tool="mdnice编辑器">简单介绍一下<code>CellChat</code>数据的结构：</p><pre data-tool="mdnice编辑器"><code>str(cellchat)<br></code></pre><pre data-tool="mdnice编辑器"><code><span>## Formal class 'CellChat' [package "CellChat"] with 14 slots</span><br><span>##   ..@ data.raw      : num[0 , 0 ] </span><br><span>##   ..@ data          :Formal class 'dgCMatrix' [package "Matrix"] with 6 slots</span><br><span>##   .. .. ..@ i       : int [1:2238732] 29 73 80 148 163 184 186 227 229 230 ...</span><br><span>##   .. .. ..@ p       : int [1:2639] 0 779 2131 3260 4220 4741 5522 6304 7094 7626 ...</span><br><span>##   .. .. ..@ Dim     : int [1:2] 13714 2638</span><br><span>##   .. .. ..@ Dimnames:List of 2</span><br><span>##   .. .. .. ..$ : chr [1:13714] "AL627309.1" "AP006222.2" "RP11-206L10.2" "RP11-206L10.9" ...</span><br><span>##   .. .. .. ..$ : chr [1:2638] "AAACATACAACCAC" "AAACATTGAGCTAC" "AAACATTGATCAGC" "AAACCGTGCTTCCG" ...</span><br><span>##   .. .. ..@ x       : num [1:2238732] 1.64 1.64 2.23 1.64 1.64 ...</span><br><span>##   .. .. ..@ factors : list()</span><br><span>##   ..@ data.signaling: num[0 , 0 ] </span><br><span>##   ..@ data.scale    : num[0 , 0 ] </span><br><span>##   ..@ data.project  : num[0 , 0 ] </span><br><span>##   ..@ net           : list()</span><br><span>##   ..@ netP          : list()</span><br><span>##   ..@ meta          :'data.frame': 2638 obs. of  7 variables:</span><br><span>##   .. ..$ orig.ident        : Factor w/ 1 level "pbmc3k": 1 1 1 1 1 1 1 1 1 1 ...</span><br><span>##   .. ..$ nCount_RNA        : num [1:2638] 2419 4903 3147 2639 980 ...</span><br><span>##   .. ..$ nFeature_RNA      : int [1:2638] 779 1352 1129 960 521 781 782 790 532 550 ...</span><br><span>##   .. ..$ seurat_annotations: Factor w/ 9 levels "Naive CD4 T",..: 2 4 2 3 7 2 5 5 1 6 ...</span><br><span>##   .. ..$ percent.mt        : num [1:2638] 3.02 3.79 0.89 1.74 1.22 ...</span><br><span>##   .. ..$ RNA_snn_res.0.5   : Factor w/ 9 levels "0","1","2","3",..: 2 4 2 3 7 2 5 5 1 6 ...</span><br><span>##   .. ..$ seurat_clusters   : Factor w/ 9 levels "0","1","2","3",..: 2 4 2 3 7 2 5 5 1 6 ...</span><br><span>##   ..@ idents        : Factor w/ 9 levels "Naive CD4 T",..: 2 4 2 3 7 2 5 5 1 6 ...</span><br><span>##   ..@ DB            : list()</span><br><span>##   ..@ LR            : list()</span><br><span>##   ..@ var.features  : list()</span><br><span>##   ..@ dr            : list()</span><br><span>##   ..@ options       :List of 1</span><br><span>##   .. ..$ mode: chr "single"</span><br></code></pre><p data-tool="mdnice编辑器">截止到目前为止，我们的<code>CellChat</code>对象结构如上所示，可以看到：</p><ul data-tool="mdnice编辑器"><li><section><p>我们输入的数据存在了<code>data</code>这个稀疏矩阵里面，而后面的<code>data.signaling</code>等对象还有待后面的分析进行填充；</p></section></li><li><section><p>此外，我们应该重点关注的就是<code>meta</code>部分，这个部分是一个数据框，所以我们还是可以在创建<code>CellChat</code>对象之后来更改细胞的信息，这是比较方便的，可以看到目前<code>CellChat</code>对象对细胞的分析是基于<code>seurat_annotations</code>的，这是我们前面设置好的，如果我们想要改变只需要<code>setIdent(cellchat, ident.use = "labels")</code>就可以了，同时我们还可以通过<code>levels(cellchat@idents)</code>来查看当前的细胞分组信息。</p></section></li></ul><h3 data-tool="mdnice编辑器"><span></span>选择受体配体数据库<span></span></h3><p data-tool="mdnice编辑器"><strong><code>CellChat</code></strong> 有一个专门的数据库，叫做<strong>CellChatDB</strong>，这个数据库是 <strong><code>CellChat</code></strong> 的作者们<strong>通过阅读大量文献，手动整理出来的“受体-配体”对</strong>，目前有人、鼠以及斑马鱼的版本。其中人的叫做 <strong>CellChatDB.human</strong>，鼠的叫做 <strong>CellChatDB.mouse</strong>，斑马鱼的叫做 <strong>CellChatDB.zebrafish</strong>。关于这两个数据库中具体的“受体-配体”对信息可以通过<strong><code>showDatabaseCategory()</code></strong>函数获得，在这里就不赘述了。</p><p data-tool="mdnice编辑器">CellChat数据库</p><ul data-tool="mdnice编辑器"><li><section><strong>mouse</strong></section></li></ul><p data-tool="mdnice编辑器"><code>2,021</code> validated molecular interactions, including <code>60% of secrete autocrine/paracrine signaling interactions</code>, <code>21% of extracellular matrix (ECM)-receptor interactions</code> and <code>19% of cell-cell contact interactions</code>.</p><ul data-tool="mdnice编辑器"><li><section><strong>human</strong></section></li></ul><p data-tool="mdnice编辑器"><code>1,939</code> validated molecular interactions, including <code>61.8% of paracrine/autocrine signaling interactions</code>, <code>21.7% of extracellular matrix (ECM)-receptor interactions</code> and <code>16.5% of cell-cell contact interactions</code>.</p><p data-tool="mdnice编辑器">加载数据库：</p><pre data-tool="mdnice编辑器"><code>CellChatDB &lt;- CellChatDB.human<br></code></pre><p data-tool="mdnice编辑器">来看一下数据库的结构（<strong>option</strong>）：</p><pre data-tool="mdnice编辑器"><code>head(CellChatDB$interaction)<br></code></pre><pre data-tool="mdnice编辑器"><code><span>##                        interaction_name pathway_name ligand      receptor</span><br><span>## TGFB1_TGFBR1_TGFBR2 TGFB1_TGFBR1_TGFBR2         TGFb  TGFB1     TGFbR1_R2</span><br><span>## TGFB2_TGFBR1_TGFBR2 TGFB2_TGFBR1_TGFBR2         TGFb  TGFB2     TGFbR1_R2</span><br><span>## TGFB3_TGFBR1_TGFBR2 TGFB3_TGFBR1_TGFBR2         TGFb  TGFB3     TGFbR1_R2</span><br><span>## TGFB1_ACVR1B_TGFBR2 TGFB1_ACVR1B_TGFBR2         TGFb  TGFB1 ACVR1B_TGFbR2</span><br><span>## TGFB1_ACVR1C_TGFBR2 TGFB1_ACVR1C_TGFBR2         TGFb  TGFB1 ACVR1C_TGFbR2</span><br><span>## TGFB2_ACVR1B_TGFBR2 TGFB2_ACVR1B_TGFBR2         TGFb  TGFB2 ACVR1B_TGFbR2</span><br><span>##                          agonist      antagonist co_A_receptor</span><br><span>## TGFB1_TGFBR1_TGFBR2 TGFb agonist TGFb antagonist              </span><br><span>## TGFB2_TGFBR1_TGFBR2 TGFb agonist TGFb antagonist              </span><br><span>## TGFB3_TGFBR1_TGFBR2 TGFb agonist TGFb antagonist              </span><br><span>## TGFB1_ACVR1B_TGFBR2 TGFb agonist TGFb antagonist              </span><br><span>## TGFB1_ACVR1C_TGFBR2 TGFb agonist TGFb antagonist              </span><br><span>## TGFB2_ACVR1B_TGFBR2 TGFb agonist TGFb antagonist              </span><br><span>##                                co_I_receptor       evidence         annotation</span><br><span>## TGFB1_TGFBR1_TGFBR2 TGFb inhibition receptor KEGG: hsa04350 Secreted Signaling</span><br><span>## TGFB2_TGFBR1_TGFBR2 TGFb inhibition receptor KEGG: hsa04350 Secreted Signaling</span><br><span>## TGFB3_TGFBR1_TGFBR2 TGFb inhibition receptor KEGG: hsa04350 Secreted Signaling</span><br><span>## TGFB1_ACVR1B_TGFBR2 TGFb inhibition receptor PMID: 27449815 Secreted Signaling</span><br><span>## TGFB1_ACVR1C_TGFBR2 TGFb inhibition receptor PMID: 27449815 Secreted Signaling</span><br><span>## TGFB2_ACVR1B_TGFBR2 TGFb inhibition receptor PMID: 27449815 Secreted Signaling</span><br><span>##                          interaction_name_2</span><br><span>## TGFB1_TGFBR1_TGFBR2 TGFB1 - (TGFBR1+TGFBR2)</span><br><span>## TGFB2_TGFBR1_TGFBR2 TGFB2 - (TGFBR1+TGFBR2)</span><br><span>## TGFB3_TGFBR1_TGFBR2 TGFB3 - (TGFBR1+TGFBR2)</span><br><span>## TGFB1_ACVR1B_TGFBR2 TGFB1 - (ACVR1B+TGFBR2)</span><br><span>## TGFB1_ACVR1C_TGFBR2 TGFB1 - (ACVR1C+TGFBR2)</span><br><span>## TGFB2_ACVR1B_TGFBR2 TGFB2 - (ACVR1B+TGFBR2)</span><br></code></pre><p data-tool="mdnice编辑器">最后，千万不要忘了把数据库嵌入到 <strong>CellChat</strong> 对象中，否则后面的分析会报错：</p><pre data-tool="mdnice编辑器"><code>cellchat@DB &lt;- CellChatDB<br></code></pre><p data-tool="mdnice编辑器">有的时候我们并不想分析所有的细胞通讯，例如我们只关心<code>Secreted Signaling</code>，或者我们只相信经过<code>KEGG</code>分析验证过的细胞通讯，为了节约运行空间和时间，我们可以使用<code>subsetDB()</code>函数来取数据库的子集，简单查看一下数据库的数据结构：</p><pre data-tool="mdnice编辑器"><code>dplyr::glimpse(CellChatDB$interaction)<br></code></pre><pre data-tool="mdnice编辑器"><code><span>## Rows: 1,939</span><br><span>## Columns: 11</span><br><span>## $ interaction_name   &lt;chr&gt; "TGFB1_TGFBR1_TGFBR2", "TGFB2_TGFBR1_TGFBR2", "TGFB…</span><br><span>## $ pathway_name       &lt;chr&gt; "TGFb", "TGFb", "TGFb", "TGFb", "TGFb", "TGFb", "TG…</span><br><span>## $ ligand             &lt;chr&gt; "TGFB1", "TGFB2", "TGFB3", "TGFB1", "TGFB1", "TGFB2…</span><br><span>## $ receptor           &lt;chr&gt; "TGFbR1_R2", "TGFbR1_R2", "TGFbR1_R2", "ACVR1B_TGFb…</span><br><span>## $ agonist            &lt;chr&gt; "TGFb agonist", "TGFb agonist", "TGFb agonist", "TG…</span><br><span>## $ antagonist         &lt;chr&gt; "TGFb antagonist", "TGFb antagonist", "TGFb antagon…</span><br><span>## $ co_A_receptor      &lt;chr&gt; "", "", "", "", "", "", "", "", "", "", "", "", "",…</span><br><span>## $ co_I_receptor      &lt;chr&gt; "TGFb inhibition receptor", "TGFb inhibition recept…</span><br><span>## $ evidence           &lt;chr&gt; "KEGG: hsa04350", "KEGG: hsa04350", "KEGG: hsa04350…</span><br><span>## $ annotation         &lt;chr&gt; "Secreted Signaling", "Secreted Signaling", "Secret…</span><br><span>## $ interaction_name_2 &lt;chr&gt; "TGFB1 - (TGFBR1+TGFBR2)", "TGFB2 - (TGFBR1+TGFBR2)…</span><br></code></pre><p data-tool="mdnice编辑器">我们只选择<code>Secreted Signaling</code>相关的细胞间通讯信息：</p><pre data-tool="mdnice编辑器"><code>subsetDB(CellChatDB.human, search = <span>'Secreted Signaling'</span>)<br></code></pre><p data-tool="mdnice编辑器">当然我们能做的绝不仅这些，我们可以通过更改<code>subsetDB()</code>函数的<code>key</code>参数来实现任何标准的筛选，例如我们想筛选出<code>evidence</code>为<code>KEGG</code>的细胞间通讯：</p><pre data-tool="mdnice编辑器"><code>subsetDB(CellChatDB.human, search = <span>'^KEGG'</span>, key = <span>'evidence'</span>) <span>#regular expression here!!!</span><br></code></pre><h3 data-tool="mdnice编辑器"><span></span>细胞通讯鉴定<span></span></h3><p data-tool="mdnice编辑器">在这个部分我们为了降低运行的内存和时间消耗，我们会抽取部分细胞进行分析，分析的流程也很好理解：<strong>首先，鉴定出细胞中高表达的受体和配体编码基因，然后再依据这个表达谱构建细胞之间的受体与配体作用对。</strong>和单细胞分析一样，这里我们也可以使用 <strong><code>future</code></strong> 包来进行并行计算，加速我们的分析过程。</p><pre data-tool="mdnice编辑器"><code><span>library</span>(future)<br>plan(strategy = <span>'multiprocess'</span>, workers = <span>4</span>)<br><span>#subset</span><br>cellchat &lt;- subsetData(cellchat)<br></code></pre><p data-tool="mdnice编辑器">为什么这里要做<code>subset</code>，<strong>因为为了节省运算时间和空间，通过这一步，我们后面的分析将只关注于与细胞通讯有关的基因（从数据框中提取出来的）</strong>，所以在这里针对于表达矩阵的基因取了子集。</p><pre data-tool="mdnice编辑器"><code>cellchat &lt;- identifyOverExpressedGenes(cellchat)<br>cellchat &lt;- identifyOverExpressedInteractions(cellchat)<br></code></pre><p data-tool="mdnice编辑器">上面两个函数分别鉴定除了每个细胞群中高表达的细胞通讯相关基因和细胞群之间根据细胞通讯相关基因的表达情况（<code>identifyOverExpressedGenes()</code>）最终鉴定出的细胞间通讯关系（<code>identifyOverExpressedInteractions</code>）。</p><pre data-tool="mdnice编辑器"><code>cellchat &lt;- computeCommunProb(cellchat)<br>cellchat &lt;- filterCommunication(cellchat, min.cells = <span>10</span>)<br></code></pre><p data-tool="mdnice编辑器"><strong>注意到为了获得更可信的细胞间通讯，方便后续的验证，这里首先对每个通讯计算了相应的概率值，同时进行了基于每个细胞类群中支持该通讯的细胞数量的过滤。</strong></p><p data-tool="mdnice编辑器">需要注意的是，预测出的细胞间通讯的数量是和每个细胞群的基因表达量有关的，所以对于基因平均表达量的计算就显得很重要，在默认情况下，<code>computeCommunProb()</code>函数使用的是<code>trimean</code>方法，<strong>该方法默认如果一群细胞里面不足25%的细胞表达某个基因的话，这个基因在该群细胞里面的平均表达量就是0</strong>。不过你可以通过设置<code>type = "truncatedMean"</code>和<code>trim=</code>来自己指定这个阈值，比如<code>trim=0.1</code>就表示阈值为10%。显然默认方法<code>trimean</code>能帮我们筛选出更少的、更可信的细胞间通讯。此外，考虑到细胞数更多的细胞群之间的细胞通讯信号往往会更强，为了去除不同细胞群之间的细胞数量差异，我们可以尝试使用<code>population.size = TRUE</code>来辅助我们发现稀有细胞类群之间的细胞通讯。你可以通过<code>computeAveExpr(cellchat, features = c("CXCL12","CXCR4"), type =  "truncatedMean", trim = 0.1)</code>来提取你所感兴趣的细胞通讯相关基因的平均表达量信息。</p><h3 data-tool="mdnice编辑器"><span></span>细胞通讯与信号通路关系的构建<span></span></h3><p data-tool="mdnice编辑器">细胞之间的通讯往往会是信号通路的重要组成部分，把细胞通讯放到信号通路中进行理解可能会更有利于我们理解生物学过程。</p><pre data-tool="mdnice编辑器"><code>cellchat &lt;- computeCommunProbPathway(cellchat)<br></code></pre><p data-tool="mdnice编辑器">每对受配体的细胞间通讯网络会被存储到<code>net</code>的slot中，而每个信号通过的细胞间通讯网络信息将会被存储到<code>netP</code>网络中。</p><h3 data-tool="mdnice编辑器"><span></span>细胞通讯网络的构建<span></span></h3><p data-tool="mdnice编辑器">进一步的，我们将细胞间的通讯进行整合，就能构建出细胞间的通讯网络。</p><pre data-tool="mdnice编辑器"><code>cellchat &lt;- aggregateNet(cellchat)<br></code></pre><p data-tool="mdnice编辑器">当然，你可能只关心部分细胞之间的通讯，你可以通过指定 <strong>信号发出细胞</strong> 和 <strong>信号作用细胞</strong> 来进行个性化的分析：</p><pre data-tool="mdnice编辑器"><code>?aggregateNet<br></code></pre><pre data-tool="mdnice编辑器"><code>aggregateNet(<br>  object,<br>  sources.use = NULL,<br>  targets.use = NULL,<br>  signaling = NULL,<br>  pairLR.use = NULL,<br>  remove.isolate = TRUE,<br>  thresh = 0.05,<br>  return.object = TRUE<br>)<br></code></pre><p data-tool="mdnice编辑器">也就是这里的 <strong><code>sources.use</code></strong> 和 <strong><code>targets.use</code></strong>。那么指定成什么呢？这个时候metadata信息的作用就来了，指定的就是前面 <strong><code>group.by</code></strong> 所包含的细胞类群信息。</p><p data-tool="mdnice编辑器"><strong>至此，上游分析已经结束，后面我们将继续分享如何理解这些分析结果，并对其进行可视化。</strong></p></section><p><br></p><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/wjt46LrzRJFHhBexEdKvaA",target="_blank" rel="noopener noreferrer">原文链接</a>
