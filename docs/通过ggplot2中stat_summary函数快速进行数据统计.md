---
title: "通过ggplot2中stat_summary函数快速进行数据统计"
date: 2022-10-31T16:02:34Z
draft: ["false"]
tags: [
  "fetched",
  "R语言数据分析指南"
]
categories: ["Acdemic"]
---
通过ggplot2中stat_summary函数快速进行数据统计 by R语言数据分析指南
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><h3 data-tool="mdnice编辑器"><span></span><span><span></span>欢迎关注R语言数据分析指南</span><span></span></h3><blockquote data-tool="mdnice编辑器"><span>❝</span><p>最近交流群内看到有观众老爷询问一张图画法，主要是点图添加误差线；绘图过程倒也简单小编在以前代码的基础上来简化一下代码添加点新的元素，下面就通过一个案例来介绍一下，<strong>「代码已经上传VIP群，加群的观众老爷请自行下载」</strong></p><span>❞</span></blockquote><blockquote data-tool="mdnice编辑器"><span>❝</span><p><code>有需要学习数据可视化的朋友欢迎加入小编2022年度VIP群</code>，目前群内已经上传公众号文档<strong>「数据+代码约260篇」</strong>，<code>VIP交流群(1)已经500人满员</code>,随着内容不断增多，为了更好的创做内容现在进群需<strong>「付费149元」</strong>,若转发此文档到朋友圈集赞20个可优惠20元，早进早享受；<strong>「一定让你感受到物超所值」</strong></p><span>❞</span></blockquote><h3 data-tool="mdnice编辑器"><span></span><span><span></span>淘宝店铺个性化绘图服务</span><span></span></h3><blockquote data-tool="mdnice编辑器"><span>❝</span><p>最近有部分观众老爷找小编做个性化绘图，为了给观众老爷提供更加优质的服务；小编开通了 <strong>「淘宝店铺(R语言数据分析指南)」</strong> ，有特殊绘图需求的欢迎关注咨询</p><span>❞</span></blockquote><h3 data-tool="mdnice编辑器"><span></span><span><span></span>加载R包</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code><span>library</span>(gapminder)<br><span>library</span>(ggsci)<br><span>library</span>(ggprism)<br><span>library</span>(ggtext)<br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span><span></span>数据清洗</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code>df &lt;- gapminder %&gt;% select(year,lifeExp,continent) %&gt;% <br>  filter(!continent %<span>in</span>% c(<span>"Oceania"</span>,<span>"Europe"</span>)) %&gt;% <br>  mutate(year=as.character(year))<br><br>df2 &lt;- df %&gt;% select(year) %&gt;% <br>  mutate(year=as.numeric(year),<br>         group=case_when(year &gt; <span>1982</span> ~ <span>"A"</span>,<br>                         <span>TRUE</span> ~ <span>"B"</span>),<br>         year=as.character(year))<br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span><span></span>数据可视化</span><span></span></h3><blockquote data-tool="mdnice编辑器"><span>❝</span><p>通过<strong>「stat_summary」</strong>来快速添加各种几何对象</p><span>❞</span></blockquote><pre data-tool="mdnice编辑器"><span></span><code>df %&gt;% ggplot()+<br>  stat_summary(aes(year,lifeExp,group=continent),<br>               fun.data = <span>"mean_cl_normal"</span>,geom=<span>"errorbar"</span>,width=<span>0.1</span>,color=<span>"black"</span>)+<br>  stat_summary(aes(year,lifeExp,group=continent,pch=continent),<br>               fun.y=<span>"mean"</span>,geom=<span>"point"</span>,size=<span>3</span>,color=<span>"black"</span>,fill=<span>"white"</span>)+<br>  stat_summary(aes(year,lifeExp,group=continent,pch=continent,color=continent),<br>               fun.y=<span>"mean"</span>,geom=<span>"line"</span>,size=<span>0.8</span>)+<br>  geom_point(data=df2,aes(x=year,y=<span>78</span>,fill=group),pch=<span>22</span>,size=<span>4</span>,color=<span>"white"</span>,<br>             show.legend = <span>F</span>)+<br>  scale_shape_manual(values=c(<span>21</span>,<span>22</span>,<span>23</span>))+<br>  scale_color_npg()+<br>  scale_y_continuous(guide = <span>"prism_minor"</span>, expand = c(<span>0</span>, <span>0</span>),limits=c(<span>40</span>,<span>80</span>)) +<br>  scale_fill_manual(values=c(<span>"#53ae32"</span>, <span>"#2e76b5"</span>))+<br>  labs(x=<span>NULL</span>,y=<span>NULL</span>)+<br>  theme(axis.text=element_text(color=<span>"black"</span>,face=<span>"bold"</span>,size=<span>10</span>),<br>        axis.line = element_line(color=<span>"black"</span>),<br>        axis.line.x.top  = element_line(color=<span>"black"</span>), <span># 修改X轴辅助线</span><br>        axis.text.x.top = element_blank(),<br>        axis.ticks.y.right=element_blank(),<br>        axis.text.y.right = element_blank(),<br>        axis.ticks.x.top=element_blank(),<br>        panel.background = element_blank(),<br>        legend.text=element_text(size=<span>10</span>,color=<span>"black"</span>,face=<span>"bold"</span>),<br>        legend.spacing.x = unit(<span>0.1</span>,<span>"cm"</span>),<br>        legend.key = element_blank(),<br>        legend.title = element_blank(),<br>        legend.key.width=unit(<span>0.5</span>,<span>"cm"</span>),<br>        legend.key.height=unit(<span>0.5</span>,<span>"cm"</span>),<br>        legend.position = c(<span>0.1</span>,<span>0.8</span>))+<br>  <span># 添加辅助线</span><br>  guides(x.sec=<span>"axis"</span>,y.sec = <span>"axis"</span>) <br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.5853080568720379" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAa4HIH9xo58XuZx93VbZH4QpKHGSX3qXkl6OCRerZh2K1cgicAQtvG6ibxicicMwAgvWt5aUP9uxLVhzQ/640?wx_fmt=png" data-type="png" data-w="844" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAa4HIH9xo58XuZx93VbZH4QpKHGSX3qXkl6OCRerZh2K1cgicAQtvG6ibxicicMwAgvWt5aUP9uxLVhzQ/640?wx_fmt=png"></figure><blockquote data-tool="mdnice编辑器"><span>❝</span><p>本节介绍到此结束，喜欢的观众老爷欢迎分享转发；<strong>「当然更推荐大家加入我的VIP交流群」</strong>扫描下方二维码加小编微信<strong>「付费149元」</strong>后邀请进群，<strong>「一定让你感受到物超所值」</strong>，<strong>「添加小编微信请备注来意，以便高效处理」</strong></p><span>❞</span></blockquote><h3 data-tool="mdnice编辑器"><span></span><span><span></span>小编微信</span><span></span></h3><p><img data-galleryid="" data-ratio="1" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/EibnicgwScTAaNu6sU2UCYkxFq9ibq75wuaO0lqFoYz1icUo4jh3N2icAWECmibgPvqyReur0FCp7JNKO0icnRAsbO9ug/640?wx_fmt=jpeg" data-type="jpeg" data-w="430" src="https://mmbiz.qpic.cn/mmbiz_jpg/EibnicgwScTAaNu6sU2UCYkxFq9ibq75wuaO0lqFoYz1icUo4jh3N2icAWECmibgPvqyReur0FCp7JNKO0icnRAsbO9ug/640?wx_fmt=jpeg"></p><h3 data-tool="mdnice编辑器"><span></span><span><span></span>关注下方公众号下回更新不迷路</span><span></span></h3><section><mp-common-profile data-pluginname="mpprofile" data-id="Mzg3MzQzNTYzMw==" data-headimg="http://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZF0rpeZII9Ltl26VbVagriczTria1fib3XgjwwHEHFjPzkmGpqWDVVHBSzhENictUM2iavAKiaM5lc9USw/0?wx_fmt=png" data-nickname="R语言数据分析指南" data-alias="YanJANtwo" data-signature="R语言重症爱好者，喜欢绘制各种精美的图表，喜欢的小伙伴可以关注我，跟我一起学习" data-from="0" data-is_biz_ban="0"></mp-common-profile></section></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/NxGDLn0xnwnu9448SWj2bg",target="_blank" rel="noopener noreferrer">原文链接</a>
