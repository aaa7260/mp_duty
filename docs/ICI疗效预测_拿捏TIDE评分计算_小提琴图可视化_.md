---
title: "ICI疗效预测？拿捏TIDE评分计算+小提琴图可视化！"
date: 2022-10-22T02:18:00Z
draft: ["false"]
tags: [
  "fetched",
  "SCIPainter"
]
categories: ["Acdemic"]
---
ICI疗效预测？拿捏TIDE评分计算+小提琴图可视化！ by SCIPainter
------
<div><p data-mpa-powered-by="yiban.io"><span>通过往几期的TCGA预后类文章复现学习，从</span><span>公共数据集下载清洗</span><span>，到</span><span>DESeq2差异基因筛选</span><span>，再到</span><span>预后相关差异基因过滤</span><span>，最后到</span><span>多基因风险模型的构建、验证、预测</span><span>，相信大家对预后类文章套路及图表绘制有了一定了解。</span></p><p><span><br></span></p><p><span>今天继续学习</span><span><strong>TIDE评分计算</strong></span><span>，用于评估免疫疗法在不同风险组中的潜在临床疗效，反映肿瘤免疫逃避的潜在能力，较高的TIDE评分与较差的ICI疗效相关。</span></p><p><span><br></span></p><p><span>计算我们直接使用TIDE评分的线上工具（</span><span>http://tide.dfci.harvard.edu/login/</span><span>）</span><span>[2]</span><span>完成，非常方便！</span></p><p><span><br></span></p><p><span><strong><span>本期摘要：</span></strong></span></p><ol><li><p><span>数据准备：表达矩阵清洗+均值标准化处理；</span></p></li><li><p><span>TIDE评分计算：表达矩阵上传与结果输出；</span></p></li><li><p><span>小提琴图可视化+统计检验</span></p></li></ol><p><br></p><p><span>复现文章：</span></p><p><span><br></span></p><p><strong><img data-ratio="0.45586297760210803" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6kFkhkOuw1ib6xSBZMYZ4tWfZzjO1bKDMfkWibMTUAgypOib6MSMWvlprPr2fqab19JKr0adTZRyJu9w/640?wx_fmt=png" data-type="png" data-w="1518" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6kFkhkOuw1ib6xSBZMYZ4tWfZzjO1bKDMfkWibMTUAgypOib6MSMWvlprPr2fqab19JKr0adTZRyJu9w/640?wx_fmt=png"></strong></p><p><span><em><strong><span>Frontiers in oncology</span></strong></em><strong><span>, IF= 5.738，2022</span></strong></span><span><strong><span>[1]</span></strong></span></p><p><br></p><p><span>【由于使用公共数据版本时间不同，样本数不完全一致、数据集切割不一致、随机数种子设置不一致等各种客观及主观原因，结果和原文不完全一致，仅供步骤流程和图表绘制学习参考，结果以文献为准】</span></p><p><br></p><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><p><span>#载入所需R包：</span><br mpa-from-tpl="t"><span>library</span>(stringr)<br mpa-from-tpl="t"><span>library</span>(ggplot2)<br mpa-from-tpl="t"><span>library</span>(ggpubr)<br mpa-from-tpl="t"><span>library</span>(patchwork)<br mpa-from-tpl="t"><span>#载入往期数据：</span><br mpa-from-tpl="t"><span>load</span>('02_exp_cl_fpkm.Rdata') <span>#第一期整理</span><br mpa-from-tpl="t"><span>load</span>('06_Risk_Score.Rdata') <span>#第六期整理</span><br mpa-from-tpl="t"><span>View</span>(exp) <span>#TCGA总队列fpkm表达矩阵</span></p></pre></section><p><img data-ratio="0.3651726671565026" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6kFkhkOuw1ib6xSBZMYZ4tWfjtBsoEgiagyh9hpJkNZNdRmT4VclU1iapeNRYH7m3RnheXvRBqMAGAicw/640?wx_fmt=png" data-type="png" data-w="1361" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6kFkhkOuw1ib6xSBZMYZ4tWfjtBsoEgiagyh9hpJkNZNdRmT4VclU1iapeNRYH7m3RnheXvRBqMAGAicw/640?wx_fmt=png"></p><p><br mpa-from-tpl="t"></p><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><p><span>head</span>(total) <span>#TCGA总队列临床信息(含风险评分)</span></p></pre></section><p><img data-ratio="0.35192780968006565" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6kFkhkOuw1ib6xSBZMYZ4tWfzpZC1SsFUtcRJ2hfDnnXJzGCibbyL0K0re8t8Kc5qmkicjbE9yPCIZOg/640?wx_fmt=png" data-type="png" data-w="1219" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6kFkhkOuw1ib6xSBZMYZ4tWfzpZC1SsFUtcRJ2hfDnnXJzGCibbyL0K0re8t8Kc5qmkicjbE9yPCIZOg/640?wx_fmt=png"></p><p><span><br></span></p><section><section powered-by="xiumi.us"><section><p>✦  <span>+</span></p></section></section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><p>+</p></section></section><section><section powered-by="xiumi.us"><p><strong><span><span>一、表达矩阵预处理</span></span></strong><span><span></span></span></p></section></section></section></section><p><br></p><p><span>首先，由于通过样本名无法识别高低风险组，所以我们需要根据风险评分将原本列名替换为高/低风险的分组id名。</span></p><p><br></p><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><p><span>dt</span> &lt;- as.data.frame(t(exp))<br mpa-from-tpl="t"><span>identical</span>(rownames(dt),rownames(total)) <span>#保险检查一下行名是否一致</span><br mpa-from-tpl="t"><span>dt</span>$score &lt;- total$score <span>#在表达矩阵中新增风险评分列</span><br mpa-from-tpl="t"><span>#按风险评分中位数对样本重新命名：</span><br mpa-from-tpl="t"><span>df</span> &lt;- dt[order(dt$score,decreasing = F),] <span>#先按风险评分把矩阵升序排列</span><br mpa-from-tpl="t"><span>df</span>$Risk_Group &lt;- ifelse(df$score &lt; median(df$score),'Low_Risk','High_Risk') <span>#新增高低风险分组列，按照风险评分中位数划分</span><br mpa-from-tpl="t"><span>df</span>$id &lt;- c(1:length(df$score)) <span>#新增id列</span><br mpa-from-tpl="t"><span>df</span>$id2 &lt;- paste(df$Risk_Group,df$id,sep = '_') <span>#将风险分组和id串联</span><br mpa-from-tpl="t"><span>rownames</span>(df) &lt;- df$id2 <span>#修改为行名</span><br mpa-from-tpl="t"><span>df</span> &lt;- df[,1:34509] <span>#去掉新增列，仅保留表达矩阵</span><br mpa-from-tpl="t"><span>df</span> &lt;- t(df) <span>#转置</span><br mpa-from-tpl="t"><span>#将矩阵重新转换为数值型：</span><br mpa-from-tpl="t"><span>df2</span> &lt;- apply(df,2,as.numeric)<br mpa-from-tpl="t"><span>row</span>.names(df2) &lt;- row.names(df)<br mpa-from-tpl="t"><span>df2</span>[1:6,1:6]</p></pre></section><p><img data-ratio="0.21787709497206703" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6kFkhkOuw1ib6xSBZMYZ4tWfrqpAFooHmBjGNiaKrVO5Uiaq0naZqMCbZmTZUqs6HRFflb1cmxQBIdHA/640?wx_fmt=png" data-type="png" data-w="1074" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6kFkhkOuw1ib6xSBZMYZ4tWfrqpAFooHmBjGNiaKrVO5Uiaq0naZqMCbZmTZUqs6HRFflb1cmxQBIdHA/640?wx_fmt=png"></p><p><span><br></span></p><p><span>完成矩阵列名替换后，需要进行标准化。我们参考官方的使用建议：将样本按均值标准化，如下图。</span></p><p><span><br></span></p><p><img data-ratio="0.28237015362106804" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6kFkhkOuw1ib6xSBZMYZ4tWf0U7a6Bea0KFG4VC2QhXcDCkAvupiaexXtLXUAVQulCqSJkwSMIwiaEPA/640?wx_fmt=png" data-type="png" data-w="1367" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6kFkhkOuw1ib6xSBZMYZ4tWf0U7a6Bea0KFG4VC2QhXcDCkAvupiaexXtLXUAVQulCqSJkwSMIwiaEPA/640?wx_fmt=png"></p><p><span><br></span></p><p><span><strong><span>计算方法：</span></strong></span><span>表达量减去每个基因所在样本的均值（即按行计算均值，再用每个表达量-均值）</span></p><p><br></p><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><p><span>Expr</span> &lt;- t(apply(df2, 1, function(x){x-(mean(x))})) <span>#均值标准化</span><br mpa-from-tpl="t"><span>Expr</span>[1:6,1:6]</p></pre></section><p><img data-ratio="0.21787709497206703" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6kFkhkOuw1ib6xSBZMYZ4tWfPFE29V7cYQDSZuxIVKtXDMaHOHK2kQ85na7TIibR7ibFicoEoFKOxca9Q/640?wx_fmt=png" data-type="png" data-w="1074" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6kFkhkOuw1ib6xSBZMYZ4tWfPFE29V7cYQDSZuxIVKtXDMaHOHK2kQ85na7TIibR7ibFicoEoFKOxca9Q/640?wx_fmt=png"></p><p><span><br mpa-from-tpl="t"></span></p><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><p><span>write</span>.csv(Expr,file = 'TIDE.csv') <span>#保存清洗好的矩阵到本地</span><span></span></p></pre></section><p><img data-ratio="0.6700796359499431" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6kFkhkOuw1ib6xSBZMYZ4tWfb8EeIYEUytovVo8UnfMj87iaWb4rCe3Z55lhdCC3nuPJJLTeuSVibAOA/640?wx_fmt=png" data-type="png" data-w="1758" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6kFkhkOuw1ib6xSBZMYZ4tWfb8EeIYEUytovVo8UnfMj87iaWb4rCe3Z55lhdCC3nuPJJLTeuSVibAOA/640?wx_fmt=png"></p><p><br></p><p><span>正式上传前，必须将矩阵转换为</span><span>制表符分隔</span><span>的文本格式，如下。</span></p><p><span><br></span></p><p><img data-ratio="0.630976430976431" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6kFkhkOuw1ib6xSBZMYZ4tWfYVQPgNTia3VwuokDXJrtTgvpxzibcRJo8ibibkBBfba7jRia2aXztReAHjw/640?wx_fmt=png" data-type="png" data-w="1485" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6kFkhkOuw1ib6xSBZMYZ4tWfYVQPgNTia3VwuokDXJrtTgvpxzibcRJo8ibibkBBfba7jRia2aXztReAHjw/640?wx_fmt=png"></p><p><br></p><section><section powered-by="xiumi.us"><section><p>✦  <span>+</span></p></section></section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><p>+</p></section></section><section><section powered-by="xiumi.us"><p><strong><span>二、TIDE评分计算</span></strong><br></p></section></section></section></section><p><br></p><p><span>进入官网（</span><span>http://tide.dfci.harvard.edu/login/</span><span>），需要先登入自己的账号才能进行其它操作，第一次使用的朋友们可以先注册一下，任意邮箱即可。</span></p><p><span><br></span></p><p><img data-ratio="0.222397476340694" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6kFkhkOuw1ib6xSBZMYZ4tWf8j6D7fM2evAtDMWKX7kUibFkvNyMNic2VNhMw2xU2GDuwnyMYeoGkZNw/640?wx_fmt=png" data-type="png" data-w="1268" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6kFkhkOuw1ib6xSBZMYZ4tWf8j6D7fM2evAtDMWKX7kUibFkvNyMNic2VNhMw2xU2GDuwnyMYeoGkZNw/640?wx_fmt=png"></p><p><br></p><p><span>登入账号后，在菜单栏第一个</span><span>‘Response Prediction’</span><span>选项页面下拉，直接上传我们整理好的制表符分隔文本格式的表达矩阵，</span><span>Cancer type</span><span>选择Other，</span><span>Previous immunotherapy</span><span>保持默认No，然后点击</span><strong><span>Predict response</span></strong><span>即可静待结果。</span></p><p><span><br></span></p><p><img data-ratio="0.6683168316831684" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6kFkhkOuw1ib6xSBZMYZ4tWfMYG8rgSuhcibfONiaGiaNYjPgnuasnh4xjLuINBamGeuiafibZArE4MwxYA/640?wx_fmt=png" data-type="png" data-w="1616" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6kFkhkOuw1ib6xSBZMYZ4tWfMYG8rgSuhcibfONiaGiaNYjPgnuasnh4xjLuINBamGeuiafibZArE4MwxYA/640?wx_fmt=png"></p><p><span><br></span></p><p><span>分析完成后，会直接跳转到预测结果报告页，如下。</span></p><p><br></p><p><img data-ratio="0.5668276972624798" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6kFkhkOuw1ib6xSBZMYZ4tWfdaVug2e0VqbohkVmdNLDx8pyxAK2sdSgA5Ev6IILdp0DO0jzuicD8Aw/640?wx_fmt=png" data-type="png" data-w="1863" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6kFkhkOuw1ib6xSBZMYZ4tWfdaVug2e0VqbohkVmdNLDx8pyxAK2sdSgA5Ev6IILdp0DO0jzuicD8Aw/640?wx_fmt=png"></p><p><span><br></span></p><p><span>我们直接下拉到页面底部，点击</span><span><strong>Export to csv</strong></span><span>将结果表下载到本地，并放在R工作目录下，方便我们调用。</span></p><p><br></p><p><img data-ratio="0.49724192277383766" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6kFkhkOuw1ib6xSBZMYZ4tWfWbZt0hokmT3XR7pJ9cPRC9EE2WicNUlLZYgicibApicSnO6mVL6Jp75sqw/640?wx_fmt=png" data-type="png" data-w="1269" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6kFkhkOuw1ib6xSBZMYZ4tWfWbZt0hokmT3XR7pJ9cPRC9EE2WicNUlLZYgicibApicSnO6mVL6Jp75sqw/640?wx_fmt=png"></p><p><br></p><p><img data-ratio="0.67008547008547" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6kFkhkOuw1ib6xSBZMYZ4tWfMmc76oTLcl1vBib4UAJsHp3py1qfutDfs1InvZuymwX8638NhaIC4CQ/640?wx_fmt=png" data-type="png" data-w="1755" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6kFkhkOuw1ib6xSBZMYZ4tWfMmc76oTLcl1vBib4UAJsHp3py1qfutDfs1InvZuymwX8638NhaIC4CQ/640?wx_fmt=png"></p><p><br></p><section><section powered-by="xiumi.us"><section><p>✦  <span>+</span></p></section></section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><p>+</p></section></section><section><section powered-by="xiumi.us"><p><strong><span>三、小提琴图可视化结果</span></strong><br></p></section></section></section></section><p><br></p><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><p><span>#读入结果表：</span><br mpa-from-tpl="t"><span>result</span> &lt;- data.table::fread('TIDE_result.csv')<br mpa-from-tpl="t"><span>colnames</span>(result)</p></pre></section><p><img data-ratio="0.11071744906997343" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6kFkhkOuw1ib6xSBZMYZ4tWffyHibOxialuaYicaGVhEs2M87qd11zHma8c4vRrQoJ6LPhqPbacKMXuUw/640?wx_fmt=png" data-type="png" data-w="1129" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6kFkhkOuw1ib6xSBZMYZ4tWffyHibOxialuaYicaGVhEs2M87qd11zHma8c4vRrQoJ6LPhqPbacKMXuUw/640?wx_fmt=png"></p><p><br mpa-from-tpl="t"></p><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><p><span>#根据行名新增分组列：</span><br mpa-from-tpl="t"><span>result</span>$Risk &lt;- ifelse(<br mpa-from-tpl="t"><span>str_sub</span>(result$Patient,1,1)=='L','Low_Risk','High_Risk'<br mpa-from-tpl="t">)<br mpa-from-tpl="t"><span>#转换为因子，调整顺序：</span><br mpa-from-tpl="t"><span>result</span>$Risk &lt;- factor(result$Risk,levels = c('Low_Risk','High_Risk'))<br mpa-from-tpl="t"><span>#小提琴图展示结果：</span><br mpa-from-tpl="t"><span>#1.TIDE小提琴图：</span><br mpa-from-tpl="t"><span>my_comparisons</span> &lt;- list( c(<span>"Low_Risk"</span>, <span>"High_Risk"</span>)) <span>#添加比较分组</span><br mpa-from-tpl="t"><span>p1</span> &lt;- ggviolin(result, x = 'Risk', y = 'TIDE', fill = 'Risk',<br mpa-from-tpl="t"><span>palette</span> = c(<span>"#4979b6"</span>,<span>"#d9352a"</span>),<br mpa-from-tpl="t"><span>add</span> = 'boxplot', add.params = list(fill = <span>"white"</span>)) +<br mpa-from-tpl="t"><span>stat_compare_means</span>(comparisons = my_comparisons, label = <span>"p.signif"</span>, bracket.size=0.5, tip.length = 0.02, method = 't.test')<br mpa-from-tpl="t"><span>p1</span><br mpa-from-tpl="t"><span>#method可选：t.test、wilcox.test、anova、kruskal.test</span></p></pre></section><p><img data-ratio="0.983065198983912" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6kFkhkOuw1ib6xSBZMYZ4tWf9tFd0W9YHrDNYGDaNSB6tLIVmTzd81RlDEVJcfsDmia6BybsYFLvSvQ/640?wx_fmt=png" data-type="png" data-w="1181" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6kFkhkOuw1ib6xSBZMYZ4tWf9tFd0W9YHrDNYGDaNSB6tLIVmTzd81RlDEVJcfsDmia6BybsYFLvSvQ/640?wx_fmt=png"></p><p><br mpa-from-tpl="t"></p><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><p><span>#2.Dysfunction小提琴图：</span><br mpa-from-tpl="t"><span>p2</span> &lt;- ggviolin(result, x = 'Risk', y = 'Dysfunction', fill = 'Risk',<br mpa-from-tpl="t"><span>palette</span> = c(<span>"#4979b6"</span>,<span>"#d9352a"</span>),<br mpa-from-tpl="t"><span>add</span> = 'boxplot', add.params = list(fill = <span>"white"</span>)) +<br mpa-from-tpl="t"><span>stat_compare_means</span>(comparisons = my_comparisons, label = <span>"p.signif"</span>, bracket.size=0.5, tip.length = 0.02, method = 't.test')<br mpa-from-tpl="t"><span>p2</span></p></pre></section><p><img data-ratio="0.983065198983912" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6kFkhkOuw1ib6xSBZMYZ4tWfAnkGhIucMgRhw8sV28tPMk8InNDLUD1Xs8HnNg2Iiar3G6WhYnSxQMQ/640?wx_fmt=png" data-type="png" data-w="1181" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6kFkhkOuw1ib6xSBZMYZ4tWfAnkGhIucMgRhw8sV28tPMk8InNDLUD1Xs8HnNg2Iiar3G6WhYnSxQMQ/640?wx_fmt=png"></p><p><br mpa-from-tpl="t"></p><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><p><span>#Exclusion小提琴图：</span><br mpa-from-tpl="t"><span>p3</span> &lt;- ggviolin(result, x = 'Risk', y = 'Exclusion', fill = 'Risk',<br mpa-from-tpl="t"><span>palette</span> = c(<span>"#4979b6"</span>,<span>"#d9352a"</span>),<br mpa-from-tpl="t"><span>add</span> = 'boxplot', add.params = list(fill = <span>"white"</span>)) +<br mpa-from-tpl="t"><span>stat_compare_means</span>(comparisons = my_comparisons, label = <span>"p.signif"</span>, bracket.size=0.5, tip.length = 0.02, method = 't.test')<br mpa-from-tpl="t"><span>p3</span></p></pre></section><p><img data-ratio="0.983065198983912" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6kFkhkOuw1ib6xSBZMYZ4tWfSBxwpboVoSkSw2PqwGaaOicUSms4UeJJItgfN3iadNNLTmbFnNqGAaBA/640?wx_fmt=png" data-type="png" data-w="1181" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6kFkhkOuw1ib6xSBZMYZ4tWfSBxwpboVoSkSw2PqwGaaOicUSms4UeJJItgfN3iadNNLTmbFnNqGAaBA/640?wx_fmt=png"></p><p><br mpa-from-tpl="t"></p><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><p><span>#MSI小提琴图：</span><br mpa-from-tpl="t"><span>colnames</span>(result)[6]<br mpa-from-tpl="t"><span>colnames</span>(result)[6] &lt;- c('MSI') <span>#简化一下列名</span><br mpa-from-tpl="t"><span>p4</span> &lt;- ggviolin(result, x = 'Risk', y = 'MSI', fill = 'Risk',<br mpa-from-tpl="t"><span>palette</span> = c(<span>"#4979b6"</span>,<span>"#d9352a"</span>),<br mpa-from-tpl="t"><span>add</span> = 'boxplot', add.params = list(fill = <span>"white"</span>)) +<br mpa-from-tpl="t"><span>stat_compare_means</span>(comparisons = my_comparisons, label = <span>"p.signif"</span>, bracket.size=0.5, tip.length = 0.02, method = 't.test')<br mpa-from-tpl="t"><span>p4</span><span></span></p></pre></section><p><img data-ratio="0.983065198983912" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6kFkhkOuw1ib6xSBZMYZ4tWfeoTWk79BagdfQGdBRzdxLAr1DibrGicQoiavoMHeP3BRQr7ibWJNjKQbeg/640?wx_fmt=png" data-type="png" data-w="1181" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6kFkhkOuw1ib6xSBZMYZ4tWfeoTWk79BagdfQGdBRzdxLAr1DibrGicQoiavoMHeP3BRQr7ibWJNjKQbeg/640?wx_fmt=png"></p><p><br mpa-from-tpl="t"></p><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><p><span>p</span> &lt;- p1+p2+p3+p4<br mpa-from-tpl="t"><span>p</span></p></pre></section><p><img data-ratio="0.9703640982218459" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6kFkhkOuw1ib6xSBZMYZ4tWf6mElCdoo8rCfj7yzc0RoWDKU25kk2BJs0C8qglfdYnLocsia4cCTKew/640?wx_fmt=png" data-type="png" data-w="1181" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6kFkhkOuw1ib6xSBZMYZ4tWf6mElCdoo8rCfj7yzc0RoWDKU25kk2BJs0C8qglfdYnLocsia4cCTKew/640?wx_fmt=png"></p><p><span><br></span></p><p><span>这样就完成了文章最后一张结果图的复现。从上图可以看出高风险组的TIDE评分、Exclusion评分和Dysfunction评分显著升高，MSI评分较低，说明了<strong>高风险组患者的免疫逃逸潜力增大，免疫检查点抑制治疗（ICI）疗效可能较差</strong>。</span></p><p><span><br></span></p><p><span>更多TCGA相关内容可戳</span><span><a target="_blank" href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzIyOTY3MDA3MA==&amp;action=getalbum&amp;album_id=2202087021886734337#wechat_redirect" textvalue="#TCGA数据库" linktype="text" imgurl="" imgdata="null" tab="innerlink" data-linktype="2">#TCGA数据库</a></span><span>，今天的分享就到这里！</span></p><p><br></p><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><p><span><strong><br></strong></span></p></section><section powered-by="xiumi.us"><section><svg viewbox="0 0 1 1"></svg></section></section></section></section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><p><strong>往期TCGA复现学习</strong></p></section></section></section></section></section></section></section></section><p><br></p><p><span>无代码的TCGA纯生信文章复现学习：</span></p><p><span><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzIyOTY3MDA3MA==&amp;mid=2247501235&amp;idx=1&amp;sn=b9f8a426cffa93e91e2654bc8f968d45&amp;chksm=e8bda86adfca217c408dc87147158166ea4a258d5c8c472adeecb7d1d449202b301f9e630e83&amp;scene=21#wechat_redirect" textvalue="《5+纯生信文章全图复现！无代码新手友好》" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1"><span>《5+纯生信文章全图复现！无代码新手友好》</span></a></span></p><p><br></p><p><span>基于R语言的TCGA纯生信文章（预后风险模型构建）复现学习：</span></p><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzA5NzQzOTgzMw==&amp;mid=2650949968&amp;idx=1&amp;sn=af6661c04dd3c926bdcfb9cf948f0e1f&amp;chksm=8b563066bc21b97098f02aa70b7d4d65baa504aa586340d274b92e3ae606ca56b4d4f9613f38&amp;scene=21#wechat_redirect" textvalue="《5.7+生信文章复现（一）：TCGA表达矩阵+临床信息清洗》" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1"><span>《5.7+生信文章复现（一）：TCGA表达矩阵+临床信息清洗》</span></a></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzIyOTY3MDA3MA==&amp;mid=2247501626&amp;idx=1&amp;sn=57db35c511b3aa08bbb3e2d3135b6ce1&amp;chksm=e8bdaae3dfca23f55e9566342f5c07144c7bfe46ed80a7ed414948c77bd5647834ce2482c4dd&amp;scene=21#wechat_redirect" textvalue="《5.7+生信文章复现（二）：ICGC表达矩阵清洗》" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1"><span>《5.7+生信文章复现（二）：ICGC表达矩阵清洗》</span></a></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzIyOTY3MDA3MA==&amp;mid=2247502169&amp;idx=1&amp;sn=c4e8c58b231cfd151c040901ba5a82d9&amp;chksm=e8bda480dfca2d962c9d0cd93f932150dd6821e028d5adcb0e73139c91383d3b83eff6a87e67&amp;scene=21#wechat_redirect" textvalue="《5.7+生信文章复现（三）：ICGC临床信息清洗》" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1"><span>《5.7+生信文章复现（三）：ICGC临床信息清洗》</span></a></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzA5NzQzOTgzMw==&amp;mid=2650954237&amp;idx=1&amp;sn=6a88f8f97332c79c952344872c4072db&amp;chksm=8b5620cbbc21a9ddb3509323e6fb8975eaef6b83e3414b7abdece112624483552f6fbef45926&amp;scene=21#wechat_redirect" textvalue="《5.7+生信文章复现（四）：DESeq2差异基因筛选》" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1"><span>《5.7+生信文章复现（四）：DESeq2差异基因筛选》</span></a></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzIyOTY3MDA3MA==&amp;mid=2247503245&amp;idx=1&amp;sn=7b7a42db1372f6e92b31235021097749&amp;chksm=e8bda054dfca2942945879d12f95cabccc7d62579b061fd8406be32536ff962a61b835cf4cb6&amp;scene=21#wechat_redirect" textvalue="《5.7+生信文章复现（五）：单因素cox+lasso筛选预后相关DEGs》" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1"><span>《5.7+生信文章复现（五）：单因素cox+lasso筛选预后相关DEGs》</span></a></section><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzIyOTY3MDA3MA==&amp;mid=2247504411&amp;idx=1&amp;sn=051a9ab619859e83d21aff93cca04baa&amp;chksm=e8bdbfc2dfca36d431f96e5e1513273aeb983b9b103999bb3c0f2e459b39696d36f7f6812bee&amp;scene=21#wechat_redirect" textvalue="《5.7+生信文章复现（六）：风险评分（Risk Score）计算》" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1"><span>《5.7+生信文章复现（六）：风险评分（Risk Score）计算》</span></a></p><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzIyOTY3MDA3MA==&amp;mid=2247504852&amp;idx=1&amp;sn=27d3e4d5be69174cb864ffd078a9f967&amp;chksm=e8bdbe0ddfca371bb8a41bcaf621edb64be36af32465cb081c8f07b2a9cd1676b837b3f3bdae&amp;scene=21#wechat_redirect" textvalue="《5.7+生信文章复现（七）：预后模型验证：风险因子联动图+生存分析绘制》" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2"><span>《5.7+生信文章复现（七）：预后模型验证：风险因子联动图+生存分析绘制》</span></a><span></span></p><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzIyOTY3MDA3MA==&amp;mid=2247504884&amp;idx=1&amp;sn=a7782e3fe5ab2dba0dbf38bc06c96282&amp;chksm=e8bdbe2ddfca373b598f379b0464081a189f0f544ce92573717aa19dd800f314d6dd9f4af4e5&amp;scene=21#wechat_redirect" textvalue="《5.7+生信文章复现（八）：模型预测：风险森林+timeROC+列线图》" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2"><span>《5.7+生信文章复现（八）：模型预测：风险森林+timeROC+列线图》</span></a><span></span></p><p><span><br></span></p><section data-role="paragraph"><section><section hm_fix="368:481"><section><img data-ratio="0.8181818181818182" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6kFkhkOuw1ib6xSBZMYZ4tWfWiaTSHKB7s6IYPW37XiclFZhcPNleoWiaK7CJ4XVYPoiaibIDQo2a2bcQ1Q/640?wx_fmt=png" data-type="png" data-w="44" data-width="100%" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6kFkhkOuw1ib6xSBZMYZ4tWfWiaTSHKB7s6IYPW37XiclFZhcPNleoWiaK7CJ4XVYPoiaibIDQo2a2bcQ1Q/640?wx_fmt=png"></section><section><section data-brushtype="text"><strong><span>参考文献</span></strong></section><section data-width="100%"><br></section></section></section></section></section><p><span>[1] Ning X, Li N, Qi Y, et al. Identification of a Hypoxia-Related Gene Model for Predicting the Prognosis and Formulating the Treatment Strategies in Kidney Renal Clear Cell Carcinoma[J]. Frontiers in oncology, 2022, 11: 806264.</span></p><p><span>[2] Fu, J., Li, K., Zhang, W. et al. Large-scale public data reuse to model immunotherapy response and resistance. Genome Med 12, 21 (2020). https://doi.org/10.1186/s13073-020-0721-z</span></p><p><span><br></span></p><section><span><strong><span>*未经许可，不得以任何方式复制或抄袭本篇文章之部分或全部内容。版权所有，侵权必究。</span></strong></span></section><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><p><br></p></section></section></section></section><section data-role="outer" label="Powered by 135editor.com"><section data-tools="135编辑器" data-id="105648"><section><section data-role="outer" label="Powered by 135editor.com"><section data-role="paragraph"><section data-role="outer" label="Powered by 135editor.com"><section data-tools="135编辑器" data-id="105648"><section><section><img data-ratio="0.8928571428571429" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6kCKJYcEqEIfoJYG621mPJE8VibmibGU0Jxic9iabARVRH0FT6BNE8VAglWFXBPibFAU7a6tWGibSs8wyUg/640?wx_fmt=png" data-type="png" data-w="41" data-width="100%" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6kCKJYcEqEIfoJYG621mPJE8VibmibGU0Jxic9iabARVRH0FT6BNE8VAglWFXBPibFAU7a6tWGibSs8wyUg/640?wx_fmt=png"></section><section><section><section data-width="35%"><section><section data-width="100%"><img data-ratio="1" data-src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/tgUVxVRjT6kCKJYcEqEIfoJYG621mPJEv5etCBwHicqbEPwnVrkpaasxqaVibM4mT2JdIuN6yTlYWDD4mL5A427A/640?wx_fmt=jpeg" data-type="jpeg" data-w="860" data-width="100%" title="SCIPainter 30cm二维码.jpg" src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/tgUVxVRjT6kCKJYcEqEIfoJYG621mPJEv5etCBwHicqbEPwnVrkpaasxqaVibM4mT2JdIuN6yTlYWDD4mL5A427A/640?wx_fmt=jpeg"></section></section></section><section data-width="50%"><section><section data-brushtype="text"><strong># SCIPainter</strong></section><section data-brushtype="text" hm_fix="361:593"><p>基迪奥旗下绘图公众号</p><p>分享科研绘图技能与工具</p><p>欢迎关注与转发~</p></section></section></section></section></section></section></section></section></section></section><section><br></section></section></section><section data-role="paragraph"><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><img data-ratio="1" data-src="https://mmbiz.qpic.cn/sz_mmbiz_gif/tgUVxVRjT6kCKJYcEqEIfoJYG621mPJEgMd0aMPtmrDjiaX8sBhfhicVteeHf1JicexSpUbS3fdS9SiboUVN7guaPw/640?wx_fmt=gif" data-type="gif" data-w="400" src="https://mmbiz.qpic.cn/sz_mmbiz_gif/tgUVxVRjT6kCKJYcEqEIfoJYG621mPJEgMd0aMPtmrDjiaX8sBhfhicVteeHf1JicexSpUbS3fdS9SiboUVN7guaPw/640?wx_fmt=gif"></section></section></section><section><section powered-by="xiumi.us"><section><p><span><strong>你的好友拍了拍你</strong></span></p><p><span><strong>并请你帮她点一下</strong></span><span><strong><span>“分享”</span></strong></span><span><strong><span>~</span></strong></span></p></section></section></section></section></section><p><br></p></section></section><p><span></span></p><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/T5g27GPf-PF_SsSZQG4ikQ",target="_blank" rel="noopener noreferrer">原文链接</a>
