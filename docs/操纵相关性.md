---
title: "操纵相关性"
date: 2022-12-06T01:45:17Z
draft: ["false"]
tags: [
  "fetched",
  "生信技能树"
]
categories: ["Acdemic"]
---
操纵相关性 by 生信技能树
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><blockquote data-tool="mdnice编辑器"><p>目前主流的10x平台的单细胞转录组测序后得到的表达量矩阵里面的每个样品都是成百上千个细胞，因为技术本身就是牺牲了每个细胞的基因数量来换取更多的单细胞的产出，这样的话，每个细胞仅仅是测到一两千个基因就足够了，换句话说，就是表达量矩阵里面有非常多的0值，绝大部分基因在绝大部分细胞都是没有检测到的，也就是表达量为0，这个是单细胞技术的天然缺陷， 有一个专有名词：drop-out</p></blockquote><h3 data-tool="mdnice编辑器"><span></span>单细胞表达量矩阵里面的0值非常多<span></span></h3><p data-tool="mdnice编辑器">我们以pbmc3k数据集为例：</p><pre data-tool="mdnice编辑器"><span></span><code><span>library</span>(Seurat)<br><span>library</span>(SeuratData)<br><br><span>#InstallData("pbmc3k")  </span><br>data(<span>"pbmc3k"</span>)  <br>sce &lt;- pbmc3k.final   <br>sce@assays$RNA@counts[<span>1</span>:<span>4</span>,<span>1</span>:<span>4</span>]<br></code></pre><p data-tool="mdnice编辑器">可以看到，前面的4个细胞的4个基因都是0，在稀疏矩阵里面的0以小数点表示，如下所示是：</p><pre data-tool="mdnice编辑器"><span></span><code>&gt; sce@assays<span>$RNA</span>@counts[1:4,1:4]<br>4 x 4 sparse Matrix of class <span>"dgCMatrix"</span><br>              AAACATACAACCAC AAACATTGAGCTAC AAACATTGATCAGC AAACCGTGCTTCCG<br>AL627309.1                 .              .              .              .<br>AP006222.2                 .              .              .              .<br>RP11-206L10.2              .              .              .              .<br>RP11-206L10.9              .              .              .              .<br>&gt; <br></code></pre><p data-tool="mdnice编辑器">也很容易计算到这个数据集到底是多少个0</p><pre data-tool="mdnice编辑器"><span></span><code>&gt; dim(sce@assays<span>$RNA</span>@counts)<br>[1] 13714  2638<br>&gt; length(sce@assays<span>$RNA</span>@counts)<br>[1] 36177532<br>&gt; sum(sce@assays<span>$RNA</span>@counts==0)<br>[1] 33938800<br>&gt; sum(sce@assays<span>$RNA</span>@counts==0)/length(sce@assays<span>$RNA</span>@counts)<br>[1] 0.9381182<br></code></pre><h3 data-tool="mdnice编辑器"><span></span>CD79A 和 CD79B都是B细胞的标记基因，所以相关性很好<span></span></h3><p data-tool="mdnice编辑器">既然具体到每个细胞来看，绝大部分基因都是0值，这样的话不同细胞之间很难计算相关性，比如FeatureScatter 函数专门是干这个事 ：</p><pre data-tool="mdnice编辑器"><span></span><code><span>library</span>(patchwork)<br>FeatureScatter(sce,<span>"nCount_RNA"</span> ,<span>"nFeature_RNA"</span>) +<br>FeatureScatter(sce,<span>"CD14"</span> ,<span>"CD4"</span>) +<br>FeatureScatter(sce,<span>"CD79A"</span> ,<span>"CD79B"</span>)<br></code></pre><p data-tool="mdnice编辑器">如下所示：</p><p><img data-galleryid="" data-ratio="0.30774365821094796" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wz3as8dmXdPCkSR04fBsDBaT2JytWPyP3YSH4KnP1shhQIx6PxFWhOLNFFgaib9N6U9lSNKueiaoDUA/640?wx_fmt=png" data-type="png" data-w="2996" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wz3as8dmXdPCkSR04fBsDBaT2JytWPyP3YSH4KnP1shhQIx6PxFWhOLNFFgaib9N6U9lSNKueiaoDUA/640?wx_fmt=png"></p><figure data-tool="mdnice编辑器"><figcaption>计算相关性</figcaption></figure><p data-tool="mdnice编辑器">因为 nCount_RNA 和 nFeature_RNA是细胞的熟悉，所以没有0的干扰，这个相关性很好，而且是可靠的。</p><p data-tool="mdnice编辑器">另外，因为 CD14 和 CD4 本来是髓系免疫细胞和cd4T细胞的标记基因，理论上就相关性应该是很差。</p><p data-tool="mdnice编辑器">最后，CD79A 和 CD79B都是B细胞的标记基因，他们的相关性确实是应该是很好。</p><h3 data-tool="mdnice编辑器"><span></span>但是CD79A 和 CD79B在b细胞亚群里面是没有相关性的<span></span></h3><p data-tool="mdnice编辑器">看起来一切合情合理，但是如果我们具体到B细胞本身，就发现不对劲了。</p><pre data-tool="mdnice编辑器"><span></span><code>Bsce = sce[,Idents(sce) == <span>'B'</span>]<br>FeatureScatter(Bsce,<span>"nCount_RNA"</span> ,<span>"nFeature_RNA"</span>) + <br>FeatureScatter(Bsce,<span>"CD79A"</span> ,<span>"CD79B"</span>)+ <br>FeatureScatter(Bsce,<span>"CD79A"</span> ,<span>"MS4A1"</span>)<br></code></pre><p data-tool="mdnice编辑器">他们的相关性居然完全没有了。。。。</p><p><img data-galleryid="" data-ratio="0.29740932642487045" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wz3as8dmXdPCkSR04fBsDBaJeK9p11JmHK6Do3wgur1kziboWgMk0Roiacic6MMfK2uz2Jicudial0UUKA/640?wx_fmt=png" data-type="png" data-w="1930" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wz3as8dmXdPCkSR04fBsDBaJeK9p11JmHK6Do3wgur1kziboWgMk0Roiacic6MMfK2uz2Jicudial0UUKA/640?wx_fmt=png"></p><figure data-tool="mdnice编辑器"><figcaption> </figcaption></figure><p data-tool="mdnice编辑器">这个时候有两个解释，首先是因为0值的存在，影响了相关性技术，其次是因为它们虽然都是B细胞的标记基因仅仅是说明它们都是应该在B细胞亚群里面高表达，并不能推理出来它们应该是正相关。</p><p data-tool="mdnice编辑器">当然了，单细胞水平不同基因的表达量相关性本来就不应该是如此简单的计算，不过这个简单的探索，这两个简单的推理还是蛮有意思的的。</p><p data-tool="mdnice编辑器">天色已晚，我不想写了，亲爱的读者们大家觉得应该是哪种可能性呢？</p></section><p><br></p><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/jPOBywnxPuXvdfyepey2Ow",target="_blank" rel="noopener noreferrer">原文链接</a>
