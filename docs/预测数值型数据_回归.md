---
title: "预测数值型数据—回归"
date: 2022-11-20T15:29:14Z
draft: ["false"]
tags: [
  "fetched",
  "医学僧的科研日记"
]
categories: ["Acdemic"]
---
预测数值型数据—回归 by 医学僧的科研日记
------
<div><p data-mpa-powered-by="yiban.io">数学关系帮助我们理解日常生活的许多方面。例如，体重是一个关于人体卡路里摄入量的函数；收入与一个人的教育和工作经验相关；民意支持率有助于我们估计总统候选人当选的胜率。而当这种关系用确切的数字表达时，我们获得了更高的清晰度。例如当经济繁荣时一个总统很可能连任。显然，这些等式关系并不完全适合每一种情形，但一般而言，我们期盼他们是合理正确的。而“回归”则在很大程度上帮助我们计算和理解这种等<span>式</span>关系。</p><section><iframe data-vidtype="2" data-mpvid="wxv_2673196171565252609" data-cover="http%3A%2F%2Fmmbiz.qpic.cn%2Fmmbiz_jpg%2FeBfvI7Ryx8cPxGRufctcobha9GiaOtdWVoFM6ESR1zEUJjjLyFIAhNhTpt1ml38FcPpIWdfe5mYVoBynNia0AZZA%2F0%3Fwx_fmt%3Djpeg" allowfullscreen="" frameborder="0" data-ratio="1.7777777777777777" data-w="1920" data-src="https://mp.weixin.qq.com/mp/readtemplate?t=pages/video_player_tmpl&amp;action=mpvideo&amp;auto=0&amp;vid=wxv_2673196171565252609"></iframe></section><h3><span>一、理解回归</span></h3><section>回归主要关注确定一个唯一的因变量(需要预测的值)和一个或多个数值型自变量(预测变量)之间的关系。顾名思义，因变量取决于自变量或者预测变量的值。回归最简单的形式假设因变量和自变量之间的关系遵循一条直线，即线性关系。如下图斜截式：y=a+bx。</section><section><img data-backh="176" data-backw="578" data-ratio="0.3041825095057034" data-src="https://mmbiz.qpic.cn/mmbiz_png/eBfvI7Ryx8cPxGRufctcobha9GiaOtdWVotrwLaBlxGyY64NM44pt3lavovHcuaTktF64W0U27mpiavHX9kjOBgw/640?wx_fmt=png" data-type="png" data-w="1315" src="https://mmbiz.qpic.cn/mmbiz_png/eBfvI7Ryx8cPxGRufctcobha9GiaOtdWVotrwLaBlxGyY64NM44pt3lavovHcuaTktF64W0U27mpiavHX9kjOBgw/640?wx_fmt=png"></section><p>回归方程的使用类似于于斜截式的形式对数据建立模型。该机器学习算法的工作就是确定a和b，从而使指定的直线最适合用来放映所提供x值和y值之间的关系。回归分析通常用来对数据元素之间的复杂关系建立模型，用来估计一种处理方法对结果的影响和推断未来。在本次学习中，我们只关注最基本的<strong>线性回归</strong>模型，即那些使用直线回归的模型。当只有一个单一的自变量时，就是所谓的<strong>简单线性回归</strong>。在两个或两个以上自变量的情况下，称为<strong>多元线性回归</strong>，或者简称为称为多元回归。这两种技术都假设因变量是以一种连续的尺度测量的。<br></p><h3><span>二、简单线性回归</span></h3><p>为了表明较低发射温度会导致航天飞机零件损害几率增加，科学家使用之前23次航天飞机的发射温度与零件事故的数据。如散点图：<br></p><section><img data-galleryid="" data-ratio="0.26970560303893637" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/eBfvI7Ryx8cPxGRufctcobha9GiaOtdWVt5RjVehRMOzl1Biauicibposjx0yjI4icm6GhQu0yFxB0J1UpOWSW8m7Pw/640?wx_fmt=png" data-type="png" data-w="1053" src="https://mmbiz.qpic.cn/mmbiz_png/eBfvI7Ryx8cPxGRufctcobha9GiaOtdWVt5RjVehRMOzl1Biauicibposjx0yjI4icm6GhQu0yFxB0J1UpOWSW8m7Pw/640?wx_fmt=png"></section><p>研究该图，可以发现明显的趋势。在较高温度发射时，事故几乎不会发生。而当温度最低时，有两次事故发生由此可见，安排航天飞机在低于20度的温度下进行发射是令人担忧的。但我们究竟应该有多大的担忧呢？要回答这个问题，我们可以构建一个简单线性回归。<br></p><p>如上如右图所示，我们对于航天飞机发射数据中回归方程的系数估计为:a=3.70，b=-0.048。因此，完整的线性方程为:y=3.70-0.048x。先不管这些数字是如何得到的，我们可以在散点图中画出这条直线。这样我们就可以估计出在不同温度下事故发生的概率。</p><h3><span>三、普通最小二乘估计</span></h3><p>为了确定a和b的最优估计值，可使用一种称为<strong>普通最小二乘</strong>(OLS)的估计方法。在OLS 回归中，斜率和截距的选择要使得误差(即y的预测值与y的真实值之间的垂直距离)的平方和最小。这些误差称为<strong>残差</strong>，可通过下图中的几个点来说明:</p><section><img data-galleryid="" data-ratio="0.41509433962264153" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/eBfvI7Ryx8cPxGRufctcobha9GiaOtdWVtr0FRaenzfSO3HDfcY9licDYIzyU1bKjwUbk0ThgOw8JtC9PHvc9Ydg/640?wx_fmt=png" data-type="png" data-w="689" src="https://mmbiz.qpic.cn/mmbiz_png/eBfvI7Ryx8cPxGRufctcobha9GiaOtdWVtr0FRaenzfSO3HDfcY9licDYIzyU1bKjwUbk0ThgOw8JtC9PHvc9Ydg/640?wx_fmt=png"></section><section><img data-galleryid="" data-ratio="0.11330698287220026" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/eBfvI7Ryx8cPxGRufctcobha9GiaOtdWVBzVYWLkRib8KXw0z3dYR5BAHKPggr1PutcRI3yvx8o9sic8MJQaDFgvg/640?wx_fmt=png" data-type="png" data-w="759" src="https://mmbiz.qpic.cn/mmbiz_png/eBfvI7Ryx8cPxGRufctcobha9GiaOtdWVBzVYWLkRib8KXw0z3dYR5BAHKPggr1PutcRI3yvx8o9sic8MJQaDFgvg/640?wx_fmt=png"></section><p>用通俗易懂的语言来说，这个方程定义了e(误差)为真实值y和预测的y值之间的差值需要将数据中的所有点的误差值平方并求和。a的解取决于b的值，它可以由以下公式获得：</p><section><img data-galleryid="" data-ratio="0.1875" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/eBfvI7Ryx8cPxGRufctcobha9GiaOtdWVxTVa5eGHUNaQMLiasgjEUjrk6BAZibJpPIbBu6vwo7xDsM10tohvJjlw/640?wx_fmt=png" data-type="png" data-w="272" src="https://mmbiz.qpic.cn/mmbiz_png/eBfvI7Ryx8cPxGRufctcobha9GiaOtdWVxTVa5eGHUNaQMLiasgjEUjrk6BAZibJpPIbBu6vwo7xDsM10tohvJjlw/640?wx_fmt=png"></section><section>通过演算来证明使平方误差最小的b的值为:</section><section><img data-galleryid="" data-ratio="0.17763157894736842" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/eBfvI7Ryx8cPxGRufctcobha9GiaOtdWVVR1gX5RgtVBhwUoy2RicSC57rZZhpzApKiajkWue8nEO4Brk3pL3eo5w/640?wx_fmt=png" data-type="png" data-w="456" src="https://mmbiz.qpic.cn/mmbiz_png/eBfvI7Ryx8cPxGRufctcobha9GiaOtdWVVR1gX5RgtVBhwUoy2RicSC57rZZhpzApKiajkWue8nEO4Brk3pL3eo5w/640?wx_fmt=png"></section><section>如果我们将该公式分解为其组分，我们就可以将其简化。b 值的分母应该看起来很熟悉，它与x的方差很相似，方差用 Var(x)表示。方差涉及求x与其均值的平均平方偏差，可以表示为:</section><section><img data-galleryid="" data-ratio="0.1425531914893617" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/eBfvI7Ryx8cPxGRufctcobha9GiaOtdWVrgQ8LdrczFzGRh3DkneHCc2FOgJwasYNsxTSY9UWRSFEc5icDUfs5xA/640?wx_fmt=png" data-type="png" data-w="470" src="https://mmbiz.qpic.cn/mmbiz_png/eBfvI7Ryx8cPxGRufctcobha9GiaOtdWVrgQ8LdrczFzGRh3DkneHCc2FOgJwasYNsxTSY9UWRSFEc5icDUfs5xA/640?wx_fmt=png"></section><section>分子涉及求每个数据点中x与其均值的偏差乘以与其均值的偏差的乘积之和，这与x和y的协方差函数相似，表示为 Cov(x,y)。协方差计算公式为:</section><section><img data-galleryid="" data-ratio="0.1673728813559322" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/eBfvI7Ryx8cPxGRufctcobha9GiaOtdWVgMviaPzHqQic6VEKK2WyvnZBUlNVUvkPUg5ZA6Vfjred0uSOcrTcw0Pw/640?wx_fmt=png" data-type="png" data-w="472" src="https://mmbiz.qpic.cn/mmbiz_png/eBfvI7Ryx8cPxGRufctcobha9GiaOtdWVgMviaPzHqQic6VEKK2WyvnZBUlNVUvkPUg5ZA6Vfjred0uSOcrTcw0Pw/640?wx_fmt=png"></section><section>如果我们用协方差函数除以方差函数，项n就消掉了，则值的公式可以重新写成：</section><section><img data-galleryid="" data-ratio="0.29310344827586204" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/eBfvI7Ryx8cPxGRufctcobha9GiaOtdWVjMxicib4PC6icluN9fZ9rql7OXFDp0pibiaYMOx4pkCwOTGLxKX3KqAs35w/640?wx_fmt=png" data-type="png" data-w="290" src="https://mmbiz.qpic.cn/mmbiz_png/eBfvI7Ryx8cPxGRufctcobha9GiaOtdWVjMxicib4PC6icluN9fZ9rql7OXFDp0pibiaYMOx4pkCwOTGLxKX3KqAs35w/640?wx_fmt=png"></section><p>以上方法是手工计算b值的过程，但这种方式并不便捷，可不需理解。在R语言可直接通过cov()和var()函数来实现。<br></p><p>接着我们通过分析下相关性系数来了解温度与航天飞机发生事故间的关系。两个变量之间的相关系数(correlation)是一个数，它表示两个变量服从一条直线的关系有多么紧密。如果没有其他的限制，相关系数通常就是指 Pearson 相关系数。相关系数的范围在-1~+1之间，两端的值表示一个完美的线性关系，而相关系数接近于零则表示不存在线性关系下面的公式定义了Pearson相关系数:</p><section><img data-galleryid="" data-ratio="0.18313953488372092" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/eBfvI7Ryx8cPxGRufctcobha9GiaOtdWVdpmppPJxMhhO6WK64fGr0XtjqklGyracqqoQA5L52Iz7kVfDsNyf5w/640?wx_fmt=png" data-type="png" data-w="344" src="https://mmbiz.qpic.cn/mmbiz_png/eBfvI7Ryx8cPxGRufctcobha9GiaOtdWVdpmppPJxMhhO6WK64fGr0XtjqklGyracqqoQA5L52Iz7kVfDsNyf5w/640?wx_fmt=png"></section><p>使用这个公式，我们可以计算发射温度和航天飞机事故数之间的相关系数。我们知道协方差函数为 cov()，标准差函数为 sd()。我们将结果存储在中，r通常用来表示估计的相关系数:</p><section><img data-ratio="0.2001763668430335" data-src="https://mmbiz.qpic.cn/mmbiz_png/eBfvI7Ryx8cPxGRufctcobha9GiaOtdWVYolpuYDh8tnuoI5ZrOSK4IXTkUrnoDJ8cTaBPyaYJm19dBXVYfOEJQ/640?wx_fmt=png" data-type="png" data-w="1134" src="https://mmbiz.qpic.cn/mmbiz_png/eBfvI7Ryx8cPxGRufctcobha9GiaOtdWVYolpuYDh8tnuoI5ZrOSK4IXTkUrnoDJ8cTaBPyaYJm19dBXVYfOEJQ/640?wx_fmt=png"></section><section>此外，我们也可以使用R的相关性系数函数cox()来计算：<br><img data-ratio="0.14735658042744657" data-src="https://mmbiz.qpic.cn/mmbiz_png/eBfvI7Ryx8cPxGRufctcobha9GiaOtdWVm2L6jQCaEic8emibw2E0Swan4aSeiaInOTIWxaN11Jiay2wmibhsTgLJMSA/640?wx_fmt=png" data-type="png" data-w="889" src="https://mmbiz.qpic.cn/mmbiz_png/eBfvI7Ryx8cPxGRufctcobha9GiaOtdWVm2L6jQCaEic8emibw2E0Swan4aSeiaInOTIWxaN11Jiay2wmibhsTgLJMSA/640?wx_fmt=png"></section><h3><span>四、多元线性回归</span></h3><p>大多数现实世界的分析不止一个自变量。因此，对于更多的数值预测任务，你将很可能使用多元线性回归(multiple linear regression)。多元线性回归的优点和缺点如下表所示。</p><section><img data-galleryid="" data-ratio="0.21768202080237742" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/eBfvI7Ryx8cPxGRufctcobha9GiaOtdWVia3bOVialPkibMOMXjIWTicv15dibiay6wibgybokf7AEynS5rRBuicbWKGryQ/640?wx_fmt=png" data-type="png" data-w="1346" src="https://mmbiz.qpic.cn/mmbiz_png/eBfvI7Ryx8cPxGRufctcobha9GiaOtdWVia3bOVialPkibMOMXjIWTicv15dibiay6wibgybokf7AEynS5rRBuicbWKGryQ/640?wx_fmt=png"></section><p>我们可以将多元回归作为简单线性回归的扩展来理解。在这两种回归中，目标是相似的一一求出系数P的值和最大限度减小线性方程的预测误差。主要区别是增加的自变量需要额外的项。多元回归方程一般遵循下述方程的形式。因变量y是截距项a加上每一个特征i的b估计值与x值的乘积。这里已加入误差项作为一种提示，即这些预测并不完美，这代表前面所提到的残差项。</p><section><img data-galleryid="" data-ratio="0.109375" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/eBfvI7Ryx8cPxGRufctcobha9GiaOtdWVT5qzR61qPTMmmR0hNlwpS5btSRB848ibKB49suhraRCGnibHPK3MlfdA/640?wx_fmt=png" data-type="png" data-w="512" src="https://mmbiz.qpic.cn/mmbiz_png/eBfvI7Ryx8cPxGRufctcobha9GiaOtdWVT5qzR61qPTMmmR0hNlwpS5btSRB848ibKB49suhraRCGnibHPK3MlfdA/640?wx_fmt=png"></section><p>为了估计回归参数的值，使用上述形式的回归方程必须将因变量，的每一个观测值与自变量x的观测值联系起来。下图说明了该结构: 可以看出，每个特征x都会对y有一个单独的影响。</p><section><img data-galleryid="" data-ratio="0.7112375533428165" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/eBfvI7Ryx8cPxGRufctcobha9GiaOtdWVegXL0h8PXlL2RbQTntaH36FNru9VibWyf3a6MIwUTYHFOmdOficSPbSQ/640?wx_fmt=png" data-type="png" data-w="703" src="https://mmbiz.qpic.cn/mmbiz_png/eBfvI7Ryx8cPxGRufctcobha9GiaOtdWVegXL0h8PXlL2RbQTntaH36FNru9VibWyf3a6MIwUTYHFOmdOficSPbSQ/640?wx_fmt=png"></section><p>使用下面的代码，我们可以创建一个名为 reg()的基本回归函数，该函数的输入参数为y和x，并返回一个估计的b系数向量。</p><section><img data-galleryid="" data-ratio="0.4206896551724138" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/eBfvI7Ryx8cPxGRufctcobha9GiaOtdWVfA8Xs6YoDATibsZyaq3tOm8V2mrmPvCu0GL8VfowFSlY1EonhztjicXA/640?wx_fmt=png" data-type="png" data-w="580" src="https://mmbiz.qpic.cn/mmbiz_png/eBfvI7Ryx8cPxGRufctcobha9GiaOtdWVfA8Xs6YoDATibsZyaq3tOm8V2mrmPvCu0GL8VfowFSlY1EonhztjicXA/640?wx_fmt=png"></section><h3><span>五、线性模型回归的R语言实现</span></h3><p>为了用R对数据拟合一个线性回归模型，可以使用 lm() 函数。该函数包含在 stats添加包中，当你安装R软件时，该添加包就应该默认安装并在R启动时自动载人。函数lm()的语法如下所示:</p><section><img data-ratio="0.5038684719535783" data-src="https://mmbiz.qpic.cn/mmbiz_png/eBfvI7Ryx8cPxGRufctcobha9GiaOtdWVHe4MbCCtzeibAQ1U3LYXoy5tMqfl0oPMzOhibibw5cbVw2m3N33yv5mOQ/640?wx_fmt=png" data-type="png" data-w="1034" src="https://mmbiz.qpic.cn/mmbiz_png/eBfvI7Ryx8cPxGRufctcobha9GiaOtdWVHe4MbCCtzeibAQ1U3LYXoy5tMqfl0oPMzOhibibw5cbVw2m3N33yv5mOQ/640?wx_fmt=png"></section><section><img data-ratio="0.3533533533533533" data-src="https://mmbiz.qpic.cn/mmbiz_png/eBfvI7Ryx8cPxGRufctcobha9GiaOtdWVbGNrIoyHicplYVnnGjdppXnhIUzFObGp6pcxicV9YA6ibibOtP0KWyfV0w/640?wx_fmt=png" data-type="png" data-w="999" src="https://mmbiz.qpic.cn/mmbiz_png/eBfvI7Ryx8cPxGRufctcobha9GiaOtdWVbGNrIoyHicplYVnnGjdppXnhIUzFObGp6pcxicV9YA6ibibOtP0KWyfV0w/640?wx_fmt=png"></section><p>我们随机使用R语言中的数据集来进行预测，例如我们使用iris数据集，以“D”作为因变量，计算“A”,“B”,“C”的系数：<br></p><section><img data-ratio="0.3592814371257485" data-src="https://mmbiz.qpic.cn/mmbiz_png/eBfvI7Ryx8cPxGRufctcobha9GiaOtdWVd5Qo9REGm2KGYaKJRM35ZQgXL0JmPicGWlGDsYI98KKmNx6wp5o3ufQ/640?wx_fmt=png" data-type="png" data-w="835" src="https://mmbiz.qpic.cn/mmbiz_png/eBfvI7Ryx8cPxGRufctcobha9GiaOtdWVd5Qo9REGm2KGYaKJRM35ZQgXL0JmPicGWlGDsYI98KKmNx6wp5o3ufQ/640?wx_fmt=png"></section><section><img data-ratio="0.49058823529411766" data-src="https://mmbiz.qpic.cn/mmbiz_png/eBfvI7Ryx8cPxGRufctcobha9GiaOtdWVQMaLlLnUc189DXpAqF2a1x2D3FyiaQWfaM9X5xzuNaHSMlwkOicxhYEw/640?wx_fmt=png" data-type="png" data-w="850" src="https://mmbiz.qpic.cn/mmbiz_png/eBfvI7Ryx8cPxGRufctcobha9GiaOtdWVQMaLlLnUc189DXpAqF2a1x2D3FyiaQWfaM9X5xzuNaHSMlwkOicxhYEw/640?wx_fmt=png"></section><p>理解线性回归是比较简单的，截距相当于自变量值等于0时的预测值，系数则表示自变量改变1时对预测值的影响。</p><p><br></p><section>我们今天的分享就先到这里，我们下期再见！</section><section>本文参考：《机器学习与R语言》</section><section><br></section><section><section><section powered-by="xiumi.us"><p><strong>偷偷告诉你，我们在B站还有优质文章分享视频</strong><span></span></p></section></section></section><section><br></section><section><img data-galleryid="" data-ratio="1" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/eBfvI7Ryx8cPxGRufctcobha9GiaOtdWVpqE6kp6WF8DpKfHN06IGavqia6jexv5tgRibXicsGI2HapwHETBqJQx9w/640?wx_fmt=jpeg" data-type="jpeg" data-w="960" src="https://mmbiz.qpic.cn/mmbiz_jpg/eBfvI7Ryx8cPxGRufctcobha9GiaOtdWVpqE6kp6WF8DpKfHN06IGavqia6jexv5tgRibXicsGI2HapwHETBqJQx9w/640?wx_fmt=jpeg"></section><section>写在后面<br></section><section>医学僧的心愿是为医学僧的支持者和科研爱好者营造一个勤学好问、互帮互助、共同进步的优良环境。但是人多了难免鱼龙混杂，良莠不齐，群里不乏有真心实意、脚踏实地的科研人，我们很尊重并欢迎他们，因此不希望被少数来发广告的、划水的、看热闹的、占个坑的所打扰，最终我们的心意付之东流，大家的热情消磨殆尽。为了解决这个问题，我们决定提高入群的门槛——收费进群，这样，愿意进群的同志相信也是个圈内活跃用户，圈内人相互交流，岂不快哉！</section><section>因此，为了提升大家的效率，调动大家的积极性，吸收真正的科研爱好者，形成一个良好的学习交流氛围，我们决定增加群的数量，并细化群的功能，暂时增加以下几个主题群：</section><ul><li><section>文献下载-医学僧</section></li><li><section>机器学习（分类）-医学僧</section></li><li><section>ggplot可视化-医学僧</section></li><li><section>热图可视化-医学僧</section></li><li><section>TCGA挖掘-医学僧</section></li><li><section>GEO挖掘-医学僧</section></li><li><section>肿瘤预后模型-医学僧</section></li><li><section>肿瘤分子亚型-医学僧</section></li></ul><section><span>欢</span><span>迎小伙伴们进群👏👏👏，每个群收费15元。</span><span>请联系小编微信yixuesengkyrj或扫描下面二维码：</span><br></section><section><span></span></section><section><img data-galleryid="" data-ratio="0.8407407407407408" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/eBfvI7Ryx8enibib3UJd6iaLibROb1ibWJtZn0fyA9Bu9szdIkibpzWVzjw0LIVrQKeHfPS7h1gI8bicaaYlcOnMIyQAQ/640?wx_fmt=jpeg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" data-type="jpeg" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_jpg/eBfvI7Ryx8enibib3UJd6iaLibROb1ibWJtZn0fyA9Bu9szdIkibpzWVzjw0LIVrQKeHfPS7h1gI8bicaaYlcOnMIyQAQ/640?wx_fmt=jpeg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"><span></span></section><section><section><br></section></section><section><br></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/FbtHqGRXds4gf1fUV7bCEA",target="_blank" rel="noopener noreferrer">原文链接</a>
