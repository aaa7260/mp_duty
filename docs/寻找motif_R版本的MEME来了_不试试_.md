---
title: "寻找motif，R版本的MEME来了，不试试？"
date: 2023-01-06T03:15:17Z
draft: ["false"]
tags: [
  "fetched",
  "生信星球"
]
categories: ["Acdemic"]
---
寻找motif，R版本的MEME来了，不试试？ by 生信星球
------
<div><p><img data-ratio="1" data-src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHrLfDiavqTPmkMHiaIAkPgmZR9LERh1l5td8g2LicMYNcCHjh1ibIxqJys9neR8ibDH1IAzcxia9jrLP1tw/640?wx_fmt=png" data-type="png" data-w="20" width="20px" src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHrLfDiavqTPmkMHiaIAkPgmZR9LERh1l5td8g2LicMYNcCHjh1ibIxqJys9neR8ibDH1IAzcxia9jrLP1tw/640?wx_fmt=png"><img data-ratio="1" data-src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHrLfDiavqTPmkMHiaIAkPgmZRXmgtHtmB3L1qaPWfQYBIXPXWsv4xSThfiaveuJxFcribXCVia6S1Q5OWw/640?wx_fmt=png" data-type="png" data-w="20" width="20px" src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHrLfDiavqTPmkMHiaIAkPgmZRXmgtHtmB3L1qaPWfQYBIXPXWsv4xSThfiaveuJxFcribXCVia6S1Q5OWw/640?wx_fmt=png"><span> 今天是生信星球陪你的<span><strong>第809天</strong></span></span><img data-ratio="1" data-src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHrLfDiavqTPmkMHiaIAkPgmZR9LERh1l5td8g2LicMYNcCHjh1ibIxqJys9neR8ibDH1IAzcxia9jrLP1tw/640?wx_fmt=png" data-type="png" data-w="20" width="20px" src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHrLfDiavqTPmkMHiaIAkPgmZR9LERh1l5td8g2LicMYNcCHjh1ibIxqJys9neR8ibDH1IAzcxia9jrLP1tw/640?wx_fmt=png"><br></p><hr><p><span><span>   </span><span>大神一句话，菜鸟跑半年。我不是大神，但我可以缩短你走弯路的半年~</span></span></p><p><span><span>   就像歌儿唱的那样，如果你不知道该往哪儿走，就留在这学点生信好不好~</span></span></p><p><span>   这里有豆豆和花花的学习历程，从新手到进阶，生信路上有你有我！</span></p><section><blockquote><p>豆豆写于2021.4.28<br>会介绍MEME的用法，以及新的R版本使用，最后看看其他类似工具</p></blockquote><h3><span>什么是MEME？</span></h3><p>看他的官网：http://meme-suite.org/index.html，很清楚写着基于motif进行的一系列分析。</p><blockquote><p>在官网中找到的motif定义：<br>A motif is an approximate sequence pattern that occurs repeatedly in a group of related sequences.</p><p>关键词：大量重复出现；短序列，只是一段pattern</p></blockquote><p>当然，这段序列不局限于DNA，还可以是RNA或者氨基酸序列；并且它经常是具有序列特异性的结合位点（比如转录因子结合位点或者RNA剪切位点等）</p><p><img data-galleryid="" data-ratio="1.0331825037707392" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHpp5Au8nialxzG7HZ9DBuzErTX0UzPzdEva18r0BPHd6zj9TlCKjy9ywBXLOFQ9UrzXU9FI6kRfVkA/640?wx_fmt=png" data-type="png" data-w="1326" src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHpp5Au8nialxzG7HZ9DBuzErTX0UzPzdEva18r0BPHd6zj9TlCKjy9ywBXLOFQ9UrzXU9FI6kRfVkA/640?wx_fmt=png"></p><p>左侧列表就写出了它的<strong>五大功能</strong>：<br></p><ul><li><p><strong>Motif Discovery</strong>：预测序列上的motif信息，可以是DNA，RNA，氨基酸序列，方法是从头预测（de novo discovery）。比如我们ChIPseq数据拿到了一些peaks的区间，那么就能拿到序列，然后就能拿到序列中的motif</p></li><ul><li><p><strong>MEME</strong>: Multiple EM for Motif Elicitation, 利用de novo预测得到motif结构和在输入序列上的位置</p></li><li><p><strong>DREME</strong>: Discriminative Regular Expression Motif Elicitation, 主要针对长度在100bp左右的序列</p></li><li><p><strong>STREME</strong>: Sensitive, Thorough, Rapid, Enriched Motif Elicitation，它是DREME的替代版，特点是基于的序列数量多（多于50个）</p></li><li><p><span>MEME-ChIP</span></p></li><li><p><span>GLAM2</span></p></li><li><p><span>MoMo</span></p></li></ul><li><p><strong>Motif Enrichment</strong>：分析已知的motif在我们的序列上有没有，有多少？</p></li><ul><li><p><span>CentriMo</span></p></li><li><p><span>AME</span></p></li><li><p><span>AME</span></p></li><li><p><span>SpaMo</span></p></li></ul><li><p><strong>Motif Scanning</strong>：分析我们序列上可能出现motif的位置是？</p></li><ul><li><p><span>FIMO</span></p></li><li><p><span>MAST</span></p></li><li><p><span>MCAST</span></p></li></ul><li><p><strong>Motif Comparison</strong>：不同motif之间的相似性有多少？</p></li><ul><li><p><span>Tomtom</span></p></li></ul><li><p><strong>Gene Regulation</strong>：预测基因和调控元件（用染色体区域表示）之间的调控关系</p></li></ul><p><img data-galleryid="" data-ratio="0.5110782865583456" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHpp5Au8nialxzG7HZ9DBuzEr3UkVQclFXsBQb8WnIqFEa7OrBHD40oIkn93W2icqUlkBAk6GVnfZTJA/640?wx_fmt=png" data-type="png" data-w="1354" src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHpp5Au8nialxzG7HZ9DBuzEr3UkVQclFXsBQb8WnIqFEa7OrBHD40oIkn93W2icqUlkBAk6GVnfZTJA/640?wx_fmt=png"></p><p>但它的缺点就是：它作为一个网页工具，但略显繁琐，限制了使用人群</p><h3><span>新的R版本怎么用？</span></h3><blockquote><p>官方文档在：https://snystrom.github.io/memes-manual/</p></blockquote><p>今天看到一个推文，发现有了R版本的支持，作者还发了篇文章：<br>Memes: an R interface to the MEME Suite<br>（https://www.biorxiv.org/content/10.1101/2021.04.23.441089v1）</p><blockquote><p>In addition to interfacing with popular MEME Suite tools, <strong>memes leverages existing R/Bioconductor data structures</strong> to store the complex, multidimensional data returned by MEME Suite tools for rapid data access and manipulation.</p></blockquote><figure><img data-ratio="1.154103852596315" data-src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHpp5Au8nialxzG7HZ9DBuzErNgS08kRkwog48PPRC6mKYoKRuwaFAzUwibKmBNm3z74LoIIwdMJ1eLw/640?wx_fmt=png" data-type="png" data-w="1194" title="" src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHpp5Au8nialxzG7HZ9DBuzErNgS08kRkwog48PPRC6mKYoKRuwaFAzUwibKmBNm3z74LoIIwdMJ1eLw/640?wx_fmt=png"></figure><h4><span>首先安装R包</span></h4><p>现在这个R包应该还是在开发版，需要R 4.1以上才可以。我于是下载了R 4.2和4.1安装试一下，<strong>结果失败😝</strong></p><p>不过没关系，先把安装代码放在这里，毕竟过些日子出了正式版4.1就可以了 <span>（R 4.1 scheduled for Tuesday 2021-05-18）</span></p><pre><code><span># 需要：Bioconductor version: Development (3.13)</span><br><span># Bioconductor version '3.13' requires R version '4.1'</span><br><br><span># 使用R 4.1 及以上版本</span><br><span>if</span> (!requireNamespace(<span>"remotes"</span>, quietly=<span>TRUE</span>))<br>    install.packages(<span>"remotes"</span>)<br>remotes::install_github(<span>"snystrom/memes"</span>)<br></code></pre><h4><span>R包需要本地MEME套件（for Linux, OS X and Cygwin systems)</span></h4><blockquote><p>不得不说，安装过程都这么繁琐，确实影响了使用者心情</p></blockquote><pre><code><span>#</span><span> 下载， 在 https://meme-suite.org/doc/download.html/ 找版本</span><br><span>#</span><span> 安装</span><br>tar zxf meme-5.3.3.tar.gz<br>cd meme-5.3.3<br>./configure --prefix=$HOME/meme --enable-build-libxml2 --enable-build-libxslt<br>make<br>make test<br>make install<br><span>#</span><span> 最后添加环境变量</span><br>export PATH=$HOME/meme/bin:$HOME/meme/libexec/meme-5.3.3:$PATH<br><span><br>#</span><span> 这个倒是安装成功了，耗时约10min</span><br></code></pre><p>如果之后安装成功了，那么就继续运行：</p><h4><span>先来一个检测步骤</span></h4><pre><code><span>library</span>(memes)<br>check_meme_install()<br><span>#&gt; checking main install</span><br><span>#&gt; ✓ /opt/meme/bin</span><br><span>#&gt; checking util installs</span><br><span>#&gt; ✓ /opt/meme/bin/dreme</span><br><span>#&gt; ✓ /opt/meme/bin/ame</span><br><span>#&gt; ✓ /opt/meme/bin/fimo</span><br><span>#&gt; ✓ /opt/meme/bin/tomtom</span><br><span>#&gt; ✓ /opt/meme/bin/meme</span><br><span># 或者可以指定路径</span><br>check_meme_install(meme_path = <span>'bad/path'</span>)<br></code></pre><p>核心的函数有：</p><figure><img data-ratio="0.3624413145539906" data-src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHpp5Au8nialxzG7HZ9DBuzErDwDA3icquiaSY0qdY4mlFFbSSgFabDM4FHXe9ScRCN5OzH2qJjQicQ15w/640?wx_fmt=png" data-type="png" data-w="2130" title="" src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHpp5Au8nialxzG7HZ9DBuzErDwDA3icquiaSY0qdY4mlFFbSSgFabDM4FHXe9ScRCN5OzH2qJjQicQ15w/640?wx_fmt=png"></figure><h4><span>DREME寻找motif</span></h4><pre><code>suppressPackageStartupMessages(<span>library</span>(magrittr))<br>suppressPackageStartupMessages(<span>library</span>(GenomicRanges))<br><br><span># 拿到peaks</span><br>data(<span>"example_peaks"</span>, package = <span>"memes"</span>)<br><span># 拿到基因组</span><br>dm.genome &lt;- BSgenome.Dmelanogaster.UCSC.dm6::BSgenome.Dmelanogaster.UCSC.dm6<br><br><span># Generate sequences from 200bp about the center of my peaks of interest</span><br>sequences &lt;- example_peaks %&gt;% <br>  resize(<span>200</span>, <span>"center"</span>) %&gt;% <br>  get_sequence(dm.genome)<br><br><span># 最后运行dreme</span><br><span># runDreme() accepts XStringSet or a path to a fasta file as input.</span><br><span># In a real analysis, e should typically be &lt; 1</span><br>dreme_results &lt;- runDreme(sequences, control = <span>"shuffle"</span>, e = <span>50</span>)<br><br><span># 展示结果</span><br><span>library</span>(universalmotif)<br>dreme_results %&gt;% <br>  to_list() %&gt;% <br>  view_motifs()<br></code></pre><figure><img data-ratio="0.7142857142857143" data-src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHpp5Au8nialxzG7HZ9DBuzErbHrAIOBNJt9u4tnUNXLqxMe6TCx0FdgP2zhSr45cURfBEyv9iatT3pw/640?wx_fmt=png" data-type="png" data-w="672" title="" src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHpp5Au8nialxzG7HZ9DBuzErbHrAIOBNJt9u4tnUNXLqxMe6TCx0FdgP2zhSr45cURfBEyv9iatT3pw/640?wx_fmt=png"></figure><h4><span>TOMTOM比较motif</span></h4><pre><code><span># Discovered motifs can be matched to known TF motifs using runTomTom()</span><br><br><span># TomTom uses a database of known motifs which can be passed to the database parameter as a path to a .meme format file, or a universalmotif object.</span><br><span># 可以指定数据库：</span><br><span># options(meme_db = system.file("extdata/flyFactorSurvey_cleaned.meme", package = "memes"))</span><br><br>full_results &lt;- dreme_results %&gt;% <br>  runTomTom()<br><span># 可视化结果</span><br>full_results %&gt;% <br>  view_tomtom_hits(top_n = <span>1</span>)<br></code></pre><figure><img data-ratio="0.7142857142857143" data-src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHpp5Au8nialxzG7HZ9DBuzErdRSib3GzibZuWscBYGTfibo3ALA58gDTUYrGwXXt2UKX0vzqjadEdsSOA/640?wx_fmt=png" data-type="png" data-w="672" title="" src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHpp5Au8nialxzG7HZ9DBuzErdRSib3GzibZuWscBYGTfibo3ALA58gDTUYrGwXXt2UKX0vzqjadEdsSOA/640?wx_fmt=png"></figure><h4><span>AME富集motif</span></h4><pre><code><span># AME is used to test for enrichment of known motifs in target sequences</span><br><span># 同样也是需要数据库的</span><br><span># options(meme_db = "path/to/database.meme")</span><br><br>ame_results &lt;- runAme(sequences, control = <span>"shuffle"</span>, evalue_report_threshold = <span>30</span>)<br>ame_results<br><span>#&gt; # A tibble: 2 x 17</span><br><span>#&gt;    rank motif_db motif_id motif_alt_id consensus  pvalue adj.pvalue evalue tests</span><br><span>#&gt;   &lt;int&gt; &lt;chr&gt;    &lt;chr&gt;    &lt;chr&gt;        &lt;chr&gt;       &lt;dbl&gt;      &lt;dbl&gt;  &lt;dbl&gt; &lt;int&gt;</span><br><span>#&gt; 1     1 /usr/lo… Eip93F_… Eip93F       ACWSCCRA… 5.14e-4     0.0339   18.8    67</span><br><span>#&gt; 2     2 /usr/lo… Cf2-PB_… Cf2          CSSHNKDT… 1.57e-3     0.0415   23.1    27</span><br><span>#&gt; # … with 8 more variables: fasta_max &lt;dbl&gt;, pos &lt;int&gt;, neg &lt;int&gt;,</span><br><span>#&gt; #   pwm_min &lt;dbl&gt;, tp &lt;int&gt;, tp_percent &lt;dbl&gt;, fp &lt;int&gt;, fp_percent &lt;dbl&gt;</span><br><br><span># 可视化结果</span><br>ame_results %&gt;% <br>  plot_ame_heatmap()<br></code></pre><figure><img data-ratio="0.6" data-src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHpp5Au8nialxzG7HZ9DBuzErfcgJAViaQbVKZgTgzavULR7QlGibLDFlu02KJxpYhLzibeTiaRFxic2InZg/640?wx_fmt=png" data-type="png" data-w="480" title="" src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHpp5Au8nialxzG7HZ9DBuzErfcgJAViaQbVKZgTgzavULR7QlGibLDFlu02KJxpYhLzibeTiaRFxic2InZg/640?wx_fmt=png"></figure><h4><span>FIMO分析motif出现的位置</span></h4><p><code>MotifDb</code>的使用方法:<br>https://bioconductor.org/packages/release/bioc/vignettes/MotifDb/inst/doc/MotifDb.html 以及 https://rdrr.io/bioc/MotifDb/man/MotifDb.html</p><pre><code><span>#</span><span> MotifDb</span><br><span><br>#</span><span> The matrices are obtained from six public sources:</span><br>FlyFactorSurvey:    614<br>hPDI:    437<br>JASPAR_CORE:    459<br>jolma2013:    843<br>ScerTF:    196<br>stamlab:    683<br>UniPROBE:    380<br>cisbp 1.02    874<br><span><br>#</span><span> Representing primarily five organsisms (and 49 total)</span><br>Hsapiens:    2328<br>Dmelanogaster:    1008<br>Scerevisiae:    701<br>Mmusculus:    660<br>Athaliana:    160<br>Celegans:    44<br>other:    177<br></code></pre><p>继续看FIMO的使用：</p><pre><code><span># Query MotifDb for a motif</span><br>e93_motif &lt;- MotifDb::query(MotifDb::MotifDb, <span>"Eip93F"</span>) %&gt;% <br>  universalmotif::convert_motifs()<br><br><span># Scan for the E93 motif within given sequences</span><br>fimo_results &lt;- runFimo(sequences, e93_motif, thresh = <span>1e-3</span>)<br><br><span># 可视化</span><br>plot_sequence_heatmap(fimo_results$matched_sequence)  <br></code></pre><figure><img data-ratio="1.3333333333333333" data-src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHpp5Au8nialxzG7HZ9DBuzEr2789d6iaoJTumJp4v320QicerXmyXby8cG7RPicBBApzR2kSlfeQ8wQSQ/640?wx_fmt=png" data-type="png" data-w="288" title="" src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHpp5Au8nialxzG7HZ9DBuzEr2789d6iaoJTumJp4v320QicerXmyXby8cG7RPicBBApzR2kSlfeQ8wQSQ/640?wx_fmt=png"></figure><h4><span>还支持导入MEME网页工具的结果</span></h4><figure><img data-ratio="0.594758064516129" data-src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHpp5Au8nialxzG7HZ9DBuzErWqiaNZDKlBuoaz7mvOu4ficrBGTNHBAbibannb2YHR2zaTia8J9KJDVHjw/640?wx_fmt=png" data-type="png" data-w="992" title="" src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHpp5Au8nialxzG7HZ9DBuzErWqiaNZDKlBuoaz7mvOu4ficrBGTNHBAbibannb2YHR2zaTia8J9KJDVHjw/640?wx_fmt=png"></figure><h3><span>最后，工具绝对不止一种</span></h3><p>比如motif分析，http://veda.cs.uiuc.edu/MET/links.html这里列出了一些：</p><figure><img data-ratio="0.3595608417200366" data-src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHpp5Au8nialxzG7HZ9DBuzErnfYX1VOkpaGSKiaZ2aJGEDFvR1HKXhyt6jKuT9TjE96jF9z6gar1pHQ/640?wx_fmt=png" data-type="png" data-w="2186" title="" src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHpp5Au8nialxzG7HZ9DBuzErnfYX1VOkpaGSKiaZ2aJGEDFvR1HKXhyt6jKuT9TjE96jF9z6gar1pHQ/640?wx_fmt=png"></figure><p>另外，<strong>常用的homer也支持</strong>，例如之前技能树发布的：Homer软件的介绍-最全面而详细的找motif教程</p><pre><code><span>#</span><span> 安装方法1：</span><br>conda install -c bioconda homer<br><span>#</span><span> 这个路径需要自己修改</span><br>perl ~/miniconda3/pkgs/homer-4.10-pl526hc9558a2_0/share/homer-4.10-0/configureHomer.pl -install hg19<br><span>#</span><span> 最后数据下载到</span><br>ls ~/miniconda3/pkgs/homer-4.10-pl526hc9558a2_0/share/homer-4.10-0/data/<br><span><br>#</span><span><span># 安装方法2：</span></span><br>cd ~/biosoft<br>mkdir homer &amp;&amp;  cd homer<br>wget http://homer.salk.edu/homer/configureHomer.pl <br>perl configureHomer.pl -install hg19<br><span><br>#</span><span> 准备数据: 第一列: 染色体; 第二列: 起始位置; 第三列: 终止位置; 第四列: 链的方向</span><br>awk '{print $4"    "$1"   "$2"   "$3"   +"}' macs_peaks.bed &gt;sample_homer.bed<br><span><br>#</span><span> 运行(在基因组区域中寻找富集Motifs)</span><br>findMotifsGenome.pl sample_homer.bed hg19 sample_homer_motifDir -len 8,10,12<br><span>#</span><span> 参数解释</span><br><span>#</span><span> -输入文件：awk处理好的Homer Peak/Positions file</span><br><span>#</span><span> -参考基因组：这里是hg19</span><br><span>#</span><span> -输出文件：给一个路径和输出文件的名字</span><br><span>#</span><span> -len：motif大小设置，默认8,10,12；越大需要的计算资源越多</span><br></code></pre><p><strong>哈佛的课程</strong>选择了MEME的<code>DREME</code>工具：https://hbctraining.github.io/Intro-to-ChIPseq/lessons/12_functional_analysis.html</p><blockquote><p>DREME is a motif discovery algorithm designed to find short, core DNA-binding motifs of eukaryotic transcription factors and is optimized to handle large ChIP-seq data sets.<br>DREME is tailored to eukaryotic data by focusing on <strong>short motifs (4 to 8 nucleotides)</strong> encompassing the DNA-binding region of most eukaryotic monomeric transcription factors.</p></blockquote><p>现在MEME更新了，用<code>STREME</code> 取代了之前的<code>DREME</code></p><p>还有一个<code>MEME-ChIP</code> ：</p><blockquote><p><strong>MEME-ChIP performs DREME and Tomtom analysis</strong> in addition to using tools to assess which motifs are most centrally enriched (motifs should be centered in the peaks) and to combine <strong>related motifs into similarity clusters.</strong> <br>It is able to identify <strong>longer motifs &lt; 30bp</strong>, but takes much longer to run.</p></blockquote><p><strong>去年还发布了一个不基于peaks的工具</strong>：NoPeak: k-mer-based motif discovery in ChIP-Seq data without peak calling （Bioinformatics, btaa845, https://doi.org/10.1093/bioinformatics/btaa845， 29 September 2020）</p><blockquote><p>Here, we present a novel approach to reliably identify transcription factor-binding motifs from ChIP-Seq data <strong>without peak detection</strong>. By evaluating the <strong>distributions of sequencing reads around the different k-mers in the genome,</strong> we are able to identify binding motifs in ChIP-Seq data that yield no results in traditional pipelines.</p></blockquote><p>还有其他<strong>基于R的工具</strong>：</p><p>rGADEM (motif discovery):<br> http://bioconductor.org/packages/devel/bioc/html/rGADEM.html</p><p>MotIV (motif validation):<br> http://bioconductor.org/packages/devel/bioc/html/MotIV.html</p></section><section><hr></section><p><strong><span>点击底部的“阅读原文”，获得更好的阅读体验哦</span></strong><span>😻</span></p><p><span><strong><span>初学生信，很荣幸带你迈出第一步</span></strong></span><br></p><p><span><strong>🤓</strong></span><strong><span>生信星球 </span></strong><span><strong>🌎</strong></span><span><span><strong>~ </strong></span><strong><span>一个不拽术语、通俗易懂的生信知识平台</span></strong></span></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/BqpzGZQsquwM7T73HEXDOg",target="_blank" rel="noopener noreferrer">原文链接</a>
