---
title: "回归分析的多重共线性现象诊断与正确处理姿势"
date: 2022-09-23T10:30:58Z
draft: ["false"]
tags: [
  "fetched",
  "医学论文与统计分析"
]
categories: ["Acdemic"]
---
回归分析的多重共线性现象诊断与正确处理姿势 by 医学论文与统计分析
------
<div><p> </p><p><img data-copyright="0" data-ratio="0.31238095238095237" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/RXNgfngwAeZCRfibaMxe4uiagAuZu0KNtxlicI7yAhl4sYUGiavqKucdF7pKcdUneR2xXapxKNMVya9KR1PZcAIDoA/640?wx_fmt=png" data-type="png" data-w="1050" src="https://mmbiz.qpic.cn/mmbiz_png/RXNgfngwAeZCRfibaMxe4uiagAuZu0KNtxlicI7yAhl4sYUGiavqKucdF7pKcdUneR2xXapxKNMVya9KR1PZcAIDoA/640?wx_fmt=png"></p><p><strong><span><br></span></strong></p><p><strong><span>“如何分析真实世界研究”系列（12）</span></strong><br></p><p><br></p><p><span>回归诊断中，多重共线性问题的识别与处理也是重要的内容.</span></p><p><span> </span></p><p><span>多重共线性</span><span>（</span><span><span>Multicollinearity</span><span>）是指回归模型中的解释变量之间由于存在较精确相关关系或高度相关关系而使模型估计失真或难以估计准确。完全共线性的情况并不多见，一般出现的是在一定程度上的共线性，即近似共线性。</span></span></p><p><span><strong><span></span></strong></span></p><section><section><h2 placeholder="请输入标题"></h2><p><strong><span>1.多重共线性现象</span></strong></p></section></section><p><span>多重共线性的出现，将会导致以下一些现象：<br></span></p><p><span>1）增加或者剔除一个自变量，或者是改变一个观测值，回归系数的估计值发生较大变化；</span></p><p><span>2）一些被认为具有统计学意义自变量在回归方程的假设检验中未能通过；</span></p><p><span>3）当回归方程中一些自变量的系数所带的正负号与理论推断的结果相违背；</span></p><p><span>4）当一些重要的自变量的回归系数的标准误差较大；</span></p><p><span>5）线性回归模型总体检验具有统计学意义，但是没有一个自变量具有统计学差异；</span></p><p><span>6）样本量不小时，许多自变量单因素回归具有统计学意义，但多因素一个统计学意义也没有</span></p><p><span><strong><span></span></strong></span></p><section><section><h2 placeholder="请输入标题"></h2><p><strong><span>2.多重共线性诊断方法</span></strong></p></section></section><p><span>1</span><span>、相关性分析，相关系数高于</span><span>0.8</span><span>，表明存在多重共线性；但相关系数低，并不能表示不存在多重共线性。</span><strong><span>（线性回归、</span><span>logistic</span><span>和</span><span>COX</span><span>回归）</span></strong><span></span></p><p><span> </span></p><p><span>2</span><span>、容忍度（</span><span>tolerance</span><span>）与方差扩大因子（</span><span>VIF</span><span>）。某个自变量的容忍度等于</span><span>1</span><span>减去该自变量为因变量而其他自变量为预测变量时所得到的线性回归模型的判定系数。容忍度越小，多重共线性越严重。通常认为容忍度小于</span><span>0.1</span><span>时，存在严重的多重共线性。方差扩大因子等于容忍度的倒数。显然，</span><span>VIF</span><span>越大，多重共线性越严重。一般认为</span><span>VIF</span><span>大于</span><span>10</span><span>时，存在严重的多重共线性。<strong>（线性回归）</strong></span></p><p><span> </span></p><p><span>5.</span><span>条件数与特征分析法：在自变量的观测值构成的设计矩阵</span><span>X</span><span>中，求出变量相关系数</span><span>R</span><span>的特征值，如果某个特征值很小（如小于</span><span>0</span><span>．</span><span>05 </span><span>），或所有特征值的倒数之和为自变量数目的</span><span>5</span><span>倍以上，表明自变量间存在多重共线性关系。</span><strong><span>（线性回归、</span><span>logistic</span><span>和</span><span>COX</span><span>回归）</span></strong></p><p><strong><span><br></span></strong></p><p><strong><span>如何采用SPSS处理多重共线性，可以关注本公众号的视频</span></strong></p><p><iframe data-vidtype="2" data-mpvid="wxv_864655831357440002" data-cover="http%3A%2F%2Fmmbiz.qpic.cn%2Fmmbiz_jpg%2FRXNgfngwAebkfOuh9JylpWUicKWiac1MdTu6iaKqmOSicSkI0TGFiaKyJp4Bg7jthXbv8x6MTgp6xc5hOTFk2fIeclQ%2F0%3Fwx_fmt%3Djpeg" allowfullscreen="" frameborder="0" data-ratio="1.7777777777777777" data-w="1280" data-src="https://mp.weixin.qq.com/mp/readtemplate?t=pages/video_player_tmpl&amp;action=mpvideo&amp;auto=0&amp;vid=wxv_864655831357440002"></iframe></p><p><strong><span></span></strong><br></p><p><span><strong><span></span></strong></span></p><section><section><h2 placeholder="请输入标题"></h2><p><strong><span>3.多重共线性常规处理方法；</span></strong><strong><span></span></strong></p></section></section><p><span></span></p><p><span>总结起来，很多文献、教材、视频处理多重共线性方法包括以下若干种方法：</span></p><p><span>1</span><span>）增加样本容量：多重共线性问题的实质是样本信息的不充分而导致模型参数的不能精确估计，因此追加样本信息是解决该问题的一条有效途径。</span></p><p><span>2）</span><span>如果要在模型中保留所有的自变量，那就应该：避免根据</span><span>t</span><span>统计量对单个参数β进行检验；对因变量</span><span>y</span><span>值的推断限定在自变量样本值的范围内。</span></p><p><span>3）</span><span>删除一个或几个共线变量：实际操作中常用逐步法作为自变量筛选方法。</span></p><p><span>4）</span><span>岭回归法；岭回归法是通过最小二乘法的改进允许回归系数的有偏估计量存在而补救多重共线性的方法。</span></p><p><span>5）</span><span>主成分分析法。</span></p><p><span> </span></p><p><strong><span>但我认为，这些方法都是瞎处理方法，其实都不严谨！</span></strong></p><p><span><strong><span></span></strong></span></p><section><section><h2 placeholder="请输入标题"></h2><p><strong><span>4.多重共线性正确处理姿势</span></strong><strong><span></span></strong></p></section></section><p><span>很多人研究和处理多重共线性回归非常简单粗暴，采用的数据驱动的多重共线性处理方法，这些方法也就是上文提到的多重共线性常规处理方法是流行于教材的主要方法。但我认为上述的方法都属于简单粗暴的方法。因为上述方法都只考虑到了数据的相关性，而没有真正考虑到相关性背后的原因。所有的方法都是基于统计学原理产生，而非针对流行病学病因关系形成的，但是回归分析必须基于因果关系开展，否则就没有存在的意义了。</span></p><p><span> </span></p><p><strong><span>因此，这些方法都欠缺因果关系研究的灵魂</span></strong><span></span></p><p><span> </span></p><p><span>没有无缘无故的爱，也没有无缘无故的相关性。处理多重共线性，要从流行病学病因上介绍，为什么有些变量会有相关性？采用主成分降维或者逐步回归法减少自变量来强行消除相关性是否合适？</span></p><p><span> </span></p><p><span>自变量为什么会相关？这是多重共线性必须要考虑的问题？</span></p><p><span>诸位不妨来看看早期的论文所介绍的相关的主要形式（<a href="http://mp.weixin.qq.com/s?__biz=MzAwOTYyMDY3OQ==&amp;mid=2650379259&amp;idx=1&amp;sn=12974041074d4137907a525367f7eb60&amp;chksm=8351ee53b4266745272392ee9234861655673b742bb09292ce0910437d17b78c31fe644022bf&amp;scene=21#wechat_redirect" target="_blank" data-itemshowtype="0" data-linktype="2">真实世界数据分析（3）：基于DAG方法进行自变量的筛选</a>）</span><span></span></p><p><span> </span></p><p><strong><span>总结来说，自变量相关主要三种</span><span>可能：</span></strong><span></span></p><p><span>1）</span><span>因为有些变量是混杂因素，是自变量的原因变量</span></p><p><span>2）</span><span>因为有些变量是中介变量，是自变量的结局变量</span></p><p><span>3）</span><span>也有可能有些变量自是纯粹的相关关系</span></p><p><span> </span></p><p><span>我在之前的论文也说过，自变量回归，混杂因素必须纳入模型，而中介变量一定不能纳入模型（<a href="http://mp.weixin.qq.com/s?__biz=MzAwOTYyMDY3OQ==&amp;mid=2650379282&amp;idx=2&amp;sn=934552e96df9d75dbfd54cc8fdc1bd3b&amp;chksm=8351e9bab42660ac9b5a860470bcc1349b44af0189ab600f3ac955da57f4f3fbbd016cd8ae4f&amp;scene=21#wechat_redirect" target="_blank" data-itemshowtype="0" data-linktype="2">真实世界研究（4）：简单案例分析中介变量的影响</a>）。</span></p><p><span> </span></p><p><span>因此，如果数据采用逐步回归分析方法，情况就太粗暴。它只考虑模型构建的总体评价指标（</span><span>R平方</span><span>，</span><span>-2Ln，AIC，BIC</span><span>），它不管自变量谁重要、谁没有价值，不考虑病因研究中的各个自变量的角色。它可能混杂因素提早踢出局，或者把中介变量留到最后。无论哪种方式，都不能得到好的一个结果。</span></p><p><span> </span></p><p><span>如果你看到这里还明白我讲的意思，那么就很清楚接下来怎么做了？</span></p><p><span> </span></p><p><strong><span>当存在多重共线性时，应该认真分析研究变量与变量的关系及关系密切程度，根据</span><span>DAG</span><span>理论，手动剔除不重要、或者会干扰结果的自变量，再构建线性回归方程，至于是否采取逐步回归法已经不重要了。</span></strong><span></span></p><p><span> </span></p><p><strong><span>也就说，多重共线性的处理，必须遵从理论驱动的方法，而非数据驱动的方法。</span></strong></p><p><span><strong><span></span></strong><strong><span></span></strong></span></p><section><section><h2 placeholder="请输入标题"></h2><p><strong><span>5.什么时候不需要考虑多重共线性问题？</span></strong><strong><span></span></strong></p></section></section><p><span>1<span>）</span></span><span> </span><span>多重共线性是普遍存在的，轻微的多重共线性问题可不采取措施；</span></p><p><span>2<span>）</span></span><span> </span><span>如果模型仅用于预测，则只要拟合程度好，可不处理多重共线性问题，存在多重共线性的模型用于预测时，往往不影响预测结</span><span>。</span></p><p><strong><span> </span><span></span></strong></p><p><strong><span>更多精品阅读：</span><span><br></span></strong></p><p><span>1.</span><a href="http://mp.weixin.qq.com/s?__biz=MzAwOTYyMDY3OQ==&amp;mid=2650379697&amp;idx=1&amp;sn=590e1faa0ddcf38f2f4f61b0c05a6e96&amp;chksm=8351e819b426610f5861c933c881baa1358329bad679f962224ff5c3b9052c8f622c1afd38dd&amp;scene=21#wechat_redirect" target="_blank" data-itemshowtype="0" data-linktype="2"><span>怎么样才能在顶级医学杂志发表Meta论文？</span><span> 一起来解剖最新川大华西医院BMJ 杂志Meta分析报告</span></a><br></p><p><span>2.</span><a href="http://mp.weixin.qq.com/s?__biz=MzAwOTYyMDY3OQ==&amp;mid=2650379565&amp;idx=1&amp;sn=c1e02509d834c24dee8e5b0757e83911&amp;chksm=8351e885b42661935faebc76f954291b83133a192e39612861e108494293948d31c5203ad166&amp;scene=21#wechat_redirect" target="_blank" data-itemshowtype="0" data-linktype="2"><span>一文学会P trend计算，帮助你发表高分SCI论文！</span></a></p><p><a href="http://mp.weixin.qq.com/s?__biz=MzAwOTYyMDY3OQ==&amp;mid=2650379423&amp;idx=2&amp;sn=9a7c91ce0c8a9d28192f485bd490bc95&amp;chksm=8351e937b42660212c4c3afcc944cddc4f18aaa74ec4bd7ed31f3309cfd396822444d2cdf090&amp;scene=21#wechat_redirect" target="_blank" data-itemshowtype="0" data-linktype="2"><span>3.率的meta分析：</span><span> 神药PD-1、PD-L1抑制剂的不良反应研究</span></a></p><p><span>4.</span><a href="http://mp.weixin.qq.com/s?__biz=MzAwOTYyMDY3OQ==&amp;mid=2650379474&amp;idx=1&amp;sn=2c259594321c76182b546681e2e1ac45&amp;chksm=8351e97ab426606c24fa64873c3f3cbc82272fe720a5fc5e5fd05e7e4db3f64635846baf056a&amp;scene=21#wechat_redirect" target="_blank" data-itemshowtype="0" data-linktype="2"><span>当正态、偏态、率的数据狭路相逢，如何绘制规范医学论文表格</span></a></p><p><span>5.</span><a href="http://mp.weixin.qq.com/s?__biz=MzAwOTYyMDY3OQ==&amp;mid=2650379342&amp;idx=1&amp;sn=384b14aa99e0e1104b2f70fc8df43ce5&amp;chksm=8351e9e6b42660f06b5fae0b5c08351d31b0bdefbd5da90a8c71930f4665205aa5238f1664f9&amp;scene=21#wechat_redirect" target="_blank" data-itemshowtype="0" data-linktype="2"><span>为什么顶级JAMA杂志会接受针灸临床研究论文?</span></a></p><p><span>6.</span><a href="http://mp.weixin.qq.com/s?__biz=MzAwOTYyMDY3OQ==&amp;mid=2650378543&amp;idx=1&amp;sn=91f92d5516239238e952b173a1a3c6e8&amp;chksm=8351ec87b4266591dcd50bdc8ba07d6c1753e68d8a33a0752a73c56d8306b771e64e38b622e3&amp;scene=21#wechat_redirect" target="_blank" data-itemshowtype="0" data-linktype="2"><span>重磅推荐：</span><span>分类最全的统计分析相关软件，了解以下？</span><span>请关注、收藏以备用</span></a></p><p><a href="http://mp.weixin.qq.com/s?__biz=MzAwOTYyMDY3OQ==&amp;mid=2650379116&amp;idx=1&amp;sn=22edfec31ec77d80869b170a41378dce&amp;chksm=8351eec4b42667d2e6d4e65de32b73acf4b4ce31a08c8fd108abe7cdc018341c4745a94fcf8d&amp;scene=21#wechat_redirect" target="_blank" data-itemshowtype="0" data-linktype="2"><span>7.《新英格兰医学杂志》宣布弱化P值的地位</span></a></p><p><br></p><p><br></p><section><img data-ratio="0.23066666666666666" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/RXNgfngwAeZ9XK4EY2oE7vI4bbZDM91UwRQsicXd9bbMXEHaMicB7Q8BloyZ3l63qVFmBkaKPKAR0dyqeTyrOia8A/640?wx_fmt=png" data-type="png" data-w="750" src="https://mmbiz.qpic.cn/mmbiz_png/RXNgfngwAeZ9XK4EY2oE7vI4bbZDM91UwRQsicXd9bbMXEHaMicB7Q8BloyZ3l63qVFmBkaKPKAR0dyqeTyrOia8A/640?wx_fmt=png"></section><section><img data-copyright="0" data-ratio="0.6253071253071253" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/RXNgfngwAeZeqyhBw7z7sq4hic2oibcXJ5icvibUntUUUCaSPewB5SbRqnPGXV9AqBvaaHg6lPm5Tibx83DibHwbeLOA/640?wx_fmt=png" data-type="png" data-w="814" src="https://mmbiz.qpic.cn/mmbiz_png/RXNgfngwAeZeqyhBw7z7sq4hic2oibcXJ5icvibUntUUUCaSPewB5SbRqnPGXV9AqBvaaHg6lPm5Tibx83DibHwbeLOA/640?wx_fmt=png"></section><p><br></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/uuW-PNZIe65lPMruPtaZ7A",target="_blank" rel="noopener noreferrer">原文链接</a>
