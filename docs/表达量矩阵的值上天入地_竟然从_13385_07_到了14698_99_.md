---
title: "表达量矩阵的值上天入地，竟然从-13385.07 到了14698.99？"
date: 2022-09-20T01:58:22Z
draft: ["false"]
tags: [
  "fetched",
  "生信菜鸟团"
]
categories: ["Acdemic"]
---
表达量矩阵的值上天入地，竟然从-13385.07 到了14698.99？ by 生信菜鸟团
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><blockquote data-tool="mdnice编辑器"><span>❝</span><p>本来是要复现这篇文章[Evaluation of Ferroptosis-related Gene AKR1C1 as  a Novel Biomarker Associated with the Immune  Microenvironment and Prognosis in Breast Cancer]的部分图表。</p><p><span>"Figure 2 Validation of the expression level and clinical significance of AKR1C1. Expression comparisons of AKR1C1 between breast cancer and normal control in <strong>「GSE22358  GSE9014 , GSE8977"」</strong></span></p><p>就是三个数据集中tumor vs normal的差异基因呀，那就按流程来呗。</p><blockquote data-tool="mdnice编辑器"><p>GEO数据库里面的表达量芯片数据处理，主要的难点是表达量矩阵获取和探针的基因名字转换，搞定后只需要一定的生物学背景对数据进行合理的分组后就是标准的差异分析，富集分析。<strong>主要是参考《生信菜鸟团》八年前的笔记：</strong></p></blockquote><span>❞<span></span></span></blockquote><p data-tool="mdnice编辑器">然而在检查矩阵时发现了问题，(⊙﹏⊙)</p><ul data-tool="mdnice编辑器"><li><section><a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247486063&amp;idx=1&amp;sn=156bee5397e979722b36b78284188538&amp;scene=21#wechat_redirect" data-linktype="2">解读GEO数据存放规律及下载，一文就够</a></section></li><li><section><a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247486054&amp;idx=1&amp;sn=209975adee162228cfe6e6c5065c5c8c&amp;scene=21#wechat_redirect" data-linktype="2">解读SRA数据库规律一文就够</a></section></li><li><section><a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247486087&amp;idx=1&amp;sn=1e775a1c3e215384e381953a9fa74ec3&amp;scene=21#wechat_redirect" data-linktype="2">从GEO数据库下载得到表达矩阵 一文就够</a></section></li><li><section><a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247486090&amp;idx=1&amp;sn=62374fbdd4f20c3185beb6568bbeb3e9&amp;scene=21#wechat_redirect" data-linktype="2">GSEA分析一文就够（单机版+R语言版）</a></section></li><li><section><a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247486112&amp;idx=1&amp;sn=67a2104c62222bcb139623699f874a6c&amp;scene=21#wechat_redirect" data-linktype="2">根据分组信息做差异分析- 这个一文不够的</a></section></li><li><section><a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247486120&amp;idx=1&amp;sn=14d7892c1beec2fb9cdfc0ec0aba3e4e&amp;scene=21#wechat_redirect" data-linktype="2">差异分析得到的结果注释一文就够</a></section></li></ul><h2 data-tool="mdnice编辑器"><span></span><span>夸张的值</span><span></span></h2><p data-tool="mdnice编辑器"><strong>「GSE8977」</strong>这个看似平平无奇的数据集，表达量矩阵竟然是这样的⬇</p><pre data-tool="mdnice编辑器"><span></span><code><span># 1.数据下载 --------------------------------------------------------------------</span><br><span>##下载的数据大小&gt;131072字节，所以需要调整默认连接缓存，以便正常下载</span><br>Sys.setenv(<span>"VROOM_CONNECTION_SIZE"</span>=99999999)<br>gse_number = <span>"GSE8977"</span><br>eSet &lt;- getGEO(gse_number, <br>               destdir = <span>'.'</span>, <br>               getGPL = F)<br>class(eSet)<br>length(eSet)<br>eSet = eSet[[1]]<br><br><span>#(1)提取表达矩阵exp</span><br>exp &lt;- exprs(eSet)<br>exp[1:4,1:4]<br>range(exp) <span>##这么夸张！！！</span><br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.4293248945147679" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8zEk7kcceNp53mMOMa1N9To597PA3JRxObrz7bxufKJB5eMESBBqgeia7qNhnbVn9wl1PoTIjpBpg/640?wx_fmt=png" data-type="png" data-w="948" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8zEk7kcceNp53mMOMa1N9To597PA3JRxObrz7bxufKJB5eMESBBqgeia7qNhnbVn9wl1PoTIjpBpg/640?wx_fmt=png"><figcaption>表达量矩阵</figcaption></figure><p data-tool="mdnice编辑器">range(exp)一看，好家伙，【-13385.07  14698.99】，难道是数据集有问题，遇事不决先<strong>「必应」</strong></p><h2 data-tool="mdnice编辑器"><span></span><span>双通道数据？？NO!</span><span></span></h2><p data-tool="mdnice编辑器">然后我就找到了这篇帖子芯片的表达数据为负值？- 简书 (jianshu.com)</p><p data-tool="mdnice编辑器">该如何判断自己的数据属于单通道还是双通道呢？判断GEO芯片数据是双通道还是单通道 - 组学大讲堂问答社区 (omicsclass.com)</p><figure data-tool="mdnice编辑器"><img data-ratio="0.25" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8zEk7kcceNp53mMOMa1N9TuJ0Uneo1mbPPHibibdGB1CTrcCgMAlhzVIsFh6pwjAYibjmxFBMQOnQvA/640?wx_fmt=png" data-type="png" data-w="832" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8zEk7kcceNp53mMOMa1N9TuJ0Uneo1mbPPHibibdGB1CTrcCgMAlhzVIsFh6pwjAYibjmxFBMQOnQvA/640?wx_fmt=png"><figcaption>芯片信息</figcaption></figure><p data-tool="mdnice编辑器">这样看的话，这个数据并不是双通道的。</p><p data-tool="mdnice编辑器">再看原始数据的构成：</p><figure data-tool="mdnice编辑器"><img data-ratio="0.786096256684492" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8zEk7kcceNp53mMOMa1N9TKOwq0bH3cEDyaOqhPayz6xvWeDgsApRZmwdGeoJDLpwliad0jRps1NA/640?wx_fmt=png" data-type="png" data-w="748" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8zEk7kcceNp53mMOMa1N9TKOwq0bH3cEDyaOqhPayz6xvWeDgsApRZmwdGeoJDLpwliad0jRps1NA/640?wx_fmt=png"><figcaption>raw-data的样子</figcaption></figure><p data-tool="mdnice编辑器">不太理解这个dcp文件？？？</p><p data-tool="mdnice编辑器">那接下来该怎么处理呢？再接着检索看看</p><p data-tool="mdnice编辑器">芯片表达数据预处理：从探针RMA-based value 到基因水平表达量 - 知乎 (zhihu.com)，</p><pre data-tool="mdnice编辑器"><span></span><code>load(<span>"GSE8977_eSet.Rdata"</span>)<br>class(gset)<br>a=gset[[<span>1</span>]] <br>class(a)<br>dat=exprs(a) <br>class(dat)<br>geneSummaries &lt;-rma(dat, target=<span>"core"</span>)<br> <span>##Error in (function (classes, fdef, mtable)  : </span><br>  函数‘probeNames’标签‘<span>"matrix"</span>’找不到继承方法<br></code></pre><p data-tool="mdnice编辑器">完蛋！</p><h2 data-tool="mdnice编辑器"><span></span><span>直接读取CEL文件，问题解决</span><span></span></h2><p data-tool="mdnice编辑器">再查，看到有网友说这种情况最好<strong>「直接下载cel文件」</strong>来分析，那就直接下载原始raw.data文件试试看吧🆒</p><pre data-tool="mdnice编辑器"><span></span><code><span># 尝试直接下载cel文件再读取 ----------------------------------------------------------</span><br>rm(list = ls()) <br>getwd()<br>library(affy)<br>dir=<span>'GSE8977_RAW/'</span><br>affy_data = ReadAffy(celfile.path=dir)<br>eset=rma(affy_data)<br>class(eset)<br>exprSet=exprs(eset)<br>exprSet[1:10,1:4]<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.6781970649895178" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8zEk7kcceNp53mMOMa1N9THKAJGeZ8mFxGCsN0nNwH2hwqzTSOTmRHicqfWb1DTFqhe5WJpJBMkXA/640?wx_fmt=png" data-type="png" data-w="954" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8zEk7kcceNp53mMOMa1N9THKAJGeZ8mFxGCsN0nNwH2hwqzTSOTmRHicqfWb1DTFqhe5WJpJBMkXA/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">后续就按正常流程走完差异分析即可~</p><p data-tool="mdnice编辑器">其他两个数据集也不可小觑，别扭得很，留待下期浅说一下吧</p><blockquote data-tool="mdnice编辑器"><span>❝</span><p>虽然问题解决了，但回头一想，为什么用getGEO得到的表达矩阵如此奇怪呢？？？</p><p>菜鸟刚上树，还需努力，如果有了解的同学，欢迎在评论区参与讨论，也为我们解惑，感激~</p><span>❞</span></blockquote></section><p><br></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/Vm-GCgetO3r0AH2sVY55NQ",target="_blank" rel="noopener noreferrer">原文链接</a>
