---
title: "如何进行批量差异分析并绘制其火山图及拼图"
date: 2023-01-04T07:47:22Z
draft: ["false"]
tags: [
  "fetched",
  "生信菜鸟团"
]
categories: ["Acdemic"]
---
如何进行批量差异分析并绘制其火山图及拼图 by 生信菜鸟团
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><h2 data-tool="mdnice编辑器"><span></span><span>缘起</span><span></span></h2><p data-tool="mdnice编辑器">上周，曾老师给了我一个8个样本8个组别的转录组数据，即每组只有一个样本的转录组数据。我的处理方式是从中抽取两组进行差异分析，与文中描述的显著差异基因数目以及文中指出的差异基因进行比较，看看分析结果是否大致相同。但是，其实我有些没有理解到老师的意思。老师的<span><strong>初衷</strong></span>是想同原文一样批量绘制<strong>「同个部位」</strong>两两组别间的差异分析结果，看看其差异基因数量的分布，然后进行比较。在看到我理解偏差后，老师还飞快地给我提供了单样本批量差异分析的脚本。<strong>「因此，本周我们主要重点展示如何批量进行单样本差异分析以及批量绘制火山图并拼图」</strong>。</p><h2 data-tool="mdnice编辑器"><span></span><span>探究</span><span></span></h2><p data-tool="mdnice编辑器">同样地，今天，我们使用的转录组数据集还是2019年发表在Diabetes杂志上，文献名称为Sarm1 Gene Defificiency Attenuates Diabetic Peripheral Neuropathy in Mice。该数据集由8个样本组成，每个样本代表一个分组。</p><h2 data-tool="mdnice编辑器"><span></span><span>转录组数据集介绍</span><span></span></h2><p data-tool="mdnice编辑器">该数据集提交在ENA官网，其PRJ项目号是PRJNA540413。若有小伙伴想从上游开始处理，具体数据下载链接见 <span>https://www.ebi.ac.uk/ena/browser/view/PRJNA540413。</span>该数据集有8个组别，但是8个组别中分为两个部位，SC与SN，处理中含基因敲除鼠与WT鼠，以及STZ处理与药物处理。<img data-ratio="0.934487021013597" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9Fcz2IfiaMOUBViaYP3emLl7kvcF22NqKB6ibjkTZrv4HKwXdKsXhqmRxicfiaJgbT28bHdIJHWILIvYw/640?wx_fmt=png" data-type="png" data-w="809" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9Fcz2IfiaMOUBViaYP3emLl7kvcF22NqKB6ibjkTZrv4HKwXdKsXhqmRxicfiaJgbT28bHdIJHWILIvYw/640?wx_fmt=png"><span><strong>重点强调</strong></span>，SC与SN代表<strong>「两个部位」</strong>哈，文中展示的图也是按照两个部位分为上半部分（SC部位4组4副图）与下半部分（SN组4组4副图）<img data-ratio="0.5505263157894736" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9Fcz2IfiaMOUBViaYP3emLl78GkicNMNhRhrmiaMqzsbFIVDxoribBLnljftc43zTL52xt7zQrgz5Nm6A/640?wx_fmt=png" data-type="png" data-w="950" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9Fcz2IfiaMOUBViaYP3emLl78GkicNMNhRhrmiaMqzsbFIVDxoribBLnljftc43zTL52xt7zQrgz5Nm6A/640?wx_fmt=png"></p><h2 data-tool="mdnice编辑器"><span></span><span>正式分析</span><span></span></h2><h3 data-tool="mdnice编辑器"><span></span><span><span></span>1.清空环境，加载R包</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code>rm(list = ls())<br><span>library</span>(edgeR)<br><span>library</span>(DESeq2)<br><span>library</span>(FactoMineR)<br><span>library</span>(factoextra)<br><span>library</span>(clusterProfiler)<br><span>library</span>(org.Hs.eg.db)<br><span>library</span>(org.Mm.eg.db)<br><span>library</span>(stringr)<br><span>library</span>(stringi)<br><span>library</span>(tidyverse)<br><span>library</span>(ggplot2)<br><span>library</span>(patchwork)<br><span>library</span>(pheatmap)<br><span>library</span>(VennDiagram)<br><span>library</span>(RColorBrewer)<br><span>library</span>(patchwork)<br><span>library</span>(ggplotify)<br><span>library</span>(EnhancedVolcano)<br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span><span></span>2.读取数据，获得基因表达矩阵</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code>rawcount &lt;- read.table(<span>"./all_trim.id.txt"</span>,header = <span>T</span>,sep=<span>"\t"</span>,row.names = <span>1</span>)<br>colnames(rawcount)<br><span>##  [1] "Chr"                 "Start"               "End"                </span><br><span>##  [4] "Strand"              "Length"              "SRR8988890.sort.bam"</span><br><span>##  [7] "SRR8988891.sort.bam" "SRR8988892.sort.bam" "SRR8988893.sort.bam"</span><br><span>## [10] "SRR8988894.sort.bam" "SRR8988895.sort.bam" "SRR8988896.sort.bam"</span><br><span>## [13] "SRR8988897.sort.bam"</span><br>rawcount[<span>1</span>:<span>4</span>,<span>1</span>:<span>4</span>]<br><span>##                                                     Chr</span><br><span>## ENSMUSG00000102693.1                               chr1</span><br><span>## ENSMUSG00000064842.1                               chr1</span><br><span>## ENSMUSG00000051951.5 chr1;chr1;chr1;chr1;chr1;chr1;chr1</span><br><span>## ENSMUSG00000102851.1                               chr1</span><br><span>##                                                                        Start</span><br><span>## ENSMUSG00000102693.1                                                 3073253</span><br><span>## ENSMUSG00000064842.1                                                 3102016</span><br><span>## ENSMUSG00000051951.5 3205901;3206523;3213439;3213609;3214482;3421702;3670552</span><br><span>## ENSMUSG00000102851.1                                                 3252757</span><br><span>##                                                                          End</span><br><span>## ENSMUSG00000102693.1                                                 3074322</span><br><span>## ENSMUSG00000064842.1                                                 3102125</span><br><span>## ENSMUSG00000051951.5 3207317;3207317;3215632;3216344;3216968;3421901;3671498</span><br><span>## ENSMUSG00000102851.1                                                 3253236</span><br><span>##                             Strand</span><br><span>## ENSMUSG00000102693.1             +</span><br><span>## ENSMUSG00000064842.1             +</span><br><span>## ENSMUSG00000051951.5 -;-;-;-;-;-;-</span><br><span>## ENSMUSG00000102851.1             +</span><br>rawcount=rawcount[,<span>6</span>:<span>13</span>]<br>keep &lt;- rowSums(rawcount&gt;<span>0</span>) &gt;= floor(<span>0.75</span>*ncol(rawcount))<br>filter_count &lt;- rawcount[keep,] <span>#获得filter_count矩阵</span><br>express_cpm &lt;- log2(cpm(filter_count)+ <span>1</span>)<br>express_cpm[<span>1</span>:<span>4</span>,<span>1</span>:<span>4</span>] <span>#获得cpm矩阵</span><br><span>##                       SRR8988890.sort.bam SRR8988891.sort.bam</span><br><span>## ENSMUSG00000051951.5            1.5845466           1.6597803</span><br><span>## ENSMUSG00000102331.1            0.5182788           0.6228564</span><br><span>## ENSMUSG00000025900.13           0.2167244           0.2165807</span><br><span>## ENSMUSG00000025902.13           3.7177481           3.7461175</span><br><span>##                       SRR8988892.sort.bam SRR8988893.sort.bam</span><br><span>## ENSMUSG00000051951.5            2.0250141           1.7654425</span><br><span>## ENSMUSG00000102331.1            0.4685779           0.8318200</span><br><span>## ENSMUSG00000025900.13           0.2196636           0.5655548</span><br><span>## ENSMUSG00000025902.13           3.9206494           4.4710626</span><br><br>a=str_split(rownames(filter_count),<span>"\\."</span>,simplify = <span>T</span>)[,<span>1</span>]<br>rownames(filter_count)=a<br><br>rawcount=filter_count<br><span>##转换ID</span><br>id2symbol &lt;- bitr(rownames(rawcount),   <br>                  fromType = <span>"ENSEMBL"</span>, <br>                  toType = <span>"SYMBOL"</span>, <br>                  OrgDb = org.Mm.eg.db)<br>rawcount &lt;- cbind(GeneID=rownames(rawcount),rawcount) <span>#多一列换成基因ID</span><br>rawcount &lt;- merge(id2symbol,rawcount,<br>                  by.x=<span>"ENSEMBL"</span>,by.y=<span>"GeneID"</span>,all.y=<span>T</span>) <br>rawcount=rawcount[!duplicated(rawcount$SYMBOL),] <br>rawcount &lt;- drop_na(rawcount) <span>#去除含有NA值的行</span><br>rownames(rawcount)=rawcount$SYMBOL<br>rawcount=rawcount[,<span>3</span>:<span>10</span>]<br>head(rawcount)<br><span>##       SRR8988890.sort.bam SRR8988891.sort.bam SRR8988892.sort.bam</span><br><span>## Gnai3                 732                 601                 592</span><br><span>## Cdc45                  75                  79                  47</span><br><span>## H19                    28                  59                  15</span><br><span>## Scml2                   6                  12                  10</span><br><span>## Apoh                   16                  19                  15</span><br><span>## Narf                  996                 801                 857</span><br><span>##       SRR8988893.sort.bam SRR8988894.sort.bam SRR8988895.sort.bam</span><br><span>## Gnai3                 647                2715                1778</span><br><span>## Cdc45                  56                  57                  50</span><br><span>## H19                    41                1700                2338</span><br><span>## Scml2                  10                  35                  26</span><br><span>## Apoh                   10                  30                  41</span><br><span>## Narf                  916                 598                 933</span><br><span>##       SRR8988896.sort.bam SRR8988897.sort.bam</span><br><span>## Gnai3                2214                2644</span><br><span>## Cdc45                 104                  63</span><br><span>## H19                  1749                1273</span><br><span>## Scml2                  35                  31</span><br><span>## Apoh                    7                  17</span><br><span>## Narf                  927                 761</span><br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span><span></span>3.自定义针对单样本的差异分析函数</span><span></span></h3><p data-tool="mdnice编辑器">（统计单样本之间差异分析上下调显著基因的数目）</p><pre data-tool="mdnice编辑器"><span></span><code>deg_single &lt;- <span>function</span>(exprSet){<br>  <span>#加载包</span><br>  <span># exprSet= rawcount[,c(1,3)]</span><br>  exprSet=exprSet[rowSums(exprSet)&gt;<span>1</span>,]<br>  group_list = c(<span>'A'</span>,<span>'B'</span>)<br>  <span>library</span>(edgeR) <br>  <span>#设置分组信息</span><br>  exprSet &lt;- DGEList(counts = exprSet, group = group_list)<br>  bcv = <span>0.1</span><span>#设置bcv为0.1</span><br>  et &lt;- exactTest(exprSet, dispersion=bcv^<span>2</span>)<br>  DEG_edgeR=as.data.frame(topTags(et, n = nrow(exprSet$counts)))<br>  head(DEG_edgeR)<br>  <span>#筛选上下调，设定阈值</span><br>  fc_cutoff &lt;- <span>2</span><br>  pvalue &lt;- <span>0.01</span><br>  DEG_edgeR$regulated &lt;- <span>"normal"</span><br>  loc_up &lt;- intersect(which(DEG_edgeR$logFC&gt;log2(fc_cutoff)),<br>                      which(DEG_edgeR$PValue&lt;pvalue))<br>  loc_down &lt;- intersect(which(DEG_edgeR$logFC &lt; (-log2(fc_cutoff))),<br>                        which(DEG_edgeR$PValue&lt;pvalue))<br>  DEG_edgeR$regulated[loc_up] &lt;- <span>"up"</span><br>  DEG_edgeR$regulated[loc_down] &lt;- <span>"down"</span> <br>  <span>return</span>(table(DEG_edgeR$regulated))<br>  <br>}<br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span><span></span>4. 1-4号（SC）样本差异分析后，显著上下调基因的统计</span><span></span></h3><p data-tool="mdnice编辑器">注意哈，前4个样本是针对SC的，也就是文章图的上半部分。区别于文章图有两点，一是可视化的方式，二是文章展示的是4个组别间表达量取lg值绘制散点图，然而我们用火山图展示了组别间两两差异分析的12个差异分析结果（除了未进行自身之间的差异分析外，我们都进行比较了哈）</p><pre data-tool="mdnice编辑器"><span></span><code>B1=lapply(<span>1</span>:<span>4</span>, <span>function</span>(i){<br>  <br>  lapply(<span>1</span>:<span>4</span>, <span>function</span>(j){<br>    <br>    <span>if</span>(i != j){<br>      deg_single(rawcount[,c(i,j)])<br>    } <br>    <br>  })<br>})<br>B1<br><span>## [[1]]</span><br><span>## [[1]][[1]]</span><br><span>## NULL</span><br><span>## </span><br><span>## [[1]][[2]]</span><br><span>## </span><br><span>##   down normal     up </span><br><span>##    110  17454    217 </span><br><span>## </span><br><span>## [[1]][[3]]</span><br><span>## </span><br><span>##   down normal     up </span><br><span>##    173  17457     92 </span><br><span>## </span><br><span>## [[1]][[4]]</span><br><span>## </span><br><span>##   down normal     up </span><br><span>##     62  17382    306 </span><br><span>## </span><br><span>## </span><br><span>## [[2]]</span><br><span>## [[2]][[1]]</span><br><span>## </span><br><span>##   down normal     up </span><br><span>##    217  17454    110 </span><br><span>## </span><br><span>## [[2]][[2]]</span><br><span>## NULL</span><br><span>## </span><br><span>## [[2]][[3]]</span><br><span>## </span><br><span>##   down normal     up </span><br><span>##    260  17431     39 </span><br><span>## </span><br><span>## [[2]][[4]]</span><br><span>## </span><br><span>##   down normal     up </span><br><span>##    191  17237    361 </span><br><span>## </span><br><span>## </span><br><span>## [[3]]</span><br><span>## [[3]][[1]]</span><br><span>## </span><br><span>##   down normal     up </span><br><span>##     92  17457    173 </span><br><span>## </span><br><span>## [[3]][[2]]</span><br><span>## </span><br><span>##   down normal     up </span><br><span>##     39  17431    260 </span><br><span>## </span><br><span>## [[3]][[3]]</span><br><span>## NULL</span><br><span>## </span><br><span>## [[3]][[4]]</span><br><span>## </span><br><span>##   down normal     up </span><br><span>##     39  17236    453 </span><br><span>## </span><br><span>## </span><br><span>## [[4]]</span><br><span>## [[4]][[1]]</span><br><span>## </span><br><span>##   down normal     up </span><br><span>##    306  17382     62 </span><br><span>## </span><br><span>## [[4]][[2]]</span><br><span>## </span><br><span>##   down normal     up </span><br><span>##    361  17237    191 </span><br><span>## </span><br><span>## [[4]][[3]]</span><br><span>## </span><br><span>##   down normal     up </span><br><span>##    453  17236     39 </span><br><span>## </span><br><span>## [[4]][[4]]</span><br><span>## NULL</span><br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span><span></span>5.自定义差异分析结果绘制火山图的函数</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code>deg_EnhanceV &lt;- <span>function</span>(exprSet){<br>  <span>#加载包</span><br>  <span># exprSet= rawcount[,c(1,3)]</span><br>  exprSet=exprSet[rowSums(exprSet)&gt;<span>1</span>,]<br>  group_list = c(<span>'A'</span>,<span>'B'</span>)<br>  <span>library</span>(edgeR) <br>  <span>#设置分组信息</span><br>  exprSet &lt;- DGEList(counts = exprSet, group = group_list)<br>  bcv = <span>0.1</span><span>#设置bcv为0.1</span><br>  et &lt;- exactTest(exprSet, dispersion=bcv^<span>2</span>)<br>  DEG_edgeR=as.data.frame(topTags(et, n = nrow(exprSet$counts)))<br>  head(DEG_edgeR)<br>  write.csv(DEG_edgeR, <span>'single-sample-deg-result.csv'</span>, quote = <span>FALSE</span>)<br>  <br>  <span>#筛选上下调，设定阈值</span><br>  fc_cutoff &lt;- <span>2</span><br>  pvalue &lt;- <span>0.01</span><br>  DEG_edgeR$regulated &lt;- <span>"normal"</span><br>  loc_up &lt;- intersect(which(DEG_edgeR$logFC&gt;log2(fc_cutoff)),<br>                      which(DEG_edgeR$PValue&lt;pvalue))<br>  loc_down &lt;- intersect(which(DEG_edgeR$logFC &lt; (-log2(fc_cutoff))),<br>                        which(DEG_edgeR$PValue&lt;pvalue))<br>  DEG_edgeR$regulated[loc_up] &lt;- <span>"up"</span><br>  DEG_edgeR$regulated[loc_down] &lt;- <span>"down"</span> <br>  EnhanceV=list()<br>  EnhanceV=print(as.ggplot(EnhancedVolcano(DEG_edgeR,<br>                                 lab =rownames(DEG_edgeR),<br>                                 x = <span>'logFC'</span>,<br>                                 y = <span>'FDR'</span>)))<br>  <span># b=list(EnhanceV,table(DEG_edgeR$regulated))</span><br>  <span># return(b)</span><br>  <span>return</span>(EnhanceV)<br>  <br>}<br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span><span></span>6. 1-4号（SC）样本批量绘制火山图并且拼图</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code>C1=lapply(<span>1</span>:<span>4</span>, <span>function</span>(i){<br>  <br>  lapply(<span>1</span>:<span>4</span>, <span>function</span>(j){<br>    <br>    <span>if</span>(i != j){<br>     C= deg_EnhanceV(rawcount[,c(i,j)])<br>    } <br>    <br>  })<br>})<br><span># 注意批量运行完，会展示12副图的结果，下面显展示第一幅图的差异分析结果，12副图的结果以拼图的形式展现</span><br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.7142857142857143" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9Fcz2IfiaMOUBViaYP3emLl7pjZnfZLKFH2P4LibNZcDbsuXdfwlw8tsgQiarurqc42L4A46aWIwWib0Q/640?wx_fmt=png" data-type="png" data-w="672" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9Fcz2IfiaMOUBViaYP3emLl7pjZnfZLKFH2P4LibNZcDbsuXdfwlw8tsgQiarurqc42L4A46aWIwWib0Q/640?wx_fmt=png"></figure><pre data-tool="mdnice编辑器"><span></span><code>C=C1<br><span>library</span>(cowplot)<br>b=plot_grid(plotlist = c(C[[<span>1</span>]],C[[<span>2</span>]],C[[<span>3</span>]],C[[<span>4</span>]]), align = <span>"h"</span>, <br>          nrow = <span>4</span>, labels=LETTERS[<span>1</span>:<span>16</span>])<br>b<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.9976958525345622" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9Fcz2IfiaMOUBViaYP3emLl7M8hv7iaAcicnzkh1TVbNE8YgbpuIgoib15iclLj8BNQO4YoysInQdyxDbQ/640?wx_fmt=png" data-type="png" data-w="868" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9Fcz2IfiaMOUBViaYP3emLl7M8hv7iaAcicnzkh1TVbNE8YgbpuIgoib15iclLj8BNQO4YoysInQdyxDbQ/640?wx_fmt=png"></figure><h3 data-tool="mdnice编辑器"><span></span><span><span></span>7. 5-8号（SN）样本差异分析后，显著上下调基因统计</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code>B5=lapply(<span>5</span>:<span>8</span>, <span>function</span>(i){<br>  <br>  lapply(<span>5</span>:<span>8</span>, <span>function</span>(j){<br>    <br>    <span>if</span>(i != j){<br>      deg_single(rawcount[,c(i,j)])<br>    } <br>    <br>  })<br>})<br>B5<br><span>## [[1]]</span><br><span>## [[1]][[1]]</span><br><span>## NULL</span><br><span>## </span><br><span>## [[1]][[2]]</span><br><span>## </span><br><span>##   down normal     up </span><br><span>##    945  16161    608 </span><br><span>## </span><br><span>## [[1]][[3]]</span><br><span>## </span><br><span>##   down normal     up </span><br><span>##    211  17041    492 </span><br><span>## </span><br><span>## [[1]][[4]]</span><br><span>## </span><br><span>##   down normal     up </span><br><span>##    440  16834    451 </span><br><span>## </span><br><span>## </span><br><span>## [[2]]</span><br><span>## [[2]][[1]]</span><br><span>## </span><br><span>##   down normal     up </span><br><span>##    608  16161    945 </span><br><span>## </span><br><span>## [[2]][[2]]</span><br><span>## NULL</span><br><span>## </span><br><span>## [[2]][[3]]</span><br><span>## </span><br><span>##   down normal     up </span><br><span>##    242  16966    499 </span><br><span>## </span><br><span>## [[2]][[4]]</span><br><span>## </span><br><span>##   down normal     up </span><br><span>##    584  16107   1025 </span><br><span>## </span><br><span>## </span><br><span>## [[3]]</span><br><span>## [[3]][[1]]</span><br><span>## </span><br><span>##   down normal     up </span><br><span>##    492  17041    211 </span><br><span>## </span><br><span>## [[3]][[2]]</span><br><span>## </span><br><span>##   down normal     up </span><br><span>##    499  16966    242 </span><br><span>## </span><br><span>## [[3]][[3]]</span><br><span>## NULL</span><br><span>## </span><br><span>## [[3]][[4]]</span><br><span>## </span><br><span>##   down normal     up </span><br><span>##    500  16947    293 </span><br><span>## </span><br><span>## </span><br><span>## [[4]]</span><br><span>## [[4]][[1]]</span><br><span>## </span><br><span>##   down normal     up </span><br><span>##    451  16834    440 </span><br><span>## </span><br><span>## [[4]][[2]]</span><br><span>## </span><br><span>##   down normal     up </span><br><span>##   1025  16107    584 </span><br><span>## </span><br><span>## [[4]][[3]]</span><br><span>## </span><br><span>##   down normal     up </span><br><span>##    293  16947    500 </span><br><span>## </span><br><span>## [[4]][[4]]</span><br><span>## NULL</span><br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span><span></span>8. 5-8号（SN）样本的批量绘制火山图并且拼图</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code>C5=lapply(<span>5</span>:<span>8</span>, <span>function</span>(i){<br>  <br>  lapply(<span>5</span>:<span>8</span>, <span>function</span>(j){<br>    <br>    <span>if</span>(i != j){<br>      C= deg_EnhanceV(rawcount[,c(i,j)])<br>    } <br>    <br>  })<br>})<br><span># 注意批量运行完，会展示12副图的结果，下面显展示第一幅图的差异分析结果，12副图的结果同样在下面的代码中以拼图的形式展现</span><br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.7142857142857143" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9Fcz2IfiaMOUBViaYP3emLl7ibdWwzQAyD0bfu67pfwsD5Fia1pSh3qCbGTrOQ7ZiaKuLelwtDibOSwqAQ/640?wx_fmt=png" data-type="png" data-w="672" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9Fcz2IfiaMOUBViaYP3emLl7ibdWwzQAyD0bfu67pfwsD5Fia1pSh3qCbGTrOQ7ZiaKuLelwtDibOSwqAQ/640?wx_fmt=png"></figure><pre data-tool="mdnice编辑器"><span></span><code>C=C5<br><br><span>library</span>(cowplot)<br>b=plot_grid(plotlist = c(C[[<span>1</span>]],C[[<span>2</span>]],C[[<span>3</span>]],C[[<span>4</span>]]), align = <span>"h"</span>, <br>            nrow = <span>4</span>, labels=LETTERS[<span>5</span>:<span>21</span>]) #此处标记咱们就从第五个字母E开始吧</code><code><span>b</span></code></pre><p data-tool="mdnice编辑器"><img data-ratio="0.9976958525345622" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9Fcz2IfiaMOUBViaYP3emLl7WfA2F9MUXJPWuEecFbIdSk1AadmxFNgJ95Vdtva7GPiciboZJm1UjicOg/640?wx_fmt=png" data-type="png" data-w="868" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9Fcz2IfiaMOUBViaYP3emLl7WfA2F9MUXJPWuEecFbIdSk1AadmxFNgJ95Vdtva7GPiciboZJm1UjicOg/640?wx_fmt=png">以上演示了批量差异分析以及批量绘制火山图及拼图的方式，感兴趣的小伙伴们可以尝试一下。<span>12副火山图的拼图其实有点大，如果不清楚的话，自身探究时可以将图片保存大些即可</span>。</p><p data-tool="mdnice编辑器"><span>值得注意的是：原文是对两组之间的lg值，绘制散点图；而不是像我们一样两两组合进行差异分析；我们在获得了差异分析的结果之后，如果有余力的话，其实也可以向作者一样进行两两组合绘制散点图探索下，感兴趣的小伙伴们可以自身尝试下哈。</span><br></p></section><p><br></p><p><mp-style-type data-value="10000"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/_WumyZyjNZ5HGKEf-yF9Fg",target="_blank" rel="noopener noreferrer">原文链接</a>
