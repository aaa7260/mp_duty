---
title: "cd-hit去冗余"
date: 2023-01-01T01:31:06Z
draft: ["false"]
tags: [
  "fetched",
  "生信喵实验柴"
]
categories: ["Acdemic"]
---
cd-hit去冗余 by 生信喵实验柴
------
<div><p><img data-galleryid="" data-ratio="0.2777777777777778" data-src="https://mmbiz.qpic.cn/mmbiz_gif/IAFet2H8TicyQzmBltWrwCrk3uRWeFvRtMiaUqTHyHeRImPcG0bQ1I0wkXbcL5icibMakSmAhU2ibz9ABuWcoZ3j6Kg/640?wx_fmt=gif" data-type="gif" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_gif/IAFet2H8TicyQzmBltWrwCrk3uRWeFvRtMiaUqTHyHeRImPcG0bQ1I0wkXbcL5icibMakSmAhU2ibz9ABuWcoZ3j6Kg/640?wx_fmt=gif"></p><p><strong>一、cd-hit介绍</strong></p><p>       cd-hit 是一款用于将蛋白、核酸序列快速聚类的工具。由于宏基因组样品中可能包含相似物种，拼接结果中可能会存在一部分冗余序列，导致预测出来的基因包含冗余部分，可以通过聚类进行去冗余。</p><p>       通常去冗余采用的聚类算法根据序列相似度对序列进行聚类，需要进行 all by all 的比较，例如 orthoMCL，不过这种方法非常耗时。而 cd-hit 使用一种贪婪的增量聚类方法，首先对输入的序列根据序列的长短进行排序，并从最长到最短的顺序处理它们。将最长的序列自动的分为第一类并作为第一类的代表序列，然后将剩下的序列与在其之前发现的代表性序列进行比较，根据序列相似性将其归为其中的一类或成为新的一个聚类的代表序列，如此遍历所有序列完成聚类过程。在默认方式中，序列仅和每一个聚类中的代表性序列（为这类中的最长序列）进行比较而不和这个类中的其他序列进行比对。在准确模式下，序列会和每个聚类中的所有序列进行比较然后决定是成为新的一类还是归为其中的一类中。</p><p>       网址：http://weizhongli-lab.org/cd-hit/</p><p><br></p><p><strong>二、软件安装</strong></p><section><ul><li></ul><pre data-lang="bash"><code><span>conda install -y <span>cd</span>-hit</span></code></pre></section><p><br></p><p><strong>三、使用案例</strong></p><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="perl"><code><span><span>#对核酸聚类</span></span></code><code><span>echo <span>"time cd-hit-est -i mg.ffn -o mg.filter.ffn -aS 0.9 -T 12 1&gt;cdhit.log 2&gt;cdhit.err"</span> &gt;cdhit.sh</span></code><code><span>bsub -<span>q</span> fat -n <span>12</span> -o %J.log -e %J.err sh cdhit.sh</span></code><code><span>seqkit <span>stat</span> mg.ffn mg.filter.ffn</span></code><code><span>        file           <span>format</span>  type  num_seqs      sum_len  min_len  avg_len  max_len</span></code><code><span>        mg.ffn         FASTA   DNA    <span>266</span>,<span>921</span>  <span>151</span>,<span>713</span>,<span>911</span>       <span>68</span>    <span>568.4</span>   <span>14</span>,<span>211</span></span></code><code><span>        mg.filter.ffn  FASTA   DNA    <span>255</span>,<span>020</span>  <span>145</span>,<span>715</span>,<span>723</span>       <span>68</span>    <span>571.4</span>   <span>14</span>,<span>211</span></span></code><code><span><span>#改变不同的阈值后，条数减少了</span></span></code><code><span>echo <span>"time cd-hit-est -i mg.ffn -o mg.filter.ffn -aS 0.85 -T 12 -c 0.85 1&gt;cdhit1.log 2&gt;cdhit1.err"</span> &gt;cdhit1.sh</span></code><code><span>bsub -<span>q</span> fat -n <span>12</span> -o %J.log -e %J.err sh cdhit1.sh</span></code><code><span>seqkit <span>stat</span> mg.ffn mg.filter.ffn</span></code><code><span>        file           <span>format</span>  type  num_seqs      sum_len  min_len  avg_len  max_len</span></code><code><span>        mg.ffn         FASTA   DNA    <span>266</span>,<span>921</span>  <span>151</span>,<span>713</span>,<span>911</span>       <span>68</span>    <span>568.4</span>   <span>14</span>,<span>211</span></span></code><code><span>        mg.filter.ffn  FASTA   DNA    <span>242</span>,<span>836</span>  <span>139</span>,<span>449</span>,<span>227</span>       <span>68</span>    <span>574.3</span>   <span>14</span>,<span>211</span></span></code><code><span><span>grep</span> <span>'&gt;'</span> mg.filter.ffn &gt;id.list <span>#提取筛选后的id</span></span></code><code><span><br></span></code><code><span><span>#对氨基酸聚类</span></span></code><code><span><span># echo "time cd-hit -i mg.faa -o mg.filter.faa -aS 0.9 -T 12 1&gt;cdhit1.log 2&gt;cdhit1.err" &gt;cdhit1.sh</span></span></code><code><span><span># bsub -q fat -n 12 -o %J.log -e %J.err sh cdhit1.sh</span></span></code><code><span><span># 使用transeq翻译，transeq来自emboss软件包</span></span></code><code><span>transeq -sequence mg.filter.ffn -outseq mg.filter.faa</span></code><code><span><span>#用筛选后的id 提取氨基酸序列</span></span></code><code><span>awk <span>'{print $1 }'</span> id.list &gt;id.txt</span></code><code><span>sed -i <span>'s/&gt;//'</span> id.txt</span></code><code><span>seqkit <span>grep</span> -r -f id.txt mg.faa &gt;mg.cdhit.faa</span></code><code><span><span>#seqkit也可以提取成氨基酸序列</span></span></code><code><span><span>time</span> seqkit translate mg.filter.ffn -T <span>11</span> &gt;test.faa</span></code></pre></section><p>选项参数：</p><p>       -i 输入文件，fasta 格式的序列</p><p>       -o 输出文件路径和名字</p><p>       -c 相似性（clustering threshold），0.9 表示相似性大于等于 90%的为一类</p><p>       -n 两两序列进行序列比对时选择的 word size</p><p>       -d 0 表示使用 fasta 标题中第一个空格前的字段作为序列名字</p><p>       -M 16000，16GB RAM</p><p>       -T 使用的线程数</p><p>Choose of word size:</p><p>       -n 5 for thresholds 0.7 ~ 1.0</p><p>       -n 4 for thresholds 0.6 ~ 0.7</p><p>       -n 3 for thresholds 0.5 ~ 0.6</p><p>       -n 2 for thresholds 0.4 ~ 0.5</p><p><img data-galleryid="" data-ratio="0.18518518518518517" data-src="https://mmbiz.qpic.cn/mmbiz_gif/IAFet2H8TicyQzmBltWrwCrk3uRWeFvRt1j7lLnMghic28HDCOogn7EfSWJf68twl5FIo1nRhY4qcpCaVPV7L9vA/640?wx_fmt=gif" data-type="gif" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_gif/IAFet2H8TicyQzmBltWrwCrk3uRWeFvRt1j7lLnMghic28HDCOogn7EfSWJf68twl5FIo1nRhY4qcpCaVPV7L9vA/640?wx_fmt=gif"></p><p>     写在最后：有时间我们会努力更新的。大家互动交流可以前去论坛，地址在下面，复制去浏览器即可访问，弥补下公众号没有留言功能的缺憾。</p><section><ul><li></ul><pre data-lang="css"><code><span><span>bioinfoer</span><span>.com</span></span></code></pre></section><p>     有些板块也可以预设为大家日常趣事的分享等，欢迎大家来提建议。</p><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/dbr5AsNtFjRlch-GYL8idw",target="_blank" rel="noopener noreferrer">原文链接</a>
