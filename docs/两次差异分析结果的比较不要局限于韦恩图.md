---
title: "两次差异分析结果的比较不要局限于韦恩图"
date: 2022-12-03T10:28:41Z
draft: ["false"]
tags: [
  "fetched",
  "生信技能树"
]
categories: ["Acdemic"]
---
两次差异分析结果的比较不要局限于韦恩图 by 生信技能树
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><blockquote data-tool="mdnice编辑器"><p>初学者最喜欢怀疑自己的分析是否正确，比如差异分析的时候就容易陷入上下调基因数量的对比问题，文章可能是上下调一千附近，但是学员自己复现的时候就数量对不上。</p></blockquote><p data-tool="mdnice编辑器">其实这个问题并不在于上下调基因数量，应该是看质量，这样的对比才有意义。</p><h3 data-tool="mdnice编辑器"><span></span>最初级的就是韦恩图啦<span></span></h3><p data-tool="mdnice编辑器">大家在做差异分析结果比较的时候，喜欢看两次分析结果的基因交集，比如韦恩图。这样的简单粗暴的思考逻辑很容易理解，但是就会出现一下啼笑皆非的提问，比如有学生问，文献差异分析结果是1000个上调基因500个下调基因，但是自己做出来仅仅是50个和25个，其实仅仅是因为使用的筛选阈值不一样。如果画一个差异变化倍数（logFC）散点图，就可以很直观的给出两次分析结果差异了。</p><p data-tool="mdnice编辑器">差异分析相信大家都不陌生了，基本上看我六年前的<strong>表达芯片的公共数据库挖掘系</strong>列推文即可；</p><ul data-tool="mdnice编辑器"><li><section><a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247486063&amp;idx=1&amp;sn=156bee5397e979722b36b78284188538&amp;scene=21#wechat_redirect" data-linktype="2">解读GEO数据存放规律及下载，一文就够</a></section></li><li><section><a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247486054&amp;idx=1&amp;sn=209975adee162228cfe6e6c5065c5c8c&amp;scene=21#wechat_redirect" data-linktype="2">解读SRA数据库规律一文就够</a></section></li><li><section><a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247486087&amp;idx=1&amp;sn=1e775a1c3e215384e381953a9fa74ec3&amp;scene=21#wechat_redirect" data-linktype="2">从GEO数据库下载得到表达矩阵 一文就够</a></section></li><li><section><a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247486090&amp;idx=1&amp;sn=62374fbdd4f20c3185beb6568bbeb3e9&amp;scene=21#wechat_redirect" data-linktype="2">GSEA分析一文就够（单机版+R语言版）</a></section></li><li><section><a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247486112&amp;idx=1&amp;sn=67a2104c62222bcb139623699f874a6c&amp;scene=21#wechat_redirect" data-linktype="2">根据分组信息做差异分析- 这个一文不够的</a></section></li><li><section><a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247486120&amp;idx=1&amp;sn=14d7892c1beec2fb9cdfc0ec0aba3e4e&amp;scene=21#wechat_redirect" data-linktype="2">差异分析得到的结果注释一文就够</a></section></li></ul><p data-tool="mdnice编辑器">两个差异分析的结果的对比，韦恩图是比较符合直觉的展现方式。我们在《生信菜鸟团》有一个专辑反复提到过，大家可以自行去阅读：</p><p><img data-galleryid="" data-ratio="0.9644886363636364" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wyH8bibVBibbPPHDgzndheFQmrnmxiapzFcWcKxdLB7KK49ETdQghaEXIZsTvfsJVtNNgXwWwRIziafUg/640?wx_fmt=png" data-type="png" data-w="1408" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wyH8bibVBibbPPHDgzndheFQmrnmxiapzFcWcKxdLB7KK49ETdQghaEXIZsTvfsJVtNNgXwWwRIziafUg/640?wx_fmt=png"></p><figure data-tool="mdnice编辑器"><figcaption>两个差异分析的结果的对比</figcaption></figure><h3 data-tool="mdnice编辑器"><span></span>其次是变化倍数的散点图<span></span></h3><p data-tool="mdnice编辑器">比如我们可以在PBMC3K数据集里面，做两次单细胞差异分析：</p><pre data-tool="mdnice编辑器"><span></span><code>CD14_deg = FindMarkers(sce,ident.1 = <span>'CD14+ Mono'</span>,<br>                  ident.2 = <span>'B'</span>)<br>head(CD14_deg[order(CD14_deg$p_val),])<br>FCGR3A_deg = FindMarkers(sce,ident.1 = <span>'FCGR3A+ Mono'</span>,<br>                       ident.2 = <span>'B'</span>)<br>head(FCGR3A_deg[order(FCGR3A_deg$p_val),])<br></code></pre><p data-tool="mdnice编辑器">然后拿两次差异分析各自统计学显著的基因的交集去绘图，代码如下所示：</p><pre data-tool="mdnice编辑器"><span></span><code>ids=intersect(rownames(CD14_deg),<br>              rownames(FCGR3A_deg))<br>df= data.frame(<br>  FCGR3A_deg = FCGR3A_deg[ids,<span>'avg_log2FC'</span>],<br>  CD14_deg = CD14_deg[ids,<span>'avg_log2FC'</span>]<br>)<br><span>library</span>(ggpubr)<br>ggscatter(df, x = <span>"FCGR3A_deg"</span>, y = <span>"CD14_deg"</span>,<br>          color = <span>"black"</span>, shape = <span>21</span>, size = <span>3</span>, <span># Points color, shape and size</span><br>          add = <span>"reg.line"</span>,  <span># Add regressin line</span><br>          add.params = list(color = <span>"blue"</span>, fill = <span>"lightgray"</span>), <span># Customize reg. line</span><br>          conf.int = <span>TRUE</span>, <span># Add confidence interval</span><br>          cor.coef = <span>TRUE</span>, <span># Add correlation coefficient. see ?stat_cor</span><br>          cor.coeff.args = list(method = <span>"pearson"</span>,  label.sep = <span>"\n"</span>)<br>)<br><br></code></pre><p data-tool="mdnice编辑器">可以看到相关性，挺好的。详见：<a href="https://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247500839&amp;idx=1&amp;sn=ad661637d839a2cd2e73af9e35b2c875&amp;scene=21#wechat_redirect" data-linktype="2">两次单细胞差异分析后的结果进行相关性散点图绘制</a></p><p data-tool="mdnice编辑器">相关性确实是可以说明我们的两次差异分析是一致的，但是很多时候，我们并不是想重复前人的数据分析结果，而是确实先看看两次差异分析的结果的不一致的地方。</p><h3 data-tool="mdnice编辑器"><span></span>更高级的是模式分类<span></span></h3><p data-tool="mdnice编辑器">参考2015的文章：《<em>ACTN4</em> and the pathways associated with cell motility and adhesion contribute to the process of lung cancer metastasis to the brain》</p><p data-tool="mdnice编辑器">一个肺癌患者：A 47-year-old female patient ，取3个样品：</p><ul data-tool="mdnice编辑器"><li><section>The adjacent benign lung tissue (N16),</section></li><li><section>the original lung cancer (T16),</section></li><li><section>the metastatic brain tumor (T30)</section></li></ul><p data-tool="mdnice编辑器">3个样品就是3个分组， 所以只能是走无重复的转录组差异分析流程，这里作者选择了 DEGseq ，参数很普通，就是：a fold change &gt; 2, P &lt; 0.5, and false discovery rate (FDR) &lt; 0.05</p><ul data-tool="mdnice编辑器"><li><section>more than900 differentially expressed genes between N16 and T16</section></li><li><section>more than 800 differentially expressed genes between N16 and T30</section></li></ul><p data-tool="mdnice编辑器"><strong>但是作者并没有对这两次的差异分析结果列表做韦恩图，反而是做了一个“骚操作”：</strong></p><blockquote data-tool="mdnice编辑器"><p>classify the differentially expressed genes in eight clusters based on the reads per kb per million reads (RPKM) change tendency of genes in these three types of tissues (N16, T16, and T30),</p></blockquote><p data-tool="mdnice编辑器">最后作者关注的是：Cluster 1: expression in N16 &gt; expression in T16 = expression in T30</p><p data-tool="mdnice编辑器">这个时候的算法来源比较老了，是：Cluster analysis of gene expression dynamics. Proc Natl Acad Sci U S A. 2002;</p><p data-tool="mdnice编辑器">算是一个启发吧。</p></section><h3 data-tool="mdnice编辑器"><span>写在文末</span></h3><p data-tool="mdnice编辑器">我在《生信技能树》，《生信菜鸟团》，《单细胞天地》的大量推文教程里面共享的代码都是复制粘贴即可使用的， 有任何疑问欢迎留言讨论，也可以发邮件给我，详细描述你遇到的困难的前因后果给我，我的邮箱地址是 jmzeng1314@163.com</p><p data-tool="mdnice编辑器">如果你确实觉得我的教程对你的科研课题有帮助，让你茅塞顿开，或者说你的课题大量使用我的技能，烦请日后在发表自己的成果的时候，加上一个简短的致谢，如下所示：</p><pre data-tool="mdnice编辑器"><span></span><code>We thank Dr.Jianming Zeng(University of Macau), and all the members of his bioinformatics team, biotrainee, <span>for</span> generously sharing their experience and codes.</code></pre><p data-tool="mdnice编辑器">十年后我环游世界各地的高校以及科研院所（当然包括中国大陆）的时候，如果有这样的情谊，我会优先见你。</p><p><br></p><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/AsL35pO6uZFslMl8Xyo42Q",target="_blank" rel="noopener noreferrer">原文链接</a>
