---
title: "KEGG的富集分析终于真的本地化了。"
date: 2023-10-24T10:31:33Z
draft: ["false"]
tags: [
  "fetched",
  "YuLabSMU"
]
categories: ["Acdemic"]
---
KEGG的富集分析终于真的本地化了。 by YuLabSMU
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-mpa-powered-by="yiban.io"><p data-tool="mdnice编辑器"><a href="https://mp.weixin.qq.com/s?__biz=MzI3MTg4NjE4OA==&amp;mid=2247484627&amp;idx=1&amp;sn=fda3a0f4f63339a5d99fc8a01a19f02e&amp;chksm=eb3bb6d0dc4c3fc60d3f250a457b1709ed01f9ff55338291ba226104f9eb7963b220795bb74f&amp;mpshare=1&amp;scene=21&amp;srcid=0608xVjnUkWCG7Eq2HdnIWTc&amp;sharer_sharetime=1657617915095&amp;sharer_shareid=6acff07d41227dcb534b22279c7852fd#wechat_redirect" data-linktype="2">受牛津华人生命科学协会的邀请，上个月开了个讲座讲clusterProfiler</a>，我在上面讲了一个新的特性。</p><p data-tool="mdnice编辑器">不知道大家是否还记得我说过我要<a href="https://mp.weixin.qq.com/s?__biz=MzI5NjUyNzkxMg==&amp;mid=2247491921&amp;idx=1&amp;sn=3433d4f3a26190e33e9a7144565c4925&amp;chksm=ec405016db37d900a9ce5ca736479b2b9b3bee759a89328c697b79a0ce80975e56f5b9aa8a5e&amp;token=984642231&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">搞个新的文件格式</a>？</p></section><p><img data-galleryid="" data-ratio="0.5691533948030176" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/MPBFtnFrw4mzrQKMm49YYpncTOJuor5Gqft66mYk9fnP33EAHWPicSxsVYjx8qLWviaA7HXsorPsLPo8q52AY6xA/640?wx_fmt=png" data-type="png" data-w="1193" src="https://mmbiz.qpic.cn/mmbiz_png/MPBFtnFrw4mzrQKMm49YYpncTOJuor5Gqft66mYk9fnP33EAHWPicSxsVYjx8qLWviaA7HXsorPsLPo8q52AY6xA/640?wx_fmt=png"></p><p>GMT的格式就是一个基因集ID对应一堆基因，没有了。如果是symbols，你可能还傻傻分不清是基因的，还是蛋白的ID。如果基因集ID不是常见的，你可能还不知道是啥基因集，你也不知道这下载下来的文件到底是什么版本？到底是老旧的还是萌新的？到底是什么物种？啥都搞不清楚的。有一种可能就是把这些信息放到基因集ID里去。会导致基因集ID里大量这些重复的信息，而这些信息的编排（比如说位置，分隔）都是不统一的，甚至于可能没有很好的分隔符，导致解析抽取信息也麻烦。</p><p><img data-galleryid="" data-ratio="0.4493927125506073" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/MPBFtnFrw4mzrQKMm49YYpncTOJuor5GPwl0GIHsS1jk9W26OPrjPyJwz5ViaC5ym5wKgDBQSKfz9TzEngVNoAA/640?wx_fmt=png" data-type="png" data-w="1235" src="https://mmbiz.qpic.cn/mmbiz_png/MPBFtnFrw4mzrQKMm49YYpncTOJuor5GPwl0GIHsS1jk9W26OPrjPyJwz5ViaC5ym5wKgDBQSKfz9TzEngVNoAA/640?wx_fmt=png"></p><p>新格式实际上是个json，也就是说它其实是个list，那么我们第一个元素，它看起来，和GMT没啥差别的样子，一个基因集ID，对应一堆基因ID。<br></p><p><img data-galleryid="" data-ratio="0.5053410024650781" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/MPBFtnFrw4mzrQKMm49YYpncTOJuor5GFYic9XObpHGBibe64zJ6CAO76a1JMcrdgx79JYRwdgrCmSN0xaIicfx2g/640?wx_fmt=png" data-type="png" data-w="1217" src="https://mmbiz.qpic.cn/mmbiz_png/MPBFtnFrw4mzrQKMm49YYpncTOJuor5GFYic9XObpHGBibe64zJ6CAO76a1JMcrdgx79JYRwdgrCmSN0xaIicfx2g/640?wx_fmt=png"></p><p>但是list可以有很多元素，物种、版本、访问时间等都可以有。<br></p><p><img data-galleryid="" data-ratio="0.514026402640264" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/MPBFtnFrw4mzrQKMm49YYpncTOJuor5GIyyjFrglv1PlzDYLicwcG3j5UjFjmyQV3IdVQDQKJ5KnfNtA9KAB9DA/640?wx_fmt=png" data-type="png" data-w="1212" src="https://mmbiz.qpic.cn/mmbiz_png/MPBFtnFrw4mzrQKMm49YYpncTOJuor5GIyyjFrglv1PlzDYLicwcG3j5UjFjmyQV3IdVQDQKJ5KnfNtA9KAB9DA/640?wx_fmt=png"></p><p>我早有定义这样一个格式的想法，可以说酝酿了很久，也在组会上跟学生提过，但没人动手，于是我自己先挖个坑，写一个R包，来读和写，当然我们可能还会有些调整，最终会出来一个formal definition的东西。定义一个格式不难，任何人都可以自己定义一个格式，难的是能让一个格式成为事实标准。</p><p><img data-galleryid="" data-ratio="0.5502092050209205" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/MPBFtnFrw4mzrQKMm49YYpncTOJuor5G1EhokOwKBNF6ic9qt4FeMImBqH8rs7SicU8jy9hq7abNcRSnQhFUXHMQ/640?wx_fmt=png" data-type="png" data-w="478" src="https://mmbiz.qpic.cn/mmbiz_png/MPBFtnFrw4mzrQKMm49YYpncTOJuor5G1EhokOwKBNF6ic9qt4FeMImBqH8rs7SicU8jy9hq7abNcRSnQhFUXHMQ/640?wx_fmt=png"></p><p><br></p><p>我先衔接一下KEGG的分析，那么用法很简单了，用gson_KEGG函数，就会自动下载，并且生成一个gson对象，你可以用write.gson去写成文件，以后要用，就可以用read.gson去读取。这样有什么好处，你可以本地化KEGG的分析了，再者KEGG是滚动升级的，虽然它也有版本，但它是滚动的，所以你过段时间分析，背景注释已经有所变化了，如果隔比较长时间，变化可能影响到富集分析的结果了。那么会导致你发表文章的时候，重新分析，发现变了。如果你能这样以文件存起来，固定起来，那么可重复性分析就有了。你的结果完全是可以重复的，而且文件里记载了版本，你访问KEGG网站的日期。你再也不会说不清楚到底用了个啥。</p><p><br></p><p><img data-galleryid="" data-ratio="0.7711370262390671" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/MPBFtnFrw4mzrQKMm49YYpncTOJuor5GrZpRrUmxTNVFBqrjia37CAiaHRHLqKth5VI46sb3671EHR0YDeWDNOlQ/640?wx_fmt=png" data-type="png" data-w="686" src="https://mmbiz.qpic.cn/mmbiz_png/MPBFtnFrw4mzrQKMm49YYpncTOJuor5GrZpRrUmxTNVFBqrjia37CAiaHRHLqKth5VI46sb3671EHR0YDeWDNOlQ/640?wx_fmt=png"></p><p><br></p><p>而富集分析，我暂时还不想改变API，所以你本来要传一个物种，现在传成gson对象就行了。其它的不变。非常容易使用。而且因为不访问网络，你会发现分析瞬间就完成了。</p><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><p data-tool="mdnice编辑器">以前的尝试因此会变得毫无意义。</p><ul data-tool="mdnice编辑器"><li><section><a href="https://mp.weixin.qq.com/s?__biz=MzI5NjUyNzkxMg==&amp;mid=2247488313&amp;idx=1&amp;sn=4ad8f14c26960bad12e2b5b31aa615ca&amp;scene=21#wechat_redirect" data-linktype="2">KEGG数据本地化，再也不用担心网络问题了</a></section></li><li><section><a href="https://mp.weixin.qq.com/s?__biz=MzI5NjUyNzkxMg==&amp;mid=2247488409&amp;idx=1&amp;sn=21220de50bbc69302f5a78a135e4311a&amp;scene=21#wechat_redirect" data-linktype="2">多物种批量下载KEGG数据并做成KEGG.db包</a><span></span></section></li></ul></section></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/c17CKZoYEBjHxH_YAcDHeA",target="_blank" rel="noopener noreferrer">原文链接</a>
