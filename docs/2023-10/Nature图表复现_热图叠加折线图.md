---
title: "Nature图表复现｜热图叠加折线图"
date: 2023-10-22T03:28:47Z
draft: ["false"]
tags: [
  "fetched",
  "R语言数据分析指南"
]
categories: ["Acdemic"]
---
Nature图表复现｜热图叠加折线图 by R语言数据分析指南
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><h3 data-tool="mdnice编辑器"><span></span><span><span></span>欢迎关注R语言数据分析指南</span><span></span></h3><blockquote data-tool="mdnice编辑器"><span>❝</span><p>本节来复现<strong>「nature communications」</strong>中的一张论文图，<strong>「热图叠加折线图」</strong>。小编将通过一个精选案例进行详细演示，这里展示的图形仅做展示，折线图中的数据是经过人为构建的，过程仅供参考。希望能对各位观众老爷有所帮助。数据代码已经整合上传到2023VIP交流群，加群的观众老爷可自行下载，有需要的朋友可关注文末介绍加入VIP交流群</p><span>❞</span></blockquote><h3 data-tool="mdnice编辑器"><span></span><span><span></span>关注下方公众号下回更新不迷路</span><span></span></h3><section><mp-common-profile data-pluginname="mpprofile" data-id="Mzg3MzQzNTYzMw==" data-headimg="http://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZF0rpeZII9Ltl26VbVagriczTria1fib3XgjwwHEHFjPzkmGpqWDVVHBSzhENictUM2iavAKiaM5lc9USw/0?wx_fmt=png" data-nickname="R语言数据分析指南" data-alias="YanJANtwo" data-signature="R语言重症爱好者，喜欢绘制各种精美的图表，喜欢的小伙伴可以关注我，跟我一起学习" data-from="0" data-is_biz_ban="0"></mp-common-profile></section><h3 data-tool="mdnice编辑器"><span></span><span><span></span>论文</span><span></span></h3><figure data-tool="mdnice编辑器"><img data-ratio="0.36018518518518516" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZibkT8dzwUQFLT14TdcglqZAkn1WfJHYydqTsFnukbC4Yaywn3mxrTYzAsyicw09MlvlC3RT5xwChA/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZibkT8dzwUQFLT14TdcglqZAkn1WfJHYydqTsFnukbC4Yaywn3mxrTYzAsyicw09MlvlC3RT5xwChA/640?wx_fmt=png"></figure><h3 data-tool="mdnice编辑器"><span></span><span><span></span>原图</span><span></span></h3><figure data-tool="mdnice编辑器"><img data-ratio="0.600925925925926" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZibkT8dzwUQFLT14TdcglqZtKXfYE5cn8dvmw1UjAa02yvc0VJG97ETFEsENNe3PqtyYanFsAHSiaA/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZibkT8dzwUQFLT14TdcglqZtKXfYE5cn8dvmw1UjAa02yvc0VJG97ETFEsENNe3PqtyYanFsAHSiaA/640?wx_fmt=png"></figure><h3 data-tool="mdnice编辑器"><span></span><span><span></span>加载R包</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code><span>library</span>(tidyverse) <br><span>library</span>(cowplot)  <br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span><span></span>导入数据</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code>df &lt;- read_tsv(<span>"group.xls"</span>)<br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span><span></span>绘制热图</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code>heatmap &lt;- df %&gt;% <br>  pivot_longer(-cluster) %&gt;%  <span># 将数据从宽格式转换为长格式，除了"cluster"列</span><br>  separate(`name`, into = <span>"name"</span>, sep = <span>"-"</span>) %&gt;%  <span># 将"name"列根据"-"分隔成新的列</span><br>  ggplot(aes(name, cluster, fill = value)) +  <span># 使用ggplot绘图，设置映射</span><br>  geom_tile() +  <span># 添加瓷砖图层，用于绘制热图</span><br>  scale_y_discrete(position = <span>"right"</span>) +  <span># 设置y轴刻度位置</span><br>  scale_x_discrete(limits = c(<span>"Epipelagic"</span>, <span>"Mesopelagic"</span>, <span>"Deep"</span>)) +  <span># 设置x轴刻度顺序</span><br>  scale_fill_gradientn(colours = rev(RColorBrewer::brewer.pal(<span>11</span>, <span>"RdBu"</span>))) +  <span># 设置颜色渐变</span><br>  theme(  <span># 设置主题</span><br>    panel.background = element_blank(),  <span># 设置面板背景为空</span><br>    plot.background = element_blank(),  <span># 设置绘图背景为空</span><br>    legend.background = element_blank(),  <span># 设置图例背景为空</span><br>    plot.margin = margin(<span>20</span>, <span>200</span>, <span>20</span>, <span>20</span>),  <span># 设置绘图边距</span><br>    axis.title = element_blank(),  <span># 设置轴标题为空</span><br>    axis.ticks = element_blank(),  <span># 设置轴刻度为空</span><br>    axis.text.x = element_text(angle = <span>45</span>, color = <span>"black"</span>, vjust = <span>1</span>, hjust = <span>1</span>),  <span># 设置x轴文字样式</span><br>    legend.position = c(<span>3</span>, <span>0.8</span>),  <span># 设置图例位置</span><br>    legend.title = element_blank()  <span># 设置图例标题为空</span><br>  )<br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span><span></span>绘制线图</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code>line &lt;- read_tsv(<span>"type.xls"</span>) %&gt;% <br>  ggplot(aes(x = type, y = len, group = cluster, color = group)) +  <span># 使用ggplot绘图，设置映射</span><br>  geom_line() +  <span># 添加线图层</span><br>  geom_point(size = <span>2</span>) +  <span># 添加点图层，设置点的大小</span><br>  geom_text(aes(label = text), nudge_x = <span>0.08</span>) +  <span># 添加文本图层，设置文本偏移</span><br>  scale_x_discrete(limits = c(<span>"tVCs"</span>, <span>"Hodts"</span>)) +  <span># 设置x轴刻度顺序</span><br>  scale_color_brewer(palette = <span>"Paired"</span>) +  <span># 设置颜色</span><br>  theme(  <span># 设置主题</span><br>    plot.margin = margin(<span>2</span>, <span>2</span>, <span>2</span>, <span>0</span>),  <span># 设置绘图边距</span><br>    plot.background = element_blank(),  <span># 设置绘图背景为空</span><br>    panel.background = element_blank(),  <span># 设置面板背景为空</span><br>    legend.position = <span>"none"</span>,  <span># 设置图例位置为无</span><br>    panel.grid.major = element_blank(),  <span># 设置主网格为空</span><br>    panel.grid.minor = element_blank(),  <span># 设置次网格为空</span><br>    axis.text.y = element_blank(),  <span># 设置y轴文字为空</span><br>    axis.text.x = element_text(color = <span>"black"</span>, face = <span>"bold"</span>),  <span># 设置x轴文字样式</span><br>    axis.title = element_blank(),  <span># 设置轴标题为空</span><br>    axis.ticks = element_blank()  <span># 设置轴刻度为空</span><br>  )<br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span><span></span>拼图</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code>plot &lt;- heatmap %&gt;% ggdraw() +<br>  draw_plot(line, scale = <span>0.93</span>, x = <span>0.12</span>, y = <span>0.023</span>)  <span># 添加线图到热图上</span><br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span><span></span>图形导出</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code>ggsave(plot, file = <span>"heatmap.pdf"</span>, width = 4.59, height = 8.33, dpi = 300)  <span># 设置文件名、尺寸和分辨率</span><br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="1.3487804878048781" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZibkT8dzwUQFLT14TdcglqZDiaLehMYzRfNvgicqAmUmEakx1Fl5pTnlt5Oicm9P1HGS5s2tQicbx9ctQ/640?wx_fmt=png" data-type="png" data-w="820" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZibkT8dzwUQFLT14TdcglqZDiaLehMYzRfNvgicqAmUmEakx1Fl5pTnlt5Oicm9P1HGS5s2tQicbx9ctQ/640?wx_fmt=png"></figure><blockquote data-tool="mdnice编辑器"><span>❝</span><p>本节内容介绍到此结束，过程仅供参考；有需要学习个性化数据可视化的朋友，欢迎到小编的<strong>「淘宝店铺」</strong> <strong>「R语言数据分析指南」</strong>购买<strong>「2023年度会员文档」</strong>同步更新中<strong>「售价149元」</strong>，内容主要包括各种<strong>「高分论文的图表分析复现以及一些个性化图表的绘制」</strong>均包含数据+代码；按照往年数据小编年产出约在150+以上</p><span>❞</span></blockquote><p data-tool="mdnice编辑器">购买后微信发小编订单截图即邀请进新的会员交流群，小编的文档为按年售卖，只包含当年度的<strong>「除系列课程外」</strong>的文档，有需要往年文档的朋友也可下单购买，需要了解更多信息的朋友欢迎淘宝店铺交流咨询。</p><h3 data-tool="mdnice编辑器"><span></span><span><span></span>淘宝店铺(淘宝扫一扫)</span><span></span></h3><p><img data-galleryid="" data-ratio="1.0210420841683367" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/EibnicgwScTAbvhPDLGT8NaialEsht92PTYNJWpmVLfoYGic1uha5FyBrDCibibZCLjiazgvpT1XcdwibfVywD2el0VAgg/640?wx_fmt=jpeg" data-type="jpeg" data-w="998" src="https://mmbiz.qpic.cn/mmbiz_jpg/EibnicgwScTAbvhPDLGT8NaialEsht92PTYNJWpmVLfoYGic1uha5FyBrDCibibZCLjiazgvpT1XcdwibfVywD2el0VAgg/640?wx_fmt=jpeg"></p><h3 data-tool="mdnice编辑器"><span></span><span><span></span>2023会员群案例展示</span><span></span></h3><p data-tool="mdnice编辑器"><img data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZibkT8dzwUQFLT14TdcglqZY4be8bhqgkHYIhxXT3cwshTzKNOaPnzIcibaJibicp7PobyVNUHaia5MEA/640?wx_fmt=png" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZibkT8dzwUQFLT14TdcglqZY4be8bhqgkHYIhxXT3cwshTzKNOaPnzIcibaJibicp7PobyVNUHaia5MEA/640?wx_fmt=png"><img data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZibkT8dzwUQFLT14TdcglqZ3RNAwNiafprQNnCnnKnxLM6FDn0dzricOhMz27fkkbf8ZuhgKibNqcuVg/640?wx_fmt=png" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZibkT8dzwUQFLT14TdcglqZ3RNAwNiafprQNnCnnKnxLM6FDn0dzricOhMz27fkkbf8ZuhgKibNqcuVg/640?wx_fmt=png"><img data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZibkT8dzwUQFLT14TdcglqZiboQPDnnycGp54pEfL6wNV8JHmpRt1YyWbibqqibTek4yGTFOwostsdsw/640?wx_fmt=png" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZibkT8dzwUQFLT14TdcglqZiboQPDnnycGp54pEfL6wNV8JHmpRt1YyWbibqqibTek4yGTFOwostsdsw/640?wx_fmt=png"><img data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZibkT8dzwUQFLT14TdcglqZTgCoNbuVbm3mq1GL8ic70ADj0KUV1OMc6LfOtFcES8Pe4brgr2VP3xQ/640?wx_fmt=png" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZibkT8dzwUQFLT14TdcglqZTgCoNbuVbm3mq1GL8ic70ADj0KUV1OMc6LfOtFcES8Pe4brgr2VP3xQ/640?wx_fmt=png"><img data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZibkT8dzwUQFLT14TdcglqZwzwwO2x4NQyI9X3zu0Yghne6shFsDJqicdVfviagb0zUWtzICuaNicqOQ/640?wx_fmt=png" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZibkT8dzwUQFLT14TdcglqZwzwwO2x4NQyI9X3zu0Yghne6shFsDJqicdVfviagb0zUWtzICuaNicqOQ/640?wx_fmt=png"><img data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZibkT8dzwUQFLT14TdcglqZny3MBmxV0JcORlcicfw73XRIprhMnHmduqPkC5BndN9vj883OTicA6GA/640?wx_fmt=png" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZibkT8dzwUQFLT14TdcglqZny3MBmxV0JcORlcicfw73XRIprhMnHmduqPkC5BndN9vj883OTicA6GA/640?wx_fmt=png"><img data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZibkT8dzwUQFLT14TdcglqZ5qibD9UNfMtJ1PQYNCMJsJpjRCTicrOICCQEBeypfMxeUEETv4AcOQxQ/640?wx_fmt=png" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZibkT8dzwUQFLT14TdcglqZ5qibD9UNfMtJ1PQYNCMJsJpjRCTicrOICCQEBeypfMxeUEETv4AcOQxQ/640?wx_fmt=png"><img data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZibkT8dzwUQFLT14TdcglqZITEtT5O03XhzLib9yppicTpAL1zjhl2GLoVtHTpjjPJdTR7e95FX7uUg/640?wx_fmt=png" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZibkT8dzwUQFLT14TdcglqZITEtT5O03XhzLib9yppicTpAL1zjhl2GLoVtHTpjjPJdTR7e95FX7uUg/640?wx_fmt=png"><img data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZibkT8dzwUQFLT14TdcglqZsPpiblDK5hibUyhBTGNMNwbY0KEx5r9zJyl4nqTkjjvCXZoAq7TQCSuA/640?wx_fmt=png" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZibkT8dzwUQFLT14TdcglqZsPpiblDK5hibUyhBTGNMNwbY0KEx5r9zJyl4nqTkjjvCXZoAq7TQCSuA/640?wx_fmt=png"></p></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/wDQQtVfSnLsCaJ2LNJa5iQ",target="_blank" rel="noopener noreferrer">原文链接</a>
