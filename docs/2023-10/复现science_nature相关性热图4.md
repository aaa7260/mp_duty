---
title: "复现science/nature相关性热图4"
date: 2023-10-26T00:47:07Z
draft: ["false"]
tags: [
  "fetched",
  "气象水文科研猫"
]
categories: ["Acdemic"]
---
复现science/nature相关性热图4 by 气象水文科研猫
------
<div><p data-mpa-powered-by="yiban.io"><span><strong><span>一、往期相关性热图推文回顾：</span></strong></span><span><br></span></p><section><strong><span><span>1.</span></span><span><span>《</span></span></strong><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzIwODY3MzIxMQ==&amp;mid=2247491845&amp;idx=1&amp;sn=7dbf6c76c3fc27bb8b84eb41bd2cbe25&amp;chksm=977d21d1a00aa8c7c462cccf2b4b09606c10a67497c3a426b6ee6d9e9a88ff5c18b148a2c0ad&amp;token=46187525&amp;lang=zh_CN&amp;scene=21#wechat_redirect" textvalue="免费开源Python和R成为科研主流" linktype="text" imgurl="" imgdata="null" tab="innerlink" data-linktype="2"><strong><span><span>免费开源Python和R成为科研主流</span></span></strong></a><strong><span><span>》</span></span><span><span><br>2.</span></span><span><span>《</span></span></strong><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzIwODY3MzIxMQ==&amp;mid=2247484625&amp;idx=1&amp;sn=07ccc383e9503c8aedd3540de73cdde2&amp;chksm=977ec405a0094d133795e262bd02ab9de9e2022d9e57d44687883f116ad311cac88a87517a91&amp;token=46187525&amp;lang=zh_CN&amp;scene=21#wechat_redirect" textvalue="又谈ggplot分面地图" linktype="text" imgurl="" imgdata="null" tab="innerlink" data-linktype="2"><strong><span><span>又谈ggplot分面地图</span></span></strong></a><strong><span><span>》</span></span></strong></section><section><strong><span><span>3.</span></span><span><span>《</span></span></strong><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzIwODY3MzIxMQ==&amp;mid=2247485038&amp;idx=1&amp;sn=45da0777aed697585ff52e0d964d2337&amp;chksm=977ec6baa0094facee11f48ba99eea2184aaa21b5846023f524eb4e50ddc700c6c9ed9516af8&amp;token=46187525&amp;lang=zh_CN&amp;scene=21#wechat_redirect" textvalue="R语言克里金插值（四）" linktype="text" imgurl="" imgdata="null" tab="innerlink" data-linktype="2"><strong><span><span>R语言克里金插值（四）</span></span></strong></a><strong><span><span>》</span></span></strong></section><section><strong><span><span>4.</span></span><span><span>《</span></span></strong><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzIwODY3MzIxMQ==&amp;mid=2247485299&amp;idx=1&amp;sn=d70409dc2f2e45b470ab265e814e070f&amp;chksm=977ec7a7a0094eb100fa45b944e75c93d753d3074d391c6b727deb260e1ac363cf91d07a886c&amp;token=46187525&amp;lang=zh_CN&amp;scene=21#wechat_redirect" textvalue="R语言热图（完）" linktype="text" imgurl="" imgdata="null" tab="innerlink" data-linktype="2"><strong><span><span>R语言热图（完）</span></span></strong></a><strong><span><span>》</span></span></strong></section><section><strong><span><span>5.</span></span><span><span>《</span></span></strong><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzIwODY3MzIxMQ==&amp;mid=2247498399&amp;idx=1&amp;sn=6faf7f6a4c7a5a3f7b41a9151570ed0e&amp;chksm=977d3a4ba00ab35da80240db8fb7879e7d091fd4b3b5da8d9bbc194c0e2e76c003edee021229&amp;token=1394647166&amp;lang=zh_CN&amp;scene=21#wechat_redirect" textvalue="复现science/nature相关性热图" linktype="text" imgurl="" imgdata="null" tab="innerlink" data-linktype="2"><strong><span><span>复现science/nature相关性热图</span></span></strong></a><strong><span><span>》</span></span></strong></section><section><strong><span><span>6.</span></span><span><span>《</span></span></strong><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzIwODY3MzIxMQ==&amp;mid=2247498583&amp;idx=1&amp;sn=d755f8cc3d3ba5eba67eeef5558591f2&amp;chksm=977d3b83a00ab295f19184858ff822bc5a3383031522aba92ba8f1ad9696de1b989a3983150b&amp;token=1511369470&amp;lang=zh_CN&amp;scene=21#wechat_redirect" textvalue="复现science/nature相关性热图2" linktype="text" imgurl="" imgdata="null" tab="innerlink" data-linktype="2"><strong><span><span>复现science/nature相关性热图2</span></span></strong></a><strong><span><span>》</span></span></strong></section><section><strong><span><span>7.</span></span><span><span>《</span></span></strong><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzIwODY3MzIxMQ==&amp;mid=2247498786&amp;idx=1&amp;sn=9dca0191c8c71e491bbe57086ed84cfb&amp;chksm=977d3cf6a00ab5e0ffb98ea75ef16d9c3fd8887fbf0c028a094bde556a0a79408f27494185db&amp;token=812177580&amp;lang=zh_CN&amp;scene=21#wechat_redirect" textvalue="复现science/nature相关性热图3" linktype="text" imgurl="" imgdata="null" tab="innerlink" data-linktype="2"><strong><span><span>复现science/nature相关性热图3</span></span></strong></a><strong><span><span>》</span></span></strong><span><span></span><strong><span></span></strong></span></section><hr><p><span><strong><span>二、厚缊大佬的ggcor包</span></strong></span></p><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><pre data-tool="mdnice编辑器"><span></span><code>library(ggcor)<br>args(quickcor)<br>quickcor(mtcars)<br>quickcor(mtcars, <span>type</span> = <span>"lower"</span>)<br>quickcor(mtcars[1:6], mtcars)<br>quickcor(mtcars) + geom_colour()<br>quickcor(mtcars) + geom_colour()+ <br>  geom_number(aes(num = r)) <span>#添加数值型文本</span><br>quickcor(mtcars, cor.test = TRUE) + geom_colour()+ <br>  geom_mark()+ <span>#添加相关系数及显著性</span><br></code></pre><p data-tool="mdnice编辑器"><img data-ratio="0.8962962962962963" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/VQj38bogwOLwcXO0UfssMhvNvUoAPLlnUamONIbPju9Dg18uyG2gqYUz9IS3ppc9GfbFMh0RibGZ44BV3TRpOxw/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/VQj38bogwOLwcXO0UfssMhvNvUoAPLlnUamONIbPju9Dg18uyG2gqYUz9IS3ppc9GfbFMh0RibGZ44BV3TRpOxw/640?wx_fmt=png"><img data-ratio="0.9074074074074074" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/VQj38bogwOLwcXO0UfssMhvNvUoAPLlndrGxdvhnKH1DodWqevP2iczLNHibqgEibCFVlYruP0jNau8EERg4CkLHg/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/VQj38bogwOLwcXO0UfssMhvNvUoAPLlndrGxdvhnKH1DodWqevP2iczLNHibqgEibCFVlYruP0jNau8EERg4CkLHg/640?wx_fmt=png"></p><pre data-tool="mdnice编辑器"><span></span><code>library(ggcor)<br>library(ggplot2)<br><span>## 构造数据</span><br>setwd(<span>'./28'</span>)<br>data1 &lt;- read.csv(<span>"test8.csv"</span>, header = TRUE)<br>data &lt;- as.matrix(data1)<br>m1 &lt;- matrix(data[,1:4], nrow = 12)<br>m2 &lt;- matrix(data[,5:8], nrow = 12)<br>m3 &lt;- matrix(data[,9:12], nrow = 12)<br><span>#mat &lt;- cbind(rbind(m1, m2, m3),rbind(m4, m5, m6),rbind(m7, m8, m9))</span><br>mat &lt;- cbind(m1, m2, m3)<br><span>#mat &lt;- cbind(rbind(m1, m2, m3))</span><br>df &lt;- cor_tbl(extra.mat = list(mat = mat))<br>df<br>p &lt;- quickcor(df, mapping = aes(fill = mat)) + <br>  scale_fill_gradient2n(midpoint = mean(mat))<br>p + geom_circle2()+geom_number(aes(num = mat))<br>p + geom_circle2()+ scale_fill_gradientn(colours = c(<span>"green"</span>,<span>"white"</span>, <span>"red"</span>))+geom_number(aes(num = mat))+ <br>  theme(legend.key.height = grid::unit(2.8, <span>"cm"</span>))+<br>  theme(axis.text.x.bottom = element_text(angle = 0, hjust = 1))<br>p1 &lt;- p+ geom_colour()+ scale_fill_gradientn(colours = c(<span>"#99FF33"</span>, <span>"#FF44AA"</span>, <span>"#5599FF"</span>))+ <br>  theme(legend.key.height = grid::unit(3.6, <span>"cm"</span>))+<br>  theme(axis.text.x.bottom = element_text(angle = 0, hjust = 1))+geom_number(aes(num = mat))+<br>  scale_x_continuous(labels = NULL)+scale_y_continuous(labels = NULL)+<br>  scale_x_discrete(limits=c(<span>"2008"</span>,<span>"2009"</span>,<span>"2010"</span>,<span>"2011"</span>,<span>"2012"</span>,<span>"2013"</span>,<span>"2014"</span>,<span>"2015"</span>,<span>"2016"</span>,<span>"2017"</span>,<span>"2018"</span>,<span>"2019"</span>))+<br>  scale_y_discrete(limits=c(<span>"12月"</span>,<span>"11月"</span>,<span>"10月"</span>,<span>"9月"</span>,<span>"8月"</span>,<span>"7月"</span>,<span>"6月"</span>,<span>"5月"</span>,<span>"4月"</span>,<span>"3月"</span>,<span>"2月"</span>,<span>"1月"</span>))+<br>  theme(text=element_text(size=16,  family=<span>"serif"</span>))<br>p1<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.8972222222222223" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/VQj38bogwOLwcXO0UfssMhvNvUoAPLlngBl5tjuk5h0Ud1f9L72SXcHD44mXlYg2v7lfobGIZXZAcSjV35jtVQ/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/VQj38bogwOLwcXO0UfssMhvNvUoAPLlngBl5tjuk5h0Ud1f9L72SXcHD44mXlYg2v7lfobGIZXZAcSjV35jtVQ/640?wx_fmt=png"></figure><hr><section><strong><span>*******************************************</span></strong></section><section><span><strong><span>欢迎加气象水文科研猫主编微信，</span></strong></span></section><section><span><strong><span>免费加入微信交流群，</span></strong></span></section><section><span><strong><span>获取更多免费代码和科研数据。</span></strong></span></section><section><strong><span>*******************************************</span></strong></section><section><img data-ratio="1.271444082519001" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/VQj38bogwOJG5okcEPbNPoh6U7OibH0K9iaC23cU8JJ2KC0mgP5085YKKGBTaKXicGV8tCykyW757GvIufia9QXmgg/640?wx_fmt=jpeg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" data-type="jpeg" data-w="921" src="https://mmbiz.qpic.cn/mmbiz_jpg/VQj38bogwOJG5okcEPbNPoh6U7OibH0K9iaC23cU8JJ2KC0mgP5085YKKGBTaKXicGV8tCykyW757GvIufia9QXmgg/640?wx_fmt=jpeg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"></section></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/X-kvH6N3MhRguk29KXJyOQ",target="_blank" rel="noopener noreferrer">原文链接</a>
