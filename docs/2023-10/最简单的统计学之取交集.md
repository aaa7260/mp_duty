---
title: "最简单的统计学之取交集"
date: 2023-10-30T03:38:10Z
draft: ["false"]
tags: [
  "fetched",
  "生信技能树"
]
categories: ["Acdemic"]
---
最简单的统计学之取交集 by 生信技能树
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><blockquote data-tool="mdnice编辑器"><p>在：<a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247525924&amp;idx=1&amp;sn=aaa305d856a835adda2f842840b96ec2&amp;scene=21#wechat_redirect" data-linktype="2">换一个分析策略会导致文章的全部论点都得推倒重来吗</a>，我们把一个单细胞转录组数据集进行基础的降维聚类分群，并且针对里面的上皮细胞亚群进行细分亚群，而且在 <a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247525967&amp;idx=1&amp;sn=c0b059b4aec399bf76380b9ae9b1d4ac&amp;scene=21#wechat_redirect" data-linktype="2">肿瘤单细胞转录组拷贝数分析结果解读和应用</a>我们根据拷贝数情况判断了其中0,1,6还有cycle是恶性细胞亚群，接下来就通过生存分析聚焦到了恶性增殖的亚群，详见：<a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247526007&amp;idx=1&amp;sn=cf7e7a308ea1b968a36f7921d8aa6462&amp;scene=21#wechat_redirect" data-linktype="2">关键单细胞亚群辅助判定之生存分析</a></p></blockquote><p data-tool="mdnice编辑器">但是这个：<a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247526007&amp;idx=1&amp;sn=cf7e7a308ea1b968a36f7921d8aa6462&amp;scene=21#wechat_redirect" data-linktype="2">关键单细胞亚群辅助判定之生存分析</a> 过程是比较复杂的，因为涉及到了针对不同单细胞亚群的特异性高表达量基因集合在转录组表达量矩阵里面的打分，并且需要高低分组后做生存分析。实际上可以有最简单的取交集即可，代码如下所示：</p><pre data-tool="mdnice编辑器"><span></span><code>rm(list=ls())<br><span>library</span>(survival)<br><span>library</span>(survminer) <br><span>library</span>(ggstatsplot) <br><br>load(<span>'cosg_celltype__marker_cosg.Rdata'</span>) <br>head(marker_cosg)<br>symbols_list &lt;-  as.list(as.data.frame(apply(marker_cosg$names,<span>2</span>,head,<span>100</span>)))<br>names(symbols_list)<br><br>load( file = <span>'batch_cox_results.Rdata'</span>)<br><span>library</span>(remotes)<br>cox_results = na.omit(cox_results)<br>do.call(rbind,lapply(symbols_list, <span>function</span>(x){<br>  <span># x = symbols_list[[1]]</span><br>  x = x[x%<span>in</span>% rownames(cox_results)]<br>  this_cox = as.data.frame(cox_results[x,])<br>  table(this_cox$p &lt; <span>0.01</span>)<br>})) <br></code></pre><p data-tool="mdnice编辑器">上面的代码背后的数据在<span>会持续更新在这个链接哈，大家一定要抽空测试：</span></p><pre data-tool="mdnice编辑器"><span></span><code>链接: https://pan.baidu.com/s/1geW1MTLRizcJWEESdjMN7g?<span>pwd</span>=96t6 提取码: 96t6<br></code></pre><p data-tool="mdnice编辑器"><strong>我们会在视频号直播互动答疑，欢迎预约我们的直播链接！</strong></p><section><mp-common-videosnap data-pluginname="mpvideosnap" data-headimgurl="https://wx.qlogo.cn/finderhead/PiajxSqBRaEI7scvWIPdECSfnUpSjTib9Y7RI14r1VVzxaA57PjcCERw/0" data-username="v2_060000231003b20faec8c7e1881bcad2ca06ec35b07788412aec898c89eb1e34f9a354475e8c@finder" data-nickname="生信技能树" data-desc="将在11月01日 18:00 直播" data-livewording="预约" data-intro="单细胞+生存分析" data-type="live" data-status="0" data-noticeid="finderlivenotice-v2_060000231003b20faec8c7e1881bcad2ca06ec35b07788412aec898c89eb1e34f9a354475e8c@finder-1698583822270546-1422988549"></mp-common-videosnap></section><p data-tool="mdnice编辑器"></p><p data-tool="mdnice编辑器">就可以看到：</p><pre data-tool="mdnice编辑器"><span></span><code>         FALSE TRUE<br>ciliated     93    4<br>AT2          89   11<br><span><strong>cycle        40   59</strong></span><br>0            82   16<br>1            90    5<br>LAMP3-epi    93    4<br>6            86   14<br>secretory    89   11<br>7            91    7<br></code></pre><p data-tool="mdnice编辑器">其中cycle的肿瘤单细胞亚群里面的特异性高表达量基因集合里面的超过一半都是有生存分析的统计学显著性，<strong> 那么毫无疑问它这个亚群就应该是最关键的啦！跟前面的<span>：</span><a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247526007&amp;idx=1&amp;sn=cf7e7a308ea1b968a36f7921d8aa6462&amp;scene=21#wechat_redirect" data-linktype="2">关键单细胞亚群辅助判定之生存分析</a><span> 过程有异曲同工之妙哈</span></strong></p><p><img data-galleryid="" data-ratio="0.319672131147541" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wzmY2v04DGKDiaTnO1vM1kMVOtyobibfC4eEIJ11AtbQjuS1icvL7LA6gWdlMgf2K4Fb13lrhde4c4Gg/640?wx_fmt=png" data-type="png" data-w="1464" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wzmY2v04DGKDiaTnO1vM1kMVOtyobibfC4eEIJ11AtbQjuS1icvL7LA6gWdlMgf2K4Fb13lrhde4c4Gg/640?wx_fmt=png"></p><p data-tool="mdnice编辑器"><strong><span></span></strong></p><p data-tool="mdnice编辑器">虽然说我们上面展现的是肿瘤单细胞亚群里面的特异性高表达量基因集合在生存分析基因集的个数，<strong>但是它实际上是一个交集的简化版，其实这个交集还可以有一个统计学显著性判断方式，</strong>在统计学中，要判断两个集合取交集的结果是否显著，通常需要进行一定的假设检验或者计算一些统计量来评估这种显著性。以下是一些常见的方法：</p><ol data-tool="mdnice编辑器"><li><section><strong>卡方检验（Chi-Square Test）</strong>：如果你有两个分类变量，可以使用卡方检验来判断它们的交集是否显著。卡方检验可以用来比较观察到的频数和期望的频数之间的差异。</section></li><li><section><strong>Fisher's Exact Test</strong>：当你的数据集很小或者不满足卡方检验的假设时，可以使用Fisher's Exact Test。这个检验适用于2x2的列联表数据，用于判断两个分类变量之间的关联是否显著。</section></li><li><section><strong>超几何分布检验（Hypergeometric Test）</strong>：当你处理的数据集是有限的，例如从一个有限的总体中抽取样本，然后想要判断两个集合的交集是否显著时，可以使用超几何分布检验。这个检验考虑了抽样的随机性。</section></li><li><section><strong>Bootstrap方法</strong>：Bootstrap方法可以用于估计两个集合交集的显著性。它通过对样本进行重抽样来估计交集的分布，并计算置信区间或p值来判断显著性。</section></li><li><section><strong>Permutation Test</strong>：排列检验也可以用于估计两个集合交集的显著性。它通过随机地改变一个或多个集合的数据来生成一个随机分布，并与实际观察到的交集进行比较。</section></li><li><section><strong>贝叶斯统计方法</strong>：贝叶斯统计方法可以用于估计两个集合交集的后验分布，从而得出关于显著性的概率分布。</section></li></ol></section><p><br></p><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/5-urz0mwrI_HpZRxmbinNA",target="_blank" rel="noopener noreferrer">原文链接</a>
