---
title: "复现science降雨径流日历图"
date: 2023-10-29T00:28:52Z
draft: ["false"]
tags: [
  "fetched",
  "气象水文科研猫"
]
categories: ["Acdemic"]
---
复现science降雨径流日历图 by 气象水文科研猫
------
<div><p data-mpa-powered-by="yiban.io"><span><strong><span>一、往期相关性热图推文回顾：</span></strong></span><span><br></span></p><section><strong><span><span>1.</span></span><span><span>《</span></span></strong><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzIwODY3MzIxMQ==&amp;mid=2247491845&amp;idx=1&amp;sn=7dbf6c76c3fc27bb8b84eb41bd2cbe25&amp;chksm=977d21d1a00aa8c7c462cccf2b4b09606c10a67497c3a426b6ee6d9e9a88ff5c18b148a2c0ad&amp;token=46187525&amp;lang=zh_CN&amp;scene=21#wechat_redirect" textvalue="免费开源Python和R成为科研主流" linktype="text" imgurl="" imgdata="null" tab="innerlink" data-linktype="2"><strong><span><span>免费开源Python和R成为科研主流</span></span></strong></a><strong><span><span>》</span></span><span><span><br>2.</span></span><span><span>《</span></span></strong><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzIwODY3MzIxMQ==&amp;mid=2247484625&amp;idx=1&amp;sn=07ccc383e9503c8aedd3540de73cdde2&amp;chksm=977ec405a0094d133795e262bd02ab9de9e2022d9e57d44687883f116ad311cac88a87517a91&amp;token=46187525&amp;lang=zh_CN&amp;scene=21#wechat_redirect" textvalue="又谈ggplot分面地图" linktype="text" imgurl="" imgdata="null" tab="innerlink" data-linktype="2"><strong><span><span>又谈ggplot分面地图</span></span></strong></a><strong><span><span>》</span></span></strong></section><section><strong><span><span>3.</span></span><span><span>《</span></span></strong><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzIwODY3MzIxMQ==&amp;mid=2247485038&amp;idx=1&amp;sn=45da0777aed697585ff52e0d964d2337&amp;chksm=977ec6baa0094facee11f48ba99eea2184aaa21b5846023f524eb4e50ddc700c6c9ed9516af8&amp;token=46187525&amp;lang=zh_CN&amp;scene=21#wechat_redirect" textvalue="R语言克里金插值（四）" linktype="text" imgurl="" imgdata="null" tab="innerlink" data-linktype="2"><strong><span><span>R语言克里金插值（四）</span></span></strong></a><strong><span><span>》</span></span></strong></section><section><strong><span><span>4.</span></span><span><span>《</span></span></strong><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzIwODY3MzIxMQ==&amp;mid=2247485299&amp;idx=1&amp;sn=d70409dc2f2e45b470ab265e814e070f&amp;chksm=977ec7a7a0094eb100fa45b944e75c93d753d3074d391c6b727deb260e1ac363cf91d07a886c&amp;token=46187525&amp;lang=zh_CN&amp;scene=21#wechat_redirect" textvalue="R语言热图（完）" linktype="text" imgurl="" imgdata="null" tab="innerlink" data-linktype="2"><strong><span><span>R语言热图（完）</span></span></strong></a><strong><span><span>》</span></span></strong></section><section><strong><span><span>5.</span></span><span><span>《</span></span></strong><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzIwODY3MzIxMQ==&amp;mid=2247498399&amp;idx=1&amp;sn=6faf7f6a4c7a5a3f7b41a9151570ed0e&amp;chksm=977d3a4ba00ab35da80240db8fb7879e7d091fd4b3b5da8d9bbc194c0e2e76c003edee021229&amp;token=1394647166&amp;lang=zh_CN&amp;scene=21#wechat_redirect" textvalue="复现science/nature相关性热图" linktype="text" imgurl="" imgdata="null" tab="innerlink" data-linktype="2"><strong><span><span>复现science/nature相关性热图</span></span></strong></a><strong><span><span>》</span></span></strong></section><section><strong><span><span>6.</span></span><span><span>《</span></span></strong><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzIwODY3MzIxMQ==&amp;mid=2247498583&amp;idx=1&amp;sn=d755f8cc3d3ba5eba67eeef5558591f2&amp;chksm=977d3b83a00ab295f19184858ff822bc5a3383031522aba92ba8f1ad9696de1b989a3983150b&amp;token=1511369470&amp;lang=zh_CN&amp;scene=21#wechat_redirect" textvalue="复现science/nature相关性热图2" linktype="text" imgurl="" imgdata="null" tab="innerlink" data-linktype="2"><strong><span><span>复现science/nature相关性热图2</span></span></strong></a><strong><span><span>》</span></span></strong></section><section><strong><span><span>7.</span></span><span><span>《</span></span></strong><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzIwODY3MzIxMQ==&amp;mid=2247498786&amp;idx=1&amp;sn=9dca0191c8c71e491bbe57086ed84cfb&amp;chksm=977d3cf6a00ab5e0ffb98ea75ef16d9c3fd8887fbf0c028a094bde556a0a79408f27494185db&amp;token=812177580&amp;lang=zh_CN&amp;scene=21#wechat_redirect" textvalue="复现science/nature相关性热图3" linktype="text" imgurl="" imgdata="null" tab="innerlink" data-linktype="2"><strong><span><span>复现science/nature相关性热图3</span></span></strong></a><strong><span><span>》</span></span></strong><span><span></span><strong><span></span></strong></span></section><section><strong><span>8.</span></strong><span><strong><span>《</span></strong></span><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzIwODY3MzIxMQ==&amp;mid=2247498943&amp;idx=1&amp;sn=24352a4f56e2c037c49c875997b2d526&amp;chksm=977d3c6ba00ab57dc67a32364abbd5a809eb15e7237984f8b5739ee1f23b85e9a024ffd9242d&amp;token=493251438&amp;lang=zh_CN&amp;scene=21#wechat_redirect" textvalue="复现science/nature相关性热图4" linktype="text" imgurl="" imgdata="null" tab="innerlink" data-linktype="2"><span><strong><span>复现science/nature相关性热图4</span></strong><strong></strong></span></a><span><strong><span>》</span></strong></span></section><hr><p><span><strong><span>二、ggplot2包绘制降雨径流日历图</span></strong></span></p><p><span><strong><span>特别说明：因论文尚未发表，本文绘图所使用的黄河干流某水文站逐日径流数据不方便公开，故采用随机数据作为示例绘图。</span></strong></span></p><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><pre data-tool="mdnice编辑器"><code>setwd(<span>"./"</span>)<br>library(tidyverse) <span># contains ggplot2 (for plot) and dplyr (for easy data manipulation)</span><br>library(lubridate) <span># For date and time manipulation</span><br>df  &lt;-  tibble(DateCol = seq(<br>    dmy(<span>"01/01/2019"</span>),<br>    dmy(<span>"31/12/2019"</span>),<br>    <span>"days"</span>),ValueCol = runif(365))<br>dfPlot &lt;- df %&gt;% <br>  mutate(weekday = wday(DateCol, label = T, week_start = 7), <span># can put week_start = 1 to start week on Monday</span><br>         month = month(DateCol, label = T),date = yday(DateCol),week = epiweek(DateCol))<br><span># isoweek makes the last week of the year as week 1, so need to change that to week 53 for the plot</span><br>dfPlot<span>$week</span>[dfPlot<span>$month</span>==<span>"12月"</span> &amp; dfPlot<span>$week</span> ==1] = 53 <br>dfPlot &lt;- dfPlot %&gt;% <br>  group_by(month) %&gt;% <br>  mutate(monthweek = 1 + week - min(week))<br>dfPlot %&gt;%  <br>  ggplot(aes(weekday,-week, fill = ValueCol)) +<br>  geom_tile(colour = <span>"white"</span>)  + <br>  theme(aspect.ratio = 1/5,<br>        axis.title.x = element_blank(),<br>        axis.title.y = element_blank(),<br>        axis.text.y = element_blank(),<br>        panel.grid = element_blank(),<br>        axis.ticks = element_blank(),<br>        panel.background = element_blank(),<br>        strip.background = element_blank(),<br>        strip.text = element_text(face = <span>"bold"</span>, size = 15),<br>        panel.border = element_rect(colour = <span>"black"</span>, fill=NA, size=1)) +<br>  facet_wrap(~month, nrow = 4, ncol = 3, scales = <span>"free"</span>) <br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.9009259259259259" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/VQj38bogwOKGV4yibBsOXeAe4GDcywK0xgib6iaQO0vszf8PynUDS8X7y2DBoiaEhibU0EkLHfAA4mp82FJ6ibqy031w/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/VQj38bogwOKGV4yibBsOXeAe4GDcywK0xgib6iaQO0vszf8PynUDS8X7y2DBoiaEhibU0EkLHfAA4mp82FJ6ibqy031w/640?wx_fmt=png"></figure><hr><section><strong><span>*****************************************<strong><span>**</span></strong></span></strong></section><section><span><strong><span>欢迎加气象水文科研猫主编微信，</span></strong></span></section><section><span><strong><span>免费加入微信交流群，</span></strong></span></section><section><span><strong><span>获取更多免费代码和科研数据。</span></strong></span></section><section><strong><span>*****************************************<strong><span>**</span></strong></span></strong></section><section><img data-ratio="1.271444082519001" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/VQj38bogwOJG5okcEPbNPoh6U7OibH0K9iaC23cU8JJ2KC0mgP5085YKKGBTaKXicGV8tCykyW757GvIufia9QXmgg/640?wx_fmt=jpeg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" data-type="jpeg" data-w="921" src="https://mmbiz.qpic.cn/mmbiz_jpg/VQj38bogwOJG5okcEPbNPoh6U7OibH0K9iaC23cU8JJ2KC0mgP5085YKKGBTaKXicGV8tCykyW757GvIufia9QXmgg/640?wx_fmt=jpeg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"></section></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/-6iei4AhX6nRKnO2_OPbew",target="_blank" rel="noopener noreferrer">原文链接</a>
