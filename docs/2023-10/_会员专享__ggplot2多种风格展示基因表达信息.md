---
title: "[会员专享] ggplot2多种风格展示基因表达信息"
date: 2023-10-18T01:38:18Z
draft: ["false"]
tags: [
  "fetched",
  "R语言数据分析指南"
]
categories: ["Acdemic"]
---
[会员专享] ggplot2多种风格展示基因表达信息 by R语言数据分析指南
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><h3 data-tool="mdnice编辑器"><span></span><span><span></span>欢迎关注R语言数据分析指南</span><span></span></h3><blockquote data-tool="mdnice编辑器"><span>❝</span><p>前面介绍了如何基于分析筛选出来的hub基因来进行数据展示，数据为随机抽取无实际意义过程仅供参考，希望对各位观众老爷能有新的帮助，数据和代码已经被打包并上传到小编的2023VIP会员交流群。已经加群的朋友可以自行下载。如果你需要，可以参考文末的方式进行购买。</p><span>❞</span></blockquote><h3 data-tool="mdnice编辑器"><span></span><span><span></span>关注下方公众号下回更新不迷路</span><span></span></h3><section><mp-common-profile data-pluginname="mpprofile" data-id="Mzg3MzQzNTYzMw==" data-headimg="http://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZF0rpeZII9Ltl26VbVagriczTria1fib3XgjwwHEHFjPzkmGpqWDVVHBSzhENictUM2iavAKiaM5lc9USw/0?wx_fmt=png" data-nickname="R语言数据分析指南" data-alias="YanJANtwo" data-signature="R语言重症爱好者，喜欢绘制各种精美的图表，喜欢的小伙伴可以关注我，跟我一起学习" data-from="0" data-is_biz_ban="0"></mp-common-profile></section><h3 data-tool="mdnice编辑器"><span></span><span><span></span>图形展示</span><span></span></h3><p data-tool="mdnice编辑器"><img data-ratio="0.40555555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAbEPSqOy1YRa1ITGFj4WxwPpFMdSmu6CBL3o5WPhe44m6lJDcI0fSf5GxxOn7hP8hHibzu5V3PfUaQ/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAbEPSqOy1YRa1ITGFj4WxwPpFMdSmu6CBL3o5WPhe44m6lJDcI0fSf5GxxOn7hP8hHibzu5V3PfUaQ/640?wx_fmt=png"><img data-ratio="0.40555555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAbEPSqOy1YRa1ITGFj4WxwPqsBwpnqPCvN0V8mBbwQsNciawddPTpOpaD9wHhmgc0icIqFhPMMUultw/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAbEPSqOy1YRa1ITGFj4WxwPqsBwpnqPCvN0V8mBbwQsNciawddPTpOpaD9wHhmgc0icIqFhPMMUultw/640?wx_fmt=png"></p><blockquote data-tool="mdnice编辑器"><span>❝</span><p>可以根据自己的喜好选择两种类型进行展示，若hub基因少则可以使用箱线图的形式，热图则适合大数据量来进行展示。其本质均为基础图形添加显著性标记，主要点在于数据整理与格式转换。</p><span>❞</span></blockquote><h3 data-tool="mdnice编辑器"><span></span><span><span></span>加载R包</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code><span>library</span>(tidyverse)<br><span>library</span>(aplot)<br><span>library</span>(scico)<br><span>library</span>(rstatix)<br><span>library</span>(ggpubr)<br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span><span></span>格式转换</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code>df &lt;- read_tsv(<span>"diff_GeneExp.txt"</span>) %&gt;% <br>  pivot_longer(-ID) %&gt;%  <span># 将数据从宽格式转为长格式</span><br>  mutate(type=map_chr(name, ~str_split(.x, <span>"_"</span>)[[<span>1</span>]][length(str_split(.x, <span>"_"</span>)[[<span>1</span>]])])) <span># 提取类型信息</span><br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span><span></span>Wilcoxon检验</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code>df_p_val1 &lt;- df %&gt;% group_by(ID) %&gt;%<br>  wilcox_test(value ~<span>type</span>) %&gt;%  <span># 进行Wilcoxon检验</span><br>  adjust_pvalue(p.col = <span>"p"</span>, method = <span>"bonferroni"</span>) %&gt;%  <span># 对p值进行Bonferroni调整</span><br>  add_significance(p.col = <span>"p.adj"</span>) %&gt;%  <span># 添加显著性标记</span><br>  add_xy_position(x = <span>"ID"</span>, dodge = 0.8)  <span># 添加x和y的位置信息</span><br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span><span></span>绘制箱线图</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code><span># 绘制箱线图，并添加p值标记</span><br>df %&gt;% ggplot(aes(ID,value))+<br>  stat_boxplot(geom=<span>"errorbar"</span>,aes(fill=type),<br>               position=position_dodge(width=<span>0.6</span>),width=<span>0.1</span>)+  <span># 添加箱线图的误差线</span><br>  geom_boxplot(aes(fill=type),position=position_dodge(width =<span>0.6</span>),width=<span>0.4</span>,outlier.shape = <span>NA</span>)+  <span># 绘制箱线图</span><br>  stat_pvalue_manual(df_p_val1,label = <span>"p.adj.signif"</span>,label.size=<span>4</span>,hide.ns = <span>T</span>,<br>                     tip.length = <span>0.01</span>)+  <span># 手动添加p值标记</span><br>  scale_size_continuous(range=c(<span>1</span>,<span>3</span>))+  <span># 设置大小的范围</span><br>  scale_fill_manual(values=c(<span>"#3CB2EC"</span>,<span>"#9C8D58"</span>))+  <span># 手动设置填充颜色</span><br>  labs(x=<span>NULL</span>,y=<span>NULL</span>)+  <span># 设置x和y轴标签</span><br>  theme_test()+  <span># 使用测试主题</span><br>  theme(plot.margin=unit(c(<span>0.5</span>,<span>0.5</span>,<span>0.5</span>,<span>0.5</span>),units=<span>"cm"</span>),  <span># 设置图形边距</span><br>        axis.line = element_line(color = <span>"black"</span>,size = <span>0.3</span>),  <span># 设置轴线</span><br>        panel.grid.minor = element_blank(),  <span># 移除次要网格线</span><br>        panel.grid.major = element_line(size = <span>0.2</span>,color = <span>"#e5e5e5"</span>),  <span># 设置主要网格线</span><br>        axis.text.y = element_text(color=<span>"black"</span>,size=<span>8</span>),  <span># 设置y轴文本</span><br>        axis.text.x = element_text(margin = margin(t = <span>2</span>),color=<span>"black"</span>,size=<span>8</span>),  <span># 设置x轴文本</span><br>        legend.position = <span>"none"</span>)+  <span># 移除图例</span><br>  coord_cartesian()  <span># 使用笛卡尔坐标系</span><br></code></pre><blockquote data-tool="mdnice编辑器"><span>❝</span><p>有需要学习个性化数据可视化的朋友，欢迎到小编的<strong>「淘宝店铺」</strong> <strong>「R语言数据分析指南」</strong>购买<strong>「2023年度会员文档」</strong>同步更新中<strong>「售价149元」</strong>，内容主要包括各种<strong>「高分论文的图表分析复现以及一些个性化图表的绘制」</strong>均包含数据+代码；按照往年数据小编年产出约在150+以上</p><span>❞</span></blockquote><p data-tool="mdnice编辑器">购买后微信发小编订单截图即邀请进新的会员交流群，小编的文档为按年售卖，只包含当年度的<strong>「除系列课程外」</strong>的文档，有需要往年文档的朋友也可下单购买，需要了解更多信息的朋友欢迎淘宝店铺交流咨询。</p><h3 data-tool="mdnice编辑器"><span></span><span><span></span>淘宝店铺(淘宝扫一扫)</span><span></span></h3><p><img data-galleryid="" data-ratio="1.0210420841683367" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/EibnicgwScTAbvhPDLGT8NaialEsht92PTYNJWpmVLfoYGic1uha5FyBrDCibibZCLjiazgvpT1XcdwibfVywD2el0VAgg/640?wx_fmt=jpeg" data-type="jpeg" data-w="998" src="https://mmbiz.qpic.cn/mmbiz_jpg/EibnicgwScTAbvhPDLGT8NaialEsht92PTYNJWpmVLfoYGic1uha5FyBrDCibibZCLjiazgvpT1XcdwibfVywD2el0VAgg/640?wx_fmt=jpeg"></p><h3 data-tool="mdnice编辑器"><span></span><span><span></span>2023会员群案例展示</span><span></span></h3><p data-tool="mdnice编辑器"><img data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAbEPSqOy1YRa1ITGFj4WxwPpuWNIGE1n3yxJHHNAL0pSvxTvXUI0prBK9jYZeBAED4nbsCs961yDA/640?wx_fmt=png" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAbEPSqOy1YRa1ITGFj4WxwPpuWNIGE1n3yxJHHNAL0pSvxTvXUI0prBK9jYZeBAED4nbsCs961yDA/640?wx_fmt=png"><img data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAbEPSqOy1YRa1ITGFj4WxwPrSYLeicgMEGVYgO9qZ9HC9mfDdBIibiaFDGPs4r55I5TAswkvvhicZZqDw/640?wx_fmt=png" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAbEPSqOy1YRa1ITGFj4WxwPrSYLeicgMEGVYgO9qZ9HC9mfDdBIibiaFDGPs4r55I5TAswkvvhicZZqDw/640?wx_fmt=png"><img data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAbEPSqOy1YRa1ITGFj4WxwPfpQNVfmxXBXTHiaQeCvAM0z6x3Ig4icWNGu5gpye5iaRvkTg00JlQHf9Q/640?wx_fmt=png" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAbEPSqOy1YRa1ITGFj4WxwPfpQNVfmxXBXTHiaQeCvAM0z6x3Ig4icWNGu5gpye5iaRvkTg00JlQHf9Q/640?wx_fmt=png"><img data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAbEPSqOy1YRa1ITGFj4WxwPYnJPFibLMuwtUXJanthPdxhAJk8dgloG8JRPuDtdRwZrdmicDfIiaPyTw/640?wx_fmt=png" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAbEPSqOy1YRa1ITGFj4WxwPYnJPFibLMuwtUXJanthPdxhAJk8dgloG8JRPuDtdRwZrdmicDfIiaPyTw/640?wx_fmt=png"><img data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAbEPSqOy1YRa1ITGFj4WxwPBpDxkZicHJkfMF6jylsTaL5l6EicBRP18a24ibHbuatzVThrYJFmcsC6g/640?wx_fmt=png" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAbEPSqOy1YRa1ITGFj4WxwPBpDxkZicHJkfMF6jylsTaL5l6EicBRP18a24ibHbuatzVThrYJFmcsC6g/640?wx_fmt=png"><img data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAbEPSqOy1YRa1ITGFj4WxwPfmmnYffqqRTK1UfeBS0L8IEDhdhpbO55A9AF1HxSnS7Tz43FQfiar9w/640?wx_fmt=png" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAbEPSqOy1YRa1ITGFj4WxwPfmmnYffqqRTK1UfeBS0L8IEDhdhpbO55A9AF1HxSnS7Tz43FQfiar9w/640?wx_fmt=png"><img data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAbEPSqOy1YRa1ITGFj4WxwPHR7icQsbfibKhnJXlX4MgfTyvvDxyScibO8NVSpA6oGBy6CnJHGbAOKYw/640?wx_fmt=png" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAbEPSqOy1YRa1ITGFj4WxwPHR7icQsbfibKhnJXlX4MgfTyvvDxyScibO8NVSpA6oGBy6CnJHGbAOKYw/640?wx_fmt=png"><img data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAbEPSqOy1YRa1ITGFj4WxwPtXgMHCe0IzUq1N2rRC1BDLJsNW2HwjkloI5oktX95rlV2Ix3sopu7Q/640?wx_fmt=png" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAbEPSqOy1YRa1ITGFj4WxwPtXgMHCe0IzUq1N2rRC1BDLJsNW2HwjkloI5oktX95rlV2Ix3sopu7Q/640?wx_fmt=png"><img data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAbEPSqOy1YRa1ITGFj4WxwPCycU1Wic5oibTGJ4kz120k6lWMnsuGUXswf4SUAyhFSmAaV5qZgGcP8A/640?wx_fmt=png" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAbEPSqOy1YRa1ITGFj4WxwPCycU1Wic5oibTGJ4kz120k6lWMnsuGUXswf4SUAyhFSmAaV5qZgGcP8A/640?wx_fmt=png"></p><h3 data-tool="mdnice编辑器"><span></span><span><span></span>数据清洗</span><span></span></h3><p><mp-pay-preview-filter data-offset="22"></mp-pay-preview-filter></p></section></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/PPR0wWjrno4UBaNBJQbYDg",target="_blank" rel="noopener noreferrer">原文链接</a>
