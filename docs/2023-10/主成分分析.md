---
title: "主成分分析"
date: 2023-10-02T13:45:29Z
draft: ["false"]
tags: [
  "fetched",
  "庄闪闪的R语言手册"
]
categories: ["Acdemic"]
---
主成分分析 by 庄闪闪的R语言手册
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-mpa-powered-by="yiban.io"><p><span>点击下方</span><span>公众号</span><span>，回复</span><span>资料分享</span><span>，收获惊喜</span></p><p><span></span></p><section><mp-common-profile data-pluginname="mpprofile" data-id="MzI1NjUwMjQxMQ==" data-headimg="http://mmbiz.qpic.cn/mmbiz_png/MIcgkkEyTHiaOjUwXredJLzMleuKP97WYf7W4ylibNiaRJlP7icneHRGekYcQEPgTLpIDbibTuuEADhn0Sv4Xqhhf4A/0?wx_fmt=png" data-nickname="庄闪闪的R语言手册" data-alias="Zss_R4ds" data-signature="在读统计博士生，R语言爱好者。来跟着我一起学 R 数据科学，可视化。" data-from="2" data-is_biz_ban="0"></mp-common-profile></section><h2 data-tool="mdnice编辑器"><span> </span><span></span><span>1 主成分分析 简介</span><span></span><span> </span></h2><p data-tool="mdnice编辑器">主成分分析（Principal Component Analysis,PCA），是考察多个变量间相关性的一种多元统计方法，<span>基本思想</span><sup>[1]</sup>就是在保留原始变量尽可能多的信息的前提下达到降维的目的，从而简化问题的复杂性并抓住问题的主要矛盾。最后筛选出的几个替代原始数据的变量被称为主成分，它们是原始变量的线性组合，关系图如下：<img data-ratio="0.6124620060790273" data-src="https://mmbiz.qpic.cn/mmbiz_png/MIcgkkEyTHjeQChVPesk2bSW2vf0I9SREa2IBBI6LkMsqqqC8oYqU9c0yBTLib1fzrUg3n8kDZjiawiagiaChfEFoA/640?wx_fmt=png" data-type="png" data-w="658" src="https://mmbiz.qpic.cn/mmbiz_png/MIcgkkEyTHjeQChVPesk2bSW2vf0I9SREa2IBBI6LkMsqqqC8oYqU9c0yBTLib1fzrUg3n8kDZjiawiagiaChfEFoA/640?wx_fmt=png"></p><h2 data-tool="mdnice编辑器"><span> </span><span></span><span>2 主成分分析 步骤</span><span></span><span> </span></h2><ul data-tool="mdnice编辑器"><li><section>构建原始数据矩阵；</section></li><li><section>消除量纲——数据标准化；</section></li><li><section>建立协方差矩阵（或相关系数矩阵）；</section></li><li><section>求出特征值、特征向量；</section></li><li><section>根据方差、累计方差贡献率确定主成分个数；</section></li><li><section>求出综合得分，给出现实意义的解释。</section></li></ul><h2 data-tool="mdnice编辑器"><span> </span><span></span><span>3 R语言实战</span><span></span><span> </span></h2><p data-tool="mdnice编辑器">依据《R语言实战》提供的实例，下面用<strong>psych</strong>程序包中的<strong>USJudgeRatings</strong>数据集进行主成分分析，这个数据集描述的是律师对美国高等法院法官的评分情况，部分数据集及各变量含义如下所示：<img data-ratio="0.26125244618395305" data-src="https://mmbiz.qpic.cn/mmbiz_png/MIcgkkEyTHjeQChVPesk2bSW2vf0I9SRoEFz7nvJGXSCuLL8Dm3e1fgGj745SibIA6C7b8BDQpuu9r3Keuiaibwrw/640?wx_fmt=png" data-type="png" data-w="1022" src="https://mmbiz.qpic.cn/mmbiz_png/MIcgkkEyTHjeQChVPesk2bSW2vf0I9SRoEFz7nvJGXSCuLL8Dm3e1fgGj745SibIA6C7b8BDQpuu9r3Keuiaibwrw/640?wx_fmt=png"></p><pre data-tool="mdnice编辑器"><code>&gt;install.packages(<span>"psych"</span>)<br>&gt;<span>library</span>(psych)<br>&gt;USJudgeRatingsz<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.38961038961038963" data-src="https://mmbiz.qpic.cn/mmbiz_png/MIcgkkEyTHjeQChVPesk2bSW2vf0I9SRowwzuOa5bMXCNAJQqZsUncicIxclrRBf2Km6RgOhPFFNQP5xmRrGg0g/640?wx_fmt=png" data-type="png" data-w="1078" src="https://mmbiz.qpic.cn/mmbiz_png/MIcgkkEyTHjeQChVPesk2bSW2vf0I9SRowwzuOa5bMXCNAJQqZsUncicIxclrRBf2Km6RgOhPFFNQP5xmRrGg0g/640?wx_fmt=png"></figure><h4 data-tool="mdnice编辑器"><span></span>3.1 数据预处理<span></span></h4><p data-tool="mdnice编辑器">数据集中的<strong>CONT</strong>变量表示的是律师与法官的联系次数，由于该变量对评分情况没有影响，考虑在进行主成分分析时将其剔除，用<strong>cor</strong>函数检查变量间的相关性。<img data-ratio="0.3655107778819119" data-src="https://mmbiz.qpic.cn/mmbiz_png/MIcgkkEyTHjeQChVPesk2bSW2vf0I9SROY1S91F92ickxiasP4SYevic6helCia3cuVWbbicfNlibnj0JO9NIyfV2aGg/640?wx_fmt=png" data-type="png" data-w="1067" src="https://mmbiz.qpic.cn/mmbiz_png/MIcgkkEyTHjeQChVPesk2bSW2vf0I9SROY1S91F92ickxiasP4SYevic6helCia3cuVWbbicfNlibnj0JO9NIyfV2aGg/640?wx_fmt=png">从相关系数矩阵中可以发现，有几个变量之间的相关性还是非常强的，表明这份数据适合做主成分分析。</p><h4 data-tool="mdnice编辑器"><span></span>3.2 构建主成分模型<span></span></h4><p data-tool="mdnice编辑器">R中构建主成分模型的常用函数有<strong>pricipal()</strong> 和<strong>princomp()</strong>，两者不同之处在于: <strong>pricipal()</strong> 只返回最佳nfactor的子集，而<strong>princomp()</strong> 将会得到和变量个数一样多的主成分。</p><ul data-tool="mdnice编辑器"><li><section>使用psych包中的pricipal()</section></li></ul><pre data-tool="mdnice编辑器"><code>&gt;pc&lt;-principal(USJudgeRatings,nfactors=<span>1</span>)<br>&gt;pc<br></code></pre><p data-tool="mdnice编辑器"><img data-ratio="0.48261758691206547" data-src="https://mmbiz.qpic.cn/mmbiz_png/MIcgkkEyTHjeQChVPesk2bSW2vf0I9SRNzKjkSPBFr91E3iaN0B4eX5sP0ByBvGIOd3lekej4lHPk7kG8ESxPwQ/640?wx_fmt=png" data-type="png" data-w="978" src="https://mmbiz.qpic.cn/mmbiz_png/MIcgkkEyTHjeQChVPesk2bSW2vf0I9SRNzKjkSPBFr91E3iaN0B4eX5sP0ByBvGIOd3lekej4lHPk7kG8ESxPwQ/640?wx_fmt=png"><img data-ratio="0.3916876574307305" data-src="https://mmbiz.qpic.cn/mmbiz_png/MIcgkkEyTHjeQChVPesk2bSW2vf0I9SRNfVr6iae6HFaT8jTibppbD2ibLZdWbWeWO9Bz6cpuRN97wnp2y9paS2Dw/640?wx_fmt=png" data-type="png" data-w="794" src="https://mmbiz.qpic.cn/mmbiz_png/MIcgkkEyTHjeQChVPesk2bSW2vf0I9SRNfVr6iae6HFaT8jTibppbD2ibLZdWbWeWO9Bz6cpuRN97wnp2y9paS2Dw/640?wx_fmt=png"></p><ul data-tool="mdnice编辑器"><li><section>使用基础函数pricomp()</section></li></ul><pre data-tool="mdnice编辑器"><code>&gt;pc&lt;-princomp(USJudgeRatings,cor=<span>T</span>)<br>&gt;summary(pc)<br></code></pre><p data-tool="mdnice编辑器">运行结果如下所示：<img data-ratio="0.37037037037037035" data-src="https://mmbiz.qpic.cn/mmbiz_png/MIcgkkEyTHjeQChVPesk2bSW2vf0I9SRf62PQ9GOpo2YpExZVqM5ia5NyY3iciaCVecRyHOfLSS1QzZGAmpdGJXTw/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/MIcgkkEyTHjeQChVPesk2bSW2vf0I9SRf62PQ9GOpo2YpExZVqM5ia5NyY3iciaCVecRyHOfLSS1QzZGAmpdGJXTw/640?wx_fmt=png"></p><h4 data-tool="mdnice编辑器"><span></span>3.3 确定主成分个数<span></span></h4><p data-tool="mdnice编辑器"><span>原则</span><sup>[2]</sup>：</p><ul data-tool="mdnice编辑器"><li><section>根据先验经验和理论知识判断主成分个数</section></li><li><section>根据解释变量的累积方差贡献率来判断主成分个数</section></li><li><section>通过检查变量间的相关系数矩阵来判断保留的主成分个数</section></li></ul><p data-tool="mdnice编辑器">碎石图能够直观地展现要选择的主成分数目，图中急剧的中断表明需要提取的主成分的适当数量，从图中可知最佳的主成分个数为1。</p><pre data-tool="mdnice编辑器"><code>&gt;fa.parallel(cor(USJudgeRatings),fa=<span>"pc"</span>,n.iter = <span>100</span>,show.legend = <span>F</span>,main = <span>"Scree plot with parallel analysis"</span>)<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.8740740740740741" data-src="https://mmbiz.qpic.cn/mmbiz_png/MIcgkkEyTHjeQChVPesk2bSW2vf0I9SRl9zIvrLpnM3cJLGxAGAGaiadXZDSyVozFoxwsEOLicrFmomLQfQro3nw/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/MIcgkkEyTHjeQChVPesk2bSW2vf0I9SRl9zIvrLpnM3cJLGxAGAGaiadXZDSyVozFoxwsEOLicrFmomLQfQro3nw/640?wx_fmt=png"></figure><h4 data-tool="mdnice编辑器"><span></span>3.4 提取主成分<span></span></h4><p data-tool="mdnice编辑器">从<strong>pricipal()</strong> 和碎石图的运行结果可知，第一主成分（PC1）与每一个变量都高度相关，也就是说，PC1是一个可用来进行一般性评价的维度。</p><p data-tool="mdnice编辑器">运行结果中的<strong>h2</strong>指主成分对每个变量的方差解释度，<strong>u2</strong>指方差无法被主成分解释的比例。例如，法官正直度（INTG）84%的方差可以用PC1来解释，15.65%的方差不能由PC1来解释。SS loadings行包含了与主成分相关联的特征值。Proportion Var行表示的是每个主成分对整个数据集的解释程度。</p><h4 data-tool="mdnice编辑器"><span></span>3.5 主成分旋转<span></span></h4><p data-tool="mdnice编辑器">旋转后得到的主成分能更容易的解释原始变量，常用的旋转方法有：</p><ul data-tool="mdnice编辑器"><li><section>正交旋转：旋转后的主成分不相关</section></li><li><section>斜交旋转：旋转后的主成分相关</section></li></ul><p data-tool="mdnice编辑器">本例中采用正交旋转中的方差极大旋转进行分析：</p><pre data-tool="mdnice编辑器"><code>&gt;rc&lt;-principal(USJudgeRatings,nfactors = <span>1</span>,rotate=<span>"varimax"</span>)<br>&gt; rc<br></code></pre><p data-tool="mdnice编辑器">旋转后的结果如下：<img data-ratio="0.48834853090172237" data-src="https://mmbiz.qpic.cn/mmbiz_png/MIcgkkEyTHjeQChVPesk2bSW2vf0I9SRKWOibUZ8NGDVN6KibVOFdS1mnXL6q24a51h40VNR0BIKIhS2UTm6LxBQ/640?wx_fmt=png" data-type="png" data-w="987" src="https://mmbiz.qpic.cn/mmbiz_png/MIcgkkEyTHjeQChVPesk2bSW2vf0I9SRKWOibUZ8NGDVN6KibVOFdS1mnXL6q24a51h40VNR0BIKIhS2UTm6LxBQ/640?wx_fmt=png"></p><h4 data-tool="mdnice编辑器"><span></span>3.6 计算主成分得分<span></span></h4><ul data-tool="mdnice编辑器"><li><section>从原始数据中获取主成分得分</section></li></ul><pre data-tool="mdnice编辑器"><code>pc&lt;-principal(USJudgeRatings,nfactors = <span>1</span>,scores=<span>T</span> )<br>pc$scores<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.5856079404466501" data-src="https://mmbiz.qpic.cn/mmbiz_png/MIcgkkEyTHjeQChVPesk2bSW2vf0I9SRaes3FnvXJlTafNE34RAYdIuiajsTN6XIh9Ziahn8ib0boibUicya0eGwDqw/640?wx_fmt=png" data-type="png" data-w="806" src="https://mmbiz.qpic.cn/mmbiz_png/MIcgkkEyTHjeQChVPesk2bSW2vf0I9SRaes3FnvXJlTafNE34RAYdIuiajsTN6XIh9Ziahn8ib0boibUicya0eGwDqw/640?wx_fmt=png"></figure><ul data-tool="mdnice编辑器"><li><section>当主成分分析基于相关系数矩阵时，无法从原始数据获得主成分得分，但是可以计算主成分得分的系数。</section></li></ul><pre data-tool="mdnice编辑器"><code>rc&lt;-principal(cor(USJudgeRatings),nfactors = <span>1</span>)<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.4938398357289528" data-src="https://mmbiz.qpic.cn/mmbiz_png/MIcgkkEyTHjeQChVPesk2bSW2vf0I9SROjUCDaRn5icbErOHrT9oJEjV12zMhtdBPQKrjo3Nkk9SVYBdUbug0mA/640?wx_fmt=png" data-type="png" data-w="974" src="https://mmbiz.qpic.cn/mmbiz_png/MIcgkkEyTHjeQChVPesk2bSW2vf0I9SROjUCDaRn5icbErOHrT9oJEjV12zMhtdBPQKrjo3Nkk9SVYBdUbug0mA/640?wx_fmt=png"></figure><h2 data-tool="mdnice编辑器"><span> </span><span></span><span>4 模型评价</span><span></span><span> </span></h2><p data-tool="mdnice编辑器">从运行结果可知，PC1的累积方差贡献率为0.92，说明第一主成分可以解释原始变量92%的方差变化，模型拟合效果良好。</p><h3 data-tool="mdnice编辑器"><span>参考资料</span></h3><section data-tool="mdnice编辑器"><span><span>[1]</span><p>基本思想: <em>《多元统计分析第5版_何晓群》</em></p></span><span><span>[2]</span><p>原则: <em>《R语言实战》</em></p></span></section><section><strong><span></span></strong><span></span></section></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/Px-3HrKOx8HVx2eflhtj3Q",target="_blank" rel="noopener noreferrer">原文链接</a>
