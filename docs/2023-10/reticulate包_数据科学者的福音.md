---
title: "reticulate包｜数据科学者的福音"
date: 2023-10-18T08:41:00Z
draft: ["false"]
tags: [
  "fetched",
  "庄闪闪的R语言手册"
]
categories: ["Acdemic"]
---
reticulate包｜数据科学者的福音 by 庄闪闪的R语言手册
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-mpa-powered-by="yiban.io"><figure data-tool="mdnice编辑器"></figure></section><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><figure data-tool="mdnice编辑器"><img data-ratio="0.5229759299781181" data-src="https://mmbiz.qpic.cn/mmbiz_png/MIcgkkEyTHiaYhLSLMyMPX9msaJmvnMr3SUhKqG3ibfWiaXGGM5UxUyHAWflDichjbv38WOb3d4aon93QsHicFM6Icg/640?wx_fmt=png" data-type="png" data-w="914" src="https://mmbiz.qpic.cn/mmbiz_png/MIcgkkEyTHiaYhLSLMyMPX9msaJmvnMr3SUhKqG3ibfWiaXGGM5UxUyHAWflDichjbv38WOb3d4aon93QsHicFM6Icg/640?wx_fmt=png"></figure><h2 data-tool="mdnice编辑器"><span></span><span>前言</span></h2><p data-tool="mdnice编辑器">如果你还在纠结：学数据科学到底用 python 还是 R 好？现在我的回答是：大可不必。现在两者的变量可以相互调用了。你可以用 R 做数据处理（<code>tidyverse</code>），可视化（<code>ggplot2</code>），用 python 做开发。具体可参考该文章:<span>R Vs Python: What’s the Difference?</span><sup>[1]</sup></p><p data-tool="mdnice编辑器">这一切有它就行了——<strong>reticulate 包</strong></p><p data-tool="mdnice编辑器">reticulate 包涵盖了用于 Python 和 R 之间协同操作的全套工具，在 R 和 Rstudio 中均可使用，主要包括：</p><p data-tool="mdnice编辑器">1）在 R 中支持多种方式调用 Python。包括 R Markdown、加载 Python 脚本、导入 Python 模块以及在 R 会话中交互式地使用 Python。</p><p data-tool="mdnice编辑器">2）实现 R 和 Python 对象之间的转换(例如 R 和 Python 数据框、R 矩阵与 NumPy 数组之间)。</p><p data-tool="mdnice编辑器">在 R 会话中嵌入了 Python 会话，从而实现了无缝的、高性能的互操作性。如果你是使用 Python 进行某些工作的 R 开发人员或使用两种语言的数据科学团队的成员，那么 reticulate 包可以极大地简化你的工作流程！官方资料可见：<span>reticulate 网站</span><sup>[2]</sup></p><h2 data-tool="mdnice编辑器"><span></span><span>本文框架</span></h2><figure data-tool="mdnice编辑器"><img data-ratio="1.2284541723666211" data-src="https://mmbiz.qpic.cn/mmbiz_png/MIcgkkEyTHiaYhLSLMyMPX9msaJmvnMr32ZhsicRtNyoWMYNOIRbkEe1et35w267U8tficrdWtrxENzNnqicZIhsMw/640?wx_fmt=png" data-type="png" data-w="731" src="https://mmbiz.qpic.cn/mmbiz_png/MIcgkkEyTHiaYhLSLMyMPX9msaJmvnMr32ZhsicRtNyoWMYNOIRbkEe1et35w267U8tficrdWtrxENzNnqicZIhsMw/640?wx_fmt=png"></figure><h2 data-tool="mdnice编辑器"><span></span><span>前期准备</span></h2><h3 data-tool="mdnice编辑器"><span></span><span>安装 reticulate 包</span><span></span></h3><p data-tool="mdnice编辑器">可以直接安装，并进行加载，非常方便。</p><pre data-tool="mdnice编辑器"><span></span><code>install.packages(<span>"reticulate"</span>)<br>library(<span>"reticulate"</span>)<br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span>下载 python 库</span><span></span></h3><p data-tool="mdnice编辑器">假设我们想用 pandas 库，但是有没有安装，那么一种方法是可以在 R 引擎下运行以下代码。可以下载 python 第三方库，也可以查看是否安装成功等其他操作。</p><pre data-tool="mdnice编辑器"><span></span><code>py_install(<span>"pandas"</span>) <span>#下载scipy库</span><br>py_module_available(<span>"pandas"</span>) <span>#查看是否安装成功</span><br><span>#repl_python()# 查看python路径</span><br><span>#use_python("D:/anaconda/python.exe") #更换python路径</span><br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span>导入 python 库</span><span></span></h3><p data-tool="mdnice编辑器">安装完第三方库，就可以将其进行导入了，这里也是在 R 引擎下进行。</p><pre data-tool="mdnice编辑器"><span></span><code>pd &lt;- import(<span>"pandas"</span>)<br></code></pre><p data-tool="mdnice编辑器">可以发现，这与 pthon 代码不同的是：</p><ul data-tool="mdnice编辑器"><li><section><code>import("os)</code>代替了<code>import os</code></section></li><li><section><code>$</code>代替了<code>.</code></section></li><li><section><code>&lt;-</code> 代替了 <code>=</code></section></li></ul><h2 data-tool="mdnice编辑器"><span></span><span>3.常用操作</span></h2><p data-tool="mdnice编辑器">reticulate 包含一个用于 R Markdown 的 Python 引擎，具有以下功能，具体可见<span>reticulate: R interface to Python</span><sup>[3]</sup>：</p><p data-tool="mdnice编辑器">1）可在 R 会话中嵌入的单个 Python 会话中，运行 Python 块。同时 Python 块之间的共享变量/状态。</p><p data-tool="mdnice编辑器">2）可打印 Python 输出，包括 matplotlib 的图形输出。</p><p data-tool="mdnice编辑器">3）可使用 py 对象访问 R 中 Python 块中创建的对象。</p><p data-tool="mdnice编辑器">4）使用 r 对象从 Python 中访问在 R 块中创建的对象。</p><h3 data-tool="mdnice编辑器"><span></span><span>作图</span><span></span></h3><p data-tool="mdnice编辑器">可以直接用 python 引擎绘图。</p><pre data-tool="mdnice编辑器"><span></span><code>import numpy as np <br>import matplotlib.pyplot as plt <br><span># 计算正弦曲线上点的 x 和 y 坐标</span><br>x = np.arange(0,  3  * np.pi,  0.1) <br>y = np.sin(x)<br>plt.title(<span>"sine wave form"</span>)  <span># 使用 matplotlib 来绘制点</span><br>plt.plot(x, y) <br>plt.show()<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.25363636363636366" data-src="https://mmbiz.qpic.cn/mmbiz_png/MIcgkkEyTHiaYhLSLMyMPX9msaJmvnMr34GZSPBdLdMiaUxMalL145K3wlyjM9zIhYfvOclj255XF5BT30KSrhlQ/640?wx_fmt=png" data-type="png" data-w="1100" src="https://mmbiz.qpic.cn/mmbiz_png/MIcgkkEyTHiaYhLSLMyMPX9msaJmvnMr34GZSPBdLdMiaUxMalL145K3wlyjM9zIhYfvOclj255XF5BT30KSrhlQ/640?wx_fmt=png"></figure><figure data-tool="mdnice编辑器"><img data-src="https://mmbiz.qpic.cn/mmbiz_png/ibOFjxwickib45zrKkgUbE2oh3nfWGHaBSOwKMyrqYEvSfFtWiaetK0dtIu4wib8Hfia6v5AtOcobiaV5n3roFMbjJNWQ/640?wx_fmt=png" data-type="png" data-ratio="0.7555555555555555" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/ibOFjxwickib45zrKkgUbE2oh3nfWGHaBSOwKMyrqYEvSfFtWiaetK0dtIu4wib8Hfia6v5AtOcobiaV5n3roFMbjJNWQ/640?wx_fmt=png"></figure><h3 data-tool="mdnice编辑器"><span></span><span>读取文件</span><span></span></h3><p data-tool="mdnice编辑器">python 怎么读取，这里也可以怎么读取，基本和在 jupter notebook 中是一样的。下面读取下 csv 格式的数据表。</p><pre data-tool="mdnice编辑器"><span></span><code>import pandas as pd<br>df = pd.read_csv(<span>"test.csv"</span>, encoding=<span>"gbk"</span>)<br>df.head()<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.2592250922509225" data-src="https://mmbiz.qpic.cn/mmbiz_png/MIcgkkEyTHiaYhLSLMyMPX9msaJmvnMr39dX1kVuzaG7OCZlic80cJwKfUgkSQ6qsa3B2mdLK3J4pCcak29iaDf3g/640?wx_fmt=png" data-type="png" data-w="1084" src="https://mmbiz.qpic.cn/mmbiz_png/MIcgkkEyTHiaYhLSLMyMPX9msaJmvnMr39dX1kVuzaG7OCZlic80cJwKfUgkSQ6qsa3B2mdLK3J4pCcak29iaDf3g/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">返回的 df 是 Python 对象，我们可以看到表格不好看，这是 R 中的 Python 对象。</p><h2 data-tool="mdnice编辑器"><span></span><span>在 R 代码块中调用 Python 变量</span></h2><p data-tool="mdnice编辑器">刚刚讲的都是在 Rmakdown 中运行 Python 代码块，并不是在 R 代码块中运行 Python 代码或者调用 Python 变量，现在我们试试在 R 代码块中调用 Python 变量。</p><h3 data-tool="mdnice编辑器"><span></span><span>py$python 变量名</span><span></span></h3><p data-tool="mdnice编辑器">R 代码块中调用 Python 方法 py$python 变量名</p><ul data-tool="mdnice编辑器"><li><section>py 相当于 Python 中的对象</section></li><li><section>$ 相当于 Python 中的<strong>点</strong></section></li><li><section>python_variable_name 是 Python 代码块中的变量名</section></li></ul><p data-tool="mdnice编辑器">比如在上文中 Python 的变量 df，在 R 中调用</p><pre data-tool="mdnice编辑器"><span></span><code>```{r}<br>py<span>$df</span><br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.3724584103512015" data-src="https://mmbiz.qpic.cn/mmbiz_png/MIcgkkEyTHiaYhLSLMyMPX9msaJmvnMr3PKvuu9UlrP9439ic8Exp044n9TZWU4ghiam6Xqu41HqicelwEEGh4eoUg/640?wx_fmt=png" data-type="png" data-w="1082" src="https://mmbiz.qpic.cn/mmbiz_png/MIcgkkEyTHiaYhLSLMyMPX9msaJmvnMr3PKvuu9UlrP9439ic8Exp044n9TZWU4ghiam6Xqu41HqicelwEEGh4eoUg/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">现在调用 Python 对象 df 时，R 会默认将其转为 R 对象，所以内容一样，样式似乎变好看了。</p><h3 data-tool="mdnice编辑器"><span></span><span>source_python()</span><span></span></h3><p data-tool="mdnice编辑器">使用 reticulate 包中的 source_python('py 文件路径')可以导入 py 文件中的变量，这样就可以在 R 代码块中使用外部变量。例如我在 data.py 中准备 A 和 B 两个字符串</p><pre data-tool="mdnice编辑器"><span></span><code>A = <span>'我是庄闪闪,'</span>B = <span>'来自浙江温州'</span><br></code></pre><p data-tool="mdnice编辑器">在 R 代码块中运行 data.py</p><pre data-tool="mdnice编辑器"><span></span><code>```{r}library(reticulate)<br>source_python(<span>"data.py"</span>)<br>paste0(A, B)<br><span>#我是庄闪闪,来自浙江温州</span><br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span>py_run_file()</span><span></span></h3><p data-tool="mdnice编辑器">在 R 代码块中运行项目文件夹中的 test.py 文件，可使用以下代码</p><pre data-tool="mdnice编辑器"><span></span><code>library(reticulate)<br>py_run_file("test.py")<br></code></pre><h2 data-tool="mdnice编辑器"><span></span><span>数据类型对比</span></h2><figure data-tool="mdnice编辑器"><img data-src="https://mmbiz.qpic.cn/mmbiz_png/ibOFjxwickib45zrKkgUbE2oh3nfWGHaBSOGicUOPMgDa8vStuZoZ5GCjUJK28HodKjQtHQYAd9rhjs6MfVpA814Dg/640?wx_fmt=png" data-type="png" data-ratio="0.35555555555555557" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/ibOFjxwickib45zrKkgUbE2oh3nfWGHaBSOGicUOPMgDa8vStuZoZ5GCjUJK28HodKjQtHQYAd9rhjs6MfVpA814Dg/640?wx_fmt=png"></figure><h3 data-tool="mdnice编辑器"><span>参考资料</span></h3><section data-tool="mdnice编辑器"><span><span>[1]</span><p>R Vs Python: What’s the Difference?: <em>https://www.guru99.com/r-vs-python.html</em></p></span><span><span>[2]</span><p>reticulate网站: <em>https://rstudio.github.io/reticulate/</em></p></span><span><span>[3]</span><p>reticulate: R interface to Python: <em>https://www.jianshu.com/p/3dcbd627c06e</em></p></span></section></section><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><h2 data-tool="mdnice编辑器"><br></h2><p><span>  相关推荐</span></p><section data-mpa-template="t" data-from="yb-recommend-list"><section data-mpa-template="t" data-from="yb-recommend" data-recommend-article-type="normal" data-recomment-template-id="1" data-recommend-article-id="2247489608_1" data-recommend-article-time="1611328658" data-recommend-article-cover="http://mmbiz.qpic.cn/mmbiz_jpg/MIcgkkEyTHiauhJL3kFZutweszTujpg7YFQpL4ctRIlxROAibL54BC7RK5GZYlZPfRpF0NUtltXuG8GCaicBe6YcA/0?wx_fmt=jpeg" data-recommend-article-title="explore包——化繁为简，交互式数据探索分析" data-recommend-article-content-url="http://mp.weixin.qq.com/s?__biz=MzI1NjUwMjQxMQ==&amp;mid=2247489608&amp;idx=1&amp;sn=aa91222343cb3c2593069a4e771624ad&amp;chksm=ea24e7acdd536eba05f2f7c0d709f984a6f26e39a32fc9764daae7d5e8c7a9b08c388131db19#rd"><a href="http://mp.weixin.qq.com/s?__biz=MzI1NjUwMjQxMQ==&amp;mid=2247489608&amp;idx=1&amp;sn=aa91222343cb3c2593069a4e771624ad&amp;chksm=ea24e7acdd536eba05f2f7c0d709f984a6f26e39a32fc9764daae7d5e8c7a9b08c388131db19&amp;scene=21#wechat_redirect" data-linktype="1"><section data-recommend-type="normal" data-recommend-tid="1" data-mid=""><section data-mid=""><section data-mid=""><span data-positionback="static"><img data-ratio="0.4264240506329114" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/MIcgkkEyTHiauhJL3kFZutweszTujpg7YFQpL4ctRIlxROAibL54BC7RK5GZYlZPfRpF0NUtltXuG8GCaicBe6YcA/640?wx_fmt=jpeg" data-type="jpeg" data-w="1264" src="https://mmbiz.qpic.cn/mmbiz_jpg/MIcgkkEyTHiauhJL3kFZutweszTujpg7YFQpL4ctRIlxROAibL54BC7RK5GZYlZPfRpF0NUtltXuG8GCaicBe6YcA/640?wx_fmt=jpeg"></span></section><section data-mid=""><p data-recommend-title="t" data-mid="">explore包——化繁为简，交互式数据探索分析</p></section></section></section></a></section><br><section data-mpa-template="t" data-from="yb-recommend" data-recommend-article-type="normal" data-recomment-template-id="1" data-recommend-article-id="2247488248_1" data-recommend-article-time="1608899622" data-recommend-article-cover="http://mmbiz.qpic.cn/mmbiz_jpg/MIcgkkEyTHj3sfdbhdOEeAUWlVu9O7x0jNFYIyvHfkXiapBNUssA3iaoCD2CjRbIu9G9bNxoGzcPEJbnn1sfwGwg/0?wx_fmt=jpeg" data-recommend-article-title="ggridges包—峰峦图详细介绍" data-recommend-article-content-url="http://mp.weixin.qq.com/s?__biz=MzI1NjUwMjQxMQ==&amp;mid=2247488248&amp;idx=1&amp;sn=6b71d7adba5ea796fdfe8f49fe232d94&amp;chksm=ea24ed1cdd53640a1e30271584458097fce82a732f9d63ce2084dc63fbae6fb028fd7f813bb7#rd"><a href="http://mp.weixin.qq.com/s?__biz=MzI1NjUwMjQxMQ==&amp;mid=2247488248&amp;idx=1&amp;sn=6b71d7adba5ea796fdfe8f49fe232d94&amp;chksm=ea24ed1cdd53640a1e30271584458097fce82a732f9d63ce2084dc63fbae6fb028fd7f813bb7&amp;scene=21#wechat_redirect" data-linktype="1"><section data-recommend-type="normal" data-recommend-tid="1" data-mid=""><section data-mid=""><section data-mid=""><span data-positionback="static"><img data-ratio="0.4265625" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/MIcgkkEyTHj3sfdbhdOEeAUWlVu9O7x0jNFYIyvHfkXiapBNUssA3iaoCD2CjRbIu9G9bNxoGzcPEJbnn1sfwGwg/640?wx_fmt=jpeg" data-type="jpeg" data-w="1280" src="https://mmbiz.qpic.cn/mmbiz_jpg/MIcgkkEyTHj3sfdbhdOEeAUWlVu9O7x0jNFYIyvHfkXiapBNUssA3iaoCD2CjRbIu9G9bNxoGzcPEJbnn1sfwGwg/640?wx_fmt=jpeg"></span></section><section data-mid=""><p data-recommend-title="t" data-mid="">ggridges包—峰峦图详细介绍</p></section></section></section></a></section><br><section data-mpa-template="t" data-from="yb-recommend" data-recommend-article-type="normal" data-recomment-template-id="1" data-recommend-article-id="2247488200_1" data-recommend-article-time="1608560988" data-recommend-article-cover="http://mmbiz.qpic.cn/mmbiz_jpg/MIcgkkEyTHhcV8vicwT1KrHxz9RhYKItWLzqtGOxRUlKarTI9sWse0Sr5jHhgiaAxKzibgav1PIAhaZlkffhb0FQQ/0?wx_fmt=jpeg" data-recommend-article-title="esquisse包—不写代码生成ggplot图" data-recommend-article-content-url="http://mp.weixin.qq.com/s?__biz=MzI1NjUwMjQxMQ==&amp;mid=2247488200&amp;idx=1&amp;sn=3a058480b104165118975b2d908dff72&amp;chksm=ea24ed2cdd53643a9deb58069cd8d0e9933fc165994a2bb7a6f7d4651c7796b839fc781ec86d#rd"><a href="http://mp.weixin.qq.com/s?__biz=MzI1NjUwMjQxMQ==&amp;mid=2247488200&amp;idx=1&amp;sn=3a058480b104165118975b2d908dff72&amp;chksm=ea24ed2cdd53643a9deb58069cd8d0e9933fc165994a2bb7a6f7d4651c7796b839fc781ec86d&amp;scene=21#wechat_redirect" data-linktype="1"><section data-recommend-type="normal" data-recommend-tid="1" data-mid=""><section data-mid=""><section data-mid=""><span data-positionback="static"><img data-ratio="0.42421875" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/MIcgkkEyTHhcV8vicwT1KrHxz9RhYKItWLzqtGOxRUlKarTI9sWse0Sr5jHhgiaAxKzibgav1PIAhaZlkffhb0FQQ/640?wx_fmt=jpeg" data-type="jpeg" data-w="1280" src="https://mmbiz.qpic.cn/mmbiz_jpg/MIcgkkEyTHhcV8vicwT1KrHxz9RhYKItWLzqtGOxRUlKarTI9sWse0Sr5jHhgiaAxKzibgav1PIAhaZlkffhb0FQQ/640?wx_fmt=jpeg"></span></section><section data-mid=""><p data-recommend-title="t" data-mid="">esquisse包—不写代码生成ggplot图</p></section></section></section></a></section><br><section data-mpa-template="t" data-from="yb-recommend" data-recommend-article-type="normal" data-recomment-template-id="1" data-recommend-article-id="2247487814_1" data-recommend-article-time="1607935906" data-recommend-article-cover="http://mmbiz.qpic.cn/mmbiz_jpg/MIcgkkEyTHiaRucK3ZpF9MlfCqKTVyxiayOOtefwgpNSyAUHoCQ96sPqGUzvVslstT5XdnH80W0L47cibZEPLO2Vg/0?wx_fmt=jpeg" data-recommend-article-title="calendR包—私人定制专属日历" data-recommend-article-content-url="http://mp.weixin.qq.com/s?__biz=MzI1NjUwMjQxMQ==&amp;mid=2247487814&amp;idx=1&amp;sn=aa58149b66ce8b6d1c6210ded418c71a&amp;chksm=ea24eea2dd5367b4a24a670b9e78d377f1506399be8dd0d0a35230407e3dc131f6b07ab3d9ca#rd"><a href="http://mp.weixin.qq.com/s?__biz=MzI1NjUwMjQxMQ==&amp;mid=2247487814&amp;idx=1&amp;sn=aa58149b66ce8b6d1c6210ded418c71a&amp;chksm=ea24eea2dd5367b4a24a670b9e78d377f1506399be8dd0d0a35230407e3dc131f6b07ab3d9ca&amp;scene=21#wechat_redirect" data-linktype="1"><section data-recommend-type="normal" data-recommend-tid="1" data-mid=""><section data-mid=""><section data-mid=""><span data-positionback="static"><img data-ratio="0.425" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/MIcgkkEyTHiaRucK3ZpF9MlfCqKTVyxiayOOtefwgpNSyAUHoCQ96sPqGUzvVslstT5XdnH80W0L47cibZEPLO2Vg/640?wx_fmt=jpeg" data-type="jpeg" data-w="1280" src="https://mmbiz.qpic.cn/mmbiz_jpg/MIcgkkEyTHiaRucK3ZpF9MlfCqKTVyxiayOOtefwgpNSyAUHoCQ96sPqGUzvVslstT5XdnH80W0L47cibZEPLO2Vg/640?wx_fmt=jpeg"></span></section><section data-mid=""><p data-recommend-title="t" data-mid="">calendR包—私人定制专属日历</p></section></section></section></a></section></section><p><br></p></section></section></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/_57NXVJxrjOYK3WB6LtIrA",target="_blank" rel="noopener noreferrer">原文链接</a>
