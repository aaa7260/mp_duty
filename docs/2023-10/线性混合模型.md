---
title: "线性混合模型"
date: 2023-10-14T07:37:15Z
draft: ["false"]
tags: [
  "fetched",
  "芬菲随笔"
]
categories: ["Acdemic"]
---
线性混合模型 by 芬菲随笔
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><hr data-tool="mdnice编辑器"><p data-tool="mdnice编辑器">本文内容:<br>1、模型原理<br>2、模型公式<br>3、结果解读</p><h1 data-tool="mdnice编辑器"><span></span><span>Part1 模型原理</span></h1><p data-tool="mdnice编辑器">实验设计导致数据嵌套方差解释的逐渐补充图</p><h2 data-tool="mdnice编辑器"><span></span><span>1-1 拟合自变量和因变量的关系</span></h2><p data-tool="mdnice编辑器">数据受到背景噪音的影响，数据间存在聚集<img data-galleryid="" data-ratio="0.24444444444444444" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/9YXSPb9ydSbu2noqabmjY4TYva50bQdvuD20S5dhUCibobVibx5rANqPXA0Q6ibtQrWxTowgypJIIaHxcBspR51rg/640?wx_fmt=jpeg" data-type="jpeg" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/9YXSPb9ydSbu2noqabmjY4TYva50bQdvuD20S5dhUCibobVibx5rANqPXA0Q6ibtQrWxTowgypJIIaHxcBspR51rg/640?wx_fmt=jpeg"><span>                     </span><span>真实数</span><span>据来源的复杂性 </span></p><p>crossed设计。每个样本同时属于两个或多个或所有上一层级的类别，在实验中，图a的下面两层就类似两个被试都接受了三种实验条件。<br>nested设计。数据中每个最底层的样本是独立的，上一级是可以将下一层级的样本进行分类组合的模式；<br>当然nested和crossed设计也可以如c,d组合来组合去搞人脑子，不过为了头发，咱们进行实验设计的时候就搞搞好吧。</p><p>线性混合模型中三种方差和两种效应的关系图</p><p><img data-cropselx1="0" data-cropselx2="568" data-cropsely1="0" data-cropsely2="312" data-galleryid="" data-ratio="0.5487510072522159" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/9YXSPb9ydSbu2noqabmjY4TYva50bQdvceK5vzqCxguJDY1CGwqjfmYeSB2Gt8CBA4eJhYKysENhX3RqF4laxQ/640?wx_fmt=png" data-type="png" data-w="1241" src="https://mmbiz.qpic.cn/sz_mmbiz_png/9YXSPb9ydSbu2noqabmjY4TYva50bQdvceK5vzqCxguJDY1CGwqjfmYeSB2Gt8CBA4eJhYKysENhX3RqF4laxQ/640?wx_fmt=png"></p><p><br></p></section><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><p data-tool="mdnice编辑器">在一般线性模型中，其自变量全部为固定效应自变量，而线性混合模型中，除了固定效应自变量外，还包含了随机效应自变量。</p><p data-tool="mdnice编辑器">使用一般线性模型，需满足3点假设：<br>1、正态性，因变量y服从正态分布；<br>2、独立性，不同类别y的观察值之间相互独立，相关系数为零；<br>3、方差齐性，不同类别y的方差相等。</p><p data-tool="mdnice编辑器">然而，在线性模型中，当存在数据分层时，可以分开处理分层数据，并且要求分层因素不能过多。因而，不如换一个模型，如线性混合模型（linear mixed effects model, LMM），该模型只要求因变量y服从正态分布。</p><h2 data-tool="mdnice编辑器"><span></span><span>1-2 固定效应和随机效应自变量分类</span></h2><p data-tool="mdnice编辑器">固定效应和随机效应变量的区别之处关键在自变量的类别。<br>如果抽样数据中，包含一个自变量的所有类别，则将该变量作为固定效应。比如性别，只要抽样的数据中同时包含了两种性别，就可以将性别作为固定效应自变量。<br>如果一个自变量在抽样数据中只包含部分类别，则将该变量作为随机效应自变量。简言之，抽样数据集中的自变量可以包含该自变量的所有情况，则作为固定效应，如果只能代表总体的一部分，则作为随机效应。</p><p data-tool="mdnice编辑器">另外，如果一个效应在不同的参与者样本中会持续存在，那么该效应就被认为是固定的。<br>随机效应是从一些人群中抽样的离散单位，它们本身就是分类的。<br>固定效应对平均趋势进行建模，而随机效应则对这些趋势在某些分组因素（如参与者或项目）的不同水平上的变化程度进行建模。</p><p data-tool="mdnice编辑器">总之，相比一般线性模型，混合线性模型的目的是通过引入随机效应，得到一个更好的解释数据的模型。</p><h1 data-tool="mdnice编辑器"><span></span><span>Part2 模型公式</span></h1><h2 data-tool="mdnice编辑器"><span></span><span>2-1 混合效应模型的种类</span></h2><p data-tool="mdnice编辑器">根据截距和斜率是否随机，混合效应模型可以有四种情况：<br>①随机截距+随机斜率；②随机截距+固定斜率；③固定截距+随机斜率；④固定截距+固定斜率。</p><h2 data-tool="mdnice编辑器"><span></span><span>2-2 随机效应模型的选择方案</span></h2><ul data-tool="mdnice编辑器"><li><section>做加法<br>在线性模型中加入多少随机效应项而言，一些学者认为应该采用渐进递增的方式进行，即从每一个随机效应项的截距到斜率逐渐叠加到已有模型，并使用卡方检验比较AIC和BIC等参数是否有显著提升来判断模型是否为最优。</section></li><li><section>做减法<br>然而，另一些学者提倡一次性将所有“符合逻辑”的随机效应项一次性纳入模型当中，再检验这些随机效应项对模型估计方差的影响。如果影响小，再剔除这些随机效应项。</section></li></ul><h2 data-tool="mdnice编辑器"><span></span><span>2-3 模型的选择</span></h2><p data-tool="mdnice编辑器">REML criterion at convergence限制最大似然 (REML) 方法，指残差最大似然法，它是LME模型默认的参数估计方法。</p><p data-tool="mdnice编辑器">常用的两个模型选择方法——赤池信息准则（Akaike Information Criterion，AIC）和贝叶斯信息准则（Bayesian Information Criterion，BIC）。<br>赤池信息量准则的方法是寻找可以最好地解释数据但包含最少自由参数的模型，优先考虑的模型应是AIC值最小的那一个。<br>AIC和BIC的原理是不同的，都是选择值最小的模型。AIC是从预测角度，选择一个好的模型用来预测，BIC是从拟合角度，选择一个对现有数据拟合最好的模型，从贝叶斯因子的解释来讲，就是边际似然最大的那个模型。</p><p data-tool="mdnice编辑器">anova()函数将模型对象作为自变量，并返回一个anova，测试更复杂的模型是否比更简单的模型更善于捕捉数据。如果得到的p值足够低（通常小于0.05），我们得出的结论是，更复杂的模型明显优于更简单的模型，因此有利于更复杂的模式。反之，如果p值不够低（通常大于0.05），我们应该选择更简单的模型。</p><h2 data-tool="mdnice编辑器"><span></span><span>2-4 混合线性模型表达式</span></h2><p data-tool="mdnice编辑器">fit = lmer(data = , formula = DV ~ Fixed_Factor + (Random_intercept + Random_Slope | Random_Factor))data - 要处理的数据集；<br>formula - 表达式；<br>DV - 观测值 （因变量）；Fixed_Factor - 固定因子（自变量）；<br>() - 完整的随机因子(包括截距和斜率)；Random_intercept - 随机截距，即认为不同群体的因变量的分布不同（可以理解成有些人出生就在终点，而你是在起点...）；<br>Random_Slope - 随机斜率，即认为不同群体受自变量的影响是不同的（可以理解成别人花两个小时能赚10000元，而你只能挣个被试费...）；Random_Factor - 随机因子。</p><p data-tool="mdnice编辑器">括号内是随机效应，括号外是固定效应。g表示分组变量，x、y分别表示自变量和因变量<br>截距中，1表示随机截距，0表示固定截距，默认截距为1。<br>1 | g表示固定斜率；x | g表示随机斜率<br>线性混合效应模型可以有四种情况：<br>随机截距 + 随机斜率；y ~ x + (x | g)<br>随机截距 + 固定斜率；y ~ x + (1 | g)<br>固定截距 + 随机斜率；y ~ x + (0 + x | g)<br>固定截距 + 固定斜率。y ~ x</p><h1 data-tool="mdnice编辑器"><span></span><span>Part3 结果解读</span></h1><p data-tool="mdnice编辑器">建立模型步骤如下：<br>1、先建立全模型，查看模型结果是否过拟合；<br>2、做减法，生成第二个模型；<br>3、模型比较，确定最终模型。</p><p data-tool="mdnice编辑器">模型过度拟合问题：随机效应中变量间相关性接近1或-1，一般在0.9以上就认为模型过拟合，可以将过度拟合的随机斜率去掉。<br>本次以单个随机因素为例，对于多个随机因素，可能存在随机因素间的交叉和嵌套，本文暂不讨论。</p><p data-tool="mdnice编辑器">本次示例数据为R语言内置数据集ChickWeight。<br>ChickWeight是578行4列的小鸡体重数据集，记录了不同喂养和育龄下小鸡的体重数据，采集了50只小鸡12个时间点四种喂养方式下体重数据。<br>weight：小鸡体重，单位是公克gm；<br>Time：育龄，小鸡出生天数；<br>Chick：小鸡序号，按最后体重从最轻到最重排序；<br>Diet：喂养方式，分为4种方式。</p><pre data-tool="mdnice编辑器"><span></span><code><span># Load packages</span><br><span>library</span>(tidyverse)<br><span>library</span>(ggplot2)<br><span>library</span>(ggsci)<br><span>library</span>(ggpubr)<br><span>library</span>(cowplot)<br><span>library</span>(lmerTest)<br><span>library</span>(ggpmisc)<br><br><span># 理解数据集</span><br>data(ChickWeight)<br>dim(ChickWeight)<br><span>## [1] 578   4</span><br>head(ChickWeight)<br><span>## Grouped Data: weight ~ Time | Chick</span><br><span>##   weight Time Chick Diet</span><br><span>## 1     42    0     1    1</span><br><span>## 2     51    2     1    1</span><br><span>## 3     59    4     1    1</span><br><span>## 4     64    6     1    1</span><br><span>## 5     76    8     1    1</span><br><span>## 6     93   10     1    1</span><br>sapply(ChickWeight, class)<br><span>## $weight</span><br><span>## [1] "numeric"</span><br><span>## </span><br><span>## $Time</span><br><span>## [1] "numeric"</span><br><span>## </span><br><span>## $Chick</span><br><span>## [1] "ordered" "factor" </span><br><span>## </span><br><span>## $Diet</span><br><span>## [1] "factor"</span><br><br><span># 两种喂养方式各选3只共6只小鸡</span><br>smallSet &lt;- ChickWeight %&gt;% subset(Chick %<span>in</span>% c(<span>1</span>:<span>3</span>, <span>21</span>:<span>23</span>))<br>dim(smallSet)<br><span>## [1] 72  4</span><br></code></pre><p data-tool="mdnice编辑器">探究小鸡体重与育龄的关系</p><pre data-tool="mdnice编辑器"><span></span><code><span># 探究小鸡体重与育龄的关系</span><br>my_formula &lt;- y ~ x<br>p1 &lt;- smallSet %&gt;%<br>  ggplot(aes(x = Time, y = weight)) +<br>  geom_point() +<br>  <span># 添加线条</span><br>  geom_smooth(formula = my_formula, method = <span>"lm"</span>) +<br>  <span># 添加相关系数</span><br>  stat_cor(method = <span>'spearman'</span>, label.y.npc = <span>0.9</span>) +<br>  <span># 添加公式</span><br>  stat_poly_eq(formula = my_formula, aes(label = stat(eq.label)),<br>               label.x.npc = <span>"left"</span>, label.y.npc = <span>0.75</span>) +<br>  theme_pubr() <br>p1<br></code></pre><figure data-tool="mdnice编辑器"><p><img data-galleryid="" data-ratio="0.7138888888888889" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/9YXSPb9ydSbu2noqabmjY4TYva50bQdvUcLZ6KzbpdjsE02teW4s5icbIibLVPgQE1NdtAaaIYj1f54BTXsLPX7A/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/9YXSPb9ydSbu2noqabmjY4TYva50bQdvUcLZ6KzbpdjsE02teW4s5icbIibLVPgQE1NdtAaaIYj1f54BTXsLPX7A/640?wx_fmt=png"></p></figure><pre data-tool="mdnice编辑器"><code><br><span># 考虑喂养方式</span><br>p1 + facet_wrap(vars(Diet))<br></code></pre><figure data-tool="mdnice编辑器"><p><img data-galleryid="" data-ratio="0.7138888888888889" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/9YXSPb9ydSbu2noqabmjY4TYva50bQdvWWBhFxt52h5MH1H0WpwPOaoDwhI4Ne1roMxpVZ9MVrapPy3oD9c2AA/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/9YXSPb9ydSbu2noqabmjY4TYva50bQdvWWBhFxt52h5MH1H0WpwPOaoDwhI4Ne1roMxpVZ9MVrapPy3oD9c2AA/640?wx_fmt=png"></p></figure><pre data-tool="mdnice编辑器"><span></span><code><span># 考虑小鸡个体差异</span><br>p1 + facet_wrap(vars(Chick))<br></code></pre><figure data-tool="mdnice编辑器"><p><img data-galleryid="" data-ratio="0.7138888888888889" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/9YXSPb9ydSbu2noqabmjY4TYva50bQdvEbricGdbjlWtCRxMyfzuyDBNuEInOLG5QmDibOg1ltibJeoamuzm78cag/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/9YXSPb9ydSbu2noqabmjY4TYva50bQdvEbricGdbjlWtCRxMyfzuyDBNuEInOLG5QmDibOg1ltibJeoamuzm78cag/640?wx_fmt=png"></p></figure><h2 data-tool="mdnice编辑器"><span></span><span>3-1 先建立全模型</span></h2><pre data-tool="mdnice编辑器"><span></span><code><span># -----------------------------------------------</span><br><span># 建立全模型</span><br>fit &lt;- lmer(weight ~ Time + (Time | Chick), data = smallSet)<br>summary(fit)<br><span>## Linear mixed model fit by REML. t-tests use Satterthwaite's method ['lmerModLmerTest']</span><br><span>## Formula: weight ~ Time + (Time | Chick)</span><br><span>##    Data: smallSet</span><br><span>## </span><br><span>## REML criterion at convergence: 560.1</span><br><span>## </span><br><span>## Scaled residuals: </span><br><span>##      Min       1Q   Median       3Q      Max </span><br><span>## -2.11330 -0.72657 -0.02159  0.61926  2.62272 </span><br><span>## </span><br><span>## Random effects:</span><br><span>##  Groups   Name        Variance Std.Dev. Corr </span><br><span>##  Chick    (Intercept) 61.20    7.823         </span><br><span>##           Time        11.48    3.388    -0.95</span><br><span>##  Residual             99.73    9.986         </span><br><span>## Number of obs: 72, groups:  Chick, 6</span><br><span>## </span><br><span>## Fixed effects:</span><br><span>##             Estimate Std. Error     df t value Pr(&gt;|t|)    </span><br><span>## (Intercept)   27.741      3.896  5.001   7.120 0.000847 ***</span><br><span>## Time           8.872      1.394  5.000   6.365 0.001415 ** </span><br><span>## ---</span><br><span>## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span><br><span>## </span><br><span>## Correlation of Fixed Effects:</span><br><span>##      (Intr)</span><br><span>## Time -0.832</span><br></code></pre><ul data-tool="mdnice编辑器"><li><section>查看模型结果</section></li></ul><pre data-tool="mdnice编辑器"><span></span><code><span># -----------------------------------------------</span><br><span># 查看模型结果</span><br><br><span># 限制最大似然 (REML) 方法</span><br><br><span># 标准化模型皮尔逊残差的分布情况</span><br>quantile(residuals(fit, type = <span>"pearson"</span>, scaled = <span>T</span>))<br><span>##          0%         25%         50%         75%        100% </span><br><span>## -2.11330258 -0.72657146 -0.02159436  0.61925812  2.62271953</span><br><br><span># 随机效应</span><br><span># 模型对数据的解释能力</span><br><br><span># 随机因子随机效应和显著性检验</span><br>ranef(fit)<br><span>## $Chick</span><br><span>##      (Intercept)       Time</span><br><span>## 3    0.302098064 -0.6820963</span><br><span>## 1    1.391325144 -1.1669241</span><br><span>## 2    0.002620769 -0.3373429</span><br><span>## 22   6.978608038 -2.6493179</span><br><span>## 23   5.257667357 -1.8413093</span><br><span>## 21 -13.932319371  6.6769905</span><br><span>## </span><br><span>## with conditional variances for "Chick"</span><br>ranova(fit)<br><span>## ANOVA-like table for random-effects: Single term deletions</span><br><span>## </span><br><span>## Model:</span><br><span>## weight ~ Time + (Time | Chick)</span><br><span>##                        npar  logLik    AIC    LRT Df Pr(&gt;Chisq)    </span><br><span>## &lt;none&gt;                    6 -280.05 572.10                         </span><br><span>## Time in (Time | Chick)    4 -335.84 679.69 111.58  2  &lt; 2.2e-16 ***</span><br><span>## ---</span><br><span>## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span><br><br><span># 固定效应，同一般的线性模型</span><br><span># 固定效应部分和线性模型结果相似，包括截距估计值和标准误；斜率估计值和标准误。</span><br><span># 查看固定效应和显著性检验</span><br>coef(fit)<br><span>## $Chick</span><br><span>##    (Intercept)      Time</span><br><span>## 3     28.04273  8.190263</span><br><span>## 1     29.13196  7.705435</span><br><span>## 2     27.74326  8.535016</span><br><span>## 22    34.71924  6.223041</span><br><span>## 23    32.99830  7.031050</span><br><span>## 21    13.80831 15.549350</span><br><span>## </span><br><span>## attr(,"class")</span><br><span>## [1] "coef.mer"</span><br>anova(fit)<br><span>## Type III Analysis of Variance Table with Satterthwaite's method</span><br><span>##      Sum Sq Mean Sq NumDF  DenDF F value   Pr(&gt;F)   </span><br><span>## Time 4040.2  4040.2     1 5.0004  40.511 0.001415 **</span><br><span>## ---</span><br><span>## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span><br><br><span># 查看类型和适用函数</span><br><span># class(fit)</span><br><span># methods(class = "lmerModLmerTest") </span><br><br><span># confint()函数查看随机效应标准差和固定效应系数的置信区间：</span><br><span># confint(fit, level = 0.95)</span><br></code></pre><h2 data-tool="mdnice编辑器"><span></span><span>3-2 做减法，生成第二个模型</span></h2><pre data-tool="mdnice编辑器"><span></span><code><span># ----------------------------------------------------------------</span><br><span># 随机截距 + 随机斜率</span><br>fit.1 &lt;- lmer(weight ~ Time + (Time | Chick), data = smallSet)<br><br><span># 随机截距 + 固定斜率</span><br>fit.2 &lt;- lmer(weight ~ Time + (<span>1</span> | Chick), data = smallSet)<br><br><span># 固定截距 + 随机斜率</span><br>fit.3 &lt;- lmer(weight ~ Time + (<span>0</span> + Time| Chick), data = smallSet)<br><br><span># 固定截距 + 固定斜率</span><br>fit.4 &lt;- lm(weight ~ Time, data = smallSet)<br><br><span># ----------------------------------------------------------------</span><br></code></pre><p data-tool="mdnice编辑器">可视化模型预测结果</p><p data-tool="mdnice编辑器">分面绘图</p><pre data-tool="mdnice编辑器"><span></span><code><span># -----------------------------------------------</span><br><span># 可视化</span><br>my_data &lt;- cbind(smallSet, pred = predict(fit))<br>head(my_data)<br><span>##   weight Time Chick Diet      pred</span><br><span>## 1     42    0     1    1  29.13196</span><br><span>## 2     51    2     1    1  44.54283</span><br><span>## 3     59    4     1    1  59.95370</span><br><span>## 4     64    6     1    1  75.36457</span><br><span>## 5     76    8     1    1  90.77544</span><br><span>## 6     93   10     1    1 106.18631</span><br><br>my_formula &lt;- y ~ x<br><br><span># Facet by Chick</span><br>smallSet %&gt;%<br>  ggplot(aes(x = Time, y = weight)) +<br>  geom_point() +<br>  facet_wrap(vars(Chick)) +<br>  <span># 添加线条</span><br>  geom_line(data = my_data, aes(y = pred)) +<br>  <span># 添加相关系数</span><br>  stat_cor(data = my_data, aes(y = pred), method = <span>'spearman'</span>, label.y.npc = <span>0.9</span>) +<br>  <span># 添加公式</span><br>  stat_poly_eq(data = my_data, formula = my_formula,<br>               aes(y = pred, label = stat(eq.label)), parse=<span>TRUE</span>,<br>               label.x.npc = <span>"left"</span>, label.y.npc = <span>0.75</span>) +<br>  theme_pubr()<br></code></pre><figure data-tool="mdnice编辑器"><p><img data-galleryid="" data-ratio="0.7138888888888889" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/9YXSPb9ydSbu2noqabmjY4TYva50bQdvGREZmkicpG2Oqp2qEugKBLfmq9VkpaehHficpegE9q9ia8ibOYk0twibicag/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/9YXSPb9ydSbu2noqabmjY4TYva50bQdvGREZmkicpG2Oqp2qEugKBLfmq9VkpaehHficpegE9q9ia8ibOYk0twibicag/640?wx_fmt=png"></p></figure><p data-tool="mdnice编辑器">绘图线性混合效应模型四种情况</p><pre data-tool="mdnice编辑器"><span></span><code><span># as whole plot</span><br>DrawPreditLine &lt;- <span>function</span>(model, label_text){<br>  my_data &lt;- cbind(smallSet, pred = predict(model))<br>  my_formula &lt;- y ~ x<br>  smallSet %&gt;%<br>    ggplot(aes(x = Time, y = weight, group = Chick, color = Chick)) +<br>    geom_point() +<br>    <span># 添加线条</span><br>    geom_line(data = my_data, aes(y = pred), size = <span>1</span>) +<br>    labs(title = label_text) + <br>    scale_color_jco() +<br>    theme_pubr() +<br>    theme(legend.position = <span>'right'</span>,<br>          plot.title = element_text(hjust = <span>0.5</span>))<br>}<br><br>plot_List &lt;- purrr::map2(list(fit.1, fit.2, fit.3, fit.4),<br>            list(<span>'随机截距 + 随机斜率'</span>, <span>'随机截距 + 固定斜率'</span>, <span>'固定截距 + 随机斜率'</span>, <span>'固定截距 + 固定斜率'</span>),<br>            DrawPreditLine)<br>plot_grid(plotlist = plot_List, labels = <span>'AUTO'</span>)<br></code></pre><figure data-tool="mdnice编辑器"><p><img data-galleryid="" data-ratio="0.7138888888888889" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/9YXSPb9ydSbu2noqabmjY4TYva50bQdvglaibDuNyDbc9JlD7zKfXVwDRPkNy6FChuvAh5gNmGyn5icygiasb7pEg/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/9YXSPb9ydSbu2noqabmjY4TYva50bQdvglaibDuNyDbc9JlD7zKfXVwDRPkNy6FChuvAh5gNmGyn5icygiasb7pEg/640?wx_fmt=png"></p></figure><h2 data-tool="mdnice编辑器"><span></span><span>3-3 模型比较，确定最终模型</span></h2><p data-tool="mdnice编辑器">与全模型fit.1相比，观察到p &lt; 0.05，说明全模型和简化后模型之间存在显著差别，因此，全模型为最终采用的模型。</p><pre data-tool="mdnice编辑器"><span></span><code><span># ----------------------------------------</span><br><span># 比较模型</span><br>anova(fit.1, fit.2, fit.3)<br><span>## Data: smallSet</span><br><span>## Models:</span><br><span>## fit.2: weight ~ Time + (1 | Chick)</span><br><span>## fit.3: weight ~ Time + (0 + Time | Chick)</span><br><span>## fit.1: weight ~ Time + (Time | Chick)</span><br><span>##       npar    AIC    BIC  logLik deviance   Chisq Df Pr(&gt;Chisq)  </span><br><span>## fit.2    4 686.53 695.64 -339.26   678.53                        </span><br><span>## fit.3    4 582.01 591.12 -287.01   574.01 104.517  0             </span><br><span>## fit.1    6 577.79 591.45 -282.90   565.79   8.217  2    0.01643 *</span><br><span>## ---</span><br><span>## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span><br>anova(fit.1, fit.2, fit.3, fit.4)<br><span>## Data: smallSet</span><br><span>## Models:</span><br><span>## fit.4: weight ~ Time</span><br><span>## fit.2: weight ~ Time + (1 | Chick)</span><br><span>## fit.3: weight ~ Time + (0 + Time | Chick)</span><br><span>## fit.1: weight ~ Time + (Time | Chick)</span><br><span>##       npar    AIC    BIC  logLik deviance   Chisq Df Pr(&gt;Chisq)    </span><br><span>## fit.4    3 724.87 731.70 -359.43   718.87                          </span><br><span>## fit.2    4 686.53 695.64 -339.26   678.53  40.338  1  2.136e-10 ***</span><br><span>## fit.3    4 582.01 591.12 -287.01   574.01 104.517  0               </span><br><span>## fit.1    6 577.79 591.45 -282.90   565.79   8.217  2    0.01643 *  </span><br><span>## ---</span><br><span>## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span><br>anova(fit.1, fit.2)<br><span>## Data: smallSet</span><br><span>## Models:</span><br><span>## fit.2: weight ~ Time + (1 | Chick)</span><br><span>## fit.1: weight ~ Time + (Time | Chick)</span><br><span>##       npar    AIC    BIC  logLik deviance  Chisq Df Pr(&gt;Chisq)    </span><br><span>## fit.2    4 686.53 695.64 -339.26   678.53                         </span><br><span>## fit.1    6 577.79 591.45 -282.90   565.79 112.73  2  &lt; 2.2e-16 ***</span><br><span>## ---</span><br><span>## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span><br>anova(fit.1, fit.3)<br><span>## Data: smallSet</span><br><span>## Models:</span><br><span>## fit.3: weight ~ Time + (0 + Time | Chick)</span><br><span>## fit.1: weight ~ Time + (Time | Chick)</span><br><span>##       npar    AIC    BIC  logLik deviance Chisq Df Pr(&gt;Chisq)  </span><br><span>## fit.3    4 582.01 591.12 -287.01   574.01                      </span><br><span>## fit.1    6 577.79 591.45 -282.90   565.79 8.217  2    0.01643 *</span><br><span>## ---</span><br><span>## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span><br>anova(fit.2, fit.3)<br><span>## Data: smallSet</span><br><span>## Models:</span><br><span>## fit.2: weight ~ Time + (1 | Chick)</span><br><span>## fit.3: weight ~ Time + (0 + Time | Chick)</span><br><span>##       npar    AIC    BIC  logLik deviance  Chisq Df Pr(&gt;Chisq)</span><br><span>## fit.2    4 686.53 695.64 -339.26   678.53                     </span><br><span>## fit.3    4 582.01 591.12 -287.01   574.01 104.52  0</span><br><br><span># 与全模型fit.1相比，观察到p &lt; 0.05，说明全模型和简化后模型之间存在显著差别，因此，全模型为最终采用的模型。</span><br></code></pre><h2 data-tool="mdnice编辑器"><span></span><span>参考资料</span></h2><p data-tool="mdnice编辑器">[1] 线性混合模型（linear mixed model, LME）<br>https://zhuanlan.zhihu.com/p/477910086</p><p data-tool="mdnice编辑器">[2] R语言练习的时候那些内置数据集<br>https://mp.weixin.qq.com/s/HeYb9bL5sTHCjswheh_fzA</p><p data-tool="mdnice编辑器">[3] R数据分析：混合效应模型的可视化解释，再不懂就真没办法<br>https://zhuanlan.zhihu.com/p/353317296</p><p data-tool="mdnice编辑器">[4] Linear Mixed Model：线性混合模型简介<br>https://blog.csdn.net/weixin_43569478/article/details/108079707</p><p data-tool="mdnice编辑器">[5] lme4 | 在R中运行混合效应模型（多层模型）<br>https://zhuanlan.zhihu.com/p/567950808</p><p data-tool="mdnice编辑器">[6] 混合线性模型的实现（更新20190607）<br>https://zhuanlan.zhihu.com/p/63092231</p><p data-tool="mdnice编辑器">[7] R语言线性混合效应模型不同类型的比较<br>https://mp.weixin.qq.com/s/NPCu4k5tGYodqSntiLMHGg</p><p data-tool="mdnice编辑器">[8] 线性混合模型（linear mixed model, LME）<br>https://zhuanlan.zhihu.com/p/477910086</p><p data-tool="mdnice编辑器">[9] R使用线性混合效应模型一些常见的结果指标<br>https://zhuanlan.zhihu.com/p/649029208</p><p data-tool="mdnice编辑器">[10] 线性混合效应模型入门之二 - 实例操作及结果解读<br>https://zhuanlan.zhihu.com/p/483173133</p><p data-tool="mdnice编辑器">[11] INTRODUCTION TO LINEAR MIXED MODELS<br>https://ourcodingclub.github.io/tutorials/mixed-models/?nsukey=JfcXN4ZtaaEgpYJMyxe3oLJVjnlrrISjyCNa8jr%2FJxC5boovrpcf%2BTJJhmqhALfQNznAP1VPeUUSZghPYi93AZHNXDFsaXoP9oL%2FEzSgzpmo9VmN7oUwmYExM%2F5cQ5Y3BhDFhWxHSxbAeT3iYd6fwXLzR65TQThi239DVAazfetJiUJlMdBoxgvfGykUcx50Fnd8BemyGv%2FLMezfhVe0tA%3D%3D&amp;from=timeline#FERE</p></section><p><br></p><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/7UWieBmszQAHBzzkx1XCiQ",target="_blank" rel="noopener noreferrer">原文链接</a>
