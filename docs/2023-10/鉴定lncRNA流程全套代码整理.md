---
title: "鉴定lncRNA流程全套代码整理"
date: 2023-10-12T04:00:11Z
draft: ["false"]
tags: [
  "fetched",
  "生信菜鸟团"
]
categories: ["Acdemic"]
---
鉴定lncRNA流程全套代码整理 by 生信菜鸟团
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><p data-tool="mdnice编辑器">前两期周更我们通过一篇文章的复现整理了mRNA和lncRNA分析基本流程，但并没有涉及新lncRNA的鉴定，本周的推文本质上是我个人学习鉴定lncRNA的全套流程笔记，整合了我们公众号往期的资源，对代码进行了勘误更新，内容非常详实。</p><p data-tool="mdnice编辑器">读前须知：本篇推文并非教学笔记，而是学习笔记，所以我并不会提前和大家说哪些地方有哪些坑或者在推文中排除掉走过的岔路，而是给大家看我每步的结果，带大家跳到坑里去再一块跳出来。</p><hr data-tool="mdnice编辑器"><p data-tool="mdnice编辑器">我们首先从[「生信技能树」LncRNA数据分析实战]这个公开视频入手，尝试跟着曾老师走完这个项目</p><p data-tool="mdnice编辑器">「生信技能树」LncRNA数据分析实战(https://www.bilibili.com/video/BV1Zg4y187ff?p=8&amp;vd_source=852ec8cbb4975dabedb5d1f798b80c2a)</p><p data-tool="mdnice编辑器">学徒第5月-02-LncRNA实战(https://mubu.com/doc/ISk-Ev1tg)</p><h1 data-tool="mdnice编辑器"><span></span>下游分析</h1><h4 data-tool="mdnice编辑器"><span></span>背景知识<span></span></h4><p data-tool="mdnice编辑器">https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE59245</p><p data-tool="mdnice编辑器">Long noncoding RNAs expression patterns associated with chemo response to cisplatin based chemotherapy in lung squamous cell carcinoma patients</p><p data-tool="mdnice编辑器">Non-coding RNA profiling by array</p><p data-tool="mdnice编辑器">肺鳞状细胞癌（SCC）患者对顺铂化疗的反应存在很大的变异性。LncRNAs是一种潜在的新型预测标记物，可以识别从化疗中受益的患者亚组，对治疗指导具有重要价值。</p><p data-tool="mdnice编辑器">使用对接受顺铂化疗的晚期肺SCC患者的部分反应（PR）肿瘤与进行性疾病（PD）肿瘤的微阵列分析来鉴定差异表达的lncRNA，并通过定量实时PCR（qPCR）进行验证。结果：与PD样本相比，953个lncRNA持续过度调节，749个lncRNAs</p><hr data-tool="mdnice编辑器"><p data-tool="mdnice编辑器">曾老师在视频中首先介绍的是下游的分析，因为这个大家通过常规转录组的学习已经比较熟悉了</p><p data-tool="mdnice编辑器">这部分我们就不老生常谈，需要补全这部分知识的同学可以参考我们前面的推文<a href="https://mp.weixin.qq.com/s?__biz=MzUzMTEwODk0Ng==&amp;mid=2247515246&amp;idx=1&amp;sn=4646cff563133543c015ee193802cc4b&amp;chksm=fa457953cd32f0451d30a706ce4203e628f268da09f792b4b975acd91b538d1c5007b986c62b&amp;scene=21&amp;cur_album_id=2545418429466607617#wechat_redirect" data-linktype="2">初探mRNA、lncRNA联合分析之下游</a>，或者自己去看看这个视频前面一部分，重难点主要是id注释，这一点可以通过曾老师的AnnoProbe包来帮助进行，这篇推文<a href="https://mp.weixin.qq.com/s?__biz=MzUzMTEwODk0Ng==&amp;mid=2247515246&amp;idx=1&amp;sn=4646cff563133543c015ee193802cc4b&amp;chksm=fa457953cd32f0451d30a706ce4203e628f268da09f792b4b975acd91b538d1c5007b986c62b&amp;scene=21&amp;cur_album_id=2545418429466607617#wechat_redirect" data-linktype="2">初探mRNA、lncRNA联合分析之下游</a>中我主要用的是biomaRt包</p><p data-tool="mdnice编辑器">我们重点还是下面这部分</p><hr data-tool="mdnice编辑器"><h1 data-tool="mdnice编辑器"><span></span>上游pipeline鉴定lncRNA</h1><h3 data-tool="mdnice编辑器"><span></span>背景知识<span></span></h3><p data-tool="mdnice编辑器">这部分视频也有相关推文与之对应：</p><blockquote data-tool="mdnice编辑器"><p><a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247493143&amp;idx=1&amp;sn=293682372c0bb88d2cef568022b42e5e&amp;chksm=9b4ba6acac3c2fba3305b181e7634d0cfe116e88aee6bb8e92923ed47c0b1d14b42230af077d&amp;scene=21&amp;cur_album_id=1322384987060142080#wechat_redirect" data-linktype="2">lncRNA-seq数据分析之新lncRNA鉴定和注释视频课程众筹</a></p><p><a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247493181&amp;idx=1&amp;sn=264be7aed913d74522012318ca18c582&amp;chksm=9b4ba686ac3c2f90095ca1339ce7a389d565bc91620a70de52b64b6e12e45766a04c594d789e&amp;scene=21&amp;cur_album_id=1322384987060142080#wechat_redirect" data-linktype="2">鉴定新的lncRNA之上游流程</a></p></blockquote><p data-tool="mdnice编辑器">主要是复现这个项目：</p><p data-tool="mdnice编辑器">Transcriptome Analysis Suggests the Roles of Long Intergenic Non-coding RNAs in the Growth Performance of Weaned Piglets</p><p data-tool="mdnice编辑器">就是重新下载一个公共数据，然后进行新lncRNA鉴定和注释，分析部分主要是分成两个大块，首先是hisat2+stringtie流程，然后是组装好的gtf文件的后，细致的进行新lncRNA鉴定和注释</p><figure data-tool="mdnice编辑器"><img data-ratio="0.6656565656565656" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8v09iaMlt4FwBxwblrPDUpUqtF7nP5VdocS4eOAUjpFiaOyu0yELHZyMZg/640?wx_fmt=png" data-type="png" data-w="990" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8v09iaMlt4FwBxwblrPDUpUqtF7nP5VdocS4eOAUjpFiaOyu0yELHZyMZg/640?wx_fmt=png"></figure><hr data-tool="mdnice编辑器"><h2 data-tool="mdnice编辑器"><span></span>测序数据获取</h2><figure data-tool="mdnice编辑器"><img data-ratio="0.5419847328244275" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8v43LBcciawXWzWHnsUlPaRWydHLn28RGWPd0XB6rHVialQSiaJZafhzryA/640?wx_fmt=png" data-type="png" data-w="1048" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8v43LBcciawXWzWHnsUlPaRWydHLn28RGWPd0XB6rHVialQSiaJZafhzryA/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">GSE65983</p><p data-tool="mdnice编辑器">https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE65983</p><p data-tool="mdnice编辑器">https://www.ncbi.nlm.nih.gov/bioproject/PRJNA275632</p><p data-tool="mdnice编辑器">https://sra-explorer.info/</p><p data-tool="mdnice编辑器">这个项目GSE搜不到 PRJ可以搜到</p><figure data-tool="mdnice编辑器"><img data-ratio="1.01171875" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vPBPBoib7l4AvyiaH3HrFHbx7dfJfzyx11OibU8UWEA4iaDPIZ0erxJmHfA/640?wx_fmt=png" data-type="png" data-w="768" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vPBPBoib7l4AvyiaH3HrFHbx7dfJfzyx11OibU8UWEA4iaDPIZ0erxJmHfA/640?wx_fmt=png"></figure><figure data-tool="mdnice编辑器"><img data-ratio="0.6104868913857678" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vP7kaohesVcDe9psffVUZSjpY4cMrnupCjs84vQe2ic7h2SL3gQicgKUQ/640?wx_fmt=png" data-type="png" data-w="801" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vP7kaohesVcDe9psffVUZSjpY4cMrnupCjs84vQe2ic7h2SL3gQicgKUQ/640?wx_fmt=png"></figure><figure data-tool="mdnice编辑器"><img data-ratio="0.27205882352941174" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vAlWtB0LsdUDQRWhAC0OTnfskJKDtQh7KHGAsXrymcmvGRzByRNFaeg/640?wx_fmt=png" data-type="png" data-w="952" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vAlWtB0LsdUDQRWhAC0OTnfskJKDtQh7KHGAsXrymcmvGRzByRNFaeg/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">去NCBI 下载accession list，这个后面整理文件感觉还是挺好用的</p><p data-tool="mdnice编辑器">https://www.ncbi.nlm.nih.gov/Traces/study/?query_key=4&amp;WebEnv=MCID_64c1e6edad6bc82565cdac33&amp;o=acc_s%3Aa</p><figure data-tool="mdnice编辑器"><img data-ratio="1.8196286472148542" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vexARmu7QZF5hxg4wolLzibA3jjtLEk1CwoYXbKSIFN040HlNbFb8sEA/640?wx_fmt=png" data-type="png" data-w="377" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vexARmu7QZF5hxg4wolLzibA3jjtLEk1CwoYXbKSIFN040HlNbFb8sEA/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">下载参考基因组构建hisat2索引，参考：</p><p data-tool="mdnice编辑器"><a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247493181&amp;idx=1&amp;sn=264be7aed913d74522012318ca18c582&amp;chksm=9b4ba686ac3c2f90095ca1339ce7a389d565bc91620a70de52b64b6e12e45766a04c594d789e&amp;scene=21&amp;cur_album_id=1322384987060142080#wechat_redirect" data-linktype="2">鉴定新的lncRNA之上游流程</a></p><p data-tool="mdnice编辑器"><a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247492603&amp;idx=2&amp;sn=9333b7df0a8e8c448bb0d2925af22098&amp;scene=21#wechat_redirect" data-linktype="2">猪狗的参考基因组构建索引</a></p><figure data-tool="mdnice编辑器"><img data-ratio="0.45986124876114964" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vcAJQFW1cK0KPJ12RycJ5lTWZvXrWPgHrueciavz4ib0OYKbIqdKOicOTA/640?wx_fmt=png" data-type="png" data-w="1009" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vcAJQFW1cK0KPJ12RycJ5lTWZvXrWPgHrueciavz4ib0OYKbIqdKOicOTA/640?wx_fmt=png"></figure><hr data-tool="mdnice编辑器"><h2 data-tool="mdnice编辑器"><span></span>fastp</h2><p data-tool="mdnice编辑器">上游的前面一部分也可以参考之前推文<a href="https://mp.weixin.qq.com/s?__biz=MzUzMTEwODk0Ng==&amp;mid=2247514989&amp;idx=1&amp;sn=2502564754823455d1833597ebc4cb4b&amp;chksm=fa457e50cd32f746fdde14c55c2ea5faad7ce95b7298813249cedf4a06de4ca4c3be3f3b25d2&amp;scene=21&amp;cur_album_id=2545418429466607617#wechat_redirect" data-linktype="2">初探mRNA、lncRNA联合分析之上游</a></p><blockquote data-tool="mdnice编辑器"><figure><img data-ratio="0.7154929577464789" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8v9jQjdY00PUPv0jibqDX0DKFTpzGib3WUSFyiciaTxyukCibxhDCpicckvJmg/640?wx_fmt=png" data-type="png" data-w="355" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8v9jQjdY00PUPv0jibqDX0DKFTpzGib3WUSFyiciaTxyukCibxhDCpicckvJmg/640?wx_fmt=png"></figure></blockquote><figure data-tool="mdnice编辑器"><img data-ratio="1.1867043847241867" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8v4RetVwPgSeacGa1h5gh01icbcE482ePfTfPaWPEAjF9e3ia9TLtriasibg/640?wx_fmt=png" data-type="png" data-w="707" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8v4RetVwPgSeacGa1h5gh01icbcE482ePfTfPaWPEAjF9e3ia9TLtriasibg/640?wx_fmt=png"></figure><figure data-tool="mdnice编辑器"><img data-ratio="0.3411371237458194" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vT81QUKiazXVDh3F2pTMb6TsMiawicLUK1EwxYKGQ08bxDTVAcsJlv3iaLw/640?wx_fmt=png" data-type="png" data-w="598" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vT81QUKiazXVDh3F2pTMb6TsMiawicLUK1EwxYKGQ08bxDTVAcsJlv3iaLw/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">-i -o -I -O 分别对应一个样本两个fq文件的输入输出</p><p data-tool="mdnice编辑器">看看帮助文档</p><pre data-tool="mdnice编辑器"><span></span><code>  -l, --length_required                reads shorter than length_required will be discarded, default is 15. (int [=15])<br>      --length_limit                   reads longer than length_limit will be discarded, default 0 means no limitation. (int [=0])<br>  -q, --qualified_quality_phred        the quality value that a base is qualified. Default 15 means phred quality &gt;=Q15 is qualified. (int [=15])<br>  -z, --compression                    compression level <span>for</span> gzip output (1 ~ 9). 1 is fastest, 9 is smallest, default is 4. (int [=4])<br>  -R, --report_title                   should be quoted with <span>' or ", default is "fastp report" (string [=fastp report])<br>  -h, --html                           the html format report file name (string [=fastp.html])<br></span></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.43759398496240604" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vgMwaVyedVyM8GEI6PVxNkk5Vsj6rXPI4DS60s6UsvMICGICyAx15lw/640?wx_fmt=png" data-type="png" data-w="665" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vgMwaVyedVyM8GEI6PVxNkk5Vsj6rXPI4DS60s6UsvMICGICyAx15lw/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">以第一个样本为例看看fastp报表：</p><p data-tool="mdnice编辑器">参考：</p><p data-tool="mdnice编辑器">[Fastp：过滤二代测序数据]https://www.jianshu.com/p/6da36135e2d1</p><figure data-tool="mdnice编辑器"><img data-ratio="0.7423312883435583" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vm1DCfofYEkAic1RtsdKGqY5DvybssaI61T9GHRicDCS0RXSmibia4FluQQ/640?wx_fmt=png" data-type="png" data-w="815" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vm1DCfofYEkAic1RtsdKGqY5DvybssaI61T9GHRicDCS0RXSmibia4FluQQ/640?wx_fmt=png"></figure><figure data-tool="mdnice编辑器"><img data-ratio="0.24660633484162897" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vMCyzo1gp5BSYg5DV9v9wZdbvgznuPuUlJXmf7ATXEoKspTzloauyDg/640?wx_fmt=png" data-type="png" data-w="442" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vMCyzo1gp5BSYg5DV9v9wZdbvgznuPuUlJXmf7ATXEoKspTzloauyDg/640?wx_fmt=png"></figure><figure data-tool="mdnice编辑器"><img data-ratio="0.7744" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vryWLt8TV9Tn0DSfeKUOibaH0oIT95qGzb8B7ESm8LaBIp6Dos2OHxCw/640?wx_fmt=png" data-type="png" data-w="625" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vryWLt8TV9Tn0DSfeKUOibaH0oIT95qGzb8B7ESm8LaBIp6Dos2OHxCw/640?wx_fmt=png"></figure><figure data-tool="mdnice编辑器"><img data-ratio="0.4852791878172589" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vbnkOichRm2z8Lkicr6bQafL5y5xFtj8BF0WxEKxGSqicIFJib40PjWhkIw/640?wx_fmt=png" data-type="png" data-w="985" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vbnkOichRm2z8Lkicr6bQafL5y5xFtj8BF0WxEKxGSqicIFJib40PjWhkIw/640?wx_fmt=png"></figure><figure data-tool="mdnice编辑器"><img data-ratio="0.7304469273743017" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vV8lKwe4KmqIdeOtrzECNwvlWXAUPdiaDBmDibD7EREoBFQicndb7bMB0g/640?wx_fmt=png" data-type="png" data-w="716" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vV8lKwe4KmqIdeOtrzECNwvlWXAUPdiaDBmDibD7EREoBFQicndb7bMB0g/640?wx_fmt=png"></figure><figure data-tool="mdnice编辑器"><img data-ratio="0.4740740740740741" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vHwd2UCggPDjKMiajeYX4KWPuVn89AufSPiaqmY3NaITb92I0bNAXJDjw/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vHwd2UCggPDjKMiajeYX4KWPuVn89AufSPiaqmY3NaITb92I0bNAXJDjw/640?wx_fmt=png"></figure><figure data-tool="mdnice编辑器"><img data-ratio="0.8315539739027283" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vjzqhXpl5LhrZ9aibicA7X1DoQahWUtQZ88oH4YVNojB8nic8w2txEZmzg/640?wx_fmt=png" data-type="png" data-w="843" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vjzqhXpl5LhrZ9aibicA7X1DoQahWUtQZ88oH4YVNojB8nic8w2txEZmzg/640?wx_fmt=png"></figure><hr data-tool="mdnice编辑器"><h2 data-tool="mdnice编辑器"><span></span>hisat2比对</h2><p data-tool="mdnice编辑器">上游前面和bulk mRNA差不多</p><figure data-tool="mdnice编辑器"><img data-ratio="0.33798882681564246" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8v3sYkQsWm12mNt8heOnyfVVyLhPkLkqJMMklVQXS2icjNNPvRxiaiaPC9A/640?wx_fmt=png" data-type="png" data-w="716" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8v3sYkQsWm12mNt8heOnyfVVyLhPkLkqJMMklVQXS2icjNNPvRxiaiaPC9A/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">异常退出：</p><figure data-tool="mdnice编辑器"><img data-ratio="0.3118421052631579" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vfULuXt3nCY62IFSl8DmO9l3ic4ziclON9CnjIZajP6AAXOO89P4BOYTA/640?wx_fmt=png" data-type="png" data-w="760" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vfULuXt3nCY62IFSl8DmO9l3ic4ziclON9CnjIZajP6AAXOO89P4BOYTA/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器"><strong>一直给我返回samtools</strong> Usage 感觉只剩软件版本问题？</p><p data-tool="mdnice编辑器">之前做bulk mRNA的版本：</p><figure data-tool="mdnice编辑器"><img data-ratio="0.7528735632183908" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vxrlHO4Um5wmQicEOzibwIfib0xUpzCyylJWokjDga0ZrHQbdZ0ZIURIOA/640?wx_fmt=png" data-type="png" data-w="696" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vxrlHO4Um5wmQicEOzibwIfib0xUpzCyylJWokjDga0ZrHQbdZ0ZIURIOA/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">现在：</p><figure data-tool="mdnice编辑器"><img data-ratio="0.7839046199701938" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vfwMmAqsMlYJ7MR7gltEZoeUkfJSJcXEx1HOORnZq3qibsjrbQKwTVcA/640?wx_fmt=png" data-type="png" data-w="671" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vfwMmAqsMlYJ7MR7gltEZoeUkfJSJcXEx1HOORnZq3qibsjrbQKwTVcA/640?wx_fmt=png"></figure><figure data-tool="mdnice编辑器"><img data-ratio="0.13148148148148148" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vnGhE067aAxgZZCs6IIkPpzCUfX7mIsnBymE2ibke8Cl3Nbp8ht8ibcmA/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vnGhE067aAxgZZCs6IIkPpzCUfX7mIsnBymE2ibke8Cl3Nbp8ht8ibcmA/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">我记得我装的是新的，这是为什么？想起来了：</p><p data-tool="mdnice编辑器">我在之前安装trinity时记录到的情况</p><blockquote data-tool="mdnice编辑器"><figure><img data-ratio="0.5610561056105611" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vcSiag8q6T0PHNL4kALptehfb6zCoWNKOXkh3CLDHtK4MA6KAiaYv6grQ/640?wx_fmt=png" data-type="png" data-w="909" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vcSiag8q6T0PHNL4kALptehfb6zCoWNKOXkh3CLDHtK4MA6KAiaYv6grQ/640?wx_fmt=png"></figure></blockquote><p data-tool="mdnice编辑器">所以这后面如果使用trinity需要特别注意</p><p data-tool="mdnice编辑器">重装：</p><figure data-tool="mdnice编辑器"><img data-ratio="0.468503937007874" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vVUOw30MwJxBBbuuYVOOYEvmQYZiayLEl4ibeP4Bz3icVeFMrtvU4dKmaQ/640?wx_fmt=png" data-type="png" data-w="1016" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vVUOw30MwJxBBbuuYVOOYEvmQYZiayLEl4ibeP4Bz3icVeFMrtvU4dKmaQ/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">重装samtools后，单独测试第一个样本：</p><figure data-tool="mdnice编辑器"><img data-ratio="0.3675925925925926" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vicE7Lk210pr0yj3LLEqyicZUykN2SJ2tInswwwUq80cgxXpuvxD5sssw/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vicE7Lk210pr0yj3LLEqyicZUykN2SJ2tInswwwUq80cgxXpuvxD5sssw/640?wx_fmt=png"></figure><figure data-tool="mdnice编辑器"><img data-ratio="0.5527859237536656" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vQ0bxMz4HKPO6EWvI4hoiagWtaCynQfhqMKgRQYF7YIkZ6E5qISc6apg/640?wx_fmt=png" data-type="png" data-w="682" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vQ0bxMz4HKPO6EWvI4hoiagWtaCynQfhqMKgRQYF7YIkZ6E5qISc6apg/640?wx_fmt=png"></figure><hr data-tool="mdnice编辑器"><h2 data-tool="mdnice编辑器"><span></span>stringtie 定量</h2><pre data-tool="mdnice编辑器"><span></span><code>stringtie -p 4 -G <span>$gtf</span> \<br>            -o 4.stringtie_gtfs/<span>$sample</span>.gtf  \<br>            -l  <span>$sample</span> 3.hisat2_bams/<span>$sample</span>.bam <br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.1656441717791411" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vSicYSlYIZibeHW3umWiaYdpBcia0kFUWDGuQ3IUsLByWkL91yNN34sxiccA/640?wx_fmt=png" data-type="png" data-w="652" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vSicYSlYIZibeHW3umWiaYdpBcia0kFUWDGuQ3IUsLByWkL91yNN34sxiccA/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">目前这一步用的还是<strong>Assemble RNA-Seq alignments into potential transcripts.</strong></p><pre data-tool="mdnice编辑器"><span></span><code> -p number of threads (CPUs) to use (default: 1)<br> -G reference annotation to use <span>for</span> guiding the assembly process (GTF/GFF3)<br> -o output path/file name <span>for</span> the assembled transcripts GTF (default: stdout)<br> -l name prefix <span>for</span> output transcripts (default: STRG)<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.2786127167630058" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8v5Pfo3wsKVEPlkZeOQfRJHAkp0SdxP84q0tKaY0qkNybiaByOK7TSBow/640?wx_fmt=png" data-type="png" data-w="865" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8v5Pfo3wsKVEPlkZeOQfRJHAkp0SdxP84q0tKaY0qkNybiaByOK7TSBow/640?wx_fmt=png"></figure><figure data-tool="mdnice编辑器"><img data-ratio="0.5674217907227616" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vqTDxBy12apBogR5ZyCMsmic5icic5q8S5Fp2S38W0JB4OyGSUBbrcpsnA/640?wx_fmt=png" data-type="png" data-w="927" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vqTDxBy12apBogR5ZyCMsmic5icic5q8S5Fp2S38W0JB4OyGSUBbrcpsnA/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">到这里，我们就获得了stringtie对每个样本组装到的gtf文件</p><p data-tool="mdnice编辑器">联系<a href="https://mp.weixin.qq.com/s?__biz=MzUzMTEwODk0Ng==&amp;mid=2247514989&amp;idx=1&amp;sn=2502564754823455d1833597ebc4cb4b&amp;chksm=fa457e50cd32f746fdde14c55c2ea5faad7ce95b7298813249cedf4a06de4ca4c3be3f3b25d2&amp;scene=21&amp;cur_album_id=2545418429466607617#wechat_redirect" data-linktype="2">初探mRNA、lncRNA联合分析之上游</a></p><blockquote data-tool="mdnice编辑器"><figure><img data-ratio="1.0379918588873813" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vT9ek2acwjsNqfvxZWDkjMomSjsG68Atq6VTBVzBGh15HxIovweJpJA/640?wx_fmt=png" data-type="png" data-w="737" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vT9ek2acwjsNqfvxZWDkjMomSjsG68Atq6VTBVzBGh15HxIovweJpJA/640?wx_fmt=png"></figure></blockquote><blockquote data-tool="mdnice编辑器"><p><strong>可以发现如果直接基于bam文件定量，给到的 -G 参数就是一开始的参考基因组gtf文件，而不是需要多走一步组装后merge的gtf文件</strong></p></blockquote><p data-tool="mdnice编辑器">而我们这里就是要鉴定新的lncRNA</p><hr data-tool="mdnice编辑器"><h2 data-tool="mdnice编辑器"><span></span>合并gtf后鉴定新的lncRNA</h2><p data-tool="mdnice编辑器"><a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247493181&amp;idx=1&amp;sn=264be7aed913d74522012318ca18c582&amp;chksm=9b4ba686ac3c2f90095ca1339ce7a389d565bc91620a70de52b64b6e12e45766a04c594d789e&amp;scene=21&amp;cur_album_id=1322384987060142080#wechat_redirect" data-linktype="2">鉴定新的lncRNA之上游流程</a></p><figure data-tool="mdnice编辑器"><img data-ratio="0.4203703703703704" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vnassGQNO0ibLog5GfymF2zIURkRyXJSLicHb2iaHPCsAsYXcZdU4nHlrQ/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vnassGQNO0ibLog5GfymF2zIURkRyXJSLicHb2iaHPCsAsYXcZdU4nHlrQ/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">注意这一步stringtie merge 使用的<code>-G</code>参数 gtf文件仍为下载下来的已有参考，只有定量时使用的gtf文件是<strong>组装后merge的gtf文件</strong></p><p data-tool="mdnice编辑器">关于为什么需要merge后的组装gtf文件，stingtie相比featureCount能鉴定新转录本：</p><blockquote data-tool="mdnice编辑器"><p>有关stringtie的使用和解读可以参考前面bulk mRNAseq这两篇</p><p><a href="https://mp.weixin.qq.com/s?__biz=MzUzMTEwODk0Ng==&amp;mid=2247513115&amp;idx=1&amp;sn=dbcbb4ff2963b496d7420c6d9acbbf7e&amp;chksm=fa457126cd32f830efa9497bbe194215833e5e117fc88fb294ec2887c531f64cd69cf1488b2e&amp;scene=21&amp;cur_album_id=2545418429466607617#wechat_redirect" data-linktype="2">明明PCA区分非常好，但是差异基因数量很少？</a></p><p><a href="https://mp.weixin.qq.com/s?__biz=MzUzMTEwODk0Ng==&amp;mid=2247512469&amp;idx=1&amp;sn=364469f90477204a6319cd57211e8264&amp;chksm=fa4574a8cd32fdbe68badc2b6c922a164ce3be815877c5e4fed59628c72fd590f0a140752831&amp;scene=21&amp;cur_album_id=2545418429466607617#wechat_redirect" data-linktype="2">使用TPM/FPKM/RPKM进行差异分析真的可以消除系统误差吗？</a></p><p>stringtie <strong>（组装-合并-定量）</strong></p><p>Stringtie和FeatureCount都是用于转录组定量的工具，但它们使用不同的定量策略。</p><p>在FeatureCount的情况下，它 <strong>直接将读数映射到预先存在的注释（如参考基因组或基因注释），并将读数分配给相应的特征</strong> ，然后可以用于量化。</p><p>另一方面，Stringtie <strong>使用从头开始的方法从读取中组装转录本并生成新的注释文件。然后使用该组装的转录组来估计来自同一组读数的表达水平。</strong> 进行<strong>合并步骤以合并多个样本并生成一致转录组，该转录组可用于定量所有样本中的读数，从而提高准确性和再现性。</strong></p><p>这两种方法各有优缺点。<strong>FeatureCount的分析速度更快、更直接，但它只依赖于预先存在的注释，可能会错过以前没有注释的新的或替代的转录本。Stringtie速度较慢，但可以捕获新的或替代的转录物，并提供了对转录物丰度的改进评估，尤其是对于低表达或重叠的转录物。</strong></p><p><strong>当然stringtie其实也可以直接定量，如果不需要发现新的转录本和基因的话，可直接基于 bam 文件走定量步骤，我们这里还是使用从头开的</strong>方法学习一下这个软件。从头开始的方法和软件具体命令参数可参考上面给出的文章。</p></blockquote><p data-tool="mdnice编辑器">我们这里使用的为 <strong>组装-合并-gffcompare鉴定和筛选新的lncRNA</strong></p><figure data-tool="mdnice编辑器"><img data-ratio="1.04125" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vLvHhYFQUPUU8Tr26SRHpqQYhPNP3kLO9zu6WnGXgVCmkr4j5ibfcXxg/640?wx_fmt=png" data-type="png" data-w="800" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vLvHhYFQUPUU8Tr26SRHpqQYhPNP3kLO9zu6WnGXgVCmkr4j5ibfcXxg/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">我们这里使用110和99看看：</p><figure data-tool="mdnice编辑器"><img data-ratio="0.12034739454094293" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vEbP67R0wAB4hssjK3GKzetzUu7Dp4Mmua1zaytYduqNIxWiblz3PLPQ/640?wx_fmt=png" data-type="png" data-w="806" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vEbP67R0wAB4hssjK3GKzetzUu7Dp4Mmua1zaytYduqNIxWiblz3PLPQ/640?wx_fmt=png"></figure><figure data-tool="mdnice编辑器"><img data-ratio="0.2387218045112782" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8v4tibUvPoicwGRibsZ2eQFtkiarQ7xnYgDxEULBNCQFOQF7AAsbF000Xr1A/640?wx_fmt=png" data-type="png" data-w="532" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8v4tibUvPoicwGRibsZ2eQFtkiarQ7xnYgDxEULBNCQFOQF7AAsbF000Xr1A/640?wx_fmt=png"></figure><figure data-tool="mdnice编辑器"><img data-ratio="0.1290743155149935" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vsQdlhp9ry0gxeuFyJbspYERFTWy2TTrNosTEKYFAknvpWfVb020sPg/640?wx_fmt=png" data-type="png" data-w="767" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vsQdlhp9ry0gxeuFyJbspYERFTWy2TTrNosTEKYFAknvpWfVb020sPg/640?wx_fmt=png"></figure><figure data-tool="mdnice编辑器"><img data-ratio="0.24390243902439024" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vVR3wib9iat2JmnrJNzKeIiah4tlz0wcUGrdZ0Qx7DBfwWNS2K8EPX4iaIw/640?wx_fmt=png" data-type="png" data-w="533" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vVR3wib9iat2JmnrJNzKeIiah4tlz0wcUGrdZ0Qx7DBfwWNS2K8EPX4iaIw/640?wx_fmt=png"></figure><blockquote data-tool="mdnice编辑器"><p>可以看到，使用不同版本的gtf文件，对结果的影响很明显哦，<strong>鉴定新的lncRNA的话，也许2016年你认为是新的lncRNA，到2018年就已经被记录在册啦。</strong></p></blockquote><p data-tool="mdnice编辑器">关于gffcompare的使用，参考：</p><blockquote data-tool="mdnice编辑器"><p><a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247503885&amp;idx=4&amp;sn=c0b43aea554448751e935b4fadddb402&amp;scene=21#wechat_redirect" data-linktype="2">lncRNA组装流程的软件介绍之gffcompare</a></p><p>比较不同样本的转录本定量信息需要先将转录本信息储存为相同的格式，一般组装软件的输出结果都是gtf或gff。<strong>由于在组装的过程中产生了大量的新的转录本信息，而我们仅通过肉眼观察其唯一的注释信息----染色体上的起始位置，很显然无法阐明其中蕴含的生物学意义，因此我们需要将它们与已知的转录本注释文件---annotation.gtf进行比较，将新得到的转录本与注释好的转录本之间建立联系</strong>，这样可以让我们更好地发现新的转录本。而gffcompare就是做的这个工作，由于它是基于cufflinks的一个附件cuffcompare开发的，因此很多原理及输出文件的格式也与cuffcompare类似。</p><p><a href="https://mp.weixin.qq.com/s?__biz=Mzg2NjAyNTE1OQ==&amp;mid=2247484004&amp;idx=1&amp;sn=a68ce7279b3b4131fe70284278c3eeeb&amp;scene=21#wechat_redirect" data-linktype="2">gffcompare用法</a></p></blockquote><p data-tool="mdnice编辑器">我的思考：</p><p data-tool="mdnice编辑器"><strong>为什么stingtie组装时使用的基因组参考注释gtf文件和gffcompare使用的基因组注释文件一样，还能找到新转录本？</strong></p><blockquote data-tool="mdnice编辑器"><p>StingTie是一个用于转录组组装的软件工具，它将测序数据映射到参考基因组上，并尝试重建转录本信息。在StingTie组装过程中，它会生成一个结果文件，通常是以gtf或gff格式保存的转录本注释信息。</p><p>为了发现新的转录本，StingTie将生成的结果文件与已知的转录本注释文件（例如annotation.gtf）进行比较，并将新得到的转录本与已知的转录本建立联系。这个比较的过程是通过使用gffcompare工具来实现的。</p><p>虽然StingTie使用的基因组参考注释文件和gffcompare使用的基因组注释文件可能是相同的文件，但在具体的操作中，它们扮演了不同的角色。</p><p><strong>StringTie使用基因组参考注释文件来辅助转录组组装过程，提供基因和转录本的位置信息等，但它并不能完全包含所有已知的转录本信息，也不能涵盖特定样本的表达情况。</strong></p><p>而gffcompare则是根据StingTie生成的结果文件和已知的转录本注释文件进行比较，从而找到新的转录本。它能够对比两个转录本集合，并确定新的转录本、已知转录本的变体以及已知转录本的完整性等信息。</p><p>因此，尽管两者使用的基因组注释文件可能一样，但StingTie和gffcompare从不同的角度对待这个注释文件，通过组装过程和比较过程的不同，能够找到新的转录本。</p></blockquote><hr data-tool="mdnice编辑器"><h3 data-tool="mdnice编辑器"><span></span>解读gffcompare结果文件：<span></span></h3><figure data-tool="mdnice编辑器"><img data-ratio="0.6904231625835189" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vaRj93wF5rfND5daqKc7Rj54GbSotTjZdaGRWIWjkuKOKWYx3YFsLSA/640?wx_fmt=png" data-type="png" data-w="449" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vaRj93wF5rfND5daqKc7Rj54GbSotTjZdaGRWIWjkuKOKWYx3YFsLSA/640?wx_fmt=png"><figcaption>img</figcaption></figure><p data-tool="mdnice编辑器">输出文件六个,前四个文件可以指定保存位置，后两个文件是跟输入的gtf文件保存在一个位置，并且都是以-o提供的前缀开头的</p><h4 data-tool="mdnice编辑器"><span></span>- gffcmp.annotated.gtf：存储的是StringTie组装的转录本与注释文件内的转录本的差别信息，通过class_code来表示<span></span></h4><p data-tool="mdnice编辑器">如果只有1个新组装的gtf与参考gtf比较，则结果文件为gffcmp.annotated.gtf，包含新组装gtf文件里所有feature的注释结果；</p><p data-tool="mdnice编辑器">如果有多个新组装的gtf与参考gtf比较，结果文件为gffcmp.combined.gtf，将所有新组装gtf的注释结果合并到一起</p><figure data-tool="mdnice编辑器"><img data-ratio="0.5425925925925926" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vneBcPld6yFAnkLv3cnicN9TUqh7RJZpdjuE5Zjvg4ZAetpUHjClauibg/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vneBcPld6yFAnkLv3cnicN9TUqh7RJZpdjuE5Zjvg4ZAetpUHjClauibg/640?wx_fmt=png"></figure><h5 data-tool="mdnice编辑器"><span></span>class code分类<span></span></h5><figure data-tool="mdnice编辑器"><img data-ratio="0.8186180422264875" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vvQCdEzwP3AqCXK1UK7nVQC1AxItnehD5oibkX47opo6ic0SdAtNlbkGw/640?wx_fmt=png" data-type="png" data-w="1042" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vvQCdEzwP3AqCXK1UK7nVQC1AxItnehD5oibkX47opo6ic0SdAtNlbkGw/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">= : 预测转录本与参考转录本拥有完全相同的内含子</p><p data-tool="mdnice编辑器">c : 预测转录本包含在参考转录本中  /</p><p data-tool="mdnice编辑器"><strong>j : 预测的转录本与参考转录本共享至少一个剪切位点，可能是潜在的新型isoform</strong></p><p data-tool="mdnice编辑器"><strong>i ： 预测的转录子完全落入参考内含子中</strong></p><p data-tool="mdnice编辑器"><strong>o ： 预测的转录本的外显子与参考转录本的外显子有重叠</strong></p><p data-tool="mdnice编辑器"><strong>u ： 与参考转录本相比，预测的转录本是在基因间区</strong></p><p data-tool="mdnice编辑器"><strong>x : 预测的转录本的外显子与参考转录本重合但是在相反的链上  /</strong></p><p data-tool="mdnice编辑器">e ： 预测的单外显子转录本与参考转录本至少重合10bp的参考内含子长度，有可能是pre-mRNA</p><p data-tool="mdnice编辑器">p ： 预测的转录本的参考转录本附近2kb的距离内，可能是聚合酶滑动产生的片段</p><p data-tool="mdnice编辑器">r ： 预测的转录本有50%以上的碱基与重复序列重合</p><p data-tool="mdnice编辑器">s : 预测的转录本内含子与参考转录本重合但是在相反的链上(likely a mapping error)</p><blockquote data-tool="mdnice编辑器"><p><strong>class_code分类的具体含义:</strong>  <strong>“=”</strong> 代码表示此预测转录本与注释基因的所有内含子完全吻合，但它们在第一外显子(first exon)的起始端或最后外显子(last exon)的末端可能有差别。然而，这并不影响将“=”类重建转录本判定为已注释转录本。又如，转录本标有 <strong>“j”</strong> 类别代码，表明此转录本至少有一个内含子与已注释基因的内含子相同，而其他位置可能不同，据此可推断此类转录本可能是注释基因的一个新异构体(novel isoform)。另外 <strong>“i,o,u,x”</strong> 的分类符合lncRNA的特征，可用于lncRNA的识别过程。因此，“<strong>i，j，o，u，x</strong>”这5类转录本表示可能是新的转录本，符合lncRNA的要求，保留作为后续分析。</p></blockquote><h4 data-tool="mdnice编辑器"><span></span>- gffcmp.stats：文件存储比对结果的准确性和预测率<span></span></h4><p data-tool="mdnice编辑器">数据总结和准确性评估（包括Base、Exon、Intron、Intron chain、Transcript和Locus共6个水平的敏感性Sensitivity和准确性Precision评估）</p><figure data-tool="mdnice编辑器"><img data-ratio="0.45" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vCBia5G4hyCVia8GOwYaupZDjgpVrNiaQnGNv25j9PQTBOIhyOr4I9S5EQ/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vCBia5G4hyCVia8GOwYaupZDjgpVrNiaQnGNv25j9PQTBOIhyOr4I9S5EQ/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">gffcompare常用于比较从头组装的转录本与已知转录本，从而评估从头组装pipeline的性能，包括敏感性Sensitivity和准确性Precision两方面，从6个feature水平进行评估（Base level 、Exon level 、Intron level 、Intron chain level 、Transcript level 、Locus level）</p><p data-tool="mdnice编辑器"><strong>敏感性Sensitivity=TP/(TP+FN) （对原真假而言）</strong></p><p data-tool="mdnice编辑器"><strong>准确性Precision=TP/(TP+FP)  （对做出的判断而言，区别于特异性：正确判断原错误为错误，同敏感性，对原真假而言）</strong></p><p data-tool="mdnice编辑器">TP：true positives，真阳性，表示新组装的feature与参考的feature一致</p><p data-tool="mdnice编辑器">FN：false negatives，假阴性，表示参考的feature未出现在新组装的feature中</p><p data-tool="mdnice编辑器">FP：false positives，假阳性，表示新组装的feature在参考feature中未出现</p><p data-tool="mdnice编辑器">FP+TP代表新组装feature的总数</p><p data-tool="mdnice编辑器">loci基因组 transcript转录本</p><h4 data-tool="mdnice编辑器"><span></span>- gffcmp.loci<span></span></h4><h4 data-tool="mdnice编辑器"><span></span>- gffcompare.tracking 该文件记录了所有样本中转录本的匹配情况，特别是对于多个新组装gtf的文件<span></span></h4><figure data-tool="mdnice编辑器"><img data-ratio="0.45" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vY9IxzyTGM5j7wnNQGf93BQZPF3aqmYcqyWQs7f3JVhFLTO6fBa8dng/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vY9IxzyTGM5j7wnNQGf93BQZPF3aqmYcqyWQs7f3JVhFLTO6fBa8dng/640?wx_fmt=png"></figure><figure data-tool="mdnice编辑器"><img data-ratio="1.0341394025604551" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vJGExRfLLricuYnbvm0k5xqca4rnN0U1xyj4LHchBJeCYWQGJBLNcG0g/640?wx_fmt=png" data-type="png" data-w="703" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vJGExRfLLricuYnbvm0k5xqca4rnN0U1xyj4LHchBJeCYWQGJBLNcG0g/640?wx_fmt=png"></figure><h4 data-tool="mdnice编辑器"><span></span>- gffcmp..refmap<span></span></h4><p data-tool="mdnice编辑器">这个文件包含四列信息，第一列ref_gene_id是gene symbol ，无symbol的给出的是ensemble的gene id; 第二列ref_id是指ensemble的transcript id; 第三列class_code 是“=”和“c”;第四列是cuff_id_list。这个文件指组装后与参考基因组几乎完全匹配的转录本</p><p data-tool="mdnice编辑器">对于每个新组装的gtf文件，都会产生一个refmap文件。内容为对于每个参考转录本，哪个query转录本完全或部分匹配到该转录本上，有4列，分别为：参考gtf中的基因名/基因ID；参考gtf中的转录本ID；匹配类型；详细匹配信息</p><figure data-tool="mdnice编辑器"><img data-ratio="0.45" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vRcgHgYJSIFaqKWGNCgKIia2iacZa2PmHUdDInWsp584LH12fJcNQK0vA/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vRcgHgYJSIFaqKWGNCgKIia2iacZa2PmHUdDInWsp584LH12fJcNQK0vA/640?wx_fmt=png"></figure><h4 data-tool="mdnice编辑器"><span></span>- gffcpm..tmap 包含了转录本的定量信息，如cov，FPKM等，可用于定量或筛选新转录本(ref_gene_id,ref_id,class_code,qry_gene_id,qry_id,num_exons,FPKM,TPM,cov,len,major_iso_id,ref_match_len)<span></span></h4><p data-tool="mdnice编辑器">对于每个新组装的gtf文件，都会产生一个tmap文件，该文件可用于后续过滤转录本。内容为对于每个新组装gtf中的转录本，哪条参考转录本与其匹配度最高，一般有12列：参考基因名/基因ID；参考转录本ID；匹配类型；新组装基因ID；新组装转录本ID；新组装转录本外显子数；FPKM；TPM；Coverage；Length；新组装gtf中该基因的主剪切本；新组装转录本与参考转录本匹配的长度</p><figure data-tool="mdnice编辑器"><img data-ratio="0.45" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vicFe7x8ib84KLzkAKsFY4pOlgeDJGC6VbbGQPdguLT8N0X1Pr3K43Dgw/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vicFe7x8ib84KLzkAKsFY4pOlgeDJGC6VbbGQPdguLT8N0X1Pr3K43Dgw/640?wx_fmt=png"></figure><hr data-tool="mdnice编辑器"><h2 data-tool="mdnice编辑器"><span></span>从新组装的gtf文件中提取特定class code的转录本进行后续筛选</h2><p data-tool="mdnice编辑器">视频课对应的后续流程：</p><figure data-tool="mdnice编辑器"><img data-ratio="0.6833333333333333" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vmtcHIqheKqzUsIT1TacNoD5Ht0oVwibWxUXGdJvNKw5Taqb2czOYZxg/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vmtcHIqheKqzUsIT1TacNoD5Ht0oVwibWxUXGdJvNKw5Taqb2czOYZxg/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">这篇文章想找intergenic （LINC）所有只选class code="u"</p><figure data-tool="mdnice编辑器"><img data-ratio="0.34444444444444444" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8v4dH4OHoKyxkicEialrOj6CMRvIhYZv4nobrWibCOSRWHAibegYwbpmoolA/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8v4dH4OHoKyxkicEialrOj6CMRvIhYZv4nobrWibCOSRWHAibegYwbpmoolA/640?wx_fmt=png"></figure><figure data-tool="mdnice编辑器"><img data-ratio="0.4150268336314848" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vlnTX4H2CSDYJddUMBMI2FMJhNtuBrHVdvicKVnFhM5UcuraibHN9lKHg/640?wx_fmt=png" data-type="png" data-w="559" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vlnTX4H2CSDYJddUMBMI2FMJhNtuBrHVdvicKVnFhM5UcuraibHN9lKHg/640?wx_fmt=png"></figure><figure data-tool="mdnice编辑器"><img data-ratio="0.43161634103019536" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8v4jYd2yR0nrwrghHL3AyibRNDXang0icTFkYSuOrGDueW37Ofcm7TuCmQ/640?wx_fmt=png" data-type="png" data-w="563" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8v4jYd2yR0nrwrghHL3AyibRNDXang0icTFkYSuOrGDueW37Ofcm7TuCmQ/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">但是由于后面的视频课丢失，也无对应的推文：</p><figure data-tool="mdnice编辑器"><img data-ratio="0.3242009132420091" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8v5LOYhUa9BOibtyJRbcI9xibD6SW1ttMCnmBQ4ib9QES3OJ1k9f5QlW52A/640?wx_fmt=png" data-type="png" data-w="876" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8v5LOYhUa9BOibtyJRbcI9xibD6SW1ttMCnmBQ4ib9QES3OJ1k9f5QlW52A/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">所以从这里开始，我们<strong>参考另一个项目代码，继续我们的流程</strong>：</p><blockquote data-tool="mdnice编辑器"><p><a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247504544&amp;idx=1&amp;sn=25275b763b6e695a39f6ca26a9f93fe9&amp;chksm=9b4b921bac3c1b0d986da3ad78b33462da2b2c9d2bfdb61f558ea8a39febdd17cdf2e4ef8435&amp;scene=21&amp;cur_album_id=1322384987060142080#wechat_redirect" data-linktype="2">LncRNA鉴定上游分析</a></p><p><a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247504567&amp;idx=1&amp;sn=3ddf2df1cd9554e2718de0abff04959e&amp;chksm=9b4b920cac3c1b1a0ac7ae48b5de9802e7eeebf91a880fad9ffe13cd09132fb35a1405bd8d2f&amp;scene=21&amp;cur_album_id=1322384987060142080#wechat_redirect" data-linktype="2">LncRNA的组装和鉴定（下游流程）</a></p></blockquote><h3 data-tool="mdnice编辑器"><span></span>Gffcompare 获取转录本组装情况<span></span></h3><blockquote data-tool="mdnice编辑器"><p>这个我们前面根据视频课两个推文已经获得</p></blockquote><p data-tool="mdnice编辑器"><strong>关键文件</strong>：以release99版本为例</p><figure data-tool="mdnice编辑器"><img data-ratio="0.3563714902807775" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vk5uzSxEu8vvtWM7icz1f7icaPtibw9z88usA83Za4hgu9fHCuRTCWAodg/640?wx_fmt=png" data-type="png" data-w="463" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vk5uzSxEu8vvtWM7icz1f7icaPtibw9z88usA83Za4hgu9fHCuRTCWAodg/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">后面都是以最新版110为例</p><h3 data-tool="mdnice编辑器"><span></span>step1：保留指定class_code的transcripts<span></span></h3><blockquote data-tool="mdnice编辑器"><p>为跟进流程，我们这里就不再跟视频课对应项目要求，而是使用现在这个参考项目要求，比如取class_code: u x j i o 而不仅仅是 u</p></blockquote><p data-tool="mdnice编辑器">过滤，只保留class_code="u","x","i","j","o"的 transcripts</p><figure data-tool="mdnice编辑器"><img data-ratio="0.09166666666666666" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vJ4hh1csucjM0Ejs4J5ZTO1pZowRX0KUllJuOhhWYU0TerZhvQeMg5A/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vJ4hh1csucjM0Ejs4J5ZTO1pZowRX0KUllJuOhhWYU0TerZhvQeMg5A/640?wx_fmt=png"></figure><figure data-tool="mdnice编辑器"><img data-ratio="0.20496894409937888" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vicLZVeHIZ4vwAbAXCwhricaGZZzNKMRyaewyU14AMIWTzL7KrWay1iaVQ/640?wx_fmt=png" data-type="png" data-w="805" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vicLZVeHIZ4vwAbAXCwhricaGZZzNKMRyaewyU14AMIWTzL7KrWay1iaVQ/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">获取剩余transcripts的exons位置信息，提取序列并组装成转录本序列</p><p data-tool="mdnice编辑器">获取剩余的transcripts的ID</p><figure data-tool="mdnice编辑器"><img data-ratio="0.8145416227608009" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vPjt9MUlDWLfckSsgcDXhes0t1Gux5kzkicfcscoiaykKlpqRHjNfOxVA/640?wx_fmt=png" data-type="png" data-w="949" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vPjt9MUlDWLfckSsgcDXhes0t1Gux5kzkicfcscoiaykKlpqRHjNfOxVA/640?wx_fmt=png"></figure><figure data-tool="mdnice编辑器"><img data-ratio="0.13677811550151975" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vDr7axvDVj5iaP9hnicpTfe19J5cjYibiakP5VJO1KkXic3QDzM17quNibvgQ/640?wx_fmt=png" data-type="png" data-w="987" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vDr7axvDVj5iaP9hnicpTfe19J5cjYibiakP5VJO1KkXic3QDzM17quNibvgQ/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">整理transcripts得到对应gtf</p><figure data-tool="mdnice编辑器"><img data-ratio="0.15555555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vru8Tee0giaRn3SLa3E4yib4JZo3RCib4h9P7CjqdFIfCyTsnjTAoQlHmw/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vru8Tee0giaRn3SLa3E4yib4JZo3RCib4h9P7CjqdFIfCyTsnjTAoQlHmw/640?wx_fmt=png"></figure><figure data-tool="mdnice编辑器"><img data-ratio="0.45" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vd9BDFkJaD8bZghg7qSCnRjsMx4NOPa1EbAJJIrBGUE8nlh2wWK9pfw/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vd9BDFkJaD8bZghg7qSCnRjsMx4NOPa1EbAJJIrBGUE8nlh2wWK9pfw/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">把filter1_transcript.gtf中的class_code "=" 替换为L， 去除剩余为去除的class_code "="</p><blockquote data-tool="mdnice编辑器"><p>前面只取了class_code: u x j i o 怎么会有 =</p></blockquote><figure data-tool="mdnice编辑器"><img data-ratio="0.45185185185185184" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vdKJ2icz6w3UUALc68ArVKeK0z4P4ucs8K9zG9JbU4ef1Ky0ljOn19Ug/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vdKJ2icz6w3UUALc68ArVKeK0z4P4ucs8K9zG9JbU4ef1Ky0ljOn19Ug/640?wx_fmt=png"></figure><figure data-tool="mdnice编辑器"><img data-ratio="0.28425925925925927" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8veGDiadBIrUic1W29umFWl0wQOjuiaiaGV6wiaiciacgsrgtlEmahKxiasVnXicA/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8veGDiadBIrUic1W29umFWl0wQOjuiaiaGV6wiaiciacgsrgtlEmahKxiasVnXicA/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">最终（43475-609350，如一个transcript包含多个exon片段）</p><figure data-tool="mdnice编辑器"><img data-ratio="0.12277580071174377" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vE9yt4H7EH69KoWBibs7pic6JATC0OaSAgvibKHlPIQYmj4TZX9BEBk0JQ/640?wx_fmt=png" data-type="png" data-w="562" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vE9yt4H7EH69KoWBibs7pic6JATC0OaSAgvibKHlPIQYmj4TZX9BEBk0JQ/640?wx_fmt=png"></figure><figure data-tool="mdnice编辑器"><img data-ratio="0.4666666666666667" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vM9GdOzgyosdZDWX0E5kNp9kDDE4iahZD5pLKQbHpGy1L9kFUKWZvwHA/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vM9GdOzgyosdZDWX0E5kNp9kDDE4iahZD5pLKQbHpGy1L9kFUKWZvwHA/640?wx_fmt=png"></figure><h3 data-tool="mdnice编辑器"><span></span>step2:  根据长度进行过滤<span></span></h3><p data-tool="mdnice编辑器">过滤，只保留exon&gt;1并且长度&gt;200bp的transcripts</p><p data-tool="mdnice编辑器"><strong>筛选tmap文件</strong></p><figure data-tool="mdnice编辑器"><img data-ratio="0.45925925925925926" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vSGJ8Qxiacp95UxmjRicknFrXazy9GTB7Wxicicb3mgLqOGeAf7buNke4vQ/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vSGJ8Qxiacp95UxmjRicknFrXazy9GTB7Wxicicb3mgLqOGeAf7buNke4vQ/640?wx_fmt=png"></figure><figure data-tool="mdnice编辑器"><img data-ratio="0.1111111111111111" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vV3J3rGPI9QovzGSHv6IZsTWLcnA6CRUeJSunUpaeZ9xia2dFBeFZibZw/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vV3J3rGPI9QovzGSHv6IZsTWLcnA6CRUeJSunUpaeZ9xia2dFBeFZibZw/640?wx_fmt=png"></figure><figure data-tool="mdnice编辑器"><img data-ratio="0.15185185185185185" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vO7yIsfoUyV1TSfW5jgF6dFRhq7lNYpAkGaVr07xicIicIdkT5A6wwfeA/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vO7yIsfoUyV1TSfW5jgF6dFRhq7lNYpAkGaVr07xicIicIdkT5A6wwfeA/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">感觉没去多少</p><p data-tool="mdnice编辑器"><strong>transcripts的exon组成gtf，根据exon位置信息提取基因组序列，组装成转录本序列：</strong></p><p data-tool="mdnice编辑器">transcripts的exon组成gtf</p><figure data-tool="mdnice编辑器"><img data-ratio="0.09074074074074075" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vwZFpeN7W0OuGAqE5MafyoZ45GiaicRnpE4QofibicKEYSusUEAk9DySXCw/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vwZFpeN7W0OuGAqE5MafyoZ45GiaicRnpE4QofibicKEYSusUEAk9DySXCw/640?wx_fmt=png"></figure><figure data-tool="mdnice编辑器"><img data-ratio="0.45" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8ve2PCOdTujHUqnwVoxDicLCBbRibQPrs3ZicKgTbK8SJw8iaFY7o7VJMQkg/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8ve2PCOdTujHUqnwVoxDicLCBbRibQPrs3ZicKgTbK8SJw8iaFY7o7VJMQkg/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">根据exon位置信息提取基因组序列，组装成转录本序列</p><blockquote data-tool="mdnice编辑器"><p>这里gffread需要另外装一下</p><figure><img data-ratio="0.3181818181818182" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vm1Zu1S7X0V7rk9z5FGMJpxLNr13Apkrk2ia9deXA5ODQI6EFxJ0AHNA/640?wx_fmt=png" data-type="png" data-w="858" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vm1Zu1S7X0V7rk9z5FGMJpxLNr13Apkrk2ia9deXA5ODQI6EFxJ0AHNA/640?wx_fmt=png"></figure></blockquote><figure data-tool="mdnice编辑器"><img data-ratio="0.044444444444444446" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vW9uoicFRpictiacrcY2icPsQwQCibOqCXR0EEeKCStffkvzkn82Np8ZZ93w/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vW9uoicFRpictiacrcY2icPsQwQCibOqCXR0EEeKCStffkvzkn82Np8ZZ93w/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">还怪好嘞自动帮我保留了索引文件</p><p data-tool="mdnice编辑器">各transcript的fa：</p><figure data-tool="mdnice编辑器"><img data-ratio="0.11564625850340136" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8via9BsqjCeKtTYGQ716ZwR0yZh0icicAFYaHodozznNZJXfVWaibZOFiah3w/640?wx_fmt=png" data-type="png" data-w="588" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8via9BsqjCeKtTYGQ716ZwR0yZh0icicAFYaHodozznNZJXfVWaibZOFiah3w/640?wx_fmt=png"></figure><figure data-tool="mdnice编辑器"><img data-ratio="0.9874371859296482" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vVMLNZ3HjC9SASRlgVpHftEBpOqCtIFVuKPnliaLDbb3NkCq4XgHJsHw/640?wx_fmt=png" data-type="png" data-w="796" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vVMLNZ3HjC9SASRlgVpHftEBpOqCtIFVuKPnliaLDbb3NkCq4XgHJsHw/640?wx_fmt=png"></figure><h3 data-tool="mdnice编辑器"><span></span>step3：转录本编码能力预测<span></span></h3><p data-tool="mdnice编辑器">转录本编码能力预测，主要是4个软件，需要取交集：</p><p data-tool="mdnice编辑器">参考:</p><ul data-tool="mdnice编辑器"><li><section><a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247503683&amp;idx=4&amp;sn=81db443971a04c904fdcf03f1013f2bc&amp;chksm=9b4b8ff8ac3c06eedadc4ce908f4c8989b1300d5677c83faaadd3ad83005ee03f96b7bb447a9&amp;scene=21&amp;cur_album_id=1322384987060142080#wechat_redirect" data-linktype="2">CPAT</a></section></li><li><section><a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247503720&amp;idx=3&amp;sn=fabe1f10333a36c0add0f5d33508186a&amp;chksm=9b4b8fd3ac3c06c537a3374974d22abdc9bd36726c0a451673b6c22104205a12b89f2e94e294&amp;scene=21&amp;cur_album_id=1322384987060142080#wechat_redirect" data-linktype="2">CPC2</a></section></li><li><section><a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247504005&amp;idx=3&amp;sn=39677d2c702a5a40f55ddccc0bd40048&amp;chksm=9b4b903eac3c19288606e6d7a5bec2895108d7be2cdb2596339ea830dbb3900b4b31fa9a2ba6&amp;scene=21&amp;cur_album_id=1322384987060142080#wechat_redirect" data-linktype="2">lncFinder</a></section></li><li><section><a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247503885&amp;idx=5&amp;sn=b161d44c578dfe0cc6e0dddf1d1787ac&amp;chksm=9b4b90b6ac3c19a0ba25f9ee8005dbb38ebb121543673b63f5bfae80e648021ef46c6c1fae8a&amp;scene=21&amp;cur_album_id=1322384987060142080#wechat_redirect" data-linktype="2">PLEK</a></section></li></ul><h4 data-tool="mdnice编辑器"><span></span><a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247503683&amp;idx=4&amp;sn=81db443971a04c904fdcf03f1013f2bc&amp;chksm=9b4b8ff8ac3c06eedadc4ce908f4c8989b1300d5677c83faaadd3ad83005ee03f96b7bb447a9&amp;scene=21&amp;cur_album_id=1322384987060142080#wechat_redirect" data-linktype="2">CPAT</a><span></span></h4><figure data-tool="mdnice编辑器"><img data-ratio="0.6027777777777777" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vrz1LXnNetaTT7aVZFTSGypRIdUp667nkUym3W96rSfWM68tgOKdbhA/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vrz1LXnNetaTT7aVZFTSGypRIdUp667nkUym3W96rSfWM68tgOKdbhA/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">https://cpat.readthedocs.io/en/latest/</p><figure data-tool="mdnice编辑器"><img data-ratio="0.675" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vnxLDfB9Mzkv3Bu7bJ6dgyoC0SPydk4ib2y8M1BWpeicqZmuEXMVfWAAw/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vnxLDfB9Mzkv3Bu7bJ6dgyoC0SPydk4ib2y8M1BWpeicqZmuEXMVfWAAw/640?wx_fmt=png"></figure><figure data-tool="mdnice编辑器"><img data-ratio="0.4527777777777778" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vGzibicUXvMYiaAV1cCHO7nYbHexoexUAtlonBOicScRbX5qY8roHBQn9ibw/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vGzibicUXvMYiaAV1cCHO7nYbHexoexUAtlonBOicScRbX5qY8roHBQn9ibw/640?wx_fmt=png"></figure><blockquote data-tool="mdnice编辑器"><p>User need to download prebuilt logit model and hexamer table (https://sourceforge.net/projects/rna-cpat/files/v1.2.2/prebuilt_model/) for human, mouse, zebrafish and fly. For other species, we provide scripts to build these models (see below).</p></blockquote><p data-tool="mdnice编辑器">https://cpat.readthedocs.io/en/latest/#build-hexamer-table</p><p data-tool="mdnice编辑器">https://cpat.readthedocs.io/en/latest/#build-logit-model</p><ul data-tool="mdnice编辑器"><li><section>Build hexamer table</section></li></ul><p data-tool="mdnice编辑器">Example:</p><pre data-tool="mdnice编辑器"><span></span><code>make_hexamer_tab.py -c Human_coding_transcripts_CDS.fa   -n Human_noncoding_transcripts_RNA.fa &gt;Human_Hexamer.tsv<br></code></pre><blockquote data-tool="mdnice编辑器"><p><strong>-c</strong> CODING_FILE, **--cod=**CODING_FILE</p><p>Coding sequence (<strong>must be CDS without UTR, i.e. from start coden to stop coden</strong>) in fasta format. User can get CDS sequence of a bed file using UCSC table browser(http://genome.ucsc.edu/cgi-bin/hgTables?org=Human&amp;db=hg19&amp;hgsid=289407045&amp;hgta_doMainPage=1) -n NONCODING_FILE, **--noncod=**NONCODING_FILE Noncoding sequences in fasta format</p><p><strong>-n</strong> NONCODING_FILE, **--noncod=**NONCODING_FILE</p><p>Noncoding sequences in fasta format</p></blockquote><p data-tool="mdnice编辑器">看看前面下载的fa文件：</p><figure data-tool="mdnice编辑器"><img data-ratio="0.525" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vYbibIVJq5zPPooLtwsERR109iahztUicL2RYjO7Jv0RZ67ONp4X1tG48w/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vYbibIVJq5zPPooLtwsERR109iahztUicL2RYjO7Jv0RZ67ONp4X1tG48w/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">如何判断存不存在UTR？</p><figure data-tool="mdnice编辑器"><img data-ratio="0.4179245283018868" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vyffILrBmq9bBKA0iahwzrCiaNlcLQXo2Uket3YupqDCZz9kxfJVugEtQ/640?wx_fmt=png" data-type="png" data-w="1060" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vyffILrBmq9bBKA0iahwzrCiaNlcLQXo2Uket3YupqDCZz9kxfJVugEtQ/640?wx_fmt=png"></figure><figure data-tool="mdnice编辑器"><img data-ratio="1.129277566539924" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8via4BI9s9SyPHUc8tjt136KfvOLCianpXCsF3fr7EzXWN8bKbZYpBh05w/640?wx_fmt=png" data-type="png" data-w="789" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8via4BI9s9SyPHUc8tjt136KfvOLCianpXCsF3fr7EzXWN8bKbZYpBh05w/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">于是重新下载CDS fa文件</p><pre data-tool="mdnice编辑器"><span></span><code>make_hexamer_tab.py -c ~/refdata/Sus_scrofa.Sscrofa11.1.cds.all.fa -n ../5.lncRNA/gffcomp110_filter2_transcript_exon.fa &gt; Sus_scrofa_Hexamer.tsv<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.525" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vbEDGJ8CwoZGgQT6vlia6nP0nIBKQm1Dm0DZLTGgA5tC2UcntyfmqKEA/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vbEDGJ8CwoZGgQT6vlia6nP0nIBKQm1Dm0DZLTGgA5tC2UcntyfmqKEA/640?wx_fmt=png"></figure><ul data-tool="mdnice编辑器"><li><section>Build Logit model</section></li></ul><figure data-tool="mdnice编辑器"><img data-ratio="0.38796296296296295" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vicicBS7N5Yt2k7eQpbMsqaOo8wtpD6wQGWQcrsREPgy5LcdEI0PAQ8Qw/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vicicBS7N5Yt2k7eQpbMsqaOo8wtpD6wQGWQcrsREPgy5LcdEI0PAQ8Qw/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">Example:</p><pre data-tool="mdnice编辑器"><span></span><code>make_logitModel.py  -x Human_Hexamer.tsv -c Human_coding_transcripts_mRNA.fa -n Human_noncoding_transcripts_RNA.fa -o Human<br></code></pre><p data-tool="mdnice编辑器"><strong>-c</strong> CODING_FILE, **--cgene=**CODING_FILE</p><p data-tool="mdnice编辑器">Genomic sequnences of protein-coding RNAs in FASTA (https://en.wikipedia.org/wiki/FASTA_format) or standard 12-column BED (https://genome.ucsc.edu/FAQ/FAQformat.html#format1) format.</p><p data-tool="mdnice编辑器">CDS vs mRNA(https://www.differencebetween.com/difference-between-cds-and-cdna/):</p><figure data-tool="mdnice编辑器"><img data-ratio="0.9893129770992366" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8v2V1wj7cDxZqicEMdrfjCg8f8mrGj54CwwN4iakY2TCNIpibKfBh7pRicnw/640?wx_fmt=png" data-type="png" data-w="655" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8v2V1wj7cDxZqicEMdrfjCg8f8mrGj54CwwN4iakY2TCNIpibKfBh7pRicnw/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">下载mRNA/cDNA fa文件</p><figure data-tool="mdnice编辑器"><img data-ratio="1.089121887287025" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8v2FWyB0qHNQR7fE4cjic5qAXPAk9Q5s03ibGqVwbRAMmYVYDnENsEwnicA/640?wx_fmt=png" data-type="png" data-w="763" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8v2FWyB0qHNQR7fE4cjic5qAXPAk9Q5s03ibGqVwbRAMmYVYDnENsEwnicA/640?wx_fmt=png"></figure><pre data-tool="mdnice编辑器"><span></span><code>make_logitModel.py -x Sus_scrofa_Hexamer.tsv -c ~/refdata/Sus_scrofa.Sscrofa11.1.cdna.all.fa -n ../5.lncRNA/gffcomp110_filter2_transcript_exon.fa -o Sus_scrofa<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.3453703703703704" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vDLZF12iaJdVJAh3eapAjGy9UXQ2bYTWIRJ3n0sXiaFWX40cK91kwuFNw/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vDLZF12iaJdVJAh3eapAjGy9UXQ2bYTWIRJ3n0sXiaFWX40cK91kwuFNw/640?wx_fmt=png"></figure><ul data-tool="mdnice编辑器"><li><section>Run CPAT on local computer</section></li></ul><pre data-tool="mdnice编辑器"><span></span><code>cpat.py -x Sus_scrofa_Hexamer.tsv --antisense -d Sus_scrofa.logit.RData --top-orf=5 -g ../5.lncRNA/gffcomp110_filter2_transcript_exon.fa -o cpat_output<br></code></pre><blockquote data-tool="mdnice编辑器"><p>--antisense</p><p>Also search for ORFs from the anti-sense strand.<em>Sense strand</em> (or coding strand) is DNA strand that carries the translatable code in the 5′ to 3′ direction. default=False (i.e. only search for ORFs from the sense strand)</p><p>--top-orf=N_TOP_ORF</p><p>Number of ORF candidates. Many RNAs have dozens of possible ORFs, in most cases, the real ORF is ranked (by size) in the top several. To increase speed, we do not need to calculate “Fickett score”, “Hexamer score” and “coding probability” for all of them. default=5</p><figure><img data-ratio="0.4703703703703704" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vrPiaewnfxHrEhAGgLgIURA6zUhSCAgtsKpHC9fVnSccuuzPic6JLiaUfA/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vrPiaewnfxHrEhAGgLgIURA6zUhSCAgtsKpHC9fVnSccuuzPic6JLiaUfA/640?wx_fmt=png"></figure></blockquote><figure data-tool="mdnice编辑器"><img data-ratio="0.38055555555555554" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8v00zVMx0Qeebp7IgO0uhEU238DJHB0ibTJ33BjGbI1BYVkCTB9HOoGoA/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8v00zVMx0Qeebp7IgO0uhEU238DJHB0ibTJ33BjGbI1BYVkCTB9HOoGoA/640?wx_fmt=png"></figure><figure data-tool="mdnice编辑器"><img data-ratio="0.23103448275862068" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vNDjNeicORZoa6IMDNXxZ64ubQ6SswUAEm18xAjXZMmiaszyo0eEArLUw/640?wx_fmt=png" data-type="png" data-w="580" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vNDjNeicORZoa6IMDNXxZ64ubQ6SswUAEm18xAjXZMmiaszyo0eEArLUw/640?wx_fmt=png"></figure><figure data-tool="mdnice编辑器"><img data-ratio="0.525" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vHZbibeyFn2ibl8uC22xicAmeN8I0pYocFUDXFAAvviaww5Z3ZGJykaIutA/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vHZbibeyFn2ibl8uC22xicAmeN8I0pYocFUDXFAAvviaww5Z3ZGJykaIutA/640?wx_fmt=png"></figure><hr data-tool="mdnice编辑器"><h4 data-tool="mdnice编辑器"><span></span><a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247503720&amp;idx=3&amp;sn=fabe1f10333a36c0add0f5d33508186a&amp;chksm=9b4b8fd3ac3c06c537a3374974d22abdc9bd36726c0a451673b6c22104205a12b89f2e94e294&amp;scene=21&amp;cur_album_id=1322384987060142080#wechat_redirect" data-linktype="2">CPC2</a><span></span></h4><blockquote data-tool="mdnice编辑器"><p>CPC2为CPC 的升级版，发布于2017 年，是目前最新的lncRNA 鉴定工具，也代表着lncRNA 鉴定的最新研究进展。</p><p>在经过大量的特征选择后，CPC2 最终的特征主要包括四条：<strong>最长ORF 长度，ORF 的完整性，Fickett 分数以及等电点</strong> (isoelectric point, pI)[39,40]。其中等电点特征主要是通过将最长ORF 翻译为氨基酸序列，而后根据氨基酸等电点这一理化性质计算而得。与大多lncRNA 鉴定工具相同，CPC2 也使用了支持向量机来构建分类器。</p></blockquote><blockquote data-tool="mdnice编辑器"><p><strong># 创建python2环境</strong>conda create -n py2test python=2.7</p><h1><span></span>安装biopython</h1><p>conda install biopython=1.70</p><h1><span></span>安装CPC2</h1><p>wget https://github.com/biocoder/CPC2/archive/refs/heads/master.zip</p><p>unzip master.zip</p><p>cd ~/CPC2-master/libs/libsvm/libsvm-3.18</p><p>make clean &amp;&amp; make</p></blockquote><figure data-tool="mdnice编辑器"><img data-ratio="0.6935185185185185" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vcTicmcWMrkjBtOQuA5kiaBiacicRNSCMX8dYXUw9cI7Yt6Qgn8RgMLXBRg/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vcTicmcWMrkjBtOQuA5kiaBiacicRNSCMX8dYXUw9cI7Yt6Qgn8RgMLXBRg/640?wx_fmt=png"></figure><figure data-tool="mdnice编辑器"><img data-ratio="0.19692307692307692" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vYokqKRpBnjWW1fRl8fEhA2b7Av66n6Qy9IymKEFxhkJzr9UB1WbFfg/640?wx_fmt=png" data-type="png" data-w="325" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vYokqKRpBnjWW1fRl8fEhA2b7Av66n6Qy9IymKEFxhkJzr9UB1WbFfg/640?wx_fmt=png"></figure><figure data-tool="mdnice编辑器"><img data-ratio="0.525" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vfzzRC1SNWHRK2klFso14Zv0YBSnoERqa3Qwxw57EYnrX5vzQMCU7Lw/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vfzzRC1SNWHRK2klFso14Zv0YBSnoERqa3Qwxw57EYnrX5vzQMCU7Lw/640?wx_fmt=png"></figure><figure data-tool="mdnice编辑器"><img data-ratio="0.19823232323232323" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vp1Ne6kUficZjHYzK3Vm1XkHgZcsyrUibUPibMQrDoSTztcyXEW3vBrRxA/640?wx_fmt=png" data-type="png" data-w="792" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vp1Ne6kUficZjHYzK3Vm1XkHgZcsyrUibUPibMQrDoSTztcyXEW3vBrRxA/640?wx_fmt=png"></figure><figure data-tool="mdnice编辑器"><img data-ratio="0.525" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vicaqTvVUH94ib6yt1ibXJkA5JJic2CcB9Cal98WK0KsRSA0CFIKMTMeJIQ/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vicaqTvVUH94ib6yt1ibXJkA5JJic2CcB9Cal98WK0KsRSA0CFIKMTMeJIQ/640?wx_fmt=png"></figure><hr data-tool="mdnice编辑器"><h4 data-tool="mdnice编辑器"><span></span><a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247504005&amp;idx=3&amp;sn=39677d2c702a5a40f55ddccc0bd40048&amp;chksm=9b4b903eac3c19288606e6d7a5bec2895108d7be2cdb2596339ea830dbb3900b4b31fa9a2ba6&amp;scene=21&amp;cur_album_id=1322384987060142080#wechat_redirect" data-linktype="2">lncFinder</a><span></span></h4><blockquote data-tool="mdnice编辑器"><p>LncFinder是一种新的lncRNA识别工具。<strong>基于六聚体的对数距离，多尺度结构信息和从快速离散傅立叶变换获得的理化特征。</strong></p><p><strong>为了确定最佳分类器，使用10倍交叉验证对五种广泛使用的机器学习算法进行了验证：逻辑回归，支持向量机（SVM），随机森林，极限学习机器和深度学习。</strong></p><p>最终选择SVM作为LncFinder的分类器。经过全面的功能选择和模型验证方案的评估，LncFinder在多个物种上的表现优于几种最先进的工具。用户可以轻松，高效地使用新的数据集或不同的机器学习算法对LncFinder进行重新训练。</p></blockquote><p data-tool="mdnice编辑器">https://cran.r-project.org/web/packages/LncFinder/index.html</p><p data-tool="mdnice编辑器">Example：</p><pre data-tool="mdnice编辑器"><span></span><code><span># Prediction without secondary structure-based features</span><br>library(LncFinder)<br>demo_DNA.seq &lt;- seqinr::read.fasta(<span>"~/lncRNA_project/07.identification/step2/filter2_transcript_exon.fa"</span>)<br><br>Seqs &lt;- demo_DNA.seq<br><br><span>### The first parameter of lnc_finder() indicates the unevaluated</span><br><span>### sequences; parameter "SS.features = FALSE" means predict sequences</span><br><span>### without secondary structure-based features; parameter </span><br><span>### 'format = "DNA"' means the format of input sequences is DNA;</span><br><span>### parameters "frequencies.file" and "svm.model" indicate predicting</span><br><span>### sequences with which model; parameter "parallel.cores" means the</span><br><span>### number of cores to conduct parallel computing, and "-1" means </span><br><span>### using all available cores.</span><br><br>result_1 &lt;- LncFinder::lnc_finder(Seqs,<br>                                  SS.features = FALSE,<br>                                  format = <span>"DNA"</span>,<br>                                  frequencies.file = <span>"human"</span>,<br>                                  svm.model = <span>"human"</span>, <br>                                  parallel.cores = 1)<br>write.table (result_1, file =<span>"~/lncRNA_project/07.identification/step3/lncFinder/lncFinder_result.txt"</span>, sep =<span>"\t"</span>,row.names =TRUE, col.names =TRUE,quote =FALSE)<br></code></pre><p data-tool="mdnice编辑器">lnc_finder（）的第一个参数表示未评估的序列；参数“SS.features=FALSE”表示预测没有基于二级结构特征的序列；参数'format=“DNA”'表示输入序列的格式为DNA；参数“frequencs.file”和“svm.model”表示用哪个模型预测序列；参数“parallel.cores”表示进行并行计算的核数，“-1”表示使用所有可用核。</p><p data-tool="mdnice编辑器"><strong>我们这里是猪的需要自己构建这两个文件</strong></p><figure data-tool="mdnice编辑器"><img data-ratio="0.40370370370370373" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vHOEALVaDEuxwJ4KOXMvXiaLj3II8d1NRAfibcepUIY3tna4S4D70NQ6A/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vHOEALVaDEuxwJ4KOXMvXiaLj3II8d1NRAfibcepUIY3tna4S4D70NQ6A/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">需要传入lncRNA的fa文件，看起来lncFinder本质上是一个分类器，基于机器学习，需要有自己原有的训练数据集（已知lncRNA）？那这个文件去哪找呢？</p><figure data-tool="mdnice编辑器"><img data-ratio="0.47685185185185186" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vBicibBrN8UQ0WdzT3T3oCicxBTaDGFYKwbjzbBF9S7TibzuBK47sQlSfow/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vBicibBrN8UQ0WdzT3T3oCicxBTaDGFYKwbjzbBF9S7TibzuBK47sQlSfow/640?wx_fmt=png"></figure><figure data-tool="mdnice编辑器"><img data-ratio="0.47685185185185186" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vDMHOicEISFJBuuF0hfw1K9vt4HM2zRKwzQ49lccOSuWuITUQy9ZKiaibg/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vDMHOicEISFJBuuF0hfw1K9vt4HM2zRKwzQ49lccOSuWuITUQy9ZKiaibg/640?wx_fmt=png"></figure><figure data-tool="mdnice编辑器"><img data-ratio="0.512962962962963" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vgFyQMZ01l8IbBYY3u7K0tCMtsbED5Bbdj4otVeYUy8qMaPH56z1IDg/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vgFyQMZ01l8IbBYY3u7K0tCMtsbED5Bbdj4otVeYUy8qMaPH56z1IDg/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">mRNA需要：</p><figure data-tool="mdnice编辑器"><img data-ratio="0.1537037037037037" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vRiar5KzeY2LsZSlfQpNLlmp1J6icwyib2iaw9fXLXfykVoF3HMyIy64hKg/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vRiar5KzeY2LsZSlfQpNLlmp1J6icwyib2iaw9fXLXfykVoF3HMyIy64hKg/640?wx_fmt=png"></figure><figure data-tool="mdnice编辑器"><img data-ratio="0.33055555555555555" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vg7znT8ibOQOgM0Le6Z0qYfnuIoria6M0YeWAzic6UX9BurxOIwIgrhGEw/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vg7znT8ibOQOgM0Le6Z0qYfnuIoria6M0YeWAzic6UX9BurxOIwIgrhGEw/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">https://anaconda.org/bioconda/viennarna</p><figure data-tool="mdnice编辑器"><img data-ratio="0.19537037037037036" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vKQTNQGB9sBJH9BXfuhJ69GPVDG0aqZBISsNnCoYlvls7kKB28d8Mww/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vKQTNQGB9sBJH9BXfuhJ69GPVDG0aqZBISsNnCoYlvls7kKB28d8Mww/640?wx_fmt=png"></figure><blockquote data-tool="mdnice编辑器"><p>Returns data.frame. The first row is RNA sequence; the second row is Dot-Bracket Notation of secondary structure sequences; the last row is minimum free energy (MFE).</p></blockquote><p data-tool="mdnice编辑器">这一步耗时过长，遂跳过lncFinder的使用</p><hr data-tool="mdnice编辑器"><h4 data-tool="mdnice编辑器"><span></span><a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247503885&amp;idx=5&amp;sn=b161d44c578dfe0cc6e0dddf1d1787ac&amp;chksm=9b4b90b6ac3c19a0ba25f9ee8005dbb38ebb121543673b63f5bfae80e648021ef46c6c1fae8a&amp;scene=21&amp;cur_album_id=1322384987060142080#wechat_redirect" data-linktype="2">PLEK</a><span></span></h4><blockquote data-tool="mdnice编辑器"><p>PLEK软件通过序列的kmer构成来区分编码和非编码转录本，不需要通过比对来完成，所以运行速度较快，同时其性能受到测序错误的影响的概率较低，比较稳定。</p></blockquote><pre data-tool="mdnice编辑器"><span></span><code>wget https://sourceforge.net/projects/plek/files/PLEK.1.2.tar.gz<br><br>tar xzvf PLEK.1.2.tar.gz<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.29907407407407405" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vvkTlybDxVe7eN7jlBe95Ld0iajHAyA99oVbzKIao9LnBVfrue3bxjRA/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vvkTlybDxVe7eN7jlBe95Ld0iajHAyA99oVbzKIao9LnBVfrue3bxjRA/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">这个软件有点奇怪，难道只能放在工作目录下？</p><figure data-tool="mdnice编辑器"><img data-ratio="0.21796565389696168" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vicsibOcWrZ9BOl2QNEMtic263LcRTnMp43ajlDicxVZ2iaZMEUK9ACHH4qQ/640?wx_fmt=png" data-type="png" data-w="757" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vicsibOcWrZ9BOl2QNEMtic263LcRTnMp43ajlDicxVZ2iaZMEUK9ACHH4qQ/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">删除前面安装的目录和环境变量信息，重新在工作目录下安装，成功运行</p><figure data-tool="mdnice编辑器"><img data-ratio="0.525" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vzibHOT9NBBTlZzKO1hFb6WQBISQCRE3iatvmK7gK6rznDZu5sAIH28Rg/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vzibHOT9NBBTlZzKO1hFb6WQBISQCRE3iatvmK7gK6rznDZu5sAIH28Rg/640?wx_fmt=png"></figure><figure data-tool="mdnice编辑器"><img data-ratio="0.525" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vBicgiapcHDSzyDzHVDvVrEn2jVZsaKB2qn87qtCpM5lmTzQ9tjrD7elQ/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vBicgiapcHDSzyDzHVDvVrEn2jVZsaKB2qn87qtCpM5lmTzQ9tjrD7elQ/640?wx_fmt=png"></figure><figure data-tool="mdnice编辑器"><img data-ratio="0.525" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vlqnOBU6WTUdZcGFoSGcZy8CQ5PdWibKyIYD1slDr2ChOhaeecicS5xog/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vlqnOBU6WTUdZcGFoSGcZy8CQ5PdWibKyIYD1slDr2ChOhaeecicS5xog/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">看起来时脚本里遇到报错了被异常捕获到</p><p data-tool="mdnice编辑器">但是还是有一个结果文件：</p><figure data-tool="mdnice编辑器"><img data-ratio="0.20907079646017698" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vib07eG2r1wRkv7vxXYH7UnNQQ1icrDwLA6tAL1AkaNVgyFuMoALqpMzw/640?wx_fmt=png" data-type="png" data-w="904" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vib07eG2r1wRkv7vxXYH7UnNQQ1icrDwLA6tAL1AkaNVgyFuMoALqpMzw/640?wx_fmt=png"></figure><figure data-tool="mdnice编辑器"><img data-ratio="0.1741424802110818" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vtAvhhAnibB12t0icWyfoKpn4Xf61obZ1H9l5TLSfMIYEnv5PVdb4p0oQ/640?wx_fmt=png" data-type="png" data-w="758" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vtAvhhAnibB12t0icWyfoKpn4Xf61obZ1H9l5TLSfMIYEnv5PVdb4p0oQ/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">完整，那就拿着接着走吧</p><p data-tool="mdnice编辑器">怀疑是-out参数要给一个文件名但我给的是目录</p><figure data-tool="mdnice编辑器"><img data-ratio="0.525" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vgSU4mic9umjqdj9t67jK5tL0DAsTT2JGoQ3RJLWUwReZgH6P80tMFww/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vgSU4mic9umjqdj9t67jK5tL0DAsTT2JGoQ3RJLWUwReZgH6P80tMFww/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">第一列代表该转录本为coding还是non-coding, 第二列为打分值，打分值大于0为coding, 小于零为non-coding, 第三列为fasta文件中的序列标识符</p><pre data-tool="mdnice编辑器"><span></span><code>less _result | grep -w <span>'Non-coding'</span> |awk <span>'{print $3}'</span> |sed <span>'s/&gt;//g'</span> &gt; plek_nc_id.txt<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.525" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8via3rBL5CBbCLbh7OgII11HmYdJTbQves8B95RQQDuErtu57BrWY23Zg/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8via3rBL5CBbCLbh7OgII11HmYdJTbQves8B95RQQDuErtu57BrWY23Zg/640?wx_fmt=png"></figure><hr data-tool="mdnice编辑器"><h4 data-tool="mdnice编辑器"><span></span>3个软件取交集，根据获取到的lncRNA预测的id，获取后续所需gtf和fasta文件<span></span></h4><figure data-tool="mdnice编辑器"><img data-ratio="0.11829436038514443" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vH3BRYCKqo8OicPNWibwAa2Ak6REqn5ibk8KhgX41gebVbyqBCTSOYX8cQ/640?wx_fmt=png" data-type="png" data-w="727" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vH3BRYCKqo8OicPNWibwAa2Ak6REqn5ibk8KhgX41gebVbyqBCTSOYX8cQ/640?wx_fmt=png"></figure><figure data-tool="mdnice编辑器"><img data-ratio="0.1681528662420382" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vuOF4YOAskARN9N1rOXXudwuYaFicYDicFnibOK6iaB4fENYgfpM68wklzg/640?wx_fmt=png" data-type="png" data-w="785" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vuOF4YOAskARN9N1rOXXudwuYaFicYDicFnibOK6iaB4fENYgfpM68wklzg/640?wx_fmt=png"></figure><figure data-tool="mdnice编辑器"><img data-ratio="0.525" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vkOIiclENWicXevCe3JfzZibtPfrdGNpkMWYz4KauOGQSphRdY3JWcAsHQ/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vkOIiclENWicXevCe3JfzZibtPfrdGNpkMWYz4KauOGQSphRdY3JWcAsHQ/640?wx_fmt=png"></figure><figure data-tool="mdnice编辑器"><img data-ratio="0.09815242494226328" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vs6lDRkrBXr5BhrYrJBDcFiaibZCRsD1TUcbm9icBmqcgj3hyXNS2HEgkA/640?wx_fmt=png" data-type="png" data-w="866" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vs6lDRkrBXr5BhrYrJBDcFiaibZCRsD1TUcbm9icBmqcgj3hyXNS2HEgkA/640?wx_fmt=png"></figure><figure data-tool="mdnice编辑器"><img data-ratio="0.525" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vhjLm7nfBceBjS7otQjkBUYX3SLDv7JzmuwqMms9D6AqXFZ4Bp6dojA/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vhjLm7nfBceBjS7otQjkBUYX3SLDv7JzmuwqMms9D6AqXFZ4Bp6dojA/640?wx_fmt=png"></figure><hr data-tool="mdnice编辑器"><p data-tool="mdnice编辑器"><strong>根据获取到的lncRNA预测的id，获取后续所需gtf和fasta文件（原推文无，此处为我自行查阅资料和参考其他步骤编写）：</strong></p><p data-tool="mdnice编辑器"><strong>提取对应的fasta序列文件：</strong></p><figure data-tool="mdnice编辑器"><img data-ratio="0.13703703703703704" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vLTsLSKtUfZKOjphtf9jU3nLuc6bB6v6U05XKvzb3hf5bGBTDrJ1jsg/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vLTsLSKtUfZKOjphtf9jU3nLuc6bB6v6U05XKvzb3hf5bGBTDrJ1jsg/640?wx_fmt=png"></figure><figure data-tool="mdnice编辑器"><img data-ratio="0.18865435356200527" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8v9Zj41HlbKslRsroBrzibca8nrcfWTf8JYibZCj8MicDjp0lt1ebEQHfAg/640?wx_fmt=png" data-type="png" data-w="758" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8v9Zj41HlbKslRsroBrzibca8nrcfWTf8JYibZCj8MicDjp0lt1ebEQHfAg/640?wx_fmt=png"></figure><figure data-tool="mdnice编辑器"><img data-ratio="0.11856474258970359" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vXE8TEdTcZAISzxuCZOhPxibYDoibKm6exhzfF0cBcNG6fQpHY0FfdvTQ/640?wx_fmt=png" data-type="png" data-w="641" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vXE8TEdTcZAISzxuCZOhPxibYDoibKm6exhzfF0cBcNG6fQpHY0FfdvTQ/640?wx_fmt=png"></figure><figure data-tool="mdnice编辑器"><img data-ratio="0.5296296296296297" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vOH62Yjg3Xh2JvMMe1CCWnt3CQGWqF1KECugZuUX1QRaLJ3UVFhsIlw/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vOH62Yjg3Xh2JvMMe1CCWnt3CQGWqF1KECugZuUX1QRaLJ3UVFhsIlw/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器"><strong>（这一步其实可以融入到获取对应的gtf文件后面</strong></p><p data-tool="mdnice编辑器"><strong>参考前面step2：</strong></p><blockquote data-tool="mdnice编辑器"><p><strong>transcripts的exon组成gtf，根据exon位置信息提取基因组序列，组装成转录本序列</strong></p></blockquote><p data-tool="mdnice编辑器"><strong>这里只是因为一开始我觉得gtf文件没有必要了就没提，单独提取的fasta。其实gtf文件也需要一路根据过滤步骤过滤保存，在进行定量以便过滤掉低表达量的lncRNA是必要的）</strong></p><p data-tool="mdnice编辑器"><strong>提取对应的gtf文件：</strong></p><blockquote data-tool="mdnice编辑器"><p>此处注意文件命名，带有exon字样的gtf文件为提取后保留exon的gtf文件，是用来写作fa序列文件的</p></blockquote><figure data-tool="mdnice编辑器"><img data-ratio="0.06296296296296296" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vemkI4ib4TIkgzJ2fauXA68zqIUibickQeZiaKWtNdH3yQBnwaMvJ4Pf6ww/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vemkI4ib4TIkgzJ2fauXA68zqIUibickQeZiaKWtNdH3yQBnwaMvJ4Pf6ww/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">后面如果通过这个途径获取对应的fa文件就需要提取gtf文件中exon部分，通过gffread来写</p><hr data-tool="mdnice编辑器"><h3 data-tool="mdnice编辑器"><span></span>step4：比对到Pfam据库<span></span></h3><p data-tool="mdnice编辑器">使用Transeq 将转录本序列翻译为6个可能的蛋白序列</p><pre data-tool="mdnice编辑器"><span></span><code>nohup transeq filter3_by_noncoding_exon.fa filter4_protein.fa -frame=6 &amp;<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.5296296296296297" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vd9bicibS2vlPTCnZt8r7iaBLYVsC1qYlDYK43rdnduvUo5djoTz4khFPQ/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vd9bicibS2vlPTCnZt8r7iaBLYVsC1qYlDYK43rdnduvUo5djoTz4khFPQ/640?wx_fmt=png"></figure><figure data-tool="mdnice编辑器"><img data-ratio="0.1540983606557377" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vvI35wDPJJ9WOPSo5RrcLK0QJficrfYMKpuFvUqTD35eUgrAISIw7E3A/640?wx_fmt=png" data-type="png" data-w="915" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vvI35wDPJJ9WOPSo5RrcLK0QJficrfYMKpuFvUqTD35eUgrAISIw7E3A/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">比对到[Pfam数据库]http://pfam.xfam.org/，过滤 (E-value &lt; 1e-5)</p><blockquote data-tool="mdnice编辑器"><p>Pfam数据库是一系列蛋白质家族的集合，其中每一个蛋白家族都以多序列比对和隐马尔科夫模型的形式来表示</p></blockquote><figure data-tool="mdnice编辑器"><img data-ratio="0.5101851851851852" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vEK5XibFYriaJLWXlXjdTSodYTQGzZh8XrpRmDoj8eLxtVpIAyAl4UoKg/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vEK5XibFYriaJLWXlXjdTSodYTQGzZh8XrpRmDoj8eLxtVpIAyAl4UoKg/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">http://ftp.ebi.ac.uk/pub/databases/Pfam/current_release/</p><p data-tool="mdnice编辑器">https://www.ebi.ac.uk/Tools/pfa/pfamscan/</p><p data-tool="mdnice编辑器">参考：</p><blockquote data-tool="mdnice编辑器"><p>使用pfam-scan进行预测(https://www.jianshu.com/p/fb3bd3de1c38)</p><figure><img data-ratio="0.635036496350365" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vDydMTJ5j5hJjfcic40AZ492vnK19ZFmVbbAyIu0rX42jxTXh4IvvIzg/640?wx_fmt=png" data-type="png" data-w="685" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vDydMTJ5j5hJjfcic40AZ492vnK19ZFmVbbAyIu0rX42jxTXh4IvvIzg/640?wx_fmt=png"></figure><p>Pfam数据库蛋白编码能力预测(http://www.biotrainee.com/thread-1212-1-1.html)</p><p>Pfam包括两个质量级别的家族数据库：Pfam-A和Pfam-B。Pfam-A来自基础序列数据库Pfamseq，是根据最新的UniProtKB数据建立的，质量较高。Pfam-B做为Pfam-A的补充，是一个未注释的低质量数据库，一般是由ADDA数据中的非冗余cluster自动生成的。虽然质量较低，但对于鉴定Pfam-A无法覆盖到的功能保守区域是非常有用的。</p></blockquote><figure data-tool="mdnice编辑器"><img data-ratio="0.5583554376657824" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vAxsibRtreWXgvn0acGibHeqBPXq0cnUoRFvwb7W5ibnDRh0HecsicNOIiag/640?wx_fmt=png" data-type="png" data-w="754" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vAxsibRtreWXgvn0acGibHeqBPXq0cnUoRFvwb7W5ibnDRh0HecsicNOIiag/640?wx_fmt=png"></figure><figure data-tool="mdnice编辑器"><img data-ratio="0.30925925925925923" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vZXKtMRscibRtWza4ic4KoWNKprQL5TnS8EtjJL3oOMJE8Jjh8JGKl4BA/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vZXKtMRscibRtWza4ic4KoWNKprQL5TnS8EtjJL3oOMJE8Jjh8JGKl4BA/640?wx_fmt=png"></figure><figure data-tool="mdnice编辑器"><img data-ratio="0.5296296296296297" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vIElt8ibvZLnUic8dhCT1bLicx7404XrCBufBj5icVw80TcYMicVUw9iaOshg/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vIElt8ibvZLnUic8dhCT1bLicx7404XrCBufBj5icVw80TcYMicVUw9iaOshg/640?wx_fmt=png"></figure><figure data-tool="mdnice编辑器"><img data-ratio="0.5296296296296297" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vdEH8ZknW1nwOzoFLXq74XBTP0x1Sl8MEfBLN5z2S484NK6Y0677U5Q/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vdEH8ZknW1nwOzoFLXq74XBTP0x1Sl8MEfBLN5z2S484NK6Y0677U5Q/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">过滤 (E-value &lt; 1e-5)</p><figure data-tool="mdnice编辑器"><img data-ratio="0.12407407407407407" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vMicpg27xAXfnibRq9HtQrgnjprZYwyzINHzPtGeUtEHYmdGibSytxibXYw/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vMicpg27xAXfnibRq9HtQrgnjprZYwyzINHzPtGeUtEHYmdGibSytxibXYw/640?wx_fmt=png"></figure><figure data-tool="mdnice编辑器"><img data-ratio="0.5296296296296297" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vqygSZu4QLKb404o9SUC2EtMnf9wppPH4DLI9Yt4MnvRMl5ibtlLdT6A/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vqygSZu4QLKb404o9SUC2EtMnf9wppPH4DLI9Yt4MnvRMl5ibtlLdT6A/640?wx_fmt=png"></figure><figure data-tool="mdnice编辑器"><img data-ratio="0.0821917808219178" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vcf3EdZNVPuzgQib1Y9GdwpVtibEBeGRKCU3icIA3wxGB8OfuZhqJCG1Fw/640?wx_fmt=png" data-type="png" data-w="803" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vcf3EdZNVPuzgQib1Y9GdwpVtibEBeGRKCU3icIA3wxGB8OfuZhqJCG1Fw/640?wx_fmt=png"></figure><hr data-tool="mdnice编辑器"><p data-tool="mdnice编辑器">获取对应gtf文件：</p><blockquote data-tool="mdnice编辑器"><p>直接过滤 fastq 文件即可</p></blockquote><p data-tool="mdnice编辑器">grep -v 非匹配项 -f  从文件读取patterns</p><p data-tool="mdnice编辑器">过滤ID：</p><figure data-tool="mdnice编辑器"><img data-ratio="0.16203703703703703" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8v4oJibKVCOg64Us0uww0FX2zkSlCc5iaEyoX712kgx6kHCRAK1azEkJiaA/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8v4oJibKVCOg64Us0uww0FX2zkSlCc5iaEyoX712kgx6kHCRAK1azEkJiaA/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">提取gtf：</p><figure data-tool="mdnice编辑器"><img data-ratio="0.0962962962962963" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vVxLAFOgyNQVT3TQLNN4c8U1AHvcgTfibJqvZeVZ7HcCpAibWQ2P7Jl0w/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vVxLAFOgyNQVT3TQLNN4c8U1AHvcgTfibJqvZeVZ7HcCpAibWQ2P7Jl0w/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">提取fasta：</p><figure data-tool="mdnice编辑器"><img data-ratio="0.11388888888888889" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vcsqXXAZESqgXFsT8NBE7nAibcCgoiaU9KLIB7hKIsD5rNU3SMsqp5KSg/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vcsqXXAZESqgXFsT8NBE7nAibcCgoiaU9KLIB7hKIsD5rNU3SMsqp5KSg/640?wx_fmt=png"></figure><hr data-tool="mdnice编辑器"><p data-tool="mdnice编辑器">+ps：这里回到gtf文件提取外显子再写成fa文件</p><p data-tool="mdnice编辑器">一开始个人感觉没有必要</p><p data-tool="mdnice编辑器">前面已经获得了<img data-ratio="0.08862629246676514" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vXYCYak0KQTibxGBx13bXqOdB4rIH06mTB79OArzibWic2bV4ItPCqU2Ig/640?wx_fmt=png" data-type="png" data-w="677" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vXYCYak0KQTibxGBx13bXqOdB4rIH06mTB79OArzibWic2bV4ItPCqU2Ig/640?wx_fmt=png"></p><p data-tool="mdnice编辑器">这两个文件</p><p data-tool="mdnice编辑器">在filter3_by_noncoding_exon.fa基础上根据coding.ID直接过滤就好了</p><figure data-tool="mdnice编辑器"><img data-ratio="0.1330977620730271" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vQKnMicVK4nNialnXuk7qhFxicg2wHQ8kXeNNdREXPtQuypY4PXJKATDcA/640?wx_fmt=png" data-type="png" data-w="849" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vQKnMicVK4nNialnXuk7qhFxicg2wHQ8kXeNNdREXPtQuypY4PXJKATDcA/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">（其实可以发现两种方法（fa - fa / gtf - gtf_exons - fa）得到的结果是一样的，都是142条序列）</p><p data-tool="mdnice编辑器">后面发现gtf文件在进行定量以便过滤掉低表达量的lncRNA是必要的</p><hr data-tool="mdnice编辑器"><h3 data-tool="mdnice编辑器"><span></span>step5：比对到NR数据库<span></span></h3><p data-tool="mdnice编辑器">参考：</p><blockquote data-tool="mdnice编辑器"><p>[史上最全的BLAST本地化教程]https://zhuanlan.zhihu.com/p/556971474</p><p>[使用Diamond将宏基因组测序数据比对到Nr数据库]https://blog.csdn.net/jileiqwd/article/details/108932732</p><p>[构建NCBI本地BLAST数据库]https://wenku.baidu.com/view/7f099944c9aedd3383c4bb4cf7ec4afe04a1b1e7.html?<em>wkts</em>=1691388429085&amp;bdQuery=diamond+blastx+%E5%88%B0NR%E6%95%B0%E6%8D%AE%E5%BA%93</p></blockquote><p data-tool="mdnice编辑器">https://ftp.ncbi.nlm.nih.gov/blast/db/FASTA/</p><p data-tool="mdnice编辑器">下载速度很慢</p><p data-tool="mdnice编辑器">参考：</p><blockquote data-tool="mdnice编辑器"><p><a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247494799&amp;idx=1&amp;sn=7f61b5f54d697ae7b052cca5352d1796&amp;scene=21#wechat_redirect" data-linktype="2">什么！！！超70G的NT数据库文件一个小时搞定</a></p><p><a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247504091&amp;idx=4&amp;sn=42b77d335e8421d6b6dab1786fad0013&amp;scene=21#wechat_redirect" data-linktype="2">lncRNA组装流程的软件介绍本地化NR数据库|按物种拆分</a></p></blockquote><h4 data-tool="mdnice编辑器"><span></span>使用ascp加速下载NR库<span></span></h4><figure data-tool="mdnice编辑器"><img data-ratio="0.5970149253731343" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vGRUQmZDLxNEJ3oEl2EVDibEcaET3oCzl8BVT8nTYQfjllUcw2jR1ic8A/640?wx_fmt=png" data-type="png" data-w="469" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vGRUQmZDLxNEJ3oEl2EVDibEcaET3oCzl8BVT8nTYQfjllUcw2jR1ic8A/640?wx_fmt=png"></figure><pre data-tool="mdnice编辑器"><span></span><code>nohup ascp -v -k 1 -T -l 400m -i ~/.aspera/connect/etc/asperaweb_id_dsa.openssh anonftp@ftp.ncbi.nlm.nih.gov:/blast/db/FASTA/nr.gz ./ &amp;<br></code></pre><hr data-tool="mdnice编辑器"><figure data-tool="mdnice编辑器"><img data-ratio="0.5027777777777778" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vh97eDN8szn1wZMNWrCiaXbH0AULbvkz4AlVAKicC6mFhicuMPGwhzAZRw/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vh97eDN8szn1wZMNWrCiaXbH0AULbvkz4AlVAKicC6mFhicuMPGwhzAZRw/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">Taxonomy ID: 9823</p><h4 data-tool="mdnice编辑器"><span></span>从NR蛋白数据库中提取<strong><em>Sus</em> <em>scrofa</em></strong>的蛋白质序列<span></span></h4><p data-tool="mdnice编辑器">首先使用TaxonKit提取特定taxons下的所有taxid</p><figure data-tool="mdnice编辑器"><img data-ratio="0.10462962962962963" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vJ5biamficibZCUp4TnW9moyuAxZm2aW2t0wBgLRH0TiaItXiaJcyvkYxk0Q/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vJ5biamficibZCUp4TnW9moyuAxZm2aW2t0wBgLRH0TiaItXiaJcyvkYxk0Q/640?wx_fmt=png"></figure><ul data-tool="mdnice编辑器"><li><section>下载taxdump.tar.gz</section></li></ul><p data-tool="mdnice编辑器">ftp://ftp.ncbi.nih.gov/pub/taxonomy/taxdump.tar.gz</p><p data-tool="mdnice编辑器">同样的方法试试拼接路径用ascp下载，成功</p><pre data-tool="mdnice编辑器"><span></span><code>nohup ascp -v -k 1 -T -l 400m -i ~/.aspera/connect/etc/asperaweb_id_dsa.openssh anonftp@ftp.ncbi.nlm.nih.gov:/pub/taxonomy/taxdump.tar.gz ./ &amp;<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.14351851851851852" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8v0ib9ghaFkXuzRZVdgoNx6DBJwv2icFC5cZt0Pic6wUDNtibRQHFKENPE8A/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8v0ib9ghaFkXuzRZVdgoNx6DBJwv2icFC5cZt0Pic6wUDNtibRQHFKENPE8A/640?wx_fmt=png"></figure><figure data-tool="mdnice编辑器"><img data-ratio="0.22136563876651982" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8veGAroAr7FIpRpMiaFN9bcqerJPdbIkmaLgoczksIk0B9sStgkclvbkw/640?wx_fmt=png" data-type="png" data-w="908" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8veGAroAr7FIpRpMiaFN9bcqerJPdbIkmaLgoczksIk0B9sStgkclvbkw/640?wx_fmt=png"></figure><pre data-tool="mdnice编辑器"><span></span><code>taxonkit list --ids 9823 --indent <span>""</span> &gt; pig.taxid.txt<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.5296296296296297" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8v7NRUSCtxHfchIb6U6UT4dfRFsvzAico72abBvhRPwwq8IcvVWVgwPjA/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8v7NRUSCtxHfchIb6U6UT4dfRFsvzAico72abBvhRPwwq8IcvVWVgwPjA/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">构建一张表，第一列是taxid，后面7列跟着门纲目科属种的名称(可做可不做)</p><pre data-tool="mdnice编辑器"><span></span><code>less pig.taxid.txt | taxonkit lineage | taxonkit reformat -f <span>"{k}\t{p}\t{c}\t{o}\t{f}\t{g}\t{s}"</span> -F | cut -f 1,3- | sed <span>'1i\Taxid\tKingdom\tPhylum\tClass\tOrder\tFamily\tGenu\tSpecies'</span> &gt; pig.taxid_Ano.txt<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.5296296296296297" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8veGVdyj93qTWH9hEzlgib66oqk2Rv1YkQ7dsRyqfs7UibuYd3MlQlliazw/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8veGVdyj93qTWH9hEzlgib66oqk2Rv1YkQ7dsRyqfs7UibuYd3MlQlliazw/640?wx_fmt=png"></figure><ul data-tool="mdnice编辑器"><li><section>下载taxid的accession号</section></li></ul><p data-tool="mdnice编辑器">https://ftp.ncbi.nlm.nih.gov/pub/taxonomy/accession2taxid/prot.accession2taxid.FULL.gz</p><pre data-tool="mdnice编辑器"><span></span><code>nohup ascp -v -k 1 -T -l 400m -i ~/.aspera/connect/etc/asperaweb_id_dsa.openssh anonftp@ftp.ncbi.nlm.nih.gov:/pub/taxonomy/accession2taxid/prot.accession2taxid.FULL.gz ./ &amp;<br></code></pre><p data-tool="mdnice编辑器">使用csvtk在prot.accession2taxid.gz文件中提取pig.taxid所有的accession</p><pre data-tool="mdnice编辑器"><span></span><code>zcat ~/refdata/prot.accession2taxid.FULL.gz | csvtk -t grep -f taxid -P pig.taxid.txt | csvtk -t cut -f accession.version &gt;pig.taxid.acc.txt<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.5296296296296297" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vSHWX7kmWUJcWG4SzGHLeOHJ2rDME3p1ibD2jhicMdOuibRU7Hy3hG6oXQ/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vSHWX7kmWUJcWG4SzGHLeOHJ2rDME3p1ibD2jhicMdOuibRU7Hy3hG6oXQ/640?wx_fmt=png"></figure><ul data-tool="mdnice编辑器"><li><section>构建NR库索引</section></li></ul><p data-tool="mdnice编辑器">这里所谓的“索引”并不和我们常见的fa文件fai索引一样，需要区别，这里从文件大小看来更像是另外拷贝一份加上索引信息</p><blockquote data-tool="mdnice编辑器"><pre><span></span><code><span># 构建NR库索引</span><br><span># 方法 1：使用上面下载的nr库解压后makeblastdb构建数据库</span><br>makeblastdb -<span>in</span>  ~/database/<span>test</span>/nr -dbtype prot -out nr<br><span># 方法 2：ascp 下载</span><br>ascp -v -k 1 -T -l 200m -i ~/miniconda3/envs/lncRNA/etc/asperaweb_id_dsa.openssh anonftp@ftp.ncbi.nlm.nih.gov:/blast/db/nr.*.tar.gz  ./  <br></code></pre></blockquote><p data-tool="mdnice编辑器">我们这里使用第一个方法</p><pre data-tool="mdnice编辑器"><span></span><code>makeblastdb -<span>in</span>  ~/refdata/NR/nr -dbtype prot -out nr<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.5296296296296297" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vSew8icfCyO89kLZeQaSSukO9ex05bSRrKzicia3eNiadRrPcnbfrmeCuoA/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vSew8icfCyO89kLZeQaSSukO9ex05bSRrKzicia3eNiadRrPcnbfrmeCuoA/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">花了大概7个小时</p><figure data-tool="mdnice编辑器"><img data-ratio="0.5296296296296297" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vvaefn8q3lfhxtCceRZK8ldfIBommkicPDAGFkO3iaRUFo426PhXibjJgw/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vvaefn8q3lfhxtCceRZK8ldfIBommkicPDAGFkO3iaRUFo426PhXibjJgw/640?wx_fmt=png"></figure><ul data-tool="mdnice编辑器"><li><section>使用blastdbcmd通过accession号提取NR蛋白质序列</section></li></ul><pre data-tool="mdnice编辑器"><span></span><code>blastdbcmd -db ~/refdata/NR/nr -entry_batch pig.taxid.acc.txt -out - | pigz -c &gt; nr_pig.fa.gz<br></code></pre><p data-tool="mdnice编辑器">pigz需要自己先装一下 mamba install pigz</p><figure data-tool="mdnice编辑器"><img data-ratio="0.5890767230169051" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8v9jW06aUo2KURXZBiaaQNLXgEmUINIgaNUWMOoGdzpwCQtyxsP5pCnmw/640?wx_fmt=png" data-type="png" data-w="769" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8v9jW06aUo2KURXZBiaaQNLXgEmUINIgaNUWMOoGdzpwCQtyxsP5pCnmw/640?wx_fmt=png"></figure><figure data-tool="mdnice编辑器"><img data-ratio="0.075" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vxUzyIwflmzJLeC4jCZnfzT6QuoicQu6DZQwcIVBfzG446X0q7ZO4Glw/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vxUzyIwflmzJLeC4jCZnfzT6QuoicQu6DZQwcIVBfzG446X0q7ZO4Glw/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">明明有索引文件，怎么回事：</p><figure data-tool="mdnice编辑器"><img data-ratio="0.7441176470588236" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8viadhcOia4z3ib34Cl8wbQqVeIjnCr8OEa2iakn3KEWLAlA9c23GbrUcRjQ/640?wx_fmt=png" data-type="png" data-w="680" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8viadhcOia4z3ib34Cl8wbQqVeIjnCr8OEa2iakn3KEWLAlA9c23GbrUcRjQ/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">不对，它为什么说”No alias or index file found for nucleotide database“，核酸数据库？</p><blockquote data-tool="mdnice编辑器"><p>参考：https://zhuanlan.zhihu.com/p/556971474</p></blockquote><p data-tool="mdnice编辑器">查看帮助文档 <code>blastdbcmd -help</code>，添加 <code>-dbtype prot</code> 参数，还是不行：</p><figure data-tool="mdnice编辑器"><img data-ratio="0.06666666666666667" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vqWusShJicibqlpN8C3uCfVZdjZicooZUzic4mx5acHEcogYicJbKjhgiaJTw/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vqWusShJicibqlpN8C3uCfVZdjZicooZUzic4mx5acHEcogYicJbKjhgiaJTw/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">BLAST FTP Site - BLAST® Help - NCBI Bookshelf https://www.ncbi.nlm.nih.gov/books/NBK62345/</p><figure data-tool="mdnice编辑器"><img data-ratio="0.42391304347826086" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vED2L2nA5Y2sYZibd8icjg14rjiaFnibW2tic5D3OaKbYd1xApBYLM8GhwFA/640?wx_fmt=png" data-type="png" data-w="828" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vED2L2nA5Y2sYZibd8icjg14rjiaFnibW2tic5D3OaKbYd1xApBYLM8GhwFA/640?wx_fmt=png"></figure><figure data-tool="mdnice编辑器"><img data-ratio="0.20833333333333334" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8v6CUGq5mw7P4GJFrRzL7H6oH1WXTLUmn4OsZtcYNbFdaK4SxQjxskzw/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8v6CUGq5mw7P4GJFrRzL7H6oH1WXTLUmn4OsZtcYNbFdaK4SxQjxskzw/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">尝试修改TITLE、移动文件目录、重新构建索引添加<code>-parse_seqids</code> 参数，测试：</p><figure data-tool="mdnice编辑器"><img data-ratio="0.05555555555555555" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vCgShNibcM9jPkseeTicSiaVjicD3sRBYXExF94xC8s4PCkYEIHjgQmoRCg/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vCgShNibcM9jPkseeTicSiaVjicD3sRBYXExF94xC8s4PCkYEIHjgQmoRCg/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">测试用blastdbcmd从blast的数据库中抽提指定序列：KJX92028.1</p><blockquote data-tool="mdnice编辑器"><p>参考：https://www.cnblogs.com/0820LL/p/10069841.html</p></blockquote><figure data-tool="mdnice编辑器"><img data-ratio="0.5296296296296297" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vBxS7UEY1rtbmxBFc9uaUeeAYrjlWib8OLsDUcTmnmsS252d98A9vmaw/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vBxS7UEY1rtbmxBFc9uaUeeAYrjlWib8OLsDUcTmnmsS252d98A9vmaw/640?wx_fmt=png"></figure><pre data-tool="mdnice编辑器"><span></span><code>blastdbcmd -db ~/refdata/NR/nr -dbtype prot -entry KJX92028.1<br></code></pre><p data-tool="mdnice编辑器">均不行，遂跳过：</p><figure data-tool="mdnice编辑器"><img data-ratio="0.10105580693815988" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vay0yrAGf3h7hicBsjQ4hQK9rCokSwzExKk8uEaZtibCa6ibdEW8tylu7A/640?wx_fmt=png" data-type="png" data-w="663" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vay0yrAGf3h7hicBsjQ4hQK9rCokSwzExKk8uEaZtibCa6ibdEW8tylu7A/640?wx_fmt=png"></figure><figure data-tool="mdnice编辑器"><img data-ratio="0.6813725490196079" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vq16C0ia6AcpCRicAJuSsOgeuZibvonN5acKIrFEJ8yXQsibt3PqkkAqlBg/640?wx_fmt=png" data-type="png" data-w="816" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vq16C0ia6AcpCRicAJuSsOgeuZibvonN5acKIrFEJ8yXQsibt3PqkkAqlBg/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">注意这里只是一个可选过滤步骤，可以跳过，有的是不行的</p><p data-tool="mdnice编辑器">我检索到的资料大部分都是我这个流程，如果大家根据这个流程走下来可以比对成功，欢迎在评论区留言</p><hr data-tool="mdnice编辑器"><h3 data-tool="mdnice编辑器"><span></span>step6：过滤掉低表达量的lncRNA<span></span></h3><p data-tool="mdnice编辑器">通过count数量或FPKM过滤掉低表达量的lncRNA</p><p data-tool="mdnice编辑器">featureCounts 统计count：</p><figure data-tool="mdnice编辑器"><img data-ratio="0.5296296296296297" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vYibeRJGOjHvIKYv1UmicMoMruiaogwaEqMt7KJE3ujWSASCdiaOFrSic9fw/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vYibeRJGOjHvIKYv1UmicMoMruiaogwaEqMt7KJE3ujWSASCdiaOFrSic9fw/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">这里需要注意一个featureCounts2.0.3版本的问题：</p><p data-tool="mdnice编辑器"><a href="https://mp.weixin.qq.com/s?__biz=MzUzMTEwODk0Ng==&amp;mid=2247511191&amp;idx=1&amp;sn=f64d1e3a6b4e1891f17b894380b6cd9b&amp;chksm=fa4569aacd32e0bca3180f690ad5259e7c4903ae6ef2848d8834a9899adf8d4c42eecab8b73c&amp;scene=21&amp;cur_album_id=2545418429466607617#wechat_redirect" data-linktype="2">转录组推文纠正--上游四套定量流程一网打尽</a></p><figure data-tool="mdnice编辑器"><img data-ratio="0.5296296296296297" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vosD3z2pthl2Ee5BpXr47AFGvq20us4VvlIjPWBPa4wffCJ8yraf9hA/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vosD3z2pthl2Ee5BpXr47AFGvq20us4VvlIjPWBPa4wffCJ8yraf9hA/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">双端测序定量添加 <code>--countReadPairs</code>参数</p><p data-tool="mdnice编辑器">并且区别于我们之前对基因定量使用注释的参数：</p><blockquote data-tool="mdnice编辑器"><pre><span></span><code>nohup featureCounts -T 5 -p --countReadPairs -t exon -g gene_id  -a <span>$gtf</span><br>-o  all.id.txt  *bam  1&gt;counts.id.log 2&gt;&amp;1 &amp;<br></code></pre><p><code>-t exon -g gene_id</code></p></blockquote><p data-tool="mdnice编辑器">我们这里对转录本注释定量：</p><p data-tool="mdnice编辑器"><code>-t transcript -g transcript_id</code></p><figure data-tool="mdnice编辑器"><img data-ratio="0.4113856068743287" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vg1ib9BYgObL0HNt4QOdJ95pEVe59Lia67uQ5gYPM5TwmOxqCUZ4Zpb7w/640?wx_fmt=png" data-type="png" data-w="931" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vg1ib9BYgObL0HNt4QOdJ95pEVe59Lia67uQ5gYPM5TwmOxqCUZ4Zpb7w/640?wx_fmt=png"></figure><pre data-tool="mdnice编辑器"><span></span><code>nohup featureCounts -T 12 -a ../7.lncRNA_pred/filter4_by_pfam.gtf -o raw_count.txt -p --countReadPairs -B -C -f -t transcript -g transcript_id ../3.hisat2_bams/*.bam &gt; transcript_featureCount.log 2&gt;&amp;1 &amp;<br></code></pre><blockquote data-tool="mdnice编辑器"><p>assign率是计算已经比对的reads中映射到特定特征的比例，而终端比对率是计算整个数据集中成功比对参考基因组的reads的比例</p></blockquote><figure data-tool="mdnice编辑器"><img data-ratio="0.5296296296296297" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vSx6zJ2lia4O76R0KvibGCuju6qajUt8m7rsp1XtbpbaBNPic8ftqBn0ag/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vSx6zJ2lia4O76R0KvibGCuju6qajUt8m7rsp1XtbpbaBNPic8ftqBn0ag/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">我们这里的特定特征就是那142个预测的lncRNA</p><figure data-tool="mdnice编辑器"><img data-ratio="0.09978768577494693" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8veicWIpiaZutAA4czY6klk1EnciaQ9Kf86RyEGdcUs8vd0Rfgic0RqA8DIw/640?wx_fmt=png" data-type="png" data-w="942" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8veicWIpiaZutAA4czY6klk1EnciaQ9Kf86RyEGdcUs8vd0Rfgic0RqA8DIw/640?wx_fmt=png"></figure><figure data-tool="mdnice编辑器"><img data-ratio="0.45" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vnCozthsGWX9n8mhiar4bHcREaIZVmH8shkpxpib8hI3HXskKAsyMTumA/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vnCozthsGWX9n8mhiar4bHcREaIZVmH8shkpxpib8hI3HXskKAsyMTumA/640?wx_fmt=png"></figure><pre data-tool="mdnice编辑器"><span></span><code># R 语言计算FPKM，筛选：FPKM &gt; 0 in at least one sample ，得到lncRNA_id.txt<br>rm(list=ls())<br># make count table <br>raw_df &lt;- read.table(file = "raw_count.txt",header = T,skip = 1,sep = "\t")<br><br>count_df &lt;- raw_df[ ,c(7:ncol(raw_df))]<br>metadata &lt;- raw_df[ ,1:6] # 提取基因信息count数据前的几列<br>rownames(count_df) &lt;- as.character(raw_df[,1])<br>colnames(count_df) &lt;- paste0("SRR18059",29:64)<br><br># calculate FPKM<br>countToFpkm &lt;- function(counts, effLen)<br>{<br>  N &lt;- colSums(counts)<br>  exp( log(counts) + log(1e9) - log(effLen) - log(N) )<br>}<br><br>options(scipen = 200) # 表示在200个数字以内都不使用科学计数法<br>fpkm = countToFpkm(count_df, metadata$Length)<br># View(fpkm)<br><br># FPKM &gt; 0 in at least one sample<br>count_df.filter &lt;- count_df[rowSums(fpkm)&gt;0,]<br><br>write.table(rownames(count_df.filter),file="./filter6_by_fpkm_id", sep="\t",quote=F,row.names = F,col.names = F)<br>write.table(count_df.filter,file="./filter6_by_fpkm_mat", sep="\t",quote=F)<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.45" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vIwZLlDDTCiaXUWxNuAKkqeDhsK5KpQ1uxVu8BR4aNRtCkBTEdXYbdnA/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vIwZLlDDTCiaXUWxNuAKkqeDhsK5KpQ1uxVu8BR4aNRtCkBTEdXYbdnA/640?wx_fmt=png"></figure><figure data-tool="mdnice编辑器"><img data-ratio="0.45" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vck7qG2dld5TYicWqOiaD8EZ1OiaHA2ib6mT8PDatKv1TICjJhlFibLmt6icQ/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vck7qG2dld5TYicWqOiaD8EZ1OiaHA2ib6mT8PDatKv1TICjJhlFibLmt6icQ/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">linux 里提取最终lncRNA的gtf和fa文件：</p><figure data-tool="mdnice编辑器"><img data-ratio="0.16253716551040634" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vC5OSwyQBsnYX6iawzcbBN0zOytVnMclpDxEOvk2DTbRGuuCsfFicFcvA/640?wx_fmt=png" data-type="png" data-w="1009" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vC5OSwyQBsnYX6iawzcbBN0zOytVnMclpDxEOvk2DTbRGuuCsfFicFcvA/640?wx_fmt=png"></figure><h3 data-tool="mdnice编辑器"><span></span>featureCounts对组装出的lncRNA、mRNA、other_RNA定量<span></span></h3><p data-tool="mdnice编辑器">我们这里主要进行lncRNA的鉴定，所以不进行其它RNA定量操作</p><p data-tool="mdnice编辑器">贴上参考代码：</p><pre data-tool="mdnice编辑器"><span></span><code><span>############## lncRNA featureaCounts ######################</span><br>nohup featureCounts -t transcript -g transcript_id  \<br>-Q 10 --primary -s 0 -p -f -T 8 \<br>-a ../lncRNA.gtf \<br>-o ./raw_count.txt \<br>~/lncRNA_project/04.mapping/*.bam \<br>&gt; featureCounts.log 2&gt;&amp;1 &amp;<br><br><br><span>#########----------- protein_coding-------------------- #############</span><br>less -S gencode.v37.annotation.gtf | grep -w <span>'gene_type "protein_coding"'</span> &gt; protein_coding_gene.gtf<br>less -S gencode.v37.annotation.gtf | grep -w <span>'gene_type "lncRNA"'</span> &gt; known_lncRNA_gene.gtf<br><br><span># featureCounts 定量</span><br>nohup featureCounts -t gene -g gene_id  \<br>-Q 10 --primary -s 0 -p -f -T 8 \<br>-a ../protein_coding_gene.gtf \<br>-o ./raw_count.txt \<br>~/lncRNA_project/04.mapping/*.bam \<br>&gt; featureCounts.log 2&gt;&amp;1 &amp;<br><br><br><span>#########----------- other_RNA-------------------- #############</span><br>less -S ~/lncRNA_project/10.mRNA/gencode.v37.annotation.gtf | grep -w -v <span>'gene_type "protein_coding"'</span> &gt; other_coding_gene.gtf<br><br><span># featureCounts 定量</span><br>nohup featureCounts -t gene -g gene_id  \<br>-Q 10 --primary -s 0 -p -f -T 8 \<br>-a ../other_coding_gene.gtf \<br>-o ./raw_count.txt \<br>~/lncRNA_project/04.mapping/*.bam \<br>&gt; featureCounts.log 2&gt;&amp;1 &amp;<br></code></pre><h3 data-tool="mdnice编辑器"><span></span>NONCODE v6_human数据库<span></span></h3><p data-tool="mdnice编辑器"><strong>blastn lncRNA.fa到 NONCODE v6_human，区分组装出的lncRNA为：know_lncRNA、novel_lncRNA</strong></p><p data-tool="mdnice编辑器">http://www.noncode.org/</p><blockquote data-tool="mdnice编辑器"><p>NONCODE (current version v6.0) is an integrated knowledge database dedicated to non-coding RNAs (excluding tRNAs and rRNAs).</p></blockquote><p data-tool="mdnice编辑器">http://www.noncode.org/datadownload/NONCODEv6_human.fa.gz</p><pre data-tool="mdnice编辑器"><span></span><code>nohup axel -n20 http://www.noncode.org/datadownload/NONCODEv6_human.fa.gz<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.07314814814814814" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8v2BPsfcyApawSWndCibico6BJejXhZbpYuzyFW44mMrj7xnrunbOadojA/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8v2BPsfcyApawSWndCibico6BJejXhZbpYuzyFW44mMrj7xnrunbOadojA/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">官方给了md5值，下载后检查一下完整性，我现在就怀疑当时NR库下载太大了，下载的结果可能有问题，所以导致：Error: [blastdbcmd] DB contains no accession info.</p><figure data-tool="mdnice编辑器"><img data-ratio="0.3469656992084433" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vqibJnE3AZoiaLQ7W79IX6KmxalLBaYXhVZ5XYKQEOsRYnqRkcI7jNFBQ/640?wx_fmt=png" data-type="png" data-w="758" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vqibJnE3AZoiaLQ7W79IX6KmxalLBaYXhVZ5XYKQEOsRYnqRkcI7jNFBQ/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">删除后重新下载仍显示不完整</p><p data-tool="mdnice编辑器">更换下载方式：</p><pre data-tool="mdnice编辑器"><span></span><code>nohup wget -c http://www.noncode.org/datadownload/NONCODEv6_human.fa.gz &amp;<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.1937869822485207" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vqhHMHia52Opb0G903VZmFicssoKL90aeehM56J6VLcSSuJvLVgpaAiafA/640?wx_fmt=png" data-type="png" data-w="676" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vqhHMHia52Opb0G903VZmFicssoKL90aeehM56J6VLcSSuJvLVgpaAiafA/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">查看下载下来的文件MD5</p><figure data-tool="mdnice编辑器"><img data-ratio="0.1368124118476728" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vLmPPqugicibwXibkic2608Cvko2CPN3AxUicibmYmjVINkq6DfLQZyRbkloA/640?wx_fmt=png" data-type="png" data-w="709" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vLmPPqugicibwXibkic2608Cvko2CPN3AxUicibmYmjVINkq6DfLQZyRbkloA/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">自己的电脑下载：</p><figure data-tool="mdnice编辑器"><img data-ratio="0.07225130890052356" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vaPKiasSCOH76CjpHp42hYBvmOZCbTrqLXrj1QbYT8ib7j31PraVsc8Bw/640?wx_fmt=png" data-type="png" data-w="955" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vaPKiasSCOH76CjpHp42hYBvmOZCbTrqLXrj1QbYT8ib7j31PraVsc8Bw/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">怀疑是官网MD5值没更新，继续</p><hr data-tool="mdnice编辑器"><pre data-tool="mdnice编辑器"><span></span><code>mamba install seqkit<br></code></pre><blockquote data-tool="mdnice编辑器"><p>Seqkit是一种用于处理和操纵序列数据的生物信息学工具。它提供了广泛的功能，如序列格式转换、修剪、过滤、统计等。</p></blockquote><p data-tool="mdnice编辑器"><code>rmdup</code>表示去除重复的序列，<code>-s</code>表示保留每个序列的第一个实例，<code>-o</code>表示将处理后的数据保存到 <code>clean.fa</code>文件中，<code>-d</code>表示将重复的序列保存到 <code>duplicated.fa</code>文件中，而 <code>-D</code>表示将关于重复序列的详细信息保存到 <code>duplicated.detail.txt</code>文件中</p><pre data-tool="mdnice编辑器"><span></span><code><span>$cat</span> ~/refdata/NONCODEv6_human.fa | seqkit rmdup -s -o clean.fa -d ddplicated.fa -D duplicated.detail.txt<br>[INFO] 1770 duplicated records removed<br></code></pre><p data-tool="mdnice编辑器">建索引</p><pre data-tool="mdnice编辑器"><span></span><code>nohup makeblastdb -<span>in</span> clean.fa -dbtype nucl -parse_seqids -out NONCODEv6_human &amp;<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.20555555555555555" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vOskrkLJQ8tmh7oVZmtqtANExL29eictwIwZHspHibmcSvYFCE9hU7ezA/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vOskrkLJQ8tmh7oVZmtqtANExL29eictwIwZHspHibmcSvYFCE9hU7ezA/640?wx_fmt=png"></figure><figure data-tool="mdnice编辑器"><img data-ratio="0.10555555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vJciaPvyib34CqpvKT5qKTF499xsGq7T3IfqtFsdAKNxjOTs7k3zsibDtQ/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vJciaPvyib34CqpvKT5qKTF499xsGq7T3IfqtFsdAKNxjOTs7k3zsibDtQ/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">将blastn结果中e-value&lt;=1e-10,min-identity=80%,min-coverage=50%的序列筛选出来当作比对上的序列</p><pre data-tool="mdnice编辑器"><span></span><code>nohup blastn -db NONCODEv6_human -evalue 1e-10 -num_threads 10 -max_target_seqs 5 -query ../8.featureCounts/lncRNA.fa -outfmt <span>' 6 qseqid sseqid pident qcovs length  mismatch gapopen qstart qend sstart send qseq sseq evalue bitscore'</span> -out lncRNA.txt<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.45" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vnK7chbEfn9icsdsMzQs765ANYna0hD2u2cJXUJ0rc2u1cobnZNZnsibQ/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vnK7chbEfn9icsdsMzQs765ANYna0hD2u2cJXUJ0rc2u1cobnZNZnsibQ/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">（这里比对NONCODE成功了，以后如果还是要做比对NR，可以在保证文件完整性的前提下，根据这里比对NONCODE一些步骤来debug）</p><p data-tool="mdnice编辑器">过滤这些匹配上的id，提取余下lncRNA的gtf和fa：</p><figure data-tool="mdnice编辑器"><img data-ratio="0.5490506329113924" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vjnIJcrL4W2dojIH977BYCibc5UC8ibJIuAIa4ZsmQ1NiczunDesnWfCibg/640?wx_fmt=png" data-type="png" data-w="632" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vjnIJcrL4W2dojIH977BYCibc5UC8ibJIuAIa4ZsmQ1NiczunDesnWfCibg/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">根据匹配上NONCODE已知lncRNA的过滤掉6个</p><figure data-tool="mdnice编辑器"><img data-ratio="0.25339366515837103" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vibF2tCclhydoU7BOoL3IV7eREOLU80SBdSu9rNhw8gvIjFkT1vMPnCQ/640?wx_fmt=png" data-type="png" data-w="663" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vibF2tCclhydoU7BOoL3IV7eREOLU80SBdSu9rNhw8gvIjFkT1vMPnCQ/640?wx_fmt=png"></figure><hr data-tool="mdnice编辑器"><h2 data-tool="mdnice编辑器"><span></span>lncRNA的功能推断</h2><p data-tool="mdnice编辑器">大量lncRNA的功能是未知的，但是它们主要是cis-regulators，所以可以根据它们</p><ul data-tool="mdnice编辑器"><li><section>临近的蛋白编码基因功能来近似推断</section></li><li><section>然后表达量的相关性也可以类推到</section></li></ul><p data-tool="mdnice编辑器"><a href="https://mp.weixin.qq.com/s?__biz=MzUzMTEwODk0Ng==&amp;mid=2247515246&amp;idx=1&amp;sn=4646cff563133543c015ee193802cc4b&amp;chksm=fa457953cd32f0451d30a706ce4203e628f268da09f792b4b975acd91b538d1c5007b986c62b&amp;scene=21&amp;cur_album_id=2545418429466607617#wechat_redirect" data-linktype="2">初探mRNA、lncRNA联合分析之下游</a></p><h3 data-tool="mdnice编辑器"><span></span>根据位置关系推断<span></span></h3><pre data-tool="mdnice编辑器"><span></span><code>nohup bedtools window -a ../9.NONCODE_blastn/lncRNA.gtf -b ~/refdata/gencode.v44.annotation_RmChr.gtf -l 100000 -r 10000 &gt; lncRNA_locus.txt &amp;<br></code></pre><p data-tool="mdnice编辑器">输入文件的每个区域周围创建一个窗口，左侧扩展100,000个单位，右侧扩展10,000个单位，并将结果保存</p><p data-tool="mdnice编辑器">locus：</p><figure data-tool="mdnice编辑器"><img data-ratio="0.45" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vTkFPUYdu7Jr5iblFKfcDSqh6ibYUF3gdExLdOGqRfeFicHvc4gEibhINJg/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vTkFPUYdu7Jr5iblFKfcDSqh6ibYUF3gdExLdOGqRfeFicHvc4gEibhINJg/640?wx_fmt=png"></figure><figure data-tool="mdnice编辑器"><img data-ratio="0.15462962962962962" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vohS3azVES8WDcs0rwicGE4Z4AhhbCkM8Bia4Sal3UiccNVEQyf4hImVag/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vohS3azVES8WDcs0rwicGE4Z4AhhbCkM8Bia4Sal3UiccNVEQyf4hImVag/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">lncRNA：</p><figure data-tool="mdnice编辑器"><img data-ratio="0.45" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vVHx8xw14iaMhBnB68VmPgKmiaNulMqqgLBIJib79As7yeUzibdksBeWibmw/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vVHx8xw14iaMhBnB68VmPgKmiaNulMqqgLBIJib79As7yeUzibdksBeWibmw/640?wx_fmt=png"></figure><figure data-tool="mdnice编辑器"><img data-ratio="0.08981481481481482" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8v1Hhw7ZJibk3BicZia4pNy0dnEyFWeOkW7RBCTx54m2IIVlnYRvAGLpDrg/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8v1Hhw7ZJibk3BicZia4pNy0dnEyFWeOkW7RBCTx54m2IIVlnYRvAGLpDrg/640?wx_fmt=png"></figure><h3 data-tool="mdnice编辑器"><span></span>表达量的相关性<span></span></h3><p data-tool="mdnice编辑器">可以参考<a href="https://mp.weixin.qq.com/s?__biz=MzUzMTEwODk0Ng==&amp;mid=2247515246&amp;idx=1&amp;sn=4646cff563133543c015ee193802cc4b&amp;chksm=fa457953cd32f0451d30a706ce4203e628f268da09f792b4b975acd91b538d1c5007b986c62b&amp;scene=21&amp;cur_album_id=2545418429466607617#wechat_redirect" data-linktype="2">初探mRNA、lncRNA联合分析之下游</a></p><figure data-tool="mdnice编辑器"><img data-ratio="0.8135391923990499" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vnoutZs0ibIjYJp5Oubq6rsNplMQJ7klYV0wdfJibckce2nxNtqqLJA2A/640?wx_fmt=png" data-type="png" data-w="842" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicyXaRnlXWtg6kVUDCPAib8vnoutZs0ibIjYJp5Oubq6rsNplMQJ7klYV0wdfJibckce2nxNtqqLJA2A/640?wx_fmt=png"></figure><hr data-tool="mdnice编辑器"><p data-tool="mdnice编辑器">以上，就是本期全部内容</p></section><p><br></p><p><mp-style-type data-value="10000"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/xqO7Wur2cMLLwRUSgR1yuQ",target="_blank" rel="noopener noreferrer">原文链接</a>
