---
title: "自定义基因集 GseaVis 绘图"
date: 2023-10-08T09:54:51Z
draft: ["false"]
tags: [
  "fetched",
  "老俊俊的生信笔记"
]
categories: ["Acdemic"]
---
自定义基因集 GseaVis 绘图 by 老俊俊的生信笔记
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><h4 data-tool="mdnice编辑器"><span></span></h4><section><mp-common-profile data-pluginname="mpprofile" data-id="MzkyMTI1MTYxNA==" data-headimg="http://mmbiz.qpic.cn/mmbiz_png/G5jjcE4usey42oX5qyLTVibLRO9dz8ic5G4TpEHQc9rICYlpS4MHg6Et8cgXrQDqibvibXombicTro8t9cekJRlDBcw/0?wx_fmt=png" data-nickname="老俊俊的生信笔记" data-alias="JunJunLab" data-signature="老俊俊的生信技能和知识分享,我不是巨人,但你可以站在我的肩膀上更进一步!" data-from="0" data-is_biz_ban="0"></mp-common-profile></section><h4 data-tool="mdnice编辑器"><span></span></h4><h2 data-tool="mdnice编辑器"><span><span>1</span></span><span>引言</span><span></span></h2><blockquote data-tool="mdnice编辑器"><p>使用 <strong>GSEA</strong> 函数与自定义的 gmt 文件做富集分析, <strong>GseaVis</strong> 也是可以出图的。此外,之前有小伙伴说 <strong>中间热图的颜色在不同通路是一样的</strong>, 按理应该是不一样的,然后也解决了这个小问题。</p></blockquote><h2 data-tool="mdnice编辑器"><span><span>2</span></span><span>安装</span><span></span></h2><pre data-tool="mdnice编辑器"><span></span><code><span># install.packages("devtools")</span><br>devtools::install_github(<span>"junjunlab/GseaVis"</span>)<br></code></pre><h2 data-tool="mdnice编辑器"><span><span>3</span></span><span>示例</span><span></span></h2><p data-tool="mdnice编辑器">使用 gmt 富集分析:</p><pre data-tool="mdnice编辑器"><span></span><code><span>library</span>(clusterProfiler)<br><span>library</span>(GseaVis)<br><br>data(geneList, package=<span>"DOSE"</span>)<br><br>gmt &lt;- read.gmt(<span>"h.all.v2023.1.Hs.entrez.gmt"</span>)<br><br>gseaRes &lt;- GSEA(geneList = geneList,<br>                TERM2GENE = gmt,<br>                pvalueCutoff = <span>0.05</span>)<br><span># preparing geneSet collections...</span><br><span># GSEA analysis...</span><br><br>df &lt;- data.frame(gseaRes)<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.37176470588235294" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4useySyFw31H9Z56ibJRV8IcEm9P9hauSwAhAvtd6eXCw2shiarPvDOlq3uOmN07blRPwv4FWXs7iaQKCJA/640?wx_fmt=png" data-type="png" data-w="1275" src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4useySyFw31H9Z56ibJRV8IcEm9P9hauSwAhAvtd6eXCw2shiarPvDOlq3uOmN07blRPwv4FWXs7iaQKCJA/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">绘图:</p><pre data-tool="mdnice编辑器"><span></span><code><span># plot</span><br>gseaNb(object = gseaRes,<br>       geneSetID = df$ID[<span>1</span>])<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.6900958466453674" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4useySyFw31H9Z56ibJRV8IcEm9aBQSyiaKsqFVmmOCic4348KbBRGBI2WRm9iblF5IXbm3yibg5L1riaiaiaG7A/640?wx_fmt=png" data-type="png" data-w="626" src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4useySyFw31H9Z56ibJRV8IcEm9aBQSyiaKsqFVmmOCic4348KbBRGBI2WRm9iblF5IXbm3yibg5L1riaiaiaG7A/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">多个通路:</p><pre data-tool="mdnice编辑器"><span></span><code>gseaNb(object = gseaRes,<br>       curveCol = circlize::rand_color(<span>4</span>),<br>       geneSetID = df$ID[sample(<span>27</span>,<span>4</span>,replace = <span>F</span>)])<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.7702871410736579" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4useySyFw31H9Z56ibJRV8IcEm9aQ8kbsVzy556ccrQQKrupiaHmWKPMVfjRdiboaPJYsZCAbbvHiaAHkMrQ/640?wx_fmt=png" data-type="png" data-w="801" src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4useySyFw31H9Z56ibJRV8IcEm9aQ8kbsVzy556ccrQQKrupiaHmWKPMVfjRdiboaPJYsZCAbbvHiaAHkMrQ/640?wx_fmt=png"></figure><h2 data-tool="mdnice编辑器"><span><span>4</span></span><span>结尾</span><span></span></h2><blockquote data-tool="mdnice编辑器"><p><strong>路漫漫其修远兮,吾将上下而求索。</strong></p></blockquote><hr data-tool="mdnice编辑器"><p data-tool="mdnice编辑器">欢迎加入生信交流群。加我微信我也拉你进 <strong>微信群聊</strong> <strong>老俊俊生信交流群</strong> <strong>(微信交流群需收取 20 元入群费用,一旦交费,拒不退还!(防止骗子和便于管理))</strong> 。QQ 群可免费加入, 记得进群按格式修改备注哦。</p><section data-tool="mdnice编辑器"><section><p><strong>老俊俊微信：</strong></p><figure><img data-ratio="1" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4useySyFw31H9Z56ibJRV8IcEm9W8AFh0piaa3ibKQ5DxhCpiaI1pYr1kibN8TI1EPYxYwNibewPqFXgqDcTMQ/640?wx_fmt=png" data-type="png" data-w="430" src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4useySyFw31H9Z56ibJRV8IcEm9W8AFh0piaa3ibKQ5DxhCpiaI1pYr1kibN8TI1EPYxYwNibewPqFXgqDcTMQ/640?wx_fmt=png"></figure><figure><img data-ratio="1.3668430335097002" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4useySyFw31H9Z56ibJRV8IcEm9FicuTQef5WnsMKrb4gpzyGXnXeKPdAG7PSJW073xUN5g0VsFEn23skg/640?wx_fmt=png" data-type="png" data-w="567" src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4useySyFw31H9Z56ibJRV8IcEm9FicuTQef5WnsMKrb4gpzyGXnXeKPdAG7PSJW073xUN5g0VsFEn23skg/640?wx_fmt=png"></figure></section><section><p><strong>知识星球：</strong></p><figure><img data-ratio="1.5896226415094339" data-src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/G5jjcE4useySyFw31H9Z56ibJRV8IcEm9dqggiaibVzRyVb1EPoZNTbh3FAmhAiapGn2od790cQKjgNHGSz92CWG0w/640?wx_fmt=jpeg" data-type="jpeg" data-w="1060" src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/G5jjcE4useySyFw31H9Z56ibJRV8IcEm9dqggiaibVzRyVb1EPoZNTbh3FAmhAiapGn2od790cQKjgNHGSz92CWG0w/640?wx_fmt=jpeg"></figure></section></section><hr data-tool="mdnice编辑器"><p data-tool="mdnice编辑器"><br></p><center data-tool="mdnice编辑器"><strong> 往期回顾目录</strong></center><blockquote data-tool="mdnice编辑器"><p><br></p><center><strong><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247510066&amp;idx=1&amp;sn=19c713554cd00a6d444e098145f3d286&amp;chksm=c1849243f6f31b5582896d837ce91f6655d7029fc6c95bfc98c622787d4a9dfe57a74152fd75&amp;token=1127717108&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">批量下载 starbase 数据</a></strong></center><strong><center><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247510050&amp;idx=1&amp;sn=9b1a5fb1cc6ecf52844847f4aba6bfb8&amp;chksm=c1849253f6f31b450c12a6748a188e734f92c16be1abc51d75afabb33f404f45d60d1d616191&amp;token=100163832&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">听说你想在 python 中对 kegg 可视化?</a></center></strong><strong><center><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247510034&amp;idx=1&amp;sn=e43a22b9de87e7e4500d3e2f52bc50c5&amp;chksm=c1849263f6f31b75338900b88e5abfe2747e7cd980706c8348e23078d65ca28273cbcbf2ff84&amp;token=203556469&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">优雅的使用 lattice 可视化单细胞</a></center></strong><strong><center><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247510008&amp;idx=1&amp;sn=86892dd2412183414ed984d5279848fc&amp;chksm=c1849d89f6f3149f5771e1b74a7e9ad1e72c619c203e227f25bd895712c981c2f9d8230e91b6&amp;token=203556469&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">听说你想在 circlize 的环形热图里添加显著性?</a></center></strong><strong><center><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247509978&amp;idx=1&amp;sn=7af95b9220830dfc92a31ef64092e72e&amp;chksm=c1849dabf6f314bd5d28fee0a1467696de2c157d506ea1d19a43c2319811514fcc76515469bf&amp;token=1162368673&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">听说表达趋势你想分面展示?</a></center></strong><strong><center><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247509949&amp;idx=1&amp;sn=712115d6aba5e45c19da2905308cfe3b&amp;chksm=c1849dccf6f314da0d6af67f840410256c03d7bcefe5a576bc7babe46422bdf61c8cc44b81b2&amp;token=353110902&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">听说你想把多个样本的 GSEA 画在一起?</a></center></strong><strong><center><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247509821&amp;idx=1&amp;sn=66d6b4c47efed6c8dbfd9f2027d5a015&amp;chksm=c1849d4cf6f3145af6077e06c25e4b9f3b5c7f7b93bf5ca507e56d4dd74d399df896dbd8c5d5&amp;token=778653154&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">grid 里绘制连续型图例</a></center></strong><strong><center><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247509799&amp;idx=1&amp;sn=b3bc4bbbb8c1e3a98be3f5815cbcb4f0&amp;chksm=c1849d56f6f3144000e22d4b9ebf989ad79349c450928c2a2346749b0187d857fca15d9e7183&amp;token=613129250&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">听说你要绘制 scanpy 版的散点图?</a></center></strong><strong><center><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247509762&amp;idx=1&amp;sn=97596153e141170c7c6af1dab29499ac&amp;chksm=c1849d73f6f31465bbb6d78217ead9b402f3b5ade770e23f9f35904ae2856392c3f332ba8c23&amp;token=613129250&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">听说你要手搓一个 grid.xaxis2/grid.yaxis2?</a></center></strong><strong><center><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247509735&amp;idx=1&amp;sn=212e45f9e6c8cfd13bc943b6ac806dc2&amp;chksm=c1849c96f6f31580624e0d4bab65b47d7b3e4cf7fc604881fb9c27a32249bd071dd1eae20d66&amp;token=613129250&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">用 grid 手搓一个单细胞散点图+细胞数量条形图</a></center></strong><p><br></p></blockquote></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/70fl8CD4P91e2MbePYGl1Q",target="_blank" rel="noopener noreferrer">原文链接</a>
