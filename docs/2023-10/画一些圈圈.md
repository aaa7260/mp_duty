---
title: "画一些圈圈"
date: 2023-10-29T00:42:51Z
draft: ["false"]
tags: [
  "fetched",
  "老俊俊的生信笔记"
]
categories: ["Acdemic"]
---
画一些圈圈 by 老俊俊的生信笔记
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-mpa-powered-by="yiban.io"><h4 data-tool="mdnice编辑器"><span></span></h4><section><mp-common-profile data-pluginname="mpprofile" data-id="MzkyMTI1MTYxNA==" data-headimg="http://mmbiz.qpic.cn/mmbiz_png/G5jjcE4usey42oX5qyLTVibLRO9dz8ic5G4TpEHQc9rICYlpS4MHg6Et8cgXrQDqibvibXombicTro8t9cekJRlDBcw/0?wx_fmt=png" data-nickname="老俊俊的生信笔记" data-alias="JunJunLab" data-signature="老俊俊的生信技能和知识分享,我不是巨人,但你可以站在我的肩膀上更进一步!" data-from="0" data-is_biz_ban="0"></mp-common-profile></section><h4 data-tool="mdnice编辑器"><span></span></h4><h2 data-tool="mdnice编辑器"><span><span>1</span></span><span>引言</span><span></span></h2><blockquote data-tool="mdnice编辑器"><p>跟着着大佬们的脚步,不断学习进步。环形图已经有好些包和软件了,比如顾大佬的 <strong>circlize</strong>,还有一个 <strong>Rcircos</strong> 包。其实自己也想学习一下这些图形开发的具体思路。我们可以自己尝试和模仿去画出类似的图形,进而提升自己对于一些高级绘图产生过程的理解,也可以向很厉害的人学习到很多有用的思维和技能。总之,学习进步的过程就是不断模仿和实践。</p></blockquote><blockquote data-tool="mdnice编辑器"><p>然后自己也尝试了一下绘制这些圈圈的过程,下面是一部分开始的工作,当然还有很多问题。环形图最重要的就是 <strong>直角坐标系到极坐标</strong> 的转换,掌握这个后续一些东西就好方便很多。</p></blockquote><h2 data-tool="mdnice编辑器"><span><span>2</span></span><span>学习过程</span><span></span></h2><p data-tool="mdnice编辑器">画个背景:</p><pre data-tool="mdnice编辑器"><span></span><code><span>library</span>(grid)<br><span>library</span>(tidyverse)<br><br><br>grid.newpage()<br>pushViewport(viewport(width = <span>0.9</span>,height = <span>0.9</span>,<br>                      xscale = c(-<span>1</span>,<span>1</span>),yscale = c(-<span>1</span>,<span>1</span>),<br>                      default.units = <span>"snpc"</span>))<br><br>grid.circle(r = <span>0.5</span>,gp = gpar(fill = <span>"grey90"</span>,col = <span>NA</span>))<br>grid.segments(x0 = <span>0.5</span>,x1 = <span>0.5</span>,y0 = <span>0</span>,y1 = <span>1</span>)<br>grid.segments(x0 = <span>0</span>,x1 = <span>1</span>,y0 = <span>0.5</span>,y1 = <span>0.5</span>)<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.8835294117647059" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4useyKkTIVib9bEzpibeDIsKyAuacdqMibJObW8G7lG2fAJUqRRg2t5sJMCZx2h4Mm7Y4544mYWcj6yXpqA/640?wx_fmt=png" data-type="png" data-w="850" src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4useyKkTIVib9bEzpibeDIsKyAuacdqMibJObW8G7lG2fAJUqRRg2t5sJMCZx2h4Mm7Y4544mYWcj6yXpqA/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器"><strong>arcSectorGrob</strong> 绘制扇区:</p><pre data-tool="mdnice编辑器"><span></span><code>grid.draw(arcSectorGrob(start = <span>0</span>,end = <span>90</span>,r0 = <span>0.5</span>,r1 = <span>0.8</span>))<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.8954022988505748" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4useyKkTIVib9bEzpibeDIsKyAuaXGAwc45ibQmKBT3UEibXakItrV0RlcCj8K7sRZNWVxNPgq3ZCugLOmBg/640?wx_fmt=png" data-type="png" data-w="870" src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4useyKkTIVib9bEzpibeDIsKyAuaXGAwc45ibQmKBT3UEibXakItrV0RlcCj8K7sRZNWVxNPgq3ZCugLOmBg/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">X 坐标轴放在底部位置:</p><pre data-tool="mdnice编辑器"><span></span><code>grid.draw(arcSectorGrob(start = <span>120</span>,end = <span>270</span>,r0 = <span>0.7</span>,r1 = <span>1</span>,<br>                        sector.gp = gpar(fill = <span>"orange"</span>),<br>                        arcxAxisGrob.params = list(pos = <span>"bottom"</span>)))<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.9434416365824309" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4useyKkTIVib9bEzpibeDIsKyAuaMBjIf2CaMGDttyAuNYJENaWI5w32udc3xZxPzZ1icHia3AQeeFLg5ygQ/640?wx_fmt=png" data-type="png" data-w="831" src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4useyKkTIVib9bEzpibeDIsKyAuaMBjIf2CaMGDttyAuNYJENaWI5w32udc3xZxPzZ1icHia3AQeeFLg5ygQ/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">y 轴放置在右边:</p><pre data-tool="mdnice编辑器"><span></span><code>grid.draw(arcSectorGrob(start = <span>270</span>,end = <span>360</span>,r0 = <span>0.3</span>,r1 = <span>0.5</span>,<br>                        sector.gp = gpar(fill = <span>"purple"</span>),<br>                        arcyAxisGrob.params = list(pos = <span>"right"</span>)))<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.904487917146145" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4useyKkTIVib9bEzpibeDIsKyAuaUlaudoFtQj8NlSRIhrUtMPGx5qUwn8bqYqOgf5DJYnef0LDcgrrcNg/640?wx_fmt=png" data-type="png" data-w="869" src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4useyKkTIVib9bEzpibeDIsKyAuaUlaudoFtQj8NlSRIhrUtMPGx5qUwn8bqYqOgf5DJYnef0LDcgrrcNg/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">添加散点:</p><pre data-tool="mdnice编辑器"><span></span><code>grid.draw(arcPointGrob(x = rnorm(<span>50</span>),y = rnorm(<span>50</span>),<br>                       start = <span>0</span>,end = <span>90</span>,r0 = <span>0.5</span>,r1 = <span>0.8</span>))<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.9256198347107438" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4useyKkTIVib9bEzpibeDIsKyAuamguhPPJvemSuyu7RVoVd8j26aFbD4szzI92pOMmGIaGTQV5W9oUNAQ/640?wx_fmt=png" data-type="png" data-w="847" src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4useyKkTIVib9bEzpibeDIsKyAuamguhPPJvemSuyu7RVoVd8j26aFbD4szzI92pOMmGIaGTQV5W9oUNAQ/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">添加折线:</p><pre data-tool="mdnice编辑器"><span></span><code>grid.draw(arcLinesGrob(x = <span>1</span>:<span>50</span>,y = rnorm(<span>50</span>),<br>                       start = <span>120</span>,end = <span>270</span>,r0 = <span>0.7</span>,r1 = <span>1</span>,<br>                       lines.gp = gpar(lwd = <span>2</span>,col = <span>"blue"</span>)))<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.9008168028004667" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4useyKkTIVib9bEzpibeDIsKyAuarDlQNrlooLH6kq9YSuX2GibkyNcPG8HqH65TcUFjANAgOmNE9jWJBFw/640?wx_fmt=png" data-type="png" data-w="857" src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4useyKkTIVib9bEzpibeDIsKyAuarDlQNrlooLH6kq9YSuX2GibkyNcPG8HqH65TcUFjANAgOmNE9jWJBFw/640?wx_fmt=png"></figure><blockquote data-tool="mdnice编辑器"><p>当然可以写一些更多的图形元素进来,这是需要时间的,总之学习的目的达到了。</p></blockquote><h2 data-tool="mdnice编辑器"><span><span>3</span></span><span>结尾</span><span></span></h2><blockquote data-tool="mdnice编辑器"><p><strong>路漫漫其修远兮,吾将上下而求索。</strong></p></blockquote><hr data-tool="mdnice编辑器"><p data-tool="mdnice编辑器">欢迎加入生信交流群。加我微信我也拉你进 <strong>微信群聊</strong> <strong>老俊俊生信交流群</strong> <strong>(微信交流群需收取 20 元入群费用,一旦交费,拒不退还!(防止骗子和便于管理))</strong> 。QQ 群可免费加入, 记得进群按格式修改备注哦。</p><section data-tool="mdnice编辑器"><section><p><strong>老俊俊微信：</strong></p><figure><img data-ratio="1" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4useyKkTIVib9bEzpibeDIsKyAuanuTIrb5yNIw6KlUJasfYACV0ghJ8Y2YdnunA0a1wia4TR7MkyUKicMiag/640?wx_fmt=png" data-type="png" data-w="430" src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4useyKkTIVib9bEzpibeDIsKyAuanuTIrb5yNIw6KlUJasfYACV0ghJ8Y2YdnunA0a1wia4TR7MkyUKicMiag/640?wx_fmt=png"></figure><figure><img data-ratio="1.3668430335097002" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4useyKkTIVib9bEzpibeDIsKyAuaJpkDcXNwu6RSdJrA1c3x6zhSKqqNCnjQZE7HZ7CsGV3SzFoiax9KFfQ/640?wx_fmt=png" data-type="png" data-w="567" src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4useyKkTIVib9bEzpibeDIsKyAuaJpkDcXNwu6RSdJrA1c3x6zhSKqqNCnjQZE7HZ7CsGV3SzFoiax9KFfQ/640?wx_fmt=png"></figure></section><section><p><strong>知识星球：</strong></p><figure><img data-ratio="1.5896226415094339" data-src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/G5jjcE4useyKkTIVib9bEzpibeDIsKyAua2BDPZYnYxQFF2d7GNDI5CJmYZrbORHKYk0BzzMUxJXwDtadGceALGw/640?wx_fmt=jpeg" data-type="jpeg" data-w="1060" src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/G5jjcE4useyKkTIVib9bEzpibeDIsKyAua2BDPZYnYxQFF2d7GNDI5CJmYZrbORHKYk0BzzMUxJXwDtadGceALGw/640?wx_fmt=jpeg"></figure></section></section><hr data-tool="mdnice编辑器"><p data-tool="mdnice编辑器"><br></p><center data-tool="mdnice编辑器"><strong> 往期回顾目录</strong></center><blockquote data-tool="mdnice编辑器"><p><br></p><center><strong><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247510256&amp;idx=1&amp;sn=65060b32f4a74337f0c6f02f775f2ef9&amp;chksm=c1849281f6f31b974683049e26c7132fd24d9e0f08aa347cbe595b7b25f6b62a0ad7bdfbc856&amp;token=61740346&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">grid 进阶: 构建自己的 grob 对象</a></strong></center><strong><center><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247510209&amp;idx=1&amp;sn=ea595989806aeaf116fab44f808d295e&amp;chksm=c18492b0f6f31ba6832f666ee1734d258dcb0ad852a2982443668f735e46e86f2a9456a1059d&amp;token=61740346&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">ChIP-seq 绘图设计&lt;&lt;续&gt;&gt;</a></center></strong><strong><center><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247510169&amp;idx=1&amp;sn=865c3e3652f75419a39df29acee16f33&amp;chksm=c18492e8f6f31bfe00a052989ee7f2ccc84df46e8e3e90bdc134a928451c9520a77532c93b31&amp;token=1624839730&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">如何获取基因的转录起始/终止位点(TSS/TES)?</a></center></strong><strong><center><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247510151&amp;idx=1&amp;sn=de70b667d6eb7f581a68fd3fc231b1fc&amp;chksm=c18492f6f6f31be05a57cb681d802fb813e36ac67f3d70fb05d26a6ea1aeee14bd17a91844e7&amp;token=1624839730&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">ChIP-seq 绘图设计</a></center></strong><strong><center><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247510122&amp;idx=1&amp;sn=f06cfbecb15ee4f133c9b3d49791743a&amp;chksm=c184921bf6f31b0d471e37ef63fdc4c7caf63df2a6598bd1f3c04d9b1505e2e103ef4f60eb66&amp;token=1598639854&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">ggChIPvis 可视化基因组富集信号</a></center></strong><strong><center><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247510122&amp;idx=1&amp;sn=f06cfbecb15ee4f133c9b3d49791743a&amp;chksm=c184921bf6f31b0d471e37ef63fdc4c7caf63df2a6598bd1f3c04d9b1505e2e103ef4f60eb66&amp;token=1598639854&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">ggChIPvis 可视化基因组富集信号</a></center></strong><strong><center><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247510110&amp;idx=1&amp;sn=5b8a12b864509d65c243b61d080350a9&amp;chksm=c184922ff6f31b3943a3681def268998388a3a930b2c384f3d8ea33ff17a437cc4513fc1b286&amp;token=819162780&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">ChIP-seq 可视化探索</a></center></strong><strong><center><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247510080&amp;idx=1&amp;sn=d296de1de6d26ca85c724c392fe9959b&amp;chksm=c1849231f6f31b272f3826f9a8f5277a1272f44443a5553513c0ffe3d82ca48d3c518ad49d0f&amp;token=1127717108&amp;lang=zh_CN&amp;poc_token=HItqJWWjkYgH0feCwRqHpggUnZg-boP69onpft9F&amp;scene=21#wechat_redirect" data-linktype="2">自定义基因集 GseaVis 绘图</a></center></strong><strong><center><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247510066&amp;idx=1&amp;sn=19c713554cd00a6d444e098145f3d286&amp;chksm=c1849243f6f31b5582896d837ce91f6655d7029fc6c95bfc98c622787d4a9dfe57a74152fd75&amp;token=1127717108&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">批量下载 starbase 数据</a></center></strong><strong><center><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247510050&amp;idx=1&amp;sn=9b1a5fb1cc6ecf52844847f4aba6bfb8&amp;chksm=c1849253f6f31b450c12a6748a188e734f92c16be1abc51d75afabb33f404f45d60d1d616191&amp;token=100163832&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">听说你想在 python 中对 kegg 可视化?</a></center></strong><p><br></p></blockquote></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/YQ6DK7MtpfBIgBmquJsgqQ",target="_blank" rel="noopener noreferrer">原文链接</a>
