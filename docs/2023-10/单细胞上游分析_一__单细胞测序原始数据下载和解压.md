---
title: "单细胞上游分析（一）：单细胞测序原始数据下载和解压"
date: 2023-10-17T04:53:51Z
draft: ["false"]
tags: [
  "fetched",
  "TOP生物信息"
]
categories: ["Acdemic"]
---
单细胞上游分析（一）：单细胞测序原始数据下载和解压 by TOP生物信息
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><h2 data-tool="mdnice编辑器"><span></span><span>前言</span></h2><p data-tool="mdnice编辑器">只要长期从事生信分析研究，尤其是目前对多样品、多平台测序数据整合要求的增加，研究者不可避免地需要掌握原始数据上游分析。对于原始数据上游分析，首要解决的是数据下载问题。为了解决这个问题，我们将会开启上游数据处理的系列笔记分享。我们将会从高通量数据测序下载和解压、单细胞文库结构、STARsolo上游分析等方面，打通上游到下游的分析，实现数据自由！</p><p data-tool="mdnice编辑器">本篇笔记作为系列开篇，我们将从<strong>高通量测序数据下载和解压</strong>开始。</p><h2 data-tool="mdnice编辑器"><span></span><span>目录</span></h2><ol data-tool="mdnice编辑器"><li><section>常用数据库介绍</section></li><li><section>数据搜索</section></li><li><section>数据下载</section></li><li><section>SRA文件解压</section></li><li><section>特殊情况处理</section></li></ol><h2 data-tool="mdnice编辑器"><span></span><span>1. 常用数据库介绍</span></h2><p data-tool="mdnice编辑器"><strong>NCBI-SRA</strong>和<strong>EBI-ENA</strong>数据库是我们最常用的高通量测序数据储存库，他们的数据中心分别位于美国和欧洲，二者之间的数据会定期交换，所以基本能互相查到，当某个数据库查找出现缺漏或困难时，我们可以到另一个数据库去查找。</p><pre data-tool="mdnice编辑器"><span></span><code><span># SRA</span><br>https://www.ncbi.nlm.nih.gov/sra<br><span># ENA-EBI</span><br>https://www.ebi.ac.uk/<br><br></code></pre><h4 data-tool="mdnice编辑器"><span></span>SRA数据库<span></span></h4><p data-tool="mdnice编辑器"><strong>（1）简介</strong></p><p data-tool="mdnice编辑器"><strong>SRA数据库</strong>: Sequence Read Archive。隶属NCBI (National Center for Biotechnology Information)，它是一个保存大规模平行测序原始数据以及比对信息和元数据 (metadata) 的数据库，所有已发表的文献中高通量测序数据基本都上传至此，方便其他研究者下载及再研究。其中的数据则是通过压缩后以.sra文件格式来保存的，SRA数据库可以用于搜索和展示SRA项目数据，包括SRA主页和 Entrez system，由 NCBI 负责维护。</p><p><img data-ratio="0.5046296296296297" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/WThoCmvVu2ZB56fxcC2D0LEVQBe3G6HqsT4ibM3ibmPd0sbFwic0RafJ8xKnIPia7O1Gam6FUck9iaYY2PLdedytx5A/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/WThoCmvVu2ZB56fxcC2D0LEVQBe3G6HqsT4ibM3ibmPd0sbFwic0RafJ8xKnIPia7O1Gam6FUck9iaYY2PLdedytx5A/640?wx_fmt=png"></p><p data-tool="mdnice编辑器"><strong>（2）SRA测序数据结构</strong></p><p data-tool="mdnice编辑器">SRA 将实验数据与 metadata（元数据）分离。metadata 是指与测序实验及其实验样品相关的数据，如实验目的、实验设计、测序平台、样本数据(物种，菌株，个体表型等)。metadata可以分为以下几类：</p><ul data-tool="mdnice编辑器"><li><section>Study：accession number 以 DRP，<strong>SRP</strong>，ERP 开头，表示的是一个特定目的的研究课题，可以包含多个研究机构和研究类型等。study 包含了项目的所有 metadata，并有一个 NCBI 和 EBI 共同承认的项目编号（universal project id），一个 study 可以包含多个实验（experiment）。</section></li><li><section>Sample：accession number以 DRS，<strong>SRS</strong>，ERS 开头，表示的是样品信息。样本信息可以包括物种信息、菌株(品系) 信息、家系信息、表型数据、临床数据,组织类型等。可以通过<span>Trace</span><sup>[1]</sup>来查询。</section></li><li><section>Experiment：accession number 以 DRX，<strong>SRX</strong>，ERX 开头。表示一个实验记载的实验设计（Design），实验平台（Platform）和结果处理（processing）三部分信息。实验是 <span>SRA</span><sup>[2]</sup> 数据库的最基本单元，一个实验信息可以同时包含多个结果集（run）。</section></li><li><section>Run：accession number 以 DRR，<strong>SRR</strong>，ERR 开头。一个 Run 包括测序序列及质量数据。</section></li><li><section>Submission：一个 study 的数据，可以分多次递交至 SRA 数据库。比如在一个项目启动前期，就可以把 study，experiment 的数据递交上去，随着项目的进展，逐批递交 run 数据。study 等同于项目，submission 等同于批次的概念。</section></li></ul><p data-tool="mdnice编辑器"><strong>（3）下载的SRA数据长什么样</strong></p><p data-tool="mdnice编辑器"><code>.sra</code>格式是SRA数据库的有损压缩格式，我们可以通过<code>sratoolkit</code>工具将其转为<code>fastq</code>或<code>sam</code>文件，并用于上游分析。通常我们使用<code>prefetch</code>命令下载后，默认会以<code>SRRxxx.sra</code>形式存在。如果用SRA Explorer提供的默认代码，会变为<code>SRR + GSM + group + species + read.fastq.gz</code>的形式。如果你没看懂的话，没有关系，后面我们将会以一个实例来实现，以更好地理解。</p><h4 data-tool="mdnice编辑器"><span></span>EBI-ENA数据库<span></span></h4><p data-tool="mdnice编辑器"><strong>ENA数据库</strong>：European Nucleotide Archive：隶属EBI (European Bioinformatics Institute)，功能等同SRA，并且对保存的数据做了注释，界面相对于SRA更友好，对于有数据需求的研究人员来说，ENA数据库最诱人的点应该是可以<strong>直接下载fastq (.gz)文件</strong>，由 EBI 负责维护。</p><p><img data-ratio="0.5342592592592592" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/WThoCmvVu2ZB56fxcC2D0LEVQBe3G6Hq1LLeoYDnt8mt0yNEoPAdI6KKG5DPIhbf3fqJIu1xgmtPGsibaoNiaA2g/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/WThoCmvVu2ZB56fxcC2D0LEVQBe3G6Hq1LLeoYDnt8mt0yNEoPAdI6KKG5DPIhbf3fqJIu1xgmtPGsibaoNiaA2g/640?wx_fmt=png"></p><p data-tool="mdnice编辑器">除了官网提供的查询以外，我们还有一些辅助查询网页和工具，比如SRA Explorer网页，能为我们提供下载链接和下载代码。可以通过搜索SRP和PRJNA号就可以查询到储存在ENA的数据。</p><pre data-tool="mdnice编辑器"><span></span><code>https://sra-explorer.info/<br></code></pre><p><img data-ratio="0.47129629629629627" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/WThoCmvVu2ZB56fxcC2D0LEVQBe3G6Hq5BDw7GOfDJib2Yh12723VdtFiard0jsRUVj3mMTRicuCMQTLicPInXW7tA/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/WThoCmvVu2ZB56fxcC2D0LEVQBe3G6Hq5BDw7GOfDJib2Yh12723VdtFiard0jsRUVj3mMTRicuCMQTLicPInXW7tA/640?wx_fmt=png"></p><h2 data-tool="mdnice编辑器"><span></span><span>2. 数据搜索</span></h2><p data-tool="mdnice编辑器">如果你曾经使用过公共数据库，最熟悉的应该是NCBI旗下的GEO数据库，以及TGCA数据库。在GEO数据库中，除了能直接下载到作者提供的直接用于下游分析的矩阵以外，通常而言还会提供SRA号或PRJNA号。我们以<code>GSE228644</code>为例，你可以打开下面链接，或在GEO网站搜索：</p><pre data-tool="mdnice编辑器"><span></span><code>https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE228644<br></code></pre><p><img data-ratio="0.856071964017991" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/WThoCmvVu2ZB56fxcC2D0LEVQBe3G6Hqw1CydP804qFyPmHAY2bQFE1FOSS79OUI9bImEWLibXHmrpJRrACcMhw/640?wx_fmt=png" data-type="png" data-w="667" src="https://mmbiz.qpic.cn/mmbiz_png/WThoCmvVu2ZB56fxcC2D0LEVQBe3G6Hqw1CydP804qFyPmHAY2bQFE1FOSS79OUI9bImEWLibXHmrpJRrACcMhw/640?wx_fmt=png"></p><p data-tool="mdnice编辑器"><br></p><p data-tool="mdnice编辑器">我们分别使用SRA数据库和ENA数据库搜索一下：</p><blockquote data-tool="mdnice编辑器"><p><strong>这里需要注意，有时候同一个GSE数据集下的原始测序数据，可能会存放多个SRA集</strong>。这可能是由于作者分批上传导致的，需要注意是否与GSE的样品信息对应。此外，同一个样品可能会对应多个lane的测序结果，显示为<strong>同一个GSM号对应多个SRR号</strong>，这是由于实验因素导致（具体可以查询10X的测序方法说明）。从下面的例子我们可以看到，上面一共6个人类样品（最后两个是小鼠），却包含了12个SRA datasets。我们仔细对比SRR和GSM号就能看到。</p></blockquote><section>1. SRA：点击上图左下角的“SRA Run Selector”进入SRA页面，你也可以从SRA Run Selector官网直接搜索“PRJNA950918”。如果我们使用<code>prefetch</code>下载整个SRP数据，则会同时下载metadata信息。</section><p><img data-ratio="0.5259259259259259" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/WThoCmvVu2ZB56fxcC2D0LEVQBe3G6HqyRj5tBiaGjT74F1P1Ee6Onr1VQibbpIlUPlAL3wWA9PJqqXib9ra55X8w/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/WThoCmvVu2ZB56fxcC2D0LEVQBe3G6HqyRj5tBiaGjT74F1P1Ee6Onr1VQibbpIlUPlAL3wWA9PJqqXib9ra55X8w/640?wx_fmt=png"></p><section>2. ENA：从ENA网站搜索“PRJNA950918”，发现没有直接得到下载信息，而是又给了两个相关的PRJNA号，我们分别点进去发现，只有“PRJNA864822”有测序信息下载。</section><p><img data-ratio="0.23880597014925373" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/WThoCmvVu2ZB56fxcC2D0LEVQBe3G6HqtgCL4m6rgC6TTIZvviaxibcPlbd2fRpibZ1sL5t944jkGRQvicDibBV0Iyw/640?wx_fmt=png" data-type="png" data-w="938" src="https://mmbiz.qpic.cn/mmbiz_png/WThoCmvVu2ZB56fxcC2D0LEVQBe3G6HqtgCL4m6rgC6TTIZvviaxibcPlbd2fRpibZ1sL5t944jkGRQvicDibBV0Iyw/640?wx_fmt=png"></p><p data-tool="mdnice编辑器">PRJNA864822：可以看到ENA数据库可以直接下载到<code>fastq.gz</code>文件，不用像<code>.sra</code>文件一样要解压。</p><p><img data-ratio="0.4759871931696905" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/WThoCmvVu2ZB56fxcC2D0LEVQBe3G6HqU6S7P7YscCQQb5XSnAEBeI15813FxYumN2TibFq2QTdcl8ricsjwOGnQ/640?wx_fmt=png" data-type="png" data-w="937" src="https://mmbiz.qpic.cn/mmbiz_png/WThoCmvVu2ZB56fxcC2D0LEVQBe3G6HqU6S7P7YscCQQb5XSnAEBeI15813FxYumN2TibFq2QTdcl8ricsjwOGnQ/640?wx_fmt=png"></p><p data-tool="mdnice编辑器">如果我们点击获得wget下载代码的按钮，就会得到一个<code>.sh</code>文件：</p><p><img data-ratio="0.12891113892365458" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/WThoCmvVu2ZB56fxcC2D0LEVQBe3G6HqVIoicoTwgOxNCumOSsw5iazWFdQ7GIsQ2bwsyHLAQFPxoHcd2DCM2CPg/640?wx_fmt=png" data-type="png" data-w="799" src="https://mmbiz.qpic.cn/mmbiz_png/WThoCmvVu2ZB56fxcC2D0LEVQBe3G6HqVIoicoTwgOxNCumOSsw5iazWFdQ7GIsQ2bwsyHLAQFPxoHcd2DCM2CPg/640?wx_fmt=png"></p><p data-tool="mdnice编辑器">如果你的网络ok，可以上传到服务器，直接在终端运行该文件下载，但通常而言，不是下载失败，就是下一半断网了。如：</p><pre data-tool="mdnice编辑器"><span></span><code>nohup bash ena-file-download-selected-files-20231011-0909.sh &amp;&gt; sra.log &amp;<br><br></code></pre><ol data-tool="mdnice编辑器"><li><section>SRA Explorer</section></li></ol><p data-tool="mdnice编辑器">我们还可以通过SRA Explorer搜索。</p><p><img data-ratio="0.35555555555555557" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/WThoCmvVu2ZB56fxcC2D0LEVQBe3G6HqtLQaw10iaB0wEkFnBpicLco5Jcb4p0dgbh1RRAcowkmgIf5YVtVfCiaSg/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/WThoCmvVu2ZB56fxcC2D0LEVQBe3G6HqtLQaw10iaB0wEkFnBpicLco5Jcb4p0dgbh1RRAcowkmgIf5YVtVfCiaSg/640?wx_fmt=png"></p><p data-tool="mdnice编辑器">SRA Explorer为研究者提供了多种格式和下载方式，<strong>我们通常选择<code>FastQ Downloads</code>下的<code>Aspera</code>选项实现高速下载</strong>，但是现在我们还不能直接运行，因为还没有装<code>Aspera</code>软件。如果你选择<code>Raw</code>或<code>Bash</code>下载，则跟上面ENA提供的下载命令类似。</p><p><img data-ratio="0.5124309392265194" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/WThoCmvVu2ZB56fxcC2D0LEVQBe3G6HqVEq0bUajCrpBeQxwHWo6ibQmBaonoC2KJicibGeiaj6kqAde6jYh9t6pibw/640?wx_fmt=png" data-type="png" data-w="724" src="https://mmbiz.qpic.cn/mmbiz_png/WThoCmvVu2ZB56fxcC2D0LEVQBe3G6HqVEq0bUajCrpBeQxwHWo6ibQmBaonoC2KJicibGeiaj6kqAde6jYh9t6pibw/640?wx_fmt=png"></p><h2 data-tool="mdnice编辑器"><span></span><span>3. 数据下载</span></h2><p data-tool="mdnice编辑器">在第二部分，我们通过一个实例了解到如何有效地查询下载地址，下面我们同样通过实例来完成一个SRR数据的下载。数据下载通常有几个方式：① 原始的<code>wget</code>或<code>curl+下载链接</code>的方式，如上面ENA提供的代码，不推荐；② SRA官方的<code>sratoolkit</code>工具的<code>prefetch</code>命令，下载比较慢；③<code>Aspera</code>高速下载：推荐；④其他下载方式，如 <code>kingfisher</code>等工具同样能实现高速下载。今天我们来介绍②和③两种方式。</p><h4 data-tool="mdnice编辑器"><span></span>（1）SRA Tooklkit<span></span></h4><p data-tool="mdnice编辑器">SRA Toolkit 安装</p><ol data-tool="mdnice编辑器"><li><section><strong>从NCBI官网点击Download —&gt; Download Tools —&gt; SRA Toolkit download</strong></section></li></ol><p><img data-ratio="0.575" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/WThoCmvVu2ZB56fxcC2D0LEVQBe3G6Hq11hy1CoI1ic1VASicRGIstuCFuuMD3nQs8pXFiaSg51ylaueTYD6PicvyA/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/WThoCmvVu2ZB56fxcC2D0LEVQBe3G6Hq11hy1CoI1ic1VASicRGIstuCFuuMD3nQs8pXFiaSg51ylaueTYD6PicvyA/640?wx_fmt=png"></p><p><img data-ratio="0.5694444444444444" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/WThoCmvVu2ZB56fxcC2D0LEVQBe3G6HqXChFgicpuj3X9QhccVYbA9dt3fmoKYFp47zR0icQKa8FK8NSwUYU3Jlg/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/WThoCmvVu2ZB56fxcC2D0LEVQBe3G6HqXChFgicpuj3X9QhccVYbA9dt3fmoKYFp47zR0icQKa8FK8NSwUYU3Jlg/640?wx_fmt=png"></p><p><img data-ratio="0.7100115074798619" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/WThoCmvVu2ZB56fxcC2D0LEVQBe3G6HqttnCkW7kdgBehwF4y2nswCdRMPeiawTjF74LFwcmVCXeB3iaaVVveiayw/640?wx_fmt=png" data-type="png" data-w="869" src="https://mmbiz.qpic.cn/mmbiz_png/WThoCmvVu2ZB56fxcC2D0LEVQBe3G6HqttnCkW7kdgBehwF4y2nswCdRMPeiawTjF74LFwcmVCXeB3iaaVVveiayw/640?wx_fmt=png"></p><ol data-tool="mdnice编辑器"><li><section><strong>根据系统选择对应的版本，这里我们选择Ubuntu系统</strong></section></li></ol><p><img data-ratio="0.48484848484848486" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/WThoCmvVu2ZB56fxcC2D0LEVQBe3G6HqlqGJdjibDYxMG9uKibElc0UbPNOfM17HicFV1eww4Fx8slUTKHaUkl5aA/640?wx_fmt=png" data-type="png" data-w="693" src="https://mmbiz.qpic.cn/mmbiz_png/WThoCmvVu2ZB56fxcC2D0LEVQBe3G6HqlqGJdjibDYxMG9uKibElc0UbPNOfM17HicFV1eww4Fx8slUTKHaUkl5aA/640?wx_fmt=png"></p><pre data-tool="mdnice编辑器"><span></span><code><span># 下载和解压</span><br>wget https://ftp-trace.ncbi.nlm.nih.gov/sra/sdk/3.0.7/sratoolkit.3.0.7-ubuntu64.tar.gz<br>tar zxvf sratoolkit.2.9.6-ubuntu64.tar.gz<br><br><span># 加入环境变量</span><br><span>cd</span> sratoolkit.3.0.7-ubuntu64<br><span>echo</span> <span>'export PATH=$PATH:$HOME/biosoftware/sratoolkit/sratoolkit.3.0.7-ubuntu64/bin'</span> &gt;&gt; ~/.bashrc<br><br><span># 重启环境</span><br><span>source</span> ~/.bashrc<br><br><span># 检查是否安装成功</span><br>prefetch -V<br><span># prefetch : 3.0.7</span><br><br></code></pre><h4 data-tool="mdnice编辑器"><span></span>Prefetch 命令批量下载SRA数据<span></span></h4><blockquote data-tool="mdnice编辑器"><p>如果仅下载单个SRR数据，可以直接看第6点</p></blockquote><ol data-tool="mdnice编辑器"><li><section>使用练习数据为<code>GSE210248</code>（与刚刚的数据集其实是同一篇文章）</section></li><ol><li><section>在目录下创建一个新的文件夹<code>GSE210248_IPAH_PA</code></section></li><li><section>从GEO中查询到对应的SRA数据编号为：<code>SRP389163</code></section></li><li><section>从SRA Selector网站中查询并获得SRR列表</section></li><li><section>新建<code>txt</code>文件：<code>vim GSE210248_IPAH_PA/SRP389163_SRR_Acc_List.txt</code>，输入<code>i</code>进入编辑模式，并将SRR列表复制到此处，按<code>esc</code>，按<code>:wq</code>保存退出。</section></li><li><section>将列表内容保存在文件<code>GSE210248_IPAH_PA/SRP389163_SRR_Acc_List.txt</code>中</section><section><img data-ratio="0.7001140250855188" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/WThoCmvVu2ZB56fxcC2D0LEVQBe3G6HqCvbVEepaAeDbL1P4pLb2Z4ibEgEk5gicuwJS12PxrKic42c5ImepECgOA/640?wx_fmt=png" data-type="png" data-w="877" src="https://mmbiz.qpic.cn/mmbiz_png/WThoCmvVu2ZB56fxcC2D0LEVQBe3G6HqCvbVEepaAeDbL1P4pLb2Z4ibEgEk5gicuwJS12PxrKic42c5ImepECgOA/640?wx_fmt=png"></section></li></ol><li><section>我们新建一个<code>bash</code>文件：</section></li><ol><li><section>在命令行输入 <code>vim run_prefetch.sh</code></section></li><li><section>按 <code>i</code>进入编辑模式</section></li><li><section>输入以下内容</section></li><li><section>按<code>esc</code>，按<code>:wq</code>保存退出。</section></li></ol></ol><pre data-tool="mdnice编辑器"><span></span><code>prefetch \<br>        <span># --option-file 是SRR列表的文本文件</span><br>        --option-file <span>$HOME</span>/resources/download_data/rna-seq/GSE210248_IPAH_PA/SRP389163_SRR_Acc_List.txt \<br>        <span># -O 表示下载的文件保存到该路径</span><br>        -O <span>$HOME</span>/resources/download_data/rna-seq/GSE210248_IPAH_PA/<br></code></pre><ol data-tool="mdnice编辑器"><li><section>下载命令，并挂载后台，下载速度取决于你的网速</section></li></ol><pre data-tool="mdnice编辑器"><span></span><code>nohup bash run_prefetch.sh &amp;&gt; prefetch_download.log &amp;<br></code></pre><ol data-tool="mdnice编辑器"><li><section>查看下载日志</section></li></ol><pre data-tool="mdnice编辑器"><span></span><code>cat prefetch_download.log | tail<br><span># 2023-09-29T22:24:33 prefetch.3.0.8: 'SRR20736761' has 0 unresolved dependencies</span><br><span># </span><br><span># 2023-09-29T22:24:35 prefetch.3.0.8: Current preference is set to retrieve SRA Normalized Format files with full base quality scores.</span><br><span># 2023-09-29T22:24:36 prefetch.3.0.8: 12) Downloading 'SRR20736762'...</span><br><span># 2023-09-29T22:24:36 prefetch.3.0.8: SRA Normalized Format file is being retrieved, if this is different from your preference, it may be due to current file availability.</span><br><span># 2023-09-29T22:24:36 prefetch.3.0.8:  Downloading via HTTPS...</span><br><span># 2023-09-29T22:31:03 prefetch.3.0.8:  HTTPS download succeed</span><br><span># 2023-09-29T22:31:14 prefetch.3.0.8:  'SRR20736762' is valid</span><br><span># 2023-09-29T22:31:14 prefetch.3.0.8: 12) 'SRR20736762' was downloaded successfully</span><br><span># 2023-09-29T22:31:14 prefetch.3.0.8: 'SRR20736762' has 0 unresolved dependencies</span><br><br></code></pre><ol data-tool="mdnice编辑器"><li><section>查看下载结果：</section></li></ol><p data-tool="mdnice编辑器">能看到每个sra文件都归类到对应文件夹下，并提供了SRP metadata信息。</p><pre data-tool="mdnice编辑器"><span></span><code>tree GSE210248_IPAH_PA/<br><br><span># GSE210248_IPAH_PA/</span><br><span># ├── run_prefetch.sh</span><br><span># ├── SRP389163_metadata.txt</span><br><span># ├── SRP389163_SRR_Acc_List.txt</span><br><span># ├── SRR20736751</span><br><span># │   └── SRR20736751.sra</span><br><span># ├── SRR20736752</span><br><span># │   └── SRR20736752.sra</span><br><span># ├── SRR20736753</span><br><span># │   └── SRR20736753.sra</span><br><span># ├── SRR20736754</span><br><span># │   └── SRR20736754.sra</span><br><span># ├── SRR20736755</span><br><span># │   └── SRR20736755.sra</span><br><span># ├── SRR20736756</span><br><span># │   └── SRR20736756.sra</span><br><span># ├── SRR20736757</span><br><span># │   └── SRR20736757.sra</span><br><span># ├── SRR20736758</span><br><span># │   └── SRR20736758.sra</span><br><span># ├── SRR20736759</span><br><span># │   └── SRR20736759.sra</span><br><span># ├── SRR20736760</span><br><span># │   └── SRR20736760.sra</span><br><span># ├── SRR20736761</span><br><span># │   └── SRR20736761.sra</span><br><span># └── SRR20736762</span><br><span># └── SRR20736762.sra</span><br><span># </span><br><span># 12 directories, 15 files</span><br><br>ls -lh GSE210248_IPAH_PA/SRR20736757<br><span># total 7.8G</span><br><span># -rw-r--r-- 1 gz123 guozi 7.8G 9月  30 03:48 SRR20736757.sra</span><br><br></code></pre><ol data-tool="mdnice编辑器"><li><section>下载单个SRR文件</section></li></ol><pre data-tool="mdnice编辑器"><span></span><code><span># prefetch + SRR number</span><br>prefetch SRR20736751<br></code></pre><h4 data-tool="mdnice编辑器"><span></span>（2）Aspera下载<span></span></h4><p data-tool="mdnice编辑器"><code>prefetch</code><strong>结合</strong><code>aspera</code><strong>命令</strong></p><p data-tool="mdnice编辑器">我们使用 <code>prefetch -h</code>查看帮助文档，可以看到 <code>-t</code>参数提示：如果存在 <code>aspera</code>的情况下，会优先使用 <code>fasp</code>技术（<code>aspera</code>核心技术）进行下载。<code>aspera</code>自己也可以通过命令下载文件。</p><pre data-tool="mdnice编辑器"><span></span><code> -t|--transport &lt;http|fasp|both&gt;  Transport: one of: fasp; http; both <br>                                  [default]. (fasp only; http only; first try <br>                                  fasp (ascp), use http <span>if</span> cannot download <br>                                  using fasp). <br></code></pre><ol data-tool="mdnice编辑器"><li><section>下载aspera</section></li></ol><pre data-tool="mdnice编辑器"><span></span><code>mkdir aspera<br><span>cd</span> aspera<br><br>wget http://download.asperasoft.com/download/sw/connect/3.7.4/aspera-connect-3.7.4.147727-linux-64.tar.gz<br><br></code></pre><ol data-tool="mdnice编辑器"><li><section>解压和安装</section></li></ol><pre data-tool="mdnice编辑器"><span></span><code>tar zxvf aspera-connect-3.7.4.147727-linux-64.tar.gz<br><span>#安装</span><br>bash aspera-connect-3.7.4.147727-linux-64.sh<br><span># 然后cd到根目录下看看是不是存在了.aspera文件夹，有的话表示安装成功</span><br><span>cd</span> &amp;&amp; ls -a<br><span># 将aspera软件加入环境变量，并激活</span><br><span>echo</span> <span>'export PATH=~/.aspera/connect/bin:$PATH'</span> &gt;&gt; ~/.bashrc<br><span>source</span> ~/.bashrc<br><span># 最后检查ascp是不是能用了</span><br>ascp --<span>help</span><br></code></pre><p data-tool="mdnice编辑器">同样运行上述<code>prefetch</code>命令即可，不需要更改其他参数。但我实测下来，发现日志文件里有时还是会用<code>HTTP</code>下载，下载速度比较慢（做好下载1-2天的准备）。因此我们可以直接使用Aspera下载。</p><p data-tool="mdnice编辑器">另外需要补充的是，<code>prefetch</code><span>命令默认单个文件最大为20G，我们可以通过 <span>--m</span><span>ax-size </span>参数调整，比如 <span>prefetch SRPxxx --max-size 100G</span></span><br></p><p data-tool="mdnice编辑器"><strong>直接使用Aspera（ascp命令）下载</strong></p><p data-tool="mdnice编辑器"><code>aspera 4.2</code>官方参考文档（但实测发现<code>4.2</code>有点bug，用上面提供的<code>3.7</code>即可，你也可以尝试其他版本）</p><pre data-tool="mdnice编辑器"><span></span><code><span># for Linux users</span><br>https://www.ibm.com/docs/en/aspera-connect/4.2?topic=aspera-connect-user-guide-linux<br><span># for Windows users</span><br>https://www.ibm.com/docs/en/aspera-connect/4.2?topic=aspera-connect-user-guide-window<br><span># for MacOS users</span><br>https://www.ibm.com/docs/en/aspera-connect/4.2?topic=aspera-connect-user-guide-macos<br><br></code></pre><p data-tool="mdnice编辑器"><code>ascp</code>参数比较多，好在有SRA Explorer的帮助，我们通常不会手敲命令，如果你实在需要的时候可以网上查询如何手敲。在SRA Explorer的下载界面，我们可以直接获得下载命令。</p><p><img data-ratio="0.5074074074074074" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/WThoCmvVu2ZB56fxcC2D0LEVQBe3G6Hqm5SAD9OCQG7KMIyfkOBoZbWBial70svY2qhL9gNJoNTXXxUhJcUJLVA/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/WThoCmvVu2ZB56fxcC2D0LEVQBe3G6Hqm5SAD9OCQG7KMIyfkOBoZbWBial70svY2qhL9gNJoNTXXxUhJcUJLVA/640?wx_fmt=png"></p><p data-tool="mdnice编辑器">为了节约时间，我们选择其中两个SRR来下载。复制以上命令，并写入一个<code>sh</code>文件。具体参数的解析，可以通过帮助文档或官方教程来查询。</p><pre data-tool="mdnice编辑器"><span></span><code>#!/usr/bin/env bash<br>ascp -QT -l 300m -P33001 -i $HOME/.aspera/connect/etc/asperaweb_id_dsa.openssh era-fasp@fasp.sra.ebi.ac.uk:vol1/fastq/SRR207/054/SRR20736754/SRR20736754_1.fastq.gz . &amp;&amp; mv SRR20736754_1.fastq.gz SRR20736754_GSM6424658_PAH_1_scRNAseq_Homo_sapiens_RNA-Seq_1.fastq.gz<br>ascp -QT -l 300m -P33001 -i $HOME/.aspera/connect/etc/asperaweb_id_dsa.openssh era-fasp@fasp.sra.ebi.ac.uk:vol1/fastq/SRR207/054/SRR20736754/SRR20736754_2.fastq.gz . &amp;&amp; mv SRR20736754_2.fastq.gz SRR20736754_GSM6424658_PAH_1_scRNAseq_Homo_sapiens_RNA-Seq_2.fastq.gz<br>ascp -QT -l 300m -P33001 -i $HOME/.aspera/connect/etc/asperaweb_id_dsa.openssh era-fasp@fasp.sra.ebi.ac.uk:vol1/fastq/SRR207/055/SRR20736755/SRR20736755_1.fastq.gz . &amp;&amp; mv SRR20736755_1.fastq.gz SRR20736755_GSM6424658_PAH_1_scRNAseq_Homo_sapiens_RNA-Seq_1.fastq.gz<br>ascp -QT -l 300m -P33001 -i $HOME/.aspera/connect/etc/asperaweb_id_dsa.openssh era-fasp@fasp.sra.ebi.ac.uk:vol1/fastq/SRR207/055/SRR20736755/SRR20736755_2.fastq.gz . &amp;&amp; mv SRR20736755_2.fastq.gz SRR20736755_GSM6424658_PAH_1_scRNAseq_Homo_sapiens_RNA-Seq_2.fastq.gz<br><br></code></pre><p data-tool="mdnice编辑器">后台运行：</p><pre data-tool="mdnice编辑器"><span></span><code>nohup bash ascp.sh &amp;&gt; download.log &amp;<br></code></pre><p data-tool="mdnice编辑器">日志输出能看到下载速度是比较快的，几分钟就下载一个<code>fastq</code>文件，速度约为2 M/s：</p><pre data-tool="mdnice编辑器"><span></span><code>Completed: 3776843K bytes transferred <span>in</span> 174 seconds<br> (177548K bits/sec), <span>in</span> 1 file.<br>Completed: 6317847K bytes transferred <span>in</span> 359 seconds<br> (144133K bits/sec), <span>in</span> 1 file.<br>Completed: 3485454K bytes transferred <span>in</span> 199 seconds<br> (143142K bits/sec), <span>in</span> 1 file.<br>Completed: 5912373K bytes transferred <span>in</span> 211 seconds<br> (229083K bits/sec), <span>in</span> 1 file.<br></code></pre><h2 data-tool="mdnice编辑器"><span></span><span>4. SRA文件解压</span></h2><p data-tool="mdnice编辑器">通常来说，通过<code>ascp</code>命令直接下载<code>fastq.gz</code>更快捷方便。但有时候各种问题会导致<code>fastq</code>文件下载失败，或ENA上缺失该样品的数据，就需要通过<code>prefetch</code>从SRA数据库中下载<code>.sra</code>文件，并转换为<code>fastq</code>文件。</p><h3 data-tool="mdnice编辑器"><span></span><span>fastq-dump转换fastq文件</span><span></span></h3><p data-tool="mdnice编辑器">参考文档：</p><pre data-tool="mdnice编辑器"><span></span><code><span># fastq-dump</span><br>https://www.jianshu.com/p/a8d70b66794c<br><span># fasterq-dump</span><br>https://www.jianshu.com/p/5c97a34cc1ad<br></code></pre><p data-tool="mdnice编辑器">SRA Toolkit中提供了<code>fastq-dump</code>和<code>fasterq-dump</code>两个工具对<code>.sra</code>文件进行解压转换，都已经集合在<code>sratoolkit</code>中，因此我们安装<code>sratoolkit</code>后可以直接使用。两者的参数基本是一致的，其中<code>fasterq-dump</code>可以调用多线程，但不能压缩。我们分别来看看他们的命令如何执行：</p><p data-tool="mdnice编辑器">具体如何调整参数可以查看上面的链接，我们用下面的代码进行转换：</p><p data-tool="mdnice编辑器"><strong>fastq-dump</strong></p><pre data-tool="mdnice编辑器"><span></span><code>time fasterq-dump \<br>         <span># sra文件名</span><br>         SRR20736751.sra \<br>         <span># 指定拆分方式为每个读取序列一个文件</span><br>         --split-3 \<br>         <span># 指定输出文件夹</span><br>         -O <span>test</span><br>         <br><span># --gizp 参数可以压缩fastq文件，但会消耗很长时间</span><br><br></code></pre><p data-tool="mdnice编辑器"><strong>fasterq-dump</strong></p><pre data-tool="mdnice编辑器"><span></span><code><span># 进入某个SRR的目录</span><br><span>cd</span> GSE210248_IPAH_PA/SRR20736751<br><br><span># time 计算时间</span><br>time fasterq-dump \<br>    <span># sra文件名</span><br>    SRR20736751.sra \<br>    <span># 指定拆分方式为每个读取序列一个文件</span><br>    --split-3 \<br>    <span># 调用线程</span><br>    -e 20 \<br>    <span># 输出文件名</span><br>    -o SRR20736751 \<br>    <span># 展示进度</span><br>    -p<br>    <br><span># fasterq-dump 中没有 --gzip 参数</span><br><br></code></pre><p data-tool="mdnice编辑器">查看结果，转换后通常会生成R1和R2两个<code>fastq</code>文件：</p><pre data-tool="mdnice编辑器"><span></span><code>ls -lh<br><br><span># total 155G</span><br><span># drwxr-xr-x 2 gz123 guozi 4.0K 10月  7 15:40 fasterq.tmp.vm-87fa-8d7bb241113e.4044998</span><br><span># -rw-r--r-- 1 gz123 guozi  64G 10月  7 16:09 SRR20736751_1.fastq</span><br><span># -rw-r--r-- 1 gz123 guozi  73G 10月  7 16:11 SRR20736751_2.fastq</span><br><span># -rw-r--r-- 1 gz123 guozi  20G 9月  29 18:32 SRR20736751.sra</span><br></code></pre><p data-tool="mdnice编辑器">查看<code>fastq</code>文件</p><pre data-tool="mdnice编辑器"><span></span><code>less -s SRR20736751_1.fastq <br><br><span>#' @SRR20736751.1 K00288:174:HCK32BBXY:2:1101:1610:1402 length=76</span><br><span>#' TNAGGGAGTCAACTGTGTTCCCTTTATTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTCCAAATATCTCCCTC</span><br><span>#' +SRR20736751.1 K00288:174:HCK32BBXY:2:1101:1610:1402 length=76</span><br><span>#' A#AAFFFJFJJJJJJJJFJJJJJJJJFJJJJJJJJJJJJJJJJJFJJJFJJJJF&lt;FFJ---7---&lt;7----&lt;&lt;---</span><br><span>#' @SRR20736751.2 K00288:174:HCK32BBXY:2:1101:1560:1420 length=76</span><br><span>#' CNCATTAAGTGTGAATTGCATTATCATTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTT</span><br><span>#' +SRR20736751.2 K00288:174:HCK32BBXY:2:1101:1560:1420 length=76</span><br><span>#' A#AFAFJFJ-FJJJJJ&lt;JJJJFJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJF-&lt;JJFFAFJJJAJFJFJ&lt;-7</span><br><span>#' @SRR20736751.3 K00288:174:HCK32BBXY:2:1101:1621:1420 length=76</span><br><span>#' ANAGACCGTCATGCATTTCATATCAATTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTAATAGACAACG</span><br><span>#' +SRR20736751.3 K00288:174:HCK32BBXY:2:1101:1621:1420 length=76</span><br><span>#' A#AA-A-AAJA7&lt;FF7JJJJJFA&lt;FAJJJJJJJJJJJJJJJJJJJJJJJJJJJJJF-AFFJ-&lt;--&lt;----------</span><br><span># （……省略）</span><br><br><span># 按 q 退出</span><br></code></pre><p data-tool="mdnice编辑器">那么R1和R2分别代表什么，这就不得不从10X的文库结构开始说起，篇幅较长，我们接下来会用一篇笔记专门阐述这个事情。在这里我们简单介绍一下：</p><p data-tool="mdnice编辑器">从下面截取的R1的<code>fastq</code>文件可以看到，碱基序列有效序列为<code>TNAGGGAGTCAACTGTGTTCCCTTTA</code> 共计26个碱基，后面的<code>TTTTT</code>为ployA尾，可以忽略。这里代表了<code>cell barcode</code>的16个碱基，加上<code>UMI</code>的10个碱基，属于10X v2的protocol。</p><pre data-tool="mdnice编辑器"><span></span><code>@SRR20736751.1 K00288:174:HCK32BBXY:2:1101:1610:1402 length=76<br>TNAGGGAGTCAACTGTGTTCCCTTTATTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTCCAAATATCTCCCTC<br>+SRR20736751.1 K00288:174:HCK32BBXY:2:1101:1610:1402 length=76<br>A#AAFFFJFJJJJJJJJFJJJJJJJJFJJJJJJJJJJJJJJJJJFJJJFJJJJF&lt;FFJ---7---&lt;7----&lt;&lt;---<br></code></pre><p data-tool="mdnice编辑器">从R2的<code>fastq</code>文件可以看到，有效碱基为98个。这里代表了反转录的cDNA序列。</p><pre data-tool="mdnice编辑器"><span></span><code>@SRR20736759.5 D00681:142:HKHVLBCX2:1:1101:1097:2445 length=98<br>GGCAGACTCCTCACATTCCAGCACTTTCCCACCTGACTCCTCTCCCCTCGTTTTTCCTTCAATAAACTATTTTGTGTCAGCTCCAAAAAAAAAAAAAA<br>+SRR20736759.5 D00681:142:HKHVLBCX2:1:1101:1097:2445 length=98<br>GGGAGIIAAGGGGGGIIGGGGIGGGGGGGGGGGGGGGIGIIIIIIIIIIIGGIIIIIIIIIIIGIGIIIGGIIIGGIIIGIGIIIGIIIAGGIGIIII<br></code></pre><p data-tool="mdnice编辑器">如果你从ENA直接下载的是<code>fastq.gz</code>文件，第一行可能没有 <code>length</code>这个信息。</p><p data-tool="mdnice编辑器">如果我们不希望每次都更改脚本，也可以写成传参脚本，我们以<code>fasterq-dump</code>为例：</p><pre data-tool="mdnice编辑器"><span></span><code><span>#!/bin/bash<br></span><br><span># 第一个参数为sra文件名</span><br>input_sra=<span>"<span>$1</span>"</span><br><span># 第二个参数为输出文件夹路径</span><br>out_file=<span>"<span>$2</span>"</span><br><br><span># 检查是否提供了足够的参数</span><br><span>if</span> [[ -z <span>"<span>$input_sra</span>"</span> || -z <span>"<span>$out_file</span>"</span> ]]; <span>then</span><br>    <span>echo</span> <span>"请提供输入参数！"</span><br>    <span>echo</span> <span>"用法: <span>$0</span> &lt;input_sra&gt; &lt;out_file&gt;"</span><br>    <span>exit</span> 1<br><span>fi</span><br><br>time fasterq-dump \<br>         --split-3 <span>"<span>$input_sra</span>"</span> \<br>         -e 20 \<br>         -o <span>"<span>$out_file</span>"</span> \<br>         -p<br><br><span># 使用这个脚本时，请确保按照以下格式提供命令行参数：</span><br><span># nohup bash fasterq-dump.sh &lt;input_sra&gt; &lt;out_file&gt; &amp;&gt; fd.log &amp;</span><br><br></code></pre><p data-tool="mdnice编辑器">使用示例：</p><pre data-tool="mdnice编辑器"><span></span><code>nohup bash fasterq-dump.sh SRR20736751.sra SRR20736751 &amp;&gt; fd.log &amp;<br></code></pre><p data-tool="mdnice编辑器">如果你想一次性多个文件进行，也可以写个循环。</p><h2 data-tool="mdnice编辑器"><span></span><span>5. 特殊情况处理</span></h2><p data-tool="mdnice编辑器">如果没有意外的话，就一定会发生意外。</p><p data-tool="mdnice编辑器">下载数据过程中各种奇葩的坑是难以想象的，其中有一种情况很常见：按照上述代码使用<code>fastq-dump</code>或<code>fasterq-dump</code>转换为fastq文件后，惊奇的发现只有1个<code>fastq</code>文件！如果我们仔细检查SRA Explorer提供的代码其实就可以看到了，比如<code>SRR20736759</code>只有一个<code>fastq.gz</code>文件的下载代码。</p><p data-tool="mdnice编辑器">我们下载之后查看这个文件，发现是cDNA序列信息：</p><pre data-tool="mdnice编辑器"><span></span><code>@SRR20736759.1 D00681:142:HKHVLBCX2:1:1101:1232:2354 length=98<br>GTGTGGTGGTCCGCGACTGTAATCCCAGCTACTCGGGAGGCTGAGGCATGAGAATCACTTGAACCCAGGAGGCGGAGGTTGCAGTGAGCCAAGATGGC<br>+SRR20736759.1 D00681:142:HKHVLBCX2:1:1101:1232:2354 length=98<br>GGGGAIGGGGGA&lt;GGIGGGIGIIIGGGGIIIIIIIIGIGIIIGIIIGIIGGIIGIGIIGIGGIIIIIIIIIIIIIGIGIIIGIIIIIIGIGGIGGIIG<br></code></pre><p data-tool="mdnice编辑器">无论是<code>cellranger</code>还是<code>STAR</code>等比对软件，都需要输入两个文件，一个包含cDNA序列，一个包含barcode，这时候怎么办呢？</p><p data-tool="mdnice编辑器">这时候，我们就不能用ENA数据库直接下载<code>fastq</code>文件了，必须要下载<code>.sra</code>文件再通过<code>fastq-dump</code>解压缩。</p><p data-tool="mdnice编辑器">在这里我们仔细讲一下<code>--split-3</code>和<code>--split-files</code>这个两个参数的区别：</p><p data-tool="mdnice编辑器">参考链接：</p><pre data-tool="mdnice编辑器"><span></span><code>https://www.biostars.org/p/186741/<br>https://mp.weixin.qq.com/s/fP8f4HboMM7m2Nd7AIljlg<br><br></code></pre><p data-tool="mdnice编辑器">前面我们用到的fastq-dump代码是：</p><pre data-tool="mdnice编辑器"><span></span><code>fastq-dump \<br>         SRR20736751.sra <span># sra文件名 \</span><br>         --split-3 <span># 指定拆分方式为每个读取序列一个文件 \</span><br>         -O <span>test</span> <span># 指定输出文件夹 </span><br></code></pre><blockquote data-tool="mdnice编辑器"><p><code>--split-3</code>将输出1、2或3个文件：1个文件表示单端测序。2个文件表示双端测序，没有低质量读取或长度小于20bp的读取。3个文件表示配对数据，但质量不对称或需要修剪。<code>--split-files</code>将3个文件：样品序列（I1）、barcode和UMI序列（R1）、cDNA序列（R2）</p></blockquote><p data-tool="mdnice编辑器">那么我们用<code>--split-3</code>输出了1个文件，是不是说明这个样品是单端测序？显然不是。这个问题比较难解释，经过查询后得到一个貌似可靠的答案：原本会产生3个文件，但第三个文件太大会覆盖前两个。</p><p data-tool="mdnice编辑器">总之不管为什么，我们尝试使用<code>--split-files</code>这个参数看看：</p><pre data-tool="mdnice编辑器"><span></span><code><span># 这里对SRR20736759.sra进行转换</span><br><span>cd</span> GSE210248_IPAH_PA/SRR20736759<br>nohup fastq-dump SRR20736759.sra --split-files --gzip &amp;&gt; fd.log &amp; <span># 加了gzip会很慢，空间足够大可以先去掉这个参数</span><br><br></code></pre><p data-tool="mdnice编辑器">看看结果：</p><p><img data-ratio="0.2742382271468144" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/WThoCmvVu2ZB56fxcC2D0LEVQBe3G6Hqd11V8dpAZqibTLA9HMneuwiayIt9FDADDZEnrFoJwPGXT7jCm9LEuWWA/640?wx_fmt=png" data-type="png" data-w="722" src="https://mmbiz.qpic.cn/mmbiz_png/WThoCmvVu2ZB56fxcC2D0LEVQBe3G6Hqd11V8dpAZqibTLA9HMneuwiayIt9FDADDZEnrFoJwPGXT7jCm9LEuWWA/640?wx_fmt=png"></p><p data-tool="mdnice编辑器">分别用<code>less</code>查看后发现三个<code>fastq</code>文件的情况如下，聪明的你应该能判断他们分别包含什么信息了吧？</p><p><img data-ratio="0.3958041958041958" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/WThoCmvVu2ZB56fxcC2D0LEVQBe3G6Hqkh7tIvmcWUMIWK6PGAaxNl7MWGiaT6OtgB2KBZJ9bOibPUzVlfL1ATGA/640?wx_fmt=png" data-type="png" data-w="715" src="https://mmbiz.qpic.cn/mmbiz_png/WThoCmvVu2ZB56fxcC2D0LEVQBe3G6Hqkh7tIvmcWUMIWK6PGAaxNl7MWGiaT6OtgB2KBZJ9bOibPUzVlfL1ATGA/640?wx_fmt=png"></p><p data-tool="mdnice编辑器"><code>SRR20736759_1.fastq.gz</code>为sample序列，可以丢弃</p><p data-tool="mdnice编辑器"><code>SRR20736759_2.fastq.gz</code>为barcode+UMI序列</p><p data-tool="mdnice编辑器"><code>SRR20736759_3.fastq.gz</code>为cDNA序列</p><p data-tool="mdnice编辑器">这时候，我们再就可以用<code>cellranger</code>或者<code>STAR</code>进行定量了。需要注意的是，这里<code>cDNA_read</code>和<code>barcode_read</code>就应该是对应的<code>fastq</code>文件了，而不是R2和R1。</p><h2 data-tool="mdnice编辑器"><span></span><span>小结</span></h2><p data-tool="mdnice编辑器">本次笔记，我们从数据库介绍、数据搜索、数据下载、数据解压和某些特殊情况处理等几个方面，介绍了高通量原始数据的获取，为我们后面做上游分析奠定基础。除了本次笔记介绍的<code>prefetch</code>和<code>aspera</code>下载方式外，鼓励大家查询和学习其他下载方式，如Kingfisher、pysradb等方式，我们也曾经给大家推荐过相关教程：<a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzkzMzE5NTM4NA==&amp;mid=2247489192&amp;idx=1&amp;sn=fba5c3c20b2c00e7f3ba17a514a690a0&amp;chksm=c2516dbff526e4a9e4360183242de85225627759f5cdb3231bc6fca17998a9d81e6df897d91b&amp;scene=21#wechat_redirect" textvalue='"Kingfisher" OR "easyBio"：单细胞转录组原始测序数据下载完全指南' linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2">"Kingfisher" OR "easyBio"：单细胞转录组原始测序数据下载完全指南</a>。如果你手头上有硬件支持，赶紧练习起来吧！</p><ul data-tool="mdnice编辑器"><li><section>下一篇笔记，我们将以10X为例，理解单细胞文库的结构，并扩展到其他测序平台（如BD）的文库结构。</section></li><li><section>再往后，我们将以<code>SRR20736751</code>为例进行上游定量分析。</section><section><br></section></li></ul></section><section><mp-common-profile data-pluginname="mpprofile" data-id="MzkzMzE5NTM4NA==" data-headimg="http://mmbiz.qpic.cn/mmbiz_png/WThoCmvVu2aJMzXzvekL6pv5hnSGnwsxWcOUF8av7a9VEiaicBGia4CRy0DUOeaFuFZY2BPLmRQSf4lkibg5l31Ttw/0?wx_fmt=png" data-nickname="TOP生物信息" data-alias="" data-signature="生信人，当自强。" data-from="0" data-is_biz_ban="0"></mp-common-profile></section><p><br></p><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/49zzxtWwu6RMY7g79dsV6Q",target="_blank" rel="noopener noreferrer">原文链接</a>
