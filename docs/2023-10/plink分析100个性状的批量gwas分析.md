---
title: "plink分析100个性状的批量gwas分析"
date: 2023-10-19T00:03:10Z
draft: ["false"]
tags: [
  "fetched",
  "育种数据分析之放飞自我"
]
categories: ["Acdemic"]
---
plink分析100个性状的批量gwas分析 by 育种数据分析之放飞自我
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-mpa-powered-by="yiban.io"><p data-tool="mdnice编辑器">大家好，我是邓飞。</p><p data-tool="mdnice编辑器">GWAS分析时，3~5个性状是正常操作，要分析100个性状呢，手动修改参数，工作量是够了，但是程序员的修养体现在哪里了？？？</p><p data-tool="mdnice编辑器">如果还是按照每个性状一个文件夹，每个文件夹中一个脚本，不断地修改脚本，一点也不高端，所以，遇到这种情况，批量处理就派上用场了。</p><p data-tool="mdnice编辑器"><span>之所以之前一直不用，因为10个性状一下，没有必要，费心思想还不如直接动手操作了，但是100个性状真的吓到我了，不满足才能有进步。就看了一下参数说明，然后五分钟搞定了。虽然五分钟搞定的事情，但是写博客20分钟记录一下还是有必要的，独乐乐不如众乐乐。</span></p><p data-tool="mdnice编辑器">开始介绍。</p><p data-tool="mdnice编辑器">plink中其实没有多性状模型的参数，但是它有一个<code>--mpheno</code>，指定性状所在的列，我们可以借用。</p><p data-tool="mdnice编辑器">数据来源，GWAS Cookbook的GWAS-dat2（领取方法：<a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzI0MTIzNjYwNQ==&amp;mid=2247489866&amp;idx=1&amp;sn=e8631d343a33ae956b23d97a6b2b3fe4&amp;chksm=e90ff658de787f4e3b52929c85adadbe8c6f54bf0943780ea94f9e19e4cc6ef8756e068761f9&amp;scene=21#wechat_redirect" textvalue="快来领取 | 飞哥的GWAS分析教程" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" wah-hotarea="click" hasload="1">快来领取 | 飞哥的GWAS分析教程</a>），用下面代码生成表型数据：</p><pre data-tool="mdnice编辑器"><span></span><code>library(data.table)<br><br>dd = fread(<span>"phe.txt"</span>)<br>head(dd)<br><br>set.seed(123)<br>xx = rnorm(150000)<br>nn = matrix(xx,1500,100) %&gt;% as.data.frame()<br>nn[1:10,1:10]<br><br><br>dd1 = cbind(dd,nn)<br>dd1[1:10,1:10]<br><br>fwrite(dd1,<span>"mphe.txt"</span>,col.names = F,quote = F,sep = <span>" "</span>)<br><br></code></pre><h3 data-tool="mdnice编辑器"><span></span>1. 表型数据<span></span></h3><p data-tool="mdnice编辑器">表型数据：模拟100个性状，整理为txt，第一列FID，第二列ID，第三列以后为性状<img data-ratio="0.4046296296296296" data-src="https://mmbiz.qpic.cn/mmbiz_png/XEicwVA08daBvyWBYAdFvHHOpNmHdQE326RoBeeIYuaIfPY0OpQK06PnYkyKSHLsibfHaIbXxMFEG4BqfgRR6n0g/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/XEicwVA08daBvyWBYAdFvHHOpNmHdQE326RoBeeIYuaIfPY0OpQK06PnYkyKSHLsibfHaIbXxMFEG4BqfgRR6n0g/640?wx_fmt=png"></p><h3 data-tool="mdnice编辑器"><span></span>2. 基因型数据<span></span></h3><figure data-tool="mdnice编辑器"><img data-ratio="0.23765432098765432" data-src="https://mmbiz.qpic.cn/mmbiz_png/XEicwVA08daBvyWBYAdFvHHOpNmHdQE32tWWFApSdcb1IBYWgiapIibsEkcCSJZbDOyJSWibKOGKGn22StsGQickXicA/640?wx_fmt=png" data-type="png" data-w="972" src="https://mmbiz.qpic.cn/mmbiz_png/XEicwVA08daBvyWBYAdFvHHOpNmHdQE32tWWFApSdcb1IBYWgiapIibsEkcCSJZbDOyJSWibKOGKGn22StsGQickXicA/640?wx_fmt=png"></figure><h3 data-tool="mdnice编辑器"><span></span>3. 单个性状建模<span></span></h3><p data-tool="mdnice编辑器">用linear模型（GLM）：</p><pre data-tool="mdnice编辑器"><span></span><code>plink --file b --pheno mphe.txt --linear --allow-no-sex --out re1<br></code></pre><p data-tool="mdnice编辑器">结果文件：</p><pre data-tool="mdnice编辑器"><span></span><code>$ ls re1*<br>re1.assoc.linear  re1.log  re1.nosex<br><br></code></pre><p data-tool="mdnice编辑器">GWAS分析结果：</p><p data-tool="mdnice编辑器"><img data-ratio="0.25277777777777777" data-src="https://mmbiz.qpic.cn/mmbiz_png/XEicwVA08daBvyWBYAdFvHHOpNmHdQE32zde4zoib03ibicgFjueW0NTNiaibVOE89YwhZLpSumBOCvFFWiajBM5GceCA/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/XEicwVA08daBvyWBYAdFvHHOpNmHdQE32zde4zoib03ibicgFjueW0NTNiaibVOE89YwhZLpSumBOCvFFWiajBM5GceCA/640?wx_fmt=png"><strong>注意，上面基因型没有质控，所以有P值为NA的情况，正常质控的数据不会存在这种情况。</strong></p><h3 data-tool="mdnice编辑器"><span></span>4. plink批量分析多性状gwas<span></span></h3><pre data-tool="mdnice编辑器"><span></span><code><span>for</span> i <span>in</span> {1..100};<span>do</span> <span>echo</span> <span>"nohup plink --file b  --allow-no-sex --pheno mphe.txt --linear --out y_<span>${i}</span>_result --mpheno <span>$i</span> "</span>|bash;<span>done</span><br></code></pre><p data-tool="mdnice编辑器">上面代码就是多性状gwas分析，代码解析：</p><ul data-tool="mdnice编辑器"><li><section>for 循环，1~100，表示100个性状，分别运行</section></li><li><section>正常进行gwas分析</section></li><li><section>--mpheno 后面参数$i，是分别运行100次gwas分析</section></li><li><section>--out 结果文件中，分别保存100个性状的gwas分析</section></li><li><section>|bash;done，是用管道符的形式运行nohup</section></li></ul><p data-tool="mdnice编辑器">运行过程：<img data-ratio="0.20092592592592592" data-src="https://mmbiz.qpic.cn/mmbiz_png/XEicwVA08daBvyWBYAdFvHHOpNmHdQE32JL7G1y1sZRGVuISJtcIDeIicT5ibyiaG4EbhibGiaq9beW2mDO3jFI3phtA/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/XEicwVA08daBvyWBYAdFvHHOpNmHdQE32JL7G1y1sZRGVuISJtcIDeIicT5ibyiaG4EbhibGiaq9beW2mDO3jFI3phtA/640?wx_fmt=png"></p><p data-tool="mdnice编辑器">运行的结果：</p><p data-tool="mdnice编辑器"><img data-ratio="0.40370370370370373" data-src="https://mmbiz.qpic.cn/mmbiz_png/XEicwVA08daBvyWBYAdFvHHOpNmHdQE32ibBebVmE4OZSoSTZWpXrmDFuVcgFuHiae4Cnw8scbz7ClJPddRFqFwcw/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/XEicwVA08daBvyWBYAdFvHHOpNmHdQE32ibBebVmE4OZSoSTZWpXrmDFuVcgFuHiae4Cnw8scbz7ClJPddRFqFwcw/640?wx_fmt=png">随便找一个性状结果：</p><p data-tool="mdnice编辑器"><img data-ratio="0.5055555555555555" data-src="https://mmbiz.qpic.cn/mmbiz_png/XEicwVA08daBvyWBYAdFvHHOpNmHdQE32plwSCRjIOicvv7oezhB7JlKXQXniaxaticicuXVJWEG8QlWvAGY5jDtaMw/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/XEicwVA08daBvyWBYAdFvHHOpNmHdQE32plwSCRjIOicvv7oezhB7JlKXQXniaxaticicuXVJWEG8QlWvAGY5jDtaMw/640?wx_fmt=png"></p><p data-tool="mdnice编辑器">完全没问题。搞定！！！</p><p data-tool="mdnice编辑器">上面的批量运行程序，不但可以是plink，也可以是gemma，gcta，GAPIT等软件，都可以按照这种写法，非常666！</p><p><br></p><p><strong>推荐阅读：</strong><br></p><p><br></p><p>1，<a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzI0MTIzNjYwNQ==&amp;mid=2247489866&amp;idx=1&amp;sn=e8631d343a33ae956b23d97a6b2b3fe4&amp;chksm=e90ff658de787f4e3b52929c85adadbe8c6f54bf0943780ea94f9e19e4cc6ef8756e068761f9&amp;scene=21#wechat_redirect" textvalue="快来领取 | 飞哥的GWAS分析教程" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" wah-hotarea="click" hasload="1">快来领取 | 飞哥的GWAS分析教程</a></p><p><br></p><p>2，<a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzI0MTIzNjYwNQ==&amp;mid=2247489124&amp;idx=1&amp;sn=923b2d827f0e4b6c70494ebd458bdfa5&amp;chksm=e90ff976de78706065f72955113db192e9f74682c503dc69c3ebf8d17e9b8726db82be1ffa0a&amp;scene=21#wechat_redirect" textvalue="飞哥汇总 | 入门数据分析资源推荐" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" wah-hotarea="click" hasload="1">飞哥汇总 | 入门数据分析资源推荐</a><br></p><p><br></p><p>3，<a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzI0MTIzNjYwNQ==&amp;mid=2247488460&amp;idx=3&amp;sn=b3acd30a2ab34e10415dacc90f596e4a&amp;chksm=e90ffcdede7875c8ba669382e38e91f5d1e10960448a1b88dbbe60bde1e5c2880e8ab918e914&amp;scene=21#wechat_redirect" textvalue="数量遗传学，分享几本书的电子版" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" wah-hotarea="click" hasload="1">数量遗传学，分享几本书的电子版</a></p><p><br></p><p>4，<a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzI0MTIzNjYwNQ==&amp;mid=2247490492&amp;idx=1&amp;sn=24434d7598cf1993bbece938b63cc7e8&amp;chksm=e90ff4aede787db837d5de895a24bb0cc055868d4345a5974a24534827aaff9882c86bbe6550&amp;scene=21#wechat_redirect" textvalue="R语言学习看最新版的电子书不香嘛？" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2">R语言学习看最新版的电子书不香嘛？</a></p><p><br></p><p><span>5，</span><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzI0MTIzNjYwNQ==&amp;mid=2247490897&amp;idx=1&amp;sn=2836fdb9bf636213d2ac9438c5d4d575&amp;chksm=e90ff243de787b55c501cf2ecc5bf3eb23f462b303ed4c861f0ade5c9d34741d338f18db3976&amp;scene=21#wechat_redirect" textvalue="书籍及配套代码领取--统计遗传分析导论" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" wah-hotarea="click" hasload="1"><span>书籍及配套代码领取--统计遗传分析导论</span></a></p><p><br></p><section><mp-common-profile data-pluginname="mpprofile" data-id="MzI0MTIzNjYwNQ==" data-headimg="http://mmbiz.qpic.cn/mmbiz_png/XEicwVA08daBIrllkaO46sRRbb3FItjeuFJ8omwhsLeNMmlvBtiaE8o3Dpib2h7XaAiaViaGQVlD5ufeDGvia2WQMU8g/0?wx_fmt=png" data-nickname="育种数据分析之放飞自我" data-alias="R-breeding" data-signature="本公众号主要介绍动植物育种数据分析中的相关问题, 算法及程序代码." data-from="0" data-is_biz_ban="0"></mp-common-profile></section><p data-tool="mdnice编辑器"><br></p></section><p><br></p><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/UD2fyKJqMem8wgagM9cxPg",target="_blank" rel="noopener noreferrer">原文链接</a>
