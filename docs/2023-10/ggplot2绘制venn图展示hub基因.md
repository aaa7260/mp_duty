---
title: "ggplot2绘制venn图展示hub基因"
date: 2023-10-16T16:20:22Z
draft: ["false"]
tags: [
  "fetched",
  "R语言数据分析指南"
]
categories: ["Acdemic"]
---
ggplot2绘制venn图展示hub基因 by R语言数据分析指南
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><h3 data-tool="mdnice编辑器"><span></span><span><span></span>欢迎关注R语言数据分析指南</span><span></span></h3><blockquote data-tool="mdnice编辑器"><span>❝</span><p>前面介绍了如何基于差异基因绘制热图并基于表达矩阵进行WGCNA分析，本节就来展示一下如何通过不同分析得到的基因id来绘制venn图展示hub基因，过程仅供参考，希望对各位观众老爷能有新的帮助，数据和代码已经被打包并上传到小编的2023VIP会员交流群。已经加群的朋友可以自行下载。如果你需要，可以参考文末的方式进行购买。</p><span>❞</span></blockquote><h3 data-tool="mdnice编辑器"><span></span><span><span></span>关注下方公众号下回更新不迷路</span><span></span></h3><section><mp-common-profile data-pluginname="mpprofile" data-id="Mzg3MzQzNTYzMw==" data-headimg="http://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZF0rpeZII9Ltl26VbVagriczTria1fib3XgjwwHEHFjPzkmGpqWDVVHBSzhENictUM2iavAKiaM5lc9USw/0?wx_fmt=png" data-nickname="R语言数据分析指南" data-alias="YanJANtwo" data-signature="R语言重症爱好者，喜欢绘制各种精美的图表，喜欢的小伙伴可以关注我，跟我一起学习" data-from="0" data-is_biz_ban="0"></mp-common-profile></section><h3 data-tool="mdnice编辑器"><span></span><span><span></span>加载R包</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code><span>library</span>(ggvenn)<br><span>library</span>(tidyverse)<br><span>library</span>(ggtext)<br><span>library</span>(magrittr)<br><span>library</span>(ggpubr)<br><span>library</span>(cowplot)<br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span><span></span>导入数据</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code>A &lt;- read_tsv(<span>"diff.txt"</span>,col_names = F)<br>B &lt;- read_tsv(<span>"OS.txt"</span>,col_names = F)<br>C &lt;- read_tsv(<span>"WGCNA.txt"</span>,col_names = F)<br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span><span></span>绘制韦恩图</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code>p1 &lt;- list(A=A$X1,B=B$X1,C=C$X1) %&gt;% <br>  ggvenn(show_percentage = <span>T</span>,show_elements = <span>F</span>,label_sep = <span>","</span>,<br>         digits = <span>1</span>,stroke_color = <span>"white"</span>,<br>         fill_color = c(<span>"#1E90FF"</span>, <span>"#FF8C00"</span>,<span>"#4DAF4A"</span>),<br>         set_name_color = c(<span>"#1E90FF"</span>,<span>"#FF8C00"</span>,<span>"#4DAF4A"</span>))<br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span><span></span>构建函数提取交并集</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code><span># 使用Reduce函数来计算列表中所有向量的交集</span><br>Intersect &lt;- <span>function</span>(x) {<br>  Reduce(intersect, x)<br>}<br><br><span># 使用Reduce函数来计算列表中所有向量的并集</span><br>Union &lt;- <span>function</span>(x) {<br>  Reduce(union, x)<br>}<br><br><span># 计算两个列表的差集</span><br>diff &lt;- <span>function</span>(x, y) {<br>  xx &lt;- Intersect(x)<br>  yy &lt;- Union(y)<br>  setdiff(xx, yy)<br>}<br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span><span></span>提取交集</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code>xx &lt;- list(A=A$X1,B=B$X1,C=C$X1)<br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span><span></span>拼图</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code>p2 &lt;- Intersect(xx) %&gt;% as.data.frame() %&gt;% set_colnames(<span>"hub-gene"</span>) %&gt;% <br>  ggtexttable(rows = <span>NULL</span>, theme = ttheme(<span>"lBlueWhite"</span>))<br><br>p1 %&gt;% ggdraw() + draw_plot(p2,scale=<span>0.008</span>,x=<span>0.62</span>,y=<span>0.27</span>,width=<span>0.5</span>,height=<span>0.1</span>)<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="1.2132505175983437" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZ7jmBldicBLDw3cHVcJXd2xzoL4IPGdpoE46kiaedmmWllkiaiaMKk7RicUrbsxk0xc3BCPh6MCcEM0JA/640?wx_fmt=png" data-type="png" data-w="966" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZ7jmBldicBLDw3cHVcJXd2xzoL4IPGdpoE46kiaedmmWllkiaiaMKk7RicUrbsxk0xc3BCPh6MCcEM0JA/640?wx_fmt=png"></figure><blockquote data-tool="mdnice编辑器"><span>❝</span><p>本节内容介绍到此结束，过程仅供参考；有需要学习个性化数据可视化的朋友，欢迎到小编的<strong>「淘宝店铺」</strong> <strong>「R语言数据分析指南」</strong>购买<strong>「2023年度会员文档」</strong>同步更新中<strong>「售价149元」</strong>，内容主要包括各种<strong>「高分论文的图表分析复现以及一些个性化图表的绘制」</strong>均包含数据+代码；按照往年数据小编年产出约在150+以上</p><span>❞</span></blockquote><p data-tool="mdnice编辑器">购买后微信发小编订单截图即邀请进新的会员交流群，小编的文档为按年售卖，只包含当年度的<strong>「除系列课程外」</strong>的文档，有需要往年文档的朋友也可下单购买，需要了解更多信息的朋友欢迎淘宝店铺交流咨询。</p><h3 data-tool="mdnice编辑器"><span></span><span><span></span>淘宝店铺(淘宝扫一扫)</span><span></span></h3><p><img data-galleryid="" data-ratio="1.0210420841683367" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/EibnicgwScTAbvhPDLGT8NaialEsht92PTYNJWpmVLfoYGic1uha5FyBrDCibibZCLjiazgvpT1XcdwibfVywD2el0VAgg/640?wx_fmt=jpeg" data-type="jpeg" data-w="998" src="https://mmbiz.qpic.cn/mmbiz_jpg/EibnicgwScTAbvhPDLGT8NaialEsht92PTYNJWpmVLfoYGic1uha5FyBrDCibibZCLjiazgvpT1XcdwibfVywD2el0VAgg/640?wx_fmt=jpeg"></p><h3 data-tool="mdnice编辑器"><span></span><span><span></span>2023会员群案例展示</span><span></span></h3><p data-tool="mdnice编辑器"><img data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZ7jmBldicBLDw3cHVcJXd2xozzdWxaWQl6icLesVsD9ONt7uXB1lM59QUEHtiaLQlxBOrHRF3j8xfGg/640?wx_fmt=png" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZ7jmBldicBLDw3cHVcJXd2xozzdWxaWQl6icLesVsD9ONt7uXB1lM59QUEHtiaLQlxBOrHRF3j8xfGg/640?wx_fmt=png"><img data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZ7jmBldicBLDw3cHVcJXd2xAZcVgAeIPk8yNEc4E68XZZGNnThaWtyg11fwwj4eWicAu1RHoZVhyjQ/640?wx_fmt=png" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZ7jmBldicBLDw3cHVcJXd2xAZcVgAeIPk8yNEc4E68XZZGNnThaWtyg11fwwj4eWicAu1RHoZVhyjQ/640?wx_fmt=png"><img data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZ7jmBldicBLDw3cHVcJXd2xaIJyGAszHlG3VgVTJNLLzLvbXv8dicJ43CA7ibfhgsB1j3ytwLzibibxAw/640?wx_fmt=png" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZ7jmBldicBLDw3cHVcJXd2xaIJyGAszHlG3VgVTJNLLzLvbXv8dicJ43CA7ibfhgsB1j3ytwLzibibxAw/640?wx_fmt=png"><img data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZ7jmBldicBLDw3cHVcJXd2xeDP9MCuznKzqdO6cSXw14F9xxnzyQuePfVWVupM8NCECib1Z9yHiarLg/640?wx_fmt=png" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZ7jmBldicBLDw3cHVcJXd2xeDP9MCuznKzqdO6cSXw14F9xxnzyQuePfVWVupM8NCECib1Z9yHiarLg/640?wx_fmt=png"><img data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZ7jmBldicBLDw3cHVcJXd2xeMd4QxF9HHjyRDBbsARIic0zakaP63ZvVfDuMPCfW9jrAHQ1Aibfwt0g/640?wx_fmt=png" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZ7jmBldicBLDw3cHVcJXd2xeMd4QxF9HHjyRDBbsARIic0zakaP63ZvVfDuMPCfW9jrAHQ1Aibfwt0g/640?wx_fmt=png"><img data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZ7jmBldicBLDw3cHVcJXd2xVxd33VdGs8mCseDlaxrmsNMlyUnebXKf7aB3ktfjlshPXkyStmptOg/640?wx_fmt=png" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZ7jmBldicBLDw3cHVcJXd2xVxd33VdGs8mCseDlaxrmsNMlyUnebXKf7aB3ktfjlshPXkyStmptOg/640?wx_fmt=png"><img data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZ7jmBldicBLDw3cHVcJXd2xTCTBJCc2iaiaDDoRT5ICyvltnBwedNEeXibXNaictyZ3I1hxJiaZLXaicQsw/640?wx_fmt=png" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZ7jmBldicBLDw3cHVcJXd2xTCTBJCc2iaiaDDoRT5ICyvltnBwedNEeXibXNaictyZ3I1hxJiaZLXaicQsw/640?wx_fmt=png"><img data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZ7jmBldicBLDw3cHVcJXd2x8pAibPMoAXcOvKPhCMkup6qBpeMUib5VvJydLVXFfNic91gpywqPrrBzw/640?wx_fmt=png" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZ7jmBldicBLDw3cHVcJXd2x8pAibPMoAXcOvKPhCMkup6qBpeMUib5VvJydLVXFfNic91gpywqPrrBzw/640?wx_fmt=png"><img data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZ7jmBldicBLDw3cHVcJXd2xYHSZRBOnURib13CohELVBQSiaTdT0bFwuBbnpga626wUs74DU0rZWq5Q/640?wx_fmt=png" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZ7jmBldicBLDw3cHVcJXd2xYHSZRBOnURib13CohELVBQSiaTdT0bFwuBbnpga626wUs74DU0rZWq5Q/640?wx_fmt=png"></p></section><p><br></p><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/F-2NT6-2jcC5v4a15Ocf8Q",target="_blank" rel="noopener noreferrer">原文链接</a>
