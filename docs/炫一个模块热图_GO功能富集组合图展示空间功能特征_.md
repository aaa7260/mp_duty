---
title: "炫一个模块热图+GO功能富集组合图展示空间功能特征！"
date: 2022-12-10T14:55:16Z
draft: ["false"]
tags: [
  "fetched",
  "SCIPainter"
]
categories: ["Acdemic"]
---
炫一个模块热图+GO功能富集组合图展示空间功能特征！ by SCIPainter
------
<div><section data-mpa-powered-by="yiban.io"><span>不难发现，高分文献中图表的美观性及创新度都会有大幅度的提升，组合类图表的形式也非常多样，一张图中往往涵盖大量message。</span></section><section><span><br></span></section><section><span>今天就来一个组合型图表的复现，为大家增加几分绘图的灵感，复现图如下：</span></section><section><span><br></span></section><section><img data-ratio="0.8537020517395183" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6krZxnsyViaTgc9YqVMMicLdahlI0JXTYaTUr6VO5HictnwlXoEp7UFEUGriaLpsUHw2BK4g2maQrBZ9A/640?wx_fmt=png" data-type="png" data-w="1121" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6krZxnsyViaTgc9YqVMMicLdahlI0JXTYaTUr6VO5HictnwlXoEp7UFEUGriaLpsUHw2BK4g2maQrBZ9A/640?wx_fmt=png"></section><section><span>（<em>Nat Commun</em>，2022）</span></section><section><span><br></span></section><section><span>该组合图为HCA分层聚类与GO功能富集结果的组合展示，确定了六个表征具有不同功能的皮肤层的特异性蛋白质模块的表达趋势、丰度及每个模块间的功能差异。</span></section><section><span></span></section><section><span></span></section><section><span></span></section><section><span><br></span></section><section><span>今天就来完整复现一波！用到</span><span><strong>Rstudio</strong></span><span>与</span><span><strong>AI（Adobe Illustrator）</strong></span><span>。想要跟着实操的朋友可点击文末</span><span>“阅读原文”</span><span>下载范例数据。</span></section><section><span><br></span></section><section><span>注：本文不含分析，仅下游绘图复现。</span></section><section><br></section><section><span>下面就开始今天的学习！</span></section><section><br mpa-from-tpl="t"></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>#载入绘制所需R包：</span><br mpa-from-tpl="t"><span>library</span>(pheatmap) <span>#画热图</span><br mpa-from-tpl="t"><span>library</span>(tidyverse) <span>#数据清洗，长宽数据转换</span><br mpa-from-tpl="t"><span>library</span>(ggplot2) <span>#绘图</span><br mpa-from-tpl="t"><span>library</span>(ggforce) <span>#使用到一个主题（theme_no_axes），仅为了偷懒</span><br mpa-from-tpl="t"><span>library</span>(patchwork) <span>#拼图</span><br mpa-from-tpl="t"><span>#载入绘图测试数据（源自文献源数据）</span><br mpa-from-tpl="t"><span>df</span> &lt;- read.csv('matixdt.csv',header = T,row.names = 1)<br mpa-from-tpl="t"><span>df</span>[1:6,1:6]</code></pre></section><p><br mpa-from-tpl="t"></p><section><span></span></section><section><img data-ratio="0.24254881808838644" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6krZxnsyViaTgc9YqVMMicLdaicQj7LtPibJicOTiaiaG5cOJmEcSw53fIw4G96hOREBLgWT6X0RwYKbBMQg/640?wx_fmt=png" data-type="png" data-w="973" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6krZxnsyViaTgc9YqVMMicLdaicQj7LtPibJicOTiaiaG5cOJmEcSw53fIw4G96hOREBLgWT6X0RwYKbBMQg/640?wx_fmt=png"></section><section><br></section><section><span>测试数据为一个丰度表达矩阵，已作聚类和归一化处理，可直接绘图；第一列为各模块对应高表达gene_symbol分组信息。</span></section><section><br></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>dt</span> &lt;- df[,-1]<br mpa-from-tpl="t"><span>dt</span>[1:6,1:6] <span>#先去掉第一列，新矩阵用于绘制热图</span></code></pre></section><p><br mpa-from-tpl="t"></p><section><span></span></section><section><img data-ratio="0.24254881808838644" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6krZxnsyViaTgc9YqVMMicLdat2dPfRpwyh1jcsObZOthBM9H1icHFwQarrj5qt3sZJ3CkiaZOkh84rjg/640?wx_fmt=png" data-type="png" data-w="973" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6krZxnsyViaTgc9YqVMMicLdat2dPfRpwyh1jcsObZOthBM9H1icHFwQarrj5qt3sZJ3CkiaZOkh84rjg/640?wx_fmt=png"></section><section><br></section><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><img data-ratio="1.3413462" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6krZxnsyViaTgc9YqVMMicLdaVwfEXicFYqzUUr7KicibFOcm0xqqGNC2BBduXNYgZdS9oy4l39Z6EIrbw/640?wx_fmt=png" data-type="png" data-w="416" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6krZxnsyViaTgc9YqVMMicLdaVwfEXicFYqzUUr7KicibFOcm0xqqGNC2BBduXNYgZdS9oy4l39Z6EIrbw/640?wx_fmt=png"></section></section></section></section></section><section><section powered-by="xiumi.us"><section><svg viewbox="0 0 1 1"></svg></section></section><section powered-by="xiumi.us"><section><p><strong>1. 模块热图绘制 </strong></p></section></section></section></section></section></section></section><section><br></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>#自定义配色：</span><br mpa-from-tpl="t"><span>mycol</span> &lt;- colorRampPalette(c(<span>"#2872d1"</span>, <span>"white"</span>, <span>"#ff0d0d"</span>))(50)<br mpa-from-tpl="t"><span>#热图绘制：</span><br mpa-from-tpl="t"><span>pheatmap</span>(<br mpa-from-tpl="t"><span>dt</span>,<br mpa-from-tpl="t"><span>scale</span> = 'none', <span>#不作归一化处理</span><br mpa-from-tpl="t"><span>cluster_rows</span> = F, <span>#不对行聚类</span><br mpa-from-tpl="t"><span>cluster_cols</span> = F, <span>#不对列聚类</span><br mpa-from-tpl="t"><span>color</span> = mycol<br mpa-from-tpl="t">)</code></pre></section><p><br mpa-from-tpl="t"></p><section><span></span></section><section><img data-ratio="1.334836527621195" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6krZxnsyViaTgc9YqVMMicLdanjDxhNiatedr3fWOJ194lYeHsk8QrA1zbVKeBEu7dyLNvCJQjfyracw/640?wx_fmt=png" data-type="png" data-w="887" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6krZxnsyViaTgc9YqVMMicLdanjDxhNiatedr3fWOJ194lYeHsk8QrA1zbVKeBEu7dyLNvCJQjfyracw/640?wx_fmt=png"></section><section><br mpa-from-tpl="t"></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>#去掉行/列名：</span><br mpa-from-tpl="t"><span>pheatmap</span>(<br mpa-from-tpl="t"><span>dt</span>,<br mpa-from-tpl="t"><span>scale</span> = 'none',<br mpa-from-tpl="t"><span>cluster_rows</span> = F,<br mpa-from-tpl="t"><span>cluster_cols</span> = F,<br mpa-from-tpl="t"><span>color</span> = mycol,<br mpa-from-tpl="t"><span>show_rownames</span> = F, <span>#去掉行名</span><br mpa-from-tpl="t"><span>show_colnames</span> = F <span>#去掉列名</span><br mpa-from-tpl="t">)</code></pre></section><p><br mpa-from-tpl="t"></p><section><span></span></section><section><img data-ratio="1.334836527621195" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6krZxnsyViaTgc9YqVMMicLdaFlXxJ2iasSchRk1LPcibHVruZgygkwJUmgNd6NkrGqicFxGKc04onMibicA/640?wx_fmt=png" data-type="png" data-w="887" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6krZxnsyViaTgc9YqVMMicLdaFlXxJ2iasSchRk1LPcibHVruZgygkwJUmgNd6NkrGqicFxGKc04onMibicA/640?wx_fmt=png"></section><section><br mpa-from-tpl="t"></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>#添加分组信息与分组颜色：</span><br mpa-from-tpl="t"><span>group</span> &lt;- data.frame(type = c(rep(<span>"SC"</span>,4), rep(<span>"GS"</span>,4), rep(<span>"BL"</span>,3),rep(<span>"BM"</span>,5),rep(<span>"SD"</span>,4),rep(<span>"DD"</span>,4)))<br mpa-from-tpl="t"><span>rownames</span>(group) &lt;- colnames(dt)<br mpa-from-tpl="t"><span>group_colors</span> &lt;- list(type = c(SC = <span>"#fd807b"</span>,<br mpa-from-tpl="t"><span>GS</span> = <span>"#c2534d"</span>,<br mpa-from-tpl="t"><span>BL</span> = <span>"#febe02"</span>,<br mpa-from-tpl="t"><span>BM</span> = <span>"#f39846"</span>,<br mpa-from-tpl="t"><span>SD</span> = <span>"#0bb5f0"</span>,<br mpa-from-tpl="t"><span>DD</span> = <span>"#6e329e"</span>))<br mpa-from-tpl="t"><span>head</span>(group)<br mpa-from-tpl="t"><span>group_colors</span></code></pre></section><p><br mpa-from-tpl="t"></p><section><span></span></section><section><img data-ratio="0.38764044943820225" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6krZxnsyViaTgc9YqVMMicLdalRiaMOE7qLaykbl83E7ia7MvmCjChRg8hnunEEVvMxl5L3ibw9JgBLlBA/640?wx_fmt=png" data-type="png" data-w="890" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6krZxnsyViaTgc9YqVMMicLdalRiaMOE7qLaykbl83E7ia7MvmCjChRg8hnunEEVvMxl5L3ibw9JgBLlBA/640?wx_fmt=png"></section><section><br mpa-from-tpl="t"></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>#绘制分组热图：</span><br mpa-from-tpl="t"><span>pheatmap</span>(<br mpa-from-tpl="t"><span>dt</span>,<br mpa-from-tpl="t"><span>scale</span> = 'none',<br mpa-from-tpl="t"><span>cluster_rows</span> = F,<br mpa-from-tpl="t"><span>cluster_cols</span> = F,<br mpa-from-tpl="t"><span>color</span> = mycol,<br mpa-from-tpl="t"><span>show_rownames</span> = F,<br mpa-from-tpl="t"><span>show_colnames</span> = F,<br mpa-from-tpl="t"><span>annotation_col</span> = group, <span>#分组信息</span><br mpa-from-tpl="t"><span>annotation_color</span> = group_colors <span>#分组颜色</span><br mpa-from-tpl="t">)</code></pre></section><p><br mpa-from-tpl="t"></p><section><span></span></section><section><img data-ratio="1.334836527621195" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6krZxnsyViaTgc9YqVMMicLdaGjMiajDx7fHDOf7NwM51InoTicA74I1qs381oS1DfBtu71AAYexwhV9Q/640?wx_fmt=png" data-type="png" data-w="887" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6krZxnsyViaTgc9YqVMMicLdaGjMiajDx7fHDOf7NwM51InoTicA74I1qs381oS1DfBtu71AAYexwhV9Q/640?wx_fmt=png"></section><section><br></section><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><img data-ratio="1.3413462" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6krZxnsyViaTgc9YqVMMicLdaVwfEXicFYqzUUr7KicibFOcm0xqqGNC2BBduXNYgZdS9oy4l39Z6EIrbw/640?wx_fmt=png" data-type="png" data-w="416" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6krZxnsyViaTgc9YqVMMicLdaVwfEXicFYqzUUr7KicibFOcm0xqqGNC2BBduXNYgZdS9oy4l39Z6EIrbw/640?wx_fmt=png"></section></section></section></section></section><section><section powered-by="xiumi.us"><section><svg viewbox="0 0 1 1"></svg></section></section><section powered-by="xiumi.us"><section><p><strong>2. 模块趋势折线图绘制 </strong></p></section></section></section></section></section></section></section><section><br></section><section><span>现在我们根据模块分组信息，用折线图展示各模块中高表达gene的表达趋势。使用ggplot2画图，开始前需要先做一个模块子集提取与长宽数据的转换。</span></section><section><br mpa-from-tpl="t"></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>##以Module1为例：</span><br mpa-from-tpl="t"><span>Module1</span> &lt;- dt[df$High_expressed_layer==<span>"SC"</span>,]<br mpa-from-tpl="t"><span>#转换为ggplot2长数据格式：</span><br mpa-from-tpl="t"><span>Module11</span> &lt;- Module1 %&gt;% t() %&gt;% as.data.frame() %&gt;%<br mpa-from-tpl="t"><span>rownames_to_column</span>(<span>"sample"</span>) %&gt;%<br mpa-from-tpl="t"><span>gather</span>(key = gene_symbol,<br mpa-from-tpl="t"><span>value</span> = value, -sample)<br mpa-from-tpl="t"><span>head</span>(Module11)</code></pre></section><p><br mpa-from-tpl="t"></p><section><span></span></section><section><img data-ratio="0.3179347826086957" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6krZxnsyViaTgc9YqVMMicLdahcViaPgkwck4UakaqIB05ZLjzkBMQO9QQW1pYjiaw2gvULibVM8RBVUrg/640?wx_fmt=png" data-type="png" data-w="736" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6krZxnsyViaTgc9YqVMMicLdahcViaPgkwck4UakaqIB05ZLjzkBMQO9QQW1pYjiaw2gvULibVM8RBVUrg/640?wx_fmt=png"></section><section><br mpa-from-tpl="t"></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>#转换为因子：</span><br mpa-from-tpl="t"><span>Module11</span>$sample &lt;- factor(Module11$sample, unique(Module11$sample))<br mpa-from-tpl="t"><span>#趋势折线图绘制：</span><br mpa-from-tpl="t"><span>p1</span> &lt;- ggplot(Module11, aes(x = sample, y = value, group = gene_symbol)) +<br mpa-from-tpl="t"><span>geom_line</span>(color = <span>"grey"</span>) +<br mpa-from-tpl="t"><span>theme_no_axes</span>()<span>#来自ggforce包中的一个除了个框其它啥都没的主题样式，方便我们后期在AI中做其它的添加。</span><br mpa-from-tpl="t"><span>p1</span></code></pre></section><p><br mpa-from-tpl="t"></p><section><span></span></section><section><img data-ratio="0.747244094488189" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6krZxnsyViaTgc9YqVMMicLdaCz7kT0ibjDxXEP5sqmOnkF3sllA64eelegN6fXJ5HU1uad4AEZDecAQ/640?wx_fmt=png" data-type="png" data-w="1270" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6krZxnsyViaTgc9YqVMMicLdaCz7kT0ibjDxXEP5sqmOnkF3sllA64eelegN6fXJ5HU1uad4AEZDecAQ/640?wx_fmt=png"></section><section><br mpa-from-tpl="t"></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>#其它几个模块绘制方法一致：</span><br mpa-from-tpl="t"><span>##Module2：</span><br mpa-from-tpl="t"><span>Module2</span> &lt;- dt[df$High_expressed_layer==<span>"GC"</span>,]<br mpa-from-tpl="t"><span>Module22</span> &lt;- Module2 %&gt;% t() %&gt;% as.data.frame() %&gt;%<br mpa-from-tpl="t"><span>rownames_to_column</span>(<span>"sample"</span>) %&gt;%<br mpa-from-tpl="t"><span>gather</span>(key = gene_symbol,<br mpa-from-tpl="t"><span>value</span> = value, -sample)<br mpa-from-tpl="t"><span>Module22</span>$sample &lt;- factor(Module22$sample, unique(Module22$sample))<br mpa-from-tpl="t"><span>p2</span> &lt;- ggplot(Module22, aes(x = sample, y = value, group = gene_symbol)) +<br mpa-from-tpl="t"><span>geom_line</span>(color = <span>"grey"</span>) +<br mpa-from-tpl="t"><span>theme_no_axes</span>()<br mpa-from-tpl="t"><span>p2</span><br mpa-from-tpl="t"><span>##Module3：</span><br mpa-from-tpl="t"><span>Module3</span> &lt;- dt[df$High_expressed_layer==<span>"BL"</span>,]<br mpa-from-tpl="t"><span>Module33</span> &lt;- Module3 %&gt;% t() %&gt;% as.data.frame() %&gt;%<br mpa-from-tpl="t"><span>rownames_to_column</span>(<span>"sample"</span>) %&gt;%<br mpa-from-tpl="t"><span>gather</span>(key = gene_symbol,<br mpa-from-tpl="t"><span>value</span> = value, -sample)<br mpa-from-tpl="t"><span>Module33</span>$sample &lt;- factor(Module33$sample, unique(Module33$sample))<br mpa-from-tpl="t"><span>p3</span> &lt;- ggplot(Module33, aes(x = sample, y = value, group = gene_symbol)) +<br mpa-from-tpl="t"><span>geom_line</span>(color = <span>"grey"</span>) +<br mpa-from-tpl="t"><span>theme_no_axes</span>()<br mpa-from-tpl="t"><span>p3</span><br mpa-from-tpl="t"><span>##Module4：</span><br mpa-from-tpl="t"><span>Module4</span> &lt;- dt[df$High_expressed_layer==<span>"BM"</span>,]<br mpa-from-tpl="t"><span>Module44</span> &lt;- Module4 %&gt;% t() %&gt;% as.data.frame() %&gt;%<br mpa-from-tpl="t"><span>rownames_to_column</span>(<span>"sample"</span>) %&gt;%<br mpa-from-tpl="t"><span>gather</span>(key = gene_symbol,<br mpa-from-tpl="t"><span>value</span> = value, -sample)<br mpa-from-tpl="t"><span>Module44</span>$sample &lt;- factor(Module44$sample, unique(Module44$sample))<br mpa-from-tpl="t"><span>p4</span> &lt;- ggplot(Module44, aes(x = sample, y = value, group = gene_symbol)) +<br mpa-from-tpl="t"><span>geom_line</span>(color = <span>"grey"</span>) +<br mpa-from-tpl="t"><span>theme_no_axes</span>()<br mpa-from-tpl="t"><span>p4</span><br mpa-from-tpl="t"><span>##Module5：</span><br mpa-from-tpl="t"><span>Module5</span> &lt;- dt[df$High_expressed_layer==<span>"SD"</span>,]<br mpa-from-tpl="t"><span>Module55</span> &lt;- Module5 %&gt;% t() %&gt;% as.data.frame() %&gt;%<br mpa-from-tpl="t"><span>rownames_to_column</span>(<span>"sample"</span>) %&gt;%<br mpa-from-tpl="t"><span>gather</span>(key = gene_symbol,<br mpa-from-tpl="t"><span>value</span> = value, -sample)<br mpa-from-tpl="t"><span>Module55</span>$sample &lt;- factor(Module55$sample, unique(Module55$sample))<br mpa-from-tpl="t"><span>p5</span> &lt;- ggplot(Module55, aes(x = sample, y = value, group = gene_symbol)) +<br mpa-from-tpl="t"><span>geom_line</span>(color = <span>"grey"</span>) +<br mpa-from-tpl="t"><span>theme_no_axes</span>()<br mpa-from-tpl="t"><span>p5</span><br mpa-from-tpl="t"><span>##Module6：</span><br mpa-from-tpl="t"><span>Module6</span> &lt;- dt[df$High_expressed_layer==<span>"DD"</span>,]<br mpa-from-tpl="t"><span>Module66</span> &lt;- Module6 %&gt;% t() %&gt;% as.data.frame() %&gt;%<br mpa-from-tpl="t"><span>rownames_to_column</span>(<span>"sample"</span>) %&gt;%<br mpa-from-tpl="t"><span>gather</span>(key = gene_symbol,<br mpa-from-tpl="t"><span>value</span> = value, -sample)<br mpa-from-tpl="t"><span>Module66</span>$sample &lt;- factor(Module66$sample, unique(Module66$sample))<br mpa-from-tpl="t"><span>p6</span> &lt;- ggplot(Module66, aes(x = sample, y = value, group = gene_symbol)) +<br mpa-from-tpl="t"><span>geom_line</span>(color = <span>"grey"</span>) +<br mpa-from-tpl="t"><span>theme_no_axes</span>()<br mpa-from-tpl="t"><span>p6</span><br mpa-from-tpl="t"><span>#patchwork纵向拼图，一行一个图：</span><br mpa-from-tpl="t"><span>p1</span>/p2/p3/p4/p5/p6</code></pre></section><p><br mpa-from-tpl="t"></p><section><span></span></section><section><img data-ratio="4.0899653979238755" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6krZxnsyViaTgc9YqVMMicLdao1FoWzC9kJRyWfqb1gqgbeoJIPQV4YvQFib0dtraFA6UWlzrSWxiaCgg/640?wx_fmt=png" data-type="png" data-w="289" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6krZxnsyViaTgc9YqVMMicLdao1FoWzC9kJRyWfqb1gqgbeoJIPQV4YvQFib0dtraFA6UWlzrSWxiaCgg/640?wx_fmt=png"></section><section><br></section><section><span>热图和折线图保存矢量格式到本地，R语言的部分到此结束。</span></section><section><span><br></span></section><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><img data-ratio="1.3413462" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6krZxnsyViaTgc9YqVMMicLdaVwfEXicFYqzUUr7KicibFOcm0xqqGNC2BBduXNYgZdS9oy4l39Z6EIrbw/640?wx_fmt=png" data-type="png" data-w="416" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6krZxnsyViaTgc9YqVMMicLdaVwfEXicFYqzUUr7KicibFOcm0xqqGNC2BBduXNYgZdS9oy4l39Z6EIrbw/640?wx_fmt=png"></section></section></section></section></section><section><section powered-by="xiumi.us"><section><svg viewbox="0 0 1 1"></svg></section></section><section powered-by="xiumi.us"><section><p><strong>3. AI美化与内容添加 </strong></p></section></section></section></section></section></section></section><section><br></section><section><span>新建一个A4横向画板，菜单栏点击</span><span>文件—置入</span><span>将上一步保存的两张矢量图表导入到画板中。</span></section><section><span><br></span></section><section><img data-ratio="0.6938325991189427" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6krZxnsyViaTgc9YqVMMicLdaAmLorMuyRujg3WVhZVTS2iaORZIn0tJG9aVIg4PqpYoQy4BMY2Dfxlg/640?wx_fmt=png" data-type="png" data-w="1816" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6krZxnsyViaTgc9YqVMMicLdaAmLorMuyRujg3WVhZVTS2iaORZIn0tJG9aVIg4PqpYoQy4BMY2Dfxlg/640?wx_fmt=png"></section><section><span><br></span></section><section><span>使用</span><span>选择工具</span><span>对图表进行等比例缩放（长按住Shift键），让两张图表大致对齐。</span></section><section><span><br></span></section><section><img data-ratio="0.694006309148265" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6krZxnsyViaTgc9YqVMMicLdarybayUsS88qEoLXujyPPyR2vu4PJPvBlEvydpuHnSu4DBL5YnbM1wA/640?wx_fmt=png" data-type="png" data-w="1268" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6krZxnsyViaTgc9YqVMMicLdarybayUsS88qEoLXujyPPyR2vu4PJPvBlEvydpuHnSu4DBL5YnbM1wA/640?wx_fmt=png"></section><section><span><br></span></section><section><span>使用</span><span>文字工具</span><span>添加每个模块的GO功能富集信息，现在该组合图所需的全部内容已准备完毕。下面进入美化和细节调整。</span></section><section><span><br></span></section><section><img data-ratio="0.694006309148265" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6krZxnsyViaTgc9YqVMMicLdaZOBkQUX9zQnd6dfQdNl4EV6syJSCx0zRFNdvtcgHgQWj7GvoNWoucg/640?wx_fmt=png" data-type="png" data-w="1268" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6krZxnsyViaTgc9YqVMMicLdaZOBkQUX9zQnd6dfQdNl4EV6syJSCx0zRFNdvtcgHgQWj7GvoNWoucg/640?wx_fmt=png"></section><section><br></section><section><span>首先对热图进行美化与调整。删掉原本在右侧的纵向图例和分组信息，使用</span><span>矩形工具</span><span>结合</span><span>渐变色填充</span><span>制作横向新图例，再使用</span><span>文字工具</span><span>添加图例和分组的文字信息到对应位置。</span></section><section><span><br></span></section><section><img data-ratio="0.694006309148265" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6krZxnsyViaTgc9YqVMMicLdam2DhVSJBC11ZX8dBDl9VQUuPsMlsAGccic6BugMlUvfuWpibluYFQxqQ/640?wx_fmt=png" data-type="png" data-w="1268" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6krZxnsyViaTgc9YqVMMicLdam2DhVSJBC11ZX8dBDl9VQUuPsMlsAGccic6BugMlUvfuWpibluYFQxqQ/640?wx_fmt=png"></section><section><span><br></span></section><section><span>使用图形工具组中的</span><span>矩形工具</span><span>绘制矩形框，以圈注模块，可在菜单栏下方</span><span>描边</span><span>选项中调整线条粗细；把描边颜色和分组颜色对应，最后再用</span><span>文字工具</span><span>添加Module标签，热图的美化完成！</span></section><section><span><br></span></section><section><img data-ratio="0.694006309148265" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6krZxnsyViaTgc9YqVMMicLdaYafXic97jevkNPOm314cpu1grMb4KpZxUo4a9q2ysnHbJDr5nZcSerw/640?wx_fmt=png" data-type="png" data-w="1268" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6krZxnsyViaTgc9YqVMMicLdaYafXic97jevkNPOm314cpu1grMb4KpZxUo4a9q2ysnHbJDr5nZcSerw/640?wx_fmt=png"></section><section><span><br></span></section><section><span>下面开始GO富集信息的美化。首先是颜色的调整，把每个模块的文字颜色更改为和分组一致，可使用</span><span>吸管工具</span><span>快速吸取。其次，可以在菜单栏下方的</span><span>字符</span><span>属性面板中进行字体、字号等文字属性的更改。</span></section><section><span><br></span></section><section><img data-ratio="0.694006309148265" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6krZxnsyViaTgc9YqVMMicLdaXVT2Epew2ZTKzzIL02UiaY8M7ePSwMMdbHqUgm89BjekqrZNiaEYNEZw/640?wx_fmt=png" data-type="png" data-w="1268" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6krZxnsyViaTgc9YqVMMicLdaXVT2Epew2ZTKzzIL02UiaY8M7ePSwMMdbHqUgm89BjekqrZNiaEYNEZw/640?wx_fmt=png"></section><section><br></section><section><span>使用</span><span>直线工具</span><span>加上Module分隔线，</span><span>文字工具</span><span>添加Module注释，富集信息的美化完成！</span></section><section><span><br></span></section><section><img data-ratio="0.694006309148265" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6krZxnsyViaTgc9YqVMMicLda1GNGe3icCeR8GkjVRNCTYMibFm16ficIicq9nnNyqKwKiaUJHnTYXFrvQNg/640?wx_fmt=png" data-type="png" data-w="1268" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6krZxnsyViaTgc9YqVMMicLda1GNGe3icCeR8GkjVRNCTYMibFm16ficIicq9nnNyqKwKiaUJHnTYXFrvQNg/640?wx_fmt=png"></section><section><br></section><section><span>最后对折线图进行调整和美化。先使用</span><span>直接选择工具</span><span>，点击框内空白处，一直Delete（存在无用的空剪切蒙版，会影响操作，建议先删掉），直到点击空白处不会出现新选区即可。</span></section><section><span><br></span></section><section><img data-ratio="0.694006309148265" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6krZxnsyViaTgc9YqVMMicLdal1c9AB9Gq3nOD9RLv4PicqkWngSDjbgvKicbaJA5mjwJRvzONHz2oxhQ/640?wx_fmt=png" data-type="png" data-w="1268" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6krZxnsyViaTgc9YqVMMicLdal1c9AB9Gq3nOD9RLv4PicqkWngSDjbgvKicbaJA5mjwJRvzONHz2oxhQ/640?wx_fmt=png"></section><section><br></section><section><span>继续使用</span><span>直接选择工具</span><span>，按住Shift将全部折线同时选中后，再切换到</span><span>选择工具</span><span>，对全部折线图进行适当缩小，给左侧留出一定空隙。如果折线觉得较粗，可以在右侧</span><span>描边属性面板</span><span>中进行线条粗细的调整。</span></section><section><span><br></span></section><section><img data-ratio="0.694006309148265" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6krZxnsyViaTgc9YqVMMicLdaWtGv8nd22et4lhNKWMz9WsUCDUm3jEaHNvZOLBzk3lxqVdAv4niaByw/640?wx_fmt=png" data-type="png" data-w="1268" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6krZxnsyViaTgc9YqVMMicLdaWtGv8nd22et4lhNKWMz9WsUCDUm3jEaHNvZOLBzk3lxqVdAv4niaByw/640?wx_fmt=png"></section><section><br></section><section><span>使用</span><span>矩形网格工具</span><span>绘制左侧的矩形网格框，先双击该工具展开选项面板，将水平分隔线设置为5，垂直分隔线设置为0，然后直接在想要放置网格的位置上拖拽画出即可。</span></section><section><span><br></span></section><section><img data-ratio="0.694006309148265" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6krZxnsyViaTgc9YqVMMicLdajTMmQ9VrdperZIGtYJ6VCM7FQ5Fh7T6KuPC4VbY7Qf55OwBdEc5iaMw/640?wx_fmt=png" data-type="png" data-w="1268" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6krZxnsyViaTgc9YqVMMicLdajTMmQ9VrdperZIGtYJ6VCM7FQ5Fh7T6KuPC4VbY7Qf55OwBdEc5iaMw/640?wx_fmt=png"></section><section><br></section><section><span>使用</span><span>文字工具</span><span>添加单个模块框中所需的全部文本信息。使用</span><span>选择工具</span><span>全部选中后，按住Alt+Shift键拖拽复制到每个组，然后再修改不同的文字部分即可。</span></section><section><span><br></span></section><section><img data-ratio="0.694006309148265" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6krZxnsyViaTgc9YqVMMicLdaEORJibDBcEibQoajvDiaMH2qV9ZicCSXuG1mDDCmciaSPwUCP5PlBia9LyOA/640?wx_fmt=png" data-type="png" data-w="1268" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6krZxnsyViaTgc9YqVMMicLdaEORJibDBcEibQoajvDiaMH2qV9ZicCSXuG1mDDCmciaSPwUCP5PlBia9LyOA/640?wx_fmt=png"></section><section><br></section><section><span>如果需要加粗，可以在字符属性面板中选择Bold。</span></section><section><span><br></span></section><section><img data-ratio="0.694006309148265" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6krZxnsyViaTgc9YqVMMicLdamlpOtD6GVndib4Vd9lls48EgBiby1q1HjIibF3dHQbm7PtPeFJL7HV0Kw/640?wx_fmt=png" data-type="png" data-w="1268" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6krZxnsyViaTgc9YqVMMicLdamlpOtD6GVndib4Vd9lls48EgBiby1q1HjIibF3dHQbm7PtPeFJL7HV0Kw/640?wx_fmt=png"></section><section><br></section><section><span>如果我们想对网格工具绘制出的网格中的单个格子进行填色，需要用到</span><span>实时上色工具</span><span>。选择工具选中该网格后，再选择实时上色工具点击对应格子即可对颜色进行更改。</span></section><section><span><br></span></section><section><img data-ratio="0.694006309148265" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6krZxnsyViaTgc9YqVMMicLdaCGzcDiapKaXNth5V8Kx512eiax4vHkwxIU2cutyMB4iaD3f3KJ6KVQCUg/640?wx_fmt=png" data-type="png" data-w="1268" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6krZxnsyViaTgc9YqVMMicLdaCGzcDiapKaXNth5V8Kx512eiax4vHkwxIU2cutyMB4iaD3f3KJ6KVQCUg/640?wx_fmt=png"></section><section><br></section><section><span>使用</span><span>钢笔工具</span><span>绘制模块趋势折线段，适当加粗，再添加一个红色描边。</span></section><section><span><br></span></section><section><img data-ratio="0.694006309148265" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6krZxnsyViaTgc9YqVMMicLdaUkzVA3vKkibxzNon7fjemaLiajB2OqfIqVFtdduuaibhVmAkpPkE3vaNw/640?wx_fmt=png" data-type="png" data-w="1268" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6krZxnsyViaTgc9YqVMMicLdaUkzVA3vKkibxzNon7fjemaLiajB2OqfIqVFtdduuaibhVmAkpPkE3vaNw/640?wx_fmt=png"></section><section><br></section><section><span>其它模块中绘制方法相同。使用</span><span>钢笔工具</span><span>时，鼠标单击即可拖出辅助线，两点间可连成直线，同时按住Shift键可辅助绘制水平垂直的线条，需要结束时直接Enter即可。</span></section><section><span><br></span></section><section><img data-ratio="0.694006309148265" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6krZxnsyViaTgc9YqVMMicLda3399w3RIyII70J3fJvL8ruRdbJmwTjSMFbDiavxYlE6EmxA0K7RXbvw/640?wx_fmt=png" data-type="png" data-w="1268" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6krZxnsyViaTgc9YqVMMicLda3399w3RIyII70J3fJvL8ruRdbJmwTjSMFbDiavxYlE6EmxA0K7RXbvw/640?wx_fmt=png"></section><section><span><br></span></section><section><span>最终效果如下。</span></section><section><span><br></span></section><section><img data-ratio="0.7227520435967303" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6krZxnsyViaTgc9YqVMMicLdakNrRMmEHGzxN6H7b5KzJQQauERAxadibaQFhgKABF15qib3fsBSwjshw/640?wx_fmt=png" data-type="png" data-w="1468" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6krZxnsyViaTgc9YqVMMicLdakNrRMmEHGzxN6H7b5KzJQQauERAxadibaQFhgKABF15qib3fsBSwjshw/640?wx_fmt=png"></section><section><br></section><section><span>好啦，今天的分享就到这里！</span></section><section><span><br></span></section><section data-role="paragraph"><section><section hm_fix="368:481"><section><img data-ratio="0.8181818181818182" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6kdRWPGPVk0Jicy3oS1NOGPJiaibgVcD3zKfzGGjtvINqicLCPZHmicLKs8bT3f5IiceLBYf6w8sNGqiblnA/640?wx_fmt=png" data-type="png" data-w="44" data-width="100%" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6kdRWPGPVk0Jicy3oS1NOGPJiaibgVcD3zKfzGGjtvINqicLCPZHmicLKs8bT3f5IiceLBYf6w8sNGqiblnA/640?wx_fmt=png"></section><section><section data-brushtype="text"><strong><span>参考文献</span></strong></section><section data-width="100%"><br></section></section></section></section></section><p><span>Li, J., Ma, J., Zhang, Q. et al. Spatially resolved proteomic map shows that extracellular matrix regulates epidermal growth. Nat Commun 13, 4012 </span><span>(2022).</span><br></p><section><span><br></span></section><section><span><strong><span>*未经许可，不得以任何方式复制或抄袭本篇文章之部分或全部内容。版权所有，侵权必究。</span></strong></span></section><section><span><br></span></section><section data-role="outer" label="Powered by 135editor.com"><section data-tools="135编辑器" data-id="105648"><section><section data-role="outer" label="Powered by 135editor.com"><section data-role="paragraph"><section data-role="outer" label="Powered by 135editor.com"><section data-tools="135编辑器" data-id="105648"><section><section><img data-ratio="0.8928571428571429" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6kCKJYcEqEIfoJYG621mPJE8VibmibGU0Jxic9iabARVRH0FT6BNE8VAglWFXBPibFAU7a6tWGibSs8wyUg/640?wx_fmt=png" data-type="png" data-w="41" data-width="100%" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6kCKJYcEqEIfoJYG621mPJE8VibmibGU0Jxic9iabARVRH0FT6BNE8VAglWFXBPibFAU7a6tWGibSs8wyUg/640?wx_fmt=png"></section><section><section><section data-width="35%"><section><section data-width="100%"><img data-ratio="1" data-src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/tgUVxVRjT6kCKJYcEqEIfoJYG621mPJEv5etCBwHicqbEPwnVrkpaasxqaVibM4mT2JdIuN6yTlYWDD4mL5A427A/640?wx_fmt=jpeg" data-type="jpeg" data-w="860" data-width="100%" title="SCIPainter 30cm二维码.jpg" src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/tgUVxVRjT6kCKJYcEqEIfoJYG621mPJEv5etCBwHicqbEPwnVrkpaasxqaVibM4mT2JdIuN6yTlYWDD4mL5A427A/640?wx_fmt=jpeg"></section></section></section><section data-width="50%"><section><section data-brushtype="text"><span><strong># SCIPainter</strong></span></section><section data-brushtype="text" hm_fix="361:593"><p>基迪奥旗下绘图公众号</p><p>分享科研绘图技能与工具</p><p>欢迎关注与转发~</p></section></section></section></section></section></section></section></section></section></section><section><br></section></section></section><section data-role="paragraph"><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><img data-ratio="1" data-src="https://mmbiz.qpic.cn/sz_mmbiz_gif/tgUVxVRjT6kCKJYcEqEIfoJYG621mPJEgMd0aMPtmrDjiaX8sBhfhicVteeHf1JicexSpUbS3fdS9SiboUVN7guaPw/640?wx_fmt=gif" data-type="gif" data-w="400" src="https://mmbiz.qpic.cn/sz_mmbiz_gif/tgUVxVRjT6kCKJYcEqEIfoJYG621mPJEgMd0aMPtmrDjiaX8sBhfhicVteeHf1JicexSpUbS3fdS9SiboUVN7guaPw/640?wx_fmt=gif"></section></section></section><section><section powered-by="xiumi.us"><section><p><span><strong>你的好友拍了拍你</strong></span></p><p><span><strong>并请你帮她点一下</strong></span><strong><span>“分享”</span></strong><span><strong><span>~</span></strong></span></p></section></section></section></section></section><p><br></p></section></section><section><span></span></section><p><mp-style-type data-value="10000"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/ueEwNv79pMmoMAFuA5NZOA",target="_blank" rel="noopener noreferrer">原文链接</a>
