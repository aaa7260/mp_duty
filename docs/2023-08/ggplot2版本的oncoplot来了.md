---
title: "ggplot2版本的oncoplot来了"
date: 2023-08-05T23:22:27Z
draft: ["false"]
tags: [
  "fetched",
  "YuLabSMU"
]
categories: ["Acdemic"]
---
ggplot2版本的oncoplot来了 by YuLabSMU
------
<div><p data-mpa-powered-by="yiban.io"><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzI5NjUyNzkxMg==&amp;mid=2247492813&amp;idx=1&amp;sn=0fa7fbe32f1fb534f226561f03009ca5&amp;chksm=ec40558adb37dc9cc52914436f71d29c50911204b3c672c391cc22367b0ff0425483ec680736&amp;scene=21#wechat_redirect" textvalue="你已选中了添加链接的内容" linktype="text" imgurl="" imgdata="null" tab="innerlink" data-linktype="1"><span><img data-galleryid="" data-ratio="0.7833333333333333" data-s="300,640" data-type="png" data-w="1080" data-src="https://mmbiz.qpic.cn/mmbiz_png/MPBFtnFrw4nWfWpwpWL7MxIgeAdksabc01MWDLPhZsEqWibmCxxj8Ws72SDH3pRMkaK7oC5vVSvAH8pnFWOA2Aw/640?wx_fmt=png" src="https://mmbiz.qpic.cn/mmbiz_png/MPBFtnFrw4nWfWpwpWL7MxIgeAdksabc01MWDLPhZsEqWibmCxxj8Ws72SDH3pRMkaK7oC5vVSvAH8pnFWOA2Aw/640?wx_fmt=png"></span></a></p><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><p data-tool="mdnice编辑器">事情的缘由总要先说一下，正如上图所示（图可点，有链接）。</p></section><p><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzI5NjUyNzkxMg==&amp;mid=2247492861&amp;idx=1&amp;sn=7f9c6e95b1d5ca1f971e4f504ddd6869&amp;chksm=ec4055badb37dcacd1b5722caa9588afe7c9867b0e338f6b02ab384530481f526c2ea973c424&amp;token=643824504&amp;lang=zh_CN&amp;scene=21#wechat_redirect" textvalue="你已选中了添加链接的内容" linktype="text" imgurl="" imgdata="null" tab="innerlink" data-linktype="1"><span><img data-galleryid="" data-ratio="1.1457528957528957" data-s="300,640" data-type="png" data-w="1036" data-src="https://mmbiz.qpic.cn/mmbiz_png/MPBFtnFrw4nWfWpwpWL7MxIgeAdksabcTpXd0oesgKuYwo6tRgokL3L4o5R2MJMCssyMR2U3dytxa5Gg35xCiaA/640?wx_fmt=png" src="https://mmbiz.qpic.cn/mmbiz_png/MPBFtnFrw4nWfWpwpWL7MxIgeAdksabcTpXd0oesgKuYwo6tRgokL3L4o5R2MJMCssyMR2U3dytxa5Gg35xCiaA/640?wx_fmt=png"></span></a></p><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><p data-tool="mdnice编辑器">然后上一次，我们干成了一个事情，就是富集分析的结果，你可以画PPI相互作用网络图了。</p></section><p><span>今天的主角是用aplot来画oncoplot，这个你可以理解成用ggplot2来画子图，然后用aplot来拼。这个事情本来就可以做，但我觉得我不搞个现成的，大家可能不太会。</span></p><p><img data-galleryid="" data-ratio="0.6194444444444445" data-s="300,640" data-type="png" data-w="1080" data-src="https://mmbiz.qpic.cn/mmbiz_png/MPBFtnFrw4nWfWpwpWL7MxIgeAdksabcyJs9xiccEiax1WIMWXlDXlIhxJSZO05tQ9gb16MfBkFsVGed8WbrLpEQ/640?wx_fmt=png" src="https://mmbiz.qpic.cn/mmbiz_png/MPBFtnFrw4nWfWpwpWL7MxIgeAdksabcyJs9xiccEiax1WIMWXlDXlIhxJSZO05tQ9gb16MfBkFsVGed8WbrLpEQ/640?wx_fmt=png"></p><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><p data-tool="mdnice编辑器">为什么要oncoplot，因为它是用base R写的，就是一键出图，然后你啥也干不了了。<strong>所以我想给你自由！</strong></p><p data-tool="mdnice编辑器">再者这个图比较简单，先拿来试水，意思就是<strong>我还想搞更多</strong>，所以欢迎大家来提需求，<strong>我们能行!</strong></p></section><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><p data-tool="mdnice编辑器">这个需求由github用户@lishensuo提供了解决方案，在此代表大家感谢他。一看就是花了时间的，而且条理非常清晰。</p><p data-tool="mdnice编辑器">然后我就基于他/她的代码进行了魔改，基本上就是能重用的代码尽量写了小函数重用了，能够分解的功能尽量分解了。逻辑更简单清晰了。</p><p data-tool="mdnice编辑器">我魔改后就AT了@lishensuo，我相信他/她肯定会花时间去看我的代码，这就算是我给到的指导了，因为他/她写的已经很不错了，所以没有来来回回的互动。</p><p data-tool="mdnice编辑器">然后这些代码就打包进了<code>aplotExtra</code>包了，大家就可以用了。没错，我们有新包<span>aplotExtra</span>，没有Extra附加包的包不是好包。主要是考虑到让<span>aplot</span>保持干净（便于维护，依赖也简单），而且后续我们能搞的复杂图形还会持续增加，于是新包上线。</p><p><img data-galleryid="" data-ratio="0.46378269617706236" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/MPBFtnFrw4nH6icq6ebibQzabKuku77FWjCbsg1IhYwQjUePs7MuyiaaL2jY2rR0CAicb3neZ6BAWH54XzmVY7J4qg/640?wx_fmt=png" data-type="png" data-w="1988" src="https://mmbiz.qpic.cn/mmbiz_png/MPBFtnFrw4nH6icq6ebibQzabKuku77FWjCbsg1IhYwQjUePs7MuyiaaL2jY2rR0CAicb3neZ6BAWH54XzmVY7J4qg/640?wx_fmt=png"></p><pre data-tool="mdnice编辑器"><span></span><code>laml.maf &lt;- system.file(<span>"extdata"</span>, <span>"tcga_laml.maf.gz"</span>, package = <span>"maftools"</span>)<br>laml.clin &lt;- system.file(<span>'extdata'</span>, <span>'tcga_laml_annot.tsv'</span>, package = <span>'maftools'</span>)<br>laml &lt;- maftools::read.maf(maf = laml.maf, clinicalData = laml.clin)<br>aplotExtra::oncoplot(maf = laml, genes = 20)<br></code></pre><p data-tool="mdnice编辑器">用上面的代码，就可以画出来下面的图：</p></section><p><img data-galleryid="" data-ratio="0.6838166510757717" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/MPBFtnFrw4nWfWpwpWL7MxIgeAdksabcDoP3POef41QKwxTv7una717PeBuJXpk7AkibLZMFScbQXmSric3SAdYA/640?wx_fmt=png" data-type="png" data-w="1069" src="https://mmbiz.qpic.cn/mmbiz_png/MPBFtnFrw4nWfWpwpWL7MxIgeAdksabcDoP3POef41QKwxTv7una717PeBuJXpk7AkibLZMFScbQXmSric3SAdYA/640?wx_fmt=png"></p><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><p data-tool="mdnice编辑器">好处有多少呢？</p><p data-tool="mdnice编辑器"><code>aplotExtra::oncoplot()</code>出的图，你能用<code>[[</code>下标取子图，每张子图都是<code>ggplot</code>对象，有必要的话你可以继续更改呀，然后再塞回去，出图就更新了。</p><p data-tool="mdnice编辑器">然而这远远不止这些，组图嘛，原来<code>maftools::oncoplot()</code>组的是死图，<code>aplot</code>组图嘛，活的！你还能继续加点东西，你看这个<code>oncoplot()</code>是个啥，无非是个基因和样本两个维度的东西。你可以继续加些样本的信息，基因的信息，围绕着主图，再加一圈。</p><p data-tool="mdnice编辑器">也就是说，原来的<code>oncoplot()</code>只针对基因组/外显子一种组学的数据，你现在多组学了，别的组学的信息，你也能加了。当然还有meta data你也能加了。</p><p data-tool="mdnice编辑器">胖友们，这意味着什么？意味着我们打开了更多的可能性！你的图可以传达更多的信息，可以更有逼格，以及通过多组学一起呈现，你更有可能会发现一些下游的线索。</p></section><p><mp-style-type data-value="10000"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/RoVyWTgVZf0XWWu_01DIzA",target="_blank" rel="noopener noreferrer">原文链接</a>
