---
title: "R统计绘图-判别分析(LDA/QDA)"
date: 2023-08-04T21:34:24Z
draft: ["false"]
tags: [
  "fetched",
  "EcoEvoPhylo"
]
categories: ["Acdemic"]
---
R统计绘图-判别分析(LDA/QDA) by EcoEvoPhylo
------
<div><section><section powered-by="xiumi.us"><section><section><section powered-by="xiumi.us"><section><section><br></section></section><section><section>zhe<section><svg viewbox="0 0 1 1"></svg></section></section></section></section></section><section><section powered-by="xiumi.us"><br></section></section><section><section powered-by="xiumi.us"><section><section><section><svg viewbox="0 0 1 1"></svg></section></section></section></section></section></section></section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><section><svg viewbox="0 0 1 1"></svg></section></section></section></section><section><section powered-by="xiumi.us"><section><section><svg viewbox="0 0 1 1"></svg></section></section></section></section></section><section powered-by="xiumi.us"><section><p><strong><span> 点击名片   关注我们</span></strong></p></section></section><section powered-by="xiumi.us"><section><mp-common-profile data-id="MzIzMTgwMjk1NQ==" data-pluginname="mpprofile" data-headimg="http://mmbiz.qpic.cn/mmbiz_png/UBCO9zW8ia6R6YRvmg5zRe6Xh1x5ibtFH4xTQZpLRwLIa1olAicH7qYibxwMibBRBDibl3w1WoOtJnh1Bn0xL0sHG7qw/0?wx_fmt=png" data-nickname="EcoEvoPhylo" data-alias="PHYLOGENOMICS" data-signature="搞科研的眼里只有实验，在此平台会不定期的推送一些科研相关的科研软件，工具书，实验流程和热门研究，欢迎各位志同道合的同学一起交流进步。" data-from="0" data-is_biz_ban="0" data-weui-theme="light"></mp-common-profile></section><section><br></section><section>判别分析是一种有监督的分类模型。当数据中样本的分类很明确时，判别分析比逻辑斯蒂回归更有效，泛化能力更强。但是不适合自变量与因变量之间具有错综复杂关系的数据集。判别分析包括线性判别分析和二次判别分析。判别分析使用贝叶斯定理确定每个样本/观测属于某个类别的概率，然后选择高概率的类别作为该观测的类别。<span></span><br></section><section><span></span></section><section><br></section><section><strong></strong></section><section><strong></strong></section><section><span><strong>一、 数据准备</strong></span></section></section><section><br></section><section>数据是模拟数据，包含3个分类变量，8个定量变量。</section><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="bash"><code><span><span># 设置工作路径</span></span></code><code><span><span>#knitr::opts_knit$set(root.dir="D:\\EnvStat\\EcoEvoPhylo\\biomarker")# 使用Rmarkdown进行程序运行</span></span></code><code><span>Sys.setlocale(<span>'LC_ALL'</span>,<span>'C'</span>) <span># Rmarkdown全局设置</span></span></code><code><span><span>#options(stringsAsFactors=F)# R中环境变量设置，防止字符型变量转换为因子</span></span></code><code><span><br></span></code><code><span>library(tidyverse)</span></code><code><span>library(magrittr)</span></code><code><span><span># 1.1 数据导入</span></span></code><code><span>data &lt;- read.csv(<span>"data.csv"</span>,</span></code><code><span>                 header = TRUE,</span></code><code><span>                 row.names = 1,</span></code><code><span>                 stringsAsFactors = TRUE</span></code><code><span>                 )</span></code><code><span>data %&gt;% head()</span></code><code><span><br></span></code><code><span><span># 1.2 数据描述统计</span></span></code><code><span>data %&gt;%</span></code><code><span>  summary</span></code><code><span>  </span></code></pre></section><section powered-by="xiumi.us"><p><img data-galleryid="" data-ratio="0.5472222222222223" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/UBCO9zW8ia6QOEFiau2OJb53aa0OSoEfdV9KNbyZ8PDXF6klIermpjSwmvRYCOW1NRxib2gVKlaCaUo03RHiaHNfvQ/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/UBCO9zW8ia6QOEFiau2OJb53aa0OSoEfdV9KNbyZ8PDXF6klIermpjSwmvRYCOW1NRxib2gVKlaCaUo03RHiaHNfvQ/640?wx_fmt=png"></p><p><span><strong>图</strong><strong>1</strong><strong>|数据</strong><strong>表，data.csv。</strong></span></p><p><br></p><p><strong>二、线性判别分析</strong></p><section><span><strong><br></strong></span></section><section><span>线性判别分析假设每种类别中的观测服从多元正态分布，且不同类别之间具有相同的协方差。</span></section><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="powershell"><code><span><span># 2.1 基础LDA分析</span></span></code><code><span>library(MASS)</span></code><code><span>lda.fit0 &lt;- lda(depth ~ .,<span>data</span> = data[-c(<span>2</span>:<span>3</span>)])</span></code><code><span>lda.fit0</span></code><code><span><br></span></code><code><span><span># 2.2 提取分析结果</span></span></code><code><span><span>## 2.2.1 结果描述</span></span></code><code><span>lda.fit0<span>$means</span> <span># 各变量的组内均值</span></span></code><code><span>lda.fit0<span>$prior</span> <span># 各组先验概率</span></span></code><code><span>lda.fit0<span>$counts</span> <span># 各组样本计数</span></span></code><code><span>lda.fit0<span>$scaling</span> <span># 线性判别系数,线性判别输出的系数用于形成LDA判决评分的自变量的线性组合。</span></span></code><code><span>lda.fit0<span>$svd</span> <span># 给出线性判别变量的组间和组内标准差之比。它们的平方是典型的F-统计量。</span></span></code><code><span><br></span></code><code><span><span>## 2.2.2 提取LDA线性判别系数</span></span></code><code><span>lda.var &lt;- data.frame(lda.fit0<span>$scaling</span>)</span></code><code><span>write.csv(lda.var,<span>"lda.var.csv"</span>,quote = FALSE)</span></code><code><span>lda.var %&gt;% head</span></code><code><span><br></span></code><code><span><span>## 2.2.3 提取LDA样本判别评分</span></span></code><code><span>lda.ind &lt;- data.frame(</span></code><code><span>  predict(lda.fit0)<span>$x</span>, <span># 判别评分</span></span></code><code><span>  depth = <span>data</span><span>$depth</span>, <span># 先验分类</span></span></code><code><span>  class = predict(lda.fit0)<span>$class</span> <span># 预测分类</span></span></code><code><span>                      )</span></code><code><span>write.csv(lda.ind,<span>"lda.ind.csv"</span>,quote = FALSE)</span></code><code><span>lda.ind %&gt;% head</span></code><code><span><br></span></code><code><span><span>## 2.2.4 LDA轴特征值</span></span></code><code><span>lda.eig &lt;- round(lda.fit0<span>$svd</span>^<span>2</span>/sum(lda.fit0<span>$svd</span>^<span>2</span>)*<span>100</span>,<span>2</span>)</span></code><code><span>lda.eig</span></code><code><span><br></span></code><code><span><span>## 2.2.5 观测属于某个类别的概率</span></span></code><code><span>predict(lda.fit0)<span>$posterior</span></span></code><code><span><br></span></code><code><span><span>## 2.2.6 预测的观测所属类别</span></span></code><code><span>predict(lda.fit0)<span>$class</span></span></code><code><span><br></span></code><code><span><span>## 2.2.7 判别正确率-混淆矩阵</span></span></code><code><span>caret::confusionMatrix(<span>data</span><span>$depth</span>, predict(lda.fit0)<span>$class</span>)</span></code><code><span><br></span></code></pre></section><p><img data-galleryid="" data-ratio="0.7750759878419453" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/UBCO9zW8ia6QOEFiau2OJb53aa0OSoEfdVtiaSicHemAjIZ8Zz722DeDjuGVEdSSBL22dWP5EmzGib2hRLrn06yTJdg/640?wx_fmt=png" data-type="png" data-w="329" src="https://mmbiz.qpic.cn/sz_mmbiz_png/UBCO9zW8ia6QOEFiau2OJb53aa0OSoEfdVtiaSicHemAjIZ8Zz722DeDjuGVEdSSBL22dWP5EmzGib2hRLrn06yTJdg/640?wx_fmt=png"></p><p><span><strong>图2</strong><strong>|LDA线性判别系数，lda.var.csv</strong><strong>。</strong>LDA分析只能形成(因变量类别数-1)个成分轴，这里有A，B，C三个类别，因此形成了2个LDA轴。线性判别系数是标准线性组合，用于确定观测的判别评分的特征。</span></p><p><span><br></span></p><p><img data-galleryid="" data-ratio="0.7425925925925926" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/UBCO9zW8ia6QOEFiau2OJb53aa0OSoEfdVYib9XwrEY6nGUGYwn1bePbf3rgMorTjYicxIjUeibfa7Dz72rgNCrZTGw/640?wx_fmt=png" data-type="png" data-w="540" src="https://mmbiz.qpic.cn/sz_mmbiz_png/UBCO9zW8ia6QOEFiau2OJb53aa0OSoEfdVYib9XwrEY6nGUGYwn1bePbf3rgMorTjYicxIjUeibfa7Dz72rgNCrZTGw/640?wx_fmt=png"></p><p><span><strong>图3</strong><strong>|LDA样本判别评分，lda.ind.csv</strong><strong>。</strong><span>depth是样本实际类别，class是模型预测分类。</span></span></p><p><span><span><br></span></span></p><p><img data-galleryid="" data-ratio="1.2795698924731183" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/UBCO9zW8ia6QOEFiau2OJb53aa0OSoEfdV0mgTLZOI0GUL90pQRVkFicdLJv2D1hkpicxKxGFeAvehcXoryia5SFsibw/640?wx_fmt=png" data-type="png" data-w="930" src="https://mmbiz.qpic.cn/sz_mmbiz_png/UBCO9zW8ia6QOEFiau2OJb53aa0OSoEfdV0mgTLZOI0GUL90pQRVkFicdLJv2D1hkpicxKxGFeAvehcXoryia5SFsibw/640?wx_fmt=png"></p><p><span><strong>图4</strong><strong>|混淆矩阵</strong><strong>。</strong>包含模型预测准确率等信息。</span></p><p><span><span><br></span></span></p><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="powershell"><code><span><span># 2.3 LDA分析leave-one-out交叉验证</span></span></code><code><span>lda.fit1 &lt;- lda(depth ~ .,<span>data</span> = data[-c(<span>2</span>:<span>3</span>)],</span></code><code><span>               method = <span>"moment"</span>,</span></code><code><span>               <span>#先验概率：默认各分类占总样本数的比例#</span></span></code><code><span>               prior = c(<span>1</span>,<span>1</span>,<span>1</span>)/<span>3</span>, <span># 设置顺序必须与因子分类水平一致。</span></span></code><code><span>               <span>#某变量组内方差&lt;tol^2时，将会停止运行#</span></span></code><code><span>               tol = <span>1.0</span>e-<span>4</span>,</span></code><code><span>               <span>#缺失值处理方式#</span></span></code><code><span>               na.action = na.omit,</span></code><code><span>               <span>#执行leave-one-out交叉验证#</span></span></code><code><span>               CV = TRUE,</span></code><code><span>               )</span></code><code><span><br></span></code><code><span>lda.fit1<span>$class</span> <span># 交叉验证结果，每个样本对应的类别。</span></span></code><code><span>table(lda.fit1<span>$class</span>,<span>data</span><span>$depth</span>)</span></code><code><span>mean(lda.fit1<span>$class</span> == <span>data</span><span>$depth</span>) <span># 模型分类正确率。</span></span></code><code><span>lda.fit1<span>$posterior</span> <span># 样本归于各分类的后验概率。</span></span></code><code><span><br></span></code></pre></section><p><span><br></span></p><section><ul><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="apache"><code><span><span># 2.4 LDA分析结果可视化</span></span></code><code><span><span>## 2.4.1 样本判别评分图</span></span></code><code><span><span>library</span>(ggplot2)</span></code><code><span><span>lda</span>.ind %&gt;% ggplot(aes(LD1,LD2,color = depth)) +</span></code><code><span>  <span>geom_point</span>(size=2.5) +</span></code><code><span>  <span>stat_ellipse</span>() +</span></code><code><span>  <span>theme_bw</span>() +</span></code><code><span>  <span>labs</span>(x = paste(<span>"LDA1 ("</span>,lda.eig[1],<span>"%)"</span>,sep = <span>""</span>),</span></code><code><span>       <span>y</span> = paste(<span>"LDA2 ("</span>,lda.eig[2],<span>"%)"</span>,sep = <span>""</span>)) -&gt; p.ind</span></code><code><span><br></span></code><code><span><span>ggsave</span>(<span>"lda.ind.pdf"</span>,p.ind,family = <span>"Times"</span>)</span></code><code><span><br></span></code></pre></section><p><img data-galleryid="" data-ratio="0.712037037037037" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/UBCO9zW8ia6QOEFiau2OJb53aa0OSoEfdVBeIdkzyV9097rYDWrFFH5HyN4m71qGBweZFdT5Q9uqGZOHq7oUgQ8g/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/UBCO9zW8ia6QOEFiau2OJb53aa0OSoEfdVBeIdkzyV9097rYDWrFFH5HyN4m71qGBweZFdT5Q9uqGZOHq7oUgQ8g/640?wx_fmt=png"></p><p><strong>图5</strong><strong>|LDA样本判别评分图</strong><strong>。</strong><span>LD</span><span>A1能很好的代表depth的组间差异。</span></p><p><span><br></span></p><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="php"><code><span><span>## 2.4.2 线性判别系数图</span></span></code><code><span>lda.<span>var</span> %&gt;% ggplot() +</span></code><code><span>  geom_segment(</span></code><code><span>    aes(</span></code><code><span>      x = <span>0</span>,xend = LD1,</span></code><code><span>      y = <span>0</span>,yend = LD2),</span></code><code><span>    linewidth = <span>1</span>,</span></code><code><span>    color = <span>"blue"</span>,</span></code><code><span>    arrow = arrow(</span></code><code><span>      type = <span>"closed"</span>,</span></code><code><span>      length = unit(<span>0.2</span>, <span>"cm"</span>)),</span></code><code><span>    lineend = <span>"butt"</span>,</span></code><code><span>    arrow.fill = <span>"white"</span>) +</span></code><code><span>  ggrepel::geom_text_repel(</span></code><code><span>    aes(</span></code><code><span>      LD1,LD2,</span></code><code><span>      label = rownames(lda.<span>var</span>)),</span></code><code><span>    color = <span>"black"</span>)+</span></code><code><span>  ggthemes::theme_base() +</span></code><code><span>  geom_hline(yintercept = <span>0</span>) +</span></code><code><span>  geom_vline(xintercept = <span>0</span>) +</span></code><code><span>  labs(x = paste(<span>"LDA1 ("</span>,lda.eig[<span>1</span>],<span>"%)"</span>,</span></code><code><span>                 sep = <span>""</span>),</span></code><code><span>       y = paste(<span>"LDA2 ("</span>,lda.eig[<span>2</span>],<span>"%)"</span>,</span></code><code><span>                 sep = <span>""</span>)) -&gt; p.<span>var</span></span></code><code><span><br></span></code><code><span>ggsave(<span>"lda.var.pdf"</span>,p.<span>var</span>,family = <span>"Times"</span>)</span></code><code><span><br></span></code></pre></section><p><img data-galleryid="" data-ratio="0.712037037037037" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/UBCO9zW8ia6QOEFiau2OJb53aa0OSoEfdVC4uc8AIfQVJuibsXKcRSxKs7SjseZVw7PRbVcriaQpMOZulNbtR6tPnQ/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/UBCO9zW8ia6QOEFiau2OJb53aa0OSoEfdVC4uc8AIfQVJuibsXKcRSxKs7SjseZVw7PRbVcriaQpMOZulNbtR6tPnQ/640?wx_fmt=png"></p><p><strong>图6</strong><strong>|LDA线性判别系数图</strong><strong>。</strong></p><p><span><br></span></p><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="properties"><code><span><span>## 2.4.3 样本-变量双序图</span></span></code><code><span><span>### ggord包可快速绘制LDA双序图，也可直接使用ggplot2绘制。 </span></span></code><code><span><span># devtools::install_github('fawda123/ggord')</span></span></code><code><span><span>library(ggord)</span></span></code><code><span><span>ggord(</span></span></code><code><span><span>  #自行提供分组信息、样本得分与变量得分数据进行绘图#</span></span></code><code><span><span>  #此方法不能自行计算轴特征值，后续也无法修改轴标题#</span></span></code><code><span>  <span>grp_in</span> = <span>data$depth,</span></span></code><code><span>  <span>obs</span> = <span>lda.ind,</span></span></code><code><span><span>  #为了图绘制美观，变量系数全部乘以一个常数。#</span></span></code><code><span>  <span>vecs</span> = <span>lda.var*3,</span></span></code><code><span><span>  </span></span></code><code><span><span>  #直接提供排序对象进行绘图，此方法会直接计算轴特征值，#</span></span></code><code><span><span>  # ord_in = lda.fit0,</span></span></code><code><span>  </span></code><code><span>  <span>xlims</span> = <span>c(-5.5,5.5),</span></span></code><code><span>  <span>ylims</span> = <span>c(-3,3),</span></span></code><code><span>  <span>size</span> = <span>2.5, # 点大小。</span></span></code><code><span>  <span>veclsz</span> = <span>0.8, # 变量系数箭头粗细。</span></span></code><code><span>  <span>repel</span> = <span>FALSE) +</span></span></code><code><span>  <span>geom_hline(yintercept</span> = <span>0) +</span></span></code><code><span>  <span>geom_vline(xintercept</span> = <span>0) +</span></span></code><code><span>  <span>theme(</span></span></code><code><span>  <span>plot.background</span> = <span>element_blank()</span></span></code><code><span>  <span>)</span>  <span>-&gt; p.biplot</span></span></code><code><span>  </span></code><code><span><span>ggsave("lda.biplot.pdf",p.biplot,family </span>=<span> "Times")</span></span></code><code><span><br></span></code></pre></section><p><img data-cropselx1="0" data-cropselx2="578" data-cropsely1="0" data-cropsely2="359" data-ratio="0.5111111111111111" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/UBCO9zW8ia6QOEFiau2OJb53aa0OSoEfdVvnW3tnUrkmsa6tLxwMF5nLchM7iaTH9dYkXVJRZLiboicDm2BCaWy9AMQ/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/UBCO9zW8ia6QOEFiau2OJb53aa0OSoEfdVvnW3tnUrkmsa6tLxwMF5nLchM7iaTH9dYkXVJRZLiboicDm2BCaWy9AMQ/640?wx_fmt=png"><span></span></p><p><span><strong>图7</strong><strong>|LDA样本-变量双序图</strong><strong>。</strong><span>此数据中V1的LDA系数较大，其他变量的系数都较小，等比例乘以常数之后，多数变量箭头还是很短。绘图时可根据自己数据，挑选变量，选择性绘图。</span></span></p><p><span><span><br></span></span></p><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="php"><code><span><span>## 2.4.4 lefse分析中的LDA得分</span></span></code><code><span><span>### 获取第一特征向量</span></span></code><code><span>w &lt;- lda.fit0$scaling[,<span>1</span>]</span></code><code><span>w</span></code><code><span><br></span></code><code><span><span>### 标准化第一特征向量</span></span></code><code><span>w_unit &lt;- w/sqrt(sum(w^<span>2</span>))</span></code><code><span>w_unit</span></code><code><span><br></span></code><code><span><span>### 计算观测新坐标</span></span></code><code><span>xy_matrix &lt;- <span>as</span>.matrix(data[-c(<span>1</span>:<span>3</span>)])</span></code><code><span>LD &lt;- xy_matrix %*% w_unit</span></code><code><span><br></span></code><code><span><span>### 计算LDA得分</span></span></code><code><span><span>###计算组间距离，作为效应系数</span></span></code><code><span><span>###如果进行了自举检验，则计算重复的均值；</span></span></code><code><span><span>###类别超过2组时，两两计算LDA得分，然后选择最大值。</span></span></code><code><span>pairs &lt;- combn(unique(<span>as</span>.character(data$depth)), <span>2</span>)</span></code><code><span>pairs </span></code><code><span>res_lda_pair &lt;- <span>list</span>()</span></code><code><span><span>for</span> (p in seq(ncol(pairs))) {</span></code><code><span>effect_size &lt;- abs(</span></code><code><span>  mean(LD[data[,<span>"depth"</span>] == pairs[,p][<span>1</span>]]) - mean(LD[data[,<span>"depth"</span>] == pairs[,p][<span>2</span>]]));</span></code><code><span>coeff &lt;- abs(w_unit * effect_size); <span># 标准化后特征向量*效应系数(组间距离) </span></span></code><code><span>rres &lt;- lda.fit0$means %&gt;% <span>as</span>.data.frame;</span></code><code><span>rres1 &lt;- apply(rres[rownames(rres) %in% pairs[,p],], <span>2</span>, <span><span>function</span><span>(x)</span> <span>abs</span><span>(x[<span>1</span>] - x[<span>2</span>])</span>)</span>;</span></code><code><span>res_lda_pair[[p]] &lt;- (rres1 + coeff[names(rres1)]) * <span>0.5</span>;                </span></code><code><span>}</span></code><code><span>res_lda_pair </span></code><code><span>res &lt;- sapply(colnames(data[-c(<span>1</span>:<span>3</span>)]), <span><span>function</span><span>(k)</span></span>{</span></code><code><span>  lapply(seq(ncol(pairs)), <span><span>function</span><span>(p)</span></span>{</span></code><code><span>    res_lda_pair[[p]][k] </span></code><code><span>  }) %&gt;% unlist %&gt;% max</span></code><code><span>})</span></code><code><span>res &lt;- sapply(res, <span><span>function</span><span>(x)</span> </span>{log10(<span>1</span> + abs(x)) * ifelse(x &gt; <span>0</span>, <span>1</span>, <span>-1</span>)})</span></code><code><span>res</span></code><code><span><br></span></code><code><span><span>### 检索到的另一种计算多分类lefse中LDA得分的简单方法</span></span></code><code><span>data.frame(t(lda.fit0$means)) %&gt;%</span></code><code><span>  mutate(name = rownames(.)) %&gt;% </span></code><code><span>  rowwise() %&gt;% </span></code><code><span>  mutate(</span></code><code><span>    max = max(A, B, C),</span></code><code><span>    min = min(A, B, C),</span></code><code><span>    ) %&gt;%</span></code><code><span>  mutate(LDA = log10(<span>1</span>+(max-min)/<span>2</span>)) %&gt;% <span># 趋势是一致的。</span></span></code><code><span>  ungroup() -&gt; lefse.lda</span></code><code><span>lefse.lda$class &lt;- NA <span># 各自变量在哪个类别中富集。</span></span></code><code><span><span>for</span>(i in <span>1</span>:nrow(lefse.lda))</span></code><code><span>  {lefse.lda[i, <span>"class"</span>] &lt;- names(which.max(lefse.lda[i, c(<span>"A"</span>, <span>"B"</span>,<span>"C"</span>)]))}</span></code><code><span>lefse.lda</span></code><code><span>                       </span></code><code><span>lefse.lda$res_lda &lt;- res</span></code><code><span>write.csv(lefse.lda,<span>"lefse.lda.csv"</span>,quote = <span>FALSE</span>)</span></code><code><span>lefse.lda</span></code><code><span><br></span></code></pre></section><p><img data-galleryid="" data-ratio="0.23425925925925925" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/UBCO9zW8ia6QOEFiau2OJb53aa0OSoEfdVhso0YkSzHk52FAb726oHQSsv16ib65bNf9l7neAqDI5rnH9Hq2Jl60Q/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/UBCO9zW8ia6QOEFiau2OJb53aa0OSoEfdVhso0YkSzHk52FAb726oHQSsv16ib65bNf9l7neAqDI5rnH9Hq2Jl60Q/640?wx_fmt=png"></p><p><strong><span>图8|lefse分析中的LDA得分，lefse.lda.csv。</span></strong><span>两种计算方法的结果有差异。计算过程参考：https://rdrr.io/cran/microeco/src/R/trans_diff.R和https://zhuanlan.zhihu.com/p/265681612。</span></p><p><span><strong>三、lefse分析结果可视化</strong></span></p><p><span>二次判别分析(QDA)假设每个类别的观测服从多元正态分布，但允许每个类别具有各自的协方差，意味着判别分数的计算允许引入二次项。</span></p><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="powershell"><code><span><span># 3.1 基础QDA分析</span></span></code><code><span>library(MASS)</span></code><code><span>qda.fit0 &lt;- qda(depth ~ .,<span>data</span> = data[-c(<span>2</span>:<span>3</span>)])</span></code><code><span>qda.fit0</span></code><code><span><br></span></code><code><span><span># 3.2 结果提取</span></span></code><code><span><span>## 3.2.1 结果描述-因为是二次函数，结果中没有线性判别系数。</span></span></code><code><span>qda.fit0<span>$means</span> <span># 各变量的组内均值</span></span></code><code><span>qda.fit0<span>$prior</span> <span># 各组先验概率</span></span></code><code><span><br></span></code><code><span><span>## 3.2.2 分类正确性</span></span></code><code><span>caret::confusionMatrix(<span>data</span><span>$depth</span>,predict(qda.fit0)<span>$class</span>) <span># 预测正确率只有些微提升。</span></span></code><code><span><br></span></code></pre></section><p><img data-galleryid="" data-ratio="0.9342592592592592" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/UBCO9zW8ia6QOEFiau2OJb53aa0OSoEfdVWiaibIKG5949HIuDVnvtlVb5WqxZd4OibPrWLGpDqDJFIviaBiaGZWTRhnQ/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/UBCO9zW8ia6QOEFiau2OJb53aa0OSoEfdVWiaibIKG5949HIuDVnvtlVb5WqxZd4OibPrWLGpDqDJFIviaBiaGZWTRhnQ/640?wx_fmt=png"></p><p><span><strong>图9</strong><strong>|QDA混淆矩阵。</strong></span><span>QDA分类器使用预测数据的二次函数，而不是线性函数，因此输出结果没有线性判别系数。</span></p><p><span><br></span></p><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="powershell"><code><span><span># 3.3 QDA分析leave-one-out交叉验证</span></span></code><code><span>qda.fit1 &lt;- qda(depth ~ .,<span>data</span> = data[-c(<span>2</span>:<span>3</span>)],</span></code><code><span>               method = <span>"moment"</span>,</span></code><code><span>               <span>#先验概率：默认各分类占总样本数的比例#</span></span></code><code><span>               prior = c(<span>1</span>,<span>1</span>,<span>1</span>)/<span>3</span>, <span># 设置顺序必须与因子分类水平一致。</span></span></code><code><span>               <span>#某变量组内方差&lt;tol^2时，将会停止运行#</span></span></code><code><span>               tol = <span>1.0</span>e-<span>4</span>,</span></code><code><span>               <span>#缺失值处理方式#</span></span></code><code><span>               na.action = na.omit,</span></code><code><span>               <span>#执行leave-one-out交叉验证#</span></span></code><code><span>               CV = TRUE,</span></code><code><span>               )</span></code><code><span><br></span></code><code><span>qda.fit1<span>$class</span> <span># 交叉验证结果，每个样本对应的类别。</span></span></code><code><span>table(qda.fit1<span>$class</span>,<span>data</span><span>$depth</span>)</span></code><code><span>mean(qda.fit1<span>$class</span> == <span>data</span><span>$depth</span>) <span># 模型分类正确率。</span></span></code><code><span>qda.fit1<span>$posterior</span> <span># 样本归于各分类的后验概率。</span></span></code><code><span><br></span></code></pre></section><p><mpcps data-templateid="card" data-traceid="6f57f943-177d-4bcf-9613-790eecc091bd" data-goodssouce="1" data-pid="101_12326907" data-appuin="3231802955" data-buffer='{"category_id":106,"pid":"101_12326907","biz_uin":"3231802955","trace_id":"6f57f943-177d-4bcf-9613-790eecc091bd","sku_id":"101_12326907","source_id":2,"source_name":"京东","audit_state":1,"main_img":"https://pcm-img.zhls.qq.com/productcenter-561dc1d1--1018824-5303902253403096300/16139560916082022/d65ba57d8f021792b63092ce7282f821.jpg","product_name":"精通机器学习：基于R（第2版）(图灵出品)","current_price":5730,"first_category_id":"106","book":{"shop_name":"人民邮电出版社京东自营官方旗舰店"},"product_label_name_list":["京东配送"],"select_tag_name_list":[],"templateId":"card","appuin":"3231802955","isNewCpsKOL":1}'></mpcps></p><p><span>数据及代码可以QQ交流群文件夹中下载，或公众号后台发送“<span>lda1</span></span><span>”获取。</span></p><p><span></span></p></section><section powered-by="xiumi.us"><section><span></span></section><p><span><br></span></p></section></section><section><section powered-by="xiumi.us"><section><section><section powered-by="xiumi.us"><section><section><svg viewbox="0 0 1 1"></svg></section></section></section><section powered-by="xiumi.us"><section><section><section powered-by="xiumi.us"><section><section><svg viewbox="0 0 1 1"></svg></section></section></section></section></section></section></section><section><section powered-by="xiumi.us"><section><p><span><strong>参考资料<br></strong></span></p></section></section><section powered-by="xiumi.us"><section><p><br></p></section></section></section></section></section><p><br></p><p><span>《精通机器学习：基于R》第二版</span></p><p><span>[宏基因组数据分析：差异分析（LEfSe安装使用及LDA score计算）](https://zhuanlan.zhihu.com/p/265681612)</span></p><p><span>https://rdrr.io/cran/microeco/src/R/trans_diff.R</span></p><p><span>https://github.com/SegataLab/lefse/tree/master/lefse</span></p><p><span><br></span></p><section powered-by="xiumi.us"><hr><p><strong><span>推荐阅读</span></strong></p><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzIzMTgwMjk1NQ==&amp;mid=2247485852&amp;idx=1&amp;sn=27c3eb79b8c6e784afe52e31f6cd41ee&amp;chksm=e89fd8b8dfe851aeaf4dadd65b1aa7830a9c37e2fc90856be0dfa06dc82cef3e966960bfaac0&amp;scene=21#wechat_redirect" textvalue="R绘图-物种、环境因子相关性网络图(简单图、提取子图、修改图布局参数、物种-环境因子分别成环径向网络图)" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2"></a></p><section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzIzMTgwMjk1NQ==&amp;mid=2247485852&amp;idx=1&amp;sn=27c3eb79b8c6e784afe52e31f6cd41ee&amp;chksm=e89fd8b8dfe851aeaf4dadd65b1aa7830a9c37e2fc90856be0dfa06dc82cef3e966960bfaac0&amp;scene=21#wechat_redirect" textvalue="R绘图-物种、环境因子相关性网络图(简单图、提取子图、修改图布局参数、物种-环境因子分别成环径向网络图)" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2">R绘图-物种、环境因子相关性网络图(简单图、提取子图、修改图布局参数、物种-环境因子分别成环径向网络图)</a></section></section><section powered-by="xiumi.us"><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzIzMTgwMjk1NQ==&amp;mid=2247485825&amp;idx=1&amp;sn=950d78df4bd0437abd7f4da6f0fb155b&amp;chksm=e89fd8a5dfe851b308d665e2795ece4bdb87ff76af87ce81e476bdb282611be5c7d27fb00592&amp;scene=21#wechat_redirect" textvalue="R统计绘图-分子生态相关性网络分析(拓扑属性计算，ggraph绘图)" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2">R统计绘图-分子生态相关性网络分析(拓扑属性计算，ggraph绘图)</a><br></p><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzIzMTgwMjk1NQ==&amp;mid=2247486124&amp;idx=1&amp;sn=878cccaa55314079769035f5ca6dc282&amp;chksm=e89fdb88dfe8529e358f8747d56f53653ca7256432935aa908dfbc151cc4e5dbae74fbc0a8e4&amp;scene=21#wechat_redirect" textvalue="R统计绘图-变量分组相关性网络图(igraph)" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2">R统计绘图-变量分组相关性网络图(igraph)</a><br></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzIzMTgwMjk1NQ==&amp;mid=2247485690&amp;idx=2&amp;sn=518b3998ac50b3e11dcdc2735188c532&amp;chksm=e89fd9dedfe850c8ab97081e3a66b25c0df4180223fb136308aa920e8a1115daf8aaaec0acbc&amp;scene=21#wechat_redirect" textvalue="机器学习-分类随机森林分析(randomForest模型构建、参数调优、特征变量筛选、模型评估和基础理论等)" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2">机器学习-分类随机森林分析(randomForest模型构建、参数调优、特征变量筛选、模型评估和基础理论等)</a></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzIzMTgwMjk1NQ==&amp;mid=2247486754&amp;idx=1&amp;sn=c36880f260869185a0715d9158fd8e9c&amp;chksm=e89fdc06dfe85510cd32526d65d2db960ccaecde5dcc155822afe3e3878495f162273a92a112&amp;scene=21#wechat_redirect" textvalue="R统计绘图-(O)PLS-DA分析(ropls)" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2"><span>R统计绘图-(O)PLS-DA分析(ropls)</span></a><br></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzIzMTgwMjk1NQ==&amp;mid=2247486731&amp;idx=1&amp;sn=fdb26232b253ff24d842d7f2d421f189&amp;chksm=e89fdc2fdfe855390a6fd7e0cd3936844160918d549df52e44641912888162a01aa9abe094b2&amp;scene=21#wechat_redirect" textvalue="R统计绘图-(O)PLS-DA分析(mixOmics)" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2"><span>R统计绘图-(O)PLS-DA分析(mixOmics)</span></a><br></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzIzMTgwMjk1NQ==&amp;mid=2247486688&amp;idx=1&amp;sn=0edbaf7182a69d1eaf1fd9e3ec3e0bde&amp;chksm=e89fddc4dfe854d2a3c6e2e9f47eef13f0ab6a15101e01f489bf1364e9959ced08e3723e5385&amp;scene=21#wechat_redirect" textvalue="机器学习-多元分类/回归决策树模型(rpart包)" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2"><span>机器学习-多元分类/回归决策树模型(rpart包)</span></a><br></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzIzMTgwMjk1NQ==&amp;mid=2247486567&amp;idx=1&amp;sn=ff2b8adf20dc3a8098b54c558668e19f&amp;chksm=e89fdd43dfe8545584a62c3379fe98affee34196c9db93fcb06290ffe6036b8c550a20c34f7e&amp;scene=21#wechat_redirect" textvalue="R统计绘图-物种丰度差异检验及biomarker鉴定(LEfSe分析、ANOVA和K-W检验)" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2"><span>R统计绘图-物种丰度差异检验及biomarker鉴定(LEfSe分析、ANOVA和K-W检验)</span></a><br></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzIzMTgwMjk1NQ==&amp;mid=2247487001&amp;idx=2&amp;sn=af56cd719aaede5678bb2df3472d1e43&amp;chksm=e89fdf3ddfe8562ba3365d48bec5dffe9c7e6a176f244c93b99c8176b5fb0417738c6a94a0ea&amp;scene=21#wechat_redirect" textvalue="R统计绘图-LEfSe分析及可视化(microbiomeMarker)" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2"><span>R统计绘图-LEfSe分析及可视化(microbiomeMarker)</span></a><br></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzIzMTgwMjk1NQ==&amp;mid=2247486380&amp;idx=1&amp;sn=84ab53182880ab0ea413b0852265063e&amp;chksm=e89fda88dfe8539ef44ebf698aaa6598225dc811cbeea756611a3671e8dc3950686b25701141&amp;scene=21#wechat_redirect" textvalue="R统计绘图-分类变量相关性卡方检验及绘图" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2"><span>R统计绘图-分类变量相关性卡方检验及绘图</span></a><br></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzIzMTgwMjk1NQ==&amp;mid=2247486373&amp;idx=2&amp;sn=c9aab1c336b1ca82e4e05242bab23b10&amp;chksm=e89fda81dfe853979fa22be257f03378ef12d5646634274895cdecc839bd50bd2a64d83a2357&amp;scene=21#wechat_redirect" textvalue="R统计绘图-多重线性回归(平均加权模型/最优子集筛选，MuMIn)" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2">R统计绘图-多重线性回归(平均加权模型/最优子集筛选，MuMIn)</a></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzIzMTgwMjk1NQ==&amp;mid=2247486281&amp;idx=1&amp;sn=76e86ea6f1b43c4b0eb8522c20485900&amp;chksm=e89fda6ddfe8537bb055069539de960febe0f2dc9adc72358a38ca5931bb5c7dda98f4a4dea0&amp;scene=21#wechat_redirect" textvalue="R统计绘图-多重线性回归(最优子集法特征筛选，leaps)" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2"><span>R统计绘图-多重线性回归(最优子集法特征筛选，leaps)</span></a><br></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzIzMTgwMjk1NQ==&amp;mid=2247486552&amp;idx=2&amp;sn=f820a2eebfc59bbfc20b4a51ff5bf725&amp;chksm=e89fdd7cdfe8546a581647e7e82a2092b0e190afab70dc428b4df941c59c507068cb28ce0867&amp;scene=21#wechat_redirect" textvalue="R统计绘图-多重线性回归(最优子集筛选/交叉验证，bestglm)" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2"><span>R统计绘图-多重线性回归(最优子集筛选/交叉验证，bestglm)</span></a><br></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzIzMTgwMjk1NQ==&amp;mid=2247486102&amp;idx=2&amp;sn=a474d1fb262f6948a72db055b03dc1ce&amp;chksm=e89fdbb2dfe852a4505fbe5d8182595c36286ba3592bcef52b83a49d38d7eb53c525b3db0a67&amp;scene=21#wechat_redirect" textvalue="R统计绘图 | 物种组成堆叠柱形图(绝对/相对丰度)" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2">R统计绘图 | 物种组成堆叠柱形图(绝对/相对丰度)</a><br></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzIzMTgwMjk1NQ==&amp;mid=2247486109&amp;idx=1&amp;sn=6c90795840ccdcad3c3a25eaac0d1367&amp;chksm=e89fdbb9dfe852af8003491eadff4d2d80e0ccf661b21096d66c5d11957d654e46ea333ff2ec&amp;scene=21#wechat_redirect" textvalue="R统计绘图 | 物种组成冲积图(绝对/相对丰度，ggalluvial)" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2">R统计绘图 | 物种组成冲积图(绝对/相对丰度，ggalluvial)</a></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzIzMTgwMjk1NQ==&amp;mid=2247486231&amp;idx=1&amp;sn=be46d7ecf5e993d0c602eacb2c7fa790&amp;chksm=e89fda33dfe853251391fd47ec8adac7328a09374a4b9a7b13dcce32492b2170d17445c86912&amp;scene=21#wechat_redirect" textvalue="R统计绘图 | 物种组成桑基图(不同分类单元微生物丰度及其从属关系，ggalluvial) -免费送书" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2">R统计绘图 | 物种组成桑基图(不同分类单元微生物丰度及其从属关系，ggalluvial) -免费送书</a><br></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzIzMTgwMjk1NQ==&amp;mid=2247486115&amp;idx=1&amp;sn=35b9009f9156e4ed60e1fb374e3ae28d&amp;chksm=e89fdb87dfe85291b26963a28bdf858550790746318703ce3083171b18e984222539eb65342a&amp;scene=21#wechat_redirect" textvalue="R统计绘图 | 物种组成堆叠面积图(绝对/相对丰度，ggalluvial)" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2"><span>R统计绘图 | 物种组成堆叠面积图(绝对/相对丰度，ggalluvial)</span></a><br></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzIzMTgwMjk1NQ==&amp;mid=2247486247&amp;idx=1&amp;sn=7b207f4c818b8f34c330919eef1fba6a&amp;chksm=e89fda03dfe853151c5ece6e8288a8b516e507ce5a3a937a0b9e8156aad73b9c8c8677042279&amp;scene=21#wechat_redirect" textvalue="R统计绘图 | 物种组成气泡图和聚类热图(ggplot2/ComplexHeatmap)" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2"><span>R统计绘图 | 物种组成气泡图和聚类热图(ggplot2/ComplexHeatmap)</span></a><br></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzIzMTgwMjk1NQ==&amp;mid=2247486410&amp;idx=1&amp;sn=24c7145dc6ffcd13c5429cb40c0eb4ef&amp;chksm=e89fdaeedfe853f88be97b666585f676491d6faca7316c7bfc8c6ac1275725abf9dbb49c5ce6&amp;scene=21#wechat_redirect" textvalue="R统计绘图-物种组成分析图(饼图、热图、venn图、花瓣图和UpSet图)" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2"><span>R统计绘图-物种组成分析图(饼图、热图、venn图、花瓣图和UpSet图)</span></a><br></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzIzMTgwMjk1NQ==&amp;mid=2247485650&amp;idx=1&amp;sn=1c6ee5fd9d5d2560962ecd3c4f892ed0&amp;chksm=e89fd9f6dfe850e0e56f985fc31c797747ddfd47bec8f13144b958d018e58b2a94f13454980a&amp;scene=21#wechat_redirect" textvalue="R统计绘图-随机森林分类分析及物种丰度差异检验组合图" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2">R统计绘图-随机森林分类分析及物种丰度差异检验组合图</a><br></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzIzMTgwMjk1NQ==&amp;mid=2247485690&amp;idx=1&amp;sn=91d7df5d3ed03425756b6e43e89a1118&amp;chksm=e89fd9dedfe850c867dda8bf067650387f40870500227485b5772532ad16434c00563c2667a9&amp;scene=21#wechat_redirect" textvalue="机器学习-多元分类/回归决策树模型(tree包)" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2">机器学习-多元分类/回归决策树模型(tree包)</a><br></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzIzMTgwMjk1NQ==&amp;mid=2247485636&amp;idx=1&amp;sn=5e6bf2ab537a68a0430dc8341788545d&amp;chksm=e89fd9e0dfe850f656c10b83a444b4d7d6cd2ac47f9aaa74c645ef53ea727ac3458a6710cdf5&amp;scene=21#wechat_redirect" textvalue="R统计绘图-环境因子相关性+mantel检验组合图(linkET包介绍1)" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2">R统计绘图-环境因子相关性+mantel检验组合图(linkET包介绍1)</a><br></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzIzMTgwMjk1NQ==&amp;mid=2247486001&amp;idx=1&amp;sn=c130e6cc06e25c69778230e8f0026006&amp;chksm=e89fdb15dfe85203908597b894f3eb974456011ee3ffecbf07de7299e11dc3892887a454307a&amp;scene=21#wechat_redirect" textvalue="R统计绘图-NMDS、环境因子拟合(线性和非线性)、多元统计(adonis2和ANOSIM)及绘图(双因素自定义图例)" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2">R统计绘图-NMDS、环境因子拟合(线性和非线性)、多元统计(adonis2和ANOSIM)及绘图(双因素自定义图例)</a><br></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzIzMTgwMjk1NQ==&amp;mid=2247484898&amp;idx=2&amp;sn=d229e066bd96e8e86515bdf8c34c0b53&amp;chksm=e89fd4c6dfe85dd0b127871b03da2c2b8ae3432b6e3528a2cc9f443103af11aa63b669199a2e&amp;scene=21#wechat_redirect" textvalue="R统计绘图-RDA分析、Mantel检验及绘图" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2">R统计绘图-RDA分析、Mantel检验及绘图</a><br></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzIzMTgwMjk1NQ==&amp;mid=2247483833&amp;idx=1&amp;sn=8385574b723a9817396b175c83de9b54&amp;chksm=e89fd09ddfe8598b9ac4ff4645f93eb220bd2b96d8c8093ef63097b7df5faabd1ff05bddb0a6&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2" wah-hotarea="click" hasload="1">R绘图-RDA排序分析</a></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzIzMTgwMjk1NQ==&amp;mid=2247484293&amp;idx=1&amp;sn=15f92fe82455ffba8992edcb7445bebf&amp;chksm=e89fd2a1dfe85bb7559e384585e6a08c9a9490ffbf797a03b1d39344a4813c2f11c85344f0ba&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2" wah-hotarea="click" hasload="1"></a><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzIzMTgwMjk1NQ==&amp;mid=2247485219&amp;idx=1&amp;sn=fbb07a5db12add50d047044f12e3c103&amp;chksm=e89fd607dfe85f11883ac5e591d5f50cfa2c609c2b51d04e841c575f0af781b032fe0581e62a&amp;scene=21#wechat_redirect" textvalue="R统计绘图-VPA(方差分解分析)" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2">R统计绘图-VPA(方差分解分析)</a><br></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzIzMTgwMjk1NQ==&amp;mid=2247485929&amp;idx=1&amp;sn=1300d9b41307dad849ed1be0cdfc66bb&amp;chksm=e89fd8cddfe851db056b6b0a245da11de51860c4f0809116084e689201a13189f3c98dcbdf90&amp;scene=21#wechat_redirect" textvalue="R统计绘图-PCA详解1(princomp/principal/rcomp/rda等)" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2">R统计绘图-PCA详解1(princomp/principal/rcomp/rda等)</a><br></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzIzMTgwMjk1NQ==&amp;mid=2247484625&amp;idx=2&amp;sn=52ca84ab65b0de9446303e2104582467&amp;chksm=e89fd5f5dfe85ce35fabcb358c21bd9c460e09049b8f8f2874051406b46a37667ec271cae029&amp;scene=21#wechat_redirect" textvalue="R统计-PCA/PCoA/db-RDA/NMDS/CA/CCA/DCA等排序分析教程" data-itemshowtype="0" tab="innerlink" data-linktype="2" wah-hotarea="click" hasload="1">R统计-PCA/PCoA/db-RDA/NMDS/CA/CCA/DCA等排序分析教程</a></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzIzMTgwMjk1NQ==&amp;mid=2247485314&amp;idx=1&amp;sn=fcadfd42825a48338af22597e719f790&amp;chksm=e89fd6a6dfe85fb05ebb6a5f828b1f5d9c0c0c73524ebd4d517e770cc9bef3f11d4016ce6192&amp;scene=21#wechat_redirect" textvalue="R统计绘图-PCA分析绘图及结果解读(误差线，多边形，双Y轴图、球形检验、KMO和变量筛选等)" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2">R统计绘图-PCA分析绘图及结果解读(误差线，多边形，双Y轴图、球形检验、KMO和变量筛选等)</a></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzIzMTgwMjk1NQ==&amp;mid=2247485223&amp;idx=2&amp;sn=b5b56d6f86170bd21577b082ce01be62&amp;chksm=e89fd603dfe85f15b2b13f9e5698ec7e01295e4dfd5599ee7f0279774b13b072f3f70d825707&amp;scene=21#wechat_redirect" textvalue="R统计-微生物群落结构差异分析及结果解读" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2">R统计-微生物群落结构差异分析及结果解读</a><br></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzIzMTgwMjk1NQ==&amp;mid=2247486397&amp;idx=1&amp;sn=86684d2987da8a1eee7bf9730eccb810&amp;chksm=e89fda99dfe8538f1573d773cd07d0ec9b1941c9542a9e748d11aa128c2f4aaf4c8693d6b5b9&amp;scene=21#wechat_redirect" textvalue="R统计绘图-群落生态学指数计算(α/β多样性、群落稳定性和生态位指数)" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2"><span>R统计绘图-群落生态学指数计算(α/β多样性、群落稳定性和生态位指数)</span></a><br></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzIzMTgwMjk1NQ==&amp;mid=2247485183&amp;idx=1&amp;sn=5176afd320554228341709a30cf7c6ab&amp;chksm=e89fd7dbdfe85ecd49c00eb5226a5af1ced8c08236b05b8d9d93c42d3761ec08d55dcaea0719&amp;scene=21#wechat_redirect" textvalue="R统计绘图-PCA分析及绘制双坐标轴双序图" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2"><span>R统计绘图-PCA分析及绘制双坐标轴双序图</span></a></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzIzMTgwMjk1NQ==&amp;mid=2247485152&amp;idx=2&amp;sn=a82d73fbd62a8dccc3a6b1a08fbe36f2&amp;chksm=e89fd7c4dfe85ed2ed3302bffd6d63c0bc169eef4155fbe16b7493f2d3eb78ecf72a6ceb3bbc&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2">R统计绘图-分子生态相关性网络分析</a><br></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzIzMTgwMjk1NQ==&amp;mid=2247483804&amp;idx=1&amp;sn=41728c614dc6aed6ad0538ce7418bf0d&amp;chksm=e89fd0b8dfe859aea901c68a060418f5b9ac97708f3b67a92f41c408c57e0522b7bfea2c77a5&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2" wah-hotarea="click">R中进行单因素方差分析并绘图</a></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzIzMTgwMjk1NQ==&amp;mid=2247484497&amp;idx=1&amp;sn=03039d1705e1e6ee9953cde3e62bc14c&amp;chksm=e89fd575dfe85c633ce620fbeb97166a98b45ea6294edf69a60ca8cba5ff85b3fe1c2d488286&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2" wah-hotarea="click">R统计-多变量单因素参数、非参数检验及多重比较</a><br></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzIzMTgwMjk1NQ==&amp;mid=2247484314&amp;idx=1&amp;sn=b0d2b26793ca6f5e0468bf2470ab57b4&amp;chksm=e89fd2bedfe85ba834a5e78b37564e4a6e71750f8c5a158e4cf604b8833b51c56d077f5434b7&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2" wah-hotarea="click">R绘图-相关性分析及绘图</a><br></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzIzMTgwMjk1NQ==&amp;mid=2247483890&amp;idx=1&amp;sn=d6b2303dfed378aeecc2619bac04b3e5&amp;chksm=e89fd0d6dfe859c038e3bda3deac2082edf285992810645983ed26f626472b5411b6961cc440&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2" wah-hotarea="click" hasload="1">R绘图-相关性系数图</a><br></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzIzMTgwMjk1NQ==&amp;mid=2247484518&amp;idx=1&amp;sn=9d5cb583a403d89ae2888be3176a9e67&amp;chksm=e89fd542dfe85c54d665d47291dc6c5126b3373e4d9f4834f00ed2c905deb505dfccdf396b08&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2" wah-hotarea="click" hasload="1">R统计绘图-环境因子相关性热图</a><br></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzIzMTgwMjk1NQ==&amp;mid=2247485010&amp;idx=1&amp;sn=829005a37e1ca22569cb72f6262f0c0a&amp;chksm=e89fd776dfe85e60872bb37d2f3b25bac98771ddddb29e257b98c93aaca5213419e8ae087765&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2" wah-hotarea="click" hasload="1">R统计绘图-corrplot绘制热图及颜色、字体等细节修改</a><br></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzIzMTgwMjk1NQ==&amp;mid=2247485023&amp;idx=1&amp;sn=1788fb4fa17f800bb043a9621637b907&amp;chksm=e89fd77bdfe85e6d434a71a0e8d9cbbc2e93011ff4c739e21965318dff6f1fd230a4fa1cbb1c&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2" wah-hotarea="click" hasload="1">R统计绘图-corrplot热图绘制细节调整2(更改变量可视化顺序、非相关性热图绘制、添加矩形框等)</a><br></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzIzMTgwMjk1NQ==&amp;mid=2247484962&amp;idx=1&amp;sn=52f4d203c220f88a148930d80191297e&amp;chksm=e89fd706dfe85e10acb64d37204b99267d6d0ba386eb7b99bc74af6150c74b1462ea32e8eaeb&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2" wah-hotarea="click" hasload="1">R数据可视化之美-节点链接图</a></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzIzMTgwMjk1NQ==&amp;mid=2247484973&amp;idx=1&amp;sn=925dde3f02975f1d3ad0e56490aef114&amp;chksm=e89fd709dfe85e1f547d18867148ba901404e479317a6a09cce70f6c89f7a45072c89b1a0425&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2" wah-hotarea="click" hasload="1">R统计绘图-rgbif包下载GBIF数据及绘制分布图</a></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzIzMTgwMjk1NQ==&amp;mid=2247485741&amp;idx=2&amp;sn=6d46403491a8449b6c8bacb021a28768&amp;chksm=e89fd809dfe8511f08a0bea04490970331ed926af01683fa7163a9abfe9de41494c750230c74&amp;scene=21#wechat_redirect" textvalue="R统计-单因素ANOVA/Kruskal-Wallis置换检验" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2">R统计-单因素ANOVA/Kruskal-Wallis置换检验</a></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzIzMTgwMjk1NQ==&amp;mid=2247484601&amp;idx=4&amp;sn=58b4ca2633180037e49b3575167a6035&amp;chksm=e89fd59ddfe85c8bc826783f419d61bead8326724b7ebad84c4bf3e75719cf3619921104bda3&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2" wah-hotarea="click" hasload="1">R统计-正态性分布检验[Translation]</a><br></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzIzMTgwMjk1NQ==&amp;mid=2247484601&amp;idx=1&amp;sn=4ecb5506ab58b69970614f2d0f2f2d6a&amp;chksm=e89fd59ddfe85c8bab94f0ea85a01c32433e799b01a7f166ccd6ddf0d7f11fb47d93657b3448&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2" wah-hotarea="click" hasload="1">R统计-数据正态分布转换[Translation]</a><br></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzIzMTgwMjk1NQ==&amp;mid=2247484601&amp;idx=3&amp;sn=ae0283fc82f46d65ceb16033a1821947&amp;chksm=e89fd59ddfe85c8be2f703f652a3f04b76cce9ccad45925ff9027e2bb8d237107e545cec19c0&amp;scene=21#wechat_redirect" textvalue="R统计-方差齐性检验[Translation]" data-itemshowtype="0" tab="innerlink" data-linktype="2" wah-hotarea="click" hasload="1">R统计-方差齐性检验[Translation]</a><br></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzIzMTgwMjk1NQ==&amp;mid=2247484568&amp;idx=1&amp;sn=b37ef4e81c2ce9759a595276978274a0&amp;chksm=e89fd5bcdfe85caa08256502b77065feee24617ba77672a7b8777ed7ef621c738a209f73c81c&amp;scene=21#wechat_redirect" textvalue="R统计-Mauchly球形检验[Translation]" data-itemshowtype="0" tab="innerlink" data-linktype="2" wah-hotarea="click" hasload="1">R统计-Mauchly球形检验[Translation]</a></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzIzMTgwMjk1NQ==&amp;mid=2247484682&amp;idx=1&amp;sn=302343dbd4911b919c416314a74cfb84&amp;chksm=e89fd42edfe85d3855e61a2bdb0d45a807d5a7c6bab078ba2e9207bdf70f0b8c72b0ca587853&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2" wah-hotarea="click" hasload="1">R统计绘图-单、双、三因素重复测量方差分析[Translation]</a><br></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzIzMTgwMjk1NQ==&amp;mid=2247484758&amp;idx=3&amp;sn=4ed84d2313f7c24d7415dd777fa8f591&amp;chksm=e89fd472dfe85d649ab2a95f2bf11b0873a74d4f1249a32dd2264dd2212c76347e33f92c3b8e&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2" wah-hotarea="click" hasload="1">R统计绘图-混合方差分析[Translation]</a><br></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzIzMTgwMjk1NQ==&amp;mid=2247484783&amp;idx=1&amp;sn=f18991e50e7c021fedc172e58a002c7f&amp;chksm=e89fd44bdfe85d5d3b9d6375dc551712c5ce0bc43f91b731da3ddf276189faf1d4f4128f3eb9&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2" wah-hotarea="click" hasload="1">R统计绘图-协方差分析[Translation]</a><br></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzIzMTgwMjk1NQ==&amp;mid=2247485036&amp;idx=1&amp;sn=dc647b8a947233469aa6b31b0e14d639&amp;chksm=e89fd748dfe85e5eee5013e54d89389fb8a852605de2c0fcd8f237a5718839748dfccf10c59f&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2" wah-hotarea="click">R统计绘图-One-Way MANOVA</a></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzIzMTgwMjk1NQ==&amp;mid=2247486217&amp;idx=2&amp;sn=b69bf52709c0676022bf363865d3fb42&amp;chksm=e89fda2ddfe8533bef4f9d5d652588c6d7e997156881e55eca4f925da8d6da176cbcfa4cc0c6&amp;scene=21#wechat_redirect" textvalue="文献管理 | Endnote使用小技巧(修改引文格式、合并文献库、删除重复文献和更新文献信息等)" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2"><span>文献管理 | Endnote使用小技巧(修改引文格式、合并文献库、删除重复文献和更新文献信息等)</span></a></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzIzMTgwMjk1NQ==&amp;mid=2247485239&amp;idx=1&amp;sn=089edc56fb131be2c82a032d11d1c3f2&amp;chksm=e89fd613dfe85f05931a32f63193b7468ad6a529d3ba542e0846d954f5cd747a634cb02afb3c&amp;scene=21#wechat_redirect" textvalue="Alignment--本地blast使用详解1-数据库序列检索下载及比对" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2"><span>Alignment--本地blast使用详解1-数据库序列检索下载及比对</span></a><br></section></section><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzIzMTgwMjk1NQ==&amp;mid=2247485036&amp;idx=1&amp;sn=dc647b8a947233469aa6b31b0e14d639&amp;chksm=e89fd748dfe85e5eee5013e54d89389fb8a852605de2c0fcd8f237a5718839748dfccf10c59f&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2" wah-hotarea="click"></a></p><section powered-by="xiumi.us"><p><img data-galleryid="" data-ratio="0.562962962962963" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/UBCO9zW8ia6SmNQkEw8qW7G8kiaxjzR58PORRsJqVg4jRK7N813534rgzb28KnpEoLTmKt8Jzsb4cFAI90U8G7mQ/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/UBCO9zW8ia6SmNQkEw8qW7G8kiaxjzR58PORRsJqVg4jRK7N813534rgzb28KnpEoLTmKt8Jzsb4cFAI90U8G7mQ/640?wx_fmt=png"></p></section></section></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/o4SmCMaL1NdkHezi7vjfsg",target="_blank" rel="noopener noreferrer">原文链接</a>
