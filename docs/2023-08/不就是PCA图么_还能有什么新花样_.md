---
title: "不就是PCA图么，还能有什么新花样？"
date: 2023-08-24T03:03:51Z
draft: ["false"]
tags: [
  "fetched",
  "SCIPainter"
]
categories: ["Acdemic"]
---
不就是PCA图么，还能有什么新花样？ by SCIPainter
------
<div><p data-mpa-powered-by="yiban.io"><span>PCA (Principal Component Analysis) 散点图，是科研文章中常见的一类散点图。</span><span>闲言少叙，下面就以PCA散点图为</span><span>例，为大家介绍如何使用ggplot2绘制好看的散点图。</span></p><p><br></p><p><span>本文重点介绍如何使用ggh4x包辅助ggplot2实现更多的个性化调整，比如为坐标轴添加小刻度、更改坐标轴线的长度等。</span></p><p><br></p><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>#读入数据；</span><br mpa-from-tpl="t"><span>dt</span> &lt;- read.csv(<span>"PCA_data.csv"</span>)<br mpa-from-tpl="t"><span>#预览读入数据；</span><br mpa-from-tpl="t"><span>head</span>(dt)</code></pre></section><p><span></span><br></p><p><img data-ratio="0.3435185185185185" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mEbbScccViaicibdW7VYlMnxHFyB2XJwAdtiaGEg6PRQvKfOibdnovflUrg0x4Sy6llyBMnre03x3Ke4g/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mEbbScccViaicibdW7VYlMnxHFyB2XJwAdtiaGEg6PRQvKfOibdnovflUrg0x4Sy6llyBMnre03x3Ke4g/640?wx_fmt=png"></p><p><br></p><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>#载入ggplot2绘图包；</span><br mpa-from-tpl="t"><span>library</span>(ggplot2)<br mpa-from-tpl="t"><span>#安装ggh4x包；</span><br mpa-from-tpl="t"><span>install</span>.packages(<span>"ggh4x"</span>)<br mpa-from-tpl="t"><span>library</span>(ggh4x)<br mpa-from-tpl="t"><br mpa-from-tpl="t"><span>#绘制散点图；</span><br mpa-from-tpl="t"><span>p1</span> &lt;- ggplot(dt,aes(x=PC1,y=PC2,color=Diagnosis))+<br mpa-from-tpl="t">  <span>geom_point</span>(size=1.5)<br mpa-from-tpl="t"><span>#预览初始绘图效果；</span><br mpa-from-tpl="t"><span>p1</span></code></pre></section><p><br></p><p><img data-ratio="0.7945205479452054" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mEbbScccViaicibdW7VYlMnxH85sK8LOaRFpicL9A3a50zG3erClJLqxPibLPc0gBAPHl9ibQoWJAxg5uA/640?wx_fmt=png" data-type="png" data-w="803" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mEbbScccViaicibdW7VYlMnxH85sK8LOaRFpicL9A3a50zG3erClJLqxPibLPc0gBAPHl9ibQoWJAxg5uA/640?wx_fmt=png"></p><p><br></p><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>#自定义分组颜色、透明度（对应色号的后两位）、图例标题；</span><br mpa-from-tpl="t"><span>p2</span> &lt;- p1+scale_color_manual(name=<span>""</span>,<br mpa-from-tpl="t">                            <span>values</span> = c(<span>"#e26fffbb"</span>,<span>"#8e9cffbb"</span>))<br mpa-from-tpl="t"><span>#预览绘图效果；</span><br mpa-from-tpl="t"><span>p2</span></code></pre></section><p><br></p><p><img data-ratio="0.7870967741935484" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mEbbScccViaicibdW7VYlMnxHib7HzPtxicoiaRDhH9AJPdh9icKu9ticENlnaoKbibQqyQA7aC5w7TdtfFoA/640?wx_fmt=png" data-type="png" data-w="930" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mEbbScccViaicibdW7VYlMnxHib7HzPtxicoiaRDhH9AJPdh9icKu9ticENlnaoKbibQqyQA7aC5w7TdtfFoA/640?wx_fmt=png"></p><p><br></p><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>#自定义坐标轴范围和刻度；</span><br mpa-from-tpl="t"><span>#通过guide = "axis_minor"添加小刻度；</span><br mpa-from-tpl="t"><span>p3</span> &lt;- p2+scale_x_continuous(position = <span>"bottom"</span>,<br mpa-from-tpl="t">                            <span>guide</span> = <span>"axis_minor"</span>,<br mpa-from-tpl="t">                   <span>expand</span>=expansion(add = c(0.7,0)),<br mpa-from-tpl="t">                   <span>limits</span>=c(-10,5),<br mpa-from-tpl="t">                   <span>breaks</span> = c(-10,-5,0, 5),<br mpa-from-tpl="t">                   <span>label</span> = c(<span>"-10"</span>,<span>"-5"</span>, <span>"0"</span>, <span>"5"</span>))+<br mpa-from-tpl="t">  <span>scale_y_continuous</span>(position = <span>"left"</span>,<br mpa-from-tpl="t">                     <span>guide</span> = <span>"axis_minor"</span>,<br mpa-from-tpl="t">                     <span>expand</span>=expansion(add = c(0.5,0)),<br mpa-from-tpl="t">                     <span>limits</span>=c(-7.5,5),<br mpa-from-tpl="t">                     <span>breaks</span> = c(-7.5,-5,-2.5,0,2.5,5),<br mpa-from-tpl="t">                     <span>label</span> = c(<span>"-7.5"</span>,<span>"-5"</span>, <span>"-2.5"</span>, <span>"0"</span>,<span>"2.5"</span>,<span>"5"</span>))<br mpa-from-tpl="t"><br mpa-from-tpl="t"><span>p3</span></code></pre></section><p><br></p><p><img data-ratio="0.7959183673469388" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mEbbScccViaicibdW7VYlMnxHFoI5k3gmsgicibxmBTLcqtXsNnTfwCibT4ZkfKK6kGdGCaia7pYjb31tHg/640?wx_fmt=png" data-type="png" data-w="882" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mEbbScccViaicibdW7VYlMnxHFoI5k3gmsgicibxmBTLcqtXsNnTfwCibT4ZkfKK6kGdGCaia7pYjb31tHg/640?wx_fmt=png"></p><p><br></p><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>#自定义主题；</span><br mpa-from-tpl="t"><span>#包括添加小刻度、自定义刻度长短等；</span><br mpa-from-tpl="t"><span>mytheme</span> &lt;- theme(panel.grid = element_blank(),<br mpa-from-tpl="t">                 <span>panel</span>.background = element_blank(),<br mpa-from-tpl="t">                 <span>legend</span>.key = element_blank(),<br mpa-from-tpl="t">                 <span>legend</span>.position = <span>"top"</span>,<br mpa-from-tpl="t">                 <span>axis</span>.line = element_line(colour = <span>"grey30"</span>),<br mpa-from-tpl="t">                 <span>axis</span>.ticks.length = unit(1.8, <span>"mm"</span>),<br mpa-from-tpl="t">                 <span>ggh4x</span>.axis.ticks.length.minor = rel(0.6))<br mpa-from-tpl="t"><span>p4</span> &lt;- p3+mytheme<br mpa-from-tpl="t"><span>p4</span></code></pre></section><p><br></p><p><img data-ratio="1.0024509803921569" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mEbbScccViaicibdW7VYlMnxHJzrrjPIMOBgYcSleusmz2RCNjJ4RIhcWvTHx2oQiaicsMg4fCjgHzFew/640?wx_fmt=png" data-type="png" data-w="816" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mEbbScccViaicibdW7VYlMnxHJzrrjPIMOBgYcSleusmz2RCNjJ4RIhcWvTHx2oQiaicsMg4fCjgHzFew/640?wx_fmt=png"></p><p><br></p><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>#调整坐标轴的样式，调整坐标轴线的长度；</span><br mpa-from-tpl="t"><span>#比较遗憾的是当前版本无法保留小刻度,与guides(x = "axis_minor", y = "axis_minor")冲突；</span><br mpa-from-tpl="t"><span>#自定义图例分组图形（点）的大小；</span><br mpa-from-tpl="t"><span>p5</span> &lt;- p4+guides(x = guide_axis_truncated(trunc_lower = -10,<br mpa-from-tpl="t">                                         <span>trunc_upper</span> = 5),<br mpa-from-tpl="t">                <span>y</span> = guide_axis_truncated(trunc_lower = -7.5,<br mpa-from-tpl="t">                                         <span>trunc_upper</span> = 5),<br mpa-from-tpl="t">                <span>color</span> = guide_legend(override.aes = list(size=4)))<br mpa-from-tpl="t"><br mpa-from-tpl="t"><span>p5</span></code></pre></section><p><br></p><p><img data-ratio="0.9951573849878934" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mEbbScccViaicibdW7VYlMnxH8BnC9u6J2q1icB2GAqBJ4hNLBtyV9QUQRWVE1rlticbcNwvjopvFTNrg/640?wx_fmt=png" data-type="png" data-w="826" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mEbbScccViaicibdW7VYlMnxH8BnC9u6J2q1icB2GAqBJ4hNLBtyV9QUQRWVE1rlticbcNwvjopvFTNrg/640?wx_fmt=png"></p><p><br></p><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>#综上技巧，尝试添加质心线；</span><br mpa-from-tpl="t"><span>p6</span> &lt;- ggplot(dt,aes(x=PC1,y=PC2,color=Diagnosis))+<br mpa-from-tpl="t">  <span>stat_centroid</span>(aes(xend = PC1, yend = PC2, colour = Diagnosis),<br mpa-from-tpl="t">                <span>geom</span> = <span>"segment"</span>, crop_other = F,<br mpa-from-tpl="t">                <span>alpha</span>=0.3,size = 1,show.legend = F)+<br mpa-from-tpl="t">  <span>geom_point</span>(size=2,stroke=1,alpha=1,<br mpa-from-tpl="t">             <span>fill</span>=<span>"white"</span>,shape = 21,show.legend = T)+<br mpa-from-tpl="t">  <span>scale_color_manual</span>(name=<span>""</span>,<br mpa-from-tpl="t">                     <span>values</span> = c(<span>"#e26fff"</span>,<span>"#8e9cff"</span>))+<br mpa-from-tpl="t">  <span>scale_x_continuous</span>(expand=expansion(add = c(0.7,0.7)),<br mpa-from-tpl="t">                     <span>limits</span>=c(-10,5))+<br mpa-from-tpl="t">  <span>scale_y_continuous</span>(expand=expansion(add = c(0.5,0.5)),<br mpa-from-tpl="t">                     <span>limits</span>=c(-7.5,5))+<br mpa-from-tpl="t">  <span>guides</span>(x = <span>"axis_truncated"</span>,y = <span>"axis_truncated"</span>)+mytheme<br mpa-from-tpl="t"><br mpa-from-tpl="t"><span>p6</span></code></pre></section><p><br></p><p><img data-ratio="1.0436408977556109" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mEbbScccViaicibdW7VYlMnxHrqBUWHYpo8OaGTibiafQtwWJm9BqWt1zl8WF1qjHzAak5Dbgiaibhefjjg/640?wx_fmt=png" data-type="png" data-w="802" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mEbbScccViaicibdW7VYlMnxHrqBUWHYpo8OaGTibiafQtwWJm9BqWt1zl8WF1qjHzAak5Dbgiaibhefjjg/640?wx_fmt=png"></p><p><br></p><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><code><span>#绘制实心散点图；</span><br mpa-from-tpl="t"><span>p7</span> &lt;- ggplot(dt,aes(x=PC1,y=PC2,fill=Diagnosis))+<br mpa-from-tpl="t">  <span>stat_centroid</span>(aes(xend = PC1, yend = PC2, colour = Diagnosis),<br mpa-from-tpl="t">                <span>geom</span> = <span>"segment"</span>, crop_other = F,<br mpa-from-tpl="t">                <span>alpha</span>=0.3,size = 1,show.legend = F)+<br mpa-from-tpl="t">  <span>geom_point</span>(size=3,alpha=0.7,<br mpa-from-tpl="t">             <span>color</span>=<span>"white"</span>,shape = 21,show.legend = T)+<br mpa-from-tpl="t">  <span>scale_color_manual</span>(name=<span>""</span>,<br mpa-from-tpl="t">                     <span>values</span> = c(<span>"#FF9999"</span>,<span>"#c77cff"</span>))+<br mpa-from-tpl="t">  <span>scale_fill_manual</span>(name=<span>""</span>,<br mpa-from-tpl="t">                     <span>values</span> = c(<span>"#FF9999"</span>,<span>"#c77cff"</span>))+<br mpa-from-tpl="t">  <span>scale_x_continuous</span>(expand=expansion(add = c(0.7,0.7)),<br mpa-from-tpl="t">                     <span>limits</span>=c(-10,5))+<br mpa-from-tpl="t">  <span>scale_y_continuous</span>(expand=expansion(add = c(0.5,0.5)),<br mpa-from-tpl="t">                     <span>limits</span>=c(-7.5,5))+<br mpa-from-tpl="t">  <span>guides</span>(x = <span>"axis_truncated"</span>,y = <span>"axis_truncated"</span>)+mytheme<br mpa-from-tpl="t"><br mpa-from-tpl="t"><span>p7</span></code></pre></section><p><br></p><p><img data-ratio="1.0452781371280724" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mEbbScccViaicibdW7VYlMnxHmceX2CHrhqJmb78J2iaoiceSoWDRFR4cibzq0wgq98mHia5QqutENibia6PQ/640?wx_fmt=png" data-type="png" data-w="773" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6mEbbScccViaicibdW7VYlMnxHmceX2CHrhqJmb78J2iaoiceSoWDRFR4cibzq0wgq98mHia5QqutENibia6PQ/640?wx_fmt=png"></p><p><br></p><p><span>好啦，本次的ggplot2绘图教程就分享到这里啦！</span></p><p><span><br></span></p><p><span><br></span></p><p><strong><span>*未经许可，不得以任何方式复制或抄袭本篇文章之部分或全部内容。版权所有，侵权必究。</span></strong></p><p><br></p><section data-role="outer" label="Powered by 135editor.com"><section data-tools="135编辑器" data-id="105648"><section><section data-role="outer" label="Powered by 135editor.com"><section data-role="paragraph"><section data-role="outer" label="Powered by 135editor.com"><section data-tools="135编辑器" data-id="105648"><section><section><img data-ratio="0.8780487804878049" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6kCKJYcEqEIfoJYG621mPJE8VibmibGU0Jxic9iabARVRH0FT6BNE8VAglWFXBPibFAU7a6tWGibSs8wyUg/640?wx_fmt=png" data-type="png" data-w="41" data-width="100%" src="https://mmbiz.qpic.cn/sz_mmbiz_png/tgUVxVRjT6kCKJYcEqEIfoJYG621mPJE8VibmibGU0Jxic9iabARVRH0FT6BNE8VAglWFXBPibFAU7a6tWGibSs8wyUg/640?wx_fmt=png"></section><section><section><section data-width="35%"><section><section data-width="100%"><img data-ratio="1" data-src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/tgUVxVRjT6kCKJYcEqEIfoJYG621mPJEv5etCBwHicqbEPwnVrkpaasxqaVibM4mT2JdIuN6yTlYWDD4mL5A427A/640?wx_fmt=jpeg" data-type="jpeg" data-w="860" data-width="100%" title="SCIPainter 30cm二维码.jpg" src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/tgUVxVRjT6kCKJYcEqEIfoJYG621mPJEv5etCBwHicqbEPwnVrkpaasxqaVibM4mT2JdIuN6yTlYWDD4mL5A427A/640?wx_fmt=jpeg"></section></section></section><section data-width="50%"><section><section data-brushtype="text"><span><strong># SCIPainter</strong></span></section><section data-brushtype="text" hm_fix="361:593"><p>基迪奥旗下绘图公众号</p><p>分享科研绘图技能与工具</p><p>欢迎关注与转发~</p></section></section></section></section></section></section></section></section></section></section><section><br></section></section></section><section data-role="paragraph"><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><img data-ratio="1" data-src="https://mmbiz.qpic.cn/sz_mmbiz_gif/tgUVxVRjT6kCKJYcEqEIfoJYG621mPJEgMd0aMPtmrDjiaX8sBhfhicVteeHf1JicexSpUbS3fdS9SiboUVN7guaPw/640?wx_fmt=gif" data-type="gif" data-w="400" src="https://mmbiz.qpic.cn/sz_mmbiz_gif/tgUVxVRjT6kCKJYcEqEIfoJYG621mPJEgMd0aMPtmrDjiaX8sBhfhicVteeHf1JicexSpUbS3fdS9SiboUVN7guaPw/640?wx_fmt=gif"></section></section></section><section><section powered-by="xiumi.us"><section><p><span><strong>你的好友拍了拍你</strong></span></p><p><span><strong>并请你帮她点一下</strong></span><strong><span>“分享”</span></strong><span><strong><span>~</span></strong></span></p></section></section></section></section></section><p><br></p></section></section><p><span><br></span></p><p><mp-style-type data-value="10000"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/ErltZm3wbRUsQCrxgWf92g",target="_blank" rel="noopener noreferrer">原文链接</a>
