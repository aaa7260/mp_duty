---
title: "离谱，这篇NG的讨论链接竟被赌网劫持了"
date: 2023-08-07T20:45:12Z
draft: ["false"]
tags: [
  "fetched",
  "生信菜鸟团"
]
categories: ["Acdemic"]
---
离谱，这篇NG的讨论链接竟被赌网劫持了 by 生信菜鸟团
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><h1 data-tool="mdnice编辑器"><span></span><span>1-背景</span><span></span></h1><p data-tool="mdnice编辑器">收到一份曾老师转发的学员提问~<img data-ratio="1.3194444444444444" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibKb9QCVgNakFpkrLriaYIPcRpkXtzbhoJLsZiaklVta7LwPg7mNdXOJiaicZSOImrnzjDgcM6mOpBEHQ/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibKb9QCVgNakFpkrLriaYIPcRpkXtzbhoJLsZiaklVta7LwPg7mNdXOJiaicZSOImrnzjDgcM6mOpBEHQ/640?wx_fmt=png">原对话略长，总结一下就是表达矩阵看着一切正常但数据检查时候展示的图像如下：<img data-ratio="0.6739583333333333" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibKb9QCVgNakFpkrLriaYIPcqykkHjqKRxQGlFwhicTicWiaChpGXLSxIIX4JIzFfsXy3a3nB8cx9vfJg/640?wx_fmt=png" data-type="png" data-w="960" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibKb9QCVgNakFpkrLriaYIPcqykkHjqKRxQGlFwhicTicWiaChpGXLSxIIX4JIzFfsXy3a3nB8cx9vfJg/640?wx_fmt=png">相信很多小伙伴都看出来了，<strong>右侧的这个火山图过于奇怪。</strong></p><h1 data-tool="mdnice编辑器"><span></span><span>2-曾大佬：问题应该在RawData</span><span></span></h1><p data-tool="mdnice编辑器">一开始以为是数据集样本的问题（唾液），可能本身检测到的基因就比较少（和Bulk混了），被大佬提醒，才反应过来芯片是探针有多少基因就有多少输出值的...</p><p data-tool="mdnice编辑器">那么... 回到文章</p><h2 data-tool="mdnice编辑器"><span></span><span>2.1 是MIAME对RawData做了什么吗？</span><span></span></h2><p data-tool="mdnice编辑器">看作者文章的描述，<img data-ratio="0.14074074074074075" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibKb9QCVgNakFpkrLriaYIPcf7jSFk8FsuAxp3dO5LiaHUDYXzQyelAeMic3vOV1oAZy78PwtxAAI3IA/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibKb9QCVgNakFpkrLriaYIPcf7jSFk8FsuAxp3dO5LiaHUDYXzQyelAeMic3vOV1oAZy78PwtxAAI3IA/640?wx_fmt=png">MIAME?是一种过滤数据的策略吗？是之前不知道的名词。</p><p data-tool="mdnice编辑器">顺藤摸瓜找到了一篇NG<img data-ratio="0.6550060313630881" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibKb9QCVgNakFpkrLriaYIPcDHJoSBUpkBQk9GMcEOneztVfICfDdjqgYmMX1oe0Yh7FDOvJPNnwibg/640?wx_fmt=png" data-type="png" data-w="829" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibKb9QCVgNakFpkrLriaYIPcDHJoSBUpkBQk9GMcEOneztVfICfDdjqgYmMX1oe0Yh7FDOvJPNnwibg/640?wx_fmt=png">这篇文章作者希望建立一个关于微阵列的数据信息标准之类的。</p><p data-tool="mdnice编辑器">顺着往下看，<strong>在Discussion部分我看到了一个讨论网址</strong>。</p><p data-tool="mdnice编辑器">想进去看看他们在讨论什么。<img data-ratio="0.4062015503875969" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibKb9QCVgNakFpkrLriaYIPcXngUtGevJjkpaOjZ4xM4fA70ic2X5qQQhoBZhpW1uTxVTrqGokib98ag/640?wx_fmt=png" data-type="png" data-w="645" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibKb9QCVgNakFpkrLriaYIPcXngUtGevJjkpaOjZ4xM4fA70ic2X5qQQhoBZhpW1uTxVTrqGokib98ag/640?wx_fmt=png">然鹅...出现了一个画风奇怪的网站...<img data-ratio="0.287962962962963" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibKb9QCVgNakFpkrLriaYIPcx4NE8a22HuuJUiccWl5xAicLg2kiaINicZVIe7kyB9Sz0rqIibO14GPXwxg/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibKb9QCVgNakFpkrLriaYIPcx4NE8a22HuuJUiccWl5xAicLg2kiaINicZVIe7kyB9Sz0rqIibO14GPXwxg/640?wx_fmt=png">看到了如下描述 <strong>???????????????</strong><img data-ratio="0.06564245810055866" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibKb9QCVgNakFpkrLriaYIPcj6d9ImanB2yzOY68TMXXuvZ5JQENdgQ5A018glMORjZ85ocZYzWWYA/640?wx_fmt=png" data-type="png" data-w="716" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibKb9QCVgNakFpkrLriaYIPcj6d9ImanB2yzOY68TMXXuvZ5JQENdgQ5A018glMORjZ85ocZYzWWYA/640?wx_fmt=png">换bing搜索...结果还是一样的<img data-ratio="0.5746268656716418" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibKb9QCVgNakFpkrLriaYIPc2SbFZmeRKVIHmp7qbnIxSmIKlzutMbThaNb80XwyGLPMFZhAxAkibEw/640?wx_fmt=png" data-type="png" data-w="670" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibKb9QCVgNakFpkrLriaYIPc2SbFZmeRKVIHmp7qbnIxSmIKlzutMbThaNb80XwyGLPMFZhAxAkibEw/640?wx_fmt=png">emmmmmmmmmmmmmm.......是不是应该给作者写一封邮件啊...</p><p data-tool="mdnice编辑器"><strong>好，再回到文章吧</strong></p><p data-tool="mdnice编辑器">细看文章，说MIAME没有规定信息格式，只规定了信息内容。<img data-ratio="0.3437037037037037" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibKb9QCVgNakFpkrLriaYIPcaFFc7J1yTGbPxvXvP0orSGkulzLibfMqXsiapL9AJZ8tiamWXDTPb9Nsw/640?wx_fmt=png" data-type="png" data-w="675" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibKb9QCVgNakFpkrLriaYIPcaFFc7J1yTGbPxvXvP0orSGkulzLibfMqXsiapL9AJZ8tiamWXDTPb9Nsw/640?wx_fmt=png">原始数据，芯片定量矩阵，基因表达数据矩阵..<span>尽量只传输必要的数据。</span></p><p data-tool="mdnice编辑器"><strong>原来MIAME只是一个GEO数据上传的规范</strong></p><p data-tool="mdnice编辑器">那就继续再看一下文章吧。</p><h2 data-tool="mdnice编辑器"><span></span><span>2.2 那有没有可能探针被删除呢？</span><span></span></h2><p data-tool="mdnice编辑器"><img data-ratio="0.1569620253164557" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibKb9QCVgNakFpkrLriaYIPcjWa9w7RF8skSsvSlBcaoKtPTAJeBzh20U5Zhs1JUXUZ5bsj2hpBY7Q/640?wx_fmt=png" data-type="png" data-w="790" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibKb9QCVgNakFpkrLriaYIPcjWa9w7RF8skSsvSlBcaoKtPTAJeBzh20U5Zhs1JUXUZ5bsj2hpBY7Q/640?wx_fmt=png">发现作者调节了Affymetrix Microarray Suite 5.0软件的参数，排除了一些探针集。（作者GEO上传了这个数据集？）<img data-ratio="0.1" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibKb9QCVgNakFpkrLriaYIPcaoK26Z376brQ3WaQ8765icsrHpBlcgYFyVZDNbFZhLwSllWT5eEmpbQ/640?wx_fmt=png" data-type="png" data-w="790" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibKb9QCVgNakFpkrLriaYIPcaoK26Z376brQ3WaQ8765icsrHpBlcgYFyVZDNbFZhLwSllWT5eEmpbQ/640?wx_fmt=png">并且这个软件和扫描芯片荧光强度的软件是同一个。（作者上传的是一开始就扫描出来的？）其实这个问题好解决，<img data-ratio="0.19748427672955976" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibKb9QCVgNakFpkrLriaYIPcZ9Be9xQmja4yGiaW2DRSsTR1vdRXWqa2y86zFmL0PMSKsFDYg41zvXg/640?wx_fmt=png" data-type="png" data-w="795" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibKb9QCVgNakFpkrLriaYIPcZ9Be9xQmja4yGiaW2DRSsTR1vdRXWqa2y86zFmL0PMSKsFDYg41zvXg/640?wx_fmt=png"></p><p data-tool="mdnice编辑器">文章里面有写，芯片一共5.4W+的探针ID，<strong>若是上传数据有删除，表达矩阵函数行数肯定也有影响。</strong>运行代码如下：</p><pre data-tool="mdnice编辑器"><code><span>##使用表达矩阵</span><br>rm(list=ls())<br>library(affy)<br>library(GEOquery)<br>gse=<span>"GSE7451"</span><br>eSet=getGEO(gse,destdir = <span>'./'</span>,AnnotGPL = F,getGPL = F)<br>exp=eSet[[1]]@assayData<span>$exprs</span><br>exp[1:4,1:4]<br><span># GSM178746 GSM180372 GSM180373 GSM180374</span><br><span># 1007_s_at  6028.230  6789.090   365.911   9729.82</span><br><span># 1053_at    2286.360   495.613   198.994   1817.31</span><br><span># 117_at     1395.530  6392.430   914.500   3670.66</span><br><span># 121_at      628.693   363.049  5097.140   3666.72</span><br>range(exp)<br><span># [1] 2.0899e+01 1.2602e+07</span><br>log2.exp=log2(exp)<br>range(log2.exp)<br><span># [1]  4.385362 23.587149</span><br>dim(log2.exp)<br><span># [1] 54675    20</span><br></code></pre><p data-tool="mdnice编辑器"><strong>看结果，一共5万4千多行，也就是有5万4千多的探针，并没有删减。</strong></p><p data-tool="mdnice编辑器"><strong></strong>看来此路不通了。</p><p data-tool="mdnice编辑器">不过，既然这个表达矩阵没有问题，</p><p data-tool="mdnice编辑器">试试与GPL570其他数据集对比，<span>之前这个平台的火山图都蛮顺利的。</span></p><h2 data-tool="mdnice编辑器"><span></span><span>2.3 与其他GPL570 RawData比较</span><span></span></h2><p data-tool="mdnice编辑器">发现其他RawData经过RMA处理，而今天的GSE7451没有经过该处理。<img data-ratio="0.8964862298195632" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibKb9QCVgNakFpkrLriaYIPcTCddz33JYl93X3uicARyibNvOtlMI2K7J8ukdayReiaK4ZkXnkic5iadm5g/640?wx_fmt=png" data-type="png" data-w="1053" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibKb9QCVgNakFpkrLriaYIPcTCddz33JYl93X3uicARyibNvOtlMI2K7J8ukdayReiaK4ZkXnkic5iadm5g/640?wx_fmt=png"><strong>我想是我们今天的主角没有经过RMA步骤..</strong></p><p data-tool="mdnice编辑器">所以我从GSE7451原始数据开始重新做了一遍，这次带上了RMA步骤</p><h2 data-tool="mdnice编辑器"><span></span><span>2.4 从RawData开始画火山图</span><span></span></h2><p data-tool="mdnice编辑器">代码如下：</p><pre data-tool="mdnice编辑器"><code><span>##使用原始数据</span><br>rm(list = ls())<br>library(oligo)<br>library(ggplot2) <br>celFiles &lt;- list.celfiles(<span>'GSE7451_RAW/'</span>,full.name=TRUE)<br>celFiles<br>cel_data &lt;- oligo::read.celfiles( celFiles ) <br>dim(exprs(cel_data)) <br>exprs(cel_data)[1:4,1:4]<br><span>### 标准化(一步完成背景校正、分位数校正标准化和RMA (robust multichip average) 表达整合)</span><br>cel_data_rma &lt;- oligo::rma(cel_data  ) <br>exp_probe &lt;- Biobase::exprs(cel_data_rma)<br>exp_probe[1:4,1:4]<br><span>#save(exp_probe,file = 'exp_probe_CEL.Rdata')</span><br>load(file = <span>"exp_probe_CEL.Rdata"</span>)<br>load(file = <span>"matrix.Rdata"</span>)<br>range(exp_probe)<br>dat=exp_probe<br><span>## 输入：表达矩阵和分组信息</span><br>library(limma) <span>##算法核心在lmFit和eBayes上</span><br>design=model.matrix(~Group) <span>##获取差异矩阵，注意对照组要在前</span><br><span>#model.matrix(~ 0 + Group) ##只进行分组，如何进行比较由差异比较矩阵和makeContrasts函数结果控制</span><br>fit=lmFit(exp_probe,design) <span>##多元回归分析 </span><br>fit=eBayes(fit)  <span>##使用trend=TRUE对标准误差进行经验贝叶斯平滑</span><br>deg_CEL=topTable(fit,coef=2,number = Inf)<br><br><span>## 输出：limma差异分析结果</span><br>library(ggplot2)<br>library(dplyr)<br><span>## 输入差异分析结果</span><br><span>##这个火山图使用好几层图叠起来的</span><br>dat=deg_CEL<br>logFC_t=1<br>p_t=0.05<br><span>#加change列</span><br>k1 = (deg_CEL<span>$P</span>.Value &lt; p_t)&amp;(deg_CEL<span>$logFC</span> &lt; -logFC_t)  <span># 满足两个条件的逻辑值输出</span><br>k2 = (deg_CEL<span>$P</span>.Value &lt; p_t)&amp;(deg_CEL<span>$logFC</span> &gt; logFC_t)   <span># 满足两个条件的逻辑值输出</span><br>deg_CEL &lt;- mutate(deg_CEL,change = ifelse(k1,<span>"down"</span>,ifelse(k2,<span>"up"</span>,<span>"stable"</span>))) <br><span>####mutate把deg_CEL,change粘贴在一起</span><br>table(deg_CEL<span>$change</span>)<br>p &lt;- ggplot(data = dat,     <span>#全局映射，指定x轴和y轴的内容，类似加个背景墙的效果，默认背景是灰色的</span><br>            aes(x = logFC,        <br>                y = -log10(P.Value))) +<br>  geom_point(alpha=0.4, size=3.5,   <span>#加一层点图，描述点的大小、透明度，标记的意思</span><br>             aes(color=change)) +<br>  scale_color_manual(values=c(<span>"blue"</span>, <span>"grey"</span>,<span>"red"</span>))+ <span>## 指定颜色</span><br>  geom_vline(xintercept=c(-logFC_t,logFC_t),lty=4,col=<span>"black"</span>,linewidth=0.8) + <span>##加竖线</span><br>  geom_hline(yintercept = -log10(p_t),lty=4,col=<span>"black"</span>,linewidth=0.8) + <span>##加横线</span><br>  theme_bw() <span>#更换背景颜色为空白</span><br>p <span>#输出图片</span><br></code></pre><p data-tool="mdnice编辑器">这下就是正常的火山图了。<img data-ratio="0.6861111111111111" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibKb9QCVgNakFpkrLriaYIPcfEiaNpoB9hWgyFCFUDEc1MnL4Hm0KLd31L9Q90ibLvDQ1iaicXvRQOBrCg/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibKb9QCVgNakFpkrLriaYIPcfEiaNpoB9hWgyFCFUDEc1MnL4Hm0KLd31L9Q90ibLvDQ1iaicXvRQOBrCg/640?wx_fmt=png">这就可以啦。</p><h1 data-tool="mdnice编辑器"><span></span><span>3-小结&amp;致谢</span><span></span></h1><p data-tool="mdnice编辑器">火山图那么奇怪是因为作者提供的表达矩阵没有经过RMA步骤。</p><p data-tool="mdnice编辑器"><strong>珍爱生命，远离赌博</strong></p><p data-tool="mdnice编辑器">最后再次感谢曾大佬在问题解决中提供的指导。<span></span></p></section><p><mp-style-type data-value="10000"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/BlGfUheeUjkLKDVjlIY4XA",target="_blank" rel="noopener noreferrer">原文链接</a>
