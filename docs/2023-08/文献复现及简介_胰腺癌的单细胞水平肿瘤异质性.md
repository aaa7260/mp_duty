---
title: "文献复现及简介—胰腺癌的单细胞水平肿瘤异质性"
date: 2023-08-26T22:34:38Z
draft: ["false"]
tags: [
  "fetched",
  "单细胞天地"
]
categories: ["Acdemic"]
---
文献复现及简介—胰腺癌的单细胞水平肿瘤异质性 by 单细胞天地
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><blockquote data-tool="mdnice编辑器"><span>❝</span><p>群里的一个小伙伴提出来想让我帮忙复现cell里面的部分单细胞数据的图，今天我先来简单的梳理一下文献还有一部分复现代码到降维分群部分。</p><p>同时我们群里的小伙伴在8月24号跟大家直播分享了这篇文献，生信技能树视频号有回放可以观看，感兴趣的可以关注一下。</p><span>❞</span></blockquote><h4 data-tool="mdnice编辑器"><span></span>文献简介<span></span></h4><p data-tool="mdnice编辑器"><strong>「Microenvironment drives cell state, plasticity, and drug response in pancreatic cancer.」</strong><strong>「Cell. 2021 Dec 9;184(25):6119-6137.e26.doi: 10.1016/j.cell.2021.11.017.」</strong></p><figure data-tool="mdnice编辑器"><img data-ratio="0.6268518518518519" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicluqDZIvjvQjuJ0wSYP8ScztLPdcPFq6OrdOjP6FApUAncd524pxvkASrtY5R5RzlM0wMkTR2w5w/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicluqDZIvjvQjuJ0wSYP8ScztLPdcPFq6OrdOjP6FApUAncd524pxvkASrtY5R5RzlM0wMkTR2w5w/640?wx_fmt=png"></figure><h4 data-tool="mdnice编辑器"><span></span>文章中的数据集<span></span></h4><p data-tool="mdnice编辑器">https://singlecell.broadinstitute.org/single_cell/study/SCP1644<img data-ratio="0.3990740740740741" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicluqDZIvjvQjuJ0wSYP8ScOK7micS2eP1WeictzHzD0wK2Ef3Zzzwutnzxv7qFhcvlvib44r9ibBH9yw/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicluqDZIvjvQjuJ0wSYP8ScOK7micS2eP1WeictzHzD0wK2Ef3Zzzwutnzxv7qFhcvlvib44r9ibBH9yw/640?wx_fmt=png"><strong>「除了Biopsy活检样本和Organoid类器官样本，文章中还有对公共数据库挖掘的数据。」</strong>https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE131886<img data-ratio="0.15833333333333333" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicluqDZIvjvQjuJ0wSYP8ScPM98pFCENODaTmnSK6fcTdicUCKhS6WxAAtx3bCwWd4tvAxn5bEnOJA/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicluqDZIvjvQjuJ0wSYP8ScPM98pFCENODaTmnSK6fcTdicUCKhS6WxAAtx3bCwWd4tvAxn5bEnOJA/640?wx_fmt=png"><img data-ratio="0.16630434782608697" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicluqDZIvjvQjuJ0wSYP8Sc1HibWw0aXhly7boibNGibkvCTxG6oSUGfCKsK327CqyDHuic4xaIc49fzQ/640?wx_fmt=png" data-type="png" data-w="920" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicluqDZIvjvQjuJ0wSYP8Sc1HibWw0aXhly7boibNGibkvCTxG6oSUGfCKsK327CqyDHuic4xaIc49fzQ/640?wx_fmt=png"></p><h4 data-tool="mdnice编辑器"><span></span>文章样品制备流程<span></span></h4><p data-tool="mdnice编辑器"><strong>「转移患者的样本通过核心针活检收集并分离，之后将活检细胞分配用于scRNA-seq，并通过下游串行scRNA-seq取样开发与患者匹配的类器官。」</strong><img data-ratio="0.2852822580645161" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicluqDZIvjvQjuJ0wSYP8ScmicbzapUt74uRZVoSnTKnUbzcmtG9fGdoKEqUD8njGgV4uRTM5aqkWw/640?wx_fmt=png" data-type="png" data-w="992" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicluqDZIvjvQjuJ0wSYP8ScmicbzapUt74uRZVoSnTKnUbzcmtG9fGdoKEqUD8njGgV4uRTM5aqkWw/640?wx_fmt=png"></p><p data-tool="mdnice编辑器"><strong>「提出复现的小伙伴比较关心活检部分的复现，活检数据是23042个细胞，其中恶性7740，非恶性细胞15320个。」</strong><img data-ratio="0.49555273189326554" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicluqDZIvjvQjuJ0wSYP8Scv2ATuIhGUhAbhJHAT1OzQj1iaH4X0NuJLhzcrjmA3icuAuvicrfd90RNA/640?wx_fmt=png" data-type="png" data-w="787" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicluqDZIvjvQjuJ0wSYP8Scv2ATuIhGUhAbhJHAT1OzQj1iaH4X0NuJLhzcrjmA3icuAuvicrfd90RNA/640?wx_fmt=png"></p><p data-tool="mdnice编辑器"><strong>「推断的拷贝数变异(CNV)改变评分分离了每个活检中的假定癌和非癌细胞，并与参考靶向DNA-seq显示了高度一致性。」</strong><img data-ratio="1.008635578583765" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicluqDZIvjvQjuJ0wSYP8Sc4cu5e55ribGJvbfx7L3p2oPYYHm5KIRbZnDzerBm0rzVC15IWtzNIJw/640?wx_fmt=png" data-type="png" data-w="579" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicluqDZIvjvQjuJ0wSYP8Sc4cu5e55ribGJvbfx7L3p2oPYYHm5KIRbZnDzerBm0rzVC15IWtzNIJw/640?wx_fmt=png"><strong>「23个病人的CNV score图」</strong></p><p data-tool="mdnice编辑器"><img data-ratio="0.4305555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicluqDZIvjvQjuJ0wSYP8Sccb0kycicAlicGD3CiaXZ2SOOhnt9ZO3TJslr60SayN6knpV0iaPqLOTJAA/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicluqDZIvjvQjuJ0wSYP8Sccb0kycicAlicGD3CiaXZ2SOOhnt9ZO3TJslr60SayN6knpV0iaPqLOTJAA/640?wx_fmt=png"><strong>「细胞亚群注释图」</strong></p><figure data-tool="mdnice编辑器"><img data-ratio="1.0149253731343284" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicluqDZIvjvQjuJ0wSYP8ScXibJEXFWrqVN6J29m8vAZlEy8jicfwI11gFKFwbBnibKiaOlvpHGejqMiaA/640?wx_fmt=png" data-type="png" data-w="268" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicluqDZIvjvQjuJ0wSYP8ScXibJEXFWrqVN6J29m8vAZlEy8jicfwI11gFKFwbBnibKiaOlvpHGejqMiaA/640?wx_fmt=png"></figure><h4 data-tool="mdnice编辑器"><span></span>部分代码复现<span></span></h4><p data-tool="mdnice编辑器"><strong>「step1:导入数据」</strong></p><pre data-tool="mdnice编辑器"><span data-remoteid="c1692849156578" data-cacheurl="https://files.mdnice.com/user/3441/876cad08-0422-409d-bb5a-08afec5da8ee.svg"></span><code>rm(list=ls())<br>options(stringsAsFactors = <span>F</span>) <br><span>library</span>(Seurat)<br><span>library</span>(ggplot2)<br><span>library</span>(clustree)<br><span>library</span>(cowplot)<br><span>library</span>(dplyr)<br><span>library</span>(data.table)<br><span>library</span>(stringr)<br>getwd()<br>setwd(<span>"../"</span>)<br><span>###### step1:导入数据 ######  </span><br><span>#数据是csv格式的就常规读取即可。</span><br>ct=fread(<span>"./SCP1664_raw/Biopsy_RawDGE_23042cells.csv"</span>,data.table = <span>F</span>)<br>ct[<span>1</span>:<span>4</span>,<span>1</span>:<span>4</span>]<br>rownames(ct)=ct[,<span>1</span>]<br>ct=ct[,-<span>1</span>]<br>sce =CreateSeuratObject(counts =  ct ,<br>                        min.cells = <span>5</span>,<br>                        min.features = <span>300</span> )<br><br>head(rownames(sce@meta.data))<br>tail(rownames(sce@meta.data))<br>phe=str_split(rownames(sce@meta.data),<span>'_'</span>,simplify = <span>T</span>)<br>head(phe)<br>tail(phe)<br>sce@meta.data$orig.ident=paste0(<span>''</span>,phe[,<span>2</span>])<br>table(sce@meta.data$orig.ident)<br>sce.all=sce<br>as.data.frame(sce.all@assays$RNA@counts[<span>1</span>:<span>10</span>, <span>1</span>:<span>2</span>])<br>head(sce.all@meta.data, <span>10</span>)<br>tail(sce.all@meta.data, <span>10</span>)<br>table(sce.all$orig.ident)<br></code></pre><p data-tool="mdnice编辑器"><strong>「step2: QC省略」</strong></p><p data-tool="mdnice编辑器"><strong>「step3: 降维分群」</strong></p><pre data-tool="mdnice编辑器"><span></span><code>dir.create(<span>"2-harmony"</span>)<br>getwd()<br>setwd(<span>"2-harmony"</span>)<br><br>sce=sce.all <br>sce<br>sce &lt;- NormalizeData(sce, <br>                         normalization.method = <span>"LogNormalize"</span>,<br>                         scale.factor = <span>1e4</span>) <br>sce &lt;- FindVariableFeatures(sce)<br>sce &lt;- ScaleData(sce)<br>sce &lt;- RunPCA(sce, features = VariableFeatures(object = sce))<br><br><span>library</span>(harmony)<br>seuratObj &lt;- RunHarmony(sce, <span>"orig.ident"</span>)<br>names(seuratObj@reductions)<br>seuratObj &lt;- RunUMAP(seuratObj,  dims = <span>1</span>:<span>15</span>, <br>                     reduction = <span>"harmony"</span>)<br>DimPlot(seuratObj,reduction = <span>"umap"</span>,label=<span>T</span> ) <br>sce=seuratObj<br>sce &lt;- FindNeighbors(sce, reduction = <span>"harmony"</span>,<br>                     dims = <span>1</span>:<span>15</span>) <br>sce.all=sce<br><span>#设置不同的分辨率，观察分群效果</span><br><span>for</span> (res <span>in</span> c(<span>0.01</span>, <span>0.05</span>, <span>0.1</span>, <span>0.2</span>, <span>0.3</span>, <span>0.5</span>,<span>0.8</span>,<span>1</span>)) {<br>  sce.all=FindClusters(sce.all, <span>#graph.name = "CCA_snn",</span><br>                       resolution = res, algorithm = <span>1</span>)<br>}<br>colnames(sce.all@meta.data)<br>apply(sce.all@meta.data[,grep(<span>"RNA_snn"</span>,colnames(sce.all@meta.data))],<span>2</span>,table)<br>head(colnames(sce.all))<br>table(sce.all$orig.ident)<br><br><span>#接下来分析</span><br>sel.clust = <span>"RNA_snn_res.0.8"</span><br>sce.all &lt;- SetIdent(sce.all, value = sel.clust)<br>table(sce.all@active.ident) <br>saveRDS(sce.all, <span>"sce.all_int.rds"</span>)<br>getwd()<br>setwd(<span>'../'</span>)<br></code></pre><p data-tool="mdnice编辑器"><strong>「step4: 检查分群」</strong></p><pre data-tool="mdnice编辑器"><span></span><code><span>###### 检查常见分群情况  ######</span><br>dir.create(<span>"3-cell"</span>)<br>setwd(<span>"3-cell"</span>)  <br>getwd()<br><br><span>#22971</span><br>DimPlot(sce.all, reduction = <span>"umap"</span>, group.by = <span>"seurat_clusters"</span>,label = <span>T</span>) <br>DimPlot(sce.all, reduction = <span>"umap"</span>, group.by = <span>"RNA_snn_res.0.8"</span>,label = <span>T</span>) <br>ggsave(<span>'umap_by_RNA_snn_res.0.8.pdf'</span>,width = <span>8</span>,height = <span>6</span>)<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.7395104895104895" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicluqDZIvjvQjuJ0wSYP8ScrIibyExWCWo2nFTIw00hMQf86AQzGY2ISGjBNEuJt2B3eWBPjqfiakrw/640?wx_fmt=png" data-type="png" data-w="572" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicluqDZIvjvQjuJ0wSYP8ScrIibyExWCWo2nFTIw00hMQf86AQzGY2ISGjBNEuJt2B3eWBPjqfiakrw/640?wx_fmt=png"></figure><pre data-tool="mdnice编辑器"><span></span><code>sce.all=RunTSNE(sce.all,  dims = <span>1</span>:<span>15</span>, <br>                reduction = <span>"harmony"</span>)<br>p_tsne=DimPlot(sce.all, reduction = <span>"tsne"</span>, group.by = <span>"RNA_snn_res.0.8"</span>,label = <span>T</span>);p_tsne<br>ggsave(<span>'tsne_by_RNA_snn_res.0.8.pdf'</span>,width = <span>8</span>,height = <span>6</span>)<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.7309833024118738" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicluqDZIvjvQjuJ0wSYP8Sc9N5oqqfomDIspfzCp1sSKhKDqptwyks8p5HSk3za4lnUvaRzMsdnUg/640?wx_fmt=png" data-type="png" data-w="539" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicluqDZIvjvQjuJ0wSYP8Sc9N5oqqfomDIspfzCp1sSKhKDqptwyks8p5HSk3za4lnUvaRzMsdnUg/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">之后该篇文献的图会陆续复现，主要针对活检Biopsy部分。</p><p data-tool="mdnice编辑器">这篇文献最主要部分就是通过CNV来分开恶性和非恶性细胞，我会继续尝试复现的。</p><p data-tool="mdnice编辑器"><strong>「文章中降维分群tsne结果」</strong></p><figure data-tool="mdnice编辑器"><img data-ratio="1.1272727272727272" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicluqDZIvjvQjuJ0wSYP8ScpdP7ic9cqmTXfiah6KdC7fpWAjfJP6AqD2bGqkibxnOqkj83iba8oDUwAw/640?wx_fmt=png" data-type="png" data-w="385" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicluqDZIvjvQjuJ0wSYP8ScpdP7ic9cqmTXfiah6KdC7fpWAjfJP6AqD2bGqkibxnOqkj83iba8oDUwAw/640?wx_fmt=png"></figure><figure data-tool="mdnice编辑器"><span>微信交流群</span></figure><p data-tool="mdnice编辑器">如果你也想参与到群里的讨论中，给我提出一些推文更新建议的话欢迎入群。同时你也可以得到我前期更新的所有数据及代码，在群里我会把代码分享给大家，而且大家可以在群里「提出自己感兴趣的单细胞文献」<strong>「我们尽可能优先选择大家的数据集去复现和实战，也欢迎大家在群里分享更多其它资料，咱们一起进步，」</strong>「比较高级的单细胞分析」**我们也会一起尝试， 相信你肯定是会不虚此行哈。</p><p data-tool="mdnice编辑器">附上之前推文的链接 <a href="https://mp.weixin.qq.com/s?__biz=MzUzMTEwODk0Ng==&amp;mid=2247512238&amp;idx=1&amp;sn=e0c6dc2ea0e089aabb78133e50fb5d7f&amp;scene=21#wechat_redirect" data-linktype="2">为爱发电不可取（单细胞周更需要你的支持）</a></p><p data-tool="mdnice编辑器"><strong>「「目前群里已经有300多人，所以你想要进群的话就需要添加我的微信，私聊给我发99元的红包，我把你拉进群里。」」</strong></p><p data-tool="mdnice编辑器">我们这个群是真正的付费交流群，不仅提供数据，代码，学习资料，而且也会跟大家互动交流，还会坚持进行创作至少一年。所以，如果介意99元的门槛且不认可我们知识分享的理念，<strong>「请不要加我好友」</strong>。。</p><figure data-tool="mdnice编辑器"><img data-ratio="1" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicluqDZIvjvQjuJ0wSYP8ScS3I7CWvP2wrXxwWsrMdCtluV252X58kxpNQ9ibiaj4o09AnDltuQsib0Q/640?wx_fmt=png" data-type="png" data-w="172" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicluqDZIvjvQjuJ0wSYP8ScS3I7CWvP2wrXxwWsrMdCtluV252X58kxpNQ9ibiaj4o09AnDltuQsib0Q/640?wx_fmt=png"></figure></section><p><mp-style-type data-value="10000"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/BnRYd3L3y-OLwSoK3fIjlw",target="_blank" rel="noopener noreferrer">原文链接</a>
