---
title: "R绘图基础篇 | 散点+分组+size+显著性~~"
date: 2023-08-30T15:35:09Z
draft: ["false"]
tags: [
  "fetched",
  "DataCharm"
]
categories: ["Acdemic"]
---
R绘图基础篇 | 散点+分组+size+显著性~~ by DataCharm
------
<div><section data-mpa-powered-by="yiban.io"><section><section> </section><section><p>点击上方</p><p>“科研后花园”</p><p>关注我们</p></section></section></section><section><section><section><section><img data-ratio="1" data-type="png" data-src="https://mmbiz.qpic.cn/mmbiz_gif/oMlX8Lll9Jiaea3YIKcpLeSJaaiaWVK358NqKqPPqazkw26Aw72MCKfQtL07g9rBNptVKGicFGRibZU5XGpO4UWcSw/640?wx_fmt=gif" data-w="64" src="https://mmbiz.qpic.cn/mmbiz_gif/oMlX8Lll9Jiaea3YIKcpLeSJaaiaWVK358NqKqPPqazkw26Aw72MCKfQtL07g9rBNptVKGicFGRibZU5XGpO4UWcSw/640?wx_fmt=gif"></section><section><p>灵感来源：</p></section></section></section></section><p><img data-galleryid="" data-ratio="0.24881141045958796" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/RB50ficWibY0njhUbJ0MAL6G5zgE0JQGp8pRFVAQUgvW3fa4BNWzJiact4xf5RAOOWfTe7QtLWoRfdEcxC7fbVBBw/640?wx_fmt=png" data-type="png" data-w="631" src="https://mmbiz.qpic.cn/mmbiz_png/RB50ficWibY0njhUbJ0MAL6G5zgE0JQGp8pRFVAQUgvW3fa4BNWzJiact4xf5RAOOWfTe7QtLWoRfdEcxC7fbVBBw/640?wx_fmt=png"></p><p><img data-galleryid="" data-ratio="0.7755644090305445" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/RB50ficWibY0njhUbJ0MAL6G5zgE0JQGp8bJMvUf4vDBeSdD0rvzyIeq5982IdqAjNSJ5jbLuNIVcaAroUQ41Rgw/640?wx_fmt=png" data-type="png" data-w="753" src="https://mmbiz.qpic.cn/mmbiz_png/RB50ficWibY0njhUbJ0MAL6G5zgE0JQGp8bJMvUf4vDBeSdD0rvzyIeq5982IdqAjNSJ5jbLuNIVcaAroUQ41Rgw/640?wx_fmt=png"></p><section><section><section><section><section><section><span><strong><span>代码如下：</span></strong></span><span></span></section><section><span><strong><span>1、设置工作环境：</span></strong></span><span><br></span></section><section><ul><li><li><li><li><li><li></ul><pre data-lang="php"><code><span>rm(<span>list</span> = ls())</span></code><code><span>setwd(<span>"D:/桌面/散点+分组+size+显著性"</span>)</span></code><code><span><br></span></code><code><span><span>#加载R包</span></span></code><code><span>library(ggplot2) <span># Create Elegant Data Visualisations Using the Grammar of Graphics</span></span></code><code><span>library(rstatix) <span># Pipe-Friendly Framework for Basic Statistical Tests</span></span></code></pre></section><section><span><strong><span></span></strong></span></section><section><span><strong><span>2、加载数据：<br></span></strong></span></section><section><ul><li><li><li><li><li></ul><pre data-lang="nginx"><code><span><span>#加载绘图数据（随机编写，无实际意义）</span></span></code><code><span><span>df</span> &lt;- read.table(<span>"data.txt"</span>, header = <span>1</span>, check.names = F)</span></code><code><span>df<span>$group1</span> &lt;- factor(df<span>$group1</span>, levels = c(<span>"One"</span>, <span>"Two"</span>, <span>"Three"</span>))</span></code><code><span>df<span>$group2</span> &lt;- factor(df<span>$group2</span>, levels = c(<span>"1"</span>, <span>"2"</span>, <span>"3"</span>,<span>"4"</span>, <span>"5"</span>, <span>"6"</span>))</span></code><code><span>df$<span>group3</span> &lt;- factor(df<span>$group3</span>, levels = c(<span>"A"</span>, <span>"B"</span>))</span></code></pre></section><section><span><strong><span></span></strong></span></section><p><img data-galleryid="" data-ratio="0.7892376681614349" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/RB50ficWibY0njhUbJ0MAL6G5zgE0JQGp8HUeAklTpiapYGkLrKWxdY1uOtsTKxCA8icichjG3yPMjR2qichYBCu0wCw/640?wx_fmt=png" data-type="png" data-w="446" src="https://mmbiz.qpic.cn/mmbiz_png/RB50ficWibY0njhUbJ0MAL6G5zgE0JQGp8HUeAklTpiapYGkLrKWxdY1uOtsTKxCA8icichjG3yPMjR2qichYBCu0wCw/640?wx_fmt=png"></p><section><span><strong><span>3、计算组间显著性：<br></span></strong></span></section><section><ul><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="nginx"><code><span><span>#计算显著性</span></span></code><code><span><span>p</span> &lt;- df[df<span>$group1</span> == <span>"Two"</span>, ] %&gt;% </span></code><code><span>  wilcox_test(Score <span>~ group3)</span> %&gt;%</span></code><code><span>  adjust_pvalue()</span></code><code><span>p</span></code><code><span><br></span></code><code><span><span># # A tibble: 1 × 8</span></span></code><code><span><span># .y.   group1 group2    n1    n2 statistic        p    p.adj</span></span></code><code><span><span># &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;  &lt;int&gt; &lt;int&gt;     &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;</span></span></code><code><span><span>#   1 Score A      B         13     9       113 0.000271 0.000271</span></span></code></pre></section><section><span><strong><span></span></strong></span></section><section><span><strong><span>4、绘图：<br></span></strong></span></section><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="php"><code><span><span>#绘图</span></span></code><code><span>ggplot(df)+</span></code><code><span>  <span>#散点图</span></span></code><code><span>  geom_point(aes(x = group2, y = Score, </span></code><code><span>                 color = group3, size = Count))+</span></code><code><span>  <span>#设置分面</span></span></code><code><span>  facet_grid(~group1,</span></code><code><span>             <span>switch</span>=<span>'x'</span>)+<span>#switch='x'可将标签位置由顶部移至底部，当switch='y'时，可将位于右边的分面标签移至左边</span></span></code><code><span>  <span>#主题设置</span></span></code><code><span>  theme_bw()+</span></code><code><span>  theme(axis.text.x = element_blank(),</span></code><code><span>        axis.text.y = element_text(color = <span>"black"</span>, size = <span>12</span>),</span></code><code><span>        axis.title = element_text(color = <span>"black"</span>, size = <span>14</span>),</span></code><code><span>        axis.ticks.x = element_blank(),</span></code><code><span>        strip.background = element_blank(),</span></code><code><span>        strip.text = element_text(color = <span>"black"</span>, size = <span>12</span>),</span></code><code><span>        panel.grid = element_blank())+</span></code><code><span>  <span>#调整size范围</span></span></code><code><span>  scale_size_continuous(range = c(<span>2</span>, <span>7</span>), breaks = c(<span>1</span>,<span>3</span>,<span>6</span>))+</span></code><code><span>  <span>#颜色</span></span></code><code><span>  scale_color_manual(values = c(<span>"#ff4e00"</span>,<span>"#01cd74"</span>))+</span></code><code><span>  <span>#y轴范围及刻度设置</span></span></code><code><span>  scale_y_continuous(breaks = c(<span>0</span>,<span>1</span>,<span>2</span>,<span>3</span>,<span>4</span>,<span>5</span>,<span>6</span>,<span>7</span>))+</span></code><code><span>  <span>#图例</span></span></code><code><span>  guides(color=guide_legend(override.aes = <span>list</span>(size=<span>4</span>,alpha=<span>1</span>)))+</span></code><code><span>  labs(x = <span>NULL</span>, color = <span>NULL</span>)+</span></code><code><span>  <span>#手动添加显著性</span></span></code><code><span>  geom_segment(df[df$group1 == <span>"Two"</span>, ], mapping = aes(x = <span>2</span>, xend = <span>5</span>, y = <span>7.5</span>, yend = <span>7.5</span>),</span></code><code><span>               color = <span>"black"</span>, linewidth = <span>0.6</span>)+</span></code><code><span>  geom_text(df[df$group1 == <span>"Two"</span>, ], mapping = aes(x = <span>3.5</span>, y = <span>8</span>, label = <span>'p &lt; 0.001'</span>), size =<span>4.5</span>, color=<span>"black"</span>)</span></code></pre></section><section><span><strong><span></span></strong></span></section><p><img data-galleryid="" data-ratio="0.45925925925925926" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/RB50ficWibY0njhUbJ0MAL6G5zgE0JQGp8RP3sbNAYP3uibJtxxLHyMg5SmZwrvniaMV3QMSLVaXdhNibVPIt1tPTcQ/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/RB50ficWibY0njhUbJ0MAL6G5zgE0JQGp8RP3sbNAYP3uibJtxxLHyMg5SmZwrvniaMV3QMSLVaXdhNibVPIt1tPTcQ/640?wx_fmt=png"></p></section></section></section></section></section><p><strong><span>PS: <span>以上</span><span>内容是</span>小编个人学习代码笔记分享，</span><span>仅供参考学习，欢迎大家一起交流学习。</span></strong></p><p><br></p><section><section><table><tbody><tr><td width="557" valign="top"><p><a target="_blank" href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=Mzg3MDY4ODI3MQ==&amp;action=getalbum&amp;album_id=2093768003036282880#wechat_redirect" textvalue="你已选中了添加链接的内容" tab="innerlink" data-linktype="1"><span data-positionback="static"><img data-cropselx1="0" data-cropselx2="556" data-cropsely1="0" data-cropsely2="111" data-ratio="0.2" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/LVW0j64NZC1LuTk1NOIKnKxiag3oLiaQADKZWyGLUOzaZme3mEH0yfya5I3nYBqpfUN9YiaZaUOCDibh8kMg9lkZYg/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/LVW0j64NZC1LuTk1NOIKnKxiag3oLiaQADKZWyGLUOzaZme3mEH0yfya5I3nYBqpfUN9YiaZaUOCDibh8kMg9lkZYg/640?wx_fmt=png"></span></a></p></td></tr></tbody></table><table><tbody><tr><td width="557" valign="top"><p><a target="_blank" href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=Mzg3MDY4ODI3MQ==&amp;action=getalbum&amp;album_id=2095285554954272769#wechat_redirect" textvalue="你已选中了添加链接的内容" tab="innerlink" data-linktype="1"><span data-positionback="static"><img data-cropselx1="0" data-cropselx2="556" data-cropsely1="0" data-cropsely2="111" data-ratio="0.2" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/LVW0j64NZC1LuTk1NOIKnKxiag3oLiaQAD7QAAicABgs5xgupznIfhBPGtcOVbibRlVesghXNEHEGsW9xfAqVWdIcg/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/LVW0j64NZC1LuTk1NOIKnKxiag3oLiaQAD7QAAicABgs5xgupznIfhBPGtcOVbibRlVesghXNEHEGsW9xfAqVWdIcg/640?wx_fmt=png"></span></a></p></td></tr></tbody></table><table><tbody><tr><td width="557" valign="top"><p><a target="_blank" href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=Mzg3MDY4ODI3MQ==&amp;action=getalbum&amp;album_id=2096600553563783169#wechat_redirect" textvalue="你已选中了添加链接的内容" tab="innerlink" data-linktype="1"><span data-positionback="static"><img data-cropselx1="0" data-cropselx2="556" data-cropsely1="0" data-cropsely2="111" data-ratio="0.2" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/LVW0j64NZC1LuTk1NOIKnKxiag3oLiaQADtSIEGGxGTF7ibQmh4JBXaLELD7nbp2zb4PHeqCQQwUexCicLic9qDn1IQ/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/LVW0j64NZC1LuTk1NOIKnKxiag3oLiaQADtSIEGGxGTF7ibQmh4JBXaLELD7nbp2zb4PHeqCQQwUexCicLic9qDn1IQ/640?wx_fmt=png"></span></a></p></td></tr></tbody></table><table><tbody><tr><td width="557" valign="top"><p><a target="_blank" href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=Mzg3MDY4ODI3MQ==&amp;action=getalbum&amp;album_id=2094871359968411648#wechat_redirect" textvalue="你已选中了添加链接的内容" tab="innerlink" data-linktype="1"><span data-positionback="static"><img data-cropselx1="0" data-cropselx2="556" data-cropsely1="0" data-cropsely2="111" data-ratio="0.2" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/LVW0j64NZC1LuTk1NOIKnKxiag3oLiaQADicpXibjUibCG9GCDkhy1BthwXUC5ntWe1YyCcMePALdelARNsgSq4CqAg/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/LVW0j64NZC1LuTk1NOIKnKxiag3oLiaQADicpXibjUibCG9GCDkhy1BthwXUC5ntWe1YyCcMePALdelARNsgSq4CqAg/640?wx_fmt=png"></span></a></p></td></tr></tbody></table><table><tbody><tr><td width="747" valign="top"><p><a target="_blank" href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=Mzg3MDY4ODI3MQ==&amp;action=getalbum&amp;album_id=2093526031474262020#wechat_redirect" textvalue="你已选中了添加链接的内容" tab="innerlink" data-linktype="1"><span data-positionback="static"><img data-cropselx1="0" data-cropselx2="556" data-cropsely1="0" data-cropsely2="111" data-ratio="0.2" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/LVW0j64NZC1LuTk1NOIKnKxiag3oLiaQADEibCXA7n4FxkLPtficGANZo2msZlEqKg2sRgp0RicWJVgo0RRibG4LKAJQ/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/LVW0j64NZC1LuTk1NOIKnKxiag3oLiaQADEibCXA7n4FxkLPtficGANZo2msZlEqKg2sRgp0RicWJVgo0RRibG4LKAJQ/640?wx_fmt=png"></span></a></p></td></tr></tbody></table><table><tbody><tr><td width="557" valign="top"><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=Mzg3MDY4ODI3MQ==&amp;mid=2247497993&amp;idx=2&amp;sn=0747d9b7dc3cd9924d11caa7c39d06a3&amp;chksm=ce8b4a69f9fcc37fcd8f695436c6ba6201ad96cf40b85993901e3a6d6e652b947e8681537846&amp;scene=21#wechat_redirect" textvalue="你已选中了添加链接的内容" data-itemshowtype="0" tab="innerlink" data-linktype="1"><span data-positionback="static"><img data-cropselx1="0" data-cropselx2="556" data-cropsely1="0" data-cropsely2="111" data-ratio="0.2" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/LVW0j64NZC1LuTk1NOIKnKxiag3oLiaQADVNhPxxQ1Mib6zFJDf7Hrsh8EtoCO3oZlI6p5rpEDFDzKrjlestUlM1w/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/LVW0j64NZC1LuTk1NOIKnKxiag3oLiaQADVNhPxxQ1Mib6zFJDf7Hrsh8EtoCO3oZlI6p5rpEDFDzKrjlestUlM1w/640?wx_fmt=png"></span></a></p></td></tr></tbody></table><table><tbody><tr><td width="557" valign="top"><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=Mzg3MDY4ODI3MQ==&amp;mid=2247497984&amp;idx=1&amp;sn=8db57733b0e1c0b1375826a0a643b25d&amp;chksm=ce8b4a60f9fcc37677b82148403407e333ab745cf2b0243b1c4d1d8af756f883b077f9b5da6c&amp;scene=21#wechat_redirect" textvalue="你已选中了添加链接的内容" data-itemshowtype="0" tab="innerlink" data-linktype="1"><span data-positionback="static"><img data-cropselx1="0" data-cropselx2="556" data-cropsely1="0" data-cropsely2="111" data-ratio="0.2" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/LVW0j64NZC1LuTk1NOIKnKxiag3oLiaQAD7eibzCvqxVYCcexQaxh8iaL59Tarbx9usfN0vNgFcibNYaP0hicYfjf1kQ/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/LVW0j64NZC1LuTk1NOIKnKxiag3oLiaQAD7eibzCvqxVYCcexQaxh8iaL59Tarbx9usfN0vNgFcibNYaP0hicYfjf1kQ/640?wx_fmt=png"></span></a></p></td></tr></tbody></table><p><br></p><p><img data-galleryid="" data-ratio="0.46467391304347827" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/AGAUoAhqkDNl1icjcibYsVUDG6USoBs1463frpsk5XNMYytziarC6UoTMZnbIJMf3g6GleZmsxRWE7ZUcRzfia8FHw/640?wx_fmt=png" data-type="png" data-w="1472" src="https://mmbiz.qpic.cn/mmbiz_png/AGAUoAhqkDNl1icjcibYsVUDG6USoBs1463frpsk5XNMYytziarC6UoTMZnbIJMf3g6GleZmsxRWE7ZUcRzfia8FHw/640?wx_fmt=png"></p><section><br></section></section></section><p><mp-style-type data-value="10000"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/QmOG1hwzY_oPSC5Q4U_h6w",target="_blank" rel="noopener noreferrer">原文链接</a>
