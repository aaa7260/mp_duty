---
title: "寻找两个变量的相关性--变量间的相关性分析和分布图"
date: 2023-08-18T23:43:09Z
draft: ["false"]
tags: [
  "fetched",
  "东林的扯淡小屋"
]
categories: ["Acdemic"]
---
寻找两个变量的相关性--变量间的相关性分析和分布图 by 东林的扯淡小屋
------
<div><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="php"><code><span>data(mtcars)<span>#加载数据集</span></span></code><code><span>mydata &lt;- mtcars[, c(<span>1</span>,<span>3</span>,<span>4</span>,<span>5</span>,<span>6</span>,<span>7</span>)]</span></code><code><span>head(mydata, <span>6</span>)<span>#查看数据前6行</span></span></code><code><span><span>#计算相关系数矩阵</span></span></code><code><span>res &lt;- cor(mydata)</span></code><code><span>round(res, <span>2</span>)<span>#保留两位小数</span></span></code><code><span>library(Hmisc)<span>#加载包</span></span></code><code><span>res2 &lt;- rcorr(<span>as</span>.matrix(mydata))</span></code><code><span>res2</span></code><code><span><span>#可以用res2$r、res2$P来提取相关系数以及显著性p-value</span></span></code><code><span>res2$r</span></code><code><span>res2$P</span></code><code><span><span>#如何将相关系数以及显著性水平p-value整合进一个矩阵内，可以自定义一个函数flattenCorrMatrix。</span></span></code><code><span><br></span></code><code><span><span># ++++++++++++++++++++++++++++</span></span></code><code><span><span># flattenCorrMatrix</span></span></code><code><span><span># ++++++++++++++++++++++++++++</span></span></code><code><span><span># cormat : matrix of the correlation coefficients</span></span></code><code><span><span># pmat : matrix of the correlation p-values</span></span></code><code><span>flattenCorrMatrix &lt;- <span><span>function</span><span>(cormat, pmat)</span> </span>{</span></code><code><span>  ut &lt;- upper.tri(cormat) </span></code><code><span>  data.frame( row = rownames(cormat)[row(cormat)[ut]], </span></code><code><span>                                      column = rownames(cormat)[col(cormat)[ut]], cor =(cormat)[ut], p = pmat[ut] )</span></code><code><span>}</span></code><code><span>res3 &lt;- rcorr(<span>as</span>.matrix(mtcars[,<span>1</span>:<span>7</span>]))</span></code><code><span>flattenCorrMatrix(res3$r, res3$P)</span></code><code><span><span># Use chart.Correlation(): Draw scatter plots</span></span></code><code><span><span># *chart.Correlation()*来自于包PerformanceAnalytics</span></span></code><code><span><br></span></code><code><span>library(PerformanceAnalytics)<span>#加载包</span></span></code><code><span>chart.Correlation(mydata, histogram=<span>TRUE</span>, pch=<span>19</span>)</span></code><code><span><br></span></code><code><span><span>#heatmap()</span></span></code><code><span>col&lt;- colorRampPalette(c(<span>"blue"</span>, <span>"white"</span>, <span>"red"</span>))(<span>20</span>)<span>#调用颜色版自定义颜色</span></span></code><code><span>heatmap(x = res, col = col, symm = <span>TRUE</span>)<span>#symm表示是否对称</span></span></code><code><span><br></span></code><code><span><span>#https://taoyan.netlify.app/post/2017-06-25.r%E8%AF%AD%E8%A8%80%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%B9%8B%E7%9B%B8%E5%85%B3%E6%80%A7%E7%9F%A9%E9%98%B5%E5%88%86%E6%9E%90%E5%8F%8A%E5%85%B6%E5%8F%AF%E8%A7%86%E5%8C%96/</span></span></code><code><span><span>#https://www.cnblogs.com/fanling999/p/5857122.html</span></span></code></pre></section><p><img data-galleryid="" data-ratio="0.6416666666666667" data-s="300,640" data-type="png" data-w="1080" data-src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBoBpib9jaG5Pf4qcET4jDAjnEibJDKEaiaj5jByv53eV9m3DOyXqk9T3RnPljXt4qPoUwAvr6ick9gxQA/640?wx_fmt=png" src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBoBpib9jaG5Pf4qcET4jDAjnEibJDKEaiaj5jByv53eV9m3DOyXqk9T3RnPljXt4qPoUwAvr6ick9gxQA/640?wx_fmt=png"></p><p><img data-galleryid="" data-ratio="1.0629629629629629" data-s="300,640" data-type="jpeg" data-w="1080" data-src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBoBpib9jaG5Pf4qcET4jDAjnZfOrcuznC3x0cQEhUbhI7Kp0YZF20iaCpe9APAW0UVdx7BRricu5KDOQ/640?wx_fmt=png" src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBoBpib9jaG5Pf4qcET4jDAjnZfOrcuznC3x0cQEhUbhI7Kp0YZF20iaCpe9APAW0UVdx7BRricu5KDOQ/640?wx_fmt=png"></p><p><img data-galleryid="" data-ratio="1.0629629629629629" data-s="300,640" data-type="jpeg" data-w="1080" data-src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBoBpib9jaG5Pf4qcET4jDAjnL4avzk8svGQUPRnmkX0sfMbAJns3iamhQMbPZHqxjdQmALE0vtKB42w/640?wx_fmt=png" src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBoBpib9jaG5Pf4qcET4jDAjnL4avzk8svGQUPRnmkX0sfMbAJns3iamhQMbPZHqxjdQmALE0vtKB42w/640?wx_fmt=png"><span></span></p><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/7-SuK9BDKcjVfuFec6HmuA",target="_blank" rel="noopener noreferrer">原文链接</a>
