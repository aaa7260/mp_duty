---
title: "3款经典转录组测序差异分析R包的一致性如何"
date: 2023-08-15T14:07:50Z
draft: ["false"]
tags: [
  "fetched",
  "生信技能树"
]
categories: ["Acdemic"]
---
3款经典转录组测序差异分析R包的一致性如何 by 生信技能树
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><blockquote data-tool="mdnice编辑器"><p>刷到了一个新鲜出炉（2023-08-10）的生物信息学数据挖掘文章：《Integrating bioinformatic resources to identify characteristics of rheumatoid arthritis-related usual interstitial pneumonia》</p></blockquote><p data-tool="mdnice编辑器">这个文章做了 Differentially expression analysis of GSE199152 ，这个数据集  GSE199152 (3 RA-UIP, 20 IPF-UIP patients and 4 non-UIP controls)  ，然后就可视化了 DESeq2, EdgeR and Limma packages were used to filter up-regulated DEGs</p><section><mp-common-videosnap data-pluginname="mpvideosnap" data-headimgurl="https://wx.qlogo.cn/finderhead/PiajxSqBRaEI7scvWIPdECSfnUpSjTib9Y7RI14r1VVzxaA57PjcCERw/0" data-username="v2_060000231003b20faec8c7e1881bcad2ca06ec35b07788412aec898c89eb1e34f9a354475e8c@finder" data-nickname="生信技能树" data-desc="将在08月16日 19:00 直播" data-livewording="预约" data-intro="转录组测序表达量矩阵下游分析一站式代码讲解" data-type="live" data-status="0" data-noticeid="finderlivenotice-v2_060000231003b20faec8c7e1881bcad2ca06ec35b07788412aec898c89eb1e34f9a354475e8c@finder-1692027241145377-789502682" data-isdisabled="0" data-errortips=""></mp-common-videosnap></section><p data-tool="mdnice编辑器"><strong>也就是说，作者仅仅是关心里面的上调基因，然后针对交集基因列表去做功能富集。关于这个交集基因作者使用了一个韦恩图展示</strong>，如下所示：</p><p><img data-galleryid="" data-ratio="1.1377870563674322" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wypJRHQOhvMrrLB669peNCIMmJGzNqMs286qmqhnuicY1MeWWhSzGQ8OOV0GATK8GeRVPmvia5U7ozw/640?wx_fmt=png" data-type="png" data-w="958" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wypJRHQOhvMrrLB669peNCIMmJGzNqMs286qmqhnuicY1MeWWhSzGQ8OOV0GATK8GeRVPmvia5U7ozw/640?wx_fmt=png"></p><figure data-tool="mdnice编辑器"><figcaption>DESeq2, EdgeR and Limma的交集</figcaption></figure><h3 data-tool="mdnice编辑器"><span></span>学徒作业<span></span></h3><p data-tool="mdnice编辑器">做起码<strong>10个转录组测序数据</strong>的表达量矩阵的 DESeq2, EdgeR and Limma的差异分析然后可视化他们的交集的汇总情况。</p><p data-tool="mdnice编辑器">下面给出来一个示例代码:</p><h4 data-tool="mdnice编辑器"><span></span>step1:表达量矩阵整理<span></span></h4><pre data-tool="mdnice编辑器"><span></span><code><span># 魔幻操作，一键清空</span><br>rm(list = ls()) <br>options(stringsAsFactors = <span>F</span>)<br><span>library</span>(data.table)<br><span>library</span>(airway,quietly = <span>T</span>)<br>data(airway) <br>mat &lt;- assay(airway) <br>mat[<span>1</span>:<span>4</span>,<span>1</span>:<span>4</span>]<br>keep_feature &lt;- rowSums (mat &gt; <span>1</span>) &gt; <span>1</span> <br>ensembl_matrix &lt;- mat[keep_feature, ]  <br><span>library</span>(AnnoProbe)<br>head(rownames(ensembl_matrix))<br>ids=annoGene(rownames(ensembl_matrix),<span>'ENSEMBL'</span>,<span>'human'</span>)<br>head(ids)<br>ids=ids[!duplicated(ids$SYMBOL),]<br>ids=ids[!duplicated(ids$ENSEMBL),]<br>symbol_matrix= ensembl_matrix[match(ids$ENSEMBL,rownames(ensembl_matrix)),]<br><br>rownames(symbol_matrix) = ids$SYMBOL<br>symbol_matrix[<span>1</span>:<span>4</span>,<span>1</span>:<span>4</span>]<br>group_list = as.character(airway@colData$dex);group_list<br>group_list=ifelse(group_list==<span>'untrt'</span>,<span>'control'</span>,<span>'case'</span> )<br>table(group_list)<br>group_list = factor(group_list,levels = c(<span>'control'</span>,<span>'case'</span> )) <br>save(symbol_matrix,group_list,file = <span>'symbol_matrix.Rdata'</span>)<br></code></pre><h4 data-tool="mdnice编辑器"><span></span>step2.1 : 使用DESeq2做差异分析<span></span></h4><pre data-tool="mdnice编辑器"><span></span><code><span>library</span>(limma)<br><span>library</span>(edgeR)<br><span>library</span>(DESeq2)<br><br>load(file = <span>'symbol_matrix.Rdata'</span>) <br>symbol_matrix[<span>1</span>:<span>4</span>,<span>1</span>:<span>4</span>]<br>exprSet = symbol_matrix<br><br>(colData &lt;- data.frame(row.names=colnames(exprSet), <br>                       group_list=group_list) )<br>dds &lt;- DESeqDataSetFromMatrix(countData = exprSet,<br>                              colData = colData,<br>                              design = ~ group_list)<br>dds &lt;- DESeq(dds) <br>res &lt;- results(dds, <br>               contrast=c(<span>"group_list"</span>,<br>                          levels(group_list)[<span>2</span>],<br>                          levels(group_list)[<span>1</span>]))<br>resOrdered &lt;- res[order(res$padj),]<br>head(resOrdered)<br>DEG =as.data.frame(resOrdered)<br>DEG_deseq2 = na.omit(DEG)<br>   <br>save(DEG_deseq2, <br>     file =  <span>'DEG_deseq2.Rdata'</span> ) <br></code></pre><h4 data-tool="mdnice编辑器"><span></span>step2.2 : 使用edgeR做差异分析<span></span></h4><pre data-tool="mdnice编辑器"><span></span><code><br>load(file = <span>'symbol_matrix.Rdata'</span>) <br>symbol_matrix[<span>1</span>:<span>4</span>,<span>1</span>:<span>4</span>]<br>exprSet = symbol_matrix<br> <br>d &lt;- DGEList(counts=exprSet, <br>             group= group_list)<br>keep &lt;- rowSums(cpm(d)&gt;<span>1</span>) &gt;= <span>2</span><br>table(keep)<br>d &lt;- d[keep, , keep.lib.sizes=<span>FALSE</span>]<br>d$samples$lib.size &lt;- colSums(d$counts)<br>d &lt;- calcNormFactors(d)<br>d$samples<br><br>dge=d<br>design &lt;- model.matrix(~<span>0</span>+factor(group_list))<br>rownames(design)&lt;-colnames(dge)<br>colnames(design)&lt;-levels(factor(group_list))<br><br>dge &lt;- estimateGLMCommonDisp(dge,design)<br>dge &lt;- estimateGLMTrendedDisp(dge, design)<br>dge &lt;- estimateGLMTagwiseDisp(dge, design)<br><br>fit &lt;- glmFit(dge, design)<br><span># https://www.biostars.org/p/110861/</span><br>lrt &lt;- glmLRT(fit,  contrast=c(-<span>1</span>,<span>1</span>)) <br>nrDEG=topTags(lrt, n=nrow(dge))<br><br>DEG_edgeR = as.data.frame(nrDEG)<br>head(DEG_edgeR)<br> <br>save(DEG_edgeR, <br>     file =  <span>'DEG_edgeR.Rdata'</span> ) <br><br></code></pre><h4 data-tool="mdnice编辑器"><span></span>step2.3 : 使用limma做差异分析<span></span></h4><pre data-tool="mdnice编辑器"><span></span><code><br>load(file = <span>'symbol_matrix.Rdata'</span>) <br>symbol_matrix[<span>1</span>:<span>4</span>,<span>1</span>:<span>4</span>]<br>exprSet = symbol_matrix<br><br>design &lt;- model.matrix(~<span>0</span>+factor(group_list))<br>colnames(design)=levels(factor(group_list))<br>rownames(design)=colnames(exprSet)<br>design<br><br>dge &lt;- DGEList(counts=exprSet)<br>dge &lt;- calcNormFactors(dge)<br>logCPM &lt;- cpm(dge, log=<span>TRUE</span>, prior.count=<span>3</span>)<br>v &lt;- voom(dge,design,plot=<span>TRUE</span>, normalize=<span>"quantile"</span>)<br><br>fit &lt;- lmFit(v, design)<br>group_list<br>g1=levels(group_list)[<span>1</span>]<br>g2=levels(group_list)[<span>2</span>]<br>con=paste0(g2,<span>'-'</span>,g1)<br>cat(con)<br>cont.matrix=makeContrasts(contrasts=c(con),levels = design)<br>fit2=contrasts.fit(fit,cont.matrix)<br>fit2=eBayes(fit2)<br><br>tempOutput = topTable(fit2, coef=con, n=<span>Inf</span>)<br>DEG_limma_voom = na.omit(tempOutput)<br>head(DEG_limma_voom)<br> <br>save(DEG_limma_voom, <br>     file =  <span>'DEG_limma_voom.Rdata'</span> ) <br><br><br></code></pre></section><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><h3 data-tool="mdnice编辑器"><span></span>邀请优秀的小伙伴讲解自己如何完成学徒作业<span></span></h3><p data-tool="mdnice编辑器">目前学徒作业已经持续了四年多，而且有两三百个不同方向的练习题，我们会邀请小伙伴参与分享自己的完成学徒作业的经历</p><section><mp-common-videosnap data-pluginname="mpvideosnap" data-headimgurl="https://wx.qlogo.cn/finderhead/PiajxSqBRaEI7scvWIPdECSfnUpSjTib9Y7RI14r1VVzxaA57PjcCERw/0" data-username="v2_060000231003b20faec8c7e1881bcad2ca06ec35b07788412aec898c89eb1e34f9a354475e8c@finder" data-nickname="生信技能树" data-desc="将在08月16日 19:00 直播" data-livewording="预约" data-intro="转录组测序表达量矩阵下游分析一站式代码讲解" data-type="live" data-status="0" data-noticeid="finderlivenotice-v2_060000231003b20faec8c7e1881bcad2ca06ec35b07788412aec898c89eb1e34f9a354475e8c@finder-1692027241145377-789502682" data-isdisabled="0" data-errortips=""></mp-common-videosnap></section></section><p><br></p><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/TZEx1ppxq0iquvq0pW4L4A",target="_blank" rel="noopener noreferrer">原文链接</a>
