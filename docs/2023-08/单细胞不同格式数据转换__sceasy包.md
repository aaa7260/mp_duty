---
title: "单细胞不同格式数据转换——sceasy包"
date: 2023-08-19T00:25:41Z
draft: ["false"]
tags: [
  "fetched",
  "生信菜鸟团"
]
categories: ["Acdemic"]
---
单细胞不同格式数据转换——sceasy包 by 生信菜鸟团
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><blockquote data-tool="mdnice编辑器"><span>❝</span><p>之前曾老师给我分享了一个sceasy包，这周有时间去看了一下，这个数据格式转换是怎么用的，用起来方便吗？尤其是scanpy和seurat之间的数据转换经常会比较麻烦，而这个包恰恰用一行代码即可搞定。</p><span>❞</span></blockquote><p data-tool="mdnice编辑器">github包网址：https://github.com/cellgeni/sceasy</p><p data-tool="mdnice编辑器"><span>h</span><span>5ad</span><span>——seurat obejct 常规格式转换</span></p><pre data-tool="mdnice编辑器"><span></span><code>remotes::install_github(<span>"mojaveazure/seurat-disk"</span>)<br><span>library</span>(SeuratDisk)<br><br> Convert(<span>"filename.h5ad"</span>, dest=<span>"h5seurat"</span>,<br>         assay = <span>"RNA"</span>,<br>         overwrite=<span>F</span>)<br>h5_object &lt;- LoadH5Seurat(<span>"filename.h5seurat"</span>)<br></code></pre><h4 data-tool="mdnice编辑器"><span></span>所需配置的环境<span></span></h4><pre data-tool="mdnice编辑器"><span></span><code>conda create -n sceasy<br>conda activate sceasy<br>conda install anndata==<span>0.6</span><span>.19</span> scipy==<span>1.2</span><span>.1</span> -c bioconda<br>conda install loompy -c bioconda<br></code></pre><h4 data-tool="mdnice编辑器"><span></span>安装所需的R包<span></span></h4><pre data-tool="mdnice编辑器"><span></span><code><span>library</span>(Seurat)<br><span>library</span>(hdf5r)<br><br>devtools::install_github(<span>"cellgeni/sceasy"</span>)<br><span>if</span> (!requireNamespace(<span>"BiocManager"</span>, quietly = <span>TRUE</span>))<br>  install.packages(<span>"BiocManager"</span>)<br><br>BiocManager::install(c(<span>"LoomExperiment"</span>, <span>"SingleCellExperiment"</span>))<br>install.packages(<span>'reticulate'</span>)<br>reticulate:::find_conda()<br><br><span>library</span>(sceasy)<br><span>library</span>(reticulate)<br>use_condaenv(<span>'sceasy'</span>)<br>loompy &lt;- reticulate::import(<span>'loompy'</span>)<br></code></pre><h4 data-tool="mdnice编辑器"><span></span>不同格式单细胞数据转换<span></span></h4><pre data-tool="mdnice编辑器"><span></span><code><span>#导入数据</span><br>seurat_object=readRDS(<span>"sce.all_int.rds"</span>)<br><br><span>#Seurat to AnnData</span><br>sceasy::convertFormat(seurat_object, from=<span>"seurat"</span>, to=<span>"anndata"</span>,<br>                      outFile=<span>'filename.h5ad'</span>)<br><span>#Seurat to SingleCellExperiment</span><br><br>sceasy::convertFormat(seurat_object, from=<span>"seurat"</span>, to=<span>"sce"</span>,<br>                      outFile=<span>'filename.rds'</span>)<br></code></pre><h4 data-tool="mdnice编辑器"><span></span>其他数据格式<span></span></h4><p data-tool="mdnice编辑器">可以用自己的数据来试一下。</p><pre data-tool="mdnice编辑器"><span></span><code><span>#AnnData to Seurat</span><br>sceasy::convertFormat(h5ad_file, from=<span>"anndata"</span>, to=<span>"seurat"</span>,<br>                      outFile=<span>'filename.rds'</span>)<br><br><span>#SingleCellExperiment to AnnData</span><br><br>sceasy::convertFormat(sce_object, from=<span>"sce"</span>, to=<span>"anndata"</span>,<br>                      outFile=<span>'filename.h5ad'</span>)<br><span>#SingleCellExperiment to Loom</span><br><br>sceasy::convertFormat(sce_object, from=<span>"sce"</span>, to=<span>"loom"</span>,<br>                      outFile=<span>'filename.loom'</span>)<br><span>#Loom to AnnData</span><br><br>sceasy::convertFormat(<span>'filename.loom'</span>, from=<span>"loom"</span>, to=<span>"anndata"</span>,<br>                      outFile=<span>'filename.h5ad'</span>)<br><span>#Loom to SingleCellExperiment</span><br><br>sceasy::convertFormat(<span>'filename.loom'</span>, from=<span>"loom"</span>, to=<span>"sce"</span>,<br>                      outFile=<span>'filename.rds'</span>)<br></code></pre><blockquote data-tool="mdnice编辑器"><span>❝</span><p>我一开始的时候忘了没有配置好环境，而直接安装sceasy，因此在use_condaenv('sceasy')这步就出现了报错，【Error: Unable to find conda binary. Is Anaconda installed?】</p><p>所以一定要配置好环境才能用！这个包还是挺方便实用的。</p><span>❞</span></blockquote><h3 data-tool="mdnice编辑器"><span></span><span>微信交流群</span><span></span></h3><p data-tool="mdnice编辑器">如果你也想参与到群里的讨论中，给我提出一些推文更新建议的话欢迎入群。同时你也可以得到我前期更新的所有数据及代码，在群里我会把代码分享给大家，而且大家可以在群里「提出自己感兴趣的单细胞文献」<strong>「我们尽可能优先选择大家的数据集去复现和实战，也欢迎大家在群里分享更多其它资料，咱们一起进步，」</strong>「比较高级的单细胞分析」**我们也会一起尝试， 相信你肯定是会不虚此行哈。</p><p data-tool="mdnice编辑器">附上之前推文的链接 <a href="https://mp.weixin.qq.com/s?__biz=MzUzMTEwODk0Ng==&amp;mid=2247512238&amp;idx=1&amp;sn=e0c6dc2ea0e089aabb78133e50fb5d7f&amp;scene=21#wechat_redirect" data-linktype="2">为爱发电不可取（单细胞周更需要你的支持）</a></p><p data-tool="mdnice编辑器"><strong>「「目前群里已经有300多人，所以你想要进群的话就需要添加我的微信，私聊给我发99元的红包，我把你拉进群里。」」</strong></p><p data-tool="mdnice编辑器">我们这个群是真正的付费交流群，不仅提供数据，代码，学习资料，而且也会跟大家互动交流，还会坚持进行创作至少一年。所以，如果介意99元的门槛且不认可我们知识分享的理念，<strong>「请不要加我好友」</strong>。。</p><figure data-tool="mdnice编辑器"><img data-ratio="1" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los98Wlq7do1rOYclgO0yo4DIt4rJVUMmZU7l0GEk31KdZic7DRRu5fb4bNOG6Dzrz5XBMTc0Vep30Dg/640?wx_fmt=png" data-type="png" data-w="172" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los98Wlq7do1rOYclgO0yo4DIt4rJVUMmZU7l0GEk31KdZic7DRRu5fb4bNOG6Dzrz5XBMTc0Vep30Dg/640?wx_fmt=png"></figure></section><p><br></p><p><mp-style-type data-value="10000"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/PnfmMX3HH9IwBeiLi5MLmg",target="_blank" rel="noopener noreferrer">原文链接</a>
