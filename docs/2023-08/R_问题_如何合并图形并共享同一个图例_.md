---
title: "R 问题｜如何合并图形并共享同一个图例？"
date: 2023-08-14T12:32:36Z
draft: ["false"]
tags: [
  "fetched",
  "庄闪闪的R语言手册"
]
categories: ["Acdemic"]
---
R 问题｜如何合并图形并共享同一个图例？ by 庄闪闪的R语言手册
------
<div><p data-mpa-powered-by="yiban.io"><span>点击下方</span><span>公众号</span><span>，回复</span><span>资料分享</span><span>，收获惊喜</span></p><section><mp-common-profile data-pluginname="mpprofile" data-id="MzI1NjUwMjQxMQ==" data-headimg="http://mmbiz.qpic.cn/mmbiz_png/MIcgkkEyTHiaOjUwXredJLzMleuKP97WYf7W4ylibNiaRJlP7icneHRGekYcQEPgTLpIDbibTuuEADhn0Sv4Xqhhf4A/0?wx_fmt=png" data-nickname="庄闪闪的R语言手册" data-alias="Zss_R4ds" data-signature="在读统计博士生，R语言爱好者。来跟着我一起学 R 数据科学，可视化。" data-from="2"></mp-common-profile></section><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><h2 data-tool="mdnice编辑器"><span></span><span>简介</span></h2><p data-tool="mdnice编辑器">小编在科研中，需要将多个图形进行合并，并共享同一个图例。此时应该如何实现？关于图形合并的相关推文写了很多了：<a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzI1NjUwMjQxMQ==&amp;mid=2247489545&amp;idx=1&amp;sn=9dd91a4be901e00380a7bc472111645f&amp;chksm=ea24e7eddd536efbb23cabb7155d3b494ea7ccf480058c97c69ee43276f39eecf988e55faeb6&amp;scene=21#wechat_redirect" textvalue="R可视乎｜合并多幅图形" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2">R可视乎｜合并多幅图形</a>、<a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzI1NjUwMjQxMQ==&amp;mid=2247516746&amp;idx=1&amp;sn=bbb0f507f295dc30d99ea04fe12d1f23&amp;chksm=ea277daedd50f4b8b06b5c9b93d6db07c42c8e00ed9bc88a8a9e123530bdc8c625670f5f72d3&amp;scene=21#wechat_redirect" textvalue="cowplot包，ggplot2图形排版R包" linktype="text" imgurl="" imgdata="null" data-itemshowtype="11" tab="innerlink" data-linktype="2">cowplot包，ggplot2图形排版R包</a>。但是对于今天这个问题，小编很少注意，在进行查阅资料后，将该技巧进行总结。主要介绍三种方法，参考资料如下：<span>cowplot</span><sup>[1]</sup>、<span>ggpubr</span><sup>[2]</sup>、<span>patchwork</span><sup>[3]</sup>。</p><h2 data-tool="mdnice编辑器"><span></span><span>绘制示例图形</span></h2><p data-tool="mdnice编辑器">这里以 <code>mpg</code> 数据集为例，前几行数据预览如下：</p><figure data-tool="mdnice编辑器"><img data-ratio="0.4703703703703704" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/MIcgkkEyTHias5g214ZRC7RDUV3nwNLujmHgEb6EUF83ia28ojezcDeWxvjWqbaXOSeUILjrbUbCba1TQ7Ja2WRg/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/MIcgkkEyTHias5g214ZRC7RDUV3nwNLujmHgEb6EUF83ia28ojezcDeWxvjWqbaXOSeUILjrbUbCba1TQ7Ja2WRg/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">以 <code>displ</code>/<code>cty</code> 为 x 轴, <code>hwy</code> 为 y 轴，颜色用 <code>class</code> 来刻画，绘制散点图。并进行了简单细节调整。</p><pre data-tool="mdnice编辑器"><span></span><code><span>library</span>(ggplot2)<br><span>library</span>(viridis)<br><span>## 创建图形</span><br>plot1 &lt;- ggplot(data = mpg, aes(x = displ, y = hwy, color = class)) +<br>  geom_point(size=<span>1.7</span>) + scale_color_viridis(discrete = <span>T</span>) + <br>  theme_bw() + theme(panel.grid = element_blank())  <br>  <br>plot2 &lt;- ggplot(data = mpg, aes(x = cty, y = hwy, color = class)) +<br>  geom_point(size=<span>1.7</span>) + scale_color_viridis(discrete = <span>T</span>) +<br>  theme_bw() + theme(panel.grid = element_blank())<br></code></pre><p data-tool="mdnice编辑器">此时合并后的结果如下：</p><figure data-tool="mdnice编辑器"><img data-ratio="0.6055555555555555" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/MIcgkkEyTHias5g214ZRC7RDUV3nwNLujArbWPejUDbq7Vc0ayBjfwh4YLL3E61QsaF3Xmx7gZ1SHwdDCFWibeAA/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/MIcgkkEyTHias5g214ZRC7RDUV3nwNLujArbWPejUDbq7Vc0ayBjfwh4YLL3E61QsaF3Xmx7gZ1SHwdDCFWibeAA/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">可以看到，两个图形的图例是相同的，为了图形更佳清晰，美观。我们需要将两个图形的图例进行合并。接下来，小编整理了三种方法供大家参考：</p><h2 data-tool="mdnice编辑器"><span></span><span>方法一 ggpubr::ggarrange()</span></h2><p data-tool="mdnice编辑器">使用 <code>ggarrange()</code> 并配合参数 <code>common.legend = TRUE</code>。此外，调整共享图例位置使用 <code>legend="top"</code>。</p><pre data-tool="mdnice编辑器"><span></span><code><span>library</span>(ggpubr)<br>ggarrange(plot1, plot2, common.legend = <span>TRUE</span>, legend=<span>"top"</span>)<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.7833333333333333" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/MIcgkkEyTHias5g214ZRC7RDUV3nwNLujyvmuCoZzsK9WKOribm1FiaC4HCLAfHcibUicOiclDawownOYYZu08DYibWlg/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/MIcgkkEyTHias5g214ZRC7RDUV3nwNLujyvmuCoZzsK9WKOribm1FiaC4HCLAfHcibUicOiclDawownOYYZu08DYibWlg/640?wx_fmt=png"></figure><h2 data-tool="mdnice编辑器"><span></span><span>方法二 cowplot::plot_grid()</span></h2><p data-tool="mdnice编辑器">使用 <code>plot_grid()</code> 并配合参数 <code>get_legend（）</code>提取某个图形的图例。</p><pre data-tool="mdnice编辑器"><span></span><code><span>library</span>(cowplot)<br>combined_plot &lt;- plot_grid(plot1 + theme(legend.position = <span>'none'</span>), plot2 + theme(legend.position = <span>'none'</span>), ncol = <span>2</span>)<br><span># 将图例添加到合并后的图形中</span><br>plot_grid(combined_plot, get_legend(plot1),rel_widths = c(<span>4</span>, <span>1</span>))<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.7907407407407407" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/MIcgkkEyTHias5g214ZRC7RDUV3nwNLuj0zBAMYSQobptWdmOh0T8IibzHobBLIvM7tJBcUuuvP4mS48NoqvcCVQ/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/MIcgkkEyTHias5g214ZRC7RDUV3nwNLuj0zBAMYSQobptWdmOh0T8IibzHobBLIvM7tJBcUuuvP4mS48NoqvcCVQ/640?wx_fmt=png"></figure><h2 data-tool="mdnice编辑器"><span></span><span>方法三 patchwork::plot_layout()</span></h2><p data-tool="mdnice编辑器">使用 <code>plot_layout()</code> 并配合参数 <code>guides = "collect"</code>。此外，调整共享图例位置使用 <code>&amp;   theme(legend.position='bottom')</code>。</p><pre data-tool="mdnice编辑器"><span></span><code><span>library</span>(patchwork)<br>plot1 + plot2 + plot_layout(guides = <span>"collect"</span>) &amp;<br>  theme(legend.position=<span>'bottom'</span>)<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.7777777777777778" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/MIcgkkEyTHias5g214ZRC7RDUV3nwNLujjYPAvxu4cOmiaWb9gD1PHAYw4QGSoUQe151dk83VNLvMCWboIrbscFg/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/MIcgkkEyTHias5g214ZRC7RDUV3nwNLujjYPAvxu4cOmiaWb9gD1PHAYw4QGSoUQe151dk83VNLvMCWboIrbscFg/640?wx_fmt=png"></figure><h3 data-tool="mdnice编辑器"><span>参考资料</span></h3><section data-tool="mdnice编辑器"><span><span>[1]</span><p>cowplot: <em>https://wilkelab.org/cowplot/articles/shared_legends.html</em></p></span><span><span>[2]</span><p>ggpubr: <em>https://rpkgs.datanovia.com/ggpubr/index.html</em></p></span><span><span>[3]</span><p>patchwork: <em>https://patchwork.data-imaginist.com/</em></p></span></section></section><h2 data-tool="mdnice编辑器"><span>相关推文指南</span></h2><section data-mpa-template="t" data-from="yb-recommend-list"><section data-mpa-template="t" data-from="yb-recommend" data-recommend-article-type="normal" data-recomment-template-id="1" data-recommend-article-id="2247516746_1" data-recommend-article-time="1681648200" data-recommend-article-cover="https://mmbiz.qpic.cn/mmbiz_jpg/ibNJyXnh77ib2HqCc1jELVf5T9RMrsic7ETYibCGuVZdYrdmSqLbx5ezrxhU21KA0v1j3UZhHQSD3D1S0vEQhAoYAw/0?wx_fmt=jpeg" data-recommend-article-title="cowplot包，ggplot2图形排版R包" data-recommend-article-content-url="https://mp.weixin.qq.com/s?__biz=MzI1NjUwMjQxMQ==&amp;mid=2247516746&amp;idx=1&amp;sn=bbb0f507f295dc30d99ea04fe12d1f23&amp;chksm=ea277daedd50f4b8b06b5c9b93d6db07c42c8e00ed9bc88a8a9e123530bdc8c625670f5f72d3#rd"><a href="https://mp.weixin.qq.com/s?__biz=MzI1NjUwMjQxMQ==&amp;mid=2247516746&amp;idx=1&amp;sn=bbb0f507f295dc30d99ea04fe12d1f23&amp;chksm=ea277daedd50f4b8b06b5c9b93d6db07c42c8e00ed9bc88a8a9e123530bdc8c625670f5f72d3&amp;scene=21#wechat_redirect" data-linktype="1"><section data-recommend-type="normal" data-recommend-tid="1" data-mid=""><section data-mid=""><section data-mid=""><span><img data-ratio="0.425" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/ibNJyXnh77ib2HqCc1jELVf5T9RMrsic7ETYibCGuVZdYrdmSqLbx5ezrxhU21KA0v1j3UZhHQSD3D1S0vEQhAoYAw/640?wx_fmt=jpeg" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_jpg/ibNJyXnh77ib2HqCc1jELVf5T9RMrsic7ETYibCGuVZdYrdmSqLbx5ezrxhU21KA0v1j3UZhHQSD3D1S0vEQhAoYAw/640?wx_fmt=jpeg"></span></section><section data-mid=""><p data-recommend-title="t" data-mid="">cowplot包，ggplot2图形排版R包</p></section></section></section></a></section><br><section data-mpa-template="t" data-from="yb-recommend" data-recommend-article-type="normal" data-recomment-template-id="1" data-recommend-article-id="2247516692_1" data-recommend-article-time="1680915600" data-recommend-article-cover="https://mmbiz.qlogo.cn/mmbiz_jpg/MIcgkkEyTHiaA1gHfarAKNic2uakAMZRVJjdb0iaickt3uFdt9ryF3pBSxzoA788F3cfdn7nMrKtiaqvzomBLgE0tnQ/0?wx_fmt=jpeg" data-recommend-article-title="使用 ggpubr 包制图" data-recommend-article-content-url="https://mp.weixin.qq.com/s?__biz=MzI1NjUwMjQxMQ==&amp;mid=2247516692&amp;idx=1&amp;sn=8bc7cbfa327bfdc84b5b86eaeb94c18a&amp;chksm=ea277df0dd50f4e6fbb89a3d309e37f5ad304871932fee1b60a1670b52bd254825166c4c5e9c#rd"><a href="https://mp.weixin.qq.com/s?__biz=MzI1NjUwMjQxMQ==&amp;mid=2247516692&amp;idx=1&amp;sn=8bc7cbfa327bfdc84b5b86eaeb94c18a&amp;chksm=ea277df0dd50f4e6fbb89a3d309e37f5ad304871932fee1b60a1670b52bd254825166c4c5e9c&amp;scene=21#wechat_redirect" data-linktype="1"><section data-recommend-type="normal" data-recommend-tid="1" data-mid=""><section data-mid=""><section data-mid=""><span><img data-ratio="0.425" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/MIcgkkEyTHiaA1gHfarAKNic2uakAMZRVJjdb0iaickt3uFdt9ryF3pBSxzoA788F3cfdn7nMrKtiaqvzomBLgE0tnQ/640?wx_fmt=jpeg" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_jpg/MIcgkkEyTHiaA1gHfarAKNic2uakAMZRVJjdb0iaickt3uFdt9ryF3pBSxzoA788F3cfdn7nMrKtiaqvzomBLgE0tnQ/640?wx_fmt=jpeg"></span></section><section data-mid=""><p data-recommend-title="t" data-mid="">使用 ggpubr 包制图</p></section></section></section></a></section><br><section data-mpa-template="t" data-from="yb-recommend" data-recommend-article-type="normal" data-recomment-template-id="1" data-recommend-article-id="2247516449_1" data-recommend-article-time="1680179400" data-recommend-article-cover="https://mmbiz.qpic.cn/mmbiz_jpg/MIcgkkEyTHiaAMA5BM5B1dCjH88KibYBH7jVcBocefRlIMoiccuxKoOcSKov7Fd4IdpJOO1Fc4DI1bICjYO86uEww/0?wx_fmt=jpeg" data-recommend-article-title="使用 ggcharts 高亮部分内容" data-recommend-article-content-url="https://mp.weixin.qq.com/s?__biz=MzI1NjUwMjQxMQ==&amp;mid=2247516449&amp;idx=1&amp;sn=0a1a0809772e006f1e5fe0d4202adb49&amp;chksm=ea277ec5dd50f7d3afc4c47ec87ce26a8023286d9c30563f5c2ea90d1adee86c8f2783230e26#rd"><a href="https://mp.weixin.qq.com/s?__biz=MzI1NjUwMjQxMQ==&amp;mid=2247516449&amp;idx=1&amp;sn=0a1a0809772e006f1e5fe0d4202adb49&amp;chksm=ea277ec5dd50f7d3afc4c47ec87ce26a8023286d9c30563f5c2ea90d1adee86c8f2783230e26&amp;scene=21#wechat_redirect" data-linktype="1"><section data-recommend-type="normal" data-recommend-tid="1" data-mid=""><section data-mid=""><section data-mid=""><span><img data-ratio="0.42407407407407405" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/MIcgkkEyTHiaAMA5BM5B1dCjH88KibYBH7jVcBocefRlIMoiccuxKoOcSKov7Fd4IdpJOO1Fc4DI1bICjYO86uEww/640?wx_fmt=jpeg" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_jpg/MIcgkkEyTHiaAMA5BM5B1dCjH88KibYBH7jVcBocefRlIMoiccuxKoOcSKov7Fd4IdpJOO1Fc4DI1bICjYO86uEww/640?wx_fmt=jpeg"></span></section><section data-mid=""><p data-recommend-title="t" data-mid="">使用 ggcharts 高亮部分内容</p></section></section></section></a></section><br><section data-mpa-template="t" data-from="yb-recommend" data-recommend-article-type="normal" data-recomment-template-id="1" data-recommend-article-id="2247516351_1" data-recommend-article-time="1678969800" data-recommend-article-cover="https://mmbiz.qpic.cn/mmbiz_jpg/MIcgkkEyTHjGAMwWEb8rAj2CibVfwadrVLQqfiavhoCcmcrKcExQbmBoXsJzpEtBhknvNicP24Ldw2ZNibAqQPUSww/0?wx_fmt=jpeg" data-recommend-article-title="使用 ggTimeSeries 包构建日历图" data-recommend-article-content-url="https://mp.weixin.qq.com/s?__biz=MzI1NjUwMjQxMQ==&amp;mid=2247516351&amp;idx=1&amp;sn=ddf1d3b3e9185717ea544d15eb4f9973&amp;chksm=ea277f5bdd50f64df854ae65d2f74b8b8a0c9d4b247d46706da848b284862b1872e9279c2512#rd"><a href="https://mp.weixin.qq.com/s?__biz=MzI1NjUwMjQxMQ==&amp;mid=2247516351&amp;idx=1&amp;sn=ddf1d3b3e9185717ea544d15eb4f9973&amp;chksm=ea277f5bdd50f64df854ae65d2f74b8b8a0c9d4b247d46706da848b284862b1872e9279c2512&amp;scene=21#wechat_redirect" data-linktype="1"><section data-recommend-type="normal" data-recommend-tid="1" data-mid=""><section data-mid=""><section data-mid=""><span><img data-ratio="0.42407407407407405" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/MIcgkkEyTHjGAMwWEb8rAj2CibVfwadrVLQqfiavhoCcmcrKcExQbmBoXsJzpEtBhknvNicP24Ldw2ZNibAqQPUSww/640?wx_fmt=jpeg" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_jpg/MIcgkkEyTHjGAMwWEb8rAj2CibVfwadrVLQqfiavhoCcmcrKcExQbmBoXsJzpEtBhknvNicP24Ldw2ZNibAqQPUSww/640?wx_fmt=jpeg"></span></section><section data-mid=""><p data-recommend-title="t" data-mid="">使用 ggTimeSeries 包构建日历图</p></section></section></section></a></section><br><section data-mpa-template="t" data-from="yb-recommend" data-recommend-article-type="normal" data-recomment-template-id="1" data-recommend-article-id="2247516056_1" data-recommend-article-time="1678365000" data-recommend-article-cover="https://mmbiz.qpic.cn/mmbiz_jpg/MIcgkkEyTHjGAMwWEb8rAj2CibVfwadrVEuLEIULqxec2PsaENicVO4XsiclgLY8DicRC7s5XNEciawla0WiaEVq6Lkw/0?wx_fmt=jpeg" data-recommend-article-title="基于 ggdensity 包的等高线绘制" data-recommend-article-content-url="https://mp.weixin.qq.com/s?__biz=MzI1NjUwMjQxMQ==&amp;mid=2247516056&amp;idx=1&amp;sn=104f3fd347a9c46aa0d20729d5c26c21&amp;chksm=ea27407cdd50c96a56f17a8f75cd95f675cba85fdae522c0d7f1931913e00f90db387ec28fb0#rd"><a href="https://mp.weixin.qq.com/s?__biz=MzI1NjUwMjQxMQ==&amp;mid=2247516056&amp;idx=1&amp;sn=104f3fd347a9c46aa0d20729d5c26c21&amp;chksm=ea27407cdd50c96a56f17a8f75cd95f675cba85fdae522c0d7f1931913e00f90db387ec28fb0&amp;scene=21#wechat_redirect" data-linktype="1"><section data-recommend-type="normal" data-recommend-tid="1" data-mid=""><section data-mid=""><section data-mid=""><span><img data-ratio="0.425" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/MIcgkkEyTHjGAMwWEb8rAj2CibVfwadrVEuLEIULqxec2PsaENicVO4XsiclgLY8DicRC7s5XNEciawla0WiaEVq6Lkw/640?wx_fmt=jpeg" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_jpg/MIcgkkEyTHjGAMwWEb8rAj2CibVfwadrVEuLEIULqxec2PsaENicVO4XsiclgLY8DicRC7s5XNEciawla0WiaEVq6Lkw/640?wx_fmt=jpeg"></span></section><section data-mid=""><p data-recommend-title="t" data-mid="">基于 ggdensity 包的等高线绘制</p></section></section></section></a></section><br><section data-mpa-template="t" data-from="yb-recommend" data-recommend-article-type="normal" data-recomment-template-id="1" data-recommend-article-id="2247515455_1" data-recommend-article-time="1676464200" data-recommend-article-cover="https://mmbiz.qpic.cn/mmbiz_jpg/MIcgkkEyTHjsekcXp04sk4No2iagQyCzkvFwBzCXicIbZ5dJP05mHiaBTL9miajCusK8ficmUrS906lzQ3ULrkgzRfg/0?wx_fmt=jpeg" data-recommend-article-title="贝叶斯 RStan 包入门教程" data-recommend-article-content-url="https://mp.weixin.qq.com/s?__biz=MzI1NjUwMjQxMQ==&amp;mid=2247515455&amp;idx=1&amp;sn=2ad479c75f994b23eeef3202ad95ef62&amp;chksm=ea2742dbdd50cbcdf135aeb65ad80ffa855ef4732b977930aad70cab61c4493f8b6c9696447b#rd"><a href="https://mp.weixin.qq.com/s?__biz=MzI1NjUwMjQxMQ==&amp;mid=2247515455&amp;idx=1&amp;sn=2ad479c75f994b23eeef3202ad95ef62&amp;chksm=ea2742dbdd50cbcdf135aeb65ad80ffa855ef4732b977930aad70cab61c4493f8b6c9696447b&amp;scene=21#wechat_redirect" data-linktype="1"><section data-recommend-type="normal" data-recommend-tid="1" data-mid=""><section data-mid=""><section data-mid=""><span><img data-ratio="0.42592592592592593" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/MIcgkkEyTHjsekcXp04sk4No2iagQyCzkvFwBzCXicIbZ5dJP05mHiaBTL9miajCusK8ficmUrS906lzQ3ULrkgzRfg/640?wx_fmt=jpeg" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_jpg/MIcgkkEyTHjsekcXp04sk4No2iagQyCzkvFwBzCXicIbZ5dJP05mHiaBTL9miajCusK8ficmUrS906lzQ3ULrkgzRfg/640?wx_fmt=jpeg"></span></section><section data-mid=""><p data-recommend-title="t" data-mid="">贝叶斯 RStan 包入门教程</p></section></section></section></a></section></section><p><br></p><p><br></p><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/K7SmKiuT6E_eMrb7q_CjZg",target="_blank" rel="noopener noreferrer">原文链接</a>
