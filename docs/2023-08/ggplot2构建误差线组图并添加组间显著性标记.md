---
title: "ggplot2构建误差线组图并添加组间显著性标记"
date: 2023-08-14T00:48:51Z
draft: ["false"]
tags: [
  "fetched",
  "R语言数据分析指南"
]
categories: ["Acdemic"]
---
ggplot2构建误差线组图并添加组间显著性标记 by R语言数据分析指南
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><h3 data-tool="mdnice编辑器"><span></span><span><span></span>欢迎关注R语言数据分析指南</span><span></span></h3><blockquote data-tool="mdnice编辑器"><span>❝</span><p>本节来复现nature上的一张小图介绍如何使用<strong>「ggplot2构建误差线组图并添加组间显著性标记」</strong>，下面小编就通过一个案例来进行结果展示，添加了详细的注释希望各位观众老爷能够喜欢，<strong>「数据+代码已经上传2023VIP群，加群的观众老爷请自行下载」</strong>。</p><span>❞</span></blockquote><h3 data-tool="mdnice编辑器"><span></span><span><span></span>论文</span><span></span></h3><blockquote data-tool="mdnice编辑器"><span>❝</span><p>Lactate limits CNS autoimmunity by stabilizing HIF-1α in dendritic cells</p><span>❞</span></blockquote><h3 data-tool="mdnice编辑器"><span></span><span><span></span>关注下方公众号下回更新不迷路</span><span></span></h3><section><mp-common-profile data-pluginname="mpprofile" data-id="Mzg3MzQzNTYzMw==" data-headimg="http://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZF0rpeZII9Ltl26VbVagriczTria1fib3XgjwwHEHFjPzkmGpqWDVVHBSzhENictUM2iavAKiaM5lc9USw/0?wx_fmt=png" data-nickname="R语言数据分析指南" data-alias="YanJANtwo" data-signature="R语言重症爱好者，喜欢绘制各种精美的图表，喜欢的小伙伴可以关注我，跟我一起学习" data-from="0" data-is_biz_ban="0"></mp-common-profile></section><h3 data-tool="mdnice编辑器"><span></span><span><span></span>加载R包</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code><span>library</span>(tidyverse)<br><span>library</span>(ggsci)<br><span>library</span>(rstatix)<br><span>library</span>(ggpubr)<br><span>library</span>(cowplot)<br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span><span></span>数据清洗</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code>df &lt;- read_tsv(<span>"data.txt"</span>) %&gt;%<br>  pivot_longer(-Id) %&gt;% <br>  mutate(group = sub(<span>"\\.\\.\\..*"</span>, <span>""</span>, name),<br>         Id=as.factor(Id)) %&gt;% select(-name)<br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span><span></span>构建绘图数据</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code>plot &lt;- df %&gt;% group_by(Id,group) %&gt;% <br>  summarise(value_mean=mean(value),sd=sd(value),se=sd(value)/sqrt(n()))<br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span><span></span>绘制主图</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code>p &lt;- plot %&gt;% ggplot(aes(Id,value_mean,fill=group,group=group,<br>                  ymin=value_mean-se,ymax=value_mean+se))+<br>  geom_errorbar(width=<span>0.2</span>)+<br>  geom_line(color=<span>"black"</span>)+<br>  geom_point(aes(pch=group,color=group,fill=group),size=<span>3</span>)+<br>  scale_shape_manual(values=c(<span>25</span>,<span>21</span>,<span>22</span>,<span>24</span>))+<br>  scale_fill_npg()+<br>  scale_color_npg()+<br>  labs(x=<span>NULL</span>,y=<span>NULL</span>)+<br>  theme_classic()+<br>  theme(plot.margin=unit(c(<span>0.1</span>,<span>1</span>,<span>0.1</span>,<span>0.1</span>),units=,<span>"cm"</span>),<br>        axis.line = element_line(color = <span>"black"</span>,size = <span>0.4</span>),<br>        panel.grid.minor =element_blank(),<br>        panel.grid.major =element_blank(),<br>        axis.text.y = element_text(color=<span>"black"</span>,size=<span>9</span>),<br>        axis.text.x = element_text(margin = margin(t=<span>3</span>),color=<span>"black"</span>,size=<span>9</span>,angle=<span>0</span>,vjust = <span>0.5</span>),<br>        legend.key=element_blank(),<br>        legend.title = element_blank(),<br>        legend.text = element_text(color=<span>"black"</span>,size=<span>8</span>),<br>        legend.spacing.x=unit(<span>0.1</span>,<span>'cm'</span>),<br>        legend.spacing.y=unit(<span>1</span>,<span>'cm'</span>),<br>        legend.key.width=unit(<span>0.7</span>,<span>'cm'</span>),<br>        legend.key.height=unit(<span>0.4</span>,<span>'cm'</span>),<br>        legend.background=element_blank(),<br>        legend.position = c(<span>0.2</span>,<span>0.95</span>),<br>        legend.box.margin = margin(<span>0</span>,<span>0</span>,<span>0</span>,<span>0</span>))<br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span><span></span>统计分析</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code>df %&gt;%<br>  t_test(value ~ group) %&gt;%<br>  adjust_pvalue() %&gt;% add_significance(<span>"p.adj"</span>) %&gt;% <br>  select(<span>2</span>,<span>3</span>,p.adj.signif)<br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span><span></span>添加注释</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code>ggdraw()+<br>  draw_plot(p)+<br>  draw_line(x=c(<span>0.95</span>,<span>0.95</span>),y=c(<span>0.35</span>,<span>0.63</span>))+<br>  draw_line(x=c(<span>0.95</span>,<span>0.95</span>),y=c(<span>0.65</span>,<span>0.8</span>))+<br>  draw_text(x=<span>0.975</span>,y=<span>0.5</span>,text=<span>"****"</span>,angle=<span>90</span>,size=<span>20</span>,color=<span>"red"</span>)+<br>  draw_text(x=<span>0.975</span>,y=<span>0.72</span>,text=<span>"****"</span>,angle=<span>90</span>,size=<span>20</span>,color=<span>"red"</span>)<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.7105831533477321" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAbAMNtndHjWWdIJhQvNL1384CnOT7ORpicZQGIoSdU3icZrfjDSiaiaIAV8EhK910H6cpRuaSKOy8DrUw/640?wx_fmt=png" data-type="png" data-w="926" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAbAMNtndHjWWdIJhQvNL1384CnOT7ORpicZQGIoSdU3icZrfjDSiaiaIAV8EhK910H6cpRuaSKOy8DrUw/640?wx_fmt=png"></figure><blockquote data-tool="mdnice编辑器"><span>❝</span><p>本节介绍到此结束，有需要学习个性化数据可视化的朋友，欢迎到小编的<strong>「淘宝店铺」</strong> <strong>「R语言数据分析指南」</strong>购买<strong>「2023年度会员文档」</strong>同步更新中<strong>「售价149元」</strong>，内容主要包括各种<strong>「高分论文的图表分析复现以及一些个性化图表的绘制」</strong>均包含数据+代码；按照往年数据小编年产出约在150+以上</p><span>❞</span></blockquote><p data-tool="mdnice编辑器">购买后微信发小编订单截图即邀请进新的会员交流群，小编的文档为按年售卖，只包含当年度的<strong>「除系列课程外」</strong>的文档，有需要往年文档的朋友也可下单购买，需要了解更多信息的朋友欢迎交流咨询。</p><h3 data-tool="mdnice编辑器"><span></span><span><span></span>淘宝扫一扫</span><span></span></h3><figure data-tool="mdnice编辑器"><img data-ratio="1.5751295336787565" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAbAMNtndHjWWdIJhQvNL1383KR7aZvpqTTRrx9Lic7KxEq1m2EOJiaMmotOqiad5K0kpqMNvUzB9VNGw/640?wx_fmt=png" data-type="png" data-w="386" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAbAMNtndHjWWdIJhQvNL1383KR7aZvpqTTRrx9Lic7KxEq1m2EOJiaMmotOqiad5K0kpqMNvUzB9VNGw/640?wx_fmt=png"></figure><h3 data-tool="mdnice编辑器"><span></span><span><span></span>2023会员群案例展示</span><span></span></h3><p data-tool="mdnice编辑器"><img data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAbAMNtndHjWWdIJhQvNL138KQEMs5bngcpLgnyRK9A3cXCGpkQkhbm01k5aSlmI6hQw7riajbsvatw/640?wx_fmt=png" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAbAMNtndHjWWdIJhQvNL138KQEMs5bngcpLgnyRK9A3cXCGpkQkhbm01k5aSlmI6hQw7riajbsvatw/640?wx_fmt=png"><img data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAbAMNtndHjWWdIJhQvNL138v9g5ia4ZVPsNMVr7p2kBnWDnU2iaCiahicDq0d6SmrQ6txvZbjibibcrAdYA/640?wx_fmt=png" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAbAMNtndHjWWdIJhQvNL138v9g5ia4ZVPsNMVr7p2kBnWDnU2iaCiahicDq0d6SmrQ6txvZbjibibcrAdYA/640?wx_fmt=png"><img data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAbAMNtndHjWWdIJhQvNL138MMBYeWsPiajGq3yPJjhndGwZBZnrpXt1ABUEGpbQm2yDcQAQfe56ibRQ/640?wx_fmt=png" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAbAMNtndHjWWdIJhQvNL138MMBYeWsPiajGq3yPJjhndGwZBZnrpXt1ABUEGpbQm2yDcQAQfe56ibRQ/640?wx_fmt=png"><img data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAbAMNtndHjWWdIJhQvNL138aCUMXyO6H0NHsVgdtVCOxO54wK95LOibFl7Ua3t8kAH6LjvhC3XKEKA/640?wx_fmt=png" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAbAMNtndHjWWdIJhQvNL138aCUMXyO6H0NHsVgdtVCOxO54wK95LOibFl7Ua3t8kAH6LjvhC3XKEKA/640?wx_fmt=png"><img data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAbAMNtndHjWWdIJhQvNL138K8v4YJ5ctD0jic6Yr8Tl4rCgvKCE2eWXyuHeibd9wQstw9lnRzmXjSJg/640?wx_fmt=png" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAbAMNtndHjWWdIJhQvNL138K8v4YJ5ctD0jic6Yr8Tl4rCgvKCE2eWXyuHeibd9wQstw9lnRzmXjSJg/640?wx_fmt=png"><img data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAbAMNtndHjWWdIJhQvNL138BFnAerSJD62G8vVkTNRhhvmsnDmLkuRcqL7De6s9WfedtmiauIuuPAg/640?wx_fmt=png" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAbAMNtndHjWWdIJhQvNL138BFnAerSJD62G8vVkTNRhhvmsnDmLkuRcqL7De6s9WfedtmiauIuuPAg/640?wx_fmt=png"><img data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAbAMNtndHjWWdIJhQvNL138zkViaH4WIErOmsazpXXpLlNWmUN4ILzhmk8sShbUz2lLBfURbjA96NQ/640?wx_fmt=png" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAbAMNtndHjWWdIJhQvNL138zkViaH4WIErOmsazpXXpLlNWmUN4ILzhmk8sShbUz2lLBfURbjA96NQ/640?wx_fmt=png"><img data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAbAMNtndHjWWdIJhQvNL138J9GmyQXAoYOW03x2ddfMib3zfe1nia4AOjgcfGT6KaLs3x16ticW8dHSg/640?wx_fmt=png" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAbAMNtndHjWWdIJhQvNL138J9GmyQXAoYOW03x2ddfMib3zfe1nia4AOjgcfGT6KaLs3x16ticW8dHSg/640?wx_fmt=png"><img data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAbAMNtndHjWWdIJhQvNL1380N63bBL4pS9P2DShhcqCLia2dZ7LxXtMRPEVd3ADqicYzLjzRwGXBeSw/640?wx_fmt=png" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAbAMNtndHjWWdIJhQvNL1380N63bBL4pS9P2DShhcqCLia2dZ7LxXtMRPEVd3ADqicYzLjzRwGXBeSw/640?wx_fmt=png"></p></section><p><br></p><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/Tt44LkKfYy4GloEqou9gzw",target="_blank" rel="noopener noreferrer">原文链接</a>
