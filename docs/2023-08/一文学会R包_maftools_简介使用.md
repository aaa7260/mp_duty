---
title: "一文学会R包 maftools 简介使用"
date: 2023-08-01T22:54:19Z
draft: ["false"]
tags: [
  "fetched",
  "生信宝典"
]
categories: ["Acdemic"]
---
一文学会R包 maftools 简介使用 by 生信宝典
------
<div><p><strong><span>简 介</span></strong></p><section><span>  随着癌症基因组学的进步，突变注释格式 (Mutation Annotation Format, <strong>MAF</strong>) 被广泛接受，并用于存储检测到的体细胞变异。</span></section><p><img data-galleryid="" data-ratio="0.8321342925659473" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zfs9OSHUB2adzcAPJBIGoSItgxicIq8Jjt2pia7TOe5taSWCX9SlueJuLpfrCSqRZYe1SlkX2Qictqsviaz2BaQJxA/640?wx_fmt=png" data-type="png" data-w="834" src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zfs9OSHUB2adzcAPJBIGoSItgxicIq8Jjt2pia7TOe5taSWCX9SlueJuLpfrCSqRZYe1SlkX2Qictqsviaz2BaQJxA/640?wx_fmt=png"></p><section>... ...</section><section><img data-galleryid="" data-ratio="0.5520958083832336" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zfs9OSHUB2adzcAPJBIGoSItgxicIq8JjT5b46o9MibCjPHxx1HfRdEFCp4iao0nas5YjljxtqN8grEagsIAzaePw/640?wx_fmt=png" data-type="png" data-w="835" src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zfs9OSHUB2adzcAPJBIGoSItgxicIq8JjT5b46o9MibCjPHxx1HfRdEFCp4iao0nas5YjljxtqN8grEagsIAzaePw/640?wx_fmt=png"></section><section>... ...</section><section><img data-galleryid="" data-ratio="0.5584725536992841" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zfs9OSHUB2adzcAPJBIGoSItgxicIq8JjYwv2wfgxb4xXvk1nibPMeeM2OSxDjricicbTo9FoLgk7UJA5Q0XM7ct9A/640?wx_fmt=png" data-type="png" data-w="838" src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zfs9OSHUB2adzcAPJBIGoSItgxicIq8JjYwv2wfgxb4xXvk1nibPMeeM2OSxDjricicbTo9FoLgk7UJA5Q0XM7ct9A/640?wx_fmt=png"></section><section><span>GDC数据库的MAF文件的一些列</span></section><section><span>https://docs.gdc.cancer.gov/Data/File_Formats/MAF_Format/</span></section><p><span>  癌症基因组图谱项目 (The Cancer Genome Atlas, <strong>TCGA</strong>) 已对 <strong>30</strong> 多种不同的癌症进行了测序，每种癌症类型的样本量超过 <strong>200</strong> 个。<strong>TCGA</strong>的数据收录在<strong>GDC</strong> (Genomic data commons) 库中，由体细胞变异组成的结果数据以 <strong>MAF</strong> 文件格式存储。</span></p><p><img data-galleryid="" data-ratio="0.4209165687426557" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zfs9OSHUB2adzcAPJBIGoSItgxicIq8JjNOo9BaeKI5dsds0CD3y4dp15lLE1vDPG6wbfIbRllEkm3uV1VpVcuA/640?wx_fmt=png" data-type="png" data-w="4255" src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zfs9OSHUB2adzcAPJBIGoSItgxicIq8JjNOo9BaeKI5dsds0CD3y4dp15lLE1vDPG6wbfIbRllEkm3uV1VpVcuA/640?wx_fmt=png"></p><section><span>GDC对体细胞突变MAF文件的处理过程</span></section><p><span>The process for modifying a protected MAF into a somatic MAF</span></p><p><span>https://docs.gdc.cancer.gov/Data/File_Formats/MAF_Format/</span></p><section><span>  Mutation Annotation Format (MAF) is a <strong>tab-delimited text file</strong> with aggregated mutation information from VCF Files and are generated on a project-level. MAF files are produced through the <strong>Somatic Aggregation Workflow</strong>. The <strong>GDC</strong> produces MAF files at two permission levels: protected and somatic (or open-access). One MAF file is produced per variant calling pipeline per GDC project. MAFs are produced by aggregating the GDC annotated VCF files generated from one pipeline for one project.</span></section><section><span>  只要数据为 MAF 格式，maftools包将尝试以有效的方式从 TCGA 或 任何内部研究中 总结、分析、注释 和 可视化 MAF 文件。</span></section><section><span><img data-galleryid="" data-ratio="1.1749510763209394" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zfs9OSHUB2YvHpcFx8QBibdtfnwTu4Kl4oW4RIJzjjI0nLs9fBeJzQSOFa7YWCXKojysyRtc3bZl4wwot9qW3JQ/640?wx_fmt=png" data-type="png" data-w="2555" src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zfs9OSHUB2YvHpcFx8QBibdtfnwTu4Kl4oW4RIJzjjI0nLs9fBeJzQSOFa7YWCXKojysyRtc3bZl4wwot9qW3JQ/640?wx_fmt=png"></span></section><p><span>引用<br></span></p><p><span>Mayakonda A, Lin DC, Assenov Y, Plass C, Koeffler HP. 2018. <strong>Maftools: efficient and comprehensive analysis of somatic variants in cancer</strong>. Genome Resarch. PMID: 30341162</span></p><p><span>论文</span></p><p><span>https://genome.cshlp.org/content/28/11/1747.full.pdf+html</span></p><section><img data-galleryid="" data-ratio="0.37229783827061647" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zfs9OSHUB2YvHpcFx8QBibdtfnwTu4Kl43jRibyZIswUB8SxT2xy3dXMiafXDRCvozR9mQpPpJwNLyaoIRaKTDbHA/640?wx_fmt=png" data-type="png" data-w="1249" src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zfs9OSHUB2YvHpcFx8QBibdtfnwTu4Kl43jRibyZIswUB8SxT2xy3dXMiafXDRCvozR9mQpPpJwNLyaoIRaKTDbHA/640?wx_fmt=png"></section><section><span>Anand Mayakonda, http://poisonalien.github.io/</span></section><p><img data-galleryid="" data-ratio="0.5494752623688156" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zfs9OSHUB2YvHpcFx8QBibdtfnwTu4Kl4lltmfDZTkMML5SQmOAbYSt1z04h7HUHRGQgDjAjSdRzdmvPWib4TYfA/640?wx_fmt=png" data-type="png" data-w="1334" src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zfs9OSHUB2YvHpcFx8QBibdtfnwTu4Kl4lltmfDZTkMML5SQmOAbYSt1z04h7HUHRGQgDjAjSdRzdmvPWib4TYfA/640?wx_fmt=png"></p><p><span>论文 fig 1. m<span>aftools概述</span></span></p><p><span>  表头描述可用的模块，即：</span><span>可视化、设置操作、变异注释 和 分析。maftools包中为每个模块提供了一个小说明和</span><span><strong>相应的函数 (<em>粗体、斜体</em>)</strong></span><span>。典型的工作流：从MAF对象创建开始，要么读取MAF文件，要么将现有的注释转换为MAF对象，进而将其作为输入传递给所需的函数 (箭头)。</span></p><section><span>1) </span><span><strong><span>可视化模块 </span></strong></span><strong><span>(Visualization)</span></strong><span>：包括从输入的MAF对象生成可发表的图的函数；</span></section><section><span>2) </span><span><strong><span>分析模块 </span></strong></span><span><strong>(</strong><strong>Analysis)</strong></span><span>：提供了在癌症基因组学中执行常用分析的函数；</span></section><section><span>3) </span><span><strong><span>变异注释模块 </span></strong></span><span><strong>(Variant annotation)</strong></span><span>：使用 oncontator API 执行变异注释，对ANNOVAR等程序生成的注释进行格式转换；</span></section><section><span>4) </span><span><strong><span>设置操作 </span></strong></span><span><strong>(Set operation )</strong></span><span>：包括根据用户自定义，对MAF对象 <strong>取子集</strong> 的函数。</span></section><section><img data-galleryid="" data-ratio="0.6630336058128974" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zfs9OSHUB2YvHpcFx8QBibdtfnwTu4Kl46EhoWpgicHRoWQqbJoWibO8PWEvmXeLic4bDJ7azcfm4mpemFDeiazQXaQ/640?wx_fmt=png" data-type="png" data-w="1101" src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zfs9OSHUB2YvHpcFx8QBibdtfnwTu4Kl46EhoWpgicHRoWQqbJoWibO8PWEvmXeLic4bDJ7azcfm4mpemFDeiazQXaQ/640?wx_fmt=png"></section><p><span>论文 fig 2. m</span><span>aftools可视化模块生成的关键图</span></p><p><span>（A） 显示ESCA (Esophageal carcinoma, 食管癌) 队列的<strong>肿瘤体细胞突变景观图 </strong></span><span><strong>(</strong><strong>Oncoplot displaying the somatic landscape)</strong></span><span>。基因根据其</span><span><strong>突变频率</strong></span><span> (Mutation frequency) 排序，</span><strong><span>样本</span></strong><span>根据疾病组织学 (Histology) </span><span><strong>排序</strong></span><span>，如注释栏（此图的底部）所示。侧栏图：显示了 <strong>MutSigCV</strong> (接受来自多个样本的WGS/WES数据，以及有关点突变、小插入/缺失和覆盖率的信息，并识别出比偶然预期的突变频率更高的基因) 估计的 log10 变换的Q值。</span></p><section><span>（B） </span><strong><span>转换和颠换图</span></strong><span> (Transition and transversion plot, Ti/Tv) 显示了ESCA中SNV的分布，分为 6 个转换和颠换事件。</span><span><strong>堆积条形图</strong></span><span>（底部）显示了MAF文件中每个样本的突变谱分布。<br></span></section><section><span>（C） </span><span><strong>棒棒糖图</strong><strong> (Lollipop plot)</strong></span><span> 显示了ESCA中 TP53 的 突变在蛋白上的分布、及蛋白结构域。图中标记了反复出现的热点突变 (Recurrent hotspots)。<span>图的标题和副标题：</span>体细胞突变率 (Somatic mutation rate) 和转录本名称。</span></section><section><span>（D） TCGA乳腺癌</span><span><strong>单个样本</strong></span><span> TCGA-A8-A08B 的</span><strong><span>降雨图/雨点图</span></strong><span> (Rainfall plot)。每个点都是根据SNV的类别 (转换和颠换，<span>Ti/Tv</span>) 进行颜色编码。通过变点法 (C<span>hange-point method</span>) 识别的超高突变基因组片段，用黑色箭头突出显示。</span></section><p><img data-galleryid="" data-ratio="0.9568627450980393" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zfs9OSHUB2YvHpcFx8QBibdtfnwTu4Kl4j9aOAkgr7qIoDBqoGtjcxCP7PP6prIXpfDBeJxr4DkPSToMOJtwDtA/640?wx_fmt=png" data-type="png" data-w="765" src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zfs9OSHUB2YvHpcFx8QBibdtfnwTu4Kl4j9aOAkgr7qIoDBqoGtjcxCP7PP6prIXpfDBeJxr4DkPSToMOJtwDtA/640?wx_fmt=png"></p><section><span>论文 fig 3. 突变<span>特征和APOBEC富集分析</span></span></section><p><span>（A，B）分别在ESCC和EAC (食管鳞癌和食管腺癌) 中鉴定的</span><span><strong>突变特征 (Mutational signature)</strong></span><span>。Y轴表示：96个三核苷酸基序 (<span>6*4*4=96：</span>每1个三联体中，6种Ti/Tv中的每1种已确定，剩余2个核苷酸可随机组合) 所展示的整体特征 (Exposure of 96 trinucleotide motifs to overall signature)。图的标题显示了与验证的 COSMIC 特征和 cosine 相似值，以及所建议的原因 (Proposed etiology) 的最佳匹配。</span></p><p><span><strong><span>突变特征 (Mutational Signatures) 及APOBEC等富集</span></strong></span></p><p><span>  突变特征 (Mutational Signatures)，可参考 Nature (2013, doi:10.1038/nature12477) 中的定义。所有的癌症都是由体细胞突变引起的 </span><span><strong><span>(All cancers are caused by somatic mutations)</span></strong></span><span>，目前对于该生物学过程的理解有限。而来自癌症基因组的体细胞突变目录具有已经起作用的突变过程的特征 (The catalogue of somatic mutations from a cancer genome bears the signatures of the mutational processes that have been operative)。即：细胞在成长过程中基因组不断受到内源性和外源性DNA损伤的威胁，不断发生变化，最终发生一些突变的积累；每一个突变过程都会留下一个不同的基因组标记，称为"Mutational Signatures"。通过分析来自7,042个癌症 (Primary cancers of 30 different classes; 507 from WGS and 6,535 from WES)的4,938,362个突变，并提取了20多种不同的突变特征。一些特征存在于许多癌症类型中，特别是</span><span><strong><span>胞苷脱氨酶APOBEC家族的特征</span></strong></span><span>，而其它局限于单一的癌症类型。某些特征与癌症诊断时</span><span><strong><span>患者的年龄、已知的诱变暴露或DNA维持缺陷</span></strong></span><span>有关，但许多特征是未知的。除了这些全基因组突变特征外，在许多癌症类型中还发现了位于小基因组区域“kataegis”的超突变。<strong>突变特征的研究，揭示了癌症发展背后的突变过程的多样性，对了解癌症病因、预防和治疗具有潜在意义</strong>。</span></p><section><span>  在突变位点的两侧提取单个5'和3'碱基 (形成：三核苷酸基序 / Trinucleotide motifs)，进行de-novo特征分析，同时估计APOBEC富集分数。APOBEC3G蛋白属APOBEC家族成员，又称为CEM15蛋白，是一种胞嘧啶脱氨酶；APOBEC家族成员均被证明对单链DNA/RNA上的胞苷有脱氨基作用，可通过诱发靶基因上的胞嘧啶脱氨基成为尿嘧啶(C&gt;U) 参与大部分基因突变，从而形成1种特殊的<strong>突变特征 (Mutational signature)，体现为图中6种不同颜色柱形图的特征</strong>。“Defective DNA mismatch repair”形成另1种突变特征。</span></section><p><span>  </span><span><strong><span>COSMIC</span></strong></span><span> (Catalogue Of Somatic Mutations In Cancer, 癌症体细胞突变目录) 数据库记录了与人类癌症相关的驱动基因，搜集和记录了大量文献中的数百万肿瘤样本的编码区变异，以及促进癌症的所有体细胞突变的非编码区变异、基因融合、拷贝数变异和耐药基因变异。COSMIC采用人工审核的方式扩充数据库，实时追踪文献的最新信息，将与癌症相关的重要基因优先放入数据库中。COSMIC-3D可研究三维蛋白结构中的突变，及其对蛋白功能和药物的影响。</span></p><section><span><span>（C） 来自ESCC中APOBEC富集分析的结果。箱线图显示了</span><span><strong><span>APOBEC富集样本</span></strong></span><span>和</span><span><strong><span>非富集样本</span></strong></span><span>之间的突变负荷差异：(∗∗∗) Wilcoxon秩和检验；P&lt;0.001。甜甜圈图显示了</span><strong><span>tCw背景</span></strong><span> (tCw context) 下的突变比例。条形图显示了</span><span>APOBEC富集和非APOBEC富集样品之间的、前10个差异突变基因 </span><span>(Top 10 differentially mutated genes between APOBEC-enriched and non-APOBEC enriched samples)</span><span> ：(∗∗∗) P&lt;0.001；(∗∗) P&lt;0.01；(∗) P&lt;0.05，Fisher精确检验。</span></span></section><section><span>（D） 与DNA错配修复特征缺陷 (Defective MMR, <span>COSMIC Signature 6) </span>相关的<span>ESCC</span>样本中富集的 TGFBR2 突变。Enriched TGFBR2 mutations </span><span><strong>in ESCC among samples associated with defects in DNA mismatch repair signature</strong></span><span> (16% <em>vs.</em> 0% Rest). <span>样本数量分别为：56 </span><em>vs.</em><span> 40，即56个样本符合</span><span>COSMIC Signature 6 (即<span>Defective MMR) 的特征。</span></span></span></section><p><span>  TGFBR2 (TGF-Beta Receptor Type-2) 基因编码的蛋白质是一种跨膜蛋白，具有蛋白激酶结构域，与TGF-β受体1型 (TGF-beta receptor type-1) 形成异二聚体复合物，并</span><span><strong><span>结合TGF-β</span></strong></span><span>。这种受体/配体复合物可使蛋白磷酸化，然后进入细胞核并调节与细胞增殖、细胞周期停滞、伤口愈合、免疫抑制和肿瘤发生相关的基因的转录。</span></p><section><span>（E） 棒棒糖图显示 TGFBR2 中的突变分布，及其 BETR2 结构域中的截断突变 (Truncating mutations：frameshift deletions 和 splice site)。</span></section><section><img data-galleryid="" data-ratio="0.5915721231766613" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zfs9OSHUB2YvHpcFx8QBibdtfnwTu4Kl4jgVccZJaL0xn9FCDKe9YnUQ3FaVUgw7hhmHbETxEe7iabfbO6Ur5icCg/640?wx_fmt=png" data-type="png" data-w="1234" src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zfs9OSHUB2YvHpcFx8QBibdtfnwTu4Kl4jgVccZJaL0xn9FCDKe9YnUQ3FaVUgw7hhmHbETxEe7iabfbO6Ur5icCg/640?wx_fmt=png"></section><p><span>论文 fig 4. <span>队列比较 和 蛋白结构域的富集分析</span></span></p><p><span>（A） EAC和ESCC之间的差异突变基因 (Differentially mutated genes between EAC and ESCC) 显示为森林图 (Forest plot)。条形表示优势比 (Odds ratio) 的95%置信区间。右侧的表格包括：在被P值突出显示的基因的突变中，各自在EAC和ESCC中的样本数量。P值表示阈值的重要性：(∗∗∗) P&lt;0.001；(∗∗) P&lt;0.01；费舍尔精确检验。</span></p><section><span>（B）<span>EAC和ESCC中，</span>涉及与VGSC (电压门钠离子通道) 和ERBB信号相关基因的<strong>突变途径 </strong></span><span><strong>(Mutated pathways)</strong></span><span>。可见：与这些途径相关的基因优先在EAC中富集，并以</span><span><strong>互斥的方式</strong></span><span>突变。</span></section><p><span><strong><span>基因突变的互斥性与共现性</span></strong></span></p><p><span>  按照协同和互斥的作用模式，可将突变分为以下两类：</span><span><strong><span>1. Co-occurencing mutations；2. Mutually exclusive mutations</span></strong></span><span>。互斥的驱动基因往往共享相同的通路 (Pathway) 或 不同进展途径<span> (Different progression pathways，如不同肿瘤类型) </span>中的基因。</span></p><p><span>  肿瘤中已存在的基因突变可能影响 (或在功能上协同于) 其它基因的突变。与互斥模式相反，一些驱动基因之间也可能存在协同模式，两个协同的驱动突变往往同时或相继发生，</span><span><strong>共同促进</strong></span><span>肿瘤的发展。</span></p><section><span><strong><span>相关性角度</span></strong></span><span>：Co-occurrence and mutual exclusivity (</span><strong><span>COME</span></strong><span>) of DNA mutation refer to two or more genes that tend to be </span><strong><span>positively </span></strong><span>or </span><strong><span>negatively correlated</span></strong><span> in DNA <span>mutation</span> among different samples.</span></section><section><span><strong><span>功能协作性角度</span></strong></span><span>：共发生的驱动基因 (Co-occurring driver genes) 通常会激活互相合作、协作的致癌途径 (Collaborating oncogenic pathways)。PMID: 34031014, DOI: 10.1016/j.trecan.2021.04.009。互斥发生的驱动基因，二者可相互独立地导致对某个生物过程的影响，而</span><strong><span>无协同与互作的必要</span></strong><span>。</span></section><section><span><strong><span>信号通路的角度</span></strong></span><span>：共发生的突变往往涉及平行信号通路 (Parallel signaling pathways) 中的基因；而互斥的突变可能涉及共同通路 (Common pathway，如同一个家族中的基因，但也不绝对)，或不同进展途径中的基因 (Different progression pathways，如不同肿瘤类型中的基因)。互斥也可能涉及合成致死基因 (Genes that are synthetically lethal)。不过这些解释只是"hand waving arguments"。参与肿瘤发生的生物途径复杂、且相互关联，很难定义信号途径的边界，以及平行或共同途径的概念。Cancer Res (2015) 75 (19): 4042–4052. https://doi.org/10.1158/0008-5472.CAN-15-0602</span></section><p><span>（C，D）分别在EAC和ESCC中</span><span><strong><span>频繁突变的 pfam 蛋白结构域</span></strong></span><span>。突出显示了前10个域。气泡大小与包含突出显示的结构域的基因数量成比例。Ion_ trans 结构域在EAC中大量突变。</span></p><section><img data-galleryid="" data-ratio="1.1022222222222222" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zfs9OSHUB2YvHpcFx8QBibdtfnwTu4Kl4M1WQ8dZpt5fQicJjNWjWVsmrtRSvOrKJRt0YsqLJGNibibicDD1SH30yqA/640?wx_fmt=png" data-type="png" data-w="675" src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zfs9OSHUB2YvHpcFx8QBibdtfnwTu4Kl4M1WQ8dZpt5fQicJjNWjWVsmrtRSvOrKJRt0YsqLJGNibibicDD1SH30yqA/640?wx_fmt=png"></section><section><span>论文 fig 5. <span>途径/Pathway和临床富集分析</span></span></section><p><span>（A） AML中</span><strong><span>互斥和共存</span></strong><span>的 (Exclusive and co-occurring) 基因对显示为三角矩阵。</span><span><strong>绿色</strong></span><span>表示共现 (<span>co-occurring</span>) 趋势，而</span><span><strong>粉色</strong></span><span>表示排它性 (Exclusiveness) 趋势。</span></p><p><span>（B） 通过CoMEt精确检验，发现AML中存在</span><span><strong>显著改变的途径</strong></span><span>，涉及NPM1、RUNX1和TP53基因，以相互排斥的方式突变（P&lt;0.001）。</span></p><p><span>（C） TCGA AML队列中由 </span><span><strong>oncodrive</strong></span><span> 鉴定的</span><strong><span>疾病相关驱动基因（FDR&lt;0.1）</span></strong><span>。括号内突出显示了紧密间隔突变簇 (C<span>losely spaced mutational clusters</span>) 的数量。</span></p><p><span>（D） MutSigCV 鉴定的ESCA中显著突变基因与</span><strong><span>泛癌驱动基因</span></strong><span>的泛癌比较。TGFBR2和ZNF750</span><strong><span>仅在</span></strong><span>食管癌中发生突变，而其它驱动因素，如TP53和CDKN2A，在</span><span><strong>整个</strong></span><span>泛癌队列中发生突变。<br></span></p><p><span>（E，F）条形图分别显示了</span><span><strong>基因与临床特征</strong></span><span>、FAB（French–American–British）分类和年龄组之间的相关性（P&lt;0.05，Fisher精确检验）。条形图用突变样本与总样本的比率进行注释。误差条显示二项比率的95% CI。Y轴表示与表型相关的样本分数 (Fraction of samples associated with the phenotype)。</span></p><section><strong><span>安 装</span></strong><br></section><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="sql"><code><span>rm(list = ls())</span></code><code><span><br></span></code><code><span># 本机R的版本</span></code><code><span># [64-bit] C:\Program Files\R\R-4.0.4</span></code><code><span><br></span></code><code><span># 本机R包的位置</span></code><code><span>.libPaths()</span></code><code><span># "C:/Users/HP/Documents/R/win-library/4.0" "C:/Program Files/R/R-4.0.4/library"</span></code><code><span><br></span></code><code><span># 设置R包的 install.packages 的下载镜像</span></code><code><span>site = "https://mirrors.tuna.tsinghua.edu.cn/CRAN"</span></code><code><span><br></span></code><code><span>if (!requireNamespace("BiocManager", quietly = TRUE))</span></code><code><span>  install.packages("BiocManager", repos = site)</span></code><code><span><br></span></code><code><span>current_packages = rownames(installed.packages())</span></code><code><span><br></span></code><code><span>needed_packages = c("maftools", "BSgenome.Hsapiens.UCSC.hg38", "BSgenome.Hsapiens.UCSC.hg19")</span></code><code><span><br></span></code><code><span>for (i in needed_packages) {</span></code><code><span>  if (!i %in% current_packages)</span></code><code><span>    BiocManager::install(i, update = F, site_repository=site)</span></code><code><span>  current_packages = rownames(installed.packages())</span></code><code><span>}</span></code><code><span><br></span></code><code><span>needed_packages2 &lt;- c("mclust", "NMF", "barplot3d", "knitr")</span></code><code><span><br></span></code><code><span>for (j in needed_packages2) {</span></code><code><span>  if (!j %in% current_packages)</span></code><code><span>    install.packages(j)</span></code><code><span>    current_packages = rownames(installed.packages())</span></code><code><span>}</span></code><code><span><br></span></code><code><span>library(maftools)</span></code><code><span>library(mclust)</span></code><code><span>library(NMF)</span></code><code><span>library(pheatmap)</span></code><code><span>library(barplot3d)</span></code><code><span>library(openxlsx)</span></code></pre></section><p><span><strong>帮 助</strong></span></p><section><ul><li><li></ul><pre data-lang="apache"><code><span># R</span></code><code><span>??maftools</span></code></pre></section><section><img data-galleryid="" data-ratio="0.38580246913580246" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zfs9OSHUB2YvHpcFx8QBibdtfnwTu4Kl4EjXYvkY6OEkWk1xTuvkFibZRwgT5WR7yn3A5HwKjZTGlxVDsGFe6iaAQ/640?wx_fmt=png" data-type="png" data-w="648" src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zfs9OSHUB2YvHpcFx8QBibdtfnwTu4Kl4EjXYvkY6OEkWk1xTuvkFibZRwgT5WR7yn3A5HwKjZTGlxVDsGFe6iaAQ/640?wx_fmt=png"></section><p><span>R包的帮助</span></p><p><img data-galleryid="" data-ratio="0.40963855421686746" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zfs9OSHUB2YvHpcFx8QBibdtfnwTu4Kl4cIxjWWsRibgjibj0iccQHteX1APcBlRKbHuVCjs7D1ibHNpDiaEzXDPxLXw/640?wx_fmt=png" data-type="png" data-w="664" src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zfs9OSHUB2YvHpcFx8QBibdtfnwTu4Kl4cIxjWWsRibgjibj0iccQHteX1APcBlRKbHuVCjs7D1ibHNpDiaEzXDPxLXw/640?wx_fmt=png"></p><section><span>maftools包的整体介绍</span></section><p><img data-ratio="0.6099290780141844" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zfs9OSHUB2YvHpcFx8QBibdtfnwTu4Kl4IntGXYtSz9T1hibQhpgYfaKf1As2EhVBIEDfncCZdLwPfzGBXzxvibew/640?wx_fmt=png" data-type="png" data-w="564" title="fig3.png" src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zfs9OSHUB2YvHpcFx8QBibdtfnwTu4Kl4IntGXYtSz9T1hibQhpgYfaKf1As2EhVBIEDfncCZdLwPfzGBXzxvibew/640?wx_fmt=png"></p><p><span>maftools包的示例代码</span></p><p><span><strong>输入文件</strong></span></p><h1><span><strong>生成 MAF 文件</strong></span></h1><ul><li><p><span><span>1. 对于 VCF 文件或一些表格，可简单地使用 </span><strong>vcf2maf</strong><span> 程序 (<span>链接</span>见文末)：注释 VCF，排序或设置转录本的</span><span>优先级</span><span>，并生成 MAF 文件。</span></span></p></li><li><p><span><span>2. GATK的更新版本，如v4.0版，可使用 </span><strong>gakt funcotator</strong><span> <span> (<span>链接</span>见文末)</span> 生成 MAF 文件。</span></span></p></li><li><p><span>3. 如果使用 <strong>ANNOVAR</strong> <span> (<span>链接</span>见文末)</span> 进行变异注释，maftools 有一个方便的函数 <strong>annovarToMaf</strong> ，用于将表格形式的 annovar 输出文件，转换为 MAF。</span></p></li></ul><h1><span><strong>MAF文件中需要的字段 (Field，即：文件中的“列”)</strong></span></h1><section><span><span>  MAF 文件包含许多字段，从染色体名称，到 </span><span>cosmic </span><span>注释等。但 maftools 中的大多数分析都使用以下字段。</span></span></section><ul><li><p><span>必须的字段：<strong>Hugo_Symbol</strong>, Chromosome, Start_Position, End_Position, <strong>Reference_Allele</strong>, <strong>Tumor_Seq_Allele2</strong>, <strong>Variant_Classification</strong>, <strong>Variant_Type </strong> 和 <strong>Tumor_Sample_Barcode</strong></span></p></li><li><p><span><span>推荐的可选字段：包含 </span><strong>VAF</strong><span>（Variant Allele Frequency）和 </span><strong>氨基酸变化</strong><span> 信息的非 MAF 特定字段 (</span><span>non MAF specific fields</span><span>)。</span></span></p></li></ul><p><span>  MAF 文件的完整文件规范，可以在 NCI GDC 文档页面上找到 (<span>链接</span><span>见文末</span>)。</span></p><p><span>  本文的对maftools的介绍，使用了<span> TCGA的 LAML 队列<span> (<span>链接</span><span>见文末</span>)，用其</span>MAF 文件作为示例，展示了 maftools 的使用及应用。</span></span></p><section><span>资料来源</span></section><p><strong><span>maftools : Summarize, Analyze and Visualize MAF Files</span></strong></p><p><span><strong>Anand Mayakonda</strong> 2022-04-26</span></p><p><span>https://bioconductor.org/packages/release/bioc/vignettes/maftools/inst/doc/maftools.html</span></p><section><strong><span>Package ‘maftools’</span></strong><span> August 11, 2022</span></section><section><span>https://master.bioconductor.org/packages/release/bioc/manuals/maftools/man/maftools.pdf</span></section><section><span>Mutation Annotation Format, <strong>MAF</strong></span></section><section><span>https://docs.gdc.cancer.gov/Data/File_Formats/MAF_Format/</span></section><section><strong><span>vcf2maf </span></strong><span>程序</span></section><section><span>https://github.com/mskcc/vcf2maf</span></section><section><strong><span>gakt funcotator</span></strong><span> 程序</span></section><p><span>https://gatk.broadinstitute.org/hc/en-us/articles/360035889931-Funcotator-Information-and-Tutorial</span></p><p><strong><span>ANNOVAR</span></strong></p><p><span>https://annovar.openbioinformatics.org/en/latest/</span></p><p><strong><span>示例数据</span></strong><span>：TCGA的 LAML 队列</span></p><section><span>Cancer Genome Atlas Research, N. Genomic and epigenomic landscapes of adult de novo acute myeloid leukemia. N Engl J Med 368, 2059-74 (2013).<br><br><br></span></section><h2 mp-original-font-size="30" mp-original-line-height="36">初始化，准备R包</h2><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><p mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867"><span mp-original-font-size="13" mp-original-line-height="16.25"><span mp-original-font-size="13" mp-original-line-height="16.25">rm</span>(<span mp-original-font-size="13" mp-original-line-height="16.25">list =</span> <span mp-original-font-size="13" mp-original-line-height="16.25">ls</span>())</span></code></p><p mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867"><span mp-original-font-size="13" mp-original-line-height="16.25"><span mp-original-font-size="13" mp-original-line-height="16.25"># 本机R的版本</span></span></code></p><p mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867"><span mp-original-font-size="13" mp-original-line-height="16.25"><span mp-original-font-size="13" mp-original-line-height="16.25"># [64-bit] C:\Program Files\R\R-4.0.4</span></span></code></p><p mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867"><span mp-original-font-size="13" mp-original-line-height="16.25"><span mp-original-font-size="13" mp-original-line-height="16.25"># 本机R包的位置</span></span></code></p><p mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867"><span mp-original-font-size="13" mp-original-line-height="16.25"><span mp-original-font-size="13" mp-original-line-height="16.25">.libPaths</span>()</span></code></p></pre><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867">## [1] "C:/Users/HP/Documents/R/win-library/4.0"<br mp-original-font-size="13" mp-original-line-height="18.571409225463867">## [2] "C:/Program Files/R/R-4.0.4/library"</code></pre><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><p mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867"><span mp-original-font-size="13" mp-original-line-height="16.25"><span mp-original-font-size="13" mp-original-line-height="16.25"># "C:/Users/HP/Documents/R/win-library/4.0" "C:/Program Files/R/R-4.0.4/library"</span></span><span mp-original-font-size="13" mp-original-line-height="16.25"><span mp-original-font-size="13" mp-original-line-height="16.25"># 设置R包的 install.packages 的下载镜像</span></span><span mp-original-font-size="13" mp-original-line-height="16.25">site <span mp-original-font-size="13" mp-original-line-height="16.25">=</span> <span mp-original-font-size="13" mp-original-line-height="16.25">"https://mirrors.tuna.tsinghua.edu.cn/CRAN"</span></span></code></p><p mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867"><span mp-original-font-size="13" mp-original-line-height="16.25"><span mp-original-font-size="13" mp-original-line-height="16.25"><br mp-original-font-size="13" mp-original-line-height="16.25"></span></span></code></p><p mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867"><span mp-original-font-size="13" mp-original-line-height="16.25"><span mp-original-font-size="13" mp-original-line-height="16.25">if</span> (<span mp-original-font-size="13" mp-original-line-height="16.25">!</span><span mp-original-font-size="13" mp-original-line-height="16.25">requireNamespace</span>(<span mp-original-font-size="13" mp-original-line-height="16.25">"BiocManager"</span>, <span mp-original-font-size="13" mp-original-line-height="16.25">quietly =</span> <span mp-original-font-size="13" mp-original-line-height="16.25">TRUE</span>))</span><span mp-original-font-size="13" mp-original-line-height="16.25">  <span mp-original-font-size="13" mp-original-line-height="16.25">install.packages</span>(<span mp-original-font-size="13" mp-original-line-height="16.25">"BiocManager"</span>, <span mp-original-font-size="13" mp-original-line-height="16.25">repos =</span> site)</span><span mp-original-font-size="13" mp-original-line-height="16.25">current_packages <span mp-original-font-size="13" mp-original-line-height="16.25">=</span> <span mp-original-font-size="13" mp-original-line-height="16.25">rownames</span>(<span mp-original-font-size="13" mp-original-line-height="16.25">installed.packages</span>())</span></code></p><p mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867"><span mp-original-font-size="13" mp-original-line-height="16.25"><br mp-original-font-size="13" mp-original-line-height="16.25"></span></code></p><p mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867"><span mp-original-font-size="13" mp-original-line-height="16.25">needed_packages <span mp-original-font-size="13" mp-original-line-height="16.25">&lt;-</span> <span mp-original-font-size="13" mp-original-line-height="16.25">c</span>(<span mp-original-font-size="13" mp-original-line-height="16.25">"maftools"</span>, <span mp-original-font-size="13" mp-original-line-height="16.25">"BSgenome.Hsapiens.UCSC.hg38"</span>, <span mp-original-font-size="13" mp-original-line-height="16.25">"BSgenome.Hsapiens.UCSC.hg19"</span>)</span></code></p><p mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867"><span mp-original-font-size="13" mp-original-line-height="16.25"><span mp-original-font-size="13" mp-original-line-height="16.25"><br mp-original-font-size="13" mp-original-line-height="16.25"></span></span></code></p><p mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867"><span mp-original-font-size="13" mp-original-line-height="16.25"><span mp-original-font-size="13" mp-original-line-height="16.25">for</span> (i <span mp-original-font-size="13" mp-original-line-height="16.25">in</span> needed_packages) {</span><span mp-original-font-size="13" mp-original-line-height="16.25">  <span mp-original-font-size="13" mp-original-line-height="16.25">if</span> (<span mp-original-font-size="13" mp-original-line-height="16.25">!</span>i <span mp-original-font-size="13" mp-original-line-height="16.25">%in%</span> current_packages)</span><span mp-original-font-size="13" mp-original-line-height="16.25">    BiocManager<span mp-original-font-size="13" mp-original-line-height="16.25">::</span><span mp-original-font-size="13" mp-original-line-height="16.25">install</span>(i, <span mp-original-font-size="13" mp-original-line-height="16.25">update =</span> F, <span mp-original-font-size="13" mp-original-line-height="16.25">site_repository=</span>site)</span><span mp-original-font-size="13" mp-original-line-height="16.25">  current_packages <span mp-original-font-size="13" mp-original-line-height="16.25">=</span> <span mp-original-font-size="13" mp-original-line-height="16.25">rownames</span>(<span mp-original-font-size="13" mp-original-line-height="16.25">installed.packages</span>())</span><span mp-original-font-size="13" mp-original-line-height="16.25">}</span></code></p><p mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867"><span mp-original-font-size="13" mp-original-line-height="16.25"><br mp-original-font-size="13" mp-original-line-height="16.25"></span></code></p><p mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867"><span mp-original-font-size="13" mp-original-line-height="16.25">needed_packages2 <span mp-original-font-size="13" mp-original-line-height="16.25">&lt;-</span> <span mp-original-font-size="13" mp-original-line-height="16.25">c</span>(<span mp-original-font-size="13" mp-original-line-height="16.25">"mclust"</span>, <span mp-original-font-size="13" mp-original-line-height="16.25">"NMF"</span>, <span mp-original-font-size="13" mp-original-line-height="16.25">"barplot3d"</span>, <span mp-original-font-size="13" mp-original-line-height="16.25">"knitr"</span>)</span></code></p><p mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867"><span mp-original-font-size="13" mp-original-line-height="16.25"><span mp-original-font-size="13" mp-original-line-height="16.25"><br mp-original-font-size="13" mp-original-line-height="16.25"></span></span></code></p><p mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867"><span mp-original-font-size="13" mp-original-line-height="16.25"><span mp-original-font-size="13" mp-original-line-height="16.25">for</span> (j <span mp-original-font-size="13" mp-original-line-height="16.25">in</span> needed_packages2) {</span><span mp-original-font-size="13" mp-original-line-height="16.25">  <span mp-original-font-size="13" mp-original-line-height="16.25">if</span> (<span mp-original-font-size="13" mp-original-line-height="16.25">!</span>j <span mp-original-font-size="13" mp-original-line-height="16.25">%in%</span> current_packages)</span><span mp-original-font-size="13" mp-original-line-height="16.25">    <span mp-original-font-size="13" mp-original-line-height="16.25">install.packages</span>(j)</span><span mp-original-font-size="13" mp-original-line-height="16.25">    current_packages <span mp-original-font-size="13" mp-original-line-height="16.25">=</span> <span mp-original-font-size="13" mp-original-line-height="16.25">rownames</span>(<span mp-original-font-size="13" mp-original-line-height="16.25">installed.packages</span>())</span><span mp-original-font-size="13" mp-original-line-height="16.25">}</span></code></p><p mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867"><span mp-original-font-size="13" mp-original-line-height="16.25"><br mp-original-font-size="13" mp-original-line-height="16.25"></span></code></p><p mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867"><span mp-original-font-size="13" mp-original-line-height="16.25"><span mp-original-font-size="13" mp-original-line-height="16.25">library</span>(maftools)</span></code></p><p mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867"><span mp-original-font-size="13" mp-original-line-height="16.25"><span mp-original-font-size="13" mp-original-line-height="16.25">library</span>(mclust)</span></code></p><p mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867"><span mp-original-font-size="13" mp-original-line-height="16.25"><span mp-original-font-size="13" mp-original-line-height="16.25">library</span>(NMF)</span></code></p><p mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867"><span mp-original-font-size="13" mp-original-line-height="16.25"><span mp-original-font-size="13" mp-original-line-height="16.25">library</span>(pheatmap)</span></code></p><p mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867"><span mp-original-font-size="13" mp-original-line-height="16.25"><span mp-original-font-size="13" mp-original-line-height="16.25">library</span>(barplot3d)</span></code></p></pre><section mp-original-font-size="17" mp-original-line-height="27.200000762939453">查看帮助文档</section><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867"><span mp-original-font-size="13" mp-original-line-height="16.25">??maftools</span></code></pre><h2 mp-original-font-size="30" mp-original-line-height="36">读入maf文件及临床信息</h2><p mp-original-font-size="17" mp-original-line-height="27.200000762939453">设置：maftools包自带的、示例数据的位置，即TCGA LAML MAF文件。本机在：</p><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867">* C:\Users\HP\Documents\R\win-library\4.0\maftools\extdata\tcga_laml.maf.gz<br mp-original-font-size="13" mp-original-line-height="18.571409225463867"><br mp-original-font-size="13" mp-original-line-height="18.571409225463867">* 共2208行，表头、字段包含：<br mp-original-font-size="13" mp-original-line-height="18.571409225463867"><br mp-original-font-size="13" mp-original-line-height="18.571409225463867">* Hugo_Symbol   Entrez_Gene_Id  Center  NCBI_Build  Chromosome  Start_Position<br mp-original-font-size="13" mp-original-line-height="18.571409225463867">* End_position  Strand  Variant_Classification  Variant_Type    Reference_Allele<br mp-original-font-size="13" mp-original-line-height="18.571409225463867">* Tumor_Seq_Allele1  Tumor_Seq_Allele2  Tumor_Sample_Barcode<br mp-original-font-size="13" mp-original-line-height="18.571409225463867">* Protein_Change       i_TumorVAF_WU        i_transcript_name</code></pre><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867"><span mp-original-font-size="13" mp-original-line-height="16.25">laml.maf <span mp-original-font-size="13" mp-original-line-height="16.25">=</span> <span mp-original-font-size="13" mp-original-line-height="16.25">system.file</span>(<span mp-original-font-size="13" mp-original-line-height="16.25">'extdata'</span>, <span mp-original-font-size="13" mp-original-line-height="16.25">'tcga_laml.maf.gz'</span>, <span mp-original-font-size="13" mp-original-line-height="16.25">package =</span> <span mp-original-font-size="13" mp-original-line-height="16.25">'maftools'</span>)</span></code></pre><p mp-original-font-size="17" mp-original-line-height="27.200000762939453">设置：患者生存信息、组织学 (Histology)分类等的临床信息。该文件的可选的 (Optional)</p><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867">* 共200个样本：<br mp-original-font-size="13" mp-original-line-height="18.571409225463867"><br mp-original-font-size="13" mp-original-line-height="18.571409225463867">* Tumor_Sample_Barcode FAB_classification   days_to_last_followup  Overall_Survival_Status<br mp-original-font-size="13" mp-original-line-height="18.571409225463867">* TCGA-AB-2802      M4   365     1<br mp-original-font-size="13" mp-original-line-height="18.571409225463867">* TCGA-AB-2803      M3   792     1<br mp-original-font-size="13" mp-original-line-height="18.571409225463867">* TCGA-AB-2804      M3   2557    0<br mp-original-font-size="13" mp-original-line-height="18.571409225463867">... ...</code></pre><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867"><span mp-original-font-size="13" mp-original-line-height="16.25">laml.clin <span mp-original-font-size="13" mp-original-line-height="16.25">=</span> <span mp-original-font-size="13" mp-original-line-height="16.25">system.file</span>(<span mp-original-font-size="13" mp-original-line-height="16.25">'extdata'</span>, <span mp-original-font-size="13" mp-original-line-height="16.25">'tcga_laml_annot.tsv'</span>, <span mp-original-font-size="13" mp-original-line-height="16.25">package =</span> <span mp-original-font-size="13" mp-original-line-height="16.25">'maftools'</span>)</span></code></pre><p mp-original-font-size="17" mp-original-line-height="27.200000762939453">读入MAF文件(及临床信息)</p><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867"><span mp-original-font-size="13" mp-original-line-height="16.25">laml.maf</span></code></pre><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867">## [1] "C:/Users/HP/Documents/R/win-library/4.0/maftools/extdata/tcga_laml.maf.gz"</code></pre><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867"><span mp-original-font-size="13" mp-original-line-height="16.25">laml.clin</span></code></pre><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867">## [1] "C:/Users/HP/Documents/R/win-library/4.0/maftools/extdata/tcga_laml_annot.tsv"</code></pre><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867"><span mp-original-font-size="13" mp-original-line-height="16.25">laml <span mp-original-font-size="13" mp-original-line-height="16.25">=</span> <span mp-original-font-size="13" mp-original-line-height="16.25">read.maf</span>(<span mp-original-font-size="13" mp-original-line-height="16.25">maf =</span> laml.maf, <span mp-original-font-size="13" mp-original-line-height="16.25">clinicalData =</span> laml.clin)</span></code></pre><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867">## -Reading<br mp-original-font-size="13" mp-original-line-height="18.571409225463867">## -Validating<br mp-original-font-size="13" mp-original-line-height="18.571409225463867">## -Silent variants: 475 <br mp-original-font-size="13" mp-original-line-height="18.571409225463867">## -Summarizing<br mp-original-font-size="13" mp-original-line-height="18.571409225463867">## -Processing clinical data<br mp-original-font-size="13" mp-original-line-height="18.571409225463867">## -Finished in 1.900s elapsed (0.360s cpu)</code></pre><p mp-original-font-size="17" mp-original-line-height="27.200000762939453"><strong mp-original-font-size="17" mp-original-line-height="27.200000762939453">Silent variants</strong>：包含 同义突变/Synonymous</p><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867">沉默突变即同义突变，Silent mutation；同义突变的，Synonymous<br mp-original-font-size="13" mp-original-line-height="18.571409225463867">    syn_vars  = laml_dt[Variant_Classification %in% "Silent"]<br mp-original-font-size="13" mp-original-line-height="18.571409225463867"><br mp-original-font-size="13" mp-original-line-height="18.571409225463867">非同义突变，non-Synonymous mutation<br mp-original-font-size="13" mp-original-line-height="18.571409225463867">    nsyn_vars = laml_dt[Variant_Classification %in% "Missense_Mutation"]</code></pre><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867"><span mp-original-font-size="13" mp-original-line-height="16.25"><span mp-original-font-size="13" mp-original-line-height="16.25"># str(laml)</span></span><span mp-original-font-size="13" mp-original-line-height="16.25"><span mp-original-font-size="13" mp-original-line-height="16.25">slotNames</span>(laml)</span></code></pre><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867">## [1] "data"                           "variants.per.sample"           <br mp-original-font-size="13" mp-original-line-height="18.571409225463867">## [3] "variant.type.summary"           "variant.classification.summary"<br mp-original-font-size="13" mp-original-line-height="18.571409225463867">## [5] "gene.summary"                   "summary"                       <br mp-original-font-size="13" mp-original-line-height="18.571409225463867">## [7] "maf.silent"                     "clinical.data"</code></pre><p mp-original-font-size="17" mp-original-line-height="27.200000762939453"><strong mp-original-font-size="17" mp-original-line-height="27.200000762939453">注意</strong>：</p><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867">* read.maf函数默认将 Silent variants 拆分出来了，放在 laml@maf.silent 中，而非 laml@data 中</code></pre><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867"><span mp-original-font-size="13" mp-original-line-height="16.25"><span mp-original-font-size="13" mp-original-line-height="16.25">table</span>(laml<span mp-original-font-size="13" mp-original-line-height="16.25">@</span>data<span mp-original-font-size="13" mp-original-line-height="16.25">$</span>Variant_Type)</span></code></pre><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867">## <br mp-original-font-size="13" mp-original-line-height="18.571409225463867">##  DEL  INS  SNP <br mp-original-font-size="13" mp-original-line-height="18.571409225463867">##   64  141 1527</code></pre><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867"><span mp-original-font-size="13" mp-original-line-height="16.25"><span mp-original-font-size="13" mp-original-line-height="16.25">table</span>(laml<span mp-original-font-size="13" mp-original-line-height="16.25">@</span>data<span mp-original-font-size="13" mp-original-line-height="16.25">$</span>Variant_Classification)</span></code></pre><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867">## <br mp-original-font-size="13" mp-original-line-height="18.571409225463867">##   Frame_Shift_Del   Frame_Shift_Ins      In_Frame_Del      In_Frame_Ins <br mp-original-font-size="13" mp-original-line-height="18.571409225463867">##                52                91                10                42 <br mp-original-font-size="13" mp-original-line-height="18.571409225463867">## Missense_Mutation Nonsense_Mutation       Splice_Site <br mp-original-font-size="13" mp-original-line-height="18.571409225463867">##              1342               103                92</code></pre><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867"><span mp-original-font-size="13" mp-original-line-height="16.25">laml<span mp-original-font-size="13" mp-original-line-height="16.25">@</span>maf.silent</span></code></pre><h2 mp-original-font-size="30" mp-original-line-height="36">MAF文件概要</h2><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867"><span mp-original-font-size="13" mp-original-line-height="16.25">laml</span></code></pre><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867">## An object of class  MAF <br mp-original-font-size="13" mp-original-line-height="18.571409225463867">##                    ID          summary  Mean Median<br mp-original-font-size="13" mp-original-line-height="18.571409225463867">##  1:        NCBI_Build               37    NA     NA<br mp-original-font-size="13" mp-original-line-height="18.571409225463867">##  2:            Center genome.wustl.edu    NA     NA<br mp-original-font-size="13" mp-original-line-height="18.571409225463867">##  3:           Samples              193    NA     NA<br mp-original-font-size="13" mp-original-line-height="18.571409225463867"></code></pre><p mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867"><span mp-original-font-size="13" mp-original-line-height="16.25"><span mp-original-font-size="13" mp-original-line-height="16.25"># Shows sample summry</span></span><span mp-original-font-size="13" mp-original-line-height="16.25"><span mp-original-font-size="13" mp-original-line-height="16.25">getSampleSummary</span>(laml)</span></code></p><p mp-original-font-size="17" mp-original-line-height="27.200000762939453"><br mp-original-font-size="17" mp-original-line-height="27.200000762939453"></p><p mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867"><span mp-original-font-size="13" mp-original-line-height="16.25"><span mp-original-font-size="13" mp-original-line-height="16.25"># Shows gene summary</span></span><span mp-original-font-size="13" mp-original-line-height="16.25"><span mp-original-font-size="13" mp-original-line-height="16.25">getGeneSummary</span>(laml)</span></code></p><p mp-original-font-size="17" mp-original-line-height="27.200000762939453"><br mp-original-font-size="17" mp-original-line-height="27.200000762939453"></p><p mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867"><span mp-original-font-size="13" mp-original-line-height="16.25"><span mp-original-font-size="13" mp-original-line-height="16.25"># shows clinical data associated with samples</span></span><span mp-original-font-size="13" mp-original-line-height="16.25"><span mp-original-font-size="13" mp-original-line-height="16.25">getClinicalData</span>(laml)</span></code></p><p mp-original-font-size="17" mp-original-line-height="27.200000762939453"><br mp-original-font-size="17" mp-original-line-height="27.200000762939453"></p><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867"><span mp-original-font-size="13" mp-original-line-height="16.25"><span mp-original-font-size="13" mp-original-line-height="16.25"># Shows all fields in MAF</span></span><span mp-original-font-size="13" mp-original-line-height="16.25"><span mp-original-font-size="13" mp-original-line-height="16.25">getFields</span>(laml)</span></code></pre><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867">##  [1] "Hugo_Symbol"            "Entrez_Gene_Id"         "Center"                <br mp-original-font-size="13" mp-original-line-height="18.571409225463867">##  [4] "NCBI_Build"             "Chromosome"             "Start_Position"        <br mp-original-font-size="13" mp-original-line-height="18.571409225463867">##  [7] "End_Position"           "Strand"                 "Variant_Classification"<br mp-original-font-size="13" mp-original-line-height="18.571409225463867">## [10] "Variant_Type"           "Reference_Allele"       "Tumor_Seq_Allele1"     <br mp-original-font-size="13" mp-original-line-height="18.571409225463867">## [13] "Tumor_Seq_Allele2"      "Tumor_Sample_Barcode"   "Protein_Change"        <br mp-original-font-size="13" mp-original-line-height="18.571409225463867">## [16] "i_TumorVAF_WU"          "i_transcript_name"</code></pre><p mp-original-font-size="17" mp-original-line-height="27.200000762939453">将MAF文件的总结结果写到文件中</p><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867"><span mp-original-font-size="13" mp-original-line-height="16.25"><span mp-original-font-size="13" mp-original-line-height="16.25"># Writes maf summary to an output file with basename laml</span></span><span mp-original-font-size="13" mp-original-line-height="16.25"><span mp-original-font-size="13" mp-original-line-height="16.25">write.mafSummary</span>(<span mp-original-font-size="13" mp-original-line-height="16.25">maf =</span> laml, <span mp-original-font-size="13" mp-original-line-height="16.25">basename =</span> <span mp-original-font-size="13" mp-original-line-height="16.25">'laml'</span>)</span></code></pre><h2 mp-original-font-size="30" mp-original-line-height="36">对MAF对象取子集</h2><p mp-original-font-size="17" mp-original-line-height="27.200000762939453">属于设置操作 (Set operation)：根据用户自定义，对MAF对象<strong mp-original-font-size="17" mp-original-line-height="27.200000762939453">取子集</strong></p><p mp-original-font-size="17" mp-original-line-height="27.200000762939453">取部分样本</p><p mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867"><span mp-original-font-size="13" mp-original-line-height="16.25"><span mp-original-font-size="13" mp-original-line-height="16.25"># Extract data for samples 'TCGA.AB.3009' and 'TCGA.AB.2933'  (Printing just 5 rows for display convenience)</span></span><span mp-original-font-size="13" mp-original-line-height="16.25"><span mp-original-font-size="13" mp-original-line-height="16.25">subsetMaf</span>(<span mp-original-font-size="13" mp-original-line-height="16.25">maf =</span> laml, <span mp-original-font-size="13" mp-original-line-height="16.25">tsb =</span> <span mp-original-font-size="13" mp-original-line-height="16.25">c</span>(<span mp-original-font-size="13" mp-original-line-height="16.25">'TCGA-AB-3009'</span>, <span mp-original-font-size="13" mp-original-line-height="16.25">'TCGA-AB-2933'</span>), <span mp-original-font-size="13" mp-original-line-height="16.25">mafObj =</span> <span mp-original-font-size="13" mp-original-line-height="16.25">FALSE</span>)[<span mp-original-font-size="13" mp-original-line-height="16.25">1</span><span mp-original-font-size="13" mp-original-line-height="16.25">:</span><span mp-original-font-size="13" mp-original-line-height="16.25">5</span>]</span></code></p><p mp-original-font-size="17" mp-original-line-height="27.200000762939453"><br mp-original-font-size="17" mp-original-line-height="27.200000762939453"></p><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867"><span mp-original-font-size="13" mp-original-line-height="16.25"><span mp-original-font-size="13" mp-original-line-height="16.25"># Same as above but return output as an MAF object (Default behaviour)</span></span><span mp-original-font-size="13" mp-original-line-height="16.25"><span mp-original-font-size="13" mp-original-line-height="16.25">subsetMaf</span>(<span mp-original-font-size="13" mp-original-line-height="16.25">maf =</span> laml, <span mp-original-font-size="13" mp-original-line-height="16.25">tsb =</span> <span mp-original-font-size="13" mp-original-line-height="16.25">c</span>(<span mp-original-font-size="13" mp-original-line-height="16.25">'TCGA-AB-3009'</span>, <span mp-original-font-size="13" mp-original-line-height="16.25">'TCGA-AB-2933'</span>))</span></code></pre><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867">## An object of class  MAF <br mp-original-font-size="13" mp-original-line-height="18.571409225463867">##                    ID          summary Mean Median<br mp-original-font-size="13" mp-original-line-height="18.571409225463867">##  1:        NCBI_Build               37   NA     NA<br mp-original-font-size="13" mp-original-line-height="18.571409225463867">##  2:            Center genome.wustl.edu   NA     NA<br mp-original-font-size="13" mp-original-line-height="18.571409225463867">##  3:           Samples                2   NA     NA<br mp-original-font-size="13" mp-original-line-height="18.571409225463867">##  4:            nGenes               34   NA     NA<br mp-original-font-size="13" mp-original-line-height="18.571409225463867">##  5:   Frame_Shift_Ins                5  2.5    2.5<br mp-original-font-size="13" mp-original-line-height="18.571409225463867">##  6:      In_Frame_Ins                1  0.5    0.5<br mp-original-font-size="13" mp-original-line-height="18.571409225463867">##  7: Missense_Mutation               26 13.0   13.0<br mp-original-font-size="13" mp-original-line-height="18.571409225463867">##  8: Nonsense_Mutation                2  1.0    1.0<br mp-original-font-size="13" mp-original-line-height="18.571409225463867">##  9:       Splice_Site                1  0.5    0.5<br mp-original-font-size="13" mp-original-line-height="18.571409225463867">## 10:             total               35 17.5   17.5</code></pre><p mp-original-font-size="17" mp-original-line-height="27.200000762939453">部分基因，部分变异类型</p><p mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867"><span mp-original-font-size="13" mp-original-line-height="16.25"><span mp-original-font-size="13" mp-original-line-height="16.25"># Select all Splice_Site mutations from DNMT3A and NPM1</span></span><span mp-original-font-size="13" mp-original-line-height="16.25"><span mp-original-font-size="13" mp-original-line-height="16.25">subsetMaf</span>(<span mp-original-font-size="13" mp-original-line-height="16.25">maf =</span> laml, <span mp-original-font-size="13" mp-original-line-height="16.25">genes =</span> <span mp-original-font-size="13" mp-original-line-height="16.25">c</span>(<span mp-original-font-size="13" mp-original-line-height="16.25">'DNMT3A'</span>, <span mp-original-font-size="13" mp-original-line-height="16.25">'NPM1'</span>), <span mp-original-font-size="13" mp-original-line-height="16.25">mafObj =</span> <span mp-original-font-size="13" mp-original-line-height="16.25">FALSE</span>,<span mp-original-font-size="13" mp-original-line-height="16.25">query =</span> <span mp-original-font-size="13" mp-original-line-height="16.25">"Variant_Classification == 'Splice_Site'"</span>)</span></code><span mp-original-font-size="17" mp-original-line-height="24.285688400268555"></span></p><p mp-original-font-size="17" mp-original-line-height="27.200000762939453">是否生成新的 MAF class</p><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867"><span mp-original-font-size="13" mp-original-line-height="16.25">laml.sub<span mp-original-font-size="13" mp-original-line-height="16.25">.1</span> <span mp-original-font-size="13" mp-original-line-height="16.25">=</span> <span mp-original-font-size="13" mp-original-line-height="16.25">subsetMaf</span>(<span mp-original-font-size="13" mp-original-line-height="16.25">maf =</span> laml, <span mp-original-font-size="13" mp-original-line-height="16.25">genes =</span> <span mp-original-font-size="13" mp-original-line-height="16.25">c</span>(<span mp-original-font-size="13" mp-original-line-height="16.25">'DNMT3A'</span>, <span mp-original-font-size="13" mp-original-line-height="16.25">'NPM1'</span>), <span mp-original-font-size="13" mp-original-line-height="16.25">mafObj =</span> <span mp-original-font-size="13" mp-original-line-height="16.25">TRUE</span>,<span mp-original-font-size="13" mp-original-line-height="16.25">query =</span> <span mp-original-font-size="13" mp-original-line-height="16.25">"Variant_Classification == 'Splice_Site'"</span>)</span></code></pre><p mp-original-font-size="17" mp-original-line-height="27.200000762939453">部分基因，部分变异类型，部分字段</p><p mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867"><span mp-original-font-size="13" mp-original-line-height="16.25"><span mp-original-font-size="13" mp-original-line-height="16.25"># Same as above but include only 'i_transcript_name' column in the output</span></span><span mp-original-font-size="13" mp-original-line-height="16.25"><span mp-original-font-size="13" mp-original-line-height="16.25">subsetMaf</span>(<span mp-original-font-size="13" mp-original-line-height="16.25">maf =</span> laml, <span mp-original-font-size="13" mp-original-line-height="16.25">genes =</span> <span mp-original-font-size="13" mp-original-line-height="16.25">c</span>(<span mp-original-font-size="13" mp-original-line-height="16.25">'DNMT3A'</span>, <span mp-original-font-size="13" mp-original-line-height="16.25">'NPM1'</span>), <span mp-original-font-size="13" mp-original-line-height="16.25">mafObj =</span> <span mp-original-font-size="13" mp-original-line-height="16.25">FALSE</span>, <span mp-original-font-size="13" mp-original-line-height="16.25">query =</span> <span mp-original-font-size="13" mp-original-line-height="16.25">"Variant_Classification == 'Splice_Site'"</span>, <span mp-original-font-size="13" mp-original-line-height="16.25">fields =</span> <span mp-original-font-size="13" mp-original-line-height="16.25">'i_transcript_name'</span>)</span></code><span mp-original-font-size="17" mp-original-line-height="24.285688400268555"></span></p><p mp-original-font-size="17" mp-original-line-height="27.200000762939453">根据某个临床信息筛选maf子集：clinQuery参数</p><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867"><span mp-original-font-size="13" mp-original-line-height="16.25"><span mp-original-font-size="13" mp-original-line-height="16.25"># Select all samples with FAB clasification M4 in clinical data </span></span><span mp-original-font-size="13" mp-original-line-height="16.25">laml_m4 <span mp-original-font-size="13" mp-original-line-height="16.25">=</span> <span mp-original-font-size="13" mp-original-line-height="16.25">subsetMaf</span>(<span mp-original-font-size="13" mp-original-line-height="16.25">maf =</span> laml, <span mp-original-font-size="13" mp-original-line-height="16.25">clinQuery =</span> <span mp-original-font-size="13" mp-original-line-height="16.25">"FAB_classification %in% 'M4'"</span>)</span></code></pre><h2 mp-original-font-size="30" mp-original-line-height="36">MAF汇总图</h2><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867"><span mp-original-font-size="13" mp-original-line-height="16.25"><span mp-original-font-size="13" mp-original-line-height="16.25">plotmafSummary</span>(<span mp-original-font-size="13" mp-original-line-height="16.25">maf =</span> laml, <span mp-original-font-size="13" mp-original-line-height="16.25">rmOutlier =</span> <span mp-original-font-size="13" mp-original-line-height="16.25">TRUE</span>, <span mp-original-font-size="13" mp-original-line-height="16.25">addStat =</span> <span mp-original-font-size="13" mp-original-line-height="16.25">'median'</span>, <span mp-original-font-size="13" mp-original-line-height="16.25">dashboard =</span> <span mp-original-font-size="13" mp-original-line-height="16.25">TRUE</span>, <span mp-original-font-size="13" mp-original-line-height="16.25">titvRaw =</span> <span mp-original-font-size="13" mp-original-line-height="16.25">FALSE</span>)</span></code></pre><p mp-original-font-size="17" mp-original-line-height="27.200000762939453"><img data-ratio="0.8333333333333334" data-type="png" data-w="1152" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zfs9OSHUB2ayejYkr6SibDaDwl8aoTpHI7tjylfXgib2L0qbZvOJwck4qGbBESqzuoPzYbfrHHdejrKPu9zkpnwg/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" width="576" src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zfs9OSHUB2ayejYkr6SibDaDwl8aoTpHI7tjylfXgib2L0qbZvOJwck4qGbBESqzuoPzYbfrHHdejrKPu9zkpnwg/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"></p><h2 mp-original-font-size="30" mp-original-line-height="36">体细胞突变景观图</h2><p mp-original-font-size="17" mp-original-line-height="27.200000762939453"><strong mp-original-font-size="17" mp-original-line-height="27.200000762939453">显示样本队列的体细胞突变景观图 (Oncoplot displaying the somatic landscape of sample cohort)</strong></p><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867">* 基因根据其突变频率 (Mutation frequency) 排序。<br mp-original-font-size="13" mp-original-line-height="18.571409225463867"><br mp-original-font-size="13" mp-original-line-height="18.571409225463867">* 样本(可选)根据疾病组织学 (Histology) 排序。提现到注释栏（图的底部）所示。<br mp-original-font-size="13" mp-original-line-height="18.571409225463867"><br mp-original-font-size="13" mp-original-line-height="18.571409225463867">* 侧栏图(可选)：可显示了 MutSigCV 估计的 log10 变换的Q值。<br mp-original-font-size="13" mp-original-line-height="18.571409225463867">    * MutSigCV接受来自多个样本的WGS/WES数据，以及有关点突变、小插入/缺失和覆盖率的信息，并识别出比人们偶然预期的突变频率更高的基因</code></pre><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867"><span mp-original-font-size="13" mp-original-line-height="16.25"><span mp-original-font-size="13" mp-original-line-height="16.25"># oncoplot for top ten mutated genes.</span></span><span mp-original-font-size="13" mp-original-line-height="16.25"><span mp-original-font-size="13" mp-original-line-height="16.25">oncoplot</span>(<span mp-original-font-size="13" mp-original-line-height="16.25">maf =</span> laml, <span mp-original-font-size="13" mp-original-line-height="16.25">top =</span> <span mp-original-font-size="13" mp-original-line-height="16.25">10</span>)</span></code></pre><p mp-original-font-size="17" mp-original-line-height="27.200000762939453"><img data-ratio="0.5" data-type="png" data-w="1920" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zfs9OSHUB2ayejYkr6SibDaDwl8aoTpHIiaVuy87RFHce0jhfODBPxPBgmfzBGtBexcxI1lXqyMUAHXgs5qHgYcQ/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" width="960" src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zfs9OSHUB2ayejYkr6SibDaDwl8aoTpHIiaVuy87RFHce0jhfODBPxPBgmfzBGtBexcxI1lXqyMUAHXgs5qHgYcQ/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"></p><h2 mp-original-font-size="30" mp-original-line-height="36">转换和颠换变异分布</h2><p mp-original-font-size="17" mp-original-line-height="27.200000762939453">转换和颠换图 (Transition and transversion plot, <strong mp-original-font-size="17" mp-original-line-height="27.200000762939453">Ti/Tv</strong>)显示了样本队列中SNV的分布</p><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867">* 分为 6 个转换和颠换事件<br mp-original-font-size="13" mp-original-line-height="18.571409225463867"><br mp-original-font-size="13" mp-original-line-height="18.571409225463867">* 堆积条形图（底部）显示了MAF文件中每个样本的突变谱分布 (Distribution of mutation spectra)</code></pre><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867"><span mp-original-font-size="13" mp-original-line-height="16.25">laml.titv <span mp-original-font-size="13" mp-original-line-height="16.25">=</span> <span mp-original-font-size="13" mp-original-line-height="16.25">titv</span>(<span mp-original-font-size="13" mp-original-line-height="16.25">maf =</span> laml, <span mp-original-font-size="13" mp-original-line-height="16.25">plot =</span> <span mp-original-font-size="13" mp-original-line-height="16.25">FALSE</span>, <span mp-original-font-size="13" mp-original-line-height="16.25">useSyn =</span> <span mp-original-font-size="13" mp-original-line-height="16.25">TRUE</span>)</span><span mp-original-font-size="13" mp-original-line-height="16.25"><span mp-original-font-size="13" mp-original-line-height="16.25"># plot titv summary</span></span><span mp-original-font-size="13" mp-original-line-height="16.25"><span mp-original-font-size="13" mp-original-line-height="16.25">plotTiTv</span>(<span mp-original-font-size="13" mp-original-line-height="16.25">res =</span> laml.titv)</span></code></pre><p mp-original-font-size="17" mp-original-line-height="27.200000762939453"><img data-ratio="0.8333333333333334" data-type="png" data-w="1152" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zfs9OSHUB2ayejYkr6SibDaDwl8aoTpHIBIQpiciaVJHxQEo32W4YXkesmpwFCIybt7zQ0eZalTS0xcVKvZibFssyg/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" width="576" src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zfs9OSHUB2ayejYkr6SibDaDwl8aoTpHIBIQpiciaVJHxQEo32W4YXkesmpwFCIybt7zQ0eZalTS0xcVKvZibFssyg/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"></p><h2 mp-original-font-size="30" mp-original-line-height="36">突变及结构域在蛋白上的分布</h2><p mp-original-font-size="17" mp-original-line-height="27.200000762939453"><strong mp-original-font-size="17" mp-original-line-height="27.200000762939453">棒棒糖图</strong> (Lollipop plot) 显示了样本队列中某个基因的 突变在蛋白上的分布，以及蛋白结构域。</p><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867">* 图中可标记了*反复出现的热点突变* (Recurrent hotspots)<br mp-original-font-size="13" mp-original-line-height="18.571409225463867"><br mp-original-font-size="13" mp-original-line-height="18.571409225463867">* 体细胞突变率 (Somatic mutation rate) 和转录本名称分别由图的标题和副标题表示<br mp-original-font-size="13" mp-original-line-height="18.571409225463867"><br mp-original-font-size="13" mp-original-line-height="18.571409225463867">* 该函数假设了蛋白质变化信息存储在'Protein_Change'列下<br mp-original-font-size="13" mp-original-line-height="18.571409225463867"><br mp-original-font-size="13" mp-original-line-height="18.571409225463867">* 如果需要，可使用参数 AACol 重新定义</code></pre><p mp-original-font-size="17" mp-original-line-height="27.200000762939453">1个基因经常包含多个不同的转录本：</p><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867">* 可使用 refSeqID 或 proteinID 参数自定义某个特定的转录本名称<br mp-original-font-size="13" mp-original-line-height="18.571409225463867">* # HGNC refseq.ID protein.ID aa.length<br mp-original-font-size="13" mp-original-line-height="18.571409225463867">* # 1: DNMT3A  NM_175629  NP_783328  912<br mp-original-font-size="13" mp-original-line-height="18.571409225463867">* # 2: DNMT3A  NM_022552  NP_072046  912<br mp-original-font-size="13" mp-original-line-height="18.571409225463867">* # 3: DNMT3A  NM_153759  NP_715640  723<br mp-original-font-size="13" mp-original-line-height="18.571409225463867">* # Using longer transcript NM_175629 for now.</code></pre><p mp-original-font-size="17" mp-original-line-height="27.200000762939453">当某个突变的氨基酸位置，未出现在上述转录本的全长中，程序提示：</p><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867">* Removed 3 mutations for which AA position was not available</code></pre><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867"><span mp-original-font-size="13" mp-original-line-height="16.25"><span mp-original-font-size="13" mp-original-line-height="16.25"># lollipop plot for one gene, which is one of the most frequent mutated gene in tumor</span></span><span mp-original-font-size="13" mp-original-line-height="16.25"><span mp-original-font-size="13" mp-original-line-height="16.25">lollipopPlot</span>(<span mp-original-font-size="13" mp-original-line-height="16.25">maf =</span> laml, <span mp-original-font-size="13" mp-original-line-height="16.25">gene =</span> <span mp-original-font-size="13" mp-original-line-height="16.25">'DNMT3A'</span>, <span mp-original-font-size="13" mp-original-line-height="16.25">AACol =</span> <span mp-original-font-size="13" mp-original-line-height="16.25">'Protein_Change'</span>,</span><span mp-original-font-size="13" mp-original-line-height="16.25">             <span mp-original-font-size="13" mp-original-line-height="16.25">showMutationRate =</span> <span mp-original-font-size="13" mp-original-line-height="16.25">TRUE</span>)</span></code></pre><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867">##      HGNC refseq.ID protein.ID aa.length<br mp-original-font-size="13" mp-original-line-height="18.571409225463867">## 1: DNMT3A NM_175629  NP_783328       912<br mp-original-font-size="13" mp-original-line-height="18.571409225463867">## 2: DNMT3A NM_022552  NP_072046       912<br mp-original-font-size="13" mp-original-line-height="18.571409225463867">## 3: DNMT3A NM_153759  NP_715640       723</code></pre><p mp-original-font-size="17" mp-original-line-height="27.200000762939453"><img data-ratio="0.8333333333333334" data-type="png" data-w="1152" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zfs9OSHUB2ayejYkr6SibDaDwl8aoTpHIZKCYsxLYA1LKO1ZkKgicGRBuGpEMy7nXINLKnaTtOJvhtTEMnibhwic1A/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" width="576" src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zfs9OSHUB2ayejYkr6SibDaDwl8aoTpHIZKCYsxLYA1LKO1ZkKgicGRBuGpEMy7nXINLKnaTtOJvhtTEMnibhwic1A/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"></p><p mp-original-font-size="17" mp-original-line-height="27.200000762939453">是否将蛋白结构域名称作为 Legend 展示</p><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867">* 'labelPos'参数用于指定想要标记的突变</code></pre><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867"><span mp-original-font-size="13" mp-original-line-height="16.25"><span mp-original-font-size="13" mp-original-line-height="16.25">lollipopPlot</span>(<span mp-original-font-size="13" mp-original-line-height="16.25">maf =</span> laml, <span mp-original-font-size="13" mp-original-line-height="16.25">gene =</span> <span mp-original-font-size="13" mp-original-line-height="16.25">'DNMT3A'</span>, <span mp-original-font-size="13" mp-original-line-height="16.25">showDomainLabel =</span> <span mp-original-font-size="13" mp-original-line-height="16.25">FALSE</span>,</span><span mp-original-font-size="13" mp-original-line-height="16.25">             <span mp-original-font-size="13" mp-original-line-height="16.25">labelPos =</span> <span mp-original-font-size="13" mp-original-line-height="16.25">882</span>)</span></code></pre><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867">##      HGNC refseq.ID protein.ID aa.length<br mp-original-font-size="13" mp-original-line-height="18.571409225463867">## 1: DNMT3A NM_175629  NP_783328       912<br mp-original-font-size="13" mp-original-line-height="18.571409225463867">## 2: DNMT3A NM_022552  NP_072046       912<br mp-original-font-size="13" mp-original-line-height="18.571409225463867">## 3: DNMT3A NM_153759  NP_715640       723</code></pre><p mp-original-font-size="17" mp-original-line-height="27.200000762939453"><img data-ratio="0.8333333333333334" data-type="png" data-w="1152" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zfs9OSHUB2ayejYkr6SibDaDwl8aoTpHI6tFzKibvaJCaxWSHtJMa4FQQ2s7nLdFibFCkRVlVFv8ia0zPFsd3iayib8A/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" width="576" src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zfs9OSHUB2ayejYkr6SibDaDwl8aoTpHI6tFzKibvaJCaxWSHtJMa4FQQ2s7nLdFibFCkRVlVFv8ia0zPFsd3iayib8A/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"></p><h2 mp-original-font-size="30" mp-original-line-height="36">读入另一组实验数据</h2><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867"><span mp-original-font-size="13" mp-original-line-height="16.25">brca <span mp-original-font-size="13" mp-original-line-height="16.25">&lt;-</span> <span mp-original-font-size="13" mp-original-line-height="16.25">system.file</span>(<span mp-original-font-size="13" mp-original-line-height="16.25">"extdata"</span>, <span mp-original-font-size="13" mp-original-line-height="16.25">"brca.maf.gz"</span>, <span mp-original-font-size="13" mp-original-line-height="16.25">package =</span> <span mp-original-font-size="13" mp-original-line-height="16.25">"maftools"</span>)</span><span mp-original-font-size="13" mp-original-line-height="16.25">brca <span mp-original-font-size="13" mp-original-line-height="16.25">=</span> <span mp-original-font-size="13" mp-original-line-height="16.25">read.maf</span>(<span mp-original-font-size="13" mp-original-line-height="16.25">maf =</span> brca, <span mp-original-font-size="13" mp-original-line-height="16.25">verbose =</span> <span mp-original-font-size="13" mp-original-line-height="16.25">FALSE</span>)</span><span mp-original-font-size="13" mp-original-line-height="16.25"><span mp-original-font-size="13" mp-original-line-height="16.25">table</span>(brca<span mp-original-font-size="13" mp-original-line-height="16.25">@</span>data<span mp-original-font-size="13" mp-original-line-height="16.25">$</span>Tumor_Sample_Barcode)</span></code></pre><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867">## <br mp-original-font-size="13" mp-original-line-height="18.571409225463867">## TCGA-A8-A08B <br mp-original-font-size="13" mp-original-line-height="18.571409225463867">##           31</code></pre><h2 mp-original-font-size="30" mp-original-line-height="36">单样本Ti/Tv雨点图</h2><p mp-original-font-size="17" mp-original-line-height="27.200000762939453">显示某<strong mp-original-font-size="17" mp-original-line-height="27.200000762939453">单个样本的</strong>、高突变基因组区域的降雨图/雨点图 (Rainfall plot)</p><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867">* 每个点都是根据SNV的类别进行颜色编码<br mp-original-font-size="13" mp-original-line-height="18.571409225463867"><br mp-original-font-size="13" mp-original-line-height="18.571409225463867">* 通过变点法 (Change-point method) 识别的超高突变基因组片段，可用黑色箭头突出显示</code></pre><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867"><span mp-original-font-size="13" mp-original-line-height="16.25"><span mp-original-font-size="13" mp-original-line-height="16.25">rainfallPlot</span>(<span mp-original-font-size="13" mp-original-line-height="16.25">maf =</span> brca, <span mp-original-font-size="13" mp-original-line-height="16.25">detectChangePoints =</span> <span mp-original-font-size="13" mp-original-line-height="16.25">TRUE</span>, <span mp-original-font-size="13" mp-original-line-height="16.25">pointSize =</span> <span mp-original-font-size="13" mp-original-line-height="16.25">0.6</span>)</span></code></pre><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867">##    Chromosome Start_Position End_Position nMuts Avg_intermutation_dist Size<br mp-original-font-size="13" mp-original-line-height="18.571409225463867">## 1:          8       98129348     98133560     7               702.0000 4212<br mp-original-font-size="13" mp-original-line-height="18.571409225463867">## 2:          8       98398549     98403536     9               623.3750 4987<br mp-original-font-size="13" mp-original-line-height="18.571409225463867">## 3:          8       98453076     98456466     9               423.7500 3390<br mp-original-font-size="13" mp-original-line-height="18.571409225463867">## 4:          8      124090377    124096810    22               306.3333 6433<br mp-original-font-size="13" mp-original-line-height="18.571409225463867">## 5:         12       97436055     97439705     7               608.3333 3650<br mp-original-font-size="13" mp-original-line-height="18.571409225463867">## 6:         17       29332072     29336153     8               583.0000 4081<br mp-original-font-size="13" mp-original-line-height="18.571409225463867">##    Tumor_Sample_Barcode C&gt;G C&gt;T<br mp-original-font-size="13" mp-original-line-height="18.571409225463867">## 1:         TCGA-A8-A08B   4   3<br mp-original-font-size="13" mp-original-line-height="18.571409225463867">## 2:         TCGA-A8-A08B   1   8<br mp-original-font-size="13" mp-original-line-height="18.571409225463867">## 3:         TCGA-A8-A08B   1   8<br mp-original-font-size="13" mp-original-line-height="18.571409225463867">## 4:         TCGA-A8-A08B   1  21<br mp-original-font-size="13" mp-original-line-height="18.571409225463867">## 5:         TCGA-A8-A08B   4   3<br mp-original-font-size="13" mp-original-line-height="18.571409225463867">## 6:         TCGA-A8-A08B   4   4</code></pre><p mp-original-font-size="17" mp-original-line-height="27.200000762939453"><img data-ratio="0.4166666666666667" data-type="png" data-w="2304" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zfs9OSHUB2ayejYkr6SibDaDwl8aoTpHI4icr70Z61SeILTic960A9gNdcYAjWiajOdiaYPLNA7as8waiaf5A2Yd2H4A/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" width="1152" src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zfs9OSHUB2ayejYkr6SibDaDwl8aoTpHI4icr70Z61SeILTic960A9gNdcYAjWiajOdiaYPLNA7as8waiaf5A2Yd2H4A/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"></p><h2 mp-original-font-size="30" mp-original-line-height="36">比较突变负荷 (Mutation load) 与TCGA队列</h2><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867">* 将输入MAF中的突变负荷与来自MC3项目的所有33个TCGA队列进行比较<br mp-original-font-size="13" mp-original-line-height="18.571409225463867"><br mp-original-font-size="13" mp-original-line-height="18.571409225463867">* 肿瘤突变负荷 (Tumor mutational burden, TMB)是指在患者的癌细胞中发现的基因突变数量<br mp-original-font-size="13" mp-original-line-height="18.571409225463867"><br mp-original-font-size="13" mp-original-line-height="18.571409225463867">  * 通常：高TMB的癌症更可能对免疫治疗或靶向治疗等治疗类型，有反应；而低TMB的肿瘤对这些治疗类型的反应不大</code></pre><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867"><span mp-original-font-size="13" mp-original-line-height="16.25">laml.mutload <span mp-original-font-size="13" mp-original-line-height="16.25">=</span> <span mp-original-font-size="13" mp-original-line-height="16.25">tcgaCompare</span>(<span mp-original-font-size="13" mp-original-line-height="16.25">maf =</span> laml, <span mp-original-font-size="13" mp-original-line-height="16.25">cohortName =</span> <span mp-original-font-size="13" mp-original-line-height="16.25">'Example-LAML'</span>)</span></code></pre><p mp-original-font-size="17" mp-original-line-height="27.200000762939453"><img data-ratio="0.4166666666666667" data-type="png" data-w="2304" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zfs9OSHUB2ayejYkr6SibDaDwl8aoTpHIcbEibCkmoXoNpJuzaxUd8l72rAPTsfmWPaqG0mShw5Ygus9ZKyVoYbw/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" width="1152" src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zfs9OSHUB2ayejYkr6SibDaDwl8aoTpHIcbEibCkmoXoNpJuzaxUd8l72rAPTsfmWPaqG0mShw5Ygus9ZKyVoYbw/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"></p><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867"><span mp-original-font-size="13" mp-original-line-height="16.25"><span mp-original-font-size="13" mp-original-line-height="16.25"># 对突变负荷 (Mutation burden) 的差异，进行：配对t检验 (Pairwise t-test)</span></span><span mp-original-font-size="13" mp-original-line-height="16.25">  <span mp-original-font-size="13" mp-original-line-height="16.25"># Warning message:</span></span><span mp-original-font-size="13" mp-original-line-height="16.25">  <span mp-original-font-size="13" mp-original-line-height="16.25">#   In FUN(X[[i]], ...) : Removed 1 samples with zero mutations.</span></span></code></pre><h2 mp-original-font-size="30" mp-original-line-height="36">基因的等位基因变异频率分布</h2><p mp-original-font-size="17" mp-original-line-height="27.200000762939453">基因的 VAF (Variant Allele Frequency, 等位基因变异频率) 分布</p><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867">* 箱线图绘制中，抖动(jitter)中的每个点(dot)，都是该基因的 1种变异<br mp-original-font-size="13" mp-original-line-height="18.571409225463867"><br mp-original-font-size="13" mp-original-line-height="18.571409225463867">  * VAF 是检测到的、与特定DNA变异匹配的测序Reads的百分比，分母是该位点的总Reads数<br mp-original-font-size="13" mp-original-line-height="18.571409225463867">  * VAF 是原始样本中携带变异的DNA分子比例的测量 (例如可代表血浆cfDNA中突变肿瘤DNA的百分比)</code></pre><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867"><span mp-original-font-size="13" mp-original-line-height="16.25"><span mp-original-font-size="13" mp-original-line-height="16.25"># Plots vaf distribution of genes as a boxplot. Each dot in the jitter is a variant.</span></span><span mp-original-font-size="13" mp-original-line-height="16.25"><span mp-original-font-size="13" mp-original-line-height="16.25"># pdf("Fig.箱线图绘制基因的vaf分布_抖动-jitter-中的每个点-dot-都是1个变异.pdf")</span></span><span mp-original-font-size="13" mp-original-line-height="16.25"><span mp-original-font-size="13" mp-original-line-height="16.25">plotVaf</span>(<span mp-original-font-size="13" mp-original-line-height="16.25">maf =</span> laml, <span mp-original-font-size="13" mp-original-line-height="16.25">vafCol =</span> <span mp-original-font-size="13" mp-original-line-height="16.25">'i_TumorVAF_WU'</span>)</span></code></pre><p mp-original-font-size="17" mp-original-line-height="27.200000762939453"><img data-ratio="1" data-type="png" data-w="768" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zfs9OSHUB2ayejYkr6SibDaDwl8aoTpHItkbv8s61v7DZ6dMPVBqSJ8BNqTNy9Ysibhma2jvXfFf5ZK0EEGjH3ng/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" width="384" src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zfs9OSHUB2ayejYkr6SibDaDwl8aoTpHItkbv8s61v7DZ6dMPVBqSJ8BNqTNy9Ysibhma2jvXfFf5ZK0EEGjH3ng/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"></p><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867"><span mp-original-font-size="13" mp-original-line-height="16.25"><span mp-original-font-size="13" mp-original-line-height="16.25"># dev.off()</span></span></code></pre><h2 mp-original-font-size="30" mp-original-line-height="36">CNV</h2><p mp-original-font-size="17" mp-original-line-height="27.200000762939453">maftools也提供了整合和分析拷贝数变异 (CNV) 数据的选项</p><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867">* CNV数据可来自：GISTIC和CBS (Circular binary segmentation)算法<br mp-original-font-size="13" mp-original-line-height="18.571409225463867"><br mp-original-font-size="13" mp-original-line-height="18.571409225463867">* GISTIC (Genomic identification of significant targets in cancer, 癌症中重要靶点的基因组鉴定)<br mp-original-font-size="13" mp-original-line-height="18.571409225463867"><br mp-original-font-size="13" mp-original-line-height="18.571409225463867">  * GISTIC模块可识别在1组样本中显着扩增或缺失 (Amplified or Deleted)的基因组区域<br mp-original-font-size="13" mp-original-line-height="18.571409225463867">  * 每个异常 (Aberration) 都被分配了一个G-score，该得分考虑了异常的幅度、及跨样本发生的频率<br mp-original-font-size="13" mp-original-line-height="18.571409225463867">  * https://broadinstitute.github.io/gistic2/<br mp-original-font-size="13" mp-original-line-height="18.571409225463867"><br mp-original-font-size="13" mp-original-line-height="18.571409225463867">* CBS (Circular binary segmentation, 循环二元分割算法)是常用的 SNParray 数据分段算法，使用芯片数据检测CNV，目前也适用于NGS数据</code></pre><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867"><span mp-original-font-size="13" mp-original-line-height="16.25">all.lesions <span mp-original-font-size="13" mp-original-line-height="16.25">&lt;-</span> <span mp-original-font-size="13" mp-original-line-height="16.25">system.file</span>(<span mp-original-font-size="13" mp-original-line-height="16.25">"extdata"</span>, <span mp-original-font-size="13" mp-original-line-height="16.25">"all_lesions.conf_99.txt"</span>, <span mp-original-font-size="13" mp-original-line-height="16.25">package =</span> <span mp-original-font-size="13" mp-original-line-height="16.25">"maftools"</span>)</span><span mp-original-font-size="13" mp-original-line-height="16.25">amp.genes <span mp-original-font-size="13" mp-original-line-height="16.25">&lt;-</span> <span mp-original-font-size="13" mp-original-line-height="16.25">system.file</span>(<span mp-original-font-size="13" mp-original-line-height="16.25">"extdata"</span>, <span mp-original-font-size="13" mp-original-line-height="16.25">"amp_genes.conf_99.txt"</span>, <span mp-original-font-size="13" mp-original-line-height="16.25">package =</span> <span mp-original-font-size="13" mp-original-line-height="16.25">"maftools"</span>)</span><span mp-original-font-size="13" mp-original-line-height="16.25">del.genes <span mp-original-font-size="13" mp-original-line-height="16.25">&lt;-</span> <span mp-original-font-size="13" mp-original-line-height="16.25">system.file</span>(<span mp-original-font-size="13" mp-original-line-height="16.25">"extdata"</span>, <span mp-original-font-size="13" mp-original-line-height="16.25">"del_genes.conf_99.txt"</span>, <span mp-original-font-size="13" mp-original-line-height="16.25">package =</span> <span mp-original-font-size="13" mp-original-line-height="16.25">"maftools"</span>)</span><span mp-original-font-size="13" mp-original-line-height="16.25">scores.gis <span mp-original-font-size="13" mp-original-line-height="16.25">&lt;-</span> <span mp-original-font-size="13" mp-original-line-height="16.25">system.file</span>(<span mp-original-font-size="13" mp-original-line-height="16.25">"extdata"</span>, <span mp-original-font-size="13" mp-original-line-height="16.25">"scores.gistic"</span>, <span mp-original-font-size="13" mp-original-line-height="16.25">package =</span> <span mp-original-font-size="13" mp-original-line-height="16.25">"maftools"</span>)</span><span mp-original-font-size="13" mp-original-line-height="16.25">laml.gistic <span mp-original-font-size="13" mp-original-line-height="16.25">=</span> <span mp-original-font-size="13" mp-original-line-height="16.25">readGistic</span>(<span mp-original-font-size="13" mp-original-line-height="16.25">gisticAllLesionsFile =</span> all.lesions, <span mp-original-font-size="13" mp-original-line-height="16.25">gisticAmpGenesFile =</span> amp.genes, <span mp-original-font-size="13" mp-original-line-height="16.25">gisticDelGenesFile =</span> del.genes, <span mp-original-font-size="13" mp-original-line-height="16.25">gisticScoresFile =</span> scores.gis, <span mp-original-font-size="13" mp-original-line-height="16.25">isTCGA =</span> <span mp-original-font-size="13" mp-original-line-height="16.25">TRUE</span>)</span></code></pre><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867">## -Processing Gistic files..<br mp-original-font-size="13" mp-original-line-height="18.571409225463867">## --Processing amp_genes.conf_99.txt<br mp-original-font-size="13" mp-original-line-height="18.571409225463867">## --Processing del_genes.conf_99.txt<br mp-original-font-size="13" mp-original-line-height="18.571409225463867">## --Processing scores.gistic<br mp-original-font-size="13" mp-original-line-height="18.571409225463867">## --Summarizing by samples</code></pre><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867"><span mp-original-font-size="13" mp-original-line-height="16.25"><span mp-original-font-size="13" mp-original-line-height="16.25"># GISTIC object</span></span><span mp-original-font-size="13" mp-original-line-height="16.25">laml.gistic</span></code></pre><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867">## An object of class  GISTIC <br mp-original-font-size="13" mp-original-line-height="18.571409225463867">##           ID summary<br mp-original-font-size="13" mp-original-line-height="18.571409225463867">## 1:   Samples     191<br mp-original-font-size="13" mp-original-line-height="18.571409225463867">## 2:    nGenes    2622<br mp-original-font-size="13" mp-original-line-height="18.571409225463867">## 3: cytoBands      16<br mp-original-font-size="13" mp-original-line-height="18.571409225463867">## 4:       Amp     388<br mp-original-font-size="13" mp-original-line-height="18.571409225463867">## 5:       Del   26481<br mp-original-font-size="13" mp-original-line-height="18.571409225463867">## 6:     total   26869</code></pre><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867"><span mp-original-font-size="13" mp-original-line-height="16.25"><span mp-original-font-size="13" mp-original-line-height="16.25">gisticChromPlot</span>(<span mp-original-font-size="13" mp-original-line-height="16.25">gistic =</span> laml.gistic, <span mp-original-font-size="13" mp-original-line-height="16.25">markBands =</span> <span mp-original-font-size="13" mp-original-line-height="16.25">"all"</span>)</span></code></pre><p mp-original-font-size="17" mp-original-line-height="27.200000762939453"><img data-ratio="0.6666666666666666" data-type="png" data-w="1152" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zfs9OSHUB2ayejYkr6SibDaDwl8aoTpHIQfQOn15I6Ud6CqAZUzqlAYnleicKbJic36NNjNGHTz6HeLK0e8s7eVVg/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" width="576" src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zfs9OSHUB2ayejYkr6SibDaDwl8aoTpHIQfQOn15I6Ud6CqAZUzqlAYnleicKbJic36NNjNGHTz6HeLK0e8s7eVVg/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"></p><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867"><span mp-original-font-size="13" mp-original-line-height="16.25"><span mp-original-font-size="13" mp-original-line-height="16.25">gisticBubblePlot</span>(<span mp-original-font-size="13" mp-original-line-height="16.25">gistic =</span> laml.gistic)</span></code></pre><p mp-original-font-size="17" mp-original-line-height="27.200000762939453"><img data-ratio="0.8" data-type="png" data-w="960" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zfs9OSHUB2ayejYkr6SibDaDwl8aoTpHI756iazS4p8ZZicAWFLR5DBXhc7DPaVTpslCbMIHZZ50H48E18tuzMM6g/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" width="480" src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zfs9OSHUB2ayejYkr6SibDaDwl8aoTpHI756iazS4p8ZZicAWFLR5DBXhc7DPaVTpslCbMIHZZ50H48E18tuzMM6g/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"></p><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867"><span mp-original-font-size="13" mp-original-line-height="16.25"><span mp-original-font-size="13" mp-original-line-height="16.25">gisticOncoPlot</span>(<span mp-original-font-size="13" mp-original-line-height="16.25">gistic =</span> laml.gistic, <span mp-original-font-size="13" mp-original-line-height="16.25">clinicalData =</span> <span mp-original-font-size="13" mp-original-line-height="16.25">getClinicalData</span>(<span mp-original-font-size="13" mp-original-line-height="16.25">x =</span> laml), <span mp-original-font-size="13" mp-original-line-height="16.25">clinicalFeatures =</span> <span mp-original-font-size="13" mp-original-line-height="16.25">'FAB_classification'</span>, <span mp-original-font-size="13" mp-original-line-height="16.25">sortByAnnotation =</span> <span mp-original-font-size="13" mp-original-line-height="16.25">TRUE</span>, <span mp-original-font-size="13" mp-original-line-height="16.25">top =</span> <span mp-original-font-size="13" mp-original-line-height="16.25">10</span>)</span></code></pre><p mp-original-font-size="17" mp-original-line-height="27.200000762939453"><img data-ratio="0.7142857142857143" data-type="png" data-w="1344" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zfs9OSHUB2ayejYkr6SibDaDwl8aoTpHIlM97DZC4nh8h40ZWB3gv0RsQhuXXuhq0hpKOMZmEzOhGJNLmbD0gWg/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" width="672" src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zfs9OSHUB2ayejYkr6SibDaDwl8aoTpHIlM97DZC4nh8h40ZWB3gv0RsQhuXXuhq0hpKOMZmEzOhGJNLmbD0gWg/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"></p><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867"><span mp-original-font-size="13" mp-original-line-height="16.25">tcga.ab.<span mp-original-font-size="13" mp-original-line-height="16.25">009.</span>seg <span mp-original-font-size="13" mp-original-line-height="16.25">&lt;-</span> <span mp-original-font-size="13" mp-original-line-height="16.25">system.file</span>(<span mp-original-font-size="13" mp-original-line-height="16.25">"extdata"</span>, <span mp-original-font-size="13" mp-original-line-height="16.25">"TCGA.AB.3009.hg19.seg.txt"</span>, <span mp-original-font-size="13" mp-original-line-height="16.25">package =</span> <span mp-original-font-size="13" mp-original-line-height="16.25">"maftools"</span>)</span><span mp-original-font-size="13" mp-original-line-height="16.25"><span mp-original-font-size="13" mp-original-line-height="16.25">plotCBSsegments</span>(<span mp-original-font-size="13" mp-original-line-height="16.25">cbsFile =</span> tcga.ab.<span mp-original-font-size="13" mp-original-line-height="16.25">009.</span>seg)</span></code></pre><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867">## NULL</code></pre><p mp-original-font-size="17" mp-original-line-height="27.200000762939453"><img data-ratio="0.375" data-type="png" data-w="1536" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zfs9OSHUB2ayejYkr6SibDaDwl8aoTpHIInIEg8MibgIzUkXuj6OH7YHoPgDjwhtn6XbmEkq7NTMDsuwicI0YWyVQ/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" width="768" src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zfs9OSHUB2ayejYkr6SibDaDwl8aoTpHIInIEg8MibgIzUkXuj6OH7YHoPgDjwhtn6XbmEkq7NTMDsuwicI0YWyVQ/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"></p><h2 mp-original-font-size="30" mp-original-line-height="36">突变的互斥、共存</h2><p mp-original-font-size="17" mp-original-line-height="27.200000762939453">突变事件存在<strong mp-original-font-size="17" mp-original-line-height="27.200000762939453">互斥或共存的 (Exclusive / Co-occurring)</strong>的基因对</p><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867">* 三角矩阵，绿色表示共现 (Co-occurring) 趋势；金色表示排它性 (Exclusiveness) 趋势</code></pre><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867"><span mp-original-font-size="13" mp-original-line-height="16.25"><span mp-original-font-size="13" mp-original-line-height="16.25"># exclusive/co-occurance event analysis on top 10 mutated genes</span></span><span mp-original-font-size="13" mp-original-line-height="16.25"><span mp-original-font-size="13" mp-original-line-height="16.25">somaticInteractions</span>(<span mp-original-font-size="13" mp-original-line-height="16.25">maf =</span> laml, <span mp-original-font-size="13" mp-original-line-height="16.25">top =</span> <span mp-original-font-size="13" mp-original-line-height="16.25">25</span>, <span mp-original-font-size="13" mp-original-line-height="16.25">pvalue =</span> <span mp-original-font-size="13" mp-original-line-height="16.25">c</span>(<span mp-original-font-size="13" mp-original-line-height="16.25">0.05</span>, <span mp-original-font-size="13" mp-original-line-height="16.25">0.1</span>))</span></code></pre><p mp-original-font-size="17" mp-original-line-height="27.200000762939453"><img data-ratio="1" data-type="png" data-w="960" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zfs9OSHUB2ayejYkr6SibDaDwl8aoTpHIS7NSZxZc2jk3UgL5bhqz51xMmDKOeibZyx65vSNicvUicSV6thdPmE5xQ/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" width="480" src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zfs9OSHUB2ayejYkr6SibDaDwl8aoTpHIS7NSZxZc2jk3UgL5bhqz51xMmDKOeibZyx65vSNicvUicSV6thdPmE5xQ/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"></p><p mp-original-font-size="17" mp-original-line-height="27.200000762939453"><span mp-original-font-size="30" mp-original-line-height="48">鉴定肿瘤Driver/驱动基因</span></p><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867">* maftools的1个函数oncodrive。根据oncodriveCLUST算法进行运算<br mp-original-font-size="13" mp-original-line-height="18.571409225463867"><br mp-original-font-size="13" mp-original-line-height="18.571409225463867">* 此概念基于：大多数致癌基因的变异在少数特定位点(即热点)的富集</code></pre><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867"><span mp-original-font-size="13" mp-original-line-height="16.25">laml.sig <span mp-original-font-size="13" mp-original-line-height="16.25">=</span> <span mp-original-font-size="13" mp-original-line-height="16.25">oncodrive</span>(<span mp-original-font-size="13" mp-original-line-height="16.25">maf =</span> laml, <span mp-original-font-size="13" mp-original-line-height="16.25">AACol =</span> <span mp-original-font-size="13" mp-original-line-height="16.25">'Protein_Change'</span>, <span mp-original-font-size="13" mp-original-line-height="16.25">minMut =</span> <span mp-original-font-size="13" mp-original-line-height="16.25">5</span>, <span mp-original-font-size="13" mp-original-line-height="16.25">pvalMethod =</span> <span mp-original-font-size="13" mp-original-line-height="16.25">'zscore'</span>)</span><span mp-original-font-size="13" mp-original-line-height="16.25"><span mp-original-font-size="13" mp-original-line-height="16.25">head</span>(laml.sig)</span></code></pre><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867"><span mp-original-font-size="13" mp-original-line-height="16.25"><span mp-original-font-size="13" mp-original-line-height="16.25">plotOncodrive</span>(<span mp-original-font-size="13" mp-original-line-height="16.25">res =</span> laml.sig, <span mp-original-font-size="13" mp-original-line-height="16.25">fdrCutOff =</span> <span mp-original-font-size="13" mp-original-line-height="16.25">0.1</span>, <span mp-original-font-size="13" mp-original-line-height="16.25">useFraction =</span> <span mp-original-font-size="13" mp-original-line-height="16.25">TRUE</span>)</span></code></pre><p mp-original-font-size="17" mp-original-line-height="27.200000762939453"><img data-ratio="0.8" data-type="png" data-w="960" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zfs9OSHUB2ayejYkr6SibDaDwl8aoTpHIPElBdqYutuH8xvLEEPD5YrqTXvotFVa6jCzm5xTLOr78662NqOqr2w/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" width="480" src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zfs9OSHUB2ayejYkr6SibDaDwl8aoTpHIPElBdqYutuH8xvLEEPD5YrqTXvotFVa6jCzm5xTLOr78662NqOqr2w/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"></p><h2 mp-original-font-size="30" mp-original-line-height="36">Pfam蛋白结构域的注释、汇总</h2><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867"><span mp-original-font-size="13" mp-original-line-height="16.25">laml.pfam <span mp-original-font-size="13" mp-original-line-height="16.25">=</span> <span mp-original-font-size="13" mp-original-line-height="16.25">pfamDomains</span>(<span mp-original-font-size="13" mp-original-line-height="16.25">maf =</span> laml, <span mp-original-font-size="13" mp-original-line-height="16.25">AACol =</span> <span mp-original-font-size="13" mp-original-line-height="16.25">'Protein_Change'</span>, <span mp-original-font-size="13" mp-original-line-height="16.25">top =</span> <span mp-original-font-size="13" mp-original-line-height="16.25">10</span>)</span></code></pre><p mp-original-font-size="17" mp-original-line-height="27.200000762939453"><img data-ratio="0.8" data-type="png" data-w="960" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zfs9OSHUB2ayejYkr6SibDaDwl8aoTpHIiaxtjEBajMN6SZ8DqiciaiajSXzTQ2sOnXW1iaXGcFjNSwdTjW08ohVjReQ/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" width="480" src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zfs9OSHUB2ayejYkr6SibDaDwl8aoTpHIiaxtjEBajMN6SZ8DqiciaiajSXzTQ2sOnXW1iaXGcFjNSwdTjW08ohVjReQ/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"></p><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867"><span mp-original-font-size="13" mp-original-line-height="16.25"><span mp-original-font-size="13" mp-original-line-height="16.25"># Protein summary (Printing first 7 columns for display convenience)</span></span><span mp-original-font-size="13" mp-original-line-height="16.25">laml.pfam<span mp-original-font-size="13" mp-original-line-height="16.25">$</span>proteinSummary[,<span mp-original-font-size="13" mp-original-line-height="16.25">1</span><span mp-original-font-size="13" mp-original-line-height="16.25">:</span><span mp-original-font-size="13" mp-original-line-height="16.25">7</span>, with <span mp-original-font-size="13" mp-original-line-height="16.25">=</span> <span mp-original-font-size="13" mp-original-line-height="16.25">FALSE</span>]</span></code></pre><p mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867"><span mp-original-font-size="13" mp-original-line-height="16.25"><span mp-original-font-size="13" mp-original-line-height="16.25"># Domain summary (Printing first 3 columns for display convenience)</span></span><span mp-original-font-size="13" mp-original-line-height="16.25">laml.pfam<span mp-original-font-size="13" mp-original-line-height="16.25">$</span>domainSummary[,<span mp-original-font-size="13" mp-original-line-height="16.25">1</span><span mp-original-font-size="13" mp-original-line-height="16.25">:</span><span mp-original-font-size="13" mp-original-line-height="16.25">3</span>, with <span mp-original-font-size="13" mp-original-line-height="16.25">=</span> <span mp-original-font-size="13" mp-original-line-height="16.25">FALSE</span>]</span></code></p><h2 mp-original-font-size="30" mp-original-line-height="36">单基因、多基因生存分析</h2><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867"><span mp-original-font-size="13" mp-original-line-height="16.25"><span mp-original-font-size="13" mp-original-line-height="16.25"># Survival analysis based on grouping of DNMT3A mutation status</span></span><span mp-original-font-size="13" mp-original-line-height="16.25"><span mp-original-font-size="13" mp-original-line-height="16.25">mafSurvival</span>(<span mp-original-font-size="13" mp-original-line-height="16.25">maf =</span> laml, <span mp-original-font-size="13" mp-original-line-height="16.25">genes =</span> <span mp-original-font-size="13" mp-original-line-height="16.25">'DNMT3A'</span>, <span mp-original-font-size="13" mp-original-line-height="16.25">time =</span> <span mp-original-font-size="13" mp-original-line-height="16.25">'days_to_last_followup'</span>, <span mp-original-font-size="13" mp-original-line-height="16.25">Status =</span> <span mp-original-font-size="13" mp-original-line-height="16.25">'Overall_Survival_Status'</span>, <span mp-original-font-size="13" mp-original-line-height="16.25">isTCGA =</span> <span mp-original-font-size="13" mp-original-line-height="16.25">TRUE</span>)</span></code></pre><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867">## DNMT3A <br mp-original-font-size="13" mp-original-line-height="18.571409225463867">##     48 <br mp-original-font-size="13" mp-original-line-height="18.571409225463867">##     Group medianTime   N<br mp-original-font-size="13" mp-original-line-height="18.571409225463867">## 1: Mutant        245  45<br mp-original-font-size="13" mp-original-line-height="18.571409225463867">## 2:     WT        396 137</code></pre><p mp-original-font-size="17" mp-original-line-height="27.200000762939453"><img data-ratio="1" data-type="png" data-w="960" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zfs9OSHUB2ayejYkr6SibDaDwl8aoTpHIBGPuYL6Dg5k6cHyAChUibjhXnNSKWQaZmQCJuz2NSvvVibEJ9Gmsj5IA/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" width="480" src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zfs9OSHUB2ayejYkr6SibDaDwl8aoTpHIBGPuYL6Dg5k6cHyAChUibjhXnNSKWQaZmQCJuz2NSvvVibEJ9Gmsj5IA/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"></p><p mp-original-font-size="17" mp-original-line-height="27.200000762939453">利用前20个突变基因，<strong mp-original-font-size="17" mp-original-line-height="27.200000762939453">识别1组基因</strong>(个数为2)，来预测预后不良的分组 (Poor prognostic groups)</p><p mp-original-font-size="17" mp-original-line-height="27.200000762939453"><span mp-original-font-size="17" mp-original-line-height="27.200000762939453">Hide</span></p><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867"><span mp-original-font-size="13" mp-original-line-height="16.25"><span mp-original-font-size="13" mp-original-line-height="16.25"># Using top 20 mutated genes to identify a set of genes (of size 2) to predict poor prognostic groups</span></span><span mp-original-font-size="13" mp-original-line-height="16.25">prog_geneset <span mp-original-font-size="13" mp-original-line-height="16.25">=</span> <span mp-original-font-size="13" mp-original-line-height="16.25">survGroup</span>(<span mp-original-font-size="13" mp-original-line-height="16.25">maf =</span> laml, <span mp-original-font-size="13" mp-original-line-height="16.25">top =</span> <span mp-original-font-size="13" mp-original-line-height="16.25">20</span>, <span mp-original-font-size="13" mp-original-line-height="16.25">geneSetSize =</span> <span mp-original-font-size="13" mp-original-line-height="16.25">2</span>, <span mp-original-font-size="13" mp-original-line-height="16.25">time =</span> <span mp-original-font-size="13" mp-original-line-height="16.25">"days_to_last_followup"</span>, <span mp-original-font-size="13" mp-original-line-height="16.25">Status =</span> <span mp-original-font-size="13" mp-original-line-height="16.25">"Overall_Survival_Status"</span>, <span mp-original-font-size="13" mp-original-line-height="16.25">verbose =</span> <span mp-original-font-size="13" mp-original-line-height="16.25">FALSE</span>)</span><span mp-original-font-size="13" mp-original-line-height="16.25"><span mp-original-font-size="13" mp-original-line-height="16.25">print</span>(prog_geneset)</span></code></pre><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867">##     Gene_combination P_value    hr  WT Mutant<br mp-original-font-size="13" mp-original-line-height="18.571409225463867">##  1:      FLT3_DNMT3A 0.00104 2.510 164     18<br mp-original-font-size="13" mp-original-line-height="18.571409225463867">##  2:      DNMT3A_SMC3 0.04880 2.220 176      6<br mp-original-font-size="13" mp-original-line-height="18.571409225463867">##  3:      DNMT3A_NPM1 0.07190 1.720 166     16<br mp-original-font-size="13" mp-original-line-height="18.571409225463867">##  4:      DNMT3A_TET2 0.19600 1.780 176      6<br mp-original-font-size="13" mp-original-line-height="18.571409225463867">##  5:        FLT3_TET2 0.20700 1.860 177      5<br mp-original-font-size="13" mp-original-line-height="18.571409225463867"></code></pre><p mp-original-font-size="17" mp-original-line-height="27.200000762939453">选择显著的，绘制生存曲线</p><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867"><span mp-original-font-size="13" mp-original-line-height="16.25"><span mp-original-font-size="13" mp-original-line-height="16.25">mafSurvGroup</span>(<span mp-original-font-size="13" mp-original-line-height="16.25">maf =</span> laml, <span mp-original-font-size="13" mp-original-line-height="16.25">geneSet =</span> <span mp-original-font-size="13" mp-original-line-height="16.25">c</span>(<span mp-original-font-size="13" mp-original-line-height="16.25">"DNMT3A"</span>, <span mp-original-font-size="13" mp-original-line-height="16.25">"FLT3"</span>), <span mp-original-font-size="13" mp-original-line-height="16.25">time =</span> <span mp-original-font-size="13" mp-original-line-height="16.25">"days_to_last_followup"</span>, <span mp-original-font-size="13" mp-original-line-height="16.25">Status =</span> <span mp-original-font-size="13" mp-original-line-height="16.25">"Overall_Survival_Status"</span>)</span></code></pre><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867">##     Group medianTime   N<br mp-original-font-size="13" mp-original-line-height="18.571409225463867">## 1: Mutant      242.5  18<br mp-original-font-size="13" mp-original-line-height="18.571409225463867">## 2:     WT      379.5 164</code></pre><p mp-original-font-size="17" mp-original-line-height="27.200000762939453"><img data-ratio="1" data-type="png" data-w="960" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zfs9OSHUB2ayejYkr6SibDaDwl8aoTpHIKQMRfctQCrianI972EDmMLxARxibor6RjKepYdo6tH6uNbDWD83TibZow/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" width="480" src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zfs9OSHUB2ayejYkr6SibDaDwl8aoTpHIKQMRfctQCrianI972EDmMLxARxibor6RjKepYdo6tH6uNbDWD83TibZow/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"></p><h2 mp-original-font-size="30" mp-original-line-height="36">两组样本队列之间的差异突变分析</h2><p mp-original-font-size="17" mp-original-line-height="27.200000762939453">队列比较：比较两个队列的MAF</p><p mp-original-font-size="17" mp-original-line-height="27.200000762939453"><span mp-original-font-size="17" mp-original-line-height="27.200000762939453"><br mp-original-font-size="17" mp-original-line-height="27.200000762939453"></span></p><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867"><span mp-original-font-size="13" mp-original-line-height="16.25"><span mp-original-font-size="13" mp-original-line-height="16.25">#Primary APL MAF</span></span><span mp-original-font-size="13" mp-original-line-height="16.25">primary.apl <span mp-original-font-size="13" mp-original-line-height="16.25">=</span> <span mp-original-font-size="13" mp-original-line-height="16.25">system.file</span>(<span mp-original-font-size="13" mp-original-line-height="16.25">"extdata"</span>, <span mp-original-font-size="13" mp-original-line-height="16.25">"APL_primary.maf.gz"</span>, <span mp-original-font-size="13" mp-original-line-height="16.25">package =</span> <span mp-original-font-size="13" mp-original-line-height="16.25">"maftools"</span>)</span><span mp-original-font-size="13" mp-original-line-height="16.25">primary.apl <span mp-original-font-size="13" mp-original-line-height="16.25">=</span> <span mp-original-font-size="13" mp-original-line-height="16.25">read.maf</span>(<span mp-original-font-size="13" mp-original-line-height="16.25">maf =</span> primary.apl)</span><span mp-original-font-size="13" mp-original-line-height="16.25"><span mp-original-font-size="13" mp-original-line-height="16.25"># Relapse APL MAF</span></span><span mp-original-font-size="13" mp-original-line-height="16.25">relapse.apl <span mp-original-font-size="13" mp-original-line-height="16.25">=</span> <span mp-original-font-size="13" mp-original-line-height="16.25">system.file</span>(<span mp-original-font-size="13" mp-original-line-height="16.25">"extdata"</span>, <span mp-original-font-size="13" mp-original-line-height="16.25">"APL_relapse.maf.gz"</span>, <span mp-original-font-size="13" mp-original-line-height="16.25">package =</span> <span mp-original-font-size="13" mp-original-line-height="16.25">"maftools"</span>)</span><span mp-original-font-size="13" mp-original-line-height="16.25">relapse.apl <span mp-original-font-size="13" mp-original-line-height="16.25">=</span> <span mp-original-font-size="13" mp-original-line-height="16.25">read.maf</span>(<span mp-original-font-size="13" mp-original-line-height="16.25">maf =</span> relapse.apl)</span></code></pre><p mp-original-font-size="17" mp-original-line-height="27.200000762939453"><span mp-original-font-size="17" mp-original-line-height="27.200000762939453"><br mp-original-font-size="17" mp-original-line-height="27.200000762939453"></span></p><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867"><span mp-original-font-size="13" mp-original-line-height="16.25"><span mp-original-font-size="13" mp-original-line-height="16.25"># Considering only genes which are mutated in at-least in 5 samples in one of the cohort to avoid bias due to genes mutated in single sample</span></span><span mp-original-font-size="13" mp-original-line-height="16.25">pt.vs.rt <span mp-original-font-size="13" mp-original-line-height="16.25">&lt;-</span> <span mp-original-font-size="13" mp-original-line-height="16.25">mafCompare</span>(<span mp-original-font-size="13" mp-original-line-height="16.25">m1 =</span> primary.apl, <span mp-original-font-size="13" mp-original-line-height="16.25">m2 =</span> relapse.apl, <span mp-original-font-size="13" mp-original-line-height="16.25">m1Name =</span> <span mp-original-font-size="13" mp-original-line-height="16.25">'Primary'</span>, <span mp-original-font-size="13" mp-original-line-height="16.25">m2Name =</span> <span mp-original-font-size="13" mp-original-line-height="16.25">'Relapse'</span>, <span mp-original-font-size="13" mp-original-line-height="16.25">minMut =</span> <span mp-original-font-size="13" mp-original-line-height="16.25">5</span>)</span><span mp-original-font-size="13" mp-original-line-height="16.25"><span mp-original-font-size="13" mp-original-line-height="16.25">print</span>(pt.vs.rt)</span></code></pre><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867">## $results<br mp-original-font-size="13" mp-original-line-height="18.571409225463867">##    Hugo_Symbol Primary Relapse         pval         or       ci.up      ci.low<br mp-original-font-size="13" mp-original-line-height="18.571409225463867">## 1:         PML       1      11 1.529935e-05 0.03537381   0.2552937 0.000806034<br mp-original-font-size="13" mp-original-line-height="18.571409225463867">## 2:        RARA       0       7 2.574810e-04 0.00000000   0.3006159 0.000000000<br mp-original-font-size="13" mp-original-line-height="18.571409225463867">## 3:       RUNX1       1       5 1.310500e-02 0.08740567   0.8076265 0.001813280<br mp-original-font-size="13" mp-original-line-height="18.571409225463867">## 4:        FLT3      26       4 1.812779e-02 3.56086275  14.7701728 1.149009169<br mp-original-font-size="13" mp-original-line-height="18.571409225463867">## 5:      ARID1B       5       8 2.758396e-02 0.26480490   0.9698686 0.064804160<br mp-original-font-size="13" mp-original-line-height="18.571409225463867"></code></pre><p mp-original-font-size="17" mp-original-line-height="27.200000762939453">队列之间的差异突变基因 (Differentially mutated genes between two cohorts) 显示为<strong mp-original-font-size="17" mp-original-line-height="27.200000762939453">森林图 (Forest plot)</strong></p><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867">* 条形表示比值比 (Odds ratio) 的95%置信区间<br mp-original-font-size="13" mp-original-line-height="18.571409225463867"><br mp-original-font-size="13" mp-original-line-height="18.571409225463867">* 图中相邻的2列数值：在被突出显示的基因的突变，在两组样本队列中的样本数量<br mp-original-font-size="13" mp-original-line-height="18.571409225463867"><br mp-original-font-size="13" mp-original-line-height="18.571409225463867">* P值：(∗∗∗) P&lt;0.001；(∗∗) P&lt;0.01；费舍尔精确检验</code></pre><p mp-original-font-size="17" mp-original-line-height="27.200000762939453"><span mp-original-font-size="17" mp-original-line-height="27.200000762939453"><br mp-original-font-size="17" mp-original-line-height="27.200000762939453"></span></p><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867"><span mp-original-font-size="13" mp-original-line-height="16.25"><span mp-original-font-size="13" mp-original-line-height="16.25">forestPlot</span>(<span mp-original-font-size="13" mp-original-line-height="16.25">mafCompareRes =</span> pt.vs.rt, <span mp-original-font-size="13" mp-original-line-height="16.25">pVal =</span> <span mp-original-font-size="13" mp-original-line-height="16.25">0.1</span>, <span mp-original-font-size="13" mp-original-line-height="16.25">color =</span> <span mp-original-font-size="13" mp-original-line-height="16.25">c</span>(<span mp-original-font-size="13" mp-original-line-height="16.25">'royalblue'</span>, <span mp-original-font-size="13" mp-original-line-height="16.25">'maroon'</span>), <span mp-original-font-size="13" mp-original-line-height="16.25">geneFontSize =</span> <span mp-original-font-size="13" mp-original-line-height="16.25">0.8</span>)</span></code></pre><p mp-original-font-size="17" mp-original-line-height="27.200000762939453"><img data-ratio="1" data-type="png" data-w="960" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zfs9OSHUB2ayejYkr6SibDaDwl8aoTpHIjU8icOtj7hictHyOlOibFKbK132aRApJwricxA9a1IdTrlF2DHllqDQhqw/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" width="480" src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zfs9OSHUB2ayejYkr6SibDaDwl8aoTpHIjU8icOtj7hictHyOlOibFKbK132aRApJwricxA9a1IdTrlF2DHllqDQhqw/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"></p><p mp-original-font-size="17" mp-original-line-height="27.200000762939453"><strong mp-original-font-size="17" mp-original-line-height="27.200000762939453">指定基因集</strong>，并排画2个oncoplot，进行队列比较</p><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867">* 例如：涉及某些信号通路 (的某些基因)，其相关基因的*突变途径 (Mutated pathways)*<br mp-original-font-size="13" mp-original-line-height="18.571409225463867"><br mp-original-font-size="13" mp-original-line-height="18.571409225463867">* 与这些途径相关的基因，是否优先在其中1个队列中富集，是否以互斥的方式突变？<br mp-original-font-size="13" mp-original-line-height="18.571409225463867"><br mp-original-font-size="13" mp-original-line-height="18.571409225463867"> * eg: Mutated pathways involving genes associated with VGSC and ERBB signaling in EAC (食管腺癌). <br mp-original-font-size="13" mp-original-line-height="18.571409225463867"> * Genes associated with these pathways are preferentially enriched in EAC, mutated in a mutually exclusive manner.</code></pre><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867"><span mp-original-font-size="13" mp-original-line-height="16.25">genes <span mp-original-font-size="13" mp-original-line-height="16.25">=</span> <span mp-original-font-size="13" mp-original-line-height="16.25">c</span>(<span mp-original-font-size="13" mp-original-line-height="16.25">"PML"</span>, <span mp-original-font-size="13" mp-original-line-height="16.25">"RARA"</span>, <span mp-original-font-size="13" mp-original-line-height="16.25">"RUNX1"</span>, <span mp-original-font-size="13" mp-original-line-height="16.25">"ARID1B"</span>, <span mp-original-font-size="13" mp-original-line-height="16.25">"FLT3"</span>)</span><span mp-original-font-size="13" mp-original-line-height="16.25"><span mp-original-font-size="13" mp-original-line-height="16.25">coOncoplot</span>(<span mp-original-font-size="13" mp-original-line-height="16.25">m1 =</span> primary.apl, <span mp-original-font-size="13" mp-original-line-height="16.25">m2 =</span> relapse.apl, <span mp-original-font-size="13" mp-original-line-height="16.25">m1Name =</span> <span mp-original-font-size="13" mp-original-line-height="16.25">'PrimaryAPL'</span>, <span mp-original-font-size="13" mp-original-line-height="16.25">m2Name =</span> <span mp-original-font-size="13" mp-original-line-height="16.25">'RelapseAPL'</span>, <span mp-original-font-size="13" mp-original-line-height="16.25">genes =</span> genes, <span mp-original-font-size="13" mp-original-line-height="16.25">removeNonMutated =</span> <span mp-original-font-size="13" mp-original-line-height="16.25">TRUE</span>)</span></code></pre><p mp-original-font-size="17" mp-original-line-height="27.200000762939453"><img data-ratio="0.2727272727272727" data-type="png" data-w="2112" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zfs9OSHUB2ayejYkr6SibDaDwl8aoTpHItaleNX5ddETmPwyUGEq72B3K2CO6Y3ibZzoeFelwnSjkJDvGxwvybMQ/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" width="1056" src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zfs9OSHUB2ayejYkr6SibDaDwl8aoTpHItaleNX5ddETmPwyUGEq72B3K2CO6Y3ibZzoeFelwnSjkJDvGxwvybMQ/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"></p><p mp-original-font-size="17" mp-original-line-height="27.200000762939453">并排画两个条形图，用于不同队列或分组的比较</p><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867"><span mp-original-font-size="13" mp-original-line-height="16.25"><span mp-original-font-size="13" mp-original-line-height="16.25">coBarplot</span>(<span mp-original-font-size="13" mp-original-line-height="16.25">m1 =</span> primary.apl, <span mp-original-font-size="13" mp-original-line-height="16.25">m2 =</span> relapse.apl, <span mp-original-font-size="13" mp-original-line-height="16.25">m1Name =</span> <span mp-original-font-size="13" mp-original-line-height="16.25">"Primary"</span>, <span mp-original-font-size="13" mp-original-line-height="16.25">m2Name =</span> <span mp-original-font-size="13" mp-original-line-height="16.25">"Relapse"</span>)</span></code></pre><p mp-original-font-size="17" mp-original-line-height="27.200000762939453"><img data-ratio="0.8" data-type="png" data-w="960" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zfs9OSHUB2ayejYkr6SibDaDwl8aoTpHIfuicHWWLjqudrqLwzfYr0jOyn96bCDSw26MLlN5Piaaqt0dib95gkj0icg/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" width="480" src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zfs9OSHUB2ayejYkr6SibDaDwl8aoTpHIfuicHWWLjqudrqLwzfYr0jOyn96bCDSw26MLlN5Piaaqt0dib95gkj0icg/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"></p><p mp-original-font-size="17" mp-original-line-height="27.200000762939453">并排画两个叠加的、蛋白突变及结构域图，用于单个蛋白突变形式的、不同队列或分组的比较</p><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867"><span mp-original-font-size="13" mp-original-line-height="16.25"><span mp-original-font-size="13" mp-original-line-height="16.25">lollipopPlot2</span>(<span mp-original-font-size="13" mp-original-line-height="16.25">m1 =</span> primary.apl, <span mp-original-font-size="13" mp-original-line-height="16.25">m2 =</span> relapse.apl, <span mp-original-font-size="13" mp-original-line-height="16.25">gene =</span> <span mp-original-font-size="13" mp-original-line-height="16.25">"PML"</span>, <span mp-original-font-size="13" mp-original-line-height="16.25">AACol1 =</span> <span mp-original-font-size="13" mp-original-line-height="16.25">"amino_acid_change"</span>, <span mp-original-font-size="13" mp-original-line-height="16.25">AACol2 =</span> <span mp-original-font-size="13" mp-original-line-height="16.25">"amino_acid_change"</span>, <span mp-original-font-size="13" mp-original-line-height="16.25">m1_name =</span> <span mp-original-font-size="13" mp-original-line-height="16.25">"Primary"</span>, <span mp-original-font-size="13" mp-original-line-height="16.25">m2_name =</span> <span mp-original-font-size="13" mp-original-line-height="16.25">"Relapse"</span>)</span></code></pre><p mp-original-font-size="17" mp-original-line-height="27.200000762939453"><img data-ratio="0.625" data-type="png" data-w="1536" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zfs9OSHUB2ayejYkr6SibDaDwl8aoTpHIeWvib4rrdVbY23nucicReCYBleJIYR9BRLvN2J2ibMEdD27tBncQzzSXw/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" width="768" src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zfs9OSHUB2ayejYkr6SibDaDwl8aoTpHIeWvib4rrdVbY23nucicReCYBleJIYR9BRLvN2J2ibMEdD27tBncQzzSXw/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"><span mp-original-font-size="24" mp-original-line-height="38.400001525878906">每个基因在某个分组中，突变差异显著性的比较</span></p><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867"><span mp-original-font-size="13" mp-original-line-height="16.25">fab.ce <span mp-original-font-size="13" mp-original-line-height="16.25">=</span> <span mp-original-font-size="13" mp-original-line-height="16.25">clinicalEnrichment</span>(<span mp-original-font-size="13" mp-original-line-height="16.25">maf =</span> laml, <span mp-original-font-size="13" mp-original-line-height="16.25">clinicalFeature =</span> <span mp-original-font-size="13" mp-original-line-height="16.25">'FAB_classification'</span>)</span></code></pre><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867">## <br mp-original-font-size="13" mp-original-line-height="18.571409225463867">## M0 M1 M2 M3 M4 M5 M6 M7 <br mp-original-font-size="13" mp-original-line-height="18.571409225463867">## 19 44 44 21 39 19  3  3</code></pre><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867"><span mp-original-font-size="13" mp-original-line-height="16.25"><span mp-original-font-size="13" mp-original-line-height="16.25"># Results are returned as a list. Significant associations p-value &lt; 0.05</span></span><span mp-original-font-size="13" mp-original-line-height="16.25">fab.ce<span mp-original-font-size="13" mp-original-line-height="16.25">$</span>groupwise_comparision[p_value <span mp-original-font-size="13" mp-original-line-height="16.25">&lt;</span> <span mp-original-font-size="13" mp-original-line-height="16.25">0.05</span>]</span></code></pre><table mp-original-font-size="17" mp-original-line-height="27.200000762939453" width="677" height="NaN"><tbody mp-original-font-size="17" mp-original-line-height="27.200000762939453"><tr mp-original-font-size="17" mp-original-line-height="27.200000762939453"><td mp-original-font-size="17" mp-original-line-height="27.200000762939453"><br></td></tr></tbody></table><table mp-original-font-size="17" mp-original-line-height="27.200000762939453" width="768" cellspacing="0"><thead mp-original-font-size="17" mp-original-line-height="27.200000762939453"><tr mp-original-font-size="17" mp-original-line-height="27.200000762939453"><th mp-original-font-size="17" mp-original-line-height="24.285688400268555" align="left"><p mp-original-font-size="17" mp-original-line-height="24.285688400268555">Hugo_Symbol</p><p mp-original-font-size="17" mp-original-line-height="24.285688400268555">&lt;chr&gt;</p></th><th mp-original-font-size="17" mp-original-line-height="24.285688400268555" align="left"><p mp-original-font-size="17" mp-original-line-height="24.285688400268555">Group1</p><p mp-original-font-size="17" mp-original-line-height="24.285688400268555">&lt;chr&gt;</p></th><th mp-original-font-size="17" mp-original-line-height="24.285688400268555" align="left"><p mp-original-font-size="17" mp-original-line-height="24.285688400268555">Group2</p><p mp-original-font-size="17" mp-original-line-height="24.285688400268555">&lt;chr&gt;</p></th><th mp-original-font-size="17" mp-original-line-height="24.285688400268555" align="left"><p mp-original-font-size="17" mp-original-line-height="24.285688400268555">n_mutated_group1</p><p mp-original-font-size="17" mp-original-line-height="24.285688400268555">&lt;chr&gt;</p></th><th mp-original-font-size="17" mp-original-line-height="24.285688400268555" align="left"><p mp-original-font-size="17" mp-original-line-height="24.285688400268555">n_mutated_group2</p><p mp-original-font-size="17" mp-original-line-height="24.285688400268555">&lt;chr&gt;</p></th><th mp-original-font-size="17" mp-original-line-height="24.285688400268555" align="right"><p mp-original-font-size="17" mp-original-line-height="24.285688400268555">p_value</p><p mp-original-font-size="17" mp-original-line-height="24.285688400268555">&lt;dbl&gt;</p></th><th mp-original-font-size="17" mp-original-line-height="24.285688400268555" align="right"><p mp-original-font-size="17" mp-original-line-height="24.285688400268555">OR_low</p><p mp-original-font-size="17" mp-original-line-height="24.285688400268555">&lt;dbl&gt;</p></th><th mp-original-font-size="17" mp-original-line-height="24.285688400268555"><br></th></tr></thead><tbody mp-original-font-size="17" mp-original-line-height="27.200000762939453"><tr mp-original-font-size="17" mp-original-line-height="27.200000762939453"><td mp-original-font-size="17" mp-original-line-height="24.285688400268555" align="left">IDH1</td><td mp-original-font-size="17" mp-original-line-height="24.285688400268555" align="left">M1</td><td mp-original-font-size="17" mp-original-line-height="24.285688400268555" align="left">Rest</td><td mp-original-font-size="17" mp-original-line-height="24.285688400268555" align="left">11 of 44</td><td mp-original-font-size="17" mp-original-line-height="24.285688400268555" align="left">7 of 149</td><td mp-original-font-size="17" mp-original-line-height="24.285688400268555" align="right">0.0002597371</td><td mp-original-font-size="17" mp-original-line-height="24.285688400268555" align="right">0</td><td mp-original-font-size="17" mp-original-line-height="24.285688400268555"><br></td></tr><tr mp-original-font-size="17" mp-original-line-height="27.200000762939453"><td mp-original-font-size="17" mp-original-line-height="24.285688400268555" align="left">TP53</td><td mp-original-font-size="17" mp-original-line-height="24.285688400268555" align="left">M7</td><td mp-original-font-size="17" mp-original-line-height="24.285688400268555" align="left">Rest</td><td mp-original-font-size="17" mp-original-line-height="24.285688400268555" align="left">3 of 3</td><td mp-original-font-size="17" mp-original-line-height="24.285688400268555" align="left">12 of 190</td><td mp-original-font-size="17" mp-original-line-height="24.285688400268555" align="right">0.0003857187</td><td mp-original-font-size="17" mp-original-line-height="24.285688400268555" align="right">0</td><td mp-original-font-size="17" mp-original-line-height="24.285688400268555"><br></td></tr><tr mp-original-font-size="17" mp-original-line-height="27.200000762939453"><td mp-original-font-size="17" mp-original-line-height="24.285688400268555" align="left">DNMT3A</td><td mp-original-font-size="17" mp-original-line-height="24.285688400268555" align="left">M5</td><td mp-original-font-size="17" mp-original-line-height="24.285688400268555" align="left">Rest</td><td mp-original-font-size="17" mp-original-line-height="24.285688400268555" align="left">10 of 19</td><td mp-original-font-size="17" mp-original-line-height="24.285688400268555" align="left">38 of 174</td><td mp-original-font-size="17" mp-original-line-height="24.285688400268555" align="right">0.0057610493</td><td mp-original-font-size="17" mp-original-line-height="24.285688400268555" align="right">0</td><td mp-original-font-size="17" mp-original-line-height="24.285688400268555"><br></td></tr><tr mp-original-font-size="17" mp-original-line-height="27.200000762939453"><td mp-original-font-size="17" mp-original-line-height="24.285688400268555" align="left">CEBPA</td><td mp-original-font-size="17" mp-original-line-height="24.285688400268555" align="left">M2</td><td mp-original-font-size="17" mp-original-line-height="24.285688400268555" align="left">Rest</td><td mp-original-font-size="17" mp-original-line-height="24.285688400268555" align="left">7 of 44</td><td mp-original-font-size="17" mp-original-line-height="24.285688400268555" align="left">6 of 149</td><td mp-original-font-size="17" mp-original-line-height="24.285688400268555" align="right">0.0117352110</td><td mp-original-font-size="17" mp-original-line-height="24.285688400268555" align="right">0</td><td mp-original-font-size="17" mp-original-line-height="24.285688400268555"><br></td></tr><tr mp-original-font-size="17" mp-original-line-height="27.200000762939453"><td mp-original-font-size="17" mp-original-line-height="24.285688400268555" align="left">RUNX1</td><td mp-original-font-size="17" mp-original-line-height="24.285688400268555" align="left">M0</td><td mp-original-font-size="17" mp-original-line-height="24.285688400268555" align="left">Rest</td><td mp-original-font-size="17" mp-original-line-height="24.285688400268555" align="left">5 of 19</td><td mp-original-font-size="17" mp-original-line-height="24.285688400268555" align="left">11 of 174</td><td mp-original-font-size="17" mp-original-line-height="24.285688400268555" align="right">0.0117436825</td><td mp-original-font-size="17" mp-original-line-height="24.285688400268555" align="right">0</td><td mp-original-font-size="17" mp-original-line-height="24.285688400268555"><br></td></tr><tr mp-original-font-size="17" mp-original-line-height="27.200000762939453"><td mp-original-font-size="17" mp-original-line-height="24.285688400268555" align="left">NPM1</td><td mp-original-font-size="17" mp-original-line-height="24.285688400268555" align="left">M5</td><td mp-original-font-size="17" mp-original-line-height="24.285688400268555" align="left">Rest</td><td mp-original-font-size="17" mp-original-line-height="24.285688400268555" align="left">7 of 19</td><td mp-original-font-size="17" mp-original-line-height="24.285688400268555" align="left">26 of 174</td><td mp-original-font-size="17" mp-original-line-height="24.285688400268555" align="right">0.0248582372</td><td mp-original-font-size="17" mp-original-line-height="24.285688400268555" align="right">0</td><td mp-original-font-size="17" mp-original-line-height="24.285688400268555"><br></td></tr><tr mp-original-font-size="17" mp-original-line-height="27.200000762939453"><td mp-original-font-size="17" mp-original-line-height="24.285688400268555" align="left">CEBPA</td><td mp-original-font-size="17" mp-original-line-height="24.285688400268555" align="left">M1</td><td mp-original-font-size="17" mp-original-line-height="24.285688400268555" align="left">Rest</td><td mp-original-font-size="17" mp-original-line-height="24.285688400268555" align="left">6 of 44</td><td mp-original-font-size="17" mp-original-line-height="24.285688400268555" align="left">7 of 149</td><td mp-original-font-size="17" mp-original-line-height="24.285688400268555" align="right">0.0478737468</td><td mp-original-font-size="17" mp-original-line-height="24.285688400268555" align="right">0</td><td mp-original-font-size="17" mp-original-line-height="24.285688400268555"><br></td></tr></tbody></table><p mp-original-font-size="17" mp-original-line-height="27.200000762939453"><br mp-original-font-size="17" mp-original-line-height="27.200000762939453"></p><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867"><span mp-original-font-size="13" mp-original-line-height="16.25"><span mp-original-font-size="13" mp-original-line-height="16.25">plotEnrichmentResults</span>(<span mp-original-font-size="13" mp-original-line-height="16.25">enrich_res =</span> fab.ce, <span mp-original-font-size="13" mp-original-line-height="16.25">pVal =</span> <span mp-original-font-size="13" mp-original-line-height="16.25">0.05</span>)</span></code></pre><p mp-original-font-size="17" mp-original-line-height="27.200000762939453"><img data-ratio="0.6666666666666666" data-type="png" data-w="1152" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zfs9OSHUB2ayejYkr6SibDaDwl8aoTpHIq9cmStnVic4AjsO8SPSfdEuEdlN2Wxs6j9Vr7SwT1dJZDvmgPqZtDiaw/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" width="576" src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zfs9OSHUB2ayejYkr6SibDaDwl8aoTpHIq9cmStnVic4AjsO8SPSfdEuEdlN2Wxs6j9Vr7SwT1dJZDvmgPqZtDiaw/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"></p><h2 mp-original-font-size="30" mp-original-line-height="36">药物-基因的互作</h2><p mp-original-font-size="17" mp-original-line-height="27.200000762939453">检查药物-基因相互作用和药物类别</p><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867"><span mp-original-font-size="13" mp-original-line-height="16.25">dgi <span mp-original-font-size="13" mp-original-line-height="16.25">=</span> <span mp-original-font-size="13" mp-original-line-height="16.25">drugInteractions</span>(<span mp-original-font-size="13" mp-original-line-height="16.25">maf =</span> laml, <span mp-original-font-size="13" mp-original-line-height="16.25">fontSize =</span> <span mp-original-font-size="13" mp-original-line-height="16.25">0.75</span>)</span></code></pre><p mp-original-font-size="17" mp-original-line-height="27.200000762939453"><img data-ratio="0.5" data-type="png" data-w="1536" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zfs9OSHUB2ayejYkr6SibDaDwl8aoTpHIMJiaaJZdhNXGg2GibmpMeEJvBuiaBvgIf9oeBW8OHwXJX1EyjvqFNOlaw/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" width="768" src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zfs9OSHUB2ayejYkr6SibDaDwl8aoTpHIMJiaaJZdhNXGg2GibmpMeEJvBuiaBvgIf9oeBW8OHwXJX1EyjvqFNOlaw/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"></p><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867"><span mp-original-font-size="13" mp-original-line-height="16.25">dnmt3a.dgi <span mp-original-font-size="13" mp-original-line-height="16.25">=</span> <span mp-original-font-size="13" mp-original-line-height="16.25">drugInteractions</span>(<span mp-original-font-size="13" mp-original-line-height="16.25">genes =</span> <span mp-original-font-size="13" mp-original-line-height="16.25">"DNMT3A"</span>, <span mp-original-font-size="13" mp-original-line-height="16.25">drugs =</span> <span mp-original-font-size="13" mp-original-line-height="16.25">TRUE</span>)</span></code></pre><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867">## Number of claimed drugs for given genes:<br mp-original-font-size="13" mp-original-line-height="18.571409225463867">##      Gene N<br mp-original-font-size="13" mp-original-line-height="18.571409225463867">## 1: DNMT3A 7</code></pre><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867"><span mp-original-font-size="13" mp-original-line-height="16.25"><span mp-original-font-size="13" mp-original-line-height="16.25"># Printing selected columns</span></span><span mp-original-font-size="13" mp-original-line-height="16.25">dnmt3a.dgi[,.(Gene, interaction_types, drug_name, drug_claim_name)]</span></code></pre><h2 mp-original-font-size="30" mp-original-line-height="36">已知的致癌生物途径的富集</h2><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867"><span mp-original-font-size="13" mp-original-line-height="16.25"><span mp-original-font-size="13" mp-original-line-height="16.25">OncogenicPathways</span>(<span mp-original-font-size="13" mp-original-line-height="16.25">maf =</span> laml)</span></code></pre><p mp-original-font-size="17" mp-original-line-height="27.200000762939453"><img data-ratio="1" data-type="png" data-w="768" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zfs9OSHUB2ayejYkr6SibDaDwl8aoTpHIuUqyxkN2epsibE69k4lx3BQqCIcJOEvdMK8Sc2xBcibEpkF70cyrK8UA/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" width="384" src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zfs9OSHUB2ayejYkr6SibDaDwl8aoTpHIuUqyxkN2epsibE69k4lx3BQqCIcJOEvdMK8Sc2xBcibEpkF70cyrK8UA/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"></p><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867"><span mp-original-font-size="13" mp-original-line-height="16.25"><span mp-original-font-size="13" mp-original-line-height="16.25">PlotOncogenicPathways</span>(<span mp-original-font-size="13" mp-original-line-height="16.25">maf =</span> laml, <span mp-original-font-size="13" mp-original-line-height="16.25">pathways =</span> <span mp-original-font-size="13" mp-original-line-height="16.25">"RTK-RAS"</span>)</span></code></pre><p mp-original-font-size="17" mp-original-line-height="27.200000762939453"><img data-ratio="0.3" data-type="png" data-w="1920" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zfs9OSHUB2ayejYkr6SibDaDwl8aoTpHIhEqjAlg77ak1ibZS2THpbbkt1OnVicQzZxVv6D8JGxxicAic2t71uWEyLA/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" width="960" src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zfs9OSHUB2ayejYkr6SibDaDwl8aoTpHIhEqjAlg77ak1ibZS2THpbbkt1OnVicQzZxVv6D8JGxxicAic2t71uWEyLA/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"></p><h2 mp-original-font-size="30" mp-original-line-height="36">基于变异等位基因频率(VAF)的样本的变异聚类</h2><p mp-original-font-size="17" mp-original-line-height="27.200000762939453">Variant Allele Frequencies, VAF</p><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867"><span mp-original-font-size="13" mp-original-line-height="16.25"><span mp-original-font-size="13" mp-original-line-height="16.25"># Heterogeneity in sample TCGA.AB.2972</span></span><span mp-original-font-size="13" mp-original-line-height="16.25"><span mp-original-font-size="13" mp-original-line-height="16.25"># install.packages("mclust")</span></span><span mp-original-font-size="13" mp-original-line-height="16.25"><span mp-original-font-size="13" mp-original-line-height="16.25"># library("mclust")</span></span><span mp-original-font-size="13" mp-original-line-height="16.25"><span mp-original-font-size="13" mp-original-line-height="16.25"># tsb参数：指定必须为其进行聚类的样本名称 (tumor_sample_barcode)</span></span><span mp-original-font-size="13" mp-original-line-height="16.25">  <span mp-original-font-size="13" mp-original-line-height="16.25"># specify sample names (Tumor_Sample_Barcodes) for which clustering has to be done</span></span><span mp-original-font-size="13" mp-original-line-height="16.25"><span mp-original-font-size="13" mp-original-line-height="16.25">table</span>(<span mp-original-font-size="13" mp-original-line-height="16.25">'TCGA-AB-2972'</span> <span mp-original-font-size="13" mp-original-line-height="16.25">%in%</span> laml<span mp-original-font-size="13" mp-original-line-height="16.25">@</span>data<span mp-original-font-size="13" mp-original-line-height="16.25">$</span>Tumor_Sample_Barcode)</span></code></pre><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867">## <br mp-original-font-size="13" mp-original-line-height="18.571409225463867">## TRUE <br mp-original-font-size="13" mp-original-line-height="18.571409225463867">##    1</code></pre><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867"><span mp-original-font-size="13" mp-original-line-height="16.25">tcga.ab.<span mp-original-font-size="13" mp-original-line-height="16.25">2972.</span>het <span mp-original-font-size="13" mp-original-line-height="16.25">=</span> <span mp-original-font-size="13" mp-original-line-height="16.25">inferHeterogeneity</span>(<span mp-original-font-size="13" mp-original-line-height="16.25">maf =</span> laml, <span mp-original-font-size="13" mp-original-line-height="16.25">tsb =</span> <span mp-original-font-size="13" mp-original-line-height="16.25">'TCGA-AB-2972'</span>, <span mp-original-font-size="13" mp-original-line-height="16.25">vafCol =</span> <span mp-original-font-size="13" mp-original-line-height="16.25">'i_TumorVAF_WU'</span>)</span></code></pre><p mp-original-font-size="17" mp-original-line-height="27.200000762939453"><img data-ratio="0.6666666666666666" data-type="png" data-w="1152" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zfs9OSHUB2ayejYkr6SibDaDwl8aoTpHIaSM3FeL0SeuU0Axx2YwYxT1TFruPKGjIfo2EmHse57oeOic0DkWviaibg/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" width="576" src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zfs9OSHUB2ayejYkr6SibDaDwl8aoTpHIaSM3FeL0SeuU0Axx2YwYxT1TFruPKGjIfo2EmHse57oeOic0DkWviaibg/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"></p><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867"><span mp-original-font-size="13" mp-original-line-height="16.25"><span mp-original-font-size="13" mp-original-line-height="16.25">print</span>(tcga.ab.<span mp-original-font-size="13" mp-original-line-height="16.25">2972.</span>het<span mp-original-font-size="13" mp-original-line-height="16.25">$</span>clusterMeans)</span></code></pre><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867">##    Tumor_Sample_Barcode cluster   meanVaf<br mp-original-font-size="13" mp-original-line-height="18.571409225463867">## 1:         TCGA-AB-2972       2 0.4496571<br mp-original-font-size="13" mp-original-line-height="18.571409225463867">## 2:         TCGA-AB-2972       1 0.2454750<br mp-original-font-size="13" mp-original-line-height="18.571409225463867">## 3:         TCGA-AB-2972 outlier 0.3695000</code></pre><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867"><span mp-original-font-size="13" mp-original-line-height="16.25"><span mp-original-font-size="13" mp-original-line-height="16.25"># Visualizing results</span></span><span mp-original-font-size="13" mp-original-line-height="16.25"><span mp-original-font-size="13" mp-original-line-height="16.25">plotClusters</span>(<span mp-original-font-size="13" mp-original-line-height="16.25">clusters =</span> tcga.ab.<span mp-original-font-size="13" mp-original-line-height="16.25">2972.</span>het)</span></code></pre><p mp-original-font-size="17" mp-original-line-height="27.200000762939453"><img data-ratio="0.6666666666666666" data-type="png" data-w="1152" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zfs9OSHUB2ayejYkr6SibDaDwl8aoTpHIQO2aIdRtyIbZruSYBaPbia6liakAbLc8q32gxvIL0h2bVuzr0hIQ3dng/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" width="576" src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zfs9OSHUB2ayejYkr6SibDaDwl8aoTpHIQO2aIdRtyIbZruSYBaPbia6liakAbLc8q32gxvIL0h2bVuzr0hIQ3dng/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"></p><p mp-original-font-size="17" mp-original-line-height="27.200000762939453">读入CBS segmented的CNV文件</p><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867">列名应该是Sample，染色体，Start, End, Num_Probes, Segment_Mean (log2 scale度)</code></pre><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867"><span mp-original-font-size="13" mp-original-line-height="16.25">seg <span mp-original-font-size="13" mp-original-line-height="16.25">=</span> <span mp-original-font-size="13" mp-original-line-height="16.25">system.file</span>(<span mp-original-font-size="13" mp-original-line-height="16.25">'extdata'</span>, <span mp-original-font-size="13" mp-original-line-height="16.25">'TCGA.AB.3009.hg19.seg.txt'</span>, <span mp-original-font-size="13" mp-original-line-height="16.25">package =</span> <span mp-original-font-size="13" mp-original-line-height="16.25">'maftools'</span>)</span><span mp-original-font-size="13" mp-original-line-height="16.25">tcga.ab.<span mp-original-font-size="13" mp-original-line-height="16.25">3009.</span>het <span mp-original-font-size="13" mp-original-line-height="16.25">=</span> <span mp-original-font-size="13" mp-original-line-height="16.25">inferHeterogeneity</span>(<span mp-original-font-size="13" mp-original-line-height="16.25">maf =</span> laml, <span mp-original-font-size="13" mp-original-line-height="16.25">tsb =</span> <span mp-original-font-size="13" mp-original-line-height="16.25">'TCGA-AB-3009'</span>, <span mp-original-font-size="13" mp-original-line-height="16.25">segFile =</span> seg, <span mp-original-font-size="13" mp-original-line-height="16.25">vafCol =</span> <span mp-original-font-size="13" mp-original-line-height="16.25">'i_TumorVAF_WU'</span>)</span></code></pre><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867">##    Hugo_Symbol Chromosome Start_Position End_Position Tumor_Sample_Barcode<br mp-original-font-size="13" mp-original-line-height="18.571409225463867">## 1:        PHF6         23      133551224    133551224         TCGA-AB-3009<br mp-original-font-size="13" mp-original-line-height="18.571409225463867">##        t_vaf Segment_Start Segment_End Segment_Mean CN<br mp-original-font-size="13" mp-original-line-height="18.571409225463867">## 1: 0.9349112            NA          NA           NA NA<br mp-original-font-size="13" mp-original-line-height="18.571409225463867"></code></pre><p mp-original-font-size="17" mp-original-line-height="27.200000762939453"><img data-ratio="0.6666666666666666" data-type="png" data-w="1152" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zfs9OSHUB2ayejYkr6SibDaDwl8aoTpHIfZWIjOBqAN4vmulXH2yfteW3fpUAL8vAUWwFynR2ibFPTNNhcSdsCuA/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" width="576" src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zfs9OSHUB2ayejYkr6SibDaDwl8aoTpHIfZWIjOBqAN4vmulXH2yfteW3fpUAL8vAUWwFynR2ibFPTNNhcSdsCuA/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"></p><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867"><span mp-original-font-size="13" mp-original-line-height="16.25"><span mp-original-font-size="13" mp-original-line-height="16.25"># Visualizing results. Highlighting those variants on copynumber altered variants</span></span><span mp-original-font-size="13" mp-original-line-height="16.25"><span mp-original-font-size="13" mp-original-line-height="16.25">plotClusters</span>(<span mp-original-font-size="13" mp-original-line-height="16.25">clusters =</span> tcga.ab.<span mp-original-font-size="13" mp-original-line-height="16.25">3009.</span>het, <span mp-original-font-size="13" mp-original-line-height="16.25">genes =</span> <span mp-original-font-size="13" mp-original-line-height="16.25">'CN_altered'</span>, <span mp-original-font-size="13" mp-original-line-height="16.25">showCNvars =</span> <span mp-original-font-size="13" mp-original-line-height="16.25">TRUE</span>)</span></code></pre><p mp-original-font-size="17" mp-original-line-height="27.200000762939453"><img data-ratio="0.6666666666666666" data-type="png" data-w="1152" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zfs9OSHUB2ayejYkr6SibDaDwl8aoTpHIf8EDxzoqqiaeCMgrvXFwkgLl5qZtgXAdxZZHrA8pOicC1TtTYPNzib2sg/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" width="576" src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zfs9OSHUB2ayejYkr6SibDaDwl8aoTpHIf8EDxzoqqiaeCMgrvXFwkgLl5qZtgXAdxZZHrA8pOicC1TtTYPNzib2sg/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"></p><p mp-original-font-size="17" mp-original-line-height="27.200000762939453"><strong mp-original-font-size="17" mp-original-line-height="27.200000762939453">突变特征 (Mutational Signatures)</strong></p><p mp-original-font-size="17" mp-original-line-height="27.200000762939453">Nature (2013, doi:10.1038/nature12477)中的定义：</p><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867">* 所有的癌症都是由体细胞突变引起的 (All cancers are caused by somatic mutations)，目前对于该生物学过程的理解有限。而来自癌症基因组的体细胞突变目录 (Catalogue)，具有已经起作用的突变过程的特征 (The catalogue of somatic mutations from a cancer genome bears the signatures of the mutational processes that have been operative)。<br mp-original-font-size="13" mp-original-line-height="18.571409225463867">* 即：细胞在成长过程中基因组不断受到内源性和外源性DNA损伤的威胁，不断发生变化，最终发生一些突变的积累；每一个突变过程都会留下一个不同的基因组标记，称为"Mutational Signatures"。<br mp-original-font-size="13" mp-original-line-height="18.571409225463867">* 通过分析来自7,042个癌症(Primary cancers of 30 different classes; 507 from WGS and 6,535 from WES)的4,938,362个突变，并提取了20多种不同的突变特征。<br mp-original-font-size="13" mp-original-line-height="18.571409225463867">* 一些存在于许多癌症类型中，特别是胞苷脱氨酶APOBEC家族的特征，而其它局限于单一的癌症类型。<br mp-original-font-size="13" mp-original-line-height="18.571409225463867">* 某些特征与癌症诊断时患者的年龄、已知的诱变暴露或DNA维持缺陷有关，但许多特征是未知的。<br mp-original-font-size="13" mp-original-line-height="18.571409225463867">* 除了这些全基因组突变特征外，在许多癌症类型中还发现了位于小基因组区域“kataegis”的超突变。<br mp-original-font-size="13" mp-original-line-height="18.571409225463867">* 突变特征的研究，揭示了癌症发展背后的突变过程的多样性，对了解癌症病因、预防和治疗具有潜在意义。</code></pre><p mp-original-font-size="17" mp-original-line-height="27.200000762939453"><strong mp-original-font-size="17" mp-original-line-height="27.200000762939453">APOBEC富集</strong></p><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867">* 在突变位点的两侧提取单个5'和3'碱基，进行de-novo特征分析，同时估计APOBEC富集分数。<br mp-original-font-size="13" mp-original-line-height="18.571409225463867">* APOBEC3G蛋白属APOBEC家族成员，又称为CEM15蛋白，是一种胞嘧啶脱氨酶。<br mp-original-font-size="13" mp-original-line-height="18.571409225463867">* APOBEC家族成员均被证明对单链DNA/RNA上的胞苷有脱氨基作用，可通过诱发靶基因上的胞嘧啶脱氨基成为尿嘧啶(C&gt;U) 参与大部分基因突变。</code></pre><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867"><span mp-original-font-size="13" mp-original-line-height="16.25"><span mp-original-font-size="13" mp-original-line-height="16.25"># Requires BSgenome object</span></span><span mp-original-font-size="13" mp-original-line-height="16.25"><span mp-original-font-size="13" mp-original-line-height="16.25">library</span>(BSgenome.Hsapiens.UCSC.hg19, <span mp-original-font-size="13" mp-original-line-height="16.25">quietly =</span> <span mp-original-font-size="13" mp-original-line-height="16.25">TRUE</span>)</span></code></pre><p mp-original-font-size="17" mp-original-line-height="27.200000762939453">UCSC提供的人全基因组序列(eg: hg19 / GRCh37.p13)，存储在Biostrings对象中</p><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867">* 这个BSgenome数据包由以下源数据文件制成: hg19.2bit (二进制，下载自：https://hgdownload.cse.ucsc.edu/goldenPath/hg19/bigZips/latest/ , March 24, 2020)</code></pre><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867"><span mp-original-font-size="13" mp-original-line-height="16.25">laml.tnm <span mp-original-font-size="13" mp-original-line-height="16.25">=</span> <span mp-original-font-size="13" mp-original-line-height="16.25">trinucleotideMatrix</span>(<span mp-original-font-size="13" mp-original-line-height="16.25">maf =</span> laml, <span mp-original-font-size="13" mp-original-line-height="16.25">prefix =</span> <span mp-original-font-size="13" mp-original-line-height="16.25">'chr'</span>, <span mp-original-font-size="13" mp-original-line-height="16.25">add =</span> <span mp-original-font-size="13" mp-original-line-height="16.25">TRUE</span>, <span mp-original-font-size="13" mp-original-line-height="16.25">ref_genome =</span> <span mp-original-font-size="13" mp-original-line-height="16.25">"BSgenome.Hsapiens.UCSC.hg19"</span>)</span></code></pre><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867">## -Extracting 5' and 3' adjacent bases<br mp-original-font-size="13" mp-original-line-height="18.571409225463867">## -Extracting +/- 20bp around mutated bases for background C&gt;T estimation<br mp-original-font-size="13" mp-original-line-height="18.571409225463867">## -Estimating APOBEC enrichment scores<br mp-original-font-size="13" mp-original-line-height="18.571409225463867">## --Performing one-way Fisher's test for APOBEC enrichment<br mp-original-font-size="13" mp-original-line-height="18.571409225463867">## ---APOBEC related mutations are enriched in  3.315 % of samples (APOBEC enrichment score &gt; 2 ;  6  of  181  samples)<br mp-original-font-size="13" mp-original-line-height="18.571409225463867">## -Creating mutation matrix<br mp-original-font-size="13" mp-original-line-height="18.571409225463867">## --matrix of dimension 188x96</code></pre><p mp-original-font-size="17" mp-original-line-height="27.200000762939453">绘图展示APOBEC富集和非APOBEC富集样本之间的差异</p><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867"><span mp-original-font-size="13" mp-original-line-height="16.25"><span mp-original-font-size="13" mp-original-line-height="16.25">plotApobecDiff</span>(<span mp-original-font-size="13" mp-original-line-height="16.25">tnm =</span> laml.tnm, <span mp-original-font-size="13" mp-original-line-height="16.25">maf =</span> laml, <span mp-original-font-size="13" mp-original-line-height="16.25">pVal =</span> <span mp-original-font-size="13" mp-original-line-height="16.25">0.2</span>)</span></code></pre><p mp-original-font-size="17" mp-original-line-height="27.200000762939453"><img data-ratio="0.5714285714285714" data-type="png" data-w="1344" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zfs9OSHUB2ayejYkr6SibDaDwl8aoTpHIWPWjdSRht3fQtwicTXib0L8NF3icYnuv9wf8nIetdJ8OiaoiaWg5wSftqpw/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" width="672" src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zfs9OSHUB2ayejYkr6SibDaDwl8aoTpHIWPWjdSRht3fQtwicTXib0L8NF3icYnuv9wf8nIetdJ8OiaoiaWg5wSftqpw/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"></p><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867">## $results<br mp-original-font-size="13" mp-original-line-height="18.571409225463867">##      Hugo_Symbol Enriched nonEnriched       pval        or      ci.up<br mp-original-font-size="13" mp-original-line-height="18.571409225463867">##   1:        TP53        2          13 0.08175632 5.9976455  46.608861<br mp-original-font-size="13" mp-original-line-height="18.571409225463867">##   2:        TET2        1          16 0.45739351 1.9407002  18.983979<br mp-original-font-size="13" mp-original-line-height="18.571409225463867">##   3:        FLT3        2          45 0.65523131 1.4081851  10.211621<br mp-original-font-size="13" mp-original-line-height="18.571409225463867">##   4:      DNMT3A        1          47 1.00000000 0.5335362   4.949499<br mp-original-font-size="13" mp-original-line-height="18.571409225463867">##   5:      ADAM11        0           2 1.00000000 0.0000000 164.191472<br mp-original-font-size="13" mp-original-line-height="18.571409225463867"></code></pre><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867"><span mp-original-font-size="13" mp-original-line-height="16.25"><span mp-original-font-size="13" mp-original-line-height="16.25"># Plots differences between APOBEC enriched and non-APOBEC enriched samples</span></span></code></pre><p mp-original-font-size="17" mp-original-line-height="27.200000762939453"><img data-ratio="0.625" data-type="png" data-w="1536" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zfs9OSHUB2ayejYkr6SibDaDwl8aoTpHIAyOqbJZ8AyicwpE9Jib9lDAPibKYbMgfPQ1nWCaJKAZ9MQvz8Cy9kxftQ/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" width="768" src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zfs9OSHUB2ayejYkr6SibDaDwl8aoTpHIAyOqbJZ8AyicwpE9Jib9lDAPibKYbMgfPQ1nWCaJKAZ9MQvz8Cy9kxftQ/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"></p><p mp-original-font-size="17" mp-original-line-height="27.200000762939453">根据共表型相关度量 (Cophenetic correlation metric) <strong mp-original-font-size="17" mp-original-line-height="27.200000762939453">估计癌症特征(Signatures)的数量</strong></p><p mp-original-font-size="17" mp-original-line-height="27.200000762939453">可使用最大至6个Signatures</p><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867"><span mp-original-font-size="13" mp-original-line-height="16.25"><span mp-original-font-size="13" mp-original-line-height="16.25">#  library('NMF')</span></span><span mp-original-font-size="13" mp-original-line-height="16.25"><span mp-original-font-size="13" mp-original-line-height="16.25">#  laml.sign = estimateSignatures(mat = laml.tnm, nTry = 6)</span></span><span mp-original-font-size="13" mp-original-line-height="16.25"><span mp-original-font-size="13" mp-original-line-height="16.25"># Run main function with maximum 6 signatures</span></span><span mp-original-font-size="13" mp-original-line-height="16.25">laml.sign <span mp-original-font-size="13" mp-original-line-height="16.25">=</span> <span mp-original-font-size="13" mp-original-line-height="16.25">estimateSignatures</span>(<span mp-original-font-size="13" mp-original-line-height="16.25">mat =</span> laml.tnm, <span mp-original-font-size="13" mp-original-line-height="16.25">nTry =</span> <span mp-original-font-size="13" mp-original-line-height="16.25">6</span>, <span mp-original-font-size="13" mp-original-line-height="16.25">pConstant =</span> <span mp-original-font-size="13" mp-original-line-height="16.25">0.1</span>, <span mp-original-font-size="13" mp-original-line-height="16.25">plotBestFitRes =</span> <span mp-original-font-size="13" mp-original-line-height="16.25">FALSE</span>, <span mp-original-font-size="13" mp-original-line-height="16.25">parallel =</span> <span mp-original-font-size="13" mp-original-line-height="16.25">2</span>)</span></code></pre><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867">## -Running NMF for 6 ranks<br mp-original-font-size="13" mp-original-line-height="18.571409225463867">## Compute NMF rank= 2  ... + measures ... OK<br mp-original-font-size="13" mp-original-line-height="18.571409225463867">## Compute NMF rank= 3  ... + measures ... OK<br mp-original-font-size="13" mp-original-line-height="18.571409225463867">## Compute NMF rank= 4  ... + measures ... OK<br mp-original-font-size="13" mp-original-line-height="18.571409225463867">## Compute NMF rank= 5  ... + measures ... OK<br mp-original-font-size="13" mp-original-line-height="18.571409225463867">## Compute NMF rank= 6  ... + measures ... OK</code></pre><p mp-original-font-size="17" mp-original-line-height="27.200000762939453"><img data-ratio="0.625" data-type="png" data-w="1536" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zfs9OSHUB2ayejYkr6SibDaDwl8aoTpHIluq9Ig03F8xTY03MqGjk7rI9BuCJibo0aORJRTI8VxwCGic0UqHJXhbQ/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" width="768" src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zfs9OSHUB2ayejYkr6SibDaDwl8aoTpHIluq9Ig03F8xTY03MqGjk7rI9BuCJibo0aORJRTI8VxwCGic0UqHJXhbQ/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"></p><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867">## -Finished in 00:01:00 elapsed (12.0s cpu)</code></pre><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867"><span mp-original-font-size="13" mp-original-line-height="16.25"><span mp-original-font-size="13" mp-original-line-height="16.25">plotCophenetic</span>(<span mp-original-font-size="13" mp-original-line-height="16.25">res =</span> laml.sign)</span></code></pre><p mp-original-font-size="17" mp-original-line-height="27.200000762939453"><img data-ratio="1" data-type="png" data-w="576" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zfs9OSHUB2ayejYkr6SibDaDwl8aoTpHIVBrzREpuLXIk0S95Xhz8lknCzLSD0icG2dMTNicuERrfnib3PK94urHSg/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" width="288" src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zfs9OSHUB2ayejYkr6SibDaDwl8aoTpHIVBrzREpuLXIk0S95Xhz8lknCzLSD0icG2dMTNicuERrfnib3PK94urHSg/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"></p><p mp-original-font-size="17" mp-original-line-height="27.200000762939453"><strong mp-original-font-size="17" mp-original-line-height="27.200000762939453">COSMIC数据库</strong></p><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867">* COSMIC (Catalogue Of Somatic Mutations In Cancer, 癌症体细胞突变目录) 数据库记录了与人类癌症相关的驱动基因，搜集和记录了大量文献中的数百万肿瘤样本的编码区变异，以及促进癌症的所有体细胞突变的非编码区变异、基因融合、拷贝数变异和耐药基因变异。<br mp-original-font-size="13" mp-original-line-height="18.571409225463867">* COSMIC采用人工审核的方式扩充数据库，实时追踪文献的最新信息，将与癌症相关的重要基因优先放入数据库中。<br mp-original-font-size="13" mp-original-line-height="18.571409225463867">* COSMIC-3D可研究三维蛋白结构中的突变，及其对蛋白功能和药物的影响。</code></pre><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867"><span mp-original-font-size="13" mp-original-line-height="16.25"><span mp-original-font-size="13" mp-original-line-height="16.25">#  laml.sig = extractSignatures(mat = laml.tnm, n = 3)</span></span><span mp-original-font-size="13" mp-original-line-height="16.25">laml.sig <span mp-original-font-size="13" mp-original-line-height="16.25">=</span> <span mp-original-font-size="13" mp-original-line-height="16.25">extractSignatures</span>(<span mp-original-font-size="13" mp-original-line-height="16.25">mat =</span> laml.tnm, <span mp-original-font-size="13" mp-original-line-height="16.25">n =</span> <span mp-original-font-size="13" mp-original-line-height="16.25">3</span>, <span mp-original-font-size="13" mp-original-line-height="16.25">pConstant =</span> <span mp-original-font-size="13" mp-original-line-height="16.25">0.1</span>,  <span mp-original-font-size="13" mp-original-line-height="16.25">parallel =</span> <span mp-original-font-size="13" mp-original-line-height="16.25">2</span>)</span></code></pre><p mp-original-font-size="17" mp-original-line-height="27.200000762939453">与原始的 30 个 signatures 比较 (COSMIC signatures)</p><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867"><span mp-original-font-size="13" mp-original-line-height="16.25"><span mp-original-font-size="13" mp-original-line-height="16.25"># laml.og30.cosm = compareSignatures(nmfRes = laml.sig, sig_db = "legacy")</span></span></code></pre><p mp-original-font-size="17" mp-original-line-height="27.200000762939453">与更新的 60 个 signatures 比较 (version3, COSMIC signatures)</p><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867"><span mp-original-font-size="13" mp-original-line-height="16.25"><span mp-original-font-size="13" mp-original-line-height="16.25"># laml.v3.cosm = compareSignatures(nmfRes = laml.sig, sig_db = "SBS")</span></span><span mp-original-font-size="13" mp-original-line-height="16.25"><span mp-original-font-size="13" mp-original-line-height="16.25"># save(file = "compareSignatures.RData", list = ls())</span></span></code></pre><p mp-original-font-size="17" mp-original-line-height="27.200000762939453"><span mp-original-font-size="17" mp-original-line-height="27.200000762939453"><br mp-original-font-size="17" mp-original-line-height="27.200000762939453"></span></p><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867"><span mp-original-font-size="13" mp-original-line-height="16.25"><span mp-original-font-size="13" mp-original-line-height="16.25">rm</span>(<span mp-original-font-size="13" mp-original-line-height="16.25">list =</span> <span mp-original-font-size="13" mp-original-line-height="16.25">ls</span>())</span><span mp-original-font-size="13" mp-original-line-height="16.25"><span mp-original-font-size="13" mp-original-line-height="16.25">load</span>(<span mp-original-font-size="13" mp-original-line-height="16.25">"compareSignatures.RData"</span>)</span><span mp-original-font-size="13" mp-original-line-height="16.25">pheatmap<span mp-original-font-size="13" mp-original-line-height="16.25">::</span><span mp-original-font-size="13" mp-original-line-height="16.25">pheatmap</span>(<span mp-original-font-size="13" mp-original-line-height="16.25">mat =</span> laml.og30.cosm<span mp-original-font-size="13" mp-original-line-height="16.25">$</span>cosine_similarities, <span mp-original-font-size="13" mp-original-line-height="16.25">cluster_rows =</span> <span mp-original-font-size="13" mp-original-line-height="16.25">FALSE</span>, <span mp-original-font-size="13" mp-original-line-height="16.25">main =</span> <span mp-original-font-size="13" mp-original-line-height="16.25">"cosine similarity against validated signatures"</span>)</span></code></pre><p mp-original-font-size="17" mp-original-line-height="27.200000762939453"><img data-ratio="0.35714285714285715" data-type="png" data-w="1344" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zfs9OSHUB2ayejYkr6SibDaDwl8aoTpHIpIVdB1jyibkfzicBxBibfnzCoAzHHYPIr69rz1NvOXibvsbviaW0dj7aejw/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" width="672" src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zfs9OSHUB2ayejYkr6SibDaDwl8aoTpHIpIVdB1jyibkfzicBxBibfnzCoAzHHYPIr69rz1NvOXibvsbviaW0dj7aejw/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"></p><p mp-original-font-size="17" mp-original-line-height="27.200000762939453"><span mp-original-font-size="17" mp-original-line-height="27.200000762939453"><br mp-original-font-size="17" mp-original-line-height="27.200000762939453"></span></p><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867"><span mp-original-font-size="13" mp-original-line-height="16.25">pheatmap<span mp-original-font-size="13" mp-original-line-height="16.25">::</span><span mp-original-font-size="13" mp-original-line-height="16.25">pheatmap</span>(<span mp-original-font-size="13" mp-original-line-height="16.25">mat =</span> laml.v3.cosm<span mp-original-font-size="13" mp-original-line-height="16.25">$</span>cosine_similarities, <span mp-original-font-size="13" mp-original-line-height="16.25">cluster_rows =</span> <span mp-original-font-size="13" mp-original-line-height="16.25">FALSE</span>, <span mp-original-font-size="13" mp-original-line-height="16.25">main =</span> <span mp-original-font-size="13" mp-original-line-height="16.25">"cosine similarity against validated signatures"</span>)</span></code></pre><p mp-original-font-size="17" mp-original-line-height="27.200000762939453"><img data-ratio="0.22727272727272727" data-type="png" data-w="2112" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zfs9OSHUB2ayejYkr6SibDaDwl8aoTpHIl4h7WKfff9jjaO2gEgNdZKvInhK1qSohbUsTyy4805U703hRePBNPA/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" width="1056" src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zfs9OSHUB2ayejYkr6SibDaDwl8aoTpHIl4h7WKfff9jjaO2gEgNdZKvInhK1qSohbUsTyy4805U703hRePBNPA/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"></p><p mp-original-font-size="17" mp-original-line-height="27.200000762939453"><span mp-original-font-size="17" mp-original-line-height="27.200000762939453"><br mp-original-font-size="17" mp-original-line-height="27.200000762939453"></span></p><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867"><span mp-original-font-size="13" mp-original-line-height="16.25">maftools<span mp-original-font-size="13" mp-original-line-height="16.25">::</span><span mp-original-font-size="13" mp-original-line-height="16.25">plotSignatures</span>(<span mp-original-font-size="13" mp-original-line-height="16.25">nmfRes =</span> laml.sig, <span mp-original-font-size="13" mp-original-line-height="16.25">title_size =</span> <span mp-original-font-size="13" mp-original-line-height="16.25">0.8</span>, <span mp-original-font-size="13" mp-original-line-height="16.25">sig_db =</span> <span mp-original-font-size="13" mp-original-line-height="16.25">"SBS"</span>)</span></code></pre><p mp-original-font-size="17" mp-original-line-height="27.200000762939453"><img data-ratio="0.6666666666666666" data-type="png" data-w="1152" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zfs9OSHUB2ayejYkr6SibDaDwl8aoTpHInSYWmsU6ns3v4LNpKhJeWTZIDia7cMlWEBz1PUmpnkXScW7CbhByHSA/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" width="576" src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zfs9OSHUB2ayejYkr6SibDaDwl8aoTpHInSYWmsU6ns3v4LNpKhJeWTZIDia7cMlWEBz1PUmpnkXScW7CbhByHSA/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"></p><p mp-original-font-size="17" mp-original-line-height="27.200000762939453">3D条形图展示第1个Signature</p><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867"><span mp-original-font-size="13" mp-original-line-height="16.25"><span mp-original-font-size="13" mp-original-line-height="16.25">#  Visualize first signature</span></span><span mp-original-font-size="13" mp-original-line-height="16.25">sig1 <span mp-original-font-size="13" mp-original-line-height="16.25">=</span> laml.sig<span mp-original-font-size="13" mp-original-line-height="16.25">$</span>signatures[,<span mp-original-font-size="13" mp-original-line-height="16.25">1</span>]</span><span mp-original-font-size="13" mp-original-line-height="16.25">barplot3d<span mp-original-font-size="13" mp-original-line-height="16.25">::</span><span mp-original-font-size="13" mp-original-line-height="16.25">legoplot3d</span>(<span mp-original-font-size="13" mp-original-line-height="16.25">contextdata =</span> sig1, <span mp-original-font-size="13" mp-original-line-height="16.25">labels =</span> <span mp-original-font-size="13" mp-original-line-height="16.25">FALSE</span>, <span mp-original-font-size="13" mp-original-line-height="16.25">scalexy =</span> <span mp-original-font-size="13" mp-original-line-height="16.25">0.01</span>, <span mp-original-font-size="13" mp-original-line-height="16.25">sixcolors =</span> <span mp-original-font-size="13" mp-original-line-height="16.25">"sanger"</span>, <span mp-original-font-size="13" mp-original-line-height="16.25">alpha =</span> <span mp-original-font-size="13" mp-original-line-height="16.25">0.5</span>)</span><span mp-original-font-size="13" mp-original-line-height="16.25"><span mp-original-font-size="13" mp-original-line-height="16.25">#  colnames(laml.sign$contributions) = as.character(getSampleSummary(x = laml)[,Tumor_Sample_Barcode])[1:187]</span></span></code></pre><p mp-original-font-size="17" mp-original-line-height="27.200000762939453"><span mp-original-font-size="17" mp-original-line-height="27.200000762939453"><br mp-original-font-size="17" mp-original-line-height="27.200000762939453"></span></p><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867"><span mp-original-font-size="13" mp-original-line-height="16.25">laml.se <span mp-original-font-size="13" mp-original-line-height="16.25">=</span> <span mp-original-font-size="13" mp-original-line-height="16.25">signatureEnrichment</span>(<span mp-original-font-size="13" mp-original-line-height="16.25">maf =</span> laml, <span mp-original-font-size="13" mp-original-line-height="16.25">sig_res =</span> laml.sig)</span></code></pre><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867">## <br mp-original-font-size="13" mp-original-line-height="18.571409225463867">## Signature_1 Signature_2 Signature_3 <br mp-original-font-size="13" mp-original-line-height="18.571409225463867">##          60          65          63</code></pre><p mp-original-font-size="17" mp-original-line-height="27.200000762939453"><img data-ratio="0.7" data-type="png" data-w="960" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zfs9OSHUB2ayejYkr6SibDaDwl8aoTpHIVCJntCHTxOUx6zo936OicM2YEHEswf7IDgKBNow8bjY6icLuLiclUkllQ/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" width="480" src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zfs9OSHUB2ayejYkr6SibDaDwl8aoTpHIVCJntCHTxOUx6zo936OicM2YEHEswf7IDgKBNow8bjY6icLuLiclUkllQ/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"></p><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867"><span mp-original-font-size="13" mp-original-line-height="16.25"><span mp-original-font-size="13" mp-original-line-height="16.25">plotEnrichmentResults</span>(<span mp-original-font-size="13" mp-original-line-height="16.25">enrich_res =</span> laml.se, <span mp-original-font-size="13" mp-original-line-height="16.25">pVal =</span> <span mp-original-font-size="13" mp-original-line-height="16.25">0.05</span>)</span></code></pre><p mp-original-font-size="17" mp-original-line-height="27.200000762939453"><img data-ratio="0.6666666666666666" data-type="png" data-w="1152" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zfs9OSHUB2ayejYkr6SibDaDwl8aoTpHIuOyHhojYWNu2O0IeeLNUPG4DWKMbcefHm4JmzCUr2MzWz13UJ0NCiaA/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" width="576" src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zfs9OSHUB2ayejYkr6SibDaDwl8aoTpHIuOyHhojYWNu2O0IeeLNUPG4DWKMbcefHm4JmzCUr2MzWz13UJ0NCiaA/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"></p><h2 mp-original-font-size="30" mp-original-line-height="36">分析ANNOVAR变异注释数据</h2><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867"><span mp-original-font-size="13" mp-original-line-height="16.25">var.annovar <span mp-original-font-size="13" mp-original-line-height="16.25">=</span> <span mp-original-font-size="13" mp-original-line-height="16.25">system.file</span>(<span mp-original-font-size="13" mp-original-line-height="16.25">"extdata"</span>, <span mp-original-font-size="13" mp-original-line-height="16.25">"variants.hg19_multianno.txt"</span>, <span mp-original-font-size="13" mp-original-line-height="16.25">package =</span> <span mp-original-font-size="13" mp-original-line-height="16.25">"maftools"</span>)</span><span mp-original-font-size="13" mp-original-line-height="16.25">var.annovar.maf <span mp-original-font-size="13" mp-original-line-height="16.25">=</span> <span mp-original-font-size="13" mp-original-line-height="16.25">annovarToMaf</span>(<span mp-original-font-size="13" mp-original-line-height="16.25">annovar =</span> var.annovar, <span mp-original-font-size="13" mp-original-line-height="16.25">Center =</span> <span mp-original-font-size="13" mp-original-line-height="16.25">'CSI-NUS'</span>, <span mp-original-font-size="13" mp-original-line-height="16.25">refBuild =</span> <span mp-original-font-size="13" mp-original-line-height="16.25">'hg19'</span>, <span mp-original-font-size="13" mp-original-line-height="16.25">tsbCol =</span> <span mp-original-font-size="13" mp-original-line-height="16.25">'Tumor_Sample_Barcode'</span>, <span mp-original-font-size="13" mp-original-line-height="16.25">table =</span> <span mp-original-font-size="13" mp-original-line-height="16.25">'ensGene'</span>)</span></code></pre><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867">## -Reading annovar files<br mp-original-font-size="13" mp-original-line-height="18.571409225463867">## -Processing Exonic variants<br mp-original-font-size="13" mp-original-line-height="18.571409225463867">## --Adding Variant_Classification<br mp-original-font-size="13" mp-original-line-height="18.571409225463867">## --Parsing aa-change<br mp-original-font-size="13" mp-original-line-height="18.571409225463867">## -Processing Non-exonic variants<br mp-original-font-size="13" mp-original-line-height="18.571409225463867">## --Adding Variant_Classification<br mp-original-font-size="13" mp-original-line-height="18.571409225463867">## -Adding Variant_Type<br mp-original-font-size="13" mp-original-line-height="18.571409225463867">## -Converting Ensemble Gene IDs into HGNC gene symbols<br mp-original-font-size="13" mp-original-line-height="18.571409225463867">## --Done. Original ensemble gene IDs are preserved under field name ens_id<br mp-original-font-size="13" mp-original-line-height="18.571409225463867">## Finished in 1.100s elapsed (0.210s cpu)</code></pre><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867"><span mp-original-font-size="13" mp-original-line-height="16.25"><span mp-original-font-size="13" mp-original-line-height="16.25"># Read sample ICGC data for ESCA</span></span><span mp-original-font-size="13" mp-original-line-height="16.25">esca.icgc <span mp-original-font-size="13" mp-original-line-height="16.25">&lt;-</span> <span mp-original-font-size="13" mp-original-line-height="16.25">system.file</span>(<span mp-original-font-size="13" mp-original-line-height="16.25">"extdata"</span>, <span mp-original-font-size="13" mp-original-line-height="16.25">"simple_somatic_mutation.open.ESCA-CN.sample.tsv.gz"</span>, <span mp-original-font-size="13" mp-original-line-height="16.25">package =</span> <span mp-original-font-size="13" mp-original-line-height="16.25">"maftools"</span>)</span><span mp-original-font-size="13" mp-original-line-height="16.25">esca.maf <span mp-original-font-size="13" mp-original-line-height="16.25">&lt;-</span> <span mp-original-font-size="13" mp-original-line-height="16.25">icgcSimpleMutationToMAF</span>(<span mp-original-font-size="13" mp-original-line-height="16.25">icgc =</span> esca.icgc, <span mp-original-font-size="13" mp-original-line-height="16.25">addHugoSymbol =</span> <span mp-original-font-size="13" mp-original-line-height="16.25">TRUE</span>)</span></code></pre><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867">## --Removed 427 duplicated variants</code></pre><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867"><span mp-original-font-size="13" mp-original-line-height="16.25"><span mp-original-font-size="13" mp-original-line-height="16.25">#Printing first 16 columns for display convenience</span></span><span mp-original-font-size="13" mp-original-line-height="16.25"><span mp-original-font-size="13" mp-original-line-height="16.25">print</span>(esca.maf[<span mp-original-font-size="13" mp-original-line-height="16.25">1</span><span mp-original-font-size="13" mp-original-line-height="16.25">:</span><span mp-original-font-size="13" mp-original-line-height="16.25">5</span>,<span mp-original-font-size="13" mp-original-line-height="16.25">1</span><span mp-original-font-size="13" mp-original-line-height="16.25">:</span><span mp-original-font-size="13" mp-original-line-height="16.25">16</span>, <span mp-original-font-size="13" mp-original-line-height="16.25">with =</span> <span mp-original-font-size="13" mp-original-line-height="16.25">FALSE</span>])</span></code></pre><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867">##    Hugo_Symbol Entrez_Gene_Id Center NCBI_Build Chromosome Start_Position<br mp-original-font-size="13" mp-original-line-height="18.571409225463867">## 1:  AC005237.4             NA     NA     GRCh37          2      241987787<br mp-original-font-size="13" mp-original-line-height="18.571409225463867">## 2:  AC061992.1            786     NA     GRCh37         17       76425382<br mp-original-font-size="13" mp-original-line-height="18.571409225463867">## 3:  AC097467.2             NA     NA     GRCh37          4      156294567<br mp-original-font-size="13" mp-original-line-height="18.571409225463867">## 4:    ADAMTS12             NA     NA     GRCh37          5       33684019<br mp-original-font-size="13" mp-original-line-height="18.571409225463867">## 5:  AL589642.1          54801     NA     GRCh37          9       32630154<br mp-original-font-size="13" mp-original-line-height="18.571409225463867"></code></pre><p mp-original-font-size="17" mp-original-line-height="27.200000762939453">基因名称 (如曾用名) 的转换</p><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867"><span mp-original-font-size="13" mp-original-line-height="16.25">laml.mutsig.corrected <span mp-original-font-size="13" mp-original-line-height="16.25">=</span> <span mp-original-font-size="13" mp-original-line-height="16.25">prepareMutSig</span>(<span mp-original-font-size="13" mp-original-line-height="16.25">maf =</span> laml)</span><span mp-original-font-size="13" mp-original-line-height="16.25"><span mp-original-font-size="13" mp-original-line-height="16.25">#  Converting gene names for 1 variants from 1 genes</span></span><span mp-original-font-size="13" mp-original-line-height="16.25"><span mp-original-font-size="13" mp-original-line-height="16.25">#     Hugo_Symbol  MutSig_Synonym  N</span></span><span mp-original-font-size="13" mp-original-line-height="16.25"><span mp-original-font-size="13" mp-original-line-height="16.25">#  1:    ARHGAP35           GRLF1  1</span></span><span mp-original-font-size="13" mp-original-line-height="16.25"><span mp-original-font-size="13" mp-original-line-height="16.25">#  Original symbols are preserved under column OG_Hugo_Symbol.</span></span></code></pre><p mp-original-font-size="17" mp-original-line-height="27.200000762939453">输出本分析流程中，各个软件的版本</p><pre mp-original-font-size="13" mp-original-line-height="18.571409225463867"><code mp-original-font-size="13" mp-original-line-height="18.571409225463867"><span mp-original-font-size="13" mp-original-line-height="16.25"><span mp-original-font-size="13" mp-original-line-height="16.25">#  devtools::install_github(repo = "PoisonAlien/TCGAmutations")</span></span><span mp-original-font-size="13" mp-original-line-height="16.25"><span mp-original-font-size="13" mp-original-line-height="16.25">sessionInfo</span>()</span></code></pre><section mp-original-font-size="17" mp-original-line-height="27.200000762939453"><span mp-original-font-size="14" mp-original-line-height="22.399999618530273">资料来源</span></section><p mp-original-font-size="17" mp-original-line-height="NaN"><strong mp-original-font-size="17" mp-original-line-height="NaN"><span mp-original-font-size="12" mp-original-line-height="NaN">maftools : Summarize, Analyze and Visualize MAF Files</span></strong></p><p mp-original-font-size="17" mp-original-line-height="NaN"><span mp-original-font-size="12" mp-original-line-height="NaN"><strong mp-original-font-size="12" mp-original-line-height="NaN">Anand Mayakonda</strong> 2022-04-26</span></p><p mp-original-font-size="17" mp-original-line-height="NaN"><span mp-original-font-size="12" mp-original-line-height="NaN">https://bioconductor.org/packages/release/bioc/vignettes/maftools/inst/doc/maftools.html</span></p><section mp-original-font-size="17" mp-original-line-height="NaN"><strong mp-original-font-size="17" mp-original-line-height="NaN"><span mp-original-font-size="12" mp-original-line-height="NaN">Package ‘maftools’</span></strong><span mp-original-font-size="12" mp-original-line-height="NaN"> August 11, 2022</span></section><section mp-original-font-size="17" mp-original-line-height="NaN"><span mp-original-font-size="12" mp-original-line-height="NaN">https://master.bioconductor.org/packages/release/bioc/manuals/maftools/man/maftools.pdf</span></section><section mp-original-font-size="17" mp-original-line-height="NaN"><span mp-original-font-size="12" mp-original-line-height="NaN">Mutation Annotation Format, <strong mp-original-font-size="12" mp-original-line-height="NaN">MAF</strong></span></section><section mp-original-font-size="17" mp-original-line-height="NaN"><span mp-original-font-size="12" mp-original-line-height="NaN">https://docs.gdc.cancer.gov/Data/File_Formats/MAF_Format/</span></section><section mp-original-font-size="17" mp-original-line-height="NaN"><strong mp-original-font-size="17" mp-original-line-height="NaN"><span mp-original-font-size="12" mp-original-line-height="NaN">vcf2maf </span></strong><span mp-original-font-size="12" mp-original-line-height="NaN">程序</span></section><section mp-original-font-size="17" mp-original-line-height="NaN"><span mp-original-font-size="12" mp-original-line-height="NaN">https://github.com/mskcc/vcf2maf</span></section><section mp-original-font-size="17" mp-original-line-height="NaN"><strong mp-original-font-size="17" mp-original-line-height="NaN"><span mp-original-font-size="12" mp-original-line-height="NaN">gakt funcotator</span></strong><span mp-original-font-size="12" mp-original-line-height="NaN"> 程序</span></section><p mp-original-font-size="17" mp-original-line-height="NaN"><span mp-original-font-size="12" mp-original-line-height="NaN">https://gatk.broadinstitute.org/hc/en-us/articles/360035889931-Funcotator-Information-and-Tutorial</span></p><p mp-original-font-size="17" mp-original-line-height="NaN"><strong mp-original-font-size="17" mp-original-line-height="NaN"><span mp-original-font-size="12" mp-original-line-height="NaN">ANNOVAR</span></strong></p><p mp-original-font-size="17" mp-original-line-height="NaN"><span mp-original-font-size="12" mp-original-line-height="NaN">https://annovar.openbioinformatics.org/en/latest/</span></p><p mp-original-font-size="17" mp-original-line-height="NaN"><strong mp-original-font-size="17" mp-original-line-height="NaN"><span mp-original-font-size="12" mp-original-line-height="NaN">示例数据</span></strong><span mp-original-font-size="12" mp-original-line-height="NaN">：TCGA的 LAML 队列</span></p><section mp-original-font-size="17" mp-original-line-height="NaN"><span mp-original-font-size="12" mp-original-line-height="NaN">Cancer Genome Atlas Research, N. Genomic and epigenomic landscapes of adult de novo acute myeloid leukemia. N Engl J Med 368, 2059-74 (2013).</span></section><section><span><br></span></section><section><mp-common-profile data-pluginname="mpprofile" data-id="MzkxNjE4MDQ5Ng==" data-headimg="http://mmbiz.qpic.cn/sz_mmbiz_png/Zfs9OSHUB2aYXsKgPr1ulGicia002CmpicAbCMtZLC9tMjWX4ffq3B8rpmC23ibz2nk5ia9Xmpyk8VdcNNuTfqia9TicA/0?wx_fmt=png" data-nickname="聊生信" data-alias="Silico-BioTech" data-signature="基因组、外显组。人类遗传病。细菌、真菌及病毒基因组。由易汉博|易生信|生信宝典团队成员维护，记录知识、分享经验。更多其它组学内容，可关注《生信宝典》。" data-from="0" data-is_biz_ban="0"></mp-common-profile></section><p><mp-common-profile data-pluginname="mpprofile" data-id="MzI5MTcwNjA4NQ==" data-headimg="http://mmbiz.qpic.cn/mmbiz_png/BA8CWhHQWPwwDmzxJ7MNeOOaAE8rT3KOwtjunVpQgUl9vALmqUzUM8ia9ib1M58r0p2DNvG1kp0eoSh0e2IYgw0A/0?wx_fmt=png" data-nickname="生信宝典" data-alias="Bio_data" data-signature="学生信最好的时间是十年前，其次是现在！10年经验分享尽在生信宝典！" data-from="0" data-is_biz_ban="0"></mp-common-profile></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/zttX7tKl9uVPLtHrXqmRYg",target="_blank" rel="noopener noreferrer">原文链接</a>
