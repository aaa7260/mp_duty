---
title: "easylift 基因组坐标轻松转换"
date: 2023-12-13T12:58:11Z
draft: ["false"]
tags: [
  "fetched",
  "老俊俊的生信笔记"
]
categories: ["Acdemic"]
---
easylift 基因组坐标轻松转换 by 老俊俊的生信笔记
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><section><mp-common-profile data-pluginname="mpprofile" data-id="MzkyMTI1MTYxNA==" data-headimg="http://mmbiz.qpic.cn/mmbiz_png/G5jjcE4usey42oX5qyLTVibLRO9dz8ic5G4TpEHQc9rICYlpS4MHg6Et8cgXrQDqibvibXombicTro8t9cekJRlDBcw/0?wx_fmt=png" data-nickname="老俊俊的生信笔记" data-alias="JunJunLab" data-signature="老俊俊的生信技能和知识分享,我不是巨人,但你可以站在我的肩膀上更进一步!" data-from="0" data-is_biz_ban="0"></mp-common-profile></section><p><mpcps data-templateid="list" data-traceid="3d488af4-2799-4f11-b3ca-5ad11e471edd" data-goodssouce="1" data-pid="101_13893799" data-appuin="3921251614"></mpcps><span></span></p><h2 data-tool="mdnice编辑器"><span><span>1</span></span><span>引言</span><span></span></h2><blockquote data-tool="mdnice编辑器"><p>分享个 R 包 <strong>easylift</strong>, 对不同基因组坐标进行转换。</p></blockquote><h2 data-tool="mdnice编辑器"><span><span>2</span></span><span>安装</span><span></span></h2><pre data-tool="mdnice编辑器"><span></span><code><span>if</span> (!<span>require</span>(<span>"BiocManager"</span>, quietly = <span>TRUE</span>))<br>    install.packages(<span>"BiocManager"</span>)<br><br>BiocManager::install(<span>"easylift"</span>)<br></code></pre><h2 data-tool="mdnice编辑器"><span><span>3</span></span><span>使用</span><span></span></h2><p data-tool="mdnice编辑器">创建一个测试基因组坐标:</p><pre data-tool="mdnice编辑器"><span></span><code><span>library</span>(<span>"easylift"</span>)<br><br>gr &lt;- GRanges(<br>  seqname = Rle(<br>    c(<span>"chr1"</span>, <span>"chr2"</span>),<br>    c(<span>100000</span>, <span>100000</span>)<br>  ),<br>  ranges = IRanges(<br>    start = <span>1</span>, end = <span>200000</span><br>  )<br>)<br><span># Here, "hg19" is the source genome</span><br>genome(gr) &lt;- <span>"hg19"</span><br></code></pre><p data-tool="mdnice编辑器">读取转换间两个基因组坐标的 <strong>chain</strong> 文件,你也可以去 ucsc 下载:</p><pre data-tool="mdnice编辑器"><span></span><code><span># Here, we use the `system.file()` function because the chain file is in the</span><br><span># package (however if you need to point to any other file on your machine,</span><br><span># just do 'chain &lt;- "path/to/your/hg19ToHg38.over.chain.gz"'):</span><br>chain &lt;- system.file(<span>"extdata"</span>, <span>"hg19ToHg38.over.chain.gz"</span>, package = <span>"easylift"</span>)<br><br>gr<br><span>#&gt; GRanges object with 200000 ranges and 0 metadata columns:</span><br><span>#&gt;            seqnames    ranges strand</span><br><span>#&gt;               &lt;Rle&gt; &lt;IRanges&gt;  &lt;Rle&gt;</span><br><span>#&gt;        [1]     chr1  1-200000      *</span><br><span>#&gt;        [2]     chr1  1-200000      *</span><br><span>#&gt;        [3]     chr1  1-200000      *</span><br><span>#&gt;        [4]     chr1  1-200000      *</span><br><span>#&gt;        [5]     chr1  1-200000      *</span><br><span>#&gt;        ...      ...       ...    ...</span><br><span>#&gt;   [199996]     chr2  1-200000      *</span><br><span>#&gt;   [199997]     chr2  1-200000      *</span><br><span>#&gt;   [199998]     chr2  1-200000      *</span><br><span>#&gt;   [199999]     chr2  1-200000      *</span><br><span>#&gt;   [200000]     chr2  1-200000      *</span><br><span>#&gt;   -------</span><br><span>#&gt;   seqinfo: 2 sequences from hg19 genome; no seqlengths</span><br></code></pre><p data-tool="mdnice编辑器">转换:</p><pre data-tool="mdnice编辑器"><span></span><code><span># Here, "hg38" is the target genome</span><br>easylift(gr, <span>"hg38"</span>, chain)<br><span>#&gt; GRanges object with 300000 ranges and 0 metadata columns:</span><br><span>#&gt;            seqnames        ranges strand</span><br><span>#&gt;               &lt;Rle&gt;     &lt;IRanges&gt;  &lt;Rle&gt;</span><br><span>#&gt;        [1]     chr1  10001-177376      *</span><br><span>#&gt;        [2]    chr19 242824-242864      *</span><br><span>#&gt;        [3]     chr1  10001-177376      *</span><br><span>#&gt;        [4]    chr19 242824-242864      *</span><br><span>#&gt;        [5]     chr1  10001-177376      *</span><br><span>#&gt;        ...      ...           ...    ...</span><br><span>#&gt;   [299996]     chr2  10001-200000      *</span><br><span>#&gt;   [299997]     chr2  10001-200000      *</span><br><span>#&gt;   [299998]     chr2  10001-200000      *</span><br><span>#&gt;   [299999]     chr2  10001-200000      *</span><br><span>#&gt;   [300000]     chr2  10001-200000      *</span><br><span>#&gt;   -------</span><br><span>#&gt;   seqinfo: 25 sequences (1 circular) from hg38 genome</span><br></code></pre><hr data-tool="mdnice编辑器"><blockquote data-tool="mdnice编辑器"><p><strong>然后是送书,三个名额,依然是公众号分享次数前三的小朋友哦。</strong></p></blockquote><blockquote data-tool="mdnice编辑器"><p>【编辑推荐】<strong>从统计小白到领域精英，厘清思路，注重实战，解决问题！全面拆解临床预测模型知识体系真实案例一镜到底，助您充分掌握预测模型全流程不仅讲授方法，更注重经验总结，扫除疑难杂症</strong></p></blockquote><h2 data-tool="mdnice编辑器"><span><span>4</span></span><span>结尾</span><span></span></h2><blockquote data-tool="mdnice编辑器"><p><strong>路漫漫其修远兮,吾将上下而求索。</strong></p></blockquote><hr data-tool="mdnice编辑器"><p data-tool="mdnice编辑器">欢迎加入生信交流群。加我微信我也拉你进 <strong>微信群聊</strong> <strong>老俊俊生信交流群</strong> <strong>(微信交流群需收取 20 元入群费用,一旦交费,拒不退还!(防止骗子和便于管理))</strong> 。QQ 群可免费加入, 记得进群按格式修改备注哦。</p><section data-tool="mdnice编辑器"><section><p><strong>老俊俊微信：</strong></p><figure><img data-imgfileid="100028101" data-ratio="1" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usexf9oUFF57MOoTRPvXWkSwDsruLX7n8ibR8E2hZwn18wHWpwa276tq2iakD7e9icj1AWUBfRiaj6TXNbA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="430" src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usexf9oUFF57MOoTRPvXWkSwDsruLX7n8ibR8E2hZwn18wHWpwa276tq2iakD7e9icj1AWUBfRiaj6TXNbA/640?wx_fmt=png&amp;from=appmsg"></figure><figure><img data-imgfileid="100028099" data-ratio="1.3668430335097002" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usexf9oUFF57MOoTRPvXWkSwDxhGdlc5945S3zx1u1lCRgibibpFwJAPibfib8q1Hl6npjJUXrrm4yRdfgw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="567" src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usexf9oUFF57MOoTRPvXWkSwDxhGdlc5945S3zx1u1lCRgibibpFwJAPibfib8q1Hl6npjJUXrrm4yRdfgw/640?wx_fmt=png&amp;from=appmsg"></figure></section><section><p><strong>知识星球：</strong></p><figure><img data-imgfileid="100028100" data-ratio="1.5896226415094339" data-src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/G5jjcE4usexf9oUFF57MOoTRPvXWkSwD9AtBxiatW4lxML5uOutGINX0sCXiciaWjicUWZ1LIickxzeFD9VPl3lIqoQ/640?wx_fmt=jpeg&amp;from=appmsg" data-type="jpeg" data-w="1060" src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/G5jjcE4usexf9oUFF57MOoTRPvXWkSwD9AtBxiatW4lxML5uOutGINX0sCXiciaWjicUWZ1LIickxzeFD9VPl3lIqoQ/640?wx_fmt=jpeg&amp;from=appmsg"></figure></section></section><hr data-tool="mdnice编辑器"><p data-tool="mdnice编辑器"><br></p><center data-tool="mdnice编辑器"><strong> 往期回顾目录 </strong></center><p data-tool="mdnice编辑器"><br></p><blockquote data-tool="mdnice编辑器"><p><br></p><center><strong><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247511683&amp;idx=1&amp;sn=289992da1c3a551a4e5b8236fe830e94&amp;chksm=c18494f2f6f31de444ff98d314f7bfea97ade3573babe625200dd89b1cf86ccb47f287548e61&amp;token=1910483679&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">CCPlotR: 细胞通讯可视化包</a></strong></center><strong><center><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247511206&amp;idx=1&amp;sn=30806bab4936d81aa5b626b3d69d828d&amp;chksm=c18496d7f6f31fc1b8993ebf3b36a9d8a1a5db32181a0cb85297c48016f5debcfb296cf58aa3&amp;token=1910483679&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">geom_genomicNestedZoom 放大视图</a></center></strong><strong><center><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247511175&amp;idx=1&amp;sn=d88e495e3ecb62a29931bab3cb51d804&amp;chksm=c18496f6f6f31fe0b5d599fb2a8e0c6f001feb8d93ea214ce2ae1a5ea9bf59845739af520c04&amp;token=1304327956&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">听说你想给 pheatmap 添加感兴趣基因?</a></center></strong><strong><center><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247510846&amp;idx=1&amp;sn=9483f23b436903fd4d74034a64e99e79&amp;chksm=c184914ff6f31859d557c2665f1e09b088ef716c5037f3030f7a12d9cbcd144aa9dd257f08d2&amp;token=843968300&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">给 heatmap 添加显著性标记</a></center></strong><strong><center><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247510758&amp;idx=1&amp;sn=6a1d78131792e297d7be33aceb4711ba&amp;chksm=c1849097f6f3198159bbb4d66d4d1424d11da9ea07e896128573ebc63860aa2985e31ea5331d&amp;token=843968300&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">没有文档的 R 包不算好包</a></center></strong><strong><center><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247510747&amp;idx=1&amp;sn=464460e587caf23d74ae7dde559a55c6&amp;chksm=c18490aaf6f319bc66e40f855881ff946d4cc6b2076868ffc18cb699fd89d4126ea2c1e941b8&amp;token=1323965478&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">听说你想用 ggcirclize 绘制和弦图?</a></center></strong><strong><center><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247510718&amp;idx=1&amp;sn=fb687cfb1316cf04edf4efd1bd4b8fec&amp;chksm=c18490cff6f319d96545ab5a9641a0a027b94436859af9778b052580a7e788df9538b6a77dce&amp;token=1323965478&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">连接线的高度控制</a></center></strong><strong><center><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247510698&amp;idx=1&amp;sn=82441bbec35c1eb10d55f4a7a8b03aa2&amp;chksm=c18490dbf6f319cda3153f1050654875f70a9089153fcb74e8213f3bd2b9a1942fba9d819d1f&amp;token=815829873&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">ggcirclize 绘制标签和连接</a></center></strong><strong><center><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247510648&amp;idx=1&amp;sn=defd6928958897ee4e6231e06d12c451&amp;chksm=c1849009f6f3191fdb8c878cc767e8b68e2241009305a9d4492db26b55e23b11658f7eca6368&amp;token=815829873&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">试试就逝世 (ggcirclize)</a></center></strong><strong><center><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247510637&amp;idx=1&amp;sn=e9d02f505f0b69fc8735980a3aa59ca7&amp;chksm=c184901cf6f3190a5de6abaec2c4a353f68b9dff9a29bd453f7b71bb69ff209c4f79c7484f48&amp;token=1656012957&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">ggcirclize 绘制基因组数据初探</a></center></strong><p><br></p></blockquote></section><p><br></p><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/YYz-BdifIwQMZRh6soDQ9w",target="_blank" rel="noopener noreferrer">原文链接</a>
