---
title: "10x单细胞的3个文件如果仅仅是提供了mtx呢"
date: 2023-12-22T12:10:27Z
draft: ["false"]
tags: [
  "fetched",
  "生信菜鸟团"
]
categories: ["Acdemic"]
---
10x单细胞的3个文件如果仅仅是提供了mtx呢 by 生信菜鸟团
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><blockquote data-tool="mdnice编辑器"><p>众所周知10x单细胞会给出3个文件，我在单细胞数据分析的基础10讲写的很清楚：</p></blockquote><ul data-tool="mdnice编辑器"><li><section><a href="https://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247486076&amp;idx=1&amp;sn=52bb851d7dc23461233a2cf458736151&amp;scene=21#wechat_redirect" data-linktype="2">01. 上游分析流程</a></section></li><li><section><a href="https://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247486082&amp;idx=1&amp;sn=03cadceffb2c14ba95d97fe5caf38d94&amp;scene=21#wechat_redirect" data-linktype="2">02.课题多少个样品，测序数据量如何</a></section></li><li><section><a href="https://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247486088&amp;idx=1&amp;sn=3a115338ee4937d20caab78627237553&amp;scene=21#wechat_redirect" data-linktype="2">03. 过滤不合格细胞和基因（数据质控很重要）</a></section></li><li><section><a href="https://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247486096&amp;idx=1&amp;sn=1a99c4c5800b7e0287db3e8ef369fab8&amp;scene=21#wechat_redirect" data-linktype="2">04. 过滤线粒体核糖体基因</a></section></li><li><section><a href="https://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247486098&amp;idx=1&amp;sn=bf9a71df848d74fe665ce7d5e283d5ff&amp;scene=21#wechat_redirect" data-linktype="2">05. 去除细胞效应和基因效应</a></section></li><li><section><a href="https://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247486260&amp;idx=1&amp;sn=c6abf658de73594d1d77d8e1ffa7d153&amp;scene=21#wechat_redirect" data-linktype="2">06.单细胞转录组数据的降维聚类分群</a></section></li><li><section><a href="https://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247486271&amp;idx=1&amp;sn=638b434b6deee63206af1c0eeda175ab&amp;scene=21#wechat_redirect" data-linktype="2">07.单细胞转录组数据处理之细胞亚群注释</a></section></li><li><section><a href="https://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247486278&amp;idx=1&amp;sn=91250ef733833ff00371818b215dc124&amp;scene=21#wechat_redirect" data-linktype="2">08.把拿到的亚群进行更细致的分群</a></section></li><li><section><a href="https://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247486287&amp;idx=1&amp;sn=49627c638ff9c04418282c53518aa7c7&amp;scene=21#wechat_redirect" data-linktype="2">09.单细胞转录组数据处理之细胞亚群比例比较</a></section></li></ul><p data-tool="mdnice编辑器">如果是10x的单细胞公共数据，比如 GSE128033 和 GSE135893，就是10x数据集，随便下载其中一个，就能看到每个样本都是走流程拿到10x单细胞转录组数据的3个文件的表达矩阵。</p><pre data-tool="mdnice编辑器"><span></span><code>2.2M Mar  8  2019 GSM3660655_SC94IPFUP_barcodes.tsv.gz<br>259K Mar  8  2019 GSM3660655_SC94IPFUP_genes.tsv.gz<br> 26M Mar  8  2019 GSM3660655_SC94IPFUP_matrix.mtx.gz<br> <br>2.2M Mar  8  2019 GSM3660656_SC95IPFLOW_barcodes.tsv.gz<br>259K Mar  8  2019 GSM3660656_SC95IPFLOW_genes.tsv.gz<br> 31M Mar  8  2019 GSM3660656_SC95IPFLOW_matrix.mtx.gz<br> <br>2.2M Mar  8  2019 GSM3660657_SC153IPFLOW_barcodes.tsv.gz<br>259K Mar  8  2019 GSM3660657_SC153IPFLOW_genes.tsv.gz<br> 33M Mar  8  2019 GSM3660657_SC153IPFLOW_matrix.mtx.gz<br> <br>2.2M Mar  8  2019 GSM3660658_SC154IPFUP_barcodes.tsv.gz<br>259K Mar  8  2019 GSM3660658_SC154IPFUP_genes.tsv.gz<br> 31M Mar  8  2019 GSM3660658_SC154IPFUP_matrix.mtx.gz<br></code></pre><p data-tool="mdnice编辑器">每个10x样品，都是3个文件，规律很明显，下游处理的时候，一定要保证这3个文件同时存在，而且在同一个文件夹下面。</p><p data-tool="mdnice编辑器">示例代码是：</p><pre data-tool="mdnice编辑器"><span></span><code>rm(list=ls())<br>options(stringsAsFactors = F)<br>library(Seurat)<br>sce1 &lt;- CreateSeuratObject(Read10X(<span>'../10x-results/WT/'</span>),<br>                          <span>"wt"</span>)<br></code></pre><p data-tool="mdnice编辑器">重点就是 Read10X 函数读取 文件夹路径，比如：<strong>../10x-results/WT/</strong> ，保证文件夹下面有3个文件，而且文件名只能是 barcodes.tsv.gz 和 matrix.mtx.gz 以及 genes.tsv.gz，绝对是不能被混杂的 。</p><p data-tool="mdnice编辑器">但是并不是所有的文献在共享数据的时候都是那么标准，比如文章：https://science.sciencemag.org/content/suppl/2018/08/13/361.6402.594.DC1</p><p data-tool="mdnice编辑器">作者在附件，给出来的就是一个纯粹的 <strong>矩阵文件</strong>，后缀是 mtx，然后配合了两个tsv文件，并不是标准的10x的3个文件！</p><p data-tool="mdnice编辑器">A table of counts for all candidate droplets (i.e., the 125,139 unique barcodes at the top of Fig. S1). Stored in matrix mart format along with two extra tables describing the column labels (droplets) and row labels (genes). Counts represent number of unique UMIs for each gene/droplet pair (see Methods).</p><p><img data-galleryid="" data-ratio="0.2079207920792079" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/iaRJcrq2Losicp9UGPQ4edWcUTIImX9ya1VDxdNrbrmEEicUAsGy9icfCO5wD91IJRy0hBf1uY84MtushVm6jl9ILw/640?wx_fmt=jpeg" data-type="jpeg" data-w="404" src="https://mmbiz.qpic.cn/mmbiz_jpg/iaRJcrq2Losicp9UGPQ4edWcUTIImX9ya1VDxdNrbrmEEicUAsGy9icfCO5wD91IJRy0hBf1uY84MtushVm6jl9ILw/640?wx_fmt=jpeg"></p><figure data-tool="mdnice编辑器"><figcaption>下载数据压缩包</figcaption></figure><p data-tool="mdnice编辑器">然后需要解压：</p><p><img data-galleryid="" data-ratio="0.29277566539923955" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Losicp9UGPQ4edWcUTIImX9ya1wmUUtRkFu2TsdmBcvCxuAyJRCmShJ0rAibeypCPGSVZd1qt24phlJIw/640?wx_fmt=png" data-type="png" data-w="526" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Losicp9UGPQ4edWcUTIImX9ya1wmUUtRkFu2TsdmBcvCxuAyJRCmShJ0rAibeypCPGSVZd1qt24phlJIw/640?wx_fmt=png"></p><figure data-tool="mdnice编辑器"><figcaption>解压开</figcaption></figure><p data-tool="mdnice编辑器">然后进入直接读取：</p><pre data-tool="mdnice编辑器"><span></span><code><span>library</span>(Seurat)<br><span># https://hbctraining.github.io/scRNA-seq/lessons/readMM_loadData.html</span><br><span>library</span>(Matrix)<br>mtx=readMM(<span>'tableOfCounts.mtx'</span>)<br>mtx<br>dim(mtx)<br>cl=read.table(<span>'tableOfCounts_colLabels.tsv'</span>,<br>              header = <span>T</span>)[,<span>2</span>]<br>rl=read.table(<span>'tableOfCounts_rowLabels.tsv'</span>,<br>              header = <span>T</span>)[,<span>2</span>]<br>head(cl)<br>head(rl)<br>rownames(mtx) &lt;- rl<br>colnames(mtx) &lt;- cl<br>sce=CreateSeuratObject(counts = mtx)<br></code></pre><p data-tool="mdnice编辑器">可以看到样本名以及基因名字都还是蛮复杂的：</p><pre data-tool="mdnice编辑器"><span></span><code>&gt; head(cl)<br>[1] <span>"4602STDY7018923___AAACGGGGTCCAACTA"</span><br>[2] <span>"4602STDY7018923___AAAGATGAGGAGTACC"</span><br>[3] <span>"4602STDY7018923___AAAGATGGTGAACCTT"</span><br>[4] <span>"4602STDY7018923___AAAGTAGTCCCTTGTG"</span><br>[5] <span>"4602STDY7018923___AAATGCCCAGTAAGAT"</span><br>[6] <span>"4602STDY7018923___AACCATGCAGTCGTGC"</span><br>&gt; head(rl)<br>[1] <span>"RP11-34P13.3_ENSG00000243485"</span>  <span>"FAM138A_ENSG00000237613"</span>      <br>[3] <span>"OR4F5_ENSG00000186092"</span>         <span>"RP11-34P13.7_ENSG00000238009"</span> <br>[5] <span>"RP11-34P13.8_ENSG00000239945"</span>  <span>"RP11-34P13.14_ENSG00000239906"</span><br></code></pre><p data-tool="mdnice编辑器">后续可以慢慢修饰这个sce对象啦！也就是说 readMM 函数即可，然后配合CreateSeuratObject来构建对象！</p><p data-tool="mdnice编辑器">降维聚类分群和生物学注释都走起！不过，因为这个文章是早期单细胞，所以数据质量并不是太好，分析的过程可能会遇到意外：</p><p><img data-galleryid="" data-ratio="1.3392226148409894" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Losicp9UGPQ4edWcUTIImX9ya1IDicpcribsBLFnSCUj906WdlZ2rO7ssDzD74IEEKHZT6a6VJOeYGgvVw/640?wx_fmt=png" data-type="png" data-w="566" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Losicp9UGPQ4edWcUTIImX9ya1IDicpcribsBLFnSCUj906WdlZ2rO7ssDzD74IEEKHZT6a6VJOeYGgvVw/640?wx_fmt=png"></p><figure data-tool="mdnice编辑器"><figcaption>降维聚类分群和生物学注释</figcaption></figure><p data-tool="mdnice编辑器">当然了，如果你是10x的fastq文件，需要10X单细胞转录组数据的<strong>cellranger结果文件</strong>，我们也是在<strong>单细胞天地公众号</strong>详细介绍了<strong>cellranger</strong>全部使用细节及流程，大家可以自行前往学习，如下：</p><ul data-tool="mdnice编辑器"><li><section><a href="https://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247484146&amp;idx=1&amp;sn=16e09b82d048eed1ff6100b22970abd5&amp;scene=21#wechat_redirect" data-linktype="2">单细胞实战(一)数据下载</a></section></li><li><section><a href="https://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247484179&amp;idx=1&amp;sn=fe84f5243a6021fe6afea128e3ac273a&amp;scene=21#wechat_redirect" data-linktype="2">单细胞实战(二) cell ranger使用前注意事项</a></section></li><li><section><a href="https://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247484206&amp;idx=1&amp;sn=edeebbdd092f79361aee87e9ce086d80&amp;scene=21#wechat_redirect" data-linktype="2">单细胞实战(三) Cell Ranger使用初探</a></section></li><li><section><a href="https://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247484355&amp;idx=1&amp;sn=7860fe0c46073a55d2d3700822c3103b&amp;scene=21#wechat_redirect" data-linktype="2">单细胞实战(四) Cell Ranger流程概览</a></section></li><li><section><a href="https://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247484402&amp;idx=1&amp;sn=95c2be0dc6499e4b1eb9a91d79e584d1&amp;scene=21#wechat_redirect" data-linktype="2">单细胞实战(五) 理解cellranger count的结果</a></section></li><li><section>更新版本见：<a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247495226&amp;idx=1&amp;sn=baff3b7bcf2091a2a658c046dce421cd&amp;scene=21#wechat_redirect" data-linktype="2">cellranger更新到4啦（全新使用教程）</a></section></li></ul><p data-tool="mdnice编辑器">因为这个cellranger上游数据分析流程对服务器要求比较高，而且10x的原始测序fastq文件也是接近100G文件，运行过程对技术资源消耗比较大。</p></section><h3 data-tool="mdnice编辑器">文末友情推荐</h3><ul><li><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247502116&amp;idx=1&amp;sn=e9d07246245ebcc0839ab00821fee25d&amp;chksm=9b4b899fac3c0089b0c2ddb6ddb03518477fe8ba570fce13738d2b13e4881d4c0d97779a837f&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1">明码标价之10X技术单细胞（2.5万每个）（标准100G测序数据）</a></p></li><li><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247502292&amp;idx=1&amp;sn=32fd8f5bd66f3b56d09c7f2350d6af83&amp;chksm=9b4b896fac3c0079fd93b8ccfd63f6c89b46088046fb02ac5be4d2ff841e654a4e01564ac95f&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2">数据挖掘线下重启(长沙站)(周六日，5月22-23)</a></p><p><br></p></li></ul></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/A_zgS9jBwWfCSfGnBLhLEQ",target="_blank" rel="noopener noreferrer">原文链接</a>
