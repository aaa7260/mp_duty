---
title: "简单绘制一个3D效果的饼图吧"
date: 2023-12-28T02:10:43Z
draft: ["false"]
tags: [
  "fetched",
  "生信技能树"
]
categories: ["Acdemic"]
---
简单绘制一个3D效果的饼图吧 by 生信技能树
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><blockquote data-tool="mdnice编辑器"><p>我们来演示一下使用<code>plotrix</code>、<code>dplyr</code>和<code>ggsci</code>等库来生成一个3D饼图，<code>plotrix</code>提供了<code>pie3D</code>函数，<code>dplyr</code>用于数据处理，<code>ggsci</code>提供了调色板<code>pal_jama</code>。</p></blockquote><p data-tool="mdnice编辑器">首先是安装和加载这些包，代码如下所示：</p><pre data-tool="mdnice编辑器"><span></span><code><span>#BiocManager::install(c("plotrix","dplyr"))</span><br>library(plotrix)<br>library(dplyr)<br>library(ggsci)<br></code></pre><p data-tool="mdnice编辑器">然后我们创作一个示例数据：</p><pre data-tool="mdnice编辑器"><span></span><code>df=data.frame(<br>  sample=LETTERS[1:4],<br>  counts=1:4,<br>  color=pal_jama(<span>"default"</span>)(4),<br>  percent =  1:4/sum(1:4)<br>)<br>df<br></code></pre><p data-tool="mdnice编辑器">可以看到是非常简单的：</p><pre data-tool="mdnice编辑器"><span></span><code>&gt; df<br>  sample counts     color percent<br>1      A      1 <span>#374E55FF     0.1</span><br>2      B      2 <span>#DF8F44FF     0.2</span><br>3      C      3 <span>#00A1D5FF     0.3</span><br>4      D      4 <span>#B24745FF     0.4</span><br></code></pre><p data-tool="mdnice编辑器">接下来就针对这个示例数据进行绘图，代码如下所示：</p><pre data-tool="mdnice编辑器"><span></span><code>pie3D(<br>  df$counts ,        <span># 向量，包含每个扇形的大小</span><br>  labels =  df$percent,   <span># 向量，包含每个扇形的标签 </span><br>  border = <span>"white"</span>,        <span># 字符串，表示饼图边界线的颜色</span><br>  edges = <span>1000</span>,            <span># 整数，表示饼图的平滑度，边缘的线段数</span><br>  radius = <span>2</span>,              <span># 数值，表示饼图的半径</span><br>  height = <span>0.25</span>,           <span># 数值，表示饼图的高度</span><br>  theta = pi/<span>5</span>,            <span># 数值，表示透视角度</span><br>  start = pi/<span>3</span>,            <span># 数值，表示饼图的起始角度</span><br>  col = df$color,             <span># 向量，表示每个扇形的填充颜色</span><br>  labelcol = <span>"black"</span>,      <span># 字符串，表示标签文本的颜色</span><br>  labelcex = <span>1.2</span>,          <span># 数值，表示标签文本的字符大小倍数</span><br>  explode = <span>0.1</span>,           <span># 数值，表示每个扇形的偏移量，模拟3D效果</span><br>  shade = <span>0.75</span>             <span># 数值，表示饼图的阴影强度</span><br>)                     <br></code></pre><p><img data-galleryid="" data-imgfileid="100043495" data-ratio="0.5694444444444444" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wyGYbaoD2dGQbYsVMBeR3hqUZ6xuRaSV5h0IiaywCEdNVZe3lQnLlDG39fgsJibYvtGyz4ialC9Sqfsg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wyGYbaoD2dGQbYsVMBeR3hqUZ6xuRaSV5h0IiaywCEdNVZe3lQnLlDG39fgsJibYvtGyz4ialC9Sqfsg/640?wx_fmt=png&amp;from=appmsg"></p><figure data-tool="mdnice编辑器"><figcaption> </figcaption></figure><p data-tool="mdnice编辑器">可以看到，上面的案例充分说明了饼图在一些情况下可能不太适用，因为它在传达数据信息和比较各部分大小方面存在一些问题。很难直观地感受到到1,2,3,4的饼的大小比例的变化</p><p data-tool="mdnice编辑器">一些人认为饼图不容易准确地传达数据，尤其是当有多个部分时。以下是一些关于饼图的常见批评：</p><ol data-tool="mdnice编辑器"><li><section><strong>难以比较部分大小：</strong> 人类视觉难以精确比较不同角度的扇形大小，尤其是在有多个部分的情况下。</section></li><li><section><strong>限制部分数量：</strong> 饼图通常适用于表示少量部分的情况。当有很多部分时，饼图可能变得混乱难读。</section></li></ol><p data-tool="mdnice编辑器">如果你想改进可视化方案，以下是一些建议：</p><ol data-tool="mdnice编辑器"><li><section><strong>使用条形图：</strong> 条形图是更直观和易于比较的一种方式。你可以考虑使用条形图代替饼图。</section></li><li><section><strong>避免3D效果：</strong> 3D效果可能会使图表更难以理解，尤其是在表示比例时。尽量使用简单的2D图表。</section></li><li><section><strong>添加标签或数据表格：</strong> 在图表上添加数值标签或提供数据表格，以便更清晰地呈现数据。</section></li><li><section><strong>使用更直观的颜色：</strong> 考虑使用更易于区分的颜色，避免引起混淆。</section></li><li><section><strong>考虑使用其他图表类型：</strong> 根据数据的特点，考虑使用更适合的图表类型，如堆积条形图或直方图等。</section></li></ol><p data-tool="mdnice编辑器">比如我们条形图一下上面的饼图同样的数据看看：</p><pre data-tool="mdnice编辑器"><span></span><code><span># 绘制条形图</span><br>barplot(<br>  df<span>$counts</span>,<br>  names.arg = df<span>$sample</span>,<br>  col = df<span>$color</span>,<br>  border = <span>"white"</span>,<br>  main = <span>"Bar Plot"</span>,<br>  xlab = <span>"Sample"</span>,<br>  ylab = <span>"Counts"</span><br>)<br></code></pre><p><img data-galleryid="" data-imgfileid="100043496" data-ratio="0.9071146245059288" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wyGYbaoD2dGQbYsVMBeR3hqS1yoMSQ3WiczdI3eAP8XqiaJ75PVNZlsfRY0uvyCFVuHiaEJl610FhrrQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1012" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wyGYbaoD2dGQbYsVMBeR3hqS1yoMSQ3WiczdI3eAP8XqiaJ75PVNZlsfRY0uvyCFVuHiaEJl610FhrrQ/640?wx_fmt=png&amp;from=appmsg"></p><figure data-tool="mdnice编辑器"><figcaption> </figcaption></figure><p data-tool="mdnice编辑器">是不是比上面的饼图更清晰呢？</p><h3 data-tool="mdnice编辑器"><span></span>使用Python编程语言做同样的可视化<span></span></h3><p data-tool="mdnice编辑器">首先是创建示例数据：</p><p data-tool="mdnice编辑器">使用 <code>pandas</code> 库创建数据框（DataFrame）。以下是使用 <code>pandas</code> 创建与你之前提到的 <code>df</code> 数据框相似的代码：</p><pre data-tool="mdnice编辑器"><span></span><code><span>import</span> pandas <span>as</span> pd<br><br><span># 数据</span><br>data = {<br>    <span>'sample'</span>: [<span>'A'</span>, <span>'B'</span>, <span>'C'</span>, <span>'D'</span>],<br>    <span>'counts'</span>: [<span>1</span>, <span>2</span>, <span>3</span>, <span>4</span>],<br>    <span>'color'</span>: [<span>'red'</span>, <span>'green'</span>, <span>'blue'</span>, <span>'orange'</span>],<br>    <span>'percent'</span>: [<span>0.1</span>, <span>0.2</span>, <span>0.3</span>, <span>0.4</span>]<br>}<br><br><span># 创建数据框</span><br>df = pd.DataFrame(data)<br><br><span># 显示数据框</span><br>print(df)<br></code></pre><p data-tool="mdnice编辑器">这样，你就创建了一个名为 <code>df</code> 的数据框，其中包含了 <code>sample</code>、<code>counts</code>、<code>color</code> 和 <code>percent</code> 这几列数据。</p><p data-tool="mdnice编辑器">在 Python 中使用 <code>matplotlib</code> 库绘制饼图和条形图的简单示例。请确保你已经安装了 <code>matplotlib</code> 库，如果没有，可以通过运行 <code>pip install matplotlib</code> 安装。</p><h3 data-tool="mdnice编辑器"><span></span>饼图示例：<span></span></h3><pre data-tool="mdnice编辑器"><span></span><code><span>import</span> matplotlib.pyplot <span>as</span> plt<br><br><span># 数据</span><br>labels = df[<span>'sample'</span>]<br>sizes = df[<span>'counts'</span>]<br>colors = df[<span>'color'</span>]<br>explode = (<span>0.1</span>, <span>0</span>, <span>0</span>, <span>0</span>)  <span># 突出显示第一个扇形</span><br><br><span># 绘制饼图</span><br>plt.pie(sizes, explode=explode, labels=labels, colors=colors, autopct=<span>'%1.1f%%'</span>, startangle=<span>140</span>)<br>plt.axis(<span>'equal'</span>)  <span># 保持饼图为正圆形</span><br>plt.title(<span>'Pie Chart'</span>)<br>plt.show()<br></code></pre><h3 data-tool="mdnice编辑器"><span></span>条形图示例：<span></span></h3><pre data-tool="mdnice编辑器"><span></span><code><span>import</span> matplotlib.pyplot <span>as</span> plt<br><br><span># 数据</span><br>samples = df[<span>'sample'</span>]<br>counts = df[<span>'counts'</span>]<br>colors = df[<span>'color'</span>]<br><br><span># 绘制条形图</span><br>plt.bar(samples, counts, color=colors)<br>plt.xlabel(<span>'Sample'</span>)<br>plt.ylabel(<span>'Counts'</span>)<br>plt.title(<span>'Bar Chart'</span>)<br>plt.show()<br></code></pre><p data-tool="mdnice编辑器">这些代码演示了如何使用 <code>matplotlib</code> 库创建简单的饼图和条形图，你可以根据实际需求修改图表的样式、颜色、标签等。如下所示，Python也可以很快出图：</p><p><img data-galleryid="" data-imgfileid="100043494" data-ratio="0.46944444444444444" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wyGYbaoD2dGQbYsVMBeR3hq0O9j1bqQkhicOvOSf5DEcqbH6wpchygQbubtJ6U2nSpPf6EN0YVD0lw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wyGYbaoD2dGQbYsVMBeR3hq0O9j1bqQkhicOvOSf5DEcqbH6wpchygQbubtJ6U2nSpPf6EN0YVD0lw/640?wx_fmt=png&amp;from=appmsg"></p><figure data-tool="mdnice编辑器"><figcaption>Python也可以很快出图</figcaption></figure></section><p><br></p><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/R_gIRlTe98K1GjIfBIdcNg",target="_blank" rel="noopener noreferrer">原文链接</a>
