---
title: "R包BioEnricher：一键式富集分析和可视化"
date: 2023-12-14T00:35:57Z
draft: ["false"]
tags: [
  "fetched",
  "生信菜鸟团"
]
categories: ["Acdemic"]
---
R包BioEnricher：一键式富集分析和可视化 by 生信菜鸟团
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><blockquote data-tool="mdnice编辑器"><p><code>BioEnricher</code>包是我的好朋友【医学僧公众号】的博主花了很大功夫写的一个R包，现在无偿的分享给大家~</p></blockquote><p data-tool="mdnice编辑器"><code>BioEnricher</code>的关键在于解决两个问题：</p><ul data-tool="mdnice编辑器"><li><section>首先，<code>BioEnricher</code>提供了富集分析的无缝集成，涵盖了各种富集分析基因集数据库，如GO、KEGG、WikiPathways、Reactome、MsigDB、Disease Ontology、Cancer Gene Network、DisGeNET、CellMarker和CMAP（药物）；</section></li><li><section>其次，<code>BioEnricher</code>提供了各种高级的可视化功能<strong>（颜值都很高，发表级的可视化方案）</strong>，简化了数据呈现的过程，使其更快速、更便捷。</section></li></ul><p data-tool="mdnice编辑器"><code>BioEnricher</code>的GitHub在https://github.com/Zaoqu-Liu/BioEnricher，记得去官方github给作者点点小星星，支持一波~</p><p data-tool="mdnice编辑器"><strong>目前R包安装暂不支持</strong><span><strong><span>install_github</span></strong></span><strong>：</strong></p><pre data-tool="mdnice编辑器"><span></span><code>devtools::install_github(<span>"Zaoqu-Liu/BioEnricher"</span>)<br></code></pre><p data-tool="mdnice编辑器">可以自行下载<code>BioEnricher_0.1.0.zip</code>文件，然后使用本地安装的方式进行安装：</p><figure data-tool="mdnice编辑器"><img data-imgfileid="100034601" data-ratio="0.3052164261931188" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/iaRJcrq2Losibch21GJ0s8F4DhHia4RhtgjiceKf5UiaoWRP1jFGMclhhbXWvIF5ytfyQYILOVx4Y1uOqxbJI6eBExg/640?wx_fmt=other&amp;from=appmsg" data-type="other" data-w="901" src="https://mmbiz.qpic.cn/mmbiz_jpg/iaRJcrq2Losibch21GJ0s8F4DhHia4RhtgjiceKf5UiaoWRP1jFGMclhhbXWvIF5ytfyQYILOVx4Y1uOqxbJI6eBExg/640?wx_fmt=other&amp;from=appmsg"><figcaption>https://github.com/Zaoqu-Liu/BioEnricher/tree/master</figcaption></figure><pre data-tool="mdnice编辑器"><span></span><code>install.packages(<span>"~/BioEnricher/BioEnricher-master/BioEnricher_0.1.0.zip"</span>, repos = <span>NULL</span>, type = <span>"win.binary"</span>)<br></code></pre><h2 data-tool="mdnice编辑器"><span></span><span></span><span>示例数据实战</span><span></span><span></span></h2><h3 data-tool="mdnice编辑器">Step1. 获取基因列表</h3><p data-tool="mdnice编辑器">经常做富集分析的小伙伴都知道，富集分析一般有两种形式：</p><ul data-tool="mdnice编辑器"><li><section>ORA富集分析，也就是基于差异基因（或者其他形式，例如WGCNA，NMF等）的富集分析，需要我们有一个感兴趣的基因列表，列表里的基因无需排序；</section></li><li><section>GSEA富集分析，也就是基于Rank排序的富集分析，需要我们事先按照某种排序标准对基因列表进行排序，例如进行差异表达分析得到的所有的基因，按照LogFoldChange对基因进行排序。</section></li></ul><p data-tool="mdnice编辑器">这里我们加载<code>BioEnricher</code>包提供的示例数据进行差异分析，得到差异基因列表，为后续的富集分析实战做准备：</p><pre data-tool="mdnice编辑器"><span></span><code><span>library</span>(airway)<br><span>library</span>(DESeq2)<br><span>library</span>(tidyverse)<br><span>library</span>(clusterProfiler)<br><span>library</span>(org.Hs.eg.db)<br><span>library</span>(BioEnricher)<br>data(airway)<br>se &lt;- airway<br>se$dex &lt;- relevel(se$dex, <span>"untrt"</span>) <br>res &lt;- DESeqDataSet(se, design = ~ cell + dex)%&gt;%<br>  estimateSizeFactors()%&gt;%DESeq()%&gt;%<br>  results()%&gt;%as.data.frame()%&gt;%na.omit()<br>ann &lt;- bitr(rownames(res),<span>'ENSEMBL'</span>,<span>'SYMBOL'</span>,org.Hs.eg.db)<br>res &lt;- merge(ann,res,by.x=<span>1</span>,by.y=<span>0</span>)%&gt;%distinct(SYMBOL,.keep_all = <span>T</span>) <span># Very crude, just as an example</span><br></code></pre><p data-tool="mdnice编辑器">res对象是一个标准的DESeq2差异分析的输出结果，包含所有的基因：</p><pre data-tool="mdnice编辑器"><span></span><code>head(res)<br><span>#           ENSEMBL   SYMBOL   baseMean log2FoldChange      lfcSE       stat       pvalue         padj</span><br><span># 1 ENSG00000000003   TSPAN6  708.60217    -0.38125389 0.10065443 -3.7877507 1.520173e-04 1.283638e-03</span><br><span># 2 ENSG00000000419     DPM1  520.29790     0.20681272 0.11221867  1.8429438 6.533721e-02 1.965458e-01</span><br><span># 3 ENSG00000000457    SCYL3  237.16304     0.03792059 0.14344472  0.2643568 7.915050e-01 9.114580e-01</span><br><span># 4 ENSG00000000460 C1orf112   57.93263    -0.08816770 0.28714200 -0.3070526 7.588033e-01 8.950344e-01</span><br><span># 5 ENSG00000000971      CFH 5817.35287     0.42640222 0.08831338  4.8282857 1.377134e-06 1.821495e-05</span><br><span># 6 ENSG00000001036    FUCA2 1282.10639    -0.24107114 0.08872064 -2.7171933 6.583813e-03 3.277906e-02</span><br></code></pre><ul data-tool="mdnice编辑器"><li><section><strong>1.1 设置cutoff，获取上下调的DEGs，用于ORA富集分析：</strong></section></li></ul><pre data-tool="mdnice编辑器"><span></span><code><span># Define an up-regulated gene list</span><br>up.genes &lt;- res$SYMBOL[res$log2FoldChange &gt; <span>2</span> &amp; res$padj &lt; <span>0.05</span>]<br><br><span># Define a down-regulated gene list</span><br>down.genes &lt;- res$SYMBOL[res$log2FoldChange &lt; -<span>2</span> &amp; res$padj &lt; <span>0.05</span>]<br></code></pre><p data-tool="mdnice编辑器">根据这个cutoff进行截断获得数量不等的上调或下调基因：</p><pre data-tool="mdnice编辑器"><span></span><code>length(up.genes)<br><span># [1] 128</span><br>length(down.genes)<br><span># [1] 107</span><br></code></pre><ul data-tool="mdnice编辑器"><li><section><strong>1.2 如果用户需要就行GSEA富集分析的话，需要对差异基因列表进行排序，进行如下操作即可：</strong></section></li></ul><pre data-tool="mdnice编辑器"><span></span><code><span># Obtain an order ranked geneList.</span><br>grlist &lt;- res$log2FoldChange<br>names(grlist) &lt;- res$SYMBOL<br>grlist &lt;- sort(grlist,decreasing = <span>T</span>)<br></code></pre><p data-tool="mdnice编辑器">grlist是一个按照log2FoldChange排序的基因/log2FoldChange字符串：</p><pre data-tool="mdnice编辑器"><span></span><code>head(grlist)<br><span># ALOX15B       ZBTB16       GUCY2D       STEAP4 LOC101928858      ANGPTL7 </span><br><span># 9.505972     7.352628     5.885112     5.207160     5.098107     5.081572 </span><br></code></pre><ul data-tool="mdnice编辑器"><li><section><strong>1.3 <code>BioEnricher</code>纳入了11种基因富集数据库，除了常用的GO，KEGG，Reactome以外，还有：</strong></section></li></ul><pre data-tool="mdnice编辑器"><span></span><code>listEnrichMethod()<br><span># "GO", "KEGG", "MKEGG", "WikiPathways", "Reactome", "MsigDB", "DO", "CGN", "DisGeNET", "CellMarker", "CMAP"</span><br></code></pre><h3 data-tool="mdnice编辑器">Step2. ORA富集分析</h3><h4 data-tool="mdnice编辑器">2.1 函数<code>lzq_ORA</code></h4><p data-tool="mdnice编辑器">函数<code>lzq_ORA</code>将执行基因集富集分析，用户可以指定<code>enrich.type</code>参数使用其中一种基因富集数据库运行，例如KEGG富集分析：</p><pre data-tool="mdnice编辑器"><span></span><code><span># Set enrich.type using an enrichment analysis method mentioned above.</span><br>kegg &lt;- lzq_ORA(<br>  genes = up.genes,<br>  enrich.type = <span>'KEGG'</span><br>)<br></code></pre><p data-tool="mdnice编辑器">KEGG富集分析可以使用<code>pathview</code>R包进行可视化</p><pre data-tool="mdnice编辑器"><span></span><code>res2 &lt;- res[res$log2FoldChange &gt; <span>0</span> &amp; res$padj &lt; <span>0.05</span>,c(<span>2</span>,<span>4</span>)]<br>res2 &lt;- data.frame(row.names = res2$SYMBOL,R=res2$log2FoldChange)<br><br>lzq_KEGGview(gene.data = res2,pathway.id = <span>'hsa04218'</span>)<br></code></pre><img data-imgfileid="100034604" data-ratio="0.5944444444444444" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/iaRJcrq2Losibch21GJ0s8F4DhHia4RhtgjUy0mEN8tr9sAOaduDv9AzaiabESEP3abcaKqFQZ0C9tiaxvN2qOSFZFw/640?wx_fmt=other&amp;from=appmsg" data-type="other" data-w="1080" width="100%" src="https://mmbiz.qpic.cn/mmbiz_jpg/iaRJcrq2Losibch21GJ0s8F4DhHia4RhtgjUy0mEN8tr9sAOaduDv9AzaiabESEP3abcaKqFQZ0C9tiaxvN2qOSFZFw/640?wx_fmt=other&amp;from=appmsg"><h4 data-tool="mdnice编辑器">2.2 函数<code>lzq_ORA.integrated</code></h4><p data-tool="mdnice编辑器">用户可以使用<code>lzq_ORA.integrated</code>进行多种数据库的批量分析：</p><p data-tool="mdnice编辑器">例如对<strong>上调的基因</strong>进行富集分析：</p><pre data-tool="mdnice编辑器"><span></span><code><span># Integrative enrichment analysis of the up-regulated gene list</span><br>up.enrich &lt;- lzq_ORA.integrated(<br>  genes = up.genes,<br>  background.genes = <span>NULL</span>,<br>  GO.ont = <span>'ALL'</span>,<br>  perform.WikiPathways = <span>T</span>,<br>  perform.Reactome = <span>T</span>,<br>  perform.MsigDB = <span>T</span>,<br>  MsigDB.category = <span>'ALL'</span>,<br>  perform.Cancer.Gene.Network = <span>T</span>,<br>  perform.disease.ontoloty = <span>T</span>,<br>  perform.DisGeNET = <span>T</span>,<br>  perform.CellMarker = <span>T</span>,<br>  perform.CMAP = <span>T</span>,<br>  min.Geneset.Size = <span>3</span><br>)<br><span>### This function will output its calculation process.</span><br><span># +++ Updating gene symbols...</span><br><span># Maps last updated on: Thu Oct 24 12:31:05 2019</span><br><span># +++ Transforming SYMBOL to ENTREZID...</span><br><span># 'select()' returned 1:1 mapping between keys and columns</span><br><span># +++ Performing GO-ALL enrichment...</span><br><span># +++ Symplifying GO results...</span><br><span># +++ Performing KEGG enrichment...</span><br><span># +++ Performing Module KEGG enrichment...</span><br><span># +++ Performing WikiPathways enrichment...</span><br><span># +++ Performing Reactome pathways enrichment...</span><br><span># +++ Performing Disease Ontoloty enrichment...</span><br><span># +++ Performing Cancer Gene Network enrichment...</span><br><span># +++ Performing DisGeNET enrichment...</span><br><span># +++ Performing CellMarker enrichment...</span><br><span># +++ Performing MsigDB-ALL enrichment...         </span><br><span># +++ Performing CMAP enrichment...</span><br><span># +++ 1826 significant terms were detected...</span><br><span># +++ Done!</span><br></code></pre><p data-tool="mdnice编辑器">对<strong>下调的基因</strong>进行富集分析：</p><pre data-tool="mdnice编辑器"><span></span><code><span># Integrative enrichment analysis of the down-regulated gene list</span><br>down.enrich &lt;- lzq_ORA.integrated(<br>  genes = down.genes,<br>  background.genes = <span>NULL</span>,<br>  GO.ont = <span>'ALL'</span>,<br>  perform.WikiPathways = <span>T</span>,<br>  perform.Reactome = <span>T</span>,<br>  perform.MsigDB = <span>T</span>,<br>  MsigDB.category = <span>'ALL'</span>,<br>  perform.Cancer.Gene.Network = <span>T</span>,<br>  perform.disease.ontoloty = <span>T</span>,<br>  perform.DisGeNET = <span>T</span>,<br>  perform.CellMarker = <span>T</span>,<br>  perform.CMAP = <span>T</span>,<br>  min.Geneset.Size = <span>3</span><br>)<br><span># +++ Updating gene symbols...</span><br><span># Maps last updated on: Thu Oct 24 12:31:05 2019</span><br><span># +++ Transforming SYMBOL to ENTREZID...</span><br><span># 'select()' returned 1:1 mapping between keys and columns</span><br><span># +++ Performing GO-ALL enrichment...</span><br><span># +++ Symplifying GO results...</span><br><span># +++ Performing KEGG enrichment...</span><br><span># +++ Performing Module KEGG enrichment...</span><br><span># +++ Performing WikiPathways enrichment...</span><br><span># +++ Performing Reactome pathways enrichment...</span><br><span># +++ Performing Disease Ontoloty enrichment...</span><br><span># +++ Performing Cancer Gene Network enrichment...</span><br><span># +++ Performing DisGeNET enrichment...</span><br><span># +++ Performing CellMarker enrichment...</span><br><span># +++ Performing MsigDB-ALL enrichment...                       </span><br><span># +++ Performing CMAP enrichment...</span><br><span># +++ 1418 significant terms were detected...</span><br><span># +++ Done!</span><br></code></pre><p data-tool="mdnice编辑器">生成的富集分析结果是一个list列表：</p><pre data-tool="mdnice编辑器"><span></span><code>names(up.enrich)<br><span># [1] "GO"                    "simplyGO"              "KEGG"                  "Module.KEGG"           "WikiPathways"         </span><br><span># [6] "Reactome"              "DiseaseOntology"       "CancerGeneNetwork"     "DisGeNET"              "CellMarker.Enrichment"</span><br><span># [11] "MsigDB.ALL"            "CMAP"</span><br></code></pre><h4 data-tool="mdnice编辑器">2.3 可视化</h4><p data-tool="mdnice编辑器"><code>BioEnricher</code>内置了很多高颜值的可视化方案：</p><p data-tool="mdnice编辑器"><strong>barplot</strong></p><pre data-tool="mdnice编辑器"><span></span><code>lzq_ORA.barplot1(enrich.obj = up.enrich$simplyGO)<br></code></pre><img data-imgfileid="100034602" data-ratio="0.6003787878787878" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/iaRJcrq2Losibch21GJ0s8F4DhHia4RhtgjwwLH6ghmkd3KdBpLIOWyZn6tsI9cSvKib0ENibN7XqVRjca9F7ddxvKg/640?wx_fmt=other&amp;from=appmsg" data-type="other" data-w="1056" width="60%" src="https://mmbiz.qpic.cn/mmbiz_jpg/iaRJcrq2Losibch21GJ0s8F4DhHia4RhtgjwwLH6ghmkd3KdBpLIOWyZn6tsI9cSvKib0ENibN7XqVRjca9F7ddxvKg/640?wx_fmt=other&amp;from=appmsg"><p data-tool="mdnice编辑器"><strong>dotplot</strong></p><pre data-tool="mdnice编辑器"><span></span><code>lzq_ORA.dotplot1(enrich.obj = up.enrich$simplyGO)<br></code></pre><img data-imgfileid="100034600" data-ratio="0.5977229601518027" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/iaRJcrq2Losibch21GJ0s8F4DhHia4RhtgjUQXiciaVQQKtOxkjJ9BkqpyibJURqsQGDrVNWbeo79x9qswzVpxzKSsog/640?wx_fmt=other&amp;from=appmsg" data-type="other" data-w="1054" width="60%" src="https://mmbiz.qpic.cn/mmbiz_jpg/iaRJcrq2Losibch21GJ0s8F4DhHia4RhtgjUQXiciaVQQKtOxkjJ9BkqpyibJURqsQGDrVNWbeo79x9qswzVpxzKSsog/640?wx_fmt=other&amp;from=appmsg"><p data-tool="mdnice编辑器"><strong>结合上调和下调的通路进行可视化：</strong></p><pre data-tool="mdnice编辑器"><span></span><code>lzq_ORA.barplot2(<br>  enrich.obj1 = up.enrich$simplyGO,<br>  enrich.obj2 = down.enrich$simplyGO,<br>  obj.types = c(<span>'Up'</span>,<span>'Down'</span>)<br>)<br></code></pre><img data-imgfileid="100034603" data-ratio="0.7574074074074074" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/iaRJcrq2Losibch21GJ0s8F4DhHia4RhtgjpXt36Bmj6II2CKpNRY9CJQLkfYibSGNsK9xOCjERtoNSyb7NGIXHGLg/640?wx_fmt=other&amp;from=appmsg" data-type="other" data-w="1080" width="60%" src="https://mmbiz.qpic.cn/mmbiz_jpg/iaRJcrq2Losibch21GJ0s8F4DhHia4RhtgjpXt36Bmj6II2CKpNRY9CJQLkfYibSGNsK9xOCjERtoNSyb7NGIXHGLg/640?wx_fmt=other&amp;from=appmsg"><p data-tool="mdnice编辑器">指定<code>use.Chinese = T</code>支持中文模式：</p><p data-tool="mdnice编辑器"><strong>Note: use.Chinese exists all the plot functions.</strong></p><pre data-tool="mdnice编辑器"><span></span><code>lzq_ORA.barplot2(<br>  enrich.obj1 = up.enrich$simplyGO,<br>  enrich.obj2 = down.enrich$simplyGO,<br>  obj.types = c(<span>'Up'</span>,<span>'Down'</span>),<br>  use.Chinese = <span>T</span><br>)<br></code></pre><img data-imgfileid="100034608" data-ratio="1.5308641975308641" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/iaRJcrq2Losibch21GJ0s8F4DhHia4RhtgjLN8iaWTUdwC9oSx6EwWvwUCF9ovKLbAHx0DA8ZsUEe4pBuyZ7CNkMvg/640?wx_fmt=other&amp;from=appmsg" data-type="other" data-w="486" width="35%" src="https://mmbiz.qpic.cn/mmbiz_jpg/iaRJcrq2Losibch21GJ0s8F4DhHia4RhtgjLN8iaWTUdwC9oSx6EwWvwUCF9ovKLbAHx0DA8ZsUEe4pBuyZ7CNkMvg/640?wx_fmt=other&amp;from=appmsg"><h3 data-tool="mdnice编辑器">Step3. GSEA富集分析</h3><h4 data-tool="mdnice编辑器">3.1 函数<code>lzq_GSEA</code></h4><p data-tool="mdnice编辑器"><code>lzq_GSEA</code>函数将执行基因集富集分析，包括GO, KEGG, WikiPathways, Reactome, MsigDB, Disease ontolty, Cancer Gene Network, DisGeNET, CellMarker和CMAP。同样的，指定<code>enrich.type</code>参数可指定目标数据库：</p><pre data-tool="mdnice编辑器"><span></span><code><span># Set enrich.type using an enrichment analysis method mentioned above.</span><br>fit &lt;- lzq_GSEA(grlist, enrich.type = <span>'KEGG'</span>)<br><span># +++ Updating gene symbols...</span><br><span># Maps last updated on: Thu Oct 24 12:31:05 2019</span><br><span># +++ Transforming SYMBOL to ENTREZID...</span><br><span># 'select()' returned 1:many mapping between keys and columns</span><br><span># +++ Performing KEGG enrichment...</span><br><span># +++ 5 significant terms were detected...</span><br><span># +++ Done!</span><br></code></pre><h4 data-tool="mdnice编辑器">3.2 函数<code>lzq_GSEA.integrated</code></h4><p data-tool="mdnice编辑器"><code>lzq_GSEA.integrated</code>函数可一键式运行所有的基因集数据库：</p><pre data-tool="mdnice编辑器"><span></span><code><span># Integrative enrichment analysis of the up-regulated gene list</span><br>fit2 &lt;- lzq_GSEA.integrated(<br>  genes = grlist,<br>  gene.type = <span>'SYMBOL'</span>,<br>  GO.ont = <span>'ALL'</span>,<br>  perform.WikiPathways = <span>T</span>,<br>  perform.Reactome = <span>T</span>,<br>  perform.MsigDB = <span>T</span>,<br>  MsigDB.category = <span>'ALL'</span>,<br>  perform.Cancer.Gene.Network = <span>T</span>,<br>  perform.disease.ontoloty = <span>T</span>,<br>  perform.DisGeNET = <span>T</span>,<br>  perform.CellMarker = <span>T</span>,<br>  perform.CMAP = <span>T</span>,<br>  min.Geneset.Size = <span>3</span><br>)<br><span># +++ Updating gene symbols...</span><br><span># Maps last updated on: Thu Oct 24 12:31:05 2019</span><br><span># +++ Transforming SYMBOL to ENTREZID...</span><br><span># 'select()' returned 1:many mapping between keys and columns</span><br><span># +++ Performing GO-ALL enrichment...</span><br><span># +++ Symplifying GO results...</span><br><span># +++ Performing KEGG enrichment...</span><br><span># +++ Performing Module KEGG enrichment...</span><br><span># +++ Performing WikiPathways enrichment...</span><br><span># +++ Performing Reactome pathways enrichment...</span><br><span># +++ Performing Disease Ontoloty enrichment...</span><br><span># +++ Performing Cancer Gene Network enrichment...</span><br><span># no term enriched under specific pvalueCutoff...</span><br><span># +++ Performing DisGeNET enrichment...</span><br><span># +++ Performing CellMarker enrichment...</span><br><span># +++ Performing MsigDB-ALL enrichment...                                               </span><br><span># +++ Performing CMAP enrichment...</span><br><span># no term enriched under specific pvalueCutoff...</span><br><span># +++ 311 significant terms were detected...</span><br><span># +++ Done!</span><br></code></pre><p data-tool="mdnice编辑器"><code>fit2</code>对象也是一个list结构，每一个元素对应了一个基因集数据库的结果。</p><h4 data-tool="mdnice编辑器">3.3 可视化</h4><p data-tool="mdnice编辑器"><strong>Visualize analyzing result of GSEA</strong></p><pre data-tool="mdnice编辑器"><span></span><code>lzq_gseaplot(<br>  fit2$simplyGO,<br>  Pathway.ID = <span>'GO:0030016'</span>,<br>  rank = <span>F</span>,<br>  statistic.position = c(<span>0.71</span>,<span>0.85</span>),<br>  rel.heights = c(<span>1</span>, <span>0.4</span>)<br>)<br></code></pre><img data-imgfileid="100034605" data-ratio="0.7537037037037037" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/iaRJcrq2Losibch21GJ0s8F4DhHia4RhtgjrtyTwpWIIEROXMtcoCPzKYLHrBiafxoa4aic8tI1DW1ggulkRPr1FpnQ/640?wx_fmt=other&amp;from=appmsg" data-type="other" data-w="1080" width="60%" src="https://mmbiz.qpic.cn/mmbiz_jpg/iaRJcrq2Losibch21GJ0s8F4DhHia4RhtgjrtyTwpWIIEROXMtcoCPzKYLHrBiafxoa4aic8tI1DW1ggulkRPr1FpnQ/640?wx_fmt=other&amp;from=appmsg"><p data-tool="mdnice编辑器"><strong>Enrichment barplot for positive or negative GSEA results</strong></p><pre data-tool="mdnice编辑器"><span></span><code>lzq_GSEA.barplot1(enrich.obj = fit2$simplyGO,type = <span>'pos'</span>)<br></code></pre><img data-imgfileid="100034609" data-ratio="0.6376518218623481" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/iaRJcrq2Losibch21GJ0s8F4DhHia4RhtgjTRXTiaiaRqRkrQkm7LVdJEXJlugtYTViazKaFe6fFpN1PH1ibNLo4CPGow/640?wx_fmt=other&amp;from=appmsg" data-type="other" data-w="988" width="60%" src="https://mmbiz.qpic.cn/mmbiz_jpg/iaRJcrq2Losibch21GJ0s8F4DhHia4RhtgjTRXTiaiaRqRkrQkm7LVdJEXJlugtYTViazKaFe6fFpN1PH1ibNLo4CPGow/640?wx_fmt=other&amp;from=appmsg"><p data-tool="mdnice编辑器"><strong>Enrichment dotplot for positive or negative GSEA results</strong></p><pre data-tool="mdnice编辑器"><span></span><code>lzq_GSEA.dotplot1(enrich.obj = fit2$simplyGO,type = <span>'pos'</span>)<br></code></pre><img data-imgfileid="100034607" data-ratio="0.6404040404040404" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/iaRJcrq2Losibch21GJ0s8F4DhHia4RhtgjkON7w14mqmSgs88QL8SOgyticC4AC6WDT6pu8HsFzpyH8ZQQtvcUr8g/640?wx_fmt=other&amp;from=appmsg" data-type="other" data-w="990" width="60%" src="https://mmbiz.qpic.cn/mmbiz_jpg/iaRJcrq2Losibch21GJ0s8F4DhHia4RhtgjkON7w14mqmSgs88QL8SOgyticC4AC6WDT6pu8HsFzpyH8ZQQtvcUr8g/640?wx_fmt=other&amp;from=appmsg"><p data-tool="mdnice编辑器">同样的，<code>lzq_GSEA.barplot2</code>支持同时可视化激活和抑制的GSEA通路：</p><pre data-tool="mdnice编辑器"><span></span><code>lzq_GSEA.barplot2(enrich.obj = fit2$simplyGO)<br></code></pre><img data-imgfileid="100034606" data-ratio="0.758695652173913" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/iaRJcrq2Losibch21GJ0s8F4DhHia4RhtgjEyjjdiayWic7htI9KlHPtfO8Nbs1icmBZtn4ASlVZicdDKQ9KXzdHtz8IA/640?wx_fmt=other&amp;from=appmsg" data-type="other" data-w="920" width="60%" src="https://mmbiz.qpic.cn/mmbiz_jpg/iaRJcrq2Losibch21GJ0s8F4DhHia4RhtgjEyjjdiayWic7htI9KlHPtfO8Nbs1icmBZtn4ASlVZicdDKQ9KXzdHtz8IA/640?wx_fmt=other&amp;from=appmsg"><p data-tool="mdnice编辑器">支持中文模式：</p><pre data-tool="mdnice编辑器"><span></span><code>lzq_GSEA.barplot2(enrich.obj = fit2$simplyGO,use.Chinese = <span>T</span>)<br></code></pre><img data-imgfileid="100034613" data-ratio="0.9858356940509915" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/iaRJcrq2Losibch21GJ0s8F4DhHia4Rhtgjic8ezq9KS72otRa4QxGS6TvX6lBnUvv3nMcwAlB8zBAJxyXtvOwaz6A/640?wx_fmt=other&amp;from=appmsg" data-type="other" data-w="706" width="45%" src="https://mmbiz.qpic.cn/mmbiz_jpg/iaRJcrq2Losibch21GJ0s8F4DhHia4Rhtgjic8ezq9KS72otRa4QxGS6TvX6lBnUvv3nMcwAlB8zBAJxyXtvOwaz6A/640?wx_fmt=other&amp;from=appmsg"><h3 data-tool="mdnice编辑器">总结</h3><p data-tool="mdnice编辑器">总体来说 ，<code>BioEnricher</code>R包内置了很多基因集数据库，一键式批量分析非常方便；另外，可视化的颜值也很高，都是发表级的，可见R包作者也是非常细心。更多内容见<code>BioEnricher_0.1.0.pdf</code>官方手册，记得去官方github（https://github.com/Zaoqu-Liu/BioEnricher）给作者点点小星星，支持一波~</p><figure data-tool="mdnice编辑器"><img data-imgfileid="100034614" data-ratio="0.28055555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/iaRJcrq2Losibch21GJ0s8F4DhHia4Rhtgjnb6zK6nDHBAtEWBcutTFicGpEqsdHPRrvice1g7rfuOPgajAhceALaibQ/640?wx_fmt=other&amp;from=appmsg" data-type="other" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_jpg/iaRJcrq2Losibch21GJ0s8F4DhHia4Rhtgjnb6zK6nDHBAtEWBcutTFicGpEqsdHPRrvice1g7rfuOPgajAhceALaibQ/640?wx_fmt=other&amp;from=appmsg"><figcaption>image-20231203182600898</figcaption></figure><p data-tool="mdnice编辑器">另外，关于富集分析，特别是单细胞富集分析，还有一些小细节和小技巧，我有时间整理一下，尽情期待！</p><span>- END -</span></section><p><br></p><p><br></p><p><mp-style-type data-value="10000"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/7ymMpAd2Nnxv23IGIqhUVQ",target="_blank" rel="noopener noreferrer">原文链接</a>
