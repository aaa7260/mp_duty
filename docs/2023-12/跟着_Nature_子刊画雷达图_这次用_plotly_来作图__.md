---
title: "跟着《Nature》子刊画雷达图！这次用{plotly}来作图～～"
date: 2023-12-14T09:50:03Z
draft: ["false"]
tags: [
  "fetched",
  "R语言和统计"
]
categories: ["Acdemic"]
---
跟着《Nature》子刊画雷达图！这次用{plotly}来作图～～ by R语言和统计
------
<div><section data-mpa-powered-by="yiban.io"><span>今天画一个类似Nature子刊《</span><span>communications</span><span> biology</span><span>》上论文</span><span><span> </span><span>[1]</span><span> </span></span><span>中的雷达图（左一）:</span></section><section><br></section><section><img data-galleryid="" data-imgfileid="100024921" data-ratio="0.2833333333333333" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/pCu8RzQCByRXdB26YqOuXrnkFYHBtYwCUUA9ySib1icI6YvkYGjUM25Rp9fvA7pMKB8cUK12A2NcVc3zv4L9eHCg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/pCu8RzQCByRXdB26YqOuXrnkFYHBtYwCUUA9ySib1icI6YvkYGjUM25Rp9fvA7pMKB8cUK12A2NcVc3zv4L9eHCg/640?wx_fmt=png&amp;from=appmsg"></section><section><span>图片来源<span>[1]</span></span></section><section><br></section><section><span>以前的推文中介绍过画雷达图的几种方法，与以往不同，这次不使用<span>{ggplot2}</span>及其衍生R包。</span></section><section><span><br></span></section><section><span>我们发现<span>{plotly}</span>画出的雷达图与论文中的更类似，就用它啦<img data-imgfileid="100024922" data-ratio="1" data-src="https://mmbiz.qpic.cn/mmbiz_png/pCu8RzQCByRXdB26YqOuXrnkFYHBtYwChsDdbHKoM5Zv5ibjE5MTSEDYqqZ1f0PBxSEicHfcqmCv4PljcDag0avg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="64" src="https://mmbiz.qpic.cn/mmbiz_png/pCu8RzQCByRXdB26YqOuXrnkFYHBtYwChsDdbHKoM5Zv5ibjE5MTSEDYqqZ1f0PBxSEicHfcqmCv4PljcDag0avg/640?wx_fmt=png&amp;from=appmsg">～<br></span></section><section><br></section><section><span>第一步，载入R包：</span></section><section><br></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><section><span>install.packages(<span>"plotly"</span>)<br mpa-from-tpl="t"></span><span>library</span><span>(plotly)</span></section></pre></section><section><span>第二步，创建做图数据：</span></section><section><br></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><section><span>mydata &lt;- data.frame(<br mpa-from-tpl="t">  parameters = c(<span>"Peak Amplitude"</span>, <span>"Peak Count"</span>, <span>"Peak Rate"</span>,<br mpa-from-tpl="t">                 <span>"Peak Spacing"</span>, <span>"Peak Width 50%"</span>, <span>"Peak Width 90%"</span>, <br mpa-from-tpl="t">                 <span>"Peak Rise Time"</span>, <span>"Peak Decay Time"</span>,<br mpa-from-tpl="t">                 <span>"Rise Slope"</span>, <span>"Decay Slope"</span>), <br mpa-from-tpl="t">  Wt_DMSO = rep(<span>100</span>, <span>10</span>), <br mpa-from-tpl="t">  APOE_DMSO = c(<span>127.07127</span>, <span>54.20589</span>, <span>53.3881</span>, <span>200.15486</span>, <span>174.3263</span>,<br mpa-from-tpl="t">                <span>148.8633</span>, <span>136.1452</span>, <span>116.2678</span>, <span>103.59806</span>, <span>116.50617</span>),<br mpa-from-tpl="t">  ten_uM_Donepezil = c(<span>75.49221</span>, <span>141.10778</span>, <span>146.3203</span>, <span>64.33077</span>, <span>157.0577</span>,<br mpa-from-tpl="t">                       <span>116.4687</span>, <span>129.5369</span>, <span>101.4318</span>, <span>56.01559</span>, <span>77.95287</span>)) <br mpa-from-tpl="t">mydata</span></section></pre></section><section><img data-galleryid="" data-imgfileid="100024919" data-ratio="0.48586118251928023" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/pCu8RzQCByRXdB26YqOuXrnkFYHBtYwClibe3PyoOdqTia41TbNIwcPzDAySgl5MmXddLXgxV2WNpzxpJxqj23Xw/640?wx_fmt=png" data-type="png" data-w="778" height="378" width="778" src="https://mmbiz.qpic.cn/mmbiz_png/pCu8RzQCByRXdB26YqOuXrnkFYHBtYwClibe3PyoOdqTia41TbNIwcPzDAySgl5MmXddLXgxV2WNpzxpJxqj23Xw/640?wx_fmt=png"></section><section><br></section><section><span>上述数据是结合原论文 </span><span>[1] </span><span>和做图需要创建。<br></span></section><section><span><br></span></section><section><span>前期准备工作完成。<br></span></section><section><br></section><section><span>最后，开始作图：</span></section><section><br></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><section><span>p &lt;- plot_ly(<br mpa-from-tpl="t">  type = <span>"scatterpolar"</span>,<br mpa-from-tpl="t">  fill = <span>"toself"</span>, <br mpa-from-tpl="t">  mode = <span>"lines"</span>)<br mpa-from-tpl="t"><br mpa-from-tpl="t">p1 &lt;- p %&gt;% <br mpa-from-tpl="t">  add_trace(<br mpa-from-tpl="t">    r = mydata$Wt_DMSO,<br mpa-from-tpl="t">    theta = mydata$parameters,<br mpa-from-tpl="t">    name = <span>"Wt_DMSO"</span>,<br mpa-from-tpl="t">    fillcolor = rgb(<span>8</span>, <span>9</span>, <span>9</span>, <span>50</span>, maxColorValue = <span>255</span>), <br mpa-from-tpl="t">    line = list(color = rgb(<span>8</span>, <span>9</span>, <span>9</span>, maxColorValue = <span>255</span>), width = <span>1.5</span>)<br mpa-from-tpl="t">    ) %&gt;% <br mpa-from-tpl="t">  add_trace(<br mpa-from-tpl="t">    r = mydata$APOE_DMSO,<br mpa-from-tpl="t">    theta = mydata$parameters,<br mpa-from-tpl="t">    name = <span>"APOE_DMSO"</span>,<br mpa-from-tpl="t">    fillcolor = rgb(<span>255</span>, <span>135</span>, <span>135</span>, <span>200</span>, maxColorValue = <span>255</span>), <br mpa-from-tpl="t">    line = list(color = rgb(<span>255</span>, <span>135</span>, <span>135</span>, <span>200</span>, maxColorValue = <span>255</span>), width = <span>1</span>)<br mpa-from-tpl="t">  ) %&gt;% <br mpa-from-tpl="t">  add_trace(<br mpa-from-tpl="t">    r = mydata$ten_uM_Donepezil,<br mpa-from-tpl="t">    theta = mydata$parameters,<br mpa-from-tpl="t">    name = <span>"10 uM Donepezil"</span>,<br mpa-from-tpl="t">    fillcolor = rgb(<span>166</span>, <span>197</span>, <span>193</span>, <span>150</span>, maxColorValue = <span>255</span>), <br mpa-from-tpl="t">    line = list(color = rgb(<span>166</span>, <span>197</span>, <span>193</span>, <span>150</span>, maxColorValue = <span>255</span>), <br mpa-from-tpl="t">                width = <span>1</span>)<br mpa-from-tpl="t">  ) %&gt;%<br mpa-from-tpl="t">  layout(<br mpa-from-tpl="t">    polar = list(<br mpa-from-tpl="t">      radialaxis = list(<br mpa-from-tpl="t">        visible = </span><span>TRUE</span><span>,<br mpa-from-tpl="t">        range = c(<span>0</span>,<span>300</span>), <br mpa-from-tpl="t">        tickvals = seq(<span>0</span>, <span>300</span>, <span>50</span>), <br mpa-from-tpl="t">        tickangle = <span>90</span>)), <br mpa-from-tpl="t">    legend = list(<br mpa-from-tpl="t">      orientation = <span>"v"</span>, <br mpa-from-tpl="t">      x = <span>0.4</span>, <br mpa-from-tpl="t">      y = - <span>0.2</span>))<br mpa-from-tpl="t"><br mpa-from-tpl="t">p1</span></section></pre></section><section><img data-galleryid="" data-imgfileid="100024920" data-ratio="0.8" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/pCu8RzQCByRXdB26YqOuXrnkFYHBtYwCuwic6459zwxiajux21CbAcdAqXtl7vp7VD1ciaDJs9haxrBKvM8Gfkrgw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/pCu8RzQCByRXdB26YqOuXrnkFYHBtYwCuwic6459zwxiajux21CbAcdAqXtl7vp7VD1ciaDJs9haxrBKvM8Gfkrgw/640?wx_fmt=png&amp;from=appmsg"></section><section><br></section><section><span>与原论文类似的雷达图就完成啦！<br></span></section><section><br></section><section><span>如果想了解更多有关雷达图的文章可以在公众号里搜索往期内容哦～</span></section><section><br></section><section><span><span>好啦，今天的内容就到这里。</span><span>如果有帮助，记得分享给需要的人</span></span><img data-ratio="1" data-src="https://res.wx.qq.com/t/wx_fed/we-emoji/res/v1.3.10/assets/Expression/Expression_67@2x.png" data-w="128" src="https://res.wx.qq.com/t/wx_fed/we-emoji/res/v1.3.10/assets/Expression/Expression_67@2x.png"><span>！</span></section><section><br></section><section><span>参考文献</span></section><section><br></section><section data-mpa-preserve-tpl-color="t" data-mpa-template="t" mpa-preserve="t" mpa-from-tpl="t"><pre><section><span>[1]. https://www.nature.com/articles/s42003-023-05582-8/figures/5</span></section></pre></section><section><br></section><section><span><strong><span>公众号的线上课程</span></strong></span></section><section><span>1. <a target="_blank" href="http://mp.weixin.qq.com/s?__biz=Mzk0MzE5OTAxMg==&amp;mid=2247506555&amp;idx=2&amp;sn=386b4d66c19578e0d318c6bc1ac5e21f&amp;chksm=c3351c30f4429526ca948ba1d78311b1f16f017a5bc17623de1276dc38e89df5bc9bc029f0de&amp;scene=21#wechat_redirect" textvalue="《R语言和统计新手课程》" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2">《R语言和统计新手课程》</a></span></section><section><span>2. <a target="_blank" href="http://mp.weixin.qq.com/s?__biz=Mzk0MzE5OTAxMg==&amp;mid=2247506977&amp;idx=1&amp;sn=b7f96f32505ac8b88fb68357c8d43d69&amp;chksm=c3351a6af442937cc8777dd9241f23c3ab8e049677738b222d8dabe7aeb1e3074c80ce749dcd&amp;scene=21#wechat_redirect" textvalue="《回归：从入门到进阶》" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2">《回归：从入门到进阶》</a></span></section><section><span><br></span></section><section><strong><span>统计咨询</span></strong></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=Mzk0MzE5OTAxMg==&amp;mid=2247508283&amp;idx=1&amp;sn=4ed28c3711a18a34b1b4346612cbfe81&amp;chksm=c3356770f442ee66f6abc20a6115ae619663d5f417f9823705ade284fc62593188c4de7903ce&amp;scene=21#wechat_redirect" textvalue="《服务介绍和经典合作案例》" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2"><span>《服务介绍和经典合作案例》</span></a></section><section><br></section><section><span><strong><span>公众号核心成员的成果发表</span></strong></span></section><section><span><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=Mzk0MzE5OTAxMg==&amp;mid=2247506555&amp;idx=1&amp;sn=0ca95fddcc184506e02c5b7ea70c0567&amp;chksm=c3351c30f4429526acad9c6c20dc0c3b76dc849d57a1755155f234f6eb31a24a904962f7aa5d&amp;scene=21#wechat_redirect" textvalue="《SCI医学1区论文》" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2">《SCI医学1区影响因子9分论文》</a></span></section><section><br></section><section><span><strong><span>公众号核心成员担任SCI杂志Associate Editor!</span></strong></span></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=Mzk0MzE5OTAxMg==&amp;mid=2247508003&amp;idx=1&amp;sn=4d6c2bf2e1723e751743ff6eeda407cc&amp;chksm=c3356668f442ef7ee530363ababa01f074c2bc1765f551a3d90cb2ce0a9faa62cdefa6380803&amp;scene=21#wechat_redirect" textvalue="《Journal of Alzheimer's disease杂志Associate editor》" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2"><span>《JAD杂志Associate editor》</span></a></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=Mzk0MzE5OTAxMg==&amp;mid=2247508499&amp;idx=1&amp;sn=2adb08a49ac005b837970118de24e749&amp;chksm=c3356458f442ed4ecd899198d92e2a5584f146a4a0a82a75cd065bc1719fd76b226886be758f&amp;scene=21#wechat_redirect" textvalue="《Frontiers in Neuroscience, Frontiers in Neurology and Frontiers in Psychiatry杂志的神经退行性病变板块》" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2"><span>《Frontiers in Neuroscience, Frontiers in Neurology and Frontiers in Psychiatry杂志的神经退行性病变板块》</span></a></section><section><br></section><section data-mpa-template="t" mpa-from-tpl="t"><section><span>▌本文由</span><span><strong mpa-from-tpl="t"><span>R语言和统计</span></strong></span><span>首发</span></section><section><span>▌课程相关咨询可添加R师妹微信: kefu_rstats</span></section><section><span>▌编辑：June</span></section><section><span>▌邮箱：contact@rstats.cn</span></section><section><span>▌网站：www.rstats.cn</span></section><section><span>▌<strong>我们致力于</strong><strong>让R语言和统计变得简单！</strong></span></section><section><span><strong></strong><br></span></section><section mpa-from-tpl="t"><section label="Powered by 135editor.com" data-role="outer" mpa-from-tpl="t"><section data-role="paragraph" mpa-from-tpl="t"><section data-mpa-template="t" mpa-from-tpl="t"><section mpa-from-tpl="t"><section label="Powered by 135editor.com" data-role="outer" mpa-from-tpl="t"><section data-role="paragraph" mpa-from-tpl="t"><section mpa-from-tpl="t"><section mpa-from-tpl="t"><section label="Powered by 135editor.com" data-role="outer" mpa-from-tpl="t"><section data-role="paragraph" mpa-from-tpl="t"><hr><section><br></section></section></section></section></section></section></section></section></section></section></section></section></section><section><br></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/Rr6SwEB0VmmEWlIZ0cUxNw",target="_blank" rel="noopener noreferrer">原文链接</a>
