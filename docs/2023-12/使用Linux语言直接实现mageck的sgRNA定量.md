---
title: "使用Linux语言直接实现mageck的sgRNA定量"
date: 2023-12-26T23:32:23Z
draft: ["false"]
tags: [
  "fetched",
  "东林的扯淡小屋"
]
categories: ["Acdemic"]
---
使用Linux语言直接实现mageck的sgRNA定量 by 东林的扯淡小屋
------
<div><p>mageck的定量结果：<br></p><p><img data-galleryid="" data-imgfileid="100024732" data-ratio="0.16111111111111112" data-s="300,640" data-type="png" data-w="1080" data-src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBpTnXvag2IqMa2E6MjIiaSdQozal4Mr3NkrMaXvWL2vWn8fafQSkyIfnaPqROuOiaknJzgrICewItvQ/640?wx_fmt=png&amp;from=appmsg" src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBpTnXvag2IqMa2E6MjIiaSdQozal4Mr3NkrMaXvWL2vWn8fafQSkyIfnaPqROuOiaknJzgrICewItvQ/640?wx_fmt=png&amp;from=appmsg"></p><p>自己写脚本来实现类似的功能（感谢ChatGPT）：<br></p><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="bash"><code><span><span># 获取当前目录下的所有*_R1.fq.gz文件，并提取文件名部分</span></span></code><code><span>samples=($(ls *_R1.fq.gz | sed <span>'s/_R1.fq.gz//'</span>))</span></code><code><span><br></span></code><code><span><span># 将表头写入result.csv</span></span></code><code><span>header=<span>"id,sgRNA,Gene,<span>${samples[*]}</span>"</span></span></code><code><span><span>echo</span> <span>"<span>$header</span>"</span> | tr <span>' '</span> <span>','</span> &gt; result.csv</span></code><code><span><br></span></code><code><span><span># 逐行统计sgRNA在各样本中的出现次数</span></span></code><code><span>awk -F, <span>'NR&gt;1 {print $1 "," $2 "," $3}'</span> gRNA_data.csv | <span>while</span> IFS=, <span>read</span> -r id sequence gene; <span>do</span></span></code><code><span>    line=<span>"<span>$id</span>,<span>$sequence</span>,<span>$gene</span>"</span></span></code><code><span><br></span></code><code><span>    <span>for</span> sample <span>in</span> <span>"<span>${samples[@]}</span>"</span>; <span>do</span></span></code><code><span>        count=$(zcat <span>"<span>${sample}</span>_R1.fq.gz"</span> | grep -o -c <span>"<span>$sequence</span>"</span>)</span></code><code><span>        line=<span>"<span>$line</span>,<span>$count</span>"</span></span></code><code><span>    <span>done</span></span></code><code><span><br></span></code><code><span>    <span>echo</span> <span>"<span>$line</span>"</span> &gt;&gt; result.csv</span></code><code><span><span>done</span></span></code><code><span><br></span></code><code><span><br></span></code></pre></section><p><img data-galleryid="" data-imgfileid="100024729" data-ratio="0.14537037037037037" data-s="300,640" data-type="png" data-w="1080" data-src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBpTnXvag2IqMa2E6MjIiaSdQEZFy7hZibOcVDarDjhsyy6j7T6ByqicvjiaAuKgJZlq1ftibQKkOJPfkLQ/640?wx_fmt=png&amp;from=appmsg" src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBpTnXvag2IqMa2E6MjIiaSdQEZFy7hZibOcVDarDjhsyy6j7T6ByqicvjiaAuKgJZlq1ftibQKkOJPfkLQ/640?wx_fmt=png&amp;from=appmsg"></p><p>准备文库文件<span>gRNA_data.csv</span><span>：</span></p><p><img data-galleryid="" data-imgfileid="100024730" data-ratio="0.14596273291925466" data-s="300,640" data-type="png" data-w="966" data-src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBpTnXvag2IqMa2E6MjIiaSdQ2WQeudEbL1wqSTdLYBibgyPHeFQYw22Z87McFaSk7BcZjqryBavQ13A/640?wx_fmt=png&amp;from=appmsg" src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBpTnXvag2IqMa2E6MjIiaSdQ2WQeudEbL1wqSTdLYBibgyPHeFQYw22Z87McFaSk7BcZjqryBavQ13A/640?wx_fmt=png&amp;from=appmsg"></p><p>分析结果：<br></p><p><img data-galleryid="" data-imgfileid="100024734" data-ratio="0.3425925925925926" data-s="300,640" data-type="png" data-w="1080" data-src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBpTnXvag2IqMa2E6MjIiaSdQOG5xt2UaUnoTEexLVczo3CwpXwXBuKZfypqJf06hbsAbGQj0d3kQVA/640?wx_fmt=png&amp;from=appmsg" src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBpTnXvag2IqMa2E6MjIiaSdQOG5xt2UaUnoTEexLVczo3CwpXwXBuKZfypqJf06hbsAbGQj0d3kQVA/640?wx_fmt=png&amp;from=appmsg"></p><p>大体结果差不多，不过没有考虑到运行的内存消耗等等，其实就是很粗糙的脚本，能用，但作用有限。<br></p><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/f0fINvwfJ8D8utBQmpxVKg",target="_blank" rel="noopener noreferrer">原文链接</a>
