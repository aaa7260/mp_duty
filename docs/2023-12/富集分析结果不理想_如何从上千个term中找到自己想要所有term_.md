---
title: "富集分析结果不理想：如何从上千个term中找到自己想要所有term？"
date: 2023-12-12T07:38:24Z
draft: ["false"]
tags: [
  "fetched",
  "生信小博士"
]
categories: ["Acdemic"]
---
富集分析结果不理想：如何从上千个term中找到自己想要所有term？ by 生信小博士
------
<div><p><strong><span>大家好</span></strong><strong><span>，我们经常会发现GO、kegg、gsea等富集分析的结果会产生很多term，如果top10之内有我们的目的term，那很好！但是如果我们想要研究的term不在top10里面怎么办呢？</span></strong></p><hr><p><strong><span>甚至我们想要研究的term在top200之后</span></strong><img data-ratio="1" data-src="https://res.wx.qq.com/t/wx_fed/we-emoji/res/v1.3.10/assets/newemoji/Hurt.png" data-w="128" src="https://res.wx.qq.com/t/wx_fed/we-emoji/res/v1.3.10/assets/newemoji/Hurt.png"><img data-ratio="1" data-src="https://res.wx.qq.com/t/wx_fed/we-emoji/res/v1.3.10/assets/newemoji/Hurt.png" data-w="128" src="https://res.wx.qq.com/t/wx_fed/we-emoji/res/v1.3.10/assets/newemoji/Hurt.png"><strong><span>，这时候咋办啊</span></strong><img data-ratio="1" data-src="https://res.wx.qq.com/t/wx_fed/we-emoji/res/v1.3.10/assets/newemoji/Sigh.png" data-w="128" src="https://res.wx.qq.com/t/wx_fed/we-emoji/res/v1.3.10/assets/newemoji/Sigh.png"></p><p><strong><span>其实我们在进行富集分析之前，可能已经对自己想要研究的方向有了大概了解。</span></strong></p><p><span><strong><span>那么问题就变成了：如何实现 从富集分析的结果里找到支撑我们想法的所有term？</span></strong></span><strong><span></span></strong></p><ul><li><p><strong><span>1 比如我们有了这样的富集结果，总共有2000多条：</span></strong></p></li></ul><p><img data-galleryid="" data-imgfileid="100001196" data-ratio="0.4324074074074074" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345Sktbgp2pg1aTqibQNwGibRoz5pyGtCeD9LNMRvv3QUt0C1eWAlqPF5G3ZA1LnPIR0d0iaSCQ2g5gVR7zw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345Sktbgp2pg1aTqibQNwGibRoz5pyGtCeD9LNMRvv3QUt0C1eWAlqPF5G3ZA1LnPIR0d0iaSCQ2g5gVR7zw/640?wx_fmt=png&amp;from=appmsg"></p><ul><li><p><strong><span>2 假如我对纤维化感兴趣，那我可以用这几个词去检索：coll  matrix  fibro</span></strong></p></li></ul><p><em><strong><span>如果你想研究其他的通路，换个关键词就行了</span></strong></em></p><section><ul><li><li><li><li><li><li><li><li></ul><pre data-lang="ruby"><code><span><span>#代码</span></span></code><code><span>selected_lung_terms=xx.all  %&gt;%</span></code><code><span>  dplyr::filter(stringr::str_detect(pattern = <span>"coll|matrix|fibro"</span>,Description))  %&gt;%</span></code><code><span>  group_by(Description) %&gt;%</span></code><code><span>  add_count()  %&gt;%</span></code><code><span>  dplyr::arrange(dplyr::desc(n),dplyr::desc(Description)) %&gt;%</span></code><code><span>  mutate(Description =forcats:: fct_inorder(Description))</span></code><code><span><br></span></code></pre></section><p><strong><span>这样找到的都是和纤维化相关的term</span></strong><br></p><p><img data-galleryid="" data-imgfileid="100001197" data-ratio="0.38796296296296295" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345Sktbgp2pg1aTqibQNwGibRoz5pVJdysS9ibPklkakdzkxIVmv3qC5015uxj9R0cxK5dhLBJsgGo6DVPWw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345Sktbgp2pg1aTqibQNwGibRoz5pVJdysS9ibPklkakdzkxIVmv3qC5015uxj9R0cxK5dhLBJsgGo6DVPWw/640?wx_fmt=png&amp;from=appmsg"></p><ul><li><p><strong><span>3 对这些富集分析结果进行可视化</span></strong><br></p></li></ul><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="php"><code><span><br></span></code><code><span>ggplot(xx.all  %&gt;%</span></code><code><span>         dplyr::filter(stringr::str_detect(pattern = <span>"coll|matrix"</span>,Description))  %&gt;%</span></code><code><span>         group_by(Description) %&gt;%</span></code><code><span>         add_count()  %&gt;%</span></code><code><span>         dplyr::arrange(dplyr::desc(n),dplyr::desc(Description)) %&gt;%</span></code><code><span>         mutate(Description =forcats:: fct_inorder(Description))</span></code><code><span><br></span></code><code><span>       , <span>#fibri|matrix|colla</span></span></code><code><span>         aes(Cluster, Description)) +</span></code><code><span>  geom_point(aes(fill=p.adjust, size=Count), shape=<span>21</span>)+</span></code><code><span>  theme_bw()+</span></code><code><span>  theme(axis.text.x=element_text(angle=<span>90</span>,hjust = <span>1</span>,vjust=<span>0.5</span>),</span></code><code><span>        axis.text.y=element_text(size = <span>12</span>),</span></code><code><span>        axis.text = element_text(color = <span>'black'</span>, size = <span>12</span>)</span></code><code><span>  )+</span></code><code><span>  scale_fill_gradient(low=<span>"red"</span>,high=<span>"blue"</span>)+</span></code><code><span>  labs(x=<span>NULL</span>,y=<span>NULL</span>)</span></code><code><span><span># coord_flip()</span></span></code><code><span><br></span></code></pre></section><p><img data-galleryid="" data-imgfileid="100001198" data-ratio="0.6953703703703704" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345Sktbgp2pg1aTqibQNwGibRoz5plTZjTdCtxRcHCNGOfUeDygwAn7l9EhmToOxAtOiaHmtEK8ztzeV5Xrw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345Sktbgp2pg1aTqibQNwGibRoz5plTZjTdCtxRcHCNGOfUeDygwAn7l9EhmToOxAtOiaHmtEK8ztzeV5Xrw/640?wx_fmt=png&amp;from=appmsg"></p><p><br></p><ul><li><p><strong><span>4 如果你想把目的term的所有基因都取出来：</span></strong><br></p></li></ul><p><img data-galleryid="" data-imgfileid="100001199" data-ratio="0.4126679462571977" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345Sktbgp2pg1aTqibQNwGibRoz5pFs9Ttpb7fB174IkrfeDk3hdYVDmXkpml1EfTAQPmjTUjIJy8GPqYzw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1042" src="https://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345Sktbgp2pg1aTqibQNwGibRoz5pFs9Ttpb7fB174IkrfeDk3hdYVDmXkpml1EfTAQPmjTUjIJy8GPqYzw/640?wx_fmt=png&amp;from=appmsg"></p><p>代码如下：</p><section><ul><li></ul><pre data-lang="php"><code><span>stringr::str_split(string = selected_lung_terms$geneID,pattern = <span>"/"</span>,simplify = <span>TRUE</span>) %&gt;%<span>as</span>.vector()</span></code></pre></section><p>所有的基因：</p><p><img data-galleryid="" data-imgfileid="100001200" data-ratio="0.47314814814814815" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345Sktbgp2pg1aTqibQNwGibRoz5pznE2S0rOut3dfrd7YNdBWKr7qgjRib9lO7liapW2CEIOhSBoibMe0RPrQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345Sktbgp2pg1aTqibQNwGibRoz5pznE2S0rOut3dfrd7YNdBWKr7qgjRib9lO7liapW2CEIOhSBoibMe0RPrQ/640?wx_fmt=png&amp;from=appmsg"></p><ul><li><p><strong><span>5 如果你想看基因在这些term中出现的频率：</span></strong><br></p></li></ul><section><ul><li></ul><pre data-lang="php"><code><span>stringr::str_split(string = selected_lung_terms$geneID,pattern = <span>"/"</span>,simplify = <span>TRUE</span>) %&gt;%<span>as</span>.vector() %&gt;%table() %&gt;%sort()</span></code></pre></section><p><img data-galleryid="" data-imgfileid="100001201" data-ratio="0.3277777777777778" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345Sktbgp2pg1aTqibQNwGibRoz5pDlnxDnUSh5CyqKqFkcqKUkwg1vAM34ys2HXMia0H9VxcRsVlyWgJHcA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345Sktbgp2pg1aTqibQNwGibRoz5pDlnxDnUSh5CyqKqFkcqKUkwg1vAM34ys2HXMia0H9VxcRsVlyWgJHcA/640?wx_fmt=png&amp;from=appmsg"></p><p><strong><span>可以看到col1a1出现的次数最多</span></strong></p><p><strong><span>最后其实对结果的可视化有很多种，我上述展示的有点丑，如果大家感兴趣，下次写写可视化的方法<br></span></strong></p><p><strong><span><img data-imgfileid="100001204" data-ratio="0.7675925925925926" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345Sktbgp2pg1aTqibQNwGibRoz5pvXWwoorj6VD2lX2rTmsTJ89ykfnndrTvQDJic8Hdj8dVrHUofVgR34g/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345Sktbgp2pg1aTqibQNwGibRoz5pvXWwoorj6VD2lX2rTmsTJ89ykfnndrTvQDJic8Hdj8dVrHUofVgR34g/640?wx_fmt=png&amp;from=appmsg"></span></strong></p><p><strong><span><br></span></strong></p><p><img data-imgfileid="100001208" data-ratio="1" data-src="https://mmbiz.qpic.cn/mmbiz_gif/4TKeL1ZejtlKxOib5kmKX6ic6eX0w0WK5jvhtz9yBRsO3OI4yr6S5iaLNM7AbAeuPDHXMvDdur2DRz9wyiax4lEviag/640?wx_fmt=gif&amp;wxfrom=5&amp;wx_lazy=1" data-type="gif" data-w="240" src="https://mmbiz.qpic.cn/mmbiz_gif/4TKeL1ZejtlKxOib5kmKX6ic6eX0w0WK5jvhtz9yBRsO3OI4yr6S5iaLNM7AbAeuPDHXMvDdur2DRz9wyiax4lEviag/640?wx_fmt=gif&amp;wxfrom=5&amp;wx_lazy=1"><br></p><p><img data-imgfileid="100001207" data-ratio="0.05278592375366569" data-type="other" data-w="341" data-src="https://mmbiz.qpic.cn/mmbiz/4TKeL1Zejtlq03ZOSZiaTlic1MxgdKiaxTbOZ7ZSe0Xx1Ca8xF3L6Nyj1FYUajtYrSmRIHyZVSsAve0EAvEicZONpg/640?wx_fmt=jpeg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" src="https://mmbiz.qpic.cn/mmbiz/4TKeL1Zejtlq03ZOSZiaTlic1MxgdKiaxTbOZ7ZSe0Xx1Ca8xF3L6Nyj1FYUajtYrSmRIHyZVSsAve0EAvEicZONpg/640?wx_fmt=jpeg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"></p><p><strong><span>看完记得顺手点个</span></strong><span><strong><span>“在看”</span></strong></span><strong><span>哦！</span></strong></p><p><strong><span><br></span></strong></p><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/9Hn9dE6bvBVsjMvg5-XcUw",target="_blank" rel="noopener noreferrer">原文链接</a>
