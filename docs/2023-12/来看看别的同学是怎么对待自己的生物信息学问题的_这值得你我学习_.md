---
title: "来看看别的同学是怎么对待自己的生物信息学问题的，这值得你我学习！"
date: 2023-12-04T03:42:10Z
draft: ["false"]
tags: [
  "fetched",
  "生信作曲家"
]
categories: ["Acdemic"]
---
来看看别的同学是怎么对待自己的生物信息学问题的，这值得你我学习！ by 生信作曲家
------
<div><section><blockquote><p>生信作曲家粉丝最近在群里<strong>发了一个word文档，详细地提除了一个问题</strong>：</p><p>最近用GSE9893数据集批量计算单因素coxHR，发现作者上传的数据经过了中心化+log转换，<strong>存在许多负值</strong>，导致跑出来的HR成百上千，<span><strong>考虑用原始数据自己处理表达矩阵</strong>；</span></p></blockquote><section><mpprofile data-pluginname="mpprofile" data-id="MzI5ODI0NzM2OQ==" data-headimg="http://mmbiz.qpic.cn/mmbiz_png/mo60jlFOtaDQIG3BiaPDOAtTJDzqbyPp4crVHnib8fS6Gp6DMjvJJkK9bhPWe6wpNujV93n60FymcjAOfum0t9PA/0?wx_fmt=png" data-nickname="生信作曲家" data-alias="Bioinfo_composer" data-signature="交流生物信息学习经验，分享科研SCI撰写思路和规范，传递最新生物医药资讯。" data-from="0"></mpprofile></section><p><img data-galleryid="" data-ratio="1.5305555555555554" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/mo60jlFOtaA3lqfGbNfpX4ttVRibX5dVdpzOB4uef3qXs9RBndgweAXR3tWMAUs0VNnsOXuCCDTmDzJmUibn3tcA/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/mo60jlFOtaA3lqfGbNfpX4ttVRibX5dVdpzOB4uef3qXs9RBndgweAXR3tWMAUs0VNnsOXuCCDTmDzJmUibn3tcA/640?wx_fmt=png"></p><p><span></span><span>GEO一看，这GSE9893RAW数据竟然是<strong>gpr格式</strong>的，于是我很快找到了gpr芯片处理神技能教程（https://cloud.tencent.com/developer/article/1648570），奇怪的是，作者在GEO只提供了gpr数据，没有教程中提到的target、SpotTypes等文件；我又找了另一篇教程（https://blog.csdn.net/weixin_43569478/article/details/124113928），用他的代码和GSE123273_RAW示例数据，标准化流程跑下来没问题（<strong>文末获取数据链接</strong>）：</span><br></p><pre><code>setwd(<span>"D:/Lab/Workplace/GSE123273_RAW"</span>)<br><br><span>library</span>(limma)<br><br>files0 &lt;- c(<span>"GSM3498849_1.gpr"</span>, <span>"GSM3498850_2.gpr"</span>, <span>"GSM3498851_3.gpr"</span>)<br><br>RG0 &lt;- read.maimages(files0, <span>source</span>=<span>"genepix"</span>)<br>RG1 &lt;- backgroundCorrect(RG0, method=<span>"normexp"</span>)<br>MA0 &lt;- normalizeWithinArrays(RG1)<br></code></pre><p><span>于是我改一改，用到自己需要分析的数据上：</span></p><pre><code>setwd(<span>"D:/Lab/Workplace/GSE9893_RAW"</span>)<br><br>rm(list = ls())<br><br><span>library</span>(limma)<br><br><span>library</span>(ArrayExpress)<br><br><span>#dir()</span><br><br>files &lt;- list.files(path = <span>"."</span>)<br></code></pre><p>结果读取文件就给报错了</p><pre><code>RG &lt;- read.maimages(files, <span>source</span>=<span>"genepix"</span>)<br></code></pre><figure><p><img data-galleryid="" data-ratio="0.05776173285198556" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/mo60jlFOtaA3lqfGbNfpX4ttVRibX5dVdxo3yjEKM2nIYHL8TElwYOCibH5WLWmoElC9YNPG6BgDVyVbLvjJN6BQ/640?wx_fmt=png" data-type="png" data-w="554" src="https://mmbiz.qpic.cn/mmbiz_png/mo60jlFOtaA3lqfGbNfpX4ttVRibX5dVdxo3yjEKM2nIYHL8TElwYOCibH5WLWmoElC9YNPG6BgDVyVbLvjJN6BQ/640?wx_fmt=png"></p><figcaption></figcaption><span><strong>报错见怪不怪了</strong>，去Google快速检索信息了解到</span></figure><p><span>#The arrays used for that experiment were custom <strong>one-color arrays</strong>, so you have to specify the columns by hand:</span></p><p><span>这下可以读取了（<strong>也埋下伏笔</strong>）：</span></p><pre><code>RG &lt;- read.maimages(dir(<span>"."</span>, <span>"^GSM"</span>), columns = list(R = <span>"F635 Median"</span>, Rb = <span>"B635 Median"</span>)) <span>####指定读取两列</span><br></code></pre><p><span>##接下来背景校正，也没问题</span></p><pre><code>RGne &lt;- backgroundCorrect(RG, method=<span>"normexp"</span>, offset=<span>25</span>) <br></code></pre><p><span>但归一化过程又报错了，很不开心：</span></p><p><span>## 归一化 得到的MA文件就类似于表达矩阵的前体了，可以直接拿来做差异分析</span></p><pre><code>MA &lt;- normalizeWithinArrays(RGne)<br></code></pre><figure><p><img data-galleryid="" data-ratio="0.07581227436823104" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/mo60jlFOtaA3lqfGbNfpX4ttVRibX5dVdvkD0IFia3SVU1asLkhgHCswzOhssibA9vWFRibIlEQFgwOSPFNcZCGzmw/640?wx_fmt=png" data-type="png" data-w="554" src="https://mmbiz.qpic.cn/mmbiz_png/mo60jlFOtaA3lqfGbNfpX4ttVRibX5dVdvkD0IFia3SVU1asLkhgHCswzOhssibA9vWFRibIlEQFgwOSPFNcZCGzmw/640?wx_fmt=png"></p><figcaption><br></figcaption></figure><p><span>既然报错了，肯定要找找原因；但我折腾了一晚上发现针对这样的报错信息，<strong>竟然没有找到现成的代码可以解决这个问题</strong>；前面GSE123273示例数据跑起来没问题，说明代码应该是可行的，难道是数据的问题？对比了之后，果然是：</span></p><p><span>GSE123273是<strong>双色array</strong></span></p><figure><p><img data-galleryid="" data-ratio="0.06097560975609756" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/mo60jlFOtaA3lqfGbNfpX4ttVRibX5dVdIb8ficDXuPAYibY52WsoTDddkZR0UGcmd82uZP3nzicCmEqeMgqWwqKiaQ/640?wx_fmt=png" data-type="png" data-w="410" src="https://mmbiz.qpic.cn/mmbiz_png/mo60jlFOtaA3lqfGbNfpX4ttVRibX5dVdIb8ficDXuPAYibY52WsoTDddkZR0UGcmd82uZP3nzicCmEqeMgqWwqKiaQ/640?wx_fmt=png"></p><figcaption><br></figcaption></figure><p><span>而GSE9893应该是<strong>单色array</strong></span></p><figure><p><img data-galleryid="" data-ratio="0.0759493670886076" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/mo60jlFOtaA3lqfGbNfpX4ttVRibX5dVdl6zzOIzPI7BxVbrGYlibyWFXAJQbHORAYSpqORrY66p7FtUJo7lUkYQ/640?wx_fmt=png" data-type="png" data-w="395" src="https://mmbiz.qpic.cn/mmbiz_png/mo60jlFOtaA3lqfGbNfpX4ttVRibX5dVdl6zzOIzPI7BxVbrGYlibyWFXAJQbHORAYSpqORrY66p7FtUJo7lUkYQ/640?wx_fmt=png"></p></figure><p><span>那GSE9893该如何解决呢，呜呜呜，利用我的知识储备和网络资源，我不知道该如何解决了；向大神求助可以嘛，感谢！！！<strong>（以上是word文档地提问内容）</strong></span></p><p><span>呜呜呜，终于打动了群里的大佬，</span><span><strong>生信作曲家的老师抽出宝贵时间来帮我解决问题，超级感动！非常感谢！</strong></span></p><p><span>直接上截图（help就能解决啦），</span><span><strong>单通道样本务必只使用normalizeBetweenArrays</strong></span><span>，双通道样本先within再between：</span></p><figure><p><img data-galleryid="" data-ratio="0.10469314079422383" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/mo60jlFOtaA3lqfGbNfpX4ttVRibX5dVdwwxia5MUia9GwIoV8uQLOAUHibZvzicKBeyxb3jzB2txgDsMLXITkH7d2g/640?wx_fmt=png" data-type="png" data-w="554" src="https://mmbiz.qpic.cn/mmbiz_png/mo60jlFOtaA3lqfGbNfpX4ttVRibX5dVdwwxia5MUia9GwIoV8uQLOAUHibZvzicKBeyxb3jzB2txgDsMLXITkH7d2g/640?wx_fmt=png"></p><figcaption><span></span><br></figcaption></figure><p><span>所以，其实只要把normalizewithinArrays改成normalizeBetweenArrays就好啦</span></p><p><span>我改改代码再看看结果，成功了！！！</span></p><figure><p><img data-galleryid="" data-ratio="0.2914046121593291" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/mo60jlFOtaA3lqfGbNfpX4ttVRibX5dVdeLmarpXG1icSTLficibFjquNSnAtmXjzoG3IdON0Pv2f7sYTx8sQaV0ibw/640?wx_fmt=png" data-type="png" data-w="477" src="https://mmbiz.qpic.cn/mmbiz_png/mo60jlFOtaA3lqfGbNfpX4ttVRibX5dVdeLmarpXG1icSTLficibFjquNSnAtmXjzoG3IdON0Pv2f7sYTx8sQaV0ibw/640?wx_fmt=png"></p><figcaption><span><br></span><br></figcaption></figure><p><span>到这里，我真是要被自己菜哭了</span></p><p><span>接下来，注释gene symbol</span></p><p><span><strong>比较有趣的是，GSE9893其实已经把symbol隐藏在gpr原始文件中了</strong>，不需另外注释哦；其他的数据集如果未直接提供symbol，也可以自己注释啦</span></p><pre><code><span>###干脆读取的时候把gene symbol一起提取出来</span><br>RG &lt;- read.maimages(dir(<span>"."</span>, <span>"^GSM"</span>), columns = list(annotation=<span>"Name"</span>,R = <span>"F635 Median"</span>, Rb = <span>"B635 Median"</span>))<br><span>## 其他操作重复上面的过程咯，接下来增加的是：</span><br>expr &lt;- as.data.frame(MA)<span>##矩阵</span><br></code></pre><pre><code>symbol&lt;-as.data.frame(MA$annotation[,<span>1</span>])<span>##基因，这里相当于列名了，但注意去重</span><br></code></pre><p><strong>总结：遇到问题时，不仅要在百度、</strong>Google<strong>自行查找答案，还要学会借助</strong>help R<strong>函数的说明文件喔（解铃还须系铃人！）；</strong></p><p><span><strong>如果还是不会解决，那就虚心请教大佬！学会提问也是一门艺术噢！</strong></span></p><p><span><strong>感谢生信作曲家团队各位大佬们拔刀相助哈！真的超级有耐心！爱了爱了！</strong></span><span>让小白学习起来更起劲了！继续奋斗叭；请大家指导~~~</span></p><p><span>最后，本次学习所用的数据已上传至百度网盘（永久链接）</span></p><p><span>https://pan.baidu.com/s/1PqxYpjlLSnT_zg-1tjt0aw</span></p><p><span>提取码：74n7</span></p><h3><span>点评</span></h3><p><span>与生信作曲家的交流很重要，当然，这位同学在提出问题的时候非常有心，</span><span><strong>将问题的前因后果**写成了word文档**提出，充分展现了检索和思考的过程，</strong></span><span>让我们很愿意也很期待解决同学的问题。我们也希望更多的 同学如果有生物信息学问题，若能以一个细心的方式和态度提出，我们也将更竭诚为你解答！</span></p><p><strong><span>交流更多，添加管理员 备注加群</span></strong><span><br></span></p><p><img data-galleryid="" data-ratio="1" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/mo60jlFOtaBGpGicRlf1uIRz5z4icMGickywJW7jQIkU4lafb2SfXxTwtD6ia0Twl7EePYmgFGpYULxQ1Ym9GVbKibw/640?wx_fmt=jpeg" data-type="jpeg" data-w="512" src="https://mmbiz.qpic.cn/mmbiz_jpg/mo60jlFOtaBGpGicRlf1uIRz5z4icMGickywJW7jQIkU4lafb2SfXxTwtD6ia0Twl7EePYmgFGpYULxQ1Ym9GVbKibw/640?wx_fmt=jpeg"></p><p><span></span><br></p></section><p><br></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/sTwFEBOTHJL_eXlq5PrgMw",target="_blank" rel="noopener noreferrer">原文链接</a>
