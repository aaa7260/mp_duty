---
title: "替身文学 | 不想用原始数据跑RNA velocity怎么办？来试试VECTOR拟时序方法！"
date: 2023-12-30T09:14:47Z
draft: ["false"]
tags: [
  "fetched",
  "生信作曲家"
]
categories: ["Acdemic"]
---
替身文学 | 不想用原始数据跑RNA velocity怎么办？来试试VECTOR拟时序方法！ by 生信作曲家
------
<div><section><h3><span>前言</span></h3><p>RNA velocity（RNA速率）分析已成为单细胞重要的分析方式，<strong>但是速率分析需要我们对单细胞原始数据进行操作</strong>，比较繁琐，很多同学往往不想去获取原始数据。</p><p>2023年最后一篇推送，我们给大家介绍发表在cell reports上的<span><strong>VECTOR</strong></span>算法，该算法可以获得与速率分析相仿的图，且具备多种附加功能。运行速度快，出图质量高<span></span></p><blockquote><p>Vector包目的是通过根据UMAP中与起始细胞（Starting Cells）的网格距离来推断细胞发育方向的向量。作者发现细胞<strong>主成分值的分位数极化与其在发育层次结构中的状态密切相关</strong>，因此为确定起始细胞提供了一种无监督的解决方案。基于这一发现，作者开发了一个名为VECTOR的工具，用于推断在Uniform Manifold Approximation and Projection（UMAP）中细胞的发育方向矢量。</p></blockquote><figure><figcaption><img data-imgfileid="100004769" data-ratio="0.9294990723562152" data-src="https://mmbiz.qpic.cn/mmbiz_png/mo60jlFOtaAonUsfjVE4sI5xSNyRJ5iblyxPaNpwVtewFEks8qvh6Ld984OVpDJXb7wrgWaDznFsx9ryaMfLXkg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="539" src="https://mmbiz.qpic.cn/mmbiz_png/mo60jlFOtaAonUsfjVE4sI5xSNyRJ5iblyxPaNpwVtewFEks8qvh6Ld984OVpDJXb7wrgWaDznFsx9ryaMfLXkg/640?wx_fmt=png&amp;from=appmsg"></figcaption></figure><figure><figcaption><img data-imgfileid="100004770" data-ratio="0.9920556107249255" data-src="https://mmbiz.qpic.cn/mmbiz_png/mo60jlFOtaAonUsfjVE4sI5xSNyRJ5iblrfqGZ6Poq0A9Hjric9ZQFLTLr5XibgFAjtMqh2SSU6raUhndJPgeDFTQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1007" src="https://mmbiz.qpic.cn/mmbiz_png/mo60jlFOtaAonUsfjVE4sI5xSNyRJ5iblrfqGZ6Poq0A9Hjric9ZQFLTLr5XibgFAjtMqh2SSU6raUhndJPgeDFTQ/640?wx_fmt=png&amp;from=appmsg"></figcaption></figure><h3><span>代码实操</span></h3><pre><code><span># 确保下面的包已装好</span><br><span>#library(igraph)</span><br>install.packages(<span>'circlize'</span>)   <span># 0.4.11</span><br>install.packages(<span>'gatepoints'</span>) <span># 0.1.3</span><br>install.packages(<span>'stringr'</span>)    <span># 1.4.0</span><br>install.packages(<span>'igraph'</span>)     <span># 1.2.6</span><br>install.packages(<span>'gmodels'</span>)    <span># 2.18.1</span><br><span>#library(gmodels)</span><br><br>scRNA=readRDS(<span>'scRNA_T.RDS'</span>)<br>table(scRNA$T_celltype)<br><span>library</span>(Seurat)<br><br>DimPlot(scRNA)<br><span># 左边为幼稚细胞，右下角为耗竭细胞</span><br></code></pre><figure><figcaption><img data-imgfileid="100004771" data-ratio="0.6722222222222223" data-src="https://mmbiz.qpic.cn/mmbiz_png/mo60jlFOtaAonUsfjVE4sI5xSNyRJ5iblx7tsAvu1Jguibr7tEypc1ulQricMqZf0pncUw4xNmMdL53bciboLAoUAA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/mo60jlFOtaAonUsfjVE4sI5xSNyRJ5iblx7tsAvu1Jguibr7tEypc1ulQricMqZf0pncUw4xNmMdL53bciboLAoUAA/640?wx_fmt=png&amp;from=appmsg"></figcaption></figure><pre><code><span>## 获取降维信息</span><br>VEC = scRNA@reductions$umap@cell.embeddings<br>rownames(VEC) = colnames(scRNA)<br>PCA =scRNA@reductions$pca@cell.embeddings<br><br><span>source</span>(<span>'https://raw.githubusercontent.com/jumphone/Vector/master/Vector.R'</span>)<br><br><span># 消除 PC 之间基于量值的共线性 </span><br>PCA=vector.rankPCA(PCA)<br></code></pre><figure><figcaption><img data-imgfileid="100004772" data-ratio="0.5266990291262136" data-src="https://mmbiz.qpic.cn/mmbiz_png/mo60jlFOtaAonUsfjVE4sI5xSNyRJ5ibl5Sxhax2NGRVdm1mHh3KWrYyIcbZibs2DNYAlmffNITVaYKIfpvCh7rw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="824" src="https://mmbiz.qpic.cn/mmbiz_png/mo60jlFOtaAonUsfjVE4sI5xSNyRJ5ibl5Sxhax2NGRVdm1mHh3KWrYyIcbZibs2DNYAlmffNITVaYKIfpvCh7rw/640?wx_fmt=png&amp;from=appmsg"><br><br></figcaption></figure><pre><code><span># 正式运行 后面跟这跑就可以</span><br><span># 定义像素</span><br>OUT=vector.buildGrid(VEC, N=<span>30</span>,SHOW=<span>TRUE</span>)<br><span># 构建网络</span><br>OUT=vector.buildNet(OUT, CUT=<span>1</span>, SHOW=<span>TRUE</span>)<br><span># 计算量子极化 (QP) 分数</span><br>OUT=vector.getValue(OUT, PCA, SHOW=<span>TRUE</span>)<br><span># 获取像素的 QP 分数</span><br>OUT=vector.gridValue(OUT,SHOW=<span>TRUE</span>)<br><span># 找起始点</span><br>OUT=vector.autoCenter(OUT,UP=<span>0.9</span>,SHOW=<span>TRUE</span>)<br><span># 推断向量</span><br>OUT=vector.drawArrow(OUT,P=<span>0.9</span>,SHOW=<span>TRUE</span>, COL=OUT$COL, SHOW.SUMMIT=<span>TRUE</span>)<br><br><span>## 运行过程图展示如下</span><br><br><span># OUT$P.PS 获得拟时序</span><br>OUT$P.PS<br></code></pre><figure><figcaption><img data-imgfileid="100004773" data-ratio="0.5444444444444444" data-src="https://mmbiz.qpic.cn/mmbiz_png/mo60jlFOtaAonUsfjVE4sI5xSNyRJ5iblzH3iaic2phb1eYxoluJ1zL3sOGcG1pznSiblcp5N3cBPibrSo6sGF0VFWg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/mo60jlFOtaAonUsfjVE4sI5xSNyRJ5iblzH3iaic2phb1eYxoluJ1zL3sOGcG1pznSiblcp5N3cBPibrSo6sGF0VFWg/640?wx_fmt=png&amp;from=appmsg"></figcaption></figure><h3><span>附加功能</span></h3><p>VECTOR提供：基因表达量可视化、手动选起点、手动选区、基因和拟时序相关性图，下面的推送将为大家一一解析。加管理员Bio_com获取可复制代码</p><figure><figcaption><img data-imgfileid="100004785" data-ratio="0.9120370370370371" data-src="https://mmbiz.qpic.cn/mmbiz_png/mo60jlFOtaAonUsfjVE4sI5xSNyRJ5iblVgH3DFQoQwgKdaHo4gSwUBeV79fMa3OznYnf3G254TdRvbGJ77za9Q/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/mo60jlFOtaAonUsfjVE4sI5xSNyRJ5iblVgH3DFQoQwgKdaHo4gSwUBeV79fMa3OznYnf3G254TdRvbGJ77za9Q/640?wx_fmt=png&amp;from=appmsg"></figcaption></figure><h4><span>附加功能1：基因表达量可视化</span></h4><p><mp-pay-preview-filter data-offset="17"></mp-pay-preview-filter></p></section></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/tkvNg_xnLem7GoWgabwFxw",target="_blank" rel="noopener noreferrer">原文链接</a>
