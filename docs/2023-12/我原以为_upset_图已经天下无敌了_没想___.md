---
title: "我原以为 upset 图已经天下无敌了，没想..."
date: 2023-12-20T14:53:58Z
draft: ["false"]
tags: [
  "fetched",
  "生信益站"
]
categories: ["Acdemic"]
---
我原以为 upset 图已经天下无敌了，没想... by 生信益站
------
<div><p><span>‍</span></p><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><img data-imgfileid="100020029" data-ratio="0.278125" data-src="https://mmbiz.qpic.cn/sz_mmbiz_gif/mhoJzVKWSibibHsIePCen0Wovf0lNAIYF1cAs8OHXK7L4mfY7EkXCecq37cMmpzIGibvVBp57yYdOM7L3pC03YHqA/640?wx_fmt=gif&amp;from=appmsg" data-type="gif" data-w="640" src="https://mmbiz.qpic.cn/sz_mmbiz_gif/mhoJzVKWSibibHsIePCen0Wovf0lNAIYF1cAs8OHXK7L4mfY7EkXCecq37cMmpzIGibvVBp57yYdOM7L3pC03YHqA/640?wx_fmt=gif&amp;from=appmsg"><p data-tool="mdnice编辑器"><code>生信益站，一点就有益</code>！祝友友们天天开心，早日发 CNS~</p></section><section><mp-common-profile data-pluginname="mpprofile" data-id="MzU1NTk0MTUxMg==" data-headimg="http://mmbiz.qpic.cn/mmbiz_png/mhoJzVKWSibicV5ezibIjic3zhPgzQcTD8N0hm3q2fO2QgBoVFIuRWy6BKffGjfXOzI7foLDlyrHWfRUMkicOCSKq4g/0?wx_fmt=png" data-nickname="生信益站" data-alias="" data-signature="生物信息或基因测序数据分析、软件算法、科研绘图、Python/Perl/R代码分享。" data-from="0" data-is_biz_ban="0"></mp-common-profile></section><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><blockquote data-tool="mdnice编辑器"><span>❝</span><p>识别具有<code>共享特征</code>的对象集是所有学科中的常见操作。分析多个集合之间的交集是深入理解其复杂关系的基础。然而，<span>到目前为止，还没有开发出方法来评估</span><code><span>三个或更多集合</span></code><span>之间的交集的</span><code><span>统计显著性</span></code>。此外，用于多集交叉点可视化的最先进方法是不可扩展的。</p><span>❞</span></blockquote><p data-tool="mdnice编辑器">在这里，作者首先开发了一个基于组合理论计算多集交集统计分布的理论框架，然后相应地设计了一个程序来有效计算多集交集的精确概率。作者进一步开发了多种高效且可扩展的技术来可视化多集交叉点和相应的交叉点统计数据。</p><p data-tool="mdnice编辑器">作者在统一的 <code>R</code> 软件包<code>SuperExactTest</code>中实现了理论框架和可视化技术。<span>作者通过深入的模拟研究和对七个独立策划的癌症基因集以及全基因组关联研究确定的六个疾病或性状相关基因集的综合分析</span>，展示了<code>SuperExactTest</code>的实用性。最后，作者预计本研究开发的<code>SuperExactTest</code>将在许多学科的科学数据分析中具有广泛的应用[1]。</p><p data-tool="mdnice编辑器"><span>一个常见应用就是多个基因/蛋白集合交集的统计检验。</span></p><h2 data-tool="mdnice编辑器"><span></span><span>示例</span><span></span></h2><h4 data-tool="mdnice编辑器"><span></span><span><span></span>1. 显示选定的重叠元素</span><span></span></h4><pre data-tool="mdnice编辑器"><span></span><code><span>library</span>(SuperExactTest)<br>set.seed(<span>1234</span>)<br><span># generate random strings</span><br>n=<span>400</span><br>r_strings &lt;- do.call(paste0, replicate(<span>5</span>, sample(LETTERS, n, <span>TRUE</span>), <span>FALSE</span>))<br>input=lapply(c(<span>40</span>,<span>60</span>,<span>80</span>,<span>200</span>),<span>function</span>(x,s) sample(s,x),s=r_strings)<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100020025" data-ratio="0.6407407407407407" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/mhoJzVKWSibibHsIePCen0Wovf0lNAIYF16u9iaGT8vBpV51RoT5xqltnSE1cVxzQCm9AiagdN9icvcYFfIRYHket4Q/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/mhoJzVKWSibibHsIePCen0Wovf0lNAIYF16u9iaGT8vBpV51RoT5xqltnSE1cVxzQCm9AiagdN9icvcYFfIRYHket4Q/640?wx_fmt=png&amp;from=appmsg"></figure><pre data-tool="mdnice编辑器"><span></span><code>Result=supertest(input,n=n)<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100020026" data-ratio="0.5871212121212122" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/mhoJzVKWSibibHsIePCen0Wovf0lNAIYF1XkkgBmlHTGNojjZseibkQqMgicoagpkObuSvP1GfO5Pm8IAkDibAVoXcg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1056" src="https://mmbiz.qpic.cn/sz_mmbiz_png/mhoJzVKWSibibHsIePCen0Wovf0lNAIYF1XkkgBmlHTGNojjZseibkQqMgicoagpkObuSvP1GfO5Pm8IAkDibAVoXcg/640?wx_fmt=png&amp;from=appmsg"></figure><pre data-tool="mdnice编辑器"><span></span><code><span># Plot the intersections with a split y-axis and</span><br><span># show elements of the intersections with no more than 20 elements</span><br><span># png('examples/ex1.png',width=2000,height=2000,res=300)</span><br>plot(Result, Layout=<span>"landscape"</span>, sort.by=<span>"size"</span>, keep=FALSE,<br>    bar.split=c(70,180), show.elements=TRUE, elements.cex=0.7,<br>    elements.list=subset(summary(Result)<span>$Table</span>,Observed.Overlap &lt;= 20),<br>    show.expected.overlap=TRUE,expected.overlap.style=<span>"hatchedBox"</span>,<br>    color.expected.overlap=<span>'red'</span>)<br><span># dev.off()</span><br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100020027" data-ratio="1" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/mhoJzVKWSibibHsIePCen0Wovf0lNAIYF1ZEZPxuZSnFtbbh5RPwrh59tCj7Q2SWic1Geic38WfXE8CJZoKgtQLYBA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/mhoJzVKWSibibHsIePCen0Wovf0lNAIYF1ZEZPxuZSnFtbbh5RPwrh59tCj7Q2SWic1Geic38WfXE8CJZoKgtQLYBA/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器"><code>color.on</code>通过设置为 <code>NULL</code> 或颜色向量来分配离散颜色来表示每个交集中涉及的集合。</p><pre data-tool="mdnice编辑器"><span></span><code><span># png('examples/ex1color.png',width=2000,height=2000,res=300)</span><br>plot(Result, Layout=<span>"landscape"</span>, sort.by=<span>"size"</span>, keep=<span>FALSE</span>,<br>    bar.split=c(<span>70</span>,<span>180</span>), show.elements=<span>TRUE</span>, elements.cex=<span>0.7</span>,<br>    elements.list=subset(summary(Result)$Table,Observed.Overlap &lt;= <span>20</span>),<br>    show.expected.overlap=<span>TRUE</span>,expected.overlap.style=<span>"hatchedBox"</span>,<br>    color.expected.overlap=<span>'red'</span>, color.on = <span>NULL</span>)<br><span># dev.off()</span><br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100020028" data-ratio="1" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/mhoJzVKWSibibHsIePCen0Wovf0lNAIYF1Er9wyRkXZTJIvl0vjlNw0oR9MwwBzOW4M78VNKxndkrykia0BZSibx3w/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/mhoJzVKWSibibHsIePCen0Wovf0lNAIYF1Er9wyRkXZTJIvl0vjlNw0oR9MwwBzOW4M78VNKxndkrykia0BZSibx3w/640?wx_fmt=png&amp;from=appmsg"><figcaption><span></span>注意看下面圆圈的颜色</figcaption></figure><h4 data-tool="mdnice编辑器"><span></span><span><span></span>2. 对交叉条进行排序</span><span></span></h4><p data-tool="mdnice编辑器">从 <code>1.0.7</code> 版本开始，我们可以通过 <code>sort.by</code> 以自定义的方式<code>更改交叉条的顺序</code>。例如，让我们交换上图中第<code>四</code>和第<code>五</code>条的顺序。</p><pre data-tool="mdnice编辑器"><span></span><code><span># First extract the intersection barcodes ordered by size</span><br>order1=names(sort(Result<span>$overlap</span>.sizes,decreasing=TRUE))<br><span># Then switch the orders of the fourth and fifth element</span><br>order2=order1[c(1:3,5,4,6:length(order1))]<br><span>print</span>(order1)<br><span>print</span>(order2)<br><span># Now plot with the new order</span><br><span># png('examples/ex2.png',width=2000,height=2000,res=300)</span><br>plot(Result, Layout=<span>"landscape"</span>, sort.by=order2, keep=FALSE,<br>     bar.split=c(70,180), show.elements=TRUE, elements.cex=0.7,<br>     elements.list=subset(summary(Result)<span>$Table</span>,Observed.Overlap &lt;= 20),<br>     show.expected.overlap=TRUE,expected.overlap.style=<span>"hatchedBox"</span>,<br>     color.expected.overlap=<span>'red'</span>, color.on = NULL)<br><span># dev.off()</span><br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100020032" data-ratio="1" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/mhoJzVKWSibibHsIePCen0Wovf0lNAIYF1oeVWxsnaiafiakObXEgDyEOF63kGfjAMTQlvdKaT3ryEmHxYJaib60Gtw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/mhoJzVKWSibibHsIePCen0Wovf0lNAIYF1oeVWxsnaiafiakObXEgDyEOF63kGfjAMTQlvdKaT3ryEmHxYJaib60Gtw/640?wx_fmt=png&amp;from=appmsg"><figcaption><span></span>注意看33，40两条柱子交换了顺序</figcaption></figure><h4 data-tool="mdnice编辑器"><span></span><span><span></span>3. 上下翻转</span><span></span></h4><p data-tool="mdnice编辑器">我们还可以使用选项 <code>Flip.vertical=TRUE</code> 将条形<code>翻转</code>。</p><pre data-tool="mdnice编辑器"><span></span><code><span># png('examples/ex3.png',width=2000,height=2000,res=300)</span><br>plot(Result, Layout=<span>"landscape"</span>, sort.by=order2, keep=<span>FALSE</span>,<br>     bar.split=c(<span>70</span>,<span>180</span>), show.elements=<span>TRUE</span>, elements.cex=<span>0.7</span>,<br>     elements.list=subset(summary(Result)$Table,Observed.Overlap &lt;= <span>20</span>),<br>     show.expected.overlap=<span>TRUE</span>,expected.overlap.style=<span>"hatchedBox"</span>,<br>     color.expected.overlap=<span>'red'</span>, color.on = <span>NULL</span>, flip.vertical=<span>TRUE</span>)<br><span># dev.off()</span><br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100020030" data-ratio="1" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/mhoJzVKWSibibHsIePCen0Wovf0lNAIYF18eLTWsO8aXYah11b3cvMQbyxHicM2kOVyHIPic31qdBdTymudicB3pf6g/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/mhoJzVKWSibibHsIePCen0Wovf0lNAIYF18eLTWsO8aXYah11b3cvMQbyxHicM2kOVyHIPic31qdBdTymudicB3pf6g/640?wx_fmt=png&amp;from=appmsg"></figure><h4 data-tool="mdnice编辑器"><span></span><span><span></span>4. 显示倍数富集</span><span></span></h4><p data-tool="mdnice编辑器">在条形顶部显示<code>倍数富集</code>而不是 <code>overlap 大小</code>（自 v1.0.7.1 起）。</p><pre data-tool="mdnice编辑器"><span></span><code><span># png('examples/ex4.png',width=2000,height=2000,res=300)</span><br>plot(Result, Layout=<span>"landscape"</span>, sort.by=order2, keep=<span>FALSE</span>,<br>     bar.split=c(<span>70</span>,<span>180</span>), show.elements=<span>TRUE</span>, elements.cex=<span>0.7</span>,<br>     show.fold.enrichment=<span>TRUE</span>,<br>     elements.list=subset(summary(Result)$Table,Observed.Overlap &lt;= <span>20</span>),elements.rot=<span>45</span>,<br>     show.expected.overlap=<span>TRUE</span>,expected.overlap.style=<span>"hatchedBox"</span>,<br>     color.expected.overlap=<span>'red'</span>, color.on = <span>NULL</span>)<br><span># dev.off()</span><br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100020031" data-ratio="1" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/mhoJzVKWSibibHsIePCen0Wovf0lNAIYF1By7Ic96tY0d1RZeuQCsI6ibUFk5h9QRdiblYibXAZZ6yIgjJGJ5SiaZwpw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/mhoJzVKWSibibHsIePCen0Wovf0lNAIYF1By7Ic96tY0d1RZeuQCsI6ibUFk5h9QRdiblYibXAZZ6yIgjJGJ5SiaZwpw/640?wx_fmt=png&amp;from=appmsg"><figcaption><span></span>注意条形图上方变成了倍数</figcaption></figure><h4 data-tool="mdnice编辑器"><span></span><span><span></span>5. 将多个 SuperExactTest 图放在同一页上</span><span></span></h4><blockquote data-tool="mdnice编辑器"><span>❝</span><p>大饼卷一切？果然，卷图的最高境界就是圈图。</p><span>❞</span></blockquote><p data-tool="mdnice编辑器">我们可以通过设置 <code>new.gridPage = FALSE</code> 在同一页面上组合多个 <code>SuperExactTest</code> 图。例如，要并排排列两个 <code>SuperExactTest</code> 图形，我们可以：</p><pre data-tool="mdnice编辑器"><span></span><code><span># png('examples/ex5.png',width=4000,height=2000,res=300)</span><br>grid.newpage()<br>vp0 &lt;- viewport(layout = grid.layout(<span>1</span>, <span>2</span>))<br>vp1 &lt;- viewport(layout.pos.col = <span>1</span>, layout.pos.row = <span>1</span>, name = <span>"plot_left"</span>)<br>vp2 &lt;- viewport(layout.pos.col = <span>2</span>, layout.pos.row = <span>1</span>, name = <span>"plot_right"</span>)<br>vps &lt;- vpTree(vp0, vpList(vp1, vp2))<br><br>pushViewport(vps)<br><br>seekViewport(<span>"plot_left"</span>)<br>plot(Result, Layout=<span>"landscape"</span>, sort.by=<span>'size'</span>, keep=<span>FALSE</span>,<br>     bar.split=c(<span>70</span>,<span>180</span>), show.fold.enrichment=<span>TRUE</span>,<br>     show.expected.overlap=<span>TRUE</span>, expected.overlap.style=<span>"hatchedBox"</span>,<br>     color.expected.overlap=<span>'red'</span>, color.on = <span>NULL</span>,<br>     title = <span>'Figure A. Landscape layout'</span>, new.gridPage = <span>FALSE</span>)<br><br>seekViewport(<span>"plot_right"</span>)<br>plot(Result, Layout=<span>"circular"</span>, sort.by=<span>'size'</span>, keep=<span>FALSE</span>,<br>     show.expected.overlap=<span>TRUE</span>,expected.overlap.style=<span>"hatchedBox"</span>,<br>     color.expected.overlap=<span>'red'</span>, color.on = <span>NULL</span>,<br>     title = <span>'Figure B. Circular layout'</span>, new.gridPage = <span>FALSE</span>)<br><span># dev.off()</span><br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100020033" data-ratio="0.5" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/mhoJzVKWSibibHsIePCen0Wovf0lNAIYF1O2LIzRkmK6gXAY3Kk8m63W01PhxxlRrlUOv1SGSdZbDR9G3ia7Wia9Eg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/mhoJzVKWSibibHsIePCen0Wovf0lNAIYF1O2LIzRkmK6gXAY3Kk8m63W01PhxxlRrlUOv1SGSdZbDR9G3ia7Wia9Eg/640?wx_fmt=png&amp;from=appmsg"><figcaption><span></span>太赞了！左边条形图，右边掰弯的条形图</figcaption></figure><h2 data-tool="mdnice编辑器"><span></span><span>参考文献</span><span></span></h2><p data-tool="mdnice编辑器">[1] Wang, M., Zhao, Y. &amp; Zhang, B. Efficient Test and Visualization of Multi-Set Intersections. Sci Rep 5, 16923 (2015). https://doi.org/10.1038/srep16923</p><hr data-tool="mdnice编辑器"><p data-tool="mdnice编辑器">OK，今天的分享到此为止，您学会了吗？</p><p data-tool="mdnice编辑器">您的<code>关注、点赞、在看、转发</code>是对益站最大的<code>鼓励和支持</code>哈。</p><figure data-tool="mdnice编辑器"><img data-imgfileid="100020034" data-ratio="1" data-src="https://mmbiz.qpic.cn/sz_mmbiz_gif/mhoJzVKWSibibHsIePCen0Wovf0lNAIYF1yH28Z3JaQjQsTjf1afBCwfhD2IibUFDJoSyMfoIaiaKnx9SGrTTO6OQw/640?wx_fmt=gif&amp;from=appmsg" data-type="gif" data-w="240" src="https://mmbiz.qpic.cn/sz_mmbiz_gif/mhoJzVKWSibibHsIePCen0Wovf0lNAIYF1yH28Z3JaQjQsTjf1afBCwfhD2IibUFDJoSyMfoIaiaKnx9SGrTTO6OQw/640?wx_fmt=gif&amp;from=appmsg"></figure><h2 data-tool="mdnice编辑器"><span></span><span>联系站长</span><span></span></h2><blockquote data-tool="mdnice编辑器"><span>❝</span><p>对本篇文章有疑问，或者有<code>科研服务需求</code>的友友可以在益站<code>发消息留言</code>，也欢迎各位童鞋<code>扫下面的二维码</code>加入我们的 <code>QQ</code> 交流群。</p><span>❞</span></blockquote><figure data-tool="mdnice编辑器"><img data-imgfileid="100020038" data-ratio="1.5" data-src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/mhoJzVKWSibibHsIePCen0Wovf0lNAIYF1BaJmAjfyBxXRh2UxTdFJ8LGyokos95lKQck3icJkS3s8NSFEhGGj9xA/640?wx_fmt=jpeg&amp;from=appmsg" data-type="jpeg" data-w="512" src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/mhoJzVKWSibibHsIePCen0Wovf0lNAIYF1BaJmAjfyBxXRh2UxTdFJ8LGyokos95lKQck3icJkS3s8NSFEhGGj9xA/640?wx_fmt=jpeg&amp;from=appmsg"><figcaption><span></span>最新QQ群</figcaption></figure><figure data-tool="mdnice编辑器"><img data-imgfileid="100020039" data-ratio="0.7277777777777777" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/mhoJzVKWSibibHsIePCen0Wovf0lNAIYF1uskq4W5RVM4b15xn2Hnf8MwUodpdFYZdaPMKV3iaoWRkME6YjpwQG6Q/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/mhoJzVKWSibibHsIePCen0Wovf0lNAIYF1uskq4W5RVM4b15xn2Hnf8MwUodpdFYZdaPMKV3iaoWRkME6YjpwQG6Q/640?wx_fmt=png&amp;from=appmsg"><figcaption><span></span>科研服务</figcaption></figure></section><section><mp-common-profile data-pluginname="mpprofile" data-id="MzU1NTk0MTUxMg==" data-headimg="http://mmbiz.qpic.cn/mmbiz_png/mhoJzVKWSibicV5ezibIjic3zhPgzQcTD8N0hm3q2fO2QgBoVFIuRWy6BKffGjfXOzI7foLDlyrHWfRUMkicOCSKq4g/0?wx_fmt=png" data-nickname="生信益站" data-alias="" data-signature="生物信息或基因测序数据分析、软件算法、科研绘图、Python/Perl/R代码分享。" data-from="0" data-is_biz_ban="0"></mp-common-profile></section></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/4jq4XwtubDazELw3TrVFGA",target="_blank" rel="noopener noreferrer">原文链接</a>
