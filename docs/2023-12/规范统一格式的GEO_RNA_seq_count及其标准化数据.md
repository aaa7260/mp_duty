---
title: "规范统一格式的GEO RNA-seq count及其标准化数据"
date: 2023-12-27T04:18:46Z
draft: ["false"]
tags: [
  "fetched",
  "生信星球"
]
categories: ["Acdemic"]
---
规范统一格式的GEO RNA-seq count及其标准化数据 by 生信星球
------
<div><section data-mpa-powered-by="yiban.io"><br></section><section><span>‍</span></section><section><img data-ratio="1" data-src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHrDic8XGmJ0b7oibVJajb0emLBHSvuibGG49ooBgtaAibE3TNJ00iaHviaMtdIKQJfCwtUfuHicDImtSfIxg/640?wx_fmt=png" data-type="png" data-w="64" width="20px" data-imgfileid="100010426" src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHrDic8XGmJ0b7oibVJajb0emLBHSvuibGG49ooBgtaAibE3TNJ00iaHviaMtdIKQJfCwtUfuHicDImtSfIxg/640?wx_fmt=png"><img data-ratio="1" data-src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHrDic8XGmJ0b7oibVJajb0emLPukRHCbicy4pNKeEv9qd7aWSfsx7roib2od3xPrRPicw3a0kbn0uQ6JmQ/640?wx_fmt=png" data-type="png" data-w="64" width="20px" data-imgfileid="100010425" src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHrDic8XGmJ0b7oibVJajb0emLPukRHCbicy4pNKeEv9qd7aWSfsx7roib2od3xPrRPicw3a0kbn0uQ6JmQ/640?wx_fmt=png"><span> 今天是生信星球陪你的<span><strong>第931天</strong></span></span><img data-imgfileid="100010428" data-ratio="1" data-src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHrDic8XGmJ0b7oibVJajb0emLBHSvuibGG49ooBgtaAibE3TNJ00iaHviaMtdIKQJfCwtUfuHicDImtSfIxg/640?wx_fmt=png" data-type="png" data-w="64" width="20px" src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHrDic8XGmJ0b7oibVJajb0emLBHSvuibGG49ooBgtaAibE3TNJ00iaHviaMtdIKQJfCwtUfuHicDImtSfIxg/640?wx_fmt=png"></section><hr><section><span><span>   </span><span>大神一句话，菜鸟跑半年。我不是大神，但我可以缩短你走弯路的半年~</span></span></section><section><span>   就像歌儿唱的那样，如果你不知道该往哪儿走，就留在这学点生信好不好~</span></section><p><span>   这里有豆豆和花花的学习历程，从新手到进阶，生信路上有你有我！</span></p><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><blockquote data-tool="mdnice编辑器"><p>参考网址：https://www.ncbi.nlm.nih.gov/geo/info/rnaseqcounts.html#why</p></blockquote><h3 data-tool="mdnice编辑器"><span></span><span>0.痛点</span><span></span></h3><p data-tool="mdnice编辑器">GEO网站的芯片数据是有统一格式的，都放在series.matrix.txt.gz文件里面了。但是RNA-seq数据，series.matrix.txt.gz文件里只能拿到临床信息（表型信息），而表达矩阵却是空的。大多数的作者在supplementary file里面提供了表达矩阵，格式不受任何限制，xls格式、csv、tsv、txt都有，最麻烦的是那种每个样本一个文件，需要自行读取并合并成矩阵的。例如：<img data-imgfileid="100010444" data-ratio="0.09814814814814815" data-src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHono92YNezVzRhwoibO3nNkaib0szUM4HtXPV6RS6KS2p5mnKXgmYeKP2q2beJ411tSpW0siamg6qMFA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHono92YNezVzRhwoibO3nNkaib0szUM4HtXPV6RS6KS2p5mnKXgmYeKP2q2beJ411tSpW0siamg6qMFA/640?wx_fmt=png&amp;from=appmsg"><img data-imgfileid="100010445" data-ratio="0.09351851851851851" data-src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHono92YNezVzRhwoibO3nNkaKicxzb7MiaytiaYWZnVF1nHHhDAVan5kxHbZX50yZDicJ5utHrqibtLiaWFQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHono92YNezVzRhwoibO3nNkaKicxzb7MiaytiaYWZnVF1nHHhDAVan5kxHbZX50yZDicJ5utHrqibtLiaWFQ/640?wx_fmt=png&amp;from=appmsg"><img data-imgfileid="100010447" data-ratio="0.6231481481481481" data-src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHono92YNezVzRhwoibO3nNkaXvIpg1cDb7KSFnoS8hroRD9I414dkPuIdJb42BFFP8IDIpOrV4wL1w/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHono92YNezVzRhwoibO3nNkaXvIpg1cDb7KSFnoS8hroRD9I414dkPuIdJb42BFFP8IDIpOrV4wL1w/640?wx_fmt=png&amp;from=appmsg"><img data-imgfileid="100010443" data-ratio="0.10277777777777777" data-src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHono92YNezVzRhwoibO3nNkaGbexIfRGMABv9hAuEVx6DbgW5OXUEiaEpibzo51Sic0IgHQlFxdyHwkAA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHono92YNezVzRhwoibO3nNkaGbexIfRGMABv9hAuEVx6DbgW5OXUEiaEpibzo51Sic0IgHQlFxdyHwkAA/640?wx_fmt=png&amp;from=appmsg">还有的数据<span><strong>没有提供</strong></span>差异分析所需使用的count，而是提供了<span><strong>rpkm、tpm、fpkm</strong></span>等标准化后的数据，这些数据不适合用作差异分析，且<span><strong>不能再逆转回count</strong></span>，这就使得GEO的RNA-seq数据的前期整理过程比较难搞。</p><h3 data-tool="mdnice编辑器"><span></span><span>1.统一格式的转录组数据来啦</span><span></span></h3><p data-tool="mdnice编辑器">GEO是NCBI旗下的网站，为了提高存量RNA-seq数据的利用率，SRA 和 GEO 团队搭建了一套流程，统一计算 RNA-seq 基因表达矩阵，方便进行差异分析和可视化。</p><h3 data-tool="mdnice编辑器"><span></span><span>2.范围</span><span></span></h3><p data-tool="mdnice编辑器">提交给 GEO 的<span><strong>人类和小鼠 RNA-seq </strong></span>数据，人类数据已经可用，小鼠数据官方说2023年秋季上线，但今天（2023.12.27）目前暂时还不能用，估计快了。原有数据已经可用，新提交的数据大约需要等待<span><strong>一周</strong></span>时间</p><h3 data-tool="mdnice编辑器"><span></span><span>3.可用文件</span><span></span></h3><p data-tool="mdnice编辑器">count、rpkm、tpm、基因注释表格</p><h3 data-tool="mdnice编辑器"><span></span><span>4.流程</span><span></span></h3><p data-tool="mdnice编辑器">HISAT2→Subread featureCounts</p><h3 data-tool="mdnice编辑器"><span></span><span>5.如何获取</span><span></span></h3><p data-tool="mdnice编辑器">举个栗子，这是GSE204753的页面，其他数据改编号即可https://www.ncbi.nlm.nih.gov/geo/download/?type=rnaseq_counts&amp;acc=GSE204753<img data-imgfileid="100010446" data-ratio="0.9089005235602095" data-src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHono92YNezVzRhwoibO3nNkaCfGwkNicronXIrhQHHJ46pUiaEHcVNarcw0EJKBibxiaYq6Pa2qhh8HV0A/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="955" src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHono92YNezVzRhwoibO3nNkaCfGwkNicronXIrhQHHJ46pUiaEHcVNarcw0EJKBibxiaYq6Pa2qhh8HV0A/640?wx_fmt=png&amp;from=appmsg">https://www.ncbi.nlm.nih.gov/geo/download/?type=rnaseq_counts&amp;acc=GSE164073&amp;format=file&amp;file=GSE164073_raw_counts_GRCh38.p13_NCBI.tsv.gz.</p><p data-tool="mdnice编辑器">在上面这个链接里<span><strong>替换GSE编号</strong></span>即可。不大喜欢多次复制粘贴改来改去，所以我在2.3.2以上版本的tinyarray中加入了一个函数：<span><strong>get_count_txt</strong></span>，目前这个版本只在github上。预计要<span><strong>2024年1月中旬</strong></span>才能出现在cran上啦。下载方式</p><pre data-tool="mdnice编辑器"><span></span><code>devtools::install_github(<span>"xjsun1221/tinyarray"</span>) <span>#2024年1月中旬以前用这个</span><br>install.packages(<span>"tinyarray"</span>)<span>#2024年1月中旬以后用这个</span><br></code></pre><p data-tool="mdnice编辑器">使用方式</p><pre data-tool="mdnice编辑器"><span></span><code><span>library</span>(tinyarray)<br>get_count_txt(<span>"GSE204753"</span>)<br><span>## https://www.ncbi.nlm.nih.gov/geo/download/?type=rnaseq_counts&amp;acc=GSE204753&amp;format=file&amp;file=GSE204753_raw_counts_GRCh38.p13_NCBI.tsv.gz</span><br></code></pre><p data-tool="mdnice编辑器">出现的网址就是上面那个网址替换你的编号的结果啦。这样就不用总是复制粘贴了。 </p><p data-tool="mdnice编辑器">我还顺便写了一个转换行名为symbol的函数嘞。是用<span><strong>bitr函数</strong></span>转换的id。</p><pre data-tool="mdnice编辑器"><span></span><code>dat = read.delim(<span>"GSE204753_raw_counts_GRCh38.p13_NCBI.tsv.gz"</span>,<br>               row.names = 1)<br>dat[1:4,1:4]<br><span>##           GSM6190621 GSM6190623 GSM6190624 GSM6190625</span><br><span>## 100287102          6          5          7          7</span><br><span>## 653635            10         12         18         17</span><br><span>## 102466751          0          0          0          0</span><br><span>## 107985730          0          0          0          0</span><br></code></pre><pre data-tool="mdnice编辑器"><span></span><code>exp = trans_entrezexp(dat)<br><span>## 'select()' returned 1:1 mapping between keys and columns</span><br><span>## Warning in clusterProfiler::bitr(rownames(entrezexp), fromType = "ENTREZID", :</span><br><span>## 4.17% of input gene IDs are fail to map...</span><br><span>## 37734 rownames transformed after duplicate rows removed</span><br></code></pre><pre data-tool="mdnice编辑器"><span></span><code>exp[1:4,1:4]<br><span>##             GSM6190621 GSM6190623 GSM6190624 GSM6190625</span><br><span>## DDX11L1              6          5          7          7</span><br><span>## WASH7P              10         12         18         17</span><br><span>## MIR6859-1            0          0          0          0</span><br><span>## MIR1302-2HG          0          0          0          0</span><br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span>6.注意事项</span><span></span></h3><h4 data-tool="mdnice编辑器"><span><span> </span></span><span><span> </span>(1) NCBI生成的表达矩阵未必与数据提交者上传的数据完全一致</span><span><span> </span></span></h4><p data-tool="mdnice编辑器">因NCBI流程与数据提交者使用的软件、参数的不同，有所差别属于正常现象。</p><h4 data-tool="mdnice编辑器"><span><span> </span></span><span><span> </span>(2) 质控</span><span><span> </span></span></h4><blockquote data-tool="mdnice编辑器"><p>The only parameter a run must pass for inclusion in the NCBI pipeline is that the run is of type 'transcriptomic' and it has a genome alignment rate over 50%.</p></blockquote><p data-tool="mdnice编辑器">type必须是转录组，且<span><strong>比对率超过50%</strong></span></p><h4 data-tool="mdnice编辑器"><span><span> </span></span><span><span> </span>(3) 检查样本是否具有可比性</span><span><span> </span></span></h4><p data-tool="mdnice编辑器">提交者经常在同一研究中存放<strong><span>多种类型</span></strong>的数据（例如，RNA-seq和RIP-seq），这意味着即使在同一个矩阵中，RNA counts也无法直接比较。或者，尽管样本属于<strong><span>同一类型</span></strong>，但它们可能仍然不用于比较。需要查看原始记录，以确定<strong><span>研究中的所有样本是否都打算直接比较</span></strong>。</p><h4 data-tool="mdnice编辑器"><span><span> </span></span><span><span> </span>(4)不同研究的count比较时要谨慎</span><span><span> </span></span></h4><p data-tool="mdnice编辑器">尽管所有NCBIcount数据都是由同一流程生成的，但如果试图比较<strong><span></span></strong>不同研究的count，应特别小心。NCBI 流程没有矫正不同实验室的差别或者其他混杂因素。</p><h4 data-tool="mdnice编辑器"><span><span> </span></span><span><span> </span>(5)标准化矩阵文件可能未充分标准化</span><span><span> </span></span></h4><blockquote data-tool="mdnice编辑器"><p>当<strong><span>总 RNA 含量及其分布差异很大</span></strong>时，FPKM （RPKM） 和 TPM 不应用于样品间的定量比较 。正如Zhao等人所讨论的，“一个常见的误解是RPKM和TPM值已经标准化，因此应该在样本或RNA-seq项目中具有可比性。然而，RPKM 和 TPM 代表测序总体中转录本的相对丰度，因此取决于样品中 RNA 总体的组成。通常，可以合理地假设总RNA浓度和分布在比较样品中非常接近。然而，在不同的实验条件下和/或不同测序方案中，测序的RNA库可能存在显着差异;因此，在这种情况下，基因表达的比例不能直接比较”。</p></blockquote><h4 data-tool="mdnice编辑器"><span><span> </span></span><span><span> </span>(6)样本缺失</span><span><span> </span></span></h4><p data-tool="mdnice编辑器"><strong><span>没达到50% 比对率</span></strong>的样本会被删掉，或者有的样本会因<strong><span>技术原因</span></strong>处理失败。</p></section><section><blockquote><section><span>如果因为代码看不懂，而跟不上正文的节奏，可以来找我，相当于来一个新手保护期。我的课程都是循环开课。下一期的时间，点进去咨询微信咯</span><br></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU4NjU4ODQ2MQ==&amp;mid=2247494009&amp;idx=1&amp;sn=035d253f973f65c0d1069e515eec2ce8&amp;chksm=fdfba13bca8c282de5a9222a2ab8bc0caa2ddf60cab543c2181e6d4a90b553f4dcde5f154adf&amp;scene=21#wechat_redirect" textvalue="生信分析直‍播课程" linktype="text" imgurl="" imgdata="null" data-itemshowtype="11" tab="innerlink" data-linktype="2">生信分析直播课程</a></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU4NjU4ODQ2MQ==&amp;mid=2247493905&amp;idx=2&amp;sn=afdbf9decef9bf286bc065e2b6f76119&amp;chksm=fdfba153ca8c2845cae9cf55c18d1988b14c1906164fe2bb73a54cb9d9e3b875dc7a2f8c1596&amp;scene=21#wechat_redirect" textvalue="生信新手保护学习小组长期报名中" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2">生信新手保护学习小组</a><br></section></blockquote></section><section><section><br></section></section><section><br></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/Wq0vlCfzIVoRr0BmZ4dZvg",target="_blank" rel="noopener noreferrer">原文链接</a>
