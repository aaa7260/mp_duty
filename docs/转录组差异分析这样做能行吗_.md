---
title: "转录组差异分析这样做能行吗？"
date: 2022-10-19T04:38:35Z
draft: ["false"]
tags: [
  "fetched",
  "生信菜鸟团"
]
categories: ["Acdemic"]
---
转录组差异分析这样做能行吗？ by 生信菜鸟团
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><h2 data-tool="mdnice编辑器"><span></span><span>缘起</span><span></span></h2><p data-tool="mdnice编辑器">前段时间，我们分享了<a href="https://mp.weixin.qq.com/s?__biz=MzUzMTEwODk0Ng==&amp;mid=2247506796&amp;idx=1&amp;sn=aa02ccb3fde52260672471bcf80e70ff&amp;scene=21#wechat_redirect" data-linktype="2">转录组三种常见差异分析的推文</a>以及<a href="https://mp.weixin.qq.com/s?__biz=MzUzMTEwODk0Ng==&amp;mid=2247506188&amp;idx=1&amp;sn=63d8e3afa55a3276f8e785e29e1ec234&amp;scene=21#wechat_redirect" data-linktype="2">单样本1V1进行差异分析的推文</a>。对单个样本进行差异分析时，我们能获得相应的差异基因。在转录组三种常见差异分析的推文中，我们利用取交集的方式看了下三种方法获得共同差异基因的交集情况。曾老师提出了一个有趣的猜想，试想如果我们将3V3的样本拆分成3次1V1进行差异分析，是否会出现什么有趣的现象呢。为了让结果可比，我们就用上次的数据集GSE190114吧。此次，我们除了关注3次1V1差异分析上调与下调差异基因分别共同的交集情况之外，还将关注3种常见分析方法的上调与下调差异基因分别与拆分成3次1V1差异分析的上调与下调差异基因的共同交集情况，<strong>「用于探究是否能够拆分成3次1V1后进行差异分析」</strong>。话不多说，由于此次所使用的数据与上次一样，对此次的探究描述与数据集介绍感兴趣的小伙伴，请移驾至<a href="https://mp.weixin.qq.com/s?__biz=MzUzMTEwODk0Ng==&amp;mid=2247506796&amp;idx=1&amp;sn=aa02ccb3fde52260672471bcf80e70ff&amp;scene=21#wechat_redirect" data-linktype="2">三种转录组差异分析方法及区别你会了吗？</a>。</p><h3 data-tool="mdnice编辑器"><span></span><span><span></span>0.清控环境，加载包</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code>rm(list = ls())<br>getwd()<br><span>## [1] "C:/Users/lj/Desktop/公众号推文/第九周"</span><br><span>library</span>(limma)<br><span>library</span>(EnhancedVolcano)<br><span>library</span>(edgeR)<br><span>library</span>(FactoMineR)<br><span>library</span>(factoextra)<br><span>library</span>(clusterProfiler)<br><span>library</span>(org.Mm.eg.db)<br><span>library</span>(stringr)<br><span>library</span>(stringi)<br><span>library</span>(tidyverse)<br><span>library</span>(ggplot2)<br><span>library</span>(patchwork)<br><span>library</span>(pheatmap)<br><span>library</span>(VennDiagram)<br><span>library</span>(RColorBrewer)<br><span>library</span>(patchwork)<br><span>library</span>(ggplotify)<br><span>library</span>(ggvenn)<br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span><span></span>1.读取数据，获得拆分后3组1V1的基因表达矩阵以及cpm矩阵</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code>rawcount &lt;- read.table(<span>"./GSE190114_RNA_Seq_CountMatrix.txt"</span>,header = <span>T</span>,sep=<span>"\t"</span>,row.names = <span>1</span>)<br>colnames(rawcount)<br><span>## [1] "WT"     "WT.2"   "WT.3"   "KI2.1"  "KI2.2"  "KI2.3"  "KIKI.1" "KIKI.2"</span><br><span>## [9] "KIKI.3"</span><br>rawcount[<span>1</span>:<span>4</span>,<span>1</span>:<span>4</span>]<br><span>##           WT WT.2 WT.3 KI2.1</span><br><span>## A1BG     176  292  151   235</span><br><span>## A1BG-AS1 242  366  179   361</span><br><span>## A1CF       2    5    2    18</span><br><span>## A2M        5    1    3    18</span><br><span># 本身就是基因表达矩阵（无需降重与ID转换）</span><br><span># 选择二分组的样本</span><br>rawcount=rawcount[,<span>1</span>:<span>6</span>]<br>colnames(rawcount)<br><span>## [1] "WT"    "WT.2"  "WT.3"  "KI2.1" "KI2.2" "KI2.3"</span><br><span>## 拆分成3个分组；获取基因表达矩阵与cpm矩阵，准备进行三个样本的单样本分析</span><br>rawcount1=rawcount[,c(<span>1</span>,<span>4</span>)]<br>colnames(rawcount1)<br><span>## [1] "WT"    "KI2.1"</span><br>rawcount2=rawcount[,c(<span>2</span>,<span>5</span>)]<br>rawcount3=rawcount[,c(<span>3</span>,<span>6</span>)]<br><br>keep1 &lt;- rowSums(rawcount1&gt;<span>0</span>) &gt;= floor(<span>0.75</span>*ncol(rawcount1))<br>filter_count1 &lt;- rawcount1[keep1,] <span>#获得filter_count矩阵</span><br>keep2 &lt;- rowSums(rawcount2&gt;<span>0</span>) &gt;= floor(<span>0.75</span>*ncol(rawcount2))<br>filter_count2 &lt;- rawcount2[keep2,] <span>#获得filter_count矩阵</span><br>keep3 &lt;- rowSums(rawcount3&gt;<span>0</span>) &gt;= floor(<span>0.75</span>*ncol(rawcount3))<br>filter_count3 &lt;- rawcount3[keep3,] <span>#获得filter_count矩阵</span><br><br>express_cpm1 &lt;- log2(cpm(filter_count1)+ <span>1</span>)<br>express_cpm1[<span>1</span>:<span>2</span>,<span>1</span>:<span>2</span>] <span>#获得cpm矩阵</span><br><span>##                WT    KI2.1</span><br><span>## A1BG     1.717622 1.747681</span><br><span>## A1BG-AS1 2.052169 2.208695</span><br>express_cpm2 &lt;- log2(cpm(filter_count2)+ <span>1</span>)<br>express_cpm2[<span>1</span>:<span>2</span>,<span>1</span>:<span>2</span>] <span>#获得cpm矩阵</span><br><span>##              WT.2    KI2.2</span><br><span>## A1BG     1.733224 1.887287</span><br><span>## A1BG-AS1 1.968583 2.072286</span><br>express_cpm3 &lt;- log2(cpm(filter_count3)+ <span>1</span>)<br>express_cpm3[<span>1</span>:<span>2</span>,<span>1</span>:<span>2</span>] <span>#获得cpm矩阵</span><br><span>##              WT.3    KI2.3</span><br><span>## A1BG     1.620961 1.633474</span><br><span>## A1BG-AS1 1.791070 2.339318</span><br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span><span></span>2.第一组1V1单样本的差异分析（重点模拟4V4；limma具有欺骗功能）</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code>exprSet &lt;- filter_count1<br>exprSet1=cbind(<br>  exprSet[,<span>1</span>:<span>2</span>],<br>  exprSet[,<span>1</span>:<span>2</span>],<br>  exprSet[,<span>1</span>:<span>2</span>],<br>  exprSet[,<span>1</span>:<span>2</span>]<br>) <br><br><span># 查看分组信息和表达矩阵数据</span><br>group1=rep(c(<span>'WT1'</span>,<span>'KI2_1'</span>),<span>4</span>)<br>group_list1=factor(group1,levels = c(<span>'WT1'</span>,<span>'KI2_1'</span>))<br>table(group_list1)<span>#检查一下组别数量</span><br><span>## group_list1</span><br><span>##   WT1 KI2_1 </span><br><span>##     4     4</span><br><span>#创建设计矩阵和对比：假设数据符合分布，构建线性模型</span><br>design1 &lt;- model.matrix(~<span>0</span>+factor(group_list1))<br>colnames(design1) &lt;- levels(factor(group_list1))<br>rownames(design1) &lt;- colnames(exprSet1)<br><span>#设置需要进行对比的分组</span><br>comp1 &lt;- <span>'KI2_1-WT1'</span><br>cont.matrix1 &lt;- makeContrasts(contrasts=c(comp1),levels = design1)<br><span>#进行差异表达分析</span><br>dge1 &lt;- DGEList(counts=exprSet1)<br>v1 &lt;- voom(dge1,design1,plot=<span>TRUE</span>, normalize=<span>"quantile"</span>)<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.7142857142857143" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibibbHkfp8ibfcK1e6qRNicEwuY79FVgQfDYz6sNDQzic1XMee9H5yzTQCSouqExgKMdZXoXu9ibBkjsBA/640?wx_fmt=png" data-type="png" data-w="672" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibibbHkfp8ibfcK1e6qRNicEwuY79FVgQfDYz6sNDQzic1XMee9H5yzTQCSouqExgKMdZXoXu9ibBkjsBA/640?wx_fmt=png"></figure><pre data-tool="mdnice编辑器"><span></span><code>fit1 &lt;- lmFit(v1, design1)<br>fit1 &lt;- contrasts.fit(fit1,cont.matrix1)<br>fit1 &lt;- eBayes(fit1)<br>tmp1 &lt;- topTable(fit1, coef=comp1, n=<span>Inf</span>,adjust.method=<span>"BH"</span>)<br>DEG_limma_voom1 &lt;- na.omit(tmp1)<br>head(DEG_limma_voom1)<br><span>##            logFC     AveExpr             t       P.Value     adj.P.Val        B</span><br><span>## ZNF302 -4.820303 -1.35848446 -7.976083e+18 1.369391e-118 6.607816e-116 260.2507</span><br><span>## MIR675 -4.388997 -0.95178652 -7.355088e+18 2.289856e-118 9.042578e-116 260.1893</span><br><span>## CDH11  -6.096823 -1.83874433 -9.540170e+18 4.398097e-119 3.750684e-116 260.1692</span><br><span>## UNC13A -6.096823 -1.83874433 -9.540170e+18 4.398097e-119 3.750684e-116 260.1692</span><br><span>## RUNX2  -3.041175  0.04715971 -5.752666e+18 1.088205e-117 1.762830e-115 260.1678</span><br><span>## DTX3   -8.288663 -3.30746580 -1.251738e+19 7.853752e-120 2.281684e-116 260.1673</span><br>EnhancedVolcano(DEG_limma_voom1,<br>                lab =rownames(DEG_limma_voom1),<br>                x = <span>'logFC'</span>,<br>                y = <span>'adj.P.Val'</span>)<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.7142857142857143" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibibbHkfp8ibfcK1e6qRNicEwu5trM4KpjXsjWpzTSnNlEdQcrwe4iad4c6GgDPM9iaIV7Ka2WF262J0Kw/640?wx_fmt=png" data-type="png" data-w="672" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibibbHkfp8ibfcK1e6qRNicEwu5trM4KpjXsjWpzTSnNlEdQcrwe4iad4c6GgDPM9iaIV7Ka2WF262J0Kw/640?wx_fmt=png"></figure><pre data-tool="mdnice编辑器"><span></span><code>fc &lt;- <span>2</span><br>p &lt;- <span>0.05</span><br>DEG_limma_voom1$regulated &lt;- ifelse(DEG_limma_voom1$logFC&gt;log2(fc)&amp;DEG_limma_voom1$adj.P.Val&lt;p,<br>                                    <span>"up"</span>,ifelse(DEG_limma_voom1$logFC&lt;(-log2(fc))&amp;DEG_limma_voom1$adj.P.Val,<span>"down"</span>,<span>"normal"</span>))<br><br><br>table(DEG_limma_voom1$regulated)<br><span>## </span><br><span>##   down normal     up </span><br><span>##   1947  15601   2241</span><br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span><span></span>3.第二组1V1单样本的差异分析</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code>exprSet &lt;- filter_count2<br>exprSet2=cbind(<br>  exprSet[,<span>1</span>:<span>2</span>],<br>  exprSet[,<span>1</span>:<span>2</span>],<br>  exprSet[,<span>1</span>:<span>2</span>],<br>  exprSet[,<span>1</span>:<span>2</span>]<br>) <br><span># 查看分组信息和表达矩阵数据</span><br>group2=rep(c(<span>'WT2'</span>,<span>'KI2_2'</span>),<span>4</span>)<br>group_list2=factor(group2,levels = c(<span>'WT2'</span>,<span>'KI2_2'</span>))<br>table(group_list2)<span>#检查一下组别数量</span><br><span>## group_list2</span><br><span>##   WT2 KI2_2 </span><br><span>##     4     4</span><br><span>#创建设计矩阵和对比：假设数据符合分布，构建线性模型</span><br>design2 &lt;- model.matrix(~<span>0</span>+factor(group_list2))<br>colnames(design2) &lt;- levels(factor(group_list2))<br>rownames(design2) &lt;- colnames(exprSet2)<br>comp2 &lt;- <span>'KI2_2-WT2'</span><br>cont.matrix2 &lt;- makeContrasts(contrasts=c(comp2),levels = design2)<br><span>#进行差异表达分析</span><br>dge2 &lt;- DGEList(counts=exprSet2)<br>v2 &lt;- voom(dge2,design2,plot=<span>TRUE</span>, normalize=<span>"quantile"</span>)<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.7142857142857143" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibibbHkfp8ibfcK1e6qRNicEwuqiceaqxnR54yibXs5pNNFAbyQO236TTAk8v44vSAW049dIGcW8OuoIicQ/640?wx_fmt=png" data-type="png" data-w="672" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibibbHkfp8ibfcK1e6qRNicEwuqiceaqxnR54yibXs5pNNFAbyQO236TTAk8v44vSAW049dIGcW8OuoIicQ/640?wx_fmt=png"></figure><pre data-tool="mdnice编辑器"><span></span><code>fit2 &lt;- lmFit(v2, design2)<br>fit2 &lt;- contrasts.fit(fit2,cont.matrix2)<br>fit2 &lt;- eBayes(fit2)<br>tmp2 &lt;- topTable(fit2, coef=comp2, n=<span>Inf</span>,adjust.method=<span>"BH"</span>)<br>DEG_limma_voom2 &lt;- na.omit(tmp2)<br>head(DEG_limma_voom2)<br><span>##              logFC      AveExpr            t       P.Value     adj.P.Val</span><br><span>## TMEM27    2.843764 -0.416357146 9.490563e+18 3.671715e-119 8.819086e-116</span><br><span>## CYP2J2    3.662103 -0.401951573 1.087962e+19 1.542764e-119 8.819086e-116</span><br><span>## ABCG2     2.907810  0.447487988 9.383159e+18 3.946809e-119 8.819086e-116</span><br><span>## CYP1A1    2.929636  0.584124556 9.250964e+18 4.318793e-119 8.819086e-116</span><br><span>## LINC00319 2.313701  0.005680239 8.177598e+18 9.448536e-119 8.819086e-116</span><br><span>## ABCA13    2.403420 -0.560656423 8.263021e+18 8.845368e-119 8.819086e-116</span><br><span>##                  B</span><br><span>## TMEM27    263.8117</span><br><span>## CYP2J2    263.7216</span><br><span>## ABCG2     263.6639</span><br><span>## CYP1A1    263.5480</span><br><span>## LINC00319 263.4814</span><br><span>## ABCA13    263.4456</span><br>EnhancedVolcano(DEG_limma_voom2,<br>                lab =rownames(DEG_limma_voom2),<br>                x = <span>'logFC'</span>,<br>                y = <span>'adj.P.Val'</span>)<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.7142857142857143" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibibbHkfp8ibfcK1e6qRNicEwuVvGqDsp1IUzYH3WTRK8wnKMRc30qh6PFaljaR1TSs2zRvqgI3rtDFA/640?wx_fmt=png" data-type="png" data-w="672" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibibbHkfp8ibfcK1e6qRNicEwuVvGqDsp1IUzYH3WTRK8wnKMRc30qh6PFaljaR1TSs2zRvqgI3rtDFA/640?wx_fmt=png"></figure><pre data-tool="mdnice编辑器"><span></span><code>fc &lt;- <span>2</span><br>p &lt;- <span>0.05</span><br>DEG_limma_voom2$regulated &lt;- ifelse(DEG_limma_voom2$logFC&gt;log2(fc)&amp;DEG_limma_voom2$adj.P.Val&lt;p,<br>                                    <span>"up"</span>,ifelse(DEG_limma_voom2$logFC&lt;(-log2(fc))&amp;DEG_limma_voom2$adj.P.Val,<span>"down"</span>,<span>"normal"</span>))<br>table(DEG_limma_voom2$regulated)<br><span>## </span><br><span>##   down normal     up </span><br><span>##   1944  15558   2345</span><br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span><span></span>4. 第三组1V1单样本差异分析</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code>exprSet &lt;- filter_count3<br>exprSet3=cbind(<br>  exprSet[,<span>1</span>:<span>2</span>],<br>  exprSet[,<span>1</span>:<span>2</span>],<br>  exprSet[,<span>1</span>:<span>2</span>],<br>  exprSet[,<span>1</span>:<span>2</span>]<br>) <br><span># 查看分组信息和表达矩阵数据</span><br>group3=rep(c(<span>'WT3'</span>,<span>'KI3_3'</span>),<span>4</span>)<br>group_list3=factor(group3,levels = c(<span>'WT3'</span>,<span>'KI3_3'</span>))<br>table(group_list3)<span>#检查一下组别数量</span><br><span>## group_list3</span><br><span>##   WT3 KI3_3 </span><br><span>##     4     4</span><br><span>#创建设计矩阵和对比：假设数据符合分布，构建线性模型</span><br>design3 &lt;- model.matrix(~<span>0</span>+factor(group_list3))<br>colnames(design3) &lt;- levels(factor(group_list3))<br>rownames(design3) &lt;- colnames(exprSet3)<br>design3<br><span>##       WT3 KI3_3</span><br><span>## WT.3    1     0</span><br><span>## KI2.3   0     1</span><br><span>## WT.3    1     0</span><br><span>## KI2.3   0     1</span><br><span>## WT.3    1     0</span><br><span>## KI2.3   0     1</span><br><span>## WT.3    1     0</span><br><span>## KI2.3   0     1</span><br><span>## attr(,"assign")</span><br><span>## [1] 1 1</span><br><span>## attr(,"contrasts")</span><br><span>## attr(,"contrasts")$`factor(group_list3)`</span><br><span>## [1] "contr.treatment"</span><br><span>#设置需要进行对比的分组</span><br>comp3 &lt;- <span>'KI3_3-WT3'</span><br>cont.matrix3 &lt;- makeContrasts(contrasts=c(comp3),levels = design3)<br><span>#进行差异表达分析</span><br>dge3 &lt;- DGEList(counts=exprSet3)<br>v3 &lt;- voom(dge3,design3,plot=<span>TRUE</span>, normalize=<span>"quantile"</span>)<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.7142857142857143" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibibbHkfp8ibfcK1e6qRNicEwueaDuia3B2HVvJroTKJruzkhdLH09p0Aw0ErKeIw4hyuSTBut8nXCMhw/640?wx_fmt=png" data-type="png" data-w="672" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibibbHkfp8ibfcK1e6qRNicEwueaDuia3B2HVvJroTKJruzkhdLH09p0Aw0ErKeIw4hyuSTBut8nXCMhw/640?wx_fmt=png"></figure><pre data-tool="mdnice编辑器"><span></span><code>fit3 &lt;- lmFit(v3, design3)<br>fit3 &lt;- contrasts.fit(fit3,cont.matrix3)<br>fit3 &lt;- eBayes(fit3)<br>tmp3 &lt;- topTable(fit3, coef=comp3, n=<span>Inf</span>,adjust.method=<span>"BH"</span>)<br>DEG_limma_voom3 &lt;- na.omit(tmp3)<br>head(DEG_limma_voom3)<br><span>##            logFC       AveExpr             t       P.Value     adj.P.Val</span><br><span>## SNTB1  -2.775061  0.0672863404 -5.938358e+18 5.700051e-118 6.754097e-115</span><br><span>## LBH    -3.372135  0.3162153907 -6.580706e+18 2.968066e-118 6.754097e-115</span><br><span>## AMPH   -3.317054 -0.1086660275 -6.505961e+18 3.191492e-118 6.754097e-115</span><br><span>## TDRD5   3.191238 -0.2396085692  6.186625e+18 4.394062e-118 6.754097e-115</span><br><span>## MCOLN3  2.546560  0.0009733578  5.494929e+18 9.332954e-118 6.754097e-115</span><br><span>## MAGEE1 -2.626896 -0.2414293712 -5.573306e+18 8.529823e-118 6.754097e-115</span><br><span>##               B</span><br><span>## SNTB1  261.1710</span><br><span>## LBH    261.1250</span><br><span>## AMPH   261.1165</span><br><span>## TDRD5  260.9435</span><br><span>## MCOLN3 260.9433</span><br><span>## MAGEE1 260.9405</span><br>EnhancedVolcano(DEG_limma_voom3,<br>                lab =rownames(DEG_limma_voom3),<br>                x = <span>'logFC'</span>,<br>                y = <span>'adj.P.Val'</span>)<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.7142857142857143" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibibbHkfp8ibfcK1e6qRNicEwuCLRxuveiaQyWCwdibCJrvY5Wh8s6eFZicc32LiaRhVpbYglnibJUZexbz9w/640?wx_fmt=png" data-type="png" data-w="672" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibibbHkfp8ibfcK1e6qRNicEwuCLRxuveiaQyWCwdibCJrvY5Wh8s6eFZicc32LiaRhVpbYglnibJUZexbz9w/640?wx_fmt=png"></figure><pre data-tool="mdnice编辑器"><span></span><code>fc &lt;- <span>2</span><br>p &lt;- <span>0.05</span><br>DEG_limma_voom3$regulated &lt;- ifelse(DEG_limma_voom3$logFC&gt;log2(fc)&amp;DEG_limma_voom3$adj.P.Val&lt;p,<br>                                    <span>"up"</span>,ifelse(DEG_limma_voom3$logFC&lt;(-log2(fc))&amp;DEG_limma_voom3$adj.P.Val,<span>"down"</span>,<span>"normal"</span>))<br><br>table(DEG_limma_voom3$regulated)<br><span>## </span><br><span>##   down normal     up </span><br><span>##   2054  15379   2217</span><br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span><span></span>5.3个1V1分组中上下调差异基因以及整体差异基因的交集情况</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code><span># 01先获取第一组比较的上调基因，下调基因与差异基因</span><br>deg1 &lt;- rownames(DEG_limma_voom1[DEG_limma_voom1$regulated!=<span>"normal"</span>,])<br>up1 &lt;- rownames(DEG_limma_voom1[DEG_limma_voom1$regulated==<span>"up"</span>,])<br>down1 &lt;- rownames(DEG_limma_voom1[DEG_limma_voom1$regulated==<span>"down"</span>,])<br><span># 02再获取第二组比较的上调基因，下调基因与差异基因</span><br>deg2 &lt;- rownames(DEG_limma_voom2[DEG_limma_voom2$regulated!=<span>"normal"</span>,])<br>up2 &lt;- rownames(DEG_limma_voom2[DEG_limma_voom2$regulated==<span>"up"</span>,])<br>down2 &lt;- rownames(DEG_limma_voom2[DEG_limma_voom2$regulated==<span>"down"</span>,])<br><span># 03再获取第三组比较的上调基因，下调基因与差异基因</span><br>deg3 &lt;- rownames(DEG_limma_voom3[DEG_limma_voom3$regulated!=<span>"normal"</span>,])<br>up3 &lt;- rownames(DEG_limma_voom3[DEG_limma_voom3$regulated==<span>"up"</span>,])<br>down3 &lt;- rownames(DEG_limma_voom3[DEG_limma_voom3$regulated==<span>"down"</span>,])<br><br><br><span># 整体差异基因的交集情况</span><br>deg&lt;-list(`deg1`=deg1,<br>          `deg2`=deg2,<br>          `deg3`=deg3)<br>p5 &lt;- ggvenn(deg,<br>             show_percentage = <span>F</span>,<br>             stroke_color = <span>"white"</span>,<br>             fill_color = c(<span>"#42B540FF"</span>,<span>"#925E9FFF"</span>,<span>"#00468BFF"</span>),<br>             set_name_color = c(<span>"#ff0000"</span>,<span>"#4a9b83"</span>,<span>"#b2d4ec"</span>))<br><br><span># 整体上调差异基因的交集情况</span><br><br>up&lt;-list(`up1`=up1,<br>         `up2`=up2,<br>         `up3`=up3)<br>p6 &lt;- ggvenn(up,<br>             show_percentage = <span>F</span>,<br>             stroke_color = <span>"white"</span>,<br>             fill_color = c(<span>"#8491B4B2"</span>,<span>"#91D1C2B2"</span>,<span>"#DC0000B2"</span>),<br>             set_name_color = c(<span>"#ff0000"</span>,<span>"#4a9b83"</span>,<span>"#b2d4ec"</span>))<br><br>down&lt;-list(`down1`=down1,<br>           `down2`=down2,<br>           `down3`=down3)<br>p7 &lt;- ggvenn(down,<br>             show_percentage = <span>F</span>,<br>             stroke_color = <span>"white"</span>,<br>             fill_color = c(<span>"#DF8F4499"</span>,<span>"#00A1D599"</span>,<span>"#B2474599"</span>),<br>             set_name_color = c(<span>"#ff0000"</span>,<span>"#4a9b83"</span>,<span>"#b2d4ec"</span>))<br>p5+p6+p7<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.7142857142857143" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibibbHkfp8ibfcK1e6qRNicEwuzPzIiaPOBScHktTPOyib7XdMgOh21omWpPhJrugNCtwPQoBUR0KnEBcw/640?wx_fmt=png" data-type="png" data-w="672" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibibbHkfp8ibfcK1e6qRNicEwuzPzIiaPOBScHktTPOyib7XdMgOh21omWpPhJrugNCtwPQoBUR0KnEBcw/640?wx_fmt=png"></figure><h3 data-tool="mdnice编辑器"><span></span><span><span></span>6.三组1V1差异分析与三种差异分析方法获得的上下调共同差异基因的交集</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code><span># 01先获取3种差异分析方法的共同上调基因与下调基因(直接读取上一篇推文结果即可;取三种方法的共同交集即可，取法如下面的02)</span><br>up_method=read.csv(<span>'up_method.csv'</span>)<br>up_method=up_method$x<br>down_method=read.csv(<span>'down_method.csv'</span>)<br>down_method=down_method$x<br><span># 02获取3组1V1样本差异分析的共同上调以及下调基因</span><br>deg_sample=intersect(deg1,deg2)<br>deg_sample=intersect(deg_sample,deg3)<br>up_sample=intersect(up1,up2)<br>up_sample= intersect(up_sample,up3) <br>down_sample=intersect(down1,down2)<br>down_sample= intersect(down_sample,down3)<br><br><br><span># 03看3差异分析方法</span><br>up&lt;-list(`up_method`=up_method,<br>         `up_sample`=up_sample)<br>p8 &lt;- ggvenn(up,<br>             show_percentage = <span>F</span>,<br>             stroke_color = <span>"white"</span>,<br>             fill_color = c(<span>"#AD002AFF"</span>,<span>"#8491B4B2"</span>),<br>             set_name_color = c(<span>"#ff0000"</span>,<span>"#4a9b83"</span>))<br><br>down&lt;-list(`down_method`=down_method,<br>           `down_sample`=down_sample)<br>p9 &lt;- ggvenn(down,<br>             show_percentage = <span>F</span>,<br>             stroke_color = <span>"white"</span>,<br>             fill_color = c(<span>"#0099B4FF"</span>,<span>"#FDAF91FF"</span>),<br>             set_name_color = c(<span>"#ff0000"</span>,<span>"#4a9b83"</span>))<br><br>p8+p9<br></code></pre><p data-tool="mdnice编辑器"><img data-ratio="0.7142857142857143" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibibbHkfp8ibfcK1e6qRNicEwuUFMQslP1Mp1BH652EqwkZbvR0qmof2FszBNbhsibCiaKmKCHmQcxRkQw/640?wx_fmt=png" data-type="png" data-w="672" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibibbHkfp8ibfcK1e6qRNicEwuUFMQslP1Mp1BH652EqwkZbvR0qmof2FszBNbhsibCiaKmKCHmQcxRkQw/640?wx_fmt=png"><strong>「我们主要关注两个结果」</strong>：1. 将3V3的样本拆分成3次1V1差异分析之后，它们之间的共同上调与共同下调差异基因以及共同差异基因之间分别的交集情况怎么样。2. 3次1V1差异分析的共同上调与共同下调基因的交集分别与对应的3种转录组常规差异分析方法获得的共同上调与共同下调基因交集情况怎么样。</p><p data-tool="mdnice编辑器">从给出的第一张Venn图可知，3次1V1差异分析，其共同上调与共同下调的差异基因数量是比较多的。尤为注意的是，第二张Veen图结果表明三种方法分别取的共同上调基因交集与共同下调基因<span>有将近6成-8成的差异基因在3次1V1单样本差异分析中也获得了</span>。</p><p data-tool="mdnice编辑器"><strong>「猜想：」</strong>那是否对于异质性相对不大的细胞实验，如某些药物处理时，做转录组差异分析我们做1V1单样本间的差异分析也可以呢？3次1V1与3种方法获得的共同上调差异基因的交集与共同下调差异基因的交集，即图中的662与576是否更能够反映实验现象，或者说三种常规方法获得的共同差异基因与三次1V1获得的共同差异基因进一步取交集能否有效Zoom in，能否进一步获得真正能够发挥作用的下游作用的关键分子呢？</p></section><p><br></p><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/4ouKuSKlEgiA4lHqS6NTGg",target="_blank" rel="noopener noreferrer">原文链接</a>
