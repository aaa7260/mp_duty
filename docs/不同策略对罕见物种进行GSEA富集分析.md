---
title: "不同策略对罕见物种进行GSEA富集分析"
date: 2022-11-27T11:23:44Z
draft: ["false"]
tags: [
  "fetched",
  "生信小知识"
]
categories: ["Acdemic"]
---
不同策略对罕见物种进行GSEA富集分析 by 生信小知识
------
<div><section><h2><span>不同策略对罕见物种进行GSEA富集分析</span></h2><blockquote><p>微信公众号：<strong>生信小知识</strong><br>关注可了解更多的生物信息学教程及知识。问题或建议，请公众号留言;</p></blockquote><h3><span>目录</span></h3><p><span><span>前言</span></span><span><span>1. 可行性分析</span></span><span><span>2. gmt数据准备</span></span><span><span>3. GSEA</span></span><span><span><span>3.1 大鼠用人基因</span></span></span><span><span><span>3.2 大鼠基因</span></span></span><span><span>4. 结果比较</span></span><span><span>后记</span></span></p><h3><span>前言</span></h3><p>前面介绍过<a href="https://mp.weixin.qq.com/s?__biz=MjM5NTk0Mzg2Nw==&amp;mid=2247488528&amp;idx=1&amp;sn=3478ae1700482036acba4e9b61041c3b&amp;scene=21#wechat_redirect" data-linktype="2">不同物种之间GSEA富集分析</a>，推文发出去后，有朋友网友私信问有没有植物GMT的文件。<strong>我做动物人的，你来问我植物？</strong></p><p>那我就告诉你，下载地址在：http://systemsbiology.cau.edu.cn/PlantGSEA/download.php</p><figure><img data-ratio="0.5661953727506427" data-src="https://mmbiz.qpic.cn/mmbiz_png/fOo3cmIWvJpaDlrsPMkq62REBCsBlYnO4kYLIED4dSibKk8kyGIlxq6l8RyAUqXqV0GMaxliaA5gaica3iaPTiascww/640?wx_fmt=png" data-type="png" data-w="1556" src="https://mmbiz.qpic.cn/mmbiz_png/fOo3cmIWvJpaDlrsPMkq62REBCsBlYnO4kYLIED4dSibKk8kyGIlxq6l8RyAUqXqV0GMaxliaA5gaica3iaPTiascww/640?wx_fmt=png"></figure><p>这个网站可以下载的植物富集分析数据集还挺多的。</p><p>另外，如果这里没能找到，还可以去另外一个网站上看看：http://systemsbiology.cau.edu.cn/PlantGSEAv2/download.php</p><figure><img data-ratio="0.4780652418447694" data-src="https://mmbiz.qpic.cn/mmbiz_png/fOo3cmIWvJpaDlrsPMkq62REBCsBlYnO03RjujZ27wpryt1LVyyULsbn8vZ4ZoYhia05HSKCibBDOlBOfLyVhdbg/640?wx_fmt=png" data-type="png" data-w="1778" src="https://mmbiz.qpic.cn/mmbiz_png/fOo3cmIWvJpaDlrsPMkq62REBCsBlYnO03RjujZ27wpryt1LVyyULsbn8vZ4ZoYhia05HSKCibBDOlBOfLyVhdbg/640?wx_fmt=png"></figure><p>后面，技能树的曾老师也找到了我，和我交流了一个想法：<strong>对于一些相对少见的物种而言，有时候很难找到对应的gmt数据，这时我们能不能直接把其他物种的基因名字转成大写，然后用人的注释文件进行分析？</strong></p><blockquote><p>对于基因的命名有一定的规则，人的基因全部大写，小鼠的基因</p><figure><img data-ratio="0.23743386243386244" data-src="https://mmbiz.qpic.cn/mmbiz_png/fOo3cmIWvJpaDlrsPMkq62REBCsBlYnOLy4ymzicYrxGSTicrwyaKQxE1OiaYsOPaAcyCeelUfzTm0aCgERF3ZTmg/640?wx_fmt=png" data-type="png" data-w="1512" src="https://mmbiz.qpic.cn/mmbiz_png/fOo3cmIWvJpaDlrsPMkq62REBCsBlYnOLy4ymzicYrxGSTicrwyaKQxE1OiaYsOPaAcyCeelUfzTm0aCgERF3ZTmg/640?wx_fmt=png"></figure></blockquote><h3><span>1. 可行性分析</span></h3><p>听到这个想法，我觉得这样做的话，有好有坏。</p><p>好处在于：</p><ul><li><p><span>分析时简单方便：直接将基因symbol转大写即可使用</span></p></li><li><p>不需要找注释 <code>gmt</code> 数据</p></li></ul><p>坏处在于：</p><ul><li><p><span>一些基因如果在不同物种之间的命名不同，则会丢失</span></p></li></ul><p>不过，<strong>即使按照前面我写的教程来做，其还是有个假设</strong>是：<strong>物种之间的信号通路是相同的</strong>。因为<strong>GSEA官网的做法其实也是利用基因同源性，将其他物种基因对应到了人和鼠上，做了基因转换而已</strong>。</p><p>那既然这样，不如试试直接将基因symbol变成大写后，然后利用人的数据库进行注释，比较下两者的结果差异。</p><h3><span>2. gmt数据准备</span></h3><p>我们还是用大鼠的数据来做测试。</p><p>同样，先找到大鼠和人的gmt文件：</p><pre><code><span>library</span>(msigdbr)<br>msigdbr_species()<br><span>#&gt; # A tibble: 20 × 2</span><br><span>#&gt;    species_name                    species_common_name                                    </span><br><span>#&gt;    &lt;chr&gt;                           &lt;chr&gt;                                                  </span><br><span>#&gt;  1 Anolis carolinensis             Carolina anole, green anole                            </span><br><span>#&gt;  2 Bos taurus                      bovine, cattle, cow, dairy cow, domestic cattle, domes…</span><br><span>#&gt;  3 Caenorhabditis elegans          &lt;NA&gt;                                                   </span><br><span>#&gt;  4 Canis lupus familiaris          dog, dogs                                              </span><br><span>#&gt;  5 Danio rerio                     leopard danio, zebra danio, zebra fish, zebrafish      </span><br><span>#&gt;  6 Drosophila melanogaster         fruit fly                                              </span><br><span>#&gt;  7 Equus caballus                  domestic horse, equine, horse                          </span><br><span>#&gt;  8 Felis catus                     cat, cats, domestic cat                                </span><br><span>#&gt;  9 Gallus gallus                   bantam, chicken, chickens, Gallus domesticus           </span><br><span>#&gt; 10 Homo sapiens                    human                                                  </span><br><span>#&gt; 11 Macaca mulatta                  rhesus macaque, rhesus macaques, Rhesus monkey, rhesus…</span><br><span>#&gt; 12 Monodelphis domestica           gray short-tailed opossum                              </span><br><span>#&gt; 13 Mus musculus                    house mouse, mouse                                     </span><br><span>#&gt; 14 Ornithorhynchus anatinus        duck-billed platypus, duckbill platypus, platypus      </span><br><span>#&gt; 15 Pan troglodytes                 chimpanzee                                             </span><br><span>#&gt; 16 Rattus norvegicus               brown rat, Norway rat, rat, rats                       </span><br><span>#&gt; 17 Saccharomyces cerevisiae        baker's yeast, brewer's yeast, S. cerevisiae           </span><br><span>#&gt; 18 Schizosaccharomyces pombe 972h- &lt;NA&gt;                                                   </span><br><span>#&gt; 19 Sus scrofa                      pig, pigs, swine, wild boar                            </span><br><span>#&gt; 20 Xenopus tropicalis              tropical clawed frog, western clawed frog</span><br></code></pre><p>可以看到，我们一共可以使用的物种信息有20种，理论上应该可以覆盖我们所需要的大多数情况了。</p><p>接下来我们还是以大鼠 Rattus norvegicus 为例进行演示。</p><p>我们需要拿到大鼠的gmt文件，为了减少计算量，我们还是只使用<strong>GO中的BP</strong>数据集进行分析。</p><p>具体我们可以通过函数完成：</p><pre><code>target_category &lt;- <span>"C5"</span><br>subcategory &lt;- <span>"BP"</span><br><br>target_species &lt;- <span>"Rattus norvegicus"</span><br>rat_gene_sets = msigdbr(species = target_species,category = target_category,subcategory = subcategory)<br>dim(rat_gene_sets)<br><span># [1] 596303     18</span><br>rat_gene_sets &lt;- rat_gene_sets[,c(<span>"gs_name"</span>,<span>"ensembl_gene"</span>)]<br><br>target_species &lt;- <span>"Homo sapiens"</span><br>homo_gene_sets = msigdbr(species = target_species,category = target_category,subcategory = subcategory)<br>dim(homo_gene_sets)<br><span># [1] 721379     15</span><br>homo_gene_sets &lt;- homo_gene_sets[,c(<span>"gs_name"</span>,<span>"gene_symbol"</span>)]<br></code></pre><p>这里可以看到，人和大鼠之间的信号通路数据集数目差别有点大。</p><p>那么我先统计下这些信号通路之间的overlap情况：</p><pre><code>homo &lt;- homo_gene_sets$gs_exact_source<br>length(homo)<br><span># [1] 721379</span><br>homo &lt;- unique(homo_gene_sets$gs_exact_source)<br>length(homo)<br><span># [1] 7658</span><br><br>rat &lt;- rat_gene_sets$gs_exact_source<br>length(rat)<br><span># [1] 596303</span><br>rat &lt;- unique(rat_gene_sets$gs_exact_source)<br>length(rat)<br><span># [1] 7656</span><br><br>length(intersect(homo,rat))<br><span># [1] 7656</span><br>head(rat)<br><span># [1] "GO:0009256" "GO:0006103" "GO:0044571" "GO:0050428" "GO:0050427" "GO:0061158"</span><br></code></pre><p>可以看到，当我以GO的ID进行统计时：</p><ul><li><p><span>大鼠有7656条信号通路，但是这些信号通路一共涉及596303个基因</span></p></li><li><p><span>人有7658条信号通路，但是这些信号通路一共涉及721379个基因</span></p></li></ul><p>说明<strong>在人和大鼠之间进行基因转化的过程中，可能很多基因【(721379-596303)/721379=17.34%】都被遗失了</strong>。</p><h3><span>3. GSEA</span></h3><p>拿到了 <code>gmt</code> 文件后，对于进行GSEA分析而言，我们还需要另外一个数据：排序后的差异分析结果。</p><p>具体而言，为了完成测试，这里我们需要2种数据：</p><ol><li><p><span>基因symbol直接转大写</span></p></li><li><p><span>大鼠基因ID</span></p></li></ol><h4><span>3.1 大鼠用人基因</span></h4><p>首先拿到排序后的 <code>geneList</code>：</p><pre><code>geneList_homo &lt;- deg$logFC<br>names(geneList_homo) &lt;- toupper(deg$gene_name)<br>geneList_homo = sort(geneList_homo, decreasing = <span>TRUE</span>)<br>head(geneList_homo)<br><span>#         UPK3B AABR07069371.1          UPK1B        SLC26A3          GSTM3           MYL7 </span><br><span>#      6.886050       6.305090       6.296671       6.062613       6.036807       5.903429</span><br></code></pre><p>然后进行GSEA分析：</p><pre><code>homo_result &lt;- clusterProfiler::GSEA(geneList_homo,<br>                                     TERM2GENE = homo_gene_sets, <br>                                     minGSSize = <span>1</span>,<br>                                     maxGSSize = <span>5000</span>,<br>                                     pvalueCutoff = <span>1</span>,<br>                                     nPermSimple = <span>5000</span>)<br>homo_result_dat &lt;- homo_result@result<br></code></pre><h4><span>3.2 大鼠基因</span></h4><p>首先拿到排序后的 <code>geneList</code>：</p><pre><code>geneList_rat &lt;- deg$logFC<br>names(geneList_rat) &lt;- deg$gene_id<br>geneList_rat = sort(geneList_rat, decreasing = <span>TRUE</span>)<br>head(geneList_rat)<br><span># ENSRNOG00000023686 ENSRNOG00000039931 ENSRNOG00000027380 ENSRNOG00000006878 ENSRNOG00000049743 ENSRNOG00000014409 </span><br><span>#           6.886050           6.305090           6.296671           6.062613           6.036807           5.903429</span><br></code></pre><p>然后进行GSEA分析：</p><pre><code>rat_result &lt;- clusterProfiler::GSEA(geneList_rat,<br>                                    TERM2GENE = rat_gene_sets, <br>                                    minGSSize = <span>1</span>,<br>                                    maxGSSize = <span>5000</span>,<br>                                    pvalueCutoff = <span>1</span>,<br>                                    nPermSimple = <span>5000</span>)<br>rat_result_dat &lt;- rat_result@result<br></code></pre><h3><span>4. 结果比较</span></h3><p>我们先看看以 <code>pvalue&lt;0.01</code> 作为标准，两种方法得到具有显著意义的通路数目差异：</p><pre><code>homo_P &lt;- homo_result_dat[homo_result_dat$pvalue&lt;<span>0.01</span>,<span>"ID"</span>]<br>length(homo_P)<br><span># [1] 1192</span><br>rat_P &lt;- rat_result_dat[rat_result_dat$pvalue&lt;<span>0.01</span>,<span>"ID"</span>]<br>length(rat_P)<br><span># [1] 1221</span><br>length(intersect(homo_P,rat_P))<br><span># [1] 1098</span><br></code></pre><p>所以，在 <code>P&lt;0.01</code> 的标准下，两种方法分别检查到显著的信号通路：</p><ul><li><p><span>大鼠基因转成人：1192条。其中1098条与另外一种方法结果相同（1098/1192=92.11%）。</span></p></li><li><p><span>大鼠基因：1221条。其中1098条与另外一种方法结果相同（1098/1221=89.93%）。</span></p></li></ul><p><strong>所以说明这两种方法整体结果是很相似的</strong>。</p><p>我猜可能是以为，即使用大鼠的基因ID来进行分析，但是在匹配GMT信息时，因为很多仍然无法对应上去，所以导致了结果的相似。</p><blockquote><p>GMT信息：</p><ul><li><p><span>大鼠有7656条信号通路，但是这些信号通路一共涉及596303个基因</span></p></li><li><p><span>人有7658条信号通路，但是这些信号通路一共涉及721379个基因</span></p></li></ul></blockquote><h3><span>后记</span></h3><p>在这种情况下，如果我遇到比较罕见的物种数据，如果找不到对应的GMT文件时，我可能就直接将基因名大写，然后用人的注释数据来分析了。</p></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/y96MSqQsgZ-MWk6m-4P_Ag",target="_blank" rel="noopener noreferrer">原文链接</a>
