---
title: "NC图表复现-绘制双连续型热图"
date: 2024-03-01T14:55:17Z
draft: ["false"]
tags: [
  "fetched",
  "R语言数据分析指南"
]
categories: ["Acdemic"]
---
NC图表复现-绘制双连续型热图 by R语言数据分析指南
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><h3 data-tool="mdnice编辑器"><span></span><span><span></span>欢迎关注R语言数据分析指南</span><span></span></h3><blockquote data-tool="mdnice编辑器"><span>❝</span><p>本节继续来复现NC上的图表，绘制一个离散型热图，需要先对数据进行相应的格式转换，<strong>「图形看起来也是比较简单，细节也是要调节一番」</strong>，数据为论文源数据，小编进行了图形绘制，整个过程仅参考。希望对各位观众老爷能有所帮助。<strong>「数据代码已经整合上传到会员交流群」</strong>，购买过小编VIP的朋友可在所加的会员群内获取下载，有需要的朋友可关注文末介绍加入VIP交流群。</p><span>❞</span></blockquote><h3 data-tool="mdnice编辑器"><span></span><span><span></span>关于永久群内容的说明</span><span></span></h3><blockquote data-tool="mdnice编辑器"><span>❝</span><p>给予长期支持我们的读者们一个特别待遇：购买小编VIP会员文档的读者，<strong>「将自动获得2024年及以后更新的绘图文档代码，无需额外付费」</strong>。目前会员文档(2023+2024)<strong>「已经更新上传了140+案例文档」</strong>，每个案例都附有相应的数据和代码，并配有对应的注释文档，方便大家学习和参考。</p><span>❞</span></blockquote><p data-tool="mdnice编辑器">有需要学习数据可视化的朋友，欢迎到小编的<strong>「淘宝店铺」</strong> <strong>「R语言数据分析指南」</strong>下单购买，内容主要包括各种<strong>「高分论文的图表分析复现以及一些个性化图表的绘制」</strong>均包含数据+代码。购买会员文档后微信发小编订单号即邀请进新的会员交流群。</p><p data-tool="mdnice编辑器"><strong>「2024更新的绘图内容同时包含数据+代码+markdown注释文档+文档清单」</strong></p><h3 data-tool="mdnice编辑器"><span></span><span><span></span>复现结果</span><span></span></h3><figure data-tool="mdnice编辑器"><img data-imgfileid="100026129" data-ratio="0.6833333333333333" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZPz6sI193pv0wDTFbYiaibicpxT1ES2FjGKicZyN39QA05oHMSZKtdYxAAtib8kl8gPkCXfsgoNFYCVyQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZPz6sI193pv0wDTFbYiaibicpxT1ES2FjGKicZyN39QA05oHMSZKtdYxAAtib8kl8gPkCXfsgoNFYCVyQ/640?wx_fmt=png&amp;from=appmsg"></figure><h3 data-tool="mdnice编辑器"><span></span><span><span></span>论文</span><span></span></h3><blockquote data-tool="mdnice编辑器"><span>❝</span><p>https://www.nature.com/articles/s41467-024-45957-x</p><span>❞</span></blockquote><figure data-tool="mdnice编辑器"><img data-imgfileid="100026130" data-ratio="0.37222222222222223" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZPz6sI193pv0wDTFbYiaibicpibzRwRIaOSy1l55xvIYIMvTCCJdBgWekytpKCL3wtjib2R9HvrdR03RA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZPz6sI193pv0wDTFbYiaibicpibzRwRIaOSy1l55xvIYIMvTCCJdBgWekytpKCL3wtjib2R9HvrdR03RA/640?wx_fmt=png&amp;from=appmsg"></figure><h3 data-tool="mdnice编辑器"><span></span><span><span></span>加载R包</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code><span>library</span>(tidyverse)<br><span>library</span>(MetBrewer)<br><span>library</span>(ggtext)<br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span><span></span>数据清洗</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code>df &lt;- read_tsv(<span>"data.xls"</span>) %&gt;% <br>  mutate(ID=as.character(ID)) %&gt;% <br>  pivot_longer(-ID) %&gt;% <br>  mutate(value=as.character(value)) %&gt;% <br>  mutate(across(everything(), ~na_if(.,<span>"-9999"</span>))) %&gt;% <br>  mutate(value=as.numeric(value),ID=as.numeric(ID),<br>         name=as.numeric(name),<br>         name=name*<span>100</span>)<br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span><span></span>统计最大最小值</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code>min_value &lt;- round(min(df$value, na.rm = <span>TRUE</span>))<br>max_value &lt;- round(max(df$value, na.rm = <span>TRUE</span>))<br><br><span># 创建一个四舍五入后的整数序列作为breaks</span><br>breaks_value &lt;- seq(min_value, max_value, by = <span>1</span>)<br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span><span></span>数据可视化</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code>df %&gt;% ggplot(aes(ID,name,fill=value))+<br>  geom_tile()+<br>  geom_vline(xintercept = <span>0.25</span>,color=<span>"#4DAF4A"</span>)+<br>  geom_hline(yintercept = <span>0</span>,linetype=<span>"dashed"</span>)+<br>  labs(x=<span>NULL</span>,y=<span>NULL</span>)+<br>  scale_fill_gradientn(colors=rev(met.brewer(<span>"Hiroshige"</span>)),<br>                       limits = c(min(breaks_value),max(breaks_value)),<br>                       breaks = breaks_value,<br>                       na.value = <span>NA</span>)+<br>  guides(fill=guide_colorsteps(show.limits = <span>TRUE</span>,<br>                               title=<span>"Change in eCO&lt;sub&gt;2&lt;/sub&gt;(ind) (gc m&lt;sup&gt;-2&lt;/sup&gt;ppm&lt;sup&gt;-1&lt;/sup&gt;)"</span>,<br>                               title.position=<span>"bottom"</span>,<br>                               breaks = breaks_value,<br>                               barwidth = <span>28</span>,barheight =<span>1</span>))+<br>  theme_test()+<br>  theme(legend.position = <span>"bottom"</span>,<br>        legend.direction = <span>"horizontal"</span>,<br>        axis.text=element_text(color=<span>"black"</span>),<br>        axis.ticks.length.x = unit(-<span>0.2</span>,<span>"cm"</span>),<br>        axis.ticks.length.y = unit(-<span>0.2</span>,<span>"cm"</span>),<br>        legend.text = element_text(color=<span>"black"</span>),<br>        legend.title = element_markdown(hjust=<span>0.5</span>,color=<span>"black"</span>,face=<span>"bold"</span>,size=<span>9</span>))<br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span><span></span>淘宝扫一扫</span><span></span></h3><figure data-tool="mdnice编辑器"><img data-imgfileid="100026131" data-ratio="1.5936675461741425" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZPz6sI193pv0wDTFbYiaibicprQPMT2iba9xicMicZTqEtibeb7nVt2LoeVxecvAMFeK3klxG1d2feLwgwQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="758" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZPz6sI193pv0wDTFbYiaibicprQPMT2iba9xicMicZTqEtibeb7nVt2LoeVxecvAMFeK3klxG1d2feLwgwQ/640?wx_fmt=png&amp;from=appmsg"></figure><h3 data-tool="mdnice编辑器"><span></span><span><span></span>淘宝店铺(有需要欢迎关注)</span><span></span></h3><p><img data-galleryid="" data-imgfileid="100019415" data-ratio="1.0210420841683367" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/EibnicgwScTAbvhPDLGT8NaialEsht92PTYNJWpmVLfoYGic1uha5FyBrDCibibZCLjiazgvpT1XcdwibfVywD2el0VAgg/640?wx_fmt=jpeg" data-type="jpeg" data-w="998" src="https://mmbiz.qpic.cn/mmbiz_jpg/EibnicgwScTAbvhPDLGT8NaialEsht92PTYNJWpmVLfoYGic1uha5FyBrDCibibZCLjiazgvpT1XcdwibfVywD2el0VAgg/640?wx_fmt=jpeg"></p><h3 data-tool="mdnice编辑器"><span></span><span><span></span>关注下方公众号下回更新不迷路</span><span></span></h3><section><mp-common-profile data-pluginname="mpprofile" data-id="Mzg3MzQzNTYzMw==" data-headimg="http://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZF0rpeZII9Ltl26VbVagriczTria1fib3XgjwwHEHFjPzkmGpqWDVVHBSzhENictUM2iavAKiaM5lc9USw/0?wx_fmt=png" data-nickname="R语言数据分析指南" data-alias="YanJANtwo" data-signature="R语言重症爱好者，喜欢绘制各种精美的图表，喜欢的小伙伴可以关注我，跟我一起学习" data-from="0" data-is_biz_ban="0"></mp-common-profile></section><p data-tool="mdnice编辑器"><br></p></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/qQx1fzLWyi1I946CKZvkBg",target="_blank" rel="noopener noreferrer">原文链接</a>
