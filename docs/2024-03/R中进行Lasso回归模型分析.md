---
title: "R中进行Lasso回归模型分析"
date: 2024-03-14T15:54:54Z
draft: ["false"]
tags: [
  "fetched",
  "R语言数据分析指南"
]
categories: ["Acdemic"]
---
R中进行Lasso回归模型分析 by R语言数据分析指南
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><h3 data-tool="mdnice编辑器"><span></span><span><span></span>欢迎关注R语言数据分析指南</span><span></span></h3><p data-tool="mdnice编辑器">本节来介绍一下如何使用R语言进行Lasso回归模型分析</p><blockquote data-tool="mdnice编辑器"><span>❝</span><p>Lasso回归是一种线性回归的扩展，通过引入L1正则化来精简模型，使得某些系数归零，实现自动的变量选择。这种方法特别适用于高维数据集，帮助防止过拟合并增强模型泛化。在统计和机器学习等多个领域，Lasso因其优异的特征选择能力而受到青睐。通过调整正则化参数允许在准确性和简洁性之间达到最佳平衡。</p><span>❞</span></blockquote><p data-tool="mdnice编辑器">Lasso分析可使用glmnet包中的cv.glmnet函数来执行Lasso回归，并通过交叉验证选出最优的正则化参数λ。下面通过R中著名的mtcars数据集来进行展示。</p><pre data-tool="mdnice编辑器"><span></span><code>set.seed(<span>123</span>) <span># 设置种子数 </span><br><span>library</span>(glmnet)  <br><span>library</span>(tidyverse)<br><span>library</span>(psych)  <br><br>data(<span>"mtcars"</span>) <span># 加载数据集</span><br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span><span></span>数据准备</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code>y &lt;- mtcars %&gt;% select(mpg) %&gt;% <br>scale(center = <span>TRUE</span>, scale = <span>FALSE</span>) %&gt;% as.matrix()<br><span># 从mtcars数据集中选取mpg列作为响应变量y，并进行中心化（减去平均值），转换为矩阵格式。</span><br>X &lt;- mtcars %&gt;% select(-mpg) %&gt;% as.matrix()<br><span># 从mtcars中选取除mpg外的所有列作为预测变量X，并转换为矩阵格式。</span><br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span><span></span>losso回归交叉验证</span><span></span></h3><blockquote data-tool="mdnice编辑器"><span>❝</span><p>在使用cv.glmnet函数时，可以不手动设置lambda参数而使用其默认值。当lambda没有被明确设置时，glmnet会自动生成一个lambda序列，该序列基于提供的数据范围，并尝试找到最佳的lambda。这个自动生成的序列旨在覆盖从最大值（在该lambda下，所有系数均为零）到足够小的值（几乎所有的系数都不会被压缩到零）的范围。</p><span>❞</span></blockquote><pre data-tool="mdnice编辑器"><span></span><code>lasso_cv &lt;- cv.glmnet(X, y, alpha = <span>1</span>,standardize = <span>TRUE</span>,nfolds = <span>10</span>)<br></code></pre><ul data-tool="mdnice编辑器"><li><section>alpha = 1执行Lasso回归，alpha = 0指定模型为岭回归</section></li><li><section>standardize = TRUE意味着在模型拟合前将预测变量标准化（减去均值并除以标准差）</section></li><li><section>nfolds = 10指定了进行10折交叉验证。</section></li></ul><pre data-tool="mdnice编辑器"><span></span><code>plot(lasso_cv) <span># 绘制Lasso回归的交叉验证结果图</span><br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100026512" data-ratio="0.7962962962962963" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAaOhyKqbmcrNOdwS57iceSAOuicf00DyUvDayj3lC9OASpzyOAuoyvTU5ICgywXKiavbto3B0HiafaLZg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAaOhyKqbmcrNOdwS57iceSAOuicf00DyUvDayj3lC9OASpzyOAuoyvTU5ICgywXKiavbto3B0HiafaLZg/640?wx_fmt=png&amp;from=appmsg"></figure><pre data-tool="mdnice编辑器"><span></span><code>&gt; lasso_cv<br><br>Call:  cv.glmnet(x = X, y = y, nfolds = <span>10</span>, alpha = <span>1</span>, standardize = <span>TRUE</span>) <br><br>Measure: Mean-Squared Error <br><br>    Lambda Index Measure    SE Nonzero<br>min <span>0.5519</span>    <span>25</span>   <span>7.046</span> <span>1.965</span>       <span>5</span><br>1se <span>1.3993</span>    <span>15</span>   <span>8.839</span> <span>2.446</span>       <span>3</span><br></code></pre><blockquote data-tool="mdnice编辑器"><span>❝</span><p>Lambda: 表示不同情况下的lambda值。lambda.min是0.5519，这是使交叉验证的均方误差最小的lambda值；lambda.1se是1.3993，这是在保持模型简洁性的前提下，给出接近最小MSE的一个较大的lambda值。<br>Index: 表示lambda值在尝试的序列中的位置。<br>Measure: 这列表示在给定lambda值下通过交叉验证计算得到的均方误差。SE: 表示MSE的标准误差。Nonzero: 表示在给定lambda值下，模型中系数不为零的特征数量。</p><span>❞</span></blockquote><blockquote data-tool="mdnice编辑器"><span>❝</span><p>在实际应用中，lambda.min提供了最小化交叉验证MSE的模型，而lambda.1se则提供了一个在MSE相对较小的同时，模型更为简化的选择。选择哪一个取决于你对模型复杂度和预测准确性之间的权衡。如果偏好更简单的模型（可能牺牲一些准确性），可以选择lambda.1se；如果目标是最小化预测误差，那么lambda.min是更好的选择。</p><span>❞</span></blockquote><pre data-tool="mdnice编辑器"><span></span><code>best_lambda &lt;- lasso_cv$lambda.min<br>lasso_best &lt;- glmnet(X, y,alpha = <span>1</span>,lambda = best_lambda,standardize = <span>TRUE</span>)<br><br>Call:  glmnet(x = X, y = y, alpha = <span>1</span>, lambda = best_lambda, standardize = <span>TRUE</span>) <br><br>  Df  %Dev Lambda<br><span>1</span>  <span>3</span> <span>82.11</span> <span>0.8007</span><br></code></pre><blockquote data-tool="mdnice编辑器"><span>❝</span><p>Df: 代表模型中非零系数的特征数目。<br>%Dev: 表示模型解释的响应变量方差的百分比，也可以被理解为模型拟合优度的一种衡量。在这里，%Dev是82.11%，表明该Lasso模型能够解释大约82.11%的响应变量方差，这是一个相对较高的值，表示模型拟合得较好。<br>Lambda: 这是用于拟合模型的lambda参数的值。Lambda为0.8007，这是通过交叉验证确定的最优值，用于在模型复杂性（即系数的数量）和模型拟合之间达到平衡。</p><span>❞</span></blockquote><h3 data-tool="mdnice编辑器"><span></span><span><span></span>动态过程图</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code><span># 定义响应变量和预测变量</span><br>y &lt;- mtcars$mpg<br>X &lt;- as.matrix(mtcars %&gt;% select(-mpg))<br><span># 使用交叉验证执行Lasso回归以确定最佳lambda值</span><br>cv_model &lt;- cv.glmnet(X, y, alpha = <span>1</span>, family = <span>"gaussian"</span>)<br><span># 绘制交叉验证误差曲线</span><br>plot(cv_model)<br><span># 绘制变量系数随lambda变化的动态过程图</span><br>plot(cv_model$glmnet.fit, xvar = <span>"lambda"</span>, label = <span>FALSE</span>)<br>legend(<span>"topright"</span>, legend = colnames(X), lty = <span>1</span>, col = <span>1</span>:ncol(X), cex = <span>0.7</span>)<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100026513" data-ratio="0.7601851851851852" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAaOhyKqbmcrNOdwS57iceSAO4VMTEIYDH8dZKUY88HyOj8ia1NczyBCSic285VQDsY5CYoC4iateM69fg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAaOhyKqbmcrNOdwS57iceSAO4VMTEIYDH8dZKUY88HyOj8ia1NczyBCSic285VQDsY5CYoC4iateM69fg/640?wx_fmt=png&amp;from=appmsg"></figure><blockquote data-tool="mdnice编辑器"><span>❝</span><p>若cv_model只有单个lambda值的模型，而没有整个lambda序列的结果时。在这种情况下，绘制系数路径图的功能可能不会有结果，因为路径图需要多个lambda值来展示系数如何随lambda变化。<br>要解决这个问题并得到一个有用的图，可以使用带有多个lambda值的原始cv_model对象来绘制路径图。cv_model对象在交叉验证过程中考虑了多个lambda值，并保存了这些lambda值下的系数，这使得它成为绘制系数路径的理想选择。</p><span>❞</span></blockquote><blockquote data-tool="mdnice编辑器"><span>❝</span><p>本节介绍到此结束，有需要学习数据可视化的朋友欢迎加入小编的VIP会员群，购买小编VIP会员文档的读者，<strong>「将自动获得2024年及以后更新的绘图文档代码，无需额外付费」</strong>。目前会员文档(2023+2024)<strong>「已经更新上传了140+案例文档」</strong>，每个案例都附有相应的数据和代码，并配有对应的注释文档，方便大家学习和参考。<strong>「有需要者欢迎店铺咨询购买」</strong></p><span>❞</span></blockquote><p data-tool="mdnice编辑器"><strong>「2024更新的绘图内容同时包含数据+代码+markdown注释文档+文档清单」</strong><img data-imgfileid="100026514" data-ratio="0.6175925925925926" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAaOhyKqbmcrNOdwS57iceSAOichlGlsP5vzre5E56YMicLA4QNolo3TgbicuwT5OwKpHeFAt5YswPZ5yg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAaOhyKqbmcrNOdwS57iceSAOichlGlsP5vzre5E56YMicLA4QNolo3TgbicuwT5OwKpHeFAt5YswPZ5yg/640?wx_fmt=png&amp;from=appmsg"></p><h3 data-tool="mdnice编辑器"><span></span><span><span></span>淘宝店铺(长按二维码跳转)</span><span></span></h3><p><img data-galleryid="" data-imgfileid="100019415" data-ratio="1.0210420841683367" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/EibnicgwScTAbvhPDLGT8NaialEsht92PTYNJWpmVLfoYGic1uha5FyBrDCibibZCLjiazgvpT1XcdwibfVywD2el0VAgg/640?wx_fmt=jpeg" data-type="jpeg" data-w="998" src="https://mmbiz.qpic.cn/mmbiz_jpg/EibnicgwScTAbvhPDLGT8NaialEsht92PTYNJWpmVLfoYGic1uha5FyBrDCibibZCLjiazgvpT1XcdwibfVywD2el0VAgg/640?wx_fmt=jpeg"></p><h3 data-tool="mdnice编辑器"><span></span><span>关注下方公众号下回更新不迷路</span><span></span></h3><section><mp-common-profile data-pluginname="mpprofile" data-id="Mzg3MzQzNTYzMw==" data-headimg="http://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZF0rpeZII9Ltl26VbVagriczTria1fib3XgjwwHEHFjPzkmGpqWDVVHBSzhENictUM2iavAKiaM5lc9USw/0?wx_fmt=png" data-nickname="R语言数据分析指南" data-alias="YanJANtwo" data-signature="R语言重症爱好者，喜欢绘制各种精美的图表，喜欢的小伙伴可以关注我，跟我一起学习" data-from="0" data-is_biz_ban="0"></mp-common-profile></section></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/R_7kj8nQTk6t37gVnkOpwg",target="_blank" rel="noopener noreferrer">原文链接</a>
