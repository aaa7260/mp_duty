---
title: "写个包 metaplot 绘制 m6A peak 分布"
date: 2024-03-24T00:37:20Z
draft: ["false"]
tags: [
  "fetched",
  "老俊俊的生信笔记"
]
categories: ["Acdemic"]
---
写个包 metaplot 绘制 m6A peak 分布 by 老俊俊的生信笔记
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-mpa-powered-by="yiban.io"><h4 data-tool="mdnice编辑器"><section><mp-common-profile data-pluginname="mpprofile" data-id="MzkyMTI1MTYxNA==" data-headimg="http://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usezgsqIGqjITSMggCTSoViaYeoKe2xoZr1IIvNJoztibQxibYHLDDoiabwAc6Ggws3Tvdo8EPss2nLgaVQ/0?wx_fmt=png" data-nickname="老俊俊的生信笔记" data-alias="JunJunLab" data-signature="老俊俊的生信技能和知识分享,我不是巨人,但你可以站在我的肩膀上更进一步!" data-from="0" data-is_biz_ban="0"></mp-common-profile></section><span></span></h4><h2 data-tool="mdnice编辑器"><span><span>1</span></span><span>引言</span><span></span></h2><blockquote data-tool="mdnice编辑器"><span></span><p>使用 <strong>Guitar</strong> 包绘制 m6A peak 分布时间耗时较长,且经常会发生一些搞不清楚的报错。在去年完成了基础框架的搭建,不如把这些代码打包一下。</p></blockquote><h2 data-tool="mdnice编辑器"><span><span>2</span></span><span>安装</span><span></span></h2><pre data-tool="mdnice编辑器"><span></span><code><span># install.packages("devtools")</span><br>devtools::install_github(<span>"junjunlab/metaplot"</span>)<br><br><span># or</span><br>remotes::install_github(<span>"junjunlab/metaplot"</span>)<br></code></pre><h2 data-tool="mdnice编辑器"><span><span>3</span></span><span>使用</span><span></span></h2><blockquote data-tool="mdnice编辑器"><span></span><p>使用 <strong>prepare_features</strong>来准备特征文件。</p></blockquote><pre data-tool="mdnice编辑器"><span></span><code><span>library</span>(metaplot)<br><span>library</span>(ggplot2)<br><br><span># test</span><br>feature_anno &lt;- prepare_features(gtf_file = <span>"Homo_sapiens.GRCh38.111.gtf.gz"</span>)<br></code></pre><blockquote data-tool="mdnice编辑器"><span></span><p><strong>metaPlot</strong> 来进行可视化。</p></blockquote><pre data-tool="mdnice编辑器"><span></span><code>meta &lt;- metaPlot(bed_file = <span>"ed.rep1_summits.bed"</span>,<br>                 features_anno = feature_anno)<br></code></pre><blockquote data-tool="mdnice编辑器"><span></span><p>返回的结果包含了数据和图。</p></blockquote><pre data-tool="mdnice编辑器"><span></span><code>df_data &lt;- meta$data<br><br><span># check</span><br>head(df_data,<span>3</span>)<br><br><span>#   type  rel_pos         group_names</span><br><span># 1  CDS 1.422274 ed.rep1_summits.bed</span><br><span># 2 UTR3 2.546256 ed.rep1_summits.bed</span><br><span># 3 UTR3 2.365882 ed.rep1_summits.bed</span><br></code></pre><p data-tool="mdnice编辑器">图形:</p><pre data-tool="mdnice编辑器"><span></span><code><span># plot</span><br>meta$plot<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100029250" data-ratio="0.6147403685092128" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usexricMm56jcvJKicIFX2ORkq49LiaPyAyHMkL7QCumAR84ghssfTGN33ia6gXl3CAtfUApwH3ed2iagpqA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="597" src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usexricMm56jcvJKicIFX2ORkq49LiaPyAyHMkL7QCumAR84ghssfTGN33ia6gXl3CAtfUApwH3ed2iagpqA/640?wx_fmt=png&amp;from=appmsg"></figure><blockquote data-tool="mdnice编辑器"><span></span><p><strong>scale_region</strong> 归一化特征区域长度。</p></blockquote><pre data-tool="mdnice编辑器"><span></span><code>meta &lt;- metaPlot(bed_file = <span>"ed.rep1_summits.bed"</span>,<br>                 features_anno = feature_anno,<br>                 scale_region = <span>T</span>)<br><br>meta$plot<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100029251" data-ratio="0.6271186440677966" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usexricMm56jcvJKicIFX2ORkq4KuLEKwMJFMSTKfDlYia0gM9WPiaPuleRHkzuJtwuHVT03RJicU9TVdKKg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="590" src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usexricMm56jcvJKicIFX2ORkq4KuLEKwMJFMSTKfDlYia0gM9WPiaPuleRHkzuJtwuHVT03RJicU9TVdKKg/640?wx_fmt=png&amp;from=appmsg"></figure><blockquote data-tool="mdnice编辑器"><span></span><p>多个样本展示。</p></blockquote><pre data-tool="mdnice编辑器"><span></span><code>meta &lt;- metaPlot(bed_file = list(<span>"ed.rep1_summits.bed"</span>,<br>                                 <span>"pa.rep1_summits.bed"</span>),<br>                 group_names = c(<span>"ed"</span>,<span>"pa"</span>),<br>                 features_anno = feature_anno)<br><br>meta$plot<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100029254" data-ratio="0.6638225255972696" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usexricMm56jcvJKicIFX2ORkq4Vxe4xKGtTePn5Kqria1RNzGFcubmDadGrhbTQRN7bcVm9rss9ibicZuwA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="586" src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usexricMm56jcvJKicIFX2ORkq4Vxe4xKGtTePn5Kqria1RNzGFcubmDadGrhbTQRN7bcVm9rss9ibicZuwA/640?wx_fmt=png&amp;from=appmsg"></figure><blockquote data-tool="mdnice编辑器"><span></span><p>分面展示。</p></blockquote><pre data-tool="mdnice编辑器"><span></span><code>meta &lt;- metaPlot(bed_file = list(<span>"ed.rep1_summits.bed"</span>,<br>                                 <span>"pa.rep1_summits.bed"</span>),<br>                 group_names = c(<span>"ed"</span>,<span>"pa"</span>),<br>                 features_anno = feature_anno,<br>                 facet = <span>T</span>)<br><br>meta$plot +<br>  theme(strip.background = element_blank(),<br>        strip.text = element_text(face = <span>"bold"</span>,size = rel(<span>1.1</span>)))<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100029253" data-ratio="0.5053191489361702" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usexricMm56jcvJKicIFX2ORkq43z1gavA6nturJwJticicEBfznU3yWLlPmKDicia71ib4jALZDtzpCIDpEjQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="752" src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usexricMm56jcvJKicIFX2ORkq43z1gavA6nturJwJticicEBfznU3yWLlPmKDicia71ib4jALZDtzpCIDpEjQ/640?wx_fmt=png&amp;from=appmsg"></figure><hr data-tool="mdnice编辑器"><blockquote data-tool="mdnice编辑器"><span></span><p>展示个 METTL3 敲除的看看。</p></blockquote><pre data-tool="mdnice编辑器"><span></span><code>feature_anno &lt;- prepare_features(gtf_file = <span>"hg19.ncbiRefSeq.gtf.gz"</span>,<br>                                 features_name = c(<span>"5UTR"</span>,<span>"CDS"</span>,<span>"3UTR"</span>))<br><br>meta &lt;- metaPlot(bed_file = list(<span>"GSE211588_control12_merge.narrowPeak"</span>,<br>                                 <span>"GSE211588_koMETTL3_12_merge.narrowPeak"</span>),<br>                 group_names = c(<span>"Control"</span>,<span>"METTL3 KO"</span>),<br>                 features_anno = feature_anno)<br><br>meta$plot<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100029252" data-ratio="0.5086092715231788" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usexricMm56jcvJKicIFX2ORkq4GEyHO7hP4y4wExlcwnMcJB6R0bw30CBqXtRMnOeFBScaicKauUqmAibA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="755" src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usexricMm56jcvJKicIFX2ORkq4GEyHO7hP4y4wExlcwnMcJB6R0bw30CBqXtRMnOeFBScaicKauUqmAibA/640?wx_fmt=png&amp;from=appmsg"></figure><hr data-tool="mdnice编辑器"><blockquote data-tool="mdnice编辑器"><span></span><p>画个 m1A 和 m6A 的分布。</p></blockquote><pre data-tool="mdnice编辑器"><span></span><code>feature_anno &lt;- prepare_features(gtf_file = <span>"hg19.ncbiRefSeq.gtf.gz"</span>,<br>                                 features_name = c(<span>"5UTR"</span>,<span>"CDS"</span>,<span>"3UTR"</span>))<br><br>meta &lt;- metaPlot(bed_file = list(<span>"GSE102493_Ctrl_m6A.narrowPeak"</span>,<br>                                 <span>"m1A-peaks.bed"</span>),<br>                 group_names = c(<span>"m6A"</span>,<span>"m1A"</span>),<br>                 features_anno = feature_anno)<br><br>meta$plot<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100029255" data-ratio="0.5019973368841545" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usexricMm56jcvJKicIFX2ORkq4cVWrHYdmw7p4faia6clibibUKiaHHen2uDadibc4KiaYEP9DN0kia3IqzHZvQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="751" src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usexricMm56jcvJKicIFX2ORkq4cVWrHYdmw7p4faia6clibibUKiaHHen2uDadibc4KiaYEP9DN0kia3IqzHZvQ/640?wx_fmt=png&amp;from=appmsg"></figure><pre data-tool="mdnice编辑器"><span></span><code>meta &lt;- metaPlot(bed_file = list(<span>"GSE102493_Ctrl_m6A.narrowPeak"</span>,<br>                                 <span>"m1A-peaks.bed"</span>),<br>                 group_names = c(<span>"m6A"</span>,<span>"m1A"</span>),<br>                 features_anno = feature_anno,<br>                 scale_region = <span>T</span>)<br><br>meta$plot<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100029256" data-ratio="0.5148247978436657" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usexricMm56jcvJKicIFX2ORkq4UibTEf7x0S0qdcnz7xqOiaryB89JKDD1R398h1RlpGmqRAS7ib6hgNbNA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="742" src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usexricMm56jcvJKicIFX2ORkq4UibTEf7x0S0qdcnz7xqOiaryB89JKDD1R398h1RlpGmqRAS7ib6hgNbNA/640?wx_fmt=png&amp;from=appmsg"></figure><h2 data-tool="mdnice编辑器"><span><span>4</span></span><span>结尾</span><span></span></h2><blockquote data-tool="mdnice编辑器"><span></span><p><strong>路漫漫其修远兮,吾将上下而求索。</strong></p></blockquote><hr data-tool="mdnice编辑器"><p data-tool="mdnice编辑器">欢迎加入生信交流群。加我微信我也拉你进 <strong>微信群聊</strong> <strong>老俊俊生信交流群</strong> <strong>(微信交流群需收取 20 元入群费用,一旦交费,拒不退还!(防止骗子和便于管理))</strong> 。QQ 群可免费加入, 记得进群按格式修改备注哦。</p><section data-tool="mdnice编辑器"><section><p><strong>老俊俊微信：</strong></p><figure><img data-imgfileid="100029259" data-ratio="1" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usexricMm56jcvJKicIFX2ORkq4osK3eA5kHXQV2WRyNW7zWS1dNbtQzKe4QDMoHax4wjhjWRicozqsaMw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="430" src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usexricMm56jcvJKicIFX2ORkq4osK3eA5kHXQV2WRyNW7zWS1dNbtQzKe4QDMoHax4wjhjWRicozqsaMw/640?wx_fmt=png&amp;from=appmsg"></figure><figure><img data-imgfileid="100029257" data-ratio="1.3668430335097002" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usexricMm56jcvJKicIFX2ORkq46qZaaYLMic7r7Htzcqh0yb4icMlhZ6GibibhxkabcnUvV6icaUsXDa1q66w/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="567" src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usexricMm56jcvJKicIFX2ORkq46qZaaYLMic7r7Htzcqh0yb4icMlhZ6GibibhxkabcnUvV6icaUsXDa1q66w/640?wx_fmt=png&amp;from=appmsg"></figure></section><section><p><strong>知识星球：</strong></p><figure><img data-imgfileid="100029258" data-ratio="1.5896226415094339" data-src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/G5jjcE4usexricMm56jcvJKicIFX2ORkq4v91JkjkWcw1KhzBxA03XcCqfiaX4cIHwuu4Q9zicakzH6XRFT9HtoicJw/640?wx_fmt=jpeg&amp;from=appmsg" data-type="jpeg" data-w="1060" src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/G5jjcE4usexricMm56jcvJKicIFX2ORkq4v91JkjkWcw1KhzBxA03XcCqfiaX4cIHwuu4Q9zicakzH6XRFT9HtoicJw/640?wx_fmt=jpeg&amp;from=appmsg"></figure></section></section><hr data-tool="mdnice编辑器"><p data-tool="mdnice编辑器"><strong></strong></p><center data-tool="mdnice编辑器"><strong> 往期回顾目录</strong></center><blockquote data-tool="mdnice编辑器"><span></span><p><strong></strong></p><center><strong><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247512856&amp;idx=1&amp;sn=7f9fd9406d4768535450ef9e2df44890&amp;chksm=c1848969f6f3007fb1e0010b0ce49fd5738fa5fd8f4759ffea56cfbe89ffaaf29e1016ed149e&amp;token=709285857&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">当 ggSCvis 遇到 ggmagnify</a></strong></center><strong><center><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247512812&amp;idx=1&amp;sn=c90eeab4ddc6aeaae7986ca163eba10e&amp;chksm=c184889df6f3018bc89c07de8b7aea1a22b7b284320dbf4280cd60ce5b4fad1a65486116ec62&amp;token=555204851&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">在模仿中精进数据可视化_使用ggcirclize绘制circos圈图</a></center></strong><strong><center><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247512783&amp;idx=1&amp;sn=2535eaafd12934a3067e88f00f17d59a&amp;chksm=c18488bef6f301a8fcd1efa4dbe75d2c0d794cdedde2151528d3841e61e902d9c3ebbc2915c4&amp;token=1338300207&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">单细胞二维密度图一文拿捏!</a></center></strong><strong><center><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247512748&amp;idx=1&amp;sn=6678a6672774f1a629701ea74db526fa&amp;chksm=c18488ddf6f301cb2522153dfab8b690bd26ea46e7db2fc03dcf923daef3f594b0442dadd9a6&amp;token=1867459500&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">coord_polar2 补充极坐标图形短板</a></center></strong><strong><center><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247512715&amp;idx=1&amp;sn=e599a44ed4013bf5512dc5f926833495&amp;chksm=c18488faf6f301ecdcd5dd4b5324fb6b86a560ce381102c45111e7ac9498ff10648127086b19&amp;token=2102927728&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">ggplot 绘制热图标注特定名称</a></center></strong><strong><center><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247512646&amp;idx=1&amp;sn=d9241b243771dcb355c74fd1a7f9431c&amp;chksm=c1848837f6f301216f9d4c06659f01814b54994b552b5f15d9df9c5b227f417288a7cd4061e6&amp;token=2102927728&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">听说你只有富集表格还想画 GSEA 图?</a></center></strong><strong><center><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247512269&amp;idx=1&amp;sn=0208555abacffaed2e8a8437c8b43214&amp;chksm=c1848abcf6f303aa83091c6c517b054ba4f7da2edc8de0fb86a2878064a91375a67cee89fd3b&amp;token=864433526&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">ggSCvis 可视化 dot/heatmap/violin plot 示例</a></center></strong><strong><center><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247512189&amp;idx=1&amp;sn=1cc5cb6167f9d3960922dd691aa376db&amp;chksm=c1848a0cf6f3031a4b9b1ab4195d525269703553f84ef29ea312878c60accfec07ca3a3102d6&amp;token=864433526&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">给你的亚群添加编号</a></center></strong><strong><center><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247512093&amp;idx=1&amp;sn=b44680cfccfa7c0bb0a59eef29b944fc&amp;chksm=c1848a6cf6f3037ad9e74e898575125b0cbd0d372c25805315559e5e41c9168c6e8612418896&amp;token=1185565850&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">ggSCvis 让你的单细胞可视化 gg 起来</a></center></strong><strong><center><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247511755&amp;idx=1&amp;sn=b5758249eef3fdf4946aae0f4e7ef592&amp;chksm=c18494baf6f31dacdbf6e4a1ba0a05817b087a9bc1ad2a6b8b79959903ce5b96156e4e1a2faf&amp;token=1185565850&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">easylift 基因组坐标轻松转换</a></center></strong></blockquote></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/KGT93_SRaS3QB9i0gNHGBA",target="_blank" rel="noopener noreferrer">原文链接</a>
