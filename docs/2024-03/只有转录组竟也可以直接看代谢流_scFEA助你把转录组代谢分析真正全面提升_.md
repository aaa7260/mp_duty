---
title: "只有转录组竟也可以直接看代谢流？scFEA助你把转录组代谢分析真正全面提升！"
date: 2024-03-11T13:43:34Z
draft: ["false"]
tags: [
  "fetched",
  "生信作曲家"
]
categories: ["Acdemic"]
---
只有转录组竟也可以直接看代谢流？scFEA助你把转录组代谢分析真正全面提升！ by 生信作曲家
------
<div><section><section><mp-common-profile data-pluginname="mpprofile" data-id="MzI5ODI0NzM2OQ==" data-headimg="http://mmbiz.qpic.cn/mmbiz_png/mo60jlFOtaDQIG3BiaPDOAtTJDzqbyPp4crVHnib8fS6Gp6DMjvJJkK9bhPWe6wpNujV93n60FymcjAOfum0t9PA/0?wx_fmt=png" data-nickname="生信作曲家" data-alias="Bioinfo_composer" data-signature="交流生物信息学习经验，分享科研SCI撰写思路和规范，传递最新生物医药资讯。" data-from="0"></mp-common-profile></section><h3><span>方法简介</span></h3><p>转录组或单细胞的<span><strong>代谢分析</strong></span>是重要的分析内容，往常的分析方法使用到的代谢评估往往是<span><strong>“基于通路的得分”</strong></span>，例如常常使用scMetabolism等。基于通路的得分分析，往往<strong>并不能告诉我们太多有关于代谢物质的信息</strong>，而代谢组学的公开数据实际上是比较缺乏的.这一点，随着分析的深入，限制性尤为突出。</p><p><strong>例如</strong>评估得到“脂肪酸代谢”通路上调，但是<strong><span>到底是物质什么转化为什么物质增强</span></strong>？这是不得而知的，只能粗糙地表述为某代谢通路。</p><p>作曲家深思熟虑这一痛点问题，此次分享给大家<span><strong>scFEA (single-cell Flux Estimation Analysis)</strong></span>，可以从<em>转录组出发</em>，直接获取<strong><em><span>具体</span></em></strong>代谢途径的丰度，从而明确到底什么代谢物质发生了改变！例如谷氨酸变谷氨酰胺再变GABA再变琥珀酸。</p><p><img data-imgfileid="100004994" data-ratio="0.11481481481481481" data-type="png" data-w="1080" data-src="https://mmbiz.qpic.cn/mmbiz_png/mo60jlFOtaB9vS6wnPDEH9QRQuNXhHNOtrAXy5KVHc2c0cdZSZq4f3yoicuWvevBgtoK1ak1CPNSAfOesrJbHnQ/640?wx_fmt=png&amp;from=appmsg" src="https://mmbiz.qpic.cn/mmbiz_png/mo60jlFOtaB9vS6wnPDEH9QRQuNXhHNOtrAXy5KVHc2c0cdZSZq4f3yoicuWvevBgtoK1ak1CPNSAfOesrJbHnQ/640?wx_fmt=png&amp;from=appmsg"><br></p><p>这一分析非常关键，<span><strong>可以直接打通转录组到代谢组的壁垒。</strong></span></p><p>作曲家在此前已经打破了转录组到蛋白组的壁垒，即metaViper算法</p><figure><blockquote data-type="1" data-url="http://mp.weixin.qq.com/s?__biz=MzI5ODI0NzM2OQ==&amp;mid=2247484525&amp;idx=2&amp;sn=4dd1c95e862f6a1f5f8c9502dde958b0&amp;chksm=eca9f1cbdbde78dda5288fdf64e555e3c1409a1612181976e9df0f9ec3a7131f0aaaaafe53b8#rd" data-author-name="Bioinfo composer" data-content-utf8-length="12" data-source-title="metaVIPER：从单细胞转录组推断单细胞蛋白活性，你试过吗？" data-text="转录到蛋白的壁垒已被打破" data-editid="5fergd4z49400000000"><section><p>转录到蛋白的壁垒已被打破</p></section><section data-json="%7B%22type%22%3A%22inner%22%2C%22source%22%3A%22biz%22%2C%22digest%22%3A%22%3Cp%3E%E8%BD%AC%E5%BD%95%E5%88%B0%E8%9B%8B%E7%99%BD%E7%9A%84%E5%A3%81%E5%9E%92%E5%B7%B2%E8%A2%AB%E6%89%93%E7%A0%B4%3C%2Fp%3E%22%2C%22digestLen%22%3A12%2C%22text%22%3A%22%22%2C%22article%22%3A%7B%22title%22%3A%22metaVIPER%EF%BC%9A%E4%BB%8E%E5%8D%95%E7%BB%86%E8%83%9E%E8%BD%AC%E5%BD%95%E7%BB%84%E6%8E%A8%E6%96%AD%E5%8D%95%E7%BB%86%E8%83%9E%E8%9B%8B%E7%99%BD%E6%B4%BB%E6%80%A7%EF%BC%8C%E4%BD%A0%E8%AF%95%E8%BF%87%E5%90%97%EF%BC%9F%22%2C%22url%22%3A%22http%3A%2F%2Fmp.weixin.qq.com%2Fs%3F__biz%3DMzI5ODI0NzM2OQ%3D%3D%26mid%3D2247484525%26idx%3D2%26sn%3D4dd1c95e862f6a1f5f8c9502dde958b0%26chksm%3Deca9f1cbdbde78dda5288fdf64e555e3c1409a1612181976e9df0f9ec3a7131f0aaaaafe53b8%23rd%22%2C%22nickname%22%3A%22%E7%94%9F%E4%BF%A1%E4%BD%9C%E6%9B%B2%E5%AE%B6%22%2C%22authorName%22%3A%22Bioinfo%20composer%22%7D%2C%22hasReportOverSize%22%3Afalse%2C%22editorReportData%22%3A%5B%7B%22id%22%3A%22122333%22%2C%22key%22%3A%2278%22%2C%22len%22%3A1%7D%5D%7D"><span>Bioinfo composer，公众号：生信作曲家<a href="http://mp.weixin.qq.com/s?__biz=MzI5ODI0NzM2OQ==&amp;mid=2247484525&amp;idx=2&amp;sn=4dd1c95e862f6a1f5f8c9502dde958b0&amp;chksm=eca9f1cbdbde78dda5288fdf64e555e3c1409a1612181976e9df0f9ec3a7131f0aaaaafe53b8#rd">metaVIPER：从单细胞转录组推断单细胞蛋白活性，你试过吗？</a></span></section></blockquote><p><br></p><p><img data-imgfileid="100004995" data-ratio="1.195712954333644" data-type="png" data-w="1073" data-src="https://mmbiz.qpic.cn/mmbiz_png/mo60jlFOtaB9vS6wnPDEH9QRQuNXhHNODK99HKSqTnrxVD7NViaiam3jrzWU2RJa9lD5duYGJGbRYob7KAxiaIicHg/640?wx_fmt=png&amp;from=appmsg" src="https://mmbiz.qpic.cn/mmbiz_png/mo60jlFOtaB9vS6wnPDEH9QRQuNXhHNODK99HKSqTnrxVD7NViaiam3jrzWU2RJa9lD5duYGJGbRYob7KAxiaIicHg/640?wx_fmt=png&amp;from=appmsg"><br></p><figcaption></figcaption>​</figure><blockquote><p><strong>scFEA原理</strong>：单细胞通量估计分析（scFEA），从单细胞RNA测序（scRNA-seq）数据中推断出细胞通量组。scFEA利用系统重构的人类代谢地图作为因子图，一种新颖的概率模型来利用scRNA-seq数据上的通量平衡约束，以及一种基于图神经网络的优化求解器。使用<strong>多层神经网络捕捉了从转录组到代谢组的错综复杂信息传播</strong>，以概括酶基因表达和反应速率之间的非线性依赖关系。应用scFEA显示出了预测通量和匹配代谢组学数据中代谢物丰度变化之间的一致性。我们还在五个公开可用的scRNA-seq和空间转录组学数据集上应用了scFEA，并识别出了上下文和细胞组特定的代谢变化。由scFEA预测的细胞通量组使一系列下游分析成为可能，<strong>包括识别共享常见代谢变化的代谢模块或细胞组、评估酶对整体代谢通量影响的敏感性以及推断细胞组织和细胞间的代谢通讯。</strong></p><p><br></p><p>参考文献：A graph neural network model to estimate cell-wise metabolic flux using single-cell RNA-seq data</p></blockquote><figure><figcaption><br></figcaption></figure><h3><span>安装和环境配置</span></h3><p>下载scFEA包（终端中或是conda prompt中运行）：</p><pre><code>git <span>clone</span> https://github.com/changwn/scFEA<br><br>python src/scFEA.py --<span>help</span><br><span># 其实就是下载github的全部内容，也可以手动下载到本地，使用python src/scFEA.py --help 判断是否成功安装</span><br><span># 下图看到报错</span><br></code></pre><figure><figcaption><img data-imgfileid="100004996" data-ratio="0.15555555555555556" data-type="png" data-w="1080" data-src="https://mmbiz.qpic.cn/mmbiz_png/mo60jlFOtaB9vS6wnPDEH9QRQuNXhHNO1YJa5p77rawaAs2d7smwaTDNwKRyOfO9Zvclx31Na78Qn63AGynlDQ/640?wx_fmt=png&amp;from=appmsg" src="https://mmbiz.qpic.cn/mmbiz_png/mo60jlFOtaB9vS6wnPDEH9QRQuNXhHNO1YJa5p77rawaAs2d7smwaTDNwKRyOfO9Zvclx31Na78Qn63AGynlDQ/640?wx_fmt=png&amp;from=appmsg"></figcaption></figure><p>可以看到缺少一些模块</p><blockquote><p>以下都是需要的模块</p><figure><figcaption><img data-imgfileid="100004997" data-ratio="0.45625841184387617" data-type="png" data-w="743" data-src="https://mmbiz.qpic.cn/mmbiz_png/mo60jlFOtaB9vS6wnPDEH9QRQuNXhHNO1Ts0mvibDCVK9jMcYArwTC7XkFvMahMicn1ian6DXmOaYZ4pwU1ghnZSw/640?wx_fmt=png&amp;from=appmsg" src="https://mmbiz.qpic.cn/mmbiz_png/mo60jlFOtaB9vS6wnPDEH9QRQuNXhHNO1Ts0mvibDCVK9jMcYArwTC7XkFvMahMicn1ian6DXmOaYZ4pwU1ghnZSw/640?wx_fmt=png&amp;from=appmsg"></figcaption></figure></blockquote><pre><code><span># 此处建议用 pip install （或conda）逐个安装</span><br><br>pip install torch<br>pip install numpy <br>pip install pandas <br>pip install matplotlib <br>pip install --user magic-impute  <span>### 注意是这行代码</span><br></code></pre><p><img data-imgfileid="100004998" data-ratio="0.2574074074074074" data-type="png" data-w="1080" data-src="https://mmbiz.qpic.cn/mmbiz_png/mo60jlFOtaB9vS6wnPDEH9QRQuNXhHNOibyibuFXDxfMpNH1qr1MWzScooicpawedn6LUKtKoSgkIfTvfxlLibVlyA/640?wx_fmt=png&amp;from=appmsg" src="https://mmbiz.qpic.cn/mmbiz_png/mo60jlFOtaB9vS6wnPDEH9QRQuNXhHNOibyibuFXDxfMpNH1qr1MWzScooicpawedn6LUKtKoSgkIfTvfxlLibVlyA/640?wx_fmt=png&amp;from=appmsg"></p><figure><figcaption></figcaption><img data-imgfileid="100004999" data-ratio="0.31666666666666665" data-type="png" data-w="1080" data-src="https://mmbiz.qpic.cn/mmbiz_png/mo60jlFOtaB9vS6wnPDEH9QRQuNXhHNO75sQW7kxvXGoI2tEKNtZyqoXyQ2oiccU7oRtARfIXTFsWwJD4MdOHEQ/640?wx_fmt=png&amp;from=appmsg" src="https://mmbiz.qpic.cn/mmbiz_png/mo60jlFOtaB9vS6wnPDEH9QRQuNXhHNO75sQW7kxvXGoI2tEKNtZyqoXyQ2oiccU7oRtARfIXTFsWwJD4MdOHEQ/640?wx_fmt=png&amp;from=appmsg"><figcaption><br></figcaption></figure><p>安装好所有依赖模块，测试<code>python src/scFEA.py --help</code> 可成功</p><figure><figcaption><img data-imgfileid="100005000" data-ratio="0.3925925925925926" data-type="png" data-w="1080" data-src="https://mmbiz.qpic.cn/mmbiz_png/mo60jlFOtaB9vS6wnPDEH9QRQuNXhHNOmOKX8gILG9r22tZlCTs48MsGgr3gMaHEu3jZbMPp3Zl7hKxtC7ye8g/640?wx_fmt=png&amp;from=appmsg" src="https://mmbiz.qpic.cn/mmbiz_png/mo60jlFOtaB9vS6wnPDEH9QRQuNXhHNOmOKX8gILG9r22tZlCTs48MsGgr3gMaHEu3jZbMPp3Zl7hKxtC7ye8g/640?wx_fmt=png&amp;from=appmsg"></figcaption></figure><h3><span>后记</span></h3><p>scFEA的具体使用及下游分析请持续关注生信作曲家！</p><p>交流更多，添加管理员 备注 加群</p><p><img data-galleryid="" data-imgfileid="100000530" data-ratio="1" data-s="300,640" data-type="jpeg" data-w="512" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/mo60jlFOtaCCLynHNic5cW7VTpnwXFdScicPJ3QSchkDsNZBRbjMMOnTvNAkwZAGK06AmFMKVeibqTj8bjvF00nQA/640?wx_fmt=jpeg" src="https://mmbiz.qpic.cn/mmbiz_jpg/mo60jlFOtaCCLynHNic5cW7VTpnwXFdScicPJ3QSchkDsNZBRbjMMOnTvNAkwZAGK06AmFMKVeibqTj8bjvF00nQA/640?wx_fmt=jpeg"></p><figure><figcaption><img data-imgfileid="100005002" data-ratio="0.8935185185185185" data-type="png" data-w="1080" data-src="https://mmbiz.qpic.cn/mmbiz_png/mo60jlFOtaB9vS6wnPDEH9QRQuNXhHNOTfWAnTFBrB0Z4iaqIC6NZrPRUU94A0xARn2Z2LqzGjnI6WQkbW6AHOQ/640?wx_fmt=png&amp;from=appmsg" src="https://mmbiz.qpic.cn/mmbiz_png/mo60jlFOtaB9vS6wnPDEH9QRQuNXhHNOTfWAnTFBrB0Z4iaqIC6NZrPRUU94A0xARn2Z2LqzGjnI6WQkbW6AHOQ/640?wx_fmt=png&amp;from=appmsg"><br><br><br></figcaption></figure></section><p><br></p><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/r7kXSeB9bbCqPGLEUYRhsQ",target="_blank" rel="noopener noreferrer">原文链接</a>
