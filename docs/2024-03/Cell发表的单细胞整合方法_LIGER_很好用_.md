---
title: "Cell发表的单细胞整合方法：LIGER，很好用！"
date: 2024-03-19T04:52:23Z
draft: ["false"]
tags: [
  "fetched",
  "生信小博士"
]
categories: ["Acdemic"]
---
Cell发表的单细胞整合方法：LIGER，很好用！ by 生信小博士
------
<div><p><strong>之前，我们已经介绍过其他的整合方法：</strong></p><ol><li><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=Mzg2NDcxMzYwNg==&amp;mid=2247484817&amp;idx=1&amp;sn=d89ee03ca1fbc08d761327f98e653c0d&amp;chksm=ce646b78f913e26ed1c7720bbe4afb94910177cebac2aa1053bfd509f42a2a06cc114d641cd8&amp;scene=21#wechat_redirect" textvalue="harmony整合单细胞数据-去除批次效应" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2">harmony整合单细胞数据-去除批次效应</a></p></li><li><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=Mzg2NDcxMzYwNg==&amp;mid=2247486060&amp;idx=2&amp;sn=023cb9c7ac755dd5c35f380416a4900d&amp;chksm=ce646485f913ed939e1f933eb7ac1698cf7d09c32aa486eca72c642b7a6980ca5768cc7225a2&amp;scene=21#wechat_redirect" textvalue="Seurat一键完成五种数据整合：harmony，CCA，RPCA,FastMNN,scVI，代码分享" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2">Seurat一键完成五种数据整合：harmony，CCA，RPCA,FastMNN,scVI，代码分享</a></p><p><br></p></li></ol><p><br></p><p><strong>今天来看看Cell发表的LIGER</strong><br></p><p><img data-galleryid="" data-imgfileid="100002730" data-ratio="0.27663734115347016" data-s="300,640" data-type="png" data-w="1023" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345Skv3kicQJEVWrtCoEjYsHtT5NrM6w0pPhfKOvYd78cU24DMjUOLofPOFCcvc6eGsBWZsjveiaGsm9SPQ/640?wx_fmt=png&amp;from=appmsg" src="https://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345Skv3kicQJEVWrtCoEjYsHtT5NrM6w0pPhfKOvYd78cU24DMjUOLofPOFCcvc6eGsBWZsjveiaGsm9SPQ/640?wx_fmt=png&amp;from=appmsg"></p><p><span><strong>介绍</strong></span></p><p>LIGER（Linked Inference of Genomic Experimental Relationships，基因实验关系的链接推断）是一个用于整合和分析多个单细胞数据集的软件包，由Macosko实验室开发，并由Welch实验室维护和扩展。它依赖于整合的非负矩阵分解技术来识别共享的和数据集特定的因子。</p><p><strong>LIGER可以用来在多种背景下比较和对比实验数据集，例如：</strong></p><ul><li><p>实验批次间</p></li><li><p>不同个体间</p></li><li><p>不同性别间</p></li><li><p>不同组织间</p></li><li><p>不同物种间（例如，小鼠和人类）</p></li><li><p>不同模态间（例如，单细胞RNA测序和空间转录组数据，单细胞甲基化或单细胞ATAC测序）</p></li></ul><p>一旦多个数据集被整合，该软件包提供了进一步的数据探索、分析和可视化的功能。用户可以：</p><ol><li><p>识别cluster</p></li><li><p>找到显著的共享（和数据集特定的）基因标记</p></li><li><p>与之前识别的细胞类型比较簇</p></li><li><p>使用t-SNE和UMAP可视化簇和基因表达</p></li></ol><p><strong>让人兴奋的是，作者设计了LIGER r包，使其能够与现有的单细胞分析软件包（包括Seurat）接入。</strong></p><p><img data-galleryid="" data-imgfileid="100002729" data-ratio="1" data-s="300,640" data-type="jpeg" data-w="996" data-src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/xVhD7345Skv3kicQJEVWrtCoEjYsHtT5NYfd0mvibDdxgp2iaTFG3EhjH8C72QL6HcvEp4icu0akg5SXTSxEPr5aaA/640?wx_fmt=jpeg&amp;from=appmsg" src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/xVhD7345Skv3kicQJEVWrtCoEjYsHtT5NYfd0mvibDdxgp2iaTFG3EhjH8C72QL6HcvEp4icu0akg5SXTSxEPr5aaA/640?wx_fmt=jpeg&amp;from=appmsg"></p><hr><p><strong>代码实战</strong><br></p><p><span><strong>这里的数据仅作演示使用，读者使用自己的数据可以试一试</strong></span></p><p><span><strong>如果你想使用我的pbmc：</strong></span></p><ol><li><p><span><strong><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=Mzg2NDcxMzYwNg==&amp;mid=2247484571&amp;idx=1&amp;sn=825291306e9956713d953f4b38f4f340&amp;chksm=ce646a72f913e3646844c07804def0aad8147ab28ddbfe5005b3a5fd66ad5b2c34bb91b8c688&amp;scene=21#wechat_redirect" textvalue="20231126单细胞直播一理解pbmc处理流程与常用R技巧" linktype="text" imgurl="" imgdata="null" data-itemshowtype="5" tab="innerlink" data-linktype="2">20231126单细胞直播一理解pbmc处理流程与常用R技巧</a><br></strong></span></p></li><li><p><span><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=Mzg2NDcxMzYwNg==&amp;mid=2247484430&amp;idx=3&amp;sn=05ca4ea70c69645b782ccd674b8e0e92&amp;chksm=ce646ae7f913e3f154e7bce85393f12b83015925413bfda1248e40d9575f76a7894400336870&amp;scene=21#wechat_redirect" textvalue="单细胞数据pbmc数据下载，标准处理流程获取seurat对象" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2">单细胞数据pbmc数据下载，标准处理流程获取seurat对象</a><br></span></p></li></ol><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="perl"><code><span><span>#remotes::install_github('satijalab/seurat-wrappers')</span></span></code><code><span>.libPaths(</span></code><code><span>  c(</span></code><code><span>    <span>'/home/rootyll/seurat_v5/'</span>,</span></code><code><span>    <span>"/usr/local/lib/R/site-library"</span>,</span></code><code><span>    <span>"/usr/lib/R/site-library"</span>,</span></code><code><span>    <span>"/usr/lib/R/library"</span></span></code><code><span>  )</span></code><code><span>)</span></code><code><span><br></span></code><code><span><span>#install.packages('rliger')</span></span></code><code><span><br></span></code><code><span><br></span></code><code><span>library(rliger)</span></code><code><span>library(Seurat)</span></code><code><span>library(SeuratData)</span></code><code><span><br></span></code><code><span>library(Seurat)</span></code><code><span>library(SeuratWrappers)</span></code><code><span><br></span></code><code><span><span>#下面正式开始-----------------------------------------------------</span></span></code><code><span><span># options(timeout = 9000)</span></span></code><code><span><span># #InstallData("pbmcsca")</span></span></code><code><span><span># data("pbmcsca")</span></span></code><code><span>load(<span>"~/gzh/pbmc3k_final_v4.rds"</span>)</span></code><code><span><br></span></code><code><span>pbmc$Method=pbmc$group</span></code><code><span><br></span></code><code><span>pbmcsca=pbmc</span></code><code><span><span># Please update your `liger` version to 0.5.0 or above before following this tutorial</span></span></code><code><span>pbmcsca &lt;- NormalizeData(pbmcsca)</span></code><code><span>pbmcsca &lt;- FindVariableFeatures(pbmcsca)</span></code><code><span>pbmcsca &lt;- ScaleData(pbmcsca, <span>split</span>.by = <span>"Method"</span>, do.center = FALSE)</span></code><code><span><br></span></code><code><span><span>#整合的过程就至需要下面这两句代码----</span></span></code><code><span>pbmcsca &lt;- RunOptimizeALS(pbmcsca, k = <span>20</span>, lambda = <span>5</span>, <span>split</span>.by = <span>"Method"</span>)</span></code><code><span>pbmcsca &lt;- RunQuantileNorm(pbmcsca, <span>split</span>.by = <span>"Method"</span>)</span></code><code><span><br></span></code><code><span><span># You can optionally perform Louvain clustering (`FindNeighbors` and `FindClusters`) after</span></span></code><code><span><span># `RunQuantileNorm` according to your needs</span></span></code><code><span>pbmcsca &lt;- FindNeighbors(pbmcsca, reduction = <span>"iNMF"</span>, dims = <span>1</span>:<span>20</span>)</span></code><code><span>pbmcsca &lt;- FindClusters(pbmcsca, resolution = <span>0</span>.<span>3</span>)</span></code><code><span><span># Dimensional reduction and plotting</span></span></code><code><span>pbmcsca &lt;- RunUMAP(pbmcsca, dims = <span>1</span>:ncol(pbmcsca[[<span>"iNMF"</span>]]), reduction = <span>"iNMF"</span>)</span></code><code><span>DimPlot(pbmcsca, group.by = c(<span>"Method"</span>, <span>"ident"</span>, <span>"cell.type"</span>), ncol = <span>3</span>)</span></code><code><span><br></span></code><code><span>head(pbmc@meta.data)</span></code></pre></section><p><br></p><p><img data-galleryid="" data-imgfileid="100002734" data-ratio="0.45555555555555555" data-s="300,640" data-type="png" data-w="1080" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345Skv3kicQJEVWrtCoEjYsHtT5NXGABRPnRSKWPliaaFEn0ib77s0ZVYicFD7TTaic6ghb5xxNblaUibDN8Dhg/640?wx_fmt=png&amp;from=appmsg" src="https://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345Skv3kicQJEVWrtCoEjYsHtT5NXGABRPnRSKWPliaaFEn0ib77s0ZVYicFD7TTaic6ghb5xxNblaUibDN8Dhg/640?wx_fmt=png&amp;from=appmsg"></p><p><strong>LIGER还具有其他功能，后续我们再分享~<br></strong></p><ul dir="auto"><li><p dir="auto">Iterative Single-Cell Multi-Omic Integration Using Online iNMF</p></li><li><p dir="auto">Integrating unshared features with UINMF</p></li><li><p dir="auto">scATAC and scRNA Integration using unshared features (UINMF)</p></li><li><p dir="auto">Cross-species Analysis with UINMF</p></li><li><p dir="auto">Performing Parameter Selection</p></li><li><p dir="auto">Integrating spatial transcriptomic and transcriptomic datasets using UINMF (Click to Download)</p></li><li><p dir="auto">Integrating Multiple Single-Cell RNA-seq Datasets</p></li><li><p dir="auto">Jointly Defining Cell Types from scRNA-seq and scATAC-seq</p></li><li><p dir="auto">Jointly Defining Cell Types from Single-Cell RNA-seq and DNA Methylation</p></li><li><p dir="auto">Running Liger directly on Seurat objects using Seurat wrappers</p></li></ul><section><mp-common-profile data-pluginname="mpprofile" data-id="Mzg2NDcxMzYwNg==" data-headimg="http://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345Sks7JhVxUX46ZKxPSob6ptqIZgnIEnHOn5VMwCX8sN6MQy1Pq4XXFEOJ6grAmsoQugyCDKOZictDBHA/0?wx_fmt=png" data-nickname="生信小博士" data-alias="bioinformatics_Dr" data-signature="【生物信息学】R语言开始，学习生信。Seurat，单细胞测序，空间转录组。 Python，scanpy，cell2location。资料分享" data-from="0"></mp-common-profile></section><section><ul><li><li><li><li></ul><pre data-lang="javascript"><code><span>参考；</span></code><code><span>https:<span>//github.com/welch-lab/liger</span></span></code><code><span>https:<span>//github.com/satijalab/seurat-wrappers</span></span></code><code><span>https:<span>//htmlpreview.github.io/?https://github.com/satijalab/seurat.wrappers/blob/master/docs/liger.html</span></span></code></pre></section><p><img data-imgfileid="100002735" data-ratio="1" data-type="gif" data-w="240" data-src="https://mmbiz.qpic.cn/mmbiz_gif/4TKeL1ZejtlKxOib5kmKX6ic6eX0w0WK5jvhtz9yBRsO3OI4yr6S5iaLNM7AbAeuPDHXMvDdur2DRz9wyiax4lEviag/640?wx_fmt=gif&amp;wxfrom=5&amp;wx_lazy=1" src="https://mmbiz.qpic.cn/mmbiz_gif/4TKeL1ZejtlKxOib5kmKX6ic6eX0w0WK5jvhtz9yBRsO3OI4yr6S5iaLNM7AbAeuPDHXMvDdur2DRz9wyiax4lEviag/640?wx_fmt=gif&amp;wxfrom=5&amp;wx_lazy=1"><br></p><p><img data-imgfileid="100002736" data-ratio="0.05278592375366569" data-type="other" data-w="341" data-src="https://mmbiz.qpic.cn/mmbiz/4TKeL1Zejtlq03ZOSZiaTlic1MxgdKiaxTbOZ7ZSe0Xx1Ca8xF3L6Nyj1FYUajtYrSmRIHyZVSsAve0EAvEicZONpg/640?wx_fmt=jpeg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" src="https://mmbiz.qpic.cn/mmbiz/4TKeL1Zejtlq03ZOSZiaTlic1MxgdKiaxTbOZ7ZSe0Xx1Ca8xF3L6Nyj1FYUajtYrSmRIHyZVSsAve0EAvEicZONpg/640?wx_fmt=jpeg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"></p><p><strong><span>看完记得顺手点个</span></strong><span><strong><span>“在看”</span></strong></span><strong><span>哦！</span></strong></p><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/e2KZlG4H79exUjjHm5b97g",target="_blank" rel="noopener noreferrer">原文链接</a>
