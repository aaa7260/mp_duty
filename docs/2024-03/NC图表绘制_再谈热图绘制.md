---
title: "NC图表绘制-再谈热图绘制"
date: 2024-03-25T04:46:42Z
draft: ["false"]
tags: [
  "fetched",
  "R语言数据分析指南"
]
categories: ["Acdemic"]
---
NC图表绘制-再谈热图绘制 by R语言数据分析指南
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><h3 data-tool="mdnice编辑器"><span></span><span><span></span>欢迎关注R语言数据分析指南</span><span></span></h3><blockquote data-tool="mdnice编辑器"><span>❝</span><p>本节继续来绘制NC上的一张图表，多组填充离散型热图，需要先对数据进行相应的格式转换，<strong>「图形看起来也是比较简单，细节也是要调节一番」</strong>，数据为论文源数据，小编进行了图形绘制，整个过程仅参考。希望对各位观众老爷能有所帮助。<strong>「数据代码已经整合上传到会员交流群」</strong>，购买过小编VIP的朋友可在所加的会员群内获取下载，有需要的朋友可关注文末介绍加入VIP交流群。</p><span>❞</span></blockquote><figure data-tool="mdnice编辑器"><img data-imgfileid="100026880" data-ratio="0.4666666666666667" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAbkVk52EsakqNFR3VuJTbjulx4kRkK3ISgRPscU34dEK11wibJgdTSnvd5wRqZicMxicwUiaqycTFvibicw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAbkVk52EsakqNFR3VuJTbjulx4kRkK3ISgRPscU34dEK11wibJgdTSnvd5wRqZicMxicwUiaqycTFvibicw/640?wx_fmt=png&amp;from=appmsg"></figure><h3 data-tool="mdnice编辑器"><span></span><span><span></span>最终结果</span><span></span></h3><figure data-tool="mdnice编辑器"><img data-imgfileid="100026883" data-ratio="0.6361111111111111" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAbkVk52EsakqNFR3VuJTbjuv0zGtj7j7RHIlrcYOHpHngHBjBICSyGYJJHicNG4v90ueDNdAp6GSJA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAbkVk52EsakqNFR3VuJTbjuv0zGtj7j7RHIlrcYOHpHngHBjBICSyGYJJHicNG4v90ueDNdAp6GSJA/640?wx_fmt=png&amp;from=appmsg"></figure><h3 data-tool="mdnice编辑器"><span></span><span><span></span>关于永久群内容的说明</span><span></span></h3><blockquote data-tool="mdnice编辑器"><span>❝</span><p>给予长期支持我们的读者们一个特别待遇：购买小编VIP会员文档的读者，<strong>「将自动获得2024年及以后更新的绘图文档代码，无需额外付费」</strong>。目前会员文档(2023+2024)<strong>「已经更新上传了150+案例文档」</strong>，每个案例都附有相应的数据和代码，并配有对应的注释文档，方便大家学习和参考。有需要的朋友欢迎到小编的<strong>「淘宝店铺」</strong> <strong>「R语言数据分析指南」</strong>下单购买。</p><span>❞</span></blockquote><p data-tool="mdnice编辑器"><strong>「2024更新的绘图内容同时包含数据+代码+markdown注释文档+文档清单」</strong><img data-imgfileid="100026884" data-ratio="0.6175925925925926" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAbkVk52EsakqNFR3VuJTbjuCAGScA6a9JX1n3IpNF6JhT6iaHBKwdrGfPyicAk7dY85Ugj5UibXBFryA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAbkVk52EsakqNFR3VuJTbjuCAGScA6a9JX1n3IpNF6JhT6iaHBKwdrGfPyicAk7dY85Ugj5UibXBFryA/640?wx_fmt=png&amp;from=appmsg"></p><h3 data-tool="mdnice编辑器"><span></span><span><span></span>2024年更新案例</span><span></span></h3><p data-tool="mdnice编辑器"><img data-imgfileid="100026881" data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAbkVk52EsakqNFR3VuJTbjuwvyg9CfVyydLIs8RzFw6Bsfv2eADmQ2Ay3MlKvRhY2l9Ff9mMWIEEA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAbkVk52EsakqNFR3VuJTbjuwvyg9CfVyydLIs8RzFw6Bsfv2eADmQ2Ay3MlKvRhY2l9Ff9mMWIEEA/640?wx_fmt=png&amp;from=appmsg"><img data-imgfileid="100026882" data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAbkVk52EsakqNFR3VuJTbjuiclH4SdU3ZqgjyA4sMRWM88LibicAK7ctJYiawhz13vWHgS9CZmZsTxMsQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAbkVk52EsakqNFR3VuJTbjuiclH4SdU3ZqgjyA4sMRWM88LibicAK7ctJYiawhz13vWHgS9CZmZsTxMsQ/640?wx_fmt=png&amp;from=appmsg"><img data-imgfileid="100026889" data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAbkVk52EsakqNFR3VuJTbjuTPJraBoZLWIaS1yGFFj3dibiaIG7VuMEjjuaVQVvZ5sPTianamwz19rPQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAbkVk52EsakqNFR3VuJTbjuTPJraBoZLWIaS1yGFFj3dibiaIG7VuMEjjuaVQVvZ5sPTianamwz19rPQ/640?wx_fmt=png&amp;from=appmsg"><img data-imgfileid="100026886" data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAbkVk52EsakqNFR3VuJTbju4r6hA8j1gMlQ5dG6qDUZibYMETzpS8Sr4TkXtw9HNKuCL3YFmYYjrhQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAbkVk52EsakqNFR3VuJTbju4r6hA8j1gMlQ5dG6qDUZibYMETzpS8Sr4TkXtw9HNKuCL3YFmYYjrhQ/640?wx_fmt=png&amp;from=appmsg"><img data-imgfileid="100026887" data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAbkVk52EsakqNFR3VuJTbjujKn1N3rGOOtCDY2gSQxoUuxU9E9IZ4Ex28eaTvLn9BBdq3Xe16iadwg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAbkVk52EsakqNFR3VuJTbjujKn1N3rGOOtCDY2gSQxoUuxU9E9IZ4Ex28eaTvLn9BBdq3Xe16iadwg/640?wx_fmt=png&amp;from=appmsg"><img data-imgfileid="100026888" data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAbkVk52EsakqNFR3VuJTbju3Tok6MvgqczPSIsCqibxa4pVjTqicJ5CTNJPtS6WsbxzHxB9I69DwJvA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAbkVk52EsakqNFR3VuJTbju3Tok6MvgqczPSIsCqibxa4pVjTqicJ5CTNJPtS6WsbxzHxB9I69DwJvA/640?wx_fmt=png&amp;from=appmsg"><img data-imgfileid="100026885" data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAbkVk52EsakqNFR3VuJTbjuypL11wWuPZr4l1lmjwCT81icichLyyfknIOOxHJZhBliaAKQokwgl5dfg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAbkVk52EsakqNFR3VuJTbjuypL11wWuPZr4l1lmjwCT81icichLyyfknIOOxHJZhBliaAKQokwgl5dfg/640?wx_fmt=png&amp;from=appmsg"><img data-imgfileid="100026890" data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAbkVk52EsakqNFR3VuJTbjuFnkXXXcdGDoAibzCbaRzsQTsia1GKbbPbrPFia7J8CpPibfBwcHicy8u7ibQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAbkVk52EsakqNFR3VuJTbjuFnkXXXcdGDoAibzCbaRzsQTsia1GKbbPbrPFia7J8CpPibfBwcHicy8u7ibQ/640?wx_fmt=png&amp;from=appmsg"></p><h3 data-tool="mdnice编辑器"><span></span><span><span></span>2023年案例图展示</span><span></span></h3><p data-tool="mdnice编辑器"><img data-imgfileid="100026891" data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAbkVk52EsakqNFR3VuJTbjuzxxdNtZQ1p6FSpnpWmy0xgWfPtUdvzWU4Y9ZsuUBbtJRgcowjaowzA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAbkVk52EsakqNFR3VuJTbjuzxxdNtZQ1p6FSpnpWmy0xgWfPtUdvzWU4Y9ZsuUBbtJRgcowjaowzA/640?wx_fmt=png&amp;from=appmsg"><img data-imgfileid="100026892" data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAbkVk52EsakqNFR3VuJTbjuaSCfxhp4ia61AerpL7LxRGqDpzeWKgQPnosB9Kd95ucVOPCfFeia2WRA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAbkVk52EsakqNFR3VuJTbjuaSCfxhp4ia61AerpL7LxRGqDpzeWKgQPnosB9Kd95ucVOPCfFeia2WRA/640?wx_fmt=png&amp;from=appmsg"><img data-imgfileid="100026894" data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAbkVk52EsakqNFR3VuJTbjucy4E8fCiawtzThEia3MnLLshBLs2JFLvSTy4lYeMsJhWXqbHBd8icdia0g/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAbkVk52EsakqNFR3VuJTbjucy4E8fCiawtzThEia3MnLLshBLs2JFLvSTy4lYeMsJhWXqbHBd8icdia0g/640?wx_fmt=png&amp;from=appmsg"><img data-imgfileid="100026893" data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAbkVk52EsakqNFR3VuJTbjugNBdsLrOxYWNSWjBDLDo8oudmuyib6f1qyxjDUlsmsmu2KcONwTVsaA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAbkVk52EsakqNFR3VuJTbjugNBdsLrOxYWNSWjBDLDo8oudmuyib6f1qyxjDUlsmsmu2KcONwTVsaA/640?wx_fmt=png&amp;from=appmsg"><img data-imgfileid="100026898" data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAbkVk52EsakqNFR3VuJTbju8yDjRVkXaWdwpN1Y72LzcHEJnAnBTzk8qY9nIDNicrrdfSU8XzjA0tA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAbkVk52EsakqNFR3VuJTbju8yDjRVkXaWdwpN1Y72LzcHEJnAnBTzk8qY9nIDNicrrdfSU8XzjA0tA/640?wx_fmt=png&amp;from=appmsg"><img data-imgfileid="100026897" data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAbkVk52EsakqNFR3VuJTbjuB9mYnQibfYagmp41DfIln0dGDrU6qjwbUOQZV1DmZOiab2obsCs1Iiaiaw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAbkVk52EsakqNFR3VuJTbjuB9mYnQibfYagmp41DfIln0dGDrU6qjwbUOQZV1DmZOiab2obsCs1Iiaiaw/640?wx_fmt=png&amp;from=appmsg"><img data-imgfileid="100026896" data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAbkVk52EsakqNFR3VuJTbjudhWkRJSLXcR6fvq5hpiarTcuufFkF3YRicfkdcOQWWq28XzvM7166ZLQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAbkVk52EsakqNFR3VuJTbjudhWkRJSLXcR6fvq5hpiarTcuufFkF3YRicfkdcOQWWq28XzvM7166ZLQ/640?wx_fmt=png&amp;from=appmsg"><img data-imgfileid="100026899" data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAbkVk52EsakqNFR3VuJTbju8vj6UYMBVibyAm9QswBYSnLLBXiaaJN7qsuJYbCVj1FEgfdChO9icV60Q/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAbkVk52EsakqNFR3VuJTbju8vj6UYMBVibyAm9QswBYSnLLBXiaaJN7qsuJYbCVj1FEgfdChO9icV60Q/640?wx_fmt=png&amp;from=appmsg"><img data-imgfileid="100026895" data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAbkVk52EsakqNFR3VuJTbjuHauqN67SfIQibSJ2c6RR7G5KzfKohh5tnZS1yaWQhrvXnSzOaG42IJw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAbkVk52EsakqNFR3VuJTbjuHauqN67SfIQibSJ2c6RR7G5KzfKohh5tnZS1yaWQhrvXnSzOaG42IJw/640?wx_fmt=png&amp;from=appmsg"><img data-imgfileid="100026904" data-ratio="0.6175925925925926" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAbkVk52EsakqNFR3VuJTbjubzVpXMFLKUgj8ZoLrvic9jibM71LtAwTXDwbtuZRIc5OywwbfdFDvQzQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAbkVk52EsakqNFR3VuJTbjubzVpXMFLKUgj8ZoLrvic9jibM71LtAwTXDwbtuZRIc5OywwbfdFDvQzQ/640?wx_fmt=png&amp;from=appmsg"></p><h3 data-tool="mdnice编辑器"><span></span><span><span></span>淘宝店铺(长按二维码跳转)</span><span></span></h3><p><img data-galleryid="" data-imgfileid="100019415" data-ratio="1.0210420841683367" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/EibnicgwScTAbvhPDLGT8NaialEsht92PTYNJWpmVLfoYGic1uha5FyBrDCibibZCLjiazgvpT1XcdwibfVywD2el0VAgg/640?wx_fmt=jpeg" data-type="jpeg" data-w="998" src="https://mmbiz.qpic.cn/mmbiz_jpg/EibnicgwScTAbvhPDLGT8NaialEsht92PTYNJWpmVLfoYGic1uha5FyBrDCibibZCLjiazgvpT1XcdwibfVywD2el0VAgg/640?wx_fmt=jpeg"></p><pre data-tool="mdnice编辑器"><span></span><code><span>library</span>(tidyverse)<br><span>library</span>(ggnewscale)<br><span>library</span>(patchwork)<br><br>df1 &lt;- read_tsv(<span>"heatmap2.xls"</span>) %&gt;% <br>  slice_head(n=<span>1</span>) %&gt;% <br>  mutate(across(-gene, as.numeric)) %&gt;% <br>  pivot_longer(-gene) %&gt;% arrange(desc(value))<br><br>df1$name &lt;- factor(df1$name,levels = df1$name %&gt;% unique())<br><br><br>df &lt;- read_tsv(<span>"heatmap2.xls"</span>) %&gt;% <br>  slice(-<span>1</span>) %&gt;% <br>  mutate(across(everything(), as.character)) %&gt;%<br>  pivot_longer(-gene) %&gt;%<br>  separate(col=value,into=<span>"Mutations"</span>,sep = <span>"/"</span>)<br><br>df$name &lt;- factor(df$name,levels =df1$name %&gt;% unique())<br><br>df1 %&gt;% ggplot(aes(name,value))+<br>  labs(x=<span>NULL</span>,y=<span>"TPM"</span>)+<br>  geom_col()+<br>  scale_y_continuous(expand= expansion(mult = c(<span>0</span>,<span>0.2</span>)))+<br>  theme_test()+<br>  theme(panel.background = element_blank(),<br>        plot.background = element_blank(),<br>        axis.text.y=element_text(color=<span>"black"</span>),<br>        axis.text.x=element_blank(),<br>        axis.ticks = element_blank(),<br>        axis.title.y = element_text(angle = <span>0</span>,color=<span>"black"</span>,vjust=<span>0.5</span>,face=<span>"bold"</span>),<br>        plot.margin=unit(c(<span>0</span>,<span>0</span>,-<span>2</span>,<span>0</span>),unit=<span>"cm"</span>))<br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span><span></span>关注下方公众号下回更新不迷路</span><span></span></h3><section><mp-common-profile data-pluginname="mpprofile" data-id="Mzg3MzQzNTYzMw==" data-headimg="http://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZF0rpeZII9Ltl26VbVagriczTria1fib3XgjwwHEHFjPzkmGpqWDVVHBSzhENictUM2iavAKiaM5lc9USw/0?wx_fmt=png" data-nickname="R语言数据分析指南" data-alias="YanJANtwo" data-signature="R语言重症爱好者，喜欢绘制各种精美的图表，喜欢的小伙伴可以关注我，跟我一起学习" data-from="0" data-is_biz_ban="0"></mp-common-profile></section><p data-tool="mdnice编辑器"><br></p></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/Vo86f2lKWJ-IyDFgHmToKw",target="_blank" rel="noopener noreferrer">原文链接</a>
