---
title: "多个组合(logFC)的富集和弦图怎么画？"
date: 2024-03-26T00:48:45Z
draft: ["false"]
tags: [
  "fetched",
  "生信益站"
]
categories: ["Acdemic"]
---
多个组合(logFC)的富集和弦图怎么画？ by 生信益站
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><figure data-tool="mdnice编辑器"><img data-imgfileid="100024266" data-ratio="0.278125" data-src="https://mmbiz.qpic.cn/sz_mmbiz_gif/mhoJzVKWSibicmjzSoicVE3Nic8Kiavib70V751kNK0H5vjZpibbibR7h9VHVCquJFPpPibCClgdeF40uMoyFmRmroeTqCw/640?wx_fmt=gif&amp;from=appmsg" data-type="gif" data-w="640" src="https://mmbiz.qpic.cn/sz_mmbiz_gif/mhoJzVKWSibicmjzSoicVE3Nic8Kiavib70V751kNK0H5vjZpibbibR7h9VHVCquJFPpPibCClgdeF40uMoyFmRmroeTqCw/640?wx_fmt=gif&amp;from=appmsg"></figure><p data-tool="mdnice编辑器"><code>生信益站，一点就有益</code>！<strong>祝友友们天天开心，月月发 CNS~</strong></p><section><br></section><section><mp-common-profile data-pluginname="mpprofile" data-id="MzU1NTk0MTUxMg==" data-headimg="http://mmbiz.qpic.cn/sz_mmbiz_png/mhoJzVKWSibibrqoic9Jrj6UbX0brFicwAoc6PooYLWhCbItmB5DObGIoWyDoO5U41UCjOyyA6Y2hQTlggZXUIzDUQ/0?wx_fmt=png" data-nickname="生信益站" data-alias="" data-signature="生物信息或基因测序数据分析、软件算法、科研绘图、Python/Perl/R代码分享。" data-from="0" data-is_biz_ban="0"></mp-common-profile></section><hr data-tool="mdnice编辑器"><figure data-tool="mdnice编辑器"><img data-imgfileid="100024263" data-ratio="0.3768518518518518" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/mhoJzVKWSibicmjzSoicVE3Nic8Kiavib70V75ibOI1Tu3qYbJXB7OElhnZlLqJIVPBjUDLYBSHxicN3N6BLQ0ZGQEluFg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/mhoJzVKWSibicmjzSoicVE3Nic8Kiavib70V75ibOI1Tu3qYbJXB7OElhnZlLqJIVPBjUDLYBSHxicN3N6BLQ0ZGQEluFg/640?wx_fmt=png&amp;from=appmsg"><figcaption>设我为🌟星标，每天就能第一时间看到推送啦~</figcaption></figure><p data-tool="mdnice编辑器">复现一个图片（PMCID: PMC5723150，PMID: 29259393，图 3）：</p><figure data-tool="mdnice编辑器"><img data-imgfileid="100024265" data-ratio="1.2516339869281046" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/mhoJzVKWSibicmjzSoicVE3Nic8Kiavib70V75TL9qWB4Nl1CVtfmmbguV12ZP3PBxAUfWJicqXbIoy25cpvYcK2k2s8A/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="612" src="https://mmbiz.qpic.cn/sz_mmbiz_png/mhoJzVKWSibicmjzSoicVE3Nic8Kiavib70V75TL9qWB4Nl1CVtfmmbguV12ZP3PBxAUfWJicqXbIoy25cpvYcK2k2s8A/640?wx_fmt=png&amp;from=appmsg"></figure><ul data-tool="mdnice编辑器"><li><section>右侧显示重要的通路，左侧显示核心基因的倍数变化（<code>每层热图代表一个差异比较组合的logFC</code>）。左右连接表示通路前沿子集中的基因成员资格。</section></li></ul><h2 data-tool="mdnice编辑器"><span></span><span>加载 r 包和数据集</span><span></span></h2><pre data-tool="mdnice编辑器"><span></span><code><span># 加载r包和数据集</span><br><span>library</span>(RColorBrewer)<br><span>library</span>(GOplot)<br>data(EC)<br></code></pre><p data-tool="mdnice编辑器">差异基因，主要是 logFC：</p><pre data-tool="mdnice编辑器"><span></span><code>head(EC$genelist)<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100024262" data-ratio="0.24277456647398843" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/mhoJzVKWSibicmjzSoicVE3Nic8Kiavib70V75DtSDE7PBf4uKk5QlAxJFzCq5DcQFcdQcHt0JJDmy9gYp31DVoYOibPw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1038" src="https://mmbiz.qpic.cn/sz_mmbiz_png/mhoJzVKWSibicmjzSoicVE3Nic8Kiavib70V75DtSDE7PBf4uKk5QlAxJFzCq5DcQFcdQcHt0JJDmy9gYp31DVoYOibPw/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器">富集结果：</p><pre data-tool="mdnice编辑器"><span></span><code>head(EC$david)<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100024264" data-ratio="0.2564814814814815" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/mhoJzVKWSibicmjzSoicVE3Nic8Kiavib70V75iaLpsSwefFzCuXvCj71vicM5icDvfHvGrVYBEwP6ib4RcIQ1OBzFz29iagw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/mhoJzVKWSibicmjzSoicVE3Nic8Kiavib70V75iaLpsSwefFzCuXvCj71vicM5icDvfHvGrVYBEwP6ib4RcIQ1OBzFz29iagw/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器">合并差异、富集表格（主要信息是 GO term、logFC、genes）：</p><pre data-tool="mdnice编辑器"><span></span><code>circ &lt;- circle_dat(EC$david, EC$genelist)<br><br>head(circ)<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100024267" data-ratio="0.19907407407407407" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/mhoJzVKWSibicmjzSoicVE3Nic8Kiavib70V75hFyvadaq43V3SswFruaeb9Mnm1mKHnfYDQODZnvhkbRqYaND51VXiaA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/mhoJzVKWSibicmjzSoicVE3Nic8Kiavib70V75hFyvadaq43V3SswFruaeb9Mnm1mKHnfYDQODZnvhkbRqYaND51VXiaA/640?wx_fmt=png&amp;from=appmsg"></figure><h2 data-tool="mdnice编辑器"><span></span><span>富集弦图（一个差异组合）</span><span></span></h2><p data-tool="mdnice编辑器">将上述表格，转换成绘制弦图的格式：</p><pre data-tool="mdnice编辑器"><span></span><code>chord &lt;- chord_dat(data = circ,<br>                   genes = EC$genes,<br>                   process = EC$process)<br></code></pre><blockquote data-tool="mdnice编辑器"><span>❝</span><p>其实就是一个<code>0/1矩阵</code>，<code>1</code>表示基因在这个 term，<code>0表示不在</code>，<code>最后一列</code>是基因的<code>logFC</code>。</p></blockquote><figure data-tool="mdnice编辑器"><img data-imgfileid="100024268" data-ratio="0.2740740740740741" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/mhoJzVKWSibicmjzSoicVE3Nic8Kiavib70V75WqNWZ7zszPic7H9wiacrq6oRPKz8o61qhIxZVSh4DzxEApC1baYEcR4Q/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/mhoJzVKWSibicmjzSoicVE3Nic8Kiavib70V75WqNWZ7zszPic7H9wiacrq6oRPKz8o61qhIxZVSh4DzxEApC1baYEcR4Q/640?wx_fmt=png&amp;from=appmsg"></figure><pre data-tool="mdnice编辑器"><span></span><code>GOChord(chord,<br>        space = <span>0.02</span>,<br>        gene.order = <span>'logFC'</span>,<br>        gene.space = <span>0.25</span>,<br>        gene.size = <span>5</span>)<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100024270" data-ratio="1.0766331658291457" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/mhoJzVKWSibicmjzSoicVE3Nic8Kiavib70V759cRvJNLMzqjhFvpWgK1UfB90d66DUeeFV8LBU6QE9mXuSqlm7YOpicA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="796" src="https://mmbiz.qpic.cn/sz_mmbiz_png/mhoJzVKWSibicmjzSoicVE3Nic8Kiavib70V759cRvJNLMzqjhFvpWgK1UfB90d66DUeeFV8LBU6QE9mXuSqlm7YOpicA/640?wx_fmt=png&amp;from=appmsg"></figure><h2 data-tool="mdnice编辑器"><span></span><span>富集弦图（多个差异组合）</span><span></span></h2><p data-tool="mdnice编辑器">其实就是，多个 logFC，<strong>即——展示 GO term 中的基因在多个差异比较组合中的 logFC</strong>。</p><p data-tool="mdnice编辑器">效果图如下：</p><figure data-tool="mdnice编辑器"><img data-imgfileid="100024271" data-ratio="1.0944444444444446" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/mhoJzVKWSibicmjzSoicVE3Nic8Kiavib70V75Pg5ACSxbUnpb24fJOicNcSiaYvchFvS32Z3LPd4f2dvMmPYZDcZXZia7Q/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/mhoJzVKWSibicmjzSoicVE3Nic8Kiavib70V75Pg5ACSxbUnpb24fJOicNcSiaYvchFvS32Z3LPd4f2dvMmPYZDcZXZia7Q/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器">接下来，开始模拟数据（注意理解）：</p><p><mp-pay-preview-filter data-offset="32"></mp-pay-preview-filter></p></section></section></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/1swISsv6mVBvifgZ548zCQ",target="_blank" rel="noopener noreferrer">原文链接</a>
