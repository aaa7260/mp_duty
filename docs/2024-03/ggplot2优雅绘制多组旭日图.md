---
title: "ggplot2优雅绘制多组旭日图"
date: 2024-03-12T13:20:01Z
draft: ["false"]
tags: [
  "fetched",
  "R语言数据分析指南"
]
categories: ["Acdemic"]
---
ggplot2优雅绘制多组旭日图 by R语言数据分析指南
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><h3 data-tool="mdnice编辑器"><span></span><span><span></span>欢迎关注R语言数据分析指南</span><span></span></h3><blockquote data-tool="mdnice编辑器"><span>❝</span><p>最近在会员交流群看到大家分享一张图，旭日图+甜甜圈图；此图若要使用ggplot2来绘制则比较繁琐，本节小编来稍微复现一下，数据为随意构建无实际意义仅供参考，希望对各位观众老爷能有所帮助。<strong>「数据代码已经整合上传到会员交流群」</strong>，购买过小编VIP的朋友可在所加的会员群内获取下载，有需要的朋友可关注文中介绍加入VIP交流群。</p><span>❞</span></blockquote><h3 data-tool="mdnice编辑器"><span></span><span><span></span>案例图</span><span></span></h3><figure data-tool="mdnice编辑器"><img data-imgfileid="100026460" data-ratio="0.9675925925925926" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZTkwEbB5ZEFBeEWzvXetQjTPlJqmDHwEsVKIrlvMqaecah5FBTUJspvzK37ZfrNczSJ3F3FQXBXg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZTkwEbB5ZEFBeEWzvXetQjTPlJqmDHwEsVKIrlvMqaecah5FBTUJspvzK37ZfrNczSJ3F3FQXBXg/640?wx_fmt=png&amp;from=appmsg"></figure><h3 data-tool="mdnice编辑器"><span></span><span><span></span>仿图</span><span></span></h3><figure data-tool="mdnice编辑器"><img data-imgfileid="100026459" data-ratio="0.7277777777777777" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZTkwEbB5ZEFBeEWzvXetQjzic58KnibZNeDzwwrS38mo4Gx7n9EYdiaY0DGI4fBOkGNSK3woSOWFMDw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZTkwEbB5ZEFBeEWzvXetQjzic58KnibZNeDzwwrS38mo4Gx7n9EYdiaY0DGI4fBOkGNSK3woSOWFMDw/640?wx_fmt=png&amp;from=appmsg"></figure><h4 data-tool="mdnice编辑器"><span></span><span><span></span>绘图思路</span><span></span></h4><blockquote data-tool="mdnice编辑器"><span>❝</span><p>此图用R绘制难点有两处<br>(1)在于绘制连接处并进行渐变色填充<br>(2)绘制独立的甜甜圈图进行拼图<br>目前ggplot2 3.5已经能指定为图形进行渐变色填充，那么连接处我们可以当做是旭日图的第三圈并独立对其进行渐变颜色填充，至于拼图个人建议还是AI编辑器实现更为简便。</p><span>❞</span></blockquote><h3 data-tool="mdnice编辑器"><span></span><span><span></span>关于永久群内容的说明</span><span></span></h3><blockquote data-tool="mdnice编辑器"><span>❝</span><p>给予长期支持我们的读者们一个特别待遇：购买小编VIP会员文档的读者，<strong>「将自动获得2024年及以后更新的绘图文档代码，无需额外付费」</strong>。目前会员文档(2023+2024)<strong>「已经更新上传了140+案例文档」</strong>，每个案例都附有相应的数据和代码，并配有对应的注释文档，方便大家学习和参考。</p><span>❞</span></blockquote><p data-tool="mdnice编辑器">有需要学习数据可视化的朋友，欢迎到小编的<strong>「淘宝店铺」</strong> <strong>「R语言数据分析指南」</strong>下单购买，内容主要包括各种<strong>「高分论文的图表分析复现以及一些个性化图表的绘制」</strong>均包含数据+代码。购买会员文档后微信发小编订单号即邀请进新的会员交流群。</p><p data-tool="mdnice编辑器"><strong>「2024更新的绘图内容同时包含数据+代码+markdown注释文档+文档清单」</strong></p><pre data-tool="mdnice编辑器"><span></span><code><span>library</span>(tidyverse)<br><span>library</span>(geomtextpath)<br><span>library</span>(ggnewscale)<br></code></pre><pre data-tool="mdnice编辑器"><span></span><code>load(<span>"da.Rdata"</span>) <span># 加载数据</span><br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span><span></span>绘制旭日图</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code>p1 &lt;- ggplot()+<br>  geom_rect(data=data.frame(xmin=0, xmax=1, ymin=0, ymax=.75), <br>            mapping=aes(xmin=xmin, xmax=xmax, ymin=ymin, ymax=ymax), fill=<span>"white"</span>)+<br>  geom_rect(data=houses, mapping=aes(xmin=start_lim, xmax=end_lim, ymin=1, ymax=1.75, <br>                        fill=fill_col), color=<span>"white"</span>)+<br>  scale_fill_npg(alpha=0.8)+<br>  new_scale_fill()+<br>  geom_rect(data=parts, mapping=aes(xmin=start_lim, xmax=end_lim, ymin=1.751, ymax=2.501, <br>                        fill=fill_col), color=<span>"white"</span>)+<br>  scale_fill_npg()+<br>  geom_textpath(data=houses, mapping=aes(x=mid_pt, y=1.35,label=toupper(speaker_type)), color=<span>"black"</span>,<br>                size = 2, text_only = TRUE)+<br>  geom_textpath(data=parts %&gt;% filter(speaker_type!=<span>"Neutral"</span> &amp; perc&gt;=0.02),<br>                mapping=aes(x=mid_pt, y=2.35,label=paste0(str_replace(speaker,<span>" "</span>,<span>"\n"</span>),<span>"\n"</span>,round(perc*100,1),<span>"%"</span>)),<br>                color=<span>"white"</span>,size =2, text_only = TRUE) +<br>  geom_textpath(data=parts %&gt;% filter(speaker_type==<span>"Neutral"</span> &amp; perc&gt;0.025),<br>                mapping=aes(x=mid_pt, y=2.35, label=paste0(str_replace(speaker,<span>" "</span>,<span>"\n"</span>),<span>"\n"</span>,round(perc*100,1),<span>"%"</span>)),<br>                color=<span>"black"</span>,size =2, text_only = TRUE) +<br>  coord_polar()+<br>  theme(legend.position = <span>"none"</span>,<br>        axis.title = element_blank(),<br>        axis.ticks = element_blank(),<br>        axis.text = element_blank(),<br>        panel.grid = element_blank(),<br>        panel.background =element_blank(),<br>        plot.background=element_blank())<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100026461" data-ratio="0.8148148148148148" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZTkwEbB5ZEFBeEWzvXetQjciaeabN0QMF3rJ9GLaibT5oxRibmXB9D1z5LWeGEgRtfTGxWpSB295QKQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZTkwEbB5ZEFBeEWzvXetQjciaeabN0QMF3rJ9GLaibT5oxRibmXB9D1z5LWeGEgRtfTGxWpSB295QKQ/640?wx_fmt=png&amp;from=appmsg"></figure><h3 data-tool="mdnice编辑器"><span></span><span><span></span>绘制甜甜圈图</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code>df_agrupado &lt;- read_csv(<span>"vinos.csv"</span>) %&gt;% <br>  mutate(grupo:=c(<span>'Tinto'</span>, <span>'Blanco'</span>, <span>'Espumoso'</span>,<span>'Rosado'</span>,<span>'Otros'</span>, <span>'Espumoso'</span>,<br>                  rep(<span>'Otros'</span>,<span>4</span>))) %&gt;%<br>  group_by(grupo) %&gt;% <br>  summarise(hl:=sum(hl)) %&gt;%<br>  mutate(pct_hl:=round(hl/sum(hl)*<span>100</span>,<span>1</span>)) %&gt;%<br>  arrange(desc(pct_hl))<br><br>colors &lt;- c(<span>"#3B9AB2"</span>,<span>"#7294D4"</span>,<span>"#C6CDF7"</span>,<span>"#E6A0C4"</span>,<span>"#A2A475"</span>)<br><br>p2 &lt;- ggplot(df_agrupado,aes(x=<span>1</span>, y=pct_hl, fill=reorder(grupo, pct_hl))) +<br>  geom_col(position=position_stack()) +<br>  scale_fill_manual(values=colors) +<br>  scale_color_manual(values=colors)+<br>  coord_polar(theta=<span>"y"</span>) +<br>  xlim(c(-<span>1</span>,<span>2</span>))+<br>  theme(axis.text=element_blank(),<br>        axis.title = element_blank(),<br>        axis.ticks = element_blank(),<br>        plot.margin = unit(c(<span>0</span>,-<span>2</span>,<span>0</span>,<span>0</span>),<span>'cm'</span>),<br>        panel.background = element_blank(),<br>        plot.background = element_blank(),<br>        panel.grid = element_blank(),<br>        panel.border = element_blank(),<br>        legend.position =c(<span>1.1</span>,<span>0.5</span>),<br>        legend.key.height = unit(<span>0.3</span>,<span>"cm"</span>),<br>        legend.key.width = unit(<span>0.3</span>,<span>"cm"</span>),<br>        legend.background = element_blank(),<br>        legend.text = element_text(color=<span>"black"</span>,size=<span>6</span>),<br>        legend.title = element_blank())<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100026457" data-ratio="0.9669811320754716" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZTkwEbB5ZEFBeEWzvXetQjGczvBdPrOtNiabdu7FZRLNKMv2xaT3Tz4ZxtNDiaAmFIGAa6yibibVJyzg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="848" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZTkwEbB5ZEFBeEWzvXetQjGczvBdPrOtNiabdu7FZRLNKMv2xaT3Tz4ZxtNDiaAmFIGAa6yibibVJyzg/640?wx_fmt=png&amp;from=appmsg"></figure><blockquote data-tool="mdnice编辑器"><span>❝</span><p>本节介绍到此结束，有需要学习数据可视化的朋友欢迎加入小编的VIP会员群。<strong>「欢迎店铺咨询」</strong></p><span>❞</span></blockquote><p data-tool="mdnice编辑器"><strong>「2024更新的绘图内容同时包含数据+代码+markdown注释文档+文档清单」</strong><img data-imgfileid="100026458" data-ratio="0.6175925925925926" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZTkwEbB5ZEFBeEWzvXetQjEX0zQx5UuMeDb59E9Oa8BLRAfy9YvcHEToreB3bdt3wTVMT9oHQftg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZTkwEbB5ZEFBeEWzvXetQjEX0zQx5UuMeDb59E9Oa8BLRAfy9YvcHEToreB3bdt3wTVMT9oHQftg/640?wx_fmt=png&amp;from=appmsg"></p><h3 data-tool="mdnice编辑器"><span></span><span><span></span>淘宝店铺(长按二维码跳转)</span><span></span></h3><p><img data-galleryid="" data-imgfileid="100019415" data-ratio="1.0210420841683367" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/EibnicgwScTAbvhPDLGT8NaialEsht92PTYNJWpmVLfoYGic1uha5FyBrDCibibZCLjiazgvpT1XcdwibfVywD2el0VAgg/640?wx_fmt=jpeg" data-type="jpeg" data-w="998" src="https://mmbiz.qpic.cn/mmbiz_jpg/EibnicgwScTAbvhPDLGT8NaialEsht92PTYNJWpmVLfoYGic1uha5FyBrDCibibZCLjiazgvpT1XcdwibfVywD2el0VAgg/640?wx_fmt=jpeg"></p><h3 data-tool="mdnice编辑器"><span></span><span><span></span>关注下方公众号下回更新不迷路</span><span></span></h3><section><mp-common-profile data-pluginname="mpprofile" data-id="Mzg3MzQzNTYzMw==" data-headimg="http://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZF0rpeZII9Ltl26VbVagriczTria1fib3XgjwwHEHFjPzkmGpqWDVVHBSzhENictUM2iavAKiaM5lc9USw/0?wx_fmt=png" data-nickname="R语言数据分析指南" data-alias="YanJANtwo" data-signature="R语言重症爱好者，喜欢绘制各种精美的图表，喜欢的小伙伴可以关注我，跟我一起学习" data-from="0" data-is_biz_ban="0"></mp-common-profile></section></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/6PeeqnrQku7Ug4l3Yu3vyA",target="_blank" rel="noopener noreferrer">原文链接</a>
