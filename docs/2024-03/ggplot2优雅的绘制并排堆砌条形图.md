---
title: "ggplot2优雅的绘制并排堆砌条形图"
date: 2024-03-31T14:20:32Z
draft: ["false"]
tags: [
  "fetched",
  "R语言数据分析指南"
]
categories: ["Acdemic"]
---
ggplot2优雅的绘制并排堆砌条形图 by R语言数据分析指南
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><h3 data-tool="mdnice编辑器"><span></span><span><span></span>欢迎关注R语言数据分析指南</span><span></span></h3><blockquote data-tool="mdnice编辑器"><span>❝</span><p>最近会员交流群内有朋友问<strong>「如何绘制并排堆砌条形图」</strong>，此图只是堆砌条形图做了变形，本节就来通过一个案例详细介绍一下。整个过程仅参考。希望对各位观众老爷能有所帮助。<strong>「数据代码及注释群内分享」</strong>，购买过小编VIP的朋友可在所加的会员群内获取下载，有需要的朋友可关注文末介绍加入VIP交流群。</p><span>❞</span></blockquote><figure data-tool="mdnice编辑器"><img data-imgfileid="100027036" data-ratio="0.687037037037037" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAY9SwBrb8UF8jDfa4oPHP3WcywL1Vib3KeCiawEFmV8YrkTIs0DicARZUkUkXtGkXYDF88QEEOZGzLYw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAY9SwBrb8UF8jDfa4oPHP3WcywL1Vib3KeCiawEFmV8YrkTIs0DicARZUkUkXtGkXYDF88QEEOZGzLYw/640?wx_fmt=png&amp;from=appmsg"></figure><blockquote data-tool="mdnice编辑器"><span>❝</span><p>给予长期支持我们的读者们一个特别待遇：购买小编VIP会员文档的读者，<strong>「将自动获得2024年及以后更新的绘图文档代码，无需额外付费」</strong>。目前会员文档(2023+2024)<strong>「已经更新上传了150+案例文档」</strong>，每个案例都附有相应的数据和代码，并配有对应的注释文档，方便大家学习和参考。有需要的朋友欢迎到小编的<strong>「淘宝店铺」</strong> <strong>「R语言数据分析指南」</strong>下单购买。</p><span>❞</span></blockquote><p data-tool="mdnice编辑器"><strong>「2024更新的绘图内容同时包含数据+代码+markdown注释文档+文档清单」</strong><img data-imgfileid="100027038" data-ratio="0.6175925925925926" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAY9SwBrb8UF8jDfa4oPHP3WCTkg4CNapQibmTuzFcHobFT1bGT3VIHwmr2uDupQU4oBLLM1yx1URNQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAY9SwBrb8UF8jDfa4oPHP3WCTkg4CNapQibmTuzFcHobFT1bGT3VIHwmr2uDupQU4oBLLM1yx1URNQ/640?wx_fmt=png&amp;from=appmsg"></p><h3 data-tool="mdnice编辑器"><span></span><span><span></span>2024年更新案例</span><span></span></h3><p data-tool="mdnice编辑器"><img data-imgfileid="100027035" data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAY9SwBrb8UF8jDfa4oPHP3W9lI3YaMDzJlbmMgZ7JPdLF3wtryEFnurNKjlkmIerI12ISm6lJ6FUA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAY9SwBrb8UF8jDfa4oPHP3W9lI3YaMDzJlbmMgZ7JPdLF3wtryEFnurNKjlkmIerI12ISm6lJ6FUA/640?wx_fmt=png&amp;from=appmsg"><img data-imgfileid="100027037" data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAY9SwBrb8UF8jDfa4oPHP3WAQckgTGpTADibc4oJkbnHEd44TY8tUpMT6Gj8SDgoIkLGMSRcCK7tWg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAY9SwBrb8UF8jDfa4oPHP3WAQckgTGpTADibc4oJkbnHEd44TY8tUpMT6Gj8SDgoIkLGMSRcCK7tWg/640?wx_fmt=png&amp;from=appmsg"><img data-imgfileid="100027034" data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAY9SwBrb8UF8jDfa4oPHP3WbqA4rSsSWCxxicztlbSnqs1UMVyJpla4BfLwY8YiaF5XXYMjOALmSqww/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAY9SwBrb8UF8jDfa4oPHP3WbqA4rSsSWCxxicztlbSnqs1UMVyJpla4BfLwY8YiaF5XXYMjOALmSqww/640?wx_fmt=png&amp;from=appmsg"><img data-imgfileid="100027042" data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAY9SwBrb8UF8jDfa4oPHP3WC7tD6zx77lgYiaFp9aHlpgE8msOeVykfxDQehoxs4RWicJVNiadAx6Hew/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAY9SwBrb8UF8jDfa4oPHP3WC7tD6zx77lgYiaFp9aHlpgE8msOeVykfxDQehoxs4RWicJVNiadAx6Hew/640?wx_fmt=png&amp;from=appmsg"><img data-imgfileid="100027041" data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAY9SwBrb8UF8jDfa4oPHP3WibiaibhOneGyUPXOMkCvJHvBX05WcxDH1g6wlkwUOvzE0eNRjqlt2cZiaw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAY9SwBrb8UF8jDfa4oPHP3WibiaibhOneGyUPXOMkCvJHvBX05WcxDH1g6wlkwUOvzE0eNRjqlt2cZiaw/640?wx_fmt=png&amp;from=appmsg"><img data-imgfileid="100027040" data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAY9SwBrb8UF8jDfa4oPHP3WlKAtwWZZ7uzIB6XaUxJRAKsr7r6x05bQRANUXYvloa65a9PNKap9rw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAY9SwBrb8UF8jDfa4oPHP3WlKAtwWZZ7uzIB6XaUxJRAKsr7r6x05bQRANUXYvloa65a9PNKap9rw/640?wx_fmt=png&amp;from=appmsg"><img data-imgfileid="100027043" data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAY9SwBrb8UF8jDfa4oPHP3WJg6SfhfhERdZQCbicYs9yALmK3Xic3Q2f5I1NoB2jeq04EpKldbebYaQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAY9SwBrb8UF8jDfa4oPHP3WJg6SfhfhERdZQCbicYs9yALmK3Xic3Q2f5I1NoB2jeq04EpKldbebYaQ/640?wx_fmt=png&amp;from=appmsg"><img data-imgfileid="100027039" data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAY9SwBrb8UF8jDfa4oPHP3WIwyiaFoNvZ1FMrMnDorYZOLmVXL6TibxiaGSrf4tx6YWsNMNZhECWGgaQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAY9SwBrb8UF8jDfa4oPHP3WIwyiaFoNvZ1FMrMnDorYZOLmVXL6TibxiaGSrf4tx6YWsNMNZhECWGgaQ/640?wx_fmt=png&amp;from=appmsg"></p><h3 data-tool="mdnice编辑器"><span></span><span><span></span>2023年案例图展示</span><span></span></h3><p data-tool="mdnice编辑器"><img data-imgfileid="100027045" data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAY9SwBrb8UF8jDfa4oPHP3WD49mQldXelrZPlF6pkpccNLhShXuW3IZrKoIVFvjyny85MTSBDGazA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAY9SwBrb8UF8jDfa4oPHP3WD49mQldXelrZPlF6pkpccNLhShXuW3IZrKoIVFvjyny85MTSBDGazA/640?wx_fmt=png&amp;from=appmsg"><img data-imgfileid="100027046" data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAY9SwBrb8UF8jDfa4oPHP3Wo206cm4utyw74JK9ribZGSEibH8pX9VjfkAeRY6fibqiaNXydhqZhfO7Lw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAY9SwBrb8UF8jDfa4oPHP3Wo206cm4utyw74JK9ribZGSEibH8pX9VjfkAeRY6fibqiaNXydhqZhfO7Lw/640?wx_fmt=png&amp;from=appmsg"><img data-imgfileid="100027044" data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAY9SwBrb8UF8jDfa4oPHP3W2q97dr3Jh3Qlu8d5mqw5pPuCOsYvpCFEeImYCfp7bDUIAWP3j0loCQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAY9SwBrb8UF8jDfa4oPHP3W2q97dr3Jh3Qlu8d5mqw5pPuCOsYvpCFEeImYCfp7bDUIAWP3j0loCQ/640?wx_fmt=png&amp;from=appmsg"><img data-imgfileid="100027048" data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAY9SwBrb8UF8jDfa4oPHP3W6NiazkVYtUHicThL0pLFvQLwsSf9s81W0w2bORuwDVSAPlibKIX74UxCA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAY9SwBrb8UF8jDfa4oPHP3W6NiazkVYtUHicThL0pLFvQLwsSf9s81W0w2bORuwDVSAPlibKIX74UxCA/640?wx_fmt=png&amp;from=appmsg"><img data-imgfileid="100027047" data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAY9SwBrb8UF8jDfa4oPHP3W6n0ELTQAUlb3QPkpP6e7ELIh0YII2vEIcL1AnbUywicLZWT4r7AZ2ibg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAY9SwBrb8UF8jDfa4oPHP3W6n0ELTQAUlb3QPkpP6e7ELIh0YII2vEIcL1AnbUywicLZWT4r7AZ2ibg/640?wx_fmt=png&amp;from=appmsg"><img data-imgfileid="100027049" data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAY9SwBrb8UF8jDfa4oPHP3WR4y5icKo9dDD9e5Sg9fhJ67wmBEmBDVOXbQohWEHpqkq1hZgW9OZibVA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAY9SwBrb8UF8jDfa4oPHP3WR4y5icKo9dDD9e5Sg9fhJ67wmBEmBDVOXbQohWEHpqkq1hZgW9OZibVA/640?wx_fmt=png&amp;from=appmsg"><img data-imgfileid="100027052" data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAY9SwBrb8UF8jDfa4oPHP3WdV1Zpia1cHepcACfHWQRVUnBmKibJ25ATqNicTwV42y8AgILmt8tuc4fw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAY9SwBrb8UF8jDfa4oPHP3WdV1Zpia1cHepcACfHWQRVUnBmKibJ25ATqNicTwV42y8AgILmt8tuc4fw/640?wx_fmt=png&amp;from=appmsg"><img data-imgfileid="100027050" data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAY9SwBrb8UF8jDfa4oPHP3WU7oFaWkXm2xMQahK6xCfvHT3vtjzKNcxtDjXPwn5ULdLxDHXpRNOQg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAY9SwBrb8UF8jDfa4oPHP3WU7oFaWkXm2xMQahK6xCfvHT3vtjzKNcxtDjXPwn5ULdLxDHXpRNOQg/640?wx_fmt=png&amp;from=appmsg"><img data-imgfileid="100027051" data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAY9SwBrb8UF8jDfa4oPHP3WhEJE1YXpIPOzhmL01DLWXDgSicPUSphh92CpZMj89TRPJMQbQb0mZ9Q/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAY9SwBrb8UF8jDfa4oPHP3WhEJE1YXpIPOzhmL01DLWXDgSicPUSphh92CpZMj89TRPJMQbQb0mZ9Q/640?wx_fmt=png&amp;from=appmsg"><img data-imgfileid="100027053" data-ratio="0.6175925925925926" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAY9SwBrb8UF8jDfa4oPHP3Ww7qEcHgaBDiaPT2N1bbGZNN9nmc6xHaWaR8w4M9zneVPtM8KMntnu6A/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAY9SwBrb8UF8jDfa4oPHP3Ww7qEcHgaBDiaPT2N1bbGZNN9nmc6xHaWaR8w4M9zneVPtM8KMntnu6A/640?wx_fmt=png&amp;from=appmsg"></p><h3 data-tool="mdnice编辑器"><span></span><span><span></span>淘宝店铺(长按二维码跳转)</span><span></span></h3><p><img data-galleryid="" data-imgfileid="100019415" data-ratio="1.0210420841683367" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/EibnicgwScTAbvhPDLGT8NaialEsht92PTYNJWpmVLfoYGic1uha5FyBrDCibibZCLjiazgvpT1XcdwibfVywD2el0VAgg/640?wx_fmt=jpeg" data-type="jpeg" data-w="998" src="https://mmbiz.qpic.cn/mmbiz_jpg/EibnicgwScTAbvhPDLGT8NaialEsht92PTYNJWpmVLfoYGic1uha5FyBrDCibibZCLjiazgvpT1XcdwibfVywD2el0VAgg/640?wx_fmt=jpeg"></p><pre data-tool="mdnice编辑器"><span></span><code><span>library</span>(tidyverse)<br><span>library</span>(ggtext)<br><span>library</span>(magrittr)<br><span>library</span>(ggprism)<br><span>library</span>(MetBrewer)<br><span>library</span>(cowplot)<br><br>df &lt;- read_csv(<span>"IHME-GBD_2019_DATA-34013a2e-1.csv"</span>) %&gt;% select(-upper,-lower,-<span>1</span>,-<span>2</span>,-cause) %&gt;% <br>  filter(sex !=<span>"Both"</span>,metric==<span>"Number"</span>,age !=<span>"All age"</span>) %&gt;% <br>  mutate(val=val/<span>1000000</span>)<br><br>p1 &lt;- df %&gt;% ggplot(aes(sex,val,fill=rei))+<br>  geom_bar(stat=<span>"identity"</span>,position=position_stack(reverse = <span>F</span>))+<br>  scale_y_continuous(expand = c(<span>0</span>,<span>0</span>))+<br>  scale_fill_manual(values=met.brewer(<span>"Monet"</span>,<span>9</span>))+<br>  labs(x=<span>NULL</span>,y=<span>NULL</span>)+<br>  theme(axis.text.x=element_blank(),<br>        axis.ticks = element_blank(),<br>        strip.background = element_blank(),<br>        strip.text.x = element_text(angle =<span>90</span>),<br>        panel.spacing.x = unit(<span>0</span>,<span>"cm"</span>),<br>        plot.margin=unit(c(<span>0.3</span>,<span>0.3</span>,<span>0.3</span>,<span>0.3</span>),units=,<span>"cm"</span>), <br>        axis.ticks.length.x = unit(-<span>.2</span>, <span>"cm"</span>),<br>        legend.key = element_blank(),<br>        legend.background = element_blank(),<br>        legend.title = element_blank(),<br>        legend.text=element_text(size=<span>8</span>,color=<span>"black"</span>),<br>        legend.spacing.x=unit(<span>0.1</span>,<span>'cm'</span>),<br>        legend.key.width=unit(<span>0.4</span>,<span>"cm"</span>),<br>        legend.key.height=unit(<span>0.4</span>,<span>"cm"</span>),<br>        legend.position = c(<span>0.75</span>,<span>1.02</span>), <span># 定义图例位置</span><br>        legend.justification = c(<span>0</span>,<span>1</span>),<br>        panel.background = element_blank(),<br>        plot.background = element_blank(),<br>        axis.line.y.left = element_line(color=<span>"black"</span>)) <br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span><span></span>关注下方公众号下回更新不迷路</span><span></span></h3><section><mp-common-profile data-pluginname="mpprofile" data-id="Mzg3MzQzNTYzMw==" data-headimg="http://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZF0rpeZII9Ltl26VbVagriczTria1fib3XgjwwHEHFjPzkmGpqWDVVHBSzhENictUM2iavAKiaM5lc9USw/0?wx_fmt=png" data-nickname="R语言数据分析指南" data-alias="YanJANtwo" data-signature="R语言重症爱好者，喜欢绘制各种精美的图表，喜欢的小伙伴可以关注我，跟我一起学习" data-from="0" data-is_biz_ban="0"></mp-common-profile></section><p data-tool="mdnice编辑器"><br></p></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/dvKQwEgdg5yKKq11iUl0Sw",target="_blank" rel="noopener noreferrer">原文链接</a>
