---
title: "mlr3超参数调优的多种方法"
date: 2024-03-20T01:34:55Z
draft: ["false"]
tags: [
  "fetched",
  "医学和生信笔记"
]
categories: ["Acdemic"]
---
mlr3超参数调优的多种方法 by 医学和生信笔记
------
<div><p><img data-galleryid="" data-imgfileid="100017876" data-ratio="0.16666666666666666" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/tpAC6lR84R9fO0vCqNNWMpw3VRMCZnvHTZzG2JUNYHDwaRCDvCcJZEJFRH3KVxBylYk1YcpWMJe8rBmrmeYwjg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/tpAC6lR84R9fO0vCqNNWMpw3VRMCZnvHTZzG2JUNYHDwaRCDvCcJZEJFRH3KVxBylYk1YcpWMJe8rBmrmeYwjg/640?wx_fmt=png&amp;from=appmsg"></p><hr><table><tbody><tr><td width="172" valign="top"><p><a target="_blank" href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzUzOTQzNzU0NA==&amp;action=getalbum&amp;album_id=2231476971388059661&amp;uin=&amp;key=&amp;devicetype=Windows+11+x64&amp;version=63090819&amp;lang=zh_CN&amp;ascene=0&amp;session_us=gh_28ea67f3b544" textvalue="你已选中了添加链接的内容" linktype="text" imgurl="" imgdata="null" tab="innerlink" data-linktype="1"><span><img data-cropselx1="0" data-cropselx2="151" data-cropsely1="0" data-cropsely2="127" data-galleryid="" data-imgfileid="100017880" data-ratio="0.8435185185185186" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/tpAC6lR84RicFQdAjJlXFgFpqvDjKEysZJVPcbVTf4Xmmz0ibmMDSDicNE8fAMebg1h5uSZJJ7nhmRNiaibJnoG6lOg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/tpAC6lR84RicFQdAjJlXFgFpqvDjKEysZJVPcbVTf4Xmmz0ibmMDSDicNE8fAMebg1h5uSZJJ7nhmRNiaibJnoG6lOg/640?wx_fmt=png&amp;from=appmsg"></span></a></p></td><td width="172" valign="top"><p><a target="_blank" href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzUzOTQzNzU0NA==&amp;action=getalbum&amp;album_id=2267367379124928515&amp;uin=&amp;key=&amp;devicetype=Windows+11+x64&amp;version=63090819&amp;lang=zh_CN&amp;ascene=0&amp;session_us=gh_28ea67f3b544" textvalue="你已选中了添加链接的内容" linktype="text" imgurl="" imgdata="null" tab="innerlink" data-linktype="1"><span><img data-cropselx1="0" data-cropselx2="151" data-cropsely1="0" data-cropsely2="127" data-galleryid="" data-imgfileid="100017878" data-ratio="0.8435185185185186" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/tpAC6lR84RicFQdAjJlXFgFpqvDjKEysZ3noGibiag7bKyuAvs4POaZWW4JTQMeUibXHqF9Jv0MEoNJLpgvY2jxaTQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/tpAC6lR84RicFQdAjJlXFgFpqvDjKEysZ3noGibiag7bKyuAvs4POaZWW4JTQMeUibXHqF9Jv0MEoNJLpgvY2jxaTQ/640?wx_fmt=png&amp;from=appmsg"></span></a></p></td><td width="172" valign="top"><p><a target="_blank" href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzUzOTQzNzU0NA==&amp;action=getalbum&amp;album_id=2255945345983627264&amp;scene=173&amp;subscene=&amp;sessionid=svr_781993951eb&amp;enterid=1709989110&amp;from_msgid=2247500872&amp;from_itemidx=1&amp;count=3&amp;nolastread=1#wechat_redirect" textvalue="你已选中了添加链接的内容" linktype="text" imgurl="" imgdata="null" tab="innerlink" data-linktype="1"><span><img data-cropselx1="0" data-cropselx2="151" data-cropsely1="0" data-cropsely2="127" data-galleryid="" data-imgfileid="100017879" data-ratio="0.8435185185185186" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/tpAC6lR84RicFQdAjJlXFgFpqvDjKEysZtVWVkXRwiaATrnk7BzxzOOOibjbZSM1AVxkMNXHRHWFybibmVTYpUb4bA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/tpAC6lR84RicFQdAjJlXFgFpqvDjKEysZtVWVkXRwiaATrnk7BzxzOOOibjbZSM1AVxkMNXHRHWFybibmVTYpUb4bA/640?wx_fmt=png&amp;from=appmsg"></span></a></p></td></tr><tr><td width="172" valign="top"><p><a target="_blank" href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzUzOTQzNzU0NA==&amp;action=getalbum&amp;album_id=2393825487539191816&amp;scene=173&amp;subscene=&amp;sessionid=svr_20c53631f79&amp;enterid=1709989057&amp;from_msgid=2247501166&amp;from_itemidx=1&amp;count=3&amp;nolastread=1#wechat_redirect" textvalue="你已选中了添加链接的内容" linktype="text" imgurl="" imgdata="null" tab="innerlink" data-linktype="1"><span><img data-cropselx1="0" data-cropselx2="151" data-cropsely1="0" data-cropsely2="127" data-galleryid="" data-imgfileid="100017877" data-ratio="0.8435185185185186" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/tpAC6lR84RicFQdAjJlXFgFpqvDjKEysZqB1xXibTCqxzWDnSCZrJSicPH8II0G8JxLBmqTEoRWcpiaEEaEoXKibKaQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/tpAC6lR84RicFQdAjJlXFgFpqvDjKEysZqB1xXibTCqxzWDnSCZrJSicPH8II0G8JxLBmqTEoRWcpiaEEaEoXKibKaQ/640?wx_fmt=png&amp;from=appmsg"></span></a></p></td><td width="172" valign="top"><p><a target="_blank" href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzUzOTQzNzU0NA==&amp;action=getalbum&amp;album_id=3302133732023369734&amp;scene=173&amp;subscene=&amp;sessionid=svr_aba6bcd7c9d&amp;enterid=1709989036&amp;from_msgid=2247501168&amp;from_itemidx=1&amp;count=3&amp;nolastread=1#wechat_redirect" textvalue="你已选中了添加链接的内容" linktype="text" imgurl="" imgdata="null" tab="innerlink" data-linktype="1"><span><img data-cropselx1="0" data-cropselx2="151" data-cropsely1="0" data-cropsely2="127" data-galleryid="" data-imgfileid="100017882" data-ratio="0.8435185185185186" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/tpAC6lR84RicFQdAjJlXFgFpqvDjKEysZEDyJ5HeuhZiaaZxAYE2vibrTo3k9PZIicu9ADibzqWtfsVJ7qsyEn8OYPA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/tpAC6lR84RicFQdAjJlXFgFpqvDjKEysZEDyJ5HeuhZiaaZxAYE2vibrTo3k9PZIicu9ADibzqWtfsVJ7qsyEn8OYPA/640?wx_fmt=png&amp;from=appmsg"></span></a></p></td><td width="172" valign="top"><p><a target="_blank" href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzUzOTQzNzU0NA==&amp;action=getalbum&amp;album_id=3330048674143567873&amp;scene=173&amp;subscene=&amp;sessionid=undefined&amp;enterid=0&amp;from_msgid=2247501093&amp;from_itemidx=1&amp;count=3&amp;nolastread=1#wechat_redirect" textvalue="你已选中了添加链接的内容" linktype="text" imgurl="" imgdata="null" tab="innerlink" data-linktype="1"><span><img data-cropselx1="0" data-cropselx2="151" data-cropsely1="0" data-cropsely2="127" data-galleryid="" data-imgfileid="100017883" data-ratio="0.8435185185185186" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/tpAC6lR84RicFQdAjJlXFgFpqvDjKEysZdBBtwWIehx7CD2kBOPBbfIIOuVPZBWCAgZa6pica4yI2DC91G1zoiaJg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/tpAC6lR84RicFQdAjJlXFgFpqvDjKEysZdBBtwWIehx7CD2kBOPBbfIIOuVPZBWCAgZa6pica4yI2DC91G1zoiaJg/640?wx_fmt=png&amp;from=appmsg"></span></a></p></td></tr></tbody></table><p><img data-galleryid="" data-imgfileid="100017881" data-ratio="0.3333333333333333" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/tpAC6lR84RicFQdAjJlXFgFpqvDjKEysZlYnHSZZLNukeic7DKOOuoenP0uPxYP0L4Ngfl5CLhoLUxogGayzREWQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/tpAC6lR84RicFQdAjJlXFgFpqvDjKEysZlYnHSZZLNukeic7DKOOuoenP0uPxYP0L4Ngfl5CLhoLUxogGayzREWQ/640?wx_fmt=png&amp;from=appmsg"></p><p><br></p><section data-role="outer" label="edit by 135editor"><section data-role="paragraph"><section data-role="outer" label="edit by 135editor"><section data-role="paragraph"><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><p data-tool="mdnice编辑器"><span><strong></strong></span></p><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><p data-tool="mdnice编辑器">在读本推文前，需要对<code>mlr3</code>有一些基本了解，强烈建议你先读<code>mlr3</code>入门教程合集：<a href="https://mp.weixin.qq.com/s?__biz=MzUzOTQzNzU0NA==&amp;mid=2247487478&amp;idx=1&amp;sn=00e6100eaa5f69561b1ed1fa5698ea73&amp;scene=21#wechat_redirect" data-linktype="2">mlr3教程汇总</a>(但是有点过时了,可以看看基础部分,实践部分请看2023年及以后的推文)</p><p data-tool="mdnice编辑器">本文主要给大家展示<code>mlr3</code>进行超参数调优的操作，不涉及数据的预处理过程，如果大家想看数据预处理但是不包含调参的基本操作，可以参考推文：<a href="https://mp.weixin.qq.com/s?__biz=MzUzOTQzNzU0NA==&amp;mid=2247492249&amp;idx=1&amp;sn=ef3565c983840ae777535170f147d0ff&amp;scene=21#wechat_redirect" data-linktype="2">使用mlr3搞定二分类资料的多个模型评价和比较</a></p><p data-tool="mdnice编辑器">关于更多数据预处理（特征工程）的知识，可参考历史推文：</p><ul data-tool="mdnice编辑器"><li><section><a href="https://mp.weixin.qq.com/s?__biz=MzUzOTQzNzU0NA==&amp;mid=2247500451&amp;idx=1&amp;sn=f7998b379292dc635b12a195d538ba0b&amp;scene=21#wechat_redirect" data-linktype="2">mlr3数据预处理</a></section></li><li><section><a href="https://mp.weixin.qq.com/s?__biz=MzUzOTQzNzU0NA==&amp;mid=2247496438&amp;idx=1&amp;sn=87f086d09b905dfca5c90ae23b179465&amp;scene=21#wechat_redirect" data-linktype="2">预测建模常用的数据预处理方法</a></section></li><li><section><a href="https://mp.weixin.qq.com/s?__biz=MzUzOTQzNzU0NA==&amp;mid=2247496921&amp;idx=1&amp;sn=2fa8c5033ed737f5968b0dbc0545fe52&amp;scene=21#wechat_redirect" data-linktype="2">R语言机器学习caret-02：数据预处理</a></section></li><li><section><a href="https://mp.weixin.qq.com/s?__biz=MzUzOTQzNzU0NA==&amp;mid=2247498260&amp;idx=1&amp;sn=3805558755e13030d7ddf37c28505c73&amp;scene=21#wechat_redirect" data-linktype="2">tidymodels菜谱：数据预处理</a></section></li></ul><p data-tool="mdnice编辑器">后续会给大家带来更多精彩的使用教程。</p><h2 data-tool="mdnice编辑器"><span></span><span>加载R包和数据</span><span></span></h2><pre data-tool="mdnice编辑器"><code>rm(list = ls())<br><span>library</span>(mlr3verse)<br><span>## Loading required package: mlr3</span><br><br><span># 减少屏幕输出</span><br>lgr::get_logger(<span>"mlr3"</span>)$set_threshold(<span>"warn"</span>)<br>lgr::get_logger(<span>"bbotk"</span>)$set_threshold(<span>"warn"</span>)<br></code></pre><p data-tool="mdnice编辑器">为了方便演示，就用自带的鸢尾花数据集，如果大家想要导入自己的数据并建立任务，可以参考上面的推文，都已经给出了详细的教程。</p><pre data-tool="mdnice编辑器"><code>task &lt;- tsk(<span>"iris"</span>)<br></code></pre><p data-tool="mdnice编辑器">在正式建立模型之前，一定要进行<strong>探索性数据分析</strong>，主要就是看看你的数据分布，数据类型，数据彼此之间的关系等，非常重要！！可以参考之前的推文：</p><ul data-tool="mdnice编辑器"><li><section><a href="https://mp.weixin.qq.com/s?__biz=MzUzOTQzNzU0NA==&amp;mid=2247496584&amp;idx=1&amp;sn=4eb515adf5e17b503bf2c1ece7fe5051&amp;scene=21#wechat_redirect" data-linktype="2">caret的可视化功能</a></section></li></ul><p data-tool="mdnice编辑器">这里就不给大家演示了。</p><h2 data-tool="mdnice编辑器"><span></span><span>超参数调优4种方法</span><span></span></h2><p data-tool="mdnice编辑器">这里以支持向量机为例。</p><p data-tool="mdnice编辑器">既然是超参数调优，那就必须<strong>设置调整哪些超参数，在<code>mlr3</code>里常见的有4种方式</strong>。其实官方也没有明确的分类,只是<code>mlr3</code>使用起来非常灵活,我记录下方便自己记忆.</p><p data-tool="mdnice编辑器">这部分内容在以前的推文中也详细介绍过，大家可以参考：<a href="https://mp.weixin.qq.com/s?__biz=MzUzOTQzNzU0NA==&amp;mid=2247486925&amp;idx=1&amp;sn=6d1a7af6170e850214ceb2c6db7e2beb&amp;scene=21#wechat_redirect" data-linktype="2">mlr3：超参数调优</a></p><h3 data-tool="mdnice编辑器"><span></span><span>第1种</span><span></span></h3><p data-tool="mdnice编辑器">首先是在选择算法的时候设置，使用<code>to_tune</code>表示要调整这个参数，并设定范围。这种形式和<code>tidymodels</code>的做法一样：</p><pre data-tool="mdnice编辑器"><code><span># 选择算法并设置要调整的超参数</span><br>learner &lt;- lrn(<span>"classif.svm"</span>, type = <span>"C-classification"</span>, kernel = <span>"radial"</span>,<br>              cost = to_tune(<span>0.1</span>, <span>10</span>), <span># 需要调整，并设定范围</span><br>              gamma = to_tune(<span>0</span>, <span>5</span>) <span># 需要调整，并设定范围</span><br>              )<br><br><span># 执行调参</span><br>set.seed(<span>123</span>)<br>instance &lt;- tune(tuner = tnr(<span>"grid_search"</span>, resolution = <span>5</span>),<br>                 task = task,<br>                 learner = learner,<br>                 resampling = rsmp (<span>"holdout"</span>),<br>                 measure = msr(<span>"classif.acc"</span>),<br>                 store_models = <span>T</span><br>                 )<br><br><span># 查看最优的超参数</span><br>instance$result_learner_param_vals<br><span>## $type</span><br><span>## [1] "C-classification"</span><br><span>## </span><br><span>## $kernel</span><br><span>## [1] "radial"</span><br><span>## </span><br><span>## $cost</span><br><span>## [1] 2.575</span><br><span>## </span><br><span>## $gamma</span><br><span>## [1] 2.5</span><br><br><span># 应用到算法上</span><br>learner$param_set$values &lt;- instance$result_learner_param_vals<br>learner<br><span>## &lt;LearnerClassifSVM:classif.svm&gt;: Support Vector Machine</span><br><span>## * Model: -</span><br><span>## * Parameters: type=C-classification, kernel=radial, cost=2.575,</span><br><span>##   gamma=2.5</span><br><span>## * Packages: mlr3, mlr3learners, e1071</span><br><span>## * Predict Types:  [response], prob</span><br><span>## * Feature Types: logical, integer, numeric</span><br><span>## * Properties: multiclass, twoclass</span><br><br><span># 重新建模，训练，预测</span><br>pred &lt;- learner$train(task)$predict(task)<br></code></pre><p data-tool="mdnice编辑器">如果以上代码有很多地方你都看不懂，你可能需要翻看历史推文：<a href="https://mp.weixin.qq.com/s?__biz=MzUzOTQzNzU0NA==&amp;mid=2247486925&amp;idx=1&amp;sn=6d1a7af6170e850214ceb2c6db7e2beb&amp;scene=21#wechat_redirect" data-linktype="2">mlr3：超参数调优</a></p><p data-tool="mdnice编辑器">可视化调参结果：</p><pre data-tool="mdnice编辑器"><code><span>library</span>(ggplot2)<br>autoplot(instance,type = <span>"performance"</span>)+<br>  theme(legend.position = <span>"none"</span>)<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100017013" data-ratio="0.636482939632546" data-src="https://mmbiz.qpic.cn/mmbiz_png/tpAC6lR84RicQQ3Mf0U8JTicLvUGNFy2oOibib0vDg9Ty13hNqneL1WWnEdbyJ35HW4gLxd5libnclRXJOBf1kQZvrw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="762" src="https://mmbiz.qpic.cn/mmbiz_png/tpAC6lR84RicQQ3Mf0U8JTicLvUGNFy2oOibib0vDg9Ty13hNqneL1WWnEdbyJ35HW4gLxd5libnclRXJOBf1kQZvrw/640?wx_fmt=png&amp;from=appmsg"></figure><h3 data-tool="mdnice编辑器"><span></span><span>第2种</span><span></span></h3><p data-tool="mdnice编辑器">第二种和第一种差不多，先不设定范围，后面再设置范围，也是和<code>tidymodels</code>很像：</p><pre data-tool="mdnice编辑器"><code><span># 选择算法</span><br>learner &lt;- lrn(<span>"classif.svm"</span>, type = <span>"C-classification"</span>, kernel = <span>"radial"</span>)<br><br><span># 选择调整的超参数及范围</span><br>learner$param_set$values$cost = to_tune(<span>0.1</span>, <span>10</span>)<br>learner$param_set$values$gamma = to_tune(<span>0</span>, <span>5</span>)<br><br><span># 执行调参</span><br>set.seed(<span>123</span>)<br><br>instance &lt;- tune(tuner = tnr(<span>"grid_search"</span>, resolution = <span>5</span>),<br>                 task = tsk(<span>"iris"</span>),<br>                 learner = learner,<br>                 resampling = rsmp (<span>"holdout"</span>),<br>                 measure = msr(<span>"classif.ce"</span>)<br>                 )<br><br><span># 查看最好的超参数</span><br>instance$result_learner_param_vals<br><br><span># 应用到算法上</span><br>learner$param_set$values &lt;- instance$result_learner_param_vals<br>learner<br><br><span># 重新建模，训练，预测</span><br>pred &lt;- learner$train(task)$predict(task)<br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span>第3种</span><span></span></h3><p data-tool="mdnice编辑器">以上2种方法都有一个问题：<strong>你不知道每个算法里有哪些超参数可以调整，你也不知道它们的类型和范围，并且即使知道你也不会拼写</strong>......</p><p data-tool="mdnice编辑器">所有这就有了第3种，也是我推荐大家使用的方法：</p><pre data-tool="mdnice编辑器"><code><span># 选择算法</span><br>learner &lt;- lrn(<span>"classif.svm"</span>, type = <span>"C-classification"</span>, kernel = <span>"radial"</span>)<br><br><span># 查看有哪些超参数</span><br>learner$param_set<br><span>## &lt;ParamSet&gt;</span><br><span>##                  id    class lower upper nlevels          default parents</span><br><span>##  1:       cachesize ParamDbl  -Inf   Inf     Inf               40        </span><br><span>##  2:   class.weights ParamUty    NA    NA     Inf                         </span><br><span>##  3:           coef0 ParamDbl  -Inf   Inf     Inf                0  kernel</span><br><span>##  4:            cost ParamDbl     0   Inf     Inf                1    type</span><br><span>##  5:           cross ParamInt     0   Inf     Inf                0        </span><br><span>##  6: decision.values ParamLgl    NA    NA       2            FALSE        </span><br><span>##  7:          degree ParamInt     1   Inf     Inf                3  kernel</span><br><span>##  8:         epsilon ParamDbl     0   Inf     Inf              0.1        </span><br><span>##  9:          fitted ParamLgl    NA    NA       2             TRUE        </span><br><span>## 10:           gamma ParamDbl     0   Inf     Inf   &lt;NoDefault[3]&gt;  kernel</span><br><span>## 11:          kernel ParamFct    NA    NA       4           radial        </span><br><span>## 12:              nu ParamDbl  -Inf   Inf     Inf              0.5    type</span><br><span>## 13:           scale ParamUty    NA    NA     Inf             TRUE        </span><br><span>## 14:       shrinking ParamLgl    NA    NA       2             TRUE        </span><br><span>## 15:       tolerance ParamDbl     0   Inf     Inf            0.001        </span><br><span>## 16:            type ParamFct    NA    NA       2 C-classification        </span><br><span>##                value</span><br><span>##  1:                 </span><br><span>##  2:                 </span><br><span>##  3:                 </span><br><span>##  4:                 </span><br><span>##  5:                 </span><br><span>##  6:                 </span><br><span>##  7:                 </span><br><span>##  8:                 </span><br><span>##  9:                 </span><br><span>## 10:                 </span><br><span>## 11:           radial</span><br><span>## 12:                 </span><br><span>## 13:                 </span><br><span>## 14:                 </span><br><span>## 15:                 </span><br><span>## 16: C-classification</span><br></code></pre><p data-tool="mdnice编辑器">这样就列出了这个算法支持的所有超参数以及它们的<code>名字(id)</code>，<code>类型(class)</code>，<code>取值范围(lower/upper)</code>等，非常方便！</p><p data-tool="mdnice编辑器">然后再通过以下方法设定超参数网格：</p><pre data-tool="mdnice编辑器"><code>search_space &lt;- ps(<br>  cost = p_dbl(<span>0.1</span>, <span>10</span>),<br>  gamma = p_dbl(<span>0</span>, <span>5</span>)<br>)<br></code></pre><p data-tool="mdnice编辑器">接下来进行调参:</p><pre data-tool="mdnice编辑器"><code>set.seed(<span>123</span>)<br><br>instance &lt;- tune(tuner = tnr(<span>"grid_search"</span>, resolution = <span>5</span>),<br>                 task = task,<br>                 learner = learner,<br>                 resampling = rsmp(<span>"cv"</span>,folds=<span>3</span>),<br>                 measure = msr(<span>"classif.acc"</span>),<br>                 search_space = search_space<br>                 )<br><br><span># 查看最好的超参数</span><br>instance$result_learner_param_vals<br><span>## $type</span><br><span>## [1] "C-classification"</span><br><span>## </span><br><span>## $kernel</span><br><span>## [1] "radial"</span><br><span>## </span><br><span>## $cost</span><br><span>## [1] 2.575</span><br><span>## </span><br><span>## $gamma</span><br><span>## [1] 1.25</span><br><br><span># 应用到算法上</span><br>learner$param_set$values &lt;- instance$result_learner_param_vals<br>learner<br><span>## &lt;LearnerClassifSVM:classif.svm&gt;: Support Vector Machine</span><br><span>## * Model: -</span><br><span>## * Parameters: type=C-classification, kernel=radial, cost=2.575,</span><br><span>##   gamma=1.25</span><br><span>## * Packages: mlr3, mlr3learners, e1071</span><br><span>## * Predict Types:  [response], prob</span><br><span>## * Feature Types: logical, integer, numeric</span><br><span>## * Properties: multiclass, twoclass</span><br><br><span># 重新建模，训练，预测</span><br>pred &lt;- learner$train(task)$predict(task)<br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span>第4种</span><span></span></h3><p data-tool="mdnice编辑器">这种和第3种非常像。这个方法在以后还会经常用到，非常强大！被称为自动调参器.</p><pre data-tool="mdnice编辑器"><code><span># 选择算法</span><br>learner &lt;- lrn(<span>"classif.svm"</span>, type = <span>"C-classification"</span>, kernel = <span>"radial"</span>)<br><br><span># 查看有哪些超参数</span><br><span>#learner$param_set</span><br><br><span># 设定超参数网格</span><br>search_space &lt;- ps(<br>  cost = p_dbl(<span>0.1</span>, <span>10</span>),<br>  gamma = p_dbl(<span>0</span>, <span>5</span>)<br>)<br><br><span># 建立自动调参器</span><br>at &lt;- auto_tuner(<br>  tuner = tnr(<span>"grid_search"</span>, resolution = <span>5</span>),<br>  learner = learner,<br>  resampling = rsmp(<span>"cv"</span>,folds=<span>3</span>),<br>  measure = msr(<span>"classif.acc"</span>),<br>  search_space = search_space<br>)<br><br><span># 执行调参</span><br>set.seed(<span>123</span>)<br>at_res &lt;- at$train(task)<br><br><span># 查看最好的超参数</span><br>at_res$tuning_result$learner_param_vals[[<span>1</span>]]<br><span>## $type</span><br><span>## [1] "C-classification"</span><br><span>## </span><br><span>## $kernel</span><br><span>## [1] "radial"</span><br><span>## </span><br><span>## $cost</span><br><span>## [1] 2.575</span><br><span>## </span><br><span>## $gamma</span><br><span>## [1] 1.25</span><br><br><span># 应用到算法上</span><br>learner$param_set$values &lt;- at_res$tuning_result$learner_param_vals[[<span>1</span>]]<br>learner<br><span>## &lt;LearnerClassifSVM:classif.svm&gt;: Support Vector Machine</span><br><span>## * Model: -</span><br><span>## * Parameters: type=C-classification, kernel=radial, cost=2.575,</span><br><span>##   gamma=1.25</span><br><span>## * Packages: mlr3, mlr3learners, e1071</span><br><span>## * Predict Types:  [response], prob</span><br><span>## * Feature Types: logical, integer, numeric</span><br><span>## * Properties: multiclass, twoclass</span><br><br><span># 重新建模，训练，预测</span><br>pred &lt;- learner$train(task)$predict(task)<br></code></pre><p data-tool="mdnice编辑器">以上就是在没有预处理的情况下常见的超参数调优方法，如果看不懂的地方可以你先看之前写过的<code>mlr3</code>入门教程合集：<a href="https://mp.weixin.qq.com/s?__biz=MzUzOTQzNzU0NA==&amp;mid=2247487478&amp;idx=1&amp;sn=00e6100eaa5f69561b1ed1fa5698ea73&amp;scene=21#wechat_redirect" data-linktype="2">mlr3教程汇总</a>(但是有点过时了,可以看看基础部分,实践部分看2023年更新的，之前的部分代码会报错)</p><p data-tool="mdnice编辑器">以上4种方法<strong>我其实最喜欢的是第3种</strong>，因为和<code>tidymodels</code>非常相似，学习起来可以互相结合，更方便记忆，而且只有这种方法可以实现非常多的可视化（<code>autoplot</code>即可，不用自己提取数据），这个我们后面还会详细说。</p><p data-tool="mdnice编辑器">欢迎大家评论区留言或者加入QQ群交流。后台回复<strong>mlr3</strong>即可获取<code>mlr3</code>推文合集.<span></span></p></section></section></section></section></section></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/-cgvnzcArFBjYLQi_wNw0w",target="_blank" rel="noopener noreferrer">原文链接</a>
