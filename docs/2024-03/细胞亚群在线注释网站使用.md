---
title: "细胞亚群在线注释网站使用"
date: 2024-03-27T04:58:36Z
draft: ["false"]
tags: [
  "fetched",
  "生信漫漫学"
]
categories: ["Acdemic"]
---
细胞亚群在线注释网站使用 by 生信漫漫学
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><h3 data-tool="mdnice编辑器"><span></span><span></span><span>写在开头</span><span></span></h3><p data-tool="mdnice编辑器">先来回顾一下我们单细胞分析的基本流程叭：</p><ul data-tool="mdnice编辑器"><li><section>step1：读取数据创建seurat对象</section></li><li><section>step2：质控——删除掉一些不合格的细胞和基因</section></li><li><section>step3：表达量的标准化和归一化（去除细胞效应和基因效应）</section></li><li><section>step4：降维聚类分群</section></li><li><section>step5：单细胞亚群注释</section></li><li><section>step6：细胞亚群继续细分</section></li></ul><p data-tool="mdnice编辑器">其中比较复杂的一步就是我们的<strong>单细胞亚群注释</strong>，如果选择手动命名的话，正常而言我们就需要根据Marker基因去推断亚群的类型人，然后给到命名，这时候需要我们对不同细胞亚群的Marker基因比较熟悉。</p><p data-tool="mdnice编辑器">通常是建议背诵下来一些常见的Marker基因，这样会方便注释。<a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247528121&amp;idx=1&amp;sn=13dc8e0de15afd0dcc840e460dc93a6f&amp;scene=21#wechat_redirect" data-linktype="2">让我们来一起背诵5000个基因吧</a></p><p data-tool="mdnice编辑器">如果不想背诵Marker基因或者懒得自己一个个去对比点图然后注释，我们也可以选择用到在线注释的网站，上传我们的Marker基因然后注释。</p><p data-tool="mdnice编辑器">曾老师在<a href="https://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247519821&amp;idx=1&amp;sn=f0d12e88cad52018c940f26e8268c0c5&amp;scene=21#wechat_redirect" data-linktype="2">单细胞亚群的关键基因背诵不下来肿么办</a>推荐了ACT网站，然后办公室同事在摸索过程中补充了PanglaoDB——<a href="https://mp.weixin.qq.com/s?__biz=MzkxMzYyMTk1Mw==&amp;mid=2247483808&amp;idx=1&amp;sn=bd96dd758d3e1b819fcedfc1ed86f75a&amp;scene=21#wechat_redirect" data-linktype="2">单细胞注释的小tips</a></p><p data-tool="mdnice编辑器">那今天来浅试一下两个在线注释网站叭。</p><h3 data-tool="mdnice编辑器"><span></span><span></span><span>获取亚群Marker基因</span><span></span></h3><p data-tool="mdnice编辑器">首先我们<strong>需要运行前面的分析步骤，然后确定选择分群的resolution，然后取得对应的Marker基因</strong></p><pre data-tool="mdnice编辑器"><span></span><code><span>###### step1:导入数据 ######   </span><br><br>samples=list.files(<span>"./GSE161045_RAW/outputs/"</span>)<br>samples<br>dir &lt;- file.path(<span>'./GSE161045_RAW/outputs/'</span>,samples)<br>names(dir) &lt;- samples<br><span>#读取数据创建Seurat对象</span><br>counts &lt;- Read10X(data.dir = dir)<br><br>sce.all = CreateSeuratObject(counts,<br>                             min.cells = 5,<br>                             min.features = 300 )<br><br>dim(sce.all)   <span>#查看基因数和细胞总数</span><br>as.data.frame(sce.all@assays<span>$RNA</span><span>$counts</span>[1:10, 1:2])<br>table(sce.all@meta.data<span>$orig</span>.ident)  <span>#查看每个样本的细胞数</span><br>head(sce.all@meta.data)<br><br><span># 分组信息，通常是隐含在文件名，样品名字里面</span><br><br>sce.all<span>$group</span>=toupper( substring(colnames(sce.all),12,13))<br>table(sce.all@meta.data<span>$group</span>)<br>table(sce.all@meta.data<span>$orig</span>.ident)<br><br><br><span>###### step2:QC质控 ######</span><br>dir.create(<span>"./1-QC"</span>)<br>setwd(<span>"./1-QC"</span>)<br><span># 如果过滤的太狠，就需要去修改这个过滤代码</span><br><span>source</span>(<span>'../scRNA_scripts/qc.R'</span>)<br>sce.all.filt = basic_qc(sce.all)<br><span>print</span>(dim(sce.all))<br><span>print</span>(dim(sce.all.filt))<br>setwd(<span>'../'</span>)<br><br><br>sp=<span>'human'</span><br><br><span>###### step3: harmony整合多个单细胞样品 ######</span><br>dir.create(<span>"2-harmony"</span>)<br>getwd()<br>setwd(<span>"2-harmony"</span>)<br><span>source</span>(<span>'../scRNA_scripts/harmony.R'</span>)<br><span># 默认 ScaleData 没有添加"nCount_RNA", "nFeature_RNA"</span><br><span># 默认的</span><br>sce.all.int = run_harmony(sce.all.filt)<br>setwd(<span>'../'</span>)<br><br><span>###### step4: 降维聚类分群和看标记基因库 ######</span><br><span># 原则上分辨率是需要自己肉眼判断，取决于个人经验</span><br><span># 为了省力，我们直接看  0.1和0.8即可</span><br>table(Idents(sce.all.int))<br>table(sce.all.int<span>$seurat_clusters</span>)<br>table(sce.all.int<span>$RNA_snn_res</span>.0.1) <br>table(sce.all.int<span>$RNA_snn_res</span>.0.8) <br><br>getwd()<br>dir.create(<span>'check-by-0.1'</span>)<br>setwd(<span>'check-by-0.1'</span>)<br>sel.clust = <span>"RNA_snn_res.0.1"</span><br>sce.all.int &lt;- SetIdent(sce.all.int, value = sel.clust)<br>table(sce.all.int@active.ident) <br><br><span>source</span>(<span>'../scRNA_scripts/check-all-markers.R'</span>)<br>setwd(<span>'../'</span>) <br>getwd()<br><br>dir.create(<span>'check-by-0.8'</span>)<br>setwd(<span>'check-by-0.8'</span>)<br>sel.clust = <span>"RNA_snn_res.0.8"</span><br>sce.all.int &lt;- SetIdent(sce.all.int, value = sel.clust)<br>table(sce.all.int@active.ident) <br><span>source</span>(<span>'../scRNA_scripts/check-all-markers.R'</span>)<br>setwd(<span>'../'</span>) <br>getwd()<br><br>last_markers_to_check<br><br></code></pre><p data-tool="mdnice编辑器"><strong>加载需要阈值保存的Rdata数据，然后取出对应亚群的top10的Marker基因</strong></p><pre data-tool="mdnice编辑器"><span></span><code><span>#取出marker基因去ACT官网注释</span><br><br>load(file =  <span>'check-by-0.1/qc-_marker_cosg.Rdata'</span>)<br>head(marker_cosg)<br><br><span>## Top10 genes</span><br>library(dplyr)  <br>cat(paste0(<span>'cluster'</span>,0:10,<span>':'</span>,<br>           unlist(apply(marker_cosg<span>$names</span>,2,<span>function</span>(x){<br>             paste(head(x),collapse=<span>','</span>)<br>           })),<span>'\n'</span>))<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100003089" data-ratio="0.5050377833753149" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YXq4yU2AbPbN7V0X4u7DFKiaT2L4oibibBic43ibwQfHeTJRbpvLzvlU36G16ZsotjcSUMFwlLkzNGmvg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="794" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YXq4yU2AbPbN7V0X4u7DFKiaT2L4oibibBic43ibwQfHeTJRbpvLzvlU36G16ZsotjcSUMFwlLkzNGmvg/640?wx_fmt=png&amp;from=appmsg"><figcaption>top10</figcaption></figure><h3 data-tool="mdnice编辑器"><span></span><span></span><span>使用ACT注释</span><span></span></h3><p data-tool="mdnice编辑器"><strong>ACT简介</strong></p><blockquote data-tool="mdnice编辑器"><span></span><p>网址1：http://xteam.xbio.top/ACT/index.jsp</p><p>网址2：http://biocc.hrbmu.edu.cn/ACT/</p></blockquote><figure data-tool="mdnice编辑器"><img data-imgfileid="100003092" data-ratio="0.5965946299934513" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YXq4yU2AbPbN7V0X4u7DFKnCQe7hL6s09dU0ndRI40DtTufHpQs6QJ95bibDjo8FlfzwwKlIu2jwA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1527" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YXq4yU2AbPbN7V0X4u7DFKnCQe7hL6s09dU0ndRI40DtTufHpQs6QJ95bibDjo8FlfzwwKlIu2jwA/640?wx_fmt=png&amp;from=appmsg"><figcaption>ACT首页</figcaption></figure><blockquote data-tool="mdnice编辑器"><span></span><p>ACT是<strong>基于结构标记图谱和细胞类型富集算法开发的，目的是高效地促进细胞类型标注过程。</strong>用户可以通过ACT中实现的方便易用的模块来<strong>探索和注释感兴趣的细胞簇，包括用于注释细胞类型的核心富集工具、富集结果的汇总表、富集细胞类型的良好组织层次图、典型标记与不同上调基因之间的映射关系、典型标记的流行程度及其在人类和小鼠多器官scRNA-seq表达数据中的可视化。</strong></p></blockquote><p data-tool="mdnice编辑器"><strong>使用方法：</strong>将Marker基因按照对应的格式粘贴到Ordered up-regulated genes——选择Species——选择Tissue——然后点击Submit提交等待结果</p><figure data-tool="mdnice编辑器"><img data-imgfileid="100003093" data-ratio="1.1274787535410764" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YXq4yU2AbPbN7V0X4u7DFK17uB6TZzNOrwQl7yiau0u4mPTK60kquJj1MpPahxxIRg2etlHZEAy6A/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="706" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YXq4yU2AbPbN7V0X4u7DFK17uB6TZzNOrwQl7yiau0u4mPTK60kquJj1MpPahxxIRg2etlHZEAy6A/640?wx_fmt=png&amp;from=appmsg"></figure><figure data-tool="mdnice编辑器"><img data-imgfileid="100003090" data-ratio="0.4426981008513425" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YXq4yU2AbPbN7V0X4u7DFKftZ7Xs8hRROKf9BSSfFo7Br80LoicUIwT6jtfQTkbd3henPqPJe6urg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1527" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YXq4yU2AbPbN7V0X4u7DFKftZ7Xs8hRROKf9BSSfFo7Br80LoicUIwT6jtfQTkbd3henPqPJe6urg/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器">注释完之后会跳转到结果页面，我们下载对应的文件即可</p><figure data-tool="mdnice编辑器"><img data-imgfileid="100003091" data-ratio="0.5575275397796817" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YXq4yU2AbPbN7V0X4u7DFKmktBcDcVcdEjl4nPHakSq9wh8jnPppiaia6XuEInEX224208JGQVwN5A/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1634" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YXq4yU2AbPbN7V0X4u7DFKmktBcDcVcdEjl4nPHakSq9wh8jnPppiaia6XuEInEX224208JGQVwN5A/640?wx_fmt=png&amp;from=appmsg"><figcaption>结果界面</figcaption></figure><p data-tool="mdnice编辑器">但是有很多亚群注释为NA了，所以需要进一步注释，同样也是可以选择人工注释或者换一个网页hhh</p><figure data-tool="mdnice编辑器"><img data-imgfileid="100003094" data-ratio="0.5362776025236593" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YXq4yU2AbPbN7V0X4u7DFKf25Bgia6ocQAlDAFJLITZoyFT2iaxO0ugAC154icRabfZtosbeBp5ibslw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1268" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YXq4yU2AbPbN7V0X4u7DFKf25Bgia6ocQAlDAFJLITZoyFT2iaxO0ugAC154icRabfZtosbeBp5ibslw/640?wx_fmt=png&amp;from=appmsg"></figure><h3 data-tool="mdnice编辑器"><span></span><span></span><span>PanglaoDB注释</span><span></span></h3><p data-tool="mdnice编辑器">因为ACT注释的亚群不全，所以同事推荐了另外一个网站PanglaoDB的Search功能，也可以进行注释。（缺点：旁边带的广告贼多。）</p><blockquote data-tool="mdnice编辑器"><span></span><p>网址：https://panglaodb.se/search.html</p></blockquote><figure data-tool="mdnice编辑器"><img data-imgfileid="100003097" data-ratio="0.5464907018596281" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YXq4yU2AbPbN7V0X4u7DFKvqcwwR9XGybbicOUt4uw9BVEmxElwMgmQibjex88MHN1MrMicc2kiaGUYQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1667" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YXq4yU2AbPbN7V0X4u7DFKvqcwwR9XGybbicOUt4uw9BVEmxElwMgmQibjex88MHN1MrMicc2kiaGUYQ/640?wx_fmt=png&amp;from=appmsg"></figure><blockquote data-tool="mdnice编辑器"><span></span><p>PanglaoDB是一个对探索小鼠和人类单细胞RNA测序实验感兴趣的科学界数据库。我们收集和整合多个研究的数据，并通过一个统一的框架来呈现。</p></blockquote><p data-tool="mdnice编辑器"><strong>不过就是可能拿单个基因注释会比较快</strong></p><p data-tool="mdnice编辑器"><strong>注释方法：根据ACT注释为NA的亚群，取其中一个Marker基因——PanglaoDB的search界面粘贴——选择物种（可不选反正就是人和鼠）——点击search查询——获取结果</strong></p><figure data-tool="mdnice编辑器"><img data-imgfileid="100003096" data-ratio="0.5658385093167702" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YXq4yU2AbPbN7V0X4u7DFKBricQUpBtXdic6DMFUwNPNdFbrx8tnjj95qTFws69Y6kkFOnnvXSEJTA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1610" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YXq4yU2AbPbN7V0X4u7DFKBricQUpBtXdic6DMFUwNPNdFbrx8tnjj95qTFws69Y6kkFOnnvXSEJTA/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器">注释结果会直接出现在页面下方，我们选择第一个注释结果即可。</p><figure data-tool="mdnice编辑器"><img data-imgfileid="100003098" data-ratio="0.6274104683195593" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YXq4yU2AbPbN7V0X4u7DFKWKB9WWvrbvMoAsQGOxoHlIaI87U9aDL5iapFZtQLUicNw7FDKx7Yrowg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1452" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YXq4yU2AbPbN7V0X4u7DFKWKB9WWvrbvMoAsQGOxoHlIaI87U9aDL5iapFZtQLUicNw7FDKx7Yrowg/640?wx_fmt=png&amp;from=appmsg"><figcaption>注释结果</figcaption></figure><h3 data-tool="mdnice编辑器"><span></span><span></span><span>写在结尾</span><span></span></h3><p data-tool="mdnice编辑器">反正对于细胞注释而言，没有很简单的方法，<strong>可以选择背诵Marker基因，然后在平常留心根据文献整理一些Marker基因</strong></p><p data-tool="mdnice编辑器">或者就是<strong>取到Marker基因，去多个网站结合起来注释。</strong><img data-imgfileid="100003095" data-ratio="0.6216955332725616" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YXq4yU2AbPbN7V0X4u7DFKfJv22Ac08LoAP4tYG7oWiapYjp3oia7unonhibrqC0ex7DI4iaV1sTfP2A/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1097" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YXq4yU2AbPbN7V0X4u7DFKfJv22Ac08LoAP4tYG7oWiapYjp3oia7unonhibrqC0ex7DI4iaV1sTfP2A/640?wx_fmt=png&amp;from=appmsg"></p><p data-tool="mdnice编辑器">或许下次可以试试看用<strong>SingleR自动注释</strong>，对了曾老师上次就直播分享了<strong>SingleR自动注释</strong>并提供了V5版seurat的全部代码，大家有需要可以自取</p><figure data-tool="mdnice编辑器"><img data-imgfileid="100003103" data-ratio="0.7737306843267108" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YXq4yU2AbPbN7V0X4u7DFKwGYdicbQZ3IopPNqoBSDC8Q7QZG5thA3IITV6XLavvJNxicNnoDpFqUQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1812" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YXq4yU2AbPbN7V0X4u7DFKwGYdicbQZ3IopPNqoBSDC8Q7QZG5thA3IITV6XLavvJNxicNnoDpFqUQ/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器">有需要的自行获取——<code>链接: https://pan.baidu.com/s/1bIBG9RciAzDhkTKKA7hEfQ?pwd=y4eh 提取码: y4eh</code></p><figure data-tool="mdnice编辑器"><img data-imgfileid="100003102" data-ratio="0.6875" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YXq4yU2AbPbN7V0X4u7DFKl4gxMAVziaQWA6FViaTgYtQVmicQyb7VWhrzXR9hZiaFSbn4XicGSL41w5g/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1952" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YXq4yU2AbPbN7V0X4u7DFKl4gxMAVziaQWA6FViaTgYtQVmicQyb7VWhrzXR9hZiaFSbn4XicGSL41w5g/640?wx_fmt=png&amp;from=appmsg"><figcaption>ScRNA_scripts</figcaption></figure></section><p><br></p><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/zqWzV4WTuH4qyGi5rCyvDA",target="_blank" rel="noopener noreferrer">原文链接</a>
