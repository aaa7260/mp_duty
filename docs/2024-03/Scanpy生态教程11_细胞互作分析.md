---
title: "Scanpy生态教程11：细胞互作分析"
date: 2024-03-27T23:38:36Z
draft: ["false"]
tags: [
  "fetched",
  "生信会客厅"
]
categories: ["Acdemic"]
---
Scanpy生态教程11：细胞互作分析 by 生信会客厅
------
<div><section><em><span>多细胞生物的细胞与细胞之间往往会通过细胞因子和膜蛋白等进行通讯，从而调节生命活动，保证生命体高效、有序的运作。细胞通讯分析通过统计不同细胞类型中受体和配体的表达及配对情况，推断不同细胞之间的相互作用。跨个体的细胞互作是不存在的，因此尽量不要把不同个体的数据合并分析，尤其不要把不同分组的数据合并分析。很多文章会把同一分组的数据合并后进行细胞互作分析，这是因为分析多个样本的细胞互作分析结果存在一定难度。合并数据得出的细胞互作结论，建议用别的分析方法交叉验证后再进行湿实验验证。</span></em></section><p><br></p><p><strong>设置分析环境</strong></p><pre><code><span>import</span> numpy <span>as</span> np<br><span>import</span> pandas <span>as</span> pd<br><span>import</span> scanpy <span>as</span> sc<br><span>import</span> os<br><span>import</span> ktplotspy <span>as</span> kpy<br><span>import</span> matplotlib.pyplot <span>as</span> plt<br><span>import</span> seaborn <span>as</span> sns<br><span>import</span> warnings</code></pre><pre><code>warnings.simplefilter(action=<span>"ignore"</span>, category=Warning)<br>sc.settings.verbosity = <span>3</span><br>sc.settings.set_figure_params(dpi=<span>80</span>)</code></pre><pre><code>projpath = <span>'D:\\公众号\\2024scanpy'</span><br>chapter = <span>"09_CellPhoneDB"</span></code></pre><pre><code>os.chdir(projpath)<br><span>if</span> <span>not</span> os.path.exists(chapter):<br>    os.makedirs(chapter)<br>os.chdir(chapter)</code></pre><pre><code><span># 下载数据库</span><br><span>from</span> cellphonedb.utils <span>import</span> db_utils<br>cpdb_target_dir = os.path.join(projpath, <span>'Resource/cellphonedb'</span>)<br>db_utils.download_database(cpdb_target_dir, <span>'v5.0.0'</span>)</code></pre><h2><strong><br></strong></h2><h2><strong>统计模式分析</strong></h2><section><span>这种模式下CellphoneDB将为每一对细胞类型组合输出所有互作分子的平均值。只有当互作分子的所有基因成员在至少一个细胞类型表达一定比例时（默认10%的细胞表达），CellphoneDB才会报告平均值。此后，CellphoneDB使用置换检验计算哪些配体-受体对显示出显著的细胞类型特异性。具体来说，它通过随机排列所有细胞的簇标签来估计交互簇中平均配体和受体表达的零分布。基于比例，计算给定受体-配体复合物细胞类型特异性的P值，这些比例与实际平均值一样高或更高。</span></section><h3>准备输入文件</h3><pre><code><span>from</span> cellphonedb.src.core.methods <span>import</span> cpdb_statistical_analysis_method</code></pre><pre><code>os.chdir(projpath)<br><span>if</span> <span>not</span> os.path.exists(chapter+<span>"/statistical_analysis"</span>):<br>    os.makedirs(chapter+<span>"/statistical_analysis"</span>)<br>os.chdir(chapter+<span>"/statistical_analysis"</span>)</code></pre><pre><code><span># 读取待分析数据</span><br>adata = sc.read_h5ad(os.path.join(projpath, <span>"05_CellAnnotation/adata_annotated.h5ad"</span>))<br>adata.obs.groupby(<span>'celltype'</span>)[<span>'type'</span>].value_counts()</code></pre><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="properties"><code><span><span>celltype</span>        <span>type </span></span></code><code><span><span>B-cell</span>          <span>Covid     526</span></span></code><code><span>                <span>Ctrl</span>      <span>507</span></span></code><code><span><span>CD14+</span> <span>Monocyte  Covid    1286</span></span></code><code><span>                <span>Ctrl</span>     <span>1037</span></span></code><code><span><span>CD16+</span> <span>Monocyte  Ctrl      287</span></span></code><code><span>                <span>Covid</span>      <span>20</span></span></code><code><span><span>CD4+</span> <span>T          Ctrl      711</span></span></code><code><span>                <span>Covid</span>     <span>279</span></span></code><code><span><span>CD8+</span> <span>T          Ctrl      647</span></span></code><code><span>                <span>Covid</span>     <span>237</span></span></code><code><span><span>NK</span>              <span>Ctrl     1137</span></span></code><code><span>                <span>Covid</span>     <span>397</span></span></code><code><span><span>Plasmablast</span>     <span>Covid      26</span></span></code><code><span>                <span>Ctrl</span>        <span>9</span></span></code><code><span><span>Platelet</span>        <span>Covid     872</span></span></code><code><span>                <span>Ctrl</span>       <span>59</span></span></code><code><span><span>Name</span>: <span>count, dtype: int64</span></span></code></pre></section><pre><code><span># 准备Covid组的分析数据</span><br><span>if</span> <span>not</span> os.path.exists(<span>'Covid'</span>):<br>    os.mkdir(<span>'Covid'</span>)<br>bdata = adata[adata.obs[<span>'type'</span>]==<span>'Covid'</span>].copy()<br>bdata.obs[<span>'celltype'</span>].to_csv(<span>'Covid/meta.csv'</span>)<br>xdata = sc.AnnData(bdata.to_df())<br>xdata.write_h5ad(<span>'Covid/count.h5ad'</span>, compression=<span>'gzip'</span>)</code></pre><pre><code><span># 准备Ctrl组的分析数据</span><br><span>if</span> <span>not</span> os.path.exists(<span>'Ctrl'</span>):<br>    os.mkdir(<span>'Ctrl'</span>)<br>bdata = adata[adata.obs[<span>'type'</span>]==<span>'Ctrl'</span>].copy()<br>bdata.obs[<span>'celltype'</span>].to_csv(<span>'Ctrl/meta.csv'</span>)<br>xdata = sc.AnnData(bdata.to_df())<br>xdata.write_h5ad(<span>'Ctrl/count.h5ad'</span>, compression=<span>'gzip'</span>)</code></pre><h3>细胞互作分析</h3><pre><code><span># Covid组数据cellphonedb分析</span><br>cpdb_file_path = os.path.join(projpath, <span>'Resource/cellphonedb/cellphonedb.zip'</span>)<br>cpdb_statistical_analysis_method.call(<br>    cpdb_file_path = cpdb_file_path,                 <span># 数据库文件路径</span><br>    meta_file_path = <span>'Covid/meta.csv'</span>,               <span># 细胞分类文件路径</span><br>    counts_file_path = <span>'Covid/count.h5ad'</span>,           <span># 表达矩阵文件路径</span><br>    counts_data = <span>'hgnc_symbol'</span>,<br>    score_interactions = <span>True</span>,                       <span># 是否对分析结果进行综合评分</span><br>    iterations = <span>1000</span>,                               <span># 置换检验的次数</span><br>    threshold = <span>0.1</span>,                                 <span># 基因的最低细胞表达比例</span><br>    threads = <span>6</span>,                                     <span># 分析使用的cpu线程数量</span><br>    pvalue = <span>0.05</span>,                                   <span># 确定显著性的P-value阈值</span><br>    output_path = <span>'Covid'</span>,                           <span># 结果保存目录</span><br>    output_suffix = <span>''</span>                               <span># 输出文件名后缀，默认是运行时间日期</span><br>    )</code></pre><pre><code><span># Ctrl组数据cellphonedb分析</span><br>cpdb_file_path = os.path.join(projpath, <span>'Resource/cellphonedb/cellphonedb.zip'</span>)<br>cpdb_statistical_analysis_method.call(<br>    cpdb_file_path = cpdb_file_path,                 <span># 数据库文件路径</span><br>    meta_file_path = <span>'Ctrl/meta.csv'</span>,                <span># 细胞分类文件路径</span><br>    counts_file_path = <span>'Ctrl/count.h5ad'</span>,            <span># 表达矩阵文件路径</span><br>    counts_data = <span>'hgnc_symbol'</span>,<br>    score_interactions = <span>True</span>,                       <span># 是否对分析结果进行综合评分</span><br>    iterations = <span>1000</span>,                               <span># 置换检验的次数</span><br>    threshold = <span>0.1</span>,                                 <span># 基因的最低细胞表达比例</span><br>    threads = <span>6</span>,                                     <span># 分析使用的cpu线程数量</span><br>    pvalue = <span>0.05</span>,                                   <span># 确定显著性的P-value阈值</span><br>    output_path = <span>'Ctrl'</span>,                            <span># 结果保存目录</span><br>    output_suffix = <span>''</span>                               <span># 输出文件名后缀，默认是运行时间日期</span><br>    )</code></pre><h3>结果可视化</h3><p>下面以Covid组为例展示常用的可视化结果</p><pre><code><span># 读取画图文件</span><br>adata = sc.read_h5ad(<span>"Covid/count.h5ad"</span>)<br>meta = pd.read_csv(<span>"Covid/meta.csv"</span>, index_col=<span>0</span>)<br>adata.obs = meta<br>means = pd.read_csv(<span>"Covid/statistical_analysis_means_.txt"</span>, sep=<span>"\t"</span>)<br>pvals = pd.read_csv(<span>"Covid/statistical_analysis_pvalues_.txt"</span>, sep=<span>"\t"</span>)</code></pre><pre><code><span># 所有细胞类型之间显著互作数量热图</span><br>ax = kpy.plot_cpdb_heatmap(pvals=pvals, log1p_transform=<span>False</span>,<br>                           figsize=(<span>6</span>, <span>6</span>),<br>                           title=<span>"Sum of significant interactions"</span>)<br>ax.ax_heatmap.grid(<span>False</span>)<br>ax.figure.savefig(<span>"Covid/sum_of_sig_cci.pdf"</span>)</code></pre><p><span></span></p><p><img data-imgfileid="100001962" data-ratio="1.0010649627263046" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/VTXDic6Eia0AEO4HP8OHSxuPqEWdhJazDStI6ichfIia51DtAnxL7Rr5Kzu5q7ib8s2ibZgvY8jtVpKH23Ttw12G2AHw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="939" src="https://mmbiz.qpic.cn/sz_mmbiz_png/VTXDic6Eia0AEO4HP8OHSxuPqEWdhJazDStI6ichfIia51DtAnxL7Rr5Kzu5q7ib8s2ibZgvY8jtVpKH23Ttw12G2AHw/640?wx_fmt=png&amp;from=appmsg"></p><p><span></span></p><pre><code><span># 指定细胞类型显著互作数量热图</span><br>ax = kpy.plot_cpdb_heatmap(pvals=pvals, cell_types=[<span>'CD4+ T'</span>,<span>'CD8+ T'</span>,<span>'B-cell'</span>,<span>'CD14+ Monocyte'</span>,<span>'CD16+ Monocyte'</span>], <br>                           figsize=(<span>5</span>, <span>5</span>), title=<span>"Sum of significant interactions"</span>)<br>ax.ax_heatmap.grid(<span>False</span>)<br>ax.figure.savefig(<span>"Covid/sum_of_sig_cci_sub.pdf"</span>)</code></pre><p><span></span></p><p><img data-imgfileid="100001963" data-ratio="1.010230179028133" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/VTXDic6Eia0AEO4HP8OHSxuPqEWdhJazDSic4icVpt5FibtnIwZC9QxibLZaEQxv3iccsDlbsMjjibWI28K0VTStLKjXcg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="782" src="https://mmbiz.qpic.cn/sz_mmbiz_png/VTXDic6Eia0AEO4HP8OHSxuPqEWdhJazDSic4icVpt5FibtnIwZC9QxibLZaEQxv3iccsDlbsMjjibWI28K0VTStLKjXcg/640?wx_fmt=png&amp;from=appmsg"></p><p><span></span></p><pre><code><span># 所有细胞类型与配受体的气泡图</span><br>g = kpy.plot_cpdb(<br>    adata=adata,<br>    cell_type1=<span>"."</span>,   <span># "."代表所有细胞</span><br>    cell_type2=<span>"."</span>,<br>    means=means,<br>    pvals=pvals,<br>    celltype_key=<span>"celltype"</span>,<br>    figsize=(<span>30</span>, <span>40</span>),<br>    max_size=<span>8</span>, <br>    highlight_size=<span>1</span>, <br>    title=<span>"interacting interactions!"</span>,<br>)<br>g.save(<span>"Covid/cci_dotplot.pdf"</span>, limitsize=<span>False</span>)</code></pre><pre><code><span># 指定细胞与配受体的互作气泡图：按基因家族过滤互作分子</span><br>g = kpy.plot_cpdb(<br>    adata=adata,<br>    celltype_key=<span>"celltype"</span>,<br>    means=means,<br>    pvals=pvals,<br>    cell_type1=<span>"."</span>,<br>    cell_type2=<span>"CD8+ T|CD8+ T"</span>,  <span>#多个细胞用竖线隔开</span><br>    gene_family=[<span>"chemokines"</span>],  <span># 可选"chemokines", "th1", "th2", "th17", "treg", "costimulatory", "coinhibitory"</span><br>    figsize=(<span>9</span>, <span>3.5</span>),<br>    highlight_size=<span>1</span>,<br>    title=<span>"interacting interactions!"</span>,<br>)<br>g.save(<span>"Covid/cci_dotplot_sub1.pdf"</span>)<br>g</code></pre><p><span></span></p><p><img data-imgfileid="100001964" data-ratio="0.38796296296296295" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/VTXDic6Eia0AEO4HP8OHSxuPqEWdhJazDSj86lXLYJyYdgJbuWL6msGALLicCQl8uEd5y9kIstYKbFzuHibatyAmuA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/VTXDic6Eia0AEO4HP8OHSxuPqEWdhJazDSj86lXLYJyYdgJbuWL6msGALLicCQl8uEd5y9kIstYKbFzuHibatyAmuA/640?wx_fmt=png&amp;from=appmsg"></p><pre><code><span># 指定细胞与配受体的互作气泡图：按基因名称过滤互作分子</span><br>g = kpy.plot_cpdb(<br>    adata=adata,<br>    celltype_key=<span>"celltype"</span>,<br>    means=means,<br>    pvals=pvals,<br>    cell_type1=<span>"."</span>,<br>    cell_type2=<span>"CD8+ T|CD8+ T"</span>,  <span>#多个细胞用竖线隔开</span><br>    genes=[<span>'ALCAM'</span>,<span>'CD6'</span>,<span>'BTLA'</span>,<span>'TNFRSF14'</span>,<span>'CCL3'</span>,<span>'CCR1'</span>,<span>'CD44'</span>,<span>'TYROBP'</span>,<span>'CD93'</span>,<span>'IFNGR1'</span>],  <br>    figsize=(<span>9</span>, <span>5</span>),<br>    highlight_size=<span>1</span>,<br>    title=<span>"interacting interactions!"</span>,<br>)<br>g.save(<span>"Covid/cci_dotplot_sub2.pdf"</span>)<br>g</code></pre><p><span></span></p><p><img data-imgfileid="100001965" data-ratio="0.5555555555555556" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/VTXDic6Eia0AEO4HP8OHSxuPqEWdhJazDSKKXnqf5uxupic9CMfJibHsBdwdJqP51pW1tIbS4QgsUD3gw8rLfRZqPQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/VTXDic6Eia0AEO4HP8OHSxuPqEWdhJazDSKKXnqf5uxupic9CMfJibHsBdwdJqP51pW1tIbS4QgsUD3gw8rLfRZqPQ/640?wx_fmt=png&amp;from=appmsg"></p><p><br></p><pre></pre><h2><strong>DEG模式分析</strong></h2><section><span>这种方法被提出作为统计推断方法的一种替代方案。这种方法允许用户设计更为复杂的比较方式，特异性地检索感兴趣细胞类型中的相互作用。当您的研究问题超越了简单地比较“一种”细胞类型与“其他所有”细胞类型时，这一点尤为重要。替代对比示例包括层级比较（例如，您关注某一特定谱系，如上皮细胞，并希望识别在这个谱系内部表达发生变化的基因）或疾病与对照组的比较（例如，您希望通过将疾病状态下的T细胞与正常对照T细胞进行比较，来鉴定在疾病状态下上调的基因）。</span></section><h3>准备输入文件</h3><pre><code><span>from</span> cellphonedb.src.core.methods <span>import</span> cpdb_degs_analysis_method</code></pre><pre><code>os.chdir(projpath)<br><span>if</span> <span>not</span> os.path.exists(chapter+<span>"/degs_analysis"</span>):<br>    os.makedirs(chapter+<span>"/degs_analysis"</span>)<br>os.chdir(chapter+<span>"/degs_analysis"</span>)</code></pre><pre><code><span># 读取待分析数据</span><br>adata = sc.read_h5ad(os.path.join(projpath, <span>"05_CellAnnotation/adata_annotated.h5ad"</span>))<br>adata.obs.groupby(<span>'celltype'</span>)[<span>'type'</span>].value_counts()</code></pre><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="properties"><code><span><span>celltype</span>        <span>type </span></span></code><code><span><span>B-cell</span>          <span>Covid     526</span></span></code><code><span>                <span>Ctrl</span>      <span>507</span></span></code><code><span><span>CD14+</span> <span>Monocyte  Covid    1286</span></span></code><code><span>                <span>Ctrl</span>     <span>1037</span></span></code><code><span><span>CD16+</span> <span>Monocyte  Ctrl      287</span></span></code><code><span>                <span>Covid</span>      <span>20</span></span></code><code><span><span>CD4+</span> <span>T          Ctrl      711</span></span></code><code><span>                <span>Covid</span>     <span>279</span></span></code><code><span><span>CD8+</span> <span>T          Ctrl      647</span></span></code><code><span>                <span>Covid</span>     <span>237</span></span></code><code><span><span>NK</span>              <span>Ctrl     1137</span></span></code><code><span>                <span>Covid</span>     <span>397</span></span></code><code><span><span>Plasmablast</span>     <span>Covid      26</span></span></code><code><span>                <span>Ctrl</span>        <span>9</span></span></code><code><span><span>Platelet</span>        <span>Covid     872</span></span></code><code><span>                <span>Ctrl</span>       <span>59</span></span></code><code><span><span>Name</span>: <span>count, dtype: int64</span></span></code></pre></section><pre><code><span># 准备Covid组的分析数据</span><br><span>if</span> <span>not</span> os.path.exists(<span>'Covid'</span>):<br>    os.mkdir(<span>'Covid'</span>)<br>bdata = adata[adata.obs[<span>'type'</span>]==<span>'Covid'</span>].copy()<br>bdata.obs[<span>'celltype'</span>].to_csv(<span>'Covid/meta.csv'</span>)<br>xdata = sc.AnnData(bdata.to_df())<br>xdata.write_h5ad(<span>'Covid/count.h5ad'</span>, compression=<span>'gzip'</span>)</code></pre><pre><code><span># 准备Ctrl组的分析数据</span><br><span>if</span> <span>not</span> os.path.exists(<span>'Ctrl'</span>):<br>    os.mkdir(<span>'Ctrl'</span>)<br>bdata = adata[adata.obs[<span>'type'</span>]==<span>'Ctrl'</span>].copy()<br>bdata.obs[<span>'celltype'</span>].to_csv(<span>'Ctrl/meta.csv'</span>)<br>xdata = sc.AnnData(bdata.to_df())<br>xdata.write_h5ad(<span>'Ctrl/count.h5ad'</span>, compression=<span>'gzip'</span>)</code></pre><pre><code><span># 按分组分别准备细胞类型marker基因用于分析</span><br><span>for</span> i <span>in</span> [<span>'Covid'</span>, <span>'Ctrl'</span>]:<br>    bdata = adata[adata.obs[<span>'type'</span>]==i].copy()<br>    sc.tl.rank_genes_groups(bdata, groupby=<span>'celltype'</span>, method=<span>'wilcoxon'</span>, pts=<span>True</span>)<br>    groups = bdata.uns[<span>'rank_genes_groups'</span>][<span>'names'</span>].dtype.names<br>    res2df = []<br>    <span>for</span> g <span>in</span> groups:<br>        df_temp = sc.get.rank_genes_groups_df(bdata, group=g)<br>        df_temp = df_temp.assign(celltype=g)<br>        res2df.append(df_temp)<br>    res2df = pd.concat(res2df, ignore_index=<span>True</span>)<br>    res2df = res2df[(res2df[<span>'logfoldchanges'</span>] &gt; <span>0.25</span>) &amp; (res2df[<span>'pvals_adj'</span>] &lt; <span>0.05</span>) &amp; (res2df[<span>'pct_nz_group'</span>] &gt; <span>0.1</span>)]<br>    res2df = res2df[[<span>'celltype'</span>, <span>'names'</span>]]<br>    res2df.to_csv(i+<span>"/deg.csv"</span>, index=<span>False</span>)</code></pre><h3>细胞互作分析</h3><pre><code>cpdb_file_path = os.path.join(projpath, <span>'Resource/cellphonedb/cellphonedb.zip'</span>)<br>cpdb_degs_analysis_method.call(<br>    cpdb_file_path=cpdb_file_path,<br>    meta_file_path=<span>'Covid/meta.csv'</span>,<br>    counts_file_path=<span>'Covid/count.h5ad'</span>,<br>    degs_file_path=<span>'Covid/deg.csv'</span>,<br>    counts_data=<span>'hgnc_symbol'</span>,<br>    score_interactions=<span>True</span>,<br>    output_path=<span>'Covid'</span>,<br>    output_suffix = <span>''</span>,<br>    threads=<span>6</span>)</code></pre><pre><code>cpdb_file_path = os.path.join(projpath, <span>'Resource/cellphonedb/cellphonedb.zip'</span>)<br>cpdb_degs_analysis_method.call(<br>    cpdb_file_path=cpdb_file_path,<br>    meta_file_path=<span>'Ctrl/meta.csv'</span>,<br>    counts_file_path=<span>'Ctrl/count.h5ad'</span>,<br>    degs_file_path=<span>'Ctrl/deg.csv'</span>,<br>    counts_data=<span>'hgnc_symbol'</span>,<br>    score_interactions=<span>True</span>,<br>    output_path=<span>'Ctrl'</span>,<br>    output_suffix = <span>''</span>,<br>    threads=<span>6</span>)</code></pre><h3>结果可视化</h3><p><span>注意：degs_analysis模式下一定要设置degs_analysis=True </span></p><pre><code>adata = sc.read_h5ad(<span>"Covid/count.h5ad"</span>)<br>meta = pd.read_csv(<span>"Covid/meta.csv"</span>, index_col=<span>0</span>)<br>adata.obs = meta<br>means = pd.read_csv(<span>"Covid/degs_analysis_means_.txt"</span>, sep=<span>"\t"</span>)<br>pvals = pd.read_csv(<span>"Covid/degs_analysis_relevant_interactions_.txt"</span>, sep=<span>"\t"</span>)</code></pre><pre><code><span># 热图</span><br>ax = kpy.plot_cpdb_heatmap(pvals=pvals, log1p_transform=<span>False</span>,<br>                           degs_analysis=<span>True</span>,<br>                           figsize=(<span>6</span>, <span>6</span>),<br>                           title=<span>"Sum of significant interactions"</span>)<br>ax.ax_heatmap.grid(<span>False</span>)<br>ax.figure.savefig(i+<span>"/sum_of_sig_cci.pdf"</span>)</code></pre><p><span></span></p><p><img data-imgfileid="100001966" data-ratio="1" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/VTXDic6Eia0AEO4HP8OHSxuPqEWdhJazDSyrkJOHTqfYwQIP4EVlYolGJaiaFQMXDkOgGmp6ibjaLPSeFPpyel8EGw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="939" src="https://mmbiz.qpic.cn/sz_mmbiz_png/VTXDic6Eia0AEO4HP8OHSxuPqEWdhJazDSyrkJOHTqfYwQIP4EVlYolGJaiaFQMXDkOgGmp6ibjaLPSeFPpyel8EGw/640?wx_fmt=png&amp;from=appmsg"></p><p><span></span></p><pre><code><span># 气泡图</span><br>g = kpy.plot_cpdb(<br>    adata=adata,<br>    cell_type1=<span>"."</span>,<br>    cell_type2=<span>"."</span>,<br>    means=means,<br>    pvals=pvals,<br>    degs_analysis=<span>True</span>,   <span>#注意此参数</span><br>    celltype_key=<span>"celltype"</span>,<br>    gene_family=[<span>"costimulatory"</span>],<br>    figsize=(<span>20</span>, <span>15</span>),<br>    max_size=<span>6</span>, <br>    highlight_size=<span>1</span>,<br>    title=<span>"interacting interactions!"</span>,<br>)<br>g.save(i+<span>"/cci_dotplot.pdf"</span>, limitsize=<span>False</span>)<br>g</code></pre><p><span></span></p><p><img data-imgfileid="100001967" data-ratio="0.75" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/VTXDic6Eia0AEO4HP8OHSxuPqEWdhJazDSgagjEA6cqI1VtPiadcGPFZQ9UHnSuS34rfqfCHQAcFwVMOEfibsUqkag/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/VTXDic6Eia0AEO4HP8OHSxuPqEWdhJazDSgagjEA6cqI1VtPiadcGPFZQ9UHnSuS34rfqfCHQAcFwVMOEfibsUqkag/640?wx_fmt=png&amp;from=appmsg"></p><p><span></span></p><p><br></p><pre><section><strong><span>交流合作</span></strong></section><section><strong><span>Kinesin专业从事单细胞与空转数据的分析与培训，有此需求的朋友欢迎加微信洽谈合作。本公众号交流群向</span></strong><span>科研院校师生和公司生信人员</span><strong><span>开放，希望入群的朋友也可加我微信申请。</span></strong></section><section><strong><span><br></span></strong></section><section><strong><span><br></span></strong></section><section><strong><span><img data-imgfileid="100001968" data-ratio="0.3194444444444444" data-src="https://mmbiz.qpic.cn/mmbiz_png/VTXDic6Eia0AGtAkJEKftUWtdPkZueleqBSVLS2GsSIKZHyGr0FWAu8nRuywTXiaGlZnCNNnicibR2vBlWI19trNoHQ/640?wx_fmt=other&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1&amp;tp=webp" data-type="png" data-w="1080" width="677px" src="https://mmbiz.qpic.cn/mmbiz_png/VTXDic6Eia0AGtAkJEKftUWtdPkZueleqBSVLS2GsSIKZHyGr0FWAu8nRuywTXiaGlZnCNNnicibR2vBlWI19trNoHQ/640?wx_fmt=other&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1&amp;tp=webp"></span></strong></section></pre><p><br></p><p><br></p><p><mp-style-type data-value="10000"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/c4AeOjnLm92SrUorz9OsVA",target="_blank" rel="noopener noreferrer">原文链接</a>
