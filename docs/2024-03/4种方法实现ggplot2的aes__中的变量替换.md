---
title: "4种方法实现ggplot2的aes()中的变量替换"
date: 2024-03-30T15:59:27Z
draft: ["false"]
tags: [
  "fetched",
  "小明的数据分析笔记本"
]
categories: ["Acdemic"]
---
4种方法实现ggplot2的aes()中的变量替换 by 小明的数据分析笔记本
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-mpa-powered-by="yiban.io"><h2 data-tool="mdnice编辑器"><span>介绍</span><span></span></h2><p data-tool="mdnice编辑器">ggplot2里<code>aes()</code>可以用tidyselect风格去选择变量做映射绘图，那么这种情况下如何实现<strong>「变量替换」</strong>呢？</p><p data-tool="mdnice编辑器">首先说下我为什么要实现<strong>「变量替换」</strong>。我目前实际的需求就是，分析代码+绘图代码篇幅太长，在封装流程的时候我想要把变量提到前面，通过替换一个变量来避免后面多次修改替换变量。</p><h2 data-tool="mdnice编辑器"><span></span><span>方法与演示</span><span></span></h2><p data-tool="mdnice编辑器">有<code>!!as.name()</code>、<code>get()</code>、<code>!!sym()</code>和<code>.data[[]]</code> 共计四种有效方法在<code>aes()</code>中实现变量替换。代码演示如下：</p><pre data-tool="mdnice编辑器"><span></span><code><span>library</span>(ggplot2)<br><br><span># 创建一个包含变量的数据框</span><br>data &lt;- data.frame(<br>  x = c(<span>1</span>, <span>2</span>, <span>3</span>, <span>4</span>),<br>  y = c(<span>10</span>, <span>20</span>, <span>30</span>, <span>40</span>),<br>  group = c(<span>"A"</span>, <span>"A"</span>, <span>"B"</span>, <span>"B"</span>)<br>)<br><br><span># 定义一个变量，用于替换图形属性</span><br>color_var &lt;- <span>"group"</span><br><br><span># 使用变量替换创建散点图</span><br>ggplot(data, aes(x = x, y = y, color = !!as.name(color_var))) +<br>  geom_point()<br>  <br>ggplot(data, aes(x = x, y = y, color = get(color_var))) +<br>  geom_point()<br><br><br>ggplot(data, aes(x = x, y = y, color = !!sym(color_var))) +<br>  geom_point()<br><br>ggplot(data, aes(x = x, y = y, color = .data[[color_var]])) +<br>  geom_point()<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.546526867627785" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/IjkuOxP0MdNiclbSMXN5oMApbWzJlfXyBlLsja5lbBmp8gpm8S2iaO5NIichibUrtxpMZguldPOINe9OyhSpkNibZ7Q/640?wx_fmt=png" data-type="png" data-w="763" src="https://mmbiz.qpic.cn/sz_mmbiz_png/IjkuOxP0MdNiclbSMXN5oMApbWzJlfXyBlLsja5lbBmp8gpm8S2iaO5NIichibUrtxpMZguldPOINe9OyhSpkNibZ7Q/640?wx_fmt=png"></figure><h2 data-tool="mdnice编辑器"><span></span><span>推荐阅读</span><span></span></h2><p><a href="https://mp.weixin.qq.com/s?__biz=Mzg5MjY1MTU4Ng==&amp;mid=2247486690&amp;idx=1&amp;sn=0c1c23a5d6aaec2eadb257444047375d&amp;chksm=c03b9dcff74c14d95782d67bdd3e6555f2c08dc27636e87f8e680ed6336706a52f2b2400e372&amp;token=1557781388&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">R脚本封装必备模板2——基础函数版</a></p><p><br></p><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=Mzg5MjY1MTU4Ng==&amp;mid=2247486563&amp;idx=1&amp;sn=1eb4dc6bd73deec0dcdf65b0fbc7ceb8&amp;chksm=c03b9d4ef74c14586dce511ede0e19a53e906dd05ec4fb7c6c9be876f94363e9fc270d941666&amp;scene=21#wechat_redirect" textvalue="R脚本封装必备模板——argparse版" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" pcked="1" hasload="1">R脚本封装必备模板——argparse版</a></p><p><br></p><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=Mzg5MjY1MTU4Ng==&amp;mid=2247486587&amp;idx=1&amp;sn=d5497df070783736e80324ffc43efacd&amp;chksm=c03b9d56f74c144073a396aa80fa899b433adf7256ae8c7168e853d6d7950023ebfc8ce4d205&amp;scene=21#wechat_redirect" textvalue="『视频版』R脚本封装必备模板——argparse版" linktype="text" imgurl="" imgdata="null" data-itemshowtype="5" tab="innerlink" data-linktype="2" pcked="1" hasload="1">『视频版』R脚本封装必备模板——argparse版</a></p><p><br></p><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=Mzg5MjY1MTU4Ng==&amp;mid=2247486658&amp;idx=1&amp;sn=1baa801ccd6e1d922a331a043da2c746&amp;chksm=c03b9deff74c14f95a4ecf0f80aab3efeaa9b073a6fd1742737b2137bfdeb5d78e531cdd49e2&amp;scene=21#wechat_redirect" textvalue="R语言处理与统计fastq文件" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1">R语言处理与统计fastq文件</a><br></p><p><br></p><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=Mzg5MjY1MTU4Ng==&amp;mid=2247486657&amp;idx=1&amp;sn=d82c8c8be7cb1cb552b964f4e8dbe6f8&amp;chksm=c03b9decf74c14fa74f19c0b8039bf7ca24efac9d4bc7ed4d2ec4b8dcd5ee5bdd2543783861e&amp;scene=21#wechat_redirect" textvalue="perl语言统计fastq文件GC含量与未知碱基N含量" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1">perl语言统计fastq文件GC含量与未知碱基N含量</a></p><p><br></p><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=Mzg5MjY1MTU4Ng==&amp;mid=2247486472&amp;idx=1&amp;sn=e8c84618a8e8909fcea2ed64f3be0a16&amp;chksm=c03b9d25f74c1433a867c3e8440e32dcceb483f1a3cd775815a6e23288e2b1d06e35bfe98e9b&amp;scene=21#wechat_redirect" textvalue="R包cli: 花式打印信息" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" pcked="1" hasload="1">R包cli: 花式打印信息</a><br></p><p><br></p><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=Mzg5MjY1MTU4Ng==&amp;mid=2247486585&amp;idx=1&amp;sn=d7c167218a91f300d1fbb327f04b0ea5&amp;chksm=c03b9d54f74c14426ddcb349783d161456aed1fe192a850bbd6c7c16ef22a2922b2a02d0d2dc&amp;scene=21#wechat_redirect" textvalue="R包prettyunits：获取易读的文件大小和时间间隔" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" pcked="1" hasload="1">R包prettyunits：获取易读的文件大小和时间间隔</a></p></section><p><br></p><p><br></p><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/G46JWP5bHzBJOeg3TmWDWA",target="_blank" rel="noopener noreferrer">原文链接</a>
