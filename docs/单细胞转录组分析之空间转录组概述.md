---
title: "单细胞转录组分析之空间转录组概述"
date: 2022-11-23T03:17:34Z
draft: ["false"]
tags: [
  "fetched",
  "医学僧的科研日记"
]
categories: ["Acdemic"]
---
单细胞转录组分析之空间转录组概述 by 医学僧的科研日记
------
<div><section><section>空间异质性是器官行使功能的关键特征，细胞的位置信息对细胞命运调控机制和细胞谱系发生过程的研究十分重要。单细胞转录组测序（ScRNA-seq）根据基因表达的相似性将细胞聚集在一起，那么聚在一起的细胞行使的功能是一样的吗？既然表达相似为什么同一类型的细胞在二维上的分布还是有一定距离？聚类模拟的分布和真实组织上的分布有什么关系？今天，让我们一起了解下单细胞转录组分析之空间转录组(ST)概述。</section><section><iframe data-vidtype="2" data-mpvid="wxv_2676165726902206467" data-cover="http%3A%2F%2Fmmbiz.qpic.cn%2Fmmbiz_jpg%2FeBfvI7Ryx8fEOhWV9ePoH6srsIfZYMQfmewrh5T7bJZm4XK0Mt8ZCemxdqEoSfxdNbRlLdq2KFlpnUpDH7gwKw%2F0%3Fwx_fmt%3Djpeg" allowfullscreen="" frameborder="0" data-ratio="1.7777777777777777" data-w="1920" data-src="https://mp.weixin.qq.com/mp/readtemplate?t=pages/video_player_tmpl&amp;action=mpvideo&amp;auto=0&amp;vid=wxv_2676165726902206467"></iframe></section><section powered-by="xiumi.us"><section><br></section></section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><section><svg viewbox="0 0 1 1"></svg></section></section></section></section><section><section powered-by="xiumi.us"><section><section><svg viewbox="0 0 1 1"></svg></section></section></section></section><section><section powered-by="xiumi.us"><section><section><svg viewbox="0 0 1 1"></svg></section></section></section></section><section><section powered-by="xiumi.us"><section><section><svg viewbox="0 0 1 1"></svg></section></section></section></section></section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><section><svg viewbox="0 0 1 1"></svg></section></section></section></section><section><section powered-by="xiumi.us"><section><section><svg viewbox="0 0 1 1"></svg></section></section></section></section></section></section></section></section></section><section><section powered-by="xiumi.us"><section><p><strong>1.什么是空间转录组测序？</strong></p></section></section></section></section><section powered-by="xiumi.us"><section><svg viewbox="0 0 1 1"></svg></section></section></section></section><section>什么是空间转录组？这里以市面上最流行的10X为例：将冰冻组织切片放置在10X Genomics Visium芯片的捕获区域内，进行HE染色和成像后，对组织切片进行透化处理，细胞内的mRNA释放出来，从而被芯片上带有oligo-dT的探针捕获，并且每个探针都带有特异的位置序列，然后以mRNA为模版进行cDNA合成，构建文库后再通过测序，获得基因表达信息的同时，每一条测序reads因带有位置序列，从而能够获得基因表达的位置信息。</section><section powered-by="xiumi.us"><section><img data-backh="241" data-backw="578" data-ratio="0.4169884" data-src="https://mmbiz.qpic.cn/mmbiz_png/eBfvI7Ryx8fEOhWV9ePoH6srsIfZYMQfLnWY0cOSQ363hXhfd4YZAnJsJpibEUkaXrr3LP7Xu8icSvYGwibjwdO5w/640?wx_fmt=png" data-type="png" data-w="1036" src="https://mmbiz.qpic.cn/mmbiz_png/eBfvI7Ryx8fEOhWV9ePoH6srsIfZYMQfLnWY0cOSQ363hXhfd4YZAnJsJpibEUkaXrr3LP7Xu8icSvYGwibjwdO5w/640?wx_fmt=png"></section></section><section>与ScRNA-seq相比的优缺点：ScRNA-seq将基因表达与单个细胞相关联，但关于这些基因在组织中的位置信息丢失了；相反的，ST知道基因表达的位置，却不知道是哪个细胞产生的。ScRNA-seq联合ST能起到1+1＞2的作用（超高分辨率+位置信息）</section><section powered-by="xiumi.us"><section><img data-backh="358" data-backw="578" data-ratio="0.6203704" data-src="https://mmbiz.qpic.cn/mmbiz_png/eBfvI7Ryx8fEOhWV9ePoH6srsIfZYMQfn9CNKXyjXMzTsmhIiaXeZnNpgjA5L7HE1pfbnDpXjUvrBCzUksVoRog/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/eBfvI7Ryx8fEOhWV9ePoH6srsIfZYMQfn9CNKXyjXMzTsmhIiaXeZnNpgjA5L7HE1pfbnDpXjUvrBCzUksVoRog/640?wx_fmt=png"></section></section><section>2022年目前一共242篇文章，其中&gt;30分26篇；&gt;20分37篇；&gt;10分104篇。也就是说，只要你做的是ScRNA-seq联合ST，你就有50%的概率发10分。</section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><section><svg viewbox="0 0 1 1"></svg></section></section></section></section><section><section powered-by="xiumi.us"><section><section><svg viewbox="0 0 1 1"></svg></section></section></section></section><section><section powered-by="xiumi.us"><section><section><svg viewbox="0 0 1 1"></svg></section></section></section></section><section><section powered-by="xiumi.us"><section><section><svg viewbox="0 0 1 1"></svg></section></section></section></section></section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><section><svg viewbox="0 0 1 1"></svg></section></section></section></section><section><section powered-by="xiumi.us"><section><section><svg viewbox="0 0 1 1"></svg></section></section></section></section></section></section></section></section></section><section><section powered-by="xiumi.us"><section><p><strong>2.文献中怎么用空间转录组？</strong></p></section></section></section></section><section powered-by="xiumi.us"><section><svg viewbox="0 0 1 1"></svg></section></section></section></section><p powered-by="xiumi.us"><strong>1.这是一篇刚发表于EBioMedicine上的食管鳞状细胞癌的ScRNA-seq+ST文章：</strong></p><section powered-by="xiumi.us"><section><img data-backh="148" data-backw="578" data-ratio="0.2564815" data-src="https://mmbiz.qpic.cn/mmbiz_png/eBfvI7Ryx8fEOhWV9ePoH6srsIfZYMQfriaAzyFuYBync9BQYt9CFGuEyYib00CmicaPXt9Xzib1SKcs44qiaBj93cQ/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/eBfvI7Ryx8fEOhWV9ePoH6srsIfZYMQfriaAzyFuYBync9BQYt9CFGuEyYib00CmicaPXt9Xzib1SKcs44qiaBj93cQ/640?wx_fmt=png"></section></section><section powered-by="xiumi.us"><section><img data-backh="374" data-backw="578" data-ratio="0.6472222" data-src="https://mmbiz.qpic.cn/mmbiz_png/eBfvI7Ryx8fEOhWV9ePoH6srsIfZYMQf45ctXNoUffcfZazuiaP02wk7wWGrxmE8OLzn50rTVDumTXrkFoM1bVg/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/eBfvI7Ryx8fEOhWV9ePoH6srsIfZYMQf45ctXNoUffcfZazuiaP02wk7wWGrxmE8OLzn50rTVDumTXrkFoM1bVg/640?wx_fmt=png"></section></section><section>基于3例ESCC样本，作者利用Multimodal intersection analysis (MIA)揭示了ESCC的TME中基质细胞的异质性。</section><section><strong>图2：</strong>ESCC肿瘤及基质的空间转录组分析。<strong>a-c：</strong>三个样本切片的HE染色。<strong>d-f：</strong>3个样本基于Spot聚类的结果。Spot数目2353(T1)、2849(T2) 和2896(T3) <span>&lt; ScRNA-seq</span>。<strong>g-i：</strong>使用MIA方法对两组方法注释亚群进行整合分析。数值越高，ST区域和ScRNA-seq亚群共享的高表达基因比例越大。对于每个ST区域，将其归类为最高值的细胞类型。<strong>j-l：</strong>根据MIA，将所有Spot分为肿瘤区和间质区。</section><p powered-by="xiumi.us"><br></p><p powered-by="xiumi.us"><strong>2.这是最近一篇EBioMedicine上的GBM的<span>公共数据库挖掘</span>文章：</strong></p><section powered-by="xiumi.us"><section><img data-backh="151" data-backw="578" data-ratio="0.2611111" data-src="https://mmbiz.qpic.cn/mmbiz_png/eBfvI7Ryx8fEOhWV9ePoH6srsIfZYMQfFySzpf2leayLelTkpRrGtxLahzwtIicc1EafOib2dNgaKCTZ7LqhhlKQ/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/eBfvI7Ryx8fEOhWV9ePoH6srsIfZYMQfFySzpf2leayLelTkpRrGtxLahzwtIicc1EafOib2dNgaKCTZ7LqhhlKQ/640?wx_fmt=png"></section></section><section powered-by="xiumi.us"><section><img data-backh="467" data-backw="578" data-ratio="0.8075773" data-src="https://mmbiz.qpic.cn/mmbiz_png/eBfvI7Ryx8fEOhWV9ePoH6srsIfZYMQfUHLgunxwRtjxMGbcekAnaTOZZzPd8h53ovEgr2L1Xu8ueWFvuw50Tw/640?wx_fmt=png" data-type="png" data-w="1003" src="https://mmbiz.qpic.cn/mmbiz_png/eBfvI7Ryx8fEOhWV9ePoH6srsIfZYMQfUHLgunxwRtjxMGbcekAnaTOZZzPd8h53ovEgr2L1Xu8ueWFvuw50Tw/640?wx_fmt=png"></section></section><section powered-by="xiumi.us"><section>GBM 可分为MES-like、AC-like、OPC-like、和NPC-like亚型。作者发现来源于巨噬细胞的GPNMB基因可通过免疫细胞-肿瘤细胞相互作用促进GBM proneural(PN)-mesenchymal(MES)亚型的转换。</section><section><strong>图3: </strong>PN- and MES-GBM的肿瘤微环境。<strong>e：</strong>ScRNA-seq定义的细胞类型特异性评分/基因的空间分布。</section><section><br></section></section><p powered-by="xiumi.us"><strong>3.这是2018年一篇发表于Cancer Research上的文章：</strong></p><section powered-by="xiumi.us"><section><img data-backh="148" data-backw="578" data-ratio="0.2564815" data-src="https://mmbiz.qpic.cn/mmbiz_png/eBfvI7Ryx8fEOhWV9ePoH6srsIfZYMQftIWxpad1uDjy4MT9r3ZTmksCCUsiabOox4N4Py0yAraIiaCWy0m6ibL4Q/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/eBfvI7Ryx8fEOhWV9ePoH6srsIfZYMQftIWxpad1uDjy4MT9r3ZTmksCCUsiabOox4N4Py0yAraIiaCWy0m6ibL4Q/640?wx_fmt=png"></section></section><section powered-by="xiumi.us"><section><img data-backh="400" data-backw="578" data-ratio="0.6925926" data-src="https://mmbiz.qpic.cn/mmbiz_png/eBfvI7Ryx8fEOhWV9ePoH6srsIfZYMQfcw5QusP5pQcFYCK43ZsibROaGR6icicwic7Z0GdpMQIvBBlxyqJfqhibIicA/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/eBfvI7Ryx8fEOhWV9ePoH6srsIfZYMQfcw5QusP5pQcFYCK43ZsibROaGR6icicwic7Z0GdpMQIvBBlxyqJfqhibIicA/640?wx_fmt=png"></section></section><section>这是篇18年的，比较老，作者测了4个Stage III期恶性黑色素瘤患者转移的淋巴结，使用ST技术生成的基因表达谱揭示了黑色素瘤淋巴结转移的空间异质性。<br></section><section powered-by="xiumi.us"><section><img data-backh="297" data-backw="578" data-ratio="0.5138889" data-src="https://mmbiz.qpic.cn/mmbiz_png/eBfvI7Ryx8fEOhWV9ePoH6srsIfZYMQfibNvZqJmzZlKeVTKN3lib6Z0ib1WHDyqNk8Ans1MDoFr946hl6ibial8b3g/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/eBfvI7Ryx8fEOhWV9ePoH6srsIfZYMQfibNvZqJmzZlKeVTKN3lib6Z0ib1WHDyqNk8Ans1MDoFr946hl6ibial8b3g/640?wx_fmt=png"></section></section><section><strong>图4：</strong>单个切片的PCA和空间热图。<strong>A：</strong>具有病理注释信息的HE染色图像。<strong>B：</strong>在组织结构域上进行的PCA产生了四个簇。以病理注释为参照，<strong>簇1</strong>对应于黑色素瘤区域周围的基质或淋巴组织；<strong>簇2</strong>明确代表黑色素瘤区域。<strong>簇3</strong>包括淋巴和肿瘤组织之间边界区域的组织结构域，可能包含来自这两种组织类型的细胞混合物。<strong>簇4</strong>代表与癌症区域物理分离的淋巴组织。<strong>C：</strong>PCA显示这4个簇显著分离。</section><section><br></section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><section><svg viewbox="0 0 1 1"></svg></section></section></section></section><section><section powered-by="xiumi.us"><section><section><svg viewbox="0 0 1 1"></svg></section></section></section></section><section><section powered-by="xiumi.us"><section><section><svg viewbox="0 0 1 1"></svg></section></section></section></section><section><section powered-by="xiumi.us"><section><section><svg viewbox="0 0 1 1"></svg></section></section></section></section></section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><section><svg viewbox="0 0 1 1"></svg></section></section></section></section><section><section powered-by="xiumi.us"><section><section><svg viewbox="0 0 1 1"></svg></section></section></section></section></section></section></section></section></section><section><section powered-by="xiumi.us"><section><p><strong>3.该如何进行ST分析？</strong></p></section></section></section></section><section powered-by="xiumi.us"><section><svg viewbox="0 0 1 1"></svg></section></section></section></section><section>根据编码方法的不同，单细胞空间转录组可以分为以下几大类。</section><section powered-by="xiumi.us"><section><img data-backh="502" data-backw="578" data-ratio="0.8675926" data-src="https://mmbiz.qpic.cn/mmbiz_png/eBfvI7Ryx8fEOhWV9ePoH6srsIfZYMQfgQXLoAQuU8wFHicickXnqlQHECxOJQ1gunAQicOI4PtxFcJeXHU6NmicxA/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/eBfvI7Ryx8fEOhWV9ePoH6srsIfZYMQfgQXLoAQuU8wFHicickXnqlQHECxOJQ1gunAQicOI4PtxFcJeXHU6NmicxA/640?wx_fmt=png"></section></section><section><strong>图：</strong>单细胞空间转录组流程图。下边以Seurat提供的10X空间转录组分析流程为例，简单介绍下空间转录组的简单应用：</section><section><br></section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><section><section powered-by="xiumi.us"><section><section><section powered-by="xiumi.us"><section><svg viewbox="0 0 1 1"></svg></section></section><section powered-by="xiumi.us"><section><svg viewbox="0 0 1 1"></svg></section></section></section></section></section></section></section></section></section></section></section><section><section powered-by="xiumi.us"><section><p><strong>1.基于Seurat的10X空间转录组分析流程</strong></p></section></section></section></section></section></section><section powered-by="xiumi.us"><section>10X Genomics Visium作为市面上流行的空间转录组技术，目前还达不到单细胞分辨率，一个Spot捕获1~10个细胞，其判断的是每个Spot中的细胞平均下来更像那种细胞，或者说那种细胞占主导，暂时无法精准判断单个细胞类型。</section><section>利用ScRNA-seq提供的单细胞分辨率的细胞亚群，结合ST提供的组织水平的HE染色信息，可以对ScRNA-seq鉴定的细胞亚群进行修正，也能补充不同亚群之间的位置信息。</section><section>基于Seurat的10X空间转录组分析流程完全可以达到获取ScRNA-seq每个细胞亚群之间位置信息的需求，详情请浏览官方教程：https://satijalab.org/seurat/articles/spatial_vignette.html。这里简单放一些关键代码：</section><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="php"><code><span><span>#详见Seurat提供的10X空间转录组分析流程</span></span></code><code><span><span>#https://satijalab.org/seurat/articles/spatial_vignette.html</span></span></code><code><span><span>#非常详细，强烈建议做ST的小伙伴们仔细研读</span></span></code><code><span>rm(<span>list</span> = ls())</span></code><code><span>library(Seurat)</span></code><code><span>library(SeuratData)</span></code><code><span>library(ggplot2)</span></code><code><span>library(patchwork)</span></code><code><span>library(dplyr)</span></code><code><span><br></span></code><code><span><span>#1.数据预处理</span></span></code><code><span>InstallData(<span>"stxBrain"</span>)</span></code><code><span>brain &lt;- LoadData(<span>"stxBrain"</span>, type = <span>"anterior1"</span>)</span></code><code><span><br></span></code><code><span>plot1 &lt;- VlnPlot(brain, features = <span>"nCount_Spatial"</span>, pt.size = <span>0.1</span>) + NoLegend()</span></code><code><span>plot2 &lt;- SpatialFeaturePlot(brain, features = <span>"nCount_Spatial"</span>) + theme(legend.position = <span>"right"</span>)</span></code><code><span>wrap_plots(plot1, plot2)</span></code><code><span><br></span></code><code><span>brain &lt;- SCTransform(brain, assay = <span>"Spatial"</span>, verbose = <span>FALSE</span>)</span></code><code><span>brain &lt;- SCTransform(brain, assay = <span>"Spatial"</span>, verbose = <span>FALSE</span>)</span></code><code><span><span>#替代方案，sctransform构建了基因表达的正则化负二项式模型，以便在保留生物学差异的同时考虑技术伪像。</span></span></code><code><span><span>#sctransform可以对数据进行归一化，检测高变异特征并将数据存储在SCT中。</span></span></code><code><span><br></span></code><code><span><span>#2.基因表达可视化</span></span></code><code><span>SpatialFeaturePlot(brain, features = c(<span>"Hpca"</span>, <span>"Ttr"</span>))</span></code><code><span><span>#在此小鼠大脑数据集中，基因Hpca是强海马标志物，而Ttr是脉络丛的标志物。</span></span></code><code><span>p1 &lt;- SpatialFeaturePlot(brain, features = <span>"Ttr"</span>, pt.size.factor = <span>1</span>)</span></code><code><span>p2 &lt;- SpatialFeaturePlot(brain, features = <span>"Ttr"</span>, alpha = c(<span>0.1</span>, <span>1</span>))</span></code><code><span>p1 + p2</span></code><code><span><br></span></code><code><span><span>#3.降维，聚类和可视化</span></span></code><code><span><span>#我们可以使用与ScRNA-seq相同的工作流程，对RNA表达数据进行降维和聚类。</span></span></code><code><span>brain &lt;- RunPCA(brain, assay = <span>"SCT"</span>, verbose = <span>FALSE</span>)</span></code><code><span>brain &lt;- FindNeighbors(brain, reduction = <span>"pca"</span>, dims = <span>1</span>:<span>30</span>)</span></code><code><span>brain &lt;- FindClusters(brain, verbose = <span>FALSE</span>)</span></code><code><span>brain &lt;- RunUMAP(brain, reduction = <span>"pca"</span>, dims = <span>1</span>:<span>30</span>)</span></code><code><span><br></span></code><code><span><span>#之后使用UMAP可视化聚类的结果，或者使用覆盖可视化图像上的聚类结果SpatialDimPlot()</span></span></code><code><span>p1 &lt;- DimPlot(brain, reduction = <span>"umap"</span>, label = <span>TRUE</span>)</span></code><code><span>p2 &lt;- SpatialDimPlot(brain, label = <span>TRUE</span>, label.size = <span>3</span>)</span></code><code><span>p1 + p2</span></code><code><span><br></span></code><code><span><span>#cells.highlight参数可以划分特定的单元格</span></span></code><code><span>SpatialDimPlot(brain,cells.highlight = CellsByIdentities(object = brain,idents = </span></code><code><span>          c(<span>2</span>,<span>1</span>,<span>4</span>,<span>3</span>,<span>5</span>,<span>8</span>)), facet.highlight = <span>TRUE</span>, ncol = <span>3</span>)</span></code><code><span><br></span></code><code><span><span>#4.交互式绘图</span></span></code><code><span>SpatialDimPlot(brain, interactive = <span>TRUE</span>)</span></code><code><span>SpatialFeaturePlot(brain, features = <span>"Ttr"</span>, interactive = <span>TRUE</span>)</span></code><code><span>LinkedDimPlot(brain)</span></code><code><span><span>#很神奇，可以调整感兴趣的点，大家可以尝试下</span></span></code><code><span><br></span></code><code><span><span>#5.识别空间可变特征</span></span></code><code><span>de_markers &lt;- FindMarkers(brain, ident<span>.1</span> = <span>5</span>, ident<span>.2</span> = <span>6</span>)</span></code><code><span>SpatialFeaturePlot(object = brain, features = rownames(de_markers)[<span>1</span>:<span>3</span>], alpha = c(<span>0.1</span>, <span>1</span>), ncol = <span>3</span>)</span></code><code><span><br></span></code><code><span>brain &lt;- FindSpatiallyVariableFeatures(brain, assay = <span>"SCT"</span>, features = VariableFeatures(brain)[<span>1</span>:<span>1000</span>],</span></code><code><span>                                       selection.method = <span>"markvariogram"</span>)</span></code><code><span><span>#可视化此前确定的前6个特征基因的表达</span></span></code><code><span>top.features &lt;- head(SpatiallyVariableFeatures(brain, selection.method = <span>"markvariogram"</span>), <span>6</span>)</span></code><code><span>SpatialFeaturePlot(brain, features = top.features, ncol = <span>3</span>, alpha = c(<span>0.1</span>, <span>1</span>))</span></code><code><span><br></span></code><code><span><span>#6.细分解剖区域</span></span></code><code><span>cortex &lt;- subset(brain, idents = c(<span>1</span>, <span>2</span>, <span>3</span>, <span>4</span>, <span>6</span>, <span>7</span>))</span></code><code><span>cortex &lt;- subset(cortex, anterior1_imagerow &gt; <span>400</span> | anterior1_imagecol &lt; <span>150</span>, invert = <span>TRUE</span>)</span></code><code><span>cortex &lt;- subset(cortex, anterior1_imagerow &gt; <span>275</span> &amp; anterior1_imagecol &gt; <span>370</span>, invert = <span>TRUE</span>)</span></code><code><span>cortex &lt;- subset(cortex, anterior1_imagerow &gt; <span>250</span> &amp; anterior1_imagecol &gt; <span>440</span>, invert = <span>TRUE</span>)</span></code><code><span><br></span></code><code><span>p1 &lt;- SpatialDimPlot(cortex, crop = <span>TRUE</span>, label = <span>TRUE</span>)</span></code><code><span>p2 &lt;- SpatialDimPlot(cortex, crop = <span>FALSE</span>, label = <span>TRUE</span>, pt.size.factor = <span>1</span>, label.size = <span>3</span>)</span></code><code><span>p1 + p2</span></code><code><span><br></span></code><code><span><span>#7.与单细胞数据集成</span></span></code><code><span>allen_reference &lt;- readRDS(<span>"../data/allen_cortex.rds"</span>)</span></code><code><span>library(dplyr)</span></code><code><span>allen_reference &lt;- SCTransform(allen_reference, ncells = <span>3000</span>, verbose = <span>FALSE</span>) %&gt;%</span></code><code><span>  RunPCA(verbose = <span>FALSE</span>) %&gt;%</span></code><code><span>  RunUMAP(dims = <span>1</span>:<span>30</span>)</span></code><code><span><br></span></code><code><span>cortex &lt;- SCTransform(cortex, assay = <span>"Spatial"</span>, verbose = <span>FALSE</span>) %&gt;%</span></code><code><span>  RunPCA(verbose = <span>FALSE</span>)</span></code><code><span>DimPlot(allen_reference, group.by = <span>"subclass"</span>, label = <span>TRUE</span>)</span></code><code><span><span>#这是ScRNA-seq的细胞注释图</span></span></code><code><span><br></span></code><code><span>anchors &lt;- FindTransferAnchors(reference = allen_reference, query = cortex, normalization.method = <span>"SCT"</span>)</span></code><code><span>predictions.assay &lt;- TransferData(anchorset = anchors, refdata = allen_reference$subclass, prediction.assay = <span>TRUE</span>,</span></code><code><span>                                  weight.reduction = cortex[[<span>"pca"</span>]], dims = <span>1</span>:<span>30</span>)</span></code><code><span>cortex[[<span>"predictions"</span>]] &lt;- predictions.assay</span></code><code><span><span>#获得每个聚类在每个Spots的预测分数</span></span></code><code><span><br></span></code><code><span>DefaultAssay(cortex) &lt;- <span>"predictions"</span></span></code><code><span>SpatialFeaturePlot(cortex, features = c(<span>"L2/3 IT"</span>, <span>"L4"</span>), pt.size.factor = <span>1.6</span>, ncol = <span>2</span>, crop = <span>TRUE</span>)</span></code><code><span><span>#基于这些预测分数，可以预测空间的细胞类型</span></span></code><code><span><br></span></code><code><span>cortex &lt;- FindSpatiallyVariableFeatures(cortex, assay = <span>"predictions"</span>, selection.method = <span>"markvariogram"</span>,</span></code><code><span>                                        features = rownames(cortex), r.metric = <span>5</span>, slot = <span>"data"</span>)</span></code><code><span>top.clusters &lt;- head(SpatiallyVariableFeatures(cortex), <span>4</span>)</span></code><code><span>SpatialPlot(object = cortex, features = top.clusters, ncol = <span>2</span>)</span></code><code><span><br></span></code><code><span><span>#最后，通过这一套整合程序能够恢复神经元和非神经元子集的已知空间定位模式</span></span></code><code><span>SpatialFeaturePlot(cortex, features = c(<span>"Astro"</span>, <span>"L2/3 IT"</span>, <span>"L4"</span>, <span>"L5 PT"</span>, <span>"L5 IT"</span>, <span>"L6 CT"</span>, <span>"L6 IT"</span>,</span></code><code><span>                                        <span>"L6b"</span>, <span>"Oligo"</span>), pt.size.factor = <span>1</span>, ncol = <span>2</span>, crop = <span>FALSE</span>, alpha = c(<span>0.1</span>, <span>1</span>))</span></code></pre></section><section><br></section></section><section powered-by="xiumi.us"><section><img data-backh="276" data-backw="578" data-ratio="0.4777778" data-src="https://mmbiz.qpic.cn/mmbiz_png/eBfvI7Ryx8fEOhWV9ePoH6srsIfZYMQfasObhiaVdHv4w0VhWHV3js3GNrOX8CYeUJ4Uuoj0PfFbmrssBfhvBew/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/eBfvI7Ryx8fEOhWV9ePoH6srsIfZYMQfasObhiaVdHv4w0VhWHV3js3GNrOX8CYeUJ4Uuoj0PfFbmrssBfhvBew/640?wx_fmt=png"></section></section><section powered-by="xiumi.us"><section><img data-backh="288" data-backw="578" data-ratio="0.4994097" data-src="https://mmbiz.qpic.cn/mmbiz_png/eBfvI7Ryx8fEOhWV9ePoH6srsIfZYMQfRNDKRNCdAIm1Lcuprxsxj72Paib6Id8XhLtBtrCiaFu6OqZmK7WjJ8ibg/640?wx_fmt=png" data-type="png" data-w="847" src="https://mmbiz.qpic.cn/mmbiz_png/eBfvI7Ryx8fEOhWV9ePoH6srsIfZYMQfRNDKRNCdAIm1Lcuprxsxj72Paib6Id8XhLtBtrCiaFu6OqZmK7WjJ8ibg/640?wx_fmt=png"></section></section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><section><svg viewbox="0 0 1 1"></svg></section></section></section></section><section><section powered-by="xiumi.us"><section><section><svg viewbox="0 0 1 1"></svg></section></section></section></section><section><section powered-by="xiumi.us"><section><section><svg viewbox="0 0 1 1"></svg></section></section></section></section><section><section powered-by="xiumi.us"><section><section><svg viewbox="0 0 1 1"></svg></section></section></section></section></section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><section><svg viewbox="0 0 1 1"></svg></section></section></section></section><section><section powered-by="xiumi.us"><section><section><svg viewbox="0 0 1 1"></svg></section></section></section></section></section></section></section></section></section></section><section powered-by="xiumi.us"><section><svg viewbox="0 0 1 1"></svg></section></section></section><section><section powered-by="xiumi.us"><section><p><strong>小结</strong></p></section></section></section></section><section powered-by="xiumi.us"><section>总的来说，单细胞空间转录组分析就是使用带有空间Barcode的探针对切片进行测序，联合ScRNA-seq可以实现将高分辨率单细胞数据得到的细胞亚群映射到空间上来，进而推断不同亚群的功能、分化关系等。</section><section>单细胞空间转录组是继细胞通讯、CNV推断、轨迹分析外经常使用的单细胞下游分析，ScRNA-seq联合ST能为文章增光添彩，感兴趣的小伙伴可以现学现用，立刻就能增加到你的研究中来！</section><p><br></p><p><strong>本文主要参考：</strong></p><ol><li><p>Analysis, visualization, and integration of spatial datasets with Seurat • Seurat；</p></li><li><p>简书-从单细胞到空间转录组，生物医学进入新时代</p></li></ol><p><br></p><p><strong>PS:我们在B站的同名账号“医学僧的科研日记”同步有公众号的讲解视频~目前已有10w余粉丝，感兴趣的小伙伴可以多多支持幺。</strong></p><p><img data-backh="578" data-backw="578" data-ratio="1" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/eBfvI7Ryx8fEOhWV9ePoH6srsIfZYMQfiaqzVCHPiaEbMXfyhdiaLh56FYjiaibZPfTRkMws36CjEgSD2S8S45jYZoQ/640?wx_fmt=jpeg" data-type="jpeg" data-w="960" src="https://mmbiz.qpic.cn/mmbiz_jpg/eBfvI7Ryx8fEOhWV9ePoH6srsIfZYMQfiaqzVCHPiaEbMXfyhdiaLh56FYjiaibZPfTRkMws36CjEgSD2S8S45jYZoQ/640?wx_fmt=jpeg"><strong></strong></p></section><section><span>医学僧的心</span><span>愿是为医学僧的支持者和科研</span><span>爱好者营造一个勤学好问、互帮互助、共同进步的优良环境。</span><span>但是人多了难免鱼龙混杂，良莠不齐，群里不乏有真心实意、脚踏实地的科研人，我们很尊重并欢迎他们，因此不希望被少数来发广告的、划水的、看热闹的、占个坑的所打扰，最终我们的心意付之东流，大家的热情消磨殆尽。</span><span>为了解决这个问题，我们决定提高入群的门槛——</span><strong>收费进群，</strong><span>这样，愿意进群的同志相信也是个圈内活跃用户，圈内人相互交流，岂不快哉！</span></section><section powered-by="xiumi.us"><section>因此，为了提升大家的效率，调动大家的积极性，吸收真正的科研爱好者，形成一个良好的学习交流氛围，我们决定增加群的数量，并细化群的功能，暂时增加以下几个主题群：</section><ul><li><p>文献下载-医学僧</p></li><li><p>机器学习（分类）-医学僧</p></li><li><p>ggplot可视化-医学僧</p></li><li><p>热图可视化-医学僧</p></li><li><p>TCGA挖掘-医学僧</p></li><li><p>GEO挖掘-医学僧</p></li><li><p>肿瘤预后模型-医学僧</p></li><li><p>肿瘤分子亚型-医学僧</p></li></ul><p>欢迎小伙伴们进群👏👏👏，每个群收费<strong>15元</strong>。请联系小编微信yixuesengkyrj或扫描下面二维码：</p></section><p><img data-backh="486" data-backw="578" data-ratio="0.8407407407407408" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/eBfvI7Ryx8eToe4Nt4XyydFdvqEM0WohEpzTSD45q9Xib8zpEq7kGgVBYh9AMdPvXJNOZAVz3MgrRJAKKfzxIWQ/640?wx_fmt=jpegwxfrom=5wx_lazy=1wx_co=1" data-type="jpegwxfrom=5wx_lazy=1wx_co=1" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_jpg/eBfvI7Ryx8eToe4Nt4XyydFdvqEM0WohEpzTSD45q9Xib8zpEq7kGgVBYh9AMdPvXJNOZAVz3MgrRJAKKfzxIWQ/640?wx_fmt=jpegwxfrom=5wx_lazy=1wx_co=1"></p></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/lYnUfF97cRxAvwaUkHNGMw",target="_blank" rel="noopener noreferrer">原文链接</a>
