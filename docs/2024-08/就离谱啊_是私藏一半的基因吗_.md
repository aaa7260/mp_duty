---
title: "就离谱啊，是私藏一半的基因吗？"
date: 2024-08-16T07:07:24Z
draft: ["false"]
tags: [
  "fetched",
  "生信技能树"
]
categories: ["Acdemic"]
---
就离谱啊，是私藏一半的基因吗？ by 生信技能树
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><p data-tool="mdnice编辑器">看到朋友圈好多人转发了一个最新的胃癌单细胞研究，数据集是GSE239676，在GEO界面可以看到如下所示的文件：</p><pre data-tool="mdnice编辑器"><span></span><code>5.4M Aug 15 23:21 GSE239676_barcodes.tsv.gz<br>939M Aug 15 23:26 GSE239676_count_matrix.mtx.gz<br>53K Aug 15 23:32 GSE239676_features.tsv.gz<br>5.5M Aug 15 23:21 GSE239676_meta.tsv.gz<br></code></pre><blockquote data-tool="mdnice编辑器"><span></span><p>2024年8月1日，美国德克萨斯大学王凌华、Jaffer A. Ajani、Pawel K. Mazur、中国科学院基础医学与肿瘤研究所覃江江共同通讯在Gastroenterology（IF25.7）在线发表了题为“Atlas of metastatic gastric cancer links ferroptosis to disease progression and immunotherapy response”的论文，研究揭示了转移性胃癌的细胞和分子机制，并提出了一种靶向铁死亡防御机制联合CAR-T细胞疗法的治疗策略。</p></blockquote><p data-tool="mdnice编辑器">可以看到，作者给出来的降维聚类分群的结果还不错：</p><p><img data-galleryid="" data-imgfileid="100048999" data-ratio="0.41944444444444445" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wwR0nQ1CtiaqmB14J2BMbE3CDro2ElgqqJao6v1NoMg70v3oiaLVibcMKA0iafwvHmctedqsClka6vFag/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wwR0nQ1CtiaqmB14J2BMbE3CDro2ElgqqJao6v1NoMg70v3oiaLVibcMKA0iafwvHmctedqsClka6vFag/640?wx_fmt=png&amp;from=appmsg"></p><figure data-tool="mdnice编辑器"><figcaption>降维聚类分群</figcaption></figure><p data-tool="mdnice编辑器">但是我自己在跑上面的代码的时候就发现了一个小瑕疵，如下所示，根据上面的基因很容易给出来各个单细胞亚群的名字，包括CD4和CD8的T细胞，髓系免疫细胞，上皮细胞，b细胞和浆细胞，甚至还有树突细胞：</p><p><img data-galleryid="" data-imgfileid="100049000" data-ratio="1.1777777777777778" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wwR0nQ1CtiaqmB14J2BMbE3CZib3GKiaEH8E6otOoAvibcHNpZRjZfO6AZfDXBo73RX2AQfTenMhKlibAg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wwR0nQ1CtiaqmB14J2BMbE3CZib3GKiaEH8E6otOoAvibcHNpZRjZfO6AZfDXBo73RX2AQfTenMhKlibAg/640?wx_fmt=png&amp;from=appmsg"></p><figure data-tool="mdnice编辑器"><figcaption> </figcaption></figure><p data-tool="mdnice编辑器">但是stromal就好奇怪，刚开始以为是分辨率的问题。本来呢，基质细胞主要包括以下几种类型：</p><ol data-tool="mdnice编辑器"><li><section><strong>成纤维细胞（Fibroblasts）</strong>：在肿瘤微环境中，成纤维细胞可以分化为癌症相关成纤维细胞（Cancer-Associated Fibroblasts, CAFs），它们通过分泌多种细胞因子和细胞外基质（ECM）成分，促进肿瘤的发展和转移。</section></li><li><section><strong>内皮细胞（Endothelial Cells）</strong>：内皮细胞在肿瘤血管生成中起到关键作用，它们可以形成新的血管，为肿瘤提供氧气和营养。</section></li><li><section><strong>平滑肌细胞（Smooth Muscle Cells, SMCs）</strong>：在某些情况下，平滑肌细胞也存在于肿瘤微环境中，尤其是在血管结构中。</section></li><li><section><strong>周细胞（Pericytes）</strong>：周细胞是血管壁的一部分，它们与内皮细胞相互作用，参与血管的稳定和成熟。</section></li></ol><p data-tool="mdnice编辑器">其中内皮细胞主要是区分成为了淋巴内皮和血管内皮， 其中血管可以细分为动脉静脉和毛细血管：</p><ul data-tool="mdnice编辑器"><li><section>lymphatic ECs (LECs; <em>CCL21, PROX1</em>).</section></li><li><section>arteries (<em>HEY1, IGFBP3</em>), capillaries (<em>CD36, CA4</em>), veins (<em>ACKR1</em>)</section></li></ul><p data-tool="mdnice编辑器">但是LUM和DCN等基因居然是缺失的，导致我如下所示的代码就失效了；</p><pre data-tool="mdnice编辑器"><span></span><code><span>library</span>(ggplot2) <br>genes_to_check =list(<br>  CM=c(<span>"TTN"</span>,<span>"MYH7"</span>,<span>"MYH6"</span>,<span>"TNNT2"</span>) ,<br>  EC=c(<span>"VWF"</span>, <span>"IFI27"</span>, <span>"PECAM1"</span>,<span>"MGP"</span>),<br>  FB=c(<span>"DCN"</span>, <span>"C7"</span> ,<span>"LUM"</span>,<span>"FBLN1"</span>,<span>"COL1A2"</span>),<br>  MP=c(<span>"CD163"</span>, <span>"CCL4"</span>, <span>"CXCL8"</span>,<span>"PTPRC"</span>),<br>  SMC=c(<span>"ACTA2"</span>, <span>"CALD1"</span>, <span>"MYH11"</span>),<br>  Tc=c(<span>"CD3D"</span>,<span>"CD3E"</span>),<br>  peric=c(<span>"ABCC9"</span>,<span>"PDGFRB"</span>,<span>"RGS5"</span>)<br>)<br>genes_to_check = lapply(genes_to_check,<span>function</span>(x){<br>  unique( c(str_to_title(x),str_to_upper(x)))<br>} )<br>p_all_markers=DotPlot(sce.all.int, <br>                      features = genes_to_check,<br>                      group.by = <span>'RNA_snn_res.0.1'</span>,<br>                      scale = <span>T</span>,assay=<span>'RNA'</span> ) +<br>  theme(axis.text.x=element_text(angle=<span>45</span>,hjust = <span>1</span>))<br>p_all_markers<br></code></pre><p data-tool="mdnice编辑器">这个时候我就明白了其实是表达量矩阵文件的问题，居然是 8630个基因，然后是 222240个细胞 。正常情况下， 有两三万个基因才对啊！大家可以自己下载这些文件走一下我们的标准的降维聚类分群，就明白了；</p><pre data-tool="mdnice编辑器"><span></span><code><span>if</span>(<span>T</span>){<br>  <span>library</span>(data.table)<br>  <span>library</span>(Matrix) <br>  <span># https://hbctraining.github.io/scRNA-seq/lessons/readMM_loadData.html</span><br>  <span># </span><br>  mtx=readMM( <span>"inputs/GSE239676_count_matrix.mtx.gz"</span> )<br>  mtx[<span>1</span>:<span>4</span>,<span>1</span>:<span>4</span>]<br>  dim(mtx)<br>  <br>  cl=fread( <span>"inputs/GSE239676_barcodes.tsv.gz"</span>   ,<br>            header = <span>F</span>,data.table = <span>F</span> ) <br>  head(cl)<br>  <br>  rl=fread(  <span>"inputs/GSE239676_features.tsv.gz"</span> ,<br>             header = <span>F</span>,data.table = <span>F</span> ) <br>  head(rl)<br>  dim(rl)<br>  dim(mtx)<br>   <br>  colnames(mtx)=cl$V1<br>  rownames(mtx)=rl$V1<br>  mtx[<span>1</span>:<span>4</span>,<span>1</span>:<span>4</span>]<br>  dim(mtx)<br>  <br>  meta=fread( <span>"inputs/GSE239676_meta.tsv.gz"</span>   ,<br>            header = <span>T</span>,data.table = <span>F</span> ) <br>  head(meta)<br>  rownames(meta)=colnames(mtx)<br>  <br>  <span>library</span>(Seurat)<br>  sce.all=CreateSeuratObject(counts =  mtx , <br>                             meta.data = meta,<br>                             min.cells = <span>5</span>,<br>                             min.features = <span>300</span> )<br>  as.data.frame(sce.all@assays$RNA$counts[<span>1</span>:<span>10</span>, <span>1</span>:<span>2</span>])<br>  head(sce.all@meta.data, <span>10</span>)<br>  table(sce.all$orig.ident)<br>  <br>}<br></code></pre><p data-tool="mdnice编辑器">这些年陆陆续续处理了一两千个单细胞转录组公共数据集了，总是会碰到一些缺胳膊断腿的。有一些数据集，比如GSE233447就完全不给任何基因名字，详见：<a href="https://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247524679&amp;idx=1&amp;sn=727ad30d48fa0c97448978774f524da1&amp;scene=21#wechat_redirect" data-linktype="2">细胞名字可以不给但是基因名字不能不要啊</a>。而这个<strong>美国德克萨斯大学王凌华老师的新鲜出炉的胃癌单细胞给一半的基因的表达量矩阵，这个操作也是有一点点迷惑。。。</strong></p><p data-tool="mdnice编辑器">看起来也是需要去下载fastq文件然后自己走cellranger流程啊：https://www.ncbi.nlm.nih.gov/bioproject/PRJNA1000548，<span><strong>但是作者并没有上传fastq文件，哈哈哈：</strong></span></p><p><img data-galleryid="" data-imgfileid="100049002" data-ratio="0.6564814814814814" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wwR0nQ1CtiaqmB14J2BMbE3Cmp2HBoECxxIxJztnJ4qPELfPnsCxWfBBQHqNvE7lYGuFxWiaia6AEruQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wwR0nQ1CtiaqmB14J2BMbE3Cmp2HBoECxxIxJztnJ4qPELfPnsCxWfBBQHqNvE7lYGuFxWiaia6AEruQ/640?wx_fmt=png&amp;from=appmsg"></p></section><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><h3 data-tool="mdnice编辑器"><span>写在文末</span></h3></section><p>如果你也想做单细胞转录组数据分析，<span>最好是有自己的计算机资源哦，比如我们的</span><a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247528363&amp;idx=1&amp;sn=5e02f3e9b2e148191e23ebc2c0d780e7&amp;scene=21#wechat_redirect" data-linktype="2">2024的共享服务器交个朋友福利价仍然是800</a><span>，而且还需要有基本的生物信息学基础，也可以看看我们的</span><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247531929&amp;idx=1&amp;sn=f6f16b7bf6b907360d6d0052e3d10cf6&amp;chksm=9b4b3d22ac3cb434b6aa7753a4cf0f266578147ccf10b49cc834e46af578ee6de99be0accb30&amp;scene=21#wechat_redirect" textvalue="生物信息学马拉‍松授课（买一得五）" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1">生物信息学马拉松授课（买一得五）</a><span> ，你的生物信息学入门课。当然了，八月份比较特殊的是：<a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzUzMTEwODk0Ng==&amp;mid=2247526317&amp;idx=1&amp;sn=b6fef7bcd40fa18db974aa3d36656c20&amp;chksm=fa45a290cd322b86afc3676b1a715a734782956a9e37d40b978ef54d51c9cd47facb9f356e53&amp;scene=21#wechat_redirect" textvalue="单细胞数据挖掘线下培训（南京站）" linktype="text" imgurl="" imgdata="null" data-itemshowtype="11" tab="innerlink" data-linktype="2" hasload="1">单细胞数据挖掘线下培训（南京站）</a>，下周六日我们可以线下授课，惊喜不！ </span><span></span></p><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/e6xHIIy7cJKusp3ibw30Pg",target="_blank" rel="noopener noreferrer">原文链接</a>
