---
title: "生信数据分析可靠与否是一个伪命题"
date: 2024-08-01T03:51:24Z
draft: ["false"]
tags: [
  "fetched",
  "生信技能树"
]
categories: ["Acdemic"]
---
生信数据分析可靠与否是一个伪命题 by 生信技能树
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><blockquote data-tool="mdnice编辑器"><span></span><p>多种场合我都是高举生物信息学数据分析的靠谱的大旗，详见前面的推文：<a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247531754&amp;idx=1&amp;sn=ff623aeaa38c148eb7280a1c45a3e0c5&amp;scene=21#wechat_redirect" data-linktype="2">离大谱了，生信转湿实验？</a>。仍然每次跟网友们的讨论的结局都是一地鸡毛，大家总会是把生物信息学数据分析跟常见的临床数据挖掘预后模型那些水文混为一谈。</p></blockquote><p data-tool="mdnice编辑器">最简单的一个生物信息学数据分析案例，可以是针对一个表达量矩阵以及里面的样品分组进行差异分析，然后拿到统计学显著的上下调基因列表，因为基因数量很多，所以我们默认会做一些生物学功能数据库注释。这里面的生物信息学算法就差异分析和注释算法， 它本身是非常可靠的！</p><p data-tool="mdnice编辑器">数据分析有错是基本上不可能的，基本上都是新手才会翻车，比如表达量矩阵的格式，是否取多次log会影响变化倍数这个指标，以及上下调弄反的，而且这些错误很容易检验，不存在实验室和地理位置特异性。抛开这个不谈，但确实是有很多人对这个结果的解读是有误的， 比如几十个到几百个基因进行生物学功能数据库注释后有十几个通路，其中选择那个作为后续分析的指导确实是有主观层面的误差。</p><p data-tool="mdnice编辑器">真正不靠谱的地方在于表达量矩阵产出这个实验阶段，你完全是没办法想象不同的实验室不同操作人员会引入多少误差。另外一个值得商榷的地方就是人类知识库的残缺，这个是泛生命科学领域的大bug，不能怪我们生物信息学数据分析。</p><p data-tool="mdnice编辑器">比如前两天我们的马拉松授课交流群就有学员提到了他在复现一个中山大学的昼夜节律相关数据挖掘文章的时候出现了源头的背景知识冲突。文章是：《Circadian rhythm-related genes index: A predictor for HNSCC prognosis, immunotherapy efficacy, and chemosensitivity》，首先是一个简单的TCGA数据库的头颈癌的差异分析（502 HNSCC samples and 44 normal samples from the TCGA- HNSCC dataset），然后拿这个差异分析的上下调基因集合去跟circadian rhythm-related genes (CRRGs) 基因列表进行取交集操作。在文章的附件给出来了这个 SUPPLEMENTARY TABLE 1，是  1424 CRRGs were obtained through Genecards database.</p><h3 data-tool="mdnice编辑器"><span></span><span>昼夜节律相关基因列表到底是什么</span><span></span></h3><p data-tool="mdnice编辑器">文献里面的昼夜节律相关基因列表获取，方法学是：We obtained Circadian rhythm-associated 1424 genes by Genecards (https://www.genecards.org/) (Supplementary Table 1) ，我们下载该列表后简单的看看；</p><pre data-tool="mdnice编辑器"><span></span><code>rm(list = ls()) <br>CRGs_gene = rio::import(<span>'./Table_1_Circadian rhythm-related genes index A predictor for HNSCC prognosis, immunotherapy efficacy, and chemosensitivity.xlsx'</span>)<br>head(CRGs_gene)<br>CRGs_gene = unique(CRGs_gene[,<span>1</span>])<br>save(CRGs_gene,file = <span>'gene_from_genecards.Rdata'</span>)<br></code></pre><p data-tool="mdnice编辑器">从Genecards数据库获取昼夜节律相关基因列表，就是一个简单的关键词搜索即可，然后基因会按照搜索关键词的相关性排序，卡一个阈值即可：</p><pre data-tool="mdnice编辑器"><span></span><code>&gt; head(CRGs_gene)                                                      <br>  Gene Symbol                                         Description<br>1       CLOCK                           Clock Circadian Regulator<br>2        PER2                        Period Circadian Regulator 2<br>3        PER3                        Period Circadian Regulator 3<br>4        PER1                        Period Circadian Regulator 1<br>5        CRY1                  Cryptochrome Circadian Regulator 1<br>6       ARNTL Aryl Hydrocarbon Receptor Nuclear Translocator Like<br>&gt; dim(CRGs_gene)<br>[1] 1424    7<br></code></pre><p data-tool="mdnice编辑器">但是如果大家简单的搜索，就可以看到华中科技大学的一个在线数据库“《Circadian Gene DataBase》”，发表在<em>Nucleic Acids Res.</em> 2017:，CGDB: a database of circadian genes in eukaryotes.，可以很简单的从这个课题组的整理好的数据库里面拿到昼夜节律相关基因列表 ，因为网页里面的人类的昼夜节律相关基因列表是以蛋白质序列方式给出来的，所以需要简单的转换 ：</p><pre data-tool="mdnice编辑器"><span></span><code>rm(list = ls()) <br><span># # download.file(url = 'http://cgdb.biocuckoo.org/download/all/Homo%20sapiens%20(Human).txt',</span><br><span># #               destfile = 'CRGs_gene.txt')</span><br><span># </span><br>CRGs_gene = readLines(<span>'CRGs_gene.txt'</span>)<br>CRGs_gene = CRGs_gene[grepl(<span>'&gt;'</span>,CRGs_gene)]<br>CRGs_gene = stringr::str_split(CRGs_gene,<span>'\\|'</span>,simplify = <span>T</span>)[,<span>2</span>]<br>head(CRGs_gene)<br>tail(CRGs_gene)<br><br>ens_crgs = CRGs_gene[grepl(<span>'^ENSP'</span>,CRGs_gene)]<br>uniport_crge = CRGs_gene[!CRGs_gene %<span>in</span>% ens_crgs]<br>ens_crgs = stringr::str_split(ens_crgs,<span>'\\.'</span>,simplify = <span>T</span>)[,<span>1</span>]<br><br><span>#gene转换为symbol</span><br><span>library</span>(clusterProfiler)<br><span>library</span>(org.Hs.eg.db)<br>keytypes(org.Hs.eg.db)<br>ens_crgs2 = bitr(ens_crgs,<br>                 fromType = <span>'ENSEMBLPROT'</span>,<br>                 toType = <span>'SYMBOL'</span>,<br>                 OrgDb = <span>'org.Hs.eg.db'</span>)<br><span>#  76.63% of input gene IDs are fail to map...</span><br>uniport_crge2 = bitr(uniport_crge,<br>                 fromType = <span>'UNIPROT'</span>,<br>                 toType = <span>'SYMBOL'</span>,<br>                 OrgDb = <span>'org.Hs.eg.db'</span>)<br><span># 14.03% of input gene IDs are fail to map...</span><br><br>CRGs_gene = unique(c(ens_crgs2$SYMBOL,uniport_crge2$SYMBOL))<br>head(CRGs_gene)<br>save(CRGs_gene,file = <span>'gene_from_cgdb.Rdata'</span>)<br> <br></code></pre><p data-tool="mdnice编辑器">接下来就可以看看这两个来源的昼夜节律相关基因列表的交集如何了：</p><pre data-tool="mdnice编辑器"><span></span><code>rm(list = ls()) <br>load(file = <span>'gene_from_genecards.Rdata'</span>)<br>genecards=CRGs_gene<br>load(file = <span>'gene_from_cgdb.Rdata'</span>)<br>cgdb=CRGs_gene <br>genes&lt;- list(genecards = genecards,<br>             cgdb = cgdb ) <span>#输入数据需要是</span><br><span>#设定颜色：长度要与list内容长度一致（这里提供备选了几种）</span><br>colors&lt;- c(<span>"#2874C5"</span>, <span>"#f87669"</span>, <span>"#e6b707"</span>, <span>"#868686"</span>, <span>"#92C5DE"</span>, <span>"#F4A582"</span>, <span>"#66C2A5"</span>, <span>"#FC8D62"</span>, <span>"#8DA0CB"</span>, <br>           <span>"#E78AC3"</span>, <span>"#A6D854"</span>, <span>"#FFD92F"</span>, <span>"#E5C494"</span>, <span>"#B3B3B3"</span>) [<span>1</span>:length(lengths(genes))] <br>p = VennDiagram::venn.diagram(x = genes,<br>                              filename = <span>NULL</span>, <span>#不生成文件（还是必写参数，烦）</span><br>                              fill = colors, <span>#设定颜色(长度要与分组数相等)</span><br>                              cat.col = colors, cat.cex = <span>1.5</span>, <span>#标签颜色，字体大小</span><br>                              col = colors, <span>#边框颜色</span><br>                              alpha = <span>0.1</span> <span>#调整透明度</span><br>) <br>grid::grid.draw(p)<br><span>library</span>(ggplot2)<br><span>#转换为ggplot对象</span><br>p&lt;- ggplotify::as.ggplot(cowplot::as_grob(p))<br>p<br>ggsave(p,file = <span>'./Venn.jpg'</span>) <br><br>int=intersect(genecards,cgdb)<br>symbols_list = list(<br>  int=int,<br>  only_genecards=setdiff(genecards,int),<br>  only_cgdb=setdiff(cgdb,int)<br>)<br>lapply(symbols_list, length)<br></code></pre><p data-tool="mdnice编辑器">可以看到，两者之间的交集居然是就各自的十分之一不到：</p><pre data-tool="mdnice编辑器"><span></span><code><span>$int</span><br>[1] 166<br><br><span>$only_genecards</span><br>[1] 1258<br><br><span>$only_cgdb</span><br>[1] 1105<br><br>&gt; lapply(symbols_list, head)<br><span>$int</span><br>[1] <span>"PER2"</span>  <span>"PER3"</span>  <span>"PER1"</span>  <span>"CRY1"</span>  <span>"CRY2"</span>  <span>"NPAS2"</span><br><br><span>$only_genecards</span><br>[1] <span>"CLOCK"</span>    <span>"ARNTL"</span>    <span>"TIMELESS"</span> <span>"ARNTL2"</span>   <span>"CIPC"</span>     <span>"CSNK1D"</span>  <br><br><span>$only_cgdb</span><br>[1] <span>"ZNF251"</span>   <span>"C1orf54"</span>  <span>"MGAM"</span>     <span>"KIR2DL5B"</span> <span>"KIR2DS1"</span>  <span>"H2BC6"</span> <br></code></pre><p data-tool="mdnice编辑器">在各个癌症里面的做昼夜节律相关基因相关预后模型的数据挖掘文章非常多，做乳酸化，线粒体，衰老相关基因列表就更多了。如果大家根本就不是从同一个基因列表开始，那凭什么保证这些数据挖掘文章的可靠性和合理性呢？</p><p data-tool="mdnice编辑器">这些基因简单的kegg数据库 注释：</p><pre data-tool="mdnice编辑器"><span></span><code><span>library</span>(clusterProfiler)<br><span>library</span>(org.Hs.eg.db)<br><span>library</span>(ReactomePA)<br><span>library</span>(ggplot2)<br><span>library</span>(stringr) <br><span># 首先全部的symbol 需要转为 entrezID</span><br>gcSample = lapply(symbols_list, <span>function</span>(y){ <br>  y=as.character(na.omit(AnnotationDbi::select(org.Hs.eg.db,<br>                                               keys = y,<br>                                               columns = <span>'ENTREZID'</span>,<br>                                               keytype = <span>'SYMBOL'</span>)[,<span>2</span>])<br>  )<br>  y<br>})<br>gcSample<br>pro=<span>'test'</span><br><span># 第1个注释是 KEGG </span><br>xx &lt;- compareCluster(gcSample, fun=<span>"enrichKEGG"</span>,<br>                     organism=<span>"hsa"</span>, pvalueCutoff=<span>0.3</span>)<br>dotplot(xx)  + theme(axis.text.x=element_text(angle=<span>45</span>,hjust = <span>1</span>)) + <br>  scale_y_discrete(labels=<span>function</span>(x) str_wrap(x, width=<span>50</span>)) <br>ggsave(paste0(pro,<span>'_kegg.pdf'</span>),width = <span>10</span>,height = <span>8</span>)<br><br></code></pre><p data-tool="mdnice编辑器">也很难下结论，感觉就是不同来源的数据库确实是需要有benchmark了，这个也是大量的生物信息学课题了：</p><p><img data-galleryid="" data-imgfileid="100048545" data-ratio="0.5472222222222223" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wwQT5948a38TibiaBx6BG5PNCrBFOE0tfVSb0EwXZSaiciaglVdz1njqnLnpIVXo4XV2OojtxzoGicM45Q/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wwQT5948a38TibiaBx6BG5PNCrBFOE0tfVSb0EwXZSaiciaglVdz1njqnLnpIVXo4XV2OojtxzoGicM45Q/640?wx_fmt=png&amp;from=appmsg"></p><figure data-tool="mdnice编辑器"><figcaption>不同来源的数据库确实是需要有benchmark了</figcaption></figure><p data-tool="mdnice编辑器">比如大家如果是想在各个癌症里面的做转录因子相关基因相关预后模型的数据挖掘文章，就需要明确人类的两万多个蛋白质编码基因里面到底是哪些基因是转录因子呢？大概有1500到2000个转录因子基因，但是具体是什么，又是有不同来源的数据库了。比如在生信菜鸟团公众号看到了有一个介绍：<a href="https://mp.weixin.qq.com/s?__biz=MzUzMTEwODk0Ng==&amp;mid=2247506156&amp;idx=1&amp;sn=e7357f1ce51d51ea3c6c496d8dbd6c6f&amp;scene=21#wechat_redirect" data-linktype="2">TCGA数据挖掘常见基因集合</a>，首先是Cancer Manag Res. 2020的文章《Prognostic and Predictive Value of a 15 Transcription Factors (TFs) Panel for Hepatocellular Carcinoma》就提到了：</p><ul data-tool="mdnice编辑器"><li><section>The TF list was downloaded from the Human Transcription Factors website (http://humantfs.ccbr.utoronto.ca/.</section></li></ul><p data-tool="mdnice编辑器">然后是2021的文章《A Transcription Factor-Based Risk Model for Predicting the Prognosis of Prostate Cancer and Potential Therapeutic Drugs》提到一个出处：</p><ul data-tool="mdnice编辑器"><li><section>Atotal of 1665 transcription factors were obtained from the Animal TFDB database。（AnimalTFDB 3.0 ），链接：http://bioinfo.life.hust.edu.cn/AnimalTFDB/#!/</section></li></ul><p data-tool="mdnice编辑器">这两个数据库关于转录因子的收录，都是接近于2000个基因。然后是刘小乐的Cistrome数据库，详见：http://cistrome.org/db/#/stat</p><p data-tool="mdnice编辑器">我下载里面的 human_factor_full_QC.txt 文件，然后统计了一下，在人类这个研究领域，有chip-seq数据的转录因子是1359个，略低于上面的两个网页数据库里面的1600~2000的数量。</p><p data-tool="mdnice编辑器">还有 RcisTarget包里面的motifAnnotations_hgnc数据，也有自己的转录因子基因合辑。</p><p data-tool="mdnice编辑器">如果做各个癌症里面的做转录因子相关基因相关预后模型的数据挖掘文章之前压根就没有了解过什么是转录因子，没有读下面的这两个综述文章：</p><ul data-tool="mdnice编辑器"><li><section>首先是2018的CELL文章：《The Human Transcription Factors》</section></li><li><section>然后是2020的NBT文章：《A comprehensive library of human transcription factors for cell fate  engineering》</section></li></ul><p data-tool="mdnice编辑器">做出来的数据挖掘文章又价值几何呢？</p><h3 data-tool="mdnice编辑器"><span></span><span>不同算法的一致性呢</span><span></span></h3><p data-tool="mdnice编辑器"><span><strong>数据源头的质量问题，以及人类知识数据库的不完善，都是会影响生物信息学数据分析结果的，但是这些是目前很难完全责怪生物信息学本身，反而是算法的多样性往往是生物信息学被人诟病的一个点了</strong></span>。比如之前我们介绍过<a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247526904&amp;idx=1&amp;sn=4ea4c4289217c8ba815354370813540a&amp;scene=21#wechat_redirect" data-linktype="2">irGSEA：基于秩次的单细胞基因集富集分析整合框架</a>，针对<strong>17种常见的Functional Class Scoring (FCS)方法</strong>进行了benchmark。</p><p data-tool="mdnice编辑器">单细胞转录组数据分析最基础的就是给每个细胞一个身份，通常是降维聚类分群后然后对每个亚群进行描述，首先可以描述每个亚群的高表达量的特异性基因，然后可以对基因进行生物学功能数据库注释。也可以直接对亚群进行打分，比如gsea和gsva算法，针对免疫或者代谢等基因集进行打分，也是拿到每个亚群的特异性生物学功能。如果选择了不同打分算法，往往是拿到了不同结果，有时候确实是很难解释。</p><h3 data-tool="mdnice编辑器"><span></span><span>未解之谜很正常</span><span></span></h3><p data-tool="mdnice编辑器">很多人对生物信息学数据处理的另外一个误解是，它应该是有百分百的确定性的的分析结果。其实也不是，比如不同单细胞转录组数据集的降维聚类分群其实都会有 热激蛋白的亚群，细胞增殖亚群，干扰素亚群，金属离子酶亚群，线粒体或者核糖体亚群，或者低质量亚群。。。但是每个数据分析人员在处理这些细胞状态的变化的时候都有自己的人为干预。</p><p data-tool="mdnice编辑器">当然了，<strong>这个其实又是归咎到了人类知识数据库的不完善，本来就暂时还没有定论，关于细胞类型和细胞状态的讨论一直在持续</strong>：</p><ul data-tool="mdnice编辑器"><li><section>1.通俗地说，细胞类型是体内执行特定功能的一类细胞。通常细胞类型被认为是相对稳定的，就像皮肤中的细胞不会自发地变成神经元。</section></li><li><section>2.我们现在知道细胞实际上具有很强的可塑性，虽然皮肤细胞自然不会变为神经元，但可以通过特殊处理诱导它们变形为神经元。</section></li><li><section>3.此外细胞确实相对频繁地切换其功能，淋巴结中的T细胞可以“激活”以对抗感染，我们可以称这种瞬态细胞状态为新的“细胞类型”吗？</section></li><li><section>4.最后，还有如何处理患病细胞的问题，不再能够执行神经元功能的神经元仍然是神经元吗？“患病”神经元有自己的细胞类型定义吗？我们用什么标准来确定细胞是否“患病”？</section></li></ul><p data-tool="mdnice编辑器">感兴趣的可以仔细品读：https://mbernste.github.io/posts/cell_types_cell_states/</p></section><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><h3 data-tool="mdnice编辑器"><span>写在文末</span></h3></section><p>如果你也想做单细胞转录组数据分析，<span>最好是有自己的计算机资源哦，比如我们的</span><a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247528363&amp;idx=1&amp;sn=5e02f3e9b2e148191e23ebc2c0d780e7&amp;scene=21#wechat_redirect" data-linktype="2">2024的共享服务器交个朋友福利价仍然是800</a><span>，而且还需要有基本的生物信息学基础，也可以看看我们的</span><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247531929&amp;idx=1&amp;sn=f6f16b7bf6b907360d6d0052e3d10cf6&amp;chksm=9b4b3d22ac3cb434b6aa7753a4cf0f266578147ccf10b49cc834e46af578ee6de99be0accb30&amp;scene=21#wechat_redirect" textvalue="生物信息学马拉‍松授课（买一得五）" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1">生物信息学马拉松授课（买一得五）</a><span> ，你的生物信息学入门课。</span></p><p><br></p><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/j7F9R8SwcD7-eqSt5xnV9Q",target="_blank" rel="noopener noreferrer">原文链接</a>
