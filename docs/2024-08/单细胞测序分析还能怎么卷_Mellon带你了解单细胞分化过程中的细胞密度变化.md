---
title: "单细胞测序分析还能怎么卷？Mellon带你了解单细胞分化过程中的细胞密度变化"
date: 2024-08-29T10:28:37Z
draft: ["false"]
tags: [
  "fetched",
  "生信滩"
]
categories: ["Acdemic"]
---
单细胞测序分析还能怎么卷？Mellon带你了解单细胞分化过程中的细胞密度变化 by 生信滩
------
<div><p><img data-galleryid="" data-imgfileid="100008014" data-ratio="0.2222222222222222" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/YHGRXkSxjSRvhAzztUiaKYKYRIqQEWXNoxXibsZRcJjicibDicCibYA7y5icMRcZgx2SdN2kLyRrksNrj1aFrfQFcB9sw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/YHGRXkSxjSRvhAzztUiaKYKYRIqQEWXNoxXibsZRcJjicibDicCibYA7y5icMRcZgx2SdN2kLyRrksNrj1aFrfQFcB9sw/640?wx_fmt=png&amp;from=appmsg"></p><section><span><strong><span>前言</span></strong><strong><span><p></p></span></strong></span></section><section><span><span>大海哥在群里看到小伙伴们对于生信分析到底还能不能发SCI讨论的热火朝天！很多小伙伴们@大海哥，想听听大海哥的想法！传统的老套路想发SCI实在是太难了。怎样才能脱离生信内卷赛道发表SCI呢？对于大多数的临床医生来说，生信分析很难再算法上进行创，那还有什么办法呢？那就是卷工作量、卷新的分析方法！今天大海哥带着大家来看看单细胞测序分析还能怎么卷？</span>Mellon带你了解单细胞分化过程中的细胞密度变化，为指导生物轨迹的机制提供见解的潜力。小伙伴们快来学习一下，看看如何应用到自己的分析中充实工作量呢！<p></p></span></section><section><span><span>练了十年生信分析的大海哥对于生信分析知识已经如鱼得水，相信有大海哥的加持一定能让大家学会！没有时间学习且有生信分析的小伙伴们快来滴滴大海哥噢！从分析到可视化直到你满意为止！</span></span></section><section><section><section><section><section><p><img data-imgfileid="100011016" data-ratio="0.9973474801061007" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/YHGRXkSxjSQicw3pkyJwFjNBuDYsZOL0kg45dSicgiaibBKJ3sbCq5IqXgFt7c9DmuucV9s07LXWFIoyBPufribs2ibA/640?wx_fmt=png" data-type="png" data-w="377" src="https://mmbiz.qpic.cn/mmbiz_png/YHGRXkSxjSQicw3pkyJwFjNBuDYsZOL0kg45dSicgiaibBKJ3sbCq5IqXgFt7c9DmuucV9s07LXWFIoyBPufribs2ibA/640?wx_fmt=png"></p><section><br></section></section><section><section><section><p>定制生信分析<br></p><p>云服务器租赁</p><p>（加微信<span>备注99</span>领取使用）</p><p><br></p></section></section></section></section></section></section></section><p><br></p><section><span><span></span><span><p></p></span></span></section><section><span><span>大海哥在这里给大家送福利了，有需要服务器的小伙伴们，欢迎大家后台私信大海哥哦，保证服务器的性价比最高哦！</span></span></section><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><p><br></p></section></section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><p>公众号后台回复<span>“SXT”</span>领取本篇代码、基因集或示例数据等文件；</p><p><span><em><strong>文件编号：240824</strong></em></span></p><p><strong><span>大海哥送福利</span></strong><span><strong>：生信人必备神器——服务器</strong></span><br></p><p>平时生信分析学习中有要的小伙伴可以联系大海哥租赁，粉丝福利都是市场超低价格，赶快找大海哥领取免费的试用账号吧！</p></section></section></section></section></section></section><section><span><span></span><span><p></p></span></span></section><section><span><strong><span>代码教程</span></strong><strong><span><p></p></span></strong></span></section><section><span>本教程<span>提供了在单细胞</span> RNA 测序 （scRNA-seq） 数据上应用Mellon密度估计器的指南。本教程的目的是说明使用 Mellon 软件包执行密度估计所需的步骤。<p></p></span></section><section><span><span>在开始之前，请确保安装了以下必备软件包，这些软件包对于将</span> Mellon 与 scRNA-seq 数据结合使用至关重要：<p></p></span></section><section><span><span>l</span><span>scanpy： </span></span><span>https://scanpy.readthedocs.io/en/stable/installation.html</span><span>（大海哥已经带着大家学习过了哦）<p></p></span></section><section><span><span>l</span><span>palantir： </span></span><span>https://github.com/dpeerlab/Palantir</span><span>.我们建议使用pip install git+https://github.com/dpeerlab/Palantir<p></p></span></section><section><span><strong><span>1.加载相应的包</span></strong><strong><span><p></p></span></strong></span></section><section><span><strong><span></span></strong></span></section><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="swift"><code><span><span>import</span> numpy as np</span></code><code><span><span>import</span> matplotlib</span></code><code><span><span>import</span> matplotlib.pyplot as plt</span></code><code><span>from sklearn.cluster <span>import</span> k_means</span></code><code><span><span>import</span> palantir</span></code><code><span><span>import</span> mellon</span></code><code><span><span>import</span> scanpy as sc</span></code><code><span><span>import</span> warnings</span></code><code><span>from numba.core.errors <span>import</span> NumbaDeprecationWarning</span></code><code><span>warnings.simplefilter(<span>"ignore"</span>, category=<span>NumbaDeprecationWarning</span>)</span></code><code><span>%matplotlib inline</span></code><code><span>matplotlib.rcParams[<span>"figure.figsize"</span>] = [<span>4</span>, <span>4</span>]</span></code><code><span>matplotlib.rcParams[<span>"figure.dpi"</span>] = <span>125</span></span></code><code><span>matplotlib.rcParams[<span>"image.cmap"</span>] = <span>"Spectral_r"</span></span></code><code><span># no bounding boxes or axis:</span></code><code><span>matplotlib.rcParams[<span>"axes.spines.bottom"</span>] = <span>"on"</span></span></code><code><span>matplotlib.rcParams[<span>"axes.spines.top"</span>] = <span>"off"</span></span></code><code><span>matplotlib.rcParams[<span>"axes.spines.left"</span>] = <span>"on"</span></span></code><code><span>matplotlib.rcParams[<span>"axes.spines.right"</span>] = <span>"off"</span></span></code></pre></section><section><span><span><p></p></span></span></section><section><span><strong><span>2. 读取和显示数据集</span></strong><strong><span><p></p></span></strong></span></section><section><span>我们将从加载 scRNA-seq 数据集开始。我们将使用预处理的 T 细胞耗竭骨髓数据。<p></p></span></section><section><span><span></span></span></section><section><ul><li><li><li><li></ul><pre data-lang="makefile"><code><span>ad_url = <span>"https://fh-pi-setty-m-eco-public.s3.amazonaws.com/mellon-tutorial/preprocessed_t-cell-depleted-bm-rna.h5ad"</span></span></code><code><span>ad = sc.read(<span>"data/preprocessed_t-cell-depleted-bm-rna.h5ad"</span>, backup_url=ad_url)</span></code><code><span>ad</span></code><code><span>sc.pl.scatter(ad, basis=<span>"umap"</span>, color=<span>"celltype"</span>)</span></code></pre></section><section><span><p></p></span></section><section><span> </span></section><p><img data-galleryid="" data-imgfileid="100011017" data-ratio="0.5652680652680653" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/YHGRXkSxjSRg3iaZWr8S3qIRnm63l3113yA3jZrN4yU78UaYiaicqaLheXnIC9QGXQ4pTd3YiatJC1cUpxDnnT6Hyw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="858" src="https://mmbiz.qpic.cn/mmbiz_png/YHGRXkSxjSRg3iaZWr8S3qIRnm63l3113yA3jZrN4yU78UaYiaicqaLheXnIC9QGXQ4pTd3YiatJC1cUpxDnnT6Hyw/640?wx_fmt=png&amp;from=appmsg"></p><section><span><strong><span>3. 预处理</span></strong><strong><span><p></p></span></strong></span></section><section><span>我们将使用扩散图作为细胞状态表示的输入作为 Mellon 的输入。扩散图通过创建保持细胞<span>之间关系的降维表示来捕获数据的固有几何形状。可以使用该函数计算扩散图。默认情况下，此函数使用预先计算的函数，但可以更改为使用</span> anndata 对象中的任何条目。<p></p></span></section><section><span></span></section><section><ul><li><li></ul><pre data-lang="makefile"><code><span>%%time</span></code><code><span>dm_res = palantir.utils.run_diffusion_maps(ad, pca_key=<span>"X_pca"</span>, n_components=20)</span></code></pre></section><section><span><p></p></span></section><section><span><strong><span>4. 密度计算</span></strong><strong><span><p></p></span></strong></span></section><section><span>在此步骤中，我们将使用 Mellon 的 DensityEstimator 类计算细胞状态密度。上面计算的扩散分量用作输入。可以使用UMAP可视化计算密度。<p></p></span></section><section><span></span></section><section><ul><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="makefile"><code><span>%%time</span></code><code><span>model = mellon.DensityEstimator()</span></code><code><span>log_density = model.fit_predict(ad.obsm[<span>"DM_EigenVectors"</span>])</span></code><code><span>predictor = model.predict</span></code><code><span>ad.obs[<span>"mellon_log_density"</span>] = log_density</span></code><code><span>ad.obs[<span>"mellon_log_density_clipped"</span>] = np.clip(</span></code><code><span>log_density, *np.quantile(log_density, [0.05, 1])</span></code><code><span>)</span></code><code><span>ad</span></code><code><span>sc.pl.scatter(</span></code><code><span>ad, color=[<span>"mellon_log_density"</span>, <span>"mellon_log_density_clipped"</span>], basis=<span>"umap"</span></span></code><code><span>)</span></code></pre></section><section><span><p></p></span></section><section><span> </span></section><p><img data-galleryid="" data-imgfileid="100011018" data-ratio="0.47783251231527096" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/YHGRXkSxjSRg3iaZWr8S3qIRnm63l3113AKcFn119Gia0EXqrXhs9ymUP3fHoBkKkj8QT2ibtibnvOian0860JQCia4g/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1015" src="https://mmbiz.qpic.cn/mmbiz_png/YHGRXkSxjSRg3iaZWr8S3qIRnm63l3113AKcFn119Gia0EXqrXhs9ymUP3fHoBkKkj8QT2ibtibnvOian0860JQCia4g/640?wx_fmt=png&amp;from=appmsg"></p><section><span><strong><span>5.分析细胞类型</span></strong><strong><span><p></p></span></strong></span></section><section><span>接下来，我们可以使用计算出的细胞密度来分析数据集中的不同细胞类型。<p></p></span></section><section><span></span></section><section><ul><li><li><li><li></ul><pre data-lang="php"><code><span>fig, (ax1, ax2) = plt.subplots(<span>1</span>, <span>2</span>, width_ratios=[<span>3</span>, <span>2</span>], figsize=[<span>12</span>, <span>4</span>])</span></code><code><span>sc.pl.violin(ad, <span>"mellon_log_density"</span>, <span>"celltype"</span>, rotation=<span>45</span>, ax=ax1, show=<span>False</span>)</span></code><code><span>sc.pl.scatter(ad, color=<span>"celltype"</span>, basis=<span>"umap"</span>, ax=ax2, show=<span>False</span>)</span></code><code><span>plt.show()</span></code></pre></section><section><span><p></p></span></section><p><img data-galleryid="" data-imgfileid="100011019" data-ratio="0.3287037037037037" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/YHGRXkSxjSRg3iaZWr8S3qIRnm63l3113594r5K9RibiaZj8jw2f06KLkQBCVD1jHV5Ez9odoQNudcheLDIF2dmPw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/YHGRXkSxjSRg3iaZWr8S3qIRnm63l3113594r5K9RibiaZj8jw2f06KLkQBCVD1jHV5Ez9odoQNudcheLDIF2dmPw/640?wx_fmt=png&amp;from=appmsg"></p><section><span> </span></section><section><span></span></section><section><ul><li><li><li><li><li><li><li></ul><pre data-lang="makefile"><code><span><span>#沿伪时间的密度比较</span></span></code><code><span><span>##密度可以与伪时间轴或其他轴进行比较，以识别高密度和低密度区域。</span></span></code><code><span>ad.obs[<span>"palantir_pseudotime"</span>], ad.obsm[<span>"palantir_lineage_cells"</span>]</span></code><code><span><span>##我们将探索沿 B 细胞谱系的密度</span></span></code><code><span>bcell_lineage_cells = ad.obs_names[ad.obsm[<span>"palantir_lineage_cells"</span>][<span>"NaiveB"</span>]]</span></code><code><span>palantir.plot.highlight_cells_on_umap(ad, bcell_lineage_cells)</span></code><code><span>plt.show()</span></code></pre></section><section><span><p></p></span></section><section><span> </span></section><p><img data-galleryid="" data-imgfileid="100011021" data-ratio="0.9951456310679612" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/YHGRXkSxjSRg3iaZWr8S3qIRnm63l3113kIHZY56ricsYkJucn4C6nrAQ9kNfuY6FMhKcRZ2LasxM44qBxfd3k2A/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="412" src="https://mmbiz.qpic.cn/mmbiz_png/YHGRXkSxjSRg3iaZWr8S3qIRnm63l3113kIHZY56ricsYkJucn4C6nrAQ9kNfuY6FMhKcRZ2LasxM44qBxfd3k2A/640?wx_fmt=png&amp;from=appmsg"></p><section><span></span></section><section><ul><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="markdown"><code><span>import pandas as pd</span></code><code><span>ct_colors = pd.Series(</span></code><code><span>ad.uns["celltype_colors"], index=ad.obs["celltype"].values.categories</span></code><code><span>)</span></code><code><span>plt.figure(figsize=[8, 3])</span></code><code><span>plt.scatter(</span></code><code><span>ad.obs[<span>"palantir_pseudotime"</span>][<span>bcell_lineage_cells</span>],</span></code><code><span>ad.obs[<span>"mellon_log_density"</span>][<span>bcell_lineage_cells</span>],</span></code><code><span>s=10,</span></code><code><span>color=ct<span>_colors[ad.obs["celltype"][bcell_</span>lineage_cells]],</span></code><code><span>)</span></code><code><span>plt.show()</span></code></pre></section><section><span><p></p></span></section><section><span> </span></section><p><img data-galleryid="" data-imgfileid="100011022" data-ratio="0.4184149184149184" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/YHGRXkSxjSRg3iaZWr8S3qIRnm63l3113aF9pwxib8SSEfGpHhawLzNYy6C5b2xw1Jz0QCsYstpSicBL7fdSWMTZg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="858" src="https://mmbiz.qpic.cn/mmbiz_png/YHGRXkSxjSRg3iaZWr8S3qIRnm63l3113aF9pwxib8SSEfGpHhawLzNYy6C5b2xw1Jz0QCsYstpSicBL7fdSWMTZg/640?wx_fmt=png&amp;from=appmsg"></p><section><span></span></section><section><ul><li><li><li><li><li><li><li><li><li></ul><pre data-lang="makefile"><code><span>palantir.plot.plot_branch(</span></code><code><span>ad,</span></code><code><span>branch_name=<span>"NaiveB"</span>,</span></code><code><span>position=<span>"mellon_log_density"</span>,</span></code><code><span>color=<span>"celltype"</span>,</span></code><code><span>masks_key=<span>"palantir_lineage_cells"</span>,</span></code><code><span>s=100,</span></code><code><span>)</span></code><code><span>plt.show()</span></code></pre></section><section><span><p></p></span></section><section><span> </span></section><p><img data-galleryid="" data-imgfileid="100011023" data-ratio="0.28055555555555556" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/YHGRXkSxjSRg3iaZWr8S3qIRnm63l3113CLSaRBPKwZyypoDUGb7gfKsS6rNWUETzz4Hh0WF3wBVGaIicrW37zdQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/YHGRXkSxjSRg3iaZWr8S3qIRnm63l3113CLSaRBPKwZyypoDUGb7gfKsS6rNWUETzz4Hh0WF3wBVGaIicrW37zdQ/640?wx_fmt=png&amp;from=appmsg"></p><section><span>该图清楚地说明了定义 B 细胞分化的交替高密度和低密度区域。可以检查这种变异性以识别高密度和低密度区域.<p></p></span></section><section><span></span></section><section><ul><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="makefile"><code><span><span>##相同的功能可用于可视化基因表达</span></span></code><code><span><span># 在伪时间和对数密度的比较中绘制EBF1的估算表达</span></span></code><code><span>palantir.plot.plot_branch(</span></code><code><span>ad,</span></code><code><span>branch_name=<span>"NaiveB"</span>,</span></code><code><span>position=<span>"mellon_log_density"</span>,</span></code><code><span>color=<span>"EBF1"</span>,</span></code><code><span>color_layer=<span>"MAGIC_imputed_data"</span>,</span></code><code><span>masks_key=<span>"palantir_lineage_cells"</span>,</span></code><code><span>s=100,</span></code><code><span>)</span></code><code><span>plt.show()</span></code></pre></section><section><span><p></p></span></section><section><span> </span></section><p><img data-galleryid="" data-imgfileid="100011024" data-ratio="0.33796296296296297" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/YHGRXkSxjSRg3iaZWr8S3qIRnm63l3113lSs34icPIU57tbbBjB01ZnIcibhupvMBRjtHdIbPPLNKrNBvo6IM1ZibQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/YHGRXkSxjSRg3iaZWr8S3qIRnm63l3113lSs34icPIU57tbbBjB01ZnIcibhupvMBRjtHdIbPPLNKrNBvo6IM1ZibQ/640?wx_fmt=png&amp;from=appmsg"></p><section><span><strong><span>6表达的局部变异性或局部变化</span></strong><strong><span><p></p></span></strong></span></section><section><span><span>局部变异性提供了每个细胞状态的基因表达变化的度量。这是通过将细胞中的基因与其相邻细胞状态进行比较来确定的，并且可以使用以下方法计算:</span>palantir.utils.run_local_variability<p></p></span></section><section><span></span></section><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="makefile"><code><span><span># 基因的局部变化</span></span></code><code><span>palantir.utils.run_local_variability(ad)</span></code><code><span><span>#这将添加' local_variability '作为一个图层到anndata</span></span></code><code><span>ad</span></code><code><span><span># 局部可变性或局部变化也可以使用' plot_branch '函数进行可视化</span></span></code><code><span>palantir.plot.plot_branch(</span></code><code><span>ad,</span></code><code><span>branch_name=<span>"NaiveB"</span>,</span></code><code><span>position=<span>"mellon_log_density"</span>,</span></code><code><span>color=<span>"EBF1"</span>,</span></code><code><span>color_layer=<span>"local_variability"</span>,</span></code><code><span>masks_key=<span>"palantir_lineage_cells"</span>,</span></code><code><span>s=100,</span></code><code><span>)</span></code><code><span>plt.show()</span></code></pre></section><section><span><p></p></span></section><section><span> </span></section><p><img data-galleryid="" data-imgfileid="100011025" data-ratio="0.3351851851851852" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/YHGRXkSxjSRg3iaZWr8S3qIRnm63l3113xOEJCXUI4coxBWUL4nycZibbbyLBnXR5VEpvVGOznyRwiaec3f8HI7Bg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/YHGRXkSxjSRg3iaZWr8S3qIRnm63l3113xOEJCXUI4coxBWUL4nycZibbbyLBnXR5VEpvVGOznyRwiaec3f8HI7Bg/640?wx_fmt=png&amp;from=appmsg"></p><section><span></span></section><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="makefile"><code><span><span>#使用蓝色色图来绘制变化</span></span></code><code><span>palantir.plot.plot_branch(</span></code><code><span>ad,</span></code><code><span>branch_name=<span>"NaiveB"</span>,</span></code><code><span>position=<span>"mellon_log_density"</span>,</span></code><code><span>color=<span>"EBF1"</span>,</span></code><code><span>color_layer=<span>"local_variability"</span>,</span></code><code><span>masks_key=<span>"palantir_lineage_cells"</span>,</span></code><code><span>s=100,</span></code><code><span>cmap=matplotlib.cm.Blues,</span></code><code><span>edgecolor=<span>"black"</span>,</span></code><code><span>linewidth=0.1,</span></code><code><span>)</span></code><code><span>plt.show()</span></code></pre></section><section><span><p></p></span></section><p><img data-galleryid="" data-imgfileid="100011026" data-ratio="0.3351851851851852" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/YHGRXkSxjSRg3iaZWr8S3qIRnm63l3113zGWiaFIvmtLncmXjiasIz9prV9TNnoibY5Z8PpCO1wOOGdfAEMjynhfhQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/YHGRXkSxjSRg3iaZWr8S3qIRnm63l3113zGWiaFIvmtLncmXjiasIz9prV9TNnoibY5Z8PpCO1wOOGdfAEMjynhfhQ/640?wx_fmt=png&amp;from=appmsg"></p><section><span> </span></section><section><span></span></section><section><ul><li><li><li><li><li><li></ul><pre data-lang="makefile"><code><span><span># umap可以与细胞子集一起绘制以探索密度</span></span></code><code><span>sc.pl.embedding(</span></code><code><span>ad[bcell_lineage_cells],</span></code><code><span>basis=<span>"umap"</span>,</span></code><code><span>color=[<span>"mellon_log_density_clipped"</span>, <span>"celltype"</span>],</span></code><code><span>)</span></code></pre></section><section><span><p></p></span></section><section><span> </span></section><p><img data-galleryid="" data-imgfileid="100011027" data-ratio="0.4046296296296296" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/YHGRXkSxjSRg3iaZWr8S3qIRnm63l3113YnJQSnhsy7iblPpfUr8I5t1ibQicQ2Raf0oGiaC1SY2BVYcWMZVQys2PIw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/YHGRXkSxjSRg3iaZWr8S3qIRnm63l3113YnJQSnhsy7iblPpfUr8I5t1ibQicQ2Raf0oGiaC1SY2BVYcWMZVQys2PIw/640?wx_fmt=png&amp;from=appmsg"></p><section><span><strong><span>7. 保存和加载变量</span></strong><strong><span><p></p></span></strong></span></section><section><span>可以将预测变量序列化到字典中，并直接保存在 Anndata 对象中。然后，我们可以将 Anndata 对象写入磁盘，重新加载它，从保存的字典中重构预测器，并将其应用于我们的数据。最终检查验证反序列化密度函数是否与原始函数相同。<p></p></span></section><section><span></span></section><section><ul><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="makefile"><code><span><span># 转换为字典并保存到Anndata，然后将Anndata写入磁盘</span></span></code><code><span>ad.uns[<span>"log_density_function"</span>] = predictor.to_dict()</span></code><code><span>ad.write(<span>"data/adata.h5ad"</span>)</span></code><code><span><span>#加载变量</span></span></code><code><span><span>#重新加载Anndata</span></span></code><code><span>ad = sc.read(<span>"data/adata.h5ad"</span>)</span></code><code><span>predictor = mellon.Predictor.from_dict(ad.uns[<span>"log_density_function"</span>])</span></code><code><span><span># 验证</span></span></code><code><span>log_density = predictor(ad.obsm[<span>"DM_EigenVectors"</span>])</span></code><code><span>assert np.all(</span></code><code><span>np.isclose(log_density, ad.obs[<span>"mellon_log_density"</span>])</span></code><code><span>), <span>"Deserialized density function differs from original."</span></span></code></pre></section><section><span><p></p></span></section><section><span><strong><span>小结</span></strong><strong><span><p></p></span></strong></span></section><section><span><span>细胞状态密度表征了细胞沿表型景观的分布，对于揭示驱动不同生物过程的机制至关重要。在这里，大海哥给小伙伴们介绍了Mellon，一种从单细胞数据的高维表示中估计细胞状态密度的算法。Mellon 有助于跨各种单细胞数据模式进行密度估计，并随细胞数量线性缩放，这在细胞状态密度在理解分化过程方面的重要性。</span><span>最后大海哥给大家介绍一个云工具！同学们如果觉得自己的代码水平一般，对于很多的参数不知道怎么改，可以体验一下我们的云生信小工具，只需输入数据，即可轻松生成所需图表，字体大小、标题等也可一键更改。感兴趣的小伙伴去云生信（http://www.biocloudservice.com/home.html）体验一下吧！</span></span></section><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><p>大海哥还提供思路设计、定制生信分析、文献思路复现；有需要的小伙伴欢迎直接扫码咨询~</p></section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><img data-cropselx1="0" data-cropselx2="177" data-cropsely1="0" data-cropsely2="177" data-imgfileid="100011028" data-ratio="0.9973474801061007" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/YHGRXkSxjSQicw3pkyJwFjNBuDYsZOL0kg45dSicgiaibBKJ3sbCq5IqXgFt7c9DmuucV9s07LXWFIoyBPufribs2ibA/640?wx_fmt=png&amp;from=appmsg" data-type="jpeg" data-w="377" src="https://mmbiz.qpic.cn/mmbiz_png/YHGRXkSxjSQicw3pkyJwFjNBuDYsZOL0kg45dSicgiaibBKJ3sbCq5IqXgFt7c9DmuucV9s07LXWFIoyBPufribs2ibA/640?wx_fmt=png&amp;from=appmsg"></section></section></section><section><section powered-by="xiumi.us"><section><p><strong>定制生信分析<br></strong></p><p><strong>服务器租赁</strong></p><p><strong>扫码咨询大海哥</strong></p></section></section></section></section></section></section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><p><strong>往期回顾</strong></p></section></section><section powered-by="xiumi.us"><section><svg viewbox="0 0 1 1"></svg></section></section><section powered-by="xiumi.us"><section><svg viewbox="0 0 1 1"></svg></section></section></section><section><section powered-by="xiumi.us"><section><svg viewbox="0 0 1 1"></svg></section></section><section powered-by="xiumi.us"><section><svg viewbox="0 0 1 1"></svg></section></section></section></section><section powered-by="xiumi.us"><section><table width="100%"><tbody><tr opera-tn-ra-comp="_$.pages:0.layers:0.comps:4.classicTable1:0" powered-by="xiumi.us"><td colspan="1" rowspan="1" opera-tn-ra-cell="_$.pages:0.layers:0.comps:4.classicTable1:0.td@@0" width="100.0000%"><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><p><strong>01</strong></p></section></section><section><section powered-by="xiumi.us"><p><span>｜<a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzkzMzUwODcwMg==&amp;mid=2247491024&amp;idx=2&amp;sn=d8ccbed93d5e13fd8a885a87cd12231b&amp;chksm=c24a3ee1f53db7f72717fae9c169ffc49e75005f8714185e35fc0864dac2e218e6563ecb3d08&amp;scene=21#wechat_redirect" textvalue="生信人必备神器——1024G存储的生信服务器，免费试用啦" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2">生信人必备神器——1024G存储的生信服务器，免费试用啦</a></span></p></section></section></section><section powered-by="xiumi.us"><section><svg viewbox="0 0 1 1"></svg></section></section></section></td></tr><tr opera-tn-ra-comp="_$.pages:0.layers:0.comps:4.classicTable1:1" powered-by="xiumi.us"><td colspan="1" rowspan="1" opera-tn-ra-cell="_$.pages:0.layers:0.comps:4.classicTable1:1.td@@0" width="100.0000%"><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><p><strong>02</strong></p></section></section><section><section powered-by="xiumi.us"><p><span>｜<a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzkzMzUwODcwMg==&amp;mid=2247490768&amp;idx=1&amp;sn=f7fa9fe45eb128a9729aaeeb866e37bb&amp;chksm=c24a3fe1f53db6f7f936d8397efb9fd089b412a7b48d53f3a76496eb2122843dd3a349a0065b&amp;scene=21#wechat_redirect" textvalue="【BWMR】孟德尔随机化分析利器，克服分析挑战！" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2">【BWMR】孟德尔随机化分析利器，克服分析挑战！</a></span></p></section></section></section><section powered-by="xiumi.us"><section><svg viewbox="0 0 1 1"></svg></section></section></section></td></tr><tr opera-tn-ra-comp="_$.pages:0.layers:0.comps:4.classicTable1:2" powered-by="xiumi.us"><td colspan="1" rowspan="1" opera-tn-ra-cell="_$.pages:0.layers:0.comps:4.classicTable1:2.td@@0" width="100.0000%"><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><p><strong>03</strong></p></section></section><section><section powered-by="xiumi.us"><p><span>｜<a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzkzMzUwODcwMg==&amp;mid=2247490408&amp;idx=1&amp;sn=ed197d298464c36bc55e010e5005bd82&amp;chksm=c24a3859f53db14f6dac19c3b53824c27b6bcec7f36ff04acc89505970a2749fc2f13acdcc1d&amp;scene=21#wechat_redirect" textvalue="分子对接花了几个小时？批量分子对接帮你5分钟搞定！" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2">分子对接花了几个小时？批量分子对接帮你5分钟搞定！</a></span></p></section></section></section><section powered-by="xiumi.us"><section><svg viewbox="0 0 1 1"></svg></section></section></section></td></tr><tr opera-tn-ra-comp="_$.pages:0.layers:0.comps:4.classicTable1:3" powered-by="xiumi.us"><td colspan="1" rowspan="1" opera-tn-ra-cell="_$.pages:0.layers:0.comps:4.classicTable1:3.td@@0" width="100.0000%"><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><p><strong>04</strong></p></section></section><section><section powered-by="xiumi.us"><p><span>｜<a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzkzMzUwODcwMg==&amp;mid=2247490092&amp;idx=1&amp;sn=60fa51a91ee9882bb37aaa240ac5a63a&amp;chksm=c24a391df53db00bbd05351d9cc70897d6c9e1670d92a0c56283d10aec4ce179f5dedd4338ad&amp;scene=21#wechat_redirect" textvalue="手把手带你复现XGboost和LightGBM机器学习算法特征重要性排名和 SHAP 汇总图" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2">手把手带你复现XGboost和LightGBM机器学习算法特征重要性排名和 SHAP 汇总图</a></span></p></section></section></section><section powered-by="xiumi.us"><section><svg viewbox="0 0 1 1"></svg></section></section></section></td></tr></tbody></table></section></section></section><p><br></p><section><span><span></span></span></section><section><br></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/08GYoTNxgGX7MxKr2wfcDw",target="_blank" rel="noopener noreferrer">原文链接</a>
