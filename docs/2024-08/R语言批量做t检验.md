---
title: "R语言批量做t检验"
date: 2024-08-28T08:25:54Z
draft: ["false"]
tags: [
  "fetched",
  "小明的数据分析笔记本"
]
categories: ["Acdemic"]
---
R语言批量做t检验 by 小明的数据分析笔记本
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><p data-tool="mdnice编辑器">参考链接</p><p data-tool="mdnice编辑器">https://rforpoliticalscience.com/2024/03/24/how-to-run-multiple-t-tests-in-a-function-with-the-broom-package-in-r/</p><h2 data-tool="mdnice编辑器"><span></span><span>使用场景</span><span></span><span> </span></h2><p data-tool="mdnice编辑器">通过gwas鉴定了一些候选基因，同时测了野生型和突变型的转录组，想看一下这些候选基因在野生型和突变型的个体中的表达是否有差异</p><p data-tool="mdnice编辑器">数据已经整理成了如下格式</p><figure data-tool="mdnice编辑器"><img data-imgfileid="100014337" data-ratio="1.8448275862068966" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/t1wZDoUyFk40OAtgvRB5EJLeoHAU9dkTmuxUqzfYiaEzcC8JpLcHXYsyl4icUqMia5IDPUuH2SpfqvhFd0aA1KLJw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="290" src="https://mmbiz.qpic.cn/sz_mmbiz_png/t1wZDoUyFk40OAtgvRB5EJLeoHAU9dkTmuxUqzfYiaEzcC8JpLcHXYsyl4icUqMia5IDPUuH2SpfqvhFd0aA1KLJw/640?wx_fmt=png&amp;from=appmsg"><figcaption>image.png</figcaption></figure><p data-tool="mdnice编辑器">三个基因 A B D</p><h2 data-tool="mdnice编辑器"><span></span><span>构造数据集</span><span></span><span> </span></h2><pre data-tool="mdnice编辑器"><span></span><code>library(tidyverse)<br>df &lt;- data.frame(gene = c(<span>"A"</span>,<span>"B"</span>,<span>"D"</span>), <br>                 ctl = rnorm(12,5,1),<br>                 trt = rnorm(12,3,1))<br>df %&gt;% <br>  pivot_longer(!gene,names_to = <span>"group"</span>,values_to = <span>"TPM"</span>) %&gt;% <br>  arrange(gene,group) %&gt;% <br>  as.data.frame() -&gt; new.dat<br><br></code></pre><p data-tool="mdnice编辑器">使用R语言的tidyverse包 这里用到nest函数</p><p data-tool="mdnice编辑器">nest函数可以分组把数据折叠起来</p><p data-tool="mdnice编辑器">比如</p><pre data-tool="mdnice编辑器"><span></span><code>new.dat %&gt;% <br>  nest(.by=<span>"gene"</span>)<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100014335" data-ratio="0.5149501661129569" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/t1wZDoUyFk40OAtgvRB5EJLeoHAU9dkTCJltREl51AdBbNOWunP5vQ1iafZgt0heGQbmzrefSRZmU2EY0m0Kliag/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="301" src="https://mmbiz.qpic.cn/sz_mmbiz_png/t1wZDoUyFk40OAtgvRB5EJLeoHAU9dkTCJltREl51AdBbNOWunP5vQ1iafZgt0heGQbmzrefSRZmU2EY0m0Kliag/640?wx_fmt=png&amp;from=appmsg"><figcaption>image.png</figcaption></figure><pre data-tool="mdnice编辑器"><span></span><code>new.dat %&gt;% <br>  nest(.by=<span>"gene"</span>,.key = <span>"mydata"</span>)<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100014336" data-ratio="0.48097826086956524" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/t1wZDoUyFk40OAtgvRB5EJLeoHAU9dkTfuNkPBPzNZ1CMBSZOOibXcl0wE3aAqULtXLS5a5uD1VJ4ZgJ9FSVXvw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="368" src="https://mmbiz.qpic.cn/sz_mmbiz_png/t1wZDoUyFk40OAtgvRB5EJLeoHAU9dkTfuNkPBPzNZ1CMBSZOOibXcl0wE3aAqULtXLS5a5uD1VJ4ZgJ9FSVXvw/640?wx_fmt=png&amp;from=appmsg"><figcaption>image.png</figcaption></figure><pre data-tool="mdnice编辑器"><span></span><code>new.dat %&gt;% <br>  nest(.by=<span>"gene"</span>,.key = <span>"mydata"</span>) %&gt;% <br>  mutate(t_test=map(mydata,~t.test(TPM~group,data=.)),<br>         tidy=map(t_test,broom::tidy)) %&gt;% <br>  unnest(tidy)<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100014338" data-ratio="0.38844086021505375" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/t1wZDoUyFk40OAtgvRB5EJLeoHAU9dkTQFUicgWhiaXltdibU1icdibFHUVKCsyKYo7xmu8Xkc0B66nwnEVTkxQD5ag/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="744" src="https://mmbiz.qpic.cn/sz_mmbiz_png/t1wZDoUyFk40OAtgvRB5EJLeoHAU9dkTQFUicgWhiaXltdibU1icdibFHUVKCsyKYo7xmu8Xkc0B66nwnEVTkxQD5ag/640?wx_fmt=png&amp;from=appmsg"><figcaption>image.png</figcaption></figure><p data-tool="mdnice编辑器"><strong>欢迎大家关注我的公众号</strong></p><p data-tool="mdnice编辑器"><strong>小明的数据分析笔记本</strong></p><section><mp-common-profile data-pluginname="mpprofile" data-id="MzI3NzQ3MTcxMg==" data-headimg="http://mmbiz.qpic.cn/mmbiz_png/t1wZDoUyFk5t1sOnM0iabvBhnfIj5YpyqrMib0E1MGCd9ibcYxaOPZd0GWhQBDvK2BPEwsicQxd6y5MHLfphnwHnow/0?wx_fmt=png" data-nickname="小明的数据分析笔记本" data-alias="" data-signature="分享R语言和python在生物信息领域做数据分析和数据可视化的简单小例子；偶尔会分享一些组学数据处理相关的内容" data-from="0" data-is_biz_ban="0"></mp-common-profile></section><p data-tool="mdnice编辑器"><strong></strong></p><blockquote data-tool="mdnice编辑器"><span></span><p>小明的数据分析笔记本 公众号 主要分享：1、R语言和python做数据分析和数据可视化的简单小例子；2、园艺植物相关转录组学、基因组学、群体遗传学文献阅读笔记；3、生物信息学入门学习资料及自己的学习笔记！</p></blockquote></section><p><br></p><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/WJCJylGZiIuZZsoGZ8CTDg",target="_blank" rel="noopener noreferrer">原文链接</a>
