---
title: "常见基因ID类型和批量转换"
date: 2024-08-07T01:09:57Z
draft: ["false"]
tags: [
  "fetched",
  "被炸熟的虾"
]
categories: ["Acdemic"]
---
常见基因ID类型和批量转换 by 被炸熟的虾
------
<div><p><span><span>当我们从公共数据库获取了表达矩阵后，常常需要将其他类型基因</span><span>ID</span><span>（通常是</span><span>Ensembl ID</span><span>）转换为我们常用的基因名（</span><span>Gene Symbol</span><span>）。例如，</span><span>ENSG00000141510</span><span>对应的基因名称是</span><span>TP53</span><span>（</span><span>tumor protein p53</span><span>）。这种转换可以使用多种方法来实现，包括下载</span><span>Ensembl</span><span>等提供的注释信息手动转换，或者使用在线工具、专门的</span></span><span>R</span><span><span>包如</span></span><code><span>biomaRt</span></code><span>等完成。</span></p><h2><span>一、常见的基因ID类型</span></h2><p><span><span>一个基因可以对应多个名字，有时候最常见的名称甚至不是</span><span>Official Symbol</span><span>，例如细胞程序性死亡-配体</span><span>1</span><span>（</span><span>Programmed cell death 1 ligand 1，PD-L1</span><span>），也称为表面抗原分化簇</span><span>274</span><span>（</span><span>cluster of differentiation 274，CD274</span><span>）或 </span><span>B7</span><span>同源体（</span><span>B7 homolog 1，B7-H1</span><span>）。</span></span></p><section><img data-imgfileid="100004210" data-ratio="0.5768518518518518" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/dRYYdqiaan3LZas55uPoEadic3XuuPh8TcWxzIetNeXicAicNayAxLMC2OvLVQQ88OONnlHribkOsljJvJWZHqTrDIA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/dRYYdqiaan3LZas55uPoEadic3XuuPh8TcWxzIetNeXicAicNayAxLMC2OvLVQQ88OONnlHribkOsljJvJWZHqTrDIA/640?wx_fmt=png&amp;from=appmsg"></section><section><br></section><section><span><span>最常见的</span><span>ID</span><span>莫过于以下三种：</span></span></section><ul><li><section><section><span><strong><span>Symbol ID</span></strong><span>，是一种用于标识基因的简短、易于理解的字符串，<span>便于科研人员和生物学家以标准方式引用和识别特定的基因</span>，由人类基因命名委员会（</span><span>Human Gene Nomenclature Committee, HGNC</span><span>）指定。</span><span>Mus musculus /house mouse</span><span>也有自己的</span><span>Mouse Genome Informatics（MGI）</span><span>。</span></span></section></section></li><li><section><section><span><strong><span>ENTREZ ID / Gene ID</span></strong><span>，是由美国国家生物技术信息中心（</span><span>NCBI</span><span>）分配的一种唯一标识符，用于标识基因、蛋白质和其他生物学实体。</span><span>ENTREZ ID</span><span>以数字形式进行命名。</span></span><span>由于</span><span>ENTREZ ID</span><span>相对稳定，它也被其他数据库如</span><span>KEGG</span><span>等广泛采用。</span><span>我们在做</span><span>KEGG/GO</span><span>富集分析的时候，往往需要先将</span><span>SYMBOL</span><span>转换成E</span><span>NTREZID</span><span>，然后再进行富集分析。</span></section></section></li><li><section><section><span><strong><span>ENSEMBL ID</span></strong><span>，<span>是由欧洲生物信息学研究所（</span></span></span><span>EMBL-EBI</span><span>）的</span><span>Ensembl</span><span><span>数据库为基因、转录本、蛋白质等分子特征分配的标识符。</span><span>ENSEMBL ID</span><span>的命名格式为：【物种前缀】</span></span><span>+</span><span><span>【类型前缀（基因或蛋白等）】</span></span><span>+</span><span><span>【数字编号】</span></span><span>+</span><span><span>【版本号后缀】，例如</span>ENSG00000120217.12<span>：</span></span></section></section></li><ul><li><section><span><span>ENS</span><span>表示这是一个人源</span><span>ID</span><span>。</span></span></section></li><li><section><span><span>G</span><span>表示这是一个</span><span>Ensembl</span><span>基因</span><span>ID</span><span>，如果是</span><span>ENST</span><span>则代表这是一个人源转录本。</span></span></section></li><li><section><span>数字序列部分用于唯一标识一个基因或转录本。</span></section></li><li><section><span>版本号后缀通常是一个小数点后跟一个数字的形式，<span>用于标识数据的更新和修订情况。</span><span>在进行基因注释或转换时，通常需要去除版本号。</span></span></section></li></ul></ul><p><span><span>需要注意的是不同编码方式的基因</span></span><span>ID</span><span><span>之间有时候不是一对一的，例如一个 </span><span>Entrez ID</span><span> 可能对应多个</span><span>Gene symbol</span><span>，一个</span><span>Gene symbol</span><span>可能对应多个</span><span>ENSEMBL ID</span><span>，例如：</span></span></p><section><img data-imgfileid="100004211" data-ratio="0.30277777777777776" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/dRYYdqiaan3LZas55uPoEadic3XuuPh8TcXFficqnBtwJOicYZRwvRtaiabO6eBlEhJWibwQHMtKxibPMGsicPL4j4RoBw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/dRYYdqiaan3LZas55uPoEadic3XuuPh8TcXFficqnBtwJOicYZRwvRtaiabO6eBlEhJWibwQHMtKxibPMGsicPL4j4RoBw/640?wx_fmt=png&amp;from=appmsg"></section><section><span>PAR</span><span>（</span><span>Pseudoautosomal Region</span><span>，拟常染色体区域）表示</span><span>X</span><span>和</span><span>Y</span><span>染色体上与常染色体同源的区域。表达量基本都是</span><span>0</span><span>。</span></section><section><span><span>其次，上图可见并不是所有基因都拥有这三种常见的</span>ID<span>，做非编码</span>RNA<span>、假基因/同源基因等方向研究的老师应该深有体会。最直观莫过于</span>HGNC<span>记录了</span>45656<span>个人类基因，而</span>GENCODE<span>数据库认为人类基因组共有</span>63086<span>个基因（</span>2024<span>年</span>8<span>月</span>5<span>日查询）</span></span></section><section><img data-imgfileid="100004212" data-ratio="0.925" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/dRYYdqiaan3LZas55uPoEadic3XuuPh8TcZmaWvPsSpu1oR5YbezVZU6ibDLQ4M2d8MopThVkicCwYS5OIARuj3G2A/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/dRYYdqiaan3LZas55uPoEadic3XuuPh8TcZmaWvPsSpu1oR5YbezVZU6ibDLQ4M2d8MopThVkicCwYS5OIARuj3G2A/640?wx_fmt=png&amp;from=appmsg"></section><section><span>其他较常见</span><span>ID</span><span>类型：</span></section><ul><li><section><span>RefSeq ID</span><span>：</span><span>RefSeq ID </span><span>用于标识由美国国家生物技术信息中心（</span><span>NCBI</span><span>）提供的参考序列数据库（</span><span>RefSeq</span><span>）中的基因、转录本和蛋白质。通常以</span><span>NM_</span><span>、</span><span>NR_</span><span>或</span><span>NP_</span><span>开头，例如 </span><span>NM_001301717</span><span>（</span><span>mRNA</span><span>序列）或 </span><span>NP_001288687</span><span>（蛋白质序列）</span></section></li><li><section><span>UniProt ID</span><span>：</span><span>UniProt </span><span>是一个综合性蛋白质数据库，包含了大量的蛋白质序列和相关注释信息。</span>UniProt ID<span>是</span>UniProt<span>数据库分配给蛋白质的唯一标识符。通常由一个或两个字母和一个数字组成，例如 </span><span>P05362</span><span>（</span><span>UniProtKB/Swiss-Prot ID</span><span>）</span></section></li><li><section><span>HGNC ID</span><span>：用于标识由</span><span>HUGO</span><span>基因命名委员会（</span><span>HGNC</span><span>）指定的基因名称。通常以</span><span>H</span><span>开头，后跟一组数字，如 </span><span>HGNC:12345</span><span>。</span></section></li></ul><h2><span>二、基因ID转换方式</span></h2><h3><span><strong><span>1、在线工具</span></strong></span></h3><p><span>很多在线工具都会推出基因</span><span>ID</span><span>转换这一功能，但被推荐的最多的可能是两个主业为富集分析的网页工具：</span></p><ul><li><section><strong><span>G:profiler</span></strong><span>：https://biit.cs.ut.ee/gprofiler/gost</span></section></li><li><section><strong><span>DAVID</span></strong><span>：https://david.ncifcrf.gov/</span></section></li></ul><h3><span><strong><span>2、常用R包</span></strong></span></h3><section><span>基因</span><span>ID</span><span>转换同样是很多</span><span>R</span><span>包的基础功能，例如很久前记录的</span><a href="https://mp.weixin.qq.com/s?__biz=MzkwNDQwMDI5NQ==&amp;mid=2247486052&amp;idx=1&amp;sn=e4a85f6643194b9d70e2ce4df9899223&amp;scene=21#wechat_redirect" data-linktype="2"><span><strong><span>两个同源基因ID转换R包 homologene / babelgene</span></strong></span></a></section><h4><span><strong>clusterProfiler包</strong></span></h4><p><span>但受众最广的可能依旧是</span><span>Y</span><span>叔的经典富集分析</span><span>R</span><span>包：</span><code><span>clusterProfiler</span></code><span>，基于不同物种的注释包，利用</span><code><span>bitr</span></code><span>函数一步完成转换：</span></p><p><span>挑选</span><span>200</span><span>个基因</span><span>ID</span><span>执行测试：</span></p><pre><code>head(Genelist)<br><span>#[1] "ENSG00000000003.15" "ENSG00000000005.6"  "ENSG00000000419.13"</span><br><span>#[4] "ENSG00000000457.14" "ENSG00000000460.17" "ENSG00000000938.13"</span><br><span>###去除版本号</span><br>Genelist &lt;- sapply(strsplit(Genelist,<span>"[.]"</span>),<span>"["</span>,<span>1</span>)<br></code></pre><pre><code><span>library</span>(org.Hs.eg.db)<span>#这个是属于注释包，每个基因集可能对应的注释包不一样</span><br><span>library</span>(<span>"clusterProfiler"</span>)<br>ids  &lt;- bitr(Genelist, <br>             fromType = <span>"ENSEMBL"</span>, <span>#fromType是指你的数据ID类型是属于哪一类的</span><br>             toType = c(<span>"ENTREZID"</span>, <span>"SYMBOL"</span>), <span>#toType是指你要转换成哪种ID类型，可以写多种，也可以只写一种</span><br>             OrgDb = org.Hs.eg.db)<span>#Orgdb是指对应的注释包是哪个</span><br><span># 'select()' returned 1:many mapping between keys and columns</span><br><span># Warning message:</span><br><span># In bitr(Genelist, fromType = "ENSEMBL", toType = c("ENTREZID", "SYMBOL"),  :</span><br>  <span># 0.5% of input gene IDs are fail to map...</span><br>head(ids)<br>          <span># ENSEMBL ENTREZID   SYMBOL</span><br><span># 1 ENSG00000000003     7105   TSPAN6</span><br><span># 2 ENSG00000000005    64102     TNMD</span><br><span># 3 ENSG00000000419     8813     DPM1</span><br><span># 4 ENSG00000000457    57147    SCYL3</span><br><span># 5 ENSG00000000460    55732 C1orf112</span><br><span># 6 ENSG00000000938     2268      FGR</span><br></code></pre><p><span>仅有一个基因（</span><span>0.5%</span><span>）转换失败：</span></p><pre><code>Genelist[!(Genelist %<span>in</span>% ids$ENSEMBL)]<br><span>#[1] "ENSG00000002079"</span><br>ids_Gene[grep(<span>"ENSG00000002079"</span>,ids_Gene$gene_id),]<br><span>#   source type score phase            gene_id                      gene_type</span><br><span>#21 HAVANA gene    NA    NA ENSG00000002079.14 transcribed_unitary_pseudogene</span><br><span>#   gene_name level    hgnc_id          havana_gene</span><br><span>#21     MYH16     1 HGNC:31038 OTTHUMG00000154426.5</span><br></code></pre><p><strong><span>这是个什么罕见？</span></strong></p><blockquote><p>“Transcribed unitary pseudogene” 是一种特定类型的假基因（pseudogene）。为了更好地理解这个术语，可以将其拆解为几个部分：</p></blockquote><blockquote><ol><li><section><strong>假基因（Pseudogene）</strong>：假基因是一类基因，它们在进化过程中丧失了正常功能，通常由于突变或缺乏必要的调控序列，不能再编码功能性的蛋白质。虽然它们在基因组中存在，但一般被认为是非功能性的遗传元素。</section></li><li><section><strong>单拷贝假基因（Unitary Pseudogene）</strong>：单拷贝假基因是一种特定的假基因类型，它源自于单拷贝基因的失效。换句话说，这些假基因在基因组中没有与之对应的功能性基因拷贝，而是由一个曾经功能正常的基因逐渐失去功能而形成的。</section></li><li><section><strong>转录假基因（Transcribed Pseudogene）</strong>：虽然假基因通常被认为不编码功能蛋白质，但有些假基因仍然能够被转录成RNA。这些转录产物可能在细胞中有某些功能，或仅仅是转录产物而已。</section></li></ol><p>因此，“transcribed unitary pseudogene” 指的是那些来源于单拷贝基因且已经转录出的假基因。尽管这些假基因可能不能编码功能性蛋白质，但它们的转录产物仍然可能参与细胞内的某些调控过程或产生其他生物学效应。</p></blockquote><p><span>转换失败也情有可原<img data-ratio="1" data-src="https://res.wx.qq.com/t/wx_fed/we-emoji/res/v1.3.10/assets/newemoji/2_05.png" data-w="128" src="https://res.wx.qq.com/t/wx_fed/we-emoji/res/v1.3.10/assets/newemoji/2_05.png">。</span><span>值得注意的是，还存在一个基因“</span><span>ENSG00000004866<span>”</span></span><span>出现了两个查询结果：</span><span><span></span></span></p><pre><code>dim(ids)<span>#[1] 200   3</span><br>ids[ids$ENSEMBL == <span>"ENSG00000004866"</span>,]<br><span>#           ENSEMBL ENTREZID  SYMBOL</span><br><span>#67 ENSG00000004866     7982     ST7</span><br><span>#68 ENSG00000004866    93655 ST7-OT3</span><br></code></pre><p><span>如果查询</span><span>TCGA</span><span>官方提供的注释，则只有一个：</span></p><pre><code>ids_Gene[grep(<span>"ENSG00000004866"</span>,ids_Gene$gene_id),]<br><span>#   source type score phase            gene_id      gene_type gene_name level</span><br><span>#68 HAVANA gene    NA    NA ENSG00000004866.22 protein_coding       ST7     1</span><br><span>#      hgnc_id           havana_gene</span><br><span>#68 HGNC:11351 OTTHUMG00000023888.24</span><br></code></pre><section><figure><p><img data-imgfileid="100004213" data-ratio="0.43333333333333335" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/dRYYdqiaan3LZas55uPoEadic3XuuPh8TcdpJM8LKT05IibEo9IlILaBsXAyaJCU87XcmZEC5ibpbuYvv7bTerE7WQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/dRYYdqiaan3LZas55uPoEadic3XuuPh8TcdpJM8LKT05IibEo9IlILaBsXAyaJCU87XcmZEC5ibpbuYvv7bTerE7WQ/640?wx_fmt=png&amp;from=appmsg"></p><p><span>是真的复杂，没有百分百的精确转换，毕竟这些数据库还在改来改去<img data-src="https://res.wx.qq.com/t/wx_fed/we-emoji/res/v1.3.10/assets/Expression/Expression_32@2x.png" data-ratio="1" data-w="128" src="https://res.wx.qq.com/t/wx_fed/we-emoji/res/v1.3.10/assets/Expression/Expression_32@2x.png">。所以如果可行，大家还是利用上游分析时</span><span>gtf</span><span>文件提供的对应关系吧</span><br></p></figure></section><pre><code>cat gencode.v38.annotation.gtf | grep -v "^#" | awk '{if($3 == "transcript") print $10"\t"$16"\t"$12}' |sed 's/;//g' | sed 's/"//g' &gt; ID.txt<br>cat gencode.v38.annotation.gtf | grep -v "^#" | awk '{if($3 == "transcript") print $10"\t"$16"\t"$12}' |sed 's/;//g' | sed 's/"//g'| head -n 5<br><span>#</span><span> ENSG00000223972.5       DDX11L1 ENST00000456328.2</span><br><span>#</span><span> ENSG00000223972.5       DDX11L1 ENST00000450305.2</span><br><span>#</span><span> ENSG00000227232.5       WASH7P  ENST00000488147.1</span><br><span>#</span><span> ENSG00000278267.1       MIR6859-1       ENST00000619216.1</span><br><span>#</span><span> ENSG00000243485.5       MIR1302-2HG     ENST00000473358.1</span></code></pre><figure><figure><span>其他的转换方向调整一下输入、输出类型就可以了，例如更常见的转：</span></figure></figure><pre><code>ids  &lt;- bitr(Genelist, <br>             fromType = <span>"SYMBOL"</span>, <span>#fromType是指你的数据ID类型是属于哪一类的</span><br>             toType = <span>"ENTREZID"</span>, <span>#toType是指你要转换成哪种ID类型，可以写多种，也可以只写一种</span><br>             OrgDb = org.Hs.eg.db)<span>#Orgdb是指对应的注释包是哪个</span><br></code></pre><p><span>试着转换全部</span><span>TCGA</span><span>基因</span><span>ID</span><span>：</span></p><pre><code>ids &lt;- bitr(Genelist, <br>            fromType = <span>"ENSEMBL"</span>, <span>#fromType是指你的数据ID类型是属于哪一类的</span><br>            toType = c(<span>"ENTREZID"</span>, <span>"SYMBOL"</span>), <span>#toType是指你要转换成哪种ID类型，可以写多种，也可以只写一种</span><br>            OrgDb = org.Hs.eg.db)<span>#Orgdb是指对应的注释包是哪个</span><br><span># 'select()' returned 1:many mapping between keys and columns</span><br><span># Warning message:</span><br><span># In bitr(Genelist, fromType = "ENSEMBL", toType = c("ENTREZID", "SYMBOL"),  :</span><br><span>#   41.69% of input gene IDs are fail to map...</span><br></code></pre><p><span><span>41.69%</span><span>，虽然老师告诉我没有转换成功的基因基本不会影响富集分析的结果<img data-ratio="1" data-src="https://res.wx.qq.com/t/wx_fed/we-emoji/res/v1.3.10/assets/newemoji/Terror.png" data-w="128" src="https://res.wx.qq.com/t/wx_fed/we-emoji/res/v1.3.10/assets/newemoji/Terror.png">，但是还是心惊胆战。</span><strong><span>如果是小鼠等其他物种，更换一个注释包就可以了：</span></strong></span></p><pre><code><span>library</span>(clusterProfiler)<br><span>#BiocManager::install("org.Mm.eg.db") # 下载小鼠的OrgDB包</span><br><span>library</span>(<span>"org.Mm.eg.db"</span>) <br><span>#将ENSEMBL ID转换为ENTREZID</span><br>ids &lt;- bitr(geneID = rownames(nrDEG), <br>            fromType = <span>"ENSEMBL"</span>, <br>            toType = <span>"ENTREZID"</span>, <br>            OrgDb = org.Mm.eg.db)<br></code></pre><p><span>其他基于</span><code><span>org.Hs.eg.db</span></code><span>等物种注释包的基因</span><span>ID</span><span>转换方法还是挺多的，例如：</span></p><pre><code><span>library</span>(AnnotationDbi)<br><span>library</span>(org.Hs.eg.db)<br>ids &lt;- mapIds(org.Hs.eg.db, keys = Genelist[<span>1</span>:<span>200</span>], keytype = <span>'ENSEMBL'</span>, column = <span>'SYMBOL'</span>)<br>head(ids)<br><span>#ENSG00000000003 ENSG00000000005 ENSG00000000419 ENSG00000000457 ENSG00000000460 ENSG00000000938 </span><br><span>#       "TSPAN6"          "TNMD"          "DPM1"         "SCYL3"      "C1orf112"           "FGR" </span><br></code></pre><p><span>但还是</span><code><span>clusterProfiler</span></code><span>的</span><code><span>bitr</span></code><span>最舒服。</span></p><h4><span><strong>biomaRt包</strong></span></h4><p><span>Ensembl</span><span>官网提供了一个在线的</span><span>BioMart</span><span>工具，可以从数据库导出自定义的注释信息：</span></p><ul><li><section><a href="https://mp.weixin.qq.com/s?__biz=MzkyNDE5ODAyNA==&amp;mid=2247485536&amp;idx=2&amp;sn=e6c727bb8a12322cf4cc9a7d038c2e4f&amp;scene=21#wechat_redirect" data-linktype="2"><span><strong><span>使用Ensembl数据库在线版的BioMart工具获取自定义的数据资源</span></strong></span></a></section></li></ul><p><code><span>biomaRt</span></code><span>就是这个在线的工具对应的</span><span>R</span><span>包，功能不是一般的强大，但使用起来也比较繁琐（吐槽一下，有点</span><code><span>TCGAbiolinks</span></code><span>的繁琐感），每次使用也很考验网络稳定性，记得成功后及时保存转换结果。这里先记录一个简单模板，后续再详细介绍：</span></p><section><strong><span>人源转换：</span></strong></section><pre><code><span># BiocManager::install("biomaRt")</span><br><span>library</span>(biomaRt)<br><span># 指定要查询的数据集</span><br>hsmart &lt;- useDataset(dataset = <span>"hsapiens_gene_ensembl"</span>, useMart(<span>"ensembl"</span>))<br>listAttributes(hsmart)<br><span># 获取映射关系</span><br>ids &lt;- getBM(attributes = c(<span>'ensembl_gene_id'</span>,<span>'external_gene_name'</span>,<span>'hgnc_symbol'</span>), <br>             filters = <span>'ensembl_gene_id'</span>,<br>             values = Genelist[<span>1</span>:<span>200</span>],<br>             mart = hsmart)<br></code></pre><p><span>首先通过</span><code><span>useMart()</span></code><span>函数创建了一个</span><span>mart</span><span>对象（</span><span>hsmart</span><span>），该对象指定了要查询的数据集和数据库。这里使用了</span><span>hsapiens_gene_ensembl</span><span>数据集，这是</span><span>Ensembl</span><span>数据库中人类基因组的数据集。然后，使用</span><code><span>getBM()</span></code><span>函数从数据库中获取了基因</span><span>ID</span><span>之间的映射关系。</span><code><span>getBM()</span></code><span>函数通过</span><code><span>attributes</span></code><span>参数指定了要获取的属性，通过</span><code><span>filters</span></code><span>参数指定了过滤器（即要查询的条件），通过</span><code><span>values</span></code><span>参数指定了要查询的值，并且通过</span><code><span>mart</span></code><span>参数指定了要使用的</span><span>mart</span><span>对象。</span></p><pre><code>head(ids)<br><span>#  ensembl_gene_id hgnc_symbol</span><br><span>#1 ENSG00000000003      TSPAN6</span><br><span>#2 ENSG00000000005        TNMD</span><br><span>#3 ENSG00000000419        DPM1</span><br><span>#4 ENSG00000000457       SCYL3</span><br><span>#5 ENSG00000000460       FIRRM</span><br><span>#6 ENSG00000000938         FGR</span><br>dim(ids)<span>#[1] 200   2</span><br>ids[ids$ensembl_gene_id == <span>"ENSG00000004866"</span>,]<br><span>#   ensembl_gene_id hgnc_symbol</span><br><span>#67 ENSG00000004866         ST7</span><br></code></pre><p><span>一切正常，试试全部基因：</span></p><pre><code>ids &lt;- getBM(attributes = c(<span>'ensembl_gene_id'</span>,<span>'external_gene_name'</span>,<span>'hgnc_symbol'</span>), <br>             filters = <span>'ensembl_gene_id'</span>,<br>             values = Genelist,<br>             mart = hsmart)<br></code></pre><p><span>339</span><span>个基因匹配失败，</span><span>3</span><span>个基因出现多次匹配，但总的来说效果算很好了。</span></p><pre><code>ids[ids$ensembl_gene_id %<span>in</span>% names(which(table(ids$ensembl_gene_id) &gt; <span>1</span>)),]<br>      <span># ensembl_gene_id external_gene_name hgnc_symbol</span><br><span># 29346 ENSG00000230417          LINC00595   LINC00595</span><br><span># 29347 ENSG00000230417          LINC00595   LINC00856</span><br><span># 56036 ENSG00000280739          EIF1B-AS1   EIF1B-AS1</span><br><span># 56037 ENSG00000280739          EIF1B-AS1  ENTPD3-AS1</span><br><span># 58138 ENSG00000286061           NCMAP-DT    NCMAP-DT</span><br><span># 58139 ENSG00000286061           NCMAP-DT     RCAN3AS</span><br>ids_Gene[grep(<span>"ENSG00000230417"</span>,ids_Gene$gene_id),-c(<span>1</span>:<span>4</span>)]<br>ids_Gene[grep(<span>"ENSG00000280739"</span>,ids_Gene$gene_id),-c(<span>1</span>:<span>4</span>)]<br>ids_Gene[grep(<span>"ENSG00000286061"</span>,ids_Gene$gene_id),-c(<span>1</span>:<span>4</span>)]<br><span>#                 gene_id gene_type gene_name level    hgnc_id           havana_gene</span><br><span>#29428 ENSG00000230417.12    lncRNA LINC00595     2 HGNC:31430 OTTHUMG00000018552.12</span><br><span>#56357  ENSG00000280739.3    lncRNA EIF1B-AS1     2 HGNC:44555 OTTHUMG00000189530.4</span><br><span>#58494  ENSG00000286061.1    lncRNA   RCAN3AS     2 HGNC:39009 OTTHUMG00000193467.1</span><br></code></pre><pre><code>Failmatch &lt;- lapply(Genelist[!(Genelist %<span>in</span>% ids$ensembl_gene_id)],<span>function</span>(x){<br>     ids_Gene[grep(x,ids_Gene$gene_id),]<br> })<br>Failmatch &lt;- do.call(rbind,Failmatch) <br>head(Failmatch) <br>       <span># source type score phase            gene_id      gene_type  gene_name</span><br><span># 4001   HAVANA gene    NA    NA ENSG00000112096.19 protein_coding       SOD2</span><br><span># 6323   HAVANA gene    NA    NA ENSG00000130723.21 protein_coding     PRRC2B</span><br><span># 7537   HAVANA gene    NA    NA ENSG00000137808.12         lncRNA AC027088.1</span><br><span># 10583  HAVANA gene    NA    NA ENSG00000161149.12         lncRNA    TUBA3FP</span><br><span># 12751 ENSEMBL gene    NA    NA  ENSG00000170152.5 protein_coding AL391987.1</span><br><span># 15196  HAVANA gene    NA    NA ENSG00000182230.12 protein_coding    FAM153B</span><br>      <span># level    hgnc_id           havana_gene</span><br><span># 4001      1 HGNC:11180  OTTHUMG00000015940.5</span><br><span># 6323      2 HGNC:28121  OTTHUMG00000020827.6</span><br><span># 7537      2       &lt;NA&gt;  OTTHUMG00000171448.2</span><br><span># 10583     2 HGNC:24067 OTTHUMG00000150876.15</span><br><span># 12751     3       &lt;NA&gt;                  &lt;NA&gt;</span><br><span># 15196     2 HGNC:27323  OTTHUMG00000163181.5</span><br>table(Failmatch$gene_type)<br></code></pre><section><figure><p><img data-imgfileid="100004214" data-ratio="0.5194444444444445" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/dRYYdqiaan3LZas55uPoEadic3XuuPh8TcNfMeZ5jeibVHNpEXXOs5gRUNzGU5l0knuoWfiaFPwc5gB3X2vTROr4eA/640?wx_fmt=jpeg&amp;from=appmsg" data-type="jpeg" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/dRYYdqiaan3LZas55uPoEadic3XuuPh8TcNfMeZ5jeibVHNpEXXOs5gRUNzGU5l0knuoWfiaFPwc5gB3X2vTROr4eA/640?wx_fmt=jpeg&amp;from=appmsg"></p></figure><figure><p><span>可以说，失败的都情有可原，但是还是。。。（不知道该吐槽谁）</span></p></figure></section><p><strong><span>如果是小鼠也是类似的：</span></strong></p><pre><code>musmart &lt;- useDataset(dataset = <span>"mmusculus_gene_ensembl"</span>, useMart(<span>"ensembl"</span>))<br>my_ensembl_gene_id &lt;- rownames(exprSet)<br><span>#listAttributes(mart)</span><br>mms_symbols &lt;- getBM(attributes = c(<span>'ensembl_gene_id'</span>,<span>'external_gene_name'</span>,<span>"mgi_symbol"</span>),<br>                     filters = <span>'ensembl_gene_id'</span>, <br>                     values = my_ensembl_gene_id, <br>                     mart = musmart)<br>head(mms_symbols)<br></code></pre><h3>参考文章：</h3><p><span><strong><span>1、小黑哥园地：</span></strong></span><a href="https://mp.weixin.qq.com/s?__biz=MzIxODEzNzMwMA==&amp;mid=2247489120&amp;idx=1&amp;sn=a0e1e3230e2e5d7c9f93df1ed83385c9&amp;scene=21#wechat_redirect" data-linktype="2"><span><strong><span>基因ID和基因名的批量转换</span></strong></span></a></p><p><span><strong><span>2、生物信息技术：</span></strong></span><a href="https://mp.weixin.qq.com/s?__biz=MzAxNzQxMDAxMw==&amp;mid=2247486080&amp;idx=1&amp;sn=8cb4bbc89cb719dd8fd615a8597a4595&amp;scene=21#wechat_redirect" data-linktype="2"><span><strong><span>将Ensembl ID转为基因名称</span></strong></span></a></p><p><span><strong><span>3、奶糖学长：</span></strong></span><a href="https://mp.weixin.qq.com/s?__biz=Mzk0MDMwNDkxNQ==&amp;mid=2247483747&amp;idx=1&amp;sn=676d7c90892ba125153e802b2ad73c7d&amp;scene=21#wechat_redirect" data-linktype="2"><span><strong><span>用clusterProfiler包和biomaRt包对基因ID进行转换，事实证明clusterProfiler才是YYDS!</span></strong></span></a></p><section><img data-imgfileid="100003752" data-ratio="0.05278592375366569" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/1LTeQhNfr8sUH75oYsoDaqjPCTiaukEmS8tWricW7LnLKKfIE9jKBexibqamsrlibaaXmuc2nicaYibfDFBNCmqX5mBw/640?wx_fmt=other&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1&amp;tp=webp" data-type="png" data-w="341" src="https://mmbiz.qpic.cn/sz_mmbiz_png/1LTeQhNfr8sUH75oYsoDaqjPCTiaukEmS8tWricW7LnLKKfIE9jKBexibqamsrlibaaXmuc2nicaYibfDFBNCmqX5mBw/640?wx_fmt=other&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1&amp;tp=webp"></section><section data-tools="135编辑器" data-id="116886" draggable="true"><section><section><section><section><strong data-brushtype="text">被炸熟的虾</strong></section></section></section><section><section><section data-width="35%"><section><img data-cropselx1="0" data-cropselx2="115" data-cropsely1="0" data-cropsely2="115" data-imgfileid="100003750" data-ratio="1" data-src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/dRYYdqiaan3JjDfj2H8p6gg3CB25AGthbwzrotao4ev5tIe0utthbZRK8yOoDOuTzOSoTSnPWn61IdDCnXsnaiag/640?wx_fmt=other&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1&amp;tp=webp" data-type="jpeg" data-w="258" data-width="100%" src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/dRYYdqiaan3JjDfj2H8p6gg3CB25AGthbwzrotao4ev5tIe0utthbZRK8yOoDOuTzOSoTSnPWn61IdDCnXsnaiag/640?wx_fmt=other&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1&amp;tp=webp"></section></section><section data-width="63%"><section><section><strong>自己的摸索，发现问题麻烦告诉作者，光速回来改正</strong><strong><img data-imgfileid="100003751" data-ratio="1" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/dRYYdqiaan3KLQGNxibvI4SdtUfxjINkz2DO8cGEPTgbcMJ357RvXJ7IvWU2p7anljpePpakI9oKu3icJxobBDp5w/640?wx_fmt=other&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1&amp;tp=webp" data-type="png" data-w="64" src="https://mmbiz.qpic.cn/sz_mmbiz_png/dRYYdqiaan3KLQGNxibvI4SdtUfxjINkz2DO8cGEPTgbcMJ357RvXJ7IvWU2p7anljpePpakI9oKu3icJxobBDp5w/640?wx_fmt=other&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1&amp;tp=webp"></strong></section></section></section></section></section></section></section><p><mp-style-type data-value="10000"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/LXOStU7-WRntma6V5r0LHw",target="_blank" rel="noopener noreferrer">原文链接</a>
