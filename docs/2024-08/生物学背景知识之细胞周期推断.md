---
title: "生物学背景知识之细胞周期推断"
date: 2024-08-05T06:46:24Z
draft: ["false"]
tags: [
  "fetched",
  "单细胞天地"
]
categories: ["Acdemic"]
---
生物学背景知识之细胞周期推断 by 单细胞天地
------
<div><section data-tools="新媒体管家" data-label="powered by xmt.cn"></section><section data-style-type="5" data-tools="新媒体排版" data-id="1914924"><section powered-by="xiumi.us"><section><section><img data-ratio="0.1203125" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQLYHt6Nf4LWia0BSc0zMTJEa8LrRubTqc3F1EwbNrserE6lRuRsVqMU09FHEkyR0xhkSdACzfNHkA/640?wx_fmt=png" data-type="png" data-w="640" width="100%" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQLYHt6Nf4LWia0BSc0zMTJEa8LrRubTqc3F1EwbNrserE6lRuRsVqMU09FHEkyR0xhkSdACzfNHkA/640?wx_fmt=png"></section></section></section></section><section data-style-type="5" data-tools="新媒体排版" data-id="2252229"><section data-style-type="5" data-tools="新媒体排版" data-id="2047694"><section data-style-type="5" data-tools="新媒体排版" data-id="1939269"><section data-style-type="5" data-tools="新媒体排版" data-id="1903304"><section><section><section><img data-ratio="1.0476190476190477" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQyBneug7xjN5K1mlDG2Pb7mHVl4eDY1Xo027FVvgmWhXxXBsKclp0hYormRVR5t7ZcDMmc11zvIg/640?wx_fmt=png" data-type="png" data-w="420" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQyBneug7xjN5K1mlDG2Pb7mHVl4eDY1Xo027FVvgmWhXxXBsKclp0hYormRVR5t7ZcDMmc11zvIg/640?wx_fmt=png"></section><section><section><p>课程笔记</p></section></section></section></section></section><p><br></p><section data-style-type="5" data-tools="新媒体排版" data-id="1886773"><p><br></p><section data-role="outer" label="Powered by 135editor.com"><section data-role="outer" label="Powered by 135editor.com"><section data-tools="135编辑器" data-id="85960"><section><p><br></p><p><span><span></span>粉丝：有单细胞线上课程吗？</span></p><p><span>小编：什么<img data-type="xmt-style-img" data-src="https://res.wx.qq.com/mpres/htmledition/images/icon/common/emotion_panel/smiley/smiley_3.png" data-ratio="1" data-w="14" src="https://res.wx.qq.com/mpres/htmledition/images/icon/common/emotion_panel/smiley/smiley_3.png">？ 我们的单细胞转录组分析线上课程已经上线好久了，你们竟然都不知道吗，每篇推文后面的课程推荐没人看的吗，小编已哭晕在厕所<img data-type="xmt-style-img" data-src="https://res.wx.qq.com/mpres/htmledition/images/icon/common/emotion_panel/smiley/smiley_5.png" data-ratio="1" data-w="14" src="https://res.wx.qq.com/mpres/htmledition/images/icon/common/emotion_panel/smiley/smiley_5.png"></span></p><p><span>好了，戏演完了，下面郑重介绍下我们的单细胞线上课程：（</span><span>详情戳下方链接）</span><img data-ratio="1" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjS2Kbd8MwP7tPSRxKut2eMaCcbAjeicBHs2jBc5noSOw4fE9L3KZj7z4SDc3Nt4UuWiafbkxG2DsOUQ/640?wx_fmt=png" data-type="png" data-w="14" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjS2Kbd8MwP7tPSRxKut2eMaCcbAjeicBHs2jBc5noSOw4fE9L3KZj7z4SDc3Nt4UuWiafbkxG2DsOUQ/640?wx_fmt=png"><span> </span></p><p><a href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247489021&amp;idx=1&amp;sn=41e95d03cc53a562098cf8c1eac67b55&amp;chksm=9b485546ac3fdc50acead78f53127ea93897bff968e987cd8fbca8cc0ec973f7f2c301cce3b2&amp;scene=21#wechat_redirect" target="_blank" data-itemshowtype="0" data-linktype="2" hasload="1"><strong><span>全网第一个单细胞转录组数据分析实战视频教程</span></strong><span>(预售第二波通知)</span></a></p><span>课程链接在：http://jm.grazy.cn/index/mulitcourse/detail.html?cid=53</span><span> </span><p><span><br></span></p><p><span>这个</span><strong><span>课程笔记</span></strong><span>栏目记录了学员们学习单细胞转录组课程的学习笔记</span></p><p><span>希望大家能有所收获！</span></p></section></section></section></section></section></section></section><p><br></p></section><p><br></p><section><section data-brushtype="text">目录</section></section><section><section><section data-autoskip="1"><ul><li><p><a href="http://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247484464&amp;idx=1&amp;sn=cec394967fcd20a25c258bed892f2457&amp;chksm=ea1f02b2dd688ba4c2bb0659f7f66349c49d876ec340c84763c29c7bf080dba5cfea90d4b68e&amp;scene=21#wechat_redirect" target="_blank" data-itemshowtype="0" data-linktype="2" hasload="1"><span>单细胞转录组学习笔记-1</span></a></p></li><li><p><a href="http://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247484484&amp;idx=1&amp;sn=eb28c69645f8dbfda6c8a4afaf931883&amp;chksm=ea1f02c6dd688bd0ca7ab1caa3261d9c0f59dc9c83002ca3780bf88e11a94f0893bff3849900&amp;scene=21#wechat_redirect" target="_blank" data-itemshowtype="0" data-linktype="2" hasload="1"><span>单细胞转录组学习笔记-2</span></a></p></li><li><p><a href="http://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247484498&amp;idx=1&amp;sn=45a7aa58d726b68dac1c80d4b686f386&amp;chksm=ea1f02d0dd688bc64fd14e5f0370ec1889215fc5ef3837e34db84f1319f517598d3e69832fc2&amp;scene=21#wechat_redirect" target="_blank" data-itemshowtype="0" data-linktype="2" hasload="1"><span>单细胞转录组上游分析之shell回顾</span></a></p></li><li><p><a href="http://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247484551&amp;idx=1&amp;sn=f58786c646cad53047b28cdc4f9bcd9e&amp;chksm=ea1f0205dd688b1326aa5309e506452aacaa9edadf46e44d8cc9547f1126abc553362ed96800&amp;scene=21#wechat_redirect" target="_blank" data-itemshowtype="0" data-linktype="2" hasload="1"><span>获取Github代码包以及准备工作</span></a></p></li><li><p><a href="http://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247484603&amp;idx=1&amp;sn=6c13a90be81285a71b915c77caa30407&amp;chksm=ea1f0239dd688b2fce040852e8e799d410517e0924c45bb4cd00f749cafbe3972d8def3c2ead&amp;scene=21#wechat_redirect" target="_blank" data-itemshowtype="0" data-linktype="2" hasload="1"><span>常说的表达矩阵，那得到之后呢？</span></a></p></li><li><p><a href="http://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247484644&amp;idx=1&amp;sn=eb86415a435da0ef81c1c0ae3c2767fc&amp;chksm=ea1f0266dd688b7030db7bb57782490f0f23d91c79bb9b89a3e6135657544dd131a9cc26a503&amp;scene=21#wechat_redirect" target="_blank" data-itemshowtype="0" data-linktype="2" hasload="1"><span>由表达矩阵看内部异质性</span></a></p></li><li><p><a href="http://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247484658&amp;idx=1&amp;sn=c0c42921ad194abb76ebdd1bc800a7f7&amp;chksm=ea1f0270dd688b66eb730b2459eb65b885fe85a2f7478c26f2aafc3b3ae6a5054f4de75d7c2c&amp;scene=21#wechat_redirect" target="_blank" data-itemshowtype="0" data-linktype="2" hasload="1"><span>重复平均表达量和变异系数相关性散点图</span></a></p></li><li><p><a href="http://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247484689&amp;idx=1&amp;sn=6689a065d287b0308354b00c0a93bb13&amp;chksm=ea1f0393dd688a85faa81c61c8c2528290a00aa8e379da1f939f5d4f5cfa2127581228961835&amp;scene=21#wechat_redirect" target="_blank" data-itemshowtype="0" data-linktype="2" hasload="1">聚类算法之PCA与tSNE</a></p></li><li><p><a href="http://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247484705&amp;idx=1&amp;sn=69b50b56286cd09bc1e9462b3218722d&amp;chksm=ea1f03a3dd688ab57971f11b5e6433e0951cc68fff4de007d01f2ee3237413832420b7ad771b&amp;scene=21#wechat_redirect" target="_blank" data-itemshowtype="0" data-linktype="2" hasload="1">统计细胞检测的基因数量</a></p></li><li><p><a href="http://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247484705&amp;idx=1&amp;sn=69b50b56286cd09bc1e9462b3218722d&amp;chksm=ea1f03a3dd688ab57971f11b5e6433e0951cc68fff4de007d01f2ee3237413832420b7ad771b&amp;scene=21#wechat_redirect" target="_blank" data-itemshowtype="0" data-linktype="2" hasload="1"></a><a href="http://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247484714&amp;idx=1&amp;sn=c5a232af5b0be717b40af56f9f10f9e2&amp;chksm=ea1f03a8dd688abe0c61699db9d9fb1248c5e749abc9354677662a8fa216f3c78ac029f0fd90&amp;scene=21#wechat_redirect" target="_blank" data-itemshowtype="0" data-linktype="2"><span>乳腺癌领域之PAM50分类</span></a><br></p></li></ul></section></section></section><p><br></p><section data-style-type="5" data-tools="新媒体排版" data-id="2058202"><section powered-by="xiumi.us"><section><section><img data-ratio="1" data-src="https://mmbiz.qpic.cn/mmbiz_gif/LbBJgGanG3eiabO1SOIibYWgValKG1LvcD4jwR0QVbbFBjTW1yDJZwLwlLXybl9iaNRsUsHicLmKDDhTzAGsq1rAnA/640?wx_fmt=gif" data-type="gif" data-w="128" src="https://mmbiz.qpic.cn/mmbiz_gif/LbBJgGanG3eiabO1SOIibYWgValKG1LvcD4jwR0QVbbFBjTW1yDJZwLwlLXybl9iaNRsUsHicLmKDDhTzAGsq1rAnA/640?wx_fmt=gif"></section></section></section></section><p><br></p><section data-style-type="5" data-tools="新媒体排版" data-id="2387807"><section data-id="4056" data-md5="6d20d"><section label="Powered by xmyeditor.com" data-tools="小蚂蚁编辑器" data-md5="6d20d"><section data-md5="6d20d" powered-by="xmyeditor.com"><section powered-by="xmyeditor.com" data-md5="6d20d"><section data-style-type="5" data-tools="新媒体排版" data-id="2182092"><section data-tools="135编辑器" data-id="92788" data-color="#fee43e" data-custom="#fee43e"><section><section><section></section><section><p><span><strong data-brushtype="text"> 前 · 言 </strong><strong data-brushtype="text"></strong></span></p></section><section></section></section></section></section></section><p cid="n5" mdtype="paragraph"><br></p><strong>第二单元第九讲：</strong><strong>生物学背景知识之细胞周期推断</strong></section><section powered-by="xmyeditor.com" data-md5="6d20d"><br><p cid="n5" mdtype="paragraph"><span>上一次说到通过PAM50基因进行乳腺癌分型，利用的就是自己的表达矩阵和PAM50基因比较，看表达量变化进行分类。细胞周期分类和PAM50类似，也是利用基因来推断G、S、M期(</span><span>https://en.wikipedia.org/wiki/Cell_cycle</span><span>)</span><span md-inline="plain"></span></p><p cid="n5" mdtype="paragraph"><span><br></span></p><p cid="n34" mdtype="paragraph"><img data-ratio="0.353" data-src="https://mmbiz.qpic.cn/mmbiz/siaia0BDGJdjQLYHt6Nf4LWia0BSc0zMTJELdGpbkZtE8stZAiayKjmGYO28hO2ianXSEkyzPJ0xQtPdBTYcLbpKy9g/640?wx_fmt=other" data-type="other" data-w="1000" src="https://mmbiz.qpic.cn/mmbiz/siaia0BDGJdjQLYHt6Nf4LWia0BSc0zMTJELdGpbkZtE8stZAiayKjmGYO28hO2ianXSEkyzPJ0xQtPdBTYcLbpKy9g/640?wx_fmt=other"></p></section><section data-style-type="5" data-tools="新媒体排版" data-id="2182092"><p><br></p><section data-tools="135编辑器" data-id="92788" data-color="#fee43e" data-custom="#fee43e"><section><section><section></section><section><p><span><strong data-brushtype="text">Scran包使用</strong></span><strong data-brushtype="text"></strong><span></span></p></section><section></section></section></section></section></section><section powered-by="xmyeditor.com" data-md5="6d20d"><h5 cid="n8" mdtype="heading"><span md-inline="plain"><br></span></h5><h5 cid="n8" mdtype="heading"><span><strong><span> 依然第一步是加载矩阵 </span></strong><strong><span></span></strong></span><span md-inline="plain"></span><br></h5><pre spellcheck="false" lang="R" cid="n9" mdtype="fences"><span><span role="presentation">rm(list = ls())</span><br><span role="presentation">options(stringsAsFactors = F)</span><br><span role="presentation">load(file = '../input.Rdata')</span><br><span role="presentation">a[1:4,1:4]</span><br><span role="presentation">head(df)</span><br><br><span role="presentation"># 放入分群、样本批次信息</span><br><span role="presentation">group_list=df$g</span><br><span role="presentation">plate=df$plate</span><br><span role="presentation">table(plate)</span></span></pre><h5 cid="n10" mdtype="heading"><span> 然后创建sce对象</span><span md-inline="plain"></span></h5><pre spellcheck="false" lang="R" cid="n11" mdtype="fences"><span><span role="presentation">library(scran)</span><br><span role="presentation">sce &lt;- SingleCellExperiment(list(counts=dat))</span><br><span role="presentation">&gt; sce</span><br><span role="presentation">class: SingleCellExperiment</span><br><span role="presentation">dim: 12198 768</span><br><span role="presentation">metadata(0):</span><br><span role="presentation">assays(1): counts</span><br><span role="presentation">rownames(12198): 0610007P14Rik 0610009B22Rik ... ERCC-00170</span><br><span role="presentation">  ERCC-00171</span><br><span role="presentation">rowData names(0):</span><br><span role="presentation">colnames(768): SS2_15_0048_A3 SS2_15_0048_A6 ... SS2_15_0049_P22</span><br><span role="presentation">  SS2_15_0049_P24</span><br><span role="presentation">colData names(0):</span><br><span role="presentation">reducedDimNames(0):</span></span><br><span>spikeNames(0):</span></pre><h5 cid="n12" mdtype="heading"><strong><span> 主要使用cyclone函数 </span></strong><span md-inline="plain"></span></h5><p cid="n13" mdtype="paragraph"><span><code>cyclone</code></span><span>函数主要需要三个元素：一个是<code>sce</code>单细胞对象，一个是<code>pairs</code>参数，还有就是<code>gene.names</code>参数。第一个已准备好，第二个参数的意思可以看帮助文档</span></p><p cid="n36" mdtype="paragraph"><img data-ratio="0.365" data-src="https://mmbiz.qpic.cn/mmbiz/siaia0BDGJdjQLYHt6Nf4LWia0BSc0zMTJEz2s8iaSp9QiagnFcKcKTbg3E0sCQpH4mlhmDL68PsFPP6jjFibhMmibZOQ/640?wx_fmt=other" data-type="other" data-w="1000" src="https://mmbiz.qpic.cn/mmbiz/siaia0BDGJdjQLYHt6Nf4LWia0BSc0zMTJEz2s8iaSp9QiagnFcKcKTbg3E0sCQpH4mlhmDL68PsFPP6jjFibhMmibZOQ/640?wx_fmt=other"></p><pre spellcheck="false" lang="R" cid="n15" mdtype="fences"><span><span role="presentation"># scran包安装好后，会在exdata文件夹中找到附件文件</span><br><span role="presentation">library(org.Mm.eg.db)</span><br><span role="presentation"># syste,.file会列出文件所在的路径，下图就是exdata文件夹下的文件，看到除了小鼠还有人的相关的RDS数据。这个RDS其实和平常看到的Rdata差不多，只不过Rdata是针对多个对象，Rds是针对一个对象进行存储和读取</span><br><span role="presentation">mm.pairs &lt;- readRDS(system.file("exdata", "mouse_cycle_markers.rds",</span><br><span role="presentation">                                package="scran"))</span></span><br></pre><p cid="n16" mdtype="paragraph"><img data-ratio="0.145" data-src="https://mmbiz.qpic.cn/mmbiz/siaia0BDGJdjQLYHt6Nf4LWia0BSc0zMTJExj8xPGVO99Tfibz9tJJNxrtrsTnia1ibB6xWzSgibXGQ90PLB85ia4ejDPA/640?wx_fmt=other" data-type="other" data-w="1000" src="https://mmbiz.qpic.cn/mmbiz/siaia0BDGJdjQLYHt6Nf4LWia0BSc0zMTJExj8xPGVO99Tfibz9tJJNxrtrsTnia1ibB6xWzSgibXGQ90PLB85ia4ejDPA/640?wx_fmt=other"></p><p cid="n41" mdtype="paragraph"><span>然后是第三个参数：<code>gene.names</code>，cyclone函数需要使用ensembl基因名</span><br></p><pre spellcheck="false" lang="R" cid="n18" mdtype="fences"><span><span role="presentation"># 将symbol转为ensembl基因</span><br><span role="presentation">ensembl &lt;- mapIds(org.Mm.eg.db, keys=rownames(sce),</span><br><span role="presentation">                  keytype="SYMBOL", column="ENSEMBL")</span><br><span role="presentation">&gt; head(ensembl)</span><br><span role="presentation">       0610007P14Rik        0610009B22Rik        0610009L18Rik</span><br><span role="presentation">                  NA "ENSMUSG00000007777" "ENSMUSG00000043644"</span><br><span role="presentation">       0610009O20Rik        0610010F05Rik        0610010K14Rik</span><br><span role="presentation">                  NA "ENSMUSG00000042208" "ENSMUSG00000020831"</span></span></pre><p cid="n19" mdtype="paragraph"><span>三者齐全，可以进行细胞周期计算：</span><span md-inline="plain"></span></p><pre spellcheck="false" lang="R" cid="n20" mdtype="fences"><span>system.time(assigned <span>&lt;-</span> cyclone(sce, pairs<span>=</span>mm.pairs, gene.names<span>=</span>ensembl))</span><br><span># 这一过程会比较慢，用system.time计算一下时间看看，大约一分半</span><br><span>#  user  system elapsed</span><br><span># 96.229   0.767 104.666</span><br><span>save(assigned,file <span>=</span> <span>'cell_cycle_assigned.Rdata'</span>)</span><br><span><span>&gt;</span> str(assigned) <span># 包含了phases、scores、normalized.scores三个元素</span></span><br><span>List of <span>3</span></span><br><span><span>$</span> phases           <span>:</span> chr [<span>1</span><span>:</span><span>768</span>] <span>"G1"</span> <span>"G1"</span> <span>"G1"</span> <span>"G1"</span> <span>...</span></span><br><span><span>$</span> scores           <span>:</span><span>'data.frame'</span><span>:</span><span>768</span> obs. of  <span>3</span> variables<span>:</span></span><br><span>  ..<span>$</span> G1 <span>:</span> num [<span>1</span><span>:</span><span>768</span>] <span>1</span> <span>0.997</span> <span>0.997</span> <span>1</span> <span>1</span> <span>1</span> <span>1</span> <span>0.937</span> <span>1</span> <span>1</span> <span>...</span></span><br><span>  ..<span>$</span> S  <span>:</span> num [<span>1</span><span>:</span><span>768</span>] <span>0.119</span> <span>0.002</span> <span>0.039</span> <span>0.011</span> <span>0.395</span> <span>0.009</span> <span>0.011</span> <span>0.008</span> <span>0.04</span> <span>0.013</span> <span>...</span></span><br><span>  ..<span>$</span> G2M<span>:</span> num [<span>1</span><span>:</span><span>768</span>] <span>0.004</span> <span>0.01</span> <span>0.02</span> <span>0.002</span> <span>0</span> <span>0</span> <span>0.02</span> <span>0.126</span> <span>0</span> <span>0.023</span> <span>...</span></span><br><span><span>$</span> normalized.scores<span>:</span><span>'data.frame'</span><span>:</span><span>768</span> obs. of  <span>3</span> variables<span>:</span></span><br><span>  ..<span>$</span> G1 <span>:</span> num [<span>1</span><span>:</span><span>768</span>] <span>0.89</span> <span>0.988</span> <span>0.944</span> <span>0.987</span> <span>0.717</span> <span>...</span></span><br><span>  ..<span>$</span> S  <span>:</span> num [<span>1</span><span>:</span><span>768</span>] <span>0.10597</span> <span>0.00198</span> <span>0.03693</span> <span>0.01086</span> <span>0.28315</span> <span>...</span></span><br><span>  ..<span>$</span> G2M<span>:</span> num [<span>1</span><span>:</span><span>768</span>] <span>0.00356</span> <span>0.00991</span> <span>0.01894</span> <span>0.00197</span> <span>0</span> <span>...</span></span><span role="presentation"></span></pre><p cid="n21" mdtype="paragraph"><span>下面就根据<code>assigned</code>进行操作</span><span md-inline="plain"></span></p><pre spellcheck="false" lang="R" cid="n22" mdtype="fences"><span><span>&gt;</span> head(assigned<span>$</span>scores)</span><br><span>     G1     S   G2M</span><br><span><span>1</span> <span>1.000</span> <span>0.119</span> <span>0.004</span></span><br><span><span>2</span> <span>0.997</span> <span>0.002</span> <span>0.010</span></span><br><span><span>3</span> <span>0.997</span> <span>0.039</span> <span>0.020</span></span><br><span><span>4</span> <span>1.000</span> <span>0.011</span> <span>0.002</span></span><br><span><span>5</span> <span>1.000</span> <span>0.395</span> <span>0.000</span></span><br><span><span>6</span> <span>1.000</span> <span>0.009</span> <span>0.000</span></span><br><span><span>&gt;</span> table(assigned<span>$</span>phases)</span><br><br><span>G1 G2M   S</span><br><span><span>723</span>  <span>34</span>  <span>11</span></span><br><br><span># 作图(利用score和phases这两个元素)</span><br><span>draw<span>=</span>cbind(assigned<span>$</span>score,assigned<span>$</span>phases)</span><br><span>attach(draw) <span>#attach的目的就是现在加载，之后直接引用即可</span></span><br><span>library(scatterplot3d)</span><br><span>scatterplot3d(G1, S, G2M, angle<span>=20</span>,</span><span role="presentation"></span><br><span role="presentation">              </span><span>color = rainbow(3)[as.numeric(as.factor(assigned$phases))],</span><br><span>              grid=TRUE, box=FALSE)</span><br><span>detach(draw)</span><span role="presentation"></span></pre><p cid="n23" mdtype="paragraph"><img data-ratio="0.493" data-src="https://mmbiz.qpic.cn/mmbiz/siaia0BDGJdjQLYHt6Nf4LWia0BSc0zMTJE8RXaKwAicJNlosy8JdGV8ILt5NFaQ6YQby3WzbONFMIsRW702pHZmoQ/640?wx_fmt=other" data-type="other" data-w="1000" src="https://mmbiz.qpic.cn/mmbiz/siaia0BDGJdjQLYHt6Nf4LWia0BSc0zMTJE8RXaKwAicJNlosy8JdGV8ILt5NFaQ6YQby3WzbONFMIsRW702pHZmoQ/640?wx_fmt=other"></p><p cid="n24" mdtype="paragraph"><span>还能做个热图(就是在<code>anno_col</code>上不断加内容即可)</span><span md-inline="plain"></span><br></p><pre spellcheck="false" lang="R" cid="n25" mdtype="fences"><span>library(pheatmap)</span><br><span># 取差异前100基因</span><br><span>cg<span>=</span>names(tail(sort(apply(dat,<span>1</span>,sd)),<span>100</span>))</span><br><span># 矩阵归一化</span><br><span>n<span>=</span>t(scale(t(dat[cg,])))</span><br><span># 原来的样本注释信息 df中包含了 g、plate  、n_g、all信息，现在新增phases信息</span><br><span>df<span>$</span>cellcycle<span>=</span>assigned<span>$</span>phases</span><br><span><span>ac</span><span>=</span><span>df</span></span><span></span><br><span>rownames(ac)<span>=</span>colnames(n)</span><br><span>pheatmap(n,show_colnames <span>=</span>F,show_rownames <span>=</span> F,</span><br><span>         annotation_col<span>=</span>ac)</span><br><span>dev.off()</span><span role="presentation"></span></pre><p cid="n26" mdtype="paragraph"><img data-ratio="0.624" data-src="https://mmbiz.qpic.cn/mmbiz/siaia0BDGJdjQLYHt6Nf4LWia0BSc0zMTJEtUTOqwlqZ7xGEMVmFVyBhRvpHyFSXvKseMIqsYBhVICADibiaFu7K8cw/640?wx_fmt=other" data-type="other" data-w="1000" src="https://mmbiz.qpic.cn/mmbiz/siaia0BDGJdjQLYHt6Nf4LWia0BSc0zMTJEtUTOqwlqZ7xGEMVmFVyBhRvpHyFSXvKseMIqsYBhVICADibiaFu7K8cw/640?wx_fmt=other"></p></section></section></section></section></section><p><br></p><section data-style-type="5" data-tools="新媒体排版" data-id="2131700"><p><img data-ratio="0.125" data-src="https://mmbiz.qpic.cn/mmbiz_gif/5SlvKaZu0hIEbAX0vO4qJozKyDX9XSyYqLUianzGzCzjNefdveocPVu2QtibjNdicsUGXwRcBoMmHSLaINEW8aGuA/640?wx_fmt=gif" data-type="gif" data-w="720" data-width="80%" src="https://mmbiz.qpic.cn/mmbiz_gif/5SlvKaZu0hIEbAX0vO4qJozKyDX9XSyYqLUianzGzCzjNefdveocPVu2QtibjNdicsUGXwRcBoMmHSLaINEW8aGuA/640?wx_fmt=gif"><br></p></section><p><br></p><section data-style-type="5" data-tools="新媒体排版" data-id="2182050"><section powered-by="xiumi.us"><section><section><span>“</span><section></section></section><section><section powered-by="xiumi.us"><p data-xmt-x1="441.1000061035156" data-xmt-y1="12743.3623046875" data-xmt-x2="1078.1000061035156" data-xmt-y2="12772.9623046875"><a href="http://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247484710&amp;idx=1&amp;sn=30e78193c93be6d9b03e5db6bd62606d&amp;chksm=ea1f03a4dd688ab265a68fa73f1a6d6eac11061ca0ab84eda72b1c6271fe65011eecd2637b5c&amp;scene=21#wechat_redirect" target="_blank" data-itemshowtype="0" data-linktype="2" hasload="1"><span>人脐带间充质干细胞的异质性研究</span></a><br></p><p data-xmt-x1="441.1000061035156" data-xmt-y1="12772.962890625" data-xmt-x2="1078.1000061035156" data-xmt-y2="12802.562890625"><a href="http://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247484699&amp;idx=1&amp;sn=06b1057210e62623cf0f0c49b69f22ea&amp;chksm=ea1f0399dd688a8f77279c2595ca4f91b896dd56c87c146bf1e237134de8cd7b9b7f168d7874&amp;scene=21#wechat_redirect" target="_blank" data-itemshowtype="0" data-linktype="2" hasload="1"><span>小鼠原肠胚形成和早期器官发生的单细胞分子图谱</span></a></p><p data-xmt-x1="441.1000061035156" data-xmt-y1="12802.5625" data-xmt-x2="1078.1000061035156" data-xmt-y2="12832.1625"><a href="http://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247484675&amp;idx=1&amp;sn=a73457073768cc0edd164202a176438c&amp;chksm=ea1f0381dd688a97f233302fe67d996bbd50272790b0025cf975ff03ee8c4201a73e52c73e70&amp;scene=21#wechat_redirect" target="_blank" data-itemshowtype="0" data-linktype="2" hasload="1"><span>想分析单细胞RNA的动态变化？</span></a></p><p data-xmt-x1="441.1000061035156" data-xmt-y1="12832.1630859375" data-xmt-x2="1078.1000061035156" data-xmt-y2="12861.7630859375"><a href="http://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247484635&amp;idx=1&amp;sn=4547338a526da984b4251030941616d8&amp;chksm=ea1f0259dd688b4f9813030593d4fe9f80996b4f5e9ae1d9bb3e4fcc6d63bd5febfe7ca07110&amp;scene=21#wechat_redirect" target="_blank" data-itemshowtype="0" data-linktype="2" hasload="1"><span>表达矩阵处理—数据可视化</span></a><br></p><p data-xmt-x1="441.1000061035156" data-xmt-y1="12861.7626953125" data-xmt-x2="1078.1000061035156" data-xmt-y2="12891.3626953125"><a href="http://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247484613&amp;idx=1&amp;sn=3b234a16fc8c3e770d89ce32c6122212&amp;chksm=ea1f0247dd688b514b945b15c2de05991671d20328b9e69c8db716385ea3e78766c3437b11e3&amp;scene=21#wechat_redirect" target="_blank" data-itemshowtype="0" data-linktype="2" hasload="1"><span>单细胞综合分析新方法—LIGER</span></a><br></p><p data-xmt-x1="441.1000061035156" data-xmt-y1="12891.3623046875" data-xmt-x2="1078.1000061035156" data-xmt-y2="12920.9623046875"><a href="http://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247484593&amp;idx=1&amp;sn=50f7dc1fe6e7df09a887af55acb8de9e&amp;chksm=ea1f0233dd688b25f17bee887a24fe748b30fa8bd782e274c279b421f8ed45a417905ea07747&amp;scene=21#wechat_redirect" target="_blank" data-itemshowtype="0" data-linktype="2" hasload="1"><span>一篇文章带你走进单细胞的天地</span></a><br></p><p data-xmt-x1="441.1000061035156" data-xmt-y1="12920.962890625" data-xmt-x2="1078.1000061035156" data-xmt-y2="12950.562890625"><a href="http://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247484587&amp;idx=1&amp;sn=3cc01de5a8553e4336f514eacf863756&amp;chksm=ea1f0229dd688b3fff536fa078402ecf03b48f2bbbb4e37ba5d25f5c001156e9ba4a3945212c&amp;scene=21#wechat_redirect" target="_blank" data-itemshowtype="0" data-linktype="2" hasload="1"><span>关于人类细胞图谱项目详细再现性的案例研究</span></a><br></p><p data-xmt-x1="441.1000061035156" data-xmt-y1="12950.5625" data-xmt-x2="1078.1000061035156" data-xmt-y2="12980.1625"><a href="http://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247484570&amp;idx=1&amp;sn=6ad7be263b0e901102238ea915cac3ad&amp;chksm=ea1f0218dd688b0e948e60d2e27cae704ad492c638ad5fa3c3191f6ce69af112832dc328a707&amp;scene=21#wechat_redirect" target="_blank" data-itemshowtype="0" data-linktype="2" hasload="1"><span>单细胞测序助力人体肠道类器官培养</span></a><br></p><p data-xmt-x1="441.1000061035156" data-xmt-y1="12980.1630859375" data-xmt-x2="1078.1000061035156" data-xmt-y2="13009.7630859375"><a href="http://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247484561&amp;idx=1&amp;sn=a1813d818cd74efc4bfdf440bd310b35&amp;chksm=ea1f0213dd688b05f9637aa70efa6a98ccf5f22ef4daa52d300769ddf36f911a03ac57dcf663&amp;scene=21#wechat_redirect" target="_blank" data-itemshowtype="11" data-linktype="2" hasload="1"><span>第一届生物信息人才发展峰会诚邀演讲嘉宾及参会者</span></a><br></p><p data-xmt-x1="441.1000061035156" data-xmt-y1="13009.7626953125" data-xmt-x2="1078.1000061035156" data-xmt-y2="13039.3626953125"><a href="http://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247484559&amp;idx=1&amp;sn=6184fdce23907d51bbe3bdd22b7ed88a&amp;chksm=ea1f020ddd688b1b7ab4c32cb1af5808c726b97f8825ca9bf4948e88a75cd168c73a6d9ca0bb&amp;scene=21#wechat_redirect" target="_blank" data-itemshowtype="0" data-linktype="2" hasload="1"><span>不同物种肾脏常驻巨噬细胞候选基因表达标签的确定</span></a><br></p><p data-xmt-x1="441.1000061035156" data-xmt-y1="13039.3623046875" data-xmt-x2="1078.1000061035156" data-xmt-y2="13068.9623046875"><span><a href="http://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247484546&amp;idx=1&amp;sn=66b75ecbd56eef64998eff93772b9fb3&amp;chksm=ea1f0200dd688b16d1bbdd06d99e3feaee57b86a759b5aa6e770b168ca0728697e8724df27b5&amp;scene=21#wechat_redirect" target="_blank" data-itemshowtype="0" data-linktype="2" hasload="1">基质微环境对胰腺癌有何影响？</a></span></p><p data-xmt-x1="441.1000061035156" data-xmt-y1="13068.962890625" data-xmt-x2="1078.1000061035156" data-xmt-y2="13098.562890625"><br></p><hr data-xmt-x1="441.1000061035156" data-xmt-y1="13098.5625" data-xmt-x2="1078.1000061035156" data-xmt-y2="13098.5625"><p data-xmt-x1="441.1000061035156" data-xmt-y1="13099.5625" data-xmt-x2="1078.1000061035156" data-xmt-y2="13129.1625"><br></p><p data-xmt-x1="441.1000061035156" data-xmt-y1="13129.1630859375" data-xmt-x2="1078.1000061035156" data-xmt-y2="13161.1630859375"><strong><span>如果你对单细胞转录组研究感兴趣，但又不知道如何入门，也许你可以关注一下下面的课程</span></strong><br></p><p data-xmt-x1="441.1000061035156" data-xmt-y1="13161.1630859375" data-xmt-x2="1078.1000061035156" data-xmt-y2="13190.7630859375"><a href="http://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247484450&amp;idx=1&amp;sn=aaf66c05514860bf69f32c93f54a7846&amp;chksm=ea1f02a0dd688bb641fdb5746707ec5cb3649961492d784c5624bf5bde5da23acf1ab898c2e3&amp;scene=21#wechat_redirect" target="_blank" data-linktype="2"><span>一年一度的生信技能树单细胞线下培训班火热招生</span></a><br></p><p data-xmt-x1="441.1000061035156" data-xmt-y1="13190.7626953125" data-xmt-x2="1078.1000061035156" data-xmt-y2="13220.3626953125"><a href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247488803&amp;idx=1&amp;sn=96b8642121587d5c3a782998a601dcf0&amp;chksm=9b485598ac3fdc8edf0bfe90d6b20811bdbae6d93c966939712e1f229399c932e3576c78fba1&amp;scene=21#wechat_redirect" target="_blank" data-itemshowtype="0" data-linktype="2" hasload="1"><span>生信技能树（爆款入门培训课）全国巡讲约你</span></a></p><p data-xmt-x1="441.1000061035156" data-xmt-y1="13220.3623046875" data-xmt-x2="1078.1000061035156" data-xmt-y2="13249.9623046875"><span><a href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247490498&amp;idx=1&amp;sn=d4287d7199f5c21e57c665c8e76bfef3&amp;chksm=9b485b79ac3fd26f24adb9f9297c87c1c45920bb02bda055b9692d4f8cb1de7a96d59a83cff8&amp;scene=21#wechat_redirect" target="_blank" data-itemshowtype="0" data-linktype="2" hasload="1">全国巡讲第12站-北京（生信技能树爆款入门课）</a></span></p></section></section><section><section></section><span>”</span></section></section></section></section><hr><p><br></p><p><img data-ratio="1" data-src="https://mmbiz.qpic.cn/mmbiz/siaia0BDGJdjQLYHt6Nf4LWia0BSc0zMTJEm87PWCA6P1YscVy9giab96522CiaK0ccuwHRTnicmf5uv0icicrvDkslZpw/640?wx_fmt=other" data-type="other" data-w="258" src="https://mmbiz.qpic.cn/mmbiz/siaia0BDGJdjQLYHt6Nf4LWia0BSc0zMTJEm87PWCA6P1YscVy9giab96522CiaK0ccuwHRTnicmf5uv0icicrvDkslZpw/640?wx_fmt=other"></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/sIRtCcYGTEG3B3_It6V8Zw",target="_blank" rel="noopener noreferrer">原文链接</a>
