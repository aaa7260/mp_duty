---
title: "跟着Seurat官网学Visium HD空转分析（二）空间组织域识别和反卷积"
date: 2024-08-17T02:08:03Z
draft: ["false"]
tags: [
  "fetched",
  "生信随笔"
]
categories: ["Acdemic"]
---
跟着Seurat官网学Visium HD空转分析（二）空间组织域识别和反卷积 by 生信随笔
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><p data-tool="mdnice编辑器">上期推文说到，目前Seurat针对HD进行了更新，并在官网发布了一个分析教程，详见https://satijalab.org/seurat/articles/visiumhd_analysis_vignette，因此我在上次推文<a href="https://mp.weixin.qq.com/s?__biz=Mzg5MjcxNzg1NA==&amp;mid=2247488398&amp;idx=1&amp;sn=9f1d970c8db5383e3e38663ac7ceab5f&amp;scene=21#wechat_redirect" data-linktype="2">【跟着Seurat官网学Visium HD空转分析（一）标准分析流程】</a>介绍了基于Seurat v5的Visium HD空转分析的标准分析流程。<span>本次推文继续介绍Seurat官网的Visium HD空转分析流程，包括使用BANKSY算法进行空间组织域识别，以及RCTD算法进行反卷积分析。</span></p><blockquote data-type="2" data-url="" data-author-name="" data-content-utf8-length="137" data-source-title="" data-text="针对Seurat v5，由于目前仍然有相当多的单细胞算法尚未支持Seurat v5，因此在使用v5的过程中用户会遇到很多bug。所以我推荐新手，特别是没有Seurat v4分析经验的，可以先熟悉Seurat v4的分析流程，熟练之后再上手v5。当然，这个只是我个人的观点，仅供参考。" data-editid="3085655svip0v6e7ls0"><section><section>针对Seurat v5，由于目前仍然有相当多的单细胞算法尚未支持Seurat v5，因此在使用v5的过程中用户会遇到很多bug。所以我推荐新手，特别是没有Seurat v4分析经验的，可以先熟悉Seurat v4的分析流程，熟练之后再上手v5。当然，这个只是我个人的观点，仅供参考。</section></section></blockquote><h3 data-tool="mdnice编辑器"><span></span><span>一.  空间组织域识别</span><span></span></h3><p data-tool="mdnice编辑器">加载上期教程使用的示例数据：</p><pre data-tool="mdnice编辑器"><span></span><code><span>library</span>(Seurat)<br><span>library</span>(ggplot2)<br><span>library</span>(patchwork)<br><span>library</span>(dplyr)<br><span>library</span>(readr)<br><span>if</span> (!requireNamespace(<span>"Banksy"</span>, quietly = <span>TRUE</span>)) {<br>  remotes::install_github(<span>"prabhakarlab/Banksy@devel"</span>)<br>}<br><span>library</span>(SeuratWrappers)<br><span>library</span>(Banksy)<br><br><span>#### 1.读入数据</span><br>object = read_rds(<span>"HD_test_data.rds"</span>)<br></code></pre><p data-tool="mdnice编辑器">然后运行BANKSY算法进行空间组织域识。关于Banksy算法，具体可参考<a href="https://mp.weixin.qq.com/s?__biz=Mzg5MjcxNzg1NA==&amp;mid=2247488215&amp;idx=1&amp;sn=154e93106f517dc279cb087f8c668cad&amp;scene=21#wechat_redirect" data-linktype="2">【空转数据分析之生态位聚类算法Banksy】</a>。简而言之，BANKSY是一种聚类空间组学数据的方法，通过将每个细胞的特征与其空间近邻特征的平均值以及邻域特征梯度相结合来增强。通过将邻域信息纳入聚类中，BANKSY能够：</p><ul data-tool="mdnice编辑器"><li><section>在嘈杂的数据中改善细胞/Spots类型分配；</section></li><li><section>区分微环境分层的微妙不同细胞/Spots类型；</section></li><li><section>确定共享相同微环境的空间域。</section></li></ul><p data-tool="mdnice编辑器">在运行BANKSY之前，用户应该考虑两个重要的模型参数:</p><ul data-tool="mdnice编辑器"><li><section><code>k_geom</code>: 本地邻域大小。更大的值将产生更大的domains；</section></li><li><section><code>ambda</code>: 邻域的影响。较大的值产生更多的空间相干的domains。</section></li></ul><p data-tool="mdnice编辑器"><code>RunBanksy</code>函数将创建一个新的插槽，默认名称为"BANKSY"，我们可以基于这个新的插槽进行后续的PCA以及降维聚类分析：</p><pre data-tool="mdnice编辑器"><span></span><code>object &lt;- RunBanksy(object,<br>  lambda = <span>0.8</span>, verbose = <span>TRUE</span>,<br>  assay = <span>"Spatial.008um"</span>, slot = <span>"data"</span>, features = <span>"variable"</span>,<br>  k_geom = <span>50</span><br>)<br></code></pre><pre data-tool="mdnice编辑器"><span></span><code>DefaultAssay(object) &lt;- <span>"BANKSY"</span><br>object &lt;- RunPCA(object, assay = <span>"BANKSY"</span>, reduction.name = <span>"pca.banksy"</span>, features = rownames(object), npcs = <span>30</span>)<br>object &lt;- FindNeighbors(object, reduction = <span>"pca.banksy"</span>, dims = <span>1</span>:<span>30</span>)<br>object &lt;- FindClusters(object, cluster.name = <span>"banksy_cluster"</span>, resolution = <span>0.5</span>)<br></code></pre><pre data-tool="mdnice编辑器"><span></span><code>Idents(object) &lt;- <span>"banksy_cluster"</span><br>p &lt;- SpatialDimPlot(object, group.by = <span>"banksy_cluster"</span>, label = <span>T</span>, repel = <span>T</span>, label.size = <span>4</span>)<br>p<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100043228" data-ratio="0.691089108910891" data-type="other" data-w="505" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/iaRJcrq2Losibs1Djqichv1y8eS8ISQm8CRic8XFgaPgExzM8Jn8LuWpyWyuv2QhicFuevkEs4ZYwvxoKibfCN5zkq0A/640?wx_fmt=other&amp;from=appmsg" src="https://mmbiz.qpic.cn/mmbiz_jpg/iaRJcrq2Losibs1Djqichv1y8eS8ISQm8CRic8XFgaPgExzM8Jn8LuWpyWyuv2QhicFuevkEs4ZYwvxoKibfCN5zkq0A/640?wx_fmt=other&amp;from=appmsg"><figcaption>image-20240816211056491</figcaption></figure><p data-tool="mdnice编辑器">与无监督聚类一样，我们可以可视化每个组织域的空间位置：</p><pre data-tool="mdnice编辑器"><span></span><code>banksy_cells &lt;- CellsByIdentities(object)<br>p &lt;- SpatialDimPlot(object, cells.highlight = banksy_cells[setdiff(names(banksy_cells), <span>"NA"</span>)], cols.highlight = c(<span>"#FFFF00"</span>, <span>"grey50"</span>), facet.highlight = <span>T</span>, combine = <span>T</span>) + NoLegend()<br>p<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100043229" data-ratio="0.9606205250596659" data-type="other" data-w="838" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/iaRJcrq2Losibs1Djqichv1y8eS8ISQm8CREib01icKAFBibz5UlstasBUSlNsRW62bxcJFiaXP4pzfjXyF4ZCxtibLezQ/640?wx_fmt=other&amp;from=appmsg" src="https://mmbiz.qpic.cn/mmbiz_jpg/iaRJcrq2Losibs1Djqichv1y8eS8ISQm8CREib01icKAFBibz5UlstasBUSlNsRW62bxcJFiaXP4pzfjXyF4ZCxtibLezQ/640?wx_fmt=other&amp;from=appmsg"><figcaption>image-20240816211248854</figcaption></figure><p data-tool="mdnice编辑器">此外，有时候我们还需要取子集进行亚群分析。例如，在这里，我们使用<code>createssegmentation</code>函数从整个数据集中创建一个坐标定义的分割掩码，标记皮层和海马区域，然后使用<code>Overlay</code>函数识别属于该区域的细胞。坐标列表可在此处下载（https://www.dropbox.com/scl/fi/qbs3j1alq33f0qz892ub3/cortex-hippocampus_coordinates.csv?rlkey=lsxglb15jhjdrircy9lb6n0rd&amp;dl=0），用户也可以在使用<code>SpatialDimPlot</code>的<code>interactive=TRUE</code>参数探索自己的数据集时识别这些边界。</p><pre data-tool="mdnice编辑器"><span></span><code>cortex.coordinates &lt;- as.data.frame(read.csv(<span>"/brahms/lis/visium_hd/final_mouse/cortex-hippocampus_coordinates.csv"</span>))<br>cortex &lt;- CreateSegmentation(cortex.coordinates)<br><br>object[[<span>"cortex"</span>]] &lt;- Overlay(object[[<span>"slice1.008um"</span>]], cortex)<br>cortex &lt;- subset(object, cells = Cells(object[[<span>"cortex"</span>]]))<br></code></pre><p data-tool="mdnice编辑器">这里取到的<code>cortex</code>对象可用于下文的RCTD反卷积分析。</p><h3 data-tool="mdnice编辑器"><span></span><span>二.  RCTD整合单细胞和HD空转数据</span><span></span></h3><p data-tool="mdnice编辑器">由于HD数据仍不是真正意义上的单个细胞，所以Seurat采用RCTD算法，基于单细胞数据注释HD空转数据。关于RCTD算法，可参考<a href="https://mp.weixin.qq.com/s?__biz=MzUzMTEwODk0Ng==&amp;mid=2247519938&amp;idx=1&amp;sn=d1814cc9fbcec0121242627bff3d59bf&amp;scene=21#wechat_redirect" data-linktype="2">【整合单细胞和空转数据多种方法之RCTD】</a>。简而言之，RCTD以scRNA-seq数据集为reference，以空间数据集为query。作为reference，官方教程使用了来自Allen Brain Atlas的小鼠scRNA-seq数据集，可在此处下载（https://www.dropbox.com/scl/fi/r1mixf4eof2cot891n215/allen_scRNAseq_ref.Rds?rlkey=ynr6s6wu1efqsjsu3h40vitt7&amp;dl=0）。Reference scRNAs-eq数据集经过了下采样，并且删除了&lt;25个细胞的罕见细胞类型，最终得到了20w个单细胞。</p><pre data-tool="mdnice编辑器"><span></span><code><span>if</span> (!requireNamespace(<span>"spacexr"</span>, quietly = <span>TRUE</span>)) {<br>  devtools::install_github(<span>"dmcable/spacexr"</span>, build_vignettes = <span>FALSE</span>)<br>}<br><span>library</span>(spacexr)<br></code></pre><pre data-tool="mdnice编辑器"><span></span><code><span># load in the reference scRNA-seq dataset</span><br>ref &lt;- read_rds(<span>"/brahms/satijar/allen_scRNAseq_ref.Rds"</span>)<br></code></pre><p data-tool="mdnice编辑器"><code>由于cortex</code>是从<code>object</code>HD数据中取的一个小子集，在进行RCTD分析前需要先对<code>cortex</code>子集执行标准分析流程。注意<code>sketch</code>算法的使用，上期推文强调过，这里再复述一遍：</p><blockquote data-tool="mdnice编辑器"><span></span><p><code>sketch</code>算法是Seurat v5的一个特色，特别适合用于大图谱数据的降维聚类分析，可参考：https://satijalab.org/seurat/articles/parsebio_sketch_integration。简要来说，<code>sketch</code>算法通过抽样取小子集的方式，可以对个小子集进行基础分析，以获得一个聚类和降维结果，然后通过<code>ProjectData</code>函数从抽样细胞中学习到的聚类标签和降维结果投影到整个数据集，这样可以大大节省内存和时间。</p></blockquote><pre data-tool="mdnice编辑器"><span></span><code><span># sketch the cortical subset of the Visium HD dataset</span><br>DefaultAssay(cortex) &lt;- <span>"Spatial.008um"</span><br>cortex &lt;- FindVariableFeatures(cortex)<br>cortex &lt;- SketchData(<br>  object = cortex,<br>  ncells = <span>50000</span>,<br>  method = <span>"LeverageScore"</span>,<br>  sketched.assay = <span>"sketch"</span><br>)<br><br>DefaultAssay(cortex) &lt;- <span>"sketch"</span><br>cortex &lt;- ScaleData(cortex)<br>cortex &lt;- RunPCA(cortex, assay = <span>"sketch"</span>, reduction.name = <span>"pca.cortex.sketch"</span>, verbose = <span>T</span>)<br>cortex &lt;- FindNeighbors(cortex, reduction = <span>"pca.cortex.sketch"</span>, dims = <span>1</span>:<span>50</span>)<br>cortex &lt;- RunUMAP(cortex, reduction = <span>"pca.cortex.sketch"</span>, reduction.name = <span>"umap.cortex.sketch"</span>, return.model = <span>T</span>, dims = <span>1</span>:<span>50</span>, verbose = <span>T</span>)<br></code></pre><p data-tool="mdnice编辑器">然后基于这个单细胞数据，对cortex区域的HD空转数据进行反卷积注释：</p><pre data-tool="mdnice编辑器"><span></span><code>Idents(ref) &lt;- <span>"subclass_label"</span><br>counts &lt;- ref[[<span>"RNA"</span>]]$counts<br>cluster &lt;- as.factor(ref$subclass_label)<br>nUMI &lt;- ref$nCount_RNA<br>levels(cluster) &lt;- gsub(<span>"/"</span>, <span>"-"</span>, levels(cluster))<br>cluster &lt;- droplevels(cluster)<br><br><span># create the RCTD reference object</span><br>reference &lt;- Reference(counts, cluster, nUMI)<br><br>counts_hd &lt;- cortex[[<span>"sketch"</span>]]$counts<br>cortex_cells_hd &lt;- colnames(cortex[[<span>"sketch"</span>]])<br>coords &lt;- GetTissueCoordinates(cortex)[cortex_cells_hd, <span>1</span>:<span>2</span>]<br><br><span># create the RCTD query object</span><br>query &lt;- SpatialRNA(coords, counts_hd, colSums(counts_hd))<br></code></pre><p data-tool="mdnice编辑器">创建好RCTD对象后，进行一键运行，但是这个步骤比较占内存和时间。<span>另外注意，由于已知HD数据的一个bin一般不会含多个细胞，因此这里使用的是RCTD的</span><code>doublet</code><span>模式，类似Slide-seqV2平台的分析策略：</span></p><pre data-tool="mdnice编辑器"><span></span><code><span># run RCTD</span><br>RCTD &lt;- create.RCTD(query, reference, max_cores = <span>28</span>)<br>RCTD &lt;- run.RCTD(RCTD, doublet_mode = <span>"doublet"</span>)<br><span># add results back to Seurat object</span><br>cortex &lt;- AddMetaData(cortex, metadata = RCTD@results$results_df)<br></code></pre><pre data-tool="mdnice编辑器"><span></span><code><span># project RCTD labels from sketched cortical cells to all cortical cells</span><br>cortex$first_type &lt;- as.character(cortex$first_type)<br>cortex$first_type[is.na(cortex$first_type)] &lt;- <span>"Unknown"</span><br>cortex &lt;- ProjectData(<br>  object = cortex,<br>  assay = <span>"Spatial.008um"</span>,<br>  full.reduction = <span>"pca.cortex"</span>,<br>  sketched.assay = <span>"sketch"</span>,<br>  sketched.reduction = <span>"pca.cortex.sketch"</span>,<br>  umap.model = <span>"umap.cortex.sketch"</span>,<br>  dims = <span>1</span>:<span>50</span>,<br>  refdata = list(full_first_type = <span>"first_type"</span>)<br>)<br></code></pre><pre data-tool="mdnice编辑器"><span></span><code>DefaultAssay(object) &lt;- <span>"Spatial.008um"</span><br><br><span># we only ran RCTD on the cortical cells</span><br><span># set labels to all other cells as "Unknown"</span><br>object[[]][, <span>"full_first_type"</span>] &lt;- <span>"Unknown"</span><br>object$full_first_type[Cells(cortex)] &lt;- cortex$full_first_type[Cells(cortex)]<br></code></pre><pre data-tool="mdnice编辑器"><span></span><code>Idents(object) &lt;- <span>"full_first_type"</span><br><br><span># now we can spatially map the location of any scRNA-seq cell type</span><br><span># start with Layered (starts with L), excitatory neurons in the cortex</span><br>cells &lt;- CellsByIdentities(object)<br>excitatory_names &lt;- sort(grep(<span>"^L.* CTX"</span>, names(cells), value = <span>TRUE</span>))<br>p &lt;- SpatialDimPlot(object, cells.highlight = cells[excitatory_names], cols.highlight = c(<span>"#FFFF00"</span>, <span>"grey50"</span>), facet.highlight = <span>T</span>, combine = <span>T</span>, ncol = <span>4</span>)<br>p<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100043225" data-ratio="0.5644504748982361" data-type="other" data-w="737" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/iaRJcrq2Losibs1Djqichv1y8eS8ISQm8CRoxy5OJ3pzYTIiaJI2ryicialL7C3gTJVs9NyglWoSAgUqibWraXxc6vWCg/640?wx_fmt=other&amp;from=appmsg" src="https://mmbiz.qpic.cn/mmbiz_jpg/iaRJcrq2Losibs1Djqichv1y8eS8ISQm8CRoxy5OJ3pzYTIiaJI2ryicialL7C3gTJVs9NyglWoSAgUqibWraXxc6vWCg/640?wx_fmt=other&amp;from=appmsg"><figcaption>image-20240816213134025</figcaption></figure><p data-tool="mdnice编辑器">我们现在可以查看单个bins与scRNA-seq标签之间的关联，以及它们的组织结构域标识（BANKSY算法得到的）。通过调查兴奋性神经元细胞属于哪个domains，我们可以将BANKSY对应的cluster重命名为“neuronal layers”:</p><pre data-tool="mdnice编辑器"><span></span><code>plot_cell_types &lt;- <span>function</span>(data, label) {<br>  p &lt;- ggplot(data, aes(x = get(label), y = n, fill = full_first_type)) +<br>    geom_bar(stat = <span>"identity"</span>, position = <span>"stack"</span>) +<br>    geom_text(aes(label = ifelse(n &gt;= min_count_to_show_label, full_first_type, <span>""</span>)), position = position_stack(vjust = <span>0.5</span>), size = <span>2</span>) +<br>    xlab(label) +<br>    ylab(<span>"# of Spots"</span>) +<br>    ggtitle(paste0(<span>"Distribution of Cell Types across "</span>, label)) +<br>    theme_minimal()<br>}<br><br>cell_type_banksy_counts &lt;- object[[]] %&gt;%<br>  dplyr::filter(full_first_type %<span>in</span>% excitatory_names) %&gt;%<br>  dplyr::count(full_first_type, banksy_cluster)<br><br>min_count_to_show_label &lt;- <span>20</span><br><br>p &lt;- plot_cell_types(cell_type_banksy_counts, <span>"banksy_cluster"</span>)<br>p<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100043227" data-ratio="1.2066246056782335" data-type="other" data-w="634" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/iaRJcrq2Losibs1Djqichv1y8eS8ISQm8CRovN2oejf9IWMLnxyMj4g3I2c1WygCFzMylhvbqFpQKIvNgaXtIVsAw/640?wx_fmt=other&amp;from=appmsg" src="https://mmbiz.qpic.cn/mmbiz_jpg/iaRJcrq2Losibs1Djqichv1y8eS8ISQm8CRovN2oejf9IWMLnxyMj4g3I2c1WygCFzMylhvbqFpQKIvNgaXtIVsAw/640?wx_fmt=other&amp;from=appmsg"><figcaption>image-20240816213321355</figcaption></figure><p data-tool="mdnice编辑器">基于上图，我们现在可以将细胞（即使它们不是兴奋性神经元）分配到不同的“neuronal layers”：</p><pre data-tool="mdnice编辑器"><span></span><code>Idents(object) &lt;- <span>"banksy_cluster"</span><br>object$layer_id &lt;- <span>"Unknown"</span><br>object$layer_id[WhichCells(object, idents = c(<span>7</span>))] &lt;- <span>"Layer 2/3"</span><br>object$layer_id[WhichCells(object, idents = c(<span>15</span>))] &lt;- <span>"Layer 4"</span><br>object$layer_id[WhichCells(object, idents = c(<span>5</span>))] &lt;- <span>"Layer 5"</span><br>object$layer_id[WhichCells(object, idents = c(<span>1</span>))] &lt;- <span>"Layer 6"</span><br></code></pre><p data-tool="mdnice编辑器">最后，我们可以可视化其他细胞类型的空间分布，并了解到它们属于皮层的哪个层。例如，与兴奋性神经元相比，皮层中的抑制性（GABAergic）中间神经元在空间上并不局限于单个层，但它们确实表现出明显的富集。</p><p data-tool="mdnice编辑器">与之前的工作中，Seurat作者发现SST和PV中间神经元类别往往局限于4-6层，而VIP和Lamp5中间神经元往往位于2 - 3层。这些结果是基于捕获单细胞剖面的原位成像技术得出的，这里在基于Visium HD点的数据中可以找到类似的结果：</p><pre data-tool="mdnice编辑器"><span></span><code><span># set ID to RCTD label</span><br>Idents(object) &lt;- <span>"full_first_type"</span><br><br><span># Visualize distribution of 4 interneuron subtypes</span><br>inhibitory_names &lt;- c(<span>"Sst"</span>, <span>"Pvalb"</span>, <span>"Vip"</span>, <span>"Lamp5"</span>)<br>cell_ids &lt;- CellsByIdentities(object, idents = inhibitory_names)<br>p &lt;- SpatialDimPlot(object, cells.highlight = cell_ids, cols.highlight = c(<span>"#FFFF00"</span>, <span>"grey50"</span>), facet.highlight = <span>T</span>, combine = <span>T</span>, ncol = <span>4</span>)<br>p<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100043226" data-ratio="0.2846975088967972" data-type="other" data-w="843" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/iaRJcrq2Losibs1Djqichv1y8eS8ISQm8CRSoE8VEl2zGPzh1ZtA7RwD4xkjo6P1Ob0iaSOlqdtz4q5MjgRNUCXULg/640?wx_fmt=other&amp;from=appmsg" src="https://mmbiz.qpic.cn/mmbiz_jpg/iaRJcrq2Losibs1Djqichv1y8eS8ISQm8CRSoE8VEl2zGPzh1ZtA7RwD4xkjo6P1Ob0iaSOlqdtz4q5MjgRNUCXULg/640?wx_fmt=other&amp;from=appmsg"><figcaption>image-20240816213559195</figcaption></figure><pre data-tool="mdnice编辑器"><span></span><code><span># create barplot to show proportions of cell types of interest</span><br>layer_table &lt;- table(object$full_first_type, object$layer_id)[inhibitory_names, <span>1</span>:<span>4</span>]<br><br>neuron_props &lt;- reshape2::melt(prop.table(layer_table), margin = <span>1</span>)<br>ggplot(neuron_props, aes(x = Var1, y = value, fill = Var2)) +<br>  geom_bar(stat = <span>"identity"</span>, position = <span>"fill"</span>) +<br>  labs(x = <span>"Cell type"</span>, y = <span>"Proportion"</span>, fill = <span>"Layer"</span>) +<br>  theme_classic()<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100043234" data-ratio="0.4454865181711606" data-type="other" data-w="853" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/iaRJcrq2Losibs1Djqichv1y8eS8ISQm8CRK1gxdG0GVmVZYLGLggnwiaoMbQWGUkpg2KG1NAPWgLdsCph4iaI20dHg/640?wx_fmt=other&amp;from=appmsg" src="https://mmbiz.qpic.cn/mmbiz_jpg/iaRJcrq2Losibs1Djqichv1y8eS8ISQm8CRK1gxdG0GVmVZYLGLggnwiaoMbQWGUkpg2KG1NAPWgLdsCph4iaI20dHg/640?wx_fmt=other&amp;from=appmsg"><figcaption>image-20240816213625905</figcaption></figure><p data-tool="mdnice编辑器">尽管Visium HD的8um分辨率不能代表真正的单细胞分辨率，但它能够准确定位scRNA-seq定义的细胞类型。</p><p data-tool="mdnice编辑器">除了RCTD算法，当然这里也可以使用其他的去卷积算法，例如：</p><ul data-tool="mdnice编辑器"><li><section><a href="https://mp.weixin.qq.com/s?__biz=MzUzMTEwODk0Ng==&amp;mid=2247517524&amp;idx=1&amp;sn=6eca8b43a3816e2538ad0d3a745488dd&amp;scene=21#wechat_redirect" data-linktype="2">整合单细胞和空转数据多种方法之CellTrek</a></section></li><li><section><a href="https://mp.weixin.qq.com/s?__biz=MzUzMTEwODk0Ng==&amp;mid=2247519266&amp;idx=1&amp;sn=2a7ead4dd345ba58f56a0cb710052d03&amp;scene=21#wechat_redirect" data-linktype="2">整合单细胞和空转数据多种方法之Cell2location</a></section></li><li><section><a href="https://mp.weixin.qq.com/s?__biz=MzUzMTEwODk0Ng==&amp;mid=2247521354&amp;idx=1&amp;sn=679b4e998acd1bcfc1fb298b6335cdd7&amp;scene=21#wechat_redirect" data-linktype="2">整合单细胞和空转数据多种方法之R包semla</a></section></li></ul><p data-tool="mdnice编辑器">但是RCTD算法具有独特的<code>doublet</code>模式，且RCTD算法的精确度不亚于Cell2location，运行相对较快。因此综上所述，我比较推荐使用RCTD算法用于HD空转数据。</p></section><p><br></p><p><mp-style-type data-value="10000"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/G2mD2sOdyYqixOVtM5ZWUQ",target="_blank" rel="noopener noreferrer">原文链接</a>
