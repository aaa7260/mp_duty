---
title: "七夕特辑-细胞通讯学习"
date: 2024-08-10T05:20:48Z
draft: ["false"]
tags: [
  "fetched",
  "生信漫漫学"
]
categories: ["Acdemic"]
---
七夕特辑-细胞通讯学习 by 生信漫漫学
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><h3 data-tool="mdnice编辑器"><span></span><span></span><span>写在开头</span><span></span></h3><p data-tool="mdnice编辑器">终于算是把单细胞学习小组的内容全部过了一遍啦！小谢也是拿到毕业证书的小朋友啦，虽然代码还没完全跑流畅，还需要一些时间去学习！</p><figure data-tool="mdnice编辑器"><img data-imgfileid="100005255" data-ratio="0.7179902755267423" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9bYwXgiaKMZahlHuFcBuSwV90BQ0MW1LE9oZRuEpPQnl3IFhV76vibCwzqJhqFOcNic6bakIgE6tKJsQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="617" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9bYwXgiaKMZahlHuFcBuSwV90BQ0MW1LE9oZRuEpPQnl3IFhV76vibCwzqJhqFOcNic6bakIgE6tKJsQ/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器">但还是<strong>让我们暂停一分钟，恭喜一下小谢完成了<a href="https://mp.weixin.qq.com/s?__biz=MzU4NjU4ODQ2MQ==&amp;mid=2247495036&amp;idx=1&amp;sn=fe8bab2c3d21e7b0a919ad4f1641ca9c&amp;scene=21#wechat_redirect" data-linktype="2">单细胞学习小组</a>的学习！</strong></p><figure data-tool="mdnice编辑器"><img data-imgfileid="100005257" data-ratio="0.6067415730337079" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9bYwXgiaKMZahlHuFcBuSwV9JAXv5swyy26HibO4N2eOlps4QiaE9836rGUV6VibX7znGfFWLWeB3s8FA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1424" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9bYwXgiaKMZahlHuFcBuSwV9JAXv5swyy26HibO4N2eOlps4QiaE9836rGUV6VibX7znGfFWLWeB3s8FA/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器">既然最后一部分内容是cellchat细胞通讯分析的内容，那就简单尝试一下吧！</p><h3 data-tool="mdnice编辑器"><span></span><span></span><span>cellchat分析初试</span><span></span></h3><p data-tool="mdnice编辑器"><strong>用到的示例数据是pbmc3k的数据，参考的教程：</strong></p><ul data-tool="mdnice编辑器"><li><section><a href="https://mp.weixin.qq.com/s?__biz=MzU4NjU4ODQ2MQ==&amp;mid=2247495036&amp;idx=1&amp;sn=fe8bab2c3d21e7b0a919ad4f1641ca9c&amp;scene=21#wechat_redirect" data-linktype="2">单细胞学习小组</a>——day10-2 细胞通讯</section></li><li><section><a href="https://mp.weixin.qq.com/s?__biz=MzUzMTEwODk0Ng==&amp;mid=2247505973&amp;idx=1&amp;sn=2af24cf413aa52d9ab3ec4999be267fa&amp;scene=21#wechat_redirect" data-linktype="2">CellChat细胞通讯分析（一）</a></section></li></ul><h4 data-tool="mdnice编辑器"><span></span><span>加载R包和数据</span><span></span></h4><pre data-tool="mdnice编辑器"><span></span><code><span>#加载需要的R包</span><br>rm(list = ls())<br>library(CellChat)<br>library(patchwork)<br>library(Seurat)<br>library(SeuratData)<br><br>options(timeout=10000)<br><span># InstallData("pbmc3k") # (89.4 MB)</span><br>data(<span>"pbmc3k"</span>)<br>pbmc &lt;- UpdateSeuratObject(pbmc3k.final)<br></code></pre><h4 data-tool="mdnice编辑器"><span></span><span>构建cellchat对象</span><span></span></h4><pre data-tool="mdnice编辑器"><span></span><code><span>#构建cellchat对象</span><br>data.input = pbmc@assays<span>$RNA</span>@data<br>meta.data =  pbmc@meta.data<br>meta.data = meta.data[!is.na(meta.data<span>$seurat_annotations</span>),]<br>data.input = data.input[,row.names(meta.data)]<br><br><span>#设置因子水平</span><br>meta.data<span>$seurat_annotations</span> = factor(meta.data<span>$seurat_annotations</span>,<br>                                      levels = c(<span>"Naive CD4 T"</span>, <span>"Memory CD4 T"</span>, <span>"CD14+ Mono"</span>, <span>"B"</span>, <span>"CD8 T"</span>, <br>                                                 <span>"FCGR3A+ Mono"</span>, <span>"NK"</span>, <span>"DC"</span>, <span>"Platelet"</span>))<br><br><span>### 1.2 Create a CellChat object</span><br>cellchat &lt;- createCellChat(object = data.input, <br>                           meta = meta.data, <br>                           group.by = <span>"seurat_annotations"</span>)<br><br>cellchat &lt;- subsetData(cellchat)<br><br></code></pre><h4 data-tool="mdnice编辑器"><span></span><span>加载需要的数据库</span><span></span></h4><pre data-tool="mdnice编辑器"><span></span><code>CellChatDB &lt;- CellChatDB.human<br><br>cellchat@DB &lt;- CellChatDB<br></code></pre><h4 data-tool="mdnice编辑器"><span></span><span>细胞通讯网络分析</span><span></span></h4><pre data-tool="mdnice编辑器"><span></span><code><span># 识别过表达基因</span><br>cellchat &lt;- identifyOverExpressedGenes(cellchat)<br><span># 识别配体-受体对</span><br>cellchat &lt;- identifyOverExpressedInteractions(cellchat)<br><br><span># 将配体、受体投射到PPI网络</span><br>cellchat &lt;- projectData(cellchat, PPI.human)<br><span>## 推测细胞通讯网络</span><br>cellchat &lt;- computeCommunProb(cellchat)<br><br>cellchat &lt;- computeCommunProbPathway(cellchat)<br>cellchat &lt;- aggregateNet(cellchat)<br><br><span>#查看结果</span><br>cellchat@netP<span>$pathways</span><br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100005254" data-ratio="0.14252696456086286" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9bYwXgiaKMZahlHuFcBuSwV9ezVBJh995dLYeCTo2dw8lAL0zKLl6ooQ7CLOUwlfMqmN3PtTibkibGfA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1298" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9bYwXgiaKMZahlHuFcBuSwV9ezVBJh995dLYeCTo2dw8lAL0zKLl6ooQ7CLOUwlfMqmN3PtTibkibGfA/640?wx_fmt=png&amp;from=appmsg"></figure><h4 data-tool="mdnice编辑器"><span></span><span>使用circle plot可视化</span><span></span></h4><pre data-tool="mdnice编辑器"><span></span><code>groupSize &lt;- as.numeric(table(cellchat@idents))<br><br><span>#展示某一条通路</span><br>pathways.show &lt;- <span>"GALECTIN"</span><br>par(mfrow = c(1,2), xpd=TRUE,mar = c(2, 2, 2, 2))<br>netVisual_aggregate(cellchat, signaling = pathways.show, <br>                    layout = <span>"circle"</span>, <br>                    vertex.receiver = vertex.receiver,<br>                    vertex.weight  = groupSize)<br><br><span>#任意两个细胞亚群之间的通讯次数</span><br>netVisual_circle(cellchat@net<span>$count</span>, vertex.weight = groupSize,<br>                 weight.scale = T, label.edge= F,<br>                 title.name = <span>"Number of interactions"</span>)<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100005256" data-ratio="0.5550972304065999" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9bYwXgiaKMZahlHuFcBuSwV9104ibEf9xNCicnfjVAnEibmhlmMKNg9zr24fIFZdEHqI5DBh46N8N8A2Q/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1697" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9bYwXgiaKMZahlHuFcBuSwV9104ibEf9xNCicnfjVAnEibmhlmMKNg9zr24fIFZdEHqI5DBh46N8N8A2Q/640?wx_fmt=png&amp;from=appmsg"></figure><h3 data-tool="mdnice编辑器"><span></span><span></span><span>结尾总结</span><span></span></h3><p data-tool="mdnice编辑器">上次月度总结的时候有反思一下自己近期的学习状态，从整理完<a href="https://mp.weixin.qq.com/s?__biz=MzkxOTI0Mjc3Mw==&amp;mid=2247488284&amp;idx=1&amp;sn=ca4ab35ba51711a207c3fdab4c2d4e31&amp;scene=21#wechat_redirect" data-linktype="2">单细胞基本分析流程学习总结</a>之后就<strong>一直在准备学习单细胞高级分析系列</strong>。</p><p data-tool="mdnice编辑器">是的，<strong>一直在准备，但没有实际行动</strong>。好像卡在了半桶水的状态，觉得自己掌握了基本分析流程就在舒适圈晃悠，但是没有沉下心按计划学习——<a href="https://mp.weixin.qq.com/s?__biz=MzkxOTI0Mjc3Mw==&amp;mid=2247488300&amp;idx=1&amp;sn=3a43622a43b154ce08ab62920d344ae4&amp;scene=21#wechat_redirect" data-linktype="2">单细胞高级分析学习规划</a></p><p data-tool="mdnice编辑器">计划说学习完单细胞学习小组的内容，然后就要开始着手单细胞文献复现了，结果文献复现是开始了——<a href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzkxOTI0Mjc3Mw==&amp;action=getalbum&amp;album_id=3548822590121869315&amp;scene=173&amp;subscene=227&amp;sessionid=1723266629&amp;enterid=1723266640&amp;from_msgid=2247488622&amp;from_itemidx=1&amp;count=3&amp;nolastread=1#wechat_redirect" data-linktype="2">#单细胞文献复现</a>还是卡在了高级分析系列内容里面。</p><p data-tool="mdnice编辑器">所以啊，<strong>学习也好工作也罢，都是不能拖延的。想到就要去行动，先完成再完美！</strong></p><figure data-tool="mdnice编辑器"><img data-imgfileid="100005253" data-ratio="0.7064935064935065" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9bYwXgiaKMZahlHuFcBuSwV9aZ21iaLBFoOw63VpxL1oXP85XC5ySc6Ho7OQuxRSrospoVsmKd5lqFw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="385" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9bYwXgiaKMZahlHuFcBuSwV9aZ21iaLBFoOw63VpxL1oXP85XC5ySc6Ho7OQuxRSrospoVsmKd5lqFw/640?wx_fmt=png&amp;from=appmsg"></figure></section><p><br></p><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/xenTdNpSQH0N2KJRMQrgnA",target="_blank" rel="noopener noreferrer">原文链接</a>
