---
title: "十多万个细胞数量就顶不住了吗"
date: 2024-08-13T12:32:54Z
draft: ["false"]
tags: [
  "fetched",
  "生信技能树"
]
categories: ["Acdemic"]
---
十多万个细胞数量就顶不住了吗 by 生信技能树
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><blockquote data-tool="mdnice编辑器"><span></span><p>最近有小伙伴使用我们的共享服务器（<a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247528363&amp;idx=1&amp;sn=5e02f3e9b2e148191e23ebc2c0d780e7&amp;scene=21#wechat_redirect" data-linktype="2">2024的共享服务器交个朋友福利价仍然是800</a>）后“抱怨”到居然读取一个单细胞转录组公共数据集，就十多万个细胞数量而已，就顶不住了，如下所示的文件 ：</p></blockquote><pre data-tool="mdnice编辑器"><span></span><code> 2.1M  8  6 21:15 GSE222318_Cell_metadata.csv.gz<br> 246M  8  6 21:16 GSE222318_Raw_gene_counts_matrix.csv.gz<br><br></code></pre><p data-tool="mdnice编辑器">我看了看他的代码，是很简单的读取表达量矩阵文件和细胞的表型信息，然后成为一个数据框（行列式 ）：</p><pre data-tool="mdnice编辑器"><span></span><code><span># 参考：https://mp.weixin.qq.com/s/tw7lygmGDAbpzMTx57VvFw</span><br>ct=data.table::fread(<span>'GSE222318_Raw_gene_counts_matrix.csv.gz'</span>,<br>                     data.table = <span>F</span>) <br>ct[<span>1</span>:<span>4</span>,<span>1</span>:<span>4</span>]<br>rownames(ct)=ct$V1<br>ct=ct[,-<span>1</span>]<br>phe=data.table::fread(<span>'GSE222318_Cell_metadata.csv.gz'</span>,data.table = <span>F</span>) <br>rownames(phe)=phe[,<span>1</span>]<br>phe=phe[,-<span>1</span>]<br>identical(colnames(ct),rownames(phe))<br>sce.all=CreateSeuratObject(counts = ct,meta.data = phe) <br></code></pre><p data-tool="mdnice编辑器">大家可以试试看，在自己的电脑复现这个流程，同样的代码复制粘贴即可。然后就发现确实是会报错，但是这个问题其实是因为数据框（行列式 ）本身的问题，只需要做下面的修改即可，适用于单细胞转录组这样的特殊性数据格式，稀疏矩阵 ：</p><pre data-tool="mdnice编辑器"><span></span><code>ct &lt;- as.matrix(ct, <span>type</span>=<span>"dgCMatrix"</span>)<br></code></pre><p data-tool="mdnice编辑器">构建好Seurat这样的单细胞对象后，在R里面然后就可以愉快的降维聚类分群啦！如下所示的初步结果：</p><p><img data-galleryid="" data-imgfileid="100048885" data-ratio="1.1947019867549669" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wzl0xWU59WMyfricyrrtVZIxicjC3M603Yro0RpUC2aMtt6fZR0lS9hfn3ibzSKJb2YEcmDficDU43oxw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1510" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wzl0xWU59WMyfricyrrtVZIxicjC3M603Yro0RpUC2aMtt6fZR0lS9hfn3ibzSKJb2YEcmDficDU43oxw/640?wx_fmt=png&amp;from=appmsg"></p><figure data-tool="mdnice编辑器"><figcaption>降维聚类分群</figcaption></figure><p data-tool="mdnice编辑器">值得注意的是上面的结果仅仅是练习而已哈，并不是最终的分群和命名，比如上面的SMC其实应该是包含了成纤维的，以文献为准：《The activator protein-1 complex governs a vascular degenerative transcriptional programme in smooth muscle cells to trigger aortic dissection and rupture》</p><p><img data-galleryid="" data-imgfileid="100048886" data-ratio="0.7311827956989247" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wzl0xWU59WMyfricyrrtVZIxtsYADz8jAibHKLm258WicKUZEib2iaollsEcnJ47ibDOn2F9EvLFDibIekOA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1674" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wzl0xWU59WMyfricyrrtVZIxtsYADz8jAibHKLm258WicKUZEib2iaollsEcnJ47ibDOn2F9EvLFDibIekOA/640?wx_fmt=png&amp;from=appmsg"></p><figure data-tool="mdnice编辑器"><figcaption>最终的分群和命名</figcaption></figure><h3 data-tool="mdnice编辑器"><span></span><span>学徒作业</span><span></span></h3><p data-tool="mdnice编辑器">读取上面的 246M 的 GSE222318_Raw_gene_counts_matrix.csv.gz 表达量矩阵文件做第一层次降维聚类分群后，去除里面的免疫细胞后，然后模仿文献里面的降维聚类分群，如下所示：</p><p><img data-galleryid="" data-imgfileid="100048884" data-ratio="0.702020202020202" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wzl0xWU59WMyfricyrrtVZIxqhoib7zoBF8Eqqu4vVj8rhSUra7bIaH1HmeVQ1iauIEG5kdlZN7hhscg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="792" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wzl0xWU59WMyfricyrrtVZIxqhoib7zoBF8Eqqu4vVj8rhSUra7bIaH1HmeVQ1iauIEG5kdlZN7hhscg/640?wx_fmt=png&amp;from=appmsg"></p><figure data-tool="mdnice编辑器"><figcaption>去除里面的免疫细胞</figcaption></figure><p data-tool="mdnice编辑器">这些就是我们传统说的基质细胞，主要包括以下几种类型：</p><ol data-tool="mdnice编辑器"><li><section><strong>成纤维细胞（Fibroblasts）</strong>：在肿瘤微环境中，成纤维细胞可以分化为癌症相关成纤维细胞（Cancer-Associated Fibroblasts, CAFs），它们通过分泌多种细胞因子和细胞外基质（ECM）成分，促进肿瘤的发展和转移。</section></li><li><section><strong>内皮细胞（Endothelial Cells）</strong>：内皮细胞在肿瘤血管生成中起到关键作用，它们可以形成新的血管，为肿瘤提供氧气和营养。</section></li><li><section><strong>平滑肌细胞（Smooth Muscle Cells, SMCs）</strong>：在某些情况下，平滑肌细胞也存在于肿瘤微环境中，尤其是在血管结构中。</section></li><li><section><strong>周细胞（Pericytes）</strong>：周细胞是血管壁的一部分，它们与内皮细胞相互作用，参与血管的稳定和成熟。</section></li></ol><p data-tool="mdnice编辑器">其中内皮细胞主要是区分成为了淋巴内皮和血管内皮， 其中血管可以细分为动脉静脉和毛细血管：</p><ul data-tool="mdnice编辑器"><li><section>lymphatic ECs (LECs; <em>CCL21, PROX1</em>).</section></li><li><section>arteries (<em>HEY1, IGFBP3</em>), capillaries (<em>CD36, CA4</em>), veins (<em>ACKR1</em>)</section></li></ul><p data-tool="mdnice编辑器">可以看到文章里面确实是区分了两个内皮细胞，就是淋巴内皮和血管内皮。</p><p data-tool="mdnice编辑器">然后文章里面的SMC和成纤维的异质性有点太高了，每个都可以细分很多群，大家试试看能不能复现。</p><p data-tool="mdnice编辑器">最后，<span><strong>文章里面有一个特殊的Mesenchymal 亚群，大家看看能不能复现出来，另外还需要解释一下周细胞（Pericytes）的缺失问题！</strong></span></p></section><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><h3 data-tool="mdnice编辑器"><span>写在文末</span></h3></section><p>如果你也想做单细胞转录组数据分析，<span>最好是有自己的计算机资源哦，比如我们的</span><a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247528363&amp;idx=1&amp;sn=5e02f3e9b2e148191e23ebc2c0d780e7&amp;scene=21#wechat_redirect" data-linktype="2">2024的共享服务器交个朋友福利价仍然是800</a><span>，而且还需要有基本的生物信息学基础，也可以看看我们的</span><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247531929&amp;idx=1&amp;sn=f6f16b7bf6b907360d6d0052e3d10cf6&amp;chksm=9b4b3d22ac3cb434b6aa7753a4cf0f266578147ccf10b49cc834e46af578ee6de99be0accb30&amp;scene=21#wechat_redirect" textvalue="生物信息学马拉‍松授课（买一得五）" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1">生物信息学马拉松授课（买一得五）</a><span> ，你的生物信息学入门课。当然了，八月份比较特殊的是：<a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzUzMTEwODk0Ng==&amp;mid=2247526317&amp;idx=1&amp;sn=b6fef7bcd40fa18db974aa3d36656c20&amp;chksm=fa45a290cd322b86afc3676b1a715a734782956a9e37d40b978ef54d51c9cd47facb9f356e53&amp;scene=21#wechat_redirect" textvalue="单细胞数据挖掘线下培训（南京站）" linktype="text" imgurl="" imgdata="null" data-itemshowtype="11" tab="innerlink" data-linktype="2" hasload="1">单细胞数据挖掘线下培训（南京站）</a>，下周六日我们可以线下授课，惊喜不！</span></p><p><br></p><p><br></p><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/szzjiSplTllR-eeqsAyvkA",target="_blank" rel="noopener noreferrer">原文链接</a>
