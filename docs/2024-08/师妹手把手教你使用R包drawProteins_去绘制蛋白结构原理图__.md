---
title: "师妹手把手教你使用R包drawProteins-去绘制蛋白结构原理图!!"
date: 2024-08-24T11:45:59Z
draft: ["false"]
tags: [
  "fetched",
  "R语言学徒"
]
categories: ["Acdemic"]
---
师妹手把手教你使用R包drawProteins-去绘制蛋白结构原理图!! by R语言学徒
------
<div><p><img data-cropselx1="0" data-cropselx2="578" data-cropsely1="0" data-cropsely2="135" data-galleryid="" data-ratio="0.2222222222222222" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEUckerRictfTicSHoNskkHZjoa7nSeGI9ticg8pf3FOEkewHQTNLbNhdKK36fxBPpNLzVm0W8LjZYKEg/640?wx_fmt=png&amp;from=appmsg" data-type="jpeg" data-w="900" src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEUckerRictfTicSHoNskkHZjoa7nSeGI9ticg8pf3FOEkewHQTNLbNhdKK36fxBPpNLzVm0W8LjZYKEg/640?wx_fmt=png&amp;from=appmsg"></p><p><span>做生信的小伙伴生物基础肯定都不错，最基础的知识基因与蛋白质的关系也是熟记于心，我们都明白他们之间的关系，师妹这里就不多赘述，之所以提起这个关系，是因为我们在做生信分析的时候，想要了解研究基因的本质，肯定离不开对蛋白质的研究，比如我们在探究大基因的分子机制，大多数都是从蛋白质数据库中寻找基因的结构图，然后通过结构去了解分子机制。所以师妹这次教小伙伴去绘制蛋白结构原理图，放在我们的文章当中，可以作为一个亮点。</span></p><p><span>我们平时去查看蛋白质结构的时候基本上都是从蛋白质相关的数据库下载，但是这样绘制的图片都难去调整。师妹这次教小伙伴使用R语言去绘制，是不是很新奇。就是R包drawProteins。</span></p><p><img data-cropselx1="0" data-cropselx2="578" data-cropsely1="0" data-cropsely2="225" data-galleryid="" data-ratio="0.4444444444444444" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/oCSOtP61aEWsBEr9hm2ibYhjkWqcyBSJw4aiaaoaLTeEmryREtHqskAFUol6ysOoEXWYpDYCntLhTv89QNYGFSdg/640?wx_fmt=jpeg&amp;from=appmsg" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/oCSOtP61aEWsBEr9hm2ibYhjkWqcyBSJw4aiaaoaLTeEmryREtHqskAFUol6ysOoEXWYpDYCntLhTv89QNYGFSdg/640?wx_fmt=jpeg&amp;from=appmsg"></p><p><span>我们先了解一下这个包是干嘛的，这个软件包从UniprotAPI输出中绘制蛋白质示意图。它根据GET命令返回的JSON，从Uniprot Features API 创建一个数据框。然后，基于ggplot2和BaseR的geoms可以使用该数据框来绘制蛋白质示意图。是不是听起来很厉害，其实就是从蛋白质数据库下载，然后使用ggplot2去绘制加工。</span></p><p><span>工作流程呢师妹这里简单总结一下吧</span></p><p><span>提供一个或多个Uniprot ID</span></p><p><span>从Uniprot API获取feature 列表</span></p><p><span>绘制这些蛋白质的基本链</span></p><p><span>根据需要添加feature</span></p><p><span>我们了解了这么多，下面我们就开始绘制吧</span></p><p><span>先分享一下这个包的下载方式</span></p><section><ul><li><li><li></ul><pre data-lang="php"><code><span><span>if</span> (!<span>require</span>(<span>"BiocManager"</span>, quietly = <span>TRUE</span>))    </span></code><code><span>  install.packages(<span>"BiocManager"</span>)        </span></code><code><span>BiocManager::install(<span>"drawProteins"</span>)</span></code></pre></section><p><span></span><span>加载一下这个包</span></p><section><ul><li></ul><pre><code><span>library(drawProteins)</span></code></pre></section><p><span>下面的操作就需要我们用联网去完成，小伙伴不要断网了哦</span></p><p><span>我们先从Uniprot检索</span></p><section><ul><li><li></ul><pre data-lang="cpp"><code><span><span># accession numbers of rel A</span></span></code><code><span>drawProteins::get_features(<span>"Q04206"</span>) -&gt; rel_json</span></code></pre></section><p><span></span><span><img data-imgfileid="100003686" data-ratio="0.10590277777777778" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/2wJ7bWfS0QuRd6AkicPqSMM23HXyLRQqjhAKASPGbWRIlVKGvibKFaR9cQwZsceWgBZMrlICBiaaqF6zz114cicIeQ/640?wx_fmt=png" data-type="png" data-w="576" height="58.600006103515625" width="553.739990234375" src="https://mmbiz.qpic.cn/sz_mmbiz_png/2wJ7bWfS0QuRd6AkicPqSMM23HXyLRQqjhAKASPGbWRIlVKGvibKFaR9cQwZsceWgBZMrlICBiaaqF6zz114cicIeQ/640?wx_fmt=png"></span><span></span></p><p><span>然后就是第二部，我们要将Uniprot中的数据转化为数据框，这个师妹就不多揭示了，小伙伴肯定都明白，因为我们要使用ggplot2，所以Uniprot API中的数据要转换为可与ggplot2一起使用的数据框</span></p><p><span>我们这里使用feature_to_dataframe()函数，这个函数会将get_features()函数提供的六个列表的列表转换为数据框，然后可用于绘制示意图。此外呢，feature_to_dataframe()函数还将添加一个“order”值以允许绘图</span></p><p><span>来看看：</span></p><section><ul><li><li></ul><pre data-lang="makefile"><code><span><span>#将 Uniprot 数据转换为数据框</span></span></code><code><span><span>drawProteins::feature_to_dataframe(rel_json) -&gt; rel_data</span></span></code></pre></section><p><page></page><span><img data-imgfileid="100003687" data-ratio="0.5344418052256532" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/2wJ7bWfS0QuRd6AkicPqSMM23HXyLRQqjLqJtN00iciauD7Svyy7YRYCBQTQfsbOEj8VkHolJYT8kiaVEtTpPC2uVg/640?wx_fmt=png" data-type="png" data-w="842" height="295.94000244140625" width="553.739990234375" src="https://mmbiz.qpic.cn/sz_mmbiz_png/2wJ7bWfS0QuRd6AkicPqSMM23HXyLRQqjLqJtN00iciauD7Svyy7YRYCBQTQfsbOEj8VkHolJYT8kiaVEtTpPC2uVg/640?wx_fmt=png"></span><span></span></p><p><span>然后就是去绘制图了，首先要画出蛋白质的链还有其结构域，因为我们要使用ggplot2去绘制，所以别忘了调用一下</span></p><p><span>我们这里使用geom_rect()和geom_label通过ggplot2绘制数据。第一步是使用draw_canvas 制作画布，它基于正在绘制的最长蛋白质。这可以通过以下方式使用管道来完成。</span></p><section><ul><li><li><li></ul><pre data-lang="properties"><code><span><span>#蛋白质链和结构域</span></span></code><code><span><span>draw_canvas(rel_data)</span> <span>-&gt; p</span></span></code><code><span><span>p</span>    <span></span></span></code></pre></section><p><page></page><span><img data-imgfileid="100003689" data-ratio="1.1406844106463878" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/2wJ7bWfS0QuRd6AkicPqSMM23HXyLRQqjMN61DkxDhyeJKD83zLswX0ic7IADaAWhcWJcdXwn5fwzp1hyr3QXjFg/640?wx_fmt=png" data-type="png" data-w="526" height="599.9299926757812" width="525.9400024414062" src="https://mmbiz.qpic.cn/sz_mmbiz_png/2wJ7bWfS0QuRd6AkicPqSMM23HXyLRQqjMN61DkxDhyeJKD83zLswX0ic7IADaAWhcWJcdXwn5fwzp1hyr3QXjFg/640?wx_fmt=png"></span><span></span></p><p><span>幕布绘制完成，然后绘制蛋白质链。使用draw_chain()函数，我们必须向该函数提供ggplot对象p和rel_data数据</span></p><section><ul><li><li></ul><pre data-lang="properties"><code><span><span>p</span> <span>&lt;- draw_chains(p, rel_data)</span></span></code><code><span><span>p</span>  <span></span></span></code></pre></section><p> <page></page><span><img data-imgfileid="100003690" data-ratio="1.118867924528302" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/2wJ7bWfS0QuRd6AkicPqSMM23HXyLRQqjxCXw22aP3HQdPkTibiccBYchnL9DOhqPpsGTusibRicVdCk7UFu1nhia9kw/640?wx_fmt=png" data-type="png" data-w="530" height="592.9299926757812" width="529.9400024414062" src="https://mmbiz.qpic.cn/sz_mmbiz_png/2wJ7bWfS0QuRd6AkicPqSMM23HXyLRQqjxCXw22aP3HQdPkTibiccBYchnL9DOhqPpsGTusibRicVdCk7UFu1nhia9kw/640?wx_fmt=png"></span><span></span></p><p><span>下面我们就可以绘制图了，这里主要添加按照长度缩放的域。这里使用 draw_domains()函数，所以我们向该函数提供ggplot对象p和rel_data数据。R包的默认设置是为链添加标签。可以使用参数label_chains=FALSE删除标签</span></p><section><ul><li><li><li></ul><pre data-lang="properties"><code><span><span>#添加按照长度缩放的域</span></span></code><code><span><span>p</span> <span>&lt;- draw_domains(p, rel_data)</span></span></code><code><span><span>p</span>    <span></span></span></code></pre></section><p><page></page><span><img data-imgfileid="100003688" data-ratio="1.135135135135135" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/2wJ7bWfS0QuRd6AkicPqSMM23HXyLRQqjfvEQD0ywDla6LCp7NmjQjuIpiaHSiaTsJ5ySNg89mthcJQ39ElfgEGyQ/640?wx_fmt=png" data-type="png" data-w="518" height="587.9400024414062" width="517.9400024414062" src="https://mmbiz.qpic.cn/sz_mmbiz_png/2wJ7bWfS0QuRd6AkicPqSMM23HXyLRQqjfvEQD0ywDla6LCp7NmjQjuIpiaHSiaTsJ5ySNg89mthcJQ39ElfgEGyQ/640?wx_fmt=png"></span><span></span></p><p><span>为了更好地展示这种可视化效果，白色背景以及删除y轴和网格都有帮助。还可以使用base_size 参数更改文本的大小，来看看如何绘制：</span></p><section><ul><li><li><li><li><li><li><li><li><li></ul><pre data-lang="xml"><code><span>#base_size 参数更改文本的大小</span></code><code><span># 白色背景并删除y轴</span></code><code><span>p <span>&lt;<span>-</span> <span>p</span> + <span>theme_bw</span>(<span>base_size</span> = <span>20)</span> + # <span>white</span> <span>background</span></span></span></code><code><span>  <span>theme</span>(<span>panel.grid.minor</span>=<span>element_blank(),</span></span></code><code><span>        <span>panel.grid.major</span>=<span>element_blank())</span> +</span></code><code><span>  <span>theme</span>(<span>axis.ticks</span> = <span>element_blank(),</span>    </span></code><code><span>        <span>axis.text.y</span> = <span>element_blank())</span> +</span></code><code><span>  <span>theme</span>(<span>panel.border</span> = <span>element_blank())</span></span></code><code><span><span>p</span></span></code></pre></section><p><span></span><span><img data-imgfileid="100003695" data-ratio="0.4841417910447761" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/2wJ7bWfS0QuRd6AkicPqSMM23HXyLRQqj3fD8HTI3G4DNoSpLtRXU4a0ucgp6Vd7DDZ9yIxSO8uKT4TvnGB5xFw/640?wx_fmt=png" data-type="png" data-w="1072" height="268.1400146484375" width="553.739990234375" src="https://mmbiz.qpic.cn/sz_mmbiz_png/2wJ7bWfS0QuRd6AkicPqSMM23HXyLRQqj3fD8HTI3G4DNoSpLtRXU4a0ucgp6Vd7DDZ9yIxSO8uKT4TvnGB5xFw/640?wx_fmt=png"></span><span></span></p><p><span>好了这个基础的函数我们就绘制完成了，我们绘制蛋白质结构图，肯定不止一种feature，也就是特征，所以我们就需要不同的函数去绘制不同的蛋白质结构特征，来看看怎么回事</span></p><section><ul><li><li></ul><pre data-lang="bash"><code><span><span>#展示其他 feature</span></span></code><code><span>draw_regions(p, rel_data) <span># 添加激活域</span></span></code></pre></section><p><span></span><span><img data-imgfileid="100003691" data-ratio="0.46944444444444444" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/2wJ7bWfS0QuRd6AkicPqSMM23HXyLRQqjicaZwNOb3AqicEYjz6C2ibUFVM2hVge5hHZxMUdiagKp4DUEdLC46egYqw/640?wx_fmt=png" data-type="png" data-w="1080" height="259.94000244140625" width="553.739990234375" src="https://mmbiz.qpic.cn/sz_mmbiz_png/2wJ7bWfS0QuRd6AkicPqSMM23HXyLRQqjicaZwNOb3AqicEYjz6C2ibUFVM2hVge5hHZxMUdiagKp4DUEdLC46egYqw/640?wx_fmt=png"></span><span></span></p><section><ul><li></ul><pre data-lang="bash"><code><span>draw_repeat(p, rel_data) <span># 在这种情况下没有添加任何内容</span></span></code></pre></section><p><page></page><span><img data-imgfileid="100003694" data-ratio="0.470533208606174" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/2wJ7bWfS0QuRd6AkicPqSMM23HXyLRQqjyFKPGfRzAiar2TmX8yxzgibibWpI8ZjmZmIZTanyptZZCJlgr0Lia3JfAw/640?wx_fmt=png" data-type="png" data-w="1069" height="260.5400085449219" width="553.739990234375" src="https://mmbiz.qpic.cn/sz_mmbiz_png/2wJ7bWfS0QuRd6AkicPqSMM23HXyLRQqjyFKPGfRzAiar2TmX8yxzgibibWpI8ZjmZmIZTanyptZZCJlgr0Lia3JfAw/640?wx_fmt=png"></span><span></span></p><section><ul><li></ul><pre data-lang="bash"><code><span>draw_motif(p, rel_data) <span># 添加9aa事务激活域&amp;NLS</span></span></code></pre></section><p><span><img data-imgfileid="100003692" data-ratio="0.46574074074074073" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/2wJ7bWfS0QuRd6AkicPqSMM23HXyLRQqjR1xjmjuv8EphEIJ6wpaqvabmVntkianibLykNWq8N7vzp8dNzVKJDzYg/640?wx_fmt=png" data-type="png" data-w="1080" height="258.0700378417969" width="553.739990234375" src="https://mmbiz.qpic.cn/sz_mmbiz_png/2wJ7bWfS0QuRd6AkicPqSMM23HXyLRQqjR1xjmjuv8EphEIJ6wpaqvabmVntkianibLykNWq8N7vzp8dNzVKJDzYg/640?wx_fmt=png"></span><span></span></p><p><span>还有一种是</span></p><section><ul><li><li></ul><pre data-lang="apache"><code><span><span># 添加Uniprot的磷酸化位点</span></span></code><code><span><span>draw_phospho</span>(p, rel_data, size = 8)</span></code></pre></section><p><page></page><span><img data-imgfileid="100003693" data-ratio="0.49713740458015265" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/2wJ7bWfS0QuRd6AkicPqSMM23HXyLRQqjfBOvhBqkK2Jd6QiaQm51lkrgLoicGQxY6viaoN0MK6Og7VM6VVBoKDeJA/640?wx_fmt=png" data-type="png" data-w="1048" height="275.2699890136719" width="553.739990234375" src="https://mmbiz.qpic.cn/sz_mmbiz_png/2wJ7bWfS0QuRd6AkicPqSMM23HXyLRQqjfBOvhBqkK2Jd6QiaQm51lkrgLoicGQxY6viaoN0MK6Og7VM6VVBoKDeJA/640?wx_fmt=png"></span><span></span></p><p><span>上述这几个不同的特征结构，我们不能分开去放在文章当中，所以这就需要我们把不同特征的蛋白质结构放在一起，这个功能ggplot2最熟悉不过了，我们这个老朋友最喜欢干的就是对细节的处理，来看看如何去绘制<br></span></p><p><span>对于 Rel A结构，我们如何一下进行组合</span></p><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="properties"><code><span><span>#组合</span></span></code><code><span><span>draw_canvas(rel_data)</span> <span>-&gt; p</span></span></code><code><span><span>p</span> <span>&lt;- draw_chains(p, rel_data)</span></span></code><code><span><span>p</span> <span>&lt;- draw_domains(p, rel_data)</span></span></code><code><span><span>p</span> <span>&lt;- draw_regions(p, rel_data)</span></span></code><code><span><span>p</span> <span>&lt;- draw_motif(p, rel_data)</span></span></code><code><span><span>p</span> <span>&lt;- draw_phospho(p, rel_data, size = 8)</span></span></code><code><span>           </span></code><code><span><span>p</span> <span>&lt;- p + theme_bw(base_size = 20) + # 白色背景&amp;更改文本大小</span></span></code><code><span>  <span>theme(panel.grid.minor</span>=<span>element_blank(),</span></span></code><code><span>        <span>panel.grid.major</span>=<span>element_blank()) +    </span></span></code><code><span>  <span>theme(axis.ticks</span> = <span>element_blank(),</span></span></code><code><span>        <span>axis.text.y</span> = <span>element_blank()) +</span></span></code><code><span>  <span>theme(panel.border</span> = <span>element_blank())</span></span></code><code><span><span>p</span></span></code></pre></section><p><span></span><span><img data-imgfileid="100003699" data-ratio="0.4675925925925926" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/2wJ7bWfS0QuRd6AkicPqSMM23HXyLRQqjQrXiaJVqkzZib8IP50eLiaoicSYhibZmGAx7ZZjZAVtmQPK3z46kXB8ia2wg/640?wx_fmt=png" data-type="png" data-w="1080" height="258.9399719238281" width="553.739990234375" src="https://mmbiz.qpic.cn/sz_mmbiz_png/2wJ7bWfS0QuRd6AkicPqSMM23HXyLRQqjQrXiaJVqkzZib8IP50eLiaoicSYhibZmGAx7ZZjZAVtmQPK3z46kXB8ia2wg/640?wx_fmt=png"></span><span></span></p><p><span>然后我们可以使用ggplot2去添加标题</span></p><section><ul><li><li><li><li><li><li><li><li></ul><pre data-lang="nginx"><code><span><span>#添加标题</span></span></code><code><span><span># add titles</span></span></code><code><span><span>rel_subtitle</span> &lt;- paste0(<span>"circles = phosphorylation sites\n"</span>,</span></code><code><span>                       <span>"RHD = Rel Homology Domain\nsource:Uniprot"</span>)</span></code><code><span>           </span></code><code><span>p &lt;- p + labs(title = <span>"Rel A/p65"</span>,</span></code><code><span>              subtitle = rel_subtitle)</span></code><code><span>p</span></code></pre></section><p><page></page><span><img data-imgfileid="100003700" data-ratio="0.5444444444444444" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/2wJ7bWfS0QuRd6AkicPqSMM23HXyLRQqjk1oZCBIXmCsxkOFbYJicO1EmynWsGogrtfApeDXy78a2pTefCiauOD8A/640?wx_fmt=png" data-type="png" data-w="1080" height="301.3399963378906" width="553.739990234375" src="https://mmbiz.qpic.cn/sz_mmbiz_png/2wJ7bWfS0QuRd6AkicPqSMM23HXyLRQqjk1oZCBIXmCsxkOFbYJicO1EmynWsGogrtfApeDXy78a2pTefCiauOD8A/640?wx_fmt=png"></span><span></span></p><p><span>如果我们面对多种蛋白质，该如何绘制呢，这次面对的是种类，来看看如何绘制，我们通过代码去显示NFkappaB 转录因子家族的五种蛋白质的工作流程：</span></p><section><ul><li><li><li><li></ul><pre data-lang="nginx"><code><span><span>#多种蛋白质的示意图</span></span></code><code><span><span># 五种NF-κB蛋白的登录号</span></span></code><code><span>           </span></code><code><span><span>prot_data</span> &lt;- drawProteins::get_features(<span>"Q04206 Q01201 Q04864 P19838 Q00653"</span>)</span></code></pre></section><p><span></span><span><img data-imgfileid="100003696" data-ratio="0.07692307692307693" data-type="png" data-w="897" width="553.739990234375" height="42.52996826171875" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/2wJ7bWfS0QuRd6AkicPqSMM23HXyLRQqjyNoDAVOTmAbwloJ6DHSCRYzI0hk9eQ0KnKBIYLU7enYlX0ChfFKPNA/640?wx_fmt=png" src="https://mmbiz.qpic.cn/sz_mmbiz_png/2wJ7bWfS0QuRd6AkicPqSMM23HXyLRQqjyNoDAVOTmAbwloJ6DHSCRYzI0hk9eQ0KnKBIYLU7enYlX0ChfFKPNA/640?wx_fmt=png"></span><span></span></p><p><span>然后我们去绘制图，原理和上述绘制的代码差不多，来看看</span></p><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="properties"><code><span><span>对数据的加载</span></span></code><code><span><span>p</span> <span>&lt;- draw_canvas(prot_data)</span></span></code><code><span><span>p</span> <span>&lt;- draw_chains(p, prot_data)</span></span></code><code><span><span>p</span> <span>&lt;- draw_domains(p, prot_data)    </span></span></code><code><span><span>p</span> <span>&lt;- draw_repeat(p, prot_data)</span></span></code><code><span><span>p</span> <span>&lt;- draw_motif(p, prot_data)</span></span></code><code><span><span>p</span> <span>&lt;- draw_phospho(p, prot_data, size = 8)</span></span></code><code><span><span># 背景和y轴</span></span></code><code><span><span>p</span> <span>&lt;- p + theme_bw(base_size = 20) + # 白色背景&amp;更改文本大小</span></span></code><code><span> </span></code><code><span>  <span>theme(panel.grid.minor</span>=<span>element_blank(),</span></span></code><code><span>        <span>panel.grid.major</span>=<span>element_blank()) +</span></span></code><code><span>  <span>theme(axis.ticks</span> = <span>element_blank(),</span></span></code><code><span>        <span>axis.text.y</span> = <span>element_blank()) +</span></span></code><code><span>  <span>theme(panel.border</span> = <span>element_blank())</span></span></code><code><span><span>           </span></span></code><code><span><span># 添加标题</span></span></code><code><span><span>rel_subtitle</span> <span>&lt;- paste0("circles = phosphorylation sites\n",</span></span></code><code><span>                       <span>"RHD</span> = <span>Rel Homology Domain\nsource:Uniprot")</span></span></code><code><span>           </span></code><code><span><span>p</span> <span>&lt;- p + labs(title = "Schematic of human NF-kappaB proteins",</span></span></code><code><span>              <span>subtitle</span> = <span>rel_subtitle)</span></span></code><code><span><span>           </span></span></code><code><span><span># 将图例移到顶部</span></span></code><code><span><span>p</span> <span>&lt;- p + theme(legend.position="top") + labs(fill="")</span></span></code><code><span><span>p</span>    <span></span></span></code></pre></section><p><page></page><span><img data-imgfileid="100003698" data-ratio="0.5731481481481482" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/2wJ7bWfS0QuRd6AkicPqSMM23HXyLRQqj97YyKWJicFicLOs3AvuqqKdU5PbondxE2ribjm4XibXKjYmuuatpBExfXA/640?wx_fmt=png" data-type="png" data-w="1080" height="317.1400146484375" width="553.739990234375" src="https://mmbiz.qpic.cn/sz_mmbiz_png/2wJ7bWfS0QuRd6AkicPqSMM23HXyLRQqj97YyKWJicFicLOs3AvuqqKdU5PbondxE2ribjm4XibXKjYmuuatpBExfXA/640?wx_fmt=png"></span><span></span></p><p><span>如果小伙伴不喜欢图片的样式，我们可以通过ggplot2去调整</span></p><section><ul><li><li></ul><pre data-lang="powershell"><code><span><span>#自定义绘图函数</span></span></code><code><span><span>data</span>(<span>"five_rel_data"</span>)</span></code></pre></section><p><span></span><span><img data-imgfileid="100003697" data-ratio="0.4945054945054945" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/2wJ7bWfS0QuRd6AkicPqSMM23HXyLRQqjGhZ2nqhXUOJDeS2p9xhvRUWOvG7VxT7zjTCX36cxblbo461cf38Xicg/640?wx_fmt=png" data-type="png" data-w="910" height="273.79998779296875" width="553.739990234375" src="https://mmbiz.qpic.cn/sz_mmbiz_png/2wJ7bWfS0QuRd6AkicPqSMM23HXyLRQqjGhZ2nqhXUOJDeS2p9xhvRUWOvG7VxT7zjTCX36cxblbo461cf38Xicg/640?wx_fmt=png"></span></p><section><ul><li><li><li><li><li><li></ul><pre data-lang="properties"><code><span><span>p</span> <span>&lt;- draw_canvas(five_rel_data)</span></span></code><code><span><span>p</span> <span>&lt;- draw_chains(p, five_rel_data,</span></span></code><code><span>                 <span>label_chains</span> = <span>FALSE,</span></span></code><code><span>                 <span>fill</span> = <span>"hotpink",    </span></span></code><code><span>                 <span>outline</span> = <span>"midnightblue")</span></span></code><code><span><span>p</span></span></code></pre></section><p><span></span><span><img data-imgfileid="100003701" data-ratio="1.1160220994475138" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/2wJ7bWfS0QuRd6AkicPqSMM23HXyLRQqjThPJFZj58icLmX5RYKyezRzjWb7eQnLkC1It66kID3AyIibAaMRXb00g/640?wx_fmt=png" data-type="png" data-w="543" height="605.9299926757812" width="542.9400024414062" src="https://mmbiz.qpic.cn/sz_mmbiz_png/2wJ7bWfS0QuRd6AkicPqSMM23HXyLRQqjThPJFZj58icLmX5RYKyezRzjWb7eQnLkC1It66kID3AyIibAaMRXb00g/640?wx_fmt=png"></span><span></span></p><p><span>还可以更改蛋白结构中磷酸化符号的大小和颜色</span></p><section><ul><li><li><li><li><li><li><li><li></ul><pre data-lang="properties"><code><span><span>#符号的大小和颜色</span></span></code><code><span><span>p</span> <span>&lt;- draw_canvas(five_rel_data)</span></span></code><code><span><span>p</span> <span>&lt;- draw_chains(p, five_rel_data,</span></span></code><code><span>                 <span>fill</span> = <span>"lightsteelblue1",    </span></span></code><code><span>                 <span>outline</span> = <span>"grey",</span></span></code><code><span>                 <span>label_size</span> = <span>5)</span></span></code><code><span><span>p</span> <span>&lt;- draw_phospho(p, five_rel_data, size = 10, fill = "red")</span></span></code><code><span><span>p</span> <span>+ theme_bw()</span></span></code></pre></section><p><span></span><span><img data-imgfileid="100003702" data-ratio="0.5425925925925926" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/2wJ7bWfS0QuRd6AkicPqSMM23HXyLRQqjBmdeMIiak638Q127BBsVFf1MloOOeQvusYwCv8mB53ZT9clj9U5qNyw/640?wx_fmt=png" data-type="png" data-w="1080" height="300.6000061035156" width="553.739990234375" src="https://mmbiz.qpic.cn/sz_mmbiz_png/2wJ7bWfS0QuRd6AkicPqSMM23HXyLRQqjBmdeMIiak638Q127BBsVFf1MloOOeQvusYwCv8mB53ZT9clj9U5qNyw/640?wx_fmt=png"></span><span></span></p><p><span>还可以将标签更改为自定义列表</span></p><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="nginx"><code><span><span>p</span> &lt;- draw_canvas(five_rel_data)</span></code><code><span>p &lt;- draw_chains(p, five_rel_data,</span></code><code><span>                 fill = <span>"lightsteelblue1"</span>,</span></code><code><span>                 outline = <span>"grey"</span>,</span></code><code><span>                 labels = c(<span>"p50/p105"</span>,</span></code><code><span>                            <span>"p50/p105"</span>,</span></code><code><span>                            <span>"p52/p100"</span>,</span></code><code><span>                            <span>"p52/p100"</span>,</span></code><code><span>                            <span>"Rel B"</span>,</span></code><code><span>                            <span>"c-Rel"</span>,    </span></code><code><span>                            <span>"p65/Rel A"</span>),</span></code><code><span>                 label_size = <span>5</span>)</span></code><code><span>p &lt;- draw_phospho(p, five_rel_data, size = <span>8</span>, fill = <span>"red"</span>)</span></code><code><span>p + theme_bw()</span></code></pre></section><p><span></span><span><img data-imgfileid="100003703" data-ratio="0.5138888888888888" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/2wJ7bWfS0QuRd6AkicPqSMM23HXyLRQqjxIF2jkjkeydwIpp34O2r7LMSI6uZcoiaBFDTYibn029ZC6u1HibrpEPCA/640?wx_fmt=png" data-type="png" data-w="1080" height="284.739990234375" width="553.739990234375" src="https://mmbiz.qpic.cn/sz_mmbiz_png/2wJ7bWfS0QuRd6AkicPqSMM23HXyLRQqjxIF2jkjkeydwIpp34O2r7LMSI6uZcoiaBFDTYibn029ZC6u1HibrpEPCA/640?wx_fmt=png"></span><span></span></p><p><span>好了，到此，我们的蛋白质结构学习就完成了，小伙伴要多多理解代码的意思，上述一些细节都是我们平时在用ggplot2绘制图片的时候接触过的，小伙伴可能有的比较熟悉，所以，学会这个章节给自己的文章添加一些亮点，快去亲自动手试试吧！</span></p><section><span><br></span></section><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><svg viewbox="0 0 1 1"></svg></section></section></section><section><section powered-by="xiumi.us"><p>E</p></section></section><section><section powered-by="xiumi.us"><p>N</p></section></section><section><section powered-by="xiumi.us"><p>D</p></section></section><section><section powered-by="xiumi.us"><section><br></section></section></section></section></section><p><span>如果您的时间和精力有限或者缺乏相关经验，并且对生信分析和期刊推荐有所需要的话，我们非常乐意为您提供如下服务：免费思路评估、付费生信分析和方案设计以及付费选刊等，有意向的小伙伴欢迎咨询师妹哦！</span></p><p><span></span><span></span></p><section powered-by="xiumi.us"><p><img data-cropselx1="18" data-cropselx2="493" data-cropsely1="0" data-cropsely2="227" data-galleryid="" data-imgfileid="100010279" data-ratio="0.4444444444444444" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/oCSOtP61aEUqAk7f4mcKxwPx45IICz1wNazhXRTUEVx9ia4aYAawCG8smiaXiaJRzR0LiaEF0rUpevlfn6W3nnm4vA/640?wx_fmt=other&amp;from=appmsg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1&amp;tp=webp" data-type="jpeg" data-w="900" src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/oCSOtP61aEUqAk7f4mcKxwPx45IICz1wNazhXRTUEVx9ia4aYAawCG8smiaXiaJRzR0LiaEF0rUpevlfn6W3nnm4vA/640?wx_fmt=other&amp;from=appmsg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1&amp;tp=webp"></p><p><br></p><p><br></p></section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><svg viewbox="0 0 1 1"></svg></section></section></section></section></section><section><section powered-by="xiumi.us"><p><strong>往期推荐</strong></p></section></section><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><svg viewbox="0 0 1 1"></svg></section></section></section></section></section></section><section powered-by="xiumi.us"><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=Mzg5MDk3Mzg4OA==&amp;mid=2247492496&amp;idx=1&amp;sn=b3be5983f3f8f068ebdf1b773b7cb792&amp;chksm=cfd6d83ff8a15129493abd81502ab5c3128247ff20fd576c1ba880303f346110e8bee971478e&amp;scene=21#wechat_redirect" textvalue="别再说纯生信想不出好思路了！北大深圳医院黄晓彦团队基于UKB数据库,孟德尔随机化一套连招拿下13分+！" linktype="text" imgurl="" imgdata="null" data-itemshowtype="11" tab="innerlink" data-linktype="2" hasload="1">别再说纯生信想不出好思路了！北大深圳医院黄晓彦团队基于UKB数据库,孟德尔随机化一套连招拿下13分+！</a></p><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=Mzg5MDk3Mzg4OA==&amp;mid=2247492387&amp;idx=1&amp;sn=fc12277c2ebd379a297d0c7a2c96c970&amp;chksm=cfd6d88cf8a1519a3a6eb4938cb44ebcb2d1b857ffc558c1c033ac88913384cb2f11d03a00f4&amp;scene=21#wechat_redirect" textvalue="师妹手把手带你复现IF5.8《Cancer Cell International》杂志的高分文章中相关性热图和散点图" linktype="text" imgurl="" imgdata="null" data-itemshowtype="11" tab="innerlink" data-linktype="2" hasload="1">师妹手把手带你复现IF5.8《Cancer Cell International》杂志的高分文章中相关性热图和散点图</a><br></p><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=Mzg5MDk3Mzg4OA==&amp;mid=2247492197&amp;idx=1&amp;sn=40540e16ddc99310445236401505c47e&amp;chksm=cfd6d9caf8a150dc8f010750cacc4bd241ed68a8974593d499c1b34edf5f222de567732a5705&amp;scene=21#wechat_redirect" textvalue="是谁还不会用孟德尔随机化？这篇文章教你！高分SCI不是梦！！" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1">是谁还不会用孟德尔随机化？这篇文章教你！高分SCI不是梦！！</a><br></p><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=Mzg5MDk3Mzg4OA==&amp;mid=2247488665&amp;idx=1&amp;sn=6d7b7b1e8b36a92df691b0ab014e7663&amp;chksm=cfd52f36f8a2a620a790e74d99e3d8af879904a131c4e1f653448590453941b7ff356d486531&amp;scene=21#wechat_redirect" textvalue="师妹教你R包EnhancedVolcano超详尽，让你的火山图喷发姿势更帅" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1">师妹教你R包EnhancedVolcano超详尽，让你的火山图喷发姿势更帅</a></p></section><p><span><br></span></p><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/oV1lAm1SgG70FXfCOoj-ng",target="_blank" rel="noopener noreferrer">原文链接</a>
