---
title: "作者为什么要上传一个错误的表达量矩阵呢"
date: 2024-08-09T13:12:42Z
draft: ["false"]
tags: [
  "fetched",
  "珠海健明生物医药科技"
]
categories: ["Acdemic"]
---
作者为什么要上传一个错误的表达量矩阵呢 by 珠海健明生物医药科技
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><blockquote data-tool="mdnice编辑器"><p>马拉松授课的一个学员孜孜不倦的互动了十几个问题了，终于到了单细胞环节。</p></blockquote><p data-tool="mdnice编辑器">凭我对他的了解，他肯定是提问的方式就是错误的，写一段自己的”感悟“，其实完全没必要，我也压根不会看他给出来的这些“长篇大论” ：</p><p><img data-galleryid="" data-ratio="1.314769975786925" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wwjL7lJ8RrW4AicxLerNEibwNlj4swF9icqScsMA9bAY1PT3Nk10ichcWuzNZLxGXcm2icLgLQjRIA47TQ/640?wx_fmt=png" data-type="png" data-w="413" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wwjL7lJ8RrW4AicxLerNEibwNlj4swF9icqScsMA9bAY1PT3Nk10ichcWuzNZLxGXcm2icLgLQjRIA47TQ/640?wx_fmt=png"></p><figure data-tool="mdnice编辑器"><figcaption>提问的方式就是错误的</figcaption></figure><p data-tool="mdnice编辑器">这样的提问完全没有用，没有代码，没有前因后果，其实给一下数据集就足够了，https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE145173</p><p data-tool="mdnice编辑器">我们很容易自己去查看这个数据集的文件：</p><pre data-tool="mdnice编辑器"><span></span><code>GSM4307836_SI_GA_H1_quants_mat.csv.gz 53.9 Mb<br>GSM4307836_SI_GA_H1_quants_mat_cols.txt.gz 430.6 Kb<br>GSM4307836_SI_GA_H1_quants_mat_rows.txt.gz 54.7 Kb<br><br>GSM4307837_SI_GA_H4_quants_mat.csv.gz 4.6 Mb<br>GSM4307837_SI_GA_H4_quants_mat_cols.txt.gz 430.6 Kb<br>GSM4307837_SI_GA_H4_quants_mat_rows.txt.gz 6.9 K<br></code></pre><p data-tool="mdnice编辑器">给人的感觉是，它这个文章作者对每个样品上传了3个文件，是很容易读取的。</p><pre data-tool="mdnice编辑器"><span></span><code>GSM4307836 Mouse_PDGFRab_Sham<br>GSM4307837 Mouse_PDGFRab_UUO<br></code></pre><p data-tool="mdnice编辑器">但是实际上，作者给出来的 _quants_mat.csv.gz 并不是常规的表达量矩阵：</p><pre data-tool="mdnice编辑器"><span></span><code>&gt; library(data.table) <br>&gt; a=fread(<span>'GSE145173_RAW/GSM4307836_SI_GA_H1_quants_mat.csv.gz'</span>,<br>+         data.table = F)<br>There were 50 or more warnings (use warnings() to see the first 50)<br>&gt; a[1:4,1:4]<br>  V1 V2 V3 V4<br>1 19  0  0  0<br>2 32  0  0  0<br>3 53  0  0  0<br>4 37  0  0  0<br>&gt; dim(a)<br>[1] 10812 53699<br></code></pre><p data-tool="mdnice编辑器">如果是从这个行列式的数量来看，应该是1万多个细胞，然后是五万多个基因啦。</p><p data-tool="mdnice编辑器">所以，如果是简单的基于这个  _quants_mat.csv.gz 文件去做单细胞转录组降维聚类分群是肯定是会有大麻烦！或者说， 如果是自己学艺不精，就会以为作者上传了错误的矩阵。因为最后这个读取确实是太复杂了：</p><pre data-tool="mdnice编辑器"><span></span><code>{<br>  <span>library</span>(data.table) <br>  a=fread(<span>'GSE145173_RAW/GSM4307836_SI_GA_H1_quants_mat.csv.gz'</span>,<br>          data.table = <span>F</span>)<br>  head(a[,<span>1</span>:<span>4</span>])<br>  tail(a[,<span>1</span>:<span>4</span>])<br>  head(t(a)[,<span>1</span>:<span>4</span>])<br>  tail(t(a)[,<span>1</span>:<span>4</span>])<br>  dim(a)<br>  cl=fread(<span>'GSE145173_RAW/GSM4307836_SI_GA_H1_quants_mat_cols.txt.gz'</span>,<br>           header = <span>F</span>,data.table = <span>F</span> ) <br>  dim(cl)<br>  length(unique(cl$V2))<br>  kp = duplicated(cl$V2)<br>  table(kp)<br>  cl=cl[!kp,]<br>  <span># 不知道为什么表达量矩阵跟它给出来的基因名字，行数不匹配，我被迫删除了其中两个基因，但是不知道是否造成了基因错位。。。。</span><br>  a=a[,<span>1</span>:(ncol(a)-<span>2</span>)]<br>  <br>  rl=fread(<span>'GSE145173_RAW/GSM4307836_SI_GA_H1_quants_mat_rows.txt.gz'</span>,<br>           header = <span>F</span>,data.table = <span>F</span> )  <br>  head(rl) <br>  mtx=t(a[,!kp])<br>  dim(mtx)<br>  rownames(mtx)=cl$V2 <br>  colnames(mtx)=rl$V1<br>  mtx[<span>1</span>:<span>4</span>,<span>1</span>:<span>4</span>]<br>  sce1=CreateSeuratObject(counts =  mtx,project = <span>'h1'</span>  )<br>  sce1<br>}<br><br></code></pre><p data-tool="mdnice编辑器">但是接下来我检查数据分析结果的时候，发现确实是造成了基因错位。。。。</p><p><img data-galleryid="" data-ratio="0.9259681093394078" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wwjL7lJ8RrW4AicxLerNEibwNWh43IfPrkBDhno6WSc0ZD1icvEdpxFymQ5431DJaXKoKuOURvIdPqLw/640?wx_fmt=png" data-type="png" data-w="878" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wwjL7lJ8RrW4AicxLerNEibwNWh43IfPrkBDhno6WSc0ZD1icvEdpxFymQ5431DJaXKoKuOURvIdPqLw/640?wx_fmt=png"></p><figure data-tool="mdnice编辑器"><figcaption>降维聚类分群结果问题不大</figcaption></figure><p data-tool="mdnice编辑器">因为后面的降维聚类分群结果问题不大，但是基因在上面就显得很突兀，基本上没有任何一个我认识的基因。。。</p><p><img data-galleryid="" data-ratio="1.4066666666666667" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wwjL7lJ8RrW4AicxLerNEibwNd5FBWiaRic8Is3TWxibFMRibm1AJlrjTxg1hrJiaPrnaJMOF4LiaYLbuiaPJg/640?wx_fmt=png" data-type="png" data-w="600" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wwjL7lJ8RrW4AicxLerNEibwNd5FBWiaRic8Is3TWxibFMRibm1AJlrjTxg1hrJiaPrnaJMOF4LiaYLbuiaPJg/640?wx_fmt=png"></p><figure data-tool="mdnice编辑器"><figcaption>基因在上面就显得很突兀</figcaption></figure><p data-tool="mdnice编辑器">Decoding myofibroblast origins in human kidney fibrosis. <em>Nature</em> 2021 Jan 人家的文章发表在CNS啊！</p><p data-tool="mdnice编辑器">我实在是没办法理解， <strong>既然同学们要重复使用他们的数据</strong>，居然不认真彻底读懂文章，简直是对科研的侮辱！！！但凡看了看文章就知道这个样品：</p><p data-tool="mdnice编辑器">https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSM4307836</p><p data-tool="mdnice编辑器">给出来的是：raw UMI barcode count matrices produced by Alevin in csv files and corresponding row (gene) and column (cell barcode) information</p><p data-tool="mdnice编辑器">虽然说这个单细胞确实是 10x chromium version 2 ，但是作者，走的是另外一个流程，Data processing Fastq files were processed using Alevin and Salmon (salmon version 0.13.1)</p><p data-tool="mdnice编辑器">所以给出来的表达量矩阵格式是需要重新学习的，不能说仅仅是照搬10x的cellranger那一套！！！</p><p data-tool="mdnice编辑器">官方文档写的很清楚：https://salmon.readthedocs.io/en/latest/alevin.html#</p><p data-tool="mdnice编辑器">A typical run of alevin will generate 4 files:</p><ul data-tool="mdnice编辑器"><li><section><em>quants_mat.gz</em> – Compressed count matrix.</section></li><li><section><em>quants_mat_cols.txt</em> – Column Header (Gene-ids) of the matrix.</section></li><li><section><em>quants_mat_rows.txt</em> – Row Index (CB-ids) of the matrix.</section></li><li><section><em>quants_tier_mat.gz</em> – Tier categorization of the matrix.</section></li></ul><p data-tool="mdnice编辑器">而且文章是给出来了全部的代码：</p><ul data-tool="mdnice编辑器"><li><section>All R and Python packages used in data analysis are described here: https://raw.githubusercontent.com/mahmoudibrahim/KidneyMap/master/requirements.txt. Additional software used for data analysis: Graphpad, FlowJo, ImageJ.</section></li><li><section>All scripts used for single cell RNA-seq data analysis are available here: https://github.com/mahmoudibrahim/KidneyMap/</section></li><li><section>Scripts used imaging in situ hybridization are available here: https://gitlab.com/mklaus/segment_cells_register_marker</section></li></ul><h3 data-tool="mdnice编辑器"><span></span>直播预告<span></span></h3><p data-tool="mdnice编辑器">既然是<strong>上面的文章的数据可以使用  Alevin and Salmon  ，那么理论上也可以使用10x的cellranger流程，我们就可以对比下了</strong>。我们在最新的唐医生服务器上面给大家演示吧！</p></section><h4 data-tool="mdnice编辑器">文末友情宣传</h4><p data-tool="mdnice编辑器">强烈建议你推荐给身边的<strong>博士后以及年轻生物学PI</strong>，多一点数据认知，让他们的科研上一个台阶：</p><ul data-tool="mdnice编辑器"><li><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247524930&amp;idx=5&amp;sn=19d5eb52cbba6389c6238cd7943d96c7&amp;chksm=9b4b22f9ac3cabefa5c0436a6e723c3ad447fd67bdd2f9d500043220c5e97e6934b6015977e3&amp;scene=21#wechat_redirect" textvalue="生物信息学马拉松授课（买一得‍五）" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1">生物信息学马拉松授课（买一得五）</a> ，你的生物信息学入门课</section></li><li><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247524148&amp;idx=1&amp;sn=7806da6feb41a36493c519c1cfc1d3ac&amp;chksm=9b4bdf8fac3c569960369602f1ef26639cb366b250f233b2297d1f059471c0458335bfc0b829&amp;scene=21#wechat_redirect" textvalue="时隔5年，我们的生信技能树VIP学徒继续招生啦" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1">时隔5年，我们的生信技能树VIP学徒继续招生啦</a><br></section></li><li><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247522831&amp;idx=2&amp;sn=1744efdf428465425a145ff3a982198b&amp;chksm=9b4bdab4ac3c53a28fbecbbff4f254f470b54a7a20468bb753b295b930315e1ec45bcbabc10b&amp;scene=21#wechat_redirect" textvalue="144线程640Gb内存服务器共享一年‍仍然是仅需800" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1">144线程640Gb内存服务器共享一年仍然是仅需800</a></section></li><li><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247519765&amp;idx=1&amp;sn=ce5a8c8182f854c88043059f8c2cb9ff&amp;chksm=9b4bceaeac3c47b88c19941d43dbb1401f3a92206481a0afc41159927868199643f795d62a7e&amp;scene=21#wechat_redirect" textvalue="千呼万唤始出来的独享生物信息学云服务器" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1">千呼万唤始出来的独享生物信息学云服务器</a></section></li><li><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247519765&amp;idx=1&amp;sn=ce5a8c8182f854c88043059f8c2cb9ff&amp;chksm=9b4bceaeac3c47b88c19941d43dbb1401f3a92206481a0afc41159927868199643f795d62a7e&amp;scene=21#wechat_redirect" textvalue="千呼万唤始出来的独享生物信息学云服务器" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1"></a><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247524275&amp;idx=1&amp;sn=fa592ee29f636f34387491d0fceadd8e&amp;chksm=9b4bdf08ac3c561e0881974b3817beb0a0e514dc1a8df4c34c2b6653da6fa78e09acb03c70c2&amp;scene=21#wechat_redirect" textvalue="生信技能树知识整理实习生又又又开放申请啦" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1">生信技能树知识整理实习生又又又开放申请啦</a></section></li><li><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247524432&amp;idx=1&amp;sn=5b33b0c6807a9e6939c332c58fabff89&amp;chksm=9b4b20ebac3ca9fdb3d8bfaf2bef5552f64eb70e7fae557cc7197fb1a23b3e8bc31b585bf829&amp;scene=21#wechat_redirect" textvalue="生信共享办公室出租" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1">生信共享办公室出租</a></p></li></ul><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/gVzeJdhHtpOvyhdu8XVYvw",target="_blank" rel="noopener noreferrer">原文链接</a>
