---
title: "获取msigdb所有通路或者特定通路、基因代码"
date: 2024-08-05T06:54:34Z
draft: ["false"]
tags: [
  "fetched",
  "生信小博士"
]
categories: ["Acdemic"]
---
获取msigdb所有通路或者特定通路、基因代码 by 生信小博士
------
<div><span>‍</span><span>‍</span><p>MSigDB (Molecular Signatures Database) 是一个广泛使用的数据库，包含了各种生物学通路和基因集，用于基因表达数据的功能注释和解释。MSigDB的数据集分为多个类别，每个类别包含不同类型的基因集，这些基因集可以用来进行各种生物学和医学研究。</p><p><img data-galleryid="" data-imgfileid="100003887" data-ratio="0.3074074074074074" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345SksJNhK5KKzp8JTHT052r71VtpDiciaCEqIpWa1iazYcXzHTW8SrfOy05UtDqLUERicGHq1u6EzCJfH8GQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345SksJNhK5KKzp8JTHT052r71VtpDiciaCEqIpWa1iazYcXzHTW8SrfOy05UtDqLUERicGHq1u6EzCJfH8GQ/640?wx_fmt=png&amp;from=appmsg"></p><p><span><strong>1.获取msigdb所有通路或者特定通路、基因代码</strong></span></p><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="css"><p><code><span>#2提取并制备人的human|mouse列表---------</span></code><code><span>if(T){</span></code><code><span>  msigdbr::msigdbr_collections()</span></code><code><span>  all_gene_sets_hs = msigdbr::msigdbr(species = "Homo sapiens") #Mus musculus  Homo sapiens ,category = "C2",subcategory = "CP"</span></code><code><span>  dim(all_gene_sets_hs)</span></code><code><span>  #saveRDS(all_gene_sets_hs,file="~/datasets/all_gene_sets_hs_msigdb.rds")</span></code><code><span><br></span></code><code><span>  all_gene_sets_hs = msigdbr::msigdbr(species = "Mus musculus" ) #Mus musculus  Homo sapiens</span></code><code><span>  dim(all_gene_sets_hs)</span></code><code><span>  #saveRDS(all_gene_sets_hs,file="~/datasets/all_gene_sets_mm_msigdb.rds")</span></code><code><span>  all_gene_sets_hs </span></code><code><span>  table(all_gene_sets_hs$gs_subcat)</span></code><code><span>  table(all_gene_sets_hs$gs_cat)</span></code><code><span><br></span></code><code><span><br></span></code><code><span>  #假设我们这里想要寻找的是APOPTOSIS相关通路</span></code><code><span><br></span></code><code><span>  #pattern参数内输入想要寻找的关键词，这里用的是"APOPTOSIS"</span></code><code><span><br></span></code><code><span>  h2 &lt;-   all_gene_sets_hs             #all_gene_sets_hs[grep(pattern = "APOPTOSIS",x = all_gene_sets_hs$gs_name,ignore.case = TRUE),]</span></code><code><span><br></span></code><code><span>  length(unique(h2$gs_name))#查看唯一通路</span></code><code><span><br></span></code><code><span>  length(unique(h2$human_gene_symbol))#查看所有通路中的唯一基因</span></code><code><span>  length(unique(h2$gene_symbol))#查看所有通路中的唯一基因</span></code><code><span>  table(h2$gs_subcat)</span></code><code><span>  #table(h2$gs_name)</span></code><code><span>  library(dplyr)</span></code><code><span>  h2[h2$gs_cat=='C3'  ,] %&gt;% .$gs_subcat %&gt;% table()</span></code><code><span><br></span></code><code><span><br></span></code><code><span>   h2[h2$gs_cat=='C3'  &amp;</span></code><code><span>        h2$gs_subcat=='TFT:GTRD' | h2$gs_subcat=='TFT:TFT_Legacy' </span></code><code><span>       ,] %&gt;% .$gs_subcat %&gt;% table()</span></code><code><span><br></span></code><code><span>  table(h2$gs_subcat)</span></code><code><span><br></span></code><code><span>  getwd()</span></code><code><span>  #openxlsx::write.xlsx(h2,"allPathway.xlsx")#保存结果 </span></code><code><span>  #save(h2,file = "allPathway.rds")</span></code><code><span><br></span></code><code><span><br></span></code><code><span>  # 3将数据转换为嵌套列表------------</span></code><code><span>  nested_list &lt;- h2 %&gt;%</span></code><code><span>    group_by(gs_cat, gs_name) %&gt;%</span></code><code><span>    summarise(gene_symbol = list(gene_symbol), .groups = 'drop') %&gt;%</span></code><code><span>    group_by(gs_cat) %&gt;%</span></code><code><span>    summarise(gs_name = list(set_names(gene_symbol, gs_name)), .groups = 'drop') %&gt;%</span></code><code><span>    deframe()</span></code><code><span><br></span></code><code><span>  # 查看结果</span></code><code><span>  # nested_list$C1[[1]]</span></code><code><span>  # head(names(nested_list$C1))</span></code><code><span><br></span></code><code><span><br></span></code><code><span><br></span></code><code><span>  #4 加载silicosis空转数据----</span></code><code><span>  # h2_list=split(x = h2$gene_symbol,f=h2$gs_name )</span></code><code><span>  # h2_list</span></code><code><span>  load("~/silicosis_spatial/d.all.rds")</span></code><code><span><br></span></code><code><span>  DefaultAssay(d.all)="SCT"</span></code><code><span>  d.all=SCTransform(d.all,vars.to.regress = "stim",assay = "Spatial")</span></code><code><span>  dim(d.all)</span></code><code><span><br></span></code><code><span>  # SpatialFeaturePlot(d.all,features = 'Mmp12')</span></code><code><span>  # </span></code><code><span><br></span></code><code><span>  #head(d.all@meta.data)</span></code><code><span><br></span></code><code><span>  mygenes=nested_list</span></code><code><span><br></span></code><code><span><br></span></code><code><span>}</span></code><code><span><br></span></code></p></pre></section><p><br></p><p><strong><span>2 MSigDB数据集的主要分类及其含义、分类理由和用途：</span></strong><span></span></p><p><strong><span><img data-galleryid="" data-imgfileid="100003889" data-ratio="0.3074074074074074" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345SksJNhK5KKzp8JTHT052r71VtpDiciaCEqIpWa1iazYcXzHTW8SrfOy05UtDqLUERicGHq1u6EzCJfH8GQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345SksJNhK5KKzp8JTHT052r71VtpDiciaCEqIpWa1iazYcXzHTW8SrfOy05UtDqLUERicGHq1u6EzCJfH8GQ/640?wx_fmt=png&amp;from=appmsg"></span></strong></p><p><strong><span><img data-galleryid="" data-imgfileid="100003888" data-ratio="0.14852492370295015" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345SksJNhK5KKzp8JTHT052r71VNhavibgCxHibzFohKGk4YEnR6P3EPjc8zKjRHmibnVGBoXhLs4ic6cJYww/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="983" src="https://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345SksJNhK5KKzp8JTHT052r71VNhavibgCxHibzFohKGk4YEnR6P3EPjc8zKjRHmibnVGBoXhLs4ic6cJYww/640?wx_fmt=png&amp;from=appmsg"></span></strong></p><h3>1. <strong>C1:<span> CGN (Chromosomal Location)</span></strong></h3><ul><li><p><strong>含义</strong>：包含基因在染色体上的物理位置，通常根据染色体带区进行分类。</p></li><li><p><strong>分类理由</strong>：基于基因在染色体上的位置，方便研究染色体区域与特定疾病或表型的相关性。</p></li><li><p><strong>用途</strong>：用于研究特定染色体区域的基因表达模式，以及这些区域的基因在疾病中的作用。</p></li></ul><h3>2. <strong>C2: <span>CGP (Chemical and Genetic Perturbations)</span></strong></h3><ul><li><p><strong>含义</strong>：包含基因集，基于对细胞或有机体进行化学或基因干扰后的表达变化。</p></li><li><p><strong>分类理由</strong>：根据基因在化学处理（如药物）或基因操作（如基因敲除、过表达）后的反应进行分类。</p></li><li><p><strong>用途</strong>：用于研究化学物质或基因干扰对基因表达的影响，探索潜在的治疗靶点。</p></li></ul><h3>3. <strong>C3: CM (Motif Gene Sets)</strong></h3><ul><li><p><strong>含义</strong>：基于共表达基因的共有序列模式（如转录因子结合位点）。</p></li><li><p><strong>分类理由</strong>：根据基因的序列特征和转录调控元件进行分类。</p></li><li><p><strong>用途</strong>：研究转录因子和其他调控蛋白如何影响基因表达。</p></li></ul><h3>4. <strong>C4: CP (Canonical Pathways)</strong></h3><ul><li><p><strong>含义</strong>：由公共数据库（如BIOCARTA、KEGG、PID、REACTOME、WIKIPATHWAYS）提供的标准生物学通路。</p></li><li><p><strong>分类理由</strong>：根据预定义的生物学通路进行分类。</p></li><li><p><strong>用途</strong>：研究细胞内信号传导、代谢路径和其他生物学过程。</p></li></ul><h3>5. <strong>C5: GO (Gene Ontology)</strong></h3><ul><li><p><strong>含义</strong>：基于基因本体论（GO）注释，包括生物过程（GO）、细胞组分（GO）和分子功能（GO）。</p></li><li><p><strong>分类理由</strong>：根据GO注释提供的基因功能分类系统进行分类。</p></li><li><p><strong>用途</strong>：研究基因在不同生物过程、细胞组分和分子功能中的作用。</p></li></ul><h3>6. <strong>C6: <span>HPO (Human Phenotype Ontology)</span></strong></h3><ul><li><p><strong>含义</strong>：基于人类表型注释的基因集。</p></li><li><p><strong>分类理由</strong>：根据与人类疾病表型相关的基因进行分类。</p></li><li><p><strong>用途</strong>：研究基因与人类疾病表型的关系，识别潜在的疾病相关基因。</p></li></ul><h3>7. <strong>C7: <span>IMMUNESIGDB (Immune Signatures)</span></strong></h3><ul><li><p><strong>含义</strong>：与免疫系统相关的基因集。</p></li><li><p><strong>分类理由</strong>：根据免疫系统的不同细胞类型、状态和功能进行分类。</p></li><li><p><strong>用途</strong>：研究免疫系统的基因表达模式，探索免疫相关疾病的分子机制。</p></li></ul><h3>8. <strong>C8: MIR (miRNA Targets)</strong></h3><ul><li><p><strong>含义</strong>：基于miRNA靶基因的基因集，包括MIR和MIR。</p></li><li><p><strong>分类理由</strong>：根据miRNA调控的靶基因进行分类。</p></li><li><p><strong>用途</strong>：研究miRNA在基因调控中的作用，探索miRNA与疾病的关联。</p></li></ul><h3>9. <strong>C9: <span>TFT (Transcription Factor Targets)</span></strong></h3><ul><li><p><strong>含义</strong>：基于转录因子靶基因的基因集，包括TFT和TFT。</p></li><li><p><strong>分类理由</strong>：根据转录因子调控的靶基因进行分类。</p></li><li><p><strong>用途</strong>：研究转录因子在基因表达调控中的作用，探索转录因子与疾病的关联。</p></li></ul><h3>10. <strong>C10: VAX (Vaccine Signatures)</strong></h3><ul><li><p><strong>含义</strong>：与疫苗相关的基因集。</p></li><li><p><strong>分类理由</strong>：根据疫苗反应相关的基因进行分类。</p></li><li><p><strong>用途</strong>：研究疫苗对基因表达的影响，探索疫苗反应的分子机制。</p></li></ul><p><br></p><p>每个类别的基因集可以用于不同的生物学研究，如探索疾病机制、寻找潜在的治疗靶点、研究基因调控网络等。通过对这些基因集进行功能注释和通路分析，可以更好地理解基因表达数据的生物学意义。</p><p><mp-common-profile data-pluginname="mpprofile" data-id="Mzg2NDcxMzYwNg==" data-headimg="http://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345Sks7JhVxUX46ZKxPSob6ptqIZgnIEnHOn5VMwCX8sN6MQy1Pq4XXFEOJ6grAmsoQugyCDKOZictDBHA/0?wx_fmt=png" data-nickname="生信小博士" data-alias="bioinformatics_Dr" data-signature="【生物信息学】R语言开始，学习生信。Seurat，单细胞测序，空间转录组。 Python，scanpy，cell2location。资料分享" data-from="0" data-is_biz_ban="0"></mp-common-profile></p><p><span>‍</span></p><span>‍</span><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/P880vYXhzCKen9dwUgEW7g",target="_blank" rel="noopener noreferrer">原文链接</a>
