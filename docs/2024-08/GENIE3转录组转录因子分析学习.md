---
title: "GENIE3转录组转录因子分析学习"
date: 2024-08-30T03:32:40Z
draft: ["false"]
tags: [
  "fetched",
  "生信方舟"
]
categories: ["Acdemic"]
---
GENIE3转录组转录因子分析学习 by 生信方舟
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><h4 data-tool="mdnice编辑器"><span></span>GENIE3算法<span></span></h4><p data-tool="mdnice编辑器"><strong>GENIE3 (GEne Network Inference with Ensemble of trees) 是一种基因网络推断算法</strong>，用于从基因表达数据中推断出调控网络。GENIE3 的核心思想是通过构建随机森林（或更广泛地讲，树的集合）来预测每个基因的调控因子。具体来说，它使用树模型来评估各个潜在调控因子（其他基因）的表达模式对目标基因表达的影响。这个算法被认为在推断基因调控网络方面具有很高的准确性和鲁棒性。<img data-imgfileid="100001456" data-ratio="0.3565989847715736" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/0SOG4MpDAyEmWibCNMjdedC1Amuiaj9Jyp081WyYYGVAIO9UxEmQVjLf6ibG9T4LgNs2NPoaDU5H8DibeWictj6ncCg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="788" src="https://mmbiz.qpic.cn/sz_mmbiz_png/0SOG4MpDAyEmWibCNMjdedC1Amuiaj9Jyp081WyYYGVAIO9UxEmQVjLf6ibG9T4LgNs2NPoaDU5H8DibeWictj6ncCg/640?wx_fmt=png&amp;from=appmsg"></p><h4 data-tool="mdnice编辑器"><span></span>算法步骤:<span></span></h4><p data-tool="mdnice编辑器"><strong>目标基因选择</strong>：对数据集中的每个基因逐一进行分析，假设该基因为目标基因。</p><p data-tool="mdnice编辑器"><strong>潜在调控因子选择</strong>：剩余的所有基因作为潜在的调控因子。</p><p data-tool="mdnice编辑器">随机森林建模：通过构建一个随机森林模型（或其他树模型）来预测目标基因的表达水平，该模型的输入是潜在调控因子的表达数据。</p><p data-tool="mdnice编辑器"><strong>重要性评分</strong>：根据随机森林模型，计算每个调控因子的特征重要性评分（Feature Importance Score），这反映了该基因作为调控因子的重要性。</p><p data-tool="mdnice编辑器"><strong>网络构建</strong>：重复上述过程，对于每个目标基因，生成一个基因调控网络。最终网络由所有的特征重要性评分（即基因之间的调控关系）组成。<img data-imgfileid="100001457" data-ratio="0.48" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/0SOG4MpDAyEmWibCNMjdedC1Amuiaj9Jypt1MZfDWdGibib3j6w7vAmGSqGrE5nibFbVQosIXfabWjXeVvsPBYLiaC1A/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="750" src="https://mmbiz.qpic.cn/sz_mmbiz_png/0SOG4MpDAyEmWibCNMjdedC1Amuiaj9Jypt1MZfDWdGibib3j6w7vAmGSqGrE5nibFbVQosIXfabWjXeVvsPBYLiaC1A/640?wx_fmt=png&amp;from=appmsg"></p><h5 data-tool="mdnice编辑器"><span></span>适用场景:<span></span></h5><p data-tool="mdnice编辑器"><strong>基因调控网络重建</strong>：GENIE3常用于基因表达数据中基因调控关系的推断，特别是在单细胞RNA测序数据和bulk RNA-seq数据中。</p><p data-tool="mdnice编辑器"><strong>生物信息学研究</strong>：可以帮助研究人员理解基因之间的调控机制，识别出潜在的关键调控因子和调控通路。</p><p data-tool="mdnice编辑器"><strong>疾病研究</strong>：通过识别特定基因的调控网络，可以揭示疾病相关的基因调控机制。</p><h5 data-tool="mdnice编辑器"><span></span>优点:<span></span></h5><p data-tool="mdnice编辑器">由于使用了随机森林等集成学习方法，GENIE3对噪声数据具有很强的鲁棒性。</p><p data-tool="mdnice编辑器">可以适用于不同规模的基因表达数据集，从小规模的实验数据到大规模的高通量测序数据。</p><h5 data-tool="mdnice编辑器"><span></span>缺点:<span></span></h5><p data-tool="mdnice编辑器">由于需要对每个基因构建多个随机森林模型，计算量较大，尤其是对于大规模基因表达数据集。</p><p data-tool="mdnice编辑器">虽然GENIE3能够捕捉非线性关系，但其精度依赖于数据的质量和复杂性，有时可能无法捕捉非常复杂的调控关系。</p><h5 data-tool="mdnice编辑器"><span></span>R语言和Python实现:<span></span></h5><p data-tool="mdnice编辑器">在R语言中，可以使用GENIE3包来实现这一算法。在Python中，可以通过pySCENIC包中的实现来使用GENIE3算法。</p><h4 data-tool="mdnice编辑器"><span></span>分析流程<span></span></h4><p data-tool="mdnice编辑器">1、导入矩阵数据和转录因子</p><pre data-tool="mdnice编辑器"><span></span><code>rm(list=ls())<br><span>library</span>(GENIE3)<br>load(<span>"~/data.Rdata"</span>)<br><br>exp1_input &lt;- exp1[intersect(degs_1, rownames(exp1)), ]<br>head(exp1_input)[<span>1</span>:<span>5</span>,<span>1</span>:<span>5</span>]<br><span>#          GSM3106326 GSM3106328 GSM3106329 GSM3106330 GSM3106332</span><br><span># NKD1       8.301358   8.475126   8.469785   8.844339   8.669053</span><br><span># PIEZO2     9.210208   8.769019   8.722026   8.689316   8.001801</span><br><span># ANKRD36    8.834924   8.628393   8.854510   8.485708   8.475799</span><br><span># ANKRD36B   9.350684   9.150061   9.273654   8.887777   8.932125</span><br><span># HMCN1      9.532162   9.362445  10.061496   9.551432   9.162787</span><br><br><span># 导入TFs</span><br><span>library</span>(data.table)<br>tfs &lt;- fread(<span>"~/allTFs_hg38_new.txt"</span>,header = <span>F</span>)<br>A1 &lt;- intersect(tfs$V1,rownames(exp1_input))<br>length(A1)<br><span># [1] 12</span><br></code></pre><p data-tool="mdnice编辑器">需要提前将转录因子和矩阵基因取交集, 因为目前已知的转录因子数量是有限的，而且未必会出现在分析的矩阵中。</p><p data-tool="mdnice编辑器">2、 GENIE3正式分析-构建共表达网络</p><pre data-tool="mdnice编辑器"><span></span><code><span># Genes that are used as candidate regulators</span><br>regulators_1 &lt;- A1<br>weightMat_1 &lt;- GENIE3(exp1_input, regulators=regulators_1, <br>                      nCores=<span>4</span>, verbose=<span>TRUE</span>,<br>                      <span>#K=7, nTrees=50</span><br>                      )<br>dim(weightMat_1)<br><span># [1]  12 213</span><br></code></pre><p data-tool="mdnice编辑器">限定转录因子的好处在于能够帮使用者提前规定好TFs和靶基因的身份(指定上下级方向)。</p><p data-tool="mdnice编辑器">3、提取共表达网络数据信息</p><pre data-tool="mdnice编辑器"><span></span><code>linkList1 &lt;- getLinkList(weightMat_1,<br>                         <span>#reportMax=5, # 这个是提取网络的数量为5</span><br>                         threshold=<span>0.1</span> <span># 权重高于0.1</span><br>                         )<br>dim(linkList1)<br><span># [1] 2544    3</span><br>head(linkList1)<br><span>#   regulatoryGene targetGene    weight</span><br><span># 1         HIVEP2     HIVEP1 0.4859376</span><br><span># 2          HIF3A      BTNL9 0.4226050</span><br><span># 3         HIVEP1     HIVEP2 0.4178483</span><br><span># 4         ZNF521    FAM171B 0.3757616</span><br><span># 5         ZNF189       PKP2 0.3665207</span><br><span># 6          HIF3A    FAM107A 0.3506742</span><br>write.csv(linkList1,<span>"linkList1.csv"</span>)<br></code></pre><p data-tool="mdnice编辑器">接下来就可以放到Cytoscape中进行可视化啦~</p><h4 data-tool="mdnice编辑器"><span></span>参考资料：<span></span></h4><p data-tool="mdnice编辑器">1、Inferring regulatory networks from expression data using tree-based methods. PLoS One. 2010 Sep 28;5(9):e12776.</p><p data-tool="mdnice编辑器">2、 GENIE3：https://bioconductor.org/packages/release/bioc/vignettes/GENIE3/inst/doc/GENIE3.html</p><p data-tool="mdnice编辑器"><strong>注</strong>：若对内容有疑惑或者有发现明确错误的朋友，请联系后台(欢迎交流)。更多内容可关注公众号：<strong>生信方舟</strong></p><span>- END -</span></section><p><br></p><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/Z1gz902QTjNIYYIYkwKzHQ",target="_blank" rel="noopener noreferrer">原文链接</a>
