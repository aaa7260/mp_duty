---
title: "RNA-seq差异分析究竟应该用什么？"
date: 2022-09-03T01:40:54Z
draft: ["false"]
tags: [
  "fetched",
  "生信菜鸟团"
]
categories: ["Acdemic"]
---
RNA-seq差异分析究竟应该用什么？ by 生信菜鸟团
------
<div><p><span>一般来说，我们在RNA-seq进行差异分析时最好使用Count值，因为limma-voom、edgeR和DESeq2都是针对RNA-seq的Count值分布进行假设，从而设计的软件。但是，在实际过程中，我们并不是总能获得其Count值，而经常得到的是FPKM或者TPM值，那对于这种情况，我们能不能使用类似于分析芯片的方法进行差异分析呢？</span></p><p><span>和前面一样，使用的数据依然来自GSE145894，使用STAR进行比对，然后使用StringTie获取其Count值和FPKM以及TPM值。对于Count值，使用DESeq2，而对于FPKM值，在log2之后使用limma进行差异分析。为避免固定阈值导致的误差，我使用mean(logFC)+2*sd(logFC)作为差异阈值，以P&lt;0.05作为显著性阈值。</span></p><p><span>下面，进入我们的正题部分。</span></p><h3><span>1、Count值</span></h3><p><img data-galleryid="" data-ratio="0.7698541329011345" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8jBtgmSfnX0rxwzmeZRlULZca27zTt1R1bv10pICE14AicT9WbS674l14NwJJNfL3btx5hwiaVJ2Tg/640?wx_fmt=png" data-type="png" data-w="617" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8jBtgmSfnX0rxwzmeZRlULZca27zTt1R1bv10pICE14AicT9WbS674l14NwJJNfL3btx5hwiaVJ2Tg/640?wx_fmt=png"></p><p>logFC_t约为4.2，共有665个基因下调，196个基因上调。<span> </span></p><p><span></span></p><h3><span>2、FPKM</span></h3><p><img data-galleryid="" data-ratio="0.7686084142394822" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8jBtgmSfnX0rxwzmeZRlULhv7wHdu75Gx1AY7fN435poSbiaDVR3Houmic0uibkSzzc6y9v08pXIaQQ/640?wx_fmt=png" data-type="png" data-w="618" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8jBtgmSfnX0rxwzmeZRlULhv7wHdu75Gx1AY7fN435poSbiaDVR3Houmic0uibkSzzc6y9v08pXIaQQ/640?wx_fmt=png"></p><p><span></span>logFC_t约为0.7，共有112个基因下调，305个基因上调。<span> </span><br></p><h3><span>3、筛选后的FPKM值</span></h3><p><span>以去除全0行作为筛选条件。</span></p><p><img data-galleryid="" data-ratio="0.7648953301127214" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8jBtgmSfnX0rxwzmeZRlULeSJAqzRTfGvc7zg95OduMNd7S04fhjPUNibt9eibQ0uPC8JILo04RghA/640?wx_fmt=png" data-type="png" data-w="621" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8jBtgmSfnX0rxwzmeZRlULeSJAqzRTfGvc7zg95OduMNd7S04fhjPUNibt9eibQ0uPC8JILo04RghA/640?wx_fmt=png"></p><p>logFC_t约为0.9，共有82个基因下调，268个基因上调。<br></p><p><span>4、经过四分位标准化后的FPKM</span></p><p><img data-galleryid="" data-ratio="0.7677419354838709" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8jBtgmSfnX0rxwzmeZRlULUoicTYrHFe5oAZq9A3szsfappL7O2On4JZu53curP7Fib5TbiatdQOWsQ/640?wx_fmt=png" data-type="png" data-w="620" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8jBtgmSfnX0rxwzmeZRlULUoicTYrHFe5oAZq9A3szsfappL7O2On4JZu53curP7Fib5TbiatdQOWsQ/640?wx_fmt=png"></p><p>logFC_t约为0.7，共有392个基因下调，255个基因上调。</p><p>5、<span>筛选后并经过</span><span>四分位标准化后的</span><span>FPKM</span></p><p><img data-galleryid="" data-ratio="0.7641357027463651" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8jBtgmSfnX0rxwzmeZRlULgVvAZkSkqicdO0IywZHZMQD4elztianbw0kcYzCiaqz4P36pxYqmlOw8g/640?wx_fmt=png" data-type="png" data-w="619" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8jBtgmSfnX0rxwzmeZRlULgVvAZkSkqicdO0IywZHZMQD4elztianbw0kcYzCiaqz4P36pxYqmlOw8g/640?wx_fmt=png"></p><p>logFC_t约为0.6，共有436个基因下调，333个基因上调。</p><p>看起来已经有很大的差异了，那么具体有多少差异基因具有一致性呢？做个upset图看看。</p><p><img data-galleryid="" data-ratio="0.7917261055634808" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8jBtgmSfnX0rxwzmeZRlULLCL5hRvv9M4nKYZbTDEbzcG4Sy0XXcrkRr9ibhfowIarGHtaqZtsBDA/640?wx_fmt=png" data-type="png" data-w="701" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8jBtgmSfnX0rxwzmeZRlULLCL5hRvv9M4nKYZbTDEbzcG4Sy0XXcrkRr9ibhfowIarGHtaqZtsBDA/640?wx_fmt=png"></p><p>这差异也太大了吧。。。。<br></p><p>虽然这只是一个孤证，但是也能够提醒我们在分析数据的时候注意，如果能拿到原始count，还是用count来做吧。同时也说明，即使有FPKM和TPM值，也不能简单地log之后用芯片的方法进行差异分析。<br></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/DSgGMI_QUV0wquw9gAkTwA",target="_blank" rel="noopener noreferrer">原文链接</a>
