---
title: "转录组差异分析P值与FDR值区别有多大"
date: 2022-08-31T07:15:03Z
draft: ["false"]
tags: [
  "fetched",
  "生信菜鸟团"
]
categories: ["Acdemic"]
---
转录组差异分析P值与FDR值区别有多大 by 生信菜鸟团
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><h2 data-tool="mdnice编辑器"><span></span><span>缘起</span><span></span></h2><p data-tool="mdnice编辑器">上一期转录组专题我们讲了 <a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzUzMTEwODk0Ng==&amp;mid=2247505172&amp;idx=1&amp;sn=47c9d60c59b19bb6dcfc7095bd832d7f&amp;chksm=fa451029cd32993ff91e7155494c9074c4975d51c21a28c2145c2fa25926bbf9194d6bf7e281&amp;scene=21#wechat_redirect" textvalue="转录组数据三分组的差异分析方式" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2">转录组数据三分组的差异分析方式</a>，有小伙伴针对其中的内容提到为什么edgeR做差异分析用的是P值，而不用校正后的FDR值，不是说FDR经过多重校正，能够更好地降低假阳性吗？这个小伙伴说的非常对，但为了筛选更多的差异基因，以及避免丢失一些基因，<strong>我们通常也会考虑过滤条件不那么严格的P值，所以这是一个假阳与假阴的权衡</strong>。关于这个权衡，我们将用一个转录组数据集通过edgeR进行差异分析，去展示P值与FDR值差异分析的区别。</p><h2 data-tool="mdnice编辑器"><span></span><span>试验</span><span></span></h2><p data-tool="mdnice编辑器">今天，我们使用标题为 NAT10 depletion suppresses fatty acid metabolism in MCF7 breast cancer cells的数据集<strong>GSE210086</strong>进行分析，数据集的介绍页面如下：https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE210086，感兴趣的小伙伴可以进入看看作者的总体设计。时间紧的话，可粗略了解下，<strong>作者主要通过敲低NAT10基因看其对MCF7乳腺癌细胞系脂肪酸代谢的影响，具体脂肪酸代谢与乳腺癌表型的描述可能需要小伙伴去查查代谢与肿瘤相关的文章了</strong>，因为这个数据集的文章目前还没有发表。</p><h2 data-tool="mdnice编辑器"><span></span><span>转录组数据集介绍</span><span></span></h2><p data-tool="mdnice编辑器">GSE210086数据集的样本分组如下，<strong>敲低对照组有三个重复，敲低NAT10组有三个重复</strong></p><figure data-tool="mdnice编辑器"><img data-ratio="0.2641509433962264" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8k7J7XUkJ43h8mGFuxFNicicdicT8kdHHWWwX588XE6I00KvJ5IBDIpToniamkicwibiayERt6H2WgJQgicA/640?wx_fmt=png" data-type="png" data-w="848" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8k7J7XUkJ43h8mGFuxFNicicdicT8kdHHWWwX588XE6I00KvJ5IBDIpToniamkicwibiayERt6H2WgJQgicA/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">处理数据的话，庆幸的是，作者上传了基因count矩阵，我们就可以直接走上次count数据处理的差异分析流程。<strong>值得注意的点是，作者上传的是基因表达矩阵，这意味着我们无需进行ID转换，直接过滤进行差异分析即可</strong></p><p data-tool="mdnice编辑器">以下为基因count矩阵下载链接：https://www.ncbi.nlm.nih.gov/geo/download/?acc=GSE210086&amp;format=file&amp;file=GSE210086%5Fgene%5Fcount%2Exls%2Egz</p><figure data-tool="mdnice编辑器"><img data-ratio="0.09871244635193133" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8k7J7XUkJ43h8mGFuxFNicicPyBHou0bLDWXtQNWz6jh9iapPP3wpgR7vTF9aTSOCQzVdleibqyGZXTg/640?wx_fmt=png" data-type="png" data-w="932" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8k7J7XUkJ43h8mGFuxFNicicPyBHou0bLDWXtQNWz6jh9iapPP3wpgR7vTF9aTSOCQzVdleibqyGZXTg/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">接下来，我们重点关注P值与多重校正后的FDR值差异分析的区别</p><h2 data-tool="mdnice编辑器"><span></span><span>正式分析</span><span></span></h2><h3 data-tool="mdnice编辑器"><span></span><span><span></span>0.清控环境，加载包</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code>rm(list = ls())<br><span>library</span>(edgeR)<br><span>library</span>(DESeq2)<br><span>library</span>(FactoMineR)<br><span>library</span>(factoextra)<br><span>library</span>(org.Hs.eg.db)<br><span>library</span>(stringr)<br><span>library</span>(stringi)<br><span>library</span>(tidyverse)<br><span>library</span>(ggplot2)<br><span>library</span>(patchwork)<br><span>library</span>(pheatmap)<br><span>library</span>(VennDiagram)<br><span>library</span>(RColorBrewer)<br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span><span></span>1.读取数据，获得基因表达矩阵以及cpm矩阵</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code>rawcount &lt;- read.delim(<span>"./GSE210086_gene_count.xls.gz"</span>,header = <span>T</span>,sep=<span>"\t"</span>)<br>rawcount &lt;- rawcount[,<span>2</span>:<span>8</span>] <span>#获得正式的基因表达矩阵</span><br>table(duplicated(rawcount$gene_name))<span>#随机降重</span><br><span>## </span><br><span>## FALSE  TRUE </span><br><span>## 57167  1568</span><br>rawcount$median &lt;- apply(rawcount[<span>1</span>:<span>6</span>],<span>1</span>,median)<br>rawcount &lt;- rawcount[!duplicated(rawcount$gene_name),]<br>rownames(rawcount) &lt;- rawcount$gene_name<br>rawcount &lt;- rawcount[,<span>1</span>:<span>6</span>] <span>#获得正式的基因表达矩阵</span><br>head(rawcount)<br><span>##        siNAT10_MCF2 siNAT10_MCF3 siC_MCF1 siNAT10_MCF1 siC_MCF2 siC_MCF3</span><br><span>## EEF1A1        82029        79914   133846        79414    96249    81294</span><br><span>## PKM          113137        87066   103953       142330    53897    45121</span><br><span>## ENO1         106702        81082   111201       119585    41414    34417</span><br><span>## FN1           54799        88855    33452        66222    86689   119331</span><br><span>## RPLP0         96851        63370    90415        93733    38245    33715</span><br><span>## IGFBP3        67465        79051    60625        65019    69043    61142</span><br><span># 将组别换成正常组在前，对照组在后的习惯去处理额</span><br>rawcount=rawcount[,c(<span>3</span>,<span>5</span>,<span>6</span>,<span>1</span>,<span>2</span>,<span>4</span>)]<br>head(rawcount) <span>#获取正常组在前，疾病组在后的基因表达矩阵</span><br><span>##        siC_MCF1 siC_MCF2 siC_MCF3 siNAT10_MCF2 siNAT10_MCF3 siNAT10_MCF1</span><br><span>## EEF1A1   133846    96249    81294        82029        79914        79414</span><br><span>## PKM      103953    53897    45121       113137        87066       142330</span><br><span>## ENO1     111201    41414    34417       106702        81082       119585</span><br><span>## FN1       33452    86689   119331        54799        88855        66222</span><br><span>## RPLP0     90415    38245    33715        96851        63370        93733</span><br><span>## IGFBP3    60625    69043    61142        67465        79051        65019</span><br>keep &lt;- rowSums(rawcount&gt;<span>0</span>) &gt;= floor(<span>0.5</span>*ncol(rawcount))<br>filter_count &lt;- rawcount[keep,] <span>#获得filter_count矩阵</span><br>express_cpm &lt;- log2(cpm(filter_count)+ <span>1</span>)<br>express_cpm[<span>1</span>:<span>4</span>,<span>1</span>:<span>4</span>] <span>#获得cpm矩阵</span><br><span>##        siC_MCF1 siC_MCF2 siC_MCF3 siNAT10_MCF2</span><br><span>## EEF1A1 13.46855 13.32252 13.18932     12.72864</span><br><span>## PKM    13.10394 12.48606 12.34009     13.19245</span><br><span>## ENO1   13.20117 12.10605 11.94950     13.10797</span><br><span>## FN1    11.46852 13.17161 13.74302     12.14676</span><br>save(express_cpm,filter_count,file=<span>"Step03filterGeneCountCpm.Rdata"</span>)<br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span><span></span>2.获取差异分析的分组信息</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code><span>#根据列的信息，提取分组信息</span><br>colnames(rawcount) <br><span>## [1] "siC_MCF1"     "siC_MCF2"     "siC_MCF3"     "siNAT10_MCF2" "siNAT10_MCF3"</span><br><span>## [6] "siNAT10_MCF1"</span><br>group=rep(c(<span>"shCON"</span>,<span>"siNAT10"</span>),each=<span>3</span>)<br>group_list=factor(group,levels = c(<span>"shCON"</span>,<span>"siNAT10"</span>))<br>table(group_list)<span>#检查一下组别数量</span><br><span>## group_list</span><br><span>##   shCON siNAT10 </span><br><span>##       3       3</span><br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span><span></span>3.初看两组分析的数据与样本分组分布（箱线图与PCA图）</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code><span>## 01绘制整体表达的箱线图</span><br>exprSet &lt;- express_cpm<br>data &lt;- data.frame(expression=c(exprSet),<br>                   sample=rep(colnames(exprSet),each=nrow(exprSet)))<br>p1 &lt;- ggplot(data = data,aes(x=sample,y=expression,fill=sample))+ geom_boxplot() + theme(axis.text.x = element_text(angle = <span>90</span>)) + <br>  xlab(<span>NULL</span>) + ylab(<span>"log2(CPM+1)"</span>)+theme_bw()<br><br><span>## 02绘制PCA图</span><br>dat &lt;- express_cpm<br>dat &lt;- as.data.frame(t(dat))<br>dat &lt;- na.omit(dat)<br>dat$group_list &lt;- group_list<br>dat_pca &lt;- PCA(dat[,-ncol(dat)], graph = <span>FALSE</span>)<span>#画图仅需数值型数据，去掉最后一列的分组信息</span><br>p2 &lt;- fviz_pca_ind(dat_pca,<br>                   geom.ind = <span>"point"</span>, <span># 只显示点，不显示文字</span><br>                   col.ind = dat$group_list, <span># 用不同颜色表示分组</span><br>                   palette = c(<span>"#00AFBB"</span>, <span>"#E7B800"</span>),<br>                   addEllipses = <span>T</span>, <span># 是否圈起来，少于4个样圈不起来</span><br>                   legend.title = <span>"Groups"</span>) + theme_bw()<br>p1+p2<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.7142857142857143" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8k7J7XUkJ43h8mGFuxFNicicwt7v94PYL6IomACrw558QXFiaicANbqFc4dp2jWwKVhOSZ1PJiczfTLZA/640?wx_fmt=png" data-type="png" data-w="672" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8k7J7XUkJ43h8mGFuxFNicicwt7v94PYL6IomACrw558QXFiaicANbqFc4dp2jWwKVhOSZ1PJiczfTLZA/640?wx_fmt=png"></figure><h3 data-tool="mdnice编辑器"><span></span><span><span></span>4.分别利用P值与FDR值进行差异分析</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code><span># 01先获取整体的差异分析表达结果</span><br>exprSet &lt;- filter_count<br>design &lt;- model.matrix(~<span>0</span>+rev(factor(group_list))) <br>rownames(design) &lt;- colnames(exprSet)<br>colnames(design) &lt;- levels(factor(group_list))<br>DEG &lt;- DGEList(counts=exprSet,  <span>#构建edgeR的DGEList对象</span><br>               group=factor(group_list))<br>DEG$samples$lib.size <br><span>## [1] 11808834  9396381  8704124 12087295 10388406 12481825</span><br>DEG &lt;- calcNormFactors(DEG)<br>DEG$samples$norm.factors<br><span>## [1] 0.9260817 1.1034025 1.1501644 0.9244119 1.0255480 0.8975017</span><br><span># 计算线性模型的参数</span><br>DEG &lt;- estimateGLMCommonDisp(DEG,design)<br>DEG &lt;- estimateGLMTrendedDisp(DEG, design)<br>DEG &lt;- estimateGLMTagwiseDisp(DEG, design)<br><span># 拟合线性模型</span><br>fit &lt;- glmFit(DEG, design)<br>lrt &lt;- glmLRT(fit, contrast=c(<span>1</span>,-<span>1</span>)) <br><span># 提取过滤差异分析结果</span><br>DEG_edgeR &lt;- as.data.frame(topTags(lrt, n=nrow(DEG)))<br>head(DEG_edgeR)<br><span>##           logFC   logCPM       LR       PValue          FDR</span><br><span>## TAGLN  2.279278 7.298149 56.93375 4.507442e-14 6.611515e-10</span><br><span>## CRYAB  1.513615 5.833886 32.39699 1.256810e-08 9.217444e-05</span><br><span>## SAMD11 2.424716 2.454854 24.80752 6.334993e-07 3.097389e-03</span><br><span>## LMCD1  1.313811 6.322715 23.30588 1.381766e-06 5.066936e-03</span><br><span>## TSSC4  1.637568 4.057177 22.79470 1.802621e-06 5.288170e-03</span><br><span>## BOK    1.411509 6.456652 21.09287 4.375522e-06 1.069669e-02</span><br><span># 设定阈值，筛选显著上下调差异基因</span><br>fc &lt;- <span>2.0</span><br>p &lt;- <span>0.05</span><br><span>## 02利用P值进行差异分析</span><br>DEG_edgeR$regulated &lt;- ifelse(DEG_edgeR$logFC&gt;log2(fc)&amp;DEG_edgeR$PValue&lt;p,<br>                              <span>"up"</span>,ifelse(DEG_edgeR$logFC&lt;(-log2(fc))&amp;DEG_edgeR$PValue&lt;p,<span>"down"</span>,<span>"normal"</span>))<br>table(DEG_edgeR$regulated)<br><span>## </span><br><span>##   down normal     up </span><br><span>##    252  14055    361</span><br><span>## 03利用FDR值进行差异分析</span><br>fc &lt;- <span>2.0</span><br>p &lt;- <span>0.05</span><br>DEG_edgeR$regulated1 &lt;- ifelse(DEG_edgeR$logFC&gt;log2(fc)&amp;DEG_edgeR$FDR&lt;p,<br>                               <span>"up"</span>,ifelse(DEG_edgeR$logFC&lt;(-log2(fc))&amp;DEG_edgeR$FDR&lt;p,<span>"down"</span>,<span>"normal"</span>))<br>table(DEG_edgeR$regulated1)<br><span>## </span><br><span>##   down normal     up </span><br><span>##      5  14638     25</span><br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span><span></span>5.展示P值与FDR值分析的差异分析结果（火山图与热图）</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code><span>## 01绘制P值与FDR值差异分析的火山图</span><br><span># 绘制第一组用P值进行差异分析的火山图</span><br>data1 &lt;- DEG_edgeR<br>p3.1 &lt;- ggplot(data=data1, aes(x=logFC, y=-log10(PValue),color=regulated)) + <br>  geom_point(alpha=<span>0.5</span>, size=<span>1.8</span>) + <br>  theme_set(theme_set(theme_bw(base_size=<span>20</span>))) + <br>  xlab(<span>"log2FC"</span>) + ylab(<span>"-log10(Pvalue)"</span>) +<br>  scale_colour_manual(values = c(<span>'blue'</span>,<span>'black'</span>,<span>'red'</span>))+theme_bw()<br><br><span># 绘制第二组用FDR值进行差异分析的火山图</span><br>p3.2 &lt;- ggplot(data=data1, aes(x=logFC, y=-log10(FDR),color=regulated1)) + <br>  geom_point(alpha=<span>0.5</span>, size=<span>1.8</span>) + <br>  theme_set(theme_set(theme_bw(base_size=<span>20</span>))) + <br>  xlab(<span>"log2FC"</span>) + ylab(<span>"-log10(FDRvalue)"</span>) +<br>  scale_colour_manual(values = c(<span>'blue'</span>,<span>'black'</span>,<span>'red'</span>))+theme_bw()<br><br><span># 拼图</span><br>p3.1+p3.2<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.7142857142857143" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8k7J7XUkJ43h8mGFuxFNicicXGoRdaMqmATf5Ms8H8AuXVLScVPdRgSKXMUia7icGJwDHW9BcxKUcL2g/640?wx_fmt=png" data-type="png" data-w="672" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8k7J7XUkJ43h8mGFuxFNicicXGoRdaMqmATf5Ms8H8AuXVLScVPdRgSKXMUia7icGJwDHW9BcxKUcL2g/640?wx_fmt=png"></figure><pre data-tool="mdnice编辑器"><span></span><code><span>## 02绘制P值与FDR值差异分析的热图</span><br><span># 绘制P值分析后比较的差异基因热图</span><br>edgeR1_sigGene1 &lt;- DEG_edgeR[DEG_edgeR$regulated!=<span>"normal"</span>,]<br>edgeR1_sigGene1 &lt;-rownames(edgeR1_sigGene1)<br>dat1 &lt;- express_cpm[match(edgeR1_sigGene1,rownames(express_cpm)),]<br>dat1[<span>1</span>:<span>4</span>,<span>1</span>:<span>4</span>]<br><span>##        siC_MCF1 siC_MCF2 siC_MCF3 siNAT10_MCF2</span><br><span>## TAGLN  6.011491 5.856408 5.584638     8.187205</span><br><span>## CRYAB  4.968841 5.055129 4.974774     6.439499</span><br><span>## SAMD11 1.678857 1.045610 1.504981     3.555214</span><br><span>## LMCD1  5.702199 5.617758 5.506579     6.830937</span><br>group1 &lt;- data.frame(group=group_list)<br>rownames(group1)=colnames(dat1)<br><span># 绘制热图</span><br><span>library</span>(pheatmap)<br>p4.1 &lt;- pheatmap(dat1,scale = <span>"row"</span>,show_colnames =<span>T</span>,show_rownames = <span>F</span>, <br>                 cluster_cols = <span>T</span>, <br>                 annotation_col=group1,<br>                 main = <span>"edgeR's DEG"</span>)<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.7142857142857143" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8k7J7XUkJ43h8mGFuxFNicic9cRodrc8GwR7icgKCsZlKBu2iaBwha30HWCT7mj7iaTMfVw6DLdIssjeg/640?wx_fmt=png" data-type="png" data-w="672" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8k7J7XUkJ43h8mGFuxFNicic9cRodrc8GwR7icgKCsZlKBu2iaBwha30HWCT7mj7iaTMfVw6DLdIssjeg/640?wx_fmt=png"></figure><pre data-tool="mdnice编辑器"><span></span><code><span>## 绘制FDR值分析后比较的差异基因热图</span><br>edgeR1_sigGene2 &lt;- DEG_edgeR[DEG_edgeR$regulated1!=<span>"normal"</span>,]<br>edgeR1_sigGene2 &lt;-rownames(edgeR1_sigGene2)<br>dat2 &lt;- express_cpm[match(edgeR1_sigGene2,rownames(express_cpm)),]<br>dat2[<span>1</span>:<span>4</span>,<span>1</span>:<span>4</span>]<br><span>##        siC_MCF1 siC_MCF2 siC_MCF3 siNAT10_MCF2</span><br><span>## TAGLN  6.011491 5.856408 5.584638     8.187205</span><br><span>## CRYAB  4.968841 5.055129 4.974774     6.439499</span><br><span>## SAMD11 1.678857 1.045610 1.504981     3.555214</span><br><span>## LMCD1  5.702199 5.617758 5.506579     6.830937</span><br>group1 &lt;- data.frame(group=group_list)<br>rownames(group1)=colnames(dat2)<br><span># 绘制热图</span><br><span>library</span>(pheatmap)<br>p4.2 &lt;- pheatmap(dat2,scale = <span>"row"</span>,show_colnames =<span>T</span>,show_rownames = <span>F</span>, <br>                 cluster_cols = <span>T</span>, <br>                 annotation_col=group1,<br>                 main = <span>"edgeR's DEG"</span>)<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.7142857142857143" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8k7J7XUkJ43h8mGFuxFNicicqGl4FhOYNQB3BJW0uVQf5kH2o3Kk44U7f2JFzhfjVZVk3hKy6oQ2BQ/640?wx_fmt=png" data-type="png" data-w="672" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8k7J7XUkJ43h8mGFuxFNicicqGl4FhOYNQB3BJW0uVQf5kH2o3Kk44U7f2JFzhfjVZVk3hKy6oQ2BQ/640?wx_fmt=png"></figure><pre data-tool="mdnice编辑器"><span></span><code><span># 热图拼图</span><br><span>library</span>(ggplotify)<br>p4.1 &lt;- as.ggplot(p4.1)<br>p4.2 &lt;- as.ggplot(p4.2)<br>p4.1+p4.2<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.7142857142857143" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8k7J7XUkJ43h8mGFuxFNicicEoCq6ZeLj2Yx54EV7WI9UKZxaPZuoia6icSu1Jq1lhyX3wFMzKR4RL3A/640?wx_fmt=png" data-type="png" data-w="672" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8k7J7XUkJ43h8mGFuxFNicicEoCq6ZeLj2Yx54EV7WI9UKZxaPZuoia6icSu1Jq1lhyX3wFMzKR4RL3A/640?wx_fmt=png"></figure><h3 data-tool="mdnice编辑器"><span></span><span><span></span>6.整体看一下P值与adjustP值分析差异基因的交集情况吧</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code>degP &lt;- rownames(DEG_edgeR[DEG_edgeR$regulated!=<span>"normal"</span>,])<br>degFDR &lt;- rownames(DEG_edgeR[DEG_edgeR$regulated1!=<span>"normal"</span>,])<br>table(degP%<span>in</span>%degFDR)<br><span>## </span><br><span>## FALSE  TRUE </span><br><span>##   583    30</span><br><span>library</span>(ggvenn)<br>deg&lt;-list(`P`=degP,<br>          `FDR`=degFDR)<br>p5 &lt;- ggvenn(deg,<br>             show_percentage = <span>F</span>,<br>             stroke_color = <span>"white"</span>,<br>             fill_color = c(<span>"#b2d4ec"</span>,<span>"#d3c0e2"</span>),<br>             set_name_color = c(<span>"#ff0000"</span>,<span>"#4a9b83"</span>))<br>p5 <span>#30个FDR分析的差异基因全在利用P值分析的差异基因里</span><br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.7142857142857143" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8k7J7XUkJ43h8mGFuxFNiciciaflaR9MvjtmJSz0iansyT0kQb1w0eFy6mO1NyEAwu8EqMRVicEibQKia0A/640?wx_fmt=png" data-type="png" data-w="672" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8k7J7XUkJ43h8mGFuxFNiciciaflaR9MvjtmJSz0iansyT0kQb1w0eFy6mO1NyEAwu8EqMRVicEibQKia0A/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">以上就是P值与FDR值进行差异分析的区别，咱们可以看见当组别之间样本没有很明显的区分时（<strong>聚类效果不好</strong>），用P值与用FDR值进行差异分析具有巨大区别，<strong>差异基因数量显著减少</strong>。</p><p data-tool="mdnice编辑器">接着，回到咱们关于P值与FDR值进行差异分析的<strong>假阳与假阴的权衡</strong>上来，如果咱们以FDR值来过滤，会得到很少的显著基因，这些基因可信度可能很高，但是有些显著基因可能因为这条件太严被过滤了。</p><p data-tool="mdnice编辑器">然而，如果用P值进行差异分析的话，就可能会面临许多显著基因中存在假阳性，且可能会被某些杂志的reviewer argue或者拒收，所以如果数据分组效果可以，想得到较少的假阳基因，推荐用FDR值。</p><p data-tool="mdnice编辑器">但是如果想进行筛选，数据质量不行，可以考虑用P值，当然这是小编的一家之言，见仁见智，<strong>大家也可以谈谈用FDR值以及P值进行差异分析的见解，以及试试用两种值进行差异分析，欢迎大家在留言区阐述自身的看法以及结果哈</strong>。<br></p></section><p><br></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/N3EYU8TNANh7nSzxt0MnIw",target="_blank" rel="noopener noreferrer">原文链接</a>
