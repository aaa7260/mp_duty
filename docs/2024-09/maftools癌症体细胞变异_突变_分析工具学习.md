---
title: "maftools癌症体细胞变异(突变)分析工具学习"
date: 2024-09-02T03:28:42Z
draft: ["false"]
tags: [
  "fetched",
  "生信方舟"
]
categories: ["Acdemic"]
---
maftools癌症体细胞变异(突变)分析工具学习 by 生信方舟
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><p data-tool="mdnice编辑器"><strong>Maftools</strong> 是一个专门用于分析和可视化突变数据的 R 包。全名为 "Mutation Annotation Format Tools"，它主要处理 MAF（Mutation Annotation Format）文件，这种文件格式广泛用于存储和共享癌症基因组中的突变数据。Maftools 的主要功能包括：</p><ol data-tool="mdnice编辑器"><li><section>突变数据解析：可以方便地加载 MAF 文件，并将其解析为 R 中的对象，便于进一步分析。</section></li><li><section>突变数据可视化：提供了多种强大的可视化工具，如瀑布图（Waterfall plot）、突变频率图、共突变和互斥突变分析、突变频谱分析等，帮助研究人员更直观地理解突变数据的特征。</section></li><li><section>临床数据整合：可以将临床数据与突变数据整合，分析不同临床亚群的突变特征和生存分析等。</section></li><li><section>统计分析：包括突变负荷分析、通路富集分析、TCGA数据整合分析等功能。</section></li></ol><p data-tool="mdnice编辑器"><strong>详细的MAF数据格式解释在官网</strong>：https://docs.gdc.cancer.gov/Data/File_Formats/MAF_Format/<img data-imgfileid="100001557" data-ratio="0.9562982005141388" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/0SOG4MpDAyENHeyjyagiaNPN86betekt1Eaiancnq26RddOOFFJqFPz159BW9YoNwd8C25cft1lct2uBgbBCQBng/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="778" src="https://mmbiz.qpic.cn/sz_mmbiz_png/0SOG4MpDAyENHeyjyagiaNPN86betekt1Eaiancnq26RddOOFFJqFPz159BW9YoNwd8C25cft1lct2uBgbBCQBng/640?wx_fmt=png&amp;from=appmsg">截图展示部分内容，如果需要了解基因组数据相关概念的可以登录该网站细细研究一下。</p><p data-tool="mdnice编辑器">那么得到这部分数据我们可以做点什么呢？首先是根据<strong>突变情况联合各种临床参数</strong>；其次现已经进入了免疫治疗时代，可以将<strong>其与免疫治疗的数据联合分析</strong>；或者如果<strong>重点要研究某一个分子的突变情况，研究者可以先来看看这里的突变数据</strong>~ 总之，用途还是非常多的！</p><p data-tool="mdnice编辑器">在使用之前建议先熟读一下官方文档，比笔者展示的更细致全面！链接：https://bioconductor.org/packages/release/bioc/vignettes/maftools/inst/doc/maftools.html#1_Introduction</p><h4 data-tool="mdnice编辑器"><span></span>分析流程<span></span></h4><h5 data-tool="mdnice编辑器"><span></span>1、导入(使用TCGAmutations包下载突变数据)<span></span></h5><p data-tool="mdnice编辑器">清洗好的LIHC数据</p><pre data-tool="mdnice编辑器"><span></span><code>rm(list = ls())<br><span>library</span>(maftools)<br><span># TCGAmutations包含了已经预处理好的TCGA的各个癌种的突变数据(不包括CNV)</span><br><span>library</span>(TCGAmutations)<br><span>library</span>(tidyverse)<br>load(<span>"TCGA-LIHC_sur_model.Rdata"</span>)<br>head(exprSet)[<span>1</span>:<span>5</span>,<span>1</span>:<span>5</span>]<br><span>#            TCGA-FV-A495-01A TCGA-ED-A7PZ-01A TCGA-ED-A97K-01A TCGA-ED-A7PX-01A TCGA-BC-A3KF-01A</span><br><span># WASH7P             1.913776        1.2986076         1.967382         1.586170        0.8210928</span><br><span># AL627309.6         3.129116        0.5606928         3.831265         1.363539        1.2461127</span><br><span># WASH9P             2.490476        2.8140204         2.960338         2.106464        1.5945195</span><br><span># MTND1P23           2.773335        3.4114257         2.591028         3.353850        2.9667012</span><br><span># MTND2P28           4.668896        8.0896003         9.426092         9.610934       10.0257594</span><br>head(meta)<br><span>#                                ID OS    OS.time  race age gender stage T  N M</span><br><span># TCGA-FV-A495-01A TCGA-FV-A495-01A  0 0.03333333 WHITE  51 FEMALE    II 2 NA 0</span><br><span># TCGA-ED-A7PZ-01A TCGA-ED-A7PZ-01A  0 0.20000000 ASIAN  61   MALE    II 2 NA 0</span><br><span># TCGA-ED-A97K-01A TCGA-ED-A97K-01A  0 0.20000000 ASIAN  54   MALE   III 3  0 0</span><br><span># TCGA-ED-A7PX-01A TCGA-ED-A7PX-01A  0 0.20000000 ASIAN  48 FEMALE    II 2 NA 0</span><br><span># TCGA-BC-A3KF-01A TCGA-BC-A3KF-01A  0 0.26666667 WHITE  66 FEMALE     I 1 NA 0</span><br><span># TCGA-DD-A4NR-01A TCGA-DD-A4NR-01A  1 0.30000000 WHITE  85 FEMALE     I 1  0 0</span><br>dim(meta)<br><span># [1] 365  10</span><br>maf = tcga_load(<span>"LIHC"</span>)<br>dim(maf@data)<br><span># [1] 36445    23</span><br>length(unique(maf@data$Tumor_Sample_Barcode))<br><span># [1] 365</span><br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100001554" data-ratio="0.37037037037037035" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/0SOG4MpDAyENHeyjyagiaNPN86betekt1uLlbNU7o2h0MuAtmeic3W0Muv6zNRdMYsVgJrjt3uvH65k1DC6KItTQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="648" src="https://mmbiz.qpic.cn/sz_mmbiz_png/0SOG4MpDAyENHeyjyagiaNPN86betekt1uLlbNU7o2h0MuAtmeic3W0Muv6zNRdMYsVgJrjt3uvH65k1DC6KItTQ/640?wx_fmt=png&amp;from=appmsg"></figure><h5 data-tool="mdnice编辑器"><span></span>2、数据预处理<span></span></h5><pre data-tool="mdnice编辑器"><span></span><code><span># 提取了每个样本的名称(前者是1：16位的/后者是全称)</span><br>samp = data.frame(ID = str_sub(unique(maf@data$Tumor_Sample_Barcode),<span>1</span>,<span>16</span>),<br>                  long = unique(maf@data$Tumor_Sample_Barcode))<br><span># merge() 函数会自动根据指定的列（如 ID 列）将两个数据框的数据进行配对合并</span><br>samp= merge(meta,samp,by = <span>"ID"</span>)<br><br><span># 临床信息</span><br><span># 其实上面已经准备好了，再来一次吧~ </span><br>maf@clinical.data = left_join(maf@clinical.data,samp,by = c(<span>"Tumor_Sample_Barcode"</span>=<span>"long"</span>))<br></code></pre><p data-tool="mdnice编辑器">这里的临床信息很丰富。<img data-imgfileid="100001558" data-ratio="0.41589267285861714" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/0SOG4MpDAyENHeyjyagiaNPN86betekt1RMnylBDg2EFe8cuMfsd5iaZaoqR64sWASjwe6UxmhdCyZhqPy77u3tw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="969" src="https://mmbiz.qpic.cn/sz_mmbiz_png/0SOG4MpDAyENHeyjyagiaNPN86betekt1RMnylBDg2EFe8cuMfsd5iaZaoqR64sWASjwe6UxmhdCyZhqPy77u3tw/640?wx_fmt=png&amp;from=appmsg"></p><h5 data-tool="mdnice编辑器"><span></span>3、oncoplot图<span></span></h5><pre data-tool="mdnice编辑器"><span></span><code><span># subsetMaf()是maftools包中的一个函数，用于从原始MAF 数据中提取特定的样本或突变类型的子集。</span><br>maf = subsetMaf(maf,tsb = samp$long)<br><span># --Possible FLAGS among top ten genes:</span><br><span>#   TTN</span><br><span>#   MUC16</span><br><span>#   OBSCN</span><br><span># -Processing clinical data</span><br><span># 意味着它们是突变频率较高的基因</span><br><br><span># 定义突变参数</span><br>cla1 = c(<span>'Frame_Shift_Del'</span>,<span>'Missense_Mutation'</span>, <br>           <span>'Nonsense_Mutation'</span>, <span>'Multi_Hit'</span>, <span>'Frame_Shift_Ins'</span>,<br>           <span>'In_Frame_Ins'</span>, <span>'Splice_Site'</span>, <span>'In_Frame_Del'</span>)<br><span># 上面的信息藏在variant.classification.summary中</span><br>cla2 = colnames(maf@variant.classification.summary)[-c(<span>1</span>,ncol(maf@variant.classification.summary))]<br><span># 使用intersect函数找到cla1和cla2的交集，即共同的突变分类；然后使用setdiff函数找到cla2中不在cla1中的突变分类，将它们合并以形成最终的突变分类列表cla</span><br>cla = c(intersect(cla1,cla2),setdiff(cla2,cla1))<br><span># 突变分类分配颜色</span><br>col = RColorBrewer::brewer.pal(n = length(cla), name = <span>'Paired'</span>)<br>names(col) = cla<br><span># 定义调色板并分配给临床特征</span><br>fabcol = RColorBrewer::brewer.pal(n = <span>9</span>,name = <span>'Spectral'</span>)<br>  <br>racecolor = fabcol[<span>1</span>:<span>3</span>];names(racecolor) = na.omit(unique(maf@clinical.data$race))<br>stagecolor = fabcol[<span>4</span>:<span>5</span>];names(stagecolor) = na.omit(unique(maf@clinical.data$stage.x))<br>agecolor = fabcol[<span>6</span>:<span>7</span>];names(agecolor) = na.omit(unique(maf@clinical.data$age))<br>gendercolor = fabcol[<span>8</span>:<span>9</span>];names(gendercolor) = na.omit(unique(maf@clinical.data$gender))<br>  <br>fabcolors = list(race = racecolor,<br>                   stage = stagecolor,<br>                   age = agecolor,<br>                   gender = gendercolor)<br>oncoplot(maf = maf, colors = col, top = <span>20</span>,<br>           clinicalFeatures = c(<span>"race"</span>,<span>"stage"</span>,<span>"age"</span>,<span>"gender"</span>), <br>           sortByAnnotation = <span>TRUE</span>, <br>           annotationColor = fabcolors)<br><br><br><span># Following columns are missing from annotation slot of MAF. Ignoring them..</span><br><span># [1] "stage" "age"</span><br></code></pre><p data-tool="mdnice编辑器"><strong>相关概念：</strong></p><ol data-tool="mdnice编辑器"><li><section>Frame Shift Del (框移缺失)：在DNA序列中删除一个或多个碱基，而这种删除的数量不是三的倍数，导致从突变点起编码框架发生移位。这种帧移通常会导致完全不同的氨基酸序列和一个提前的终止密码子，从而产生功能丧失的蛋白质。</section></li><li><section>Missense Mutation (错义突变)：在DNA序列中的一个点发生单个碱基的变化，导致编码一个不同的氨基酸。这种突变可以改变蛋白质的功能，有时导致疾病。</section></li><li><section>Nonsense Mutation (无义突变)：在DNA序列的一个点发生变化，导致一个氨基酸的密码子变成了终止密码子。这导致蛋白质的提前终止，通常会产生一个非功能的或缺失关键功能域的蛋白质。</section></li><li><section>Multi Hit：指一个基因在同一细胞中发生多次突变。这通常指多个独立的突变事件影响同一个基因，可能导致该基因功能的完全丧失或显著改变。</section></li><li><section>Frame Shift Ins (框移插入)：在DNA序列中插入一个或多个碱基，而这种插入的数量不是三的倍数，导致编码框架发生移位。这也会导致蛋白质序列的改变和可能的早终止。</section></li><li><section>In Frame Ins (同框插入)：在DNA序列中插入的碱基数量是三的倍数，不会改变读码框，但会在蛋白质中添加额外的氨基酸。这种突变可能改变蛋白质的功能或稳定性，但蛋白质的其余部分仍然按原设计翻译。</section></li><li><section>Splice Site (剪接位点突变)：这类突变发生在基因内编码剪接位点的区域，可能影响mRNA的剪接过程，导致畸形或功能失常的蛋白质。</section></li><li><section>In Frame Del (同框缺失)：在DNA序列中删除的碱基数量是三的倍数，不改变读码框，但会在蛋白质中删除一些氨基酸。与同框插入类似，这种突变可能影响蛋白质的功能或稳定性，但不会导致读码框移位。<img data-imgfileid="100001556" data-ratio="0.9715909090909091" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/0SOG4MpDAyENHeyjyagiaNPN86betekt1nvLPqzBI8WtqD7xmDSK5rF7ibAVPhricISrPg6vKnuVYlByjTmxbbKIA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="528" src="https://mmbiz.qpic.cn/sz_mmbiz_png/0SOG4MpDAyENHeyjyagiaNPN86betekt1nvLPqzBI8WtqD7xmDSK5rF7ibAVPhricISrPg6vKnuVYlByjTmxbbKIA/640?wx_fmt=png&amp;from=appmsg"></section></li></ol><h5 data-tool="mdnice编辑器"><span></span>4、综合展示图<span></span></h5><pre data-tool="mdnice编辑器"><span></span><code>plotmafSummary(maf = maf,<br>               rmOutlier = <span>TRUE</span>,<br>               addStat = <span>"median"</span>,<br>               dashboard = <span>TRUE</span>,<br>               titvRaw = <span>FALSE</span>)<br></code></pre><p data-tool="mdnice编辑器"><strong>相关概念：</strong></p><ol data-tool="mdnice编辑器"><li><section>SNP (Single Nucleotide Polymorphism，单核苷酸多态性)：SNP是指在DNA序列中一个单一的碱基（核苷酸）在人群中存在两种或多种变体的情况。例如，一个位置的碱基可能在大多数人中是"A"，但在某些人中可能是"G"。这种类型的遗传变异非常普遍，并且与许多遗传性疾病和个体之间的表型差异有关。</section></li><li><section>ONP (Oligonucleotide Polymorphism，少核苷酸多态性)：ONP通常指的是在DNA序列中长度为2到几个核苷酸的短序列变异。这些可以视为较长的SNP或短小的插入和删除。ONP比单一的SNP更复杂，可以影响更多的生物学过程，例如蛋白质的编码或基因表达的调控。</section></li><li><section>INS (Insertion，插入)：插入是指一个或多个核苷酸添加到DNA序列中的事件。插入的长度可以从一个碱基到几千个碱基不等。根据插入的大小和位置，它们可以对基因的功能产生显著影响，例如改变蛋白质的结构或调控基因的表达。</section></li><li><section>DEL (Deletion，删除)：删除是指DNA序列中一个或多个核苷酸的丢失。与插入类似，删除也可以广泛变化其长度和发生的位置。删除可能导致基因失功能、编码蛋白质结构的改变或影响基因的调控。<img data-imgfileid="100001555" data-ratio="0.9715909090909091" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/0SOG4MpDAyENHeyjyagiaNPN86betekt1kFfTD6d89xmg1yzMmHyrb9zeZibfWcEWQPCMMw3yRs3icNQG6rNEVlLw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="528" src="https://mmbiz.qpic.cn/sz_mmbiz_png/0SOG4MpDAyENHeyjyagiaNPN86betekt1kFfTD6d89xmg1yzMmHyrb9zeZibfWcEWQPCMMw3yRs3icNQG6rNEVlLw/640?wx_fmt=png&amp;from=appmsg"></section></li></ol><h5 data-tool="mdnice编辑器"><span></span>5、Ti/Tv比率<span></span></h5><p data-tool="mdnice编辑器">Ti/Tv比率（Transition/Transversion ratio）是指DNA序列中的碱基替换类型中，嘌呤（A/G）或嘧啶（C/T）之间的替换（称为转换，transitions）与嘌呤和嘧啶之间的替换（称为颠换，transversions）的比率。这个比率可以用来评估序列数据的质量，因为在人类基因组中，转换的发生率通常高于颠换。</p><p data-tool="mdnice编辑器">● Transitions (Ti): 嘌呤之间的替换（A-G）或嘧啶之间的替换（C-T）</p><p data-tool="mdnice编辑器">● Transversions (Tv): 嘌呤和嘧啶之间的替换（A-C, A-T, G-C, G-T）</p><pre data-tool="mdnice编辑器"><span></span><code>titv &lt;- titv(maf = maf,<br>             plot = <span>F</span>,<br>             useSyn = <span>TRUE</span>)<br>plotTiTv(res = titv)<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100001563" data-ratio="0.9715909090909091" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/0SOG4MpDAyENHeyjyagiaNPN86betekt1VQC62MPyQmGGQDtWjb6ouINSmUMn2T4VjzbUoHo4Qu8hR4QeASvyEw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="528" src="https://mmbiz.qpic.cn/sz_mmbiz_png/0SOG4MpDAyENHeyjyagiaNPN86betekt1VQC62MPyQmGGQDtWjb6ouINSmUMn2T4VjzbUoHo4Qu8hR4QeASvyEw/640?wx_fmt=png&amp;from=appmsg"></figure><h5 data-tool="mdnice编辑器"><span></span>6、雨景图<span></span></h5><pre data-tool="mdnice编辑器"><span></span><code>rainfallPlot(maf = maf, <br>             tsb = <span>NULL</span>, <span># 修改这里可以看特定样本 </span><br>             detectChangePoints = <span>TRUE</span>,<br>             pointSize = <span>0.4</span>)<br></code></pre><p data-tool="mdnice编辑器">图中绘制了不同类型的点突变（单核苷酸多态性，SNP）在所有染色体上的分布，以及每种突变之间的距离（对数尺度）。</p><p data-tool="mdnice编辑器"><strong>分布特点</strong>：通过观察不同染色体上的点分布，我们可以推断某些染色体可能存在更频繁的突变事件或特定类型的突变更为常见。</p><p data-tool="mdnice编辑器"><strong>突变热点</strong>：某些区域可能显示出更密集的点，表明这些区域可能是突变热点，这些热点可能与特定的生物学性质或疾病相关。</p><p data-tool="mdnice编辑器"><strong>突变类型的比较</strong>：不同颜色的分布可以帮助识别哪种类型的突变在该样本中更为常见。<img data-imgfileid="100001561" data-ratio="1.0976645435244161" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/0SOG4MpDAyENHeyjyagiaNPN86betekt1PeJ3H4h9iaodNyFMsph3eH4wE2EMVC5Nicu5gF0m1oOKxHnDaKQZ9eeg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="471" src="https://mmbiz.qpic.cn/sz_mmbiz_png/0SOG4MpDAyENHeyjyagiaNPN86betekt1PeJ3H4h9iaodNyFMsph3eH4wE2EMVC5Nicu5gF0m1oOKxHnDaKQZ9eeg/640?wx_fmt=png&amp;from=appmsg"></p><h5 data-tool="mdnice编辑器"><span></span>7、突变位点可视化<span></span></h5><pre data-tool="mdnice编辑器"><span></span><code>lollipopPlot(maf = maf,<br>             gene = <span>"TP53"</span>,<br>             AACol=<span>"HGVSp_Short"</span>,<br>             showMutationRate = <span>TRUE</span>)<br></code></pre><p data-tool="mdnice编辑器"><strong>橙色区域</strong>表示TP53基因中的功能域（例如，P53和P53四聚体域），这些是蛋白质活性和功能的关键区域。</p><p data-tool="mdnice编辑器"><strong>蓝色区域</strong>表示其他结构域，例如DBD_TAD域，与蛋白质的转录活性调节相关。</p><p data-tool="mdnice编辑器"><strong>黄色区域</strong>表示TP53基因中的P53四聚体域（P53 tetramer）</p><p data-tool="mdnice编辑器"><strong>突变集中区域</strong>：注意哪些区域有较多突变聚集，特别是功能域内的突变，因为这些可能影响蛋白质的功能。</p><p data-tool="mdnice编辑器"><strong>突变类型</strong>：错义突变和无义突变的位置可以提供关于可能影响蛋白质功能的重要信息。例如，无义突变可能导致蛋白质提前终止。</p><p data-tool="mdnice编辑器"><strong>频率高的突变</strong>：在图中垂直位置较高的突变表明在研究或数据集中观察到的频率较高，可能是该基因的关键突变。<img data-imgfileid="100001559" data-ratio="0.9715909090909091" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/0SOG4MpDAyENHeyjyagiaNPN86betekt1KfKT9GvJbryA21Ed94yjGSEcaYicy6GAmwvAsmnCg9dw3icfHwVLWX6A/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="528" src="https://mmbiz.qpic.cn/sz_mmbiz_png/0SOG4MpDAyENHeyjyagiaNPN86betekt1KfKT9GvJbryA21Ed94yjGSEcaYicy6GAmwvAsmnCg9dw3icfHwVLWX6A/640?wx_fmt=png&amp;from=appmsg"></p><h5 data-tool="mdnice编辑器"><span></span>8、TCGA肿瘤突变负荷全景图<span></span></h5><pre data-tool="mdnice编辑器"><span></span><code>tcgaCompare(maf=maf.merge,<br>            cohortName=<span>"BREAST"</span>)<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100001562" data-ratio="0.9715909090909091" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/0SOG4MpDAyENHeyjyagiaNPN86betekt1Z0MYuCoWtkynlMwCuOV2vBWSqbekicHSserBj3DicicwGGJzibBbnNUUqw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="528" src="https://mmbiz.qpic.cn/sz_mmbiz_png/0SOG4MpDAyENHeyjyagiaNPN86betekt1Z0MYuCoWtkynlMwCuOV2vBWSqbekicHSserBj3DicicwGGJzibBbnNUUqw/640?wx_fmt=png&amp;from=appmsg"></figure><h5 data-tool="mdnice编辑器"><span></span>9、变异等位基因频率<span></span></h5><pre data-tool="mdnice编辑器"><span></span><code>plotVaf(maf = maf,<br>        top = <span>20</span>)<br><span># t_vaf field is missing, but found t_ref_count &amp; t_alt_count columns. Estimating vaf..</span><br></code></pre><p data-tool="mdnice编辑器">t_vaf field is missing, but found t_ref_count &amp; t_alt_count columns. Estimating vaf..:</p><p data-tool="mdnice编辑器">这条信息说明原始MAF数据中缺少直接表示变异等位基因频率（Variant Allele Frequency，VAF）的字段（通常标记为 t_vaf），但是找到了代表参考等位基因计数（t_ref_count）和变异等位基因计数（t_alt_count）的列。VAF的计算公式通常是变异等位基因计数除以总等位基因计数（变异等位基因计数加上参考等位基因计数）<img data-imgfileid="100001560" data-ratio="0.9715909090909091" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/0SOG4MpDAyENHeyjyagiaNPN86betekt1Y1rzaM6m6eTePydCNWzEaJXRqk5ehEUiabBAm8SNKLPCsvTEo9RibZHg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="528" src="https://mmbiz.qpic.cn/sz_mmbiz_png/0SOG4MpDAyENHeyjyagiaNPN86betekt1Y1rzaM6m6eTePydCNWzEaJXRqk5ehEUiabBAm8SNKLPCsvTEo9RibZHg/640?wx_fmt=png&amp;from=appmsg"></p><h5 data-tool="mdnice编辑器"><span></span>10、共现和互斥分析<span></span></h5><pre data-tool="mdnice编辑器"><span></span><code>somaticInteractions(<br>  maf,<br>  top = <span>20</span>,<br>  genes = <span>NULL</span>,<br>  pvalue = c(<span>0.05</span>, <span>0.01</span>),<br>  returnAll = <span>TRUE</span>,<br>  geneOrder = <span>NULL</span>,<br>  fontSize = <span>0.6</span>,<br>  showSigSymbols = <span>TRUE</span>,<br>  showCounts = <span>FALSE</span>,<br>  countStats = <span>"all"</span>,<br>  countType = <span>"all"</span>,<br>  countsFontSize = <span>0.6</span>,<br>  countsFontColor = <span>"red"</span>,<br>  colPal = <span>"BrBG"</span>,<br>  showSum = <span>TRUE</span>,<br>  plotPadj = <span>FALSE</span>,<br>  colNC = <span>9</span>,<br>  nShiftSymbols = <span>5</span>,<br>  sigSymbolsSize = <span>2</span>,<br>  sigSymbolsFontSize = <span>0.8</span>,<br>  pvSymbols = c(<span>46</span>, <span>42</span>),<br>  limitColorBreaks = <span>TRUE</span><br>)<br></code></pre><p data-tool="mdnice编辑器"><strong>基因标签：</strong></p><p data-tool="mdnice编辑器">● 横轴和纵轴都标有基因名，基因名旁的数字表示该基因突变的样本数量。</p><p data-tool="mdnice编辑器"><strong>颜色和图例：</strong></p><p data-tool="mdnice编辑器">● 颜色深浅表示了P值的对数缩放（-log10 P-value），颜色越深（趋向绿色）表示统计上的关联性越强，颜色越浅（趋向黄色）表示关联性越弱。</p><p data-tool="mdnice编辑器">● 绿色代表基因间的共现（co-occurrence），即这两个基因倾向于在同一样本中同时发生突变。</p><p data-tool="mdnice编辑器">● 黄色代表基因间的互斥（mutually exclusive），即这两个基因倾向于不在同一样本中同时发生突变。</p><p data-tool="mdnice编辑器"><strong>查看基因对的关系</strong>：图中每个单元格代表一对基因间的关系。例如，如果一个单元格位于基因A的行和基因B的列，那么这个单元格的颜色和标记描述了A和B之间的关系。</p><p data-tool="mdnice编辑器"><strong>评估共现和互斥</strong>：找出那些颜色最深的绿色单元格，这些代表具有强烈共现关系的基因对；寻找黄色单元格，尤其是带有星号的，这些代表具有显著互斥关系的基因对。</p><p data-tool="mdnice编辑器"><strong>统计显著性</strong>：特别关注那些带有星号的单元格，因为这些基因对显示了显著的共现或互斥关系。<img data-imgfileid="100001565" data-ratio="0.9715909090909091" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/0SOG4MpDAyENHeyjyagiaNPN86betekt1vVUKkHpuxAcAxIcIth8KVhtZLmt6oibyA5bibTibjKI2AjibhJ1mpUwn3g/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="528" src="https://mmbiz.qpic.cn/sz_mmbiz_png/0SOG4MpDAyENHeyjyagiaNPN86betekt1vVUKkHpuxAcAxIcIth8KVhtZLmt6oibyA5bibTibjKI2AjibhJ1mpUwn3g/640?wx_fmt=png&amp;from=appmsg"></p><h5 data-tool="mdnice编辑器"><span></span>11、基因突变状态与生存的关系<span></span></h5><pre data-tool="mdnice编辑器"><span></span><code>maf@clinical.data$OS.time &lt;- as.numeric(maf@clinical.data$OS.time)<br>mafSurvival(maf = maf, <br>            genes = c(<span>'MUC16'</span>), <br>            time = <span>'OS.time'</span>, <br>            Status = <span>'OS'</span>, <br>            isTCGA = <span>TRUE</span>)<br><span># Looking for clinical data in annoatation slot of MAF..</span><br><span># Number of mutated samples for given genes: </span><br><span># MUC16 </span><br><span>#    61 </span><br><span># Removed 13 samples with NA's</span><br><span># Median survival..</span><br><span>#     Group medianTime     N</span><br><span>#    &lt;char&gt;      &lt;num&gt; &lt;int&gt;</span><br><span># 1:     WT   19.73333   352</span><br><span># Error in survdiff.fit(y, groups, strata.keep, rho) : </span><br><span>#   There is only 1 group</span><br><span># 有一些基因是没法进行分组的</span><br><br><span># 计算获得能够获得生存显著性及基因集合</span><br>prog_geneset = survGroup(maf = maf, <br>                         top = <span>20</span>,  <span># 应用突变频率前20的基因集作为母集</span><br>                         geneSetSize = <span>2</span>, <span># 每2个基因作为signature计算的依据</span><br>                         time = <span>"OS.time"</span>, <br>                         Status = <span>"OS"</span>, <br>                         verbose = <span>FALSE</span>)<br>prog_geneset<br><span>#      Gene_combination  P_value    hr    WT Mutant</span><br><span>#                &lt;char&gt;    &lt;num&gt; &lt;num&gt; &lt;int&gt;  &lt;int&gt;</span><br><span>#   1:       PCLO_GPR98 0.000168 5.580   346      6</span><br><span>#   2:       PCLO_OBSCN 0.001350 3.940   344      8</span><br><span>#   3:        TP53_PCLO 0.002060 2.670   335     17</span><br><span>#   4:      MUC16_HMCN1 0.002610 3.630   346      6</span><br><span>#   5:        TP53_FAT3 0.007420 2.460   338     14</span><br><span>#  ---                                             </span><br><span># 105:     CTNNB1_MUC16 0.950000 1.030   332     20</span><br><span># 106:       MUC16_RYR2 0.950000 0.964   341     11</span><br><span># 107:       ALB_ABCA13 0.996000 1.000   344      8</span><br><span># 108:     ARID1A_AXIN1 0.997000 1.000   347      5</span><br><span># 109:        TTN_XIRP2 0.998000 1.000   345      7</span><br><br><span># 指定基因进行分析</span><br>mafSurvGroup(maf = maf, <br>             geneSet = c(<span>"TP53"</span>, <span>"PCLO"</span>), <br>             time = <span>"OS.time"</span>, <br>             Status = <span>"OS"</span>)<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100001568" data-ratio="0.7825159914712153" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/0SOG4MpDAyENHeyjyagiaNPN86betekt16EFlqTbufZt1YVjdVmWW3MmMWYvUV18b1g3fd2GUGTq3sIX25Aklvg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="938" src="https://mmbiz.qpic.cn/sz_mmbiz_png/0SOG4MpDAyENHeyjyagiaNPN86betekt16EFlqTbufZt1YVjdVmWW3MmMWYvUV18b1g3fd2GUGTq3sIX25Aklvg/640?wx_fmt=png&amp;from=appmsg"></figure><h5 data-tool="mdnice编辑器"><span></span>12、临床表型与突变图谱的相关性分析<span></span></h5><pre data-tool="mdnice编辑器"><span></span><code>race = clinicalEnrichment(maf = maf, <br>                          clinicalFeature = <span>'race.y'</span>)<br><br>OS = clinicalEnrichment(maf = maf, <br>                        clinicalFeature = <span>'OS'</span>)<br><span>#查看有统计学意义的突变类型</span><br>race$groupwise_comparision[p_value &lt; <span>0.05</span>]<br><span>#      Hugo_Symbol                    Group1 Group2 n_mutated_group1 n_mutated_group2     p_value         OR     OR_low     OR_high   fdr</span><br><span>#           &lt;char&gt;                    &lt;char&gt; &lt;char&gt;           &lt;char&gt;           &lt;char&gt;       &lt;num&gt;      &lt;num&gt;      &lt;num&gt;       &lt;num&gt; &lt;num&gt;</span><br><span>#   1:        TP53 BLACK OR AFRICAN AMERICAN   Rest         11 of 16        99 of 349 0.001285001  5.5255089 1.71654429  20.8205063     1</span><br><span>#   2:        TP53                     WHITE   Rest        39 of 176        71 of 189 0.001414001  0.4740894 0.28942050   0.7687838     1</span><br><span>#   3:       FOXG1                     ASIAN   Rest         7 of 151         0 of 214 0.001908274        Inf 2.09742173         Inf     1</span><br><span>#   4:      SEMA3D BLACK OR AFRICAN AMERICAN   Rest          3 of 16         4 of 349 0.002186009 19.3625522 2.57688879 127.7694190     1</span><br><span>#   5:    CACNA2D1                     ASIAN   Rest        11 of 151         2 of 214 0.002373209  8.2837736 1.76888072  77.9776396     1</span><br><span>#  ---                                                                                                                                   </span><br><span># 111:       DIP2C                     ASIAN   Rest         0 of 151         7 of 214 0.044474868  0.0000000 0.00000000   0.9691803     1</span><br><span># 112:      SCAPER                     ASIAN   Rest         0 of 151         7 of 214 0.044474868  0.0000000 0.00000000   0.9691803     1</span><br><span># 113:      TRERF1                     ASIAN   Rest         0 of 151         7 of 214 0.044474868  0.0000000 0.00000000   0.9691803     1</span><br><span># 114:        LRP2                     ASIAN   Rest         3 of 151        14 of 214 0.045851136  0.2904066 0.05257406   1.0669070     1</span><br><span># 115:       LZTR1                     ASIAN   Rest         9 of 151         4 of 214 0.046441601  3.3165026 0.90431753  15.0216913     1</span><br><br><span>#对有意义的临床表型-突变组合数据进行可视化</span><br>plotEnrichmentResults(enrich_res = race, <br>                      pVal = <span>0.05</span>, <br>                      geneFontSize = <span>0.5</span>, <br>                      annoFontSize = <span>0.6</span>)<br><br>plotEnrichmentResults(enrich_res = OS, <br>                      pVal = <span>0.05</span>, <br>                      geneFontSize = <span>0.5</span>, <br>                      annoFontSize = <span>0.6</span>)<br></code></pre><p data-tool="mdnice编辑器">灰色代表的是未分类的信息。<img data-imgfileid="100001567" data-ratio="0.6140142517814727" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/0SOG4MpDAyENHeyjyagiaNPN86betekt1ZicVm5UPv0VqIqicu2ThgicUSZwFIgmh7hpqNQkmOMxqg6iaiaRsyRzvRgw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="842" src="https://mmbiz.qpic.cn/sz_mmbiz_png/0SOG4MpDAyENHeyjyagiaNPN86betekt1ZicVm5UPv0VqIqicu2ThgicUSZwFIgmh7hpqNQkmOMxqg6iaiaRsyRzvRgw/640?wx_fmt=png&amp;from=appmsg"><img data-imgfileid="100001566" data-ratio="0.6758169934640523" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/0SOG4MpDAyENHeyjyagiaNPN86betekt15L26yQchP9F2ybjRd4tH6Z5mCzricBQB2QialOk9iaCmDrRNgwia5KExIA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="765" src="https://mmbiz.qpic.cn/sz_mmbiz_png/0SOG4MpDAyENHeyjyagiaNPN86betekt15L26yQchP9F2ybjRd4tH6Z5mCzricBQB2QialOk9iaCmDrRNgwia5KExIA/640?wx_fmt=png&amp;from=appmsg"></p><h5 data-tool="mdnice编辑器"><span></span>13、药物互作<span></span></h5><pre data-tool="mdnice编辑器"><span></span><code><span>#查看药物-突变相关作用(潜在可靶药物)作用</span><br>drug = drugInteractions(maf = maf, fontSize = <span>0.75</span>)<br><br><span>#查看数据库中特定基因的可靶药物</span><br>drug_gene = drugInteractions(genes = <span>"TP53"</span>, drugs = <span>TRUE</span>)<br><span># Number of claimed drugs for given genes:</span><br><span>#      Gene     N</span><br><span>#    &lt;char&gt; &lt;int&gt;</span><br><span># 1:   TP53   193</span><br>drug_gene<br><span>#        Gene        interaction_claim_source interaction_types         drug_claim_name drug_claim_primary_name     drug_name drug_chembl_id</span><br><span>#      &lt;char&gt;                          &lt;char&gt;            &lt;char&gt;                  &lt;char&gt;                  &lt;char&gt;        &lt;char&gt;         &lt;char&gt;</span><br><span>#   1:   TP53                             CKB                                     CTX-1                   CTX-1                             </span><br><span>#   2:   TP53                             CKB                               Gemcitabine             Gemcitabine   GEMCITABINE      CHEMBL888</span><br><span>#   3:   TP53 ClearityFoundationClinicalTrial                               GRANISETRON             GRANISETRON   GRANISETRON   CHEMBL289469</span><br><span>#   4:   TP53                             CKB                                epirubicin              epirubicin    EPIRUBICIN      CHEMBL417</span><br><span>#   5:   TP53                             NCI                   TOPICAL CORTICOSTEROIDS TOPICAL CORTICOSTEROIDS                             </span><br><span>#  ---                                                                                                                                      </span><br><span># 189:   TP53                             CKB                                  CEP-8983                CEP-8983                             </span><br><span># 190:   TP53                             CKB                               Panitumumab             Panitumumab   PANITUMUMAB  CHEMBL1201827</span><br><span># 191:   TP53                             NCI                             STREPTONIGRIN           STREPTONIGRIN STREPTONIGRIN    CHEMBL11417</span><br><span># 192:   TP53                             CKB                                Seliciclib              Seliciclib    SELICICLIB    CHEMBL14762</span><br><span># 193:   TP53                             CKB                                 PD0166285               PD0166285                             </span><br><span>#                                             PMIDs</span><br><span>#                                            &lt;char&gt;</span><br><span>#   1:                                     26883273</span><br><span>#   2: 27167172,23520471,21389100,27815358,26228206</span><br><span>#   3:                                             </span><br><span>#   4:                                     22903472</span><br><span>#   5:                                     12207591</span><br><span>#  ---                                             </span><br><span># 189:                                     23428903</span><br><span># 190:                                     28514312</span><br><span># 191:                                     12027749</span><br><span># 192:                            22862161,26826118</span><br><span># 193:                                     11719452</span><br></code></pre><p data-tool="mdnice编辑器"><strong>图表解释</strong></p><p data-tool="mdnice编辑器">纵轴（Y轴）：展示了不同的药物靶向类别，如“TYROSINE KINASE”、“DNA REPAIR”、“CELL SURFACE”等。</p><p data-tool="mdnice编辑器">横轴（X轴）：显示了每个类别中基因的数量，范围从0到12。类别和基因</p><p data-tool="mdnice编辑器">每个类别旁边括号内的是该类别中的基因，例如：TYROSINE KINASE [TTN]：表示酪氨酸激酶类包含TTN基因。DNA REPAIR [TP53]：表示DNA修复类包含TP53基因。</p><p data-tool="mdnice编辑器"><strong>数据解读</strong></p><p data-tool="mdnice编辑器">基因数量：条形的长度表示该类别中涉及的基因数量。图中的黑色条形突出显示了每个类别中的基因数量，有助于快速识别哪些类别含有较多的潜在药物靶点基因。</p><p data-tool="mdnice编辑器">药物靶点类别：这些类别根据其在药物开发中的重要性和功能进行了组织，提供了潜在的药物作用靶点的概览。<img data-imgfileid="100001564" data-ratio="1.2925" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/0SOG4MpDAyENHeyjyagiaNPN86betekt1QqqTLdickic1RaUOECf3Vq1TUkhjePKWQ9HvXenGae8BVYnDB47QlHIA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="400" src="https://mmbiz.qpic.cn/sz_mmbiz_png/0SOG4MpDAyENHeyjyagiaNPN86betekt1QqqTLdickic1RaUOECf3Vq1TUkhjePKWQ9HvXenGae8BVYnDB47QlHIA/640?wx_fmt=png&amp;from=appmsg"></p><h5 data-tool="mdnice编辑器"><span></span>14、突变负荷分析<span></span></h5><pre data-tool="mdnice编辑器"><span></span><code>tmb(maf = maf)<br><span>#              Tumor_Sample_Barcode total total_perMB total_perMB_log</span><br><span>#                            &lt;fctr&gt; &lt;num&gt;       &lt;num&gt;           &lt;num&gt;</span><br><span>#   1: TCGA-BC-A10X-01A-11D-A12Z-10     1        0.02      -1.6989700</span><br><span>#   2: TCGA-ED-A627-01A-12D-A30V-10     2        0.04      -1.3979400</span><br><span>#   3: TCGA-XR-A8TE-01A-11D-A35Z-10    12        0.24      -0.6197888</span><br><span>#   4: TCGA-5R-AA1D-01A-11D-A382-10    15        0.30      -0.5228787</span><br><span>#   5: TCGA-CC-A9FV-01A-11D-A36X-10    15        0.30      -0.5228787</span><br><span>#  ---                                                               </span><br><span># 361: TCGA-DD-AAC8-01A-11D-A40R-10   500       10.00       1.0000000</span><br><span># 362: TCGA-DD-A1EE-01A-11D-A12Z-10   663       13.26       1.1225435</span><br><span># 363: TCGA-CC-A7IH-01A-11D-A33K-10   675       13.50       1.1303338</span><br><span># 364: TCGA-4R-AA8I-01A-11D-A382-10  1054       21.08       1.3238706</span><br><span># 365: TCGA-UB-A7MB-01A-11D-A33Q-10  1294       25.88       1.4129643</span><br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100001573" data-ratio="1.0976645435244161" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/0SOG4MpDAyENHeyjyagiaNPN86betekt16C2kZL0DnjfFnBmHbGNjRb5yiapZdplEicEa74DqV4yMSM6Ue1e1WDSA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="471" src="https://mmbiz.qpic.cn/sz_mmbiz_png/0SOG4MpDAyENHeyjyagiaNPN86betekt16C2kZL0DnjfFnBmHbGNjRb5yiapZdplEicEa74DqV4yMSM6Ue1e1WDSA/640?wx_fmt=png&amp;from=appmsg"></figure><h4 data-tool="mdnice编辑器"><span></span>参考资料：<span></span></h4><p data-tool="mdnice编辑器">1、Maftools: efficient and comprehensive analysis of somatic variants in cancer. Genome Res. 2018 Nov;28(11):1747-1756. doi: 10.1101/gr.239244.118.</p><p data-tool="mdnice编辑器">2、Maftools说明文档: https://bioconductor.org/packages/release/bioc/vignettes/maftools/inst/doc/maftools.html#1_Introduction</p><p data-tool="mdnice编辑器">3、生信技能树：https://mp.weixin.qq.com/s/EHrJCEl8FL_3pdDxvuY7Twhttps://mp.weixin.qq.com/s/Lx3ExJd6hg1sYMwEzugT2Q</p><p data-tool="mdnice编辑器">4、生信菜鸟团：https://mp.weixin.qq.com/s/looYjwANerhPUMd7v0_5Fg</p><p data-tool="mdnice编辑器">5、生信星球：https://mp.weixin.qq.com/s/z-8K95DJ-aIOdQMubqpMqQ</p><p data-tool="mdnice编辑器">6、医学和生信笔记：https://mp.weixin.qq.com/s/1cR3Cnfd5Co9U3jIoIWJBA</p><p data-tool="mdnice编辑器">7、聊生信：https://mp.weixin.qq.com/s/vKM-VMyFtLcW_VlnCkDngw</p><p data-tool="mdnice编辑器">8、芒果师兄聊生信：https://mp.weixin.qq.com/s/V6lce2wCR2asJCEewcvwqA</p><p data-tool="mdnice编辑器">9、灵活胖子的科研进步之路：https://mp.weixin.qq.com/s/6vllQmjsem8jEZgBsrayuQ</p><p data-tool="mdnice编辑器">10、生信碱移：https://mp.weixin.qq.com/s/pBDue6hOf0DrTZMN0rB2sA</p><p data-tool="mdnice编辑器">11、小明的数据分析笔记本：https://mp.weixin.qq.com/s/Qi9rkGAV0r__tvnIXoLSYQ</p><p data-tool="mdnice编辑器">12、Bio小菜鸟：https://mp.weixin.qq.com/s/vC3pBavzLOJrtaiRIDB2Ag</p><p data-tool="mdnice编辑器"><strong>注</strong>：若对内容有疑惑或者有发现明确错误的朋友，请联系后台(欢迎交流)。更多内容可关注公众号：<strong>生信方舟</strong></p><span>- END -</span></section><p><br></p><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/MjL16h5FcxqPuQjCQ_6l8A",target="_blank" rel="noopener noreferrer">原文链接</a>
