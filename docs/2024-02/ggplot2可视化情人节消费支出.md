---
title: "ggplot2可视化情人节消费支出"
date: 2024-02-14T13:20:43Z
draft: ["false"]
tags: [
  "fetched",
  "R语言数据分析指南"
]
categories: ["Acdemic"]
---
ggplot2可视化情人节消费支出 by R语言数据分析指南
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><h3 data-tool="mdnice编辑器"><span></span><span><span></span>欢迎关注R语言数据分析指南</span><span></span></h3><blockquote data-tool="mdnice编辑器"><span>❝</span><p>本节来介绍如何使用ggstar包绘制心形并通过哑铃图的形式来展示美国情人节消费支出，数据为随意构建，整个过程仅参考。希望对各位观众老爷能有所帮助。<strong>「数据代码已经整合上传到会员交流群」</strong>，购买过小编VIP的朋友可在所加的会员群内获取下载，有需要的朋友可关注文末介绍加入VIP交流群。</p><span>❞</span></blockquote><h3 data-tool="mdnice编辑器"><span></span><span><span></span>关于永久群内容的说明</span><span></span></h3><blockquote data-tool="mdnice编辑器"><span>❝</span><p>给予长期支持我们的忠实读者们一个特别待遇：凡是购买小编2022年或2023年VIP会员文档的读者，<strong>「将自动获得2024年及以后更新的绘图文档代码，无需额外付费。」</strong></p><span>❞</span></blockquote><h3 data-tool="mdnice编辑器"><span></span><span><span></span>加载R包</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code><span>library</span>(ggstar)<br><span>library</span>(tidyverse)<br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span><span></span>R包版本号</span><span></span></h3><p data-tool="mdnice编辑器">版本号尽量保持一致，不然可能会有报错参生</p><pre data-tool="mdnice编辑器"><span></span><code>sessionInfo()<br></code></pre><pre data-tool="mdnice编辑器"><span></span><code>other attached packages:<br> [<span>1</span>] lubridate_1.9.3  forcats_1.0.0    stringr_1.5.1    dplyr_1.1.4      purrr_1.0.2     <br> [<span>6</span>] readr_2.1.5      tidyr_1.3.0      tibble_3.2.1     ggplot2_3.4.4    tidyverse_2.0.0 <br>[<span>11</span>] ggstar_1.0.4.001<br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span><span></span>导入数据</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code>gifts_gender &lt;- read_tsv(<span>"data.xls"</span>)<br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span><span></span>数据清洗</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code>df &lt;- gifts_gender %&gt;% select(-SpendingCelebrating) %&gt;% pivot_longer(-Gender) <br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span><span></span>定义函数添加%</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code>add_percent &lt;- <span>function</span>(x) {<br>  paste0(x, <span>"%"</span>)<br>}<br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span><span></span>定义因子</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code>df<span>$name</span> &lt;- factor(df<span>$name</span>,levels = c(<span>"Candy"</span>,<span>"GreetingCards"</span>,<span>"Flowers"</span>,<br>                                     <span>"EveningOut"</span>,<span>"Jewelry"</span>,<span>"Clothing"</span>,<span>"GiftCards"</span>) %&gt;% <br>                    rev())<br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span><span></span>构建标签位置信息</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code>df_text &lt;- df %&gt;% select(-Gender) %&gt;% group_by(name) %&gt;% <br>  summarise(across(everything(), ~ mean(.x, na.rm = <span>TRUE</span>)))<br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span><span></span>数据可视化</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code>df %&gt;% ggplot(aes(value,name,group=name))+<br>  geom_line(color=<span>"grey30"</span>)+<br>  geom_star(starshape=<span>16</span>,size=<span>8</span>,aes(fill=Gender),show.legend = <span>F</span>) +<br>  geom_text(aes(label =value), size = <span>3.5</span>,color=<span>"white"</span>) +<br>  geom_text(data=df_text,aes(label = paste(name),x=value), <br>            nudge_y = <span>0.45</span>, size =<span>4</span>, color=<span>"black"</span>)+<br>  scale_fill_manual(values = c(<span>"#663399"</span>,<span>"#FF69B4"</span>))+<br>  theme(axis.text.y = element_blank(),<br>        axis.text.x = element_text(color=<span>"black"</span>,face=<span>"bold"</span>),<br>        axis.ticks=element_blank(),<br>        axis.title = element_blank(),<br>        panel.background = element_blank(),<br>        plot.background = element_blank(),<br>        plot.margin = unit(c(<span>0.5</span>, <span>0.5</span>, <span>0.5</span>,<span>0.5</span>), <span>"cm"</span>))<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100025847" data-ratio="0.7601851851851852" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAaAU7uXHlkZ98mm8icWJ0icCZOoUkObvlSg6oK6y0PKLBLtpKE2KKY0O3R1cUFqxBic9ZsdgLfZQbZHg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAaAU7uXHlkZ98mm8icWJ0icCZOoUkObvlSg6oK6y0PKLBLtpKE2KKY0O3R1cUFqxBic9ZsdgLfZQbZHg/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器">本节介绍到此结束祝节日快乐，有需要学习数据可视化的朋友，欢迎到小编的<strong>「淘宝店铺」</strong> <strong>「R语言数据分析指南」</strong>下单购买，内容主要包括各种<strong>「高分论文的图表分析复现以及一些个性化图表的绘制」</strong>均包含数据+代码。购买会员文档后微信发小编订单号即邀请进新的会员交流群</p><h3 data-tool="mdnice编辑器"><span></span><span><span></span>淘宝店铺(有需要欢迎关注)</span><span></span></h3><p><img data-galleryid="" data-imgfileid="100019415" data-ratio="1.0210420841683367" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/EibnicgwScTAbvhPDLGT8NaialEsht92PTYNJWpmVLfoYGic1uha5FyBrDCibibZCLjiazgvpT1XcdwibfVywD2el0VAgg/640?wx_fmt=jpeg" data-type="jpeg" data-w="998" src="https://mmbiz.qpic.cn/mmbiz_jpg/EibnicgwScTAbvhPDLGT8NaialEsht92PTYNJWpmVLfoYGic1uha5FyBrDCibibZCLjiazgvpT1XcdwibfVywD2el0VAgg/640?wx_fmt=jpeg"></p><h3 data-tool="mdnice编辑器"><span></span><span><span></span>关注下方公众号下回更新不迷路</span><span></span></h3></section><p><br></p><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/OCJv1wzT2_CDZz8jZOq2Lg",target="_blank" rel="noopener noreferrer">原文链接</a>
