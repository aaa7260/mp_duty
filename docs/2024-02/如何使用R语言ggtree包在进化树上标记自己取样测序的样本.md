---
title: "如何使用R语言ggtree包在进化树上标记自己取样测序的样本"
date: 2024-02-06T10:12:51Z
draft: ["false"]
tags: [
  "fetched",
  "小明的数据分析笔记本"
]
categories: ["Acdemic"]
---
如何使用R语言ggtree包在进化树上标记自己取样测序的样本 by 小明的数据分析笔记本
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-mpa-powered-by="yiban.io"><p data-tool="mdnice编辑器">随着三代测序技术的发展和测序成本的下降，现在基于三代测序数据组装基因组做泛基因组的研究越来越多。虽然测序成本降低了许多，但也是相对于之前，做大规模的测序组装的费用也是非常昂贵的，现在通常的做法是如果做了大规模的二代测序，通常会利用这些数据做的进化树，然后根据进化树的分布在每一个类群里选取一些有代表性的个体去做三代测序组装。比如大豆cell发表的泛基因组论文，就是从2000多份材料里选择26份有代表性的材料。</p><p data-tool="mdnice编辑器">论文里通常会有一幅图来展示所有材料的进化树，然后做三代测序组装的材料单独标记出来</p><figure data-tool="mdnice编辑器"><img data-imgfileid="100013035" data-ratio="0.37786259541984735" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/t1wZDoUyFk7t2qeQiaj7Pf33DvkTic63vyriclded8PhA82skNWufvpGcoNLKLHS6yWp5aHIGRSQDP57Xib19RUsNg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1048" src="https://mmbiz.qpic.cn/sz_mmbiz_png/t1wZDoUyFk7t2qeQiaj7Pf33DvkTic63vyriclded8PhA82skNWufvpGcoNLKLHS6yWp5aHIGRSQDP57Xib19RUsNg/640?wx_fmt=png&amp;from=appmsg"><figcaption>image.png</figcaption></figure><p data-tool="mdnice编辑器">这个是大豆cell那篇论文的图1B</p><p data-tool="mdnice编辑器">这里没有找到合适的数据，就自己随便构造一个进化树</p><figure data-tool="mdnice编辑器"><img data-imgfileid="100013036" data-ratio="0.9811320754716981" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/t1wZDoUyFk7t2qeQiaj7Pf33DvkTic63vyugict76V9euUyxaicpDV59QicZqian8UXhHn0mOEyVh24HsjtOUWkaCqdQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="901" src="https://mmbiz.qpic.cn/sz_mmbiz_png/t1wZDoUyFk7t2qeQiaj7Pf33DvkTic63vyugict76V9euUyxaicpDV59QicZqian8UXhHn0mOEyVh24HsjtOUWkaCqdQ/640?wx_fmt=png&amp;from=appmsg"><figcaption>image.png</figcaption></figure><p data-tool="mdnice编辑器">这个进化树，大体上可以分为三个组，在每个组中选择一两个材料，比如我选择了C F K这三个材料，我要自进化树上给这三个材料单独标记颜色</p><h2 data-tool="mdnice编辑器"><span></span><span>代码</span><span></span><span> </span></h2><pre data-tool="mdnice编辑器"><span></span><code>library(ggtree)<br>library(treeio)<br><br><br>tree &lt;- read.tree(<span>"data/20220829/fig2.nwk"</span>)<br>ggtree(tree)+<br>  geom_tiplab()<br><br>group01&lt;-c(<span>"C"</span>,<span>"F"</span>,<span>"K"</span>)<br><br><br>group02&lt;-tree<span>$tip</span>.label[-match(group01,tree<span>$tip</span>.label)]<br>groupInfo&lt;-list(group01=group01,<br>                group02=group02)<br><br>new.tree&lt;-groupOTU(tree,groupInfo)<br><br>ggtree(new.tree,aes(color=group))+<br>  scale_color_manual(values = c(<span>"red"</span>,<span>"gray"</span>))+<br>  ggnewscale::new_scale_color()+<br>  geom_tiplab(aes(color=group,alpha=group),<br>              size=10,offset = -2,hjust=0.5)+<br>  geom_tippoint(aes(shape=group,color=group,alpha=group),<br>                show.legend = F,size=10)+<br>  <span>#scale_color_manual(values = c("white","red"))+</span><br>  scale_alpha_manual(values = c(1,0))+<br>  scale_shape_manual(values = c(19,5))+<br>  layout_dendrogram()+<br>  theme(legend.position = <span>"none"</span>)<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100013034" data-ratio="0.42592592592592593" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/t1wZDoUyFk7t2qeQiaj7Pf33DvkTic63vyHvDWVshnTrUVuKc96FlVphd3iczIG7yYdw5CmnwWibx2wiccb7f3BqL1w/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/t1wZDoUyFk7t2qeQiaj7Pf33DvkTic63vyHvDWVshnTrUVuKc96FlVphd3iczIG7yYdw5CmnwWibx2wiccb7f3BqL1w/640?wx_fmt=png&amp;from=appmsg"><figcaption>image.png</figcaption></figure><blockquote data-tool="mdnice编辑器"><span></span><p>示例数据和代码可以给推文打赏一元获取</p></blockquote><p data-tool="mdnice编辑器"><strong>欢迎大家关注我的公众号</strong></p><p data-tool="mdnice编辑器"><strong>小明的数据分析笔记本</strong></p><section><mp-common-profile data-pluginname="mpprofile" data-id="MzI3NzQ3MTcxMg==" data-headimg="http://mmbiz.qpic.cn/mmbiz_png/t1wZDoUyFk5t1sOnM0iabvBhnfIj5YpyqrMib0E1MGCd9ibcYxaOPZd0GWhQBDvK2BPEwsicQxd6y5MHLfphnwHnow/0?wx_fmt=png" data-nickname="小明的数据分析笔记本" data-alias="" data-signature="分享R语言和python在生物信息领域做数据分析和数据可视化的简单小例子；偶尔会分享一些组学数据处理相关的内容" data-from="0" data-is_biz_ban="0"></mp-common-profile></section><p data-tool="mdnice编辑器"><strong></strong></p><blockquote data-tool="mdnice编辑器"><span></span><p>小明的数据分析笔记本 公众号 主要分享：1、R语言和python做数据分析和数据可视化的简单小例子；2、园艺植物相关转录组学、基因组学、群体遗传学文献阅读笔记；3、生物信息学入门学习资料及自己的学习笔记！</p></blockquote></section><p><br></p><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/LvjScxvmvoCPzmiX2mPkIg",target="_blank" rel="noopener noreferrer">原文链接</a>
