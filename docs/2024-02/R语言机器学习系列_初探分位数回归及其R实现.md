---
title: "R语言机器学习系列|初探分位数回归及其R实现"
date: 2024-02-28T21:24:28Z
draft: ["false"]
tags: [
  "fetched",
  "科研生信充电宝"
]
categories: ["Acdemic"]
---
R语言机器学习系列|初探分位数回归及其R实现 by 科研生信充电宝
------
<div><section><section powered-by="xiumi.us"><section><p><strong>R语言机器学习系列</strong></p></section></section><section powered-by="xiumi.us"><section><p>R</p></section></section><section powered-by="xiumi.us"><section><p><strong>初探分位数回归</strong></p><p><strong>及其R实现</strong><br></p></section></section><section powered-by="xiumi.us"><p>- 02·27-</p></section><section powered-by="xiumi.us"><section><p>宜分享</p></section></section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><p><strong></strong><strong>初探分位数回归及其R实现</strong></p></section></section></section><section powered-by="xiumi.us"><section><p><span>Brief Introduction</span><br></p></section></section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><p><strong>01</strong></p></section></section></section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><p><strong>分位数回归的基本概念</strong></p></section></section></section></section><section powered-by="xiumi.us"><p>分位数回归（Quantile Regression）是一种统计技术，用于估计变量的各个分位数之间的线性关系。与传统的最小二乘回归（OLS）不同，它不仅仅预测条件均值，而是可以预测条件中位数或其他任何分位数，提供了一种更全面的视角来分析因变量与一个或多个自变量之间的关系。</p><p><br></p><p>分位数回归特别适用于数据不满足常态分布或存在异常值的情况，能够提供比OLS更为稳健的估计。<br></p><p><br></p><p>下面请跟随小编一起来学习这一期内容吧~</p></section><section powered-by="xiumi.us"><section><img data-ratio="0.7464788732394366" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/hN03ibG0t2HtDHGTBHgggicRROEkvKlfnkDibia3DI5sNPJStD2YsXA3PNzm2ozV7K1GyLARRFFhY8Peu2XjzwHzYw/640?wx_fmt=png" data-w="852" src="https://mmbiz.qpic.cn/mmbiz_png/hN03ibG0t2HtDHGTBHgggicRROEkvKlfnkDibia3DI5sNPJStD2YsXA3PNzm2ozV7K1GyLARRFFhY8Peu2XjzwHzYw/640?wx_fmt=png"></section></section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><p><strong>02</strong></p></section></section></section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><p><strong><span>分位数回归的公式</span>：</strong></p></section></section></section></section><section powered-by="xiumi.us"><section><img data-ratio="0.3543123543123543" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/hN03ibG0t2HtDHGTBHgggicRROEkvKlfnkEp5kib1UxLhzblX4LudxQ8wfB3T3XiakWSyhzlfeY50Kgm4csA1frGwQ/640?wx_fmt=png" data-w="858" src="https://mmbiz.qpic.cn/mmbiz_png/hN03ibG0t2HtDHGTBHgggicRROEkvKlfnkEp5kib1UxLhzblX4LudxQ8wfB3T3XiakWSyhzlfeY50Kgm4csA1frGwQ/640?wx_fmt=png"></section></section><p powered-by="xiumi.us"><br></p><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><p><strong>03</strong></p></section></section></section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><p><strong>为什么在医学领域选择分位数回归：</strong></p></section></section></section></section><section powered-by="xiumi.us"><p>在医学领域，分位数回归可以用来分析各种因素对疾病发生风险、治疗效果或病情进展的影响。<span><strong>研究者经常面临的一个数据问题是数据的异质性。</strong></span>例如，在研究某种药物对血压的影响时，不同患者的反应可能会有很大差异。传统的线性回归模型，如最小二乘法，主要关注于预测因变量的条件均值。然而，这种方法可能无法充分捕捉到数据的全部特性，特别是当数据分布不均匀或存在异常值时。</p><p><br></p><p><span><strong>而分位数回归提供了一种解决这一问题的方法。</strong></span>它不仅可以预测条件均值，还可以预测条件分位数，从而提供了关于因变量分布的更全面的视图。通过预测不同的条件分位数（例如，第25、50和75百分位数），研究者可以更好地理解变量之间的关系在不同点上是如何变化的。</p></section><section powered-by="xiumi.us"><section><img data-ratio="0.5037037037037037" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/hN03ibG0t2HtDHGTBHgggicRROEkvKlfnkRoJSpsdRXnuMMkVfciaEg469iarEdt7ric3VrHF76hRqCz8GRCWws8iakg/640?wx_fmt=png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/hN03ibG0t2HtDHGTBHgggicRROEkvKlfnkRoJSpsdRXnuMMkVfciaEg469iarEdt7ric3VrHF76hRqCz8GRCWws8iakg/640?wx_fmt=png"></section></section><section powered-by="xiumi.us"><p><br></p><p><strong><span>例如，通过分析不同年龄、性别、生活习惯等因素对血压、胆固醇水平或体重指数（BMI）不同分位数的影响，可以更深入地理解这些因素如何影响人群健康状况的分布。</span></strong></p><p><br></p><p><span><strong>再比如，通过分析药物对血压影响的不同分位数，研究者可以识别出哪些患者可能从治疗中获益最大（或最小），以及治疗效果的变异性如何随患者特征变化。</strong></span>这种分析可以为个性化医疗提供重要信息，帮助医生为不同的患者制定更合适的治疗方案。</p><p><br></p><p><strong>通过结合机器学习知识和具体的应用场景，分位数回归展现了其在处理复杂医学数据中的强大能力，这种方法尤其适用于处理非对称分布的医学数据，以及当研究者对极端值（如高风险群体）更感兴趣时，</strong><strong>可以帮助研究者理解治疗效果的不确定性和变异性</strong><strong>，从不同角度理解和解释数据，从而做出更为精准和有针对性的医疗决策。</strong></p></section><section powered-by="xiumi.us"><section><img data-ratio="0.9939577039274925" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/hN03ibG0t2HtDHGTBHgggicRROEkvKlfnkQSyXDLy7gu0eHkjiawySWZNicawgf7e8TyvdG4QyVdDJ3qY88qAg6XXg/640?wx_fmt=png" data-w="993" src="https://mmbiz.qpic.cn/mmbiz_png/hN03ibG0t2HtDHGTBHgggicRROEkvKlfnkQSyXDLy7gu0eHkjiawySWZNicawgf7e8TyvdG4QyVdDJ3qY88qAg6XXg/640?wx_fmt=png"></section></section><p powered-by="xiumi.us"><br></p><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><p><strong>04</strong></p></section></section></section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><p><strong>有哪些常用的分位数回归模型呢？</strong></p></section></section></section></section><section powered-by="xiumi.us"><p><strong>1. 线性分位数回归</strong></p><p><strong>优点:</strong><br></p><ul><li><p>简单易理解，可以直接通过最小化分位数损失函数来求解。<br></p></li><li><p>计算效率高，适用于小到中等规模的数据集。<br></p></li><li><p>模型的系数容易解释，可以直接得到对应分位数的线性关系。<br></p></li></ul><p><strong>缺点:</strong></p><ul><li><p>对于非线性关系，模型的表现可能不佳。</p></li><li><p>对异常值较敏感，尤其是在目标分布的尾部。</p></li></ul><p><strong>2. 随机森林分位数回归</strong></p><p><strong>优点:</strong></p><ul><li><p>能够自然地处理非线性和复杂的数据结构。</p></li><li><p>对异常值具有较好的鲁棒性。</p></li><li><p>可以自动进行特征选择，减少过拟合的风险。</p></li></ul><p><strong>缺点:</strong></p><ul><li><p>相对于线性模型，随机森林的结果更难解释。</p></li><li><p>训练和预测的时间较长，尤其是在大数据集上。</p></li></ul><p><strong>3. 支持向量机分位数回归 (SVR)</strong></p><p><strong>优点:</strong></p><ul><li><p>通过使用不同的核函数，SVR可以很好地处理非线性问题。</p></li><li><p>模型具有较好的泛化能力，尤其是在合适的正则化下。</p></li></ul><p><strong>缺点:</strong></p><ul><li><p>参数调优（如C、epsilon和核参数）对模型性能有较大影响，但调优过程可能既复杂又耗时。</p></li><li><p>计算成本高，尤其是在处理大规模数据集时。</p></li></ul><p><strong>4. 深度学习分位数回归</strong></p><p><strong>优点:</strong></p><ul><li><p>非常灵活，能够通过设计网络架构来捕捉复杂的非线性关系和交互效应。</p></li><li><p>对大规模数据集有良好的适应性。</p></li></ul><p><strong>缺点:</strong></p><ul><li><p>需要大量的数据来训练模型，以避免过拟合。</p></li><li><p>模型解释性差，很难理解模型是如何做出预测的。</p></li><li><p>训练时间长，对计算资源的需求高。</p></li></ul><p><strong>5. 量子神经网络分位数回归</strong></p><p><strong>优点:</strong></p><ul><li><p>在处理特定类型的问题时，可能提供超越传统机器学习技术的能力。</p></li><li><p>长期来看，有潜力处理复杂度极高的问题。</p></li></ul><p><strong>缺点:</strong></p><ul><li><p>目前仍处于研究和开发的早期阶段，实际应用有限。</p></li><li><p>需要特殊的硬件和软件支持，可接触性有限。</p></li></ul></section><section powered-by="xiumi.us"><section><img data-ratio="0.7232704402515723" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/hN03ibG0t2HtDHGTBHgggicRROEkvKlfnkz0LSs28iamm50ubjh11m1IryS3lYQ5mqckp9k834ic9Nc2YxMmhntLYw/640?wx_fmt=png" data-w="636" src="https://mmbiz.qpic.cn/mmbiz_png/hN03ibG0t2HtDHGTBHgggicRROEkvKlfnkz0LSs28iamm50ubjh11m1IryS3lYQ5mqckp9k834ic9Nc2YxMmhntLYw/640?wx_fmt=png"></section></section><section powered-by="xiumi.us"><p><br></p><p>此外，还有比较常用的<strong>梯度提升分位数回归模型（Gradient Boosting Quantile Regression，简称GBQR）</strong>是一种基于梯度提升方法的分位数回归技术。它结合了梯度提升机（Gradient Boosting Machine, GBM）的强大能力和分位数回归的灵活性，以预测条件分位数而非条件均值。这种模型特别适用于预测分布的不同部分，如预测一个分布的下尾（较低分位数）或上尾（较高分位数），这在风险管理、医学、金融预测等领域非常有用。</p><p><br></p><p><strong>梯度提升分位数回归模型的特点</strong></p><p><strong>优点</strong></p><ul><li><p>灵活性高：能够适应各种类型的数据分布和复杂的非线性关系，通过调整分位数参数，可以估计任意分位数。</p></li><li><p>鲁棒性强：对异常值具有较好的鲁棒性，因为分位数回归不像均值回归那样对异常值高度敏感。</p></li><li><p>减少过拟合风险：梯度提升方法通过逐步添加树模型来减少过拟合的风险，每一步的添加都旨在减少上一步的残差，使模型逐渐改进。</p></li><li><p>解释性：虽然梯度提升树的解释性不如线性模型，但通过特征重要性等指标，它能提供一定程度的解释性，帮助理解哪些因素对预测结果有重要影响。</p></li></ul><p><strong>缺点</strong><br></p><ul><li><p>参数调整：需要仔细调整多个参数（如树的数量、深度、学习率等），参数选择对模型性能有显著影响。<br></p></li><li><p>计算成本：尽管单个树模型的训练通常很快，但由于梯度提升需要逐步构建多个树模型，因此整体训练过程可能相对耗时，特别是在数据集较大时。<br></p></li><li><p>预测速度：虽然通常快于深度学习模型，但在有大量树的情况下预测速度可能会慢于一些简单模型。<br></p></li></ul><p><strong>应用场景</strong><br></p><p>梯度提升分位数回归模型在需要预测分布的特定分位数，尤其是对风险敏感的领域中特别有用。例如，在金融领域，可以用来预测资产回报的潜在下行风险；在医疗领域，可用于预测疾病恢复时间的不同可能性；在零售和供应链管理中，有助于优化库存水平，通过预测需求的不确定性来减少缺货或过剩库存的风险。</p><p><br></p><p>总的来说，梯度提升分位数回归模型通过提供对数据分布不同部分的深入了解，使决策者能够更好地评估和管理潜在的风险和不确定性。</p><p><br></p><p><br></p></section><section powered-by="xiumi.us"><section><img data-ratio="0.7312" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/hN03ibG0t2HtDHGTBHgggicRROEkvKlfnk43l6YkQ2MfCBQP6PXiczuSfHAh0uOibyTiaU5hubpmYJibBJf9MCvootlg/640?wx_fmt=png" data-w="625" src="https://mmbiz.qpic.cn/mmbiz_png/hN03ibG0t2HtDHGTBHgggicRROEkvKlfnk43l6YkQ2MfCBQP6PXiczuSfHAh0uOibyTiaU5hubpmYJibBJf9MCvootlg/640?wx_fmt=png"></section></section><section powered-by="xiumi.us"><p><strong>Expectile regression （期望值回归）</strong>是一种统计分析方法，与分位数回归相似，但它关注的是条件期望值的不同水平，而不是条件分布的分位数。Expectile regression 通过最小化加权残差平方的和来估计模型参数，这些加权残差平方的权重取决于残差的正负和指定的expectile水平。该方法为数据的不同部分（即不同的条件期望水平）提供了一种灵活的建模策略，从而能够揭示变量之间复杂的非线性关系和异质性。<br></p><p>与分位数回归类似，expectile regression 也可以用来探索自变量对因变量的影响如何随条件期望的不同水平而变化。然而，与分位数回归直接对分位数进行建模不同，expectile regression 关注的是在给定的条件下，因变量期望值的不同水平（即期望线）如何受到自变量的影响。</p><p>Expectile regression 的一个关键特点是它可以提供关于数据分布尾部特性的信息，类似于分位数回归，但通过分析条件期望的不同水平来实现。这使得expectile regression 在金融风险管理（如价值在风险（VaR）和条件尾部期望（CTE）的估计）、医学、社会科学等领域的研究中非常有用，特别是在需要评估变量影响的不对称性和尾部风险时。</p><p>在技术层面，expectile regression 通常通过求解一个优化问题来实现，该问题旨在找到一组系数，使得加权的残差平方和最小。权重由残差的符号和指定的expectile水平决定。这种方法的实现通常需要使用专门的统计软件包，如R或Python中的特定函数或库。</p></section><section powered-by="xiumi.us"><section><img data-ratio="0.5111464968152867" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/hN03ibG0t2HtDHGTBHgggicRROEkvKlfnkMDEDRtNPKYkictkuagohibUSxSve32ZJFUV52T3XMQ6hvVbFh0DVqWmA/640?wx_fmt=png" data-w="628" src="https://mmbiz.qpic.cn/mmbiz_png/hN03ibG0t2HtDHGTBHgggicRROEkvKlfnkMDEDRtNPKYkictkuagohibUSxSve32ZJFUV52T3XMQ6hvVbFh0DVqWmA/640?wx_fmt=png"></section></section><p powered-by="xiumi.us"><br></p><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><p><strong>02</strong></p></section></section></section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><p><strong>基于quantreg包行分位数回归实例：</strong></p></section></section></section></section><section powered-by="xiumi.us"><p>接下来，我们将通过一个具体的医学研究案例来深入理解分位数回归的应用。<span><strong>我们将探讨一个关于心血管健康的研究案例，特别是研究体重指数（BMI）对血压的影响。</strong></span></p><p><br></p><p><strong>研究背景 </strong></p><p>高血压是心血管疾病的重要风险因素，而BMI作为衡量体重健康的一个重要指标，其与血压之间的关系受到广泛关注。然而，这种关系可能不是线性的，也可能因人群的不同分布而有所不同。标准的最小二乘回归模型可能无法充分捕捉到BMI在不同血压水平上的影响。 </p><p><br></p><p><strong>研究目的</strong></p><p>本研究旨在应用分位数回归模型来分析BMI对不同血压分位数的影响，从而提供更全面的视角来理解BMI如何影响血压水平，特别是在血压的高值和低值分布区间。 </p><p><br></p><p><strong>数据收集</strong></p><p>假设我们收集了一项涵盖年龄、性别、BMI、收缩压和舒张压等信息的大型人群健康数据库。数据集包括1000名成年人的数据。</p></section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><p><strong><span>01</span></strong></p></section></section><section><section powered-by="xiumi.us"><section><svg viewbox="0 0 1 1"></svg></section></section><section powered-by="xiumi.us"><section><p><strong>步骤1: 准备示例数据集</strong></p></section></section><section powered-by="xiumi.us"><section><svg viewbox="0 0 1 1"></svg></section></section></section></section><section powered-by="xiumi.us"><p>首先，我们将创建一个包含1000个观测值的示例数据集。每个观测值代表一个记录。</p><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="r"><code><span><span># install.packages("quantreg")</span></span></code><code><span>library(quantreg)</span></code><code><span><br></span></code><code><span><span># 设置随机种子以保证结果的可重现性</span></span></code><code><span>set.seed(<span>123</span>)</span></code><code><span><br></span></code><code><span><span># 生成模拟数据</span></span></code><code><span>n &lt;- 1000  <span># 样本大小</span></span></code><code><span>age &lt;- rnorm(n, <span>50</span>, <span>12</span>)  <span># 年龄分布，均值为50岁，标准差为12</span></span></code><code><span>gender &lt;- sample(<span>c</span>(<span>'Male'</span>, <span>'Female'</span>), n, replace = <span>TRUE</span>)  <span># 性别</span></span></code><code><span>bmi &lt;- rnorm(n, <span>25</span>, <span>4</span>)  <span># BMI分布，均值为25，标准差为4</span></span></code><code><span>sbp &lt;- 120 + <span>0.25</span> * bmi + rnorm(n, <span>0</span>, <span>10</span>)  <span># 收缩压，基于BMI和随机波动</span></span></code><code><span>dbp &lt;- 80 + <span>0.15</span> * bmi + rnorm(n, <span>0</span>, <span>8</span>)  <span># 舒张压，基于BMI和随机波动</span></span></code><code><span><br></span></code><code><span><span># 创建数据框</span></span></code><code><span>data &lt;- data.frame(Age = age, Gender = gender, BMI = bmi, SBP = sbp, DBP = dbp)</span></code><code><span><br></span></code><code><span><span># 查看数据结构</span></span></code><code><span>str(data)</span></code></pre></section></section><section powered-by="xiumi.us"><section><img data-ratio="0.3202614379084967" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/hN03ibG0t2HtDHGTBHgggicRROEkvKlfnk6Ia0yjnX6BA8fuBPXYibqAStMGHzC6jgdpgDyx64hSlBkeQqiaQWbnrg/640?wx_fmt=png" data-w="612" src="https://mmbiz.qpic.cn/mmbiz_png/hN03ibG0t2HtDHGTBHgggicRROEkvKlfnk6Ia0yjnX6BA8fuBPXYibqAStMGHzC6jgdpgDyx64hSlBkeQqiaQWbnrg/640?wx_fmt=png"></section></section><p powered-by="xiumi.us"><br></p><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><p><strong><span>02</span></strong></p></section></section><section><section powered-by="xiumi.us"><section><svg viewbox="0 0 1 1"></svg></section></section><section powered-by="xiumi.us"><section><p><strong>步骤2: 构建分位数回归模型</strong></p></section></section><section powered-by="xiumi.us"><section><svg viewbox="0 0 1 1"></svg></section></section></section></section><p powered-by="xiumi.us">使用R语言的quantreg包来建立分位数回归模型，分别针对收缩压和舒张压的不同分位数（如25%、50%、75%分位数），探索BMI与这些血压分位数之间的关系。</p><section><ul><li><li><li><li><li><li><li><li></ul><pre data-lang="r"><code><span><span># 加载quantreg包并进行分位数回归分析</span></span></code><code><span><span>if</span> (!requireNamespace(<span>"quantreg"</span>, quietly = <span>TRUE</span>)) install.packages(<span>"quantreg"</span>)</span></code><code><span>library(quantreg)</span></code><code><span><br></span></code><code><span><span># 分别对收缩压进行25%，50%，75%分位数回归</span></span></code><code><span>model_25 &lt;- rq(SBP ~ BMI, data = data, tau = <span>0.25</span>)</span></code><code><span>model_50 &lt;- rq(SBP ~ BMI, data = data, tau = <span>0.50</span>)</span></code><code><span>model_75 &lt;- rq(SBP ~ BMI, data = data, tau = <span>0.75</span>)</span></code></pre></section><section powered-by="xiumi.us"><section><img data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/hN03ibG0t2HtDHGTBHgggicRROEkvKlfnkksSj6EmEevHWvam3fcHZPw3kfiaQuXnRo50oQlWbE7b47L0kCA7FSVw/640?wx_fmt=png" data-ratio="0.3539967373572594" data-w="613" src="https://mmbiz.qpic.cn/mmbiz_png/hN03ibG0t2HtDHGTBHgggicRROEkvKlfnkksSj6EmEevHWvam3fcHZPw3kfiaQuXnRo50oQlWbE7b47L0kCA7FSVw/640?wx_fmt=png"></section></section><section powered-by="xiumi.us"><p><strong>解读：</strong>model_25的输出表示了<span><strong>对于收缩压的25%分位数（即较低的收缩压水平），BMI（体重指数）与收缩压之间的关系。</strong></span></p><ul><li><p><strong>(Intercept) 113.251846：</strong>这是截距项，表示当BMI为0时，收缩压的预测值为113.25。当然，在实际情况中，BMI不可能为0，这个值更多地提供了模型的基准水平。</p></li><li><p><strong>BMI 0.264279：</strong>这是BMI的系数，表示BMI每增加一个单位，收缩压的25%分位数预期增加约0.264单位。<strong>换句话说，对于处在较低收缩压水平的人群，他们的收缩压随BMI的增加而轻微上升。</strong></p></li><li><p><strong>Degrees of freedom: 1000 total; 998 residual：</strong>这表示数据中有1000个观察值，模型拟合后剩余998个自由度。自由度的计算基于观察值的总数减去模型参数的数量（包括截距和BMI系数）。</p></li></ul><p>这个分析结果表明，<span><strong>对于处于较低血压水平的个体，BMI对收缩压有轻微的正向影响。这意味着体重指数较高的个体在低血压分位数上可能会经历轻微的血压增加，但这种影响相对较小。这种关系的强度和方向可能会随着血压分位数的变化而变化，因此对于中位数（50%）和较高分位数（75%）的分析可能会揭示不同的BMI影响模式。</strong></span></p><p><br></p><p><strong>研究结果</strong></p><ul><li><p><strong>发现：</strong>结果可能显示BMI对收缩压的影响在不同的血压分位数上有所不同。例如，对于较低分位数（25%），BMI的影响较小；而在中位数（50%）和较高分位数（75%）上，BMI对血压的影响显著增加。</p></li><li><p><strong>解释：</strong>这表明在正常血压和高血压人群中，BMI的增加对血压的影响更为显著，特别是对于那些已经面临高血压风险的人群。 </p></li></ul><p><strong>结论和意义 </strong></p><p>本研究通过分位数回归分析，揭示了BMI对不同血压水平影响的差异性，为针对性的高血压预防和管理提供了依据。与传统的平均效应分析相比，分位数回归提供了更为细致和全面的视角，有助于更好地理解和解释BMI与血压之间的复杂关系。</p></section><p powered-by="xiumi.us"><br></p><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><p><strong><span>03</span></strong></p></section></section><section><section powered-by="xiumi.us"><section><svg viewbox="0 0 1 1"></svg></section></section><section powered-by="xiumi.us"><section><p><strong>步骤3: 可视化分位数回归模型</strong></p></section></section><section powered-by="xiumi.us"><section><svg viewbox="0 0 1 1"></svg></section></section></section></section><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="r"><code><span>library(ggplot2)</span></code><code><span>library(ggthemes)</span></code><code><span><span># 分位数线性拟合</span></span></code><code><span>p2 &lt;- ggplot(data, aes(x = BMI, y = SBP)) +</span></code><code><span>  geom_point(alpha = <span>0.5</span>) + <span># 添加数据点</span></span></code><code><span>  geom_smooth(method = <span>"rq"</span>, formula = y ~ x, method.args = <span>list</span>(tau = <span>0.25</span>), colour = <span>"red"</span>, se = <span>FALSE</span>) + <span># 添加25%分位数回归线，修正参数传递</span></span></code><code><span>  geom_smooth(method = <span>"rq"</span>, formula = y ~ x, method.args = <span>list</span>(tau = <span>0.50</span>), colour = <span>"green"</span>, se = <span>FALSE</span>) + <span># 添加50%分位数回归线，修正参数传递</span></span></code><code><span>  geom_smooth(method = <span>"rq"</span>, formula = y ~ x, method.args = <span>list</span>(tau = <span>0.75</span>), colour = <span>"blue"</span>, se = <span>FALSE</span>) + <span># 添加75%分位数回归线，修正参数传递</span></span></code><code><span>  labs(title = <span>"BMI对收缩压的分位数回归分析"</span>,</span></code><code><span>       x = <span>"BMI"</span>,</span></code><code><span>       y = <span>"收缩压(SBP)"</span>) +</span></code><code><span>  theme_few() + </span></code><code><span>  theme(plot.title = element_text(hjust = <span>0.5</span>, size = <span>16</span>), </span></code><code><span>        plot.caption = element_text(size = <span>12</span>), </span></code><code><span>        axis.text = element_text(size = <span>12</span>), </span></code><code><span>        axis.title = element_text(size = <span>15</span>))</span></code><code><span><span># 显示图形</span></span></code><code><span>print(p2)</span></code></pre></section><section powered-by="xiumi.us"><section><img data-ratio="0.8938144329896908" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/hN03ibG0t2HtDHGTBHgggicRROEkvKlfnkvW0OwG2icGv6CGlJ871r78Ql6ialpgWzuOlpw9aqfoqFjWNodib7k4uGA/640?wx_fmt=png" data-w="970" src="https://mmbiz.qpic.cn/mmbiz_png/hN03ibG0t2HtDHGTBHgggicRROEkvKlfnkvW0OwG2icGv6CGlJ871r78Ql6ialpgWzuOlpw9aqfoqFjWNodib7k4uGA/640?wx_fmt=png"></section></section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><p><strong><span>04</span></strong></p></section></section><section><section powered-by="xiumi.us"><section><svg viewbox="0 0 1 1"></svg></section></section><section powered-by="xiumi.us"><section><p><strong>步骤4: 查看传统模型拟合可视化</strong></p></section></section><section powered-by="xiumi.us"><section><svg viewbox="0 0 1 1"></svg></section></section></section></section><p powered-by="xiumi.us"><strong>① 简单线性模型：</strong></p><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="r"><code><span><span># 简单线性拟合</span></span></code><code><span>p1 &lt;- ggplot(data, aes(x = BMI, y = SBP)) +</span></code><code><span>  geom_point(alpha = <span>0.5</span>) + <span># 添加数据点</span></span></code><code><span>  geom_smooth(method = <span>"lm"</span>, formula = y ~ x, colour = <span>"red"</span>, se = <span>TRUE</span>) +</span></code><code><span>  labs(title = <span>"BMI对收缩压的线性回归分析"</span>,</span></code><code><span>       x = <span>"BMI"</span>,</span></code><code><span>       y = <span>"收缩压(SBP)"</span>) +</span></code><code><span>  theme_few() + </span></code><code><span>  theme(plot.title = element_text(hjust = <span>0.5</span>, size = <span>16</span>), </span></code><code><span>        plot.caption = element_text(size = <span>12</span>), </span></code><code><span>        axis.text = element_text(size = <span>12</span>), </span></code><code><span>        axis.title = element_text(size = <span>15</span>))</span></code><code><span><br></span></code><code><span><span># 显示图形</span></span></code><code><span>print(p1)</span></code></pre></section><section powered-by="xiumi.us"><section><img data-ratio="0.8855670103092783" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/hN03ibG0t2HtDHGTBHgggicRROEkvKlfnkREH8xTu53zVwa3eQZrkE8bU3iaLH3apakRxlzQEVIW1bs5GEA4kprug/640?wx_fmt=png" data-w="970" src="https://mmbiz.qpic.cn/mmbiz_png/hN03ibG0t2HtDHGTBHgggicRROEkvKlfnkREH8xTu53zVwa3eQZrkE8bU3iaLH3apakRxlzQEVIW1bs5GEA4kprug/640?wx_fmt=png"></section></section><p powered-by="xiumi.us"><strong>② LOESS曲线拟合模型：</strong></p><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="r"><code><span><span># 使用LOESS方法进行曲线拟合</span></span></code><code><span>p_loess &lt;- ggplot(data, aes(x = BMI, y = SBP)) +</span></code><code><span>  geom_point(alpha = <span>0.5</span>) + <span># 添加数据点</span></span></code><code><span>  geom_smooth(method = <span>"loess"</span>, formula = y ~ x, span = <span>0.5</span>, se = <span>TRUE</span>, colour = <span>"darkorange"</span>) + <span># 使用LOESS拟合曲线</span></span></code><code><span>  labs(title = <span>"BMI对收缩压的LOESS曲线拟合"</span>,</span></code><code><span>       x = <span>"BMI"</span>,</span></code><code><span>       y = <span>"收缩压(SBP)"</span>) +</span></code><code><span>  theme_few() + </span></code><code><span>  theme(plot.title = element_text(hjust = <span>0.5</span>, size = <span>16</span>), </span></code><code><span>        plot.caption = element_text(size = <span>12</span>), </span></code><code><span>        axis.text = element_text(size = <span>12</span>), </span></code><code><span>        axis.title = element_text(size = <span>15</span>))</span></code><code><span><br></span></code><code><span><span># 显示图形</span></span></code><code><span>print(p_loess)</span></code></pre></section><section powered-by="xiumi.us"><section><img data-ratio="0.8824742268041237" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/hN03ibG0t2HtDHGTBHgggicRROEkvKlfnkqPrw6W8iazxShrgZcTvibJ3XErrx919OIHsiaoiaEDJ3uRuk1UlsXal5ZQ/640?wx_fmt=png" data-w="970" src="https://mmbiz.qpic.cn/mmbiz_png/hN03ibG0t2HtDHGTBHgggicRROEkvKlfnkqPrw6W8iazxShrgZcTvibJ3XErrx919OIHsiaoiaEDJ3uRuk1UlsXal5ZQ/640?wx_fmt=png"></section></section><p powered-by="xiumi.us"><strong>③ 基于nlm的非线性拟合模型：</strong></p><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="r"><code><span><span># 非线性模型拟合</span></span></code><code><span>nls_model &lt;- nls(SBP ~ a * BMI^b, data = data, start = <span>list</span>(a = <span>1</span>, b = <span>0.5</span>))</span></code><code><span><br></span></code><code><span><span># 提取拟合结果并进行预测</span></span></code><code><span>new_data &lt;- data.frame(BMI = seq(<span>min</span>(data$BMI), <span>max</span>(data$BMI), length.out = <span>100</span>))</span></code><code><span>new_data$SBP_pred &lt;- predict(nls_model, newdata = new_data)</span></code><code><span><br></span></code><code><span><span># 绘制原始数据点和拟合曲线</span></span></code><code><span>p_nls &lt;- ggplot(data, aes(x = BMI, y = SBP)) +</span></code><code><span>  geom_point(alpha = <span>0.5</span>) +</span></code><code><span>  geom_line(data = new_data, aes(x = BMI, y = SBP_pred), colour = <span>"blue"</span>) +</span></code><code><span>  labs(title = <span>"BMI对收缩压的非线性拟合"</span>,</span></code><code><span>       x = <span>"BMI"</span>,</span></code><code><span>       y = <span>"收缩压(SBP)"</span>) +</span></code><code><span>  theme_few() + </span></code><code><span>  theme(plot.title = element_text(hjust = <span>0.5</span>, size = <span>16</span>), </span></code><code><span>        plot.caption = element_text(size = <span>12</span>), </span></code><code><span>        axis.text = element_text(size = <span>12</span>), </span></code><code><span>        axis.title = element_text(size = <span>15</span>))</span></code><code><span><br></span></code><code><span><span># 显示图形</span></span></code><code><span>print(p_nls)</span></code></pre></section><section powered-by="xiumi.us"><section><img data-ratio="0.8886597938144329" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/hN03ibG0t2HtDHGTBHgggicRROEkvKlfnko6X0sWlo7DLe0njPK0o8p3Yr4PgYwb0KszwvoDaPPichbzl9PoDzXhg/640?wx_fmt=png" data-w="970" src="https://mmbiz.qpic.cn/mmbiz_png/hN03ibG0t2HtDHGTBHgggicRROEkvKlfnko6X0sWlo7DLe0njPK0o8p3Yr4PgYwb0KszwvoDaPPichbzl9PoDzXhg/640?wx_fmt=png"></section></section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><p><strong><span>05</span></strong></p></section></section><section><section powered-by="xiumi.us"><section><svg viewbox="0 0 1 1"></svg></section></section><section powered-by="xiumi.us"><section><p><strong>步骤5: 构建分位数曲线拟合模型</strong></p></section></section><section powered-by="xiumi.us"><section><svg viewbox="0 0 1 1"></svg></section></section></section></section><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="r"><code><span><span># 分位数曲线拟合</span></span></code><code><span>p3 &lt;- ggplot(data, aes(x = BMI, y = SBP)) +</span></code><code><span>  geom_point(alpha = <span>0.5</span>) + <span># 添加数据点</span></span></code><code><span>  geom_smooth(method = <span>"rq"</span>, formula = y ~ <span>log</span>(x), method.args = <span>list</span>(tau = <span>0.25</span>), colour = <span>"red"</span>, se = <span>FALSE</span>) + <span># 添加25%分位数回归线，修正参数传递</span></span></code><code><span>  geom_smooth(method = <span>"rq"</span>, formula = y ~ <span>log</span>(x), method.args = <span>list</span>(tau = <span>0.50</span>), colour = <span>"green"</span>, se = <span>FALSE</span>) + <span># 添加50%分位数回归线，修正参数传递</span></span></code><code><span>  geom_smooth(method = <span>"rq"</span>, formula = y ~ <span>log</span>(x), method.args = <span>list</span>(tau = <span>0.75</span>), colour = <span>"blue"</span>, se = <span>FALSE</span>) + <span># 添加75%分位数回归线，修正参数传递</span></span></code><code><span>  labs(title = <span>"BMI对收缩压的分位数回归分析"</span>,</span></code><code><span>       x = <span>"BMI"</span>,</span></code><code><span>       y = <span>"收缩压(SBP)"</span>) +</span></code><code><span>  theme_few() + </span></code><code><span>  theme(plot.title = element_text(hjust = <span>0.5</span>, size = <span>16</span>), </span></code><code><span>        plot.caption = element_text(size = <span>12</span>), </span></code><code><span>        axis.text = element_text(size = <span>12</span>), </span></code><code><span>        axis.title = element_text(size = <span>15</span>))</span></code><code><span><span># 显示图形</span></span></code><code><span>print(p3)</span></code></pre></section><section powered-by="xiumi.us"><section><img data-ratio="0.8810256410256411" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/hN03ibG0t2HtDHGTBHgggicRROEkvKlfnkaH6rMZ3JBRdicOEyanSibDsopCtzx2PntFEpbVJ9qHPndJlFfkMrDVFg/640?wx_fmt=png" data-w="975" src="https://mmbiz.qpic.cn/mmbiz_png/hN03ibG0t2HtDHGTBHgggicRROEkvKlfnkaH6rMZ3JBRdicOEyanSibDsopCtzx2PntFEpbVJ9qHPndJlFfkMrDVFg/640?wx_fmt=png"></section></section><p powered-by="xiumi.us"><br></p><p powered-by="xiumi.us"><strong>现在：</strong></p><section powered-by="xiumi.us"><p><br></p><p>长按扫码关注：<strong>科研生信充电宝</strong></p></section><section powered-by="xiumi.us"><section><img data-ratio="1" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/hN03ibG0t2Hv4lr5d37oLxqic5UEjibU1EccBnMkS34CdBiaYbWFKrlmyPwlu7YH3XITUh6y7UBjoDXz0RZbjp9fHQ/640?wx_fmt=jpeg" data-w="258" src="https://mmbiz.qpic.cn/mmbiz_jpg/hN03ibG0t2Hv4lr5d37oLxqic5UEjibU1EccBnMkS34CdBiaYbWFKrlmyPwlu7YH3XITUh6y7UBjoDXz0RZbjp9fHQ/640?wx_fmt=jpeg"></section></section><section powered-by="xiumi.us"><p><strong><span>10元赞赏本文，即喜欢作者~</span></strong></p><p><strong><span><br></span></strong></p><p><strong><span>即可直接解锁：</span></strong></p><p><br></p><p><strong><span>《初探分位数回归及其R实现</span></strong><strong><span>》源文件</span></strong></p><p><br></p><p><span>看到这里你还不心动吗？</span><br></p><p><span><br></span></p><p><span>赶紧关注、转发、点赞、分享，领取你的专属福利吧~</span></p></section><section powered-by="xiumi.us"><p><br></p><p><br></p><p>好啦，以上就是今天推文的全部内容啦！<br></p><p><br></p><p><br></p></section><section powered-by="xiumi.us"><p>今天的分享就到这里啦~<br></p><p><br></p><p><span><strong>另外，本公众号建立了R语言和Python学习分享群，联系后台，拉您入群。</strong></span></p><p><span><strong><br></strong></span></p></section><p powered-by="xiumi.us">或直接添加小编，拉您入群：</p><section powered-by="xiumi.us"><section><img data-ratio="1.3642105263157895" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/hN03ibG0t2Hs6qwZupib0xjB5s9pVDhxvNVdpicm3ibDULLNr7HHCvruA12ovAaCibwqJr4X7tGpsMJ92E8NFwIdu8g/640?wx_fmt=jpeg" data-w="950" src="https://mmbiz.qpic.cn/mmbiz_jpg/hN03ibG0t2Hs6qwZupib0xjB5s9pVDhxvNVdpicm3ibDULLNr7HHCvruA12ovAaCibwqJr4X7tGpsMJ92E8NFwIdu8g/640?wx_fmt=jpeg"></section></section><p powered-by="xiumi.us"><br></p><section powered-by="xiumi.us"><p><br></p><p><br></p><p>版权声明：本文内容由互联网用户自发贡献，版权归作者所有，本公众号不拥有所有权，也不承担相关法律责任。</p><p>如果您发现本公众号中有涉嫌抄袭的内容，欢迎发送邮件至：kysxcdb@163.com 进行举报，一经查实，本公众号将立刻删除涉嫌侵权内容。</p></section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><p><strong>BIOINFOR</strong></p></section></section></section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><img data-ratio="1" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/hN03ibG0t2Hv4lr5d37oLxqic5UEjibU1EccBnMkS34CdBiaYbWFKrlmyPwlu7YH3XITUh6y7UBjoDXz0RZbjp9fHQ/640?wx_fmt=jpeg" data-w="258" src="https://mmbiz.qpic.cn/mmbiz_jpg/hN03ibG0t2Hv4lr5d37oLxqic5UEjibU1EccBnMkS34CdBiaYbWFKrlmyPwlu7YH3XITUh6y7UBjoDXz0RZbjp9fHQ/640?wx_fmt=jpeg"></section></section><section powered-by="xiumi.us"><section><p>微信号｜科研生信充电宝</p></section></section><section powered-by="xiumi.us"><section><p><span><strong> · BIOINFOR · </strong></span></p></section></section><p powered-by="xiumi.us"><br></p></section></section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><svg viewbox="0 0 1 1"></svg></section></section></section><section><section powered-by="xiumi.us"><section><p><strong>永远相信美好的事情</strong></p></section></section></section><section><section powered-by="xiumi.us"><section><svg viewbox="0 0 1 1"></svg></section></section></section><section><section powered-by="xiumi.us"><section><p><strong>即将发生</strong></p></section></section></section><section><section powered-by="xiumi.us"><section><svg viewbox="0 0 1 1"></svg></section></section></section></section></section><p><mp-style-type data-value="10000"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/y-vKvv0xMlJXJ-4FKhHbqg",target="_blank" rel="noopener noreferrer">原文链接</a>
