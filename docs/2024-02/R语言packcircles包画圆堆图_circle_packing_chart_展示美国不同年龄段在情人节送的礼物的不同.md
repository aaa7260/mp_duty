---
title: "R语言packcircles包画圆堆图（circle packing chart）展示美国不同年龄段在情人节送的礼物的不同"
date: 2024-02-15T01:27:59Z
draft: ["false"]
tags: [
  "fetched",
  "小明的数据分析笔记本"
]
categories: ["Acdemic"]
---
R语言packcircles包画圆堆图（circle packing chart）展示美国不同年龄段在情人节送的礼物的不同 by 小明的数据分析笔记本
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-mpa-powered-by="yiban.io"><p data-tool="mdnice编辑器">这个圆堆图（circle packing chart）之前有人问过，但是当时也不知道是如何实现的。今天看到一个很有意思的数据可视化案例：画圆堆图展示美国不同年龄段在情人节送的礼物的不同</p><figure data-tool="mdnice编辑器"><img data-imgfileid="100013068" data-ratio="0.3745072273324573" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/t1wZDoUyFk6b3S9CfQvM0d66S7N4R5lsibia6zkfsV123b5BsEhN6UCaYaWks4xmjtQzfM4BfdgOI54mzNrH8oVw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1522" src="https://mmbiz.qpic.cn/sz_mmbiz_png/t1wZDoUyFk6b3S9CfQvM0d66S7N4R5lsibia6zkfsV123b5BsEhN6UCaYaWks4xmjtQzfM4BfdgOI54mzNrH8oVw/640?wx_fmt=png&amp;from=appmsg"><figcaption>image.png</figcaption></figure><p data-tool="mdnice编辑器">数据和代码链接 https://github.com/BjnNowak/TidyTuesday/blob/main/valentine_day.R</p><p data-tool="mdnice编辑器">这部分代码看的还不是很明白，这里画这个图是用 packcircles + ggplot2来做的，查了一下这个R包的基础用法，链接  https://r-graph-gallery.com/305-basic-circle-packing-with-one-level.html</p><p data-tool="mdnice编辑器">先来画一个最基本的</p><p data-tool="mdnice编辑器">这里我们只画18-24年龄段的这个图</p><h2 data-tool="mdnice编辑器"><span></span><span>读取数据</span><span></span><span> </span></h2><pre data-tool="mdnice编辑器"><span></span><code>library(tidyverse)<br><br>read_csv(<span>"gifts_age.csv"</span>) %&gt;% <br>  filter(Age==<span>"18-24"</span>) %&gt;% <br>  pivot_longer(!Age) -&gt; dat<br></code></pre><h2 data-tool="mdnice编辑器"><span></span><span>生成所有圆的圆心和半径的数据</span><span></span><span> </span></h2><pre data-tool="mdnice编辑器"><span></span><code>library(packcircles)<br>packing &lt;- circleProgressiveLayout(dat<span>$value</span>, sizetype=<span>'area'</span>)<br>packing<br><br>dat &lt;- cbind(dat, packing)<br><br>dat<br></code></pre><h2 data-tool="mdnice编辑器"><span></span><span>作图代码</span><span></span><span> </span></h2><pre data-tool="mdnice编辑器"><span></span><code>tst &lt;- MoMAColors::moma.colors(<span>"Klein"</span>, n=10, <span>type</span>=<span>"discrete"</span>)<br>tst<br><br>library(ggforce)<br>dat<br>ggplot()+<br>  geom_circle(data = dat, aes(x0=x, y0=y,r=radius, fill = name))+<br>  geom_text(data = dat, aes(x, y, label = name),size=5)+<br>  theme_void() + <br>  theme(legend.position=<span>"none"</span>) +<br>  coord_equal() -&gt; p1<br><br>ggplot()+<br>  geom_circle(data = dat, aes(x0=x, y0=y,r=radius, fill = name))+<br>  geom_text(data = dat, aes(x, y, label = name),size=5)+<br>  theme_void() + <br>  theme(legend.position=<span>"none"</span>) +<br>  coord_equal()+<br>  scale_fill_manual(values = tst) -&gt; p2<br><br>library(patchwork)<br><br>p1+p2<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100013067" data-ratio="0.42612064194798005" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/t1wZDoUyFk6b3S9CfQvM0d66S7N4R5lszQkRR7yZzjZylOWeZRPOPNrEdl6LtCjia4yPeajI8ryYQibsbl1r3IPw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1807" src="https://mmbiz.qpic.cn/sz_mmbiz_png/t1wZDoUyFk6b3S9CfQvM0d66S7N4R5lszQkRR7yZzjZylOWeZRPOPNrEdl6LtCjia4yPeajI8ryYQibsbl1r3IPw/640?wx_fmt=png&amp;from=appmsg"><figcaption>image.png</figcaption></figure><p data-tool="mdnice编辑器">这个应该如何调整布局暂时还没有想明白，比如能不能把最大的圆放到中间的位置</p><p data-tool="mdnice编辑器">这个形式在科研作图中应该可以用来替换柱形图</p><blockquote data-tool="mdnice编辑器"><span></span><p>示例数据和代码可以给推文打赏一元获取</p></blockquote><p data-tool="mdnice编辑器"><strong>欢迎大家关注我的公众号</strong></p><p data-tool="mdnice编辑器"><strong>小明的数据分析笔记本</strong></p><section><mp-common-profile data-pluginname="mpprofile" data-id="MzI3NzQ3MTcxMg==" data-headimg="http://mmbiz.qpic.cn/mmbiz_png/t1wZDoUyFk5t1sOnM0iabvBhnfIj5YpyqrMib0E1MGCd9ibcYxaOPZd0GWhQBDvK2BPEwsicQxd6y5MHLfphnwHnow/0?wx_fmt=png" data-nickname="小明的数据分析笔记本" data-alias="" data-signature="分享R语言和python在生物信息领域做数据分析和数据可视化的简单小例子；偶尔会分享一些组学数据处理相关的内容" data-from="0" data-is_biz_ban="0"></mp-common-profile></section><p data-tool="mdnice编辑器"><strong></strong></p><blockquote data-tool="mdnice编辑器"><span></span><p>小明的数据分析笔记本 公众号 主要分享：1、R语言和python做数据分析和数据可视化的简单小例子；2、园艺植物相关转录组学、基因组学、群体遗传学文献阅读笔记；3、生物信息学入门学习资料及自己的学习笔记！</p></blockquote></section><p><br></p><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/3vc7EwUTRbr6oDNyL2ruuA",target="_blank" rel="noopener noreferrer">原文链接</a>
