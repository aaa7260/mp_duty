---
title: "获取和一组GO条目相关的基因-区间关联"
date: 2024-02-05T10:51:13Z
draft: ["false"]
tags: [
  "fetched",
  "方圆之处"
]
categories: ["Acdemic"]
---
获取和一组GO条目相关的基因-区间关联 by 方圆之处
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><p data-tool="mdnice编辑器">我们首先进行一个<strong>rGREAT</strong>和<strong>simplifyEnrichment</strong>的联合分析。我们首先有一组感兴趣的基因组区间（在下面的例子中是一组TFBS）。我们用<strong>rGREAT</strong>包进行GO富集分析，然后用<strong>simplifyEnrichment</strong>包进行可视化。</p><pre data-tool="mdnice编辑器"><code><span>library</span>(rGREAT)<br>df = read.table(url(<span>"https://raw.githubusercontent.com/jokergoo/rGREAT_suppl/master/data/tb_encTfChipPkENCFF708LCH_A549_JUN_hg19.bed"</span>))<br><span># 转换成GRanges对象</span><br>gr = GRanges(seqnames = df[, <span>1</span>], ranges = IRanges(df[, <span>2</span>], df[, <span>3</span>]))<br>res = great(gr, <span>"BP"</span>, <span>"hg19"</span>)<br>tb = getEnrichmentTable(res)<br>head(tb)<br><span>##           id                         description genome_fraction observed_region_hits</span><br><span>## 1 GO:0097190         apoptotic signaling pathway      0.05142843                  175</span><br><span>## 2 GO:0042981     regulation of apoptotic process      0.13625922                  382</span><br><span>## 3 GO:0043067 regulation of programmed cell death      0.13923473                  385</span><br><span>## 4 GO:0010941            regulation of cell death      0.15491807                  413</span><br><span>## 5 GO:0006915                   apoptotic process      0.17416621                  458</span><br><span>## 6 GO:0033554         cellular response to stress      0.16660653                  438</span><br><span>##   fold_enrichment p_value p_adjust mean_tss_dist observed_gene_hits gene_set_size</span><br><span>## 1        1.971487       0        0        109284                109           585</span><br><span>## 2        1.624264       0        0        124438                270          1394</span><br><span>## 3        1.602036       0        0        125615                273          1426</span><br><span>## 4        1.544569       0        0        122812                295          1577</span><br><span>## 5        1.523564       0        0        122719                331          1833</span><br><span>## 6        1.523145       0        0        132952                307          1883</span><br><span>##   fold_enrichment_hyper p_value_hyper p_adjust_hyper</span><br><span>## 1              1.525021  3.675911e-06   7.282157e-05</span><br><span>## 2              1.585280  1.110223e-15   3.409079e-13</span><br><span>## 3              1.566925  3.552714e-15   8.311658e-13</span><br><span>## 4              1.531071  5.218048e-15   9.860104e-13</span><br><span>## 5              1.477987  1.387779e-14   2.351089e-12</span><br><span>## 6              1.334422  2.225650e-08   8.347036e-07</span><br><br><span>library</span>(simplifyEnrichment)<br>sig_go_ids = tb$id[tb$p_adjust &lt; <span>0.001</span>]<br>cl = simplifyGO(sig_go_ids)<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100000834" data-ratio="0.6666666666666666" data-src="https://mmbiz.qpic.cn/mmbiz_png/8yoFdJolUibeJyLwQ661DFaGccUD5M873iaMbicPt2JxYGeGwVlYrib4ohnzI5PNnFl5Nz9AxWtAoer9hIt66xiaP0A/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1728" src="https://mmbiz.qpic.cn/mmbiz_png/8yoFdJolUibeJyLwQ661DFaGccUD5M873iaMbicPt2JxYGeGwVlYrib4ohnzI5PNnFl5Nz9AxWtAoer9hIt66xiaP0A/640?wx_fmt=png&amp;from=appmsg"></figure><pre data-tool="mdnice编辑器"><code>head(cl)<br><span>##           id cluster</span><br><span>## 1 GO:0097190       1</span><br><span>## 2 GO:0042981       2</span><br><span>## 3 GO:0043067       2</span><br><span>## 4 GO:0010941       2</span><br><span>## 5 GO:0006915       2</span><br><span>## 6 GO:0033554       1</span><br><br><br>table(cl$cluster)<br><span>## </span><br><span>##   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17  18  19  20  21  22  23  24  25 </span><br><span>## 136  12 194   1   1  30  88  39  11  18   5  11   5  11   1   1   1  16   9   1   4   3   5   2   1 </span><br><span>##  26  27  28  29  30 </span><br><span>##   1   3   1   2   1</span><br></code></pre><p data-tool="mdnice编辑器">图看起来不错。下面你可能想要获取和某一个显著的GO条目相关的基因-区间关联。例如我们可以通过下面的代码获取<code>cl</code>变量中第一个GO条目相关的基因-区间关联：</p><pre data-tool="mdnice编辑器"><code>getRegionGeneAssociations(res, cl$id[<span>1</span>])<br><span>## GRanges object with 175 ranges and 2 metadata columns:</span><br><span>##         seqnames            ranges strand | annotated_genes    dist_to_TSS</span><br><span>##            &lt;Rle&gt;         &lt;IRanges&gt;  &lt;Rle&gt; | &lt;CharacterList&gt;  &lt;IntegerList&gt;</span><br><span>##     [1]     chr1 16472855-16473095      * |           EPHA2           9487</span><br><span>##     [2]     chr1 16490874-16491114      * |           EPHA2          -8292</span><br><span>##     [3]     chr1 23073949-23074189      * |           KDM1A        -271752</span><br><span>##     [4]     chr1 23912118-23912358      * |           RPL11        -105911</span><br><span>##     [5]     chr1 28479716-28479956      * |            EYA3         -64568</span><br><span>##     ...      ...               ...    ... .             ...            ...</span><br><span>##   [171]    chr20 48292419-48292659      * |           PTGIS        -107712</span><br><span>##   [172]    chr20 48782588-48782828      * |           CEBPB         -24292</span><br><span>##   [173]    chr20 48802827-48803067      * |           CEBPB          -4053</span><br><span>##   [174]    chr20 48989426-48989666      * |     CEBPB,PTPN1 182306,-137225</span><br><span>##   [175]    chr20 49039803-49040043      * |     CEBPB,PTPN1  232683,-86848</span><br><span>##   -------</span><br><span>##   seqinfo: 23 sequences from an unspecified genome; no seqlengths</span><br></code></pre><p data-tool="mdnice编辑器"><code>cl</code>中有超过600个显著的GO条目，你可能不会手动去提取每一个。</p><p data-tool="mdnice编辑器"><strong>simplifyEnrichment</strong>已经将这600多个GO条目划分到大约10个左右的组中。那么我们其实可以去寻找和一个<strong>GO条目组</strong>相关的基因-区间关联，而不是每一个单独的GO条目。在最新版的<strong>rGREAT</strong>包中，<code>getRegionGeneAssociations()</code>函数中第二个参数可以设置为一个GO ID的向量。例如我们可以提取<code>cl</code>中和第一个GO聚类相关的基因-区间关联：</p><pre data-tool="mdnice编辑器"><code>getRegionGeneAssociations(res, cl$id[cl$cluster == <span>1</span>])<br><span>## GRanges object with 1245 ranges and 2 metadata columns:</span><br><span>##          seqnames            ranges strand | annotated_genes    dist_to_TSS</span><br><span>##             &lt;Rle&gt;         &lt;IRanges&gt;  &lt;Rle&gt; | &lt;CharacterList&gt;  &lt;IntegerList&gt;</span><br><span>##      [1]     chr1   1280252-1280492      * |     TAS1R3,DVL1     13526,4000</span><br><span>##      [2]     chr1   2143913-2144153      * |          FAAP20          -4741</span><br><span>##      [3]     chr1   4052186-4052426      * |           AJAP1        -662679</span><br><span>##      [4]     chr1   4440698-4440938      * |           AJAP1        -274167</span><br><span>##      [5]     chr1   7359438-7359678      * |    CAMTA1,VAMP3 514054,-471651</span><br><span>##      ...      ...               ...    ... .             ...            ...</span><br><span>##   [1241]    chr22 37921455-37921695      * |          CARD10          -6077</span><br><span>##   [1242]    chr22 39096963-39097203      * |          GTPBP1          -4604</span><br><span>##   [1243]    chr22 39704855-39705095      * |      PDGFB,RPL3   -63898,11296</span><br><span>##   [1244]    chr22 40894508-40894748      * |     SGSM3,MRTFA  127913,137942</span><br><span>##   [1245]    chr22 50364455-50364695      * |    PIM3,IL17REL    10312,86360</span><br><span>##   -------</span><br><span>##   seqinfo: 23 sequences from an unspecified genome; no seqlengths</span><br></code></pre></section><p><br></p><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/c1EFfkhHTc-cumatw-6khA",target="_blank" rel="noopener noreferrer">原文链接</a>
