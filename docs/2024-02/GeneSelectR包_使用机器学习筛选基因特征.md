---
title: "GeneSelectR包：使用机器学习筛选基因特征"
date: 2024-02-26T23:56:20Z
draft: ["false"]
tags: [
  "fetched",
  "生信碱移"
]
categories: ["Acdemic"]
---
GeneSelectR包：使用机器学习筛选基因特征 by 生信碱移
------
<div><section data-tool="markdown编辑器" data-website="https://markdown.com.cn/editor"><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><img data-ratio="1.0324675324675325" data-type="gif" data-w="154" data-imgfileid="100008423" data-src="https://mmbiz.qpic.cn/mmbiz_gif/lN9Tp5oiaqHFn9Rg6MwMU3ukMR9ROPh7bf7QWHEMwhUBUwSUKFsV8oK9noHic3jLaeJVQewHJcLq1cTXVAat35Tw/640?wx_fmt=gif&amp;wxfrom=5&amp;wx_lazy=1" src="https://mmbiz.qpic.cn/mmbiz_gif/lN9Tp5oiaqHFn9Rg6MwMU3ukMR9ROPh7bf7QWHEMwhUBUwSUKFsV8oK9noHic3jLaeJVQewHJcLq1cTXVAat35Tw/640?wx_fmt=gif&amp;wxfrom=5&amp;wx_lazy=1"></section></section></section></section></section><section><section powered-by="xiumi.us"><section><p>老铁快点击蓝字 <strong>关注俺</strong></p></section></section></section><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><img data-ratio="1.0324675324675325" data-type="gif" data-w="154" data-imgfileid="100008425" data-src="https://mmbiz.qpic.cn/mmbiz_gif/lN9Tp5oiaqHFn9Rg6MwMU3ukMR9ROPh7bf7QWHEMwhUBUwSUKFsV8oK9noHic3jLaeJVQewHJcLq1cTXVAat35Tw/640?wx_fmt=gif&amp;wxfrom=5&amp;wx_lazy=1" src="https://mmbiz.qpic.cn/mmbiz_gif/lN9Tp5oiaqHFn9Rg6MwMU3ukMR9ROPh7bf7QWHEMwhUBUwSUKFsV8oK9noHic3jLaeJVQewHJcLq1cTXVAat35Tw/640?wx_fmt=gif&amp;wxfrom=5&amp;wx_lazy=1"></section></section></section></section></section></section></section></section></section><section powered-by="xiumi.us"><section data-mpa-powered-by="yiban.io" data-darkmode-bgcolor-16095509242984="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16095509242984="rgb(255, 255, 255)" data-style='white-space: normal; max-width: 100%; letter-spacing: 0.544px; text-size-adjust: auto; background-color: rgb(255, 255, 255); font-family: "Helvetica Neue", Helvetica, "Hiragino Sans GB", "Microsoft YaHei", Arial, sans-serif; box-sizing: border-box !important; overflow-wrap: break-word !important;'><section data-darkmode-bgcolor-16095509242984="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16095509242984="rgb(255, 255, 255)"><section data-darkmode-bgcolor-16095509242984="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16095509242984="rgb(255, 255, 255)"><section data-id="85660" data-custom="rgb(117, 117, 118)" data-color="rgb(117, 117, 118)" data-darkmode-bgcolor-16095509242984="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16095509242984="rgb(255, 255, 255)"><section data-darkmode-bgcolor-16095509242984="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16095509242984="rgb(255, 255, 255)"><section data-darkmode-bgcolor-16095509242984="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16095509242984="rgb(255, 255, 255)"><section data-darkmode-bgcolor-16095509242984="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16095509242984="rgb(255, 255, 255)"><section data-darkmode-bgcolor-16095509242984="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16095509242984="rgb(255, 255, 255)"><section data-darkmode-bgcolor-16095509242984="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16095509242984="rgb(255, 255, 255)"><section data-id="85660" data-custom="rgb(117, 117, 118)" data-color="rgb(117, 117, 118)" data-darkmode-bgcolor-16095509242984="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16095509242984="rgb(255, 255, 255)"><section data-darkmode-bgcolor-16095509242984="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16095509242984="rgb(255, 255, 255)" data-style="margin-top: 2em; padding-top: 0.5em; padding-bottom: 0.5em; max-width: 100%; border-style: solid none; text-decoration: inherit; border-top-color: rgb(204, 204, 204); border-bottom-color: rgb(204, 204, 204); border-top-width: 1px; border-bottom-width: 1px; box-sizing: border-box !important; overflow-wrap: break-word !important;"><p data-darkmode-bgcolor-16095509242984="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16095509242984="rgb(255, 255, 255)"><span>生信碱移</span></p><section><strong>GeneSelectR包</strong></section></section></section></section></section></section></section></section></section></section></section></section><blockquote data-type="2" data-url="" data-author-name="" data-content-utf8-length="68" data-source-title="" data-darkmode-bgcolor-16095509242984="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16095509242984="rgb(255, 255, 255)" data-darkmode-color-16095509242984="rgba(163, 163, 163, 0.498)" data-darkmode-original-color-16095509242984="rgba(0, 0, 0, 0.498)" data-style='color: rgba(0, 0, 0, 0.498); white-space: normal; max-width: 100%; letter-spacing: 0.544px; font-family: -apple-system-font, system-ui, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif; background-color: rgb(255, 255, 255); box-sizing: border-box !important; overflow-wrap: break-word !important;'><section><span>使用机器学习快速进行基因特征筛选。</span></section></blockquote></section><p data-tool="markdown.com.cn编辑器"><strong>GeneSelectR</strong>，是一个开源的R包，它创新性地结合了机器学习（ML）和生物信息学数据挖掘方法，帮助研究者进行组学特征筛选。通过GeneSelectR，可以使用多种机器学习方法和用户定义的参数，从标准化的RNA数据集中选择特征。</p><p data-tool="markdown.com.cn编辑器"><img data-galleryid="" data-imgfileid="100008408" data-ratio="0.7518518518518519" data-s="300,640" data-type="png" data-w="1080" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/LvUIqvYKCeUWLcSwkw0jOicLtscjYib49j8KuA6hWgvbrmNOC3zUNkibEX7086jK2HSrSbBHrbL2oQFGQanTC9yEg/640?wx_fmt=png&amp;from=appmsg" src="https://mmbiz.qpic.cn/sz_mmbiz_png/LvUIqvYKCeUWLcSwkw0jOicLtscjYib49j8KuA6hWgvbrmNOC3zUNkibEX7086jK2HSrSbBHrbL2oQFGQanTC9yEg/640?wx_fmt=png&amp;from=appmsg"></p><h2 data-tool="markdown.com.cn编辑器"><span></span><span>使用介绍</span></h2><h3 data-tool="markdown.com.cn编辑器"><span></span><span>1. 环境配置</span><span></span></h3><p data-tool="markdown.com.cn编辑器"><span>GeneSelectR 包的特征选择过程是使用 Python 的 scikit-learn 库实现的。<strong>该软件包需要安装 Anaconda 才能正常工作</strong></span>：</p><pre data-tool="markdown.com.cn编辑器"><span></span><code><span># install.packages("devtools")</span><br>devtools::install_github(<span>"dzhakparov/GeneSelectR"</span>, build_vignettes = <span>FALSE</span>)<br><br><span># !首次启动时，需要为包创建conda工作环境</span><br>GeneSelectR::configure_environment() <br></code></pre><p data-tool="markdown.com.cn编辑器"><span><strong>每次分析需要通过设置正确的 conda 工作环境来重新启动 GeneSelectR 分析</strong></span>：</p><pre data-tool="markdown.com.cn编辑器"><code>GeneSelectR::set_reticulate_python()<br><span>library</span>(GeneSelectR)<br></code></pre><br data-tool="markdown.com.cn编辑器"><h3 data-tool="markdown.com.cn编辑器"><span></span><span>2. 输入数据与基础用法</span><span></span></h3><p data-tool="markdown.com.cn编辑器"><span><strong>输入的数据矩阵是一个数据框，其中样本为行，特征为列</strong>。示例数据集的<span>访问和</span>分析可以通过以下方式执行</span>：</p><pre data-tool="markdown.com.cn编辑器"><span></span><code>data(<span>"UrbanRandomSubset"</span>)<br>head(UrbanRandomSubset[,<span>1</span>:<span>10</span>])<br><br><span># treatment 列作为分类标签</span><br>X &lt;- UrbanRandomSubset %&gt;% dplyr::select(-treatment) <span># get the feature matrix</span><br>y &lt;- UrbanRandomSubset[<span>'treatment'</span>] <span># store the data point label in a separate vector</span><br>y &lt;- as.factor(y)<br><br><span># 最基础的用法模式</span><br>selection_results &lt;- GeneSelectR::GeneSelectR(X = X, <br>                                              y = y,<br>                                              njobs = -<span>1</span>   <span># 选择所有可用核心</span><br></code></pre><section><span>提示，该示例数据集是一个bulk RNAseq 数据集，取自 149 名非洲儿童的血液样本，这些儿童被分为特应性皮炎 (AD) 儿童和健康对照 (HC) 儿童。此外，整个数据集包含按儿童位置（城市和农村）划分的分层变量，此部分数据仅包含城市样本。列代表基因，样本在行中。列处理包含诊断标签</span>。</section><h4 data-tool="markdown.com.cn编辑器"><span></span><span>3. 特征选择过程的具体设定</span><span></span></h4><p data-tool="markdown.com.cn编辑器"><span><strong>执行分析前需要设置特征选择的算法默认参数值</strong>。如果未提供，则建立默认的特征选择方法和超参数网格。默认情况下，有四种方法来选择特征：<span><strong>单变量特征选择</strong></span>、<span><strong>带 L1 惩罚的逻辑回归</strong></span>、<span><strong>boruta</strong></span>和<span><strong>随机森林</strong></span>。每个默认特征选择方法组合如下</span>：</p><pre data-tool="markdown.com.cn编辑器"><span></span><code>fs_param_grids &lt;- list(<br>  <span>"Lasso"</span> = list(<br>    <span>"feature_selector__estimator__C"</span> = c(<span>0.01</span>, <span>0.1</span>, <span>1L</span>, <span>10L</span>),<br>    <span>"feature_selector__estimator__solver"</span> = c(<span>'liblinear'</span>,<span>'saga'</span>)<br>  ),<br>  <span>"Univariate"</span> = list(<br>    <span>"feature_selector__param"</span> = seq(<span>50L</span>, <span>200L</span>, by = <span>50L</span>)<br>  ),<br>  <span>"boruta"</span> = list(<br>    <span>"feature_selector__perc"</span> = seq(<span>80L</span>, <span>100L</span>, by = <span>10L</span>),<br>    <span>'feature_selector__n_estimators'</span> = c(<span>50L</span>, <span>100L</span>, <span>250L</span>, <span>500L</span>)<br>  ),<br>  <span>"RandomForest"</span> = list(<br>    <span>"feature_selector__estimator__n_estimators"</span> = seq(<span>100L</span>, <span>500L</span>,by = <span>50L</span>),<br>    <span>"feature_selector__estimator__max_depth"</span> = c(<span>10L</span>, <span>20L</span>, <span>30L</span>),<br>    <span>"feature_selector__estimator__min_samples_split"</span> = c(<span>2L</span>, <span>5L</span>, <span>10L</span>),<br>    <span>"feature_selector__estimator__min_samples_leaf"</span> = c(<span>1L</span>, <span>2L</span>, <span>4L</span>),<br>    <span>"feature_selector__estimator__bootstrap"</span> = c(<span>TRUE</span>, <span>FALSE</span>)<br>  )<br>)<br></code></pre><p data-tool="markdown.com.cn编辑器"><span>需要注意的是，默认使用的参数搜索方法是 RandomizedSearchCV（随机的）。用户还可以指定</span><code><span>search_type</span></code><span>参数进行贝叶斯优化或完整的网格参数查找</span>。</p><h4 data-tool="markdown.com.cn编辑器"><span></span><span>4.自定义算法与参数组合</span><span></span></h4><p data-tool="markdown.com.cn编辑器"><span>该包支持其它来自sklearn库的算法。<strong>举个例子，如果您想使用 XGBoost 分类器而不是默认的随机森林</strong></span>：</p><pre data-tool="markdown.com.cn编辑器"><span></span><code>xgb &lt;- reticulate::import(<span>'xgboost'</span>)<br>xgb.classifier &lt;- xgb$XGBClassifier()<br><br>xgb_param_grid &lt;- list(<br>  <span>"classifier__learning_rate"</span> = c(<span>0.01</span>, <span>0.05</span>, <span>0.1</span>),<br>  <span>"classifier__n_estimators"</span> = c(<span>100L</span>, <span>200L</span>, <span>300L</span>),<br>  <span>"classifier__max_depth"</span> = c(<span>3L</span>, <span>5L</span>, <span>7L</span>),<br>  <span>"classifier__min_child_weight"</span> = c(<span>1L</span>, <span>3L</span>, <span>5L</span>),<br>  <span>"classifier__gamma"</span> = c(<span>0</span>, <span>0.1</span>, <span>0.2</span>),<br>  <span>"classifier__subsample"</span> = c(<span>0.8</span>, <span>1.0</span>),<br>  <span>"classifier__colsample_bytree"</span> = c(<span>0.8</span>, <span>1.0</span>)<br>)<br><span># 执行分析</span><br>selection_results &lt;- GeneSelectR::GeneSelectR(X = X, <br>                                              y = y,<br>                                              njobs = -<span>1</span>,<br>                                              classifier = xgb.classifier,<br>                                              classifier_grid = xgb_param_grid)<br></code></pre><br data-tool="markdown.com.cn编辑器"><h4 data-tool="markdown.com.cn编辑器"><span></span><span>5. 结果图表</span><span></span></h4><p><span><strong>特征重要性</strong></span>：</p><pre data-tool="markdown.com.cn编辑器"><span></span><code>plot_feature_importance(selection_results, top_n_features = <span>10</span>)<br></code></pre><section><img data-imgfileid="100008409" data-ratio="0.7268518518518519" data-type="png" data-w="1080" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/LvUIqvYKCeUWLcSwkw0jOicLtscjYib49jHHZkm8YgnYzmKoDRB2B0dnsZYEibCy3XtP6DyhZaeV1fEHGPjwYFCfQ/640?wx_fmt=png&amp;from=appmsg" src="https://mmbiz.qpic.cn/sz_mmbiz_png/LvUIqvYKCeUWLcSwkw0jOicLtscjYib49jHHZkm8YgnYzmKoDRB2B0dnsZYEibCy3XtP6DyhZaeV1fEHGPjwYFCfQ/640?wx_fmt=png&amp;from=appmsg"></section><p data-tool="markdown.com.cn编辑器"><span><strong>算法的表现</strong></span>：</p><pre data-tool="markdown.com.cn编辑器"><span></span><code>plot_metrics(selection_results)<br><br><span># or access it as a dataframe </span><br>selection_results$test_metrics <br>selection_results$cv_mean_score<br></code></pre><section><img data-imgfileid="100008410" data-ratio="2.3822714681440442" data-type="png" data-w="361" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/LvUIqvYKCeUWLcSwkw0jOicLtscjYib49jK2Wibvf4DYIgQGQ8VcCydrJG6WA7wgYhjcSe1OhokSUFbt77zXWKNEw/640?wx_fmt=png&amp;from=appmsg" src="https://mmbiz.qpic.cn/sz_mmbiz_png/LvUIqvYKCeUWLcSwkw0jOicLtscjYib49jK2Wibvf4DYIgQGQ8VcCydrJG6WA7wgYhjcSe1OhokSUFbt77zXWKNEw/640?wx_fmt=png&amp;from=appmsg"></section><p data-tool="markdown.com.cn编辑器"><span><strong>算法间的交集</strong></span><strong>：</strong></p><pre data-tool="markdown.com.cn编辑器"><span></span><code>overlap &lt;- calculate_overlap_coefficients(selection_results)<br>plot_overlap_heatmaps(overlap)<br><br><span># 对于自定义的算法集合：</span><br>custom_list &lt;- list(custom_list = c(<span>'char1'</span>,<span>'char2'</span>,<span>'char3'</span>,<span>'char4'</span>,<span>'char5'</span>),<br>                    custom_list2 = c(<span>'char1'</span>,<span>'char2'</span>,<span>'char3'</span>,<span>'char4'</span>,<span>'char5'</span>))<br>overlap1 &lt;- calculate_overlap_coefficients(selection_results, custom_lists = custom_list)<br>plot_overlap_heatmaps(overlap1)<br></code></pre><section><img data-imgfileid="100008411" data-ratio="0.6377858002406739" data-type="png" data-w="831" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/LvUIqvYKCeUWLcSwkw0jOicLtscjYib49jib2ibvogGyVe4xXNybbUiaicOiasS8IuJ0jCJlIARpicy8jEibxAl5fyxA6Lw/640?wx_fmt=png&amp;from=appmsg" src="https://mmbiz.qpic.cn/sz_mmbiz_png/LvUIqvYKCeUWLcSwkw0jOicLtscjYib49jib2ibvogGyVe4xXNybbUiaicOiasS8IuJ0jCJlIARpicy8jEibxAl5fyxA6Lw/640?wx_fmt=png&amp;from=appmsg"></section><p data-tool="markdown.com.cn编辑器"><span><strong>upset交集图</strong></span><strong>：</strong></p><pre data-tool="markdown.com.cn编辑器"><span></span><code>upset_upet(selection_results)<br><br><span># plot upset with custom lists </span><br>upset_upet(selection_results, custom_lists = custom_list)<br></code></pre><p data-tool="markdown.com.cn编辑器"><img data-imgfileid="100008412" data-ratio="0.6184419713831478" data-type="png" data-w="629" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/LvUIqvYKCeUWLcSwkw0jOicLtscjYib49jnLsjn69D0E7EWfnUIULP6P4SpY65iaKxx8OQK0DvlQ1kp68aIPMf9dg/640?wx_fmt=png&amp;from=appmsg" src="https://mmbiz.qpic.cn/sz_mmbiz_png/LvUIqvYKCeUWLcSwkw0jOicLtscjYib49jnLsjn69D0E7EWfnUIULP6P4SpY65iaKxx8OQK0DvlQ1kp68aIPMf9dg/640?wx_fmt=png&amp;from=appmsg"></p><hr><p><strong><span>简单分享到这里 <img data-ratio="1" data-w="128" data-src="https://res.wx.qq.com/t/wx_fed/we-emoji/res/v1.3.10/assets/newemoji/Yellowdog.png" src="https://res.wx.qq.com/t/wx_fed/we-emoji/res/v1.3.10/assets/newemoji/Yellowdog.png"><img data-ratio="1" data-w="128" data-src="https://res.wx.qq.com/t/wx_fed/we-emoji/res/v1.3.10/assets/Expression/Expression_64@2x.png" src="https://res.wx.qq.com/t/wx_fed/we-emoji/res/v1.3.10/assets/Expression/Expression_64@2x.png"></span></strong></p><section><mp-common-profile data-id="MzkyNTIzMzYyMA==" data-pluginname="mpprofile" data-headimg="http://mmbiz.qpic.cn/mmbiz_png/LvUIqvYKCeXYZNMxRMnjiaicO2a27jDZ2FgQga8TdeQcsGRJRIn2IInkKtfcbbMXOBSViaPXpTOBulUlNzd11pzow/0?wx_fmt=png" data-nickname="生信碱移" data-alias="liudoufu307" data-signature="春来秋至，分享我的所见与所识" data-from="2" data-weuitheme="light"></mp-common-profile></section><section><br></section><section><strong><span>END~</span></strong><br></section><p><span><strong>仅供粉丝老铁们参考</strong></span></p><p><strong>如有侵权或错误，请联系删除改正～</strong></p><h5 data-tool="markdown.com.cn编辑器"><span>更多介绍参见：</span></h5><ul data-tool="markdown.com.cn编辑器"><li><p><span>https://cran.r-project.org/web/packages/GeneSelectR/vignettes/example.html</span></p></li></ul></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/H95WdZaOohh4Zsjz-rTjvQ",target="_blank" rel="noopener noreferrer">原文链接</a>
