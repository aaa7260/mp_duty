---
title: "还没见过ComplexHeatmap版本的单细胞数据Dotplot图？大海哥手把手教你绘制！"
date: 2024-02-03T10:05:09Z
draft: ["false"]
tags: [
  "fetched",
  "生信滩"
]
categories: ["Acdemic"]
---
还没见过ComplexHeatmap版本的单细胞数据Dotplot图？大海哥手把手教你绘制！ by 生信滩
------
<div><p data-mpa-powered-by="yiban.io"><img data-galleryid="" data-imgfileid="100008014" data-ratio="0.2222222222222222" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/YHGRXkSxjSRvhAzztUiaKYKYRIqQEWXNoxXibsZRcJjicibDicCibYA7y5icMRcZgx2SdN2kLyRrksNrj1aFrfQFcB9sw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/YHGRXkSxjSRvhAzztUiaKYKYRIqQEWXNoxXibsZRcJjicibDicCibYA7y5icMRcZgx2SdN2kLyRrksNrj1aFrfQFcB9sw/640?wx_fmt=png&amp;from=appmsg"></p><section><span>小伙伴做单细胞数据可视化的时候，做过不少的图，热图肯定也少不了绘制，之前大海哥教过小伙伴如何使用ComplexHeatmap绘制出精美的热图，那么我们是不是可以把这个方式套用到单细胞数据中来呢，大海哥这里就手把手教小伙伴利用ComplexHeatmap去绘制单细胞数据中复杂的Dotplot图！</span></section><section><span>其实Dotplot就是点图，而点图是可以跨细胞群可视化 scRNAseq 表达数据的的好方法之一。它提供了细胞群内细胞的平均表达水平的信息（按颜色）以及群内表达该基因的细胞的百分比（按点的大小）。所以呢，在单细胞数据点图是一种常用的方式，但是常规的Seurat::DotPlot()绘图方式，不能对行和列进行聚类，所以这次大海哥使用ComplexHeatmap进行绘制，来看看吧！</span></section><section><span>我们使用自带的数据集，先调用R包</span></section><section><span></span></section><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="perl"><code><span>library(Seurat)  <span># DotPlot()</span></span></code><code><span>library(tidyverse)  <span># 数据整理</span></span></code><code><span>library(ComplexHeatmap)  <span># 绘制气泡热图</span></span></code><code><span>library(circlize)  <span># circlize::colorRamp2()</span></span></code><code><span>library(scRNAtoolVis)  <span># 为了使用pbmc数据集</span></span></code><code><span>然后我们加载pbmc数据集</span></code><code><span>httest &lt;- system.file(<span>"extdata"</span>, <span>"htdata.RDS"</span>, <span>package</span> = <span>"scRNAtoolVis"</span>)</span></code><code><span>pbmc &lt;- readRDS(httest)</span></code><code><span>           </span></code><code><span><span># add groups</span></span></code><code><span>pbmc$groups &lt;- rep(c(<span>'stim'</span>,<span>'control'</span>),<span>each</span> = <span>1319</span>)    </span></code><code><span><span># add celltype</span></span></code><code><span>pbmc$celltype &lt;- Seurat::Idents(pbmc)</span></code><code><span>           </span></code><code><span><span># load markergene</span></span></code><code><span>data(<span>"top3pbmc.markers"</span>)</span></code><code><span>           </span></code><code><span><span># check</span></span></code><code><span>head(top3pbmc.markers,<span>3</span>)</span></code></pre></section><section><span></span></section><section><span><img data-imgfileid="100008177" data-ratio="0.2700490998363339" data-src="https://mmbiz.qpic.cn/mmbiz_png/YHGRXkSxjSSZvC5WKjA7sZia5UWXLjWTicyqlLzzQMLRCiarAZasPtvv1JMYVWUia0ZVlUuKfrnzyp8OjYQaGYiaV8g/640?wx_fmt=png" data-type="png" data-w="611" height="149.54000854492188" width="553.739990234375" src="https://mmbiz.qpic.cn/mmbiz_png/YHGRXkSxjSSZvC5WKjA7sZia5UWXLjWTicyqlLzzQMLRCiarAZasPtvv1JMYVWUia0ZVlUuKfrnzyp8OjYQaGYiaV8g/640?wx_fmt=png"></span></section><section><span>先看看用Seurat::DotPlot()绘制的图</span></section><section><ul><li><li></ul><pre data-lang="xml"><code><span>p <span>&lt;<span>-</span> <span>DotPlot</span>(<span>object</span> = <span>pbmc,</span> <span>features</span> = <span>top3pbmc.markers$gene)</span></span></span></code><code><span><span>p</span></span></code></pre></section><p><span></span></p><section><span><img data-imgfileid="100008173" data-ratio="0.6675925925925926" data-src="https://mmbiz.qpic.cn/mmbiz_png/YHGRXkSxjSSZvC5WKjA7sZia5UWXLjWTicXp9ZHdFUaokPCPRLrVOkjy9cynglU7twiamINmSjUOfXPyqjcULq8CQ/640?wx_fmt=png" data-type="png" data-w="1080" height="295.34002685546875" width="442.3399658203125" src="https://mmbiz.qpic.cn/mmbiz_png/YHGRXkSxjSSZvC5WKjA7sZia5UWXLjWTicXp9ZHdFUaokPCPRLrVOkjy9cynglU7twiamINmSjUOfXPyqjcULq8CQ/640?wx_fmt=png"></span><span>    </span><page></page></section><section><span>在一些细节上我们无法修改，来我们看看ComplexHeatmap版的Dotplot，先提取绘图数据</span><span>        </span><p> </p></section><section><span></span></section><section><ul><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="php"><code><span><span>#提取数据</span></span></code><code><span>df&lt;- p$data</span></code><code><span>           </span></code><code><span>exp_mat &lt;- df %&gt;%</span></code><code><span>  dplyr::select(-pct.exp, -avg.exp) %&gt;%</span></code><code><span>  pivot_wider(names_from = id, values_from = avg.exp.scaled) %&gt;%</span></code><code><span>  <span>as</span>.data.frame()</span></code><code><span>           </span></code><code><span>           </span></code><code><span>row.names(exp_mat) &lt;- exp_mat$features.plot</span></code><code><span>exp_mat &lt;- exp_mat[,<span>-1</span>] %&gt;% <span>as</span>.matrix()</span></code><code><span>head(exp_mat)</span></code></pre></section><section><span></span></section><section><span><img data-imgfileid="100008175" data-ratio="0.3089005235602094" data-src="https://mmbiz.qpic.cn/mmbiz_png/YHGRXkSxjSSZvC5WKjA7sZia5UWXLjWTicicWUDR9P4zOQtsOzSkPPlLuKliakU0UGsKarice5LrNGjIELsZ19xRSCw/640?wx_fmt=png" data-type="png" data-w="955" height="163.34002685546875" width="528.6699829101562" src="https://mmbiz.qpic.cn/mmbiz_png/YHGRXkSxjSSZvC5WKjA7sZia5UWXLjWTicicWUDR9P4zOQtsOzSkPPlLuKliakU0UGsKarice5LrNGjIELsZ19xRSCw/640?wx_fmt=png"></span></section><section><span>数据2</span></section><section><span></span></section><section><ul><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="php"><code><span><span>#数据2</span></span></code><code><span>               </span></code><code><span>percent_mat &lt;- df %&gt;%</span></code><code><span>  dplyr::select(-avg.exp, -avg.exp.scaled) %&gt;%</span></code><code><span>  pivot_wider(names_from = id, values_from = pct.exp) %&gt;%</span></code><code><span>  <span>as</span>.data.frame()</span></code><code><span>           </span></code><code><span>row.names(percent_mat) &lt;- percent_mat$features.plot</span></code><code><span>percent_mat &lt;- percent_mat[,<span>-1</span>] %&gt;% <span>as</span>.matrix()</span></code><code><span>head(percent_mat)</span></code></pre></section><section><span></span></section><section><span><img data-imgfileid="100008176" data-ratio="0.17373737373737375" data-src="https://mmbiz.qpic.cn/mmbiz_png/YHGRXkSxjSSZvC5WKjA7sZia5UWXLjWTicFqsfDudCC4k7uMnFz0oDCWlgxl8Diac9nPkic1DrXqJ64WbBXNUSIpkg/640?wx_fmt=png" data-type="png" data-w="990" height="96.20001220703125" width="553.739990234375" src="https://mmbiz.qpic.cn/mmbiz_png/YHGRXkSxjSSZvC5WKjA7sZia5UWXLjWTicFqsfDudCC4k7uMnFz0oDCWlgxl8Diac9nPkic1DrXqJ64WbBXNUSIpkg/640?wx_fmt=png"></span></section><section><span>小伙伴可以按照这样的数据形式自行去设置</span></section><section><span>然后我们去设置一下调色板</span><span>       </span><p> </p></section><section><span></span></section><section><ul><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="makefile"><code><span><span>#调色板</span></span></code><code><span>library(RColorBrewer)</span></code><code><span>quantile(exp_mat, c(0.1, 0.5, 0.9, 0.99))</span></code><code><span>           </span></code><code><span>col_fun = circlize::colorRamp2(c(-0.6, 0, 2), brewer.pal(11, <span>"PiYG"</span>)[c(11,8,1)])</span></code><code><span>           </span></code><code><span>cell_fun = function(j, i, x, y, w, h, fill){</span></code><code><span>  grid.rect(x = x, y = y, width = w, height = h,</span></code><code><span>            gp = gpar(col = NA, fill = NA))    </span></code><code><span>  grid.circle(x=x,y=y,r= percent_mat[i, j]/100 * min(unit.c(w, h)),</span></code><code><span>              gp = gpar(fill = col_fun(exp_mat[i, j]), col = NA))}</span></code></pre></section><section><span></span></section><section><span>这里我们使用ComplexHeatmap::Heatmap绘制聚类散点图（想象一下吧，就是把热图中的小方块换成了圆块），看一下效果</span></section><section><span></span></section><section><ul><li><li><li><li><li><li><li><li><li></ul><pre data-lang="properties"><code><span><span>Heatmap(exp_mat,</span></span></code><code><span>        <span>name</span> = <span>"hp",</span></span></code><code><span>        <span>heatmap_legend_param</span> = <span>list(title = "expression"),</span></span></code><code><span>        <span>col</span> = <span>col_fun,</span></span></code><code><span>        <span>rect_gp</span> = <span>gpar(type = "none"),</span></span></code><code><span>        <span>cell_fun</span> = <span>cell_fun,</span></span></code><code><span>        <span>row_names_gp</span> = <span>gpar(fontsize = 5),</span></span></code><code><span>        <span>row_km</span> = <span>4,</span></span></code><code><span>        <span>border</span> = <span>"black")</span></span></code></pre></section><section><span></span></section><section><span><img data-imgfileid="100008174" data-ratio="0.6499068901303539" data-src="https://mmbiz.qpic.cn/mmbiz_png/YHGRXkSxjSSZvC5WKjA7sZia5UWXLjWTicNQYlpMHmWkGz6ibE94iaCYE9GibRoZ1mzNFpA2rsRjZ7bjpBqG2LparpA/640?wx_fmt=png" data-type="png" data-w="1074" height="304.66998291015625" width="468.8699951171875" src="https://mmbiz.qpic.cn/mmbiz_png/YHGRXkSxjSSZvC5WKjA7sZia5UWXLjWTicNQYlpMHmWkGz6ibE94iaCYE9GibRoZ1mzNFpA2rsRjZ7bjpBqG2LparpA/640?wx_fmt=png"></span></section><section><span><span>但是还有很多细节不是很完美，仔细看行列名称不清楚距离也很宽，下面我们对配色还有网络以及行的修饰进行修改一下，来看看</span>    </span><page></page></section><section><span>还是和上面一样把数据调用出来</span></section><section><span></span></section><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="php"><code><span>httest &lt;- system.file(<span>"extdata"</span>, <span>"htdata.RDS"</span>, package = <span>"scRNAtoolVis"</span>)</span></code><code><span>pbmc &lt;- readRDS(httest)</span></code><code><span>           </span></code><code><span><span># add groups</span></span></code><code><span>pbmc$groups &lt;- rep(c(<span>'stim'</span>,<span>'control'</span>),each = <span>1319</span>)</span></code><code><span><span># add celltype</span></span></code><code><span>pbmc$celltype &lt;- Seurat::Idents(pbmc)</span></code><code><span>           </span></code><code><span><span># load markergene</span></span></code><code><span>data(<span>"top3pbmc.markers"</span>)</span></code><code><span>           </span></code><code><span><span># check</span></span></code><code><span>head(top3pbmc.markers,<span>3</span>)</span></code><code><span><span># Seurat::DotPlot()</span></span></code><code><span>p &lt;- DotPlot(object = pbmc, features = top3pbmc.markers$gene)</span></code><code><span>下面重新整理绘图的数据</span></code><code><span><span># 提取并重新整理绘图数据</span></span></code><code><span>df&lt;- p$data</span></code><code><span>           </span></code><code><span>exp_mat &lt;- df %&gt;%</span></code><code><span>  dplyr::select(-pct.exp, -avg.exp) %&gt;%    </span></code><code><span>  pivot_wider(names_from = id, values_from = avg.exp.scaled) %&gt;%</span></code><code><span>  <span>as</span>.data.frame()</span></code><code><span>row.names(exp_mat) &lt;- exp_mat$features.plot</span></code><code><span>exp_mat &lt;- exp_mat[,<span>-1</span>] %&gt;% <span>as</span>.matrix()</span></code><code><span>           </span></code><code><span>percent_mat &lt;- df %&gt;%</span></code><code><span>  dplyr::select(-avg.exp, -avg.exp.scaled) %&gt;%</span></code><code><span>  pivot_wider(names_from = id, values_from = pct.exp) %&gt;%</span></code><code><span>  <span>as</span>.data.frame()</span></code><code><span>           </span></code><code><span>row.names(percent_mat) &lt;- percent_mat$features.plot</span></code><code><span>percent_mat &lt;- percent_mat[,<span>-1</span>] %&gt;% <span>as</span>.matrix()</span></code><code><span>           </span></code><code><span><span># 填充色设置</span></span></code><code><span>col_fun = circlize::colorRamp2(c(<span>-0.6</span>, <span>0</span>, <span>2</span>), c(<span>"#424da7"</span>,<span>"#ffffff"</span>,<span>"#dd2b19"</span>))</span></code><code><span>           </span></code><code><span><span># 增加细胞百分比和细胞群注释</span></span></code><code><span>cluster &lt;- colnames(exp_mat)</span></code><code><span>           </span></code><code><span>column_ha &lt;- HeatmapAnnotation(</span></code><code><span>  cluster = cluster,</span></code><code><span>  col = <span>list</span>(cluster = setNames(brewer.pal(<span>9</span>, <span>"Paired"</span>), unique(cluster))    </span></code><code><span>  ),</span></code><code><span>  na_col = <span>"grey"</span></span></code><code><span>)</span></code><code><span>           </span></code><code><span><span># 图层设置</span></span></code><code><span>layer_fun = <span><span>function</span><span>(j, i, x, y, w, h, fill)</span></span>{</span></code><code><span>  grid.rect(x = x, y = y, width = w, height = h,</span></code><code><span>            gp = gpar(col = NA, fill = NA))</span></code><code><span>  grid.circle(x=x,y=y,r= pindex(percent_mat, i, j)/<span>100</span> * unit(<span>2</span>, <span>"mm"</span>),</span></code><code><span>              gp = gpar(fill = col_fun(pindex(exp_mat, i, j)), col = NA))}</span></code><code><span>           </span></code><code><span><span># 图例设置</span></span></code><code><span>lgd_list = <span>list</span>(</span></code><code><span>  Legend( labels = c(<span>0</span>,<span>0.25</span>,<span>0.5</span>,<span>0.75</span>,<span>1</span>), title = <span>"pt"</span>,</span></code><code><span>          graphics = <span>list</span>(</span></code><code><span>            <span><span>function</span><span>(x, y, w, h)</span> <span>grid</span>.<span>circle</span><span>(x = x, y = y, r = <span>0</span> * unit<span>(<span>2</span>, <span>"mm"</span>)</span>,</span></span></span></code><code><span><span>                                             gp = gpar<span>(fill = <span>"black"</span>)</span>)</span>,</span></code><code><span>            <span>function</span><span>(x, y, w, h)</span> <span>grid</span>.<span>circle</span><span>(x = x, y = y, r = <span>0.25</span> * unit<span>(<span>2</span>, <span>"mm"</span>)</span>,</span></span></code><code><span><span>                                             gp = gpar<span>(fill = <span>"black"</span>)</span>)</span>,</span></code><code><span>            <span>function</span><span>(x, y, w, h)</span> <span>grid</span>.<span>circle</span><span>(x = x, y = y, r = <span>0.5</span> * unit<span>(<span>2</span>, <span>"mm"</span>)</span>,</span></span></code><code><span><span>                                             gp = gpar<span>(fill = <span>"black"</span>)</span>)</span>,</span></code><code><span>            <span>function</span><span>(x, y, w, h)</span> <span>grid</span>.<span>circle</span><span>(x = x, y = y, r = <span>0.75</span> * unit<span>(<span>2</span>, <span>"mm"</span>)</span>,    </span></span></code><code><span><span>                                             gp = gpar<span>(fill = <span>"black"</span>)</span>)</span>,</span></code><code><span>            <span>function</span><span>(x, y, w, h)</span> <span>grid</span>.<span>circle</span><span>(x = x, y = y, r = <span>1</span> * unit<span>(<span>2</span>, <span>"mm"</span>)</span>,</span></span></code><code><span><span>                                             gp = gpar<span>(fill = <span>"black"</span>)</span>)</span>)</span></code><code><span>  ))</span></code><code><span>上述设置好了之后，我们开始绘制图片，先看一下气泡热图</span></code><code><span># 气泡热图</span></code><code><span><span>hp</span> &lt;- <span>Heatmap</span><span>(exp_mat,</span></span></code><code><span>              name = <span>"hp"</span>,</span></code><code><span>              heatmap_legend_param = list<span>(title = <span>"expression"</span>)</span>,</span></code><code><span>              col = col_fun,</span></code><code><span>              rect_gp = gpar<span>(type = <span>"none"</span>)</span>,</span></code><code><span>              layer_fun = layer_fun,</span></code><code><span>              row_names_gp = gpar<span>(fontsize = <span>5</span>)</span>,</span></code><code><span>              row_names_side = <span>"left"</span>,</span></code><code><span>              row_title = NULL,</span></code><code><span>              row_km = <span>4</span>,</span></code><code><span>              column_names_rot = <span>45</span>,</span></code><code><span>              border = <span>"black"</span>,</span></code><code><span>              bottom_annotation = column_ha,</span></code><code><span>              # 去掉行聚类树的虚线</span></code><code><span>              show_parent_dend_line = F)</span></code><code><span>               </span></code><code><span><span>draw</span><span>(hp, annotation_legend_list = lgd_list)</span></span></code></pre></section><section><span></span></section><section><span><img data-imgfileid="100008180" data-ratio="0.6657407407407407" data-src="https://mmbiz.qpic.cn/mmbiz_png/YHGRXkSxjSSZvC5WKjA7sZia5UWXLjWTicPiaed6TnAVKPPt8AUHNpErsibfun5fVUQvxx3icmlrDU6AkibYwHmsG1yA/640?wx_fmt=png" data-type="png" data-w="1080" height="368.40997314453125" width="553.739990234375" src="https://mmbiz.qpic.cn/mmbiz_png/YHGRXkSxjSSZvC5WKjA7sZia5UWXLjWTicPiaed6TnAVKPPt8AUHNpErsibfun5fVUQvxx3icmlrDU6AkibYwHmsG1yA/640?wx_fmt=png"></span></section><section><span>是不是很好看，并且图注信息等很清楚，配色也是很美丽。</span></section><section><span>下面在修饰一下行的名字等，</span></section><section><span></span></section><section><ul><li><li><li><li></ul><pre data-lang="bash"><code><span><span># 装饰行name</span></span></code><code><span>decorate_row_names(<span>"hp"</span>, {</span></code><code><span>  grid.rect(gp = gpar(fill = <span>"#FFA50080"</span>, col = <span>"white"</span>))</span></code><code><span>}, slice = 1)</span></code></pre></section><section><span><img data-imgfileid="100008178" data-ratio="1.018987341772152" data-src="https://mmbiz.qpic.cn/mmbiz_png/YHGRXkSxjSSZvC5WKjA7sZia5UWXLjWTictWB9gXtM8OrgNtqAtlmL2YY4sJWBXot1TSZtv5orcqnoVvibhuRWHEQ/640?wx_fmt=png" data-type="png" data-w="632" height="474.010009765625" width="465.1400146484375" src="https://mmbiz.qpic.cn/mmbiz_png/YHGRXkSxjSSZvC5WKjA7sZia5UWXLjWTictWB9gXtM8OrgNtqAtlmL2YY4sJWBXot1TSZtv5orcqnoVvibhuRWHEQ/640?wx_fmt=png"></span></section><section><span></span></section><section><ul><li><li><li></ul><pre data-lang="javascript"><code><span>decorate_row_names(<span>"hp"</span>, {</span></code><code><span>  grid.rect(gp = gpar(fill = <span>"#FF000040"</span>, col = <span>"white"</span>))</span></code><code><span>}, slice = <span>2</span>)</span></code></pre></section><section><span><span></span>    </span><page></page></section><section><span><img data-imgfileid="100008182" data-ratio="1.048780487804878" data-src="https://mmbiz.qpic.cn/mmbiz_png/YHGRXkSxjSSZvC5WKjA7sZia5UWXLjWTic6wNEDX1kwcDOicTgOIAkKU4wE1zaWJmAxXN4GOI6Bic12aJ6SdHXbwKg/640?wx_fmt=png" data-type="png" data-w="615" height="437.34002685546875" width="417.010009765625" src="https://mmbiz.qpic.cn/mmbiz_png/YHGRXkSxjSSZvC5WKjA7sZia5UWXLjWTic6wNEDX1kwcDOicTgOIAkKU4wE1zaWJmAxXN4GOI6Bic12aJ6SdHXbwKg/640?wx_fmt=png"></span></section><section><span></span></section><section><ul><li><li><li></ul><pre data-lang="javascript"><code><span>decorate_row_names(<span>"hp"</span>, {</span></code><code><span>  grid.rect(gp = gpar(fill = <span>"#00FF0040"</span>, col = <span>"white"</span>))</span></code><code><span>}, slice = <span>3</span>)</span></code></pre></section><section><span><span></span>    </span><page></page></section><section><span><img data-imgfileid="100008179" data-ratio="1.0289855072463767" data-src="https://mmbiz.qpic.cn/mmbiz_png/YHGRXkSxjSSZvC5WKjA7sZia5UWXLjWTicAa4MOY9mnXlaKzp24GjNXljqbq6lzF4rOY8qI6wd2HGqdHjm0kdTtA/640?wx_fmt=png" data-type="png" data-w="621" height="392.3399963378906" width="381.3399963378906" src="https://mmbiz.qpic.cn/mmbiz_png/YHGRXkSxjSSZvC5WKjA7sZia5UWXLjWTicAa4MOY9mnXlaKzp24GjNXljqbq6lzF4rOY8qI6wd2HGqdHjm0kdTtA/640?wx_fmt=png"></span></section><section><span></span></section><section><ul><li><li><li></ul><pre data-lang="javascript"><code><span>decorate_row_names(<span>"hp"</span>, {</span></code><code><span>  grid.rect(gp = gpar(fill = <span>"#0000FF40"</span>, col = <span>"white"</span>))</span></code><code><span>}, slice = <span>4</span>)</span></code></pre></section><section><span><span></span>    </span><page></page></section><section><span><img data-imgfileid="100008181" data-ratio="1.0206677265500794" data-src="https://mmbiz.qpic.cn/mmbiz_png/YHGRXkSxjSSZvC5WKjA7sZia5UWXLjWTicNXpZTubI2fqVXJUlhsY60TfNXM8la5BbtpiacXI5BmUeoZohbj2NiawA/640?wx_fmt=png" data-type="png" data-w="629" height="410.010009765625" width="401.6700439453125" src="https://mmbiz.qpic.cn/mmbiz_png/YHGRXkSxjSSZvC5WKjA7sZia5UWXLjWTicNXpZTubI2fqVXJUlhsY60TfNXM8la5BbtpiacXI5BmUeoZohbj2NiawA/640?wx_fmt=png"></span></section><section><span><span>好了，这样一来图片就绘制完成了，小伙伴有没有学会呢？快去动手试试吧，多多理解代码意义，绘制出自己想要的图！</span></span></section><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><p>大海哥还提供思路设计、定制生信分析、文献思路复现；有需要的小伙伴欢迎直接扫码咨询~</p></section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><img data-cropselx1="0" data-cropselx2="177" data-cropsely1="0" data-cropsely2="177" data-imgfileid="100008184" data-ratio="0.9973474801061007" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/YHGRXkSxjSQicw3pkyJwFjNBuDYsZOL0kg45dSicgiaibBKJ3sbCq5IqXgFt7c9DmuucV9s07LXWFIoyBPufribs2ibA/640?wx_fmt=png&amp;from=appmsg" data-type="jpeg" data-w="377" src="https://mmbiz.qpic.cn/mmbiz_png/YHGRXkSxjSQicw3pkyJwFjNBuDYsZOL0kg45dSicgiaibBKJ3sbCq5IqXgFt7c9DmuucV9s07LXWFIoyBPufribs2ibA/640?wx_fmt=png&amp;from=appmsg"></section></section></section><section><section powered-by="xiumi.us"><section><p><strong>定制生信分析<br></strong></p><p><strong>服务器租赁</strong></p><p><strong>扫码咨询大海哥</strong></p></section></section></section></section></section></section><p powered-by="xiumi.us"><br></p><section powered-by="xiumi.us"><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzkzMzUwODcwMg==&amp;mid=2247491024&amp;idx=2&amp;sn=d8ccbed93d5e13fd8a885a87cd12231b&amp;chksm=c24a3ee1f53db7f72717fae9c169ffc49e75005f8714185e35fc0864dac2e218e6563ecb3d08&amp;scene=21#wechat_redirect" textvalue="你已选中了添加链接的内容" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="1"><span><img data-imgfileid="100008185" data-ratio="0.29333333333333333" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/YHGRXkSxjSRzichicbEcnU2mvqdp0llrP8YNwNxNKRMdrRvz0oLnZNEMMFCyVfJXeWmtQcJ24EkyyXxgyaYicwn5w/640?wx_fmt=jpeg&amp;from=appmsg" data-type="jpeg" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_jpg/YHGRXkSxjSRzichicbEcnU2mvqdp0llrP8YNwNxNKRMdrRvz0oLnZNEMMFCyVfJXeWmtQcJ24EkyyXxgyaYicwn5w/640?wx_fmt=jpeg&amp;from=appmsg"></span></a></section></section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><p><strong>往期回顾</strong></p></section></section><section powered-by="xiumi.us"><section><svg viewbox="0 0 1 1"></svg></section></section><section powered-by="xiumi.us"><section><svg viewbox="0 0 1 1"></svg></section></section></section><section><section powered-by="xiumi.us"><section><svg viewbox="0 0 1 1"></svg></section></section><section powered-by="xiumi.us"><section><svg viewbox="0 0 1 1"></svg></section></section></section></section><section powered-by="xiumi.us"><section><table width="100%"><tbody><tr opera-tn-ra-comp="_$.pages:0.layers:0.comps:4.classicTable1:0" powered-by="xiumi.us"><td colspan="1" rowspan="1" opera-tn-ra-cell="_$.pages:0.layers:0.comps:4.classicTable1:0.td@@0" width="100.0000%"><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><p><strong>01</strong></p></section></section><section><section powered-by="xiumi.us"><p><span>｜<a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzkzMzUwODcwMg==&amp;mid=2247491024&amp;idx=2&amp;sn=d8ccbed93d5e13fd8a885a87cd12231b&amp;chksm=c24a3ee1f53db7f72717fae9c169ffc49e75005f8714185e35fc0864dac2e218e6563ecb3d08&amp;scene=21#wechat_redirect" textvalue="生信人必备神器——1024G存储的生信服务器，免费试用啦" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2">生信人必备神器——1024G存储的生信服务器，免费试用啦</a></span></p></section></section></section><section powered-by="xiumi.us"><section><svg viewbox="0 0 1 1"></svg></section></section></section></td></tr><tr opera-tn-ra-comp="_$.pages:0.layers:0.comps:4.classicTable1:1" powered-by="xiumi.us"><td colspan="1" rowspan="1" opera-tn-ra-cell="_$.pages:0.layers:0.comps:4.classicTable1:1.td@@0" width="100.0000%"><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><p><strong>02</strong></p></section></section><section><section powered-by="xiumi.us"><p><span>｜<a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzkzMzUwODcwMg==&amp;mid=2247490768&amp;idx=1&amp;sn=f7fa9fe45eb128a9729aaeeb866e37bb&amp;chksm=c24a3fe1f53db6f7f936d8397efb9fd089b412a7b48d53f3a76496eb2122843dd3a349a0065b&amp;scene=21#wechat_redirect" textvalue="【BWMR】孟德尔随机化分析利器，克服分析挑战！" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2">【BWMR】孟德尔随机化分析利器，克服分析挑战！</a></span></p></section></section></section><section powered-by="xiumi.us"><section><svg viewbox="0 0 1 1"></svg></section></section></section></td></tr><tr opera-tn-ra-comp="_$.pages:0.layers:0.comps:4.classicTable1:2" powered-by="xiumi.us"><td colspan="1" rowspan="1" opera-tn-ra-cell="_$.pages:0.layers:0.comps:4.classicTable1:2.td@@0" width="100.0000%"><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><p><strong>03</strong></p></section></section><section><section powered-by="xiumi.us"><p><span>｜<a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzkzMzUwODcwMg==&amp;mid=2247490408&amp;idx=1&amp;sn=ed197d298464c36bc55e010e5005bd82&amp;chksm=c24a3859f53db14f6dac19c3b53824c27b6bcec7f36ff04acc89505970a2749fc2f13acdcc1d&amp;scene=21#wechat_redirect" textvalue="分子对接花了几个小时？批量分子对接帮你5分钟搞定！" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2">分子对接花了几个小时？批量分子对接帮你5分钟搞定！</a></span></p></section></section></section><section powered-by="xiumi.us"><section><svg viewbox="0 0 1 1"></svg></section></section></section></td></tr><tr opera-tn-ra-comp="_$.pages:0.layers:0.comps:4.classicTable1:3" powered-by="xiumi.us"><td colspan="1" rowspan="1" opera-tn-ra-cell="_$.pages:0.layers:0.comps:4.classicTable1:3.td@@0" width="100.0000%"><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><p><strong>04</strong></p></section></section><section><section powered-by="xiumi.us"><p><span>｜<a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzkzMzUwODcwMg==&amp;mid=2247490092&amp;idx=1&amp;sn=60fa51a91ee9882bb37aaa240ac5a63a&amp;chksm=c24a391df53db00bbd05351d9cc70897d6c9e1670d92a0c56283d10aec4ce179f5dedd4338ad&amp;scene=21#wechat_redirect" textvalue="手把手带你复现XGboost和LightGBM机器学习算法特征重要性排名和 SHAP 汇总图" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2">手把手带你复现XGboost和LightGBM机器学习算法特征重要性排名和 SHAP 汇总图</a></span></p></section></section></section><section powered-by="xiumi.us"><section><svg viewbox="0 0 1 1"></svg></section></section></section></td></tr></tbody></table></section></section></section><p><span></span><br></p><section><page></page></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/LCyjwa3vUjQV5Sn3sR1vpA",target="_blank" rel="noopener noreferrer">原文链接</a>
