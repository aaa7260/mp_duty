---
title: "高速下载GEO数据库的单细胞表达量矩阵文件"
date: 2024-02-14T08:20:19Z
draft: ["false"]
tags: [
  "fetched",
  "单细胞天地"
]
categories: ["Acdemic"]
---
高速下载GEO数据库的单细胞表达量矩阵文件 by 单细胞天地
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><blockquote data-tool="mdnice编辑器"><span></span><p>一般来说，GEO数据库的文件是没有必要高速下载的，因为里面存放的都是表达量矩阵等，文件非常小，通过浏览器点击下载的方式就算是网络很慢，等等也会成功。</p></blockquote><p data-tool="mdnice编辑器">但是如果要下载成百上千个文件，最好是使用代码批量下载，而且现在单细胞技术的大行其道，使得表达量矩阵文件本身也会很巨大，比如：https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE253013 ，可以看到如下所示9.3 Gb文件 ：</p><pre data-tool="mdnice编辑器"><span></span><code> GSE253013_all_luad_garnett_temp.rds.gz 9.3 Gb (ftp)(http) RDS<br></code></pre><p data-tool="mdnice编辑器">如果是慢慢的下载需要两三天时间：</p><pre data-tool="mdnice编辑器"><span></span><code>wget -c https://ftp.ncbi.nlm.nih.gov/geo/series/GSE253nnn/GSE253013/suppl/GSE253013_all_luad_garnett_temp.rds.gz <br><br> 8.04M  34.2KB/s  剩余 2d 4h<br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span>借助aspera的高速下载</span><span></span></h3><p data-tool="mdnice编辑器">首先自行参考：<a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247492889&amp;idx=2&amp;sn=bc2ef17a3b96a257fb692f73338c6b0f&amp;scene=21#wechat_redirect" data-linktype="2">使用ebi数据库直接下载fastq测序数据</a>  ,  配置好aspera软件即可，然后要详细的阅读GEO数据库的官方文档</p><ul data-tool="mdnice编辑器"><li><section><p>https://www.ncbi.nlm.nih.gov/geo/info/download.html</p></section></li><li><section><p>https://www.ibm.com/support/pages/downloading-data-ncbi-command-line</p></section></li></ul><p data-tool="mdnice编辑器">需要构建的命令如下所示：</p><pre data-tool="mdnice编辑器"><span></span><code>conda activate download<br> <br>ascp -v -k 1 -T -l 200m \<br>-i ~/miniconda3/envs/download/etc/asperaweb_id_dsa.openssh   \<br>anonftp@ftp.ncbi.nlm.nih.gov:/geo/series/GSE253nnn/GSE253013/suppl/GSE253013_all_luad_garnett_temp.rds.gz ./ <br></code></pre><p data-tool="mdnice编辑器">下载速度非常感人：</p><pre data-tool="mdnice编辑器"><span></span><code>1%   97MB  191Mb/s<br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span><span>有了这个rds文件，很容易载入到r编程语言里面去处理它，然后文章是提取子集，感兴趣的可以试试看（Single-cell analysis identifies NOTCH3-mediated interactions between stromal cells that promote microenvironment remodeling and invasion in lung adenocarcinoma）</span></span></h3><p><img data-galleryid="" data-imgfileid="100036300" data-ratio="0.5857142857142857" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSIY97AgmQnWushuU4myIWnzHodqiaVeX0IQ0nabVf59DOZHJX3hqYXXbLLAkia4RqAcnQEfdy4uIVg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="980" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSIY97AgmQnWushuU4myIWnzHodqiaVeX0IQ0nabVf59DOZHJX3hqYXXbLLAkia4RqAcnQEfdy4uIVg/640?wx_fmt=png&amp;from=appmsg"></p><span>全部的Linux命令</span><span></span><p data-tool="mdnice编辑器">首先是安装自己的conda，在自己的服务器里面自己下载并且安装自己的conda，自己配置哈：</p><pre data-tool="mdnice编辑器"><span></span><code><span># 首先下载文件，20M/S的话需要几秒钟即可</span><br>wget https://repo.anaconda.com/miniconda/Miniconda3-latest-Linux-x86_64.sh<br><span># Miniconda3-latest-Linux-x86_64.sh 135.1 MiB 2023-12-21 09:23</span><br><span># wget https://mirrors.tuna.tsinghua.edu.cn/anaconda/miniconda/Miniconda3-latest-Linux-x86_64.sh</span><br><span># 如果比较慢就切换镜像哦</span><br><br><span># 接下来使用bash命令来运行我们下载的文件，记得是一路yes下去</span><br>bash Miniconda3-latest-Linux-x86_64.sh <br><span>#  上面的bash命令安装成功后,需要更新系统环境变量文件</span><br><span>source</span> ~/.bashrc<br></code></pre><p data-tool="mdnice编辑器">首先如果是在中国大陆，需要设置好镜像：</p><pre data-tool="mdnice编辑器"><span></span><code>conda config --add channels https://mirrors.bfsu.edu.cn/anaconda/cloud/bioconda/<br>conda config --add channels https://mirrors.bfsu.edu.cn/anaconda/cloud/conda-forge/<br>conda config --add channels https://mirrors.bfsu.edu.cn/anaconda/pkgs/free/<br>conda config --add channels https://mirrors.bfsu.edu.cn/anaconda/pkgs/main/<br>conda config --<span>set</span> show_channel_urls yes <br></code></pre><p data-tool="mdnice编辑器">然后就可以使用自己的conda来安装 aspera 软件，本来是说让大家自行参考：<a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247492889&amp;idx=2&amp;sn=bc2ef17a3b96a257fb692f73338c6b0f&amp;scene=21#wechat_redirect" data-linktype="2">使用ebi数据库直接下载fastq测序数据</a>  ,  配置好aspera软件即可。</p><pre data-tool="mdnice编辑器"><span></span><code>conda create -n download <br>conda activate download <br>conda install -y -c hcc aspera-cli <br><span>which</span> ascp <br><span>## 一定要搞清楚你的软件被conda安装在哪</span><br>ls -lh ~/miniconda3/envs/download/etc/asperaweb_id_dsa.openssh <br></code></pre><p data-tool="mdnice编辑器">上面的代码是基于Linux操作系统哦，如果大家一定要在自己的Windows或者Mac电脑处理，就简单的替换关键参数即可。</p></section><p><br></p><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/iiz0wWlSvSgWeHpkf26ABA",target="_blank" rel="noopener noreferrer">原文链接</a>
