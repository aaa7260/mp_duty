---
title: "【孟德尔随机化】文献复现（五）"
date: 2024-02-21T05:22:18Z
draft: ["false"]
tags: [
  "fetched",
  "生信菜鸟团"
]
categories: ["Acdemic"]
---
【孟德尔随机化】文献复现（五） by 生信菜鸟团
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><blockquote data-tool="mdnice编辑器"><span></span><p>因为自己复现的结果始终与文献不一致，所以尝试联系了作者并找到了作者提供的代码，这次我们尝试用官方代码重跑一遍~</p></blockquote><p data-tool="mdnice编辑器">作者提供的数据和代码在这里：</p><blockquote data-tool="mdnice编辑器"><span></span><p>https:// doi.org/10.17605/OSF.IO/MUERZ.<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="22px" height="22px" viewbox="0 0 32 32" enable-background="new 0 0 32 32"><image width="32" height="32" x="0" y="0"></image></svg></p></blockquote><p data-tool="mdnice编辑器">今天的内容建议参考<a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzUzMTEwODk0Ng==&amp;mid=2247519864&amp;idx=1&amp;sn=b245d6ad929017786680113346b03073&amp;chksm=fa454b45cd32c2538a75ee0f1721f12615ce257c98f9acf694c3b53aa9298a91c478b61c1657&amp;scene=21#wechat_redirect" textvalue="【孟德尔随机化】文献复现（三）" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2">【孟德尔随机化】文献复现（三）</a>，比较一下代码的异同以便进一步思考~</p><p data-tool="mdnice编辑器">我们先来看table 1部分：</p><pre data-tool="mdnice编辑器"><span></span><code>chr&lt;-<span>4</span><br>window &lt;- <span>0</span> <span>#using a more stringent window for the anlysis. </span><br>gene_start&lt;-<span>120415550</span><span>#119494395#</span><br>gene_end&lt;-<span>120550146</span><span>#119628991#</span><br>chrpos &lt;- paste0(chr, <span>":"</span>, gene_start - window, <span>"-"</span>, gene_end + window)<br></code></pre><p data-tool="mdnice编辑器">获取PDE5的eqtl数据：</p><pre data-tool="mdnice编辑器"><span></span><code>eqtl&lt;-extract_instruments(<span>'eqtl-a-ENSG00000138735'</span> ,clump = <span>F</span>)<br>eqtl&lt;-eqtl$SNP[eqtl$pval.exposure&lt; <span>5</span>*<span>10</span>^-<span>8</span> &amp; eqtl$pos.exposure&gt;gene_start-window &amp; eqtl$pos.exposure&lt;gene_end+window &amp; eqtl$chr.exposure==chr]<br></code></pre><pre data-tool="mdnice编辑器"><span></span><code>misssense&lt;-c(<span>"rs3733526"</span>,<span>"rs139979143"</span>, <span>"rs114886951"</span>,<span>"rs149385790"</span>) <span>#missesnse varailbes</span><br></code></pre><p data-tool="mdnice编辑器">获取收缩压数据：</p><pre data-tool="mdnice编辑器"><span></span><code>exp_dsbp&lt;- extract_outcome_data(c(eqtl,misssense),  <br>                                c(<span>"ieu-b-39"</span>), <br>                                proxies = <span>F</span>, <br>                                rsq = <span>0.8</span>, <br>                                align_alleles = <span>1</span>,  <br>                                palindromes = <span>1</span>, <br>                                maf_threshold = <span>0.3</span>, <br>                                access_token = ieugwasr::check_access_token(),<br>                                splitsize = <span>10000</span>, <br>                                proxy_splitsize = <span>500</span>)<br></code></pre><p data-tool="mdnice编辑器">在线clump：</p><pre data-tool="mdnice编辑器"><span></span><code>exp_dsbp&lt;-convert_outcome_to_exposure(exp_dsbp)<br>exp_dsbp&lt;-clump_data(exp_dsbp,clump_r2 = <span>0.35</span>, clump_kb = <span>10000</span>)<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100036686" data-ratio="0.1537037037037037" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicTyibrkLLK1nzxVgDQficAI2AtMv6WJBHnekp8IEibeYx7TKKtu5WkabsicnnG0KrB6V2qialZW1AibZxA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicTyibrkLLK1nzxVgDQficAI2AtMv6WJBHnekp8IEibeYx7TKKtu5WkabsicnnG0KrB6V2qialZW1AibZxA/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器">可以发现这里的snp其实和文献中的并不完全重合，反而和之前俺用本地clump复现的结果一致，除了beta值的正负恰好相反（……）</p><blockquote data-tool="mdnice编辑器"><span></span><p>向作者请教以后，作者给的答复如下</p><figure><img data-imgfileid="100036684" data-ratio="0.3296296296296296" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicTyibrkLLK1nzxVgDQficAI2ZAjgCibMO6l6rwREicgB6piczreKTrx7dlgpf5eAyiat1hsFGp5ibtReU5g/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicTyibrkLLK1nzxVgDQficAI2ZAjgCibMO6l6rwREicgB6piczreKTrx7dlgpf5eAyiat1hsFGp5ibtReU5g/640?wx_fmt=png&amp;from=appmsg"></figure><p>所以还是可能与clump的方法有关，本地和在线竟然差这么大！</p></blockquote><p data-tool="mdnice编辑器">但为了尽量重复原文结果，我们还是用文献中的5个snp接着分析——</p><pre data-tool="mdnice编辑器"><span></span><code>exp_dsbp&lt;- extract_outcome_data(c(<span>"rs80223330"</span>, <span>"rs12646525"</span>, <span>"rs17355550"</span>, <span>"rs10050092"</span>,  <span>"rs66887589"</span>),   c(<span>"ieu-b-39"</span>), proxies = <span>F</span>, rsq = <span>0.8</span>,  align_alleles = <span>1</span>,  palindromes = <span>1</span>,  maf_threshold = <span>0.3</span>,  access_token = ieugwasr::check_access_token(),splitsize = <span>10000</span>,  proxy_splitsize = <span>500</span>)<br>exp&lt;-convert_outcome_to_exposure(exp_dsbp)<br></code></pre><p data-tool="mdnice编辑器">然后来看看困扰小编很久的S table1是如何实现的：</p><pre data-tool="mdnice编辑器"><span></span><code>ED&lt;- extract_outcome_data(exp$SNP,   c(<span>"ebi-a-GCST006956"</span>,<span>"finn-b-I9_HYPTENSPUL"</span>,<span>"finn-b-ERECTILE_DYSFUNCTION"</span>), proxies = <span>F</span>, rsq = <span>0.8</span>,  align_alleles = <span>1</span>,  palindromes = <span>1</span>,  maf_threshold = <span>0.3</span>,  access_token = ieugwasr::check_access_token(),splitsize = <span>10000</span>,  proxy_splitsize = <span>500</span>)<br></code></pre><p data-tool="mdnice编辑器">接着还是平平无奇的harmonise</p><pre data-tool="mdnice编辑器"><span></span><code>dat &lt;- harmonise_data(exp, ED, action = <span>2</span>)<br></code></pre><p data-tool="mdnice编辑器">重头戏在这里：</p><pre data-tool="mdnice编辑器"><span></span><code><span>for</span> (i <span>in</span> dat$SNP[dat$outcome.deprecated==<span>"Erectile dysfunction ||  || "</span>&amp;dat$id.exposure==<span>"ieu-b-39"</span>&amp;dat$id.outcome==<span>"finn-b-ERECTILE_DYSFUNCTION"</span>]){<br>  mED&lt;-meta::metagen(TE=dat$beta.outcome[dat$SNP==i&amp;dat$outcome.deprecated==<span>"Erectile dysfunction ||  || "</span>&amp;dat$id.exposure==<span>"ieu-b-39"</span>],seTE=dat$se.outcome[dat$SNP==i&amp;dat$outcome.deprecated==<span>"Erectile dysfunction ||  || "</span>&amp;dat$id.exposure==<span>"ieu-b-39"</span>])<br>  dat$beta.outcome[dat$SNP==i&amp;dat$outcome.deprecated==<span>"Erectile dysfunction ||  || "</span>&amp;dat$id.exposure==<span>"ieu-b-39"</span>&amp;dat$id.outcome==<span>"ebi-a-GCST006956"</span>]&lt;-mED$TE.fixed<br>  dat$beta.outcome[dat$SNP==i&amp;dat$outcome.deprecated==<span>"Erectile dysfunction ||  || "</span>&amp;dat$id.exposure==<span>"ieu-b-39"</span>&amp;dat$id.outcome==<span>"finn-b-ERECTILE_DYSFUNCTION"</span>]&lt;-<span>NA</span><br>  dat$se.outcome[dat$SNP==i&amp;dat$outcome.deprecated==<span>"Erectile dysfunction ||  || "</span>&amp;dat$id.exposure==<span>"ieu-b-39"</span>&amp;dat$id.outcome==<span>"ebi-a-GCST006956"</span>]&lt;-mED$seTE.fixed<br>  dat$se.outcome[dat$SNP==i&amp;dat$outcome.deprecated==<span>"Erectile dysfunction ||  || "</span>&amp;dat$id.exposure==<span>"ieu-b-39"</span>&amp;dat$id.outcome==<span>"finn-b-ERECTILE_DYSFUNCTION"</span>]&lt;-<span>NA</span><br>}<br><br><br>dat&lt;-dat[!is.na(dat$beta.outcome),]<br><br><span>for</span> (i <span>in</span> c(<span>"ebi-a-GCST006956"</span>,<span>"finn-b-I9_HYPTENSPUL"</span> )){<span>#"finn-b-ERECTILE_DYSFUNCTION"</span><br> <span>for</span> (j <span>in</span> c(<span>"ieu-b-39"</span>)){<span>#,"ieu-b-38"</span><br>    <br>    <br>    print(j)<br>    print(i)  <br>    <br>    IVW&lt;-IVWcorrel(   <br>      betaYG=dat$beta.outcome[dat$id.exposure==j&amp;dat$id.outcome==i],<br>      sebetaYG=dat$se.outcome[dat$id.exposure==j&amp;dat$id.outcome==i],<br>      betaXG=dat$beta.exposure[dat$id.exposure==j&amp;dat$id.outcome==i],<br>      sebetaXG=dat$se.exposure[dat$id.exposure==j&amp;dat$id.outcome==i],<br>      rho=matrix[dat$SNP[dat$id.exposure==j&amp;dat$id.outcome==i],dat$SNP[dat$id.exposure==j&amp;dat$id.outcome==i]]<br>    )<br>    print(IVW)<br>  }}<br></code></pre><blockquote data-tool="mdnice编辑器"><span></span><pre><span></span><code>[1] <span>"ieu-b-39"</span><br>[1] <span>"ebi-a-GCST006956"</span><br>     beta_IVWcorrel se_IVWcorrel.random p_IVWcorrel.random n_snp   F_stat<br>[1,]      0.1276879          0.05520846         0.02073184     5 25.58036<br>[1] <span>"ieu-b-39"</span><br>[1] <span>"finn-b-I9_HYPTENSPUL"</span><br>     beta_IVWcorrel se_IVWcorrel.random p_IVWcorrel.random n_snp   F_stat<br>[1,]       3.293556           0.5730375       9.055132e-09     5 25.58036<br></code></pre></blockquote><figure data-tool="mdnice编辑器"><img data-imgfileid="100036685" data-ratio="0.21388888888888888" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicTyibrkLLK1nzxVgDQficAI2juzMoHEG3Q6OUaWlLbIYERFU2ccvEczcMIa6KtrxDtHkdgVQP40eLQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicTyibrkLLK1nzxVgDQficAI2juzMoHEG3Q6OUaWlLbIYERFU2ccvEczcMIa6KtrxDtHkdgVQP40eLQ/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器">努力破禁锢，下周继续~</p></section><p><br></p><p><mp-style-type data-value="10000"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/q8qMdNFtMwbVrUzmcLuZiQ",target="_blank" rel="noopener noreferrer">原文链接</a>
