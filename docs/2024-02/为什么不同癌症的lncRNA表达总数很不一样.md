---
title: "为什么不同癌症的lncRNA表达总数很不一样"
date: 2024-02-23T09:13:50Z
draft: ["false"]
tags: [
  "fetched",
  "生信技能树"
]
categories: ["Acdemic"]
---
为什么不同癌症的lncRNA表达总数很不一样 by 生信技能树
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><blockquote data-tool="mdnice编辑器"><p>在前面的教程：<a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247506519&amp;idx=1&amp;sn=4ad9c8bc26c86eafcdaf4bcdc60e9439&amp;scene=21#wechat_redirect" data-linktype="2">居然有如此多种癌症（是时候开启pan-cancer数据挖掘模式）</a>，我们把全部的TCGA的33种癌症的表达量矩阵区拆分成为蛋白编码基因和非编码基因这两个不同的表达量矩阵，并且保存成为了rdata文件。</p></blockquote><p data-tool="mdnice编辑器">在不同癌症里面，蛋白质编码相关基因数量一直在一万八附近，而非编码基因数量跨度比较大，从一万二到两万七不等。因为非编码基因的组织病人特异性都很强，恰好最近看到了一个很有意思图可以说明这件事，如下所示：</p><p><img data-ratio="0.5515625" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/cZNhZQ6j4wwr7ibJNjIJ2kYZrTQpJib2U52zq7T6bmFlfE589vblicARtEs5T55jFCIgAptHTrA9rlLgYOBlksmlQ/640?wx_fmt=jpeg" data-type="jpeg" data-w="1280" src="https://mmbiz.qpic.cn/mmbiz_jpg/cZNhZQ6j4wwr7ibJNjIJ2kYZrTQpJib2U52zq7T6bmFlfE589vblicARtEs5T55jFCIgAptHTrA9rlLgYOBlksmlQ/640?wx_fmt=jpeg"></p><figure data-tool="mdnice编辑器"><figcaption> </figcaption></figure><p data-tool="mdnice编辑器">这个图来源于文献：《Transcriptional landscape and clinical utility of enhancer RNAs for eRNA-targeted therapy in cance》，作者展现的是Enhancer RNA (eRNA) 的癌症特异性很强，其实eRNA就是非编码基因的一种。根据特异性可以分成成为3种：</p><ul data-tool="mdnice编辑器"><li><section>652 ubiquitous eRNAs expressed in ≥10 cancer types,</section></li><li><section>3124 intermediately specific eRNAs that are expressed in 2–9 cancer types,</section></li><li><section>5332 cancer- type-specific eRNAs that are expressed in only one cancer type</section></li></ul><p data-tool="mdnice编辑器">接下来我们就针对格式化好的非编码基因的表达量矩阵，进行如下所示的图表绘制！</p><h3 data-tool="mdnice编辑器"><span></span>step1: 批量读取前面的Rdata<span></span></h3><pre data-tool="mdnice编辑器"><span></span><code>rm(list=ls())<br>options(stringsAsFactors = <span>F</span>)<br><span>library</span>(stringr)  <br><span>library</span>(data.table)  <br><br><span>###### step1: 批量读取前面的Rdata  ###### </span><br><br>fs=list.files(<span>'Rdata/'</span>,<br>              pattern = <span>'htseq_counts'</span>)<br>fs<br><span># 首先加载每个癌症的表达量矩阵（提取非蛋白编码基因部分）</span><br><span># 成为一个 list </span><br>dat_list = lapply(fs, <span>function</span>(x){<br>  <span># x=fs[1]</span><br>  pro=gsub(<span>'.htseq_counts..Rdata'</span>,<span>''</span>,x)<br>  print(pro)<br>  <br>  load(file =  file.path(<span>'Rdata/'</span>,x)) <br>  <br>  dat=log2(edgeR::cpm(non_mat)+<span>1</span>)<br>  dat[<span>1</span>:<span>4</span>,<span>1</span>:<span>4</span>]<br>  <span>return</span>(dat)<br>})<br></code></pre><h3 data-tool="mdnice编辑器"><span></span>step2: 区分基因<span></span></h3><pre data-tool="mdnice编辑器"><span></span><code><br><span>###### step2: 区分基因  ###### </span><br>tmp=table(unlist(lapply(dat_list, rownames)))<br>all_genes=names(tmp) <span>#[tmp==33]</span><br>length(all_genes)<br>ubiquitous_genes=names(tmp)[tmp==<span>33</span>]<br>length(ubiquitous_genes)<br>specific_genes =names(tmp)[tmp==<span>1</span>]<br>length(specific_genes)<br>intermediately_genes=setdiff(setdiff(all_genes,specific_genes),ubiquitous_genes)<br><br><span># 在33个癌症都存在的非编码基因不到九千个</span><br><span># 但是33个癌症总共涉及到31455个非编码基因</span><br><span># 独特存在于33种癌症的仅仅是一个里面的是 2236个基因。</span><br></code></pre><p data-tool="mdnice编辑器">在33个癌症都存在的非编码基因不到九千个，但是33个癌症总共涉及到31455个非编码基因。独特存在于33种癌症的仅仅是一个里面的是 2236个基因。</p><h3 data-tool="mdnice编辑器"><span></span>step3: 计算各个基因在各个癌症的均值<span></span></h3><pre data-tool="mdnice编辑器"><span></span><code><br><span># 但是突然间发现，下面的代码难度更高了：</span><br>sm = do.call(cbind,<br>        lapply(dat_list, <span>function</span>(x){<br>          m=rowMeans(x)<br>          ubiquitous_m=rep(<span>0</span>,length(ubiquitous_genes))<br>          specific_m=rep(<span>0</span>,length(specific_genes))<br>          intermediately_m=rep(<span>0</span>,length(intermediately_genes))<br>          <br>          cg=intersect(names(m),ubiquitous_genes)<br>          ubiquitous_m[match(cg,ubiquitous_genes)]=m[match(cg,names(m))]<br>          cg=intersect(names(m),specific_genes)<br>          specific_m[match(cg,specific_genes)]=m[match(cg,names(m))]<br>          cg=intersect(names(m),intermediately_genes)<br>          intermediately_m[match(cg,intermediately_genes)]=m[match(cg,names(m))]<br>           <br>          <span>return</span>(c(ubiquitous_m,intermediately_m,specific_m))<br>          })) <br>colnames(sm)=gsub(<span>'TCGA-'</span>,<span>''</span>,gsub(<span>'.htseq_counts..Rdata'</span>,<span>''</span>,fs))<br>rownames(sm)=c(ubiquitous_genes,intermediately_genes,specific_genes)<br>pheatmap::pheatmap(sm)<br></code></pre><p data-tool="mdnice编辑器">出丑图如下所示：</p><p><img data-cropselx1="0" data-cropselx2="558" data-cropsely1="0" data-cropsely2="274" data-galleryid="" data-ratio="0.7188405797101449" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wwr7ibJNjIJ2kYZrTQpJib2U5Kek9ibjiaicxicpqDFicv7m0VuRWuzaUgia4TSL9Q2HHm2U8uH2Wiah3Rkibiag/640?wx_fmt=png" data-type="png" data-w="690" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wwr7ibJNjIJ2kYZrTQpJib2U5Kek9ibjiaicxicpqDFicv7m0VuRWuzaUgia4TSL9Q2HHm2U8uH2Wiah3Rkibiag/640?wx_fmt=png"></p><figure data-tool="mdnice编辑器"><figcaption> </figcaption></figure><p data-tool="mdnice编辑器">勉强可以看到 (ubiquitous_genes,intermediately_genes,specific_genes ，下面我们进行初步美化看看：</p><h3 data-tool="mdnice编辑器"><span></span>step4: 美化<span></span></h3><pre data-tool="mdnice编辑器"><span></span><code><br>sm_bak=sm<br>sm=sm_bak<br>sm[sm&gt;<span>6</span>]=<span>6</span><br><br>df1=sm[ubiquitous_genes,]<br>df1=df1[order(rowMeans(df1),decreasing = <span>T</span>),]<br>p1=pheatmap(t(df1), <br>            cluster_rows = <span>F</span>,<br>            cluster_cols = <span>F</span>,<br>            show_rownames = <span>T</span>,<br>            show_colnames = <span>F</span>)<br>p1<br><br><br>df2=sm[intermediately_genes,]<br>n_genes = apply(df2, <span>1</span>, <span>function</span>(x) sum(x&gt;<span>0</span>)) <br>tmp_list= split(names(n_genes),n_genes)<br>lapply(tmp_list, length)<br>ordd=do.call(c,<br>        lapply(tmp_list, <span>function</span>(cg){<br>         <span># cg=tmp_list[[1]]</span><br>          ord=do.call(c,lapply(dat_list, <span>function</span>(x){<br>            cg[cg %<span>in</span>% rownames(x)]<br>          }))<br>          length(ord)<br>          <span>return</span>(unique(ord))<br>        }) )<br>length(ordd)<br>df2=df2[order( n_genes ,ordd,rowMeans(df2),decreasing = <span>T</span>),]<br>p2=pheatmap(t(df2), <br>            cluster_rows = <span>F</span>,<br>            cluster_cols = <span>F</span>,<br>            show_rownames = <span>T</span>,<br>            show_colnames = <span>F</span>)<br>p2<br><br><br>df3=sm[specific_genes,] <br>ord=do.call(c,lapply(dat_list, <span>function</span>(x){<br>  specific_genes[specific_genes %<span>in</span>% rownames(x)]<br>}))<br><br>p3=pheatmap(t(df3[ord,]),<br>         cluster_rows = <span>F</span>,<br>         cluster_cols = <span>F</span>,<br>         show_rownames = <span>T</span>,<br>         show_colnames = <span>F</span>)<br>p3<br><br><span>library</span>(cowplot) <br>plot_grid(p1$gtable,<br>          p2$gtable,<br>          p3$gtable,nrow = <span>1</span>,<br>          labels=c(<span>'ubiquitous_genes'</span>,<br>                   <span>'intermediately_genes'</span>,<br>                   <span>'specific_genes'</span>) )<br><br></code></pre><p data-tool="mdnice编辑器">我也说不清楚这个是美化还是丑化了：</p><p><img data-galleryid="" data-ratio="0.49157581764122893" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wwr7ibJNjIJ2kYZrTQpJib2U5oY7v4Dy9XqHLahiaI0YK9oSVq566mxofsJMjtvb6BAQkeG2bJ0Tibjxg/640?wx_fmt=png" data-type="png" data-w="1009" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wwr7ibJNjIJ2kYZrTQpJib2U5oY7v4Dy9XqHLahiaI0YK9oSVq566mxofsJMjtvb6BAQkeG2bJ0Tibjxg/640?wx_fmt=png"></p><figure data-tool="mdnice编辑器"><figcaption> </figcaption></figure><p data-tool="mdnice编辑器">买家秀和卖家秀差距不是一点点啊！</p><h3 data-tool="mdnice编辑器"><span></span>同理可以应用于蛋白编码基因表达量矩阵<span></span></h3><p data-tool="mdnice编辑器">可以看到：</p><pre data-tool="mdnice编辑器"><span></span><code>&gt; length(all_genes)<br>[1] 19302<br>&gt; ubiquitous_genes=names(tmp)[tmp==33]<br>&gt; length(ubiquitous_genes)<br>[1] 16370<br>&gt; specific_genes =names(tmp)[tmp==1]<br>&gt; length(specific_genes)<br>[1] 123<br>&gt; intermediately_genes=setdiff(setdiff(all_genes,specific_genes),ubiquitous_genes)<br>&gt; length(intermediately_genes)<br>[1] 2809<br></code></pre><p data-tool="mdnice编辑器">几乎所有的基因都在全部的癌症内部有表达量，仅仅是123个基因具有癌症特异性，而且它的表达量肯定是超级低！</p><p><img data-galleryid="" data-ratio="0.6703980099502488" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wwr7ibJNjIJ2kYZrTQpJib2U5pybNicLVqPyD90wk6T31hjI1dqbmdxdVLpNqkegNkEqvEnWxrO3eTxQ/640?wx_fmt=png" data-type="png" data-w="804" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wwr7ibJNjIJ2kYZrTQpJib2U5pybNicLVqPyD90wk6T31hjI1dqbmdxdVLpNqkegNkEqvEnWxrO3eTxQ/640?wx_fmt=png"></p><figure data-tool="mdnice编辑器"><figcaption> </figcaption></figure><p data-tool="mdnice编辑器">你能相信它们是蛋白编码基因吗？</p><p data-tool="mdnice编辑器">这123个基因很有意思，或许是一个课题？</p></section></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/tP_hoBtfT3En7TPCgiWXZg",target="_blank" rel="noopener noreferrer">原文链接</a>
