---
title: "【孟德尔随机化】文献复现（北辙南辕？）"
date: 2024-02-07T05:10:05Z
draft: ["false"]
tags: [
  "fetched",
  "生信菜鸟团"
]
categories: ["Acdemic"]
---
【孟德尔随机化】文献复现（北辙南辕？） by 生信菜鸟团
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><p data-tool="mdnice编辑器">前情回顾：<a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzUzMTEwODk0Ng==&amp;mid=2247519864&amp;idx=1&amp;sn=b245d6ad929017786680113346b03073&amp;chksm=fa454b45cd32c2538a75ee0f1721f12615ce257c98f9acf694c3b53aa9298a91c478b61c1657&amp;scene=21#wechat_redirect" textvalue="【孟德尔随机化】文献复现（三）" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2">【孟德尔随机化】文献复现（三）</a>做出了table 1，但是不知道有没有小伙伴发现，我的复现结果中β值和文献结果虽然一样，但是正负有区别。</p><blockquote data-tool="mdnice编辑器"><p>这里我反复检查了我的数据，没有发现问题；也查阅了一些资料，但是没有找到更改正负值的依据，因此在后续的分析中我还是按照我的结果进行了复现，但发现和文献的结果实在是差距很大……</p></blockquote><p data-tool="mdnice编辑器">如果有小伙伴找到了问题的话，欢迎后台留言指正，不胜感激~</p><p data-tool="mdnice编辑器">上周复现了<code>statistical analysis</code>部分的内容 ，这回我们接着往下看<code>Mendelianrandomisation</code>的部分~</p><blockquote data-tool="mdnice编辑器"><p>为了得出 MR 估计值，我们用变异-结果关联除以变异-舒张压关联来估计每个遗传变异的沃尔德比值。</p><p>MR的标准误差按变异-结果关联的标准误差除以变异-表型关联来估算。</p><p>然后使用乘法随机效应模型对每个变异体的 Wald 估计值进行元分析，同时使用与 1000G 小组中欧洲血统参与者相对应的连锁不平衡矩阵作为参考源，以考虑变异体之间的相关性。</p></blockquote><figure data-tool="mdnice编辑器"><img data-imgfileid="100036480" data-ratio="0.1537037037037037" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8Ria2nNePm6FlzjHpoPxkTMe5LzqaUMvnC9x6fwU1TB4EImAvsRRKMlcFVL1v9SDo6JcgRF0EWjWQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8Ria2nNePm6FlzjHpoPxkTMe5LzqaUMvnC9x6fwU1TB4EImAvsRRKMlcFVL1v9SDo6JcgRF0EWjWQ/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器">由于可公开获取的数据只有后代数量这一项，我尝试对这一结果进行复现：</p><ul data-tool="mdnice编辑器"><li><section>number of children fathered：ukb-b-2227——针对男性</section></li><li><section>number of children  birthed：ukb-b-1209——针对女性</section></li></ul><p data-tool="mdnice编辑器">以下是实现过程：</p><pre data-tool="mdnice编辑器"><span></span><code>rm(list = ls())<br>options(timeout = <span>100000000000000</span>)<br><br><span>if</span> (<span>T</span>) {<br>  <span>library</span>(dplyr)<br>  <span>library</span>(tidyr)<br>  <span>library</span>(stringr)<br>  <span>library</span>(tidyverse)<br>  <span>library</span>(data.table)<br>  <span>library</span>(<span>"readxl"</span>)<br>  <span># remotes::install_github('MRCIEU/TwoSampleMR')</span><br>  <span>library</span>(TwoSampleMR)<br>  <span>library</span>(MendelianRandomization)<br>}<br></code></pre><pre data-tool="mdnice编辑器"><span></span><code>IVs &lt;- read.csv(<span>"../Results/table1.csv"</span>,header = <span>T</span>)<br>exp_dat &lt;- format_data(IVs,<br>                       type = <span>"exposure"</span>,<br>                       phenotype_col = <span>"Phenotype"</span>,<br>                       snp_col = <span>"SNP"</span>,<br>                       beta_col = <span>"beta.exposure"</span>,<br>                       se_col = <span>"se.exposure"</span>,<br>                       eaf_col = <span>"eaf.exposure"</span>,<br>                       effect_allele_col = <span>"effect_allele.exposure"</span>,<br>                       other_allele_col = <span>"other_allele.exposure"</span>,<br>                       pval_col = <span>"pval.exposure"</span>,<br>                       chr_col = <span>"chr.exposure"</span>,<br>                       pos_col = <span>"pos.exposure"</span>)<br></code></pre><h2 data-tool="mdnice编辑器"><span></span>Number of children fathered</h2><pre data-tool="mdnice编辑器"><span></span><code><span># Number of children fathered ---------------------------------------------</span><br>out_dat &lt;- read_outcome_data(filename = <span>"../Primary_Outcome/convert_ukb-b-2227.vcf.gz.csv"</span>,<br>                             snps =exp_dat$SNP,<br>                             sep = <span>","</span>,<br>                             phenotype_col = <span>"phenotype"</span>, <span>##要有这一列</span><br>                             snp_col = <span>"SNP"</span>,<br>                             beta_col = <span>"beta"</span>,<br>                             se_col = <span>"se"</span>,<br>                             eaf_col = <span>"eaf"</span>,<br>                             effect_allele_col = <span>"effect allele"</span>,<br>                             other_allele_col = <span>"other allele"</span>,<br>                             pval_col = <span>"pval"</span>)<br><br><span>##读取结局数据</span><br>dat &lt;- harmonise_data(exp_dat, out_dat)<br></code></pre><p data-tool="mdnice编辑器">计算连锁不平衡相关系数：</p><pre data-tool="mdnice编辑器"><span></span><code><span>library</span>(LDlinkR) <span>#加载该R包</span><br>LDinfo &lt;- LDmatrix(snps = dat$SNP, <br>                   pop = <span>"EUR"</span>, r2d = <span>"r2"</span>, <br>                   token = <span>'2de64218213a'</span>, <br>                   file =<span>FALSE</span>)<br>mrinput &lt;- mr_input(bx =dat$beta.exposure, bxse = dat$se.exposure, <br>                    by = dat$beta.outcome, byse= dat$se.outcome,<br>                    correlation =as.matrix(LDinfo[,<span>2</span>:ncol(LDinfo)]), <br>                    exposure = <span>"exposure"</span>, outcome = <span>"outcome"</span>)<br></code></pre><p data-tool="mdnice编辑器">以上两个函数可以用下面的一个函数代替：</p><pre data-tool="mdnice编辑器"><span></span><code>dat2 &lt;- dat_to_MRInput(dat, get_correlation = <span>TRUE</span>)<br></code></pre><p data-tool="mdnice编辑器">如果用最简单的wald方法实现MR分析，就是下面这样：</p><pre data-tool="mdnice编辑器"><span></span><code><span># https://zhuanlan.zhihu.com/p/439005972</span><br>simple &lt;-MendelianRandomization::mr_median(mrinput,weighting = <span>"simple"</span>,<br>                   distribution =<span>"normal"</span>,alpha = <span>0.05</span>,<br>                   iterations = <span>10000</span>,seed = <span>314159265</span>)<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100036481" data-ratio="0.2065677966101695" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8Ria2nNePm6FlzjHpoPxkTMC9ian80jk82m0FlyDKKUj45AsZXIyAmbqIIzUCxyIMRPbsBJYvsHlDA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="944" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8Ria2nNePm6FlzjHpoPxkTMC9ian80jk82m0FlyDKKUj45AsZXIyAmbqIIzUCxyIMRPbsBJYvsHlDA/640?wx_fmt=png&amp;from=appmsg"><figcaption><br></figcaption></figure><p data-tool="mdnice编辑器">这一步其实还是有些疑问，<strong>文章中提到用乘法随机效应模型对wald估计值进行meta分析【这里引用了另一篇文献的方法，但我在这篇文献中并未找到相关描述】</strong>，所以我用了最简单的wald法试了一下⬆</p><h2 data-tool="mdnice编辑器"><span></span>Number of live births</h2><p data-tool="mdnice编辑器">过程同上~<img data-imgfileid="100036482" data-ratio="0.21035940803382663" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8Ria2nNePm6FlzjHpoPxkTMFGiagutxPr3K57OJKzH1OuqCQbVhh7aDJnz1A7wO6ZichiccJ438bEhFQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="946" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8Ria2nNePm6FlzjHpoPxkTMFGiagutxPr3K57OJKzH1OuqCQbVhh7aDJnz1A7wO6ZichiccJ438bEhFQ/640?wx_fmt=png&amp;from=appmsg"></p><p data-tool="mdnice编辑器">再试试用最常规的mr方法呢</p><pre data-tool="mdnice编辑器"><span></span><code>res &lt;- mr(dat)<br>mrdat &lt;-generate_odds_ratios(res)<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100036478" data-ratio="0.14477766287487073" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8Ria2nNePm6FlzjHpoPxkTMuvjtEBaLdpzyPETDx6nHLIPQjRof0EM43DvKgvpmX0XFgYGbHqG6IQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="967" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8Ria2nNePm6FlzjHpoPxkTMuvjtEBaLdpzyPETDx6nHLIPQjRof0EM43DvKgvpmX0XFgYGbHqG6IQ/640?wx_fmt=png&amp;from=appmsg"></figure><blockquote data-tool="mdnice编辑器"><p>为了促进我们的Mendelian Randomization结果的临床解释和情境化，我们将估计值进行了缩放，以表示西地那非（sildenafil）100毫克剂量对舒张压的降低效应（即，主要的Mendelian Randomization估计值以通过遗传代理的PDE5抑制导致的舒张压降低5.5毫米汞柱为基础）。</p></blockquote><p data-tool="mdnice编辑器">所以这样的结果可以这么理解：<span>西地那非导致舒张压每降低5.5毫米汞柱，后代数量将会相应增加</span>。</p><figure data-tool="mdnice编辑器"><img data-imgfileid="100036479" data-ratio="0.15669205658324264" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8Ria2nNePm6FlzjHpoPxkTMXlz2Zhqweqbxia4RPkKjSs3XDhkkm0vJnIPqEaEO2iaPGoGynsHlALmw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="919" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8Ria2nNePm6FlzjHpoPxkTMXlz2Zhqweqbxia4RPkKjSs3XDhkkm0vJnIPqEaEO2iaPGoGynsHlALmw/640?wx_fmt=png&amp;from=appmsg"></figure></section><p><br></p><p><mp-style-type data-value="10000"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/5P5NqUT5dG_Qbl0Dzh7JqA",target="_blank" rel="noopener noreferrer">原文链接</a>
