---
title: "ggh4x 部分实用功能分享"
date: 2024-02-08T02:32:50Z
draft: ["false"]
tags: [
  "fetched",
  "老俊俊的生信笔记"
]
categories: ["Acdemic"]
---
ggh4x 部分实用功能分享 by 老俊俊的生信笔记
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-mpa-powered-by="yiban.io"><h4 data-tool="mdnice编辑器"><span></span></h4><section><mp-common-profile data-pluginname="mpprofile" data-id="MzkyMTI1MTYxNA==" data-headimg="http://mmbiz.qpic.cn/mmbiz_png/G5jjcE4usey42oX5qyLTVibLRO9dz8ic5G4TpEHQc9rICYlpS4MHg6Et8cgXrQDqibvibXombicTro8t9cekJRlDBcw/0?wx_fmt=png" data-nickname="老俊俊的生信笔记" data-alias="JunJunLab" data-signature="老俊俊的生信技能和知识分享,我不是巨人,但你可以站在我的肩膀上更进一步!" data-from="0" data-is_biz_ban="0"></mp-common-profile></section></section><section><qqmusic musicid="106708125" mid="000Zbl1S04Xq3s" albumurl="https://y.gtimg.cn/music/photo_new/T002R68x68M000000ndvXv1aYZnt.jpg" audiourl="http://isure6.stream.qqmusic.qq.com/C200004PKwqT2u0rtC.m4a?guid=2000000052&amp;vkey=E7446E4C8393F949325A366CAAB3603B958A3949C131F223927D340EA771C69E44FB7F2B7D2382D2484C73AD40A13A29ACA3C533BC78DEE6&amp;uin=0&amp;fromtag=20052" music_name="空白格" singer="杨宗纬 - 空白格" play_length="218" src="/mp/readtemplate?t=app_editor/music&amp;singer=%E6%9D%A8%E5%AE%97%E7%BA%AC%20-%20%E7%A9%BA%E7%99%BD%E6%A0%BC&amp;music_name=%E7%A9%BA%E7%99%BD%E6%A0%BC&amp;albumurl=https%3A%2F%2Fy.gtimg.cn%2Fmusic%2Fphoto_new%2FT002R68x68M000000ndvXv1aYZnt.jpg&amp;musictype=1" musictype="1" otherid="000Zbl1S04Xq3s" albumid="000ndvXv1aYZnt" jumpurlkey="" data-pluginname="insertaudio"></qqmusic></section><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><h4 data-tool="mdnice编辑器"><span></span></h4><h2 data-tool="mdnice编辑器"><span><span>1</span></span><span>引言</span><span></span></h2><blockquote data-tool="mdnice编辑器"><p><strong>ggh4x</strong> 是一个非常优秀且功能丰富的 R 包,对 ggplot 拓展了不少实用的功能。这里介绍一些也许会用到的,具体使用见官方使用手册。</p></blockquote><h2 data-tool="mdnice编辑器"><span><span>2</span></span><span>介绍</span><span></span></h2><p data-tool="mdnice编辑器">映射多个颜色标度:</p><pre data-tool="mdnice编辑器"><span></span><code><span>library</span>(ggh4x)<br><br><span># Separating layers by species and declaring (yet) unknown aesthetics</span><br>g &lt;- ggplot(iris, aes(Sepal.Width, Sepal.Length)) +<br>  geom_point(aes(swidth = Sepal.Width),<br>             data = ~ subset(., Species == <span>"setosa"</span>)) +<br>  geom_point(aes(pleng = Petal.Length),<br>             data = ~ subset(., Species == <span>"versicolor"</span>)) +<br>  geom_point(aes(pwidth = Petal.Width),<br>             data = ~ subset(., Species == <span>"virginica"</span>)) +<br>  facet_wrap(~ Species, scales = <span>"free_x"</span>)<br><span>#&gt; Warning in geom_point(aes(swidth = Sepal.Width), data = ~subset(., Species == :</span><br><span>#&gt; Ignoring unknown aesthetics: swidth</span><br><span>#&gt; Warning in geom_point(aes(pleng = Petal.Length), data = ~subset(., Species == :</span><br><span>#&gt; Ignoring unknown aesthetics: pleng</span><br><span>#&gt; Warning in geom_point(aes(pwidth = Petal.Width), data = ~subset(., Species == :</span><br><span>#&gt; Ignoring unknown aesthetics: pwidth</span><br><br><span># This generated quite some warnings, but this is no reason to worry!</span><br><br>g + scale_colour_multi(<br>  aesthetics = c(<span>"swidth"</span>, <span>"pleng"</span>, <span>"pwidth"</span>),<br>  <span># Providing colours as a list distributes list-elements over different scales</span><br>  colours = list(c(<span>"black"</span>, <span>"green"</span>),<br>                 c(<span>"gray"</span>,  <span>"red"</span>),<br>                 c(<span>"white"</span>, <span>"blue"</span>)),<br>  guide = list(guide_colourbar(barheight = unit(<span>35</span>, <span>"pt"</span>)))<br>)<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.7358024691358025" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usez8y4ib7Vomvibd8OzD7ibJld5gVxYfzmuGz8u9kT8PfFtyicWnHNricHlx4yjoc1gHvrlUDNXzwETKlOA/640?wx_fmt=png" data-type="png" data-w="810" src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usez8y4ib7Vomvibd8OzD7ibJld5gVxYfzmuGz8u9kT8PfFtyicWnHNricHlx4yjoc1gHvrlUDNXzwETKlOA/640?wx_fmt=png"></figure><hr data-tool="mdnice编辑器"><p data-tool="mdnice编辑器">把图例换成文字:</p><pre data-tool="mdnice编辑器"><span></span><code>p1 &lt;- ggplot(diamonds, aes(price, carat, colour = clarity)) +<br>  geom_point() +<br>  scale_colour_brewer(palette = <span>"Dark2"</span>)<br><br>p2 &lt;- ggplot(diamonds, aes(price, carat, colour = clarity)) +<br>  geom_point(shape = <span>"."</span>) +<br>  scale_colour_brewer(palette = <span>"Dark2"</span>, guide = <span>"stringlegend"</span>)<br><br>p1 + p2<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.7302955665024631" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usez8y4ib7Vomvibd8OzD7ibJld5KaFuorMf8nfHkTgKMkYC67k10TeGl7IBIjoNJ6ib6XQvBW7wtZEVnLw/640?wx_fmt=png" data-type="png" data-w="812" src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usez8y4ib7Vomvibd8OzD7ibJld5KaFuorMf8nfHkTgKMkYC67k10TeGl7IBIjoNJ6ib6XQvBW7wtZEVnLw/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">调整细节:</p><pre data-tool="mdnice编辑器"><span></span><code>p &lt;- ggplot(mpg, aes(displ, hwy)) +<br>  geom_point(aes(colour = class))<br><br>p2 &lt;- p + guides(colour = guide_stringlegend(face = <span>"bold"</span>, spacing = <span>15</span>))<br><br>p3 &lt;- p + guides(colour = guide_stringlegend(spacing.x = <span>0</span>, spacing.y = <span>5</span>,<br>                                       family = <span>"mono"</span>, ncol = <span>2</span>))<br><br>p2 + p3<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.5534591194968553" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usez8y4ib7Vomvibd8OzD7ibJld5yChibyYjE5ibDEiccvc66EprpUz0HwaOAqJRO0MwShCiazkI9bprEjWyZg/640?wx_fmt=png" data-type="png" data-w="795" src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usez8y4ib7Vomvibd8OzD7ibJld5yChibyYjE5ibDEiccvc66EprpUz0HwaOAqJRO0MwShCiazkI9bprEjWyZg/640?wx_fmt=png"></figure><hr data-tool="mdnice编辑器"><p data-tool="mdnice编辑器">给点之间添加线段:</p><pre data-tool="mdnice编辑器"><span></span><code>set.seed(<span>0</span>)<br>df &lt;- data.frame(<br>  x = <span>1</span>:<span>10</span>,<br>  y = cumsum(rnorm(<span>10</span>))<br>)<br><br>p &lt;- ggplot(pressure, aes(temperature, pressure)) +<br>  geom_pointpath()<br><br>p + theme(aspect.ratio = <span>0.5</span>)<br>p + theme(aspect.ratio = <span>2</span>)<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.7670196671709532" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usez8y4ib7Vomvibd8OzD7ibJld5dhibeGzCwX4Hgny4iaN76ZIfHibf4UAOcmnOB8jwOaaNn7Bico16JzXYQA/640?wx_fmt=png" data-type="png" data-w="661" src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usez8y4ib7Vomvibd8OzD7ibJld5dhibeGzCwX4Hgny4iaN76ZIfHibf4UAOcmnOB8jwOaaNn7Bico16JzXYQA/640?wx_fmt=png"></figure><hr data-tool="mdnice编辑器"><p data-tool="mdnice编辑器">内部坐标轴:</p><pre data-tool="mdnice编辑器"><span></span><code>p &lt;- ggplot(mpg, aes(displ - mean(displ), hwy - mean(hwy))) +<br>  geom_point() +<br>  theme(axis.line = element_line())<br><br>p + coord_axes_inside()<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="1.1263020833333333" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usez8y4ib7Vomvibd8OzD7ibJld5wzHPfOdNlMuWVsZkSUZarKfbA8tkVRV5kiamxk2q04Yia9acFp8ViaREQ/640?wx_fmt=png" data-type="png" data-w="768" src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usez8y4ib7Vomvibd8OzD7ibJld5wzHPfOdNlMuWVsZkSUZarKfbA8tkVRV5kiamxk2q04Yia9acFp8ViaREQ/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">在内部显示刻度:</p><pre data-tool="mdnice编辑器"><span></span><code>p + coord_axes_inside(labels_inside = <span>TRUE</span>) +<br>  scale_x_continuous(<br>    labels = ~ ifelse(.x == <span>0</span>, <span>""</span>, .x),<br>    guide  = <span>"axis_minor"</span><br>  ) +<br>  scale_y_continuous(<br>    labels = ~ ifelse(.x == <span>0</span>, <span>""</span>, .x),<br>    guide  = <span>"axis_truncated"</span><br>  )<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="1.1263020833333333" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usez8y4ib7Vomvibd8OzD7ibJld5fOR9CxRZDD82ny8U37onEAemEaJtAJQ1uqoXWEkpxwoYG7GXA5ZpTQ/640?wx_fmt=png" data-type="png" data-w="768" src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usez8y4ib7Vomvibd8OzD7ibJld5fOR9CxRZDD82ny8U37onEAemEaJtAJQ1uqoXWEkpxwoYG7GXA5ZpTQ/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">这个你也可以看看 <a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247508952&amp;idx=1&amp;sn=32b0f917e455a5d4b3f6d41043699bb8&amp;chksm=c18499a9f6f310bf7c6ed3099886e05bcae4de735eb016799a256e916bc4adaff2aaf08eeb06&amp;token=948441875&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">geom_cross_axis 绘制交叉坐标轴</a>。</p><hr data-tool="mdnice编辑器"><p data-tool="mdnice编辑器">文字旋转:</p><pre data-tool="mdnice编辑器"><span></span><code>ggplot(mpg, aes(factor(<span>1</span>), fill = class)) +<br>  geom_bar(show.legend = <span>FALSE</span>, position = <span>"fill"</span>) +<br>  geom_text_aimed(aes(x = <span>1.2</span>, label = class, group = class),<br>                  position = position_fill(vjust = <span>0.5</span>),<br>                  stat = <span>"count"</span>) +<br>  coord_polar(<span>"y"</span>) +<br>  theme_void()<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="1.1263020833333333" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usez8y4ib7Vomvibd8OzD7ibJld5LCUtcJI30rDB4kJyl2TzJrrnyobW1TzXSEMrhGW90PyRmemLb37kyA/640?wx_fmt=png" data-type="png" data-w="768" src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usez8y4ib7Vomvibd8OzD7ibJld5LCUtcJI30rDB4kJyl2TzJrrnyobW1TzXSEMrhGW90PyRmemLb37kyA/640?wx_fmt=png"></figure><pre data-tool="mdnice编辑器"><span></span><code>ggplot(diamonds, aes(cut, fill = clarity)) +<br>  geom_bar(width = <span>1</span>) +<br>  geom_text_aimed(aes(label = cut, group = cut),<br>                  angle = <span>90</span>,<br>                  stat = <span>"count"</span>, nudge_y = <span>2000</span>) +<br>  scale_x_discrete(labels = <span>NULL</span>) +<br>  coord_polar()<br><span>#&gt; Warning: The following aesthetics were dropped during statistical transformation: fill</span><br><span>#&gt; ℹ This can happen when ggplot fails to infer the correct grouping structure in</span><br><span>#&gt;   the data.</span><br><span>#&gt; ℹ Did you forget to specify a `group` aesthetic or to convert a numerical</span><br><span>#&gt;   variable into a factor?</span><br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="1.1263020833333333" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usez8y4ib7Vomvibd8OzD7ibJld543B9OcibBsccS1ul101ocflFjs8We902iczVlicickO0jt7sVj9seSfiaNw/640?wx_fmt=png" data-type="png" data-w="768" src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usez8y4ib7Vomvibd8OzD7ibJld543B9OcibBsccS1ul101ocflFjs8We902iczVlicickO0jt7sVj9seSfiaNw/640?wx_fmt=png"></figure><h2 data-tool="mdnice编辑器"><span><span>3</span></span><span>结尾</span><span></span></h2><blockquote data-tool="mdnice编辑器"><p><strong>路漫漫其修远兮,吾将上下而求索。</strong></p></blockquote><hr data-tool="mdnice编辑器"><p data-tool="mdnice编辑器">欢迎加入生信交流群。加我微信我也拉你进 <strong>微信群聊</strong> <strong>老俊俊生信交流群</strong> <strong>(微信交流群需收取 20 元入群费用,一旦交费,拒不退还!(防止骗子和便于管理))</strong> 。QQ 群可免费加入, 记得进群按格式修改备注哦。</p><section data-tool="mdnice编辑器"><section><p><strong>老俊俊微信：</strong></p><figure><img data-ratio="1" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usez8y4ib7Vomvibd8OzD7ibJld55GxvTbx18rTzH279MpeTOyPF23okMvGk72Uo2YTRZby6RTV9YskCQQ/640?wx_fmt=png" data-type="png" data-w="430" src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usez8y4ib7Vomvibd8OzD7ibJld55GxvTbx18rTzH279MpeTOyPF23okMvGk72Uo2YTRZby6RTV9YskCQQ/640?wx_fmt=png"></figure><figure><img data-ratio="1.3668430335097002" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usez8y4ib7Vomvibd8OzD7ibJld5Pnt9icNAvHxaRia1MdNsGLfD1IGQPCQ2F7g4RoicRCf2HG6FhgZXgWMBw/640?wx_fmt=png" data-type="png" data-w="567" src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usez8y4ib7Vomvibd8OzD7ibJld5Pnt9icNAvHxaRia1MdNsGLfD1IGQPCQ2F7g4RoicRCf2HG6FhgZXgWMBw/640?wx_fmt=png"></figure></section><section><p><strong>知识星球：</strong></p><figure><img data-ratio="1.5896226415094339" data-src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/G5jjcE4usez8y4ib7Vomvibd8OzD7ibJld56NLLWQjWeyaAzlyUGMQs2rN9B9sjzaySYou0WynOLBIfgDhx1LuumA/640?wx_fmt=jpeg" data-type="jpeg" data-w="1060" src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/G5jjcE4usez8y4ib7Vomvibd8OzD7ibJld56NLLWQjWeyaAzlyUGMQs2rN9B9sjzaySYou0WynOLBIfgDhx1LuumA/640?wx_fmt=jpeg"></figure></section></section><hr data-tool="mdnice编辑器"><p data-tool="mdnice编辑器"><br></p><center data-tool="mdnice编辑器"><strong> 往期回顾目录 </strong></center><p data-tool="mdnice编辑器"><br></p><blockquote data-tool="mdnice编辑器"><p><br></p><center><strong><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247509510&amp;idx=1&amp;sn=5f1f4cb3a3f37abccc19265da77536f9&amp;chksm=c1849c77f6f315618e2029f6837f483948e195489daaec481793cb30891641fa105e6bbbcd19&amp;token=948441875&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">听说你想插入 GO 和 KEGG 图形注释?</a></strong></center><strong><center><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247509499&amp;idx=1&amp;sn=888b0cb8401eb46c1f56c8e90fd2bb81&amp;chksm=c1849f8af6f3169cfaf72e4818cd414375251b0fcf031bc05bda33fc39e7c9bae549cfc1e2bc&amp;token=948441875&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">ClusterGVis 添加自定义图形注释</a></center></strong><strong><center><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247509478&amp;idx=1&amp;sn=71977a66e74d9dc4fa6aa1b2adbc50be&amp;chksm=c1849f97f6f31681543b475f4df381c9e462dfd617260d5fbeb8956731033c97eb4c20a49f9b&amp;token=948441875&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">听说你想绘制 scanpy 的 tracksPlot?</a></center></strong><strong><center><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247509446&amp;idx=1&amp;sn=cd7ba9e8589af745ac1ede9b11812f8b&amp;chksm=c1849fb7f6f316a1c6ce6c8e1e4a9b1e59680cb308e6f26c0ee1d34c567b29eb81b003f6bb8b&amp;token=869651629&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">重复序列元件定量分析</a></center></strong><strong><center><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247509431&amp;idx=1&amp;sn=e629e380c033e68176c60caf8a5d282c&amp;chksm=c1849fc6f6f316d01e726bcb3c4da7760bbea9a1f2c1c8db416524e9871e40a20caff0231023&amp;token=1975028665&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">如何下载重复序列元件的注释信息</a></center></strong><strong><center><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247509411&amp;idx=1&amp;sn=2503a9260b840b0c519db92fe15e270e&amp;chksm=c1849fd2f6f316c468847cd4c434078c83193759a86c87381af0565270cb2054175c68d70a8f&amp;token=1776735002&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">更换 Rstudio 图标</a></center></strong><strong><center><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247509388&amp;idx=1&amp;sn=4cfdcc42b0729397ef63e30637408397&amp;chksm=c1849ffdf6f316ebe38d18bcb62c23732f988f7a6cfc6074ec00585963b62fc604d696095ca8&amp;token=1776735002&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">蛋白亚定位工具集合</a></center></strong><strong><center><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247509377&amp;idx=1&amp;sn=4a98b4f144d9a8a3c45a87cad963db02&amp;chksm=c1849ff0f6f316e6365b3886808eb129a2b36193861f246c0847200c255833cbf1d4ceda8657&amp;token=2015278227&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">aPEAR 优雅的可视化通路富集结果</a></center></strong><strong><center><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247509358&amp;idx=1&amp;sn=66bebbb863b8b802f43f3db73877caca&amp;chksm=c1849f1ff6f31609247f1a4bb6e55f5b67e46bcdd729edb9033eac43d6832e47f169a74862e0&amp;token=1563911021&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">BSgenomeForge 一行代码轻松构建 BSgenome package</a></center></strong><strong><center><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247509312&amp;idx=1&amp;sn=5ab254679b6934cbe6c7a325154e1143&amp;chksm=c1849f31f6f31627cc1148df6eb33e1e757a455c27d4822e864a28987aa2af95e9688b8061fd&amp;token=115754840&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">听说你想画个 monocle3 的拟时序热图?</a></center></strong><p><br></p></blockquote></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/oSX4Xg5QbL2wnE-YZf7HMQ",target="_blank" rel="noopener noreferrer">原文链接</a>
