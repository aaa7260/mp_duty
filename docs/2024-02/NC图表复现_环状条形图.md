---
title: "NC图表复现｜环状条形图"
date: 2024-02-20T17:41:35Z
draft: ["false"]
tags: [
  "fetched",
  "R语言数据分析指南"
]
categories: ["Acdemic"]
---
NC图表复现｜环状条形图 by R语言数据分析指南
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><h3 data-tool="mdnice编辑器"><span></span><span><span></span>欢迎关注R语言数据分析指南</span><span></span></h3><blockquote data-tool="mdnice编辑器"><span>❝</span><p>本节来复现NC上一张环状条图，整个过程仅参考。希望对各位观众老爷能有所帮助。<strong>「数据代码已经整合上传到会员交流群」</strong>，购买过小编VIP的朋友可在所加的会员群内获取下载，有需要的朋友查看文中介绍加入VIP交流群。</p><span>❞</span></blockquote><h3 data-tool="mdnice编辑器"><span></span><span><span></span>原图</span><span></span></h3><figure data-tool="mdnice编辑器"><img data-imgfileid="100025950" data-ratio="0.8562753036437247" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAbTUkI2T969CDAvZ1qujlaab3iaK7UEwiatQbNyMcsDpbrib614CLvzUbJE7zL0uSDB5hibBoSO6xZc0g/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="988" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAbTUkI2T969CDAvZ1qujlaab3iaK7UEwiatQbNyMcsDpbrib614CLvzUbJE7zL0uSDB5hibBoSO6xZc0g/640?wx_fmt=png&amp;from=appmsg"></figure><h3 data-tool="mdnice编辑器"><span></span><span><span></span>论文</span><span></span></h3><figure data-tool="mdnice编辑器"><img data-imgfileid="100025948" data-ratio="0.39537037037037037" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAbTUkI2T969CDAvZ1qujlaatRDDW7dFl5UFstbncMJCFiaVKzHgJYAY50GM85M2A6J5MM1kFHk7bcQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAbTUkI2T969CDAvZ1qujlaatRDDW7dFl5UFstbncMJCFiaVKzHgJYAY50GM85M2A6J5MM1kFHk7bcQ/640?wx_fmt=png&amp;from=appmsg"></figure><h3 data-tool="mdnice编辑器"><span></span><span><span></span>复现结果</span><span></span></h3><figure data-tool="mdnice编辑器"><img data-imgfileid="100025949" data-ratio="0.9574074074074074" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAbTUkI2T969CDAvZ1qujlaaYeibpbzzb0lZOCAmYy1nQPNPh7F8U6T8HtdzkEFseoVn79icjvEkoTDQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAbTUkI2T969CDAvZ1qujlaaYeibpbzzb0lZOCAmYy1nQPNPh7F8U6T8HtdzkEFseoVn79icjvEkoTDQ/640?wx_fmt=png&amp;from=appmsg"></figure><blockquote data-tool="mdnice编辑器"><span>❝</span><p>图例文本部分作者用了多种颜色，有此特殊需求可使用其它工具进行编辑。</p><span>❞</span></blockquote><h3 data-tool="mdnice编辑器"><span></span><span><span></span>关于永久群内容的说明</span><span></span></h3><blockquote data-tool="mdnice编辑器"><span>❝</span><p>给予长期支持我们的忠实读者们一个特别待遇：购买小编2023年VIP会员文档的读者，<strong>「将自动获得2024年及以后更新的绘图文档代码，无需额外付费目前已包含100+学习案例。」</strong>有需要学习数据可视化的朋友，欢迎到小编的<strong>「淘宝店铺」</strong> <strong>「R语言数据分析指南」</strong>下单购买，内容主要包括各种<strong>「高分论文的图表分析复现以及一些个性化图表的绘制」</strong>均包含数据+代码。购买会员文档后微信发小编订单号即邀请进新的会员交流群</p><span>❞</span></blockquote><p data-tool="mdnice编辑器"><strong>「2024更新的绘图内容同时包含数据+代码+markdown注释文档+文档清单」</strong></p><figure data-tool="mdnice编辑器"><img data-imgfileid="100025951" data-ratio="0.6175925925925926" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAbTUkI2T969CDAvZ1qujlaatB9ckvHH0icNCMqhjeN83yHNbCyaBwQ6ZoX5kDjRbT7dkMXKAS0Ag1A/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAbTUkI2T969CDAvZ1qujlaatB9ckvHH0icNCMqhjeN83yHNbCyaBwQ6ZoX5kDjRbT7dkMXKAS0Ag1A/640?wx_fmt=png&amp;from=appmsg"></figure><h3 data-tool="mdnice编辑器"><span></span><span><span></span>淘宝店铺</span><span></span></h3><p><img data-galleryid="" data-imgfileid="100019415" data-ratio="1.0210420841683367" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/EibnicgwScTAbvhPDLGT8NaialEsht92PTYNJWpmVLfoYGic1uha5FyBrDCibibZCLjiazgvpT1XcdwibfVywD2el0VAgg/640?wx_fmt=jpeg" data-type="jpeg" data-w="998" src="https://mmbiz.qpic.cn/mmbiz_jpg/EibnicgwScTAbvhPDLGT8NaialEsht92PTYNJWpmVLfoYGic1uha5FyBrDCibibZCLjiazgvpT1XcdwibfVywD2el0VAgg/640?wx_fmt=jpeg"></p><h3 data-tool="mdnice编辑器"><span></span><span><span></span>加载R包</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code><span>library</span>(tidyverse)<br><span>library</span>(ggtext)<br></code></pre><pre data-tool="mdnice编辑器"><span></span><code>df &lt;- read_tsv(<span>"data.tsv"</span>) %&gt;% <br>  select(geneSymbol,med_LFC,type,id) %&gt;% <br>  mutate(type=case_match(type,<span>"MGT1 high vs low"</span> ~ <span>"MGT#1&lt;sup&gt;-high&lt;/sup&gt; vs MGT#1&lt;sup&gt;-low&lt;/sup&gt;"</span>,<br>                         <span>"MGT4 high vs low"</span> ~ <span>"MGT#4&lt;sup&gt;-high&lt;/sup&gt; vs MGT#4&lt;sup&gt;-low&lt;/sup&gt;"</span>,<br>                         <span>"PNGT3 high vs low"</span> ~ <span>"PNGT#3&lt;sup&gt;-high&lt;/sup&gt; vs PNGT#3&lt;sup&gt;-low&lt;/sup&gt;"</span>,<br>                         .default = type))<br><br>label_data &lt;- adjust_label_angles(df, <span>"id"</span>)<br><br><br>col &lt;- c(<span>"#81A88D"</span>,<span>"#0A9F9D"</span>,<span>"#E6A0C4"</span>)<br><br>ggplot(df) +<br>  geom_bar(aes(x = id, y = med_LFC,fill=type),<br>           stat = <span>"identity"</span>, position = <span>"dodge"</span>,<br>           show.legend = <span>T</span>,alpha = <span>.9</span>,linewidth = <span>0.5</span>) +<br>  coord_polar()+<br>  scale_y_continuous(limits = c(-<span>5</span>,<span>6</span>),expand = c(<span>0</span>,<span>0</span>)) +<br>  geom_point(data=df,aes(x = id, y = med_LFC,size=med_LFC),shape=<span>19</span>,alpha=<span>0.7</span>,show.legend = <span>T</span>)+<br>  geom_text(data=label_data, <br>            aes(x=id, y=med_LFC+<span>0.4</span>, label=geneSymbol, hjust=hjust),<br>            fontface=<span>"bold"</span>,<br>            alpha=<span>1</span>, size=<span>3</span>, angle= label_data$angle, inherit.aes = <span>FALSE</span> )+<br>  scale_x_continuous(expand = c(<span>0</span>,<span>0</span>))+<br>  guides(size=<span>"none"</span>)+<br>  labs( x=<span>NULL</span>,y=<span>NULL</span>) +<br>  theme( panel.background = element_blank(),<br>         plot.background = element_blank(),<br>         axis.text = element_blank(),<br>         legend.text = element_markdown(size = <span>8</span>, face = <span>"bold"</span>),<br>         legend.title=element_blank(),<br>         legend.position = c(<span>0.5</span>,<span>0.5</span>),<br>         panel.grid.major = element_blank(),<br>         panel.grid.minor = element_blank(),<br>         axis.ticks = element_blank(),<br>         plot.margin = margin(<span>0</span>,<span>0</span>,<span>0</span>,<span>0</span>))<br></code></pre></section><section><mp-common-profile data-pluginname="mpprofile" data-id="Mzg3MzQzNTYzMw==" data-headimg="http://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZF0rpeZII9Ltl26VbVagriczTria1fib3XgjwwHEHFjPzkmGpqWDVVHBSzhENictUM2iavAKiaM5lc9USw/0?wx_fmt=png" data-nickname="R语言数据分析指南" data-alias="YanJANtwo" data-signature="R语言重症爱好者，喜欢绘制各种精美的图表，喜欢的小伙伴可以关注我，跟我一起学习" data-from="0" data-is_biz_ban="0"></mp-common-profile></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/98AXY3p3Rik-SqE9tW7ZhQ",target="_blank" rel="noopener noreferrer">原文链接</a>
