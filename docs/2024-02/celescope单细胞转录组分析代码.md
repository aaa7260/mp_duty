---
title: "celescope单细胞转录组分析代码"
date: 2024-02-10T22:58:07Z
draft: ["false"]
tags: [
  "fetched",
  "东林的扯淡小屋"
]
categories: ["Acdemic"]
---
celescope单细胞转录组分析代码 by 东林的扯淡小屋
------
<div><p><br></p><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="sql"><code><span><br></span></code><code><span>cd /data1/yudonglin/scATAC</span></code><code><span><br></span></code><code><span>wget -c https://sra-pub-run-odp.s3.amazonaws.com/sra/SRR12695060/SRR12695060 -O SRR12695060.sra</span></code><code><span>wget -c https://sra-pub-run-odp.s3.amazonaws.com/sra/SRR12695061/SRR12695061 -O SRR12695061.sra</span></code><code><span>wget -c https://sra-pub-run-odp.s3.amazonaws.com/sra/SRR12695062/SRR12695062 -O SRR12695062.sra</span></code><code><span>fastq-dump <span>--split-files --gzip SRR12695060.sra</span></span></code><code><span>fastq-dump <span>--split-files --gzip SRR12695061.sra</span></span></code><code><span>fastq-dump <span>--split-files --gzip SRR12695062.sra</span></span></code><code><span><br></span></code><code><span><br></span></code><code><span>conda activate /home/yudonglin/miniconda3/envs/celescope</span></code><code><span>celescope rna   <span>--help </span></span></code><code><span><br></span></code><code><span>cd /data/yudonglin/reference/singcell</span></code><code><span>mkdir hs_ensembl_99</span></code><code><span>cd hs_ensembl_99</span></code><code><span><br></span></code><code><span>wget ftp://ftp.ensembl.org/pub/<span>release</span><span>-99</span>/fasta/homo_sapiens/dna/Homo_sapiens.GRCh38.dna.primary_assembly.fa.gz</span></code><code><span>wget <span>ftp</span>://ftp.ensembl.org/pub/<span>release</span><span>-99</span>/gtf/homo_sapiens/Homo_sapiens.GRCh38<span>.99</span>.gtf.gz</span></code><code><span><br></span></code><code><span>gunzip Homo_sapiens.GRCh38.dna.primary_assembly.fa.gz</span></code><code><span>gunzip Homo_sapiens.GRCh38<span>.99</span>.gtf.gz</span></code><code><span><br></span></code><code><span>conda <span>activate</span> /home/yudonglin/miniconda3/envs/celescope</span></code><code><span>celescope utils mkgtf Homo_sapiens.GRCh38<span>.99</span>.gtf Homo_sapiens.GRCh38<span>.99</span>.filtered.gtf</span></code><code><span>celescope rna mkref \</span></code><code><span> <span>--genome_name Homo_sapiens_ensembl_99_filtered \</span></span></code><code><span> <span>--fasta Homo_sapiens.GRCh38.dna.primary_assembly.fa \</span></span></code><code><span> <span>--gtf Homo_sapiens.GRCh38.99.filtered.gtf \</span></span></code><code><span> <span>--mt_gene_list mt_gene_list.txt</span></span></code><code><span><br></span></code><code><span><br></span></code><code><span>multi_rna\</span></code><code><span><span>--mapfile ./mapfile \# 提供mapfile文件位置</span></span></code><code><span><span>--genomeDir pathto/genome \ # mkref创建的参考基因组目录(路径)</span></span></code><code><span><span>--thread 4  \# 线程数</span></span></code><code><span><span>--mod  shell \# 生成的脚本类型</span></span></code><code><span><span>--outdir   ./   # 可以指定文件的输出路径</span></span></code><code><span><br></span></code><code><span><span>--mapfile：包含三列, 每列之间用tab分割；每一行是一个样本。</span></span></code><code><span>第一列：fastq前缀</span></code><code><span>第二列：fastq所在文件夹</span></code><code><span>第三列：{<span>sample</span>}（即生成文件的前缀）</span></code><code><span>第四列：可选，期望细胞数</span></code><code><span>vi rna.mapfile</span></code><code><span>SRR12695060  /data1/yudonglin/scATAC/SRR12695060  primary_breast</span></code><code><span>SRR12695061  /data1/yudonglin/scATAC/SRR12695061  positive_lymph_node</span></code><code><span>SRR12695062  /data1/yudonglin/scATAC/SRR12695062  negative_lymph_node</span></code><code><span><br></span></code><code><span><br></span></code><code><span>multi_rna \</span></code><code><span>  <span>--mapfile ./rna.mapfile \</span></span></code><code><span>  <span>--genomeDir /data/yudonglin/reference/singcell/hs_ensembl_99 \</span></span></code><code><span>  <span>--thread 20 \</span></span></code><code><span>  <span>--mod shell</span></span></code><code><span><br></span></code><code><span><br></span></code><code><span>cd /data1/yudonglin/scATAC</span></code><code><span>conda <span>activate</span> /home/yudonglin/miniconda3/envs/celescope</span></code><code><span>sh /data1/yudonglin/scATAC/shell/negative_lymph_node.sh  </span></code><code><span><br></span></code><code><span><br></span></code><code><span>cd /data1/yudonglin/scATAC</span></code><code><span>conda <span>activate</span> /home/yudonglin/miniconda3/envs/celescope</span></code><code><span>sh /data1/yudonglin/scATAC/shell/positive_lymph_node.sh  </span></code><code><span><br></span></code><code><span><br></span></code><code><span>cd /data1/yudonglin/scATAC</span></code><code><span>conda <span>activate</span> /home/yudonglin/miniconda3/envs/celescope</span></code><code><span>sh /data1/yudonglin/scATAC/shell/primary_breast.sh</span></code><code><span><br></span></code><code><span><br></span></code><code><span><br></span></code><code><span><br></span></code><code><span>celescope rna <span>sample</span> <span>--outdir .//primary_breast/00.sample --sample primary_breast --thread 20 --chemistry scopeV1  --fq1 /data1/yudonglin/scATAC/SRR12695060/SRR12695060_1.fastq.gz </span></span></code><code><span>celescope rna prep_map <span>--outdir .//primary_breast/01.prep_map --sample primary_breast --thread 20 --chemistry scopeV1 --lowNum 2 --minimum_length 20 --nextseq_trim 20 --overlap 10 --genomeDir /data/yudonglin/reference/singcell/hs_ensembl_99 --outFilterMatchNmin 50 --outFilterMultimapNmax 1 --starMem 30  --fq1 /data1/yudonglin/scATAC/SRR12695060/SRR12695060_1.fastq.gz --fq2 /data1/yudonglin/scATAC/SRR12695060/SRR12695060_2.fastq.gz </span></span></code><code><span>celescope rna featureCounts <span>--outdir .//primary_breast/02.featureCounts --sample primary_breast --thread 20 --gtf_type gene --genomeDir /data/yudonglin/reference/singcell/hs_ensembl_99  --input .//primary_breast/01.prep_map/primary_breast_Aligned.out.bam </span></span></code><code><span>celescope rna <span>count</span> <span>--outdir .//primary_breast/03.count --sample primary_breast --thread 20 --genomeDir /data/yudonglin/reference/singcell/hs_ensembl_99 --expected_cell_num 3000 --cell_calling_method EmptyDrops_CR  --count_detail .//primary_breast/02.featureCounts/primary_breast_count_detail.txt --force_cell_num None </span></span></code><code><span>celescope rna analysis <span>--outdir .//primary_breast/04.analysis --sample primary_breast --thread 20 --genomeDir /data/yudonglin/reference/singcell/hs_ensembl_99  --matrix_file .//primary_breast/03.count/primary_breast_filtered_feature_bc_matrix</span></span></code><code><span><br></span></code><code><span><br></span></code><code><span><br></span></code></pre></section><p><img data-galleryid="" data-imgfileid="100025329" data-ratio="0.5907407407407408" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBq9WElrnNmwwWKxmVlFicuUqvC8THrOZkaZ7WexicVJtzpncExiaU1QLcp0PFpzuiccibZenQ6hAzgdrCA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBq9WElrnNmwwWKxmVlFicuUqvC8THrOZkaZ7WexicVJtzpncExiaU1QLcp0PFpzuiccibZenQ6hAzgdrCA/640?wx_fmt=png&amp;from=appmsg"></p><p><br></p><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/QSVfjhcVyCmiyyB1pnm7AA",target="_blank" rel="noopener noreferrer">原文链接</a>
