---
title: "NetAct代码实操之单细胞转录因子分析的新时代"
date: 2023-02-13T04:10:07Z
draft: ["false"]
tags: [
  "fetched",
  "生信宝库"
]
categories: ["Acdemic"]
---
NetAct代码实操之单细胞转录因子分析的新时代 by 生信宝库
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><section><mp-common-profile data-pluginname="mpprofile" data-weui-theme="light" data-id="MzI4MjY5ODI1Nw==" data-headimg="http://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7f28iaAPOSZyaVreHSWoQketIFUzNSiayMfvqbyCD0TNcBv06SGnkaO1gXRsN9icoQ23IjMJ5ta3Jia9w/0?wx_fmt=png" data-nickname="生信宝库" data-alias="sxbk2020" data-signature="本公众号只用于生信知识的收集与传播，以及生信人之间互相交流和学习，不会涉及任何商业利益。本公众号各小编平时忙于科研，更新文章较其它同类型公众号较慢，但保持宁缺毋滥的本心，只更新对大家有用的推文。" data-from="0" data-is_biz_ban="0"></mp-common-profile></section><h2 data-tool="mdnice编辑器"><span>前言</span></h2><p data-tool="mdnice编辑器">Immugent在之前的一篇推文；<a href="https://mp.weixin.qq.com/s?__biz=MzI4MjY5ODI1Nw==&amp;mid=2247487261&amp;idx=1&amp;sn=9a74a924c35256d539238642b2b7b379&amp;chksm=eb94b863dce331752aa1856c87d466adb02c00f0f4e0d46d915a9e840bbb89334de7fb55d455&amp;token=704098781&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">NetAct:利用基因活性构建核心转录因子调控网络</a>中，介绍了NetAct的整体框架。<span>简单来说，</span><span>NetAct是一个新的</span><span>转录</span><span>因子分析</span><span>软件</span><span>，其</span><span>使用转录组数据和基于文献的转录因子-靶标数据库来构建核心转录因子调控网络。</span>今天就通过代码实操的方式展示如何使用NetAct来对我们的单细胞数据进行转录因子分析。</p><p data-tool="mdnice编辑器">本篇推文旨在演示NetAct的核心功能的分析流程，以及如何使用它来构建转录因子调控网络并建立模型。该工作流程中使用的实验RNA-seq数据来自Sheridan等人(2015)，由三种细胞群，包含basal细胞、luminal progenitor(LP)和mature luminal(ML)组成，这些细胞群来自雌性未交配小鼠的乳腺。使用GEO系列登录号GSE63310，这些样本的计数数据可以从GEO数据库上下载。</p><p data-tool="mdnice编辑器"><br></p><hr data-tool="mdnice编辑器"><h2 data-tool="mdnice编辑器"><span></span><span>代码实操</span></h2><p data-tool="mdnice编辑器">首先我们需要下载包含每个样本原始基因水平计数的文本文件，示例文件GSE63310_RAW.tar可在http://www.ncbi.nlm.nih.gov/geo/download/?acc=GSE63310&amp;format=file上下载。</p><pre data-tool="mdnice编辑器"><code>library(NetAct)<br><br>url &lt;- <span>"https://www.ncbi.nlm.nih.gov/geo/download/?acc=GSE63310&amp;format=file"</span><br>utils::download.file(url, destfile=<span>"GSE63310_RAW.tar"</span>, mode=<span>"wb"</span>) <br>utils::untar(<span>"GSE63310_RAW.tar"</span>, exdir = <span>"."</span>)<br>files &lt;- c(<span>"GSM1545535_10_6_5_11.txt"</span>, <span>"GSM1545536_9_6_5_11.txt"</span>, <span>"GSM1545538_purep53.txt"</span>,<br>           <span>"GSM1545539_JMS8-2.txt"</span>, <span>"GSM1545540_JMS8-3.txt"</span>, <span>"GSM1545541_JMS8-4.txt"</span>,<br>           <span>"GSM1545542_JMS8-5.txt"</span>, <span>"GSM1545544_JMS9-P7c.txt"</span>, <span>"GSM1545545_JMS9-P8c.txt"</span>)<br><span>for</span>(i <span>in</span> paste(files, <span>".gz"</span>, sep=<span>""</span>)){<br>  R.utils::gunzip(i, overwrite=TRUE)<br>}<br><br>files &lt;- c(<span>"GSM1545535_10_6_5_11.txt"</span>, <span>"GSM1545536_9_6_5_11.txt"</span>, <br>           <span>"GSM1545538_purep53.txt"</span>, <span>"GSM1545539_JMS8-2.txt"</span>, <br>           <span>"GSM1545540_JMS8-3.txt"</span>, <span>"GSM1545541_JMS8-4.txt"</span>, <br>           <span>"GSM1545542_JMS8-5.txt"</span>, <span>"GSM1545544_JMS9-P7c.txt"</span>, <br>           <span>"GSM1545545_JMS9-P8c.txt"</span>)<br><br>x &lt;- edgeR::readDGE(files, columns=c(1,3))<br>group &lt;- as.factor(c(<span>"LP"</span>, <span>"ML"</span>, <span>"Basal"</span>, <span>"Basal"</span>, <span>"ML"</span>, <span>"LP"</span>, <span>"Basal"</span>, <span>"ML"</span>, <span>"LP"</span>))<br>x<span>$samples</span><span>$group</span> &lt;- group<br>samplenames &lt;- c(<span>"LP1"</span>, <span>"ML1"</span>, <span>"Basal1"</span>, <span>"Basal2"</span>, <span>"ML2"</span>, <span>"LP2"</span>, <span>"Basal3"</span>, <span>"ML3"</span>, <span>"LP3"</span>)<br>colnames(x) &lt;- samplenames<br></code></pre><p data-tool="mdnice编辑器">Set up comparisons and phenodata</p><pre data-tool="mdnice编辑器"><code>compList &lt;- c(<span>"Basal-LP"</span>, <span>"Basal-ML"</span>, <span>"LP-ML"</span>)<br>phenoData = new(<span>"AnnotatedDataFrame"</span>, data = data.frame(celltype = group))<br>rownames(phenoData) = colnames(x<span>$counts</span>)<br></code></pre><p data-tool="mdnice编辑器">Preprocess and DEG analysis</p><pre data-tool="mdnice编辑器"><code>counts &lt;- Preprocess_counts(counts = x<span>$counts</span>, groups = group, mouse = TRUE)<br>DErslt = RNAseqDegs_limma(counts = counts, phenodata = phenoData, <br>                          complist = compList, qval = 0.05)<br><br>neweset = Biobase::ExpressionSet(assayData = as.matrix(DErslt<span>$Overall</span><span>$e</span>), phenoData = phenoData)<br></code></pre><p data-tool="mdnice编辑器">Identify significantly enriched TFs（最关键的一步）</p><pre data-tool="mdnice编辑器"><code>data(<span>"mDB"</span>)<br>calc &lt;- FALSE<br><br><span>if</span> (calc) {<br>  gsearslts &lt;- TF_Selection(GSDB = mDB, DErslt = DErslt, minSize = 5, nperm = 10000,<br>                            qval = 0.05, compList = compList,<br>                            nameFile = <span>"gsearslts_tutorial"</span>)<br>} <span>else</span> {<br>  gsearslts &lt;- readRDS(file = <span>"gsearslts_tutorial.RDS"</span>)<br>}<br><br>tfs &lt;- gsearslts<span>$tfs</span><br>tfs<br>Reselect_TFs(GSEArslt = gsearslts<span>$GSEArslt</span>, qval = 0.01)<br></code></pre><p data-tool="mdnice编辑器">Calculate the activities of the selected TFs</p><pre data-tool="mdnice编辑器"><code>act.me &lt;- TF_Activity(tfs, mDB, neweset, DErslt<span>$Overall</span>)<br>acts_mat = act.me<span>$all_activities</span><br>Activity_heatmap(acts_mat, neweset)<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.8571428571428571" data-src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7eAAadr0HicECWyYsEH3JgmUhNBlpzlZbUpwHicTQ8dwibBBl7wd0FOwZn7G9WAcm4t4hzP0NDujx4bw/640?wx_fmt=png" data-type="png" data-w="1344" src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7eAAadr0HicECWyYsEH3JgmUhNBlpzlZbUpwHicTQ8dwibBBl7wd0FOwZn7G9WAcm4t4hzP0NDujx4bw/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">Construct gene regualtory network</p><pre data-tool="mdnice编辑器"><code>tf_links = TF_Filter(acts_mat, mDB, miTh = .05, nbins = 8, corMethod = <span>"spearman"</span>, DPI = T)<br>plot_network(tf_links)<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.7795031055900621" data-src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7eAAadr0HicECWyYsEH3JgmU1Vsy8IoqrCbMHrwpaxJRtenH3SnscfseSdjwDKOU16Or2yK2ia8DCGA/640?wx_fmt=png" data-type="png" data-w="644" src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7eAAadr0HicECWyYsEH3JgmU1Vsy8IoqrCbMHrwpaxJRtenH3SnscfseSdjwDKOU16Or2yK2ia8DCGA/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">RACIPE simulations</p><pre data-tool="mdnice编辑器"><code>racipe_results &lt;- sRACIPE::sracipeSimulate(circuit = tf_links, numModels = 200, plots = TRUE)<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="1.865301724137931" data-src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7eAAadr0HicECWyYsEH3JgmUoB48ZqYSwCuicCg1E28BGw6cUnXTobsxQAkpQmuLIuYLkUebLbKiaIzQ/640?wx_fmt=png" data-type="png" data-w="928" src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7eAAadr0HicECWyYsEH3JgmUoB48ZqYSwCuicCg1E28BGw6cUnXTobsxQAkpQmuLIuYLkUebLbKiaIzQ/640?wx_fmt=png"></figure><hr data-tool="mdnice编辑器"><h2 data-tool="mdnice编辑器"><span></span><span>说在最后</span></h2><p data-tool="mdnice编辑器">在NetAct之前，对单细胞数据进行转录因子分析的软件我们听到最多的都是SCENIC，以及它的python版本--pySCENIC。但是这两个软件使用起来都很不方便，而且没有具体展示各基因(转录因子)之间的调控关系。而NetAct的出现，使我们彻底告别SCENIC的垄断时代，它不仅轻便而且能展示更多的转录因子调控关系，感兴趣的小伙伴赶紧实操起来吧。</p><p data-tool="mdnice编辑器">好啦，本期分享到这就结束了，我们下期再会~~</p><p data-tool="mdnice编辑器"><br></p><hr data-tool="mdnice编辑器"></section><p><img data-galleryid="" data-ratio="1" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/GL6g5Y3aR7f28iaAPOSZyaVreHSWoQket3gNW3WtOGwutAMDGYKSk6ZBOdhDUyS95mNMn5INvyOIibBSfHgzI6sQ/640?wx_fmt=jpeg" data-type="jpeg" data-w="258" src="https://mmbiz.qpic.cn/mmbiz_jpg/GL6g5Y3aR7f28iaAPOSZyaVreHSWoQket3gNW3WtOGwutAMDGYKSk6ZBOdhDUyS95mNMn5INvyOIibBSfHgzI6sQ/640?wx_fmt=jpeg"></p><h3 data-tool="mdnice编辑器"><span>关注下方公众号下回更新不迷路</span></h3><section><mp-common-profile data-weui-theme="light" data-id="MzI4MjY5ODI1Nw==" data-pluginname="mpprofile" data-headimg="http://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7f28iaAPOSZyaVreHSWoQketIFUzNSiayMfvqbyCD0TNcBv06SGnkaO1gXRsN9icoQ23IjMJ5ta3Jia9w/0?wx_fmt=png" data-nickname="生信宝库" data-alias="sxbk2020" data-signature="用于生信知识的收集与传播，以及生信人之间学习交流。本公众号各小编平时忙于科研，更新文章较其它同类型公众号较慢，但保持宁缺毋滥的本心，只更新对大家有用的推文。" data-from="2" data-is_biz_ban="0"></mp-common-profile><span></span></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/tVSUFg3pzG0RRkpqBCsCEg",target="_blank" rel="noopener noreferrer">原文链接</a>
