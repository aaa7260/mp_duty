---
title: "如何做单样本之间的差异分析？"
date: 2022-09-21T05:30:24Z
draft: ["false"]
tags: [
  "fetched",
  "生信菜鸟团"
]
categories: ["Acdemic"]
---
如何做单样本之间的差异分析？ by 生信菜鸟团
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><h2 data-tool="mdnice编辑器"><span></span><span>缘起</span><span></span></h2><p data-tool="mdnice编辑器">老师在处理数据时，看见了一个神奇的样本数量为1V2的转录组数据集GSE111838，它既不像我们常见的3V3；也不是每组所含的样本数量都一致，而是实验组2个样本，对照组1个样本，于是就有了我这篇新推文。刘小乐老师的哈佛公开课中曾谈到<strong>「转录组差异分析对于样本数量的要求」</strong>；她说对于人与动物这种<strong>「异质性相对较大的样本」</strong>，至少拥有3个重复，即3V3以上，人貌似要更多一些，因为人与人之间的异质性更大；对于<strong>「异质性相对而言没那么大」</strong>的的<strong>「细胞系」</strong>，<strong>「至少拥有2个重复」</strong>，即2V2以上。但是，这个数据集的作者竟然做了不合常规的1V2，既然作者已经出做了，那我们就试着去分析一下吧。由于常规的三种转录组差异分析方法DEseq2、edgeR与limma都不支持组别样本1V2的分析方式，<strong>「那我们分析的角度就基于1个对照组，分别做2个实验组的差异分析」</strong>，取<strong>「差异基因的交集」</strong>看其差异，<strong>「并从相关性的角度」</strong>探究一下两组差异分析得出的差异基因的表达<strong>「相关性」</strong>。</p><h2 data-tool="mdnice编辑器"><span></span><span>探索</span><span></span></h2><p data-tool="mdnice编辑器">今天，我们使用标题为 Gene expression changes in breast cancer cells upon USP1 knockdown的数据集GSE111838进行探究，数据集的介绍链接如下  <span>https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE111838</span>，感兴趣的小伙伴可以点进去看看作者的总体设计。在此我们对文章进行简单的归纳，<strong>「作者主要是探究了敲低USP1特异性siRNA对于乳腺癌细胞系的影响」</strong>。</p><h2 data-tool="mdnice编辑器"><span></span><span>转录组数据集介绍</span><span></span></h2><p data-tool="mdnice编辑器">GSE111838数据集的样本分组如下，1个样本是敲低无义RNA即siCTR处理乳腺癌细胞系作为对照组，2个样本是在MCF7乳腺癌细胞系中靶向敲低siUSP1作为实验组<img data-ratio="0.16541353383458646" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9qmZZWyMfNLFtxCR5rE5qUhXn2EyOQISaKZs0v02ln1x3gw6Y1IBwE3xWRgtXyKMvzHF6MGBrkIQ/640?wx_fmt=png" data-type="png" data-w="665" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9qmZZWyMfNLFtxCR5rE5qUhXn2EyOQISaKZs0v02ln1x3gw6Y1IBwE3xWRgtXyKMvzHF6MGBrkIQ/640?wx_fmt=png">处理数据的话，作者上传了基因表达矩阵<img data-ratio="0.08360128617363344" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9qmZZWyMfNLFtxCR5rE5qU5gB96Pn3Jgl5BARXbymFVZlopKOoxFHBJXEq5bQGdgIiazaKIv2rd3g/640?wx_fmt=png" data-type="png" data-w="933" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9qmZZWyMfNLFtxCR5rE5qU5gB96Pn3Jgl5BARXbymFVZlopKOoxFHBJXEq5bQGdgIiazaKIv2rd3g/640?wx_fmt=png">以下为上述数据集的下载链接：<span>https://www.ncbi.nlm.nih.gov/geo/download/?acc=GSE111838&amp;format=file&amp;file=GSE111838%5Fgene%5Fexpression%2Etxt%2Egz</span>，感兴趣的小伙伴可下载试试单样本做转录组差异分析的感觉。</p><h3 data-tool="mdnice编辑器"><span></span><span><span></span>0.清控环境，加载包</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code>rm(list = ls())<br><span>library</span>(edgeR)<br><span>library</span>(DESeq2)<br><span>library</span>(FactoMineR)<br><span>library</span>(factoextra)<br><span>library</span>(org.Hs.eg.db)<br><span>library</span>(stringr)<br><span>library</span>(stringi)<br><span>library</span>(tidyverse)<br><span>library</span>(ggplot2)<br><span>library</span>(patchwork)<br><span>library</span>(pheatmap)<br><span>library</span>(VennDiagram)<br><span>library</span>(RColorBrewer)<br><span>library</span>(data.table)<br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span><span></span>1.读取数据，获得基因表达矩阵以及cpm矩阵</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code>rawcount &lt;- fread(<span>"./GSE111838_gene_expression.txt"</span>,header = <span>T</span>,data.table =<span>F</span> )<br>rawcount &lt;- rawcount[,c(<span>2</span>,<span>8</span>,<span>9</span>,<span>10</span>)] <span>#根据列名，提取表达列与基因名对应的列名</span><br>rawcount$median &lt;- apply(rawcount[,<span>2</span>:<span>4</span>],<span>1</span>,median) <span>#先排序而后降重，保留最大值</span><br>rawcount=rawcount[order(rawcount$gene_name,rawcount$median,decreasing = <span>T</span>),] <br>rawcount=rawcount[!duplicated(rawcount$gene_name),]<br>rownames(rawcount)=rawcount$gene_name<br>rawcount=rawcount[,<span>2</span>:<span>4</span>]<br>keep &lt;- rowSums(rawcount&gt;<span>0</span>) &gt;= floor(<span>0.75</span>*ncol(rawcount))<br>filter_count &lt;- rawcount[keep,] <span>#获得filter_count矩阵</span><br>fivenum(filter_count)<br><span>## [1]      0.0      4.0     49.5    458.0 241317.0</span><br>filter_count=na.omit(filter_count)<br>express_cpm &lt;- log2(cpm(filter_count)+ <span>1</span>)<br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span><span></span>2.第一组单样本差异分析比较（重点，模拟4V4通过limma-voom进行差异分析）</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code>filter_count &lt;- filter_count[,c(<span>3</span>,<span>2</span>,<span>1</span>)] <span>#调整成正常在前；疾病在后</span><br>head(filter_count)<br><span>##        MCF7_siCTR_count MCF7_siUSP1_1_count MCF7_siUSP1_2_count</span><br><span>## ZZZ3                356                 724                 671</span><br><span>## ZZEF1               987                1148                1196</span><br><span>## ZYX                1102                1097                 677</span><br><span>## ZYG11B              315                 354                 241</span><br><span>## ZYG11A              235                 254                 309</span><br><span>## ZXDC                307                 426                 430</span><br>exprSet &lt;- filter_count<br>exprSet1=cbind(<br>  exprSet[,<span>1</span>:<span>2</span>],<br>  exprSet[,<span>1</span>:<span>2</span>],<br>  exprSet[,<span>1</span>:<span>2</span>],<br>  exprSet[,<span>1</span>:<span>2</span>]<br>) <br><br><span># 查看分组信息和表达矩阵数据</span><br>group1=rep(c(<span>'siCtrl'</span>,<span>'SiUsp1'</span>),<span>4</span>)<br>group_list1=factor(group1,levels = c(<span>'siCtrl'</span>,<span>'SiUsp1'</span>))<br>table(group_list1)<span>#检查一下组别数量</span><br><span>## group_list1</span><br><span>## siCtrl SiUsp1 </span><br><span>##      4      4</span><br><br><span># 加载包</span><br><span>library</span>(limma)<br><span>library</span>(edgeR) <br><span>#创建设计矩阵和对比：假设数据符合分布，构建线性模型</span><br>design1 &lt;- model.matrix(~<span>0</span>+factor(group_list1))<br>colnames(design1) &lt;- levels(factor(group_list1))<br>rownames(design1) &lt;- colnames(exprSet1)<br>design1<br><span>##                     siCtrl SiUsp1</span><br><span>## MCF7_siCTR_count         1      0</span><br><span>## MCF7_siUSP1_1_count      0      1</span><br><span>## MCF7_siCTR_count         1      0</span><br><span>## MCF7_siUSP1_1_count      0      1</span><br><span>## MCF7_siCTR_count         1      0</span><br><span>## MCF7_siUSP1_1_count      0      1</span><br><span>## MCF7_siCTR_count         1      0</span><br><span>## MCF7_siUSP1_1_count      0      1</span><br><span>## attr(,"assign")</span><br><span>## [1] 1 1</span><br><span>## attr(,"contrasts")</span><br><span>## attr(,"contrasts")$`factor(group_list1)`</span><br><span>## [1] "contr.treatment"</span><br><br><span>#设置需要进行对比的分组</span><br>comp1 &lt;- <span>'SiUsp1-siCtrl'</span><br>cont.matrix1 &lt;- makeContrasts(contrasts=c(comp1),levels = design1)<br><span>#进行差异表达分析</span><br>dge1 &lt;- DGEList(counts=exprSet1)<br>v1 &lt;- voom(dge1,design1,plot=<span>TRUE</span>, normalize=<span>"quantile"</span>)<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.7142857142857143" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9qmZZWyMfNLFtxCR5rE5qUoKrDx5FNUYQ9fvb5TECCRdryQOPsNkPB5ibk0sZJ16PrVeSY4BSheAQ/640?wx_fmt=png" data-type="png" data-w="672" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9qmZZWyMfNLFtxCR5rE5qUoKrDx5FNUYQ9fvb5TECCRdryQOPsNkPB5ibk0sZJ16PrVeSY4BSheAQ/640?wx_fmt=png"></figure><pre data-tool="mdnice编辑器"><span></span><code>fit1 &lt;- lmFit(v1, design1)<br>fit1 &lt;- contrasts.fit(fit1,cont.matrix1)<br>fit1 &lt;- eBayes(fit1)<br>tmp1 &lt;- topTable(fit1, coef=comp1, n=<span>Inf</span>,adjust.method=<span>"BH"</span>)<br>DEG_limma_voom1 &lt;- na.omit(tmp1)<br><br>head(DEG_limma_voom1)<br><span>##               logFC   AveExpr            t       P.Value     adj.P.Val        B</span><br><span>## ZAR1      -1.584963 -3.836418 -4.61964e+22 1.089114e-139 6.395347e-138 312.0156</span><br><span>## VSTM1     -1.584963 -3.836418 -4.61964e+22 1.089114e-139 6.395347e-138 312.0156</span><br><span>## USP17L12  -1.584963 -3.836418 -4.61964e+22 1.089114e-139 6.395347e-138 312.0156</span><br><span>## UPK1A-AS1 -1.584963 -3.836418 -4.61964e+22 1.089114e-139 6.395347e-138 312.0156</span><br><span>## TYROBP    -1.584963 -3.836418 -4.61964e+22 1.089114e-139 6.395347e-138 312.0156</span><br><span>## TPSD1     -1.584963 -3.836418 -4.61964e+22 1.089114e-139 6.395347e-138 312.0156</span><br><span>library</span>(EnhancedVolcano)<br><br>EnhancedVolcano(DEG_limma_voom1,<br>                lab =rownames(DEG_limma_voom1),<br>                x = <span>'logFC'</span>,<br>                y = <span>'adj.P.Val'</span>)<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.7142857142857143" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9qmZZWyMfNLFtxCR5rE5qUArwTGUF3jmDo8VGHibvVFIIhUzH5qr7I4oAaN3Bq326Wt8IicA5pG3ng/640?wx_fmt=png" data-type="png" data-w="672" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9qmZZWyMfNLFtxCR5rE5qUArwTGUF3jmDo8VGHibvVFIIhUzH5qr7I4oAaN3Bq326Wt8IicA5pG3ng/640?wx_fmt=png"></figure><h3 data-tool="mdnice编辑器"><span></span><span><span></span>3.第二组单样本差异分析比较（重点，模拟4V4通过limma-voom进行差异分析）</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code>exprSet2=cbind(<br>  exprSet[,c(<span>1</span>,<span>3</span>)],<br>  exprSet[,c(<span>1</span>,<span>3</span>)],<br>  exprSet[,c(<span>1</span>,<span>3</span>)],<br>  exprSet[,c(<span>1</span>,<span>3</span>)]<br>) <br><br><span># 查看分组信息和表达矩阵数据</span><br>group2=rep(c(<span>'siCtrl'</span>,<span>'SiUsp2'</span>),<span>4</span>)<br>group_list2=factor(group2,levels = c(<span>'siCtrl'</span>,<span>'SiUsp2'</span>))<br>table(group_list2)<span>#检查一下组别数量</span><br><span>## group_list2</span><br><span>## siCtrl SiUsp2 </span><br><span>##      4      4</span><br><br><span># 加载包</span><br><span>library</span>(limma)<br><span>library</span>(edgeR) <br><span>#创建设计矩阵和对比：假设数据符合分布，构建线性模型</span><br>design2 &lt;- model.matrix(~<span>0</span>+factor(group_list2))<br>colnames(design2) &lt;- levels(factor(group_list2))<br>rownames(design2) &lt;- colnames(exprSet2)<br>design2<br><span>##                     siCtrl SiUsp2</span><br><span>## MCF7_siCTR_count         1      0</span><br><span>## MCF7_siUSP1_2_count      0      1</span><br><span>## MCF7_siCTR_count         1      0</span><br><span>## MCF7_siUSP1_2_count      0      1</span><br><span>## MCF7_siCTR_count         1      0</span><br><span>## MCF7_siUSP1_2_count      0      1</span><br><span>## MCF7_siCTR_count         1      0</span><br><span>## MCF7_siUSP1_2_count      0      1</span><br><span>## attr(,"assign")</span><br><span>## [1] 1 1</span><br><span>## attr(,"contrasts")</span><br><span>## attr(,"contrasts")$`factor(group_list2)`</span><br><span>## [1] "contr.treatment"</span><br><br><span>#设置需要进行对比的分组</span><br>comp2 &lt;- <span>'SiUsp2-siCtrl'</span><br>cont.matrix2 &lt;- makeContrasts(contrasts=c(comp2),levels = design2)<br><span>#进行差异表达分析</span><br>dge2 &lt;- DGEList(counts=exprSet2)<br>v2 &lt;- voom(dge2,design2,plot=<span>TRUE</span>, normalize=<span>"quantile"</span>)<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.7142857142857143" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9qmZZWyMfNLFtxCR5rE5qUrr5rJ2Kj9Efx280eCWbU2vKeJBwwBrkMQO2rJmzMLXh8Z6aJNVEBicw/640?wx_fmt=png" data-type="png" data-w="672" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9qmZZWyMfNLFtxCR5rE5qUrr5rJ2Kj9Efx280eCWbU2vKeJBwwBrkMQO2rJmzMLXh8Z6aJNVEBicw/640?wx_fmt=png"></figure><pre data-tool="mdnice编辑器"><span></span><code>fit2 &lt;- lmFit(v2, design2)<br>fit2 &lt;- contrasts.fit(fit2,cont.matrix2)<br>fit2 &lt;- eBayes(fit2)<br>tmp2 &lt;- topTable(fit2, coef=comp2, n=<span>Inf</span>,adjust.method=<span>"BH"</span>)<br>DEG_limma_voom2 &lt;- na.omit(tmp2)<br><br>head(DEG_limma_voom2)<br><span>##               logFC   AveExpr             t      P.Value     adj.P.Val        B</span><br><span>## ZNF716    -1.584963 -3.776335 -3.482617e+19 4.72292e-122 3.009022e-120 271.6684</span><br><span>## ZNF705G   -1.584963 -3.776335 -3.482617e+19 4.72292e-122 3.009022e-120 271.6684</span><br><span>## ZNF501    -1.584963 -3.776335 -3.482617e+19 4.72292e-122 3.009022e-120 271.6684</span><br><span>## ZMYM4-AS1 -1.584963 -3.776335 -3.482617e+19 4.72292e-122 3.009022e-120 271.6684</span><br><span>## YIPF7     -1.584963 -3.776335 -3.482617e+19 4.72292e-122 3.009022e-120 271.6684</span><br><span>## WFDC10A   -1.584963 -3.776335 -3.482617e+19 4.72292e-122 3.009022e-120 271.6684</span><br><span>library</span>(EnhancedVolcano)<br><br>EnhancedVolcano(DEG_limma_voom2,<br>                lab =rownames(DEG_limma_voom2),<br>                x = <span>'logFC'</span>,<br>                y = <span>'adj.P.Val'</span>)<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.7142857142857143" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9qmZZWyMfNLFtxCR5rE5qUkXWdw4qG9fRTXxMaxI9DwKibia7Gce6YnNyTtI6cNiaJq83TH9Eb55SuA/640?wx_fmt=png" data-type="png" data-w="672" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9qmZZWyMfNLFtxCR5rE5qUkXWdw4qG9fRTXxMaxI9DwKibia7Gce6YnNyTtI6cNiaJq83TH9Eb55SuA/640?wx_fmt=png"></figure><h3 data-tool="mdnice编辑器"><span></span><span><span></span>4.统计两组差异分析获得的差异基因的交集情况</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code>fc &lt;- <span>2</span><br>p &lt;- <span>0.05</span><br>DEG_limma_voom1$regulated &lt;- ifelse(DEG_limma_voom1$logFC&gt;log2(fc)&amp;DEG_limma_voom1$adj.P.Val&lt;p,<br>                                    <span>"up"</span>,ifelse(DEG_limma_voom1$logFC&lt;(-log2(fc))&amp;DEG_limma_voom1$adj.P.Val,<span>"down"</span>,<span>"normal"</span>))<br><br><br>table(DEG_limma_voom1$regulated)<br><span>## </span><br><span>##   down normal     up </span><br><span>##   2323  18108   2059</span><br><span>### 单样本的话；使用P值与adjust P值区别不大</span><br><br>DEG_limma_voom2$regulated &lt;- ifelse(DEG_limma_voom2$logFC&gt;log2(fc)&amp;DEG_limma_voom2$adj.P.Val&lt;p,<br>                                    <span>"up"</span>,ifelse(DEG_limma_voom2$logFC&lt;(-log2(fc))&amp;DEG_limma_voom2$adj.P.Val,<span>"down"</span>,<span>"normal"</span>))<br>table(DEG_limma_voom2$regulated)<br><span>## </span><br><span>##   down normal     up </span><br><span>##   2544  17510   2436</span><br><br><span># 看看1V2差异分析基因的交集情况</span><br><span>library</span>(ggplotify)<br><span>library</span>(ggvenn)<br><span># 01先获取第一组比较的上调基因，下调基因与差异基因</span><br>deg1 &lt;- rownames(DEG_limma_voom1[DEG_limma_voom1$regulated!=<span>"normal"</span>,])<br>up1 &lt;- rownames(DEG_limma_voom1[DEG_limma_voom1$regulated==<span>"up"</span>,])<br>down1 &lt;- rownames(DEG_limma_voom1[DEG_limma_voom1$regulated==<span>"down"</span>,])<br><span># 02再获取第二组比较的上调基因，下调基因与差异基因</span><br>deg2 &lt;- rownames(DEG_limma_voom2[DEG_limma_voom2$regulated!=<span>"normal"</span>,])<br>up2 &lt;- rownames(DEG_limma_voom2[DEG_limma_voom2$regulated==<span>"up"</span>,])<br>down2 &lt;- rownames(DEG_limma_voom2[DEG_limma_voom2$regulated==<span>"down"</span>,])<br>deg&lt;-list(`deg1`=deg1,<br>          `deg2`=deg2)<br>p5 &lt;- ggvenn(deg,<br>             show_percentage = <span>F</span>,<br>             stroke_color = <span>"white"</span>,<br>             fill_color = c(<span>"#b2d4ec"</span>,<span>"#d3c0e2"</span>),<br>             set_name_color = c(<span>"#ff0000"</span>,<span>"#4a9b83"</span>))<br><br><span># 绘制两组比较上调差异基因韦恩图</span><br>up&lt;-list(`up1`=up1,<br>         `up2`=up2)<br><br>p6 &lt;- ggvenn(up,<br>             show_percentage = <span>F</span>,<br>             stroke_color = <span>"white"</span>,<br>             fill_color = c(<span>"#ffb2b2"</span>,<span>"#b2e7cb"</span>),<br>             set_name_color = c(<span>"#ff0000"</span>,<span>"#4a9b83"</span>))<br><br><span># 绘制两组下调差异基因韦恩图</span><br>down&lt;-list(`down1`=down1,<br>           `down2`=down2)<br><br>p7 &lt;- ggvenn(down,<br>             show_percentage = <span>F</span>,<br>             stroke_color = <span>"white"</span>,<br>             fill_color = c(<span>"#b2d4ec"</span>,<span>"08a4ad"</span>),<br>             set_name_color = c(<span>"#ff0000"</span>,<span>"#4a9b83"</span>))<br>p6+p7<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.7142857142857143" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9qmZZWyMfNLFtxCR5rE5qUb5Dsia6iasZaeOcTegbkxy5NicmG1CRo8Tj1npMiakqaDEfCiadt7mEQGTw/640?wx_fmt=png" data-type="png" data-w="672" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9qmZZWyMfNLFtxCR5rE5qUb5Dsia6iasZaeOcTegbkxy5NicmG1CRo8Tj1npMiakqaDEfCiadt7mEQGTw/640?wx_fmt=png"></figure><h3 data-tool="mdnice编辑器"><span></span><span><span></span>5.查看两组差异分析获得差异基因结果的相关性情况</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code><span># 01看一看分别比较的整体相关性（此处就看整体差异基因吧）</span><br><span>library</span>(ggstatsplot)<br><span>library</span>(ggpmisc)<br>ids = intersect(deg1,deg2) <span>#只有40条，所以得换用富集方法</span><br><span># 02构建可视化所需的矩阵（相关性就两行值）</span><br>df=data.frame(<br>  deg1=DEG_limma_voom1[ids,<span>"logFC"</span>],<br>  deg2=DEG_limma_voom2[ids,<span>"logFC"</span>] <span>#就是两列logFC的值（散点图）</span><br>)<br><br><span># 03绘制相关性图形</span><br>p &lt;- ggplot(df, aes(x=df$deg1,<br>                    df$deg2))+    <br>  geom_point()+<br>  labs(x = <span>"deg1"</span>,<br>       y = <span>"deg2"</span>)+<br>  scale_color_manual(values=c(<span>"blue"</span>, <span>"grey"</span>,<span>"red"</span>))+<br>  geom_vline(xintercept = c( -<span>1.5</span>,<span>0</span>,<span>1.5</span>),lty=<span>4</span>,col=<span>"#ec183b"</span>,lwd=<span>0.8</span>) +<br>  geom_hline(yintercept =  c( -<span>1.5</span>,<span>0</span>,<span>1.5</span>),lty=<span>4</span>,col=<span>"#18a5ec"</span>,lwd=<span>0.8</span>) +<br>  <span>#xlim(-5,5)+</span><br>  <span>#ylim(-3,3)+</span><br>  theme_ggstatsplot()+<br>  theme(panel.grid.minor = element_blank(),<br>        panel.grid.major = element_blank())<br>p+stat_poly_eq(aes(label=paste(..eq.label..,..adj.rr.label..,..p.value.label..,sep = <span>"~~~~"</span>)),formula = y~x,parse=<span>T</span>,size=<span>3.0</span>)<br></code></pre><p data-tool="mdnice编辑器"><img data-ratio="0.7142857142857143" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9qmZZWyMfNLFtxCR5rE5qUlhicKYibtlH6YV6XEzHcD2RebqoBZqKUPib5vTjK62ISkqSAAIAWibV3ibQ/640?wx_fmt=png" data-type="png" data-w="672" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9qmZZWyMfNLFtxCR5rE5qUlhicKYibtlH6YV6XEzHcD2RebqoBZqKUPib5vTjK62ISkqSAAIAWibV3ibQ/640?wx_fmt=png">以上就是单样本1V2差异分析的处理方式，我们<strong>「通过两个实验组分别与对照组1V1比较，取交集与绘制相关性图形的方式」</strong>看了看作者的处理效果；从交集的结果来看，相较于对照组，两个实验组均具有显著差异，<strong>「Venn图结果表明」</strong>，上调与下调的差异基因中，两次差异分析之间均具有一半左右的交集。<strong>「相关性分析结果表明」</strong>，两次差异分析有较好的相关性，这表明作者的实验结果是比较可靠的，效果也是比较显著的。</p><p data-tool="mdnice编辑器">但是，小编不建议大家做单样本处理额，感觉细胞系至少得两个重复以上，否则单一样本出现问题的话是<strong>「不好排查的且不够让人可信」</strong>。感兴趣的同学可以尝试一下，并敞开交流一下自身对于单样本处理的观点。</p></section><p><br></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/PEqmBsV9bOsG9bRgcB0qKQ",target="_blank" rel="noopener noreferrer">原文链接</a>
