---
title: "R优雅的自定义绘制代谢通路图"
date: 2022-12-12T00:39:49Z
draft: ["false"]
tags: [
  "fetched",
  "生信宝库"
]
categories: ["Acdemic"]
---
R优雅的自定义绘制代谢通路图 by 生信宝库
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><blockquote data-tool="mdnice编辑器"><span>❝</span><p>最近看到一个非常好的案例来分享一下，使用igraph，ggraph等R包来自定义绘制代谢通路pathway，原文文档链接见下方，数据可自行去官网下载。代码过程很是简洁，当然难点也许在于构建边文件与点文件。这需要各位观众老爷细细品味</p><span>❞</span></blockquote><h3 data-tool="mdnice编辑器"><span></span><span><span></span>原文文档</span><span></span></h3><blockquote data-tool="mdnice编辑器"><span>❝</span><p>https://github.com/cxli233/ggpathway</p><span>❞</span></blockquote><blockquote data-tool="mdnice编辑器"><span>❝</span><p><code>有需要学习数据可视化的朋友欢迎加入小编2022年度VIP群</code>，目前群内已经上传公众号文档<strong>「数据+代码约270篇」</strong>，<code>VIP交流群(1)已经500人满员</code>,随着内容不断增多，为了更好的创做内容现在进群需<strong>「付费149元」</strong> 年底临近<strong>「从即日起至12月底无需转发文档到朋友圈积赞，可直接已129元的价格入群」</strong></p><span>❞</span></blockquote><h3 data-tool="mdnice编辑器"><span></span><span><span></span>淘宝店铺个性化绘图服务</span><span></span></h3><blockquote data-tool="mdnice编辑器"><span>❝</span><p>最近有部分观众老爷找小编做个性化绘图，为了给观众老爷提供更加优质的服务；小编开通了 <strong>「淘宝店铺(R语言数据分析指南)」</strong> ，有特殊绘图需求的欢迎关注咨询(<strong>「由于小编时间精力有限有需求的请及时下单」</strong>)</p><span>❞</span></blockquote><h3 data-tool="mdnice编辑器"><span></span><span><span></span>加载R包</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code><span>library</span>(tidyverse)<br><span>library</span>(igraph)<br><span>library</span>(ggraph)<br><span>library</span>(readxl)<br><span>library</span>(viridis)<br><span>library</span>(RColorBrewer)<br><span>library</span>(rcartocolor)<br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span><span></span>构建边数据</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code>example1_edge_table &lt;- tribble(<br>  ~from, ~to,  ~label,<br>  <span>"Glc6P"</span>, <span>"6P-gluconolactone"</span>,  <span>"Glc6PHD"</span>,<br>  <span>"6P-gluconolactone"</span>, <span>"6P-glucoconate"</span>,  <span>"6P-gluconolactonase"</span>,<br>  <span>"6P-glucoconate"</span>, <span>"Ru5P"</span>, <span>"6P-gluconateDH"</span><br>)<br><span># 构建点数据</span><br>example1_nodes_table &lt;- tribble(<br>  ~name, ~x,  ~y,<br>  <span>"Glc6P"</span>, <span>1</span>, <span>0</span>,<br>  <span>"6P-gluconolactone"</span>, <span>2</span>, <span>0</span>,  <br>  <span>"6P-glucoconate"</span>, <span>3</span>, <span>0</span>,<br>  <span>"Ru5P"</span>, <span>4</span>, <span>0</span><br>)<br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span><span></span>文件整合</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code>example1_network &lt;- graph_from_data_frame(<br>  d = example1_edge_table,<br>  vertices = example1_nodes_table,<br>  directed = <span>T</span><br>)<br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span><span></span>绘制基础通路图</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code>ggraph(example1_network, layout = <span>"manual"</span>, <br>       x = x, y = y) +<br>  geom_node_text(aes(label = name), hjust = <span>0.5</span>) +<br>  geom_edge_link(aes(label = example1_edge_table$label), <br>                 angle_calc = <span>'along'</span>,<br>                 label_dodge = unit(<span>2</span>, <span>'lines'</span>),<br>                 arrow = arrow(length = unit(<span>0.5</span>, <span>'lines'</span>)), <br>                 start_cap = circle(<span>4</span>, <span>'lines'</span>),<br>                 end_cap = circle(<span>4</span>, <span>'lines'</span>)) +<br>  theme_void()  <br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.34509371554575524" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAYhXWaMOPWE3lTWjo6stglQVwjlXuS6Yictp0JHgxCreiawSzgrTuOo6EmQxYurg5ffsERBb47wWK3A/640?wx_fmt=png" data-type="png" data-w="907" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAYhXWaMOPWE3lTWjo6stglQVwjlXuS6Yictp0JHgxCreiawSzgrTuOo6EmQxYurg5ffsERBb47wWK3A/640?wx_fmt=png"></figure><h3 data-tool="mdnice编辑器"><span></span><span><span></span>绘制PPP代谢途径</span><span></span></h3><p data-tool="mdnice编辑器">导入数据</p><pre data-tool="mdnice编辑器"><span></span><code>example2_edges &lt;- read_excel(<span>"OPPP_edges.xlsx"</span>)<br>example2_nodes &lt;- read_excel(<span>"OPPP_nodes.xlsx"</span>)<br></code></pre><h4 data-tool="mdnice编辑器"><span></span><span><span></span>构建新标签</span><span></span></h4><pre data-tool="mdnice编辑器"><span></span><code>example2_nodes &lt;- example2_nodes %&gt;% <br>  mutate(label = str_remove(name, <span>"_\\d"</span>))<br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span><span></span>文件整合</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code>example2_network &lt;- graph_from_data_frame(<br>  d = example2_edges,<br>  vertices = example2_nodes,<br>  directed = <span>T</span>)<br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span><span></span>绘制PPP代谢途径图</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code>ggraph(example2_network, layout = <span>"kk"</span>) +<br>  geom_node_point(size = <span>3</span>, aes(fill = as.factor(carbons)), <br>                  alpha = <span>0.8</span>, shape = <span>21</span>, color = <span>"grey20"</span>) +<br>  geom_node_text(aes(label = label), hjust = <span>0.5</span>, repel = <span>T</span>) +<br>  geom_edge_link(label_dodge = unit(<span>2</span>, <span>'lines'</span>),<br>    arrow = arrow(length = unit(<span>0.4</span>, <span>'lines'</span>)), <br>    start_cap = circle(<span>1</span>, <span>'lines'</span>),<br>    end_cap = circle(<span>2</span>, <span>'lines'</span>)) +<br>  scale_fill_manual(values = carto_pal(<span>7</span>, <span>"Vivid"</span>)) +<br>  labs(fill = <span>"Carbons"</span>) +<br>  theme_void()  <br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="1.1632302405498283" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAYhXWaMOPWE3lTWjo6stglQo2mkSSXtHDfpvl6eyUtncQAGJ0I3ELHQ2Gom4cekXRjIMJ26pmvbKg/640?wx_fmt=png" data-type="png" data-w="582" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAYhXWaMOPWE3lTWjo6stglQo2mkSSXtHDfpvl6eyUtncQAGJ0I3ELHQ2Gom4cekXRjIMJ26pmvbKg/640?wx_fmt=png"></figure><h3 data-tool="mdnice编辑器"><span></span><span><span></span>TCA途径</span><span></span></h3><p data-tool="mdnice编辑器">导入数据</p><pre data-tool="mdnice编辑器"><span></span><code>example3_edges &lt;- read_excel(<span>"TCA_cycle_edges.xlsx"</span>)<br>example3_nodes &lt;- read_excel(<span>"TCA_cycle_nodes.xlsx"</span>)<br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span><span></span>构建标签文本</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code>example3_nodes &lt;- example3_nodes %&gt;% <br>  mutate(label = str_remove(name, <span>"_\\d"</span>))<br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span><span></span>整合数据</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code>example3_network &lt;- graph_from_data_frame(<br>  d = example3_edges,<br>  vertices = example3_nodes,<br>  directed = <span>T</span>)<br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span><span></span>绘制TCA途径图</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code>ggraph(example3_network, layout = <span>"manual"</span>,<br>       x = x, y = y) +<br>  geom_node_point(size = <span>3</span>, aes(fill = as.factor(carbons)), <br>                  alpha = <span>0.8</span>, shape = <span>21</span>, color = <span>"black"</span>) +<br>  geom_edge_link(arrow = arrow(length = unit(<span>0.4</span>, <span>'lines'</span>)), <br>                 start_cap = circle(<span>0.5</span>, <span>'lines'</span>),<br>                 end_cap = circle(<span>0.5</span>, <span>'lines'</span>), <br>                 width = <span>1.1</span>, alpha = <span>0.5</span>) +<br>  geom_node_text(aes(label = label), hjust = <span>0.5</span>, repel = <span>T</span>) +<br>  annotate(geom = <span>"text"</span>, label = <span>"TCA Cycle"</span>, <br>           x = <span>0</span>, y = <span>0</span>, size = <span>5</span>, fontface = <span>"bold"</span>) +<br>  scale_fill_manual(values = carto_pal(<span>7</span>, <span>"Vivid"</span>)) +<br>  labs(fill = <span>"Carbons"</span>) +<br>  theme_void() +<br>  coord_fixed()<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.7475192943770672" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAYhXWaMOPWE3lTWjo6stglQs15wfibqouk0539kjGs0bOWmOKYQZexwa2UFJp9x1g2ficia54QFJxxgw/640?wx_fmt=png" data-type="png" data-w="907" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAYhXWaMOPWE3lTWjo6stglQs15wfibqouk0539kjGs0bOWmOKYQZexwa2UFJp9x1g2ficia54QFJxxgw/640?wx_fmt=png"></figure><blockquote data-tool="mdnice编辑器"><span>❝</span><p>好了本节介绍到此结束，整个代码还是非常简洁的，<code>喜欢的观众老爷欢迎分析转发</code>，更多详细内容可以参看作者官方文档，<strong>「当然更推荐大家加入我的VIP交流群」</strong>一定让你感受到物超所值，<strong>「添加小编微信请备注来意，以便高效处理」</strong>，</p><span>❞</span></blockquote><h3 data-tool="mdnice编辑器"><span></span><span><span></span>小编微信</span><span></span></h3><p><img data-galleryid="" data-ratio="1" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/EibnicgwScTAaNu6sU2UCYkxFq9ibq75wuaO0lqFoYz1icUo4jh3N2icAWECmibgPvqyReur0FCp7JNKO0icnRAsbO9ug/640?wx_fmt=jpeg" data-type="jpeg" data-w="430" src="https://mmbiz.qpic.cn/mmbiz_jpg/EibnicgwScTAaNu6sU2UCYkxFq9ibq75wuaO0lqFoYz1icUo4jh3N2icAWECmibgPvqyReur0FCp7JNKO0icnRAsbO9ug/640?wx_fmt=jpeg"></p><h3 data-tool="mdnice编辑器"><span></span><span><span></span>关注下方公众号下回更新不迷路</span><span></span></h3><section><mp-common-profile data-pluginname="mpprofile" data-weui-theme="light" data-id="Mzg3MzQzNTYzMw==" data-headimg="http://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZF0rpeZII9Ltl26VbVagriczTria1fib3XgjwwHEHFjPzkmGpqWDVVHBSzhENictUM2iavAKiaM5lc9USw/0?wx_fmt=png" data-nickname="R语言数据分析指南" data-alias="YanJANtwo" data-signature="R语言重症爱好者，喜欢绘制各种精美的图表，喜欢的小伙伴可以关注我，跟我一起学习" data-from="0" data-is_biz_ban="0"></mp-common-profile></section></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/7ERRGmixeYnMl79bvdBQJA",target="_blank" rel="noopener noreferrer">原文链接</a>
