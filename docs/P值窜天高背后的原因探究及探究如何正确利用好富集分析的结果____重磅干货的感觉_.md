---
title: "P值窜天高背后的原因探究及探究如何正确利用好富集分析的结果---（重磅干货的感觉）"
date: 2022-09-14T04:36:36Z
draft: ["false"]
tags: [
  "fetched",
  "生信菜鸟团"
]
categories: ["Acdemic"]
---
P值窜天高背后的原因探究及探究如何正确利用好富集分析的结果---（重磅干货的感觉） by 生信菜鸟团
------
<div><h2 data-tool="mdnice编辑器"><span>缘起</span></h2><p data-tool="mdnice编辑器">上一周，我们做完差异分析后，看到了一个p值窜天高的现象，当时的我感觉它很新奇，具体链接见<a href="https://mp.weixin.qq.com/s?__biz=MzUzMTEwODk0Ng==&amp;mid=2247505893&amp;idx=1&amp;sn=7c5c750ef3d05bc42d44d369429f3294&amp;scene=21#wechat_redirect" data-linktype="2">P值竟窜天高，我的流程错了吗</a>。但这些天，我是出奇的幸运，曾老师根据差异基因数量随手一指，我竟又获得了一个P值串天高的数据集GSE186262。于是，我就想总结一下P值窜天高现象背后隐藏的内容，并且尝试探究P值窜天高现象出现的原因。起初的我只考虑到从看看P值窜天高的样本分组相关性如何、在不同分组的表达情况以及差异基因数量<strong>「三个角度去看」</strong>，曾老师告诉我，可以看看这些P值窜天高差异基因的通路富集情况，看看其富集的通路是否有什么特点，于是我又喜添一个新颖角度。所以，接下来，我们从上述谈到的<strong>「四个角度开始探究吧」</strong>。</p><h2 data-tool="mdnice编辑器"><span>探索</span></h2><p data-tool="mdnice编辑器">今天，我们使用标题为 RNA-seq analysis of triple negative breast cancer cell line MDA-MB-468 with knockdown of cytokeratin 5 (CK5) 的数据集GSE186262进行探究，数据集的介绍链接如下 <span>https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE186262</span>，感兴趣的小伙伴可以进点进去看作者的总体设计。想具体了解文章内容的，可以看看文章 Cytokeratins 5 and 17 Maintain an Aggressive Epithelial State in Basal-Like Breast Cancer，从文章中去了解一下CK5与三阴乳腺癌细胞侵袭的关系。</p><h2 data-tool="mdnice编辑器"><span>转录组数据集介绍</span></h2><p data-tool="mdnice编辑器">GSE186262数据集的样本分组如下， 3个样本是在三阴乳腺癌细胞系中敲低无义RNA作为对照组，3个样本是在三阴乳腺癌细胞系中敲低CK5作为实验组<img data-ratio="0.3041168658698539" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9rzNz4icibksH6ibHg1H0jjic5LrWib0lsQ2QdBrjiaWGiaju7DToJnWkxwOiaymgibN3J3UOZ30lTzzWBB5Q/640?wx_fmt=png" data-type="png" data-w="753" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9rzNz4icibksH6ibHg1H0jjic5LrWib0lsQ2QdBrjiaWGiaju7DToJnWkxwOiaymgibN3J3UOZ30lTzzWBB5Q/640?wx_fmt=png">处理数据的话，作者上传了 <strong>Ensenmble count矩阵</strong>，我们就可以直接走上次Ensenmble count数据处理的差异分析流程进行分析，链接见  <a href="https://mp.weixin.qq.com/s?__biz=MzUzMTEwODk0Ng==&amp;mid=2247505172&amp;idx=1&amp;sn=47c9d60c59b19bb6dcfc7095bd832d7f&amp;scene=21#wechat_redirect" data-linktype="2">转录组数据三分组的差异分析方式</a> 。</p><p data-tool="mdnice编辑器">以下为GSE186262数据集 Ensenmble count矩阵的下载链接：<span>https://www.ncbi.nlm.nih.gov/geo/download/?acc=GSE186262&amp;format=file&amp;file=GSE186262%5FGene%5Fraw%5Fread%5Fcounts%5F468%2Etxt%2Egz</span>感兴趣的小伙伴可以下载下来，跑跑试试。</p><h3 data-tool="mdnice编辑器"><span>0.清控环境，加载包</span></h3><pre data-tool="mdnice编辑器"><code>rm(list = ls())<br><span>library</span>(edgeR)<br><span>library</span>(DESeq2)<br><span>library</span>(FactoMineR)<br><span>library</span>(factoextra)<br><span>library</span>(clusterProfiler)<br><span>library</span>(org.Hs.eg.db)<br><span>library</span>(org.Mm.eg.db)<br><span>library</span>(stringr)<br><span>library</span>(stringi)<br><span>library</span>(tidyverse)<br><span>library</span>(ggplot2)<br><span>library</span>(patchwork)<br><span>library</span>(pheatmap)<br><span>library</span>(VennDiagram)<br><span>library</span>(RColorBrewer)<br><span>library</span>(patchwork)<br><span>library</span>(ggplotify)<br></code></pre><h3 data-tool="mdnice编辑器"><span>1.读取数据，获得基因表达矩阵以及cpm矩阵</span></h3><pre data-tool="mdnice编辑器"><code>rawcount &lt;- read.table(<span>"./all.id.txt"</span>,header = <span>T</span>,sep=<span>"\t"</span>,row.names = <span>1</span>)<br>rawcount &lt;- rawcount[,<span>6</span>:<span>11</span>] <span>#根据列名，提取表达列与命名列名</span><br>colnames(rawcount)=c(<span>"shCon1"</span>,<span>"shCon2"</span>,<span>"shCon3"</span>,<span>"shCK51"</span>,<span>"shCK52"</span>,<span>"shCK53"</span>)<br>colnames(rawcount)<br><span>## [1] "shCon1" "shCon2" "shCon3" "shCK51" "shCK52" "shCK53"</span><br>rawcount[<span>1</span>:<span>4</span>,<span>1</span>:<span>4</span>]<br><span>##                 shCon1 shCon2 shCon3 shCK51</span><br><span>## ENSG00000186827      2      0      2      0</span><br><span>## ENSG00000186891      4     12     12      0</span><br><span>## ENSG00000160072   2327   2733   2752   1645</span><br><span>## ENSG00000260179      8     14      6     12</span><br>rawcount$median &lt;- apply(rawcount,<span>1</span>,median) <span>#先排序而后降重，保留最大值,一降版本号，二降多个ID对应一个Ensemble ID</span><br>rawcount$Ensmble=rownames(rawcount)<br>rawcount=rawcount[order(rawcount$Ensmble,rawcount$median,decreasing = <span>T</span>),] <br>rawcount=rawcount[!duplicated(rawcount$Ensmble),]<span>#排序后，降EnsemleID的重，降完EnsembleID转换</span><br><br>id2symbol &lt;- bitr(rownames(rawcount),   <span>##转换ID，22%有没有对应的symbole。</span><br>                  fromType = <span>"ENSEMBL"</span>, <br>                  toType = <span>"SYMBOL"</span>, <br>                  OrgDb = org.Hs.eg.db)<br>rawcount &lt;- cbind(GeneID=rownames(rawcount),rawcount) <span>#多一列换成基因ID</span><br>rawcount &lt;- merge(id2symbol,rawcount,<br>                  by.x=<span>"ENSEMBL"</span>,by.y=<span>"GeneID"</span>,all.y=<span>T</span>) <span>#有没匹配的，需去除NA</span><br>rawcount=rawcount[!duplicated(rawcount$SYMBOL),] <br>rawcount &lt;- drop_na(rawcount) <span>#去除含有NA值的行</span><br>rawcount &lt;- rawcount[,!colnames(rawcount)%<span>in</span>%c(<span>"ENSEMBL"</span>,<span>"Ensmble"</span>,<span>"median"</span>)]<span>#正式获得基因rawcount矩阵</span><br>rownames(rawcount) &lt;- rawcount$SYMBOL<br>rawcount &lt;- rawcount[,<span>2</span>:<span>7</span>]<br>keep &lt;- rowSums(rawcount&gt;<span>0</span>) &gt;= floor(<span>0.75</span>*ncol(rawcount))<br>filter_count &lt;- rawcount[keep,] <span>#获得filter_count矩阵</span><br>express_cpm &lt;- log2(cpm(filter_count)+ <span>1</span>)<br>express_cpm[<span>1</span>:<span>4</span>,<span>1</span>:<span>4</span>] <span>#获得cpm矩阵</span><br><span>##            shCon1   shCon2   shCon3   shCK51</span><br><span>## TSPAN6   3.894868 3.909638 3.898333 4.973152</span><br><span>## DPM1     6.094633 6.023308 6.107927 6.271558</span><br><span>## SCYL3    3.226588 3.156117 3.333095 3.365107</span><br><span>## C1orf112 4.977671 4.996168 4.777207 4.675710</span><br></code></pre><h3 data-tool="mdnice编辑器"><span>2.获取分组信息</span></h3><pre data-tool="mdnice编辑器"><code><span>#根据列的信息，提取分组信息</span><br>colnames(rawcount) <br><span>## [1] "shCon1" "shCon2" "shCon3" "shCK51" "shCK52" "shCK53"</span><br>group=rep(c(<span>"shCon"</span>,<span>"shCK5"</span>),each=<span>3</span>)<br>group<br><span>## [1] "shCon" "shCon" "shCon" "shCK5" "shCK5" "shCK5"</span><br>group_list=factor(group,levels = c(<span>"shCon"</span>,<span>"shCK5"</span>))<br>table(group_list)<span>#检查一下组别数量</span><br><span>## group_list</span><br><span>## shCon shCK5 </span><br><span>##     3     3</span><br></code></pre><h3 data-tool="mdnice编辑器"><span>3.初看两组分析的数据与样本分组分布（箱线图与PCA图）</span></h3><pre data-tool="mdnice编辑器"><code><span>## 01绘制箱线图</span><br>exprSet &lt;- express_cpm<br>data &lt;- data.frame(expression=c(exprSet),<br>                   sample=rep(colnames(exprSet),each=nrow(exprSet)))<br>p1 &lt;- ggplot(data = data,aes(x=sample,y=expression,fill=sample))+ geom_boxplot() + theme(axis.text.x = element_text(angle = <span>90</span>)) + <br>  xlab(<span>NULL</span>) + ylab(<span>"log2(CPM+1)"</span>)+theme_bw()<br><span>## 02绘制PCA图</span><br>dat &lt;- express_cpm<br>dat &lt;- as.data.frame(t(dat))<br>dat &lt;- na.omit(dat)<br>dat$group_list &lt;- group_list<br>dat_pca &lt;- PCA(dat[,-ncol(dat)], graph = <span>FALSE</span>)<span>#画图仅需数值型数据，去掉最后一列的分组信息</span><br>p2 &lt;- fviz_pca_ind(dat_pca,<br>                   geom.ind = <span>"point"</span>, <span># 只显示点，不显示文字</span><br>                   col.ind = dat$group_list, <span># 用不同颜色表示分组</span><br>                   palette = c(<span>"#00AFBB"</span>, <span>"#E7B800"</span>),<br>                   addEllipses = <span>T</span>, <span># 是否圈起来，少于4个样圈不起来</span><br>                   legend.title = <span>"Groups"</span>) + theme_bw()<br>p1+p2<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.7142857142857143" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9rzNz4icibksH6ibHg1H0jjic5ds1P6vNpudG4ArdRfPdib5jDXLWwZUibRlyJ9UQpsicN7DI4QP7icVicRicg/640?wx_fmt=png" data-type="png" data-w="672" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9rzNz4icibksH6ibHg1H0jjic5ds1P6vNpudG4ArdRfPdib5jDXLWwZUibRlyJ9UQpsicN7DI4QP7icVicRicg/640?wx_fmt=png"></figure><h3 data-tool="mdnice编辑器"><span>4.通过热图聚类，看存在P值为零的样本组间差异</span></h3><pre data-tool="mdnice编辑器"><code><span>## p3CorPheatmap(样本相关性热图)</span><br>exprSet &lt;- express_cpm<br><span>library</span>(corrplot)<br><span># 先计算相关性</span><br>M &lt;- cor(exprSet)<br><span># 绘制样本相关性的热图</span><br><span>library</span>(pheatmap)<br>anno &lt;- data.frame(sampleType=group_list)<br>rownames(anno) &lt;- colnames(exprSet)<br>p3 &lt;- pheatmap::pheatmap(M,display_numbers = <span>T</span>,<br>                         annotation_col = anno,<br>                         fontsize = <span>12</span>,cellheight = <span>30</span>,<br>                         cellwidth = <span>30</span>,cluster_rows = <span>T</span>,<br>                         cluster_cols = <span>T</span>)<br>p3<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.7142857142857143" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9rzNz4icibksH6ibHg1H0jjic5PFWjKWQtQOMN19NT33vaJ9BvcEctbypdXLUdWvMu3MtgGCnFwSmGLw/640?wx_fmt=png" data-type="png" data-w="672" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9rzNz4icibksH6ibHg1H0jjic5PFWjKWQtQOMN19NT33vaJ9BvcEctbypdXLUdWvMu3MtgGCnFwSmGLw/640?wx_fmt=png"><strong><span>shCon组与shCK5处理组两组之间的样本存在显著差异</span></strong></figure><h3 data-tool="mdnice编辑器"><span>5.利用edgeR与limma进行差异分析</span></h3><p data-tool="mdnice编辑器"><span><strong>重点看head对应的P值为零的情况以及P值为零的原始count值表达情况</strong></span>，从中可以看出上调基因组中的shCon组相较于shCK5存在巨大的差异。table(DEG_edgeR$regulated)中有<span><strong>3470个下调与4554个上调</strong></span>；20000多个基因竟然有将近8000个差异基因，这说明大量P值为零的话，存在大量差异基（超过5000个）以及P值为零时正常组与疾病组基因表达量存在显著差异，<span><strong>两组中可能很多表达为零或者表达量显著下调</strong></span>。</p><pre data-tool="mdnice编辑器"><code>exprSet &lt;- filter_count<br>design &lt;- model.matrix(~<span>0</span>+rev(factor(group_list))) <br>rownames(design) &lt;- colnames(exprSet)<br>colnames(design) &lt;- levels(factor(group_list))<br>DEG &lt;- DGEList(counts=exprSet,  <span>#构建edgeR的DGEList对象</span><br>               group=factor(group_list))<br>DEG$samples$lib.size <br><span>## [1] 68177629 72779922 76340908 60835268 67425139 63200342</span><br>DEG &lt;- calcNormFactors(DEG)<br>DEG$samples$norm.factors<br><span>## [1] 0.9629136 0.9504745 0.9445087 1.0515069 1.0510786 1.0466920</span><br><span># 计算线性模型的参数</span><br>DEG &lt;- estimateGLMCommonDisp(DEG,design)<br>DEG &lt;- estimateGLMTrendedDisp(DEG, design)<br>DEG &lt;- estimateGLMTagwiseDisp(DEG, design)<br><span># 拟合线性模型</span><br>fit &lt;- glmFit(DEG, design)<br>lrt &lt;- glmLRT(fit, contrast=c(<span>1</span>,-<span>1</span>)) <br><span># 提取过滤差异分析结果</span><br>DEG_edgeR &lt;- as.data.frame(topTags(lrt, n=nrow(DEG)))<br>head(DEG_edgeR)<br><span>##              logFC   logCPM        LR PValue FDR</span><br><span>## MGRN1    -13.52685 5.335601 10459.305      0   0</span><br><span>## ADAMTS12 -13.36525 5.963147 13911.774      0   0</span><br><span>## TCEAL9   -13.33841 5.148001  7789.511      0   0</span><br><span>## COL6A1   -13.05175 7.776522 26250.568      0   0</span><br><span>## BEX3     -12.93606 5.535200 10792.648      0   0</span><br><span>## IGFBP1   -12.64965 4.462320  4949.084      0   0</span><br><span># 设定阈值，筛选显著上下调差异基因</span><br>fc &lt;- <span>2.0</span><br>p &lt;- <span>0.05</span><br>DEG_edgeR$regulated &lt;- ifelse(DEG_edgeR$logFC&gt;log2(fc)&amp;DEG_edgeR$PValue&lt;p,<br>                              <span>"up"</span>,ifelse(DEG_edgeR$logFC&lt;(-log2(fc))&amp;DEG_edgeR$PValue&lt;p,<span>"down"</span>,<span>"normal"</span>))<br><span>## 取出其p值为零的情况，看其整体表达情况</span><br>head(DEG_edgeR[DEG_edgeR$regulated==<span>'up'</span>,])<br><span>##           logFC   logCPM        LR PValue FDR regulated</span><br><span>## CLCA2  8.002057 3.339633  2229.040      0   0        up</span><br><span>## IGFBP5 7.703890 8.270502 23674.848      0   0        up</span><br><span>## S100A8 7.614268 5.160717  6688.843      0   0        up</span><br><span>## FRY    7.433570 4.839635  7398.049      0   0        up</span><br><span>## APCDD1 7.370616 4.597174  5841.049      0   0        up</span><br><span>## EN1    7.331482 2.485849  1617.960      0   0        up</span><br>pgene=c(<span>'CLCA2'</span>,<span>'IGFBP5'</span>,<span>'S100A8'</span>,<span>'FRY'</span>,<span>'APCDD1'</span>,<span>'EN1'</span>)<br>filter_count[rownames(filter_count)%<span>in</span>%pgene,]<br><span>##        shCon1 shCon2 shCon3 shCK51 shCK52 shCK53</span><br><span>## FRY        24     19     25   3628   4117   3741</span><br><span>## IGFBP5    189    198    223  38124  43886  41643</span><br><span>## CLCA2       7      4      5   1404   1313   1352</span><br><span>## S100A8     28     26     21   4814   5055   4472</span><br><span>## APCDD1     19     25     16   2998   3430   3281</span><br><span>## EN1         2     12      0    721    765    762</span><br>table(DEG_edgeR$regulated)<br><span>## </span><br><span>##   down normal     up </span><br><span>##   3470  11207   4554</span><br></code></pre><h3 data-tool="mdnice编辑器"><span>6.绘制edgeR分析的火山图与热图</span></h3><pre data-tool="mdnice编辑器"><code><span>## 01绘制普通版火山图</span><br>data &lt;- DEG_edgeR<br>colnames(data)<br><span>## [1] "logFC"     "logCPM"    "LR"        "PValue"    "FDR"       "regulated"</span><br><span>library</span>(ggplot2)<br>p4 &lt;- ggplot(data=data, aes(x=logFC, y=-log10(PValue),color=regulated)) + <br>  geom_point(alpha=<span>0.5</span>, size=<span>1.8</span>) + <br>  theme_set(theme_set(theme_bw(base_size=<span>20</span>))) + <br>  xlab(<span>"log2FC"</span>) + ylab(<span>"-log10(Pvalue)"</span>) +<br>  scale_colour_manual(values = c(<span>'blue'</span>,<span>'black'</span>,<span>'red'</span>))+theme_bw()<br><br><span>## 02绘制edgeR利用p值进行差异分析的热图</span><br>edgeR1_sigGene1 &lt;- DEG_edgeR[DEG_edgeR$regulated!=<span>"normal"</span>,]<br>edgeR1_sigGene1 &lt;-rownames(edgeR1_sigGene1)<br>dat1 &lt;- express_cpm[match(edgeR1_sigGene1,rownames(express_cpm)),]<br>dat1[<span>1</span>:<span>4</span>,<span>1</span>:<span>4</span>]<br><span>##            shCon1   shCon2   shCon3     shCK51</span><br><span>## MGRN1    6.289553 6.268774 6.276105 0.02352198</span><br><span>## ADAMTS12 6.928395 6.874852 6.899380 0.04666660</span><br><span>## TCEAL9   6.055717 6.073327 6.144717 0.00000000</span><br><span>## COL6A1   8.690808 8.705545 8.728090 0.00000000</span><br>group1 &lt;- data.frame(group=group_list)<br>rownames(group1)=colnames(dat1)<br><span># 绘制热图</span><br><span>library</span>(pheatmap)<br>p5 &lt;- pheatmap(dat1,scale = <span>"row"</span>,show_colnames =<span>T</span>,show_rownames = <span>F</span>, <br>                 cluster_cols = <span>T</span>, <br>                 annotation_col=group1,<br>                 main = <span>"edgeR's DEG"</span>,<br>               color = colorRampPalette(colors = c(<span>"blue"</span>,<span>"white"</span>,<span>"red"</span>))(<span>100</span>))<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.5937961595273265" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9rzNz4icibksH6ibHg1H0jjic5WCwShDCuLojXXS0iczUBe0gFhhcG0dc2r4sd1yCwsAbBIUlvEuw5Q5g/640?wx_fmt=png" data-type="png" data-w="677" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9rzNz4icibksH6ibHg1H0jjic5WCwShDCuLojXXS0iczUBe0gFhhcG0dc2r4sd1yCwsAbBIUlvEuw5Q5g/640?wx_fmt=png"></figure><pre data-tool="mdnice编辑器"><code>p5 &lt;- as.ggplot(p5)<br>(plot_spacer()/p4+plot_layout(heights = c(<span>1</span>, <span>8</span>)))|(p5)<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.5882352941176471" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9rzNz4icibksH6ibHg1H0jjic5PBxhicWWhjPg4e4ok38rTayySXPibiaiaarBaXn7GHSuEyedffPlZyJibibA/640?wx_fmt=png" data-type="png" data-w="952" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9rzNz4icibksH6ibHg1H0jjic5PBxhicWWhjPg4e4ok38rTayySXPibiaiaarBaXn7GHSuEyedffPlZyJibibA/640?wx_fmt=png"></figure><h3 data-tool="mdnice编辑器"><span>7.对整体差异基因进行GO与KEGG富集分析</span></h3><pre data-tool="mdnice编辑器"><code><span>## 00.清空环境，加载包</span><br><span>library</span>(clusterProfiler)<br><span>library</span>(org.Hs.eg.db)<br>R.utils::setOption( <span>"clusterProfiler.download.method"</span>,<span>'auto'</span> ) <span>#富集必须</span><br><br><span>## 01.输入数据准备</span><br>DEG_edgeR1=DEG_edgeR<br>edgeR1_sigGene &lt;- DEG_edgeR1[DEG_edgeR1$regulated!=<span>"normal"</span>,]<br>DEG &lt;- rownames(edgeR1_sigGene)<br>gene_all &lt;- rownames(filter_count)<br>keytypes(org.Hs.eg.db) <span>#可看具体能够转换的类型</span><br><span>##  [1] "ACCNUM"       "ALIAS"        "ENSEMBL"      "ENSEMBLPROT"  "ENSEMBLTRANS"</span><br><span>##  [6] "ENTREZID"     "ENZYME"       "EVIDENCE"     "EVIDENCEALL"  "GENENAME"    </span><br><span>## [11] "GENETYPE"     "GO"           "GOALL"        "IPI"          "MAP"         </span><br><span>## [16] "OMIM"         "ONTOLOGY"     "ONTOLOGYALL"  "PATH"         "PFAM"        </span><br><span>## [21] "PMID"         "PROSITE"      "REFSEQ"       "SYMBOL"       "UCSCKG"      </span><br><span>## [26] "UNIPROT"</span><br><br><span>## 02将Symble ID转换为Entreze ID</span><br>allID &lt;- bitr(gene_all, fromType = <span>"SYMBOL"</span>, <br>              toType = c( <span>"ENTREZID"</span> ), <br>              OrgDb = org.Hs.eg.db )<br>degID &lt;- bitr(DEG, fromType = <span>"SYMBOL"</span>, <br>              toType = c( <span>"ENTREZID"</span> ), <br>              OrgDb = org.Hs.eg.db )<br><span>## 03富集并绘制差异基因的KEGG富集结果与GO富集结果</span><br>enrich &lt;- enrichKEGG(gene =degID[,<span>2</span>],<br>                     organism=<span>'hsa'</span>,<br>                     universe=allID[,<span>2</span>],<br>                     pvalueCutoff=<span>1</span>,<br>                     qvalueCutoff=<span>1</span>)<br>p6 &lt;- barplot(enrich,showCategory=1<span>0</span>,title=<span>"KEGG Pathway"</span>,<br>               colorBy=<span>"p.adjust",font.size = 21,label_format = 15</span>)+scale_fill_gradient(low=<span>"#DC0000B2"</span>,high =<span>"#00A087B2"</span> )<br><span># GO富集分析</span><br>enrich_all &lt;- enrichGO(gene = degID[,<span>2</span>],OrgDb= <span>'org.Hs.eg.db'</span>,ont = <span>"ALL"</span>,<br>                       universe=allID[,<span>2</span>],pvalueCutoff=<span>1</span>,qvalueCutoff=<span>1</span>)<span>#GO的3个过程都画</span><br>p7 &lt;- barplot(enrich_all ,showCategory=1<span>0</span>,title=<span>"GO enrichment"</span>,colorBy=<span>"p.adjust",font.size = 21,label_format = 15</span>)+<br>  scale_fill_gradient(low=<span>"#925E9FFF"</span>,high =<span>"#42B540FF"</span> )<br>p6+p7<br></code></pre><p><br></p><p><img data-galleryid="" data-ratio="0.75" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9rzNz4icibksH6ibHg1H0jjic5mTyqg98kZE9UBNHE2h0SBsAcnExdicrr3QGEMNvQnsQ1BspicvSKsVFQ/640?wx_fmt=png" data-type="png" data-w="6400" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9rzNz4icibksH6ibHg1H0jjic5mTyqg98kZE9UBNHE2h0SBsAcnExdicrr3QGEMNvQnsQ1BspicvSKsVFQ/640?wx_fmt=png"></p><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><h3 data-tool="mdnice编辑器"><span>8.对上下调差异基因分别进行GO与KEGG富集分析</span></h3><pre data-tool="mdnice编辑器"><span></span><code><span># 1.先看下调差异基因的GO与KEGG富集情况</span><br><span>## 01.输入数据准备</span><br>edgeR1_sigGenedown &lt;- DEG_edgeR1[DEG_edgeR1$regulated==<span>"down"</span>,]<br>DEGdown &lt;- rownames(edgeR1_sigGenedown)<br>gene_all &lt;- rownames(filter_count)<br>keytypes(org.Hs.eg.db) <span>#可看具体能够转换的类型</span><br><br><span>## 02将Symble ID转换为Entreze ID</span><br>degIDdown &lt;- bitr(DEGdown, fromType = <span>"SYMBOL"</span>, <br>              toType = c( <span>"ENTREZID"</span> ), <br>              OrgDb = org.Hs.eg.db )<br><span>## 03富集并绘制差异基因的KEGG富集结果与GO富集结果</span><br>enrich_down &lt;- enrichKEGG(gene =degIDdown[,<span>2</span>],<br>                     organism=<span>'hsa'</span>,<br>                     universe=allID[,<span>2</span>],<br>                     pvalueCutoff=<span>1</span>,<br>                     qvalueCutoff=<span>1</span>)<br>p9 &lt;- barplot(enrich_down,showCategory=<span>10</span>,title=<span>"KEGG Pathway"</span>,<br>              colorBy=<span>"p.adjust"</span>,font.size = <span>21</span>,label_format = <span>15</span> )+scale_fill_gradient(low=<span>"#DC0000B2"</span>,high =<span>"#00A087B2"</span> )<br>p9<br>enrich_all_down &lt;- enrichGO(gene = degIDdown[,<span>2</span>],OrgDb= <span>'org.Hs.eg.db'</span>,ont = <span>"ALL"</span>,<br>                       universe=allID[,<span>2</span>],pvalueCutoff=<span>1</span>,qvalueCutoff=<span>1</span>)<span>#GO的3个过程都画</span><br>p10 &lt;- barplot(enrich_all_down ,showCategory=<span>10</span>,title=<span>"GO enrichment"</span>,colorBy=<span>"p.adjust"</span>,font.size = <span>21</span>,label_format = <span>15</span>)+<br>  scale_fill_gradient(low=<span>"#925E9FFF"</span>,high =<span>"#42B540FF"</span> )<br>p10<br>p9+p10<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.75" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9rzNz4icibksH6ibHg1H0jjic5yad8Rr6beglicXWfFjCIHeVFYMr1J8l3icZIynW1xBjJNZNZic5RDkIrQ/640?wx_fmt=png" data-type="png" data-w="6400" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9rzNz4icibksH6ibHg1H0jjic5yad8Rr6beglicXWfFjCIHeVFYMr1J8l3icZIynW1xBjJNZNZic5RDkIrQ/640?wx_fmt=png"></figure><pre data-tool="mdnice编辑器"><span></span><code><span># 2.再看上调差异基因的富集情况</span><br><span>## 01.输入数据准备</span><br>edgeR1_sigGeneup &lt;- DEG_edgeR1[DEG_edgeR1$regulated==<span>"up"</span>,]<br>DEGup &lt;- rownames(edgeR1_sigGeneup)<br>gene_all &lt;- rownames(filter_count)<br>keytypes(org.Hs.eg.db) <span>#可看具体能够转换的类型</span><br><br><span>## 02将Symble ID转换为Entreze ID</span><br>degIDup &lt;- bitr(DEGup, fromType = <span>"SYMBOL"</span>, <br>                  toType = c( <span>"ENTREZID"</span> ), <br>                  OrgDb = org.Hs.eg.db )<br><span>## 03富集并绘制差异基因的KEGG富集结果与GO富集结果</span><br>enrich_up &lt;- enrichKEGG(gene =degIDup[,<span>2</span>],<br>                          organism=<span>'hsa'</span>,<br>                          universe=allID[,<span>2</span>],<br>                          pvalueCutoff=<span>1</span>,<br>                          qvalueCutoff=<span>1</span>)<br>p11 &lt;- barplot(enrich_up,showCategory=<span>10</span>,title=<span>"KEGG Pathway"</span>,<br>               colorBy=<span>"p.adjust"</span>,font.size = <span>21</span>,label_format = <span>20</span>)+scale_fill_gradient(low=<span>"#DC0000B2"</span>,high =<span>"#00A087B2"</span> )<br>p11<br>enrich_all_up &lt;- enrichGO(gene = degIDup[,<span>2</span>],OrgDb= <span>'org.Hs.eg.db'</span>,ont = <span>"ALL"</span>,<br>                            universe=allID[,<span>2</span>],pvalueCutoff=<span>1</span>,qvalueCutoff=<span>1</span>)<span>#GO的3个过程都画</span><br>p12 &lt;- barplot(enrich_all_up ,showCategory=<span>10</span>,title=<span>"GO enrichment"</span>,colorBy=<span>"p.adjust"</span>,font.size = <span>21</span>,label_format = <span>20</span>)+<br>  scale_fill_gradient(low=<span>"#925E9FFF"</span>,high =<span>"#42B540FF"</span> )<br>p12<br>p11+p12<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.75" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9rzNz4icibksH6ibHg1H0jjic5WA9c2kgYopbdY9DBYb1QwtibasftR6USKtzmNboClDQLugiadbh0qPCg/640?wx_fmt=png" data-type="png" data-w="6400" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9rzNz4icibksH6ibHg1H0jjic5WA9c2kgYopbdY9DBYb1QwtibasftR6USKtzmNboClDQLugiadbh0qPCg/640?wx_fmt=png"></figure></section><p data-tool="mdnice编辑器">以上就是P值窜天高背后内容的探究。接下来，就让我们基于开头提出的四个角度进行回顾，并分析一下作者的测序结果。</p><p data-tool="mdnice编辑器"><strong>首先是第一个角度（样本相关性）</strong>，3与4的PCA结果与样本热图聚类结果可以看出处理组shCK5与对照组shCon存在显著差异；<strong>第二个角度（差异基因数量），</strong>5中利用edgeR进行差异分析的差异分析结果表明处理组相较于对照组存在显著差异，竟然有超过8000个<strong>差异基因</strong>，想想目前人只有20000多个基因；<strong>第三个角度（差异基因表达），</strong>5中可以看见对照组与处理组P值为零的情况下，两者的基因表达量存在显著区别（某一组绝对的低表达）。<strong>最后一个角度（通路富集）</strong>，我们可以看见KEGG通路富集分析的结果表明神经激活性配受体、蛋白消化与降解以及细胞粘附分子等通路发生显著变化；GO富集分析结果表明趋化因子、血液循环与循环通路过程发生显著变化。</p><p data-tool="mdnice编辑器"><strong>关于最后一个<span>角度</span>富集分析</strong>，起初我为了图省事只是展示了一下差异基因的GO与KEGG富集结果，但是整体差异基因富集的结果并不能说明作者欲探究的科学问题。曾老师一看完结果就告诉我<span><strong>应该分别对上下调差异基因进行GO与KEGG富集分析</strong></span>。因此，我进一步对上下调差异基因进行了GO与KEGG富集分析，结果如表格中所示。</p><table><tbody><tr><td width="557" valign="top"><strong>从GO富集的结果中可以看出，</strong><span>上调基因主要显著富集于如cell-cell adhesion via plasma membrane等</span><span>与粘附相关的通路</span><span>，下调差异基因主要显著富集于如positive regulation of migration等</span><span>与侵袭迁移相关的通路</span><span>；</span><strong>KEGG的富集结果表明,</strong><span>下调显著差异基因主要富集于如PI3K-AKT</span><span>等促侵袭迁移的通路中</span><span>，而上调差异基因主要显著富集于如Cell adhesion molecues</span><span>等与粘附相关的通路</span><span>。</span><strong>上下调差异基因分别的富集结果均表明，敲除CK5抑制肿瘤细胞侵袭</strong><span>，</span><strong>这说明作者的转录组测序结果挺不错的</strong><span>。</span></td></tr></tbody></table><p><br></p><p><span>由于</span><span>小</span><span>编的生物学背景不足，KEGG富集的结果小编通过蛋白消化与降解猜测其可能与迁移相关；</span><span>但是小编这里存在</span><strong><span>一个</span></strong><strong><span>疑问</span></strong><span>，</span><strong>为什么GO富集结果中许多显著差异通路与循环相关</strong><strong>，</strong><strong>此研究不是主要集中在细胞水平吗，与循环有何关系呢，如果需要解释的话，是否能说癌细胞也能分泌一些与循环相关的因子，在动物水平能够促进血管生成，促进癌症的侵袭与迁移呢？</strong><span>希望有这方面知识的小伙伴可以谈谈自身的观点，感兴趣的小伙伴可以试试进一步挖掘下，看看能不能发现P值窜天高现象背后存在的新规律。</span><br></p><p><br></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/JOuyKGXttlOIXrG7ozglyw",target="_blank" rel="noopener noreferrer">原文链接</a>
