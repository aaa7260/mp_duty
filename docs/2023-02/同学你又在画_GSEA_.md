---
title: "同学你又在画 GSEA?"
date: 2023-02-20T15:15:02Z
draft: ["false"]
tags: [
  "fetched",
  "老俊俊的生信笔记"
]
categories: ["Acdemic"]
---
同学你又在画 GSEA? by 老俊俊的生信笔记
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-mpa-powered-by="yiban.io"><h4 data-tool="mdnice编辑器"><span></span></h4><section><mp-common-profile data-pluginname="mpprofile" data-weui-theme="light" data-id="MzkyMTI1MTYxNA==" data-headimg="http://mmbiz.qpic.cn/mmbiz_png/G5jjcE4usey42oX5qyLTVibLRO9dz8ic5G4TpEHQc9rICYlpS4MHg6Et8cgXrQDqibvibXombicTro8t9cekJRlDBcw/0?wx_fmt=png" data-nickname="老俊俊的生信笔记" data-alias="JunJunLab" data-signature="老俊俊的生信技能和知识分享,我不是巨人,但你可以站在我的肩膀上更进一步!" data-from="0" data-is_biz_ban="0"></mp-common-profile></section></section><section><p><img data-ratio="0.13333333333333333" data-src="https://mmbiz.qpic.cn/mmbiz_gif/wBb5fdnxUtWbzEQT65RpiaLBtjHDiaWQRSYCx5dhicDoHMVP42y7BjXnFgZM2IbMc7eAFnVn6ze4LqDD1E5NTdSoQ/640?wx_fmt=gif" data-type="gif" data-w="750" src="https://mmbiz.qpic.cn/mmbiz_gif/wBb5fdnxUtWbzEQT65RpiaLBtjHDiaWQRSYCx5dhicDoHMVP42y7BjXnFgZM2IbMc7eAFnVn6ze4LqDD1E5NTdSoQ/640?wx_fmt=gif"></p></section><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><h4 data-tool="mdnice编辑器"><span></span></h4><h2 data-tool="mdnice编辑器"><span><span>1</span></span><span>前言</span></h2><figure data-tool="mdnice编辑器"><img data-ratio="0.6430107526881721" data-src="https://mmbiz.qpic.cn/mmbiz_png/G5jjcE4usewfuPsDMeodr8fYQzCCtU1N1141P6icib4Yn4QHcAttEI79Ag8C2Rzm3G9eGr3hrEHnkiaSTAySbcaww/640?wx_fmt=png" data-type="png" data-w="930" src="https://mmbiz.qpic.cn/mmbiz_png/G5jjcE4usewfuPsDMeodr8fYQzCCtU1N1141P6icib4Yn4QHcAttEI79Ag8C2Rzm3G9eGr3hrEHnkiaSTAySbcaww/640?wx_fmt=png"></figure><blockquote data-tool="mdnice编辑器"><p><strong>下午干饭的时候,突然收到一封邮件,看起来这位英雄好汉体验感非常不舒服,直接骂我了(笑哭)</strong> 。<strong>我就是菜狗本狗,哈哈哈,又是元气满满的一天。</strong></p></blockquote><h2 data-tool="mdnice编辑器"><span><span>2</span></span><span>引言</span></h2><blockquote data-tool="mdnice编辑器"><p><strong>GseaVis</strong> 的常规图可以支持多通路可视化, 但是 <strong>新样式</strong> 的却只能单条通路展示, 于是写了个分面来展示多通路的可视化。</p></blockquote><p data-tool="mdnice编辑器"><strong>github 链接:</strong></p><blockquote data-tool="mdnice编辑器"><p><strong>https://github.com/junjunlab/GseaVis</strong></p></blockquote><h2 data-tool="mdnice编辑器"><span><span>3</span></span><span>安装</span></h2><pre data-tool="mdnice编辑器"><span></span><code><span># install.packages("devtools")</span><br>devtools::install_github(<span>"junjunlab/GseaVis"</span>)<br></code></pre><h2 data-tool="mdnice编辑器"><span><span>4</span></span><span>使用</span></h2><p data-tool="mdnice编辑器">首先加载内置数据:</p><pre data-tool="mdnice编辑器"><span></span><code><span>library</span>(GseaVis)<br><br><span># load data</span><br>test_data &lt;- system.file(<span>"extdata"</span>, <span>"gseaRes.RDS"</span>, package = <span>"GseaVis"</span>)<br>gseaRes &lt;- readRDS(test_data)<br></code></pre><p data-tool="mdnice编辑器">先画个常规的:</p><pre data-tool="mdnice编辑器"><span></span><code>setid &lt;- c(<span>"GOBP_REGULATION_OF_OSTEOCLAST_DIFFERENTIATION"</span>,<br>           <span>"GOBP_NEGATIVE_REGULATION_OF_MYELOID_CELL_DIFFERENTIATION"</span>,<br>           <span>"GOBP_REGULATION_OF_NEURON_MIGRATION"</span>,<br>           <span>"GOBP_POSITIVE_REGULATION_OF_TYPE_I_INTERFERON_PRODUCTION"</span>,<br>           <span>"GOBP_POLYSACCHARIDE_BIOSYNTHETIC_PROCESS"</span>)<br><br>gseaNb(object = gseaRes,<br>       geneSetID = setid,<br>       curveCol= jjAnno::useMyCol(<span>'stallion'</span>,<span>5</span>),<br>       subPlot = <span>2</span>,<br>       addPval = <span>T</span>,<br>       pvalX = <span>1</span>,<br>       pvalY = <span>1</span>)<br></code></pre><figure data-tool="mdnice编辑器"><img data-src="https://mmbiz.qpic.cn/mmbiz_png/G5jjcE4usewfuPsDMeodr8fYQzCCtU1Nia9NyKO8LAK367EAGaTWRfo7ZsBDkUtwm1wmFgGashyUD5lwpRicqZicA/640?wx_fmt=png" data-type="png" data-ratio="0.5601851851851852" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/G5jjcE4usewfuPsDMeodr8fYQzCCtU1Nia9NyKO8LAK367EAGaTWRfo7ZsBDkUtwm1wmFgGashyUD5lwpRicqZicA/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">新样式:</p><pre data-tool="mdnice编辑器"><span></span><code>gseaNb(object = gseaRes,<br>       geneSetID = setid,<br>       newGsea = <span>T</span>,<br>       rmHt = <span>T</span>)<br></code></pre><figure data-tool="mdnice编辑器"><img data-src="https://mmbiz.qpic.cn/mmbiz_png/G5jjcE4usewfuPsDMeodr8fYQzCCtU1N2hbKnMiaoEuwMIjzGeomomyeFDatZRkDlicgLic5VGZ7IbaTXsR2UZG3Q/640?wx_fmt=png" data-type="png" data-ratio="0.7161366313309776" data-w="849" src="https://mmbiz.qpic.cn/mmbiz_png/G5jjcE4usewfuPsDMeodr8fYQzCCtU1N2hbKnMiaoEuwMIjzGeomomyeFDatZRkDlicgLic5VGZ7IbaTXsR2UZG3Q/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">你可以调整左边通路的长度:</p><pre data-tool="mdnice编辑器"><span></span><code>gseaNb(object = gseaRes,<br>       geneSetID = setid,<br>       newGsea = <span>T</span>,<br>       rmHt = <span>T</span>,<br>       termWidth = <span>20</span>)<br></code></pre><figure data-tool="mdnice编辑器"><img data-src="https://mmbiz.qpic.cn/mmbiz_png/G5jjcE4usewfuPsDMeodr8fYQzCCtU1NicHJv7PhwXsDnqb4HNomjPBFHoBgOdTsO9ibDNLCrgVVqolJriaXhtMGQ/640?wx_fmt=png" data-type="png" data-ratio="0.6624113475177305" data-w="705" src="https://mmbiz.qpic.cn/mmbiz_png/G5jjcE4usewfuPsDMeodr8fYQzCCtU1NicHJv7PhwXsDnqb4HNomjPBFHoBgOdTsO9ibDNLCrgVVqolJriaXhtMGQ/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">保留纵坐标:</p><pre data-tool="mdnice编辑器"><span></span><code>gseaNb(object = gseaRes,<br>       geneSetID = setid,<br>       newGsea = <span>T</span>,<br>       rmHt = <span>T</span>,<br>       rm.newGsea.ticks = <span>F</span>)<br></code></pre><figure data-tool="mdnice编辑器"><img data-src="https://mmbiz.qpic.cn/mmbiz_png/G5jjcE4usewfuPsDMeodr8fYQzCCtU1NIVlK4rEUrRiaasLJDu7XIlibHEH9F9sU4DNms5zUaW0dV3xQf26PvleQ/640?wx_fmt=png" data-type="png" data-ratio="0.6754807692307693" data-w="832" src="https://mmbiz.qpic.cn/mmbiz_png/G5jjcE4usewfuPsDMeodr8fYQzCCtU1NIVlK4rEUrRiaasLJDu7XIlibHEH9F9sU4DNms5zUaW0dV3xQf26PvleQ/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">添加 P 值:</p><pre data-tool="mdnice编辑器"><span></span><code>gseaNb(object = gseaRes,<br>       geneSetID = setid,<br>       newGsea = <span>T</span>,<br>       addPval = <span>T</span>,<br>       rmHt = <span>T</span>,<br>       pvalX = <span>0.9</span>,<br>       pvalY = <span>0.5</span>,<br>       pFill = <span>"white"</span>)<br></code></pre><figure data-tool="mdnice编辑器"><img data-src="https://mmbiz.qpic.cn/mmbiz_png/G5jjcE4usewfuPsDMeodr8fYQzCCtU1NuMoX4Bx2dIuebu4w5cC8Zxq0KfxtYRhmShd7ROya4ydicd2Jw5E4Jhw/640?wx_fmt=png" data-type="png" data-ratio="0.9888111888111888" data-w="715" src="https://mmbiz.qpic.cn/mmbiz_png/G5jjcE4usewfuPsDMeodr8fYQzCCtU1NuMoX4Bx2dIuebu4w5cC8Zxq0KfxtYRhmShd7ROya4ydicd2Jw5E4Jhw/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">添加 TOP 基因:</p><pre data-tool="mdnice编辑器"><span></span><code>gseaNb(object = gseaRes,<br>       geneSetID = setid,<br>       newGsea = <span>T</span>,<br>       addPval = <span>T</span>,<br>       rmHt = <span>T</span>,<br>       pvalX = <span>0.8</span>,<br>       pvalY = <span>0.5</span>,<br>       pFill = <span>"white"</span>,<br>       addGene = <span>T</span>,<br>       markTopgene = <span>T</span>,<br>       geneCol = <span>"#009933"</span>)<br></code></pre><figure data-tool="mdnice编辑器"><img data-src="https://mmbiz.qpic.cn/mmbiz_png/G5jjcE4usewfuPsDMeodr8fYQzCCtU1N5XebZicXmqbb2XpDFaD874uH79XYDTKVJbrOxn0YCot8K3Isn1ElU5g/640?wx_fmt=png" data-type="png" data-ratio="0.9832635983263598" data-w="717" src="https://mmbiz.qpic.cn/mmbiz_png/G5jjcE4usewfuPsDMeodr8fYQzCCtU1N5XebZicXmqbb2XpDFaD874uH79XYDTKVJbrOxn0YCot8K3Isn1ElU5g/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">改变曲线颜色,可支持多个颜色向量:</p><pre data-tool="mdnice编辑器"><span></span><code>setid2 &lt;- c(<span>"GOBP_POSITIVE_REGULATION_OF_MUSCLE_HYPERTROPHY"</span>,<br>            <span>"GOBP_BIOLOGICAL_PROCESS_INVOLVED_IN_INTERACTION_WITH_SYMBIONT"</span>,<br>            <span>"GOBP_POSITIVE_REGULATION_OF_LEUKOCYTE_MIGRATION"</span>,<br>            <span>"GOBP_REGULATION_OF_MACROPHAGE_DIFFERENTIATION"</span>,<br>            <span>"GOBP_METANEPHRIC_NEPHRON_MORPHOGENESIS"</span>)<br><br>gseaNb(object = gseaRes,<br>       geneSetID = setid2,<br>       newGsea = <span>T</span>,<br>       addPval = <span>T</span>,<br>       rmHt = <span>T</span>,<br>       pvalX = <span>0.8</span>,<br>       pvalY = <span>0.5</span>,<br>       pFill = <span>"transparent"</span>,<br>       addGene = <span>T</span>,<br>       markTopgene = <span>T</span>,<br>       geneCol = <span>"#009933"</span>,<br>       newCurveCol = rainbow(<span>7</span>))<br></code></pre><figure data-tool="mdnice编辑器"><img data-src="https://mmbiz.qpic.cn/mmbiz_png/G5jjcE4usewfuPsDMeodr8fYQzCCtU1NFKibfyfOe58iawtWDNDCENbaFONERCmQpcHTBXAmBrb4nnGpg3hnltaw/640?wx_fmt=png" data-type="png" data-ratio="0.9762900976290098" data-w="717" src="https://mmbiz.qpic.cn/mmbiz_png/G5jjcE4usewfuPsDMeodr8fYQzCCtU1NFKibfyfOe58iawtWDNDCENbaFONERCmQpcHTBXAmBrb4nnGpg3hnltaw/640?wx_fmt=png"></figure><h2 data-tool="mdnice编辑器"><span><span>5</span></span><span>结尾</span></h2><blockquote data-tool="mdnice编辑器"><p><strong>如果有任何疑问或者建议,欢迎在 github 留言!</strong></p></blockquote><hr data-tool="mdnice编辑器"><p data-tool="mdnice编辑器">欢迎加入生信交流群。加我微信我也拉你进 <strong>微信群聊</strong> <strong>老俊俊生信交流群</strong> <strong>(微信交流群需收取 20 元入群费用,一旦交费,拒不退还!(防止骗子和便于管理))</strong> 。QQ 群可免费加入, 记得进群按格式修改备注哦。</p><section data-tool="mdnice编辑器"><section><p><strong>老俊俊微信：</strong></p><figure><img data-src="https://mmbiz.qpic.cn/mmbiz_png/G5jjcE4usewfuPsDMeodr8fYQzCCtU1NGicSnMjFq0V8g0tzu1ShBiayIeQicxxqDkRy67Nbp4WwKaRXmomkA0e4A/640?wx_fmt=png" data-type="png" data-ratio="1" data-w="430" src="https://mmbiz.qpic.cn/mmbiz_png/G5jjcE4usewfuPsDMeodr8fYQzCCtU1NGicSnMjFq0V8g0tzu1ShBiayIeQicxxqDkRy67Nbp4WwKaRXmomkA0e4A/640?wx_fmt=png"></figure><figure><img data-src="https://mmbiz.qpic.cn/mmbiz_png/G5jjcE4usewfuPsDMeodr8fYQzCCtU1ND3R7yIBexGgvq8GtfqCObxSpAyLyAcoLSjZ4wyz1gw1upd1N9Ffuhw/640?wx_fmt=png" data-type="png" data-ratio="1.3668430335097002" data-w="567" src="https://mmbiz.qpic.cn/mmbiz_png/G5jjcE4usewfuPsDMeodr8fYQzCCtU1ND3R7yIBexGgvq8GtfqCObxSpAyLyAcoLSjZ4wyz1gw1upd1N9Ffuhw/640?wx_fmt=png"></figure></section><section><p><strong>知识星球：</strong></p><figure><img data-src="https://mmbiz.qpic.cn/mmbiz_jpg/G5jjcE4usewfuPsDMeodr8fYQzCCtU1NBRG3qXqPEBTz54DkvS8OsqoTwxy5otoIHhAccAtjgxAAXibibDxxLNfg/640?wx_fmt=jpeg" data-type="jpeg" data-ratio="1.5896226415094339" data-w="1060" src="https://mmbiz.qpic.cn/mmbiz_jpg/G5jjcE4usewfuPsDMeodr8fYQzCCtU1NBRG3qXqPEBTz54DkvS8OsqoTwxy5otoIHhAccAtjgxAAXibibDxxLNfg/640?wx_fmt=jpeg"></figure></section></section><hr data-tool="mdnice编辑器"><p data-tool="mdnice编辑器"><br></p><center data-tool="mdnice编辑器"><strong> 往期回顾目录</strong></center><blockquote data-tool="mdnice编辑器"><ul><li><section><strong><center><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247507849&amp;idx=1&amp;sn=9b1a2afe2afce59cb22e3e3994a915d2&amp;chksm=c184e5f8f6f36cee333855c25536ec92c5770d7d58220af9eb75c3a04a5bce088b8bb1205b41&amp;token=495330596&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">R 语言中的 S3/S4 类</a></center></strong></section></li><li><section><strong><center><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247507821&amp;idx=1&amp;sn=183615ca33d377c497db95632819dddb&amp;chksm=c184e51cf6f36c0a29d0c6a074eb6aadeddf5d1a2284860f2dcd6c4a6b370d0352acba806dcc&amp;token=495330596&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">transPlotR 展示代表性转录本</a></center></strong></section></li><li><section><strong><center><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247507775&amp;idx=1&amp;sn=fd045c97d302621d4760dbed6cf0929c&amp;chksm=c184e54ef6f36c584b7a06b422c6a822f308c511b1bd8e2911720f4667303e7d45ff0979a5d1&amp;token=158906776&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">云雨一下?</a></center></strong></section></li><li><section><strong><center><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247507735&amp;idx=1&amp;sn=d8236c12a07beecc5d6c181b196a9a78&amp;chksm=c184e566f6f36c7072f382be27259127b4fa9c0b1228c891f5cfc35869861b3d9b8f6e9b0824&amp;token=158906776&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">bugs 报告和修复</a></center></strong></section></li><li><section><strong><center><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247507659&amp;idx=1&amp;sn=1ab71d31c3b805a09de88f2eaf955c95&amp;chksm=c184e4baf6f36dac6fd5a322f351a09e1ea4d351ededa6b0f28b23e6a8fb3eb654fd04fab143&amp;token=139164705&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">合并生物学重复 bigwig 文件简化作图</a></center></strong></section></li><li><section><strong><center><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247507643&amp;idx=1&amp;sn=704c5dd5ec052bb99c34b08efc876916&amp;chksm=c184e4caf6f36ddc92c10e6f41887c2c5b704f96d75dd9fa57b5ff5d2e0ecb94f2996a787071&amp;token=139164705&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">WiggleTools 处理 bigwig/wig 文件好帮手</a></center></strong></section></li><li><section><strong><center><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247507552&amp;idx=1&amp;sn=57aacb748fb168a180d2569348eb9ee8&amp;chksm=c184e411f6f36d07f490d6dd2753cb717b762f8f9c5b23d06542569dd396ba7d363b926412a0&amp;token=1411764085&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">ggplate 优雅的可视化 culture plates</a></center></strong></section></li><li><section><strong><center><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247507518&amp;idx=1&amp;sn=99c95f7e874699f20489b62933a7fc9e&amp;chksm=c184e44ff6f36d59c5dee40889b8204896c71a32f02faec96946f3a971a660cf0b2cd8fb6039&amp;payreadticket=HIQRHXbxh8oH_23UPa6nk9zBwAhs-r_M_qtotZYPBTOJ3Y_ZyI0c5v5ilml8s043FMLWAgU&amp;scene=21#wechat_redirect" data-linktype="2">使用 ggplot2 美化 lasso 图</a></center></strong></section></li><li><section><strong><center><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247507465&amp;idx=1&amp;sn=b6211b024d0b2715d0b3d181443b3588&amp;chksm=c184e478f6f36d6ebb8b2d9ef2d7e598185cc1e22717e742ce0c7224fa9c2249e5f18931cf0e&amp;token=341747724&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">将多分组 KM 曲线两两比较的结果添加到生存曲线图中</a></center></strong></section></li><li><section><strong><center><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247507435&amp;idx=1&amp;sn=d3ee6268f58e1f2f6408c5c3615a8499&amp;chksm=c184e79af6f36e8c9a13b16c0b7836253b35114cc76d2acfdaa28f6520ddf3d3ac0de0c0e3c4&amp;token=450867742&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">经验贝叶斯分层模型鉴定 m6A 修饰</a></center></strong></section></li></ul></blockquote></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/pu0iDZcshjmPMvoqGPP_0A",target="_blank" rel="noopener noreferrer">原文链接</a>
