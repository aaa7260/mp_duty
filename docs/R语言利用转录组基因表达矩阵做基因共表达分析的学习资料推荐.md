---
title: "R语言利用转录组基因表达矩阵做基因共表达分析的学习资料推荐"
date: 2022-10-12T04:41:31Z
draft: ["false"]
tags: [
  "fetched",
  "小明的数据分析笔记本"
]
categories: ["Acdemic"]
---
R语言利用转录组基因表达矩阵做基因共表达分析的学习资料推荐 by 小明的数据分析笔记本
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-mpa-powered-by="yiban.io"><h2 data-tool="mdnice编辑器"><span></span><span>参考资料链接</span><span> </span></h2><p data-tool="mdnice编辑器">https://github.com/cxli233/SimpleTidy_GeneCoEx/tree/v1.0.1</p><p data-tool="mdnice编辑器">提供完整的示例数据和代码，非常好的学习材料</p><p data-tool="mdnice编辑器">做基因共表达比较常用的是WGCNA那个R包，这个链接里提供的代码不是用WGCNA这个R包实现的，而是利用表达量数据计算不同基因之间的相关性，这种方法也挺常用的在论文里见过</p><p data-tool="mdnice编辑器">表达量数据是来源于论文</p><p data-tool="mdnice编辑器">High-resolution spatiotemporal transcriptome mapping of tomato fruit development and ripening</p><p data-tool="mdnice编辑器">https://www.nature.com/articles/s41467-017-02782-9</p><p data-tool="mdnice编辑器">数据是不同发育阶段的转录数据，表达量数据的下载链接是 https://zenodo.org/record/7117357#.Y0WB13ZBzic</p><p data-tool="mdnice编辑器">关于样本的一些分组信息在链接里提供了，大家如果感兴趣可以自己下载数据然后跟着这个链接完全重复一下</p><blockquote data-tool="mdnice编辑器"><p>接下来的内容我重复一下资料中利用表达量数据做PCA的内容</p></blockquote><h2 data-tool="mdnice编辑器"><span></span><span>代码</span><span> </span></h2><pre data-tool="mdnice编辑器"><span></span><code>setwd(<span>"data/20221012/"</span>)<br>list.files()<br><br><span>#library(data.table)</span><br>library(readr)<br>Exp_table &lt;- read_csv(<span>"Shinozaki_tpm_all.csv"</span>, col_types = cols())<br>head(Exp_table)<br>dim(Exp_table)<br><br>library(readxl)<br>Metadata &lt;- read_excel(<span>"SimpleTidy_GeneCoEx-1.0.1/Data/Shinozaki_datasets_SRA_info.xlsx"</span>)<br>head(Metadata)<br>dim(Metadata)<br><br>library(tidyverse)<br>Exp_table_long &lt;- Exp_table %&gt;% <br>  rename(gene_ID = `...1`) %&gt;% <br>  pivot_longer(cols = !gene_ID, names_to = <span>"library"</span>, values_to = <span>"tpm"</span>) %&gt;% <br>  mutate(logTPM = log10(tpm + 1)) <br><br>head(Exp_table_long)<br><br><br>Exp_table_log_wide &lt;- Exp_table_long %&gt;% <br>  select(gene_ID, library, logTPM) %&gt;% <br>  pivot_wider(names_from = library, values_from = logTPM)<br><br>head(Exp_table_log_wide)<br><br>my_pca &lt;- prcomp(t(Exp_table_log_wide[, -1]))<br>pc_importance &lt;- as.data.frame(t(summary(my_pca)<span>$importance</span>))<br>head(pc_importance, 20)<br><br><br>PCA_coord &lt;- my_pca<span>$x</span>[, 1:10] %&gt;% <br>  as.data.frame() %&gt;% <br>  mutate(Run = row.names(.)) %&gt;% <br>  full_join(Metadata %&gt;% <br>              select(Run, tissue, dev_stage, `Library Name`, `Sample Name`), by = <span>"Run"</span>)<br><br>head(PCA_coord)<br><br><br>PCA_coord &lt;- PCA_coord %&gt;% <br>  mutate(stage = case_when(<br>    str_detect(dev_stage, <span>"MG|Br|Pk"</span>) ~ str_sub(dev_stage, start = 1, end = 2),<br>    T ~ dev_stage<br>  )) %&gt;% <br>  mutate(stage = factor(stage, levels = c(<br>    <span>"Anthesis"</span>,<br>    <span>"5 DPA"</span>,<br>    <span>"10 DPA"</span>,<br>    <span>"20 DPA"</span>,<br>    <span>"30 DPA"</span>,<br>    <span>"MG"</span>,<br>    <span>"Br"</span>,<br>    <span>"Pk"</span>,<br>    <span>"LR"</span>,<br>    <span>"RR"</span><br>  ))) %&gt;% <br>  mutate(dissection_method = case_when(<br>    str_detect(tissue, <span>"epidermis"</span>) ~ <span>"LM"</span>,<br>    str_detect(tissue, <span>"Collenchyma"</span>) ~ <span>"LM"</span>,<br>    str_detect(tissue, <span>"Parenchyma"</span>) ~ <span>"LM"</span>,<br>    str_detect(tissue, <span>"Vascular"</span>) ~ <span>"LM"</span>,<br>    str_detect(dev_stage, <span>"Anthesis"</span>) ~ <span>"LM"</span>,<br>    str_detect(dev_stage, <span>"5 DPA"</span>) &amp;<br>      str_detect(tissue, <span>"Locular tissue|Placenta|Seeds"</span>) ~ <span>"LM"</span>,<br>    T ~ <span>"Hand"</span><br>  ))<br><br>head(PCA_coord)<br><br>library(viridis)<br>library(RColorBrewer)<br><br>PCA_by_method &lt;- PCA_coord %&gt;% <br>  ggplot(aes(x = PC1, y = PC2)) +<br>  geom_point(aes(fill = dissection_method), color = <span>"grey20"</span>, shape = 21, size = 3, alpha = 0.8) +<br>  scale_fill_manual(values = brewer.pal(n = 3, <span>"Accent"</span>)) +<br>  labs(x = paste(<span>"PC1 ("</span>, pc_importance[1, 2] %&gt;% signif(3)*100, <span>"% of Variance)"</span>, sep = <span>""</span>), <br>       y = paste(<span>"PC2 ("</span>, pc_importance[2, 2] %&gt;% signif(3)*100, <span>"% of Variance)"</span>, <span>"  "</span>, sep = <span>""</span>),<br>       fill = NULL) +  <br>  theme_bw() +<br>  theme(<br>    text = element_text(size= 14),<br>    axis.text = element_text(color = <span>"black"</span>)<br>  )<br><br><br>PCA_by_method<br><br>PCA_by_tissue &lt;- PCA_coord %&gt;% <br>  ggplot(aes(x = PC1, y = PC2)) +<br>  geom_point(aes(fill = tissue), color = <span>"grey20"</span>, shape = 21, size = 3, alpha = 0.8) +<br>  scale_fill_manual(values = brewer.pal(11, <span>"Set3"</span>)) +<br>  labs(x = paste(<span>"PC2 ("</span>, pc_importance[2, 2] %&gt;% signif(3)*100, <span>"% of Variance)"</span>, sep = <span>""</span>), <br>       y = paste(<span>"PC3 ("</span>, pc_importance[3, 2] %&gt;% signif(3)*100, <span>"% of Variance)"</span>, <span>"  "</span>, sep = <span>""</span>),<br>       fill = <span>"tissue"</span>) +  <br>  theme_bw() +<br>  theme(<br>    text = element_text(size= 14),<br>    axis.text = element_text(color = <span>"black"</span>)<br>  )<br><br>PCA_by_tissue<br><br>PCA_by_stage &lt;- PCA_coord %&gt;% <br>  ggplot(aes(x = PC2, y = PC3)) +<br>  geom_point(aes(fill = stage), color = <span>"grey20"</span>, shape = 21, size = 3, alpha = 0.8) +<br>  scale_fill_manual(values = viridis(10, option = <span>"D"</span>)) +<br>  labs(x = paste(<span>"PC2 ("</span>, pc_importance[2, 2] %&gt;% signif(3)*100, <span>"% of Variance)"</span>, sep = <span>""</span>), <br>       y = paste(<span>"PC3 ("</span>, pc_importance[3, 2] %&gt;% signif(3)*100, <span>"% of Variance)"</span>, <span>"  "</span>, sep = <span>""</span>),<br>       fill = <span>"stage"</span>) +  <br>  theme_bw() +<br>  theme(<br>    text = element_text(size= 14),<br>    axis.text = element_text(color = <span>"black"</span>)<br>  )<br><br>PCA_by_stage <br><br><br>library(patchwork)<br><br>PCA_by_method+PCA_by_tissue+PCA_by_tissue<br><br></code></pre><p><img data-galleryid="" data-ratio="0.42406015037593986" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/t1wZDoUyFk4YuULRibA3juNlaXMGDVwzg0KQhq4k1ukQm8htUkAKibOCTDadbt54FHTfRZibErIaia74LMcOaPtYQA/640?wx_fmt=png" data-type="png" data-w="1995" src="https://mmbiz.qpic.cn/mmbiz_png/t1wZDoUyFk4YuULRibA3juNlaXMGDVwzg0KQhq4k1ukQm8htUkAKibOCTDadbt54FHTfRZibErIaia74LMcOaPtYQA/640?wx_fmt=png"></p><figure data-tool="mdnice编辑器"><figcaption>image.png</figcaption></figure><blockquote data-tool="mdnice编辑器"><p>以上用到的代码和示例数据都可以在推文开头提到链接里找到</p></blockquote><p data-tool="mdnice编辑器">上面的代码有一步是对TPM值 加1然后取log10，他的实现方式是先将宽格式数据转换为长格式，然后把取log10后的长格式再转换为宽格式，这里我没能还可以借助<code>mutate_at()</code>函数</p><pre data-tool="mdnice编辑器"><span></span><code>Exp_table %&gt;% select(1,2,3) %&gt;% <br>  rename(<span>"gene_id"</span>=<span>"...1"</span>) %&gt;% <br>  mutate_at(vars(starts_with(<span>"SRR"</span>)),<br>            <span>function</span>(x){log10(x+1)})<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.5825864276568502" data-src="https://mmbiz.qpic.cn/mmbiz_png/t1wZDoUyFk4YuULRibA3juNlaXMGDVwzgqiaTmH08cKgfa3gRvf3e6KGQImibDn613S4pv83Dc3DSKp7VibyTpiaReA/640?wx_fmt=png" data-type="png" data-w="781" src="https://mmbiz.qpic.cn/mmbiz_png/t1wZDoUyFk4YuULRibA3juNlaXMGDVwzgqiaTmH08cKgfa3gRvf3e6KGQImibDn613S4pv83Dc3DSKp7VibyTpiaReA/640?wx_fmt=png"><figcaption>image.png</figcaption></figure><p data-tool="mdnice编辑器">欢迎大家关注我的公众号</p><p data-tool="mdnice编辑器"><strong>小明的数据分析笔记本</strong></p><section><mp-common-profile data-pluginname="mpprofile" data-id="MzI3NzQ3MTcxMg==" data-headimg="http://mmbiz.qpic.cn/mmbiz_png/t1wZDoUyFk5t1sOnM0iabvBhnfIj5YpyqrMib0E1MGCd9ibcYxaOPZd0GWhQBDvK2BPEwsicQxd6y5MHLfphnwHnow/0?wx_fmt=png" data-nickname="小明的数据分析笔记本" data-alias="" data-signature="数据分析和数据可视化有意思的简单小例子~石榴研究生的笔记本" data-from="0" data-is_biz_ban="0"></mp-common-profile><br></section><blockquote data-tool="mdnice编辑器"><p>小明的数据分析笔记本 公众号 主要分享：1、R语言和python做数据分析和数据可视化的简单小例子；2、园艺植物相关转录组学、基因组学、群体遗传学文献阅读笔记；3、生物信息学入门学习资料及自己的学习笔记！</p></blockquote></section><p><br></p><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/yXVOJgcM617GRGnYX2kRoQ",target="_blank" rel="noopener noreferrer">原文链接</a>
