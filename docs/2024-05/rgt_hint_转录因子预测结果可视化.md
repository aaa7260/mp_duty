---
title: "rgt-hint 转录因子预测结果可视化"
date: 2024-05-01T00:46:24Z
draft: ["false"]
tags: [
  "fetched",
  "老俊俊的生信笔记"
]
categories: ["Acdemic"]
---
rgt-hint 转录因子预测结果可视化 by 老俊俊的生信笔记
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-mpa-powered-by="yiban.io"><section><mp-common-profile data-pluginname="mpprofile" data-id="MzkyMTI1MTYxNA==" data-headimg="http://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usezgsqIGqjITSMggCTSoViaYeoKe2xoZr1IIvNJoztibQxibYHLDDoiabwAc6Ggws3Tvdo8EPss2nLgaVQ/0?wx_fmt=png" data-nickname="老俊俊的生信笔记" data-alias="JunJunLab" data-signature="老俊俊的生信技能和知识分享,我不是巨人,但你可以站在我的肩膀上更进一步!" data-from="0" data-is_biz_ban="0"></mp-common-profile></section><section><mp-common-clmusic data-pluginname="insertaudio" type="1" music_name="断捨離 (feat. りりあ。) (断舍离)" albumurl="http://wx.y.gtimg.cn/music/photo_new/T002R500x500M000003g3cy80ucoPW_1.jpg" singer="SG" duration="209000" username="" music_source="1" is_vip="0" listenid="78270120922102891"></mp-common-clmusic></section><h2 data-tool="mdnice编辑器"><span></span><span>引言</span><span></span></h2><blockquote data-tool="mdnice编辑器"><span>❝</span><p>这里主要对 <strong>rgt</strong> 预测差异转录因子的输出结果进行重新绘图。</p></blockquote><figure data-tool="mdnice编辑器"><img data-imgfileid="100029512" data-ratio="0.38848920863309355" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usez2hBxgLF4FiaLwCLzGePHOmIPkZMpYCgfxZD8RialTg9sLArzZnBbZhAhOy8VYFpNGG6NmIfiaG7s9Q/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="417" src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usez2hBxgLF4FiaLwCLzGePHOmIPkZMpYCgfxZD8RialTg9sLArzZnBbZhAhOy8VYFpNGG6NmIfiaG7s9Q/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器"><strong>Lineplots</strong> 结果是具体预测的 motif 在全基因组上的 <strong>footprint</strong> 结合信息, 差异的结果则储存在 <strong>differential_statistics.txt</strong>。</p><h2 data-tool="mdnice编辑器"><span></span><span>绘图</span><span></span></h2><p data-tool="mdnice编辑器">绘制差异结果的火山图:</p><pre data-tool="mdnice编辑器"><span></span><code>setwd(<span>"~/JunJun/8.atacSeq_proj/6.footprint-data/CTL_siNCoR/"</span>)<br><br><span>library</span>(ggplot2)<br><span>library</span>(ggrepel)<br><span>library</span>(dplyr)<br><br>de &lt;- read.delim(<span>"differential_statistics.txt"</span>) %&gt;%<br>  mutate(type = if_else(P_values &lt; <span>0.05</span>,<span>"sigTF"</span>,<span>"nonsigTF"</span>))<br><br><span># check</span><br>head(de)<br><span>#             Motif   Num Protection_Score_CTL Protection_Score_siNCoR    TC_CTL TC_siNCoR TF_Activity</span><br><span># 1 MA1645.1.NKX2-2  4477            0.4885421               0.3008693 0.7111927 0.4536498 -0.44521579</span><br><span># 2   MA1114.1.PBX3  4827            0.2360842               0.1123626 0.7566007 0.6198544 -0.26046793</span><br><span># 3   MA1493.1.HES6  2399            0.3567710               0.3080597 0.8004308 0.6267882 -0.22235388</span><br><span># 4    MA0467.1.Crx  2767            0.3652523               0.3291425 0.5681782 0.5047526 -0.09953544</span><br><span># 5 MA1649.1.ZBTB12  3235           -0.4410400              -0.3347849 0.6667690 0.5216612 -0.03885269</span><br><span># 6 MA1653.1.ZNF148 36771            1.0893183               0.8442928 1.0740597 0.8580158 -0.46106941</span><br><span>#       Z_score  P_values     type</span><br><span># 1 -1.50718866 0.1317623 nonsigTF</span><br><span># 2 -0.85208810 0.3941652 nonsigTF</span><br><span># 3 -0.71693883 0.4734118 nonsigTF</span><br><span># 4 -0.28143485 0.7783769 nonsigTF</span><br><span># 5 -0.06625888 0.9471717 nonsigTF</span><br><span># 6 -1.56340425 0.1179575 nonsigTF</span><br><br><span># plot</span><br>ggplot(de,aes(x = TF_Activity,y = -log10(P_values))) +<br>  geom_point(aes(color = type)) +<br>  theme_bw() +<br>  theme(panel.grid = element_blank(),<br>        axis.text = element_text(colour = <span>"black"</span>)) +<br>  geom_hline(yintercept = -log10(<span>0.05</span>),lty = <span>"dashed"</span>) +<br>  scale_color_manual(values = c(<span>"sigTF"</span> = <span>"red"</span>,<span>"nonsigTF"</span> = <span>"grey50"</span>)) +<br>  geom_label_repel(data = . %&gt;% filter(P_values &lt; <span>0.05</span>),<br>                   aes(label = Motif))<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100029514" data-ratio="0.7978303747534516" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usez2hBxgLF4FiaLwCLzGePHOm2BqTr8hzEgMicbDadKUej70cdfrg1rbvmmZFDYAQJTPYIOZPicJV2ywQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1014" src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usez2hBxgLF4FiaLwCLzGePHOm2BqTr8hzEgMicbDadKUej70cdfrg1rbvmmZFDYAQJTPYIOZPicJV2ywQ/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器">换个展示方式,比如按 <strong>TF activity</strong> 进行排序:</p><pre data-tool="mdnice编辑器"><span></span><code>de &lt;- de %&gt;% arrange(desc(TF_Activity))<br>de$x &lt;- rownames(de) %&gt;% as.numeric()<br><br>ggplot(de,aes(x = x,y = TF_Activity)) +<br>  geom_point(aes(color = type)) +<br>  theme_bw() +<br>  theme(panel.grid = element_blank(),<br>        axis.text = element_text(colour = <span>"black"</span>)) +<br>  geom_hline(yintercept = <span>0</span>,lty = <span>"dashed"</span>) +<br>  scale_color_manual(values = c(<span>"sigTF"</span> = <span>"red"</span>,<span>"nonsigTF"</span> = <span>"grey50"</span>)) +<br>  geom_label_repel(data = . %&gt;% filter(P_values &lt; <span>0.05</span>),<br>                   aes(label = Motif)) +<br>  xlab(<span>"Rank by TF Activity"</span>)<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100029515" data-ratio="0.7992125984251969" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usez2hBxgLF4FiaLwCLzGePHOmyj16yQmRDpgMUiccaorfWTUq5rXAo6aUicHicIibk55icCOf4jfYQ5JA2gw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1016" src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usez2hBxgLF4FiaLwCLzGePHOmyj16yQmRDpgMUiccaorfWTUq5rXAo6aUicHicIibk55icCOf4jfYQ5JA2gw/640?wx_fmt=png&amp;from=appmsg"></figure><hr data-tool="mdnice编辑器"><blockquote data-tool="mdnice编辑器"><span>❝</span><p><strong>footprint</strong> 的折线图我们可以把显著的(p &lt; 0.05)都画出来, 但是输出结果没有关于 <strong>motif</strong> 的数据,所以画不了 motif。</p></blockquote><figure data-tool="mdnice编辑器"><img data-imgfileid="100029513" data-ratio="0.7435897435897436" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usez2hBxgLF4FiaLwCLzGePHOmOkwMUAJkx52aNRy42ARFgHcAN8pGAiaDwFlbWic1jH2bmLqicJ3ibdcISQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="507" src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usez2hBxgLF4FiaLwCLzGePHOmOkwMUAJkx52aNRy42ARFgHcAN8pGAiaDwFlbWic1jH2bmLqicJ3ibdcISQ/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器">批量读取数据然后合并,再绘图:</p><pre data-tool="mdnice编辑器"><span></span><code><span># ==============================================================================</span><br><span># plot footprinting</span><br><span># ==============================================================================</span><br>sigTF &lt;- de %&gt;% filter(P_values &lt; <span>0.05</span>)<br><br>TF_name &lt;- sigTF$Motif<br><br><span># loop plot footprinting</span><br><span># x = 1</span><br>lapply(seq_along(TF_name),<span>function</span>(x){<br>  <span># check names</span><br>  var &lt;- str_detect(TF_name[x],pattern = <span>"var"</span>)<br><br>  <span>if</span>(var){<br>    tmp_name &lt;- str_replace(TF_name[x],pattern = <span>"\\(|\\)"</span>,replacement = <span>"_"</span>)<br>    tmp_name &lt;- str_replace(tmp_name,pattern = <span>"\\)"</span>,replacement = <span>""</span>)<br>  }<span>else</span>{<br>    tmp_name &lt;- TF_name[x]<br>  }<br><br>  <span># load data</span><br>  ft &lt;- read.delim(paste0(<span>"Lineplots/"</span>,tmp_name,<span>".txt"</span>)) %&gt;%<br>    mutate(pos = -<span>100</span>:<span>99</span>,TF = tmp_name) %&gt;%<br>    pivot_longer(cols = c(<span>"CTL"</span>,<span>"siNCoR"</span>),<br>                 names_to = <span>"group"</span>,<br>                 values_to = <span>"Occupancy"</span>)<br><br>}) %&gt;% do.call(<span>"rbind"</span>,.) -&gt; ft_df<br><br><span># check</span><br>head(ft_df,<span>3</span>)<br><span># A tibble: 3 × 4</span><br><span># pos TF             group  Occupancy</span><br><span>#   &lt;int&gt; &lt;chr&gt;          &lt;chr&gt;      &lt;dbl&gt;</span><br><span># 1  -100 MA0862.1.GMEB2 CTL        0.685</span><br><span># 2  -100 MA0862.1.GMEB2 siNCoR     0.832</span><br><span># 3   -99 MA0862.1.GMEB2 CTL        0.723</span><br><br><span># plot</span><br>ggplot(ft_df,aes(x = pos,y = Occupancy,color = group)) +<br>  geom_line() +<br>  theme_bw() +<br>  theme(panel.grid = element_blank(),<br>        strip.background = element_rect(fill = <span>"grey90"</span>),<br>        strip.text = element_text(face = <span>"bold.italic"</span>),<br>        axis.text = element_text(colour = <span>"black"</span>)) +<br>  facet_wrap(~TF,scales = <span>"free"</span>,ncol = <span>5</span>)<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100029516" data-ratio="0.5951327433628318" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usez2hBxgLF4FiaLwCLzGePHOmNZ744dwakS6cPkkPibMn3JY5Cf8HPJDzVabmW8UwxoZT7ibPz1LH8Yiag/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1356" src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usez2hBxgLF4FiaLwCLzGePHOmNZ744dwakS6cPkkPibMn3JY5Cf8HPJDzVabmW8UwxoZT7ibPz1LH8Yiag/640?wx_fmt=png&amp;from=appmsg"></figure><hr data-tool="mdnice编辑器"><p data-tool="mdnice编辑器">我们选第一个看看 <strong>KLF4</strong> 是一样的,我们看看已知的这个 motif 的情况:</p><pre data-tool="mdnice编辑器"><span></span><code><span>library</span>(ATACseqQC)<br><span>library</span>(MotifDb)<br><span>library</span>(ggseqlogo)<br><br>MT &lt;- query(MotifDb, andStrings = c(<span>"hsapiens"</span>,<span>"KLF4"</span>))<br>ggseqlogo(as.list(MT))<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100029521" data-ratio="0.4902887139107612" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usez2hBxgLF4FiaLwCLzGePHOmoHVwndMQ86pWNwApcL80PWVicqibmsxozB2LIzBnROKFPf3kAB1bkhIw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1905" src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usez2hBxgLF4FiaLwCLzGePHOmoHVwndMQ86pWNwApcL80PWVicqibmsxozB2LIzBnROKFPf3kAB1bkhIw/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器">可以看到 <strong>Hsapiens-jaspar2022</strong> 数据库的 motif 数据和重新预测的很像。</p><figure data-tool="mdnice编辑器"><img data-imgfileid="100029519" data-ratio="0.7127016129032258" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usez2hBxgLF4FiaLwCLzGePHOmQwrCoYfeZUtSxrTqkr3dT0WsZRsib6AWQTqRarhDu68a0Absrlx7fEw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="992" src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usez2hBxgLF4FiaLwCLzGePHOmQwrCoYfeZUtSxrTqkr3dT0WsZRsib6AWQTqRarhDu68a0Absrlx7fEw/640?wx_fmt=png&amp;from=appmsg"></figure><blockquote data-tool="mdnice编辑器"><span>❝</span><p><strong>路漫漫其修远兮,吾将上下而求索。</strong></p></blockquote><hr data-tool="mdnice编辑器"><p data-tool="mdnice编辑器">欢迎加入生信交流群。加我微信我也拉你进 <strong>微信群聊</strong> <strong>老俊俊生信交流群</strong> <strong>(微信交流群需收取 20 元入群费用,一旦交费,拒不退还!(防止骗子和便于管理))</strong> 。QQ 群可免费加入, 记得进群按格式修改备注哦。</p><section data-tool="mdnice编辑器"><section><p><strong>老俊俊微信：</strong></p><figure><img data-imgfileid="100029517" data-ratio="1" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usez2hBxgLF4FiaLwCLzGePHOmKr2kKYRY24EqLG5JPvgt05avEtKaNiaoWaKEQhWUdM8OZjARaarGbIg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="430" src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usez2hBxgLF4FiaLwCLzGePHOmKr2kKYRY24EqLG5JPvgt05avEtKaNiaoWaKEQhWUdM8OZjARaarGbIg/640?wx_fmt=png&amp;from=appmsg"></figure><figure><img data-imgfileid="100029520" data-ratio="1.3668430335097002" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usez2hBxgLF4FiaLwCLzGePHOmvicibjic1RicjB0SzyEE5U3CekzXPP6fOMSx2yjUvPB6UXFDiahwOe2nOKg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="567" src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usez2hBxgLF4FiaLwCLzGePHOmvicibjic1RicjB0SzyEE5U3CekzXPP6fOMSx2yjUvPB6UXFDiahwOe2nOKg/640?wx_fmt=png&amp;from=appmsg"></figure></section><section><p><strong>知识星球：</strong></p><figure><img data-imgfileid="100029518" data-ratio="1.5896226415094339" data-src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/G5jjcE4usez2hBxgLF4FiaLwCLzGePHOmFmkI7np7f4fuqzUTNW5FtLax4YhyI8n0nOOUSVD9iaNfpyr9VPkWuFQ/640?wx_fmt=jpeg&amp;from=appmsg" data-type="jpeg" data-w="1060" src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/G5jjcE4usez2hBxgLF4FiaLwCLzGePHOmFmkI7np7f4fuqzUTNW5FtLax4YhyI8n0nOOUSVD9iaNfpyr9VPkWuFQ/640?wx_fmt=jpeg&amp;from=appmsg"></figure></section></section><hr data-tool="mdnice编辑器"><p data-tool="mdnice编辑器"><strong></strong></p><center data-tool="mdnice编辑器"><strong> 往期回顾目录</strong></center><blockquote data-tool="mdnice编辑器"><span>❝</span><p><strong></strong></p><center><strong><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247513159&amp;idx=1&amp;sn=832b6c709d2df7a32d8fc64c609e4ac4&amp;chksm=c1848e36f6f3072035a95da9f10234e5b162ca058bb7bbb041ddd5d44bca17c143279246de21&amp;token=635906193&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">绘图时如何处理 Input 样本</a></strong></center><strong><center><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247513137&amp;idx=1&amp;sn=ffd1d42ce1174494bc53d58726a93778&amp;chksm=c1848e40f6f3075653a6849b9525d40a682a89231053f076f03a7026aed5ddab7509f89f0121&amp;token=635906193&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">ATAC-seq 数据分析实操教程</a></center></strong><strong><center><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247513054&amp;idx=1&amp;sn=e87d34b1b715ff2a00628e4bb0886ba3&amp;chksm=c18489aff6f300b9ab3cdda646acb3a02914b79c3f28433b9a05722625ac65175318d0f8e7c2&amp;token=1860740043&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">ATAC-seq 分析方法一览</a></center></strong><strong><center><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247513016&amp;idx=1&amp;sn=902232584345e1435aade90821238a9e&amp;chksm=c18489c9f6f300dfe8e7e436f76c891eb8234ec40a388f361f7838dc6dc61fd17ccb33f96bac&amp;token=1218322320&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">locuszoomr 可视化 GWAS 结果</a></center></strong><strong><center><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247512947&amp;idx=1&amp;sn=87d8684deca7bcf68ec887e067449ce5&amp;chksm=c1848902f6f30014f25b1e24e98e8ec4edf704bf70a037d4d291d3e5c7aae7e826635926e345&amp;token=538711716&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">2024 了,听说你还在用 dplyr 处理数据?</a></center></strong><strong><center><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247512936&amp;idx=1&amp;sn=53d5444bfa7e6028c169578cd6fc873d&amp;chksm=c1848919f6f3000f297af5def286cf09caad0898d6598277f610b9563116c7c4000f34d79daf&amp;token=1008140360&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">计算 motif 到 peak center 的距离</a></center></strong><strong><center><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247512922&amp;idx=1&amp;sn=247004f40306ea4e555fb6e32480a42f&amp;chksm=c184892bf6f3003d132a9779834b2d4df5c3f1b52ec9c3a04041d7398f3ec155560efe6eb578&amp;token=2004442534&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">写个包 metaplot 绘制 m6A peak 分布</a></center></strong><strong><center><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247512856&amp;idx=1&amp;sn=7f9fd9406d4768535450ef9e2df44890&amp;chksm=c1848969f6f3007fb1e0010b0ce49fd5738fa5fd8f4759ffea56cfbe89ffaaf29e1016ed149e&amp;token=709285857&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">当 ggSCvis 遇到 ggmagnify</a></center></strong><strong><center><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247512812&amp;idx=1&amp;sn=c90eeab4ddc6aeaae7986ca163eba10e&amp;chksm=c184889df6f3018bc89c07de8b7aea1a22b7b284320dbf4280cd60ce5b4fad1a65486116ec62&amp;token=555204851&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">在模仿中精进数据可视化_使用ggcirclize绘制circos圈图</a></center></strong><strong><center><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247512783&amp;idx=1&amp;sn=2535eaafd12934a3067e88f00f17d59a&amp;chksm=c18488bef6f301a8fcd1efa4dbe75d2c0d794cdedde2151528d3841e61e902d9c3ebbc2915c4&amp;token=1338300207&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">单细胞二维密度图一文拿捏!</a></center></strong><p><br></p></blockquote></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/RRn1kmJCZoiy6erOOR6gAg",target="_blank" rel="noopener noreferrer">原文链接</a>
