---
title: "GPTCelltype：玩GPT4玩出Nature"
date: 2024-05-07T07:11:25Z
draft: ["false"]
tags: [
  "fetched",
  "Biomamba 生信基地"
]
categories: ["Acdemic"]
---
GPTCelltype：玩GPT4玩出Nature by Biomamba 生信基地
------
<div><section data-support="96编辑器" data-style-id="40226" data-mpa-powered-by="yiban.io"><section><section><p><strong>一、写在前面</strong></p></section><section data-width="100%"><p><span>相信GPT4凭借及强大的Debug能力与文字润色能力已经成为大家在生信分析与文章撰写时的好帮手。在本菜鸡还在拿GPT4帮自己写代码的时候，已经有大佬将GPT4的API接入自己写的R包用于帮助单细胞数据的注释，并且顺手发了一篇《</span><span><strong>Nature Methods</strong></span><span>》。学过我们此前课程(</span><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247500167&amp;idx=2&amp;sn=8de136b938e8d4753042d23166a24026&amp;chksm=9b3cb8d7ac4b31c19c843810c7fe4341515df8ba6fff86a0ebff9d830edfcd656a29d18011c9&amp;scene=21#wechat_redirect" textvalue="手把手教你做单细胞测序数据分析|5.细胞类型注释，从入门到入土" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2"><span>细胞类型注释，从入门到入土</span></a><span>)的同学都知道，人工注释费时费力，需要分析人员对于组织中的细胞特征拥有</span><span><strong>专业级别</strong></span><span>的了解；用singleR这类软件进行</span><span><strong>自动注释</strong></span><span>，又很</span><strong><span>依赖</span></strong><span>软件</span><span><strong>算法</strong></span><span>的准确性与</span><span><strong>参考数据集</strong></span><span><span>的适配性。相信这些问题已经困扰大家很久了，那么这篇题为"</span><span>Assessing GPT-4 for cell type annotation in single-cell RNA-seq analysis</span><span>"的文章能够一定程度上医好大家的头疼。</span></span></p><p><span>原文链接：</span><span>https://www.nature.com/articles/s41592-024-02235-4</span></p></section></section></section><p><br></p><section data-support="96编辑器" data-style-id="40226" data-mpa-powered-by="yiban.io"><section><section><p><strong>二、主要内容</strong></p></section><section data-width="100%"><section><span>细胞注释是single-cell RNA suquencing(scRNA-seq)的基本步骤，这一步基本不能直接产生对文章论题有用的信息与图表，但是却十分耗时、耗力、耗专业知识。GPT-3.5与<span><strong>GPT-4</strong></span>可以说在近年的大语言模型中独领风骚，并被迅速的应用在生物医药领域。考虑到GPT-4可以高效、无缝的整合到现有的单细胞分析流程中去，因此作者开发了<span><strong>GPTCelltype</strong></span>并系统性评估了GPT-4在十个数据集(包含正常细胞与肿瘤细胞)中的细胞注释表现情况。从示意图(Figure 1a)可以看出，依赖GPT4进行scRNA-Seq的细胞注释<span><strong>好处有</strong></span>：无需生物学专业知识、无需代码知识、无需参考数据集、人工成本低、分析流程适配性高、无组织类型限制、注释分辨率/粒度高。</span></section><section><span><img data-imgfileid="100027034" data-ratio="0.7694444444444445" data-src="https://mmbiz.qpic.cn/mmbiz_png/ImlBFVOwwpzia8OSMUPNUXCXkVqc4Wj3KMUX7t4z0MUqnKakUBnsfZs9Av9WB0TFvVBIC5VV9YafGH9Tjgvo29A/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/ImlBFVOwwpzia8OSMUPNUXCXkVqc4Wj3KMUX7t4z0MUqnKakUBnsfZs9Av9WB0TFvVBIC5VV9YafGH9Tjgvo29A/640?wx_fmt=png&amp;from=appmsg"></span></section><section><br></section><section><span>在研究过程中，作者重点考察了Top差异基因(marker)来源与数量、数据来源、数据集大小等因素对GPT-4的细胞注释能力进行了<span><strong>评估</strong></span>，并用数据集原先的人工注释结果作为参考进行准确率计算。结果显示在利用Top10marker进行细胞注释时准确性最高(Figure 2a)。在大部分数据集与组织中，GPT的细胞注释及亚群注释结果能保证大于<span><strong>75%</strong></span>的准确率(这个下限其实不高)，且对于<span><strong>免疫细胞</strong></span>的注释比其它细胞类型更加精准。在肺癌与结肠癌数据集中，其能够精准的识别肿瘤细胞，但在B淋巴瘤细胞的识别上有些不足，建议结合<span><strong>拷贝数变异分析</strong></span>进一步推断。</span></section><p><img data-galleryid="" data-imgfileid="100027033" data-ratio="1.2916666666666667" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/ImlBFVOwwpzia8OSMUPNUXCXkVqc4Wj3KI3eLYDpZ8n8KIaqePLssBiborNlcqicU4rp8FRK7f2dibsoRgRc8DMJYw/640?wx_fmt=png&amp;from=appmsg" data-type="jpeg" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/ImlBFVOwwpzia8OSMUPNUXCXkVqc4Wj3KI3eLYDpZ8n8KIaqePLssBiborNlcqicU4rp8FRK7f2dibsoRgRc8DMJYw/640?wx_fmt=png&amp;from=appmsg"></p><section><br></section><section><span>在GPT-4与ScType、CPT3.5、SingleR的横向比较中，无论是<span><strong>准确性</strong></span>还是<span><strong>计算速度</strong></span>，GPT-4均<span><strong>大幅领先</strong></span>(Figure 2d&amp;2e)。GPTCelltype的计算效率高得益于其依赖</span><span><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247510380&amp;idx=1&amp;sn=0eb2b0c519ef1dc25ee8821b736a0fde&amp;chksm=9b3cd03cac4b592ad93149fb4847e6ba3dd03ab69e1ca594ddc64d323fb7496775789cae245d&amp;scene=21#wechat_redirect" textvalue="Seurat" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2">Seurat</a></span><span>进行Top marker的计算，而另外几种工具需要自行对表达矩阵进行处理。此外，作者还使用了包含93%真实细胞与7%混合细胞的模拟数据集进行了测试，结果显示GPTCelltype对于已知和未知细胞类型的注释准确率高达99%(Figure.2g)。在重现性表现方面，GPTCelltype同样表现优秀(Figure 2H&amp;I)。<br></span></section><section><br></section><section><span>需要注意的是GPT4的训练截止日期是2021年9月，这个时间对于快速发展的scRNA-Seq与生物信息学领域而言，有些久远。虽然GPTCelltype的使用门槛很低，但作者并不推荐使用top marker少于5的细胞类型以及数量少于10个的细胞注释。<span>另外一个需要考虑的因素是，GPT-4并不是用爱发电的，大约需要<strong><span>$20</span></strong>一个月的订阅成本，但按照GPT-4的流量限制来说，注释本文作者提到的所有细胞类型，花费不会超过<span><strong>0.1$</strong></span>。</span></span></section><section><span>大家可以自行学习一下分析教程，流程很简单，但是需要科学上网(</span><span>https://user.by.ltd/aff.php?aff=23313</span><span>)和Open AI的账号：</span></section><p><span>https://winnie09.github.io/Wenpin_Hou/pages/gptcelltype.html</span><span></span></p></section></section></section><section><section><section><section><section><section data-support="96编辑器" data-style-id="34887"><section><section data-support="96编辑器" data-style-id="36531"><section data-align="title"><section><section><img data-imgfileid="100027135" data-ratio="0.5106382978723404" data-w="47" data-width="100%" data-src="https://mmbiz.qpic.cn/mmbiz_png/Ljib4So7yuWiaFyWDMZJ2713X3DwiaQicG5O8mjlC4kPOluxibs4oDot7AXe0RgoXgMeiaB3KYViadIQqXRoRicyian7KUg/640?wx_fmt=other&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1&amp;tp=webp" src="https://mmbiz.qpic.cn/mmbiz_png/Ljib4So7yuWiaFyWDMZJ2713X3DwiaQicG5O8mjlC4kPOluxibs4oDot7AXe0RgoXgMeiaB3KYViadIQqXRoRicyian7KUg/640?wx_fmt=other&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1&amp;tp=webp"></section><section><section data-lazy-bgimg="https://mmbiz.qpic.cn/mmbiz_png/Ljib4So7yuWiaFyWDMZJ2713X3DwiaQicG5Ohviaxjsp3ZhRgjJ0mLNVEwpbT2fzdQMNt832icGGUt1ib9G2DMiazWDahA/640?wx_fmt=png" data-fail="0"><section><p><strong>如何联系我们</strong><br></p></section></section><section><img data-imgfileid="100027134" data-ratio="1.163265306122449" data-src="https://mmbiz.qpic.cn/mmbiz_png/Ljib4So7yuWiaFyWDMZJ2713X3DwiaQicG5OSxqKNRib39TuLic5NT2iaJaI0mIicuvjMZlRPvlqPfgjzg001qlRJTBDRA/640?wx_fmt=other&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1&amp;tp=webp" data-w="49" data-width="100%" src="https://mmbiz.qpic.cn/mmbiz_png/Ljib4So7yuWiaFyWDMZJ2713X3DwiaQicG5OSxqKNRib39TuLic5NT2iaJaI0mIicuvjMZlRPvlqPfgjzg001qlRJTBDRA/640?wx_fmt=other&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1&amp;tp=webp"></section></section></section></section></section><section data-support="96编辑器" data-style-id="34624"><section><section><section><img data-imgfileid="100027133" data-ratio="0.2463768115942029" data-w="138" data-src="https://mmbiz.qpic.cn/mmbiz_gif/Ljib4So7yuWiaC0oer2QpXIolHVU3Xibtm9BNWiav660mHaB5qEd1dibMibUicNYmAzBBiadQP2s7HArdUxoWL5cDkTEbQ/640?wx_fmt=gif&amp;wxfrom=5&amp;wx_lazy=1&amp;tp=webp" src="https://mmbiz.qpic.cn/mmbiz_gif/Ljib4So7yuWiaC0oer2QpXIolHVU3Xibtm9BNWiav660mHaB5qEd1dibMibUicNYmAzBBiadQP2s7HArdUxoWL5cDkTEbQ/640?wx_fmt=gif&amp;wxfrom=5&amp;wx_lazy=1&amp;tp=webp"></section><section><section>公众号后台消息回复不便，这里给大家留一下领取资料及免费服务器(<a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247507693&amp;idx=1&amp;sn=d9517a0803ad75cb7be430806834e7b8&amp;chksm=9b3ca7bdac4b2eaba1ad01ed04ab1fbcbafcf4f6ddfe9e4f76ed9229707f545fe7d9c9ffd6ae&amp;scene=21#wechat_redirect" textvalue="足够支持你完成硕博生涯的生信环境" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1"><span>足够支持你完成硕博生涯的生信环境</span></a>)的<span><strong>微信号</strong></span>，方便各位随时交流、提建议（别问在么，添加时直接说来意）。此外呼声一直很高的<strong><span>交流群</span></strong>也建好了，欢迎大家入群讨论：</section><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247505868&amp;idx=2&amp;sn=20c81313eaef9a7031a84ef3a691d1b5&amp;chksm=9b3cae9cac4b278a42c8de97e864c7664a37e9a4adb5973625fe3f8dd1093e55aeda88d443aa&amp;scene=21#wechat_redirect" textvalue="永久免费的生信、科研交流群" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1"><span>永久免费的生信、科研交流群</span></a><br></p><section><span>大家可以阅读完这几篇之后添加</span></section><section><span><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247493329&amp;idx=1&amp;sn=597870b7f7ce10346da3561e7c281627&amp;chksm=9b3c9f81ac4b169794088ce9abbcacb5f18e9fd174fc0d7e28da62d78facadf3100ef38aaf22&amp;scene=21#wechat_redirect" textvalue="给生信入门初学者的小贴士" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1">给生信入门初学者的小贴士</a><br></span></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247506266&amp;idx=2&amp;sn=22b1164bc9602c25620d058847785422&amp;chksm=9b3ca00aac4b291c16d738271746ffb90149282a728f484e8a1952463c46a8e7dc4f883ab928&amp;scene=21#wechat_redirect" textvalue="如何搜索公众号过往发布内容(内含集锦)" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1"><span>如何搜索公众号过往发布内容</span></a><br></section><p><img data-galleryid="" data-imgfileid="100027137" data-ratio="0.4357976653696498" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/ImlBFVOwwpx6Htt0YEibg4Pn7N7fFUdclZQH9RX6YAUqQG98l3jcz9XjCiatucDpyE0o10sotnD7jiaEIFDOmv8Yw/640?wx_fmt=other&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1&amp;tp=webp" data-type="png" data-w="1028" src="https://mmbiz.qpic.cn/mmbiz_png/ImlBFVOwwpx6Htt0YEibg4Pn7N7fFUdclZQH9RX6YAUqQG98l3jcz9XjCiatucDpyE0o10sotnD7jiaEIFDOmv8Yw/640?wx_fmt=other&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1&amp;tp=webp"></p></section></section></section></section></section></section></section></section></section></section></section><section><section><section><img data-imgfileid="100027138" data-ratio="0.7619047619047619" data-src="https://mmbiz.qpic.cn/mmbiz_gif/Ljib4So7yuWhFTIP7DCMLPwWh8Yhjs079f1vMqlYdExqbWaZVJyiawKkr21EDSNW740b4yMzkeHxFJULTpZGzYwQ/640?wx_fmt=gif&amp;wxfrom=5&amp;wx_lazy=1&amp;tp=webp" data-w="84" data-width="80%" src="https://mmbiz.qpic.cn/mmbiz_gif/Ljib4So7yuWhFTIP7DCMLPwWh8Yhjs079f1vMqlYdExqbWaZVJyiawKkr21EDSNW740b4yMzkeHxFJULTpZGzYwQ/640?wx_fmt=gif&amp;wxfrom=5&amp;wx_lazy=1&amp;tp=webp"></section><section><span>您点的每个赞和在看，我都认真当成了喜欢</span></section></section></section><section><br></section><p><br></p><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/pDZHaX3kneookNOfAZDdVA",target="_blank" rel="noopener noreferrer">原文链接</a>
