---
title: "怎么知道我的单细胞数据需不需要去除细胞周期的影响呢"
date: 2024-05-05T02:06:26Z
draft: ["false"]
tags: [
  "fetched",
  "生信星球"
]
categories: ["Acdemic"]
---
怎么知道我的单细胞数据需不需要去除细胞周期的影响呢 by 生信星球
------
<div><section data-mpa-powered-by="yiban.io"><br></section><section><span>‍</span></section><section><img data-imgfileid="100010876" data-ratio="1" data-src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHrDic8XGmJ0b7oibVJajb0emLBHSvuibGG49ooBgtaAibE3TNJ00iaHviaMtdIKQJfCwtUfuHicDImtSfIxg/640?wx_fmt=png" data-type="png" data-w="64" width="20px" src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHrDic8XGmJ0b7oibVJajb0emLBHSvuibGG49ooBgtaAibE3TNJ00iaHviaMtdIKQJfCwtUfuHicDImtSfIxg/640?wx_fmt=png"><img data-imgfileid="100010877" data-ratio="1" data-src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHrDic8XGmJ0b7oibVJajb0emLPukRHCbicy4pNKeEv9qd7aWSfsx7roib2od3xPrRPicw3a0kbn0uQ6JmQ/640?wx_fmt=png" data-type="png" data-w="64" width="20px" src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHrDic8XGmJ0b7oibVJajb0emLPukRHCbicy4pNKeEv9qd7aWSfsx7roib2od3xPrRPicw3a0kbn0uQ6JmQ/640?wx_fmt=png"><span> 今天是生信星球陪你的<span><strong>第949天</strong></span></span><img data-imgfileid="100010875" data-ratio="1" data-src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHrDic8XGmJ0b7oibVJajb0emLBHSvuibGG49ooBgtaAibE3TNJ00iaHviaMtdIKQJfCwtUfuHicDImtSfIxg/640?wx_fmt=png" data-type="png" data-w="64" width="20px" src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHrDic8XGmJ0b7oibVJajb0emLBHSvuibGG49ooBgtaAibE3TNJ00iaHviaMtdIKQJfCwtUfuHicDImtSfIxg/640?wx_fmt=png"></section><hr><section><span><span>   </span><span>大神一句话，菜鸟跑半年。我不是大神，但我可以缩短你走弯路的半年~</span></span></section><section><span>   就像歌儿唱的那样，如果你不知道该往哪儿走，就留在这学点生信好不好~</span></section><p><span>   这里有豆豆和花花的学习历程，从新手到进阶，生信路上有你有我！</span></p><p><span><br></span></p><section><h3><span>0.背景知识</span></h3><figure><img data-imgfileid="100010919" data-ratio="0.8785488958990536" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/8oKPbJgbBHqHiaXmoYrcZAcXK4sR9LHoh4Mywv82xegOzcIHoFU7icibNLnPSsXbaCkCLHzJyic2yoIqMGdpulL1gw/640?wx_fmt=other&amp;from=appmsg" data-type="other" data-w="634" title="" src="https://mmbiz.qpic.cn/mmbiz_jpg/8oKPbJgbBHqHiaXmoYrcZAcXK4sR9LHoh4Mywv82xegOzcIHoFU7icibNLnPSsXbaCkCLHzJyic2yoIqMGdpulL1gw/640?wx_fmt=other&amp;from=appmsg"><figcaption></figcaption></figure><blockquote><p>图片来自百度百科</p></blockquote><p>尘封的高中生物学知识，细胞的有丝分裂，分为分裂期（M）和分裂间期（G1，S，G2），细胞处于不同的细胞周期时，代谢活跃状态和染色体的状态大不相同，直接比较表达量是不公平的。</p><p>在一些数据中，细胞周期的影响很大，大到每个周期的细胞各自聚成一簇，严重影响下游的聚类和分群。有的数据中，细胞周期的影响非常之低，可以忽略不记。</p><p>Seurat有自带的方法，根据在各个周期高表达的基因来计算细胞周期评分，根据评分的高低来推断细胞属于什么周期。</p><p>让我们来康一康如何探索细胞周期，以及有影响和没影响的数据各自长什么样。</p><h3><span>1.读取数据并做好前期的质控</span></h3><p>搞了两个数据做例子，一个是GSE218208来自GEO，是没太有影响的例子，第二个是来自Seurat Vignette的示例数据，是有影响的例子</p><p>https://satijalab.org/seurat/articles/cell_cycle_vignette</p><h4><span><span> </span>1.1 GSE218208</span></h4><pre><code><span>#</span><span>untar(<span>"GSE218208_RAW.tar"</span>)</span><br>rm(list = ls())<br>a = data.table::fread("GSM6736629_10x-PBMC-1_ds0.1974_CountMatrix.tsv.gz",data.table = F)<br>a[1:4,1:4]<br><span><br>#</span><span>#                 alias:gene AAACCCAAGTAGGGTC AAACCCACACCATTCC AAACCCATCTACACTT</span><br><span>#</span><span># 1   TSPAN6:ENSG00000000003                0                0                0</span><br><span>#</span><span># 2     DPM1:ENSG00000000419                0                1                0</span><br><span>#</span><span># 3    SCYL3:ENSG00000000457                0                0                0</span><br><span>#</span><span># 4 C1orf112:ENSG00000000460                0                0                0</span><br><br>library(tidyverse)<br><span>a$</span><span>`<span>alias</span>:gene` = str_split_i(a$`<span>alias</span>:gene`,<span>":"</span>,i = 1)</span><br>a = distinct(a,`alias:gene`,.keep_all = T)<br>a = column_to_rownames(a,var = "alias:gene")<br>a[1:4,1:4]<br><span><br>#</span><span>#          AAACCCAAGTAGGGTC AAACCCACACCATTCC AAACCCATCTACACTT AAACGAAAGCACGTCC</span><br><span>#</span><span># TSPAN6                  0                0                0                0</span><br><span>#</span><span># DPM1                    0                1                0                0</span><br><span>#</span><span># SCYL3                   0                0                0                0</span><br><span>#</span><span># C1orf112                0                0                0                0</span><br><br>library(Seurat)<br>pbmc &lt;- CreateSeuratObject(counts = a, <br>                           project = "a", <br>                           min.cells = 3, <br>                           min.features = 200)<br>pbmc[["percent.mt"]] &lt;- PercentageFeatureSet(pbmc, pattern = "^MT-")<br>head(pbmc@meta.data, 3)<br><span><br>#</span><span>#                  orig.ident nCount_RNA nFeature_RNA percent.mt</span><br><span>#</span><span># AAACCCAAGTAGGGTC          a      10768         3213   7.030089</span><br><span>#</span><span># AAACCCACACCATTCC          a       4102         1676   5.046319</span><br><span>#</span><span># AAACCCATCTACACTT          a       4694         1740   6.305922</span><br><br>VlnPlot(pbmc, <br>        features = c("nFeature_RNA",<br>                     "nCount_RNA", <br>                     "percent.mt"), <br>        ncol = 3,pt.size = 0.5)<br></code></pre><figure><img data-imgfileid="100010921" data-ratio="0.7138888888888889" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/8oKPbJgbBHqHiaXmoYrcZAcXK4sR9LHoh8VzVaN36Z9HbdcQFozVmia5Noa33ymgnQV3v3Op81tZVKhfuQVukAgQ/640?wx_fmt=other&amp;from=appmsg" data-type="other" data-w="1080" title="" src="https://mmbiz.qpic.cn/mmbiz_jpg/8oKPbJgbBHqHiaXmoYrcZAcXK4sR9LHoh8VzVaN36Z9HbdcQFozVmia5Noa33ymgnQV3v3Op81tZVKhfuQVukAgQ/640?wx_fmt=other&amp;from=appmsg"><figcaption></figcaption></figure><pre><code>pbmc = subset(pbmc,nFeature_RNA &lt; 4200 &amp;<br>                nCount_RNA &lt; 18000 &amp;<br>                percent.mt &lt; 10)<br></code></pre><h4><span><span> </span>1.2 marrow</span></h4><pre><code><span>exp</span>.mat &lt;- <span>read</span>.delim(<span>"nestorawa_forcellcycle_expressionMatrix.txt"</span>,row.names = <span>1</span>)<br>marrow &lt;- CreateSeuratObject(counts = <span>exp</span>.mat,<br>                             project = <span>"b"</span>,<br>                             <span>min</span>.cells = <span>3</span>, <br>                             <span>min</span>.features = <span>200</span>)<br>marrow<span>[["percent.mt"]]</span> &lt;- PercentageFeatureSet(marrow, pattern = <span>"^MT-"</span>)<br>head(marrow@meta.data, <span>3</span>)<br><br>##          orig.ident nCount_RNA nFeature_RNA percent.mt<br>## Prog_013       Prog    <span>2563086</span>        <span>10208</span>   <span>5.187809</span><br>## Prog_019       Prog    <span>3030619</span>         <span>9990</span>   <span>5.965877</span><br>## Prog_031       Prog    <span>1293487</span>        <span>10192</span>   <span>5.664456</span><br><br>VlnPlot(marrow, <br>        features = c(<span>"nFeature_RNA"</span>,<br>                     <span>"nCount_RNA"</span>, <br>                     <span>"percent.mt"</span>), <br>        ncol = <span>3</span>,pt.size = <span>0.5</span>)<br></code></pre><figure><img data-imgfileid="100010923" data-ratio="0.7138888888888889" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/8oKPbJgbBHqHiaXmoYrcZAcXK4sR9LHoh94Nv2uvAalnP6hraQPoAecgSjZXT5418ibGQ5fw00T9QU71w4G47Whg/640?wx_fmt=other&amp;from=appmsg" data-type="other" data-w="1080" title="" src="https://mmbiz.qpic.cn/mmbiz_jpg/8oKPbJgbBHqHiaXmoYrcZAcXK4sR9LHoh94Nv2uvAalnP6hraQPoAecgSjZXT5418ibGQ5fw00T9QU71w4G47Whg/640?wx_fmt=other&amp;from=appmsg"><figcaption></figcaption></figure><pre><code><span>#从图上可以看出这个数据已经过滤了</span><br></code></pre><h3><span>2.计算细胞周期评分</span></h3><pre><code>check_cc =  function(ob){<br>  s.genes &lt;- intersect(cc.genes$s.genes,rownames(ob))<br>  g2m.genes &lt;- intersect(cc.genes$g2m.genes,rownames(ob))<br>  ob = ob %&gt;% <br>  NormalizeData() %&gt;%  <br>  FindVariableFeatures() %&gt;%  <br>  CellCycleScoring(s.features = s.genes, <br>                   g2m.features = g2m.genes) %&gt;%<br>  ScaleData(features = rownames(.)) %&gt;%  <br>  RunPCA(features = c(s.genes,g2m.genes))<br>  return(ob)<br>}<br>ob1 = check_cc(pbmc)<br>head(ob1@meta.data)<br><span><br>#</span><span>#                  orig.ident nCount_RNA nFeature_RNA percent.mt      S.Score</span><br><span>#</span><span># AAACCCAAGTAGGGTC          a      10768         3213   7.030089 -0.049741327</span><br><span>#</span><span># AAACCCACACCATTCC          a       4102         1676   5.046319  0.077834857</span><br><span>#</span><span># AAACCCATCTACACTT          a       4694         1740   6.305922 -0.042199858</span><br><span>#</span><span># AAACGAAAGCACGTCC          a       5584         2055   4.512894 -0.005870195</span><br><span>#</span><span># AAACGAAGTTCAAACC          a       2917         1548   2.673980 -0.036017674</span><br><span>#</span><span># AAACGAAGTTGGACTT          a       3755         1408   5.219707 -0.008708112</span><br><span>#</span><span>#                     G2M.Score Phase</span><br><span>#</span><span># AAACCCAAGTAGGGTC -0.078938340    G1</span><br><span>#</span><span># AAACCCACACCATTCC -0.036964594     S</span><br><span>#</span><span># AAACCCATCTACACTT -0.033518345    G1</span><br><span>#</span><span># AAACGAAAGCACGTCC -0.026582838    G1</span><br><span>#</span><span># AAACGAAGTTCAAACC  0.006352434   G2M</span><br><span>#</span><span># AAACGAAGTTGGACTT -0.060231178    G1</span><br></code></pre><h3><span>3.比较两个数据的细胞周期评分和PCA</span></h3><p>可以看到这个函数处理完后，meta.data里面多了4列，分别是s和g2m的评分以及推断的细胞周期。</p><pre><code><span>table(ob1$</span><span>Phase)</span><br><span><br>#</span><span># </span><br><span>#</span><span>#   G1  G2M    S </span><br><span>#</span><span># 1821 1224 1294</span><br><br>ob2 = check_cc(marrow)<br><span>table(ob2$</span><span>Phase)</span><br><span><br>#</span><span># </span><br><span>#</span><span>#  G1 G2M   S </span><br><span>#</span><span># 279 183 312</span><br><br>PCAPlot(ob1,group.by = "Phase")+ PCAPlot(ob2,group.by = "Phase")<br></code></pre><figure><img data-imgfileid="100010920" data-ratio="0.7138888888888889" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/8oKPbJgbBHqHiaXmoYrcZAcXK4sR9LHohwcTXATn2iab3IJsvNhfchsa3SJTa10g6y1gJa1OCdowT5KGJT3bbOdw/640?wx_fmt=other&amp;from=appmsg" data-type="other" data-w="1080" title="" src="https://mmbiz.qpic.cn/mmbiz_jpg/8oKPbJgbBHqHiaXmoYrcZAcXK4sR9LHohwcTXATn2iab3IJsvNhfchsa3SJTa10g6y1gJa1OCdowT5KGJT3bbOdw/640?wx_fmt=other&amp;from=appmsg"><figcaption></figcaption></figure><p>这样的比较不太直观，把坐标调到相同范围</p><pre><code>library(patchwork)<br>PCAPlot(ob1,<span>group</span>.<span>by</span> = <span>"Phase"</span>)+ <br>  PCAPlot(ob2,<span>group</span>.<span>by</span> = <span>"Phase"</span>)&amp;<br>  xlim(<span>-10</span>,<span>10</span>)&amp;<br>  ylim(<span>-10</span>,<span>10</span>)<br></code></pre><figure><img data-imgfileid="100010922" data-ratio="0.7138888888888889" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/8oKPbJgbBHqHiaXmoYrcZAcXK4sR9LHoh0d79PqDFGLJ9ggHichJfJZZPLNg9FfkRCa6FBTAial7kyY4Sd1SNY5Zg/640?wx_fmt=other&amp;from=appmsg" data-type="other" data-w="1080" title="" src="https://mmbiz.qpic.cn/mmbiz_jpg/8oKPbJgbBHqHiaXmoYrcZAcXK4sR9LHoh0d79PqDFGLJ9ggHichJfJZZPLNg9FfkRCa6FBTAial7kyY4Sd1SNY5Zg/640?wx_fmt=other&amp;from=appmsg"><figcaption></figcaption></figure><p>再比较一下S.Score和G2M.Score</p><pre><code>p1 = VlnPlot(ob1,<span>"S.Score"</span>,<span>group</span>.<span>by</span> = <span>"Phase"</span>)<br>p2 = VlnPlot(ob2,<span>"S.Score"</span>,<span>group</span>.<span>by</span> = <span>"Phase"</span>)<br>wrap_plots(p1,p2,nrow = <span>1</span>) &amp; ylim(<span>-0.6</span>,<span>0.6</span>)<br></code></pre><figure><img data-imgfileid="100010925" data-ratio="0.7138888888888889" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/8oKPbJgbBHqHiaXmoYrcZAcXK4sR9LHohSJ6HyKjja0iciaqkArdIagtiaIyOpM9GSZWsLPyf07gFib6YRiag8vxgZuQ/640?wx_fmt=other&amp;from=appmsg" data-type="other" data-w="1080" title="" src="https://mmbiz.qpic.cn/mmbiz_jpg/8oKPbJgbBHqHiaXmoYrcZAcXK4sR9LHohSJ6HyKjja0iciaqkArdIagtiaIyOpM9GSZWsLPyf07gFib6YRiag8vxgZuQ/640?wx_fmt=other&amp;from=appmsg"><figcaption></figcaption></figure><pre><code>p1 = VlnPlot(ob1,<span>"G2M.Score"</span>,<span>group</span>.<span>by</span> = <span>"Phase"</span>)<br>p2 = VlnPlot(ob2,<span>"G2M.Score"</span>,<span>group</span>.<span>by</span> = <span>"Phase"</span>)<br>wrap_plots(p1,p2,nrow = <span>1</span>) &amp; ylim(<span>-0.5</span>,<span>1</span>)<br></code></pre><figure><img data-imgfileid="100010924" data-ratio="0.7138888888888889" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/8oKPbJgbBHqHiaXmoYrcZAcXK4sR9LHohkrR6ib8pbRodhhIibhrwHcLm8wxGDeLCEfCn3k7o0vqe0cPUnETegEAQ/640?wx_fmt=other&amp;from=appmsg" data-type="other" data-w="1080" title="" src="https://mmbiz.qpic.cn/mmbiz_jpg/8oKPbJgbBHqHiaXmoYrcZAcXK4sR9LHohkrR6ib8pbRodhhIibhrwHcLm8wxGDeLCEfCn3k7o0vqe0cPUnETegEAQ/640?wx_fmt=other&amp;from=appmsg"><figcaption></figcaption></figure><p>这个周期的判断还是比较粗暴的，哪个分高就是那个周期，两个分都是负的那就G1期。</p><p>因此虽然GSE218208的数据也是有周期区别，但是分数相差很小，影响很小。</p><p><strong>所以像这样的大多数点都集中在0点附近的数据，就可以不用去除细胞周期的影响！</strong></p><p>ok，你不踏实。那我们来比较一下去除和不去除细胞周期影响的下游注释看有没有区别吧。</p><h3><span>4.比较去除和不去处细胞周期影响的下游注释</span></h3><h4><span><span> </span>4.1 不考虑细胞周期的降维聚类分群</span></h4><pre><code>f = <span>"ob1.Rdata"</span><br>if(!file.exists(f)){<br>  ob1 = pbmc %&gt;% <br>  NormalizeData() %&gt;%  <br>  FindVariableFeatures() %&gt;%  <br>  ScaleData(features = rownames(.)) %&gt;%  <br>  RunPCA(features = VariableFeatures(.))  %&gt;%<br>  FindNeighbors(dims = 1:15) %&gt;% <br>  FindClusters(resolution = 0.5) %&gt;% <br>  RunUMAP(dims = 1:15) %&gt;% <br>  RunTSNE(dims = 1:15)<br>  save(ob1,file = f)<br>}<br>load(f)<br></code></pre><h4><span><span> </span>4.2 考虑细胞周期的降维聚类分群</span></h4><pre><code>s.genes &lt;- intersect(cc.genes<span>$s</span>.genes,rownames(pbmc))<br>g2m.genes &lt;- intersect(cc.genes<span>$g2m</span>.genes,rownames(pbmc))<br>f = <span>"ob2.Rdata"</span><br><span>if</span>(!file.exists(f)){<br>  ob2 = pbmc %&gt;% <br>  NormalizeData() %&gt;%  <br>  FindVariableFeatures() %&gt;%  <br>  CellCycleScoring(s.features = s.genes, g2m.features = g2m.genes) %&gt;%<br>  ScaleData(vars.to.regress = c(<span>"S.Score"</span>, <span>"G2M.Score"</span>),features = rownames(.)) %&gt;%  <span>#运行极其慢</span><br>  RunPCA(features = VariableFeatures(.))  %&gt;%<br>  FindNeighbors(dims = 1:15) %&gt;% <br>  FindClusters(resolution = 0.5) %&gt;% <br>  RunUMAP(dims = 1:15) %&gt;% <br>  RunTSNE(dims = 1:15)<br>  save(ob2,file = f)<br>}<br><br><span>## Modularity Optimizer version 1.3.0 by Ludo Waltman and Nees Jan van Eck</span><br><span>## </span><br><span>## Number of nodes: 4339</span><br><span>## Number of edges: 146188</span><br><span>## </span><br><span>## Running Louvain algorithm...</span><br><span>## Maximum modularity in 10 random starts: 0.8902</span><br><span>## Number of communities: 12</span><br><span>## Elapsed time: 0 seconds</span><br><br>load(f)<br>p1 &lt;- DimPlot(ob1, reduction = <span>"umap"</span>,label = T)+NoLegend()<br>p2 &lt;- DimPlot(ob2, reduction = <span>"umap"</span>,label = T)+NoLegend()<br>p1+p2<br></code></pre><figure><img data-imgfileid="100010926" data-ratio="0.7138888888888889" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/8oKPbJgbBHqHiaXmoYrcZAcXK4sR9LHohB3cDApaLoOIkaf3CfYvGJ396kMk1YHp0Cyhpq3JkuG4QWxWBdWAFbA/640?wx_fmt=other&amp;from=appmsg" data-type="other" data-w="1080" title="" src="https://mmbiz.qpic.cn/mmbiz_jpg/8oKPbJgbBHqHiaXmoYrcZAcXK4sR9LHohB3cDApaLoOIkaf3CfYvGJ396kMk1YHp0Cyhpq3JkuG4QWxWBdWAFbA/640?wx_fmt=other&amp;from=appmsg"><figcaption></figcaption></figure><p>简单点用singleR来注释</p><pre><code>library(celldex)<br>library(SingleR)<br>ls(<span>"package:celldex"</span>)<br><br><span>## [1] "BlueprintEncodeData"              "DatabaseImmuneCellExpressionData"</span><br><span>## [3] "HumanPrimaryCellAtlasData"        "ImmGenData"                      </span><br><span>## [5] "MonacoImmuneData"                 "MouseRNAseqData"                 </span><br><span>## [7] "NovershternHematopoieticData"</span><br><br>f = <span>"../supp/single_ref/ref_Human_all.RData"</span><br><span>if</span>(!file.exists(f)){<br>  <span>ref</span> &lt;- celldex::HumanPrimaryCellAtlasData()<br>  save(<span>ref</span>,file = f)<br>}<br><span>ref</span> &lt;- get(load(f))<br>library(BiocParallel)<br>scRNA = ob1<br>test = scRNA@assays$RNA$data<br>pred.scRNA &lt;- SingleR(test = test, <br>                      <span>ref</span> = <span>ref</span>,<br>                      labels = <span>ref</span>$label.main, <br>                      clusters = scRNA@active.ident)<br>new.cluster.ids &lt;- pred.scRNA$pruned.labels<br>names(new.cluster.ids) &lt;- levels(scRNA)<br>scRNA &lt;- RenameIdents(scRNA,new.cluster.ids)<br>p3 &lt;- DimPlot(scRNA, reduction = <span>"umap"</span>,label = T,pt.size = <span>0</span>.<span>5</span>) + NoLegend()<br><span>m</span> = scRNA<br></code></pre><p>解释一下为什么会有<code>scRNA = ob1</code>,<code>m = scRNA</code>这样的代码：</p><p>当然是为了少改代码犯错误啦。两次注释的代码是一样的，如果把scRNA这个变量名替换掉就麻烦，别说可以全部替换，万一你替换的变量名称是函数或者文件名等东西的一部分，那不还得报错还得改回去？所以移花接木另行赋值是个更好的选择。</p><pre><code>scRNA = ob2<br>test = scRNA@assays$RNA$data<br>pred.scRNA &lt;- SingleR(test = test, <br>                      <span>ref</span> = <span>ref</span>,<br>                      labels = <span>ref</span>$label.main, <br>                      clusters = scRNA@active.ident)<br>new.cluster.ids &lt;- pred.scRNA$pruned.labels<br>names(new.cluster.ids) &lt;- levels(scRNA)<br>scRNA &lt;- RenameIdents(scRNA,new.cluster.ids)<br>p4 &lt;- DimPlot(scRNA, reduction = <span>"umap"</span>,label = T,pt.size = <span>0</span>.<span>5</span>) + NoLegend()<br>p3+p4<br></code></pre><figure><img data-imgfileid="100010927" data-ratio="0.7138888888888889" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/8oKPbJgbBHqHiaXmoYrcZAcXK4sR9LHohuVKCnmUtGPQXnKpnqiav5Osr3ft8bByPbDYUtERyAtTW36cBjQMaa2A/640?wx_fmt=other&amp;from=appmsg" data-type="other" data-w="1080" title="" src="https://mmbiz.qpic.cn/mmbiz_jpg/8oKPbJgbBHqHiaXmoYrcZAcXK4sR9LHohuVKCnmUtGPQXnKpnqiav5Osr3ft8bByPbDYUtERyAtTW36cBjQMaa2A/640?wx_fmt=other&amp;from=appmsg"><figcaption></figcaption></figure><pre><code>table(Idents(m)==Idents(scRNA))<br><span><br>#</span><span># </span><br><span>#</span><span># FALSE  TRUE </span><br><span>#</span><span>#    53  4241</span><br></code></pre><p>去不去除当然还是有区别的，只不过影响不大，可以忽略不计啊。<span></span></p></section><section><section><section><figure><figcaption></figcaption></figure></section><figure><figcaption></figcaption></figure></section><figure><span></span><span></span></figure></section><section><figure><section><figure><figcaption></figcaption></figure></section></figure></section><section><figure><figcaption></figcaption></figure></section><section><figure><figcaption></figcaption></figure></section><section><figure><figcaption></figcaption></figure></section><section><blockquote><section><span>如果因为代码看不懂，而跟不上正文的节奏，可以来找我，相当于来一个新手保护期。</span><span>我的课程都是循环开课。</span><span>下一期的时间，点进去咨询微信咯</span><br></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU4NjU4ODQ2MQ==&amp;mid=2247494547&amp;idx=1&amp;sn=90165024f9fe55db558502c3ab5dde6e&amp;chksm=fdfba3d1ca8c2ac7d81212b631784044b635a7f11bb921d41eaaa7677623fb9c07aebbfdb994&amp;scene=21#wechat_redirect" textvalue="生信分析直播课‍程" linktype="text" imgurl="" imgdata="null" data-itemshowtype="11" tab="innerlink" data-linktype="2">生信分析直播课程</a></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU4NjU4ODQ2MQ==&amp;mid=2247494009&amp;idx=1&amp;sn=035d253f973f65c0d1069e515eec2ce8&amp;chksm=fdfba13bca8c282de5a9222a2ab8bc0caa2ddf60cab543c2181e6d4a90b553f4dcde5f154adf&amp;scene=21#wechat_redirect" textvalue="生信新手保护学习小组‍" linktype="text" imgurl="" imgdata="null" data-itemshowtype="11" tab="innerlink" data-linktype="2">生信新手保护学习小组</a><br></section></blockquote></section><section><section><br></section></section><section><br></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/bJ0tNj4w5p4R1MX5RHG9Ng",target="_blank" rel="noopener noreferrer">原文链接</a>
