---
title: "单细胞测序最好的教程（十三）：你真的做对过干预后细胞分析吗？"
date: 2024-05-16T14:35:55Z
draft: ["false"]
tags: [
  "fetched",
  "单细胞天地"
]
categories: ["Acdemic"]
---
单细胞测序最好的教程（十三）：你真的做对过干预后细胞分析吗？ by 单细胞天地
------
<div><section data-style-type="5" data-tools="新媒体排版" data-id="2430070"><section data-style-type="5" data-tools="新媒体排版" data-id="2390348"><section><section powered-by="xiumi.us"><section><section><section powered-by="xiumi.us"><section><section><br></section><section><section><section powered-by="xiumi.us"><section><section><p>分享是一种态度</p></section></section></section></section></section></section></section></section><section><section powered-by="xiumi.us"><section><section><img data-ratio="0.8738095238095238" data-src="https://mmbiz.qpic.cn/mmbiz_gif/siaia0BDGJdjSnnb9ibXpFagGPWQ0JjSSTNVBZthROEhicfINuLcxX2Ro3Zb600LJhrzeYIb120tLjSVXEtLn14DwA/640?wx_fmt=gif" data-type="gif" data-w="420" width="100%" data-imgfileid="100035376" src="https://mmbiz.qpic.cn/mmbiz_gif/siaia0BDGJdjSnnb9ibXpFagGPWQ0JjSSTNVBZthROEhicfINuLcxX2Ro3Zb600LJhrzeYIb120tLjSVXEtLn14DwA/640?wx_fmt=gif"></section></section></section></section></section></section></section></section></section><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><blockquote data-tool="mdnice编辑器"><p>作者按</p><p>本章节主要讲解了干预（不同处理）的单细胞数据的正确分析方法，讲解了干预分析与差异表达分析，细胞组成分析的区别，并介绍了<code>查找受扰动影响最大的细胞类型</code>以及<code>预测单细胞对扰动的转录反应</code>的干预分析方法。本教程首发于单细胞最好的中文教程，未经授权许可，禁止转载。</p><p><span>全文字数|预计阅读时间</span>: 5000|10min</p><p>——Starlitnightly（星夜）</p></blockquote><h2 data-tool="mdnice编辑器"><span></span><span>1. 背景</span></h2><p data-tool="mdnice编辑器">在前面的分析教程中，我们详细研究了“不同处理下细胞的差异表达基因”，“不同处理下细胞的组成变化”。实际上，我们还会关心一个很直接的问题，那就是不同处理下，究竟什么细胞受到的影响最大。可能你会说，观察差异表达基因的数量，或者观察哪一类细胞变多了，又或者是对差异表达基因进行通路富集分析去评价通路变化。这两个思路是都是间接去反映细胞的状态，但我们希望有一个直接的评价指标，去评估不同处理后细胞的影响大小。</p><p data-tool="mdnice编辑器">我们先阐明清楚“扰动”的定义，顾名思义，由外部影响所造成的细胞暂时性或永久性的改变。最常见的是CRISPR-Cas9实验带来的基因组扰动现象，其次是由外界干预所带来的转录水平或者蛋白水平的改变。尽管我们可以从实验的角度去衡量扰动的效果，但是对单细胞层面，不同细胞的扰动效果，仍有着较大的发展空间，具体来说有以下几点：</p><ul data-tool="mdnice编辑器"><li><section><span>扰动响应</span>: 根据不同的外界干预方法，我们可以预测扰动后的组学特征。一般我们可以通过预测特征和真实值的相关性来评估，还可以通过表型的测量值进行评估，例如IC50，不同剂量反应下的AUC（曲线下面积），毒性等。</section></li><li><section><span>靶点和机理</span>: 我们通常会采用实验手段去分析药物的靶点与机理，但实际上，对于一种未知作用的化合物而言，我们分析其作用模式，也可以通过扰动响应的方式进行。</section></li><li><section><span>扰动相互作用</span>: 由于干预一般不是独立的，我们有时候会去预测扰动的组合效应，以了解基因组与药物组合之间的相互关联的影响。</section></li><li><section><span>化学性质</span>: 我们除了通过组学层特征的改变去分析药物的扰动响应外，我们也可以根据现有的化合物知识，包括R基团，药效基团等，通过已有的数据来直接预测药物的扰动效应。</section></li></ul><p data-tool="mdnice编辑器">而在本章教程中，我们将分析两个方面，包括<code>查找受扰动影响最大的细胞类型</code>以及<code>预测单细胞对扰动的转录反应</code></p><pre data-tool="mdnice编辑器"><span></span><code><span>import</span> omicverse <span>as</span> ov<br><span>import</span> scanpy <span>as</span> sc<br><span>import</span> scvelo <span>as</span> scv<br><span>import</span> pertpy <span>as</span> pt<br><br>ov.utils.ov_plot_set()<br></code></pre><pre data-tool="mdnice编辑器"><span></span><code>       ____            _     _    __                  <br>      / __ \____ ___  (_)___| |  / /__  _____________ <br>     / / / / __ `__ \/ / ___/ | / / _ \/ ___/ ___/ _ \ <br>    / /_/ / / / / / / / /__ | |/ /  __/ /  (__  )  __/ <br>    \____/_/ /_/ /_/_/\___/ |___/\___/_/  /____/\___/                                              <br>    <br>    Version: 1.5.6, Tutorials: https://omicverse.readthedocs.io/<br><br><br>    Global seed <span>set</span> to 0<br></code></pre><h2 data-tool="mdnice编辑器"><span></span><span>2. 加载数据</span></h2><p data-tool="mdnice编辑器">我们将使用 Kang 数据集，这是一个基于 10 倍液滴的 scRNA-seq 外周血单核细胞 (PBMC) 数据集，来自 8 名狼疮患者 INF-β 治疗前后 6 小时（总共 16 个样本)。</p><pre data-tool="mdnice编辑器"><span></span><code>adata=ov.read(<span>'data/kang.h5ad'</span>)<br>adata<br></code></pre><pre data-tool="mdnice编辑器"><span></span><code>    <span># AnnData object with n_obs × n_vars = 24673 × 15706</span><br>    <span>#     obs: 'nCount_RNA', 'nFeature_RNA', 'tsne1', 'tsne2', 'label', 'cluster', 'cell_type', 'replicate', 'nCount_SCT', 'nFeature_SCT', 'integrated_snn_res.0.4', 'seurat_clusters'</span><br>    <span>#     var: 'name'</span><br>    <span>#     obsm: 'X_pca', 'X_umap'</span><br></code></pre><p data-tool="mdnice编辑器">我们将label重命名为condition以提高可读性，并且将<code>ctrl</code>替换成<code>control</code>,<code>stim</code>替换成<code>stimulated</code>。</p><pre data-tool="mdnice编辑器"><span></span><code>adata.obs.rename({<span>"label"</span>: <span>"condition"</span>}, axis=<span>1</span>, inplace=<span>True</span>)<br>adata.obs[<span>"condition"</span>].replace({<span>"ctrl"</span>: <span>"control"</span>, <span>"stim"</span>: <span>"stimulated"</span>}, inplace=<span>True</span>)<br></code></pre><p data-tool="mdnice编辑器">该数据集包含 PBMC [ Kang等人。，2018 ]的七种不同的细胞类型。</p><pre data-tool="mdnice编辑器"><span></span><code>adata.obs.cell_type.value_counts()<br></code></pre><pre data-tool="mdnice编辑器"><span></span><code>    <span># CD4 T cells          11238</span><br>    <span># CD14+ Monocytes       5697</span><br>    <span># B cells               2651</span><br>    <span># NK cells              1716</span><br>    <span># CD8 T cells           1621</span><br>    <span># FCGR3A+ Monocytes     1089</span><br>    <span># Dendritic cells        529</span><br>    <span># Megakaryocytes         132</span><br>    <span># Name: cell_type, dtype: int64</span><br></code></pre><h2 data-tool="mdnice编辑器"><span></span><span>3. 识别受扰动影响最大的细胞类型</span></h2><p data-tool="mdnice编辑器">扰动很少对所有细胞产生相同的影响。特别是，不同的细胞类型或细胞周期中处于不同状态的细胞可能受到不同程度的影响。在这里，我们将利用Skinnidier 等人的Augur，这提供了一种量化响应程度的方法。</p><figure data-tool="mdnice编辑器"><img data-imgfileid="100035434" data-ratio="0.512962962962963" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSaGKjyKTBmBxeg4AyXl7MdbjpEbvXyfAD659xfQ7Fib4baQNUmn3b4Bl8RS8ljsy9FEibz4DWaRlqQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSaGKjyKTBmBxeg4AyXl7MdbjpEbvXyfAD659xfQ7Fib4baQNUmn3b4Bl8RS8ljsy9FEibz4DWaRlqQ/640?wx_fmt=png&amp;from=appmsg"><figcaption>Augur模型示意图</figcaption></figure><h3 data-tool="mdnice编辑器"><span></span><span>3.1 Augur模型介绍</span><span></span></h3><p data-tool="mdnice编辑器">Augur 的目标是根据细胞类型对给定单细胞基因表达数据的实验扰动的反应，对细胞类型进行排序或优先排序。基本思想是，在分子测量领域，对诱导扰动反应强烈的细胞比反应很少或没有反应的细胞类型更容易分为受扰动组和未受扰动组。通过测量每种细胞类型内实验标签（例如处理和对照）的预测程度来量化这种可分离性。这与AUC的分类方法很像，Augur 训练一个机器学习模型，在多次交叉验证运行中预测每种细胞类型的实验标签，然后根据衡量模型准确性的指标分数对细胞类型响应进行优先级排序。对于分类数据，曲线下面积是默认度量，对于数值数据，一致性相关系数用作模型精度的代理，进而近似扰动响应。</p><p data-tool="mdnice编辑器">我们可以选择两种不同的分类器用作Augur的模型：</p><ul data-tool="mdnice编辑器"><li><section>随机森林模型<code>random_forest_classifier</code>：用于分类数据</section></li><li><section>逻辑回归模型<code>logistic_regression_classifier</code>:：用于数值数据</section></li></ul><p data-tool="mdnice编辑器">在我们的数据中分为Control和stimulated两种类别，故我们选择随机森林模型。</p><pre data-tool="mdnice编辑器"><span></span><code>ag_rfc = pt.tl.Augur(<span>"random_forest_classifier"</span>)<br>loaded_data = ag_rfc.load(adata, label_col=<span>"condition"</span>, cell_type_col=<span>"cell_type"</span>)<br>loaded_data<br></code></pre><pre data-tool="mdnice编辑器"><span></span><code>    <span># AnnData object with n_obs × n_vars = 24673 × 15706</span><br>    <span>#     obs: 'nCount_RNA', 'nFeature_RNA', 'tsne1', 'tsne2', 'label', 'cluster', 'cell_type', 'replicate', 'nCount_SCT', 'nFeature_SCT', 'integrated_snn_res.0.4', 'seurat_clusters', 'y_'</span><br>    <span>#     var: 'name'</span><br>    <span>#     obsm: 'X_pca', 'X_umap'</span><br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span>3.2 Augur模型预测</span><span></span></h3><p data-tool="mdnice编辑器">需要注意的是，由于在Pertpy包中，Augur模型被重新实现。故在保留了Augur的原始模型外，还额外扩展了另一种运行模型，：</p><ul data-tool="mdnice编辑器"><li><section><code>Augur原始模型</code>：我们可以在<code>predict</code>函数中指定参数<code>select_variance_feature=True</code>来使用该模型，该方法使用了方差来计算细胞间的基因特征，仅排除了方差较小的基因。</section></li><li><section><code>高可变基因模型</code>：我们还可以在<code>predict</code>函数中指定参数<code>select_variance_feature=False</code>来使用该模型，这种方法仅采用了单细胞数据中的高可变基因，大幅减少了基因数，由于高可变基因分离细胞类型相当有用，因此我们所计算出来的Augur分数偏高，作者推荐将其应用在具有扰动的非常大的数据集，这些扰动预计会对特定细胞类型产生强烈影响。</section></li></ul><p data-tool="mdnice编辑器">我们预计 INF-β 不会对特定细胞类型产生特殊影响，因此我们使用原始 Augur 特征选择来运行 Augur。为了进一步提高分辨率，我们将 设为subsample_size20（默认值：50），它对应于每种细胞类型随机绘制的细胞数。</p><pre data-tool="mdnice编辑器"><span></span><code>v_adata, v_results = ag_rfc.predict(<br>    loaded_data, subsample_size=<span>20</span>, n_threads=<span>4</span>, select_variance_features=<span>True</span>, span=<span>1</span><br>)<br></code></pre><pre data-tool="mdnice编辑器"><span></span><code>v_results[<span>"summary_metrics"</span>]<br></code></pre><section data-tool="mdnice编辑器"><table><thead><tr><th><br></th><th>CD14+ Monocytes</th><th>CD4 T cells</th><th>Dendritic cells</th><th>NK cells</th><th>CD8 T cells</th><th>B cells</th><th>FCGR3A+ Monocytes</th><th>Megakaryocytes</th></tr></thead><tbody><tr><td>mean_augur_score</td><td>0.920476</td><td>0.669376</td><td>0.847007</td><td>0.673299</td><td>0.626247</td><td>0.783628</td><td>0.888934</td><td>0.512619</td></tr><tr><td>mean_auc</td><td>0.920476</td><td>0.669376</td><td>0.847007</td><td>0.673299</td><td>0.626247</td><td>0.783628</td><td>0.888934</td><td>0.512619</td></tr><tr><td>mean_accuracy</td><td>0.817033</td><td>0.601172</td><td>0.744249</td><td>0.610330</td><td>0.575714</td><td>0.674505</td><td>0.780330</td><td>0.510513</td></tr><tr><td>mean_precision</td><td>0.835072</td><td>0.630593</td><td>0.779699</td><td>0.642700</td><td>0.587059</td><td>0.742801</td><td>0.792996</td><td>0.526175</td></tr><tr><td>mean_f1</td><td>0.806636</td><td>0.564695</td><td>0.735157</td><td>0.591230</td><td>0.552114</td><td>0.633906</td><td>0.780933</td><td>0.406510</td></tr><tr><td>mean_recall</td><td>0.826349</td><td>0.575714</td><td>0.756032</td><td>0.616984</td><td>0.580000</td><td>0.622540</td><td>0.816508</td><td>0.388413</td></tr></tbody></table></section><h3 data-tool="mdnice编辑器"><span></span><span>3.3 Augur模型结果解读</span><span></span></h3><p data-tool="mdnice编辑器">结果表包含拟合模型的几个评估指标。对于 IFN-β 反应的细胞类型优先顺序的解释，只有mean_augur_score相关，对应于mean_auc。值越高，拟合模型就越容易区分控制细胞状态和扰动细胞状态。因此，这种细胞类型的扰动效应更强。让我们可视化一下这个效果。</p><pre data-tool="mdnice编辑器"><span></span><code>lollipop = pt.pl.ag.lollipop(v_results)<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100035430" data-ratio="0.6764374295377678" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSaGKjyKTBmBxeg4AyXl7MdCc6NYLU1pbLrLOktWTo4TczibKO2XjgXTsqVia6FgibwJ663BVxFHMsGQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="887" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSaGKjyKTBmBxeg4AyXl7MdCc6NYLU1pbLrLOktWTo4TczibKO2XjgXTsqVia6FgibwJ663BVxFHMsGQ/640?wx_fmt=png&amp;from=appmsg"><figcaption>细胞干预排序</figcaption></figure><p data-tool="mdnice编辑器">据观察，CD14+单核细胞受IFN-β影响最大，而巨核细胞受影响最小。这大致相当于原始论文中各细胞类型差异表达基因的数量</p><pre data-tool="mdnice编辑器"><span></span><code>ov.utils.embedding(v_adata,<br>                   basis=<span>'X_umap'</span>,<br>                    frameon=<span>'small'</span>,<br>                   color=[<span>"augur_score"</span>, <span>"cell_type"</span>, <span>"label"</span>],<br>                   cmap=<span>'Reds'</span>,<br>                   ncols=<span>2</span>)<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100035431" data-ratio="0.725" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSaGKjyKTBmBxeg4AyXl7MdHRyjCaBCR9kXK8icmVkO7t4nY62d1HcbCrc5iaZ976hoG7RmO6So72Qw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSaGKjyKTBmBxeg4AyXl7MdHRyjCaBCR9kXK8icmVkO7t4nY62d1HcbCrc5iaZ976hoG7RmO6So72Qw/640?wx_fmt=png&amp;from=appmsg"><figcaption>细胞干预可视化</figcaption></figure><h3 data-tool="mdnice编辑器"><span></span><span>3.4 确定扰动关键基因</span><span></span></h3><p data-tool="mdnice编辑器">可能你会觉得，既然与差异表达基因数一致，那为什么不用差异表达基因数来衡量扰动强弱，这是因为，除了关心扰动强弱外，我们还关心扰动的主要干预基因，这些基因不一定是差异表达倍数最高的基因，但他们对模型的贡献度是可以量化的。</p><pre data-tool="mdnice编辑器"><span></span><code>important_features = pt.pl.ag.important_features(v_results)<br></code></pre><p data-tool="mdnice编辑器"><br></p><figure data-tool="mdnice编辑器"><img data-imgfileid="100035432" data-ratio="0.8534850640113798" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSaGKjyKTBmBxeg4AyXl7Md2ZgdEJTZbB41vDyGsMK4nx0EsNQtzEA5XzbibibBuM5KlIgQEszMSkVQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="703" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSaGKjyKTBmBxeg4AyXl7Md2ZgdEJTZbB41vDyGsMK4nx0EsNQtzEA5XzbibibBuM5KlIgQEszMSkVQ/640?wx_fmt=png&amp;from=appmsg"><figcaption>干预基因贡献排序</figcaption></figure><p data-tool="mdnice编辑器"><br></p><p data-tool="mdnice编辑器">虽然这些基因在Augur模型中的贡献度较高，但是，扰动是一种生物性调控，因此，确定扰动直接干预的基因仍需进行进一步的生物学探索，而不是仅根据数据影响来确定。</p><h3 data-tool="mdnice编辑器"><span></span><span>3.5 不同处理中受扰动影响的细胞类型优先级</span><span></span></h3><p data-tool="mdnice编辑器">在上述分析中，我们仅研究了<code>Ctrl</code>和<code>Stim</code>两个组受扰动的影响，但在真实情况中，我们通常会进行多种药物处理，或者是不同时间段的药物干预分析。而在Augur中，提供了排列测试来进行差异优先级划分。</p><p data-tool="mdnice编辑器">基本上，差异优先级是通过对两组细胞类型优先级之间的 AUC 差异进行排列测试来获得的，与样本标签随机排列后相同的两个优先级之间的预期 AUC 差异进行比较。在此过程中，用户首先分别对药物A  和药物B进行细胞类型优先级排序，然后计算药物 A 和药物 B 之间的 AUC 差异。为了计算 AUC 差异的统计显着性，需要使用经验零分布然后通过排列样本标签，然后在排列数据中重复细胞类型优先顺序，计算每种细胞类型的 AUC 差异。然后计算排列 P 值。因此，该程序能够识别不同条件之间细胞类型优先顺序的统计显着差异，以及细胞类型在转录上可分离程度更高的条件。</p><p data-tool="mdnice编辑器">我们在这里使用另外一个数据执行扰动分析，该数据给小鼠提供可卡因，并在戒断后 48 小时（withdraw_48h_Cocaine）和 15 天（withdraw_15d_Cocaine）采集前额皮质样本进行 scRNA-seq。</p><p data-tool="mdnice编辑器">数据下载地址：</p><ul data-tool="mdnice编辑器"><li><section>https://figshare.com/ndownloader/files/34526528</section></li></ul><pre data-tool="mdnice编辑器"><span></span><code>adata=ov.read(<span>'data/bhattacher.h5ad'</span>)<br>adata.obs.rename({<span>"label"</span>: <span>"condition"</span>}, axis=<span>1</span>, inplace=<span>True</span>)<br><span>#ov.pp.preprocess(adata,mode='shiftlog|pearson',n_HVGs=2000,)</span><br>ag_rfc = pt.tl.Augur(<span>"random_forest_classifier"</span>)<br>sc.pp.log1p(adata)<br></code></pre><p data-tool="mdnice编辑器">我们分别测试<code>withdraw_15d_Cocaine</code>和<code>withdraw_48h_Cocaine</code>的augur效果</p><pre data-tool="mdnice编辑器"><span></span><code><span># Default mode</span><br>bhattacherjee_15 = ag_rfc.load(<br>    adata,<br>    label_col=<span>'condition'</span>,<br>    condition_label=<span>"Maintenance_Cocaine"</span>,<br>    treatment_label=<span>"withdraw_15d_Cocaine"</span>,<br>    cell_type_col=<span>"cell_type"</span>,<br>)<br><br>bhattacherjee_adata_15, bhattacherjee_results_15 = ag_rfc.predict(<br>    bhattacherjee_15, random_state=<span>None</span>, <br>    n_threads=<span>4</span>, <br>)<br>bhattacherjee_results_15[<span>"summary_metrics"</span>].loc[<span>"mean_augur_score"</span>].sort_values(<br>    ascending=<span>False</span><br>)<br></code></pre><p data-tool="mdnice编辑器">每个药物处理组在default模式中运行一次，并在permute模式中运行一次，以便我们执行排列测试。</p><p data-tool="mdnice编辑器">我们对48小时组进行相同的分析</p><pre data-tool="mdnice编辑器"><span></span><code><span># Default mode</span><br>bhattacherjee_48 = ag_rfc.load(<br>    adata,<br>    label_col=<span>'condition'</span>,<br>    condition_label=<span>"Maintenance_Cocaine"</span>,<br>    treatment_label=<span>"withdraw_48h_Cocaine"</span>,<br>    cell_type_col=<span>"cell_type"</span>,<br>)<br><br>bhattacherjee_adata_48, bhattacherjee_results_48 = ag_rfc.predict(<br>    bhattacherjee_48, random_state=<span>None</span>, <br>    n_threads=<span>4</span>,<br>)<br><br>bhattacherjee_results_48[<span>"summary_metrics"</span>].loc[<span>"mean_augur_score"</span>].sort_values(<br>    ascending=<span>False</span><br>)<br></code></pre><pre data-tool="mdnice编辑器"><span></span><code>scatter = pt.pl.ag.scatterplot(bhattacherjee_results_15, bhattacherjee_results_48)<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100035433" data-ratio="0.8902077151335311" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSaGKjyKTBmBxeg4AyXl7MdqNKaqkm32Dqm7flbG0su65PLdUdXfJPK0wIXcIaXibibJyGZv9tHHmPw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="674" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSaGKjyKTBmBxeg4AyXl7MdqNKaqkm32Dqm7flbG0su65PLdUdXfJPK0wIXcIaXibibJyGZv9tHHmPw/640?wx_fmt=png&amp;from=appmsg"><figcaption>不同干预细胞前后变化</figcaption></figure><p data-tool="mdnice编辑器">我们发现一个有意思的事，在15天和48小时两个组中，Oligo受干预的影响由0.8恢复至0.55，这表明Oligo会自动修复成正常的细胞状态</p><p data-tool="mdnice编辑器">而设置 <code>augur_mode = “ permute” </code>将为每个单元格类型生成一个空的 AUC 分布，我们可以根据这个空分布去评估不同扰动下的p值情况</p><p data-tool="mdnice编辑器">注意，当设置 <code>augur_mode = “ permute” </code>时，如果n_subsample 值小于100时，将自动设置为500</p><pre data-tool="mdnice编辑器"><span></span><code><span># Permute mode</span><br>bhattacherjee_adata_15_permute, bhattacherjee_results_15_permute = ag_rfc.predict(<br>    bhattacherjee_15,<br>    augur_mode=<span>"permute"</span>,<br>    n_subsamples=<span>100</span>,<br>    random_state=<span>None</span>,<br>    n_threads=<span>4</span>,<br>)<br><span># Permute mode</span><br>bhattacherjee_adata_48_permute, bhattacherjee_results_48_permute = ag_rfc.predict(<br>    bhattacherjee_48,<br>    augur_mode=<span>"permute"</span>,<br>    n_subsamples=<span>100</span>,<br>    random_state=<span>None</span>,<br>    n_threads=<span>4</span>,<br>)<br></code></pre><pre data-tool="mdnice编辑器"><span></span><code>pvals = ag_rfc.predict_differential_prioritization(<br>    augur_results1=bhattacherjee_results_15,<br>    augur_results2=bhattacherjee_results_48,<br>    permuted_results1=bhattacherjee_results_15_permute,<br>    permuted_results2=bhattacherjee_results_48_permute,<br>)<br>pvals<br>diff = pt.pl.ag.dp_scatter(pvals)<br></code></pre><p data-tool="mdnice编辑器">由于 Augur 确定扰动响应的程度，因此它需要不同的细胞类型。如果细胞类型标记是一种持续、平稳的过程或基因表达轨迹（例如细胞分化），那么 Augur 可能不允许进行足够细粒度的排名。</p><h2 data-tool="mdnice编辑器"><span></span><span>4. 预测细胞的扰动响应</span></h2><p data-tool="mdnice编辑器">除了对已知细胞评估扰动响应外，我们还可以根据已有的细胞，预测数据集中未知的细胞的扰动响应。这种情况一般发生在：</p><ul data-tool="mdnice编辑器"><li><section>细胞分选失败：扰动后没有分选到目的细胞</section></li><li><section>细胞捕获频率较低：这类细胞通常多次重复才能通过测序手段发现</section></li></ul><p data-tool="mdnice编辑器">而如果分析这类未知的细胞，我们从实验的角度，需要对样本进行重新测序，这可能带来额外的代价。而基于自编码器AE，研究人员开发了多种扰动建模的方法。在这里，我们演示scGen的应用，这是一种与向量算术相结合的变分自动编码器。该模型学习数据的潜在表示，其中估计对照（未处理）和扰动（处理）细胞之间的差异向量。然后将估计的差异向量添加到感兴趣的细胞类型或群体的对照细胞中，以预测每个单细胞的基因表达反应。</p><h3 data-tool="mdnice编辑器"><span></span><span>4.1 构建模拟数据集</span><span></span></h3><p data-tool="mdnice编辑器">我们假设CD4+ T细胞在IFN-beta治疗后没有被测序仪捕获，构建数据如下。scGen 最适合对数转换数据。由于特征空间减少，高度可变的基因选择可以加快计算速度。</p><pre data-tool="mdnice编辑器"><span></span><code>adata=ov.read(<span>'data/kang.h5ad'</span>)<br>adata.obs.rename({<span>"label"</span>: <span>"condition"</span>}, axis=<span>1</span>, inplace=<span>True</span>)<br>adata.obs[<span>"condition"</span>].replace({<span>"ctrl"</span>: <span>"control"</span>, <br>                                <span>"stim"</span>: <span>"stimulated"</span>}, inplace=<span>True</span>)<br>adata=ov.pp.preprocess(adata,mode=<span>'shiftlog|pearson'</span>,n_HVGs=<span>2000</span>,)<br>adata.raw = adata<br>adata = adata[:, adata.var.highly_variable_features]<br>adata<br></code></pre><pre data-tool="mdnice编辑器"><span></span><code>    <span># Begin robust gene identification</span><br>    <span># After filtration, 15706/15706 genes are kept. Among 15706 genes, 12841 genes are robust.</span><br>    <span># End of robust gene identification.</span><br>    <span># Begin size normalization: shiftlog and HVGs selection pearson</span><br>    <span># normalizing counts per cell The following highly-expressed genes are not considered during normalization factor computation:</span><br>    <span># ['HBB', 'FTH1', 'MALAT1', 'HBA2', 'FTL', 'IGLL5']</span><br>    <span>#     finished (0:00:00)</span><br>    <span># extracting highly variable genes</span><br>    <span># --&gt; added</span><br>    <span>#     'highly_variable', boolean vector (adata.var)</span><br>    <span>#     'highly_variable_rank', float vector (adata.var)</span><br>    <span>#     'highly_variable_nbatches', int vector (adata.var)</span><br>    <span>#     'highly_variable_intersection', boolean vector (adata.var)</span><br>    <span>#     'means', float vector (adata.var)</span><br>    <span>#     'variances', float vector (adata.var)</span><br>    <span>#     'residual_variances', float vector (adata.var)</span><br>    <span># End of size normalization: shiftlog and HVGs selection pearson</span><br></code></pre><pre data-tool="mdnice编辑器"><span></span><code>adata[adata.obs[<span>"condition"</span>] == <span>"stimulated"</span>].obs.cell_type.value_counts()<br></code></pre><pre data-tool="mdnice编辑器"><span></span><code>    <span># CD4 T cells          5678</span><br>    <span># CD14+ Monocytes      2765</span><br>    <span># B cells              1335</span><br>    <span># NK cells              861</span><br>    <span># CD8 T cells           810</span><br>    <span># FCGR3A+ Monocytes     569</span><br>    <span># Dendritic cells       271</span><br>    <span># Megakaryocytes         69</span><br>    <span># Name: cell_type, dtype: int64</span><br></code></pre><p data-tool="mdnice编辑器">我们删除<code>stimulated</code>下的所有CD4+ T细胞，命名为<code>adata_t</code>，同时存放<code>stimulated</code>下的所有CD4+ T细胞，命名为<code>cd4t_stim</code></p><pre data-tool="mdnice编辑器"><span></span><code>adata_t = adata[<br>    ~(<br>        (adata.obs[<span>"cell_type"</span>] == <span>"CD4 T cells"</span>)<br>        &amp; (adata.obs[<span>"condition"</span>] == <span>"stimulated"</span>)<br>    )<br>].copy()<br><br>cd4t_stim = adata[<br>    (<br>        (adata.obs[<span>"cell_type"</span>] == <span>"CD4 T cells"</span>)<br>        &amp; (adata.obs[<span>"condition"</span>] == <span>"stimulated"</span>)<br>    )<br>].copy()<br></code></pre><pre data-tool="mdnice编辑器"><span></span><code>adata_t[adata_t.obs[<span>"condition"</span>] == <span>"stimulated"</span>].obs.cell_type.value_counts()<br></code></pre><pre data-tool="mdnice编辑器"><span></span><code>    <span># CD14+ Monocytes      2765</span><br>    <span># B cells              1335</span><br>    <span># NK cells              861</span><br>    <span># CD8 T cells           810</span><br>    <span># FCGR3A+ Monocytes     569</span><br>    <span># Dendritic cells       271</span><br>    <span># Megakaryocytes         69</span><br>    <span># Name: cell_type, dtype: int64</span><br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span>4.2 构建scGEN模型并训练</span><span></span></h3><p data-tool="mdnice编辑器">scGen 需要修改后的AnnData对象 (adata_t) 来构造模型对象，该模型对象可用于训练模型。n_hidden该函数接收多个用户输入，包括bottleneck（网络的中间层）之前模型的每个hidden（ 隐藏层）中的节点数以及此类层的数量（n_layers）。此外，用户可以调整包括bottleneck的维度，该维度用于计算扰动单元和控制单元之间的差异向量。这里使用的默认参数取自原始出版物。在实践中，更宽的隐藏层可以带来更好的重建精度，这对于我们预测许多基因的扰动响应的目标至关重要。</p><pre data-tool="mdnice编辑器"><span></span><code><span>import</span> scgen<br>scgen.SCGEN.setup_anndata(adata_t, <br>                          batch_key=<span>"condition"</span>, <br>                          labels_key=<span>"cell_type"</span>)<br>model = scgen.SCGEN(adata_t, n_hidden=<span>800</span>, n_latent=<span>100</span>, n_layers=<span>2</span>)<br></code></pre><p data-tool="mdnice编辑器">scGen 是一个具有数千个参数的神经网络，用于学习低维数据表示。在这里，我们train使用训练数据来估计这些参数。这里有多个参数:</p><ul data-tool="mdnice编辑器"><li><section>max_epochs是模型允许更新参数的最大迭代次数，这里设置为100。较高值的训练纪元将花费更多计算时间，但可能有助于获得更好的结果。</section></li><li><section>batch_size模型更新其参数的样本（单个单元）的数量。对于 scGen，较低的数字通常会带来更好的结果。</section></li><li><section>early_stopping如果模型的结果在early_stopping_patience训练周期后没有改善，它可以使模型停止训练。早期停止机制可以防止训练数据的潜在过度拟合，从而导致对未见过的群体的泛化效果不佳。</section></li></ul><pre data-tool="mdnice编辑器"><span></span><code>model.train(<br>    max_epochs=<span>100</span>, batch_size=<span>32</span>, <br>    early_stopping=<span>True</span>, early_stopping_patience=<span>25</span><br>)<br></code></pre><pre data-tool="mdnice编辑器"><span></span><code>    <span># GPU available: True (cuda), used: True</span><br>    <span># TPU available: False, using: 0 TPU cores</span><br>    <span># IPU available: False, using: 0 IPUs</span><br>    <span># HPU available: False, using: 0 HPUs</span><br>    <span># LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]</span><br><br><br>    <span># Epoch 26/100:  26%|██▌       | 26/100 [02:34&lt;07:20,  5.95s/it, loss=1.5e+03, v_num=1] </span><br>    <span># Monitored metric elbo_validation did not improve in the last 25 records. Best score: 3924.366. Signaling Trainer to stop.</span><br></code></pre><p data-tool="mdnice编辑器">为了可视化模型学习到的数据表示，我们使用 UMAP 算法绘制模型的潜在表示。返回get_latent_representation() 每个单元格的 100 维向量。我们将潜在表示存储在AnnData 对象的.obsm槽中。</p><pre data-tool="mdnice编辑器"><span></span><code>adata_t.obsm[<span>"scgen"</span>] = model.get_latent_representation()<br>adata_t.obsm[<span>"X_mde"</span>]=ov.utils.mde(adata_t.obsm[<span>"scgen"</span>])<br></code></pre><pre data-tool="mdnice编辑器"><span></span><code>ov.utils.embedding(adata_t, <br>           basis=<span>'X_mde'</span>,<br>           color=[<span>"condition"</span>, <span>"cell_type"</span>], <br>           wspace=<span>0.4</span>, frameon=<span>'small'</span>)<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100035438" data-ratio="0.3277777777777778" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSaGKjyKTBmBxeg4AyXl7MdibibWh9A7NxOrvoOspaajx1eqP8JKad2YY5O28EE2ru4znNHsTCX46vw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSaGKjyKTBmBxeg4AyXl7MdibibWh9A7NxOrvoOspaajx1eqP8JKad2YY5O28EE2ru4znNHsTCX46vw/640?wx_fmt=png&amp;from=appmsg"><figcaption>IFN-beta刺激后的降维可视化</figcaption></figure><p data-tool="mdnice编辑器">如上所述，IFN-β 刺激诱导所有细胞类型发生强烈的转录变化</p><h3 data-tool="mdnice编辑器"><span></span><span>4.4 预测CD4+ T细胞对IFN-β刺激的反应</span><span></span></h3><p data-tool="mdnice编辑器">模型训练完成后，我们可以要求模型模拟训练数据中存在的每个对照 CD4T 细胞的 IFN-β 反应效果。通过该方法可以进行预测，该方法接收对象（如用户之前提供的）列中的predict相应标签（ctrl_key及stim_key以下），以估计“control”和“stimulated”之间的潜在空间中的全局差异向量' 细胞。然后添加到（此处为 CD4+ T）中指定的每个单细胞中。</p><pre data-tool="mdnice编辑器"><span></span><code>pred, delta = model.predict(<br>    ctrl_key=<span>"control"</span>, <br>    stim_key=<span>"stimulated"</span>, <br>    celltype_to_predict=<span>"CD4 T cells"</span><br>)<br><br><span># we annotate the predicted cells to distinguish them later from ground truth cells.</span><br>pred.obs[<span>"condition"</span>] = <span>"predicted stimulated"</span><br>pred<br></code></pre><pre data-tool="mdnice编辑器"><span></span><code>    <span># [34mINFO    [0m Received view of anndata, making copy.                                                                    </span><br>    <span># [34mINFO    [0m Input AnnData not setup with scvi-tools. attempting to transfer AnnData setup                             </span><br>    <span># [34mINFO    [0m Received view of anndata, making copy.                                                                    </span><br>    <span># [34mINFO    [0m Input AnnData not setup with scvi-tools. attempting to transfer AnnData setup                             </span><br>    <span># [34mINFO    [0m Received view of anndata, making copy.                                                                    </span><br>    <span># [34mINFO    [0m Input AnnData not setup with scvi-tools. attempting to transfer AnnData setup    </span><br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span>4.5 评估预测的IFN-β刺激的CD4+ T细胞的反应</span><span></span></h3><p data-tool="mdnice编辑器">我们在前面的数据中保存了受IFN-beta刺激的CD4+ T细胞位于<code>cd4t_stim</code>对象中，我们可以对比我们预测的CD4+ T细胞与实际的CD4+ T细胞，来评估scGen预测扰动的准确性。我们将从以下几个维度来评估：</p><ul data-tool="mdnice编辑器"><li><section>主成分分析空间中Control，Predicted，Actual的CD4+ T细胞的特征表示</section></li><li><section>Predicted的刺激后CD4+ T细胞与实际的刺激后CD4+ T细胞对于Control的差异表达基因的相关性。</section></li></ul><pre data-tool="mdnice编辑器"><span></span><code>ctrl_adata = adata[<br>    ((adata.obs[<span>"cell_type"</span>] == <span>"CD4 T cells"</span>) &amp; (adata.obs[<span>"condition"</span>] == <span>"control"</span>))<br>]<br><span># concatenate pred, control and real CD4 T cells in to one object</span><br>eval_adata = sc.concat([ctrl_adata,cd4t_stim, pred],merge=<span>'same'</span>)<br>eval_adata.obs.condition.value_counts()<br></code></pre><pre data-tool="mdnice编辑器"><span></span><code>    <span># stimulated              5678</span><br>    <span># control                 5560</span><br>    <span># predicted stimulated    5560</span><br>    <span># Name: condition, dtype: int64</span><br></code></pre><p data-tool="mdnice编辑器">我们首先观察对照、IFN-β 刺激和预测的 CD4T 细胞的 PCA 共嵌入。</p><pre data-tool="mdnice编辑器"><span></span><code>ov.pp.scale(eval_adata)<br>ov.pp.pca(eval_adata,layer=<span>'scaled'</span>,n_pcs=<span>50</span>)<br>eval_adata.obsm[<span>"X_mde_pca"</span>]=ov.utils.mde(eval_adata.obsm[<span>"scaled|original|X_pca"</span>])<br>ov.utils.embedding(eval_adata, <br>                   basis=<span>'scaled|original|X_pca'</span>,<br>                   color=<span>"condition"</span>, <br>                   frameon=<span>'small'</span>,<br>                  )<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100035437" data-ratio="0.6581986143187067" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSaGKjyKTBmBxeg4AyXl7MdIgeSvT9gkj1oZO8OSLv1IpMfzcLDO9FydoN2H9MGpsFFPcT86ibXLdA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="866" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSaGKjyKTBmBxeg4AyXl7MdIgeSvT9gkj1oZO8OSLv1IpMfzcLDO9FydoN2H9MGpsFFPcT86ibXLdA/640?wx_fmt=png&amp;from=appmsg"><figcaption>PCA可视化扰动预测</figcaption></figure><p data-tool="mdnice编辑器">如上所述，预测的刺激细胞向用 IFN-β 刺激的 CD4T 细胞移动。然而，我们还应该关注差异表达基因（DEG），以验证最引人注目的 DE 基因是否也存在于预测的刺激细胞中。下面，我们看看预测细胞和真实细胞之间的总体平均相关性。在此之前，我们提取对照细胞和刺激细胞之间的 DEG</p><pre data-tool="mdnice编辑器"><span></span><code>cd4t_adata = adata[adata.obs[<span>"cell_type"</span>] == <span>"CD4 T cells"</span>]<br>sc.tl.rank_genes_groups(cd4t_adata, groupby=<span>"condition"</span>, method=<span>"wilcoxon"</span>)<br>diff_genes = cd4t_adata.uns[<span>"rank_genes_groups"</span>][<span>"names"</span>][<span>"stimulated"</span>]<br>diff_genes<br></code></pre><pre data-tool="mdnice编辑器"><span></span><code>    <span># ranking genes</span><br>    <span>#     finished: added to `.uns['rank_genes_groups']`</span><br>    <span>#     'names', sorted np.recarray to be indexed by group ids</span><br>    <span>#     'scores', sorted np.recarray to be indexed by group ids</span><br>    <span>#     'logfoldchanges', sorted np.recarray to be indexed by group ids</span><br>    <span>#     'pvals', sorted np.recarray to be indexed by group ids</span><br>    <span>#     'pvals_adj', sorted np.recarray to be indexed by group ids (0:00:04)</span><br><br></code></pre><p data-tool="mdnice编辑器">scGen 的函数reg_mean_plot是计算预测的 IFN-β 细胞和现有的 IFN-β 细胞的平均基因表达之间的 R² 相关性。R² 越高（最大值为 1），与实际情况相比，预测就越可信。红色突出显示的基因是 IFN-β 刺激后上调的前 10 个 DEG，这对于成功的预测至关重要。</p><p data-tool="mdnice编辑器">正如所观察到的，该模型对于平均值较高的基因表现良好，而对于一些平均表达在 0-4之间的基因则失败。我们还测量了非 DEG 的准确性，因为模型不应在改变 DEG 表达的同时，把不受扰动影响的基因也改变了。</p><pre data-tool="mdnice编辑器"><span></span><code><span>#eval_adata=eval_adata.raw.to_adata()</span><br>ov.plot_set()<br>r2_value = model.reg_mean_plot(<br>    eval_adata,<br>    axis_keys={<span>"x"</span>: <span>"predicted stimulated"</span>, <span>"y"</span>: <span>"stimulated"</span>},<br>    gene_list=diff_genes[:<span>10</span>],<br>    <span>#top_100_genes=list(set(diff_genes) &amp; set(eval_adata.var_names)),</span><br>    labels={<span>"x"</span>: <span>"predicted"</span>, <span>"y"</span>: <span>"ground truth"</span>},<br>    show=<span>True</span>,<br>    legend=<span>False</span>,<br>    x_coeff=<span>0.98</span>,<br>    y_coeff=<span>1</span><br>)<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100035436" data-ratio="0.9711538461538461" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSaGKjyKTBmBxeg4AyXl7MdxXb1Iofz7yRafGav1dib8DGxLFibLRpHbTqX5Z9kQB9b3JKnfG1Y6bYg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="624" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSaGKjyKTBmBxeg4AyXl7MdxXb1Iofz7yRafGav1dib8DGxLFibLRpHbTqX5Z9kQB9b3JKnfG1Y6bYg/640?wx_fmt=png&amp;from=appmsg"><figcaption>真实与预测的相关性</figcaption></figure><p data-tool="mdnice编辑器">我们还可以观察 IFN-β 最上调基因的分布。例如，我们绘制了ISG15的表达分布，这是IFN刺激后诱导的基因 。正如所观察到的，该模型确定该基因在用 IFN-β 刺激后应该上调，并且它确实将值转移到真实（刺激）细胞中的类似范围。</p><pre data-tool="mdnice编辑器"><span></span><code><span>import</span> matplotlib.pyplot <span>as</span> plt<br>sc.pl.violin(eval_adata, keys=<span>"ISG15"</span>, groupby=<span>"condition"</span>,show=<span>False</span>)<br>plt.xticks(rotation=<span>90</span>)<br>plt.show()<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100035435" data-ratio="1.488695652173913" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSaGKjyKTBmBxeg4AyXl7MdSKmQPPiaEIebUpiaT1E8ChHPibLoAmTrBsOUuB5MloJFeeWclaVqXdYIA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="575" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSaGKjyKTBmBxeg4AyXl7MdSKmQPPiaEIebUpiaT1E8ChHPibLoAmTrBsOUuB5MloJFeeWclaVqXdYIA/640?wx_fmt=png&amp;from=appmsg"><figcaption>ISG15在不同组别的表达</figcaption></figure><p data-tool="mdnice编辑器">总体而言，我们展示了 scGen 作为扰动响应模型的示例在预测所需扰动下未见群体的基因表达中的应用。虽然扰动响应模型提供了计算机预测，但它们不能代替实际实验。还不清楚预测的反应有多少归因于细胞类型特异性反应或跨细胞类型。然而，正如在 scGen 的情况下观察到的那样，它可以预测高表达基因的总体反应，但对低表达基因的预测效果较差，这需要进一步优化和动力来开发更复杂和稳健的方法。</p><h2 data-tool="mdnice编辑器"><span></span><span>5. 总结</span></h2><ul data-tool="mdnice编辑器"><li><section>应用 Augur 时，确保可以细胞类型的清晰可分离的，进而使用差异丰度测试来查找混杂效应，除此之外，我们还可以使用差异基因表达来查找扰动效应的基因水平来源。</section></li><li><section>使用 scGen 等工具预测扰动响应对于高表达基因效果很好，但对于低表达基因则具有一定的困难。</section></li></ul><h2 data-tool="mdnice编辑器"><span></span><span>6. 思考</span></h2><ul data-tool="mdnice编辑器"><li><section>为什么应用 Augur 时需要有可靠的细胞类型标签？</section></li><li><section>为什么 scGen 主要只应用于高表达基因？</section></li></ul></section><section><p><br></p><p><br></p><section data-style-type="5" data-tools="新媒体排版" data-id="2440476"><section><section><section><section><img data-imgfileid="100035375" data-ratio="0.9495798319327731" data-src="https://mmbiz.qpic.cn/mmbiz_gif/09gp6SvPE04j3m2v7Hr889icHUyibTOHs8YuUibicl7ibRD0ZwG5pDTjBluRreZvuib1o3BibvLkicYhnA4YW7dQsjn0cA/640?wx_fmt=gif" data-type="gif" data-w="119" data-width="100%" src="https://mmbiz.qpic.cn/mmbiz_gif/09gp6SvPE04j3m2v7Hr889icHUyibTOHs8YuUibicl7ibRD0ZwG5pDTjBluRreZvuib1o3BibvLkicYhnA4YW7dQsjn0cA/640?wx_fmt=gif"></section><section data-brushtype="text">往期回顾</section><section><br></section></section></section></section><section><section data-autoskip="1"><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247519133&amp;idx=1&amp;sn=42293cd8456a5b4d00a64bfe5a7a47ca&amp;chksm=ea1c8d1fdd6b0409d658d83639f6d12cdb9e4825096d3751add69c762c0cbbb87f13b930d6a8&amp;scene=21#wechat_redirect" textvalue="单细胞测序最好的教程（十二）：你真的做对了细胞比例分析吗？" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2"><span>单细胞测序最好的教程（十二）：你真的做对了细胞比例分析吗？</span></a><br></p><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247518832&amp;idx=1&amp;sn=292407e85bc2b169861bcd1d82aaae39&amp;chksm=ea1c8cf2dd6b05e477962ad1737ae6b7d12f3833359cb39645b83dea1d92e532e596fb4cf875&amp;scene=21#wechat_redirect" textvalue="单细胞测序最好的教程（十一）：差异表达基因分析｜或许比pseudobulk更优" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2"><span>单细胞测序最好的教程（十一）：差异表达基因分析｜或许比pseudobulk更优</span></a><br></p><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247515825&amp;idx=2&amp;sn=5122e66e005b04194ee21569d8c8245f&amp;chksm=ea1cb833dd6b312560d4da99a3ed73c7110d5ce84ae71bb8f9d3ab565de3f077521f0ff04ad0&amp;scene=21#wechat_redirect" textvalue="单细胞测序最好的教程（十）：万能的Transformer与细胞注释" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2"><span>单细胞测序最好的教程（十）：万能的Transformer与细胞注释</span></a><br></p><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247515808&amp;idx=1&amp;sn=271304f9dbf9a7e504f5e7644c207046&amp;chksm=ea1cb822dd6b313430cc7a76a713b603552598db95ec32fb66dfc1adbfd8d4ed622b44002a51&amp;scene=21#wechat_redirect" textvalue="单细胞测序最好的教程（九）: 发表在Science的细胞注释算法" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2"><span>单细胞测序最好的教程（九）: 发表在Science的细胞注释算法</span></a><br></p><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247515584&amp;idx=1&amp;sn=cdebf7564d705460fe9dc975731cd415&amp;chksm=ea1cbb42dd6b3254fb79fb6553ebfd4cdc501ffb6e1c5f67e035e45c6827e4c958b471a7102a&amp;scene=21#wechat_redirect" textvalue="单细胞测序最好的教程（八）: 基于marker的自动注释" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2"><span>单细胞测序最好的教程（八）: 基于marker的自动注释</span></a><br></p></section></section><hr><p><br></p></section><section data-style-type="5" data-tools="新媒体排版" data-id="2440475"><hr><p><br></p><hr><section><p>如果你对单细胞转录组研究感兴趣，但又不知道如何入门，也许你可以关注一下下面的课程<span></span></p><p><br></p><ul><li><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247527207&amp;idx=1&amp;sn=fb9ca814003fc24e9ec8b1bcecbd1d56&amp;chksm=9b4b2b9cac3ca28afc5b68047e5f0587b6636d52879051decd573009e38313c5f7d6b0d1927d&amp;scene=21#wechat_redirect" textvalue="生信入门&amp;数据挖掘线上直播课2024年1月班" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1">生信入门&amp;数据挖掘线上直播课2024年1月班</a><br></p></li><li><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247524148&amp;idx=1&amp;sn=7806da6feb41a36493c519c1cfc1d3ac&amp;chksm=9b4bdf8fac3c569960369602f1ef26639cb366b250f233b2297d1f059471c0458335bfc0b829&amp;scene=21#wechat_redirect" textvalue="时隔5年，我们的生信技能树VIP学徒继续招生啦" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1">时隔5年，我们的生信技能树VIP学徒继续招生啦</a><br></p></li><li><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247526168&amp;idx=1&amp;sn=ebc4a9d53d675e3f7d20b1e2f97901b8&amp;chksm=9b4b27a3ac3caeb5ee0828c38f816c229067d1946be224bcaf4bac0dbdfc9eff863c621097e2&amp;scene=21#wechat_redirect" textvalue="生物信息学江湖的开创性产品-共享服务器" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1">生物信息学江湖的开创性产品-共享服务器</a></p></li></ul><p><img data-imgfileid="100035374" data-ratio="1" data-src="https://mmbiz.qpic.cn/mmbiz_gif/4TKeL1ZejtlKxOib5kmKX6ic6eX0w0WK5jvhtz9yBRsO3OI4yr6S5iaLNM7AbAeuPDHXMvDdur2DRz9wyiax4lEviag/640?wx_fmt=gif" data-type="gif" data-w="240" src="https://mmbiz.qpic.cn/mmbiz_gif/4TKeL1ZejtlKxOib5kmKX6ic6eX0w0WK5jvhtz9yBRsO3OI4yr6S5iaLNM7AbAeuPDHXMvDdur2DRz9wyiax4lEviag/640?wx_fmt=gif"><br></p><p><img data-imgfileid="100035372" data-ratio="0.05278592375366569" data-src="https://mmbiz.qpic.cn/mmbiz/4TKeL1Zejtlq03ZOSZiaTlic1MxgdKiaxTbOZ7ZSe0Xx1Ca8xF3L6Nyj1FYUajtYrSmRIHyZVSsAve0EAvEicZONpg/640?wx_fmt=jpeg" data-type="other" data-w="341" src="https://mmbiz.qpic.cn/mmbiz/4TKeL1Zejtlq03ZOSZiaTlic1MxgdKiaxTbOZ7ZSe0Xx1Ca8xF3L6Nyj1FYUajtYrSmRIHyZVSsAve0EAvEicZONpg/640?wx_fmt=jpeg"></p><p><strong><span>看完记得顺手点个</span></strong><span><strong><span>“在看”</span></strong></span><strong><span>哦！</span></strong></p></section><section><section data-id="93668"><section><section data-width="95%"><section><section><section data-width="38%"><section><section data-tools="135编辑器" data-id="93668"><section><section data-width="95%"><section><section><section data-width="61.8%"><section><section><section><p><br></p><span><strong data-burshtype="text"><img data-copyright="0" data-cropselx1="0" data-cropselx2="109" data-cropsely1="0" data-cropsely2="109" data-imgfileid="100035373" data-ratio="1" data-src="https://mmbiz.qpic.cn/mmbiz/siaia0BDGJdjRMGrkqo64BGKecYk4akuHpGHVQs7FeOpY7eWbIPGC1tRw5Tw0oEPmx053mR9FTVerWvhuZchIpZw/640?wx_fmt=jpeg" data-type="other" data-w="258" title="qrcode_for_gh_5a3c482ed99f_1280.jpg" src="https://mmbiz.qpic.cn/mmbiz/siaia0BDGJdjRMGrkqo64BGKecYk4akuHpGHVQs7FeOpY7eWbIPGC1tRw5Tw0oEPmx053mR9FTVerWvhuZchIpZw/640?wx_fmt=jpeg"><strong data-burshtype="text">生物</strong><strong data-burshtype="text"> | 单细胞 | 转录组丨资料</strong></strong></span></section><section><span><strong data-burshtype="text">每天都精彩</strong></span></section></section></section><section><section><section><section><section><section><p><span>长按扫码可关注</span></p></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/FlO4fN5AlcyZ81llzHE5Ag",target="_blank" rel="noopener noreferrer">原文链接</a>
