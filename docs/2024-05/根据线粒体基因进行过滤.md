---
title: "根据线粒体基因进行过滤"
date: 2024-05-01T02:27:46Z
draft: ["false"]
tags: [
  "fetched",
  "单细胞天地"
]
categories: ["Acdemic"]
---
根据线粒体基因进行过滤 by 单细胞天地
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><h3 data-tool="mdnice编辑器"><span></span><span></span><span>前情提要</span><span></span></h3><p data-tool="mdnice编辑器">上篇推文中对<a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247521951&amp;idx=1&amp;sn=97b6fdf3c64463eff877c89ca8ac5af7&amp;chksm=ea1c901ddd6b190b9c50e29435df3d2bf7bd283b022fafc29c41cb0fd27ea3ddb11e0593eb03&amp;scene=21#wechat_redirect" textvalue="ncount_RNA 和nFeature_RNA" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2"><strong>ncount_RNA 和nFeature_RNA</strong></a>进行了可视化，然后<strong>基于可视化结果进行了阈值的判断，并且也给大家分享了在实际分析中的应用</strong></p><figure data-tool="mdnice编辑器"><img data-imgfileid="100038464" data-ratio="1.1796296296296296" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjRpH9DlgvEA8pkoRDvmAO8UYaghvWoGngGTdfy04V5evOhKLic8ibSfHuam72Qbiaia3A2pnmyymIP33Q/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjRpH9DlgvEA8pkoRDvmAO8UYaghvWoGngGTdfy04V5evOhKLic8ibSfHuam72Qbiaia3A2pnmyymIP33Q/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器">其中也提到了在我们的质控脚本中，首先是<strong>计算了线粒体、核糖体以及血红细胞的比例</strong>，然后就可视化了细胞中这些参数的情况，在基于这些数据进行一个过滤</p><p data-tool="mdnice编辑器">那这期我们来了解一下<strong>如何根据线粒体、核糖体以及红血蛋白基因的比例，对细胞进行过滤</strong></p><h3 data-tool="mdnice编辑器"><span></span><span></span><span>为什么要基于这些基因进行过滤</span><span></span></h3><p data-tool="mdnice编辑器">单细胞中表达量最高的基因一般是<strong>线粒体基因、核糖体基因等</strong></p><pre data-tool="mdnice编辑器"><span></span><code><span>#抽样查看TOP50基因</span><br><span># 这里的C 这个矩阵，有一点大，可以考虑随抽样 </span><br>C=subset(sce.all,downsample=1000)@assays<span>$RNA</span><span>$counts</span><br>dim(C)<br>dim(sce.all)<br><br>C=Matrix::t(Matrix::t(C)/Matrix::colSums(C)) * 100<br><br>most_expressed &lt;- order(apply(C, 1, median), decreasing = T)[50:1]<br><br>pdf(<span>"TOP50_most_expressed_gene.pdf"</span>,width=14)<br><br>pdf(<span>"test.pdf"</span>,width = 15,height = 15)<br><br>boxplot(as.matrix(Matrix::t(C[most_expressed, ])),<br>        cex = 0.2, las = 2, <br>        ylim=c(0,8),<br>        xlab = <span>"% total count per cell"</span>,<br>        col = (scales::hue_pal())(50)[50:1], <br>        horizontal = TRUE)<br><br><br>dev.off()<br><br></code></pre><p><img data-galleryid="" data-imgfileid="100038481" data-ratio="1.0138888888888888" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjRpH9DlgvEA8pkoRDvmAO8UyYCgHVdy9PO4PhWfaKvph6DMlZM5xuZRcaYV5s4Ca2uf7QXkpzmHLA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjRpH9DlgvEA8pkoRDvmAO8UyYCgHVdy9PO4PhWfaKvph6DMlZM5xuZRcaYV5s4Ca2uf7QXkpzmHLA/640?wx_fmt=png&amp;from=appmsg"></p><p data-tool="mdnice编辑器">如果是<strong>线粒体基因高表达的细胞</strong>，可能是<strong>处于凋亡状态或者裂解状态的细胞</strong>，会干扰后续的分析</p><p data-tool="mdnice编辑器"><strong>红细胞中会高表达血红蛋白基因</strong>，而红细胞本身是不含有细胞核的，且携带的基因少，其携带的基因与疾病以及生物发育等过程没有太大的联系，所以可以直接剔除掉</p><h3 data-tool="mdnice编辑器"><span></span><span></span><span>计算基因比例</span><span></span></h3><p data-tool="mdnice编辑器">在读取完数据创建seurat对象之后，会为每个细胞创建一个元数据，保存在meta.data里面，比如我们上次介绍的nFeature_RNA和nCount_RNA，统计一下全部基因的表达量</p><p data-tool="mdnice编辑器">但是并不会计算线粒体、核糖体这些单独的基因的比例，所以需要我们自行计算一下这些基因，然后也保存在meta.data里面</p><p data-tool="mdnice编辑器"><strong>计算方法：</strong></p><ul data-tool="mdnice编辑器"><li><section><p>根据基因名特征进行整理</p></section></li><li><section><p>使用<code>PercentageFeatureSet</code>进行计算</p></section></li></ul><pre data-tool="mdnice编辑器"><span></span><code><span>#计算线粒体基因比例</span><br>mito_genes=rownames(sce.all)[grep(<span>"^MT-"</span>, rownames(sce.all),ignore.case = T)] <br><span>print</span>(mito_genes)<br>sce.all=PercentageFeatureSet(sce.all, features = mito_genes, col.name = <span>"percent_mito"</span>)<br>fivenum(sce.all@meta.data<span>$percent_mito</span>)<br><br><span>#计算核糖体基因比例</span><br>ribo_genes=rownames(sce.all)[grep(<span>"^Rp[sl]"</span>, rownames(sce.all),ignore.case = T)]<br><span>print</span>(ribo_genes)<br>sce.all=PercentageFeatureSet(sce.all,  features = ribo_genes, col.name = <span>"percent_ribo"</span>)<br>fivenum(sce.all@meta.data<span>$percent_ribo</span>)<br><br><span>#计算红血细胞基因比例</span><br>Hb_genes=rownames(sce.all)[grep(<span>"^Hb[^(p)]"</span>, rownames(sce.all),ignore.case = T)]<br><span>print</span>(Hb_genes)<br>sce.all=PercentageFeatureSet(sce.all,  features = Hb_genes,col.name = <span>"percent_hb"</span>)<br>fivenum(sce.all@meta.data<span>$percent_hb</span>)<br><br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100038461" data-ratio="0.0854978354978355" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjRpH9DlgvEA8pkoRDvmAO8UePKibSYmKOHmRWUU4srQiaWnzB7ETabUevk9zm2fwv9LZ0rDE2JBoRMg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="924" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjRpH9DlgvEA8pkoRDvmAO8UePKibSYmKOHmRWUU4srQiaWnzB7ETabUevk9zm2fwv9LZ0rDE2JBoRMg/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器"><strong>人类和小鼠的线粒体核糖体基因区别：</strong></p><ul data-tool="mdnice编辑器"><li><section><p>人类的核糖体基因是RPS/RPL开头</p></section></li><li><section><p>人类的线粒体基因是MT-开头</p></section></li><li><section><p>小鼠的核糖体基因是Rps/Rpl开头</p></section></li><li><section><p>小鼠的线粒体基因是mt-开头</p></section></li></ul><h4 data-tool="mdnice编辑器"><span></span><span>可视化</span><span></span></h4><pre data-tool="mdnice编辑器"><span></span><code>feats &lt;- c(<span>"percent_mito"</span>, <span>"percent_ribo"</span>, <span>"percent_hb"</span>)1<br>p2=VlnPlot(sce.all, group.by = <span>"orig.ident"</span>, features = feats, pt.size = 0, ncol = 3, same.y.lims=T) + <br>  scale_y_continuous(breaks=seq(0, 100, 5)) +<br>  NoLegend()<br>p2<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100038463" data-ratio="0.36666666666666664" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjRpH9DlgvEA8pkoRDvmAO8UpdJAlqiaZO1Oib1QK5uTickT0icuyaBFldLlyvibicPfIKASsyvox11hJt4w/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjRpH9DlgvEA8pkoRDvmAO8UpdJAlqiaZO1Oib1QK5uTickT0icuyaBFldLlyvibicPfIKASsyvox11hJt4w/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器">如果分析中发现某些<strong>单细胞样品中的线粒体表达量特别高</strong>，可能说明这个<strong>样品质量是比较一般</strong>的</p><h3 data-tool="mdnice编辑器"><span></span><span></span><span>设置阈值过滤</span><span></span></h3><p data-tool="mdnice编辑器">一般简单的过滤就是基于可视化的结果，设置一个上限</p><pre data-tool="mdnice编辑器"><span></span><code><span>#过滤指标2:线粒体/核糖体基因比例(根据上面的violin图)</span><br>selected_mito &lt;- WhichCells(sce.all, expression = percent_mito &lt; 25)<br><span>#selected_ribo &lt;- WhichCells(sce.all, expression = percent_ribo &gt; 3)</span><br>selected_hb &lt;- WhichCells(sce.all, expression = percent_hb &lt; 1 )<br>length(selected_hb)<br>length(selected_ribo)<br>length(selected_mito)<br><br>sce.all_filt &lt;- subset(sce.all, cells = selected_mito)<br><span>#sce.all &lt;- subset(sce.all, cells = selected_ribo)</span><br>sce.all_filt &lt;- subset(sce.all_filt, cells = selected_hb)<br>dim(sce.all_filt)<br><br>table(sce.all_filt<span>$orig</span>.ident) <br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100038465" data-ratio="0.5518518518518518" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjRpH9DlgvEA8pkoRDvmAO8U2fDZSUPNURGWqkCXX6DNWH2B0UjAtuXOxW2wyI1nQU07dzvSFTyZVQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjRpH9DlgvEA8pkoRDvmAO8U2fDZSUPNURGWqkCXX6DNWH2B0UjAtuXOxW2wyI1nQU07dzvSFTyZVQ/640?wx_fmt=png&amp;from=appmsg"></figure><h3 data-tool="mdnice编辑器"><span></span><span></span><span>根据线粒体核糖体基因进行过滤</span><span></span></h3><p data-tool="mdnice编辑器">在<a href="https://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247486096&amp;idx=1&amp;sn=1a99c4c5800b7e0287db3e8ef369fab8&amp;scene=21#wechat_redirect" data-linktype="2">过滤线粒体核糖体基因</a>推文中提到了过滤的方式</p><p data-tool="mdnice编辑器"><strong>1. 粗暴的去除全部线粒体基因</strong></p><p data-tool="mdnice编辑器">直接在表达矩阵里面，去除掉属于的那一行表达量即可</p><p data-tool="mdnice编辑器"><strong>2. 设定阈值去除掉高表达量细胞</strong></p><p data-tool="mdnice编辑器">多次反复查看线粒体核糖体基因的影响，分群前后看，不同batch看，多次质控图表里面显示它，判断它是否是一个主要因素</p><p data-tool="mdnice编辑器"><strong>3. 高表达核糖体基因的细胞是否要去除</strong></p><p data-tool="mdnice编辑器">在不影响分群和功能分析时可以不删除，很多细胞里都大量表达核糖体基因，如果一刀切全删除，会删除很多目的细胞。</p><h3 data-tool="mdnice编辑器"><span></span><span></span><span>在分析中的应用</span><span></span></h3><p data-tool="mdnice编辑器">与ncount_RNA 和nFeature_RNA一样，在进行单细胞亚群可视化的时候，也会可视化一下线粒体核糖体基因这些基因的比例</p><pre data-tool="mdnice编辑器"><span></span><code>  feats &lt;- c(<span>"percent_mito"</span>, <span>"percent_ribo"</span>, <span>"percent_hb"</span>)<br>  p2=VlnPlot(sce.all.int,  features = feats, pt.size = 0, ncol = 3, same.y.lims=T) + <br>    scale_y_continuous(breaks=seq(0, 100, 5)) +<br>    NoLegend()<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100038470" data-ratio="0.549074074074074" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjRpH9DlgvEA8pkoRDvmAO8UzlqTITYg2oQUq8iaCAAecfcNlD9kgVD6RN0fm5Wab4QQkPsIZ1V0PiaA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjRpH9DlgvEA8pkoRDvmAO8UzlqTITYg2oQUq8iaCAAecfcNlD9kgVD6RN0fm5Wab4QQkPsIZ1V0PiaA/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器">不过因为在质控的时候已经去除掉线粒体基因表达过高的细胞，所以在亚群分类的时候也不太需要仔细辨别</p><p data-tool="mdnice编辑器">在单细胞亚群细分的时候，主要还是基于每个簇的<strong>ncount_RNA 和nFeature_RNA</strong>以及基于Marker基因和Umap图去判断是否是双细胞，或者增殖细胞</p></section><p><br></p><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/4GZ4d4yUVHNE2213REEdFA",target="_blank" rel="noopener noreferrer">原文链接</a>
