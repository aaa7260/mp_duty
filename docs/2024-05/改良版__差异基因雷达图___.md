---
title: "改良版 [差异基因雷达图] ？"
date: 2024-05-12T01:38:34Z
draft: ["false"]
tags: [
  "fetched",
  "生信益站"
]
categories: ["Acdemic"]
---
改良版 [差异基因雷达图] ？ by 生信益站
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><figure data-tool="mdnice编辑器"><img data-imgfileid="100024841" data-ratio="0.278125" data-src="https://mmbiz.qpic.cn/sz_mmbiz_gif/mhoJzVKWSib8YHxqKZIc8sEOrDbcNxTeMDEayIsol8GFIAjrdKD3sHRgd6uekX3yw9gu8qrF1sTH9vwiaVKICnew/640?wx_fmt=gif&amp;from=appmsg" data-type="gif" data-w="640" src="https://mmbiz.qpic.cn/sz_mmbiz_gif/mhoJzVKWSib8YHxqKZIc8sEOrDbcNxTeMDEayIsol8GFIAjrdKD3sHRgd6uekX3yw9gu8qrF1sTH9vwiaVKICnew/640?wx_fmt=gif&amp;from=appmsg"></figure><p data-tool="mdnice编辑器"><code>生信益站，一点就有益</code>！<strong>祝友友们天天开心，月月发 CNS~</strong></p><hr data-tool="mdnice编辑器"><figure data-tool="mdnice编辑器"><img data-imgfileid="100024837" data-ratio="0.3768518518518518" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/mhoJzVKWSib8YHxqKZIc8sEOrDbcNxTeMibEr2K8OEawIxUjLRtIzeHLx3wt3UEiaLugBR0aibmics9N8TrQiahSliaMA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/mhoJzVKWSib8YHxqKZIc8sEOrDbcNxTeMibEr2K8OEawIxUjLRtIzeHLx3wt3UEiaLugBR0aibmics9N8TrQiahSliaMA/640?wx_fmt=png&amp;from=appmsg"><figcaption>设我为🌟星标，每天就能第一时间看到推送啦~</figcaption></figure><figure data-tool="mdnice编辑器"><img data-imgfileid="100024838" data-ratio="0.7277777777777777" data-type="png" data-w="1080" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/mhoJzVKWSib8YHxqKZIc8sEOrDbcNxTeMtPpWO0yMAUCcRTb3Z0HWWNjG8Xa8IiaCbicPcBqS26nSic1iaCQvjEb3TQ/640?wx_fmt=png&amp;from=appmsg" src="https://mmbiz.qpic.cn/sz_mmbiz_png/mhoJzVKWSib8YHxqKZIc8sEOrDbcNxTeMtPpWO0yMAUCcRTb3Z0HWWNjG8Xa8IiaCbicPcBqS26nSic1iaCQvjEb3TQ/640?wx_fmt=png&amp;from=appmsg"><figcaption>扫码进QQ群交流</figcaption></figure><p data-tool="mdnice编辑器">再复现一个雷达图，<code>展示两个比较组之间的基因/代谢物/蛋白——显著差异</code>结果，<span><strong>且克服了某些云平台不展示基因name的bug</strong></span>（<span>最常见的就是转录组中的 top30 差异基因</span>）。</p><p data-tool="mdnice编辑器">分 3 种布局：</p><figure data-tool="mdnice编辑器"><img data-imgfileid="100024840" data-ratio="1" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/mhoJzVKWSib8YHxqKZIc8sEOrDbcNxTeM4O9yESFVHUczcFMsgDQw05uicIyr61DLZicNAaY4AXbXIV9fd2wcaUog/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/mhoJzVKWSib8YHxqKZIc8sEOrDbcNxTeM4O9yESFVHUczcFMsgDQw05uicIyr61DLZicNAaY4AXbXIV9fd2wcaUog/640?wx_fmt=png&amp;from=appmsg"><figcaption>基因name布局1——易于观察</figcaption></figure><figure data-tool="mdnice编辑器"><img data-imgfileid="100024839" data-ratio="1" data-type="png" data-w="1080" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/mhoJzVKWSib8YHxqKZIc8sEOrDbcNxTeM4fpwdTamRXMIMN3UyJ2ibIpURiciaY9lODiamjMYiaHpic9b1e7WQEyZYkXg/640?wx_fmt=png&amp;from=appmsg" src="https://mmbiz.qpic.cn/sz_mmbiz_png/mhoJzVKWSib8YHxqKZIc8sEOrDbcNxTeM4fpwdTamRXMIMN3UyJ2ibIpURiciaY9lODiamjMYiaHpic9b1e7WQEyZYkXg/640?wx_fmt=png&amp;from=appmsg"><figcaption>基因name布局2——平行对齐</figcaption></figure><figure data-tool="mdnice编辑器"><img data-imgfileid="100024846" data-ratio="1" data-type="png" data-w="1080" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/mhoJzVKWSib8YHxqKZIc8sEOrDbcNxTeM5OABMfhkkLwdk6phLEXnQTicFF42oIVFODER9CJaKZJhhiaq1By9UOPA/640?wx_fmt=png&amp;from=appmsg" src="https://mmbiz.qpic.cn/sz_mmbiz_png/mhoJzVKWSib8YHxqKZIc8sEOrDbcNxTeM5OABMfhkkLwdk6phLEXnQTicFF42oIVFODER9CJaKZJhhiaq1By9UOPA/640?wx_fmt=png&amp;from=appmsg"><figcaption>基因name布局3——垂直对齐</figcaption></figure><blockquote data-tool="mdnice编辑器"><span>❝</span><p>注：折线（多边形）图（A/B 两组表达百分比） + 散点图（log2FC 绝对值） + 线段注释 + 文本注释（A/B 两组平均 FPKM）+ 极坐标。</p></blockquote><h2 data-tool="mdnice编辑器"><span></span><span>加载 R 包</span><span></span></h2><pre data-tool="mdnice编辑器"><span></span><code><span>library</span>(ggplot2)<br><span>library</span>(plyr) <span>## ddply</span><br></code></pre><h2 data-tool="mdnice编辑器"><span></span><span>数据处理</span><span></span></h2><pre data-tool="mdnice编辑器"><span></span><code>df &lt;- read.table(<span>"diff_gene.tsv"</span>,sep=<span>"\t"</span>,header=<span>T</span>)<br>head(df)<br><span>#   gene_name     FPKM      log2FC group</span><br><span># 1   CYP26B1 0.113826 -22.2025002     A</span><br><span># 2    DBNDD1 0.358944 -22.5162706     A</span><br><span># 3     STPG1 0.000000  19.6430763     A</span><br><span># 4      PRR5 3.430211   1.3613360     A</span><br><span># 5     MGST1 0.416713 -21.6760196     A</span><br><span># 6     CHPF2 6.732450   0.4441101     A</span><br><br>tail(df)<br><span>#    gene_name        FPKM     log2FC group</span><br><span># 55      AKNA   0.7069633  1.0006960     B</span><br><span># 56      EDF1  17.2404447 -0.6492983     B</span><br><span># 57  SLC25A39 213.1192218  1.4159588     B</span><br><span># 58     C1QBP  17.0071303 -0.4456199     B</span><br><span># 59      GAR1   2.3238698 -0.9488662     B</span><br><span># 60      CD82   8.8315472  0.5734518     B</span><br></code></pre><pre data-tool="mdnice编辑器"><span></span><code>df2 &lt;- ddply(df,<span>"gene_name"</span>,transform,percent_exp=FPKM/sum(FPKM) *<span>100</span>)<br>df2 &lt;- ddply(df2,<span>"gene_name"</span>,transform,label_y=cumsum(percent_exp))<br>df2$type &lt;- ifelse(df2$log2FC&gt;<span>0</span>,<span>"up"</span>,<span>"down"</span>)<br><br>head(df2)<br><span>#   gene_name      FPKM    log2FC group percent_exp type   label_y</span><br><span># 1      AKNA 0.3821007 1.0006960     A    35.08524   up  35.08524</span><br><span># 2      AKNA 0.7069633 1.0006960     B    64.91476   up 100.00000</span><br><span># 3      ARSA 2.6551465 0.7347924     A    39.66181   up  39.66181</span><br><span># 4      ARSA 4.0393202 0.7347924     B    60.33819   up 100.00000</span><br><span># 5      ASNS 0.0000000 6.6057566     A     0.00000   up   0.00000</span><br><span># 6      ASNS 0.1516158 6.6057566     B   100.00000   up 100.00000</span><br><br>df2$FPKM &lt;- round(df2$FPKM,<span>2</span>)<br>head(df2)<br><span>#   gene_name FPKM    log2FC group percent_exp type   label_y</span><br><span># 1      AKNA 0.38 1.0006960     A    35.08524   up  35.08524</span><br><span># 2      AKNA 0.71 1.0006960     B    64.91476   up 100.00000</span><br><span># 3      ARSA 2.66 0.7347924     A    39.66181   up  39.66181</span><br><span># 4      ARSA 4.04 0.7347924     B    60.33819   up 100.00000</span><br><span># 5      ASNS 0.00 6.6057566     A     0.00000   up   0.00000</span><br><span># 6      ASNS 0.15 6.6057566     B   100.00000   up 100.00000</span><br></code></pre><h2 data-tool="mdnice编辑器"><span></span><span>基因 name 布局——易于观察</span><span></span></h2><p><mp-pay-preview-filter data-offset="17"></mp-pay-preview-filter></p></section></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/GfVPvGcE8nrX_UP51L1zLw",target="_blank" rel="noopener noreferrer">原文链接</a>
