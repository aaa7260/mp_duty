---
title: "测序数据处理 —— 注释文件"
date: 2024-05-27T00:23:26Z
draft: ["false"]
tags: [
  "fetched",
  "生信杂货铺"
]
categories: ["Acdemic"]
---
测序数据处理 —— 注释文件 by 生信杂货铺
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><h2 data-tool="mdnice编辑器"><span></span><span>介绍</span><span></span></h2><p data-tool="mdnice编辑器">基因组注释文件主要标注了基因组特征信息，包含基因及转录本在基因组上的位置信息，比如编码区、外显子内含子以及 <code>UTR</code> 等。</p><p data-tool="mdnice编辑器">我们可以根据这些文件来提取基因组对应的信息，常见的文件格式包括 <code>GFF</code>、<code>GTF</code> 和 <code>BED</code>。</p><p data-tool="mdnice编辑器">还有一种变异注释文件，用于记录和描述基因组中变异（如单核苷酸多态性（<code>SNP</code>）、插入和缺失（<code>Indel</code>）等）的详细信息及其功能注释。如 <code>VCF</code> 或 <code>GVF</code> 等。</p><h2 data-tool="mdnice编辑器"><span></span><span>GTF/GFF</span><span></span></h2><p data-tool="mdnice编辑器"><code>GFF</code> (<span>General Feature Format</span><sup>[1]</sup>) 文件格式是一种用于描述基因以及 <code>DNA</code>、<code>RNA</code> 和蛋白质特征的文件格式。</p><p data-tool="mdnice编辑器"><code>GFF</code> 有不同的版本和格式（<code>GFF2</code>、 <code>GFF3</code> 和 <code>GTF</code>），但都使用制表符分隔，每行有 <code>9</code> 个字段。前 <code>7</code> 个字段的结构相同，但第 <code>9</code> 个字段的内容和格式会略有不同。</p><h3 data-tool="mdnice编辑器"><span></span><span>文件格式</span><span></span></h3><figure data-tool="mdnice编辑器"><img data-imgfileid="100013074" data-ratio="0.35079365079365077" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/R14BjDEcNWJzCibs5xNJUn4CiboLIkPxJxw5XUWoN47R6CNW4mRzoVwxSdGB88pUc2TuFA9B6jeKYC9D0cicUcFHQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="630" src="https://mmbiz.qpic.cn/sz_mmbiz_png/R14BjDEcNWJzCibs5xNJUn4CiboLIkPxJxw5XUWoN47R6CNW4mRzoVwxSdGB88pUc2TuFA9B6jeKYC9D0cicUcFHQ/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器">最后一个字段使用键值对的形式表示，记录了基因的各种信息。例如：</p><pre data-tool="mdnice编辑器"><span></span><code>##gff-version 3<br>#description: evidence-based annotation of the human genome (GRCh38), version 46 (Ensembl 112)<br>#provider: GENCODE<br>#contact: gencode-help@ebi.ac.uk<br>#format: gff3<br>#date: 2024-03-26<br>##sequence-region chr1 1 248956422<br>chr1    HAVANA  gene    11869   14409   .       +       .       ID=ENSG00000290825.1;gene_id=ENSG00000290825.1;gene_type=lncRNA;gene_name=DDX11L2;level=2;tag=overlaps_pseudogene<br>chr1    HAVANA  transcript      11869   14409   .       +       .       ID=ENST00000456328.2;Parent=ENSG00000290825.1;gene_id=ENSG00000290825.1;transcript_id=ENST00000456328.2;gene_type=lncRNA;gene_name=DDX11L2;transcript_type=lncRNA;transcript_name=DDX11L2-202;level=2;transcript_support_level=1;tag=basic,Ensembl_canonical;havana_transcript=OTTHUMT00000362751.1<br>chr1    HAVANA  exon    11869   12227   .       +       .       ID=exon:ENST00000456328.2:1;Parent=ENST00000456328.2;gene_id=ENSG00000290825.1;transcript_id=ENST00000456328.2;gene_type=lncRNA;gene_name=DDX11L2;transcript_type=lncRNA;transcript_name=DDX11L2-202;exon_number=1;exon_id=ENSE00002234944.1;level=2;transcript_support_level=1;tag=basic,Ensembl_canonical;havana_transcript=OTTHUMT00000362751.1<br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span>GTF</span><span></span></h3><p data-tool="mdnice编辑器"><code>GTF</code>（<code>Gene Transfer Format</code>）格式是 <code>GFF2</code> 的扩展，专门用于基因注释。它也有 <code>9</code> 个字段，与 <code>GFF</code> 相似，但在属性字段中对键值对的内容有更严格的要求。</p><p data-tool="mdnice编辑器">它要求包括 <code>gene_id</code> 和 <code>transcript_id</code> 标识符，这使得对转录本和基因的描述更加明确。例如：</p><pre data-tool="mdnice编辑器"><span></span><code>##description: evidence-based annotation of the human genome (GRCh38), version 42 (Ensembl 108)<br>##provider: GENCODE<br>##contact: gencode-help@ebi.ac.uk<br>##format: gtf<br>##date: 2022-07-20<br>chr1    HAVANA  gene    11869   14409   .       +       .       gene_id "ENSG00000290825.1"; gene_type "lncRNA"; gene_name "DDX11L2"; level 2; tag "overlaps_pseudogene";<br>chr1    HAVANA  transcript      11869   14409   .       +       .       gene_id "ENSG00000290825.1"; transcript_id "ENST00000456328.2"; gene_type "lncRNA"; gene_name "DDX11L2"; transcript_type "lncRNA"; transcript_name "DDX11L2-202"; level 2; transcript_support_level "1"; tag "basic"; tag "Ensembl_canonical"; havana_transcript "OTTHUMT00000362751.1";<br>chr1    HAVANA  exon    11869   12227   .       +       .       gene_id "ENSG00000290825.1"; transcript_id "ENST00000456328.2"; gene_type "lncRNA"; gene_name "DDX11L2"; transcript_type "lncRNA"; transcript_name "DDX11L2-202"; exon_number 1; exon_id "ENSE00002234944.1"; level 2; transcript_support_level "1"; tag "basic"; tag "Ensembl_canonical"; havana_transcript "OTTHUMT00000362751.1";<br></code></pre><p data-tool="mdnice编辑器">除了最后一个字段，其他字段基本一样。</p><h2 data-tool="mdnice编辑器"><span></span><span>BED</span><span></span></h2><p data-tool="mdnice编辑器"><code>BED</code>（<span>Browser Extensible Data</span><sup>[2]</sup>）格式是一个较为简单的文件格式，用于描述基因组区域的位置信息。一般来说，标准的 <code>BED</code> 格式至少需要 <code>3</code> 个字段，可添加九个可选字段，共十二列，每一行表示基因组上的一段区间。</p><figure data-tool="mdnice编辑器"><img data-imgfileid="100013077" data-ratio="0.3761904761904762" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/R14BjDEcNWJzCibs5xNJUn4CiboLIkPxJxP42v3UCULTTz0Dy2LiaYKDFaMnTm3EC2zBGQP5ibe714XvZS4KpJ0kIg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="630" src="https://mmbiz.qpic.cn/sz_mmbiz_png/R14BjDEcNWJzCibs5xNJUn4CiboLIkPxJxP42v3UCULTTz0Dy2LiaYKDFaMnTm3EC2zBGQP5ibe714XvZS4KpJ0kIg/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器">例如，我们常见的一般是这种，只关注基因组位置信息</p><pre data-tool="mdnice编辑器"><span></span><code>chr1    13043   13104   .       0       .<br>chr1    13297   13347   .       0       .<br>chr1    13949   14010   .       0       .<br>chr1    14913   14964   .       0       .<br>chr1    16221   16282   .       0       .<br>chr1    17467   17526   .       0       .<br>chr1    234290  234344  .       0       .<br>chr1    235090  235179  .       0       .<br>chr1    236181  236231  .       0       .<br></code></pre><h2 data-tool="mdnice编辑器"><span></span><span>VCF</span><span></span></h2><p data-tool="mdnice编辑器">变异注释文件（<span>Variant Call Format</span><sup>[3]</sup>）用于记录和描述基因组变异（如单核苷酸多态性（<code>SNP</code>）、插入和缺失（<code>Indel</code>）等）的详细信息及其功能注释。</p><p data-tool="mdnice编辑器"><code>VCF</code> 是一种简单的文本文件，用于记录基因组变异的标准格式，广泛用于各种变异数据集。</p><p data-tool="mdnice编辑器"><code>VCF</code> 文件由两个部分组成：</p><ul data-tool="mdnice编辑器"><li><section><strong>头部信息</strong>：以 <code>##</code>开头的行，包含文件格式版本、参考基因组信息和其他元数据。</section></li><li><section><strong>主体部分</strong>。以 <code>#</code> 开头的行表示列标题，接下来的行表示每个变异的详细信息。</section></li></ul><h3 data-tool="mdnice编辑器"><span></span><span>头部信息</span><span></span></h3><p data-tool="mdnice编辑器">头部信息推荐使用的字段包括：<code>fileformat</code>（文件格式）、<code>fileDate</code>（创建日期） 和 <code>reference</code>（参考基因组） 等。</p><p data-tool="mdnice编辑器">还包含几个用于描述主体部分所用字段的关键字表示的含义及格式，主要有 <code>INFO</code>、<code>FILTER</code> 和 <code>FORMAT</code>。</p><p data-tool="mdnice编辑器">例如，头部包含如下信息</p><pre data-tool="mdnice编辑器"><span></span><code>##fileformat=VCFv4.3<br>##fileDate=20090805<br>##source=myImputationProgramV3.1<br>##reference=file:///seq/references/1000GenomesPilot-NCBI36.fasta<br>##contig=&lt;ID=20,length=62435964,assembly=B36,md5=f126cdf8a6e0c7f379d618ff66beb2da,species="Homo sapiens",taxonomy=x&gt;<br>##phasing=partial<br>##INFO=&lt;ID=NS,Number=1,Type=Integer,Description="Number of Samples With Data"&gt;<br>##INFO=&lt;ID=DP,Number=1,Type=Integer,Description="Total Depth"&gt;<br>##INFO=&lt;ID=AF,Number=A,Type=Float,Description="Allele Frequency"&gt;<br>##INFO=&lt;ID=AA,Number=1,Type=String,Description="Ancestral Allele"&gt;<br>##INFO=&lt;ID=DB,Number=0,Type=Flag,Description="dbSNP membership, build 129"&gt;<br>##INFO=&lt;ID=H2,Number=0,Type=Flag,Description="HapMap2 membership"&gt;<br>##FILTER=&lt;ID=q10,Description="Quality below 10"&gt;<br>##FILTER=&lt;ID=s50,Description="Less than 50% of samples have data"&gt;<br>##FORMAT=&lt;ID=GT,Number=1,Type=String,Description="Genotype"&gt;<br>##FORMAT=&lt;ID=GQ,Number=1,Type=Integer,Description="Genotype Quality"&gt;<br>##FORMAT=&lt;ID=DP,Number=1,Type=Integer,Description="Read Depth"&gt;<br>##FORMAT=&lt;ID=HQ,Number=2,Type=Integer,Description="Haplotype Quality"&gt;<br></code></pre><p data-tool="mdnice编辑器">其中 <code>contig</code> 指定了变异信息所在的染色体编号；<code>INFO</code> 和 <code>FORMAT</code> 分别指定了不同的关键字，每个关键字代表不同的信息；以及 <code>FILTER</code> 用于设置变异的过滤条件。</p><h3 data-tool="mdnice编辑器"><span></span><span>主体部分</span><span></span></h3><p data-tool="mdnice编辑器"><code>VCF</code> 的正文位于标题之后，用制表符分隔成 <code>8</code> 个必填列和数量不限的可选列，可用于记录有关样本的变异信息。</p><p data-tool="mdnice编辑器">当使用附加列时，第一个可选列（<code>FORMAT</code>）用于描述后面各列的数据格式。</p><figure data-tool="mdnice编辑器"><img data-imgfileid="100013075" data-ratio="0.33081570996978854" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/R14BjDEcNWJzCibs5xNJUn4CiboLIkPxJxR9KUAxATYuib1e3b7qJ1Qb4ZdMocTsowUgLF10LLdWrPVvECauKibnRQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="662" src="https://mmbiz.qpic.cn/sz_mmbiz_png/R14BjDEcNWJzCibs5xNJUn4CiboLIkPxJxR9KUAxATYuib1e3b7qJ1Qb4ZdMocTsowUgLF10LLdWrPVvECauKibnRQ/640?wx_fmt=png&amp;from=appmsg"></figure><h4 data-tool="mdnice编辑器"><span></span><span>INFO</span><span></span></h4><p data-tool="mdnice编辑器"><code>INFO</code> 字段的关键字可以自由定义，只要与头部信息中定义的字段相同即可。如果不清楚 <code>INFO</code> 字段的关键字都代表什么意思，可以在头部查看其定义。</p><p data-tool="mdnice编辑器">例如，几个常见的字段<img data-imgfileid="100013073" data-ratio="0.5877342419080068" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/R14BjDEcNWJzCibs5xNJUn4CiboLIkPxJxrbZSCMaPMqQxgdxCTicouxY6qXH6RvAo3YLuSagl6ibhG13KiaVzE0K7g/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="587" src="https://mmbiz.qpic.cn/sz_mmbiz_png/R14BjDEcNWJzCibs5xNJUn4CiboLIkPxJxrbZSCMaPMqQxgdxCTicouxY6qXH6RvAo3YLuSagl6ibhG13KiaVzE0K7g/640?wx_fmt=png&amp;from=appmsg"></p><h4 data-tool="mdnice编辑器"><span></span><span>FORMAT</span><span></span></h4><p data-tool="mdnice编辑器">类似于 <code>INFO</code> 字段，<code>FORMAT</code> 字段定义了每个样本应该包含哪些信息，也可以从头部对应字段的关键字的定义信息来查看具体含义。</p><figure data-tool="mdnice编辑器"><img data-imgfileid="100013076" data-ratio="0.5264054514480409" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/R14BjDEcNWJzCibs5xNJUn4CiboLIkPxJxFDW2tHWGucIcaYhwsxvWHz1jzns6F5pAcW8hmSlKnhicJJIibqWic0rmQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="587" src="https://mmbiz.qpic.cn/sz_mmbiz_png/R14BjDEcNWJzCibs5xNJUn4CiboLIkPxJxFDW2tHWGucIcaYhwsxvWHz1jzns6F5pAcW8hmSlKnhicJJIibqWic0rmQ/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器">例如，主体部分包含如下信息</p><pre data-tool="mdnice编辑器"><span></span><code>#CHROM POS      ID         REF   ALT    QUAL  FILTER   INFO                             FORMAT       NA00001         NA00002          NA00003<br>20     14370    rs6054257  G     A      29    PASS    NS=3;DP=14;AF=0.5;DB;H2           GT:GQ:DP:HQ  0|0:48:1:51,51  1|0:48:8:51,51   1/1:43:5:.,.<br>20     17330    .          T     A      3     q10     NS=3;DP=11;AF=0.017               GT:GQ:DP:HQ  0|0:49:3:58,50  0|1:3:5:65,3     0/0:41:3<br>20     1110696  rs6040355  A     G,T    67    PASS    NS=2;DP=10;AF=0.333,0.667;AA=T;DB GT:GQ:DP:HQ  1|2:21:6:23,27  2|1:2:0:18,2     2/2:35:4<br>20     1230237  .          T     .      47    PASS    NS=3;DP=13;AA=T                   GT:GQ:DP:HQ  0|0:54:7:56,60  0|0:48:4:51,51   0/0:61:2<br>20     1234567  microsat1  GTC   G,GTCT 50    PASS    NS=3;DP=9;AA=G                    GT:GQ:DP     0/1:35:4        0/2:17:2         1/1:40:3<br></code></pre><p data-tool="mdnice编辑器">这 <code>5</code> 条变异记录都在 <code>20</code> 号染色体上，除了第二条记录值通过了质量分数的过滤，其他记录都通过了所有过滤条件。</p><p data-tool="mdnice编辑器"><code>INFO</code> 字段中记录了包含变异的样本数，测序深度以及等位频率等；<code>FORMAT</code> 字段中定义了基因型、基因型质量、测序深度以及单倍型质量，值用 <code>:</code> 分隔。</p><h2 data-tool="mdnice编辑器"><span></span><span>BCF</span><span></span></h2><p data-tool="mdnice编辑器"><code>BCF</code>（<code>Binary Call Format</code>）和 <code>VCF</code> 都是用于存储和交换基因组变异数据的格式。它们之间的主要区别在于文件格式的存储方式和处理效率。</p><p data-tool="mdnice编辑器"><code>BCF</code> 是二进制格式，相较于 <code>VCF</code> 文本文件，其可以高效地存储和处理变异数据，节省存储空间，适合大规模数据分析。</p><p data-tool="mdnice编辑器">数据存储格式的主要区别在于，样本数据的存储方式。如下图所示<img data-imgfileid="100013082" data-ratio="0.4044776119402985" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/R14BjDEcNWJzCibs5xNJUn4CiboLIkPxJxgv9ticUTo5QVFeqnUsg7jgWibzvzVib5M7ibh4MhtetbH5YNicHokgQ5u0Q/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1340" src="https://mmbiz.qpic.cn/sz_mmbiz_png/R14BjDEcNWJzCibs5xNJUn4CiboLIkPxJxgv9ticUTo5QVFeqnUsg7jgWibzvzVib5M7ibh4MhtetbH5YNicHokgQ5u0Q/640?wx_fmt=png&amp;from=appmsg"></p><h2 data-tool="mdnice编辑器"><span></span><span>GVCF</span><span></span></h2><p data-tool="mdnice编辑器"><code>GVCF</code>（<code>Genomic VCF</code>）是一种特殊的 <code>VCF</code> 格式，用于存储基因组变异数据的详细信息。</p><p data-tool="mdnice编辑器">与传统的 <code>VCF</code> 文件不同，<code>GVCF</code> 不仅记录变异位置的信息，还包括未变异位置的覆盖深度和质量信息。这使得 <code>GVCF</code> 在处理大规模基因组数据时更加高效和全面。</p><p data-tool="mdnice编辑器"><code>GVCF</code> 通过定义变异和非变异区域的块来压缩信息，减少文件大小。每个块描述了一个连续的非变异区域，内含统一的置信度信息。</p><p data-tool="mdnice编辑器"><code>GVCF</code> 文件格式在基本结构上与 <code>VCF</code> 相似。例如</p><pre data-tool="mdnice编辑器"><span></span><code>##fileformat=VCFv4.2<br>##FILTER=&lt;ID=PASS,Description="All filters passed"&gt;<br>##FORMAT=&lt;ID=GT,Number=1,Type=String,Description="Genotype"&gt;<br>##FORMAT=&lt;ID=GQ,Number=1,Type=Integer,Description="Genotype Quality"&gt;<br>##FORMAT=&lt;ID=DP,Number=1,Type=Integer,Description="Read Depth"&gt;<br>##contig=&lt;ID=1,length=249250621&gt;<br>#CHROM POS     ID        REF  ALT  QUAL FILTER INFO                               FORMAT Sample1<br>1      10010   .         A    &lt;*&gt;  50   PASS   END=10020;BLOCKAVG_min30p3a        GT:GQ:DP 0/0:50:10<br>1      10021   rs123456  T    A    99   PASS   .                                  GT:GQ:DP 0/1:99:20<br>1      10022   .         G    &lt;*&gt;  50   PASS   END=10100;BLOCKAVG_min30p3a        GT:GQ:DP 0/0:50:15<br></code></pre><p data-tool="mdnice编辑器">其中，<code>&lt;*&gt;</code> 表示这是一个非变异区域的记录，<code>END=10020</code> 表示非变异块的结束位置，<code>BLOCKAVG_min30p3a</code> 可能是一种区块平均质量分数。</p><p data-tool="mdnice编辑器">在 <code>GVCF</code> 和 <code>VCF</code> 文件中，<code>&lt;NON_REF&gt;</code> 和 <code>&lt;*&gt;</code> 两者都可以见到，它们用于指示非参考碱基的信息，但有不同的具体含义和用途。</p><ul data-tool="mdnice编辑器"><li><section><code>&lt;NON_REF&gt;</code>：表示所有可能的非参考碱基的集合，通常用于 <code>GVCF</code> 文件中。</section></li><li><section><code>&lt;*&gt;</code>：用于指示无法确定的或者未明确识别的替代碱基</section></li></ul><section data-tool="mdnice编辑器"><span>参考资料</span></section><section data-tool="mdnice编辑器"><span><span>[1] </span><p>GFF: <em>https://en.wikipedia.org/wiki/General_feature_format</em></p></span><span><span>[2] </span><p>BED: <em>https://en.wikipedia.org/wiki/BED_(file_format)</em></p></span><span><span>[3] </span><p>VCF: <em>https://en.wikipedia.org/wiki/Variant_Call_Format</em></p></span></section></section><p><br></p><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/JjMofA5_SnvGoQy2IH_RZg",target="_blank" rel="noopener noreferrer">原文链接</a>
