---
title: "GSEA只看排序吗？"
date: 2024-05-08T03:25:29Z
draft: ["false"]
tags: [
  "fetched",
  "果子学生信"
]
categories: ["Acdemic"]
---
GSEA只看排序吗？ by 果子学生信
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><p data-tool="mdnice编辑器">其实这个问题很好回答，只需要运行如下代码，如下的基因列表是顺序是完全相同，并且我们只是做了最基础的变换</p><pre data-tool="mdnice编辑器"><span></span><code><span>library</span>(clusterProfiler)<br><span>library</span>(org.Hs.eg.db)<br><br>data(geneList, package=<span>"DOSE"</span>)<br><br>ego1 &lt;- gseGO(geneList     = geneList,<br>              OrgDb        = org.Hs.eg.db,<br>              ont          = <span>"CC"</span>,<br>              minGSSize    = <span>100</span>,<br>              maxGSSize    = <span>500</span>,<br>              pvalueCutoff = <span>0.05</span>,<br>              verbose      = <span>FALSE</span>)<br>geneList2 &lt;- geneList + <span>5</span><br><br>ego2 &lt;- gseGO(geneList     = geneList2,<br>              OrgDb        = org.Hs.eg.db,<br>              ont          = <span>"CC"</span>,<br>              minGSSize    = <span>100</span>,<br>              maxGSSize    = <span>500</span>,<br>              pvalueCutoff = <span>0.05</span>,<br>              verbose      = <span>FALSE</span>)<br>geneList3 &lt;- geneList * <span>100</span><br><br>ego3 &lt;- gseGO(geneList     = geneList3,<br>              OrgDb        = org.Hs.eg.db,<br>              ont          = <span>"CC"</span>,<br>              minGSSize    = <span>100</span>,<br>              maxGSSize    = <span>500</span>,<br>              pvalueCutoff = <span>0.05</span>,<br>              verbose      = <span>FALSE</span>)<br><br><br><span>library</span>(ggplot2)<br>p1 &lt;- dotplot(ego1)<br>p2 &lt;- dotplot(ego2)<br>p3 &lt;- dotplot(ego3)<br>p1 + p2 + p3<br></code></pre><p data-tool="mdnice编辑器">但是结果中，geneList和geneList3最为接近，geneList2几乎完全不一样。</p><figure data-tool="mdnice编辑器"><img data-imgfileid="503253368" data-ratio="0.31896551724137934" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/NDy5aEnReX3G0LrhYIkczXTh6sFygP5ywx5k5FldjLfiaBCS7ukM61KPqTJoAhH0k7zMapx8kKFwBVMM3Hia6ahw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1508" src="https://mmbiz.qpic.cn/sz_mmbiz_png/NDy5aEnReX3G0LrhYIkczXTh6sFygP5ywx5k5FldjLfiaBCS7ukM61KPqTJoAhH0k7zMapx8kKFwBVMM3Hia6ahw/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器">这说明GSEA肯定是不可能考虑排序的，因为它的算法过程中还有一个ES得分计算，这个计算用到的权重就来自于排序所用的得分。</p><blockquote data-tool="mdnice编辑器"><span></span><p>Step 1: Calculation of an Enrichment Score. We calculate an enrichment score (ES) that reflects the degree to which a set S is overrepresented at the extremes (top or bottom) of the entire ranked list L. The score is calculated by walking down the list L, increasing a running-sum statistic when we encounter a gene in S and decreasing it when we encounter genes not in S. <strong>The magnitude of the increment depends on the correlation of the gene with the phenotype</strong>. The enrichment score is the maximum deviation from zero encountered in the random walk; it corresponds to a weighted Kolmogorov–Smirnov-like statistic (ref. 7 and Fig. 1B).</p></blockquote><p data-tool="mdnice编辑器">在GSEA发表的文章中提到了，这种增加和降低的比例就取决于基因和表型的相关性，也就是说，gene的得分很重要。目前的得分有如下流派</p><ol data-tool="mdnice编辑器"><li><section>pvalue / qvalue: 只考虑显著性</section></li><li><section>log2FC: 考虑倍数变化</section></li><li><section>-log10(pvalue) : 显著性的一种换算方式</section></li><li><section>sign(log2FC) * -log10(pvalue):  有符号的显著性。</section></li><li><section>统计检验的值, AUC,.... 类似于第一种方法。</section></li></ol><p data-tool="mdnice编辑器">问题来了，我们应该选择哪种？这个问题后续就由果子来解决吧</p></section><p><br></p><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/1um9mhoCu6JmcuYAG0Xn8Q",target="_blank" rel="noopener noreferrer">原文链接</a>
