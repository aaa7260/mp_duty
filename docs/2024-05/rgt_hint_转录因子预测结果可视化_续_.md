---
title: "rgt-hint 转录因子预测结果可视化(续)"
date: 2024-05-02T08:18:38Z
draft: ["false"]
tags: [
  "fetched",
  "老俊俊的生信笔记"
]
categories: ["Acdemic"]
---
rgt-hint 转录因子预测结果可视化(续) by 老俊俊的生信笔记
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-mpa-powered-by="yiban.io"><section><mp-common-profile data-pluginname="mpprofile" data-id="MzkyMTI1MTYxNA==" data-headimg="http://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usezgsqIGqjITSMggCTSoViaYeoKe2xoZr1IIvNJoztibQxibYHLDDoiabwAc6Ggws3Tvdo8EPss2nLgaVQ/0?wx_fmt=png" data-nickname="老俊俊的生信笔记" data-alias="JunJunLab" data-signature="老俊俊的生信技能和知识分享,我不是巨人,但你可以站在我的肩膀上更进一步!" data-from="0" data-is_biz_ban="0"></mp-common-profile></section><section><mp-common-clmusic data-pluginname="insertaudio" type="1" music_name="最佳歌手" albumurl="http://wx.y.gtimg.cn/music/photo_new/T002R500x500M000000LfSb70Ewn3w_1.jpg" singer="许嵩" duration="267000" username="" music_source="1" is_vip="1" listenid="78221626560540768"></mp-common-clmusic></section><h2 data-tool="mdnice编辑器"><span></span><span>引言</span><span></span></h2><blockquote data-tool="mdnice编辑器"><span>❝</span><p>上次推文 <a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247513180&amp;idx=1&amp;sn=51e30d1b04182f55bb0c23901a37a36a&amp;chksm=c1848e2df6f3073bb4f5c00f60cd1c6725fe08992431cf0aadee3563bb8db3a2c0cf170c634e&amp;token=896011679&amp;lang=zh_CN&amp;poc_token=HP5gMmajxs0JmmG1VFdSTh9aDqshMc0eJZ_Jp5Av&amp;scene=21#wechat_redirect" data-linktype="2">rgt-hint 转录因子预测结果可视化</a> 留下个问题, 就是绘制 <strong>footprint</strong> 曲线时,无法把下面的 <strong>motif</strong> 绘制出来, 因为软件没有输出类似的<strong>位置权重矩阵(pwm)</strong> 。仔细想了一下, 这次我们来解决这个问题。</p></blockquote><h2 data-tool="mdnice编辑器"><span></span><span>测试</span><span></span></h2><p data-tool="mdnice编辑器"><strong>结果解读:</strong></p><p data-tool="mdnice编辑器">我们在做完 <strong>rgt-motifanalysis matching</strong> 分析后,产生的文件在 <strong>match</strong> 文件夹下,内容如下,第四列就是预测到的转录因子:</p><pre data-tool="mdnice编辑器"><span></span><code>(chip) [laojunjun@cloud 6.footprint-data]$ head ./match/CTL_mpbs.bed<br>chr1    756871  756882  MA1628.1.Zic1::Zic2     11.801793739070824      +<br>chr1    756887  756899  MA1602.1.ZSCAN29        13.982648767774405      +<br>chr1    756922  756934  MA1602.1.ZSCAN29        13.982648767774405      +<br>chr1    762540  762552  MA0039.4.KLF4   14.937741792469735      -<br>chr1    762541  762552  MA0493.1.Klf1   10.875777015291094      -<br>chr1    762541  762551  MA0599.1.KLF5   13.508886663843134      -<br>chr1    762687  762697  MA0048.2.NHLH1  10.565938430193414      +<br>chr1    762687  762697  MA0048.2.NHLH1  11.529766662529898      -<br>chr1    762711  762722  MA0076.2.ELK4   13.336245664270239      +<br>chr1    762682  762692  MA0092.1.Hand1::Tcf3    11.40795144811544       +<br></code></pre><p data-tool="mdnice编辑器"><strong>既然结果文件是预测到的转录因子,那么前面的位置肯定就是对应的转录因子结合的序列信息,我们就可以自己提取序列然后绘制 motif 了。</strong> 下面我来做这样的事情。</p><p data-tool="mdnice编辑器">提取序列:</p><pre data-tool="mdnice编辑器"><span></span><code><span>library</span>(BSgenome.Hsapiens.UCSC.hg19)<br><span>library</span>(ChIPpeakAnno)<br><span>library</span>(ggseqlogo)<br><span>library</span>(aplot)<br><span>library</span>(ggplot2)<br><span>library</span>(ggforce)<br><br><span># mtf &lt;- data.table::fread("../match/CTL_mpbs.bed")</span><br>mtf &lt;- rtracklayer::import.bed(<span>"../match/CTL_mpbs.bed"</span>)<br><br><span># filter target TF</span><br>my_TF &lt;- <span>"MA0039.4.KLF4"</span><br><br>TFtarget &lt;- subset(mtf,name == my_TF)<br><br>TFtarget_ed &lt;- resize(TFtarget,width = <span>200</span>,fix = <span>"center"</span>)<br><br><span># subtract sequence for TF</span><br>mtf_seq &lt;- getAllPeakSequence(myPeakList = TFtarget_ed,<br>                              upstream = <span>0</span>,downstream = <span>0</span>,<br>                              genome = BSgenome.Hsapiens.UCSC.hg19)<br></code></pre><p data-tool="mdnice编辑器">我们先把 <strong>footprinting</strong> 折线图绘制出来:</p><pre data-tool="mdnice编辑器"><span></span><code><span># footprinting line plot</span><br>footprint &lt;-<br>  ggplot(ft_df %&gt;%<br>           dplyr::filter(TF == <span>"MA0039.4.KLF4"</span>),<br>         aes(x = pos,y = Occupancy,color = group)) +<br>  geom_line() +<br>  theme_bw() +<br>  theme(panel.grid = element_blank(),<br>        strip.background = element_rect(fill = <span>"grey90"</span>),<br>        legend.background = element_blank(),<br>        strip.text = element_text(face = <span>"bold.italic"</span>,size = rel(<span>1</span>)),<br>        legend.position = c(<span>0.1</span>,<span>0.8</span>),<br>        axis.text = element_text(colour = <span>"black"</span>)) +<br>  facet_wrap(~TF)<br><br>footprint<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100029537" data-ratio="0.6794871794871795" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usew7w6kA5OhJRG4FsYeQwrbyyOVQaVI5JBkPPxcFsxs5Awr3X06fAJFjCsWyCBVmZbNR4yP2Hic3llw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="624" src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usew7w6kA5OhJRG4FsYeQwrbyyOVQaVI5JBkPPxcFsxs5Awr3X06fAJFjCsWyCBVmZbNR4yP2Hic3llw/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器">现在根据提取的序列绘制 motif:</p><pre data-tool="mdnice编辑器"><span></span><code><span># plot sequence(motif)</span><br>denovo_mt &lt;-<br>ggseqlogo(mtf_seq$sequence,seq_type = <span>"dna"</span>) +<br>  theme_bw() +<br>  theme(panel.grid = element_blank(),<br>        axis.text.x = element_blank())<br><br>denovo_mt<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100029533" data-ratio="0.4299163179916318" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usew7w6kA5OhJRG4FsYeQwrbyamCTjWYic7Pex2njx47d5Xibsf5XCiaHPLjAPriaz9GA9zlEbfVUyWOZiaA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="956" src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usew7w6kA5OhJRG4FsYeQwrbyamCTjWYic7Pex2njx47d5Xibsf5XCiaHPLjAPriaz9GA9zlEbfVUyWOZiaA/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器">可以看到和软件输出的默认结果是一样的。</p><figure data-tool="mdnice编辑器"><img data-imgfileid="100029536" data-ratio="0.7473572938689218" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usew7w6kA5OhJRG4FsYeQwrbyNSHnVFBXuAg93AIgIiaDqgRy7vHibibRiavrOPcMx2ibt15iaT7h1wFJozsA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="946" src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usew7w6kA5OhJRG4FsYeQwrbyNSHnVFBXuAg93AIgIiaDqgRy7vHibibRiavrOPcMx2ibt15iaT7h1wFJozsA/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器">我们拼个图:</p><pre data-tool="mdnice编辑器"><span></span><code><span># combine plot</span><br>cowplot::plot_grid(plotlist = list(denovo_mt,footprint),ncol = <span>1</span>)<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100029535" data-ratio="0.8819875776397516" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usew7w6kA5OhJRG4FsYeQwrbyQ8rRvKCpQdcbrMVOM1uXs7yhwHqia47Jmjg6tbM5XQuiaSB6X69heRng/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="805" src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usew7w6kA5OhJRG4FsYeQwrbyQ8rRvKCpQdcbrMVOM1uXs7yhwHqia47Jmjg6tbM5XQuiaSB6X69heRng/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器"><strong>也许你会发现中间结合主要的 motif 显得非常拥挤,我们可以进行放大来更好的查看是哪些 motif</strong>:</p><pre data-tool="mdnice编辑器"><span></span><code><span># zoom for center motif</span><br>denovo_mt &lt;-<br>ggseqlogo(mtf_seq$sequence,seq_type = <span>"dna"</span>) +<br>  theme_bw() +<br>  theme(panel.grid = element_blank(),<br>        axis.text.x = element_blank(),<br>        axis.ticks.x = element_blank()) +<br>  facet_zoom(xlim = c(<span>100</span> - <span>10</span>,<span>100</span> + <span>10</span>),<br>             zoom.size = <span>0.5</span>)<br><br><span># combine plot</span><br>cowplot::plot_grid(plotlist = list(denovo_mt,footprint),ncol = <span>1</span>)<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100029534" data-ratio="0.9504685408299867" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usew7w6kA5OhJRG4FsYeQwrby7GOFyMNbicjkSXVMiaR8nQS8dic4sUC5FRXsibicOAo3GFaAib0BRRqiclPCw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="747" src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usew7w6kA5OhJRG4FsYeQwrby7GOFyMNbicjkSXVMiaR8nQS8dic4sUC5FRXsibicOAo3GFaAib0BRRqiclPCw/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器"><strong>这个图就完美多了!</strong></p><h2 data-tool="mdnice编辑器"><span></span><span>结尾</span><span></span></h2><blockquote data-tool="mdnice编辑器"><span>❝</span><p><strong>路漫漫其修远兮,吾将上下而求索。</strong></p></blockquote><hr data-tool="mdnice编辑器"><p data-tool="mdnice编辑器">欢迎加入生信交流群。加我微信我也拉你进 <strong>微信群聊</strong> <strong>老俊俊生信交流群</strong> <strong>(微信交流群需收取 20 元入群费用,一旦交费,拒不退还!(防止骗子和便于管理))</strong> 。QQ 群可免费加入, 记得进群按格式修改备注哦。</p><section data-tool="mdnice编辑器"><section><p><strong>老俊俊微信：</strong></p><figure><img data-imgfileid="100029540" data-ratio="1" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usew7w6kA5OhJRG4FsYeQwrbyhOfSZQEbCAOe24Zt77fWVZsJEZlr2focea17TNMCI28J2bw4oXqBCg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="430" src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usew7w6kA5OhJRG4FsYeQwrbyhOfSZQEbCAOe24Zt77fWVZsJEZlr2focea17TNMCI28J2bw4oXqBCg/640?wx_fmt=png&amp;from=appmsg"></figure><figure><img data-imgfileid="100029542" data-ratio="1.3668430335097002" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usew7w6kA5OhJRG4FsYeQwrbypFIcqa5qMWJQ0H8ktiaoib79npTS9I2lS2RuZUz2nmkarv1AmoVptf4w/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="567" src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usew7w6kA5OhJRG4FsYeQwrbypFIcqa5qMWJQ0H8ktiaoib79npTS9I2lS2RuZUz2nmkarv1AmoVptf4w/640?wx_fmt=png&amp;from=appmsg"></figure></section><section><p><strong>知识星球：</strong></p><figure><img data-imgfileid="100029541" data-ratio="1.5896226415094339" data-src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/G5jjcE4usew7w6kA5OhJRG4FsYeQwrby70URNvicsAGWgz4arrm0pLiauk60LKkY6krPVjAKOgKD1JicQELj9FAKw/640?wx_fmt=jpeg&amp;from=appmsg" data-type="jpeg" data-w="1060" src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/G5jjcE4usew7w6kA5OhJRG4FsYeQwrby70URNvicsAGWgz4arrm0pLiauk60LKkY6krPVjAKOgKD1JicQELj9FAKw/640?wx_fmt=jpeg&amp;from=appmsg"></figure></section></section><hr data-tool="mdnice编辑器"><p data-tool="mdnice编辑器"><strong></strong></p><center data-tool="mdnice编辑器"><strong> 往期回顾目录</strong></center><blockquote data-tool="mdnice编辑器"><span>❝</span><p><strong></strong></p><center><strong><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247513180&amp;idx=1&amp;sn=51e30d1b04182f55bb0c23901a37a36a&amp;chksm=c1848e2df6f3073bb4f5c00f60cd1c6725fe08992431cf0aadee3563bb8db3a2c0cf170c634e&amp;token=896011679&amp;lang=zh_CN&amp;poc_token=HP5gMmajxs0JmmG1VFdSTh9aDqshMc0eJZ_Jp5Av&amp;scene=21#wechat_redirect" data-linktype="2">rgt-hint 转录因子预测结果可视化</a></strong></center><strong><center><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247513159&amp;idx=1&amp;sn=832b6c709d2df7a32d8fc64c609e4ac4&amp;chksm=c1848e36f6f3072035a95da9f10234e5b162ca058bb7bbb041ddd5d44bca17c143279246de21&amp;token=635906193&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">绘图时如何处理 Input 样本</a></center></strong><strong><center><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247513137&amp;idx=1&amp;sn=ffd1d42ce1174494bc53d58726a93778&amp;chksm=c1848e40f6f3075653a6849b9525d40a682a89231053f076f03a7026aed5ddab7509f89f0121&amp;token=635906193&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">ATAC-seq 数据分析实操教程</a></center></strong><strong><center><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247513054&amp;idx=1&amp;sn=e87d34b1b715ff2a00628e4bb0886ba3&amp;chksm=c18489aff6f300b9ab3cdda646acb3a02914b79c3f28433b9a05722625ac65175318d0f8e7c2&amp;token=1860740043&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">ATAC-seq 分析方法一览</a></center></strong><strong><center><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247513016&amp;idx=1&amp;sn=902232584345e1435aade90821238a9e&amp;chksm=c18489c9f6f300dfe8e7e436f76c891eb8234ec40a388f361f7838dc6dc61fd17ccb33f96bac&amp;token=1218322320&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">locuszoomr 可视化 GWAS 结果</a></center></strong><strong><center><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247512947&amp;idx=1&amp;sn=87d8684deca7bcf68ec887e067449ce5&amp;chksm=c1848902f6f30014f25b1e24e98e8ec4edf704bf70a037d4d291d3e5c7aae7e826635926e345&amp;token=538711716&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">2024 了,听说你还在用 dplyr 处理数据?</a></center></strong><strong><center><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247512936&amp;idx=1&amp;sn=53d5444bfa7e6028c169578cd6fc873d&amp;chksm=c1848919f6f3000f297af5def286cf09caad0898d6598277f610b9563116c7c4000f34d79daf&amp;token=1008140360&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">计算 motif 到 peak center 的距离</a></center></strong><strong><center><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247512922&amp;idx=1&amp;sn=247004f40306ea4e555fb6e32480a42f&amp;chksm=c184892bf6f3003d132a9779834b2d4df5c3f1b52ec9c3a04041d7398f3ec155560efe6eb578&amp;token=2004442534&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">写个包 metaplot 绘制 m6A peak 分布</a></center></strong><strong><center><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247512856&amp;idx=1&amp;sn=7f9fd9406d4768535450ef9e2df44890&amp;chksm=c1848969f6f3007fb1e0010b0ce49fd5738fa5fd8f4759ffea56cfbe89ffaaf29e1016ed149e&amp;token=709285857&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">当 ggSCvis 遇到 ggmagnify</a></center></strong><strong><center><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247512812&amp;idx=1&amp;sn=c90eeab4ddc6aeaae7986ca163eba10e&amp;chksm=c184889df6f3018bc89c07de8b7aea1a22b7b284320dbf4280cd60ce5b4fad1a65486116ec62&amp;token=555204851&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">在模仿中精进数据可视化_使用ggcirclize绘制circos圈图</a></center></strong><p><br></p></blockquote></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/5ka15kregXe4XDpLyW-Z-w",target="_blank" rel="noopener noreferrer">原文链接</a>
