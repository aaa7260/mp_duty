---
title: "单细胞测序 | Seurat 数据结构与样本合并"
date: 2024-05-15T09:44:01Z
draft: ["false"]
tags: [
  "fetched",
  "被炸熟的虾"
]
categories: ["Acdemic"]
---
单细胞测序 | Seurat 数据结构与样本合并 by 被炸熟的虾
------
<div><section><span>虽然<span>Seurat</span>升级后标准流程变换不大：<a href="https://mp.weixin.qq.com/s?__biz=MzkwNDQwMDI5NQ==&amp;mid=2247486783&amp;idx=1&amp;sn=f59e51b07863b59b2263bff583ce547b&amp;scene=21#wechat_redirect" data-linktype="2">单细胞测序 | Seurat 官网教程 pbmc3k 标准流程简单整理</a>，但是做起样本整合与后续分析时真的有点小折磨。</span></section><h2><span>1、Seurat 对象结构总览</span></h2><p><span>新版</span><code>Seurat</code><span>在数据存储格式上进行了不小的变动，利用</span><span>V4</span><span>与</span><span>V5</span><span>两个版本分别运行</span><code>Seurat</code><span>标准工作流程：</span></p><pre><code><span>library</span>(Seurat)<br>packageVersion(<span>"Seurat"</span>)<br>pbmc.data &lt;- Read10X(data.dir = <span>"./filtered_gene_bc_matrices/"</span>)<span>#[1] 32738  2700</span><br>pbmc &lt;- CreateSeuratObject(counts = pbmc.data, project = <span>"pbmc3k"</span>, min.cells = <span>3</span>, min.features = <span>200</span>)<br>pbmc &lt;- NormalizeData(object = pbmc)<br>pbmc &lt;- FindVariableFeatures(object = pbmc)<br>pbmc &lt;- ScaleData(object = pbmc)<br>pbmc &lt;- RunPCA(object = pbmc)<br>pbmc &lt;- FindNeighbors(object = pbmc, dims = <span>1</span>:<span>30</span>)<br>pbmc &lt;- FindClusters(object = pbmc)<br>pbmc &lt;- RunUMAP(object = pbmc, dims = <span>1</span>:<span>30</span>)<br></code></pre><h3></h3><h3><span><strong><span>Seurat V4</span></strong></span></h3><pre><code>packageVersion(<span>"Seurat"</span>) <span>#[1] ‘4.3.0’</span><br></code></pre><p><img data-imgfileid="100003499" data-ratio="0.41388888888888886" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/dRYYdqiaan3JnzG1ZsDQWRLLWE8LjfdIcMAbfDbF1Uic9GZ39g1u0Ch1zRsPPU1n7JU7xggIGVOQA5p5UzZ3tAcw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/dRYYdqiaan3JnzG1ZsDQWRLLWE8LjfdIcMAbfDbF1Uic9GZ39g1u0Ch1zRsPPU1n7JU7xggIGVOQA5p5UzZ3tAcw/640?wx_fmt=png&amp;from=appmsg"></p><ul><li><section><strong><span>assays</span></strong><span>：储存一系列表达量矩阵，包括不同数据来源的原始表达量（</span><span>count</span><span>）、均一化（</span><span>data</span><span>）、归一化（</span><span>scale.data</span><span>）数据等</span></section></li><li><section><strong><span>meta.data</span></strong><span>：记录所有细胞的描述信息，如样本、</span><span>UMI</span><span>数、检测基因数、分群信息、细胞注释等：</span></section></li><li><section><strong><span>reduction</span></strong><span>：记录细胞的降维信息</span></section></li><li><section><strong><span>active.ident</span></strong><span>：当前默认的细胞注释信息</span></section></li><li><section><strong><span>graphs</span></strong><span>：细胞临近图</span></section></li><li><section><strong><span>images</span></strong><span>：图片信息，主要用于空间转录组</span></section></li><li><section><strong><span>project.name</span></strong><span>：项目名称，创建时命名</span></section></li><li><section><strong><span>version</span></strong><span>：创建该对象时使用的</span><code>Seurat</code><span>版本</span></section></li><li><section><strong><span>commands</span></strong><span>：数据分析过程中的每个步骤使用的参数命令，包括命令执行的时间和日期</span></section></li></ul><p><span>虽然</span><code>Seurat</code><span>对象进行了封装，但需要时仍可以利用</span><span>@</span><span>与</span><span>$</span><span>提取相应插槽信息，例如提取</span><span>UMAP</span><span>坐标、表达矩阵或注释信息：</span></p><pre><code><span>###降维坐标</span><br>head(pbmc@reductions$umap@cell.embeddings)<br><span>#                     UMAP_1      UMAP_2</span><br><span>#AAACATACAACCAC-1   3.181187 -0.06559556</span><br><span>#AAACATTGAGCTAC-1   4.736073 11.57442195</span><br><span>#AAACATTGATCAGC-1   5.678308  0.36032302</span><br><span>#AAACCGTGCTTCCG-1 -10.141605 -7.33418887</span><br><span>#AAACCGTGTATGCG-1   3.911305 -5.11113458</span><br><span>#AAACGCACTGGTAC-1   4.499196  0.06407172</span><br><span>###数据矩阵</span><br>pbmc@assays$RNA@counts[<span>1</span>:<span>4</span>,<span>1</span>:<span>4</span>]<br>pbmc@assays$RNA@data[<span>1</span>:<span>4</span>,<span>1</span>:<span>4</span>]<br>pbmc@assays$RNA@scale.data[<span>1</span>:<span>4</span>,<span>1</span>:<span>4</span>]<br><span>###细胞信息</span><br>head(pbmc@meta.data)<br><span>#                  orig.ident nCount_RNA nFeature_RNA RNA_snn_res.0.8 seurat_clusters</span><br><span># AAACATACAACCAC-1     pbmc3k       2419          779               0               0</span><br><span># AAACATTGAGCTAC-1     pbmc3k       4903         1352               3               3</span><br><span># AAACATTGATCAGC-1     pbmc3k       3147         1129               1               1</span><br><span># AAACCGTGCTTCCG-1     pbmc3k       2639          960               5               5</span><br><span># AAACCGTGTATGCG-1     pbmc3k        980          521               6               6</span><br><span># AAACGCACTGGTAC-1     pbmc3k       2163          781               1               1</span><br></code></pre><p><span>其实</span><code>Seurat</code><span>为每个插槽的数据提取都提供了专门的函数，但我这个懒癌晚期患者真的一点都没背<img data-src="https://res.wx.qq.com/t/wx_fed/we-emoji/res/v1.3.10/assets/Expression/Expression_9@2x.png" data-ratio="1" data-w="128" src="https://res.wx.qq.com/t/wx_fed/we-emoji/res/v1.3.10/assets/Expression/Expression_9@2x.png">，例如：</span></p><pre><code><span>###降维坐标</span><br>Embeddings(pbmc, reduction = <span>"pca"</span>)<br>Embeddings(pbmc, reduction = <span>"umap"</span>)<br><span>###数据矩阵</span><br>GetAssayData(object = pbmc, assay = <span>"RNA"</span>, slot = <span>"counts"</span>)<br>GetAssayData(object = pbmc, assay = <span>"RNA"</span>, slot = <span>"data"</span>)<br>GetAssayData(object = pbmc, assay = <span>"RNA"</span>, slot = <span>"scale.data"</span>)<br></code></pre><h3><span><strong><span>Seurat V5</span></strong></span></h3><pre><code>packageVersion(<span>"Seurat"</span>) <span>#[1] ‘5.0.3’</span><br></code></pre><p><span>升级为</span><code>Seurat</code><span>V5</span><span>后，</span><code>Seurat</code><span>对象组织结构变了：</span></p><p><img data-imgfileid="100003503" data-ratio="0.49722222222222223" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/dRYYdqiaan3JnzG1ZsDQWRLLWE8LjfdIcdibqNaywDdBU1v3SDTiaicKLwDov9PqPSFYvNSaV8grum3QGSicJuAU0Yg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/dRYYdqiaan3JnzG1ZsDQWRLLWE8LjfdIcdibqNaywDdBU1v3SDTiaicKLwDov9PqPSFYvNSaV8grum3QGSicJuAU0Yg/640?wx_fmt=png&amp;from=appmsg"></p><p><span>在<span>V5</span>中，</span><span>assays</span><span>的</span><span>RNA</span><span>下多了一层</span><span>layers</span><span>，并将</span><span>counts</span><span>、</span><span>data</span><span>以及</span><span>scale.data</span><span>归类到</span><span>layers</span><span>层级之下，这也是和<span>V4</span>最大的区别。相应的，数据提取代码就需要重新组织：</span></p><pre><code>head(pbmc@assays$RNA@layers$counts) <span>#无基因名，仅表达量信息</span><br>head(pbmc@assays$RNA$counts)<br>pbmc@assays$RNA$counts[<span>1</span>:<span>4</span>,<span>1</span>:<span>4</span>]<br><span>#查看标准化稀疏矩阵：</span><br>pbmc@assays$RNA$data[<span>1</span>:<span>4</span>,<span>1</span>:<span>4</span>]<br><span>#查看归一化数据：</span><br>pbmc@assays$RNA$scale.data[<span>1</span>:<span>4</span>,<span>1</span>:<span>4</span>]<br></code></pre><p><span>除去<span>沿用</span></span><code>Seurat</code><span>V4</span><span>的函数，</span><span>V5</span><span>也新增了一些新的数据提取方法/函数，例如，如果需要提取</span><span>Count</span><span>矩阵，我们可以利用以下方法：</span></p><pre><code><span>#仍然支持来自Seurat v4的GetAssayData</span><br>GetAssayData(object = pbmc, assay = <span>"RNA"</span>, slot = <span>"counts"</span>)<br><span>#检索表达矩阵RNA计数矩阵中的数据</span><br>pbmc[[<span>"RNA"</span>]]$counts<br><span>#新增备用函数</span><br>LayerData(pbmc, assay = <span>"RNA"</span>, layer = <span>"counts"</span>)<br><span>#仍然支持来自Seurat v4的GetAssayData</span><br>GetAssayData(object = pbmc, assay = <span>"RNA"</span>, slot = <span>"counts"</span>)    <br></code></pre><p><span>查看</span><span>cells</span><span>和</span><span>features</span><span>：</span></p><pre><code>pbmc[[<span>'RNA'</span>]]<br><span>#Assay (v5) data with 13714 features for 2700 cells</span><br><span>#Top 10 variable features:</span><br><span># PPBP, S100A9, IGLL5, LYZ, GNLY, FTL, PF4, FTH1, FCER1A, GNG11 </span><br><span>#Layers:</span><br><span># counts, data, scale.data </span><br>head(Cells(pbmc[[<span>'RNA'</span>]]))<br><span>#[1] "AAACATACAACCAC-1" "AAACATTGAGCTAC-1" "AAACATTGATCAGC-1" "AAACCGTGCTTCCG-1"</span><br><span>#[5] "AAACCGTGTATGCG-1" "AAACGCACTGGTAC-1"</span><br>head(Features(pbmc[[<span>'RNA'</span>]]))<br><span>#[1] "AL627309.1"    "AP006222.2"    "RP11-206L10.2" "RP11-206L10.9"</span><br><span>#[5] "LINC00115"     "NOC2L"     </span><br></code></pre><p><span>尴尬的是部分下游分析</span><span>R</span><span>包也采用的是</span><span>@</span><span>与</span><span>$</span><span>提取相应插槽信息，没有及时更新，因此使用</span><code>Seurat</code><span>V5</span><span>对象作为输入无法运行。</span><span>emmm</span><span>，等等吧。</span></p><p><span>有趣的是，</span><span>assays</span><span>下也塞了一个</span><span>meta.data</span><span>，包含了</span><span>v4</span><span>中</span><span>meta.feature</span><span>和</span><span>var.features</span><span>：</span></p><pre><code>head(pbmc@assays$RNA@meta.data)<br>  <span># vf_vst_counts_mean vf_vst_counts_variance vf_vst_counts_variance.expected</span><br><span># 1        0.003333333            0.003323453                     0.003575582</span><br><span># 2        0.001111111            0.001110288                     0.001112798</span><br><span># 3        0.001851852            0.001849107                     0.001921811</span><br><span># 4        0.001111111            0.001110288                     0.001112798</span><br><span># 5        0.006666667            0.006624676                     0.007342308</span><br><span># 6        0.106666667            0.158310485                     0.203482316</span><br>  <span># vf_vst_counts_variance.standardized vf_vst_counts_variable vf_vst_counts_rank var.features</span><br><span># 1                           0.9294859                  FALSE                 NA         &lt;NA&gt;</span><br><span># 2                           0.9977442                  FALSE                 NA         &lt;NA&gt;</span><br><span># 3                           0.9621691                  FALSE                 NA         &lt;NA&gt;</span><br><span># 4                           0.9977442                  FALSE                 NA         &lt;NA&gt;</span><br><span># 5                           0.9022607                  FALSE                 NA         &lt;NA&gt;</span><br><span># 6                           0.7780061                  FALSE                 NA         &lt;NA&gt;</span><br>  <span># var.features.rank</span><br><span># 1                NA</span><br><span># 2                NA</span><br><span># 3                NA</span><br><span># 4                NA</span><br><span># 5                NA</span><br><span># 6                NA</span><br></code></pre><p><span>与另一个</span><span>meta.data</span><span>比较一下：</span></p><pre><code>head(pbmc@meta.data)<br>                 <span># orig.ident nCount_RNA nFeature_RNA RNA_snn_res.0.8 seurat_clusters</span><br><span># AAACATACAACCAC-1     pbmc3k       2419          779               0               0</span><br><span># AAACATTGAGCTAC-1     pbmc3k       4903         1352               3               3</span><br><span># AAACATTGATCAGC-1     pbmc3k       3147         1129               1               1</span><br><span># AAACCGTGCTTCCG-1     pbmc3k       2639          960               5               5</span><br><span># AAACCGTGTATGCG-1     pbmc3k        980          521               6               6</span><br><span># AAACGCACTGGTAC-1     pbmc3k       2163          781               1               1</span><br></code></pre><p><span>这个安排的意义是啥<img data-ratio="1" data-src="https://res.wx.qq.com/t/wx_fed/we-emoji/res/v1.3.10/assets/Expression/Expression_33@2x.png" data-w="128" src="https://res.wx.qq.com/t/wx_fed/we-emoji/res/v1.3.10/assets/Expression/Expression_33@2x.png">？</span></p><h2><span>2、多样本合并</span></h2><section><span>这里只是简单的数据整合，即没有对数据集做任何校正处理（没有</span><span>integration</span><span>）。<span>使用函数</span><code>seurat::merge()</code><span>整合两个或多个数据集。</span></span></section><h3><span><strong><span>Seurat V4：</span></strong></span></h3><section><span></span></section><section><strong><span>示例</span></strong><strong><span>1</span></strong><strong><span>：</span></strong><span>合并两个</span><span>10X PBMC</span><span>数据集：</span></section><p><span>首先读入并创建两个</span><span>seurat objects: pbmc4k</span><span>和</span><span>pbmc8k</span></p><pre><code>rm(list=ls())<br>options(stringsAsFactors = <span>F</span>)<br>setwd(<span>"D:/bioinformatics/scRNA-seq/0. background/data"</span>)<br><span>library</span>(Seurat)<br>pbmc4k.data &lt;- Read10X(data.dir = <span>"./pbmc4k/filtered_gene_bc_matrices/GRCh38/"</span>)<br>pbmc4k &lt;- CreateSeuratObject(counts = pbmc4k.data, project = <span>"PBMC4K"</span>)<br>pbmc4k<br><span>#An object of class Seurat </span><br><span>#33694 features across 4340 samples within 1 assay </span><br><span>#Active assay: RNA (33694 features, 0 variable features)</span><br><br>pbmc8k.data &lt;- Read10X(data.dir = <span>"./pbmc8k/filtered_gene_bc_matrices/GRCh38/"</span>)<br>pbmc8k &lt;- CreateSeuratObject(counts = pbmc8k.data, project = <span>"PBMC8K"</span>)<br>pbmc8k<br><span>#An object of class Seurat </span><br><span>#33694 features across 8381 samples within 1 assay </span><br><span>#Active assay: RNA (33694 features, 0 variable features)</span><br></code></pre><section><span>考虑到两个数据集的细胞</span><span>barcode</span><span>可能会重复，为了区分细胞来源，通过</span><span>add.cell.ids</span><span>给不同样本的细胞</span><span>barcode</span><span>添加一个</span><span>id：</span></section><pre><code>pbmc.combined &lt;- merge(pbmc4k, y = pbmc8k, add.cell.ids = c(<span>"4K"</span>, <span>"8K"</span>), project =<span>"PBMC12K"</span>)<br>pbmc.combined<br><span>#An object of class Seurat </span><br><span>#33694 features across 12721 samples within 1 assay </span><br><span>#Active assay: RNA (33694 features, 0 variable features)</span><br><br>head(colnames(pbmc.combined))<br><span>#[1] "4K_AAACCTGAGAAGGCCT-1" "4K_AAACCTGAGACAGACC-1" "4K_AAACCTGAGATAGTCA-1" "4K_AAACCTGAGCGCCTCA-1" "4K_AAACCTGAGGCATGGT-1" "4K_AAACCTGCAAGGTTCT-1" </span><br>tail(colnames(pbmc.combined))<br><span>#[1] "8K_TTTGTCAGTTACCGAT-1" "8K_TTTGTCATCATGTCCC-1" "8K_TTTGTCATCCGATATG-1" "8K_TTTGTCATCGTCTGAA-1" "8K_TTTGTCATCTCGAGTA-1" "8K_TTTGTCATCTGCTTGC-1"</span><br>table(pbmc.combined$orig.ident)<br><span># PBMC4K PBMC8K </span><br><span>#  4340   8381 </span><br></code></pre><p><strong><span>示例</span></strong><strong><span>2</span></strong><strong><span>：</span></strong><span>合并多个数据集：</span><span>pbmc3k pbmc4k pbmc8k</span><span></span></p><pre><code><span>#InstallData("pbmc3k")</span><br><span>library</span>(SeuratData)<br>pbmc3k &lt;- LoadData(<span>"pbmc3k"</span>, type = <span>"pbmc3k.final"</span>)<br>pbmc3k<br>pbmc.big &lt;- merge(pbmc3k, y = c(pbmc4k, pbmc8k), add.cell.ids = c(<span>"3K"</span>, <span>"4K"</span>, <span>"8K"</span>), project = <span>"PBMC15K"</span>)<br>pbmc.big<br>table(pbmc.big$orig.ident)<br><span># pbmc3k PBMC4K PBMC8K </span><br><span>#  2638   4340   8381 </span><br></code></pre><section><span>因此遇到之前《</span><a href="https://mp.weixin.qq.com/s?__biz=MzkwNDQwMDI5NQ==&amp;mid=2247486847&amp;idx=1&amp;sn=07c2d3edc26a6d1df89f7eef371ad3b9&amp;scene=21#wechat_redirect" data-linktype="2">在R中读入不同格式的单细胞公共数据</a><span>》中那样循环读入情况时，可以一步合并：</span></section><pre><code>sce.all &lt;- merge(sceList[[<span>1</span>]], y = sceList[-<span>1</span>], <br>                 add.cell.ids = folders, <br>                 project = <span>"Merge"</span>)<br>sce.all<br></code></pre><section><span>默认情况下，将基于原始计数矩阵合并对象, 如果你想同时合并标准化的数据矩阵以及原始计数矩阵，则应添加</span><code>merge.data = TRUE</code><span>：</span></section><pre><code>pbmc4k &lt;- NormalizeData(pbmc4k)<br>pbmc8k &lt;- NormalizeData(pbmc8k)<br>pbmc.normalized &lt;- merge(pbmc4k, y = pbmc8k, add.cell.ids = c(<span>"4K"</span>, <span>"8K"</span>), project = <span>"PBMC12K"</span>, <br>                         merge.data = <span>TRUE</span>)<br></code></pre><h3><span><strong><span>Seurat V5：</span></strong></span></h3><section><span>如果是</span><code>Seurat</code><span>的</span><span>V5</span><span>版本，多个文件如果是分开读取的，</span><code>merge</code><span>函数并没有把每个样品的表达量矩阵</span><span>merge</span><span>，在</span><code>Seurat</code><span>对象中每个样品仍然是独立的矩阵，如下所示：</span></section><pre><code>pbmc.combined &lt;- merge(pbmc4k, y = pbmc8k, add.cell.ids = c(<span>"4K"</span>, <span>"8K"</span>), project =<span>"PBMC12K"</span>)<br>pbmc.combined<br><span>#An object of class Seurat </span><br><span>#33694 features across 12721 samples within 1 assay </span><br><span>#Active assay: RNA (33694 features, 0 variable features)</span><br><span># 2 layers present: counts.PBMC4K, counts.PBMC8K</span><br></code></pre><p><img data-imgfileid="100003500" data-ratio="0.49537037037037035" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/dRYYdqiaan3JnzG1ZsDQWRLLWE8LjfdIcVeFlVghkLPqssQNb2C7sa3Z4vXyNKWZrnibYb7b7N6vzyxM4dY4tboQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/dRYYdqiaan3JnzG1ZsDQWRLLWE8LjfdIcVeFlVghkLPqssQNb2C7sa3Z4vXyNKWZrnibYb7b7N6vzyxM4dY4tboQ/640?wx_fmt=png&amp;from=appmsg"></p><section><strong><span>需要使用额外</span><code>JoinLayers()</code><span>函数将其彻底融合：</span></strong><span></span></section><pre><code>pbmc.combined &lt;- JoinLayers(pbmc.combined)<br>pbmc.combined<br><span>#An object of class Seurat </span><br><span>#33694 features across 12721 samples within 1 assay </span><br><span>#Active assay: RNA (33694 features, 0 variable features)</span><br><span># 1 layer present: counts</span><br>head(pbmc.combined@meta.data)<br><span>#                      orig.ident nCount_RNA nFeature_RNA</span><br><span>#4K_AAACCTGAGAAGGCCT-1     PBMC4K       1738          748</span><br><span>#4K_AAACCTGAGACAGACC-1     PBMC4K       3240         1052</span><br><span>#4K_AAACCTGAGATAGTCA-1     PBMC4K       1683          739</span><br><span>#4K_AAACCTGAGCGCCTCA-1     PBMC4K       2319          875</span><br><span>#4K_AAACCTGAGGCATGGT-1     PBMC4K       2983          951</span><br><span>#4K_AAACCTGCAAGGTTCT-1     PBMC4K       4181         1248</span><br>tail(pbmc.combined@meta.data)<br><span>#                      orig.ident nCount_RNA nFeature_RNA</span><br><span>#8K_TTTGTCAGTTACCGAT-1     PBMC8K       4808         1436</span><br><span>#8K_TTTGTCATCATGTCCC-1     PBMC8K       3141         1176</span><br><span>#8K_TTTGTCATCCGATATG-1     PBMC8K       5401         1379</span><br><span>#8K_TTTGTCATCGTCTGAA-1     PBMC8K       6081         1802</span><br><span>#8K_TTTGTCATCTCGAGTA-1     PBMC8K       3970         1317</span><br><span>#8K_TTTGTCATCTGCTTGC-1     PBMC8K       4027         1259</span></code></pre><p><img data-imgfileid="100003501" data-ratio="0.5287037037037037" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/dRYYdqiaan3JnzG1ZsDQWRLLWE8LjfdIcRBNm6e2PROFVf6FjTqNwV5BjQbobU1MPO1hYuHaibRovZw0PyB6BVGw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/dRYYdqiaan3JnzG1ZsDQWRLLWE8LjfdIcRBNm6e2PROFVf6FjTqNwV5BjQbobU1MPO1hYuHaibRovZw0PyB6BVGw/640?wx_fmt=png&amp;from=appmsg"></p><p><span>如果需要还可以再次拆分：</span></p><pre><code>pbmc.combined[[<span>"RNA"</span>]] &lt;- split(pbmc.combined[[<span>"RNA"</span>]], f = pbmc.combined$orig.ident)<br></code></pre><section><span>此外</span><code>Read10X()</code><span>函数可以一次性读取多个路径文件，这让我们可以在文件读入阶段直接合并所有样本。比如我们整理好</span><span>GSE106273</span><span>样本后，可以一步生成：</span></section><p><img data-imgfileid="100003502" data-ratio="0.8148148148148148" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/dRYYdqiaan3JnzG1ZsDQWRLLWE8LjfdIcNNZGb3zoVrDeZHc0MRtrdw9XsGniaTwic9QVACWmnicy8yTvHvjT9snqw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/dRYYdqiaan3JnzG1ZsDQWRLLWE8LjfdIcNNZGb3zoVrDeZHc0MRtrdw9XsGniaTwic9QVACWmnicy8yTvHvjT9snqw/640?wx_fmt=png&amp;from=appmsg"></p><pre><code><span>library</span>(Seurat)<br>dir &lt;- list.dirs(<span>'./GSE106273_RAW'</span>)[-<span>1</span>] <span>#list.dirs会把根目录也列出来，所以要-1.</span><br><span># 创建Seurat对象</span><br>sce.all &lt;- CreateSeuratObject(counts = Read10X(dir), <br>                              min.cells = <span>5</span>,<br>                              min.features = <span>300</span>)<br>sce.all</code></pre><h3><span>参考文章：</span></h3><section><strong><span>1、</span></strong><span><strong><span>SCIPainter</span></strong><span>：</span></span><a href="https://mp.weixin.qq.com/s?__biz=MzIyOTY3MDA3MA==&amp;mid=2247534728&amp;idx=1&amp;sn=63aac8681bf93c467e45e207e36d32a5&amp;scene=21#wechat_redirect" data-linktype="2"><span>v5 Seurat对象内部结构一览</span></a></section><section><strong><span>2、</span></strong><strong><span><span>小熊学生信</span></span></strong><span><span></span><span>：</span></span><a href="https://mp.weixin.qq.com/s?__biz=MzI5NzUzMTQ3Nw==&amp;mid=2247484002&amp;idx=1&amp;sn=a6e914d5d52ea54fcca3b645433e7c58&amp;scene=21#wechat_redirect" data-linktype="2"><span>Seurat v5批量读取多个10x的单细胞数据</span></a></section><section><strong><span>3、Seurat - Combining Two 10X Runs：</span></strong></section><section><strong><span>https://satijalab.org/seurat/archive/v4.3/merge</span></strong></section><p><br></p><section><img data-imgfileid="100003130" data-ratio="0.05278592375366569" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/1LTeQhNfr8sUH75oYsoDaqjPCTiaukEmS8tWricW7LnLKKfIE9jKBexibqamsrlibaaXmuc2nicaYibfDFBNCmqX5mBw/640?wx_fmt=other&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1&amp;tp=webp" data-type="png" data-w="341" src="https://mmbiz.qpic.cn/sz_mmbiz_png/1LTeQhNfr8sUH75oYsoDaqjPCTiaukEmS8tWricW7LnLKKfIE9jKBexibqamsrlibaaXmuc2nicaYibfDFBNCmqX5mBw/640?wx_fmt=other&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1&amp;tp=webp"></section><section data-tools="135编辑器" data-id="116886" draggable="true"><section><section><section><section><strong data-brushtype="text">被炸熟的虾</strong></section></section></section><section><section><section data-width="35%"><section><img data-cropselx1="0" data-cropselx2="115" data-cropsely1="0" data-cropsely2="115" data-imgfileid="100003129" data-ratio="1" data-src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/dRYYdqiaan3JjDfj2H8p6gg3CB25AGthbwzrotao4ev5tIe0utthbZRK8yOoDOuTzOSoTSnPWn61IdDCnXsnaiag/640?wx_fmt=other&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1&amp;tp=webp" data-type="jpeg" data-w="258" data-width="100%" src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/dRYYdqiaan3JjDfj2H8p6gg3CB25AGthbwzrotao4ev5tIe0utthbZRK8yOoDOuTzOSoTSnPWn61IdDCnXsnaiag/640?wx_fmt=other&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1&amp;tp=webp"></section></section><section data-width="63%"><section><section><strong>自己的摸索，发现问题麻烦告诉作者，光速回来改正</strong><strong><img data-ratio="1" data-type="png" data-w="64" data-imgfileid="100003128" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/dRYYdqiaan3KLQGNxibvI4SdtUfxjINkz2DO8cGEPTgbcMJ357RvXJ7IvWU2p7anljpePpakI9oKu3icJxobBDp5w/640?wx_fmt=other&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1&amp;tp=webp" src="https://mmbiz.qpic.cn/sz_mmbiz_png/dRYYdqiaan3KLQGNxibvI4SdtUfxjINkz2DO8cGEPTgbcMJ357RvXJ7IvWU2p7anljpePpakI9oKu3icJxobBDp5w/640?wx_fmt=other&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1&amp;tp=webp"></strong></section></section></section></section></section></section></section><p><mp-style-type data-value="10000"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/WbThYGqKitgcMdmVRRFArA",target="_blank" rel="noopener noreferrer">原文链接</a>
