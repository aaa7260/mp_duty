---
title: "[会员专享] 跟着NC学绘图之散点图叠加拟合曲线"
date: 2022-12-13T04:28:01Z
draft: ["false"]
tags: [
  "fetched",
  "R语言数据分析指南"
]
categories: ["Acdemic"]
---
[会员专享] 跟着NC学绘图之散点图叠加拟合曲线 by R语言数据分析指南
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><blockquote data-tool="mdnice编辑器"><span>❝</span><p>本节来复现<strong>「nature communications」</strong>上的一张图；散点图+拟合曲线，图形绘制倒也简单主要是细节的调整结果仅供参考，<strong>「数据+代码已经上传VIP群，加群的观众老爷请自行下载」</strong></p><span>❞</span></blockquote><h3 data-tool="mdnice编辑器"><span></span><span><span></span>原文</span><span></span></h3><blockquote data-tool="mdnice编辑器"><span>❝</span><p>Bioenergetic control of soil carbon dynamics across depth</p><span>❞</span></blockquote><figure data-tool="mdnice编辑器"><img data-ratio="0.5264" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAYu1QgYXh4bsBzeb5ibI1dibL8hJEjtWOtTuIgG0NyhFN1tTZRZsRNVVsQJ6gXluJQPSgnKXyHtoU6Q/640?wx_fmt=png" data-type="png" data-w="1250" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAYu1QgYXh4bsBzeb5ibI1dibL8hJEjtWOtTuIgG0NyhFN1tTZRZsRNVVsQJ6gXluJQPSgnKXyHtoU6Q/640?wx_fmt=png"></figure><blockquote data-tool="mdnice编辑器"><span>❝</span><p><code>有需要学习数据可视化的朋友欢迎加入小编2022年度VIP群</code>，目前群内已经上传公众号文档<strong>「数据+代码约270篇」</strong>，<code>VIP交流群(1)已经500人满员</code>,随着内容不断增多，为了更好的创做内容现在进群需<strong>「付费149元」</strong> 年底临近<strong>「从即日起至12月底无需转发文档到朋友圈积赞，可直接已129元的价格入群」</strong>无需求请勿扰。</p><span>❞</span></blockquote><h3 data-tool="mdnice编辑器"><span></span><span><span></span>小编微信</span><span></span></h3><p><img data-galleryid="" data-ratio="1" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/EibnicgwScTAaNu6sU2UCYkxFq9ibq75wuaO0lqFoYz1icUo4jh3N2icAWECmibgPvqyReur0FCp7JNKO0icnRAsbO9ug/640?wx_fmt=jpeg" data-type="jpeg" data-w="430" src="https://mmbiz.qpic.cn/mmbiz_jpg/EibnicgwScTAaNu6sU2UCYkxFq9ibq75wuaO0lqFoYz1icUo4jh3N2icAWECmibgPvqyReur0FCp7JNKO0icnRAsbO9ug/640?wx_fmt=jpeg"></p><h3 data-tool="mdnice编辑器"><span></span><span><span></span>关注下方公众号下回更新不迷路</span><span></span></h3><section><mp-common-profile data-pluginname="mpprofile" data-weui-theme="light" data-id="Mzg3MzQzNTYzMw==" data-headimg="http://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZF0rpeZII9Ltl26VbVagriczTria1fib3XgjwwHEHFjPzkmGpqWDVVHBSzhENictUM2iavAKiaM5lc9USw/0?wx_fmt=png" data-nickname="R语言数据分析指南" data-alias="YanJANtwo" data-signature="R语言重症爱好者，喜欢绘制各种精美的图表，喜欢的小伙伴可以关注我，跟我一起学习" data-from="0" data-is_biz_ban="0"></mp-common-profile></section><h3 data-tool="mdnice编辑器"><span></span><span><span></span>淘宝店铺个性化绘图服务</span><span></span></h3><blockquote data-tool="mdnice编辑器"><span>❝</span><p>最近有部分观众老爷找小编做个性化绘图，为了给观众老爷提供更加优质的服务；小编开通了 <strong>「淘宝店铺(R语言数据分析指南)」</strong> ，有特殊绘图需求的欢迎关注咨询</p><span>❞</span></blockquote><h3 data-tool="mdnice编辑器"><span></span><span><span></span>结果图</span><span></span></h3><figure data-tool="mdnice编辑器"><img data-ratio="0.9153005464480874" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAYu1QgYXh4bsBzeb5ibI1dibLpoBYnotr7QQqqO6nYWrHA6gQUQz9KrOpiaiaPYmh2kWBkib4yHeX9Ep0g/640?wx_fmt=png" data-type="png" data-w="732" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAYu1QgYXh4bsBzeb5ibI1dibLpoBYnotr7QQqqO6nYWrHA6gQUQz9KrOpiaiaPYmh2kWBkib4yHeX9Ep0g/640?wx_fmt=png"></figure><h3 data-tool="mdnice编辑器"><span></span><span><span></span>加载R包</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code><span>library</span>(tidyverse)<br><span>library</span>(magrittr)<br><span>library</span>(ggsci)<br><span>library</span>(ggpubr)<br><span>library</span>(cowplot)<br><span>library</span>(ggpmisc)<br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span><span></span>数据清洗</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code>df &lt;- read_tsv(<span>"data.txt"</span>) %&gt;% <br>  select(2:4,<span>"Respiration of plant-derived OC \r\n(Rplant, g C-CO2 \r\nm-2 day-1)"</span>,<br>         <span>"Native SOC decomposition rate \r\n(kSOC, µg C-CO2 \r\ng-1 SOC day-1)"</span>,last_col()) %&gt;% <br>  set_colnames(c(<span>"type"</span>,<span>"layer"</span>,<span>"plant"</span>,<span>"plant_derived"</span>,<span>"SOC"</span>,<span>"RPF"</span>)) %&gt;% <br>  unite(.,col=<span>"lintype"</span>,layer:<span>type</span>,sep=<span>"-"</span>,remove = F,na.rm = F)<br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span><span></span>绘制附图</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code>p1 &lt;- df %&gt;% <br>  ggplot(aes(plant_derived,SOC,shape=lintype,color=lintype,linetype=lintype))+<br>  geom_point()+<br>  geom_smooth(method = lm, formula = y ~ x,alpha=<span>0.3</span>,se=<span>F</span>)+<br>  scale_linetype_manual(values = c(<span>"dotted"</span>,<span>"dotted"</span>,<span>"dotted"</span>,<span>"solid"</span>,<span>"solid"</span>,<span>"solid"</span>))+<br>  scale_color_manual(values=c(<span>"#FD7446FF"</span>,<span>"#008f39"</span>,<span>"#56B4E9"</span>,<span>"#FD7446FF"</span>,<span>"#008f39"</span>,<span>"#56B4E9"</span>))+<br>  scale_shape_manual(values=c(<span>0</span>,<span>2</span>,<span>1</span>,<span>16</span>,<span>17</span>,<span>15</span>))+<br>  theme_test()+<br>  theme(legend.title = element_blank(),<br>        legend.key = element_blank(),<br>        legend.text = element_text(color=<span>"black"</span>))<br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span><span></span>绘制主图</span><span></span></h3><p><mp-pay-preview-filter></mp-pay-preview-filter></p></section></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/eoKkPMPB03QdPwXXc4cDow",target="_blank" rel="noopener noreferrer">原文链接</a>
