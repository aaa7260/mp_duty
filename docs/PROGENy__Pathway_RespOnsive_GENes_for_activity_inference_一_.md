---
title: "PROGENy: Pathway RespOnsive GENes for activity inference（一）"
date: 2022-12-19T06:33:16Z
draft: ["false"]
tags: [
  "fetched",
  "生信菜鸟团"
]
categories: ["Acdemic"]
---
PROGENy: Pathway RespOnsive GENes for activity inference（一） by 生信菜鸟团
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><p><img data-ratio="0.53" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibiczT3BTIILXTyR6VsNkndlYW2XfSXDuWe3BoE8q9iaD9S4aT8ED3AvpcnDBX8SwCC0KRZgAEqaedg/640?wx_fmt=png" data-type="png" data-w="400" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibiczT3BTIILXTyR6VsNkndlYW2XfSXDuWe3BoE8q9iaD9S4aT8ED3AvpcnDBX8SwCC0KRZgAEqaedg/640?wx_fmt=png"></p><p data-tool="mdnice编辑器">Title：PROGENy: Pathway RespOnsive GENes for activity inference; 通路反应基因活性推断工具</p><h1 data-tool="mdnice编辑器"><span></span>1.引入</h1><p data-tool="mdnice编辑器">在上篇推送介绍的R包中，我们用到了PROGENy工具分析14个通路的活性，简单提了一下PROGENy的github 地址，但并没有做过多探索，在后续的学习中，发现PROGENy的学习文档写的也很……就不是很能懂。由此，本篇就PROGENy 进行简要探索。</p><h1 data-tool="mdnice编辑器"><span></span>2. 介绍</h1><p data-tool="mdnice编辑器">PROGENy （Pathway RespOnsive GENes for activity inference）是2018年发表在Nature Communication的R包[1]。一般认为，基因表达与通路的信号活性相关，在以往的通路富集分析中，基本上都以此为依据，认为在某个通路中高表达的基因越多，则通路激活的可能性越大，然而，却忽略了翻译后修饰的影响，基于此，作者团队开发了PROGENy, 它可以使用公开可用的信号扰动实验<code>(perturbation experiments)</code>数据来推断出人类的样本通路响应过程中的共同核心基因。这些可与任何统计方法相结合，可用于从bulk RNAseq学中推断通路活性。在作者的Abstract中，其将PROGENy的功能主要总结为以下几点：</p><blockquote data-tool="mdnice编辑器"><p><strong>(i) Recover the effect of known driver mutations</strong></p><p><strong>(ii) Provide or improve strong markers for drug indications</strong></p><p><strong>(iii) Distinguish between oncogenic and tumor suppressor pathways for patient survival</strong></p></blockquote><p data-tool="mdnice编辑器">PROGENy计算的14种通路简要介绍如下：</p><blockquote data-tool="mdnice编辑器"><p><strong>Androgen</strong>: involved in the growth and development of the male reproductive organs.</p><p><strong>EGFR</strong>: regulates growth, survival, migration, apoptosis, proliferation, and differentiation in mammalian cells</p><p><strong>Estrogen</strong>: promotes the growth and development of the female reproductive organs.</p><p><strong>Hypoxia</strong>: promotes angiogenesis and metabolic reprogramming when O2 levels are low.</p><p><strong>JAK-STAT</strong>: involved in immunity, cell division, cell death, and tumor formation.</p><p><strong>MAPK</strong>: integrates external signals and promotes cell growth and proliferation.</p><p><strong>NFkB</strong>: regulates immune response, cytokine production and cell survival.</p><p><strong>p53</strong>: regulates cell cycle, apoptosis, DNA repair and tumor suppression.</p><p><strong>PI3K</strong>: promotes growth and proliferation.</p><p><strong>TGFb</strong>: involved in development, homeostasis, and repair of most tissues.</p><p><strong>TNFa</strong>: mediates haematopoiesis, immune surveillance, tumour regression and protection from infection.</p><p><strong>Trail</strong><span>: in</span><span>duces apoptosis.</span></p><p><strong>VEGF</strong>: mediates angiogenesis, vascular permeability, and cell migration.</p><p><strong>WNT</strong>: regulates organ morphogenesis during development and tissue repair.</p></blockquote><p data-tool="mdnice编辑器">在后续几年内，Christian H. Holland 等人不断拓展PROGENy的使用范围，2019年将PROGENy拓展至小鼠的研究[2]。2020年PROGENy可支持单细胞转录数据的分析[3]。目前PROGENy的原始文献引用量已达154。这些信息表明，PROGENy还是较为被研究者们可以的。</p><p data-tool="mdnice编辑器"><img data-ratio="0.18309859154929578" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibiczT3BTIILXTyR6VsNkndlL5AcwINGCibUD6GcscWdn10xeA3n9AUwmd205YxKS1UMLQcYVhk3J6g/640?wx_fmt=png" data-type="png" data-w="1065" title="图1  Web of science 检索页面" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibiczT3BTIILXTyR6VsNkndlL5AcwINGCibUD6GcscWdn10xeA3n9AUwmd205YxKS1UMLQcYVhk3J6g/640?wx_fmt=png"><span>图1  Web of science 检索页面</span></p><blockquote data-tool="mdnice编辑器"><p>[1] Schubert M, Klinger B, Klünemann M, Sieber A, Uhlitz F, Sauer S, Garnett MJ, Blüthgen N, Saez-Rodriguez J. 2018. Perturbation-response genes reveal signaling footprints in cancer gene expression. <em>Nature Communications</em>: 10.1038/s41467-017-02391-6</p><p>[2] Holland CH, Szalai B, Saez-Rodriguez J. Transfer of regulatory knowledge from human to mouse for functional genomics analysis. Biochim Biophys Acta Gene Regul Mech. 2020;1863(6):194431. doi:10.1016/j.bbagrm.2019.194431</p><p>[3] Holland, C.H., Tanevski, J., Perales-Patón, J. et al. Robustness and applicability of transcription factor and pathway analysis tools on single-cell RNA-seq data. Genome Biol 21, 36 (2020). https://doi.org/10.1186/s13059-020-1949-z</p></blockquote><h1 data-tool="mdnice编辑器"><span></span>3. PROGENy安装及使用</h1><h2 data-tool="mdnice编辑器"><span> </span><span>3.1 安装</span><span></span><span> </span></h2><p data-tool="mdnice编辑器">截止到本文发布前，PROGENy存储在Bioconductor的版本已经是最新的v1.20版本，和github的版本是一致的。因此，可以通过Bioconductor进行安装，也可以通过github 安装。</p><pre data-tool="mdnice编辑器"><span></span><code><span>##通过Bioconductor安装</span><br><span>if</span> (!requireNamespace(<span>"BiocManager"</span>, quietly = <span>TRUE</span>))<br>    install.packages(<span>"BiocManager"</span>)<br><br>BiocManager::install(<span>"progeny"</span>)<br><br><span>## 通过github安装</span><br>devtools::install_github(<span>"saezlab/progeny"</span>)<br></code></pre><h2 data-tool="mdnice编辑器"><span> </span><span></span><span>3.2 使用</span><span></span><span> </span></h2><p data-tool="mdnice编辑器">一般而言，作者开发R包都希望其他研究者来使用他的软件，因此都会配套一个说明文档或者说使用文档，告诉我们这个新东西应该怎么去使用。在github 的描述页面会给说明文档的链接，或者就直接写在描述页面。如果存储在bioconductor ，网页中也会有相关的帮助文档链接地址。PROGENy的更新后的操作文档写的好像不是能够很好的理解。以下是Bioconductor（https://www.bioconductor.org/packages/release/bioc/vignettes/progeny/inst/doc/progeny.html）及github（https://github.com/saezlab/progeny/blob/master/vignettes/progeny.Rmd）上帮助文档提供的操作代码</p><pre data-tool="mdnice编辑器"><span></span><code><span>library</span>(progeny)<br><span>library</span>(ggplot2)<br><span>library</span>(dplyr)<br>model &lt;- progeny::model_human_full<br>head(model)<br><span>#&gt;       gene pathway      weight     p.value</span><br><span>#&gt; 1     RFC2    EGFR  1.47064662 0.001655275</span><br><span>#&gt; 2    ESRRA    EGFR  0.17858956 0.211837604</span><br><span>#&gt; 3   HNRNPK    EGFR  0.30669860 0.084560061</span><br><span>#&gt; 4     CBX6    EGFR -0.67550734 0.017641119</span><br><span>#&gt; 5   ASRGL1    EGFR -0.25232814 0.295429969</span><br><span>#&gt; 6 FLJ30679    MAPK -0.06047373 0.628461747</span><br><span># Get top 100 significant genes per pathway</span><br>model_100 &lt;- model %&gt;%<br>  group_by(pathway) %&gt;%<br>  slice_min(order_by = p.value, n = <span>200</span>)<br><br><span># Plot</span><br>ggplot(data=model_100, aes(x=weight, color=pathway, fill=pathway)) +<br>  geom_density() +<br>  theme(text = element_text(size=<span>12</span>)) +<br>  facet_wrap(~ pathway, scales=<span>'free'</span>) +<br>  xlab(<span>'scores'</span>) +<br>  ylab(<span>'densities'</span>) +<br>  theme_bw() +<br>  theme(legend.position = <span>"none"</span>)<br></code></pre><p data-tool="mdnice编辑器"><img data-ratio="0.5556844547563805" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibiczT3BTIILXTyR6VsNkndlSgkHml4T2rLbIgV3bfeqvGw4a4FZXkibRY1rwkpoicqE07mR0rzBacjA/640?wx_fmt=png" data-type="png" data-w="862" title="图2 帮助文档结果展示图" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibiczT3BTIILXTyR6VsNkndlSgkHml4T2rLbIgV3bfeqvGw4a4FZXkibRY1rwkpoicqE07mR0rzBacjA/640?wx_fmt=png"><span>图2 帮助文档结果展示图</span></p><p data-tool="mdnice编辑器">看这个文档，实际上看不大懂这个PROGENy到底应该怎么用的。Google检索发现以前也有人写过相关的操作流程，例如PROGENy 推断通路活性（https://www.jianshu.com/p/6e14680036ad）、单细胞之富集分析-6: PROGENY（https://www.jianshu.com/p/89491b688c80）。前者提供的操作链接已经不可用了， 后者的原始文档在目前的bioconductor/github 上也消失了。而检索较早版本的<code>bioconductor</code> progeny发现，在v1.4版本的说明文档链接还能看到后者的部分操作，但单细胞流程的部分直接丢失了网页，至少现在找不到了，PROGENy pathway signatures（https://www.bioconductor.org/packages/3.8/bioc/vignettes/progeny/inst/doc/progeny.html），而使用v1.4版本的说明文档又发现biomaRt的ID转换因为网络问题，也不大好用。而<code>browseVignettes</code>函数也不能调用<code>PROGENy</code>的demo 文档。基于此，本篇主要基于v1.20 附带的函数帮助文档结合前期的一些操作流程进行介绍。</p><pre data-tool="mdnice编辑器"><span></span><code>browseVignettes(<span>"progeny"</span>)<br><span>#&gt; No vignettes found by browseVignettes("progeny")</span><br></code></pre><h2 data-tool="mdnice编辑器"><span> </span><span></span><span>3.3  Bulk RNAseq数据分析</span><span></span><span> </span></h2><h3 data-tool="mdnice编辑器"><span></span>3.3.1 信号通路活性分析<span></span></h3><p data-tool="mdnice编辑器">相较于最初的版本，v1.20 已经附加了demo 的演示数据，因此，在本篇的演示文档中，我们只需要加载PROGENy包中附带的数据即可。如下：</p><pre data-tool="mdnice编辑器"><span></span><code><span>library</span>(progeny)<br><span>### 获取包内自带数据</span><br>gene_expression &lt;- as.matrix(read.csv(system.file(<span>"extdata"</span>,<br>                                                  <span>"human_input.csv"</span>, package = <span>"progeny"</span>), row.names = <span>1</span>))<br>head(gene_expression)<br><span>#&gt;         SRR1039508 SRR1039509 SRR1039512 SRR1039513 SRR1039516 SRR1039517 SRR1039520 SRR1039521</span><br><span>#&gt;  ANKRD37    7.108502   7.318073   6.501028   6.603712   6.550726   6.767772   6.720333   6.862744</span><br><span>#&gt;  ANKZF1     9.397687   9.637948   9.134391   9.405355   9.345567   9.548367   9.185797   9.405191</span><br><span>#&gt;  ATP6V1G2   5.302948   5.302948   5.302948   5.302948   5.302948   5.302948   5.302948   5.302948</span><br><span>#&gt;  BMP4      11.543845  12.103400  11.630489  11.380581  10.901069  11.171775  11.205271  11.235885</span><br><span>#&gt;  BMPR2     11.541010  11.537694  11.695743  11.653518  11.769146  11.893831  11.738505  11.764539</span><br><span>#&gt;  BNIP3L    12.847510  12.889814  12.882546  13.116758  12.923894  13.563225  12.734816  13.108777</span><br></code></pre><p data-tool="mdnice编辑器">Bulk RNAseq 的数据只需提供归一化之后的表达矩阵，以行为基因名，列为样本名即可，</p><pre data-tool="mdnice编辑器"><span></span><code><span># 计算通路活性</span><br>pathways &lt;- progeny(gene_expression, scale=<span>TRUE</span>,<br>                    organism=<span>"Human"</span>, <span>#如为小鼠，填 "Mouse"</span><br>                    top = <span>100</span>, perm = <span>1</span>)<br>head(pathways)[<span>1</span>:<span>5</span>,<span>1</span>:<span>5</span>]<br><span>#&gt;               Androgen       EGFR   Estrogen    Hypoxia    JAK-STAT</span><br><span>#&gt;  SRR1039508 -1.2111870 -0.2213137  0.9492413  0.4971532  1.70999798</span><br><span>#&gt;  SRR1039509  0.5193128 -1.1128063 -1.0750417 -0.0351343 -1.37369841</span><br><span>#&gt;  SRR1039512 -0.7562443 -0.1584680  0.7905036 -0.7592593  0.78242868</span><br><span>#&gt;  SRR1039513  0.9281783 -0.7618999 -1.0702726 -0.9091296  0.54820602</span><br><span>#&gt;  SRR1039516 -0.7653795  0.0702440  1.1708203 -0.6315846 -0.02282687</span><br></code></pre><p data-tool="mdnice编辑器">由此，得到了每个样本的各通路活性值，后续参考zip文件附带code，进一步处理。</p><pre data-tool="mdnice编辑器"><span></span><code>nrow(pathways) <br><span>#&gt; 8</span><br>controls =rep(c(<span>TRUE</span>,<span>FALSE</span>),<span>4</span>)<br>ctl_mean = apply(pathways[controls,], <span>2</span>, mean)<br>ctl_sd = apply(pathways[controls,], <span>2</span>, sd)<br>pathways = t(apply(pathways, <span>1</span>, <span>function</span>(x) x - ctl_mean))<br>pathways = apply(pathways, <span>1</span>, <span>function</span>(x) x / ctl_sd)<br><span>library</span>(pheatmap)<br>myColor = colorRampPalette(c(<span>"Darkblue"</span>, <span>"white"</span>,<span>"red"</span>))(<span>100</span>)<br>pheatmap(t(pathways),fontsize=<span>14</span>, show_rownames = <span>F</span>,<br>         color=myColor, main = <span>"PROGENy"</span>, angle_col = <span>45</span>, treeheight_col = <span>0</span>,  <br>         border_color = <span>NA</span>)<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.5162412993039444" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibiczT3BTIILXTyR6VsNkndloSLt2CP64wtRibycd14wKmvbzxyf1C2AT8ewv7AbqpfJvyicAgk7Y1Zw/640?wx_fmt=png" data-type="png" data-w="862" title="图3. Bulk RNAseq分组通路活性热图" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibiczT3BTIILXTyR6VsNkndloSLt2CP64wtRibycd14wKmvbzxyf1C2AT8ewv7AbqpfJvyicAgk7Y1Zw/640?wx_fmt=png"></figure><figure data-tool="mdnice编辑器"><span>图3. Bulk RNAseq分组通路活性热图</span></figure><h3 data-tool="mdnice编辑器"><span></span>3.3.2  两组间通路活性差异分析<span></span></h3><p data-tool="mdnice编辑器">在最初的版本的说明中，Bulk RNAseq的文档里面还提供了计算两组间通路活性差异的代码。<br>简单来说，按上述的demo文件共有8个样本，分成两组，一组为对照（<code>TRUE</code>），一组为实验组（<code>FALSE</code>），假如我要探究某个实验条件对样本的通路活性影响，我可以先计算各样本的通路活性，再利用下面的代码，找到差异最为明显的通路。</p><pre data-tool="mdnice编辑器"><span></span><code><span>library</span>(dplyr)<br>result = apply(pathways, <span>1</span>, <span>function</span>(x) {<br>    broom::tidy(lm(x ~ !controls)) %&gt;%<br>        filter(term == <span>"!controlsTRUE"</span>) %&gt;%<br>        dplyr::select(-term)<br>})<br>res_lm&lt;- mutate(bind_rows(result), pathway=names(result))<br>res_lm<br><span>#&gt;  # A tibble: 14 × 5</span><br><span>#&gt;     estimate std.error statistic    p.value pathway </span><br><span>#&gt;        &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt; &lt;chr&gt;   </span><br><span>#&gt;   1   8.45       0.962    8.79   0.000120   Androgen</span><br><span>#&gt;   2  -0.210      2.58    -0.0814 0.938      EGFR    </span><br><span>#&gt;   3 -10.0        0.719  -13.9    0.00000854 Estrogen</span><br><span>#&gt;   4   1.18       1.25     0.944  0.382      Hypoxia </span><br><span>#&gt;   5  -1.45       0.700   -2.07   0.0844     JAK-STAT</span><br><span>#&gt;   6   1.28       1.68     0.760  0.476      MAPK    </span><br><span>#&gt;   7   0.221      0.689    0.321  0.759      NFkB    </span><br><span>#&gt;   8  -5.43       0.960   -5.66   0.00130    p53     </span><br><span>#&gt;   9  -2.58       3.22    -0.798  0.455      PI3K    </span><br><span>#&gt;  10   2.80       0.878    3.19   0.0188     TGFb    </span><br><span>#&gt;  11   0.336      0.665    0.506  0.631      TNFa    </span><br><span>#&gt;  12   0.840      0.810    1.04   0.340      Trail   </span><br><span>#&gt;  13  -0.0104     0.648   -0.0160 0.988      VEGF    </span><br><span>#&gt;  14  -0.964      0.609   -1.58   0.164      WNT</span><br></code></pre><p data-tool="mdnice编辑器">结果显示，在实验组中 p53 在处理后确实不如处理前活跃。源文档没有提供可视化的方法，但我们可以自行用ggplot2画图.</p><pre data-tool="mdnice编辑器"><span></span><code><span>library</span>(ggplot2)<br>ggplot(as.data.frame(res_lm),aes(x=pathway,y=statistic))+<br>  geom_point(aes(size=-log10(p.value),color=pathway))+<br>  theme_bw()+ylim(c(-<span>15</span>,<span>10</span>))+<br>  scale_color_manual(values = paletteer::paletteer_d(<span>'ggsci::category20_d3'</span>,n=<span>14</span>))+<br>  ggplot2::coord_flip()+theme(legend.position = <span>'none'</span>)<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.9270833333333334" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibiczT3BTIILXTyR6VsNkndl8BnBrGibMqb6CWnUjamW8v2ibXxjKzGapnDhujaicYaTxBGuJHNfSpqKg/640?wx_fmt=png" data-type="png" data-w="480" title="图4. Bulk RNA-seq  通路活性分组差异分析后结果" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibiczT3BTIILXTyR6VsNkndl8BnBrGibMqb6CWnUjamW8v2ibXxjKzGapnDhujaicYaTxBGuJHNfSpqKg/640?wx_fmt=png"><figcaption><span>图4. Bulk RNA-seq  通路活性分组差异分析后结果</span></figcaption></figure><h3 data-tool="mdnice编辑器"><span></span>3.3.3 与药物作用相关性分析<span></span></h3><p data-tool="mdnice编辑器">在PROGENy以往的说明文档中，还提供了与药物作用的相关性分析，Code很简单，但需要一些数据自行下载。<br>本部分用到的数据存储在 the Genomics of Drug Sensitivity in Cancer（GDSC）数据库中，简单来说，通过分析细胞系基因表达及药物处理细胞后的表达谱变化，来推测药物的敏感性。这几个文件长什么样可以自己下载探索一下。</p><pre data-tool="mdnice编辑器"><span></span><code><span># set up a file cache so we download only once</span><br><span>library</span>(BiocFileCache)<br>bfc = BiocFileCache(<span>"."</span>)<br><span># gene expression and drug response</span><br>base = <span>"http://www.cancerrxgene.org/gdsc1000/GDSC1000_WebResources/Data/"</span><br>paths = bfcrpath(bfc, paste0(base, c(<span>"suppData/TableS4A.xlsx"</span>,<br>            <span>"preprocessed/Cell_line_RMA_proc_basalExp.txt.zip"</span>)))<br><span># load the downloaded files</span><br>drug_table &lt;- readxl::read_excel(paths[<span>1</span>], skip=<span>5</span>, na=<span>"NA"</span>)<br>drug_table &lt;- replace(drug_table, is.na(drug_table), <span>0</span>)<br>gene_table &lt;- readr::read_tsv(paths[<span>2</span>])<br><br><span># we need drug response with COSMIC IDs</span><br>drug_response &lt;- data.matrix(drug_table[,<span>3</span>:ncol(drug_table)])<br>rownames(drug_response) &lt;- drug_table[[<span>1</span>]]<br><br><span># we need genes in rows and samples in columns</span><br>gene_expr &lt;- data.matrix(gene_table[,<span>3</span>:ncol(gene_table)])<br>colnames(gene_expr) &lt;- sub(<span>"DATA."</span>, <span>""</span>, colnames(gene_expr), fixed=<span>TRUE</span>)<br>rownames(gene_expr) &lt;- gene_table$GENE_SYMBOLS<br></code></pre><p data-tool="mdnice编辑器">手动下载：<br>Processed gene expression matrix（http://www.cancerrxgene.org/gdsc1000/GDSC1000_WebResources/Data/preprocessed/Cell_line_RMA_proc_basalExp.txt.zip）<br>Drug sensitivities（http://www.cancerrxgene.org/gdsc1000/GDSC1000_WebResources/Data/suppData/TableS4A.xlsx）<br>随后进行PROGENy 运算：</p><pre data-tool="mdnice编辑器"><span></span><code><span>library</span>(progeny)<br>pathways &lt;- progeny(gene_expr,scale = <span>TRUE</span>, organism = <span>"Human"</span>, top = <span>100</span>,<br>    perm = <span>1</span>, verbose = <span>FALSE</span>)<br></code></pre><p data-tool="mdnice编辑器">可视化结果：</p><pre data-tool="mdnice编辑器"><span></span><code><span>library</span>(pheatmap)<br>myColor = colorRampPalette(c(<span>"Darkblue"</span>, <span>"white"</span>,<span>"red"</span>))(<span>100</span>)<br>pheatmap(pathways,fontsize=<span>14</span>, show_rownames = <span>FALSE</span>,<br>    color=myColor, main = <span>"PROGENy"</span>, angle_col = <span>45</span>, treeheight_col = <span>0</span>,  <br>    border_color = <span>NA</span>)<br></code></pre><p data-tool="mdnice编辑器"><img data-ratio="0.8694404591104734" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibiczT3BTIILXTyR6VsNkndljQ6UF4MYNrJTsF3g6I6bicVfKPulzf2LcicVDKuP7Y9YicyxX5PmTw7Ow/640?wx_fmt=png" data-type="png" data-w="697" title="图5  细胞系PROGENy 分析结果示意" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibiczT3BTIILXTyR6VsNkndljQ6UF4MYNrJTsF3g6I6bicVfKPulzf2LcicVDKuP7Y9YicyxX5PmTw7Ow/640?wx_fmt=png"><span>图5  细胞系PROGENy 分析结果示意</span></p><p data-tool="mdnice编辑器">假设这里我们要讨论<code>Trametinib</code>与<code>MAPK</code> 通路活性的相关性，我们可以先找到匹配的使用<code>Trametinib</code>处理的细胞及其对照组，再找到<code>MAPK</code>通路，随后进行一个相关性分析。</p><pre data-tool="mdnice编辑器"><span></span><code>cell_lines = intersect(rownames(pathways), rownames(drug_response))<br>trametinib = drug_response[cell_lines, <span>"Trametinib"</span>]<br><br>mapk = pathways[cell_lines, <span>"MAPK"</span>]<br><br>associations = lm(trametinib ~ mapk)<br>summary(associations)<br><span>#&gt; Call:</span><br><span>#&gt; lm(formula = trametinib ~ mapk)</span><br><br><span>#&gt; Residuals:</span><br><span>#&gt;    Min     1Q Median     3Q    Max </span><br><span>#&gt; -6.548 -1.255  0.338  1.338  6.819 </span><br><span>#&gt; </span><br><span>#&gt; Coefficients:</span><br><span>#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span><br><span>#&gt; (Intercept) -0.94703    0.06442  -14.70   &lt;2e-16 ***</span><br><span>#&gt; mapk        -1.35978    0.06449  -21.09   &lt;2e-16 ***</span><br><span>#&gt; ---</span><br><span>#&gt; Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span><br><br><span>#&gt; Residual standard error: 1.998 on 960 degrees of freedom</span><br><span>#&gt; Multiple R-squared:  0.3165,	Adjusted R-squared:  0.3158 </span><br><span>#&gt; F-statistic: 444.6 on 1 and 960 DF,  p-value: &lt; 2.2e-16</span><br></code></pre><p data-tool="mdnice编辑器">根据结果来看，我们发现 MAPK 活性与对 Trametinib 的敏感性密切相关：Pr(&gt;|t|)远小于阈值0.05。</p><h3 data-tool="mdnice编辑器"><span></span>4. Bulk RNAseq 小结<span></span></h3><p data-tool="mdnice编辑器">总体上而言，PROGENy 的操作方式很简单，只需要提供一个基因表达矩阵即可，其功能还是很强大的，提供的药物作用分析也可以用在数据挖掘相关的文章中，用以挖掘药物可能作用的靶点。在本篇简要介绍中，并没有过多描述他的算法原理，感兴趣的可以去看原文。对于当前的PROGENy bioconductor版本，初学者找到演示文档是比较困难的，可能由于其更新了新的文档之后将前次的文档覆盖，进而导致之前版本的文档。具体原因不做深究。下一篇推文继续简要介绍PROGENy在单细胞数据中的应用。</p><span>- END -</span></section><p><br></p><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/-UjKxtszsH7HxRe3Rjh7zg",target="_blank" rel="noopener noreferrer">原文链接</a>
