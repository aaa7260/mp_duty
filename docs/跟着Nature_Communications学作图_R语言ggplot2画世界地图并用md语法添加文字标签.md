---
title: "跟着Nature Communications学作图:R语言ggplot2画世界地图并用md语法添加文字标签"
date: 2022-09-13T14:53:41Z
draft: ["false"]
tags: [
  "fetched",
  "小明的数据分析笔记本"
]
categories: ["Acdemic"]
---
跟着Nature Communications学作图:R语言ggplot2画世界地图并用md语法添加文字标签 by 小明的数据分析笔记本
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-mpa-powered-by="yiban.io"><h2 data-tool="mdnice编辑器"><span></span><span>论文</span><span> </span></h2><blockquote data-tool="mdnice编辑器"><p>MiDAS 4: A global catalogue of full-length 16S rRNA gene sequences and taxonomy for studies of bacterial communities in wastewater treatment plants</p></blockquote><p data-tool="mdnice编辑器">https://www.nature.com/articles/s41467-022-29438-7</p><p data-tool="mdnice编辑器">数据链接</p><p data-tool="mdnice编辑器">https://figshare.com/articles/dataset/Dueholm2021a_data_zip/16566408/1</p><p data-tool="mdnice编辑器">代码链接</p><p data-tool="mdnice编辑器">https://github.com/msdueholm/MiDAS4</p><p data-tool="mdnice编辑器">今天的推文我们重复一下论文中的Figure1a 世界地图</p><figure data-tool="mdnice编辑器"><img data-ratio="0.5475806451612903" data-src="https://mmbiz.qpic.cn/mmbiz_png/t1wZDoUyFk7NRn2tMzQ8H72QqetrFcrwwSpqHQhTjGYLfLhvdxKJQBHiaKla8pswPKrVhf7PThSYXFQFyvIhEPQ/640?wx_fmt=png" data-type="png" data-w="1240" src="https://mmbiz.qpic.cn/mmbiz_png/t1wZDoUyFk7NRn2tMzQ8H72QqetrFcrwwSpqHQhTjGYLfLhvdxKJQBHiaKla8pswPKrVhf7PThSYXFQFyvIhEPQ/640?wx_fmt=png"><figcaption>image.png</figcaption></figure><p data-tool="mdnice编辑器">之前的推文介绍过世界地图添加采样地点</p><p data-tool="mdnice编辑器"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzI3NzQ3MTcxMg==&amp;mid=2247492663&amp;idx=1&amp;sn=2f1a14966d89aa38624525a05d8241e9&amp;chksm=eb676cb8dc10e5aec167d4d4dc42728a1087d3c0987d46252e53b4ec928907403726d869c153&amp;scene=21#wechat_redirect" textvalue="跟着Nature Communication学作图：R语言ggplot2画世界地图展示采样地点" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2">跟着Nature Communication学作图：R语言ggplot2画世界地图展示采样地点</a><br></p><h2 data-tool="mdnice编辑器"><span></span><span>首先是地图</span><span> </span></h2><p data-tool="mdnice编辑器">我这里就不画国家的边界了，本来是想添加每个洲的边界的，但是暂时没有找到办法，想到了再来介绍吧</p><pre data-tool="mdnice编辑器"><span></span><code>library(ggplot2)<br>world&lt;-map_data(<span>"world"</span>)<br>ggplot() +<br>  geom_polygon(data=world,aes(x=long,y=lat,group=group),<br>               fill=<span>"#dedede"</span>)+<br>  theme_bw()+<br>  scale_y_continuous(expand = expansion(mult=c(0,0)))+<br>  scale_x_continuous(expand = expansion(add=c(0,0))) -&gt; world.map<br><br>world.map<br><br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.8295557570262919" data-src="https://mmbiz.qpic.cn/mmbiz_png/t1wZDoUyFk7NRn2tMzQ8H72QqetrFcrwZibeJEUUkRYyMF33CHRMvHibMOSxSoQj7j3jvia2hHhKF1BTpdLl0gWUQ/640?wx_fmt=png" data-type="png" data-w="1103" src="https://mmbiz.qpic.cn/mmbiz_png/t1wZDoUyFk7NRn2tMzQ8H72QqetrFcrwZibeJEUUkRYyMF33CHRMvHibMOSxSoQj7j3jvia2hHhKF1BTpdLl0gWUQ/640?wx_fmt=png"><figcaption>image.png</figcaption></figure><p data-tool="mdnice编辑器">添加采样点</p><pre data-tool="mdnice编辑器"><span></span><code>df&lt;-read.csv(<span>"figure1df.csv"</span>)<br>world.map+<br>  geom_point(data = df,<br>             aes(x=Longitude, <br>                 y=Latitude, <br>                 colour = Process_type2), size=2)+<br>  scale_color_manual(values = c(<span>"#3373a5"</span>,<span>"#97b1c0"</span>,<br>                                         <span>"#f8ad63"</span>,<br>                                         <span>"#d8191a"</span>,<br>                                         <span>"#c4c4c4"</span>))<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.6654578422484134" data-src="https://mmbiz.qpic.cn/mmbiz_png/t1wZDoUyFk7NRn2tMzQ8H72QqetrFcrwRKzXyIeLyg2KnrzLDibIPSzuz3CraGR4I7Mic7b3eiaTgFHHyuWMTSAUw/640?wx_fmt=png" data-type="png" data-w="1103" src="https://mmbiz.qpic.cn/mmbiz_png/t1wZDoUyFk7NRn2tMzQ8H72QqetrFcrwRKzXyIeLyg2KnrzLDibIPSzuz3CraGR4I7Mic7b3eiaTgFHHyuWMTSAUw/640?wx_fmt=png"><figcaption>image.png</figcaption></figure><p data-tool="mdnice编辑器">添加文本标签</p><pre data-tool="mdnice编辑器"><span></span><code>library(ggtext)                                  <br>dftext&lt;-data.frame(<br>  x=c(-180,-150,-10,100,50,-50),<br>  y=c(40,-50,-50,-50,50,60),<br>  label=c(<span>"**North america**&lt;br&gt;3 countries&lt;br&gt;107 cities&lt;br&gt;145WWTPs"</span>,<br>          <span>"**South american**&lt;br&gt;2 countries&lt;br&gt;29 cities&lt;br&gt;38 WWTPs"</span>,<br>          3,4,5,6)<br>)<br>world.map01 +<br>  theme(legend.position = c(0.9,0.7),<br>        legend.background = element_rect(fill=<span>"transparent"</span>),<br>        legend.box.background = element_rect(color=<span>"gray"</span>,<br>                                             fill=<span>"transparent"</span>),<br>        legend.key = element_rect(fill=<span>"transparent"</span>))+<br>  geom_richtext(data=dftext,<br>                aes(x=x,y=y,label=label),<br>                nudge_x =0,hjust=0,<br>                fill=<span>"transparent"</span>)<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.42338709677419356" data-src="https://mmbiz.qpic.cn/mmbiz_png/t1wZDoUyFk7NRn2tMzQ8H72QqetrFcrwrAk7zHy8sf2icgNnWND3svSmYHU7SaGD2rKctetjaHCYAXuk2PtO96w/640?wx_fmt=png" data-type="png" data-w="1240" src="https://mmbiz.qpic.cn/mmbiz_png/t1wZDoUyFk7NRn2tMzQ8H72QqetrFcrwrAk7zHy8sf2icgNnWND3svSmYHU7SaGD2rKctetjaHCYAXuk2PtO96w/640?wx_fmt=png"><figcaption>image.png</figcaption></figure><blockquote data-tool="mdnice编辑器"><p>示例数据和代码可以直接到论文中去获取 或者给推文点赞，点击在看，然后留言获取</p></blockquote><p data-tool="mdnice编辑器">欢迎大家关注我的公众号</p><p data-tool="mdnice编辑器"><strong>小明的数据分析笔记本</strong></p><section><mp-common-profile data-pluginname="mpprofile" data-id="MzI3NzQ3MTcxMg==" data-headimg="http://mmbiz.qpic.cn/mmbiz_png/t1wZDoUyFk5t1sOnM0iabvBhnfIj5YpyqrMib0E1MGCd9ibcYxaOPZd0GWhQBDvK2BPEwsicQxd6y5MHLfphnwHnow/0?wx_fmt=png" data-nickname="小明的数据分析笔记本" data-alias="" data-signature="数据分析和数据可视化有意思的简单小例子~石榴研究生的笔记本" data-from="0" data-is_biz_ban="0"></mp-common-profile><br></section><blockquote data-tool="mdnice编辑器"><p>小明的数据分析笔记本 公众号 主要分享：1、R语言和python做数据分析和数据可视化的简单小例子；2、园艺植物相关转录组学、基因组学、群体遗传学文献阅读笔记；3、生物信息学入门学习资料及自己的学习笔记！</p></blockquote></section><p><br></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/FNW0EBq3YU-1QYRyVbazhQ",target="_blank" rel="noopener noreferrer">原文链接</a>
