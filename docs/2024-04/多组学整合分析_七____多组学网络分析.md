---
title: "多组学整合分析(七) ——多组学网络分析"
date: 2024-04-21T01:20:41Z
draft: ["false"]
tags: [
  "fetched",
  "生信益站"
]
categories: ["Acdemic"]
---
多组学整合分析(七) ——多组学网络分析 by 生信益站
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><figure data-tool="mdnice编辑器"><img data-imgfileid="100024964" data-ratio="0.278125" data-src="https://mmbiz.qpic.cn/sz_mmbiz_gif/mhoJzVKWSib8Ba68JbuzLpDXo1ib8kzsIIScIb0Nciazicqic4UwiczB0VI7SbA9gaE0coanh6tZK19CicNBibvaItYnaw/640?wx_fmt=gif&amp;from=appmsg" data-type="gif" data-w="640" src="https://mmbiz.qpic.cn/sz_mmbiz_gif/mhoJzVKWSib8Ba68JbuzLpDXo1ib8kzsIIScIb0Nciazicqic4UwiczB0VI7SbA9gaE0coanh6tZK19CicNBibvaItYnaw/640?wx_fmt=gif&amp;from=appmsg"></figure><p data-tool="mdnice编辑器"><code>生信益站，一点就有益</code>！<strong>祝友友们天天开心，月月发 CNS~</strong></p><section><mp-common-profile data-pluginname="mpprofile" data-id="MzU1NTk0MTUxMg==" data-headimg="http://mmbiz.qpic.cn/sz_mmbiz_png/mhoJzVKWSib8n88v0Cj6koLMO8nOuGacicngmJdb0zgmMpxaXYnrB7sjV5iar1cTzTDLsicoyNKrjic1Hgric41HObSQ/0?wx_fmt=png" data-nickname="生信益站" data-signature="生物信息或基因测序数据分析、软件算法、科研绘图、Python/Perl/R代码分享。" data-from="0"></mp-common-profile></section><hr data-tool="mdnice编辑器"><figure data-tool="mdnice编辑器"><img data-imgfileid="100024960" data-ratio="0.3768518518518518" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/mhoJzVKWSib8Ba68JbuzLpDXo1ib8kzsIIiccgICX8icJok75tYYt8QyJ1FVibkWATGbDTibYE3J9Udbyh4kQ7fCzQVg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/mhoJzVKWSib8Ba68JbuzLpDXo1ib8kzsIIiccgICX8icJok75tYYt8QyJ1FVibkWATGbDTibYE3J9Udbyh4kQ7fCzQVg/640?wx_fmt=png&amp;from=appmsg"><figcaption>设我为🌟星标，每天就能第一时间看到推送啦~</figcaption></figure><blockquote data-tool="mdnice编辑器"><span>❝</span><p>今天给大伙带来多组学整合分析（七）——<code>MetaNet：多组学网络分析</code>。</p></blockquote><h2 data-tool="mdnice编辑器"><span></span><span>MetaNet</span><span></span></h2><p data-tool="mdnice编辑器">MetaNet <strong>是一个针对组学数据的综合网络分析 R 包：</strong></p><ul data-tool="mdnice编辑器"><li><section><p>支持多组学数据的集成分析。</p></section></li><li><section><p>快速计算关联网络，通过并行计算加速大量分析。</p></section></li></ul><figure data-tool="mdnice编辑器"><img data-imgfileid="100024962" data-ratio="0.7138888888888889" data-type="png" data-w="1080" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/mhoJzVKWSib8Ba68JbuzLpDXo1ib8kzsIIML96gVIt0z6Htj5eicsEKiaibnI0dnMjoYGqial2QQdcYLtojLfdLsyjHA/640?wx_fmt=png&amp;from=appmsg" src="https://mmbiz.qpic.cn/sz_mmbiz_png/mhoJzVKWSib8Ba68JbuzLpDXo1ib8kzsIIML96gVIt0z6Htj5eicsEKiaibnI0dnMjoYGqial2QQdcYLtojLfdLsyjHA/640?wx_fmt=png&amp;from=appmsg"></figure><ul data-tool="mdnice编辑器"><li><section><p>处理更大的数据，每个组学中有超过 10,000 个节点。</p></section></li><li><section><p>为多组学网络提供各种布局算法以及与<code>其他软件（Gephi、Cytoscape、ggplot2）</code>的接口，易于可视化。</p></section></li><li><section><p>提供全面的拓扑指标计算，包括生态网络稳定性。</p></section></li></ul><h2 data-tool="mdnice编辑器"><span></span><span>安装</span><span></span></h2><p data-tool="mdnice编辑器">MetaNet 是一个全面的网络分析包，<strong>特别是在各种生物组学方面</strong>。</p><p data-tool="mdnice编辑器">有些功能 MetaNet 是依赖的 pcutils，所以还需要安装 pcutils。</p><p data-tool="mdnice编辑器">稳定版本可以从 CRAN 安装：</p><pre data-tool="mdnice编辑器"><span></span><code>install.packages(<span>"pcutils"</span>)<br>install.packages(<span>"MetaNet"</span>)<br></code></pre><p data-tool="mdnice编辑器">最新的开发版本可以在<code>https://github.com/Asa12138/MetaNet</code>找到：</p><pre data-tool="mdnice编辑器"><span></span><code>remotes::install_github(<span>"Asa12138/pcutils"</span>)<br>remotes::install_github(<span>"Asa12138/MetaNet"</span>, dependencies = <span>T</span>)<br></code></pre><p data-tool="mdnice编辑器">对于数据操作，作者建议使用 dplyr。</p><pre data-tool="mdnice编辑器"><span></span><code><span>library</span>(MetaNet)<br><span>library</span>(igraph)<br><br><span># ========data manipulation</span><br><span>library</span>(dplyr)<br><span>library</span>(pcutils)<br></code></pre><h2 data-tool="mdnice编辑器"><span></span><span>快速开始</span><span></span></h2><p data-tool="mdnice编辑器">这是整体的开发框架 MetaNet，包括<code>数据处理、网络构建、网络分析、网络可视化</code>等功能：</p><figure data-tool="mdnice编辑器"><img data-imgfileid="100024963" data-ratio="1.2268518518518519" data-type="png" data-w="1080" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/mhoJzVKWSib8Ba68JbuzLpDXo1ib8kzsIIRMR7LQJa5dAJSS5R4C29E3jQicpt0DJf8WZWuIldp6WibialUcK7JPicag/640?wx_fmt=png&amp;from=appmsg" src="https://mmbiz.qpic.cn/sz_mmbiz_png/mhoJzVKWSib8Ba68JbuzLpDXo1ib8kzsIIRMR7LQJa5dAJSS5R4C29E3jQicpt0DJf8WZWuIldp6WibialUcK7JPicag/640?wx_fmt=png&amp;from=appmsg"><figcaption>MetaNet整体开发框架</figcaption></figure><p data-tool="mdnice编辑器">简单地构建并绘制网络图，只需要使用<code>c_net_calculate()、c_net_build()、c_net_plot()</code>三个函数，简称<code>MetaNet三板斧</code>：</p><pre data-tool="mdnice编辑器"><span></span><code>data(<span>"otutab"</span>, package = <span>"pcutils"</span>)<br><br><span># Inter-species correlation coefficients were calculated after transposition</span><br>totu &lt;- t2(otutab[1:100, ])<br><br>cor &lt;- c_net_calculate(totu)<br>net &lt;- c_net_build(cor)<br>c_net_plot(net)<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100024961" data-ratio="0.7272727272727273" data-type="png" data-w="1056" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/mhoJzVKWSib8Ba68JbuzLpDXo1ib8kzsII6stzUFbVZWiaAgaz0maX15FPHHKdqXdo4gPBibybgPK27cFMjs5Ly9HQ/640?wx_fmt=png&amp;from=appmsg" src="https://mmbiz.qpic.cn/sz_mmbiz_png/mhoJzVKWSib8Ba68JbuzLpDXo1ib8kzsII6stzUFbVZWiaAgaz0maX15FPHHKdqXdo4gPBibybgPK27cFMjs5Ly9HQ/640?wx_fmt=png&amp;from=appmsg"></figure><h2 data-tool="mdnice编辑器"><span></span><span>多组学整合网络</span><span></span></h2><blockquote data-tool="mdnice编辑器"><span>❝</span><p>这里即将展示的是——转录组、代谢组、微生物 3 个组学的整合网络。</p></blockquote><h3 data-tool="mdnice编辑器"><span></span><span>基本网络</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code>data(<span>"multi_test"</span>, package = <span>"MetaNet"</span>)<br>data(<span>"c_net"</span>, package = <span>"MetaNet"</span>)<br><span># build a multi-network</span><br>multi1 &lt;- multi_net_build(list(Microbiome = micro, Metabolome = metab, Transcriptome = transc))<br><span># v_group is default, three different table</span><br><br>plot(multi1)<br><br><span># set vertex_class</span><br>multi1_with_anno &lt;- c_net_set(multi1, micro_g, metab_g, transc_g, vertex_class = c(<span>"Phylum"</span>, <span>"kingdom"</span>, <span>"type"</span>))<br><span># set vertex_size</span><br>multi1_with_anno &lt;- c_net_set(multi1_with_anno,<br>  data.frame(<span>"Abundance1"</span> = colSums(micro)),<br>  data.frame(<span>"Abundance2"</span> = colSums(metab)),<br>  data.frame(<span>"Abundance3"</span> = colSums(transc)),<br>  vertex_size = paste0(<span>"Abundance"</span>, <span>1</span>:<span>3</span>)<br>)<br><br>plot(multi1_with_anno)<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100024969" data-ratio="0.7272727272727273" data-type="png" data-w="1056" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/mhoJzVKWSib8Ba68JbuzLpDXo1ib8kzsIIZxiaEI1FPf6IbBwibNgicQtGWTJYpOia7DibBqSepYWolu5icuomdkhntaNw/640?wx_fmt=png&amp;from=appmsg" src="https://mmbiz.qpic.cn/sz_mmbiz_png/mhoJzVKWSib8Ba68JbuzLpDXo1ib8kzsIIZxiaEI1FPf6IbBwibNgicQtGWTJYpOia7DibBqSepYWolu5icuomdkhntaNw/640?wx_fmt=png&amp;from=appmsg"></figure><h3 data-tool="mdnice编辑器"><span></span><span>自定义网络</span><span></span></h3><p data-tool="mdnice编辑器">使用<code>c_net_plot()</code>注释来绘制网络并设置颜色、大小、宽度、图例等。</p><pre data-tool="mdnice编辑器"><span></span><code>c_net_plot(multi1_with_anno,<br>  labels_num = <span>5</span>, vertex.color = get_cols(<span>11</span>, <span>"col1"</span>), vertex_size_range = c(<span>3</span>, <span>10</span>), vertex.label.color = <span>"red"</span>,<br>  edge_width_range = c(<span>0.5</span>, <span>3</span>), edge.color = c(<span>"orange"</span>, <span>"green4"</span>), edge.curved = <span>0.5</span>,<br>  legend = <span>T</span>, legend_number = <span>T</span>, group_legend_order = c(<span>"Microbiome"</span>, <span>"Metabolome"</span>, <span>"Transcriptome"</span>),<br>  group_legend_title = c(<span>"Phylum"</span>, <span>"Metabolome"</span>, <span>"Transcriptome"</span>),<br>  edge_legend_title = <span>"Correlation"</span>, edge_legend_order = c(<span>"positive"</span>, <span>"negative"</span>),<br>  size_legend = <span>T</span>, size_legend_title = <span>"Abundance"</span>,<br>  width_legend = <span>T</span>, width_legend_title = <span>"abs(r)"</span>,<br>  lty_legend = <span>T</span>, lty_legend_title = <span>"Omics relationship"</span><br>)<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100024967" data-ratio="0.7138888888888889" data-type="png" data-w="1080" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/mhoJzVKWSib8Ba68JbuzLpDXo1ib8kzsIIML96gVIt0z6Htj5eicsEKiaibnI0dnMjoYGqial2QQdcYLtojLfdLsyjHA/640?wx_fmt=png&amp;from=appmsg" src="https://mmbiz.qpic.cn/sz_mmbiz_png/mhoJzVKWSib8Ba68JbuzLpDXo1ib8kzsIIML96gVIt0z6Htj5eicsEKiaibnI0dnMjoYGqial2QQdcYLtojLfdLsyjHA/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器"><code>params_list</code>是<code>c_net_plot()</code>中的一个特殊参数，它是一个包含参数的列表，用它来绘制一系列具有相同属性的网络非常方便。</p><pre data-tool="mdnice编辑器"><span></span><code>node_colors &lt;- setNames(get_cols(<span>9</span>, <span>"col1"</span>), unique(V(multi1_with_anno)$v_class))<br><br>params_list &lt;- list(<br>  labels_num = <span>5</span>,<br>  vertex.color = node_colors, vertex_size_range = c(<span>3</span>, <span>10</span>), vertex.label.color = <span>"red"</span>,<br>  edge_width_range = c(<span>0.5</span>, <span>3</span>), edge.color = c(<span>"orange"</span>, <span>"green4"</span>), edge.curved = <span>0.5</span>,<br>  legend = <span>T</span>, legend_number = <span>T</span>, group_legend_order = c(<span>"Microbiome"</span>, <span>"Metabolome"</span>, <span>"Transcriptome"</span>),<br>  group_legend_title = c(<span>"Phylum"</span>, <span>"Metabolome"</span>, <span>"Transcriptome"</span>),<br>  edge_legend_title = <span>"Correlation"</span>, edge_legend_order = c(<span>"positive"</span>, <span>"negative"</span>),<br>  size_legend = <span>T</span>, size_legend_title = <span>"Abundance"</span>,<br>  width_legend = <span>T</span>, width_legend_title = <span>"abs(r)"</span>,<br>  lty_legend = <span>T</span>, lty_legend_title = <span>"Omics relationship"</span><br>)<br><br>c_net_plot(multi1_with_anno, params_list = params_list)<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100024966" data-ratio="0.7138888888888889" data-type="png" data-w="1080" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/mhoJzVKWSib8Ba68JbuzLpDXo1ib8kzsIIML96gVIt0z6Htj5eicsEKiaibnI0dnMjoYGqial2QQdcYLtojLfdLsyjHA/640?wx_fmt=png&amp;from=appmsg" src="https://mmbiz.qpic.cn/sz_mmbiz_png/mhoJzVKWSib8Ba68JbuzLpDXo1ib8kzsIIML96gVIt0z6Htj5eicsEKiaibnI0dnMjoYGqial2QQdcYLtojLfdLsyjHA/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器"><code>网络过滤</code>：</p><pre data-tool="mdnice编辑器"><span></span><code><span># build another multi-network</span><br>multi1_with_anno2 &lt;- c_net_filter(multi1_with_anno, v_group %<span>in</span>% c(<span>"Microbiome"</span>, <span>"Metabolome"</span>)) %&gt;%<br>  c_net_filter(., e_class == <span>"intra"</span>, mode = <span>"e"</span>)<br>c_net_plot(multi1_with_anno2, params_list = params_list)<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100024968" data-ratio="0.7138888888888889" data-type="png" data-w="1080" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/mhoJzVKWSib8Ba68JbuzLpDXo1ib8kzsIIgAGrr8zG5AhgKOXGkdpLLrmT31AtbQT6NvcB29PZNChH8dlUqmMTiaQ/640?wx_fmt=png&amp;from=appmsg" src="https://mmbiz.qpic.cn/sz_mmbiz_png/mhoJzVKWSib8Ba68JbuzLpDXo1ib8kzsIIgAGrr8zG5AhgKOXGkdpLLrmT31AtbQT6NvcB29PZNChH8dlUqmMTiaQ/640?wx_fmt=png&amp;from=appmsg"></figure><h2 data-tool="mdnice编辑器"><span></span><span>更多案例</span><span></span></h2><p data-tool="mdnice编辑器">当然，MetaNet的<code>功能远不止于此</code>，更多的案例请参考教程：</p><ul data-tool="mdnice编辑器"><li><section>https://bookdown.org/Asa12138/metanet_book/</section></li></ul><hr data-tool="mdnice编辑器"><p data-tool="mdnice编辑器">OK，今天的分享到此为止。咱们明天见~</p><h2 data-tool="mdnice编辑器"><span></span><span>联系站长</span><span></span></h2><blockquote data-tool="mdnice编辑器"><span>❝</span><p>对<code>本篇文章有疑问</code>，或者有<code>科研服务需求</code>的友友可以在益站<code>发消息留言</code>，也欢迎各位童鞋<code>扫下面的二维码</code>加入我们的 <code>QQ</code> 交流群。</p></blockquote><figure data-tool="mdnice编辑器"><img data-imgfileid="100024970" data-ratio="0.7277777777777777" data-type="png" data-w="1080" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/mhoJzVKWSib8Ba68JbuzLpDXo1ib8kzsIIvY5tIuhu6yFCYdVhyyDeNkg8lkNuxySQh6KR1uXpLtwC65hVGQR2bQ/640?wx_fmt=png&amp;from=appmsg" src="https://mmbiz.qpic.cn/sz_mmbiz_png/mhoJzVKWSib8Ba68JbuzLpDXo1ib8kzsIIvY5tIuhu6yFCYdVhyyDeNkg8lkNuxySQh6KR1uXpLtwC65hVGQR2bQ/640?wx_fmt=png&amp;from=appmsg"><figcaption>科研服务</figcaption></figure><hr data-tool="mdnice编辑器"><figure data-tool="mdnice编辑器"><img data-imgfileid="100024974" data-ratio="1.5" data-type="jpeg" data-w="512" data-src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/mhoJzVKWSib8Ba68JbuzLpDXo1ib8kzsIIUWKxB55T5JAk7mKZkdX4ZlrsSZqDrPLLicWG7cNXkgPibxkSDBxCia3Mg/640?wx_fmt=jpeg&amp;from=appmsg" src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/mhoJzVKWSib8Ba68JbuzLpDXo1ib8kzsIIUWKxB55T5JAk7mKZkdX4ZlrsSZqDrPLLicWG7cNXkgPibxkSDBxCia3Mg/640?wx_fmt=jpeg&amp;from=appmsg"><figcaption>最新QQ群</figcaption></figure><hr data-tool="mdnice编辑器"><figure data-tool="mdnice编辑器"><img data-imgfileid="100024975" data-ratio="1" data-type="gif" data-w="240" data-src="https://mmbiz.qpic.cn/sz_mmbiz_gif/mhoJzVKWSib8Ba68JbuzLpDXo1ib8kzsIIfcUSaWFicIicXMFYxKG1OEEF186ib5lqr5KEuWeG6UOc5icqlk0R6Ebicnw/640?wx_fmt=gif&amp;from=appmsg" src="https://mmbiz.qpic.cn/sz_mmbiz_gif/mhoJzVKWSib8Ba68JbuzLpDXo1ib8kzsIIfcUSaWFicIicXMFYxKG1OEEF186ib5lqr5KEuWeG6UOc5icqlk0R6Ebicnw/640?wx_fmt=gif&amp;from=appmsg"><figcaption>您的<code>关注、点赞、在看、转发</code>是对益站最大的<code>鼓励和支持</code>哈</figcaption></figure><hr data-tool="mdnice编辑器"></section><section><mp-common-profile data-pluginname="mpprofile" data-id="MzU1NTk0MTUxMg==" data-headimg="http://mmbiz.qpic.cn/sz_mmbiz_png/mhoJzVKWSib8n88v0Cj6koLMO8nOuGacicngmJdb0zgmMpxaXYnrB7sjV5iar1cTzTDLsicoyNKrjic1Hgric41HObSQ/0?wx_fmt=png" data-nickname="生信益站" data-signature="生物信息或基因测序数据分析、软件算法、科研绘图、Python/Perl/R代码分享。" data-from="0"></mp-common-profile></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/Ee4UBh_wElIfc9rX7maixA",target="_blank" rel="noopener noreferrer">原文链接</a>
