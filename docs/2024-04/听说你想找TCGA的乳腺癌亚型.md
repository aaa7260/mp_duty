---
title: "听说你想找TCGA的乳腺癌亚型"
date: 2024-04-04T07:19:04Z
draft: ["false"]
tags: [
  "fetched",
  "生信星球"
]
categories: ["Acdemic"]
---
听说你想找TCGA的乳腺癌亚型 by 生信星球
------
<div><section data-mpa-powered-by="yiban.io"><br></section><section><span>‍</span></section><section><img data-ratio="1" data-src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHrDic8XGmJ0b7oibVJajb0emLBHSvuibGG49ooBgtaAibE3TNJ00iaHviaMtdIKQJfCwtUfuHicDImtSfIxg/640?wx_fmt=png" data-type="png" data-w="64" width="20px" data-imgfileid="100010583" src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHrDic8XGmJ0b7oibVJajb0emLBHSvuibGG49ooBgtaAibE3TNJ00iaHviaMtdIKQJfCwtUfuHicDImtSfIxg/640?wx_fmt=png"><img data-imgfileid="100010584" data-ratio="1" data-src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHrDic8XGmJ0b7oibVJajb0emLPukRHCbicy4pNKeEv9qd7aWSfsx7roib2od3xPrRPicw3a0kbn0uQ6JmQ/640?wx_fmt=png" data-type="png" data-w="64" width="20px" src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHrDic8XGmJ0b7oibVJajb0emLPukRHCbicy4pNKeEv9qd7aWSfsx7roib2od3xPrRPicw3a0kbn0uQ6JmQ/640?wx_fmt=png"><span> 今天是生信星球陪你的<span><strong>第936天</strong></span></span><img data-imgfileid="100010585" data-ratio="1" data-src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHrDic8XGmJ0b7oibVJajb0emLBHSvuibGG49ooBgtaAibE3TNJ00iaHviaMtdIKQJfCwtUfuHicDImtSfIxg/640?wx_fmt=png" data-type="png" data-w="64" width="20px" src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHrDic8XGmJ0b7oibVJajb0emLBHSvuibGG49ooBgtaAibE3TNJ00iaHviaMtdIKQJfCwtUfuHicDImtSfIxg/640?wx_fmt=png"></section><hr><section><span><span>   </span><span>大神一句话，菜鸟跑半年。我不是大神，但我可以缩短你走弯路的半年~</span></span></section><section><span>   就像歌儿唱的那样，如果你不知道该往哪儿走，就留在这学点生信好不好~</span></section><p><span>   这里有豆豆和花花的学习历程，从新手到进阶，生信路上有你有我！</span></p><p><br></p><section><section><h4><span><span> </span>0.需求</span></h4><p>想要查询TCGA里的乳腺癌每个样本是什么亚型，并选出LumA和LumB亚型的样本。</p><p>这个信息在xena网站上有现成的，如下：<br></p><figure><img data-imgfileid="100010593" data-ratio="0.5092592592592593" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/8oKPbJgbBHpe5KNEBTjicgEQvC7kgQB0CxwjuH6DOEvlXYwia8KvVunYM2ERo618vvGZzibdHxl45f8KfyiadwuynQ/640?wx_fmt=other&amp;from=appmsg" data-type="other" data-w="1080" title="" src="https://mmbiz.qpic.cn/mmbiz_jpg/8oKPbJgbBHpe5KNEBTjicgEQvC7kgQB0CxwjuH6DOEvlXYwia8KvVunYM2ERo618vvGZzibdHxl45f8KfyiadwuynQ/640?wx_fmt=other&amp;from=appmsg"><figcaption></figcaption></figure><br><figure><img data-imgfileid="100010592" data-ratio="0.48148148148148145" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/8oKPbJgbBHpe5KNEBTjicgEQvC7kgQB0Cp3JJCBgicBNHo0ic3uVZ3RBnvC7xw6x3thIt9STWXtKRDYQjmrkLUy3g/640?wx_fmt=other&amp;from=appmsg" data-type="other" data-w="1080" title="" src="https://mmbiz.qpic.cn/mmbiz_jpg/8oKPbJgbBHpe5KNEBTjicgEQvC7kgQB0Cp3JJCBgicBNHo0ic3uVZ3RBnvC7xw6x3thIt9STWXtKRDYQjmrkLUy3g/640?wx_fmt=other&amp;from=appmsg"><figcaption></figcaption></figure><br><figure><img data-imgfileid="100010591" data-ratio="0.362962962962963" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/8oKPbJgbBHpe5KNEBTjicgEQvC7kgQB0CsRGzxoMIIOOX1kvyEYHW3qictqx5r4ZOM4YDqicpf1qyjz05R9q6jbXA/640?wx_fmt=other&amp;from=appmsg" data-type="other" data-w="1080" title="" src="https://mmbiz.qpic.cn/mmbiz_jpg/8oKPbJgbBHpe5KNEBTjicgEQvC7kgQB0CsRGzxoMIIOOX1kvyEYHW3qictqx5r4ZOM4YDqicpf1qyjz05R9q6jbXA/640?wx_fmt=other&amp;from=appmsg"><figcaption></figcaption></figure><h4><span><span> </span>1.读取数据</span></h4><p>其实不光是BRCA，各种癌症的亚型都在这里</p><pre><code>rm(list = ls())<br>a = read.delim(<span>"TCGASubtype.20170308.tsv.gz"</span>)<br>head(a)<br><br><span>##          sampleID                         Subtype_mRNA</span><br><span>## 1 TCGA-OR-A5J1-01 steroid-phenotype-high+proliferation</span><br><span>## 2 TCGA-OR-A5J2-01 steroid-phenotype-high+proliferation</span><br><span>## 3 TCGA-OR-A5J3-01               steroid-phenotype-high</span><br><span>## 4 TCGA-OR-A5J4-01                                 &lt;NA&gt;</span><br><span>## 5 TCGA-OR-A5J5-01               steroid-phenotype-high</span><br><span>## 6 TCGA-OR-A5J6-01               steroid-phenotype-low </span><br><span>##     Subtype_DNAmeth Subtype_protein Subtype_miRNA Subtype_CNA</span><br><span>## 1         CIMP-high            &lt;NA&gt;       miRNA_1       Quiet</span><br><span>## 2          CIMP-low               1       miRNA_1       Noisy</span><br><span>## 3 CIMP-intermediate               3       miRNA_6 Chromosomal</span><br><span>## 4         CIMP-high            &lt;NA&gt;       miRNA_6 Chromosomal</span><br><span>## 5 CIMP-intermediate            &lt;NA&gt;       miRNA_2 Chromosomal</span><br><span>## 6          CIMP-low               2       miRNA_1       Noisy</span><br><span>##   Subtype_Integrative Subtype_other      Subtype_Selected</span><br><span>## 1                COC3           C1A         ACC.CIMP-high</span><br><span>## 2                COC3           C1A          ACC.CIMP-low</span><br><span>## 3                COC2           C1A ACC.CIMP-intermediate</span><br><span>## 4                &lt;NA&gt;          &lt;NA&gt;         ACC.CIMP-high</span><br><span>## 5                COC2           C1A ACC.CIMP-intermediate</span><br><span>## 6                COC1           C1B          ACC.CIMP-low</span><br></code></pre><h4><span><span> </span>2.选出BRCA样本</span></h4><pre><code><span>library</span>(stringr)<br>k = str_starts(a$Subtype_Selected,<span>"BRCA"</span>);table(k)<br><br><span>## k</span><br><span>## FALSE  TRUE </span><br><span>##  6516  1218</span><br><br>a = a[k,]<br>table(a$Subtype_mRNA)<br><br><span>## </span><br><span>##  Basal   Her2   LumA   LumB Normal </span><br><span>##    193     82    581    219    143</span><br></code></pre><p>可以看到各种亚型的样本数量统计</p><h4><span><span> </span>3.提取需要的亚型样本</span></h4><p>brca_exp.Rdata里面存放的是brca的表达矩阵。可以通过TCGAbiolinks下载得到。</p><pre><code><span># 表达矩阵</span><br>load(<span>"brca_exp.Rdata"</span>)<br>brca[<span>1</span>:<span>4</span>,<span>1</span>:<span>4</span>]<br><br><span>##                    TCGA-E2-A1L7-11A-33R-A144-07</span><br><span>## ENSG00000000003.15                         4209</span><br><span>## ENSG00000000005.6                            71</span><br><span>## ENSG00000000419.13                         1611</span><br><span>## ENSG00000000457.14                         1217</span><br><span>##                    TCGA-E2-A1L7-01A-11R-A144-07</span><br><span>## ENSG00000000003.15                         1689</span><br><span>## ENSG00000000005.6                            16</span><br><span>## ENSG00000000419.13                         1810</span><br><span>## ENSG00000000457.14                         1098</span><br><span>##                    TCGA-AR-A0U0-01A-11R-A109-07</span><br><span>## ENSG00000000003.15                         1590</span><br><span>## ENSG00000000005.6                             0</span><br><span>## ENSG00000000419.13                         2073</span><br><span>## ENSG00000000457.14                          889</span><br><span>##                    TCGA-BH-A28O-01A-11R-A22K-07</span><br><span>## ENSG00000000003.15                         4583</span><br><span>## ENSG00000000005.6                           135</span><br><span>## ENSG00000000419.13                         1531</span><br><span>## ENSG00000000457.14                         1445</span><br><br>head(colnames(brca))<br><br><span>## [1] "TCGA-E2-A1L7-11A-33R-A144-07"</span><br><span>## [2] "TCGA-E2-A1L7-01A-11R-A144-07"</span><br><span>## [3] "TCGA-AR-A0U0-01A-11R-A109-07"</span><br><span>## [4] "TCGA-BH-A28O-01A-11R-A22K-07"</span><br><span>## [5] "TCGA-A2-A0D4-01A-11R-A00Z-07"</span><br><span>## [6] "TCGA-E9-A1R4-01A-21R-A14D-07"</span><br><br><span># 缩短id</span><br>colnames(brca) = str_sub(colnames(brca),<span>1</span>,<span>15</span>)<br>rownames(a) = <span>NULL</span><br>a = tibble::column_to_rownames(a,<span>"sampleID"</span>)<br><span># 匹配两个表格的顺序</span><br>s = intersect(colnames(brca),rownames(a))<br>exp = brca[,s]<br>a = a[s,]<br><span># 提取</span><br>k1 = a$Subtype_mRNA %<span>in</span>% c(<span>"LumA"</span>,<span>"LumB"</span>);table(k1)<br><br><span>## k1</span><br><span>## FALSE  TRUE </span><br><span>##   415   800</span><br><br>a = a[k1,]<br>exp = exp[,k1]<br>exp[<span>1</span>:<span>4</span>,<span>1</span>:<span>4</span>]<br><br><span>##                    TCGA-E2-A1L7-01 TCGA-A2-A0D4-01</span><br><span>## ENSG00000000003.15            1689            1550</span><br><span>## ENSG00000000005.6               16              45</span><br><span>## ENSG00000000419.13            1810            2710</span><br><span>## ENSG00000000457.14            1098            2026</span><br><span>##                    TCGA-E9-A1R4-01 TCGA-AO-A1KQ-01</span><br><span>## ENSG00000000003.15             711             825</span><br><span>## ENSG00000000005.6               15               3</span><br><span>## ENSG00000000419.13            1943            2626</span><br><span>## ENSG00000000457.14            1285            1058</span></code></pre></section></section><section><blockquote><section><span>如果因为代码看不懂，而跟不上正文的节奏，可以来找我，相当于来一个新手保护期。我的课程都是循环开课。下一期的时间，点进去咨询微信咯</span><br></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU4NjU4ODQ2MQ==&amp;mid=2247494223&amp;idx=1&amp;sn=956c0412cf4235ad73269a1c219cd90c&amp;chksm=fdfba20dca8c2b1b8cfafefb05d6fa736f2f126c8883086f8963e9aafeb2af39791e2e56e254&amp;scene=21#wechat_redirect" textvalue="生信分析‍直播课程" linktype="text" imgurl="" imgdata="null" data-itemshowtype="11" tab="innerlink" data-linktype="2">生信分析直播课程</a></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU4NjU4ODQ2MQ==&amp;mid=2247494009&amp;idx=1&amp;sn=035d253f973f65c0d1069e515eec2ce8&amp;chksm=fdfba13bca8c282de5a9222a2ab8bc0caa2ddf60cab543c2181e6d4a90b553f4dcde5f154adf&amp;scene=21#wechat_redirect" textvalue="生信新手保护学习小组‍" linktype="text" imgurl="" imgdata="null" data-itemshowtype="11" tab="innerlink" data-linktype="2">生信新手保护学习小组</a><br></section></blockquote></section><section><section><br></section></section><section><br></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/COchTSuPINEjjP9mv2e4_w",target="_blank" rel="noopener noreferrer">原文链接</a>
