---
title: "R包推荐|gghighlight突出显示某组某个数据"
date: 2024-04-11T22:55:56Z
draft: ["false"]
tags: [
  "fetched",
  "生信七点半"
]
categories: ["Acdemic"]
---
R包推荐|gghighlight突出显示某组某个数据 by 生信七点半
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><h3 data-tool="mdnice编辑器"><span></span><span>R包准备</span><span></span></h3><p data-tool="mdnice编辑器">加载所需的包并设置默认<code>ggplot2</code>主题为<code>theme_bw()</code>：</p><pre data-tool="mdnice编辑器"><span data-remoteid="c1710225426354" data-cacheurl="https://files.mdnice.com/user/3441/876cad08-0422-409d-bb5a-08afec5da8ee.svg"></span><code><span>library</span>(tidyverse)<br><span>library</span>(gghighlight)<br>theme_set(theme_bw())<br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span>基础线图</span><span></span></h3><p data-tool="mdnice编辑器">创建一个展示每个月日平均温度变化的基础线图：</p><pre data-tool="mdnice编辑器"><span data-remoteid="c1710225426355" data-cacheurl="https://files.mdnice.com/user/3441/876cad08-0422-409d-bb5a-08afec5da8ee.svg"></span><code>p &lt;- ggplot(<br>  airquality,<br>  aes(Day, Temp, group = Month, color = factor(Month))<br>  ) +<br>  geom_line() +<br>  scale_color_viridis_d() +<br>  labs(x = <span>"Day of Month"</span>, y = <span>"Temperature"</span>) +<br>  theme(legend.position = <span>"top"</span>)<br>p<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100005123" data-ratio="0.7" data-src="https://mmbiz.qpic.cn/mmbiz_png/owuibmRdV9s9l90C2SN4ibDToKuRKMZ3hKA8n78vESzvyaoia1qjDnEZ3YZzBDGb1GjAdGULiaRBMvTBqWe5sADb0g/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="960" src="https://mmbiz.qpic.cn/mmbiz_png/owuibmRdV9s9l90C2SN4ibDToKuRKMZ3hKA8n78vESzvyaoia1qjDnEZ3YZzBDGb1GjAdGULiaRBMvTBqWe5sADb0g/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器">这段代码使用<code>ggplot</code>函数设置了图表的数据源和美学映射，<code>aes</code>函数中的<code>Day</code>和<code>Temp</code>分别设置为x轴和y轴，<code>group</code>和<code>color</code>按照<code>Month</code>进行分组和着色。<code>geom_line()</code>添加了线图层，<code>scale_color_viridis_d()</code>使用了<code>viridis</code>颜色方案美化图表。<code>labs</code>和<code>theme</code>函数分别用于设置轴标签和图例位置。</p><h3 data-tool="mdnice编辑器"><span></span><span>突出显示特定线条</span><span></span></h3><p data-tool="mdnice编辑器">接下来，我们将突出显示那些最大温度值大于93的线条：</p><pre data-tool="mdnice编辑器"><span data-remoteid="c1710225426356" data-cacheurl="https://files.mdnice.com/user/3441/876cad08-0422-409d-bb5a-08afec5da8ee.svg"></span><code>p + gghighlight(max(Temp) &gt; <span>93</span>, label_key = Month)<br></code></pre><p data-tool="mdnice编辑器">这段代码通过<code>gghighlight</code>函数添加了一个高亮效果，<code>max(Temp) &gt; 93</code>用于指定突出显示的条件，即温度的最大值大于93。<code>label_key = Month</code>参数确保图例正确显示月份信息。</p><figure data-tool="mdnice编辑器"><img data-imgfileid="100005124" data-ratio="0.7" data-src="https://mmbiz.qpic.cn/mmbiz_png/owuibmRdV9s9l90C2SN4ibDToKuRKMZ3hKicXfYs3RgZP9zQKj7PEaPtBAOF2FyMutxIVfQsMeQZ4ftBicd6Hxd64A/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="960" src="https://mmbiz.qpic.cn/mmbiz_png/owuibmRdV9s9l90C2SN4ibDToKuRKMZ3hKicXfYs3RgZP9zQKj7PEaPtBAOF2FyMutxIVfQsMeQZ4ftBicd6Hxd64A/640?wx_fmt=png&amp;from=appmsg"></figure><h3 data-tool="mdnice编辑器"><span></span><span>直方图</span><span></span></h3><p data-tool="mdnice编辑器">我们将使用<code>iris</code>数据集创建一个直方图，展示不同物种的花萼长度分布，并使用<code>facet_wrap</code>按物种分面展示：</p><pre data-tool="mdnice编辑器"><span data-remoteid="c1710225426357" data-cacheurl="https://files.mdnice.com/user/3441/876cad08-0422-409d-bb5a-08afec5da8ee.svg"></span><code>ggplot(iris, aes(Sepal.Length, fill = Species)) +<br>  geom_histogram(bins = <span>30</span>) +<br>  scale_fill_viridis_d() +<br>  gghighlight() + <br>  facet_wrap(~ Species)<br></code></pre><p data-tool="mdnice编辑器">在这个直方图中，我们使用<code>geom_histogram(bins = 30)</code>来绘制花萼长度的分布，其中<code>bins = 30</code>用于指定直方图的柱状体数量。<code>scale_fill_viridis_d()</code>应用了<code>viridis</code>颜色方案，按照<code>Species</code>物种不同着色。<code>gghighlight()</code>函数默认会高亮所有数据，这里我们没有指定高亮条件，因为它在分面展示中用于突出显示每个分面内的分布。<code>facet_wrap(~ Species)</code>按照<code>Species</code>物种进行分面展示。</p><figure data-tool="mdnice编辑器"><img data-imgfileid="100005125" data-ratio="0.6666666666666666" data-src="https://mmbiz.qpic.cn/mmbiz_png/owuibmRdV9s9l90C2SN4ibDToKuRKMZ3hK3StPPgQ3aZIj7vKiamFu3ESKUOPuoP9LZiazCKUTSnLPPEuAkxYawcfA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/owuibmRdV9s9l90C2SN4ibDToKuRKMZ3hK3StPPgQ3aZIj7vKiamFu3ESKUOPuoP9LZiazCKUTSnLPPEuAkxYawcfA/640?wx_fmt=png&amp;from=appmsg"></figure><h3 data-tool="mdnice编辑器"><span></span><span>散点图</span><span></span></h3><p data-tool="mdnice编辑器">接下来，我们使用<code>mtcars</code>数据集创建一个散点图，展示汽车的<code>mpg</code>(每加仑英里数)和<code>disp</code>(发动机排量)之间的关系，并突出显示排量在350到400之间的汽车：</p><pre data-tool="mdnice编辑器"><span data-remoteid="c1710225426358" data-cacheurl="https://files.mdnice.com/user/3441/876cad08-0422-409d-bb5a-08afec5da8ee.svg"></span><code>df &lt;- mtcars %&gt;% mutate(name = row.names(.))<br>df %&gt;% <br>  ggplot(aes(mpg, disp)) +<br>  geom_point(col = <span>"darkred"</span>) +<br>  gghighlight(disp &gt; <span>350</span> &amp; disp &lt;= <span>400</span>,<br>              unhighlighted_colour = alpha(<span>"steelblue"</span>, <span>0.4</span>),<br>              use_direct_label = <span>TRUE</span>,<br>              label_key = name,<br>              label_params = list(size = <span>5</span>)) +<br>  geom_point(col = <span>"darkred"</span>, size = <span>2.5</span>)<br></code></pre><p data-tool="mdnice编辑器">在这个散点图中，我们首先对<code>mtcars</code>数据集添加了一个名为<code>name</code>的列，用于存储每行的行名。<code>ggplot(aes(mpg, disp))</code>设置了<code>mpg</code>作为x轴，<code>disp</code>作为y轴。<code>geom_point(col = "darkred")</code>添加了散点图层，点的颜色为深红色。<code>gghighlight(disp &gt; 350 &amp; disp &lt;= 400,...)</code>突出显示排量在350到400之间的汽车，并通过<code>label_key = name</code>添加每辆车的名称作为直接标签。<code>unhighlighted_colour</code>设置了未突出显示点的颜色和透明度。再次使用<code>geom_point</code>加强突出显示的点的视觉效果，使其更加明显。</p><p data-tool="mdnice编辑器"><img data-imgfileid="100005126" data-ratio="1" data-src="https://mmbiz.qpic.cn/mmbiz_png/owuibmRdV9s9l90C2SN4ibDToKuRKMZ3hKmWdgEJVObaQy6eVFXZJOushRDLPXYic04jXmzc8Kxvyzzb4ysic12ujg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="768" src="https://mmbiz.qpic.cn/mmbiz_png/owuibmRdV9s9l90C2SN4ibDToKuRKMZ3hKmWdgEJVObaQy6eVFXZJOushRDLPXYic04jXmzc8Kxvyzzb4ysic12ujg/640?wx_fmt=png&amp;from=appmsg">为了创建一个柱状图（条形图）来展示<code>mtcars</code>数据集中每辆车的<code>mpg</code>（每加仑英里数），并且突出显示<code>mpg</code>大于25的车辆，我们可以使用以下代码：</p><pre data-tool="mdnice编辑器"><span data-remoteid="c1710225426359" data-cacheurl="https://files.mdnice.com/user/3441/876cad08-0422-409d-bb5a-08afec5da8ee.svg"></span><code>ggplot(df, aes(name, mpg)) +<br>  geom_col() +<br>  theme(axis.text.x = element_text(angle = <span>45</span>, hjust = <span>1</span>)) +<br>  gghighlight(mpg &gt; <span>25</span>)<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100005127" data-ratio="0.6666666666666666" data-src="https://mmbiz.qpic.cn/mmbiz_png/owuibmRdV9s9l90C2SN4ibDToKuRKMZ3hKsHRU6ib51CHkqcBxSJw5z9zqeVAhoLdwGiayJqWia8xcD9HFSTeGJHBEg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/owuibmRdV9s9l90C2SN4ibDToKuRKMZ3hKsHRU6ib51CHkqcBxSJw5z9zqeVAhoLdwGiayJqWia8xcD9HFSTeGJHBEg/640?wx_fmt=png&amp;from=appmsg"></figure><ul data-tool="mdnice编辑器"><li><section><code>ggplot(df, aes(name, mpg))</code>：设置数据源为<code>df</code>（之前已经通过<code>mtcars</code>数据集创建并增加了一个<code>name</code>列），并指定x轴为车辆名称<code>name</code>，y轴为每加仑英里数<code>mpg</code>。</section></li><li><section><code>geom_col()</code>：添加柱状图层，用于绘制每辆车的<code>mpg</code>值。<code>geom_col</code>默认使用<code>aes</code>中指定的y值高度绘制柱体，x轴显示分类。</section></li><li><section><code>theme(axis.text.x = element_text(angle = 45, hjust = 1))</code>：调整x轴文本的显示样式，将文本角度设置为45度并调整水平对齐方式为1（右对齐），以便于阅读斜着的车辆名称。</section></li><li><section><code>gghighlight(mpg &gt; 25)</code>：应用<code>gghighlight</code>函数突出显示<code>mpg</code>大于25的车辆。这样，满足条件的车辆会以默认高亮颜色突出显示，而其他车辆则会以更淡的颜色显示，从而直观地识别出哪些车辆的燃油效率较高。</section></li></ul></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/FpuOUc1hJRLfweYu-riBlw",target="_blank" rel="noopener noreferrer">原文链接</a>
