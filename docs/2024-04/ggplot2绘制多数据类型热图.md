---
title: "ggplot2绘制多数据类型热图"
date: 2024-04-02T05:28:09Z
draft: ["false"]
tags: [
  "fetched",
  "R语言数据分析指南"
]
categories: ["Acdemic"]
---
ggplot2绘制多数据类型热图 by R语言数据分析指南
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><h3 data-tool="mdnice编辑器"><span></span><span><span></span>欢迎关注R语言数据分析指南</span><span></span></h3><blockquote data-tool="mdnice编辑器"><span>❝</span><p>本节继续来绘制NC上的一张图表，离散型与连续型数据组合而成的热图，<strong>「图形看起来也是比较简单，细节也是要调节一番」</strong>，数据为论文源数据，小编进行了图形绘制与原文图有出入，整个过程仅参考。希望对各位观众老爷能有所帮助。<strong>「数据代码+注释文档会整合上传到会员交流群」</strong>，有需要的朋友可关注文末介绍购买交流群。</p><span>❞</span></blockquote><figure data-tool="mdnice编辑器"><img data-imgfileid="100027118" data-ratio="0.4666666666666667" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAab87lMkBAcC2eyhHdNLPoeowNQQra8RgG1e2te84fMRhqyfLqhAON5E9oJUZ28dqhma2CIc3IveQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAab87lMkBAcC2eyhHdNLPoeowNQQra8RgG1e2te84fMRhqyfLqhAON5E9oJUZ28dqhma2CIc3IveQ/640?wx_fmt=png&amp;from=appmsg"></figure><h3 data-tool="mdnice编辑器"><span></span><span><span></span>最终结果</span><span></span></h3><figure data-tool="mdnice编辑器"><img data-imgfileid="100027116" data-ratio="1.4223541048466863" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAab87lMkBAcC2eyhHdNLPoed69DFpEA1r9u2d5b200QX8a2RpWgbUmozibR4JeYRzySlSrdu3j1pIQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1011" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAab87lMkBAcC2eyhHdNLPoed69DFpEA1r9u2d5b200QX8a2RpWgbUmozibR4JeYRzySlSrdu3j1pIQ/640?wx_fmt=png&amp;from=appmsg"></figure><blockquote data-tool="mdnice编辑器"><span>❝</span><p>给予长期支持我们的读者们一个特别待遇：购买小编VIP会员文档的读者，<strong>「将自动获得2024年及以后更新的绘图文档代码，无需额外付费」</strong>。目前会员文档(2023+2024)<strong>「已经更新上传了150+案例文档」</strong>，每个案例都附有相应的数据和代码，并配有对应的注释文档，方便大家学习和参考。有需要的朋友欢迎到小编的<strong>「淘宝店铺-R语言数据分析指南」</strong>下单购买<strong>「R数据可视化案例文档」</strong>持续更新中</p><span>❞</span></blockquote><p data-tool="mdnice编辑器"><strong>「2024更新的绘图内容同时包含数据+代码+markdown注释文档+文档清单」</strong></p><h3 data-tool="mdnice编辑器"><span></span><span><span></span>淘宝店铺</span><span></span></h3><p><img data-galleryid="" data-imgfileid="100019415" data-ratio="1.0210420841683367" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/EibnicgwScTAbvhPDLGT8NaialEsht92PTYNJWpmVLfoYGic1uha5FyBrDCibibZCLjiazgvpT1XcdwibfVywD2el0VAgg/640?wx_fmt=jpeg" data-type="jpeg" data-w="998" src="https://mmbiz.qpic.cn/mmbiz_jpg/EibnicgwScTAbvhPDLGT8NaialEsht92PTYNJWpmVLfoYGic1uha5FyBrDCibibZCLjiazgvpT1XcdwibfVywD2el0VAgg/640?wx_fmt=jpeg"></p><figure data-tool="mdnice编辑器"><img data-imgfileid="100027119" data-ratio="0.6175925925925926" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAab87lMkBAcC2eyhHdNLPoeHDVo0K0Mt78M0LgmBcy1mqxUpqb5Wx4YicSeNcgtXvH6u8eNsTgPJxQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAab87lMkBAcC2eyhHdNLPoeHDVo0K0Mt78M0LgmBcy1mqxUpqb5Wx4YicSeNcgtXvH6u8eNsTgPJxQ/640?wx_fmt=png&amp;from=appmsg"></figure><h3 data-tool="mdnice编辑器"><span></span><span><span></span>2024年更新案例</span><span></span></h3><p data-tool="mdnice编辑器"><img data-imgfileid="100027115" data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAab87lMkBAcC2eyhHdNLPoeLIQzicXHmrQly8Xs3U7UqMlma9NXUjiax0zXb3icNKZHicphPCHUBIoFaA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAab87lMkBAcC2eyhHdNLPoeLIQzicXHmrQly8Xs3U7UqMlma9NXUjiax0zXb3icNKZHicphPCHUBIoFaA/640?wx_fmt=png&amp;from=appmsg"><img data-imgfileid="100027117" data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAab87lMkBAcC2eyhHdNLPoeuYG1krSbao7AxUmrss6UNAYBwaickiagy3jC2tg1j2RaYuwg0pR1VC9w/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAab87lMkBAcC2eyhHdNLPoeuYG1krSbao7AxUmrss6UNAYBwaickiagy3jC2tg1j2RaYuwg0pR1VC9w/640?wx_fmt=png&amp;from=appmsg"><img data-imgfileid="100027123" data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAab87lMkBAcC2eyhHdNLPoeib9SYk9Ta8RPOPKwLIuvRI57WKcoq4UKW2LM63DJMWLZ4fR2gHSicYwA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAab87lMkBAcC2eyhHdNLPoeib9SYk9Ta8RPOPKwLIuvRI57WKcoq4UKW2LM63DJMWLZ4fR2gHSicYwA/640?wx_fmt=png&amp;from=appmsg"><img data-imgfileid="100027120" data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAab87lMkBAcC2eyhHdNLPoeZ6jOlHwXveCm6s7zdqAI95yhXHWUgwhQVy0ZnSRpaibIYvmkkDl1Zlg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAab87lMkBAcC2eyhHdNLPoeZ6jOlHwXveCm6s7zdqAI95yhXHWUgwhQVy0ZnSRpaibIYvmkkDl1Zlg/640?wx_fmt=png&amp;from=appmsg"><img data-imgfileid="100027121" data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAab87lMkBAcC2eyhHdNLPoeFUZgT30IvwticPDia8a0QcGejQITjLuSMSWxlyEYpLd8sqnMnanWNjag/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAab87lMkBAcC2eyhHdNLPoeFUZgT30IvwticPDia8a0QcGejQITjLuSMSWxlyEYpLd8sqnMnanWNjag/640?wx_fmt=png&amp;from=appmsg"><img data-imgfileid="100027122" data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAab87lMkBAcC2eyhHdNLPoeAibba5L19Rfg4Y9fwaR3Xg0rCcpArKlEmnmdURAwtUficAWAJLU0ZxWw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAab87lMkBAcC2eyhHdNLPoeAibba5L19Rfg4Y9fwaR3Xg0rCcpArKlEmnmdURAwtUficAWAJLU0ZxWw/640?wx_fmt=png&amp;from=appmsg"><img data-imgfileid="100027124" data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAab87lMkBAcC2eyhHdNLPoeDK2VhjEBZkiaB1cmib5cQhj5IQSQGicyR7BgkfjBLrrISHlD7mC6r7IWA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAab87lMkBAcC2eyhHdNLPoeDK2VhjEBZkiaB1cmib5cQhj5IQSQGicyR7BgkfjBLrrISHlD7mC6r7IWA/640?wx_fmt=png&amp;from=appmsg"><img data-imgfileid="100027127" data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAab87lMkBAcC2eyhHdNLPoeqySzlIIvQ4b3qn8lAgGWiaPZnz9C1bsWTNgM0WKQx6fTiaJ5UZbjMn6A/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAab87lMkBAcC2eyhHdNLPoeqySzlIIvQ4b3qn8lAgGWiaPZnz9C1bsWTNgM0WKQx6fTiaJ5UZbjMn6A/640?wx_fmt=png&amp;from=appmsg"><img data-imgfileid="100027128" data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAab87lMkBAcC2eyhHdNLPoeX4RK5XdIlnE9qqibRrofTEhXepMhW1Msux9Q3WFIaFrPjflc4XcciaFw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAab87lMkBAcC2eyhHdNLPoeX4RK5XdIlnE9qqibRrofTEhXepMhW1Msux9Q3WFIaFrPjflc4XcciaFw/640?wx_fmt=png&amp;from=appmsg"><img data-imgfileid="100027126" data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAab87lMkBAcC2eyhHdNLPoe9SQVP2AGKS2ibhaNU2weM2oTVTQkQuRpeU6aWCh4eC9IpTKUTMbZaTw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAab87lMkBAcC2eyhHdNLPoe9SQVP2AGKS2ibhaNU2weM2oTVTQkQuRpeU6aWCh4eC9IpTKUTMbZaTw/640?wx_fmt=png&amp;from=appmsg"><img data-imgfileid="100027129" data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAab87lMkBAcC2eyhHdNLPoeibPCSxWrDj3Flyz0ZJZ3GrTc05vsibP7BGuTUCMic5VmQUByLhKW8hg8w/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAab87lMkBAcC2eyhHdNLPoeibPCSxWrDj3Flyz0ZJZ3GrTc05vsibP7BGuTUCMic5VmQUByLhKW8hg8w/640?wx_fmt=png&amp;from=appmsg"></p><pre data-tool="mdnice编辑器"><span></span><code><span>library</span>(tidyverse)<br><span>library</span>(ggnewscale)<br><span>library</span>(MetBrewer)<br><span>library</span>(patchwork)<br><span>library</span>(ggtext)<br><br>df &lt;- read_tsv(<span>"data.xls"</span>) %&gt;% <br>  select(where(is.character)) %&gt;%<br>  pivot_longer(-sample.ID)<br><br>df$sample &lt;- factor(df$sample.ID,levels = df$sample.ID %&gt;% unique())<br>df$name &lt;- factor(df$name,levels = df$name %&gt;% unique() %&gt;% rev())<br><br>p2 &lt;- df %&gt;% ggplot(aes(x=sample.ID,y=name))+<br>  geom_tile(data=df5,color=<span>"black"</span>,<br>            aes(fill=`median centered&lt;br&gt;log-transformed FPKM`))+<br>  scale_fill_gradientn(colors=met.brewer(<span>"Cassatt1"</span>),na.value = <span>NA</span>)+<br>  new_scale_fill()+<br>  labs(x=<span>NULL</span>,y=<span>NULL</span>)+<br>  theme(axis.text.x = element_blank(),<br>        axis.text.y=element_text(color=<span>"black"</span>),<br>        legend.position = c(<span>1.35</span>,<span>0.12</span>),<br>        legend.direction = <span>"vertical"</span>,<br>        plot.margin=unit(c(-<span>20</span>,<span>1</span>,<span>0.5</span>,<span>0.5</span>),unit=<span>"cm"</span>),<br>        plot.background = element_blank(),<br>        panel.background = element_blank(),<br>        axis.ticks = element_blank(),<br>        legend.title =element_markdown(),<br>        legend.text = element_text(color=<span>"black"</span>))<br><br>plot &lt;- p1/p2+plot_layout(heights = c(<span>0.2</span>,<span>2</span>))<br><br>ggsave(plot,file=<span>"heatmap.pdf"</span>,dpi=<span>300</span>,width =<span>5.85</span> ,height=<span>8.32</span>)<br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span><span></span>关注下方公众号下回更新不迷路</span><span></span></h3><section><mp-common-profile data-pluginname="mpprofile" data-id="Mzg3MzQzNTYzMw==" data-headimg="http://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZF0rpeZII9Ltl26VbVagriczTria1fib3XgjwwHEHFjPzkmGpqWDVVHBSzhENictUM2iavAKiaM5lc9USw/0?wx_fmt=png" data-nickname="R语言数据分析指南" data-alias="YanJANtwo" data-signature="R语言重症爱好者，喜欢绘制各种精美的图表，喜欢的小伙伴可以关注我，跟我一起学习" data-from="0" data-is_biz_ban="0"></mp-common-profile></section></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/KxDuM92yvgaXQpn6N7mcXw",target="_blank" rel="noopener noreferrer">原文链接</a>
