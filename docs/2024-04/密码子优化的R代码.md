---
title: "密码子优化的R代码"
date: 2024-04-15T22:59:53Z
draft: ["false"]
tags: [
  "fetched",
  "东林的扯淡小屋"
]
categories: ["Acdemic"]
---
密码子优化的R代码 by 东林的扯淡小屋
------
<div><p><img data-galleryid="" data-imgfileid="100025866" data-ratio="1.0140712945590995" data-s="300,640" data-type="png" data-w="1066" data-src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBpUfbia1SaX0BiaJrf8HoAj4W5FCW0X7iaPfGOic9y96gWwjrCHqn3NmaRiao9c3ytHCibH6mJ5y4ibO5wPg/640?wx_fmt=png&amp;from=appmsg" src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBpUfbia1SaX0BiaJrf8HoAj4W5FCW0X7iaPfGOic9y96gWwjrCHqn3NmaRiao9c3ytHCibH6mJ5y4ibO5wPg/640?wx_fmt=png&amp;from=appmsg"></p><p><img data-galleryid="" data-imgfileid="100025868" data-ratio="0.8532423208191127" data-s="300,640" data-type="png" data-w="879" data-src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBpUfbia1SaX0BiaJrf8HoAj4WxAVHl7ibZrktwPk8POrM0o3shHStoyREwPp2o9iaVCjLwJttJlptLFcw/640?wx_fmt=png&amp;from=appmsg" src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBpUfbia1SaX0BiaJrf8HoAj4WxAVHl7ibZrktwPk8POrM0o3shHStoyREwPp2o9iaVCjLwJttJlptLFcw/640?wx_fmt=png&amp;from=appmsg"></p><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="powershell"><code><span><span># 定义密码子对应关系</span></span></code><code><span>codon_table &lt;- list(</span></code><code><span>  A = c(<span>"GCT"</span>, <span>"GCC"</span>, <span>"GCA"</span>, <span>"GCG"</span>),</span></code><code><span>  R = c(<span>"CGT"</span>, <span>"CGC"</span>, <span>"CGA"</span>, <span>"CGG"</span>, <span>"AGA"</span>, <span>"AGG"</span>),</span></code><code><span>  N = c(<span>"AAT"</span>, <span>"AAC"</span>),</span></code><code><span>  D = c(<span>"GAT"</span>, <span>"GAC"</span>),</span></code><code><span>  C = c(<span>"TGT"</span>, <span>"TGC"</span>),</span></code><code><span>  Q = c(<span>"CAA"</span>, <span>"CAG"</span>),</span></code><code><span>  E = c(<span>"GAA"</span>, <span>"GAG"</span>),</span></code><code><span>  G = c(<span>"GGT"</span>, <span>"GGC"</span>, <span>"GGA"</span>, <span>"GGG"</span>),</span></code><code><span>  H = c(<span>"CAT"</span>, <span>"CAC"</span>),</span></code><code><span>  I = c(<span>"ATT"</span>, <span>"ATC"</span>, <span>"ATA"</span>),</span></code><code><span>  L = c(<span>"TTA"</span>, <span>"TTG"</span>, <span>"CTT"</span>, <span>"CTC"</span>, <span>"CTA"</span>, <span>"CTG"</span>),</span></code><code><span>  K = c(<span>"AAA"</span>, <span>"AAG"</span>),</span></code><code><span>  M = c(<span>"ATG"</span>),</span></code><code><span>  `F` = c(<span>"TTT"</span>, <span>"TTC"</span>),</span></code><code><span>  P = c(<span>"CCT"</span>, <span>"CCC"</span>, <span>"CCA"</span>, <span>"CCG"</span>),</span></code><code><span>  S = c(<span>"TCT"</span>, <span>"TCC"</span>, <span>"TCA"</span>, <span>"TCG"</span>, <span>"AGT"</span>, <span>"AGC"</span>),</span></code><code><span>  `T` = c(<span>"ACT"</span>, <span>"ACC"</span>, <span>"ACA"</span>, <span>"ACG"</span>),</span></code><code><span>  W = c(<span>"TGG"</span>),</span></code><code><span>  Y = c(<span>"TAT"</span>, <span>"TAC"</span>),</span></code><code><span>  V = c(<span>"GTT"</span>, <span>"GTC"</span>, <span>"GTA"</span>, <span>"GTG"</span>),</span></code><code><span>  X = c(<span>"TAA"</span>, <span>"TGA"</span>, <span>"TAG"</span>)  <span># 用于表示终止密码子</span></span></code><code><span>)</span></code><code><span><br></span></code><code><span><span># 定义函数进行密码子优化</span></span></code><code><span>optimize_sequence &lt;- <span>function</span>(aa_sequence) {</span></code><code><span>  dna_sequence &lt;- character()</span></code><code><span>  <span>for</span> (aa <span>in</span> strsplit(aa_sequence, <span>""</span>)[[<span>1</span>]]) {</span></code><code><span>    <span># 忽略不在密码子表中的氨基酸</span></span></code><code><span>    <span>if</span> (aa %<span>in</span>% names(codon_table)) {</span></code><code><span>      codons &lt;- codon_table[[aa]]</span></code><code><span>      <span># 随机选择一个密码子</span></span></code><code><span>      dna_sequence &lt;- append(dna_sequence, codons[<span>1</span>])  <span># 这里简单地选择第一个密码子，你也可以使用随机选择函数进行更复杂的选择</span></span></code><code><span>    } <span>else</span> {</span></code><code><span>      cat(paste(<span>"Ignoring unknown amino acid:"</span>, aa, <span>"\n"</span>))</span></code><code><span>    }</span></code><code><span>  }</span></code><code><span>  <span>return</span>(dna_sequence)</span></code><code><span>}</span></code><code><span><br></span></code><code><span><span># 提供的氨基酸序列</span></span></code><code><span>aa_sequence &lt;- <span>"MGSPKKKRKVEFMAATVKTEDAGHARYTYRLRLSLTSRHALLAEWDRCRWVWNQCVATSRQAYRAGEKCGPAHLCKLLTGWRSEHDWLSAGGSVPQQRIIRDFAKSRAKALKDVKARLPMRQRAGMPKFKKKALARPSLNYTRRGYRITDGRLHLAGGIVCAVVWSRELPCAPSSVRVYQDAQGHWYCSFVVATEVRSLPETGQVIGIDWGVTETATTTSEAHDLPHAEHGKRAAVKLARYQRMMAWRRPAKGKPASKGYRKAQRRAAKAHAKVARQRQDTARKWALRVARDHDAIAVEDFRPKFLAKTTMARKAADAAISATKNELIMMGRKHGRLVMLVDPKHSTMDCGQCGARTKHALPLSERTYTCTACGHVCPRDKNSARVMLVRAGLYPAGVEGARPPEALPREAAGSKRPAATKKAGQAKKKKTGYPYDVPDYAYPYDVPDYAYPYDVPDYA"</span></span></code><code><span><br></span></code><code><span><span># 进行密码子优化</span></span></code><code><span>optimized_dna_sequence &lt;- optimize_sequence(aa_sequence)</span></code><code><span><br></span></code><code><span><span># 输出密码子优化后的DNA序列</span></span></code><code><span>cat(optimized_dna_sequence, sep = <span>""</span>)</span></code><code><span><br></span></code><code><span><br></span></code><code><span><br></span></code><code><span><br></span></code><code><span><br></span></code><code><span>optimize_sequence &lt;- <span>function</span>(aa_sequence) {</span></code><code><span>  dna_sequence &lt;- character()</span></code><code><span>  <span>for</span> (aa <span>in</span> strsplit(aa_sequence, <span>""</span>)[[<span>1</span>]]) {</span></code><code><span>    <span># 忽略不在密码子表中的氨基酸</span></span></code><code><span>    <span>if</span> (aa %<span>in</span>% names(codon_table)) {</span></code><code><span>      codons &lt;- codon_table[[aa]]</span></code><code><span>      <span># 保持与原始序列相同的密码子顺序</span></span></code><code><span>      dna_sequence &lt;- append(dna_sequence, sample(codons, <span>1</span>))  <span># 随机选择一个密码子</span></span></code><code><span>    } <span>else</span> {</span></code><code><span>      cat(paste(<span>"Ignoring unknown amino acid:"</span>, aa, <span>"\n"</span>))</span></code><code><span>    }</span></code><code><span>  }</span></code><code><span>  <span>return</span>(dna_sequence)</span></code><code><span>}</span></code><code><span><br></span></code><code><span><span>data</span>&lt;-read.csv(<span>"序列.csv"</span>)</span></code><code><span>head(<span>data</span>)</span></code><code><span><br></span></code><code><span><span># 将sequence列转换为字符型</span></span></code><code><span><span>data</span><span>$sequence</span> &lt;- as.character(<span>data</span><span>$sequence</span>)</span></code><code><span><br></span></code><code><span><span># 应用函数到数据框中的每一行</span></span></code><code><span>optimized_sequences &lt;- character()</span></code><code><span><span>for</span> (i <span>in</span> <span>1</span>:nrow(<span>data</span>)) {</span></code><code><span>  optimized_dna_sequence &lt;- optimize_sequence(data[i, <span>"sequence"</span>])</span></code><code><span>  optimized_sequences &lt;- c(optimized_sequences, paste(optimized_dna_sequence, collapse = <span>""</span>))</span></code><code><span>}</span></code><code><span><br></span></code><code><span><span># 将优化后的序列添加到数据框中</span></span></code><code><span><span>data</span><span>$optimized_sequence</span> &lt;- optimized_sequences</span></code><code><span><br></span></code><code><span><span># 查看结果</span></span></code><code><span>head(<span>data</span>)</span></code><code><span><span>data</span><span>$amino_count</span> &lt;- nchar(<span>data</span><span>$sequence</span>)</span></code><code><span><span>data</span><span>$nucleotide_count</span> &lt;- nchar(<span>data</span><span>$optimized_sequence</span>)</span></code><code><span>data[<span>1</span>,]</span></code><code><span>write.csv(<span>data</span>,<span>"代码进行密码子优化.csv"</span>)</span></code><code><span><br></span></code></pre></section><p><img data-galleryid="" data-imgfileid="100025869" data-ratio="0.5703703703703704" data-s="300,640" data-type="png" data-w="1080" data-src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBpUfbia1SaX0BiaJrf8HoAj4WFVxlnianhg58CeXnicRoqBhVtnR7hwibpT2QDcrK7zlibs90AVbt4UHUMQ/640?wx_fmt=png&amp;from=appmsg" src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBpUfbia1SaX0BiaJrf8HoAj4WFVxlnianhg58CeXnicRoqBhVtnR7hwibpT2QDcrK7zlibs90AVbt4UHUMQ/640?wx_fmt=png&amp;from=appmsg"></p><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/aE8A-kOTa9YAYapOB-ahDg",target="_blank" rel="noopener noreferrer">原文链接</a>
