---
title: "Salmon — 兼具高效、精准及偏差感知的RNA-seq定量工具"
date: 2024-04-23T23:08:07Z
draft: ["false"]
tags: [
  "fetched",
  "生信菜鸟团"
]
categories: ["Acdemic"]
---
Salmon — 兼具高效、精准及偏差感知的RNA-seq定量工具 by 生信菜鸟团
------
<div><section data-md5="d93a6" act="xmy"><section data-md5="d93a6"><section data-md5="d93a6"><section data-md5="d93a6"><section data-md5="d93a6"><section data-md5="d93a6"><section data-md5="d93a6"><p data-md5="d93a6"><strong data-md5="d93a6">工欲善其事必先利其器</strong></p></section></section></section></section></section></section></section><p><br></p><p><br></p><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><p data-tool="mdnice编辑器">前面介绍了alevin 的单细胞定量功能，见 <a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzUzMTEwODk0Ng==&amp;mid=2247521280&amp;idx=1&amp;sn=312920b33e02bc5f631467236f6eddad&amp;chksm=fa45513dcd32d82b42504d0668e1ac2130cc17be61547b5bf7201b21e38049bdb7151f9977fe&amp;scene=21#wechat_redirect" textvalue="Alevin — 更快的单细胞定量" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2">Alevin — 更快的单细胞定量</a>，其也只是Salmon软件的一个组成部分，今天我们就再来学习一下 Salmon 其最初的功能 —— 转录组定量</p><h2 data-tool="mdnice编辑器"><span><span>1</span></span><span>Salmon</span></h2><p data-tool="mdnice编辑器">Salmon 是由Rob Patro领导的团队开发的一款高效的生物信息学工具，主要用于定量转录组数据中的转录本表达量。其特性如下：</p><ol data-tool="mdnice编辑器"><li><section><strong>速度与效率</strong>：Salmon 使用了一种被称为“准映射”（quasi-mapping）的技术，该技术可以快速准确地将读段（reads）直接映射到转录本上，大大加快了处理速度并降低了内存需求。</section></li><li><section><strong>无偏估计</strong>：软件在估计转录本丰度时，可以有效地避免系统偏误，使用复杂的统计模型来校正样本制备和测序过程中的偏差。</section></li><li><section><strong>灵活的输入格式支持</strong>：Salmon 支持多种类型的输入数据，包括但不限于FASTA和FASTQ格式，能够处理单端和配对端数据。</section></li></ol><p data-tool="mdnice编辑器">官网：https://combine-lab.github.io/salmon/</p><p data-tool="mdnice编辑器">GitHub：https://github.com/COMBINE-lab/salmon?tab=readme-ov-file</p><p data-tool="mdnice编辑器">编程语言：C++</p><figure data-tool="mdnice编辑器"><img data-imgfileid="100037942" data-ratio="0.40925925925925927" data-type="png" data-w="1080" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8ZgfvonAsIdBjVt7yakyVpZ1iavokBxaUvNkyzNbzGQG53YY7pwOoIGfWDQEkSdNmZVSWhF0jbmeA/640?wx_fmt=png&amp;from=appmsg" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8ZgfvonAsIdBjVt7yakyVpZ1iavokBxaUvNkyzNbzGQG53YY7pwOoIGfWDQEkSdNmZVSWhF0jbmeA/640?wx_fmt=png&amp;from=appmsg"><figcaption>Salmon</figcaption></figure><h2 data-tool="mdnice编辑器"><span><span>2</span></span><span>发表文章</span></h2><blockquote data-tool="mdnice编辑器"><p><strong>文章信息</strong>：Salmon provides fast and bias-aware quantification of transcript expression<br><strong>期刊</strong>：Nature Methods<br><strong>日期</strong>：2017年3月<br><strong>作者 &amp; 单位</strong>：Rob Patro &amp;  Stony Brook University<br><strong>DOI</strong>：https://doi.org/10.1038/nmeth.4197</p></blockquote><figure data-tool="mdnice编辑器"><img data-imgfileid="100037940" data-ratio="0.47129629629629627" data-type="png" data-w="1080" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8ZgfvonAsIdBjVt7yakyVphh61TDyIGD57pIZoicWhaCtvDLGeMlwibEDic04Ip70SxXEibNXelD9ofw/640?wx_fmt=png&amp;from=appmsg" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8ZgfvonAsIdBjVt7yakyVphh61TDyIGD57pIZoicWhaCtvDLGeMlwibEDic04Ip70SxXEibNXelD9ofw/640?wx_fmt=png&amp;from=appmsg"></figure><h2 data-tool="mdnice编辑器"><span><span>3</span></span><span>如何安装</span></h2><p data-tool="mdnice编辑器">Salmon 提供了多种安装方式。包括但不限于 二进制版本、源码构建、Docker镜像、Conda安装等。由于源码构建所需依赖过多，所以推荐使用二进制版本、Conda、Docker镜像安装</p><h3 data-tool="mdnice编辑器"><span></span><span>Conda安装（推荐）</span><span></span></h3><p data-tool="mdnice编辑器">由于Github 没有提供最新版的salmon的二进制版本，所以推荐使用Conda安装</p><pre data-tool="mdnice编辑器"><span></span><code>conda create -n salmon<br>conda activate salmon<br>conda install salmon -y <br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100037939" data-ratio="0.37592592592592594" data-type="png" data-w="1080" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8ZgfvonAsIdBjVt7yakyVpx4NzJ4d8F4lSsPnQb7uIia9zDrP5MLctEO8pab6wfNLGalH3mk5BB0A/640?wx_fmt=png&amp;from=appmsg" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8ZgfvonAsIdBjVt7yakyVpx4NzJ4d8F4lSsPnQb7uIia9zDrP5MLctEO8pab6wfNLGalH3mk5BB0A/640?wx_fmt=png&amp;from=appmsg"></figure><h2 data-tool="mdnice编辑器"><span><span>4</span></span><span>定量基本流程</span></h2><ul data-tool="mdnice编辑器"><li><section>索引构建：首先，需要为参考转录组构建索引。这个过程包括对所有转录本的序列进行预处理，从而为快速准映射（quasi-mapping）做好准备。</section></li><li><section>准映射：在索引构建完成后，Salmon 使用准映射技术将读段（reads）直接映射到转录本上。这种方法不需要完全的比对，而是快速地估计读段与转录本的相似度，显著提升了处理速度。</section></li><li><section>表达量估计：映射完成后，Salmon 会根据映射的读段计算每个转录本的表达量。这一步考虑了读段覆盖度、转录本长度和测序深度等因素。</section></li><li><section>偏差校正：在定量的过程中，Salmon 还会进行偏差校正，尝试消除由测序和样本制备中引入的技术偏差影响。</section></li><li><section>输出结果：最后，Salmon 输出转录本的表达量估计，通常是以TPM（每百万转录本碱基数）单位表示。</section></li></ul><h2 data-tool="mdnice编辑器"><span><span>5</span></span><span>最小化使用</span></h2><p data-tool="mdnice编辑器">salmon有两种定量模式</p><h3 data-tool="mdnice编辑器"><span></span><span>基于映射模式的定量</span><span></span></h3><h4 data-tool="mdnice编辑器"><span>准备文件</span></h4><p data-tool="mdnice编辑器">GENCODE：https://www.gencodegenes.org/</p><pre data-tool="mdnice编辑器"><span></span><code><span>#</span><span><span>#下载对应物种的转录本fa文件</span></span><br>wget -c https://ftp.ebi.ac.uk/pub/databases/gencode/Gencode_human/release_45/gencode.v45.transcripts.fa.gz<br><span><br>#</span><span><span># 创建salmon索引</span></span><br>salmon index -i homo_gencode_transcript_index -k 31 --gencode -p 8  -t gencode.v45.transcripts.fa.gz <br><br>-i #指定索引的输出位置和名称<br>-k #设置用于构建准索引的k-mer的长度，默认为31<br>-p #设置调用线程，默认为2<br>-t #输入文件；转录本的fasta格式文件<br>--gencode #此选项表明输入的fasta文件是GENCODE格式的，会在第一个`|`字符处切分转录本名称<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100037938" data-ratio="0.6395833333333333" data-type="png" data-w="960" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8ZgfvonAsIdBjVt7yakyVpXJtBFGkTD4XRUiby0vHtiaVAHGglP54RvgxetTs7xnjjdQdW2vGicshAw/640?wx_fmt=png&amp;from=appmsg" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8ZgfvonAsIdBjVt7yakyVpXJtBFGkTD4XRUiby0vHtiaVAHGglP54RvgxetTs7xnjjdQdW2vGicshAw/640?wx_fmt=png&amp;from=appmsg"><figcaption>索引文件</figcaption></figure><p data-tool="mdnice编辑器">当然，部分物种也可下载官方构建好的索引文件，见：http://refgenomes.databio.org/</p><h4 data-tool="mdnice编辑器"><span></span>定量<span></span></h4><pre data-tool="mdnice编辑器"><span></span><code><span>#</span><span><span># 双端测序</span></span><br><span>#</span><span><span># salmon quant -i transcripts_index -l &lt;LIBTYPE&gt; -1 reads1.fq -2 reads2.fq --validateMappings -o transcripts_quant</span></span><br><br>salmon quant -i ~/ref/homo/homo_gencode_transcript_index -l IU -p 8 -1 SRR8707539_1.fastq.gz -2 SRR8707539_2.fastq.gz -o ~/GSE128101/salmon_paired_out/<br><br>-i #指定索引文件位置<br>-l #指定库类型的格式字符串。这个参数告诉Salmon你的测序库是单端还是双端，以及测序的方向性 (注意参数顺序，-l 参数要放在reads文件之前),不清楚的话可以设为 “A”<br>-1 # reads 文件1<br>-2 # reads 文件2<br>-o #输出结果目录<br>-p #设置调用线程（默认256），建议8~12个线程<br>--validateMappings #早期版本的 Salmon 中，需要显式启用选择性对准来优化映射质量。在较新版本的Salmon中已被标记为弃用，并且没有效果。因为选择性对准（selective alignment）现在是Salmon的默认行为<br><span><br>#</span><span><span># 单端测序</span></span><br><span>#</span><span><span># salmon quant -i transcripts_index -l &lt;LIBTYPE&gt; -r reads.fq --validateMappings -o transcripts_quant</span></span><br>salmon quant -i ~/ref/mouse/mouse_gencode_transcript_index -l A  -p 8 -r SRR8734841.fastq.gz -o ~/GSE128101/salmon_single_out/SRR8734841<br><br>-r # 指定单端样本<br>-l A #自动检测读段方向<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100037941" data-ratio="0.26944444444444443" data-type="png" data-w="1080" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8ZgfvonAsIdBjVt7yakyVpfhkSlvKfoncKsoRBlWHMrL3prmbTtAwlDZLEZKhpk515e4YgZXcfoA/640?wx_fmt=png&amp;from=appmsg" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8ZgfvonAsIdBjVt7yakyVpfhkSlvKfoncKsoRBlWHMrL3prmbTtAwlDZLEZKhpk515e4YgZXcfoA/640?wx_fmt=png&amp;from=appmsg"><figcaption>双端演示</figcaption></figure><figure data-tool="mdnice编辑器"><img data-imgfileid="100037947" data-ratio="0.31296296296296294" data-type="png" data-w="1080" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8ZgfvonAsIdBjVt7yakyVpzQmR7JX09nOeQ60hxQC2BwEwMSibPHRgTOpTkvSjKHlBu69hcIWdwgQ/640?wx_fmt=png&amp;from=appmsg" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8ZgfvonAsIdBjVt7yakyVpzQmR7JX09nOeQ60hxQC2BwEwMSibPHRgTOpTkvSjKHlBu69hcIWdwgQ/640?wx_fmt=png&amp;from=appmsg"><figcaption>单端演示</figcaption></figure><h3 data-tool="mdnice编辑器"><span></span><span>关于 <code>-l</code>  参数 库类型</span><span></span></h3><p data-tool="mdnice编辑器">对于单端测序</p><ul data-tool="mdnice编辑器"><li><section>A: 自动检测读段的方向</section></li><li><section>U: 未指定方向性（未知或不相关）</section></li></ul><p data-tool="mdnice编辑器">对于<strong>双末端测序</strong></p><ul data-tool="mdnice编辑器"><li><section>A：自动检测</section></li><li><section>IU: 内向配对（inward），未指定方向性</section></li><li><section>ISF: 内向配对，正向/正向</section></li><li><section>ISR: 内向配对，反向/反向</section></li><li><section>OSF: 外向配对，正向/正向</section></li><li><section>OSR: 外向配对，反向/反向</section></li><li><section>MSF: 匹配配对，正向/正向</section></li><li><section>MSR: 匹配配对，反向/反向</section></li></ul><p data-tool="mdnice编辑器"><code>I</code> 代表内向（inward）配对，<code>O</code> 代表外向（outward）配对，<code>M</code> 代表匹配（matching）配对。<code>S</code> 代表正向（same），<code>R</code> 代表反向（reverse）</p><figure data-tool="mdnice编辑器"><img data-imgfileid="100037946" data-ratio="0.6805555555555556" data-type="png" data-w="1080" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8ZgfvonAsIdBjVt7yakyVpUFWLU5JdNoDKCl0Iqb5lXgAYofrefNFQqiaibiaxMWIQKFjyntJic11J6g/640?wx_fmt=png&amp;from=appmsg" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8ZgfvonAsIdBjVt7yakyVpUFWLU5JdNoDKCl0Iqb5lXgAYofrefNFQqiaibiaxMWIQKFjyntJic11J6g/640?wx_fmt=png&amp;from=appmsg"><figcaption>示意图</figcaption></figure><h3 data-tool="mdnice编辑器"><span></span><span>基于比对模式的定量</span><span></span></h3><p data-tool="mdnice编辑器">Salmon期望提供的对齐文件是针对与FASTA文件中给出的转录本进行的。这意味着读段应该直接对齐到转录本上，而不是整个基因组。这与一些其他工具（如Cufflinks）不同，后者是对整个基因组进行读段的对齐</p><pre data-tool="mdnice编辑器"><span></span><code><span>#</span><span><span># 比对</span></span><br><span>#</span><span><span># hisat2 -p 4 -x ~/ref/homo/hisat2_trans_index/homo_gencode_v45 -1 SRR8707540_1_val_1.fq.gz -2 SRR8707540_2_val_2.fq.gz |samtools sort -@ 4 -o ~/GSE128101/hisat_trans_out/SRR8707540_sort.bam</span></span><br><span>#</span><span><span># salmon基于比对模式的定量</span></span><br><span>#</span><span><span># ./bin/salmon quant -t transcripts.fa -l &lt;LIBTYPE&gt; -a aln.bam -o salmon_quant</span></span><br><br>salmon quant -t ~/ref/homo/gencode.v45.transcripts.fa -l IU -p 8 -a ./SRR8707540_sort.bam -o ~/GSE128101/salmon_paired_out/SRR8707540_bam<br><br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100037945" data-ratio="0.30925925925925923" data-type="png" data-w="1080" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8ZgfvonAsIdBjVt7yakyVp4lIsics3Ax21qAVC9vyMRZWRiccwcx9iay3iaiawKAenRCLRV6W3bbibEjMg/640?wx_fmt=png&amp;from=appmsg" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8ZgfvonAsIdBjVt7yakyVp4lIsics3Ax21qAVC9vyMRZWRiccwcx9iay3iaiawKAenRCLRV6W3bbibEjMg/640?wx_fmt=png&amp;from=appmsg"><figcaption>基于比对模式</figcaption></figure><h2 data-tool="mdnice编辑器"><span><span>6</span></span><span>结果文件</span></h2><figure data-tool="mdnice编辑器"><img data-imgfileid="100037943" data-ratio="0.5981481481481481" data-type="png" data-w="1080" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8ZgfvonAsIdBjVt7yakyVp5ia6O09PTDiaGaNHJ7HM3dZtxZkenzhe3rRGoMnvibxvrH6FMicg298xZQ/640?wx_fmt=png&amp;from=appmsg" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8ZgfvonAsIdBjVt7yakyVp5ia6O09PTDiaGaNHJ7HM3dZtxZkenzhe3rRGoMnvibxvrH6FMicg298xZQ/640?wx_fmt=png&amp;from=appmsg"><figcaption>结果文件</figcaption></figure><h3 data-tool="mdnice编辑器"><span></span><span>主要结果</span><span></span></h3><p data-tool="mdnice编辑器">以制表符分割的定量文件 —— <code>quant.sf</code></p><figure data-tool="mdnice编辑器"><img data-imgfileid="100037944" data-ratio="0.4962962962962963" data-type="png" data-w="1080" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8ZgfvonAsIdBjVt7yakyVpqjf1ZKrILicYOVI2Fh4IZHytsjnRFGd8NaHKWx4m4nQwLNKSgUx5PIg/640?wx_fmt=png&amp;from=appmsg" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8ZgfvonAsIdBjVt7yakyVpqjf1ZKrILicYOVI2Fh4IZHytsjnRFGd8NaHKWx4m4nQwLNKSgUx5PIg/640?wx_fmt=png&amp;from=appmsg"><figcaption>quant.sf</figcaption></figure><ol data-tool="mdnice编辑器"><li><section><strong>Name</strong>（名称）：输入转录本数据库（FASTA文件）中提供的目标转录本的名称</section></li><li><section><strong>Length</strong>（长度）：目标转录本的长度，以核苷酸计算</section></li><li><section><strong>EffectiveLength</strong>（有效长度）：这是计算得出的目标转录本的有效长度。它考虑了所有影响从该转录本采样片段的概率的因素，包括片段长度分布、序列特异性和GC片段偏差（如果这些因素被建模）</section></li><li><section><strong>TPM</strong>（每百万转录本数）：Salmon估计的该转录本的相对丰度，单位为每百万转录本数（TPM）。TPM是推荐用于下游分析的相对丰度测量单位</section></li><li><section><strong>NumReads</strong>（读段数）：Salmon估计的映射到每个被定量转录本的读段数量。这是一个“估计值”</section></li></ol><blockquote data-tool="mdnice编辑器"><p>更多参数信息详见：https://salmon.readthedocs.io/en/latest/salmon.html</p></blockquote><hr data-tool="mdnice编辑器"><p data-tool="mdnice编辑器">参考：</p><ul data-tool="mdnice编辑器"><li><section>https://salmon.readthedocs.io/en/latest/salmon.html</section><section><br></section></li></ul></section><section><section act="xmy"><section data-id="123409" data-type="lspecial02,lspecial04" powered-by="xmyeditor.com" data-md5="8b46d"><section powered-by="xmyeditor.com" data-md5="8b46d"><section powered-by="xmyeditor.com" data-md5="8b46d"><section powered-by="xmyeditor.com" data-md5="8b46d"><br></section><section powered-by="xmyeditor.com" data-md5="8b46d"><img data-imgfileid="100037952" data-ratio="0.6940298507462687" data-type="gif" data-w="134" data-src="https://mmbiz.qpic.cn/mmbiz_gif/iaRJcrq2LosibrvQnXTV3PMktpwwmDsjia2JG4e3ibpLQ1G6M4nktW4PiaiaKfnpiaRmNbTT6St7QLfzAMAomKgWxQ4kA/640?wx_fmt=gif&amp;wxfrom=5&amp;wx_lazy=1&amp;tp=webp" src="https://mmbiz.qpic.cn/mmbiz_gif/iaRJcrq2LosibrvQnXTV3PMktpwwmDsjia2JG4e3ibpLQ1G6M4nktW4PiaiaKfnpiaRmNbTT6St7QLfzAMAomKgWxQ4kA/640?wx_fmt=gif&amp;wxfrom=5&amp;wx_lazy=1&amp;tp=webp"></section><section powered-by="xmyeditor.com" data-md5="8b46d"><br></section></section></section></section></section></section><p><span></span><br></p><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><h4 data-tool="mdnice编辑器">文末友情宣传</h4><p data-tool="mdnice编辑器">强烈建议你推荐给身边的<strong>博士后以及年轻生物学PI</strong>，多一点数据认知，让他们的科研上一个台阶：</p><ul data-tool="mdnice编辑器"><li><section> <a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247530001&amp;idx=1&amp;sn=676dcf224f9be23b288189775292aeeb&amp;chksm=9b4b36aaac3cbfbc3e3bb0865bd789d5093e3a643f3f345332995f707b7f209ae924e9e9529e&amp;scene=21#wechat_redirect" textvalue="生信入门&amp;数据挖掘线上直播课5月班" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2">生信入门&amp;数据挖掘线上直播课5月班</a>，你的生物信息学入门课</section></li><li><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247524148&amp;idx=1&amp;sn=7806da6feb41a36493c519c1cfc1d3ac&amp;chksm=9b4bdf8fac3c569960369602f1ef26639cb366b250f233b2297d1f059471c0458335bfc0b829&amp;scene=21#wechat_redirect" textvalue="时隔5年，我们的生信技能树VIP学徒继续招生啦" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1">时隔5年，我们的生信技能树VIP学徒继续招生啦</a><br></section></li><li><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247528363&amp;idx=1&amp;sn=5e02f3e9b2e148191e23ebc2c0d780e7&amp;chksm=9b4b2f10ac3ca606c1c4bac8cf112bb9b0f18e3c4262f5f2b8c0dba3bfedf2ba201507247005&amp;scene=21#wechat_redirect" textvalue="2024的共享服务器交个朋友福利价仍然是800" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1">2024的共享服务器交个朋友福利价仍然是800</a></section></li></ul></section><p><mp-style-type data-value="10000"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/a6LQxKMe0_Nh0TUK8cyRjw",target="_blank" rel="noopener noreferrer">原文链接</a>
