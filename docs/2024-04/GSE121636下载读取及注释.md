---
title: "GSE121636下载读取及注释"
date: 2024-04-05T22:58:17Z
draft: ["false"]
tags: [
  "fetched",
  "学R时习之"
]
categories: ["Acdemic"]
---
GSE121636下载读取及注释 by 学R时习之
------
<div><p><code><span>GSE121636</span></code><span>是肾癌的单细胞测序数据，包含3 个外周血和 3 个肿瘤组织样品。</span><ne-clipboard source="https%3A%2F%2Fwww.yuque.com%2Fgaodashitou%2Fxggbo7%2Flzmv9sbt5ugrcgw7"></ne-clipboard></p><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><blockquote data-tool="mdnice编辑器"><p>We generated a comprehensive immune profile using single-cell RNA-seq data from 25,000 immune cells from three renal cell carcinoma along with matched peripheral blood.<span></span></p></blockquote></section><hr><p><span>看文献时发现有篇文章就是挖掘的该数据集(PMID38442575)，且作者在方法中说是从</span><code><span>TISCH</span></code><span>这个宝藏数据中下载得到的。那么咱们接下来按照文章方法看能不能复现单细胞部分？</span></p><p><img data-imgfileid="100003079" data-ratio="0.3175925925925926" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/C0nicuvoMeDGV17T0clR6DXicvSk4srVCBpibhTs1tp2k5fvY41PoUQic107xOb2u22y5CriawAxeM4HbN7F5DmuLjQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" width="725" src="https://mmbiz.qpic.cn/sz_mmbiz_png/C0nicuvoMeDGV17T0clR6DXicvSk4srVCBpibhTs1tp2k5fvY41PoUQic107xOb2u22y5CriawAxeM4HbN7F5DmuLjQ/640?wx_fmt=png&amp;from=appmsg"><img data-imgfileid="100003080" data-ratio="0.7981481481481482" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/C0nicuvoMeDGV17T0clR6DXicvSk4srVCBkh0rIzYibdpWvVENVPXYpp9adVO1fLLWLE8zfBMPM2yZvRBbnqo4Vow/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" width="559" src="https://mmbiz.qpic.cn/sz_mmbiz_png/C0nicuvoMeDGV17T0clR6DXicvSk4srVCBkh0rIzYibdpWvVENVPXYpp9adVO1fLLWLE8zfBMPM2yZvRBbnqo4Vow/640?wx_fmt=png&amp;from=appmsg"></p><h2><span>step00. 数据下载及读取</span></h2><h1><span></span></h1><ul><li><p><span>首先从</span><code><span>TISCH2</span></code><span>网站，按照①-⑤下载该数据集</span></p></li><li><p><span>最终获得⑥⑦两个文件</span></p></li></ul><p><img data-imgfileid="100003083" data-ratio="0.6129629629629629" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/C0nicuvoMeDGV17T0clR6DXicvSk4srVCBBePAxOyRibOTtmUQuK37aIJsejpfTFib4pXPMuMP3eMReVhhEdpMSbFQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" width="1487" src="https://mmbiz.qpic.cn/sz_mmbiz_png/C0nicuvoMeDGV17T0clR6DXicvSk4srVCBBePAxOyRibOTtmUQuK37aIJsejpfTFib4pXPMuMP3eMReVhhEdpMSbFQ/640?wx_fmt=png&amp;from=appmsg"><img data-imgfileid="100003082" data-ratio="0.5898148148148148" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/C0nicuvoMeDGV17T0clR6DXicvSk4srVCBbuVLHM0XnGtbMHNOGBqEicI666yQyRErke6icKyKJpqQlE4GPUKtweLw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" width="1477" src="https://mmbiz.qpic.cn/sz_mmbiz_png/C0nicuvoMeDGV17T0clR6DXicvSk4srVCBbuVLHM0XnGtbMHNOGBqEicI666yQyRErke6icKyKJpqQlE4GPUKtweLw/640?wx_fmt=png&amp;from=appmsg"><img data-imgfileid="100003081" data-ratio="0.6055555555555555" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/C0nicuvoMeDGV17T0clR6DXicvSk4srVCBcPk0Sfs7LOibpwjxEtP4ZL7CbpO7pGST4vowoicNQJrb1ibs5uFN0I48A/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" width="1154" src="https://mmbiz.qpic.cn/sz_mmbiz_png/C0nicuvoMeDGV17T0clR6DXicvSk4srVCBcPk0Sfs7LOibpwjxEtP4ZL7CbpO7pGST4vowoicNQJrb1ibs5uFN0I48A/640?wx_fmt=png&amp;from=appmsg"><img data-imgfileid="100003084" data-ratio="0.09591836734693877" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/C0nicuvoMeDGV17T0clR6DXicvSk4srVCBzpm0sNHibtge0AYJ0Ny71Ps3iaXYsaStr5hpbxT6OGYOgziaSDrjRic1DA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="980" width="490" src="https://mmbiz.qpic.cn/sz_mmbiz_png/C0nicuvoMeDGV17T0clR6DXicvSk4srVCBzpm0sNHibtge0AYJ0Ny71Ps3iaXYsaStr5hpbxT6OGYOgziaSDrjRic1DA/640?wx_fmt=png&amp;from=appmsg"></p><p><span>接下来读取数据</span></p><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><pre data-tool="mdnice编辑器"><span></span><code>rm(list = ls())<br>librarian::shelf(tidyverse)<br>librarian::shelf(Seurat)<br>library(harmony)<br><br><span>##### step00.数据读取 #####</span><br><span>if</span>(F){<br>  mydata &lt;- Read10X_h5(<span>"KIRC_GSE121636_expression.h5"</span>)<br>  pbmc &lt;- CreateSeuratObject(counts = mydata,<br>                             project = <span>"GSE121636"</span>,<br>                             min.cells = 3,<br>                             min.features = 200)<br>  pbmc &lt;- SetIdent(pbmc, value = <span>"GSE121636"</span>)<br>  dim(pbmc)<br><br>  <span>#将列名称修改后再读取</span><br>  phe=data.table::fread(<span>"KIRC_GSE121636_CellMetainfo_table.tsv"</span>,data.table = F)<br>  phe=as.data.frame(phe)<br>  rownames(phe)=phe<span>$Cell</span><br>  pbmc=AddMetaData(pbmc, phe, col.name = colnames(phe))<br>  unique(pbmc<span>$Sample</span>)<br>  saveRDS(pbmc, file = <span>"sce.all_raw.rds"</span>)<br>}<span></span></code></pre></section><h1><span>step01.质控QC</span></h1><p><span>下面进行数据筛选及质控</span></p><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><pre data-tool="mdnice编辑器"><span></span><code><span>if</span>(F){<br>  dir.create(<span>"./1-QC"</span>)<br>  setwd(<span>"./1-QC"</span>)<br>  sce.all &lt;- readRDS(<span>"../sce.all_raw.rds"</span>)<br>  sce.all[[<span>"percent.mt"</span>]] &lt;- PercentageFeatureSet(sce.all, pattern = <span>"^MT-"</span>)<br>  feats &lt;- c(<span>"nFeature_RNA"</span>, <span>"nCount_RNA"</span>, <span>"percent.mt"</span>)<br>  p1=VlnPlot(sce.all, group.by = <span>"Sample"</span>, features = feats, pt.size = 0.01, ncol = 3) +<br>  NoLegend()<br>  p1<br><br>  ggsave(filename=<span>"Vlnplot1.pdf"</span>,plot=p1)<br><br>  p2=FeatureScatter(sce.all, <span>"nCount_RNA"</span>, <span>"nFeature_RNA"</span>, group.by = <span>"Sample"</span>, pt.size = 0.5)<br>  p2<br>  ggsave(filename=<span>"Scatterplot.pdf"</span>,plot=p2)<br><br><br>  sce.all.filt &lt;- subset(sce.all, subset = nFeature_RNA &gt; 200 &amp; nFeature_RNA &lt; 4000 &amp; percent.mt &lt; 5 &amp; nCount_RNA &lt; 4000)<br><br>  dim(sce.all)<br>  <span>#17738 25681</span><br>  dim(sce.all.filt)<br>  <span>#17738 25350</span><br><br>  <span>#可视化过滤后的情况</span><br>  feats &lt;- c(<span>"nFeature_RNA"</span>, <span>"nCount_RNA"</span>, <span>"percent.mt"</span>)<br>  p1_filtered=VlnPlot(sce.all.filt, group.by = <span>"Sample"</span>, features = feats, pt.size = 0.1, ncol = 3) +<br>  NoLegend()<br>  p1_filtered<br>  ggsave(filename=<span>"Vlnplot1_filtered.pdf"</span>,plot=p1_filtered)<br><br>  <span>#细胞周期评分</span><br>  sce.all.filt = NormalizeData(sce.all.filt)<br>  s.genes=Seurat::cc.genes.updated.2019<span>$s</span>.genes<br>  g2m.genes=Seurat::cc.genes.updated.2019<span>$g2m</span>.genes<br>  sce.all.filt=CellCycleScoring(object = sce.all.filt,<br>                                s.features = s.genes,<br>                                g2m.features = g2m.genes,<br>                                set.ident = TRUE)<br>  p3=VlnPlot(sce.all.filt, features = c(<span>"S.Score"</span>, <span>"G2M.Score"</span>), group.by = <span>"Sample"</span>,<br>             ncol = 2, pt.size = 0.1)<br>  p3<br>  ggsave(filename=<span>"Vlnplot3_cycle.pdf"</span>,plot=p3)<br><br>  sce.all.filt@meta.data  %&gt;% ggplot(aes(S.Score,G2M.Score))+geom_point(aes(color=Phase))+<br>  theme_minimal()<br>  ggsave(filename=<span>"cycle_details.pdf"</span> )<br>  <span># S.Score较高的为S期，G2M.Score较高的为G2M期，都比较低的为G1期</span><br><br>  dim(sce.all)<br>  dim(sce.all.filt)<br>  saveRDS(sce.all.filt, <span>"sce.all_qc.rds"</span>)<br>}</code></pre></section><p><br></p><p><img data-imgfileid="100003097" data-ratio="0.48148148148148145" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/C0nicuvoMeDGV17T0clR6DXicvSk4srVCBpq7YK54brWibOgMzibh1ia2aBicnRVGUjLeR15o2BUnApsUvtYVHlQUOWQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" width="1370" src="https://mmbiz.qpic.cn/sz_mmbiz_png/C0nicuvoMeDGV17T0clR6DXicvSk4srVCBpq7YK54brWibOgMzibh1ia2aBicnRVGUjLeR15o2BUnApsUvtYVHlQUOWQ/640?wx_fmt=png&amp;from=appmsg"></p><p><img data-imgfileid="100003088" data-ratio="0.45092592592592595" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/C0nicuvoMeDGV17T0clR6DXicvSk4srVCBHRZl5fLQWaKJUMg4WPAfPKNhavURDjpOQicicNjic7vIgiaULIredGtehg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" width="1200" src="https://mmbiz.qpic.cn/sz_mmbiz_png/C0nicuvoMeDGV17T0clR6DXicvSk4srVCBHRZl5fLQWaKJUMg4WPAfPKNhavURDjpOQicicNjic7vIgiaULIredGtehg/640?wx_fmt=png&amp;from=appmsg"><img data-imgfileid="100003087" data-ratio="0.5990740740740741" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/C0nicuvoMeDGV17T0clR6DXicvSk4srVCBkE3THxx5ScqIgPT5S50gUVmvLfZqkBQbkW8GURN4F2tyoVbsMIfYjg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" width="1019" src="https://mmbiz.qpic.cn/sz_mmbiz_png/C0nicuvoMeDGV17T0clR6DXicvSk4srVCBkE3THxx5ScqIgPT5S50gUVmvLfZqkBQbkW8GURN4F2tyoVbsMIfYjg/640?wx_fmt=png&amp;from=appmsg"><br></p><hr><h1><span>step02.数据合并harmony</span></h1><p><span>一般情况下需要展示PCA降维结果，然后用harmony去除批次效应。下面直接去除批次效应，按照原文直接选定 </span><code><span>resolution=0.8</span></code><span>。可以看到一共有 23 个 clusters。</span></p><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><pre data-tool="mdnice编辑器"><span></span><code><span>##### step02.harmony #####</span><br><br><span>if</span>(T){<br>  dir.create(<span>"2-harmony"</span>)<br>  setwd(<span>"./2-harmony/"</span>)<br>  sce &lt;- readRDS(<span>"../1-QC/sce.all_qc.rds"</span>)<br><br>  sce &lt;- NormalizeData(sce)<br>  sce&lt;- FindVariableFeatures(sce, selection.method = <span>"vst"</span>, nfeatures = 2000)<br>  sce &lt;- ScaleData(sce, features = rownames(sce))<br>  sce &lt;- RunPCA(sce, features = VariableFeatures(object = sce))<br>  sce &lt;- SetIdent(sce, value = <span>"Sample"</span>)<br>  sce@meta.data<span>$orig</span>.ident=sce@meta.data<span>$Sample</span><br>  table(sce@meta.data<span>$orig</span>.ident)<br><br>  seuratObj &lt;- RunHarmony(sce, <span>"orig.ident"</span>)<br>  names(seuratObj@reductions)<br>  seuratObj &lt;- RunUMAP(seuratObj,  dims = 1:20,<br>                       reduction = <span>"harmony"</span>)<br>  DimPlot(seuratObj,reduction = <span>"umap"</span>,label=T )<br>  DimPlot(seuratObj,reduction = <span>"harmony"</span>,label=T ,group.by = <span>"orig.ident"</span>)<br>  sce=seuratObj<br>  sce &lt;- FindNeighbors(sce, reduction = <span>"harmony"</span>,<br>                       dims = 1:20)<br>  sce &lt;- FindClusters(object= sce, resolution=0.8)<br>  sce &lt;- RunTSNE(sce, reduction = <span>"harmony"</span>, dims = 1:20)<br>  DimPlot(sce, reduction = <span>"umap"</span>, group.by = <span>"seurat_clusters"</span>)<br>  ggsave(file=<span>"seurat_cluster.pdf"</span>,width = 8,height = 6)<br>  saveRDS(sce,file = <span>"sce.all_int.rds"</span>)<br>}</code></pre></section><p><span></span></p><p><img data-imgfileid="100003085" data-ratio="0.7314814814814815" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/C0nicuvoMeDGV17T0clR6DXicvSk4srVCBc2gJeSY780PeCl1ukxNZwDxy9pxcsppWOLYLe7A0RpkZpmryHAEgtw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" width="734" src="https://mmbiz.qpic.cn/sz_mmbiz_png/C0nicuvoMeDGV17T0clR6DXicvSk4srVCBc2gJeSY780PeCl1ukxNZwDxy9pxcsppWOLYLe7A0RpkZpmryHAEgtw/640?wx_fmt=png&amp;from=appmsg"></p><hr><h1><span>step03.细胞注释</span></h1><p><span>上面常规的降维聚类已完成，最最重要的部分细胞注释部分。咱们同样用手工+</span><code><span>CellMarker</span></code><span>的方法进行注释。</span></p><ul><li><p><code><span>writeLines(paste0(0:22,","))</span></code><span> #把亚群的序号输出到控制台，然后手工生成</span><code><span>manual_annotate.txt</span></code><span>文件。</span></p></li><li><p><code><span>TISCH2</span></code><span>其实大致已经给cluster命名，可结合其结果，对 cluster 名称微调即可。</span></p></li></ul><p><span>首先是利用</span><code><span>FindAllMarkers</span></code><span>找出各个亚群的差异基因，然后根据差异基因给各个亚群命名。</span></p><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><pre data-tool="mdnice编辑器"><code>0,NK_cell<br>1,CD4_T<br>2,CD8_T<br>3,Mono.Macro<br>4,CD8_T<br>5,CD8_T<br>6,CD4_T<br>7,B_cell<br>8,Mono.Macro<br>9,Mono.Macro<br>10,DC<br>11,NK_cell<br>12,Treg<br>13,B_cell<br>14,Mono.Macro<br>15,CD8_T<br>16,Mono.Macro<br>17,prolif.cells<br>18,Mono.Macro<br>19,CD8_T<br>20,DC<br>21,Plasma<br>22,CMP<span></span></code></pre></section><p><img data-imgfileid="100003094" data-ratio="0.674074074074074" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/C0nicuvoMeDGV17T0clR6DXicvSk4srVCB9K87DUcZ3yiagfv4VnEZeaogwMPiamLibGGEjrZJNZ3xyT5xlXbNhoRDA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" width="1275" src="https://mmbiz.qpic.cn/sz_mmbiz_png/C0nicuvoMeDGV17T0clR6DXicvSk4srVCB9K87DUcZ3yiagfv4VnEZeaogwMPiamLibGGEjrZJNZ3xyT5xlXbNhoRDA/640?wx_fmt=png&amp;from=appmsg"><img data-imgfileid="100003093" data-ratio="0.4546296296296296" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/C0nicuvoMeDGV17T0clR6DXicvSk4srVCBlVzPAHAogQfhNkaHoARRYOpNepwtaS1Rt5voPee67ibdOUI77C0Gkxg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" width="1499" src="https://mmbiz.qpic.cn/sz_mmbiz_png/C0nicuvoMeDGV17T0clR6DXicvSk4srVCBlVzPAHAogQfhNkaHoARRYOpNepwtaS1Rt5voPee67ibdOUI77C0Gkxg/640?wx_fmt=png&amp;from=appmsg"></p><p><span>直接上代码：</span></p><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><pre data-tool="mdnice编辑器"><span></span><code><span>##### step03.细胞注释 #####</span><br><br><span>if</span>(F){<br>  <span># 差异分析法注释</span><br>  dir.create(<span>"3-cell"</span>);setwd(<span>"./3-cell"</span>)<br>  sce &lt;- readRDS(<span>"../2-harmony/sce.all_int.rds"</span>)<br>  allmarkers &lt;- FindAllMarkers(sce,<br>                               only.pos = TRUE,<br>                               min.pct = 0.25,<br>                               logfc.threshold = 0.25)<br>  top5_markers &lt;- allmarkers %&gt;%<br>  group_by(cluster) %&gt;%<br>  top_n(n = 5, wt = avg_log2FC)<br><br>  <span># 显示每个簇中具有最显著差异表达的前5个基因</span><br>  top5_markers<br><br>  <span># 创建基因的Dot Plot</span><br>  DotPlot(sce, features = unique(top5_markers<span>$gene</span>)) +<br>  theme(axis.text.x = element_text(angle = 90, vjust = 1, size = 8, hjust = 1)) + NoLegend()<br><br>  <span># 创建基因的Heatmap</span><br>  DoHeatmap(sce, features = unique(top5_markers<span>$gene</span>)) +<br>  theme(axis.text.y = ggplot2::element_text(size = 8)) + NoLegend()<br><br>  <span># 保存数据</span><br>  save(allmarkers, top5_markers, file = <span>"markers_integrated.Rdata"</span>)<br>}<br>DimPlot(sce, reduction = <span>"umap"</span>, group.by = <span>"seurat_clusters"</span>, label = T)<br><span>#writeLines(paste0(0:22, ","))</span><br>metadata &lt;- sce@meta.data<br>tab.1=table(metadata$`Celltype (major-lineage)`,metadata<span>$RNA_snn_res</span>.0.8)<br>library(gplots)<br>tab.1<br>pro=<span>'cluster'</span><br>pdf(file = paste0(<span>"2."</span> , pro,<span>'  celltype VS  res.0.8.pdf'</span>),width = 14)<br>balloonplot(tab.1, main =<span>" celltype VS  res.0.8 "</span>, xlab =<span>""</span>, ylab=<span>""</span>,<br>            label = T, show.margins = F)<br>dev.off()<br><br>celltype &lt;- data.table::fread(<span>"manual_annotate.txt"</span>,data.table = F)<br>sce<span>$celltype</span> &lt;- plyr::mapvalues(sce<span>$seurat_clusters</span>, from = 0:22,<br>                                to=celltype<span>$V2</span>)<br><br>DimPlot(sce, reduction = <span>"umap"</span>, group.by = c(<span>"seurat_clusters"</span>,<span>"celltype"</span>), label = T)<br><br>DimPlot(sce, reduction = <span>"umap"</span>, group.by = <span>"celltype"</span>, split.by = <span>"Tissue"</span>,label = T)<br><br>librarian::shelf(scRNAtoolVis)<br>my_pal2 &lt;- c(<span>"#D4477D"</span>, <span>"#D24B27"</span>, <span>"#4DBBD5"</span>, <span>"#6387C5"</span>, <span>"#6E4B9E"</span>, <span>"#C10020"</span>, <span>"#1E78B4"</span>,<span>"#FCBF6E"</span>, <span>"#83AD00"</span>,<span>"#9ebcda"</span>,<br>             <span>"#74a9cf"</span>, <span>"#fbdf72"</span>, <span>"#FF8E00"</span>, <span>"#F37B7D"</span>, <span>"#CF4A31"</span>,<span>"#F37B7D"</span>,<span>"#FF8E00"</span>)<br>cellRatio1&lt;-cellRatioPlot(object = sce,<br>                          sample.name = <span>"Tissue"</span>,<br>                          celltype.name = <span>"celltype"</span>,<br>                          flow.curve = 0.5,<br>                          fill.col = my_pal2)+ theme(<br>  axis.text.x = element_text(<br>    angle = 45,<br>    hjust = 1,<br>    vjust = 1<br>  ));cellRatio1</code></pre></section><p><img data-imgfileid="100003092" data-ratio="0.4361111111111111" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/C0nicuvoMeDGV17T0clR6DXicvSk4srVCBN2Z1XdXCLNSl9JaaJdspH7WnD1XHZwDRLoh7ib4GrpjwsYIwGWeTdSQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" width="1279" src="https://mmbiz.qpic.cn/sz_mmbiz_png/C0nicuvoMeDGV17T0clR6DXicvSk4srVCBN2Z1XdXCLNSl9JaaJdspH7WnD1XHZwDRLoh7ib4GrpjwsYIwGWeTdSQ/640?wx_fmt=png&amp;from=appmsg"><img data-imgfileid="100003091" data-ratio="0.4305555555555556" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/C0nicuvoMeDGV17T0clR6DXicvSk4srVCB7cdkqnXnsuUaPuYGyzF5oJDI2M5QIM9wglwRyJaibgFIcTBSrLW9hGw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" width="1289" src="https://mmbiz.qpic.cn/sz_mmbiz_png/C0nicuvoMeDGV17T0clR6DXicvSk4srVCB7cdkqnXnsuUaPuYGyzF5oJDI2M5QIM9wglwRyJaibgFIcTBSrLW9hGw/640?wx_fmt=png&amp;from=appmsg"><img data-imgfileid="100003090" data-ratio="0.9537037037037037" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/C0nicuvoMeDGV17T0clR6DXicvSk4srVCB1nLicUJDrlDMHjkAjXFSADdlrf8PoU3w26nJjS9kldzLN42GWAicooLA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" width="958" src="https://mmbiz.qpic.cn/sz_mmbiz_png/C0nicuvoMeDGV17T0clR6DXicvSk4srVCB1nLicUJDrlDMHjkAjXFSADdlrf8PoU3w26nJjS9kldzLN42GWAicooLA/640?wx_fmt=png&amp;from=appmsg"></p><p><br></p><p><span>从上面结果可看出 CD4_T, CD8_T, B_cell, DC 和 Tregs 细胞在正常和肿瘤组差异比较明显，然后咱们挑选目标细胞的差异基因进行筛选，构建预后模型等进一步分析。</span></p><hr><p><span>碎碎念：</span></p><ul><li><p><code><span>TISCH2</span></code><span>网站真强大，上面直接整理好了表达矩阵及注释信息，咱们可以直接下载表达矩阵及注释信息，常规降维聚类及注释后挑选目标基因，让你的文章big满满，超赞。</span></p></li><li><p><span>细胞注释还是要多练，最好能总结下自己常用的 cellmarker。</span></p></li></ul><p><br></p><p><span>参考链接：</span></p><ul><li><p><a href="https://mp.weixin.qq.com/s?__biz=MzkxMjU0MjM0NQ==&amp;mid=2247485615&amp;idx=1&amp;sn=8b9e6be931f03eb5af78af5baf897e64&amp;scene=21#wechat_redirect" data-href="https://mp.weixin.qq.com/s?__biz=MzkxMjU0MjM0NQ==&amp;mid=2247485615&amp;idx=1&amp;sn=8b9e6be931f03eb5af78af5baf897e64&amp;scene=21#wechat_redirect" target="_blank" data-linktype="2"><span>单细胞转录组：手动/自动注释细胞亚群(微信公众号:宇言生信)</span></a></p></li><li><p><a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247507852&amp;idx=3&amp;sn=0a2d157fe76985af2f55306505f5fb30&amp;scene=21#wechat_redirect" data-href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247507852&amp;idx=3&amp;sn=0a2d157fe76985af2f55306505f5fb30&amp;scene=21#wechat_redirect" target="_blank" data-linktype="2"><span>单细胞转录组的普通降维聚类分群流程（仅需800元）(微信公众号:生信技能树)</span></a></p></li><li><p><a href="https://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247520597&amp;idx=1&amp;sn=ecbdc314efcde02b8780c774b221bb41&amp;scene=21#wechat_redirect" data-href="https://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247520597&amp;idx=1&amp;sn=ecbdc314efcde02b8780c774b221bb41&amp;scene=21#wechat_redirect" target="_blank" data-linktype="2"><span>乳腺癌第一层次降维聚类分群复现(微信公众号:单细胞天地)</span></a></p></li><li><p><span>单细胞专题 | 从GEO数据库中下载并批量读取单细胞数据——10X标准文件(生信大爆炸公众号)</span></p></li><li><p><span>单细胞专题 | Seurat V5 一行代码去除批次效应(生信大爆炸公众号)</span></p></li><li><p><span>单细胞专题 | 细胞类型注释的十八般武艺(生信大爆炸公众号)</span></p></li></ul><p><br></p><p><span>声明：本文绝大部分代码均整理自生信技能树、单细胞天地等，仅供交流学习，禁止用于商业用途，如有侵权，请联系删除。鉴于本人水平有限，某些内容难免理解不到位，还请各位大佬多多指教。</span></p><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/mUxb2uGEbQOTfNFl4SSRvg",target="_blank" rel="noopener noreferrer">原文链接</a>
