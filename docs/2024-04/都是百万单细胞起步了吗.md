---
title: "都是百万单细胞起步了吗"
date: 2024-04-25T02:52:52Z
draft: ["false"]
tags: [
  "fetched",
  "生信菜鸟团"
]
categories: ["Acdemic"]
---
都是百万单细胞起步了吗 by 生信菜鸟团
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><blockquote data-tool="mdnice编辑器"><span></span><p>交流群有小伙伴提问不知道如何处理130万这个数量级的单细胞转录组数据，让我感觉很有意思，因为普通人是很难接触到这个数据量的单细胞项目，如果有这个实力那么理所当然知道如何处理不至于来微信交流群问。。。。</p></blockquote><p><img data-galleryid="" data-imgfileid="100037969" data-ratio="0.9685990338164251" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Losic3w7yeOcyibIQVagYzgpZicMQgzLFjDSXtk1pUCWVrIL2k8N5KxAP62YqmRuAyicX0LA1glo6jf0cnw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="828" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Losic3w7yeOcyibIQVagYzgpZicMQgzLFjDSXtk1pUCWVrIL2k8N5KxAP62YqmRuAyicX0LA1glo6jf0cnw/640?wx_fmt=png&amp;from=appmsg"></p><figure data-tool="mdnice编辑器"><figcaption>130万这个数量级的单细胞转录组数据</figcaption></figure><p data-tool="mdnice编辑器">也就是说，普通人其实并没有这个能力也不需要面临这样的130万这个数量级的单细胞转录组数据的烦恼！我们拿这个HRA002184数据集举例：</p><ul data-tool="mdnice编辑器"><li><section>https://ngdc.cncb.ac.cn/gsa-human/browse/HRA002184</section></li></ul><p data-tool="mdnice编辑器">它对应的文章是：《<strong>Single-cell analyses implicate ascites in remodeling the ecosystems of primary and metastatic tumors in ovarian cancer</strong>》，数据集页面就描述的很清楚， 是：225,373 high-quality cell profiles from primary ovarian tumour, peritoneal metastasis tumour, pelvic lymph node, malignant ascites, and peripheral blood mononuclear cell (PBMC) samples.</p><p data-tool="mdnice编辑器">页面的 <strong>个体和样本信息</strong> 显示的这个研究是14个病人的39个样品，如下所示：</p><p><img data-galleryid="" data-imgfileid="100037970" data-ratio="0.3838903170522708" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Losic3w7yeOcyibIQVagYzgpZicMu6MaIR6jIFk6WgmKgXrdfMjaL7sWkG4aRlrjD6icmajPNCuPbX9oReQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="2334" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Losic3w7yeOcyibIQVagYzgpZicMu6MaIR6jIFk6WgmKgXrdfMjaL7sWkG4aRlrjD6icmajPNCuPbX9oReQ/640?wx_fmt=png&amp;from=appmsg"></p><figure data-tool="mdnice编辑器"><figcaption>14个病人的39个样品</figcaption></figure><p data-tool="mdnice编辑器">这样的样品数量，拿到225,373 的细胞数量是合理的，因为每个10x技术的单细胞转录组样品都应该是5到8千的细胞数量。那么为什么有人会以为这个研究有130万这个数量级的单细胞转录组数据，因为初学者可能会不太懂单细胞的测序数据结构。以为页面里面的run就是每个10x样品，其实是每个样品可以有多个run</p><h3 data-tool="mdnice编辑器"><span></span><span>关于国家基因组科学数据中心</span><span></span></h3><p data-tool="mdnice编辑器">国家基因组科学数据中心（National Genomics Data Center, NGDC）的人类遗传资源组学原始数据归档库（Genome Sequence Archive for Human, GSA-Human）是一个用于收集、存储、管理和共享人类遗传资源原始数据的数据库。在GSA-Human中，数据格式和ID标识遵循一定的规范，以确保数据的准确性和可追溯性。</p><ol data-tool="mdnice编辑器"><li><section><strong>HRI ID</strong>：HRI代表“Human Research Individual”，即个体的标识符。每个在GSA-Human数据库中存储的个体或样本都会有一个唯一的HRI ID，用于标识特定的个体或样本。</section></li><li><section><strong>HRS ID</strong>：HRS代表“Human Research Sample”，即样本的标识符。与HRI ID类似，HRS ID用于唯一标识一个样本。</section></li><li><section><strong>HRR ID</strong>：HRR代表“Human Research Run”，可能指的是测序运行的标识符。它可能用于标识特定的测序实验或测序批次。</section></li><li><section><strong>HRX ID</strong>：HRX的具体含义在提供的文档中没有明确说明，但根据上下文推测，它可能代表与人类遗传资源相关的某种特定数据集或实验的标识符。</section></li></ol><p data-tool="mdnice编辑器">如下所示可以看到每个HRS的编号都会对应很多HRR的编号 ：</p><p><img data-galleryid="" data-imgfileid="100037968" data-ratio="0.22814982973893302" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Losic3w7yeOcyibIQVagYzgpZicMeicPIgFCuMic2526lMUuF8ibOlriaVgibBPsWwCkbeSBHxBic6NGFwcEJ7ibg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1762" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Losic3w7yeOcyibIQVagYzgpZicMeicPIgFCuMic2526lMUuF8ibOlriaVgibBPsWwCkbeSBHxBic6NGFwcEJ7ibg/640?wx_fmt=png&amp;from=appmsg"></p><figure data-tool="mdnice编辑器"><figcaption> </figcaption></figure><p data-tool="mdnice编辑器">所以，虽然说我们可以看到 926个fq文件，其实对应的是463个run，因为每个run在这个作者上传的fq1和fq2文件，如下所示：</p><pre data-tool="mdnice编辑器"><span></span><code>ls -lh */*gz|cut -d<span>" "</span> -f 6-|head<br>2.9G Mar 26 17:26 HRR649563/HRR649563_S1_L001_R1_001.fastq.gz<br> 11G Mar 26 17:25 HRR649563/HRR649563_S1_L001_R2_001.fastq.gz<br>3.1G Mar 26 21:32 HRR649564/HRR649564_S1_L001_R1_001.fastq.gz<br> 12G Mar 26 21:31 HRR649564/HRR649564_S1_L001_R2_001.fastq.gz<br>2.5G Mar 26 15:16 HRR649565/HRR649565_S1_L001_R1_001.fastq.gz<br>9.4G Mar 26 15:18 HRR649565/HRR649565_S1_L001_R2_001.fastq.gz<br>2.5G Mar 26 10:58 HRR649566/HRR649566_S1_L001_R1_001.fastq.gz<br>9.6G Mar 26 10:58 HRR649566/HRR649566_S1_L001_R2_001.fastq.gz<br>139M Mar 26 12:41 HRR649567/HRR649567_S1_L001_R1_001.fastq.gz<br>499M Mar 26 12:41 HRR649567/HRR649567_S1_L001_R2_001.fastq.gz<br><br></code></pre><p data-tool="mdnice编辑器">但是这个463个run，对应的很明显就39个样品，所以实际上在修改他们的名字的时候，就不能是采用上面的规则。。。。</p><p data-tool="mdnice编辑器">而且从文件大小也可以看出来的，上面的每个run的fq1和fq2文件都不大啊，如果是真正的10x单细胞转录组，比如：PRJCA007562，可以看到每个样品的fq1和fq2文件是很大的：</p><pre data-tool="mdnice编辑器"><span></span><code>12G 8月  31 12:48 HRR568828_f1.fastq.gz<br>44G 8月  31 18:38 HRR568828_r2.fastq.gz<br>18G 8月  31 13:32 HRR568829_f1.fastq.gz<br>70G 8月  31 23:18 HRR568829_r2.fastq.gz<br>47G 9月   1 01:05 HRR568830_r2.fastq.gz<br>13G 8月  31 14:17 HRR568831_f1.fastq.gz<br>47G 9月   1 01:35 HRR568831_r2.fastq.gz <br></code></pre><p data-tool="mdnice编辑器">这样的10x单细胞转录组技术，必须是以样品为单位的修改名字哦！比如我们前面介绍的<a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247511452&amp;idx=2&amp;sn=83ec97cbc3334a6095e6d63e05e9fd6e&amp;scene=21#wechat_redirect" data-linktype="2">不知道10x单细胞转录组样品和fastq文件的对应关系</a>，就是多个run的fq文件修改为样品开头的文件：</p><pre data-tool="mdnice编辑器"><span></span><code>7_S1_L001_R1_001.fastq.gz -&gt; /home/PRJNA762594/SRR15860132_1.fastq.gz<br>7_S1_L001_R2_001.fastq.gz -&gt; /home/PRJNA762594/SRR15860132_2.fastq.gz<br>7_S1_L002_R1_001.fastq.gz -&gt; /home/PRJNA762594/SRR15860143_1.fastq.gz<br>7_S1_L002_R2_001.fastq.gz -&gt; /home/PRJNA762594/SRR15860143_2.fastq.gz<br>7_S1_L003_R1_001.fastq.gz -&gt; /home/PRJNA762594/SRR15860154_1.fastq.gz<br>7_S1_L003_R2_001.fastq.gz -&gt; /home/PRJNA762594/SRR15860154_2.fastq.gz<br>7_S1_L004_R1_001.fastq.gz -&gt; /home/PRJNA762594/SRR15860155_1.fastq.gz<br>7_S1_L004_R2_001.fastq.gz -&gt; /home/PRJNA762594/SRR15860155_2.fastq.gz<br></code></pre><p data-tool="mdnice编辑器">一个样品可以有三五个run，甚至可以有成百上千个run，但是它仍然是一个样品只能说是跑一次cellranger得到一个表达量矩阵哦。在处理fastq文件时，如果遇到多个样品或多个测序通道的情况，需要仔细地按照fastq文件的命名规则进行整理和重命名，以确保数据分析的准确性。比如我在<a href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247512340&amp;idx=3&amp;sn=1b9609a8870a0209dd27ffdcbc3cac87&amp;chksm=9b4bf1afac3c78b90674678fcec66365b9faaa275ff4b0a2255e0a05fa8b905e15222a643bea&amp;scene=21#wechat_redirect" data-linktype="2">10X单细胞转录组原始测序数据的Cell Ranger流程（仅需800元）</a> 演示的：</p><pre data-tool="mdnice编辑器"><span></span><code>SIGAA11_S40_L007_R1_001.fastq.gz<br>SIGAA11_S40_L007_R2_001.fastq.gz<br>SIGAA11_S40_L007_I1_001.fastq.gz<br>SIGAA11_S40_L008_R1_001.fastq.gz<br>SIGAA11_S40_L008_R2_001.fastq.gz<br>SIGAA11_S40_L008_I1_001.fastq.gz<br>SIGAA11_S40_L009_R1_001.fastq.gz<br>SIGAA11_S40_L009_R2_001.fastq.gz<br>SIGAA11_S40_L009_I1_001.fastq.gz<br></code></pre><p data-tool="mdnice编辑器">针对10x单细胞转录组的fastq文件，其命名通常遵循一定的规则，这些规则有助于识别样品的来源和测序过程中的不同阶段。根据您提供的文件名示例，我们可以分析出以下规律：</p><ol data-tool="mdnice编辑器"><li><section><strong>样品标识</strong>：<code>SIGAA11</code> 通常表示特定的样品名称或ID，用于区分不同的样品。</section></li><li><section><strong>样品序号</strong>：<code>S40</code> 表示该样品在测序运行中的序号。在10X技术中，<code>S</code>后面的数字通常用来标识样品的唯一性，特别是在一个实验中处理多个样品时。</section></li><li><section><strong>库标识</strong>：<code>L009</code> 表示该样品被分配到的库（Library）编号。在一次测序运行中，一个样品可能会被分成多个库进行测序，以增加测序深度或处理样品量。</section></li><li><section><strong>测序通道</strong>：<code>R1</code> 和 <code>R2</code> 表示测序的两个独立通道。在10X单细胞转录组测序中，<code>R1</code> 通常代表细胞barcode和UMI（Unique Molecular Identifier），而 <code>R2</code> 代表实际的cDNA序列。</section></li><li><section><strong>索引文件</strong>：<code>I1</code> 有时候也会出现在文件名中，它通常包含了测序的索引信息，但在某些情况下，如第一个搜索结果3所述，<code>I1</code> 文件理论上可以抛弃，因为所需的信息已经在 <code>R1</code> 和 <code>R2</code> 中包含了。</section></li><li><section><strong>文件格式</strong>：<code>.fastq.gz</code> 表示这是一个经过压缩的fastq格式文件。Fastq格式是一种文本文件，包含了测序得到的核酸序列及其质量分数。</section></li><li><section><strong>文件后缀</strong>：<code>_001</code> 这通常表示该文件是该样品测序数据的一部分，有时一个样品的测序数据会分成多个文件存储，后缀用来区分这些文件。</section></li></ol><p data-tool="mdnice编辑器">在处理这些fastq文件时，需要确保文件名的一致性和正确性，以便在后续的数据分析流程中，如使用Cell Ranger软件进行单细胞转录组数据分析时，能够正确地识别和处理这些数据。</p><p data-tool="mdnice编辑器">只需要是合理的修改好名字，正常走cellranger的定量流程即可，代码我已经是多次分享了。参考：</p><ul data-tool="mdnice编辑器"><li><section><a href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247512340&amp;idx=3&amp;sn=1b9609a8870a0209dd27ffdcbc3cac87&amp;chksm=9b4bf1afac3c78b90674678fcec66365b9faaa275ff4b0a2255e0a05fa8b905e15222a643bea&amp;scene=21#wechat_redirect" data-linktype="2">10X单细胞转录组原始测序数据的Cell Ranger流程（仅需800元）</a></section></li><li><section><a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247496813&amp;idx=1&amp;sn=4151bf2265618eff4e0123722c50e569&amp;scene=21#wechat_redirect" data-linktype="2">10X的单细胞转录组原始数据也可以在EBI下载</a></section></li><li><section><a href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247510920&amp;idx=1&amp;sn=c4561d34e984406693c014cdfe236c0f&amp;chksm=9b4beb33ac3c622542d894344c323ff7cca52f69119d02fc7aa4636af0cbe7df4b6c63dd5ba9&amp;scene=21#wechat_redirect" data-linktype="2">一个10x单细胞转录组项目从fastq到细胞亚群</a></section></li><li><section><a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247513565&amp;idx=1&amp;sn=092e637017d176c43f00a295d3210592&amp;scene=21#wechat_redirect" data-linktype="2">一文打通单细胞上游：从软件部署到上游分析</a></section></li><li><section><a href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247513605&amp;idx=1&amp;sn=e86a329c887745c6d00d3ededa39dcda&amp;chksm=9b4bf6beac3c7fa8523cef4e7189fb20b914460ddb61e6cd1dd520b5928e1b59a8b7827ce783&amp;scene=21#wechat_redirect" data-linktype="2">PRJNA713302这个10x单细胞fastq实战</a></section></li><li><section><a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247513968&amp;idx=1&amp;sn=f5a44a7bea0bdacd8af1a20c177763e5&amp;scene=21#wechat_redirect" data-linktype="2">一次曲折且昂贵的单细胞公共数据获取与上游处理</a></section></li><li><section><a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247514146&amp;idx=1&amp;sn=b9721433d49a2d963eeaab1ad47fc91b&amp;scene=21#wechat_redirect" data-linktype="2">只能下载bam文件的10x单细胞转录组项目数据处理</a></section></li><li><section><a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247511452&amp;idx=2&amp;sn=83ec97cbc3334a6095e6d63e05e9fd6e&amp;scene=21#wechat_redirect" data-linktype="2">不知道10x单细胞转录组样品和fastq文件的对应关系</a></section></li><li><section><a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247508521&amp;idx=2&amp;sn=2cf3158e74d37b3a741908d8bfc8f02f&amp;scene=21#wechat_redirect" data-linktype="2">10X单细胞转录组测序数据的 SRA转fastq踩坑那些事</a></section></li><li><section><a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247514395&amp;idx=2&amp;sn=96c505b76ae87dd0efa737c4c44e2270&amp;scene=21#wechat_redirect" data-linktype="2">10x的单细胞转录组fastq文件的R1和R2不能弄混哦</a></section></li></ul><p data-tool="mdnice编辑器">最后可以得到如下所示的每个样品的表达量矩阵文件以及对应的报表：</p><p><img data-galleryid="" data-imgfileid="100037971" data-ratio="1.4142857142857144" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Losic3w7yeOcyibIQVagYzgpZicMRTIDP6z0bbB4JCXXdQCOsbwGnVfzVhyic2AnXXpCPznM6dkzvtRvlcg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="420" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Losic3w7yeOcyibIQVagYzgpZicMRTIDP6z0bbB4JCXXdQCOsbwGnVfzVhyic2AnXXpCPznM6dkzvtRvlcg/640?wx_fmt=png&amp;from=appmsg"></p><figure data-tool="mdnice编辑器"><figcaption>每个样品的表达量矩阵文件以及对应的报表</figcaption></figure><p data-tool="mdnice编辑器">也就是说，<strong>上面的研究是14个病人的39个样品，所以理论上就应该是出来39个文件夹而已。也就是22.5万个细胞而已。</strong></p></section><h3 data-tool="mdnice编辑器"><span>文末友情宣传</span></h3><p data-tool="mdnice编辑器"><strong>强烈建议你推荐给身边的博士后以及年轻生物学PI，多一点数据认知，让他们的科研上一个台阶：</strong></p><ul data-tool="mdnice编辑器"><li><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247530001&amp;idx=1&amp;sn=676dcf224f9be23b288189775292aeeb&amp;chksm=9b4b36aaac3cbfbc3e3bb0865bd789d5093e3a643f3f345332995f707b7f209ae924e9e9529e&amp;scene=21#wechat_redirect" textvalue="生物信息学马拉松授课（买‍一得五）" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1">生物信息学马拉松授课（买一得五）</a> ，你的生物信息学入门课</section></li><li><section><a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247524148&amp;idx=1&amp;sn=7806da6feb41a36493c519c1cfc1d3ac&amp;scene=21#wechat_redirect" data-linktype="2">时隔5年，我们的生信技能树VIP学徒继续招生啦</a></section></li><li><section><a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247528363&amp;idx=1&amp;sn=5e02f3e9b2e148191e23ebc2c0d780e7&amp;scene=21#wechat_redirect" data-linktype="2">2024的共享服务器交个朋友福利价仍然是800</a></section></li><li><section><a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247519765&amp;idx=1&amp;sn=ce5a8c8182f854c88043059f8c2cb9ff&amp;scene=21#wechat_redirect" data-linktype="2">千呼万唤始出来的独享生物信息学云服务器</a></section></li><li><section><a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247528144&amp;idx=1&amp;sn=be4d7e542d1077921024c86a4c130f16&amp;scene=21#wechat_redirect" data-linktype="2">永久免费的生信进阶培训（线下）</a></section></li></ul><p><br></p><p><mp-style-type data-value="10000"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/8pQuvX5NUY4FFctZ80mKbg",target="_blank" rel="noopener noreferrer">原文链接</a>
