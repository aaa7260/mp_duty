---
title: "R语言高度自定义添加p值"
date: 2024-04-17T22:19:09Z
draft: ["false"]
tags: [
  "fetched",
  "R语言数据分析指南"
]
categories: ["Acdemic"]
---
R语言高度自定义添加p值 by R语言数据分析指南
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><blockquote data-tool="mdnice编辑器"><span>❝</span><p>本节继续来跟着nature系列期刊学绘图，为条形图自定义添加p值，数据为论文源数据分析方法未严格按照文章进行结果有所不同，整个过程仅参考。希望对各位观众老爷能有所帮助。<strong>「数据+完整代码已经整合上传到会员交流群」</strong>，购买过小编VIP的朋友可在所加的会员群内获取下载，有需要的朋友可关注文末介绍加入VIP交流群。</p><span>❞</span></blockquote><h3 data-tool="mdnice编辑器"><span></span><span><span></span>论文</span><span></span></h3><figure data-tool="mdnice编辑器"><img data-imgfileid="100027396" data-ratio="0.4244256348246675" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAb5Dz7g13nFM9kSOv4L3blOGpliazCm3OVXdYdMEQ3zl6grXowFROKcZyPG4gBmRqO3HOMRWLeBXMA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1654" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAb5Dz7g13nFM9kSOv4L3blOGpliazCm3OVXdYdMEQ3zl6grXowFROKcZyPG4gBmRqO3HOMRWLeBXMA/640?wx_fmt=png&amp;from=appmsg"></figure><figure data-tool="mdnice编辑器"><img data-imgfileid="100027397" data-ratio="0.6707616707616708" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAb5Dz7g13nFM9kSOv4L3blOdq5m5FnGNd8gDnSOlrVj8lyHZibxNhVvMMLCvDoKBMdaSkWppLKEx8w/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1628" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAb5Dz7g13nFM9kSOv4L3blOdq5m5FnGNd8gDnSOlrVj8lyHZibxNhVvMMLCvDoKBMdaSkWppLKEx8w/640?wx_fmt=png&amp;from=appmsg"></figure><figure data-tool="mdnice编辑器"><img data-imgfileid="100027395" data-ratio="0.7975567190226877" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAb5Dz7g13nFM9kSOv4L3blO4AshHibjlRlOiaxFL6g5HCJ8725wtwbOicq7Cu3lNy0BGyEIibHCYfsJuQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1146" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAb5Dz7g13nFM9kSOv4L3blO4AshHibjlRlOiaxFL6g5HCJ8725wtwbOicq7Cu3lNy0BGyEIibHCYfsJuQ/640?wx_fmt=png&amp;from=appmsg"></figure><blockquote data-tool="mdnice编辑器"><span>❝</span><p>有需要学习数据可视化的朋友欢迎购买小编的R数据可视化案例文档，目前内容包含公众号(2023+2024)的绘图文档，<strong>「已经更新上传了150+案例文档」</strong>，每个案例都附有相应的数据和代码，并配有对应的注释文档，方便大家学习和参考。</p><span>❞</span></blockquote><h3 data-tool="mdnice编辑器"><span></span><span><span></span>购买方式</span><span></span></h3><p data-tool="mdnice编辑器"><strong>「淘宝店铺-R语言数据分析指南」</strong>下单购买<strong>「R数据可视化案例文档」</strong>持续更新中</p><h3 data-tool="mdnice编辑器"><span></span><span><span></span>淘宝店铺</span><span></span></h3><p><img data-galleryid="" data-imgfileid="100019415" data-ratio="1.0210420841683367" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/EibnicgwScTAbvhPDLGT8NaialEsht92PTYNJWpmVLfoYGic1uha5FyBrDCibibZCLjiazgvpT1XcdwibfVywD2el0VAgg/640?wx_fmt=jpeg" data-type="jpeg" data-w="998" src="https://mmbiz.qpic.cn/mmbiz_jpg/EibnicgwScTAbvhPDLGT8NaialEsht92PTYNJWpmVLfoYGic1uha5FyBrDCibibZCLjiazgvpT1XcdwibfVywD2el0VAgg/640?wx_fmt=jpeg"></p><p data-tool="mdnice编辑器"><strong>「2024更新的绘图内容同时包含数据+代码+markdown注释文档+文档清单」</strong><img data-imgfileid="100027398" data-ratio="0.6176961602671118" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAb5Dz7g13nFM9kSOv4L3blOC88YvxJymAiaboW5leA10cWLzYe5Rauju4Vu8gSI4Ab4NBjImlaVCAQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="2396" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAb5Dz7g13nFM9kSOv4L3blOC88YvxJymAiaboW5leA10cWLzYe5Rauju4Vu8gSI4Ab4NBjImlaVCAQ/640?wx_fmt=png&amp;from=appmsg"></p><h3 data-tool="mdnice编辑器"><span></span><span><span></span>2024年更新案例</span><span></span></h3><p data-tool="mdnice编辑器"><img data-imgfileid="100027399" data-ratio="0.4817432273262662" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAb5Dz7g13nFM9kSOv4L3blOKMrq4h5MFzrB4WwZD6XOXJjKB739DUNicNQPoYNOZicTf9YmicxxMzJUQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1698" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAb5Dz7g13nFM9kSOv4L3blOKMrq4h5MFzrB4WwZD6XOXJjKB739DUNicNQPoYNOZicTf9YmicxxMzJUQ/640?wx_fmt=png&amp;from=appmsg"><img data-imgfileid="100027404" data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAb5Dz7g13nFM9kSOv4L3blOLYb329xSyU9DbM8TcxcN1V2OIqb8IWtAjkd3hbk2mOoAC6dV2qAgug/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAb5Dz7g13nFM9kSOv4L3blOLYb329xSyU9DbM8TcxcN1V2OIqb8IWtAjkd3hbk2mOoAC6dV2qAgug/640?wx_fmt=png&amp;from=appmsg"><img data-imgfileid="100027401" data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAb5Dz7g13nFM9kSOv4L3blOWC4HicZUvJncGmKRa6h3jne5RDibJN10MXeDMr83sjBD0ul5pF2aSJUA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAb5Dz7g13nFM9kSOv4L3blOWC4HicZUvJncGmKRa6h3jne5RDibJN10MXeDMr83sjBD0ul5pF2aSJUA/640?wx_fmt=png&amp;from=appmsg"><img data-imgfileid="100027400" data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAb5Dz7g13nFM9kSOv4L3blOEicfxxlxo6gSoGzHyLyp2VartLGEplcictXgtnqoXsBgs8UNDrhzvXIQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAb5Dz7g13nFM9kSOv4L3blOEicfxxlxo6gSoGzHyLyp2VartLGEplcictXgtnqoXsBgs8UNDrhzvXIQ/640?wx_fmt=png&amp;from=appmsg"><img data-imgfileid="100027403" data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAb5Dz7g13nFM9kSOv4L3blOHBticibQ6dcFFXxqhDtMDbw01pqQB8Hw7rO41bGvOzeic1DYO1qZrLBHA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAb5Dz7g13nFM9kSOv4L3blOHBticibQ6dcFFXxqhDtMDbw01pqQB8Hw7rO41bGvOzeic1DYO1qZrLBHA/640?wx_fmt=png&amp;from=appmsg"><img data-imgfileid="100027402" data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAb5Dz7g13nFM9kSOv4L3blOZvz0fBgveNMFiaibqHxSic0krB3mxsFR4cZA39h2EzWPibFEkgYHkX6B1A/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAb5Dz7g13nFM9kSOv4L3blOZvz0fBgveNMFiaibqHxSic0krB3mxsFR4cZA39h2EzWPibFEkgYHkX6B1A/640?wx_fmt=png&amp;from=appmsg"><img data-imgfileid="100027405" data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAb5Dz7g13nFM9kSOv4L3blOPR3skibOjR9TlVSpibGnQdgF3nasb6MoL1IjS2L7Vu4SPYVcAltbbZ8Q/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAb5Dz7g13nFM9kSOv4L3blOPR3skibOjR9TlVSpibGnQdgF3nasb6MoL1IjS2L7Vu4SPYVcAltbbZ8Q/640?wx_fmt=png&amp;from=appmsg"><img data-imgfileid="100027408" data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAb5Dz7g13nFM9kSOv4L3blO7qxwljrZ6k9atWpBKEIdQAOKEiaHnvRt7KDic35yYTrySrKt3C8upqGQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAb5Dz7g13nFM9kSOv4L3blO7qxwljrZ6k9atWpBKEIdQAOKEiaHnvRt7KDic35yYTrySrKt3C8upqGQ/640?wx_fmt=png&amp;from=appmsg"><img data-imgfileid="100027409" data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAb5Dz7g13nFM9kSOv4L3blOerrkLWXeJLPoSJ1HyYibU8dg1BxH7DDTbyI8mSzX5LPdib6B7mEp6Rdw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAb5Dz7g13nFM9kSOv4L3blOerrkLWXeJLPoSJ1HyYibU8dg1BxH7DDTbyI8mSzX5LPdib6B7mEp6Rdw/640?wx_fmt=png&amp;from=appmsg"><img data-imgfileid="100027407" data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAb5Dz7g13nFM9kSOv4L3blOpQaax8g82S6k3uMaB1dEySlVc3p0WRf8ic8baXZibjiadPx91xd3z2qeQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAb5Dz7g13nFM9kSOv4L3blOpQaax8g82S6k3uMaB1dEySlVc3p0WRf8ic8baXZibjiadPx91xd3z2qeQ/640?wx_fmt=png&amp;from=appmsg"><img data-imgfileid="100027406" data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAb5Dz7g13nFM9kSOv4L3blOGpANWicOdZeFeZpWBWO4ocABlfD9tMwu0KFoTS6OVhB2qFia0dWQXFYA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAb5Dz7g13nFM9kSOv4L3blOGpANWicOdZeFeZpWBWO4ocABlfD9tMwu0KFoTS6OVhB2qFia0dWQXFYA/640?wx_fmt=png&amp;from=appmsg"><img data-imgfileid="100027414" data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAb5Dz7g13nFM9kSOv4L3blOSXgPZA4ibKm3blyvbt7rQibE4rYUzoPa4Guyzibx5hSC2JnibBVufrDNUg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAb5Dz7g13nFM9kSOv4L3blOSXgPZA4ibKm3blyvbt7rQibE4rYUzoPa4Guyzibx5hSC2JnibBVufrDNUg/640?wx_fmt=png&amp;from=appmsg"></p><h3 data-tool="mdnice编辑器"><span></span><span><span></span>加载R包</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code><span>library</span>(tidyverse)<br><span>library</span>(readxl)<br><span>library</span>(ggpubr)<br><span>library</span>(rstatix)<br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span><span></span>R包版本</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code>other attached packages:<br> [1] rstatix_0.7.2   ggpubr_0.6.0    readxl_1.4.3    lubridate_1.9.3 forcats_1.0.0   stringr_1.5.1   dplyr_1.1.4     purrr_1.0.2    <br> [9] readr_2.1.5     tidyr_1.3.1     tibble_3.2.1    ggplot2_3.5.0   tidyverse_2.0.0<br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span><span></span>导入数据</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code>df &lt;- read_excel(<span>"data.xlsx"</span>) %&gt;% pivot_longer(-type) %&gt;% <br>  mutate(value=round(value,digits = <span>1</span>))<br><br>df_p_val &lt;- df %&gt;% group_by(type) %&gt;%<br>  t_test(value ~name) %&gt;%<br>  adjust_pvalue(p.col=<span>"p"</span>) %&gt;%<br>  add_significance(p.col=<span>"p.adj"</span>)<br><br>df %&gt;% ggplot(.,aes(name,value)) + <br>  geom_jitter(width = <span>0.1</span>)+<br>  stat_summary(aes(fill=name),<br>               fun=<span>"mean"</span>,geom=<span>"bar"</span>,size=<span>0.4</span>,width = <span>0.5</span>,color=<span>"black"</span>,<br>               position = position_dodge(<span>0.5</span>))+<br>  stat_summary(aes(fill=name),<br>               fun.data =<span>"mean_se"</span>,geom=<span>"errorbar"</span>,width=<span>0.1</span>,size=<span>0.3</span>,<br>               position = position_dodge(<span>0.5</span>))+<br>  scale_fill_manual(values = c(<span>"#7294D4"</span>,<span>"#E6A0C4"</span>))+<br>  labs(x=<span>NULL</span>,y=<span>NULL</span>)+<br>  theme(legend.position = <span>"none"</span>,<br>        axis.ticks.x=element_blank(),<br>        panel.background = element_blank(),<br>        plot.background = element_blank(),<br>        plot.margin =margin(<span>0.5</span>,<span>0.5</span>,<span>0.5</span>,<span>0.5</span>,unit=<span>"cm"</span>))<br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span><span></span>关注下方公众号下回更新不迷路</span><span></span></h3><section><mp-common-profile data-pluginname="mpprofile" data-id="Mzg3MzQzNTYzMw==" data-headimg="http://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZF0rpeZII9Ltl26VbVagriczTria1fib3XgjwwHEHFjPzkmGpqWDVVHBSzhENictUM2iavAKiaM5lc9USw/0?wx_fmt=png" data-nickname="R语言数据分析指南" data-alias="YanJANtwo" data-signature="R语言重症爱好者，喜欢绘制各种精美的图表，喜欢的小伙伴可以关注我，跟我一起学习" data-from="0" data-is_biz_ban="0"></mp-common-profile></section></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/bdxsv-1107ZNBaa05GIghA",target="_blank" rel="noopener noreferrer">原文链接</a>
