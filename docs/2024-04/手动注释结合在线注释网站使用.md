---
title: "手动注释结合在线注释网站使用"
date: 2024-04-19T03:13:31Z
draft: ["false"]
tags: [
  "fetched",
  "生信漫漫学"
]
categories: ["Acdemic"]
---
手动注释结合在线注释网站使用 by 生信漫漫学
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><h3 data-tool="mdnice编辑器"><span></span><span></span><span>写在开头</span><span></span></h3><p data-tool="mdnice编辑器">处理了个不太熟悉的组织——<code>GSE185042</code>肝脏的单细胞数据，在进行亚群细分的时候可花了一些心思。</p><ul data-tool="mdnice编辑器"><li><section><p>首先是<strong>基于chtaGPT找Marker基因以及结合<a href="https://mp.weixin.qq.com/mp/appmsgalbum?action=getalbum&amp;__biz=MzI1Njk4ODE0MQ==&amp;scene=21&amp;album_id=2350231750729433089&amp;count=3&amp;uin=&amp;key=&amp;devicetype=Windows+11+x64&amp;version=63090926&amp;lang=zh_CN&amp;ascene=0#wechat_redirect" data-linktype="2">#标记基因</a>中的Marker基因整理了一下肝脏相关的gene_list</strong></p></section></li><li><section><p>然后命名之后感觉不大对劲，因为<strong>Kuffer cell和macrophage</strong>尊的有点难分！所以<strong>使用ACT在线网页注释</strong>了一下。</p></section></li><li><section><p>最后<strong>结合手动的marker基因集，ACT注释的结果以及文章里面的第一层次降维聚类分群结果</strong>给亚群命名！</p></section></li></ul><figure data-tool="mdnice编辑器"><img data-imgfileid="100003653" data-ratio="0.7904374364191251" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9ZJhs8rBe8vauiaNXSwUFgJ6y5GCaAIcZ8JpHibfOdyFrP15NmehnXyHrtqzIhxkQwYia8skJqQhlpibA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="983" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9ZJhs8rBe8vauiaNXSwUFgJ6y5GCaAIcZ8JpHibfOdyFrP15NmehnXyHrtqzIhxkQwYia8skJqQhlpibA/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器">那一起来看看如果是不熟悉的组织，我们如何进行亚群命名叭！</p><h3 data-tool="mdnice编辑器"><span></span><span></span><span>单细胞亚群命名规则及步骤</span><span></span></h3><p data-tool="mdnice编辑器">首先来回顾一下<strong>单细胞亚群命名规则及手动注释步骤</strong></p><h4 data-tool="mdnice编辑器"><span></span><span><a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247529601&amp;idx=1&amp;sn=e2b082386a067cf8b428b4938a21b7e5&amp;scene=21#wechat_redirect" data-linktype="2">单细胞亚群的生物学命名的4个规则</a>：</span><span></span></h4><ul data-tool="mdnice编辑器"><li><section><p><strong>对已知的生物学亚群命名</strong>——需要对每个亚群的生物学背景足够了解，才有可能合理的命名。需要背诵尽可能的的基因和细胞亚群对应关系</p></section></li><li><section><p><strong>顺序编号加上特异性高表达量基因</strong>——在细分亚群的时候如果足够细致，就有可能是没有生物学背景了，这时候就可以使用顺序编号加上特异性高表达量基因</p></section></li><li><section><p>通过<strong>生物学功能进行注释</strong></p></section></li></ul><figure data-tool="mdnice编辑器"><img data-imgfileid="100003652" data-ratio="0.7695167286245354" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9ZJhs8rBe8vauiaNXSwUFgJ6pSKiczsmZQs3d6IhQ3dIcOCUN0MibltdVIFSIV9kmicaA723st3HJ2sFQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1076" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9ZJhs8rBe8vauiaNXSwUFgJ6pSKiczsmZQs3d6IhQ3dIcOCUN0MibltdVIFSIV9kmicaA723st3HJ2sFQ/640?wx_fmt=png&amp;from=appmsg"></figure><ul data-tool="mdnice编辑器"><li><section><strong>转录因子等基因集特异性亚群</strong></section></li></ul><figure data-tool="mdnice编辑器"><img data-imgfileid="100003654" data-ratio="0.6438848920863309" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9ZJhs8rBe8vauiaNXSwUFgJ6mukSuQBy5Y7LKxbia6WsSayrfP67xicQdXHibeR60GHOFLgLcIO78FpYA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1112" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9ZJhs8rBe8vauiaNXSwUFgJ6mukSuQBy5Y7LKxbia6WsSayrfP67xicQdXHibeR60GHOFLgLcIO78FpYA/640?wx_fmt=png&amp;from=appmsg"></figure><h4 data-tool="mdnice编辑器"><span></span><span><a href="https://mp.weixin.qq.com/s?__biz=MzkxOTI0Mjc3Mw==&amp;mid=2247486944&amp;idx=1&amp;sn=72e9ef6d941a0d3d7a244f5286d8fba6&amp;scene=21#wechat_redirect" data-linktype="2">单细胞亚群手动注释步骤</a>：</span><span></span></h4><ul data-tool="mdnice编辑器"><li><section><p>了解样品背景，大致<strong>预估样品细胞成分</strong></p></section></li><li><section><p>收集<strong>整理marker基因</strong></p></section></li><li><section><p>对<strong>已知细胞亚群命名</strong></p></section></li><li><section><p><strong>未知细胞定义</strong></p></section></li></ul><h4 data-tool="mdnice编辑器"><span></span><span>细胞亚群在线注释网站</span><span></span></h4><blockquote data-tool="mdnice编辑器"><span></span><p>ACT——<code>http://biocc.hrbmu.edu.cn/ACT/</code></p><p>PanglaoDB——<code>https://panglaodb.se/search.html</code></p></blockquote><h3 data-tool="mdnice编辑器"><span></span><span></span><span>手动注释结合在线注释网站</span><span></span></h3><h4 data-tool="mdnice编辑器"><span></span><span>手动注释结果</span><span></span></h4><p data-tool="mdnice编辑器">因为对样品背景不熟悉，所以根据文献大概了解了样品中的细胞成分</p><figure data-tool="mdnice编辑器"><img data-imgfileid="100003655" data-ratio="1.2292020373514432" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9ZJhs8rBe8vauiaNXSwUFgJ6vtjSSnTgjqccFVrL8fpXwGlX1AoHseb3tvibOibEiczSWtABdat3PxCpA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1178" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9ZJhs8rBe8vauiaNXSwUFgJ6vtjSSnTgjqccFVrL8fpXwGlX1AoHseb3tvibOibEiczSWtABdat3PxCpA/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器">结合<strong>基于chtaGPT找Marker基因以及结合<a href="https://mp.weixin.qq.com/mp/appmsgalbum?action=getalbum&amp;__biz=MzI1Njk4ODE0MQ==&amp;scene=21&amp;album_id=2350231750729433089&amp;count=3&amp;uin=&amp;key=&amp;devicetype=Windows+11+x64&amp;version=63090926&amp;lang=zh_CN&amp;ascene=0#wechat_redirect" data-linktype="2">#标记基因</a>中的Marker基因整理了一下肝脏相关的gene_list</strong></p><pre data-tool="mdnice编辑器"><span></span><code><span>#肝脏相关gene_list整理</span><br><br>Kupffer = c(<span>"CD163"</span>, <span>"CD206"</span>, <span>"F4/80"</span>, <span>"CD68"</span>) <br>endothelial = c(<span>"CLDN5"</span>, <span>"ABCB1"</span>, <span>"EBF1"</span>,<span>"CD31"</span>,<span>"VWF"</span>) <br>macrophage = c(<span>'Adgre1'</span>, <span>'Cd14'</span>,  <span>'Fcgr3'</span>)<br>Cholangiocyte = c(<span>"CK7"</span>, <span>"CK19"</span>, <span>"SOX9"</span>,<span>"EpCAM"</span>,<span>"FYXD2"</span>,<span>"TM4SF4"</span>,<span>"ANXA4"</span>) <br>Hepatocyte = c(<span>"ALB"</span>, <span>"AFP"</span>, <span>"CYP2E1"</span>,<span>"HNF4A"</span>,<span>"ASGR1"</span>,<span>"APOC3"</span>,<span>"FABP1"</span>,<span>" APOA1"</span>) <br>Dividing=<span>'Ki-67,PCNA,MCM2,AURKA'</span><br>PlasmaB=<span>'CD138,CD19,CD20,CD27,CD38,IRF4'</span><br>Hepatic_stellate=c(  <span>'GFAP'</span>, <span>'PDGFRβ'</span>,<span>"ACTA2"</span>,<span>"COL1A1"</span>)<br>cDCs=c(<span>'Xcr1'</span>, <span>'Flt3'</span>,  <span>'Ccr7'</span>)<br>pDCs=c(<span>'Siglech'</span>, <span>'Clec10a'</span>,  <span>'Clec12a'</span>)<br><br>gene_list = list(<br>  Kup = Kupffer,<br>  endo = endothelial,<br>  macr = macrophage ,<br>  Chol = Cholangiocyte,<br>  Hepato = Hepatocyte, <br>  Dividing = Dividing,<br>  PlasmaB = PlasmaB,<br>  Hepatic = Hepatic_stellate,<br>  pDCs=pDCs,<br>  cDCs=cDCs<br>)<br>gene_list = lapply(gene_list,<span>function</span>(x){<br>  unique( c(str_to_title(x),str_to_upper(x)))<br>} )<br>gene_list<br>p3=DotPlot(sce.all.int, assay = <span>"RNA"</span>, features = gene_list, <br>           group.by = <span>'RNA_snn_res.0.1'</span><br>) + theme(axis.text.x = element_text(angle = 45, <br>                                     vjust = 0.5, hjust=0.5))<br>p3<br></code></pre><p data-tool="mdnice编辑器">基于自己整理的gene_list，我就推断<strong>亚群3是macrophage；亚群0和8是Kupffer细胞</strong>，并且结合0.1的亚群聚类结果进行了其他的亚群的判断</p><figure data-tool="mdnice编辑器"><img data-imgfileid="100003651" data-ratio="0.6364692218350755" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9ZJhs8rBe8vauiaNXSwUFgJ6WfXH3OOeCsSp0jlPibCbIXHCLobjLyW8tvwAICldxY6QSaq1AcCE1KA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="861" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9ZJhs8rBe8vauiaNXSwUFgJ6WfXH3OOeCsSp0jlPibCbIXHCLobjLyW8tvwAICldxY6QSaq1AcCE1KA/640?wx_fmt=png&amp;from=appmsg"></figure><figure data-tool="mdnice编辑器"><img data-imgfileid="100003659" data-ratio="1.0435510887772195" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9ZJhs8rBe8vauiaNXSwUFgJ67R84EGxQgICdUw3C0ibmSzU7tUia7UEmytbxr1h4LeBYCCwEYOaWBTQQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1194" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9ZJhs8rBe8vauiaNXSwUFgJ67R84EGxQgICdUw3C0ibmSzU7tUia7UEmytbxr1h4LeBYCCwEYOaWBTQQ/640?wx_fmt=png&amp;from=appmsg"></figure><pre data-tool="mdnice编辑器"><span></span><code><span>#基于marker基因手动注释命名情况</span><br><span>if</span>(F){<br>  sce.all.int<br>  celltype=data.frame(ClusterID=0:12 ,<br>                      celltype= 0:12) <br>  <span>#定义细胞亚群      </span><br>  celltype[celltype<span>$ClusterID</span> %<span>in</span>% c( 0,8 ),2]=<span>'macrophage'</span><br>  celltype[celltype<span>$ClusterID</span> %<span>in</span>% c( 3 ),2]=<span>'Kupffer'</span><br>  celltype[celltype<span>$ClusterID</span> %<span>in</span>% c(  1,6 ),2]=<span>'endothelial'</span><br>  celltype[celltype<span>$ClusterID</span> %<span>in</span>% c(  2 ),2]=<span>'Tcell'</span><br>  celltype[celltype<span>$ClusterID</span> %<span>in</span>% c( 4 ),2]=<span>'Bcell'</span><br>  celltype[celltype<span>$ClusterID</span> %<span>in</span>% c(  5 ),2]=<span>'Hepatocyte'</span><br>  celltype[celltype<span>$ClusterID</span> %<span>in</span>% c( 11 ),2]=<span>'Cholangiocyte'</span><br>  celltype[celltype<span>$ClusterID</span> %<span>in</span>% c( 10 ),2]=<span>'Dividing'</span><br>  celltype[celltype<span>$ClusterID</span> %<span>in</span>% c(  12 ),2]=<span>'Hepatic_stellate'</span><br>  celltype[celltype<span>$ClusterID</span> %<span>in</span>% c( 7 ),2]=<span>'Dendritic'</span><br>  celltype[celltype<span>$ClusterID</span> %<span>in</span>% c( 9 ),2]=<span>'PlasmaB'</span><br>  <br>  head(celltype)<br>  celltype<br>  table(celltype<span>$celltype</span>)<br>  sce.all.int@meta.data<span>$celltype</span> = <span>"NA"</span><br>  <br>  <span>for</span>(i <span>in</span> 1:nrow(celltype)){<br>    sce.all.int@meta.data[<span>which</span>(sce.all.int@meta.data<span>$RNA_snn_res</span>.0.1 == celltype<span>$ClusterID</span>[i]),<span>'celltype'</span>] &lt;- celltype<span>$celltype</span>[i]}<br>  Idents(sce.all.int)=sce.all.int<span>$celltype</span><br>  <br>  sel.clust = <span>"celltype"</span><br>  sce.all.int &lt;- SetIdent(sce.all.int, value = sel.clust)<br>  table(sce.all.int@active.ident) <br>  <br>  dir.create(<span>'check-by-celltype'</span>)<br>  setwd(<span>'check-by-celltype'</span>)<br>  <span>source</span>(<span>'../scRNA_scripts/check-all-markers.R'</span>)<br>  setwd(<span>'../'</span>) <br>  getwd()<br>}<br><br>p_umap=DimPlot(sce.all.int, reduction = <span>"umap"</span>,raster = F,<br>               label = T,repel = T) <br>p_umap <br><br><br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100003657" data-ratio="0.7639175257731958" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9ZJhs8rBe8vauiaNXSwUFgJ6VicMOtvoIVL4a8DmQdOJLT32qibWrjZ20s0Qe2lBicFY4bmSaAoL2dAAg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="970" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9ZJhs8rBe8vauiaNXSwUFgJ6VicMOtvoIVL4a8DmQdOJLT32qibWrjZ20s0Qe2lBicFY4bmSaAoL2dAAg/640?wx_fmt=png&amp;from=appmsg"><figcaption>手动注释</figcaption></figure><p data-tool="mdnice编辑器">可以很明显的发现与文献给的结果还是有出入的，所以还是取了每个cluster的前几个基因去在线网站注释了一下</p><figure data-tool="mdnice编辑器"><img data-imgfileid="100003658" data-ratio="0.7177083333333333" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9ZJhs8rBe8vauiaNXSwUFgJ6OYIibqZNibNnXnFYEicF45D7WpxVO5hYGY5tcBzH8uHPU8GicheDhD7bQw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="960" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9ZJhs8rBe8vauiaNXSwUFgJ6OYIibqZNibNnXnFYEicF45D7WpxVO5hYGY5tcBzH8uHPU8GicheDhD7bQw/640?wx_fmt=png&amp;from=appmsg"></figure><h4 data-tool="mdnice编辑器"><span></span><span>在线网站注释情况</span><span></span></h4><p data-tool="mdnice编辑器">具体的步骤在<a href="https://mp.weixin.qq.com/s?__biz=MzkxOTI0Mjc3Mw==&amp;mid=2247486759&amp;idx=1&amp;sn=fa0dbca7a9e3a7e9e00e6909395465ee&amp;scene=21#wechat_redirect" data-linktype="2">细胞亚群在线注释网站使用</a>里面，大家可以了解一下</p><p data-tool="mdnice编辑器"><strong>Ⅰ 获取每个亚群的TOP基因</strong></p><pre data-tool="mdnice编辑器"><span></span><code><span>#加载数据取TOP基因</span><br>load(file =  <span>'check-by-0.1/qc-_marker_cosg.Rdata'</span>)<br>head(marker_cosg)<br><br><span>## Top10 genes</span><br>library(dplyr)  <br>cat(paste0(<span>'cluster'</span>,0:12,<span>':'</span>,<br>           unlist(apply(marker_cosg<span>$names</span>,2,<span>function</span>(x){<br>             paste(head(x),collapse=<span>','</span>)<br>           })),<span>'\n'</span>))<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100003656" data-ratio="0.5867052023121387" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9ZJhs8rBe8vauiaNXSwUFgJ6SOMiaG9DwZ4tJA9erbR4l4tc4cVZNOQh2U53eUKnq0Axlz101EPNs9w/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="692" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9ZJhs8rBe8vauiaNXSwUFgJ6SOMiaG9DwZ4tJA9erbR4l4tc4cVZNOQh2U53eUKnq0Axlz101EPNs9w/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器"><strong>Ⅱ 根据基因到ACT网站注释</strong></p><p data-tool="mdnice编辑器">要注意<strong>选择正确的物种，这个数据集用到的是<code>Mus musculus</code>不是人哦！</strong></p><p data-tool="mdnice编辑器">（别问 问就是我选了人报错了，然后求助同事的时候才发现没有改物种）</p><figure data-tool="mdnice编辑器"><img data-imgfileid="100003660" data-ratio="0.526171875" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9ZJhs8rBe8vauiaNXSwUFgJ6jjoghiabT7eZxW9buDj90m3jLib9Uia1ic7qfgubHTPccABfDcSiaiclCr2A/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="2560" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9ZJhs8rBe8vauiaNXSwUFgJ6jjoghiabT7eZxW9buDj90m3jLib9Uia1ic7qfgubHTPccABfDcSiaiclCr2A/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器">得到结果之后下载下来本地查看即可，网页结果还有个<strong>Tree of cell ontology</strong>还挺有意思的！</p><figure data-tool="mdnice编辑器"><img data-imgfileid="100003665" data-ratio="0.526171875" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9ZJhs8rBe8vauiaNXSwUFgJ61xPFCQhawatGlUM5fiaytW3Z2wAo6cUxN6RibiauicldNEBMafeuhODRtg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="2560" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9ZJhs8rBe8vauiaNXSwUFgJ61xPFCQhawatGlUM5fiaytW3Z2wAo6cUxN6RibiauicldNEBMafeuhODRtg/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器"><strong>结合手动的marker基因集，ACT注释的结果以及文章里面的第一层次降维聚类分群结果</strong></p><figure data-tool="mdnice编辑器"><img data-imgfileid="100003664" data-ratio="0.37314172447968286" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9ZJhs8rBe8vauiaNXSwUFgJ66LoSF2zzib6bHaXtmncy6icHN1EuziayKpkUb4gEgX92Uy7B39tDerGrg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="2018" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9ZJhs8rBe8vauiaNXSwUFgJ66LoSF2zzib6bHaXtmncy6icHN1EuziayKpkUb4gEgX92Uy7B39tDerGrg/640?wx_fmt=png&amp;from=appmsg"></figure><pre data-tool="mdnice编辑器"><span></span><code><span>if</span>(T){<br>  sce.all.int<br>  celltype=data.frame(ClusterID=0:12 ,<br>                      celltype= 0:12) <br>  <span>#定义细胞亚群      </span><br>  celltype[celltype<span>$ClusterID</span> %<span>in</span>% c( 3 ),2]=<span>'macrophage'</span><br>  celltype[celltype<span>$ClusterID</span> %<span>in</span>% c( 0,8 ),2]=<span>'Kupffer'</span><br>  celltype[celltype<span>$ClusterID</span> %<span>in</span>% c(  1,6 ),2]=<span>'endothelial'</span><br>  celltype[celltype<span>$ClusterID</span> %<span>in</span>% c(  2 ),2]=<span>'Tcell'</span><br>  celltype[celltype<span>$ClusterID</span> %<span>in</span>% c( 4 ),2]=<span>'Bcell'</span><br>  celltype[celltype<span>$ClusterID</span> %<span>in</span>% c(  5 ),2]=<span>'Hepatocyte'</span><br>  celltype[celltype<span>$ClusterID</span> %<span>in</span>% c( 11 ),2]=<span>'Cholangiocyte'</span><br>  celltype[celltype<span>$ClusterID</span> %<span>in</span>% c( 10 ),2]=<span>'Dividing'</span><br>  celltype[celltype<span>$ClusterID</span> %<span>in</span>% c(  12 ),2]=<span>'Hepatic_stellate'</span><br>  celltype[celltype<span>$ClusterID</span> %<span>in</span>% c( 7 ),2]=<span>'pDCs'</span><br>  celltype[celltype<span>$ClusterID</span> %<span>in</span>% c( 9 ),2]=<span>'cDCs'</span><br>  <br>  head(celltype)<br>  celltype<br>  table(celltype<span>$celltype</span>)<br>  sce.all.int@meta.data<span>$celltype</span> = <span>"NA"</span><br>  <br>  <span>for</span>(i <span>in</span> 1:nrow(celltype)){<br>    sce.all.int@meta.data[<span>which</span>(sce.all.int@meta.data<span>$RNA_snn_res</span>.0.1 == celltype<span>$ClusterID</span>[i]),<span>'celltype'</span>] &lt;- celltype<span>$celltype</span>[i]}<br>  Idents(sce.all.int)=sce.all.int<span>$celltype</span><br>  <br>  sel.clust = <span>"celltype"</span><br>  sce.all.int &lt;- SetIdent(sce.all.int, value = sel.clust)<br>  table(sce.all.int@active.ident) <br>  <br>  dir.create(<span>'check-by-celltype'</span>)<br>  setwd(<span>'check-by-celltype'</span>)<br>  <span>source</span>(<span>'../scRNA_scripts/check-all-markers.R'</span>)<br>  setwd(<span>'../'</span>) <br>  getwd()<br>}<br><br>p_umap=DimPlot(sce.all.int, reduction = <span>"umap"</span>,raster = F,<br>               label = T,repel = T) <br>p_umap <br></code></pre><p data-tool="mdnice编辑器"><strong>最终结果和文献注释的内容没有什么出入！</strong></p><figure data-tool="mdnice编辑器"><img data-imgfileid="100003663" data-ratio="0.7600827300930714" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9ZJhs8rBe8vauiaNXSwUFgJ68tgsMcTCFXUtH4r7KHWcbWOSQnaztduvjo55sGy4iaXRlLFAWTnH6KA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="967" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9ZJhs8rBe8vauiaNXSwUFgJ68tgsMcTCFXUtH4r7KHWcbWOSQnaztduvjo55sGy4iaXRlLFAWTnH6KA/640?wx_fmt=png&amp;from=appmsg"></figure><h3 data-tool="mdnice编辑器"><span></span><span></span><span>写在最后</span><span></span></h3><p data-tool="mdnice编辑器">之前还想着试试看SingleR的自动注释，结果一直拖拖拖还没开始尝试。</p><p data-tool="mdnice编辑器">记得<strong>上次问过曾老师，为什么明明自动注释以及在线网页注释后还是要人工手动去判定，为什么不直接就人工注释呢？</strong></p><p data-tool="mdnice编辑器">现在明白了，<strong>成年人不做选择成年人都要！如果我们对样品的背景知识熟悉，那直接根据Marker基因注释即可；如果我们对样品不熟悉，那就结合起来使用呀！</strong></p></section><p><br></p><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/TCDuIjKLlSjwOffWkla3Xg",target="_blank" rel="noopener noreferrer">原文链接</a>
