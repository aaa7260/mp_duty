---
title: "相关性散点图和相关性热图绘制合集"
date: 2024-04-12T08:37:43Z
draft: ["false"]
tags: [
  "fetched",
  "Tobin笔记"
]
categories: ["Acdemic"]
---
相关性散点图和相关性热图绘制合集 by Tobin笔记
------
<div><p>感谢同学们支持，觉得内容对您有所帮助，欢迎喜欢我！！！<img data-ratio="1" data-src="https://res.wx.qq.com/t/wx_fed/we-emoji/res/v1.3.10/assets/newemoji/2_06.png" data-w="128" src="https://res.wx.qq.com/t/wx_fed/we-emoji/res/v1.3.10/assets/newemoji/2_06.png"><img data-ratio="1" data-src="https://res.wx.qq.com/t/wx_fed/we-emoji/res/v1.3.10/assets/newemoji/2_06.png" data-w="128" src="https://res.wx.qq.com/t/wx_fed/we-emoji/res/v1.3.10/assets/newemoji/2_06.png"><img data-ratio="1" data-src="https://res.wx.qq.com/t/wx_fed/we-emoji/res/v1.3.10/assets/newemoji/2_06.png" data-w="128" src="https://res.wx.qq.com/t/wx_fed/we-emoji/res/v1.3.10/assets/newemoji/2_06.png"></p><p><img data-galleryid="" data-ratio="0.7538200339558574" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/RZcOyvRFYZgjPMKI0v4HczUrmoiapqo4mWsib4r6Wzh7ZAbrom9sLUPDfVO3CNibwVhm2F5f7MKdYzkwrudGiaNgPw/640?wx_fmt=png" data-type="png" data-w="589" src="https://mmbiz.qpic.cn/mmbiz_png/RZcOyvRFYZgjPMKI0v4HczUrmoiapqo4mWsib4r6Wzh7ZAbrom9sLUPDfVO3CNibwVhm2F5f7MKdYzkwrudGiaNgPw/640?wx_fmt=png"></p><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="xml"><code><span>library(tidyverse)</span></code><code><span>library(ggplot2)</span></code><code><span>library(ggpubr)</span></code><code><span>library(cowplot)</span></code><code><span>library(ggExtra)</span></code><code><span><br></span></code><code><span>p <span>&lt;<span>-</span> <span>ggplot</span>(<span>iris</span>,<span>aes_string</span>(<span>x</span> = <span>'Sepal.Length'</span>,<span>y</span> = <span>'Sepal.Width'</span>)) +</span></span></code><code><span>  <span>geom_point</span>(<span>size</span> = <span>2,color</span> = <span>'#EC0101'</span>,<span>alpha</span> = <span>0.5)</span> +</span></code><code><span>  <span>theme_bw</span>() +</span></code><code><span>  # 主题细节调整</span></code><code><span>  <span>theme</span>(<span>axis.title</span> = <span>element_text(size</span> = <span>16),</span></span></code><code><span>        <span>axis.text</span> = <span>element_text(size</span> = <span>14),</span></span></code><code><span>        <span>axis.ticks.length</span> = <span>unit(0.25,</span>'<span>cm</span>'),</span></code><code><span>        <span>axis.ticks</span> = <span>element_line(size</span> = <span>1),</span></span></code><code><span>        <span>panel.border</span> = <span>element_rect(size</span> = <span>1.5),</span></span></code><code><span>        <span>panel.grid</span> = <span>element_blank()</span></span></code><code><span>  ) +</span></code><code><span>  # 添加回归线</span></code><code><span>  <span>geom_smooth</span>(<span>method</span> = <span>'lm'</span>,<span>se</span> = <span>T,color</span> = <span>'#F9B208'</span>,<span>size</span> = <span>1.5,fill</span> = <span>'#FEA82F'</span>) +</span></code><code><span>  # 添加相关性系数及<span>p</span>值</span></code><code><span>  <span>stat_cor</span>(<span>method</span> = <span>"pearson"</span>,<span>digits</span> = <span>3,size</span>=<span>6)</span></span></code><code><span><br></span></code><code><span># 添加边际柱形密度图</span></code><code><span><span>ggMarginal</span>(<span>p</span>,<span>type</span> = <span>"densigram"</span>,</span></code><code><span>           <span>xparams</span> = <span>list(binwidth</span> = <span>0.1,</span> <span>fill</span> = <span>"#B3E283"</span>,<span>size</span> = <span>.7),</span></span></code><code><span>           <span>yparams</span> = <span>list(binwidth</span> = <span>0.1,</span> <span>fill</span> = <span>"#8AB6D6"</span>,<span>size</span> = <span>.7))</span></span></code><code><span><br></span></code></pre></section><p><img data-galleryid="" data-ratio="0.8442982456140351" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/RZcOyvRFYZgjPMKI0v4HczUrmoiapqo4mzL7q5wtAiaywHy9XiaftaxVBQd8Utog1WdHS3kK704YZoibAuNWf1G7UQ/640?wx_fmt=png" data-type="png" data-w="912" src="https://mmbiz.qpic.cn/mmbiz_png/RZcOyvRFYZgjPMKI0v4HczUrmoiapqo4mzL7q5wtAiaywHy9XiaftaxVBQd8Utog1WdHS3kK704YZoibAuNWf1G7UQ/640?wx_fmt=png"></p><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="xml"><code><span># install.packages('ggpmisc')</span></code><code><span>library(ggpmisc)</span></code><code><span>data("iris")</span></code><code><span>df <span>&lt;<span>-</span> <span>iris</span></span></span></code><code><span><span>head</span>(<span>df</span>)</span></code><code><span><span>ggscatter</span>(<span>df</span>, </span></code><code><span>          <span>x</span> = <span>"Sepal.Length"</span>,</span></code><code><span>          <span>y</span> = <span>"Petal.Length"</span>, </span></code><code><span>          <span>palette</span> = <span>"jco"</span>, </span></code><code><span>          <span>add</span> = <span>"reg.line"</span>,                    </span></code><code><span>          <span>conf.int</span> = <span>TRUE,</span> </span></code><code><span>          <span>color</span> = <span>"Species"</span></span></code><code><span>          )+</span></code><code><span>  <span>labs</span>(<span>title</span> = <span>"test"</span>)+</span></code><code><span>  <span>theme_bw</span>()+</span></code><code><span>  <span>theme</span>(<span>plot.title</span> = <span>element_text(hjust</span> = <span>0.5,</span></span></code><code><span>                                  <span>size</span> = <span>15),</span></span></code><code><span>        <span>axis.title.x</span> = <span>element_text(size</span> = <span>12),</span></span></code><code><span>        <span>axis.title.y</span> = <span>element_text(size</span> = <span>12),</span></span></code><code><span>        <span>axis.text.x</span> = <span>element_text(size</span> = <span>12),</span></span></code><code><span>        <span>axis.text.y</span> = <span>element_text(size</span> = <span>12)</span></span></code><code><span>  )+</span></code><code><span>  <span>stat_cor</span>(<span>aes</span>(<span>color</span> = <span>Species),</span> <span>label.x</span> = <span>3)</span></span></code><code><span>  #添加回归方程</span></code><code><span>  <span>stat_poly_eq</span>(<span>aes</span>(<span>color</span> = <span>Species,label</span> =  <span>paste(..rr.label..,..p.value.label..,</span> <span>sep</span> = <span>"~~~~"</span>)))</span></code></pre></section><p><img data-galleryid="" data-ratio="0.8442982456140351" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/RZcOyvRFYZhI5E6o5apoYktemluZhCpZvwkibIasPudkKMySBFADBdYgrZYPKok1ZaY7aWprc86jezj4jKTX5MA/640?wx_fmt=png" data-type="png" data-w="912" src="https://mmbiz.qpic.cn/mmbiz_png/RZcOyvRFYZhI5E6o5apoYktemluZhCpZvwkibIasPudkKMySBFADBdYgrZYPKok1ZaY7aWprc86jezj4jKTX5MA/640?wx_fmt=png"><img data-galleryid="" data-ratio="0.8442982456140351" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/RZcOyvRFYZhI5E6o5apoYktemluZhCpZQs0TnUVbEjA7eQxpzVEhiaIdOk95d5Z5J6md1aKv1waY80s6m04XY8A/640?wx_fmt=png" data-type="png" data-w="912" src="https://mmbiz.qpic.cn/mmbiz_png/RZcOyvRFYZhI5E6o5apoYktemluZhCpZQs0TnUVbEjA7eQxpzVEhiaIdOk95d5Z5J6md1aKv1waY80s6m04XY8A/640?wx_fmt=png"></p><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="xml"><code><span># 加载包</span></code><code><span><br></span></code><code><span>library(ggplot2)</span></code><code><span><br></span></code><code><span>library(ggpubr)</span></code><code><span><br></span></code><code><span><br></span></code><code><span># 加载iris数据集</span></code><code><span><br></span></code><code><span>data(iris)</span></code><code><span><br></span></code><code><span>aa<span>&lt;<span>-iris</span></span></span></code><code><span><br></span></code><code><span>### 出图<span>1</span></span></code><code><span><br></span></code><code><span><span>ggplot</span>(<span>aa</span>,<span>aes</span>(<span>x</span>=<span>aa$Sepal.Length,y</span>=<span>aa$Petal.Width))+#x,y参数</span></span></code><code><span>  </span></code><code><span>  <span>geom_point</span>(<span>size</span>=<span>4,aes(color</span>=<span>aa$Species))+#点大小</span></span></code><code><span>  </span></code><code><span>  <span>scale_color_manual</span>(<span>values</span>=<span>c(</span>"<span>Tan4</span>","<span>OliveDrab3</span>","<span>DarkGreen</span>"))+#颜色</span></code><code><span>  </span></code><code><span>  <span>geom_smooth</span>(<span>method</span>=<span>lm,level</span>=<span>0.95,color</span>=<span>"gray4"</span>)+</span></code><code><span>  </span></code><code><span>  <span>stat_cor</span>(<span>method</span> = <span>"pearson"</span>,<span>label.x.npc</span> =<span>"left"</span>,<span>label.y.npc</span> = <span>0.02)+</span></span></code><code><span>  </span></code><code><span>  <span>labs</span>(<span>y</span>=<span>"Sepal Width"</span>,<span>x</span>=<span>"Sepa Length"</span>)+#坐标轴</span></code><code><span>  </span></code><code><span>  <span>theme</span>(<span>axis.title</span> = <span>element_text(color</span>=<span>'black'</span>,<span>size</span>=<span>9),#主题</span></span></code><code><span>        </span></code><code><span>        <span>axis.ticks.length</span> = <span>unit(0.4,</span>"<span>lines</span>"), <span>axis.ticks</span> = <span>element_line(color</span>=<span>'black'</span>),</span></code><code><span>        </span></code><code><span>        <span>axis.line</span> = <span>element_line(colour</span> = <span>"black"</span>), </span></code><code><span>        </span></code><code><span>        <span>axis.title.x</span>=<span>element_text(colour</span>=<span>'black'</span>, <span>size</span>=<span>11),</span></span></code><code><span>        </span></code><code><span>        <span>axis.title.y</span>=<span>element_text(colour</span>=<span>'black'</span>, <span>size</span>=<span>11),</span></span></code><code><span>        </span></code><code><span>        <span>axis.text</span>=<span>element_text(colour</span>=<span>'black'</span>,<span>size</span>=<span>9),</span></span></code><code><span>        </span></code><code><span>        <span>legend.title</span>=<span>element_blank(),</span></span></code><code><span>        </span></code><code><span>        <span>legend.text</span>=<span>element_text(size</span>=<span>9),</span></span></code><code><span>        </span></code><code><span>        <span>legend.key</span>=<span>element_blank(),</span></span></code><code><span>        </span></code><code><span>        <span>legend.background</span> = <span>element_rect(colour</span> = <span>"White"</span>))</span></code><code><span><br></span></code><code><span><br></span></code><code><span><br></span></code><code><span>### 出图<span>2</span> </span></code><code><span><br></span></code><code><span><span>ggplot</span>(<span>aa</span>,<span>aes</span>(<span>x</span>=<span>aa$Sepal.Length,y</span>=<span>aa$Petal.Length))+</span></span></code><code><span>  </span></code><code><span>  <span>geom_point</span>(<span>size</span>=<span>4,aes(color</span>=<span>aa$Species))+</span></span></code><code><span>  </span></code><code><span>  <span>scale_color_manual</span>(<span>values</span>=<span>c(</span>"<span>Tan4</span>","<span>OliveDrab3</span>","<span>DarkGreen</span>"))+</span></code><code><span>  </span></code><code><span>  <span>geom_smooth</span>(<span>method</span>=<span>lm,level</span>=<span>0.95,color</span>=<span>"gray4"</span>)+</span></code><code><span>  </span></code><code><span>  <span>stat_cor</span>(<span>method</span> = <span>"pearson"</span>,<span>label.x.npc</span> =<span>"left"</span>,<span>label.y.npc</span> = <span>0.02)+</span></span></code><code><span>  </span></code><code><span>  <span>theme_classic</span>()+</span></code><code><span>  </span></code><code><span>  <span>labs</span>(<span>y</span>=<span>"Sepal Width"</span>,<span>x</span>=<span>"Sepa Length"</span>)+</span></code><code><span>  </span></code><code><span>  <span>theme</span>(<span>axis.title</span> = <span>element_text(color</span>=<span>'black'</span>,<span>size</span>=<span>9),</span></span></code><code><span>        </span></code><code><span>        <span>axis.ticks.length</span> = <span>unit(0.4,</span>"<span>lines</span>"), <span>axis.ticks</span> = <span>element_line(color</span>=<span>'black'</span>),</span></code><code><span>        </span></code><code><span>        <span>axis.line</span> = <span>element_line(colour</span> = <span>"black"</span>), </span></code><code><span>        </span></code><code><span>        <span>axis.title.x</span>=<span>element_text(colour</span>=<span>'black'</span>, <span>size</span>=<span>11),</span></span></code><code><span>        </span></code><code><span>        <span>axis.title.y</span>=<span>element_text(colour</span>=<span>'black'</span>, <span>size</span>=<span>11),</span></span></code><code><span>        </span></code><code><span>        <span>axis.text</span>=<span>element_text(colour</span>=<span>'black'</span>,<span>size</span>=<span>9),</span></span></code><code><span>        </span></code><code><span>        <span>legend.title</span>=<span>element_blank(),</span></span></code><code><span>        </span></code><code><span>        <span>legend.text</span>=<span>element_text(size</span>=<span>9),</span></span></code><code><span>        </span></code><code><span>        <span>legend.key</span>=<span>element_blank(),</span></span></code><code><span>        </span></code><code><span>        <span>legend.background</span> = <span>element_rect(colour</span> = <span>"White"</span>))</span></code></pre></section><p><img data-galleryid="" data-ratio="0.8442982456140351" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/RZcOyvRFYZhI5E6o5apoYktemluZhCpZ6MmnibRrgBocMyqoiajUgbrByP59v86iaIhPWozXXvJnoguezzKCAKavQ/640?wx_fmt=png" data-type="png" data-w="912" src="https://mmbiz.qpic.cn/mmbiz_png/RZcOyvRFYZhI5E6o5apoYktemluZhCpZ6MmnibRrgBocMyqoiajUgbrByP59v86iaIhPWozXXvJnoguezzKCAKavQ/640?wx_fmt=png"><img data-galleryid="" data-ratio="1.4080882352941178" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/RZcOyvRFYZhI5E6o5apoYktemluZhCpZ3uEicyHkNy9icLibyAxRhCicTprktecSnmLMlILQzLUOwYdrDqe7CibGc2A/640?wx_fmt=png" data-type="png" data-w="544" src="https://mmbiz.qpic.cn/mmbiz_png/RZcOyvRFYZhI5E6o5apoYktemluZhCpZ3uEicyHkNy9icLibyAxRhCicTprktecSnmLMlILQzLUOwYdrDqe7CibGc2A/640?wx_fmt=png"><img data-galleryid="" data-ratio="0.8463227222832053" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/RZcOyvRFYZhI5E6o5apoYktemluZhCpZS955c00vvWLMEChBIx9l06mevQEsCPxIktRlR2WefvE1VkFpCQK0pA/640?wx_fmt=png" data-type="png" data-w="911" src="https://mmbiz.qpic.cn/mmbiz_png/RZcOyvRFYZhI5E6o5apoYktemluZhCpZS955c00vvWLMEChBIx9l06mevQEsCPxIktRlR2WefvE1VkFpCQK0pA/640?wx_fmt=png"><img data-galleryid="" data-ratio="0.8463227222832053" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/RZcOyvRFYZhI5E6o5apoYktemluZhCpZD9QjwvbbYcBQLpgfNJPDwztP9uXwcMAo8ekR4N47XrxkQ9Flr5icdPg/640?wx_fmt=png" data-type="png" data-w="911" src="https://mmbiz.qpic.cn/mmbiz_png/RZcOyvRFYZhI5E6o5apoYktemluZhCpZD9QjwvbbYcBQLpgfNJPDwztP9uXwcMAo8ekR4N47XrxkQ9Flr5icdPg/640?wx_fmt=png"><img data-galleryid="" data-ratio="0.8442982456140351" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/RZcOyvRFYZhI5E6o5apoYktemluZhCpZO0LhGHZ22IBTd6iaDB01PTeu11I9VZVKjlLRqNPFp3IeqhQQtRLuPTg/640?wx_fmt=png" data-type="png" data-w="912" src="https://mmbiz.qpic.cn/mmbiz_png/RZcOyvRFYZhI5E6o5apoYktemluZhCpZO0LhGHZ22IBTd6iaDB01PTeu11I9VZVKjlLRqNPFp3IeqhQQtRLuPTg/640?wx_fmt=png"><img data-galleryid="" data-ratio="0.8442982456140351" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/RZcOyvRFYZhI5E6o5apoYktemluZhCpZiblCno5W031f9AKLu0pfHlG0WQV2oKuZDudwQ0WD1RmpAXr4sA2jtow/640?wx_fmt=png" data-type="png" data-w="912" src="https://mmbiz.qpic.cn/mmbiz_png/RZcOyvRFYZhI5E6o5apoYktemluZhCpZiblCno5W031f9AKLu0pfHlG0WQV2oKuZDudwQ0WD1RmpAXr4sA2jtow/640?wx_fmt=png"></p><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="php"><code><span><span># install.packages("devtools")</span></span></code><code><span><span># # devtools::install_github("Hy4m/linkET", force = TRUE)</span></span></code><code><span><span># packageVersion("linkET")</span></span></code><code><span><br></span></code><code><span>library(linkET)</span></code><code><span><span>## matrix_data</span></span></code><code><span>matrix_data(<span>list</span>(mtcars = mtcars))</span></code><code><span><span>## md_tbl</span></span></code><code><span>matrix_data(<span>list</span>(mtcars = mtcars)) %&gt;% </span></code><code><span>  as_md_tbl()</span></code><code><span>as_matrix_data(mtcars)</span></code><code><span>as_md_tbl(mtcars)</span></code><code><span>correlate(mtcars) %&gt;% </span></code><code><span>  as_matrix_data()</span></code><code><span>correlate(mtcars) %&gt;% </span></code><code><span>  as_md_tbl()</span></code><code><span><br></span></code><code><span>correlate(mtcars) %&gt;% </span></code><code><span>  as_md_tbl() %&gt;% </span></code><code><span>  qcorrplot() +</span></code><code><span>  geom_square()</span></code><code><span><br></span></code><code><span>library(vegan)</span></code><code><span><span>#&gt; 载入需要的程辑包：permute</span></span></code><code><span><span>#&gt; 载入需要的程辑包：lattice</span></span></code><code><span><span>#&gt; This is vegan 2.6-4</span></span></code><code><span>data(<span>"varespec"</span>)</span></code><code><span>data(<span>"varechem"</span>)</span></code><code><span>correlate(varespec[<span>1</span>:<span>30</span>], varechem) %&gt;% </span></code><code><span>  qcorrplot() +</span></code><code><span>  geom_square() +</span></code><code><span>  scale_fill_gradientn(colours = RColorBrewer::brewer.pal(<span>11</span>, <span>"RdBu"</span>))</span></code><code><span><br></span></code><code><span>qcorrplot(varespec[<span>1</span>:<span>30</span>], type = <span>"lower"</span>) +</span></code><code><span>  geom_square() +</span></code><code><span>  scale_fill_gradientn(colours = RColorBrewer::brewer.pal(<span>11</span>, <span>"RdBu"</span>))</span></code><code><span><span>#&gt; The input data is not a correlation matrix,</span></span></code><code><span><span>#&gt; you can override this behavior by setting the `is_corr` parameter.</span></span></code><code><span><br></span></code><code><span><span>## you can set your style</span></span></code><code><span>set_corrplot_style()</span></code><code><span>qcorrplot(mtcars) + geom_square()</span></code><code><span><span>#&gt; The input data is not a correlation matrix,</span></span></code><code><span><span>#&gt; you can override this behavior by setting the `is_corr` parameter.</span></span></code><code><span><br></span></code><code><span><br></span></code><code><span>library(dplyr)</span></code><code><span><span>#&gt; </span></span></code><code><span><span>#&gt; 载入程辑包：'dplyr'</span></span></code><code><span><span>#&gt; The following objects are masked from 'package:stats':</span></span></code><code><span><span>#&gt; </span></span></code><code><span><span>#&gt;     filter, lag</span></span></code><code><span><span>#&gt; The following objects are masked from 'package:base':</span></span></code><code><span><span>#&gt; </span></span></code><code><span><span>#&gt;     intersect, setdiff, setequal, union</span></span></code><code><span>data(<span>"varechem"</span>, package = <span>"vegan"</span>)</span></code><code><span>data(<span>"varespec"</span>, package = <span>"vegan"</span>)</span></code><code><span><br></span></code><code><span>mantel &lt;- mantel_test(varespec, varechem,</span></code><code><span>                      spec_select = <span>list</span>(Spec01 = <span>1</span>:<span>7</span>,</span></code><code><span>                                         Spec02 = <span>8</span>:<span>18</span>,</span></code><code><span>                                         Spec03 = <span>19</span>:<span>37</span>,</span></code><code><span>                                         Spec04 = <span>38</span>:<span>44</span>)) %&gt;% </span></code><code><span>  mutate(rd = cut(r, breaks = c(-Inf, <span>0.2</span>, <span>0.4</span>, Inf),</span></code><code><span>                  labels = c(<span>"&lt; 0.2"</span>, <span>"0.2 - 0.4"</span>, <span>"&gt;= 0.4"</span>)),</span></code><code><span>         pd = cut(p, breaks = c(-Inf, <span>0.01</span>, <span>0.05</span>, Inf),</span></code><code><span>                  labels = c(<span>"&lt; 0.01"</span>, <span>"0.01 - 0.05"</span>, <span>"&gt;= 0.05"</span>)))</span></code><code><span><span>#&gt; `mantel_test()` using 'bray' dist method for 'spec'.</span></span></code><code><span><span>#&gt; `mantel_test()` using 'euclidean' dist method for 'env'.</span></span></code><code><span><br></span></code><code><span>qcorrplot(correlate(varechem), type = <span>"lower"</span>, diag = <span>FALSE</span>) +</span></code><code><span>  geom_square() +</span></code><code><span>  geom_couple(aes(colour = pd, size = rd), </span></code><code><span>              data = mantel, </span></code><code><span>              curvature = nice_curvature()) +</span></code><code><span>  scale_fill_gradientn(colours = RColorBrewer::brewer.pal(<span>11</span>, <span>"RdBu"</span>)) +</span></code><code><span>  scale_size_manual(values = c(<span>0.5</span>, <span>1</span>, <span>2</span>)) +</span></code><code><span>  scale_colour_manual(values = color_pal(<span>3</span>)) +</span></code><code><span>  guides(size = guide_legend(title = <span>"Mantel's r"</span>,</span></code><code><span>                             override.aes = <span>list</span>(colour = <span>"grey35"</span>), </span></code><code><span>                             order = <span>2</span>),</span></code><code><span>         colour = guide_legend(title = <span>"Mantel's p"</span>, </span></code><code><span>                               override.aes = <span>list</span>(size = <span>3</span>), </span></code><code><span>                               order = <span>1</span>),</span></code><code><span>         fill = guide_colorbar(title = <span>"Pearson's r"</span>, order = <span>3</span>))</span></code><code><span><br></span></code><code><span>qpairs(iris) + geom_pairs()</span></code><code><span><br></span></code></pre></section><p><img data-galleryid="" data-ratio="0.783068783068783" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/RZcOyvRFYZhI5E6o5apoYktemluZhCpZzINx1CwTmXbneJNQhia120dsEDNQyG4tQnQk2XZzApzHwZN4nuZeZ4Q/640?wx_fmt=png" data-type="png" data-w="567" src="https://mmbiz.qpic.cn/mmbiz_png/RZcOyvRFYZhI5E6o5apoYktemluZhCpZzINx1CwTmXbneJNQhia120dsEDNQyG4tQnQk2XZzApzHwZN4nuZeZ4Q/640?wx_fmt=png"><img data-galleryid="" data-ratio="0.784452296819788" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/RZcOyvRFYZhI5E6o5apoYktemluZhCpZ6zCEVOG2hbhlBw7hpafCENngHNetLv6EteZ5cO8WNUrbbnics7wicnhQ/640?wx_fmt=png" data-type="png" data-w="566" src="https://mmbiz.qpic.cn/mmbiz_png/RZcOyvRFYZhI5E6o5apoYktemluZhCpZ6zCEVOG2hbhlBw7hpafCENngHNetLv6EteZ5cO8WNUrbbnics7wicnhQ/640?wx_fmt=png"></p><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="bash"><code><span>library(ggplot2)</span></code><code><span>library(RColorBrewer)</span></code><code><span>library(ggsci)</span></code><code><span><br></span></code><code><span>df=iris</span></code><code><span><span>##Spearman's correlation</span></span></code><code><span>colnames(df)</span></code><code><span>df<span>$Sample3</span>&lt;-<span>"Spearman's correlation"</span></span></code><code><span><br></span></code><code><span>ggplot(df, aes(x=Sepal.Length, y=Sepal.Width,color=as.factor(Species)))+</span></code><code><span>  </span></code><code><span>  geom_point(df,mapping =  aes(x=Sepal.Length, y=Sepal.Width),size=2)+</span></code><code><span>  </span></code><code><span>  geom_smooth(aes(x=Sepal.Length, y=Sepal.Width),method = <span>'lm'</span>,level=0.95,se = F, size=1.6)+</span></code><code><span>  </span></code><code><span>  stat_cor(method = <span>"spearman"</span>,label.x.npc =<span>"left"</span>,label.y.npc = 0.97)+<span>#或pearson</span></span></code><code><span>  </span></code><code><span>  theme_bw()+scale_color_npg()+scale_fill_npg()+</span></code><code><span>  </span></code><code><span>  theme(axis.text=element_text(colour=<span>'black'</span>,size=9))+</span></code><code><span>  </span></code><code><span>  labs(x=<span>"Sepal.Length"</span>, y=<span>"Sepal.Width"</span>, color = <span>""</span>,fill = <span>""</span>)+</span></code><code><span>  </span></code><code><span>  facet_grid( ~Sample3, drop=TRUE,scale=<span>"free"</span>, space=<span>"free_x"</span>)+</span></code><code><span>  </span></code><code><span>  scale_y_continuous(expand = c(0, 0), <span>limit</span> = c(2, 4.5))+</span></code><code><span>  </span></code><code><span>  scale_x_continuous(expand = c(0, 0), <span>limit</span> = c(4, 8))+</span></code><code><span>  </span></code><code><span>  annotate(<span>"rect"</span>, xmin = -1.5, xmax =3,  ymin = -1.5, ymax =3, alpha = 0.1,fill=<span>"#FAE3AD"</span>) +</span></code><code><span>  </span></code><code><span>  theme(panel.grid.major=element_blank(),panel.grid.minor=element_blank())+</span></code><code><span>  </span></code><code><span>  theme(strip.background = element_rect(fill=c(<span>"#FAE3AD"</span>)))+</span></code><code><span>  </span></code><code><span>  theme(strip.text = element_text(size = 12,face = <span>'bold'</span>,colour = <span>"#B8733A"</span>))+</span></code><code><span>  </span></code><code><span>  theme(axis.text=element_text(colour=<span>'black'</span>,size=11))</span></code><code><span><br></span></code><code><span><span>##Pearson's correlation</span></span></code><code><span><br></span></code><code><span><span>#将pH转化为数值</span></span></code><code><span><br></span></code><code><span><br></span></code><code><span>df<span>$Sample3</span>&lt;-<span>"Pearson's correlation"</span></span></code><code><span><br></span></code><code><span>ggplot(df, aes(x=Sepal.Length, y=Sepal.Width,color=as.factor(Species)))+</span></code><code><span>  </span></code><code><span>  geom_point(df,mapping =  aes(x=Sepal.Length, y=Sepal.Width),size=2)+</span></code><code><span>  </span></code><code><span>  geom_smooth(aes(x=Sepal.Length, y=Sepal.Width),method = <span>'lm'</span>,level=0.95,se = F, size=1.6)+</span></code><code><span>  </span></code><code><span>  stat_cor(method = <span>"pearson"</span>,label.x.npc =<span>"left"</span>,label.y.npc = 0.97)+<span>#或pearson</span></span></code><code><span>  </span></code><code><span>  theme_bw()+scale_color_npg()+scale_fill_npg()+</span></code><code><span>  </span></code><code><span>  theme(axis.text=element_text(colour=<span>'black'</span>,size=9))+</span></code><code><span>  </span></code><code><span>  labs(x=<span>"Sepal.Length"</span>, y=<span>"Sepal.Width"</span>, color = <span>""</span>,fill = <span>""</span>)+</span></code><code><span>  </span></code><code><span>  facet_grid( ~Sample3, drop=TRUE,scale=<span>"free"</span>, space=<span>"free_x"</span>)+</span></code><code><span>  </span></code><code><span>  scale_y_continuous(expand = c(0, 0), <span>limit</span> = c(2, 4.5))+</span></code><code><span>  </span></code><code><span>  scale_x_continuous(expand = c(0, 0), <span>limit</span> = c(4, 8))+</span></code><code><span>  </span></code><code><span>  annotate(<span>"rect"</span>, xmin = -1.5, xmax =3,  ymin = -1.5, ymax =3, alpha = 0.1,fill=<span>"#CCE3FA"</span>) +</span></code><code><span>  </span></code><code><span>  theme(panel.grid.major=element_blank(),panel.grid.minor=element_blank())+</span></code><code><span>  </span></code><code><span>  theme(strip.background = element_rect(fill=c(<span>"#CCE3FA"</span>)))+</span></code><code><span>  </span></code><code><span>  theme(strip.text = element_text(size = 12,face = <span>'bold'</span>,colour = <span>"#328BBF"</span>))+</span></code><code><span>  </span></code><code><span>  theme(axis.text=element_text(colour=<span>'black'</span>,size=11))</span></code><code><span><br></span></code></pre></section><p><img data-galleryid="" data-ratio="0.783068783068783" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/RZcOyvRFYZhI5E6o5apoYktemluZhCpZmpK8yskOXX0vSK9BpAqHO8S3Cj7KCMgIhoH4gaJiaF5Z9ibT7r8s2RiaQ/640?wx_fmt=png" data-type="png" data-w="567" src="https://mmbiz.qpic.cn/mmbiz_png/RZcOyvRFYZhI5E6o5apoYktemluZhCpZmpK8yskOXX0vSK9BpAqHO8S3Cj7KCMgIhoH4gaJiaF5Z9ibT7r8s2RiaQ/640?wx_fmt=png"><img data-galleryid="" data-ratio="0.783068783068783" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/RZcOyvRFYZhI5E6o5apoYktemluZhCpZ4Pib3pKzZaVzqZGLzMHsicELpgnElB29oIAcNv5q3Pibcib50aInajvvuQ/640?wx_fmt=png" data-type="png" data-w="567" src="https://mmbiz.qpic.cn/mmbiz_png/RZcOyvRFYZhI5E6o5apoYktemluZhCpZ4Pib3pKzZaVzqZGLzMHsicELpgnElB29oIAcNv5q3Pibcib50aInajvvuQ/640?wx_fmt=png"><img data-galleryid="" data-ratio="0.6777777777777778" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/RZcOyvRFYZhI5E6o5apoYktemluZhCpZYhhaia0pneDyaK62Qp1iaov91fDicPanTzvCE9ReicFicG0BibrFoA1bepXQ/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/RZcOyvRFYZhI5E6o5apoYktemluZhCpZYhhaia0pneDyaK62Qp1iaov91fDicPanTzvCE9ReicFicG0BibrFoA1bepXQ/640?wx_fmt=png"></p><p><img data-galleryid="" data-ratio="0.6777777777777778" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/RZcOyvRFYZhI5E6o5apoYktemluZhCpZnia5kibb9iacwcxEVkthnmpzXIejvh3LrK7eDzUS1k7mHia37Nb7IGCQag/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/RZcOyvRFYZhI5E6o5apoYktemluZhCpZnia5kibb9iacwcxEVkthnmpzXIejvh3LrK7eDzUS1k7mHia37Nb7IGCQag/640?wx_fmt=png"><img data-galleryid="" data-ratio="0.6777777777777778" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/RZcOyvRFYZhI5E6o5apoYktemluZhCpZD2upEpVrf7ibMgWNESoocicpKVL4ZeNDrGdSxPlkuZeHLSoicR92whHvg/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/RZcOyvRFYZhI5E6o5apoYktemluZhCpZD2upEpVrf7ibMgWNESoocicpKVL4ZeNDrGdSxPlkuZeHLSoicR92whHvg/640?wx_fmt=png"><img data-galleryid="" data-ratio="0.6777777777777778" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/RZcOyvRFYZhI5E6o5apoYktemluZhCpZqIRgaUpyzrbXk2PUibpx9MvYRg1dJDK362VhoIPlWD7x20FwJYIC2Rw/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/RZcOyvRFYZhI5E6o5apoYktemluZhCpZqIRgaUpyzrbXk2PUibpx9MvYRg1dJDK362VhoIPlWD7x20FwJYIC2Rw/640?wx_fmt=png"></p><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="sql"><code><span><span>#install_github("ggobi/ggally")</span></span></code><code><span>install.packages(<span>"GGally"</span>)</span></code><code><span><span>library</span>(GGally)</span></code><code><span><span>library</span>(rstatix)</span></code><code><span>vig_ggally(<span>"ggpairs"</span>) <span># 查看ggally包指定函数的帮助文件</span></span></code><code><span><span>#?ggpairs # 查看帮助信息</span></span></code><code><span><br></span></code><code><span>env=iris</span></code><code><span><span># 2.1 默认参数绘图</span></span></code><code><span>ggpairs(env, <span># 默认对表中的所有(定性/定量)变量绘制成对比较图。</span></span></code><code><span>             <span># 字符/因子列中允许的最大分类数，默认为15，设置cardinality_threshold = NULL,这不限制最大分类数。</span></span></code><code><span>             cardinality_threshold = <span>15</span>) </span></code><code><span><br></span></code><code><span><br></span></code><code><span><span># 2.2 选择指定列绘图</span></span></code><code><span><span>#p2 = ggpairs(env, columns = c(4:14)) # 两个代码效果一致</span></span></code><code><span>ggpairs(env[<span>3</span>:<span>5</span>]) <span># 默认左下角(lower)为成对变量散点图，对角(diag)为密度曲线图，右上角(upper)为相关性系数和显著性标记。</span></span></code><code><span><span>#p2 = ggpairs(env, columns = c(colnames(env[4:14])), columnLabels = c(colnames(env[4:7]),"ammonia",colnames(env[9:14]))) # columnLabels可以更改变量名</span></span></code><code><span><br></span></code><code><span><br></span></code><code><span><br></span></code><code><span><br></span></code><code><span><span># 2.3 使用分组信息对变量进行分类</span></span></code><code><span><span>library</span>(ggsci)</span></code><code><span>cols = pal_d3(<span>"category10"</span>)(<span>10</span>)</span></code><code><span>ggpairs(env, </span></code><code><span>        <span>mapping</span> = ggplot2::aes(color = Species,shape = Species),</span></code><code><span>        <span>columns</span> = c(colnames(env)))+</span></code><code><span>  ggplot2::scale_color_manual(<span>values</span> = cols)+ <span># 设置的颜色只应用于upper和lower。</span></span></code><code><span>  ggplot2::scale_shape_manual(<span>values</span> = c(<span>15</span>:<span>17</span>))</span></code><code><span><br></span></code><code><span><br></span></code><code><span><span># 2.4 成对变量比较图：upper、lower和diag部分参数调整</span></span></code><code><span>ggpairs(env,<span>columns</span> = <span>1</span>:<span>4</span>, <span># 选择需要绘图的变量所在列号</span></span></code><code><span>        <span>#upper = "black" # 不显示upper部分</span></span></code><code><span>        <span>upper</span> = <span>list</span>(continuous = <span>"cor"</span>, <span># 为各种数据类型设置显示形式，ggally中功能函数的后缀(ggally_cor())。</span></span></code><code><span>                     <span>#combo = "box_no_facet", # 设置combo数据类型的绘图参数</span></span></code><code><span>                     <span>#discrete = "count",# 设置discrete数据类型的绘图参数。</span></span></code><code><span>                     na =<span>"na"</span>),<span># 设置参数名称与成对数据类型名称一致。</span></span></code><code><span>        <span>lower</span> = <span>list</span>(continuous = <span>"smooth"</span>,<span>#ggally_smooth()</span></span></code><code><span>                     <span>#combo = "facethist", </span></span></code><code><span>                     <span>#discrete = "facetbar", </span></span></code><code><span>                     na =<span>"na"</span>),</span></code><code><span>        diag = <span>list</span>(continuous = <span>"densityDiag"</span>, <span># 'densityDiag', 'barDiag', 'blankDiag'可选</span></span></code><code><span>                    <span>#discrete = "barDiag", # 'barDiag', 'blankDiag'可选 </span></span></code><code><span>                    <span>#diag =NULL # 不显示diag部分</span></span></code><code><span>                    na = <span>"naDiag"</span>))+</span></code><code><span>  theme_bw()<span># 设置主题参数</span></span></code><code><span><br></span></code><code><span><br></span></code><code><span><span># 2.5 成对变量比较图-使用wrap()设置ggally功能函数的参数，以调整绘图参数</span></span></code><code><span>ggpairs(env,<span>columns</span> = <span>1</span>:<span>4</span>, </span></code><code><span>        ggplot2::aes(color = Species), <span># 按分组信息分别着色、计算相关性系数和拟合</span></span></code><code><span>        <span>upper</span> = <span>list</span>(continuous = wrap(<span>"cor"</span>,method = <span>"spearman"</span>)), <span># 更改相关性系数，?ggally_cor，查看函数参数，默认pearson。</span></span></code><code><span>        <span>lower</span> = <span>list</span>(continuous = wrap(<span>"smooth"</span>,method = <span>"loess"</span>,se = <span>TRUE</span>)), <span># 默认lm</span></span></code><code><span>        diag = <span>list</span>(continuous = wrap(<span>"barDiag"</span>,rescale=<span>TRUE</span>)))+ <span># 默认rescale=FLASE，此参数只对数值型数据起效。</span></span></code><code><span>  theme_bw()</span></code><code><span><br></span></code><code><span><br></span></code><code><span><span># 2.6 成对变量比较图-自定义函数以调整绘图参数</span></span></code><code><span>cols = pal_jco()(<span>7</span>) <span># 设置绘图颜色</span></span></code><code><span>my_density &lt;- <span>function</span>(<span>data</span>, <span>mapping</span>, <span>values</span> = cols ) {</span></code><code><span>  ggplot(<span>data</span> = <span>data</span>, <span>mapping</span> = <span>mapping</span>) +</span></code><code><span>    geom_density() +</span></code><code><span>    scale_color_manual(<span>values</span> = <span>values</span>)</span></code><code><span>} <span># 自定义函数</span></span></code><code><span><br></span></code><code><span>ggpairs(env,<span>columns</span> = <span>1</span>:<span>4</span>, </span></code><code><span>             ggplot2::aes(color = Species), <span># 按分组信息分别着色、计算相关性系数和拟合</span></span></code><code><span>             <span>upper</span> = <span>list</span>(continuous = <span>"cor"</span>), </span></code><code><span>             <span>lower</span> = <span>list</span>(continuous = wrap(<span>"smooth"</span>,method = <span>"loess"</span>,se = <span>FALSE</span>)), <span># se = FALSE,不展示置信区间 </span></span></code><code><span>             diag = <span>list</span>(continuous = my_density))+</span></code><code><span>  ggplot2::scale_color_manual(<span>values</span> = cols)+</span></code><code><span>  theme_bw()</span></code></pre></section><p><img data-galleryid="" data-ratio="0.7284345047923323" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/RZcOyvRFYZhI5E6o5apoYktemluZhCpZ9ROUdLKekBcbpZWfmtYcq2Pt5v6eVsjLHBAKpPdu7STo2pb1opt8YQ/640?wx_fmt=png" data-type="png" data-w="939" src="https://mmbiz.qpic.cn/mmbiz_png/RZcOyvRFYZhI5E6o5apoYktemluZhCpZ9ROUdLKekBcbpZWfmtYcq2Pt5v6eVsjLHBAKpPdu7STo2pb1opt8YQ/640?wx_fmt=png"><img data-galleryid="" data-ratio="0.7310565635005336" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/RZcOyvRFYZhI5E6o5apoYktemluZhCpZfIWrSect14C6HYVR0UX8zXvSyoA4aCiafb0fPricZ2xduXo9LLMiaicXeg/640?wx_fmt=png" data-type="png" data-w="937" src="https://mmbiz.qpic.cn/mmbiz_png/RZcOyvRFYZhI5E6o5apoYktemluZhCpZfIWrSect14C6HYVR0UX8zXvSyoA4aCiafb0fPricZ2xduXo9LLMiaicXeg/640?wx_fmt=png"><img data-galleryid="" data-ratio="0.7284345047923323" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/RZcOyvRFYZhI5E6o5apoYktemluZhCpZk60tMGvqPmDej3XH4bO2E4DA1bYlZ6RiaaR56icqXrjJ3ap0vhgwibgnA/640?wx_fmt=png" data-type="png" data-w="939" src="https://mmbiz.qpic.cn/mmbiz_png/RZcOyvRFYZhI5E6o5apoYktemluZhCpZk60tMGvqPmDej3XH4bO2E4DA1bYlZ6RiaaR56icqXrjJ3ap0vhgwibgnA/640?wx_fmt=png"><img data-galleryid="" data-ratio="0.7310565635005336" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/RZcOyvRFYZhI5E6o5apoYktemluZhCpZWceJ0SIqTl5v7XM0tcPU9vVvibA9Doa5TKMX5ODiadNoyRsv05tRbxibw/640?wx_fmt=png" data-type="png" data-w="937" src="https://mmbiz.qpic.cn/mmbiz_png/RZcOyvRFYZhI5E6o5apoYktemluZhCpZWceJ0SIqTl5v7XM0tcPU9vVvibA9Doa5TKMX5ODiadNoyRsv05tRbxibw/640?wx_fmt=png"><img data-galleryid="" data-ratio="0.7310565635005336" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/RZcOyvRFYZhI5E6o5apoYktemluZhCpZfIWrSect14C6HYVR0UX8zXvSyoA4aCiafb0fPricZ2xduXo9LLMiaicXeg/640?wx_fmt=png" data-type="png" data-w="937" src="https://mmbiz.qpic.cn/mmbiz_png/RZcOyvRFYZhI5E6o5apoYktemluZhCpZfIWrSect14C6HYVR0UX8zXvSyoA4aCiafb0fPricZ2xduXo9LLMiaicXeg/640?wx_fmt=png"></p><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="perl"><code><span><span># remotes::install_github("r-link/corrmorant")</span></span></code><code><span>library(corrmorant)</span></code><code><span>library(ggplot2)</span></code><code><span>library(cols4all)</span></code><code><span><br></span></code><code><span><span>#测试数据：</span></span></code><code><span>dt &lt;- drosera <span>#数据集展示了三种非洲茅属植物的叶和叶柄大小</span></span></code><code><span>head(dt)</span></code><code><span>table(dt$species)</span></code><code><span>table(dt$variety)</span></code><code><span>p1 &lt;-ggcorrm(dt,</span></code><code><span>        corr_method = c(<span>'pearson'</span>)) + <span>#分析方法选择,可选'pearson','kendall' or 'spearman'</span></span></code><code><span>  lotri(geom_point()) + <span>#下三角区域添加散点图</span></span></code><code><span>  lotri(geom_smooth(method = <span>'lm'</span>)) + <span>#下三角区域添加拟合曲线</span></span></code><code><span>  utri_corrtext(corr_size = TRUE) + <span>#上三角区域添加相关性系数</span></span></code><code><span>  dia_names(y_pos = <span>0</span>.<span>15</span>) + <span>#对角线区域添加分类标签</span></span></code><code><span>  dia_histogram(lower = <span>0</span>.<span>3</span>, upper = <span>0</span>.<span>98</span>, color = <span>'grey30'</span>) <span>#对角线区域添加直方图</span></span></code><code><span><br></span></code><code><span>p2 &lt;-ggcorrm(data = dt,</span></code><code><span>        corr_method = c(<span>'pearson'</span>)) +</span></code><code><span>  lotri(geom_point(alpha = <span>0</span>.<span>3</span>)) +</span></code><code><span>  lotri(geom_smooth(method = <span>'lm'</span>,</span></code><code><span>                    fill = <span>'#FBB4AE'</span>,color = <span>'#F0027F'</span>)) +</span></code><code><span>  utri_corrtext(corr_size = FALSE) + <span>#逻辑值为TRUE时，按照相关性强弱调整系数文本大小；FALSE则按相同大小显示</span></span></code><code><span>  dia_names(y_pos = <span>0</span>.<span>15</span>, size = <span>3.5</span>) +</span></code><code><span>  dia_density(lower = <span>0</span>.<span>3</span>, upper = <span>0</span>.<span>98</span>,</span></code><code><span>              fill = <span>'#F0027F'</span>, color = <span>'#F0027F'</span>, alpha = <span>0</span>.<span>3</span>) <span>#对角线区域添加核密度曲线</span></span></code><code><span><br></span></code><code><span><br></span></code><code><span>p3 &lt;-ggcorrm(data = dt,</span></code><code><span>        mapping = aes(color = species, fill = species)) +</span></code><code><span>  lotri(geom_point(alpha = <span>0</span>.<span>3</span>)) +</span></code><code><span>  lotri(geom_smooth(method = <span>'lm'</span>)) +</span></code><code><span>  utri_corrtext(nrow = <span>2</span>, <span>#</span></span></code><code><span>                squeeze = <span>0</span>.<span>5</span>, <span>#存在多标签时，用于调整宽/高比例</span></span></code><code><span>                corr_size = F) +</span></code><code><span>  dia_names(y_pos = <span>0</span>.<span>15</span>, size = <span>3.5</span>) +</span></code><code><span>  dia_density(lower = <span>0</span>.<span>3</span>, upper = <span>0</span>.<span>98</span>,</span></code><code><span>              alpha = <span>0</span>.<span>6</span>)</span></code><code><span><br></span></code><code><span><span>#自定义分类颜色：</span></span></code><code><span>c4a_gui()</span></code><code><span>mycol &lt;- c4a(<span>'10'</span>,<span>3</span>)</span></code><code><span><br></span></code><code><span>p3 &lt;- p2 +</span></code><code><span>  scale_color_manual(<span>values</span> = mycol) +</span></code><code><span>  scale_fill_manual(<span>values</span> = mycol)</span></code><code><span>p3</span></code><code><span><br></span></code><code><span><br></span></code><code><span><span>#当数据存在不同组别时，可通过颜色映射进行直观比较：</span></span></code><code><span>p2 &lt;- ggcorrm(data = dt,</span></code><code><span>              mapping = aes(color = species, fill = species)) +</span></code><code><span>  lotri(geom_point(alpha = <span>0</span>.<span>3</span>)) +</span></code><code><span>  lotri(geom_smooth(method = <span>'lm'</span>)) +</span></code><code><span>  utri_corrtext(nrow = <span>2</span>, <span>#</span></span></code><code><span>                squeeze = <span>0</span>.<span>5</span>, <span>#存在多标签时，用于调整宽/高比例</span></span></code><code><span>                corr_size = F) +</span></code><code><span>  dia_names(y_pos = <span>0</span>.<span>15</span>, size = <span>3.5</span>) +</span></code><code><span>  dia_density(lower = <span>0</span>.<span>3</span>, upper = <span>0</span>.<span>98</span>,</span></code><code><span>              alpha = <span>0</span>.<span>6</span>)</span></code><code><span>p2</span></code><code><span><br></span></code><code><span><br></span></code><code><span><span>#自定义分类颜色：</span></span></code><code><span>c4a_gui()</span></code><code><span>mycol &lt;- c4a(<span>'10'</span>,<span>3</span>)</span></code><code><span><br></span></code><code><span>p3 &lt;- p2 +</span></code><code><span>  scale_color_manual(<span>values</span> = mycol) +</span></code><code><span>  scale_fill_manual(<span>values</span> = mycol)</span></code><code><span>p3</span></code><code><span><br></span></code><code><span><br></span></code><code><span><span>#自定义主题相关参数：</span></span></code><code><span>mytheme1 &lt;- theme(</span></code><code><span>  axis.text = element_text(size = <span>7</span>),</span></code><code><span>  strip.text = element_text(size = <span>10</span>),</span></code><code><span>  legend.text = element_text(size = <span>9</span>),</span></code><code><span>  legend.title = element_text(size = <span>10</span>)</span></code><code><span>)</span></code><code><span><br></span></code><code><span>p4 &lt;- p3 + mytheme1</span></code><code><span>p4</span></code><code><span><br></span></code></pre></section><p><img data-galleryid="" data-ratio="0.7095588235294118" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/RZcOyvRFYZhI5E6o5apoYktemluZhCpZ3261WL2icvOfdXsKJ9oyu4VRVa7Oia4u6qmibkqAMfYlK9IStruqlTosw/640?wx_fmt=png" data-type="png" data-w="816" src="https://mmbiz.qpic.cn/mmbiz_png/RZcOyvRFYZhI5E6o5apoYktemluZhCpZ3261WL2icvOfdXsKJ9oyu4VRVa7Oia4u6qmibkqAMfYlK9IStruqlTosw/640?wx_fmt=png"></p><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="powershell"><code><span>library(ggplot2)</span></code><code><span><span>data</span>=iris</span></code><code><span>colnames(<span>data</span>)</span></code><code><span><span>data</span><span>$Species</span></span></code><code><span>p1 &lt;- ggplot(<span>data</span>)+</span></code><code><span>  geom_point(aes(Sepal.Length, Sepal.Width, color = Species))+</span></code><code><span>  scale_color_manual(values = c(<span>"setosa"</span> = <span>"#ffbe5d"</span>,</span></code><code><span>                                <span>"versicolor"</span> = <span>"#82a0c3"</span>,</span></code><code><span>                                <span>"virginica"</span> = <span>"#f28c88"</span>))+</span></code><code><span>  theme_classic()+</span></code><code><span>  theme(legend.position = c(<span>0.99</span>,<span>0.99</span>),</span></code><code><span>        legend.justification = c(<span>1</span>,<span>1</span>))+</span></code><code><span>  guides(colour = guide_legend(<span>""</span>))</span></code><code><span><br></span></code><code><span><br></span></code><code><span><span># 上方直方图：对应X轴</span></span></code><code><span>p2 &lt;- ggplot(<span>data</span>)+</span></code><code><span>  geom_histogram(aes(Sepal.Length), </span></code><code><span>                 binwidth = <span>0.2</span>, </span></code><code><span>                 fill = <span>"#9db1c1"</span>,</span></code><code><span>                 color = <span>"#ffffff"</span>,</span></code><code><span>                 size = <span>1</span>)+</span></code><code><span>  theme_classic()+</span></code><code><span>  xlab(<span>""</span>)+</span></code><code><span>  ylab(<span>"# of vOTUs"</span>)</span></code><code><span><br></span></code><code><span><br></span></code><code><span><span># 右侧直方图：对应Y轴</span></span></code><code><span>p3 &lt;- ggplot(<span>data</span>)+</span></code><code><span>  geom_histogram(aes(Sepal.Width), </span></code><code><span>                 binwidth = <span>0.2</span>, </span></code><code><span>                 fill = <span>"#9db1c1"</span>,</span></code><code><span>                 color = <span>"#ffffff"</span>,</span></code><code><span>                 size = <span>1</span>)+</span></code><code><span>  theme_classic()+</span></code><code><span>  xlab(<span>""</span>)+</span></code><code><span>  ylab(<span>"# of vOTUs"</span>)+</span></code><code><span>  coord_flip()</span></code><code><span><br></span></code><code><span><span># 拼图：</span></span></code><code><span>library(cowplot)</span></code><code><span><br></span></code><code><span>ggdraw() + </span></code><code><span>  draw_plot_label(<span>"a"</span>, size = <span>20</span>)+</span></code><code><span>  <span># 四个数值中前两个代表左下角位置：</span></span></code><code><span>  <span># 后两个代表图形宽和高：</span></span></code><code><span>  draw_plot(p1, <span>0.05</span>, <span>0</span>, .<span>75</span>, .<span>8</span>)+</span></code><code><span>  draw_plot(p2, <span>0.05</span>, <span>0.8</span>, .<span>75</span>, .<span>2</span>)+</span></code><code><span>  draw_plot(p3, <span>0.8</span>, <span>0</span>, .<span>2</span>, .<span>8</span>)\</span></code><code><span>  </span></code><code><span><br></span></code></pre></section><p><img data-galleryid="" data-ratio="0.7110091743119266" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/RZcOyvRFYZhI5E6o5apoYktemluZhCpZD08zHhtFWiacHbPUWjouNM0PDUpc4ibxSECtGJlPicZlicFMY2oUhDyCtQ/640?wx_fmt=png" data-type="png" data-w="654" src="https://mmbiz.qpic.cn/mmbiz_png/RZcOyvRFYZhI5E6o5apoYktemluZhCpZD08zHhtFWiacHbPUWjouNM0PDUpc4ibxSECtGJlPicZlicFMY2oUhDyCtQ/640?wx_fmt=png"></p><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="bash"><code><span>library(ggplot2)</span></code><code><span>library(scales)</span></code><code><span>ggplot(iris, aes())+</span></code><code><span>  </span></code><code><span>  geom_jitter(aes(x=iris<span>$Sepal</span>.Length,y=iris<span>$Sepal</span>.Width),position=position_jitter(0.17),size=3, alpha=1,color=<span>"#925F8C"</span>)+</span></code><code><span>  </span></code><code><span>  labs(x=<span>"Sepal.Length"</span>, y=<span>"Sepal.Width"</span>)+</span></code><code><span>  </span></code><code><span>  geom_smooth(aes(x=iris<span>$Sepal</span>.Length, y=iris<span>$Sepal</span>.Width),method=lm,level=0.95,color=<span>"#925F8C"</span>, formula = y~poly(x, 2))+<span>#拟合线</span></span></code><code><span>  </span></code><code><span>  geom_jitter(aes(x=iris<span>$Sepal</span>.Length,y=iris<span>$Petal</span>.Length),position=position_jitter(0.17),size=3, alpha=1,color=<span>"#537F88"</span>, formula = y~poly(x, 2))+</span></code><code><span>  </span></code><code><span>  geom_smooth(aes(x=iris<span>$Sepal</span>.Length,y=iris<span>$Petal</span>.Length),method=lm,level=0.95,color=<span>"#537F88"</span>)+</span></code><code><span>  </span></code><code><span>  theme_classic()+</span></code><code><span>  </span></code><code><span>  scale_y_continuous(sec.axis = sec_axis(~.*0.5, name = <span>'SOC (g/kg)'</span>))+</span></code><code><span>  </span></code><code><span>  theme(panel.grid.major=element_blank(),panel.grid.minor=element_blank())+</span></code><code><span>  </span></code><code><span>  theme(axis.text=element_text(colour=<span>'black'</span>,size=9))</span></code></pre></section><p><img data-galleryid="" data-ratio="0.8555555555555555" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/RZcOyvRFYZhI5E6o5apoYktemluZhCpZcqib7fhFQiaQIjCxvtAiaIYib5EVbo1LvLNHlwc5fUJJvYbFlXnSNLpGicg/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/RZcOyvRFYZhI5E6o5apoYktemluZhCpZcqib7fhFQiaQIjCxvtAiaIYib5EVbo1LvLNHlwc5fUJJvYbFlXnSNLpGicg/640?wx_fmt=png"></p><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="bash"><code><span>library(ggplot2)</span></code><code><span>library(scales)</span></code><code><span>colnames(iris)</span></code><code><span>ggplot(iris,aes(x = Sepal.Length,y = Sepal.Width))+</span></code><code><span>  geom_point(size = 3)+</span></code><code><span>  geom_smooth(method = <span>"lm"</span>,color = <span>"#9f0000"</span>)+</span></code><code><span>  stat_cor(method = <span>"pearson"</span>,<span>#相关系数计算方法</span></span></code><code><span>           label.sep = <span>'\n'</span>,<span>#r和p换行</span></span></code><code><span>           p.accuracy = 0.0001,<span>#P值精确度</span></span></code><code><span>           r.digits = 4,<span>#相关性系数小数点位数</span></span></code><code><span>           label.x = 7,size = 7.5) +</span></code><code><span>  scale_x_continuous(limits = c(4,8.5),expand = c(0,0)) +</span></code><code><span>  scale_y_continuous(limits = c(1.5,5),expand = c(0,0)) +</span></code><code><span>  labs(x = <span>"MAPK-PROGENy GES"</span>,y = <span>"IL-17 GES"</span>) +</span></code><code><span>  ggtitle(<span>"PROGENy versus IL-17"</span>) +</span></code><code><span>  theme_classic() +</span></code><code><span>  theme(axis.text = element_text(color = <span>"black"</span>,size = 18),</span></code><code><span>        axis.title = element_text(size = 20),</span></code><code><span>        plot.title = element_text(size = 20, hjust = 0.5))</span></code></pre></section><p><img data-galleryid="" data-ratio="0.32314814814814813" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/RZcOyvRFYZhI5E6o5apoYktemluZhCpZpoK8sDpcXwpxdKvnEqmiab1aOxhf7cQZJhcMlW8IlBrtsIJN9fF2mfw/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/RZcOyvRFYZhI5E6o5apoYktemluZhCpZpoK8sDpcXwpxdKvnEqmiab1aOxhf7cQZJhcMlW8IlBrtsIJN9fF2mfw/640?wx_fmt=png"></p><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="perl"><code><span>colnames(iris)</span></code><code><span>ggplot(iris, aes(Sepal.Length, Sepal.Width)) + </span></code><code><span>  geom_point(alpha = <span>0</span>.<span>5</span>) + </span></code><code><span>  stat_correlation(aes(label = after_stat(cor.label), method = <span>"pearson"</span>), label.x = <span>0</span>.<span>05</span>, label.y = <span>0</span>.<span>95</span>) +  <span># spearman、pearson</span></span></code><code><span>  stat_correlation(aes(label = after_stat(p.value.label), method = <span>"pearson"</span>), label.x = <span>0</span>.<span>05</span>, label.y = <span>0</span>.<span>85</span>) +  </span></code><code><span>  stat_correlation(aes(label = after_stat(n.label)), label.x =<span>0</span>.<span>05</span>, label.y = <span>0</span>.<span>75</span>) +</span></code><code><span>  geom_smooth(method = <span>"lm"</span>, size = <span>2</span>) + </span></code><code><span>  scale_y_continuous(breaks = se<span>q(0, 0.6, 0.1)</span>) + </span></code><code><span>  scale_x_continuous(breaks = se<span>q(0, 0.6, 0.1)</span>) + </span></code><code><span>  facet_wrap(~Species) + </span></code><code><span>  theme_bw() + </span></code><code><span>  theme(axis.text = element_text(size = <span>12</span>),</span></code><code><span>        axis.text.x = element_text(angle = <span>90</span>, vjust = <span>0</span>.<span>5</span>), </span></code><code><span>        strip.text = element_text(size = <span>12</span>),</span></code><code><span>        axis.title = element_text(size = <span>14</span>),</span></code><code><span>        panel.grid = element_blank()) + </span></code><code><span>  labs(<span>x</span> = <span>"Length"</span>, <span>y</span> = <span>"Width"</span>)</span></code></pre></section><section><img data-galleryid="" data-ratio="0.7929759704251387" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/RZcOyvRFYZhI5E6o5apoYktemluZhCpZUyMn5icRhExicCfCK0Zb5sZFW9xmiaDqJgZrkiatw6icyicXanRAMoM3ITuw/640?wx_fmt=png" data-type="png" data-w="541" src="https://mmbiz.qpic.cn/mmbiz_png/RZcOyvRFYZhI5E6o5apoYktemluZhCpZUyMn5icRhExicCfCK0Zb5sZFW9xmiaDqJgZrkiatw6icyicXanRAMoM3ITuw/640?wx_fmt=png"><img data-galleryid="" data-ratio="0.7333333333333333" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/RZcOyvRFYZhI5E6o5apoYktemluZhCpZbm4htPfw8r1mEAc717w322LAthGCSQ3Ma8APU5wP52zg1ictWFEq0nA/640?wx_fmt=png" data-type="png" data-w="525" src="https://mmbiz.qpic.cn/mmbiz_png/RZcOyvRFYZhI5E6o5apoYktemluZhCpZbm4htPfw8r1mEAc717w322LAthGCSQ3Ma8APU5wP52zg1ictWFEq0nA/640?wx_fmt=png"><img data-galleryid="" data-ratio="0.7300380228136882" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/RZcOyvRFYZhI5E6o5apoYktemluZhCpZhkpicCjLzN9cMbD0OvwJy7NCiaUGImuX9qhhuZ2JzH3Y0BicImx52a5Qg/640?wx_fmt=png" data-type="png" data-w="526" src="https://mmbiz.qpic.cn/mmbiz_png/RZcOyvRFYZhI5E6o5apoYktemluZhCpZhkpicCjLzN9cMbD0OvwJy7NCiaUGImuX9qhhuZ2JzH3Y0BicImx52a5Qg/640?wx_fmt=png"><img data-galleryid="" data-ratio="0.7262357414448669" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/RZcOyvRFYZhI5E6o5apoYktemluZhCpZnLwZdTvg2QTArrtgoI1HxibguLiblqGib72gRgvjb3xm56qbFMiaksOv2g/640?wx_fmt=png" data-type="png" data-w="526" src="https://mmbiz.qpic.cn/mmbiz_png/RZcOyvRFYZhI5E6o5apoYktemluZhCpZnLwZdTvg2QTArrtgoI1HxibguLiblqGib72gRgvjb3xm56qbFMiaksOv2g/640?wx_fmt=png"><img data-galleryid="" data-ratio="0.7276190476190476" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/RZcOyvRFYZhI5E6o5apoYktemluZhCpZYyKplvuuCiaWslnT1AwEMfiaBEQgib2wQue3kn3iaSzYTkX8FzWkFaicrJw/640?wx_fmt=png" data-type="png" data-w="525" src="https://mmbiz.qpic.cn/mmbiz_png/RZcOyvRFYZhI5E6o5apoYktemluZhCpZYyKplvuuCiaWslnT1AwEMfiaBEQgib2wQue3kn3iaSzYTkX8FzWkFaicrJw/640?wx_fmt=png"><img data-galleryid="" data-ratio="0.7300380228136882" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/RZcOyvRFYZhI5E6o5apoYktemluZhCpZdluM4Ds2gdfe6ibW5HQNmOLd5VmE1MRX55mzjygXqlZgSgIyJ57lJMg/640?wx_fmt=png" data-type="png" data-w="526" src="https://mmbiz.qpic.cn/mmbiz_png/RZcOyvRFYZhI5E6o5apoYktemluZhCpZdluM4Ds2gdfe6ibW5HQNmOLd5VmE1MRX55mzjygXqlZgSgIyJ57lJMg/640?wx_fmt=png"><img data-galleryid="" data-ratio="0.7243346007604563" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/RZcOyvRFYZhI5E6o5apoYktemluZhCpZicSVhzaR2HTa00wV8bN1MPibe2CKXfZZmFMRfWTyc0oRtks67l5u1vAw/640?wx_fmt=png" data-type="png" data-w="526" src="https://mmbiz.qpic.cn/mmbiz_png/RZcOyvRFYZhI5E6o5apoYktemluZhCpZicSVhzaR2HTa00wV8bN1MPibe2CKXfZZmFMRfWTyc0oRtks67l5u1vAw/640?wx_fmt=png"><img data-galleryid="" data-ratio="0.6607843137254902" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/RZcOyvRFYZhI5E6o5apoYktemluZhCpZMictribUvAzBQtZtjGnseiczynRliakqMlCNMVANnptiaTT5g0UEdic0XVsA/640?wx_fmt=png" data-type="png" data-w="510" src="https://mmbiz.qpic.cn/mmbiz_png/RZcOyvRFYZhI5E6o5apoYktemluZhCpZMictribUvAzBQtZtjGnseiczynRliakqMlCNMVANnptiaTT5g0UEdic0XVsA/640?wx_fmt=png"><img data-galleryid="" data-ratio="0.7061688311688312" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/RZcOyvRFYZhI5E6o5apoYktemluZhCpZL3JX57l72RKicKh7hGicHYKJ0CV1ouKUGTYVBY7xmh4xmYpMT6GicZ84A/640?wx_fmt=png" data-type="png" data-w="616" src="https://mmbiz.qpic.cn/mmbiz_png/RZcOyvRFYZhI5E6o5apoYktemluZhCpZL3JX57l72RKicKh7hGicHYKJ0CV1ouKUGTYVBY7xmh4xmYpMT6GicZ84A/640?wx_fmt=png"><img data-galleryid="" data-ratio="0.6533333333333333" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/RZcOyvRFYZhI5E6o5apoYktemluZhCpZwUakTojF5sWCMlBVW1ebM1KOA3icQmicpeIB9pOUicWnlD9n3fPzLDEVg/640?wx_fmt=png" data-type="png" data-w="600" src="https://mmbiz.qpic.cn/mmbiz_png/RZcOyvRFYZhI5E6o5apoYktemluZhCpZwUakTojF5sWCMlBVW1ebM1KOA3icQmicpeIB9pOUicWnlD9n3fPzLDEVg/640?wx_fmt=png">......</section><section><img data-galleryid="" data-ratio="0.6527545909849749" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/RZcOyvRFYZhI5E6o5apoYktemluZhCpZgJMH9U15Y1kXvQB4dQ6Xo1LO604kLYInWSzz6lQibhMZsvDCZVM9B8A/640?wx_fmt=png" data-type="png" data-w="599" src="https://mmbiz.qpic.cn/mmbiz_png/RZcOyvRFYZhI5E6o5apoYktemluZhCpZgJMH9U15Y1kXvQB4dQ6Xo1LO604kLYInWSzz6lQibhMZsvDCZVM9B8A/640?wx_fmt=png"></section><p><img data-galleryid="" data-ratio="0.7641509433962265" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/RZcOyvRFYZhI5E6o5apoYktemluZhCpZfxxrT8aouqZJUMM6T9cZTHkZFnBQicK42f1KgK4PWdOIx6cFcnrJjnw/640?wx_fmt=png" data-type="png" data-w="954" src="https://mmbiz.qpic.cn/mmbiz_png/RZcOyvRFYZhI5E6o5apoYktemluZhCpZfxxrT8aouqZJUMM6T9cZTHkZFnBQicK42f1KgK4PWdOIx6cFcnrJjnw/640?wx_fmt=png"><img data-galleryid="" data-ratio="0.7310565635005336" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/RZcOyvRFYZhI5E6o5apoYktemluZhCpZpo5v928B4iae0kadicxLckMHibqHZBl3T23qWqiaor42lbAky0WSmbHIBg/640?wx_fmt=png" data-type="png" data-w="937" src="https://mmbiz.qpic.cn/mmbiz_png/RZcOyvRFYZhI5E6o5apoYktemluZhCpZpo5v928B4iae0kadicxLckMHibqHZBl3T23qWqiaor42lbAky0WSmbHIBg/640?wx_fmt=png"></p><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="php"><code><span><span># install.packages("ggcorrplot")</span></span></code><code><span><span># devtools::install_github("kassambara/ggcorrplot")</span></span></code><code><span><span># 以mtcars内置数据为例：</span></span></code><code><span>library(ggcorrplot)</span></code><code><span>data(mtcars)</span></code><code><span>corr &lt;- round(cor(mtcars), <span>1</span>)</span></code><code><span><span># Compute a matrix of correlation p-values</span></span></code><code><span>p.mat &lt;- cor_pmat(mtcars)</span></code><code><span>head(p.mat[, <span>1</span>:<span>4</span>])</span></code><code><span>ggcorrplot(corr)</span></code><code><span>ggcorrplot(corr, hc.order = <span>TRUE</span>, outline.color = <span>"white"</span>)</span></code><code><span>ggcorrplot(corr,</span></code><code><span>           hc.order = <span>TRUE</span>,</span></code><code><span>           type = <span>"lower"</span>,</span></code><code><span>           outline.color = <span>"white"</span>)</span></code><code><span><br></span></code><code><span>ggcorrplot(</span></code><code><span>  corr,</span></code><code><span>  hc.order = <span>TRUE</span>,</span></code><code><span>  type = <span>"upper"</span>,</span></code><code><span>  outline.color = <span>"white"</span>,</span></code><code><span>  ggtheme = ggplot2::theme_gray,</span></code><code><span>  colors = c(<span>"#6D9EC1"</span>, <span>"white"</span>, <span>"#E46726"</span>)</span></code><code><span>)</span></code><code><span><br></span></code><code><span>ggcorrplot(corr,</span></code><code><span>           hc.order = <span>TRUE</span>,</span></code><code><span>           type = <span>"lower"</span>,</span></code><code><span>           lab = <span>TRUE</span>)</span></code><code><span><br></span></code><code><span>ggcorrplot(corr,</span></code><code><span>           hc.order = <span>TRUE</span>,</span></code><code><span>           type = <span>"lower"</span>,</span></code><code><span>           p.mat = p.mat)</span></code><code><span><br></span></code><code><span><br></span></code><code><span><span># install.packages("corrplot")</span></span></code><code><span>library(corrplot)</span></code><code><span>data(mtcars)</span></code><code><span>corr &lt;- round(cor(mtcars), <span>1</span>)</span></code><code><span><br></span></code><code><span><br></span></code><code><span>corrplot(corr)</span></code><code><span><span>#可选图形样式："circle", "square", "ellipse", "number", "shade", "color", "pie"</span></span></code><code><span>library(ggplot2)</span></code><code><span>corrplot(corr, method = c(<span>'square'</span>))</span></code><code><span>corrplot(corr, method = c(<span>'ellipse'</span>))</span></code><code><span>corrplot(corr, method = c(<span>'number'</span>))</span></code><code><span>corrplot(corr, method = c(<span>'shade'</span>))</span></code><code><span>corrplot(corr, method = c(<span>'color'</span>))</span></code><code><span>corrplot(corr, method = c(<span>'pie'</span>))</span></code><code><span><br></span></code><code><span><br></span></code><code><span>  </span></code><code><span><span># 接下来介绍corrplot更多的参数：</span></span></code><code><span><span># outline = 'grey'是否为图形添加外轮廓线，默认FLASE，可直接TRUE或指定颜色向量</span></span></code><code><span><span># col是自己定义的颜色或色卡</span></span></code><code><span><span># order是聚类方式选择："original", "AOE", "FPC", "hclust", "alphabet"</span></span></code><code><span><span># tl.cex是文本标签大小</span></span></code><code><span><span># tl.col文本标签颜色</span></span></code><code><span><span># addgrid.col是文本标签颜色</span></span></code><code><span><span># diag = FALSE是否展示对角线结果，默认TRUE</span></span></code><code><span><span># 参数介绍</span></span></code><code><span>mycol &lt;- colorRampPalette(c(<span>"#06a7cd"</span>, <span>"white"</span>, <span>"#e74a32"</span>), alpha = <span>TRUE</span>)</span></code><code><span>mycol2 &lt;- colorRampPalette(c(<span>"#0AA1FF"</span>,<span>"white"</span>, <span>"#F5CC16"</span>), alpha = <span>TRUE</span>)</span></code><code><span>corrplot(corr, method = c(<span>'square'</span>), type = c(<span>'lower'</span>), </span></code><code><span>         col = mycol2(<span>100</span>),</span></code><code><span>         outline = <span>'grey'</span>, <span>#是否为图形添加外轮廓线，默认FLASE，可直接TRUE或指定颜色向量</span></span></code><code><span>         order = c(<span>'AOE'</span>), <span>#排序/聚类方式选择："original", "AOE", "FPC", "hclust", "alphabet"</span></span></code><code><span>         diag = <span>FALSE</span>, <span>#是否展示对角线结果，默认TRUE</span></span></code><code><span>         tl.cex = <span>1.2</span>, <span>#文本标签大小</span></span></code><code><span>         tl.col = <span>'black'</span>, <span>#文本标签颜色</span></span></code><code><span>         addgrid.col= <span>'grey'</span> <span>#格子轮廓颜色</span></span></code><code><span>)</span></code><code><span><span># 图片</span></span></code><code><span><span># 接下来叠加相关性结果：</span></span></code><code><span><span># 叠加相关性</span></span></code><code><span>corrplot(corr, method = c(<span>'ellipse'</span>), </span></code><code><span>         type = c(<span>'lower'</span>), </span></code><code><span>         col = mycol(<span>100</span>),</span></code><code><span>         outline = <span>'grey'</span>,</span></code><code><span>         order = c(<span>'AOE'</span>),</span></code><code><span>         diag = <span>TRUE</span>,</span></code><code><span>         tl.cex = <span>1.2</span>, </span></code><code><span>         tl.col = <span>'black'</span>,</span></code><code><span>         addCoef.col = <span>'black'</span>, <span>#在现有样式中添加相关性系数数字，并指定颜色</span></span></code><code><span>         number.cex = <span>0.8</span>, <span>#相关性系数数字标签大小</span></span></code><code><span>)</span></code><code><span><br></span></code><code><span>corrplot(corr, method = c(<span>'pie'</span>), </span></code><code><span>         type = c(<span>'upper'</span>), </span></code><code><span>         col = mycol(<span>100</span>),</span></code><code><span>         outline = <span>'grey'</span>, </span></code><code><span>         order = c(<span>'AOE'</span>), </span></code><code><span>         diag = <span>TRUE</span>,</span></code><code><span>         tl.cex = <span>1</span>, <span>#对角线文字大小</span></span></code><code><span>         tl.col = <span>'black'</span>, <span>#对角线文字颜色</span></span></code><code><span>         tl.pos = <span>'d'</span> <span>#仅在对角线显示文本标签</span></span></code><code><span>)</span></code><code><span>corrplot(corr, add = <span>TRUE</span>,</span></code><code><span>         method = c(<span>'number'</span>), </span></code><code><span>         type = c(<span>'lower'</span>), </span></code><code><span>         col = mycol(<span>100</span>),</span></code><code><span>         order = c(<span>'AOE'</span>), </span></code><code><span>         diag = <span>FALSE</span>, </span></code><code><span>         number.cex = <span>0.9</span>,</span></code><code><span>         tl.pos = <span>'n'</span>, <span>#不显示文本标签</span></span></code><code><span>         cl.pos = <span>'n'</span> <span>#不显示颜色图例</span></span></code><code><span>)</span></code><code><span>corrplot(corr, method = c(<span>'square'</span>), </span></code><code><span>         type = c(<span>'upper'</span>), </span></code><code><span>         col = mycol(<span>100</span>),</span></code><code><span>         outline = <span>'grey'</span>, </span></code><code><span>         order = c(<span>'AOE'</span>), </span></code><code><span>         diag = <span>TRUE</span>,</span></code><code><span>         tl.cex = <span>1.2</span>, </span></code><code><span>         tl.col = <span>"black"</span>,</span></code><code><span>         tl.pos = <span>"tp"</span></span></code><code><span>)</span></code><code><span>corrplot(corr, add = <span>TRUE</span>,</span></code><code><span>         method = c(<span>'number'</span>), </span></code><code><span>         type = c(<span>'lower'</span>), </span></code><code><span>         col = mycol(<span>100</span>),</span></code><code><span>         order = c(<span>'AOE'</span>), </span></code><code><span>         diag = <span>FALSE</span>, </span></code><code><span>         number.cex = <span>1.3</span>,</span></code><code><span>         tl.pos = <span>'n'</span>, </span></code><code><span>         cl.pos = <span>'n'</span></span></code><code><span>)</span></code><code><span><br></span></code><code><span><span># 显著性添加</span></span></code><code><span><span># 显著性计算：</span></span></code><code><span>res &lt;- cor.mtest(mtcars, conf.level = <span>.95</span>)</span></code><code><span>p &lt;- res$p</span></code><code><span><br></span></code><code><span><span>#上三角图添加显著性水平星号：</span></span></code><code><span>corrplot(corr, method = c(<span>'pie'</span>), </span></code><code><span>         type = c(<span>'upper'</span>), </span></code><code><span>         col = mycol(<span>100</span>),</span></code><code><span>         outline = <span>'grey'</span>, </span></code><code><span>         order = c(<span>'AOE'</span>), </span></code><code><span>         diag = <span>TRUE</span>,</span></code><code><span>         tl.cex = <span>1</span>, </span></code><code><span>         tl.col = <span>'black'</span>,</span></code><code><span>         tl.pos = <span>'d'</span>,</span></code><code><span>         p.mat = p,</span></code><code><span>         sig.level = c(<span>.001</span>, <span>.01</span>, <span>.05</span>),</span></code><code><span>         insig = <span>"label_sig"</span>, <span>#显著性标注样式："pch", "p-value", "blank", "n", "label_sig"</span></span></code><code><span>         pch.cex = <span>1.2</span>, <span>#显著性标记大小</span></span></code><code><span>         pch.col = <span>'black'</span> <span>#显著性标记颜色</span></span></code><code><span>)</span></code><code><span><span>#下三角图添加不显著叉号：</span></span></code><code><span>corrplot(corr, add = <span>TRUE</span>,</span></code><code><span>         method = c(<span>'number'</span>), </span></code><code><span>         type = c(<span>'lower'</span>),</span></code><code><span>         col = mycol(<span>100</span>),</span></code><code><span>         order = c(<span>'AOE'</span>), </span></code><code><span>         diag = <span>FALSE</span>, </span></code><code><span>         number.cex = <span>0.9</span>,</span></code><code><span>         tl.pos = <span>'n'</span>, </span></code><code><span>         cl.pos = <span>'n'</span>,</span></code><code><span>         p.mat = p,</span></code><code><span>         insig = <span>"pch"</span></span></code><code><span>)</span></code><code><span><br></span></code><code><span><br></span></code><code><span><span># 先安装ggcor包</span></span></code><code><span><span># devtools::install_github("Github-Yilei/ggcor")</span></span></code><code><span>library(ggcor)</span></code><code><span>library(ggplot2)</span></code><code><span>set_scale()</span></code><code><span>quickcor(mtcars) + geom_square()</span></code><code><span>quickcor(mtcars, type = <span>"upper"</span>) + geom_circle2()</span></code><code><span>quickcor(mtcars, cor.test = <span>TRUE</span>) +</span></code><code><span>  geom_square(data = get_data(type = <span>"lower"</span>, show.diag = <span>FALSE</span>)) +</span></code><code><span>  geom_mark(data = get_data(type = <span>"upper"</span>, show.diag = <span>FALSE</span>), size = <span>2.5</span>) +</span></code><code><span>  geom_abline(slope = <span>-1</span>, intercept = <span>12</span>)</span></code><code><span><br></span></code><code><span>library(dplyr)</span></code><code><span><span>#&gt; Warning: package 'dplyr' was built under R version 3.6.2</span></span></code><code><span>data(<span>"varechem"</span>, package = <span>"vegan"</span>)</span></code><code><span>data(<span>"varespec"</span>, package = <span>"vegan"</span>)</span></code><code><span><br></span></code><code><span>mantel &lt;- mantel_test(varespec, varechem,</span></code><code><span>                      spec.select = <span>list</span>(Spec01 = <span>1</span>:<span>7</span>,</span></code><code><span>                                         Spec02 = <span>8</span>:<span>18</span>,</span></code><code><span>                                         Spec03 = <span>19</span>:<span>37</span>,</span></code><code><span>                                         Spec04 = <span>38</span>:<span>44</span>)) %&gt;% </span></code><code><span>  mutate(rd = cut(r, breaks = c(-Inf, <span>0.2</span>, <span>0.4</span>, Inf),</span></code><code><span>                  labels = c(<span>"&lt; 0.2"</span>, <span>"0.2 - 0.4"</span>, <span>"&gt;= 0.4"</span>)),</span></code><code><span>         pd = cut(p.value, breaks = c(-Inf, <span>0.01</span>, <span>0.05</span>, Inf),</span></code><code><span>                  labels = c(<span>"&lt; 0.01"</span>, <span>"0.01 - 0.05"</span>, <span>"&gt;= 0.05"</span>)))</span></code><code><span><br></span></code><code><span>quickcor(varechem, type = <span>"upper"</span>) +</span></code><code><span>  geom_square() +</span></code><code><span>  anno_link(aes(colour = pd, size = rd), data = mantel) +</span></code><code><span>  scale_size_manual(values = c(<span>0.5</span>, <span>1</span>, <span>2</span>)) +</span></code><code><span>  scale_colour_manual(values = c(<span>"#D95F02"</span>, <span>"#1B9E77"</span>, <span>"#A2A2A288"</span>)) +</span></code><code><span>  guides(size = guide_legend(title = <span>"Mantel's r"</span>,</span></code><code><span>                             override.aes = <span>list</span>(colour = <span>"grey35"</span>), </span></code><code><span>                             order = <span>2</span>),</span></code><code><span>         colour = guide_legend(title = <span>"Mantel's p"</span>, </span></code><code><span>                               override.aes = <span>list</span>(size = <span>3</span>), </span></code><code><span>                               order = <span>1</span>),</span></code><code><span>         fill = guide_colorbar(title = <span>"Pearson's r"</span>, order = <span>3</span>))</span></code><code><span><span># 图片</span></span></code><code><span><span># install.packages('ambient')</span></span></code><code><span><span># ggcor包还可以绘制环状热图Circular heatmap</span></span></code><code><span>rand_correlate(<span>100</span>, <span>8</span>) %&gt;% <span>## require ambient packages</span></span></code><code><span>  quickcor(circular = <span>TRUE</span>, cluster = <span>TRUE</span>, open = <span>45</span>) +</span></code><code><span>  geom_colour(colour = <span>"white"</span>, size = <span>0.125</span>) +</span></code><code><span>  anno_row_tree() +</span></code><code><span>  anno_col_tree() +</span></code><code><span>  set_p_xaxis() +</span></code><code><span>  set_p_yaxis()</span></code><code><span><span>#&gt; Warning: Removed 8 rows containing missing values (geom_text).</span></span></code></pre></section><section powered-by="xiumi.us"><section><br></section></section><section powered-by="xiumi.us"><br></section><section powered-by="xiumi.us"><section><br></section></section><p><img data-galleryid="" data-ratio="0.9090909090909091" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/RZcOyvRFYZhI5E6o5apoYktemluZhCpZM7XYgpscicTfRIW1FnB2H3iazqvDziaIFR758ibhbFwWtu1STX2JicnSO4A/640?wx_fmt=png" data-type="png" data-w="737" src="https://mmbiz.qpic.cn/mmbiz_png/RZcOyvRFYZhI5E6o5apoYktemluZhCpZM7XYgpscicTfRIW1FnB2H3iazqvDziaIFR758ibhbFwWtu1STX2JicnSO4A/640?wx_fmt=png"><img data-galleryid="" data-ratio="0.7310565635005336" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/RZcOyvRFYZhI5E6o5apoYktemluZhCpZrLD73oxFY558z4JLjfjtTMyFoh0j6zo0chqMWZHLcFa17JS97RA6yA/640?wx_fmt=png" data-type="png" data-w="937" src="https://mmbiz.qpic.cn/mmbiz_png/RZcOyvRFYZhI5E6o5apoYktemluZhCpZrLD73oxFY558z4JLjfjtTMyFoh0j6zo0chqMWZHLcFa17JS97RA6yA/640?wx_fmt=png"><img data-galleryid="" data-ratio="0.7284345047923323" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/RZcOyvRFYZhI5E6o5apoYktemluZhCpZM2Oc3oiaCjA24dGogiao4zze7xypx3czYia7ticRe3AyXy3pknAicZbEr5w/640?wx_fmt=png" data-type="png" data-w="939" src="https://mmbiz.qpic.cn/mmbiz_png/RZcOyvRFYZhI5E6o5apoYktemluZhCpZM2Oc3oiaCjA24dGogiao4zze7xypx3czYia7ticRe3AyXy3pknAicZbEr5w/640?wx_fmt=png"><span></span></p><p><br></p><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="powershell"><code><span><span># remotes::install_github("r-link/corrmorant")</span></span></code><code><span>library(corrmorant)</span></code><code><span><br></span></code><code><span>library(ggplot2)</span></code><code><span>library(cols4all)</span></code><code><span>df &lt;- mtcars <span>#使用mtcars测试</span></span></code><code><span>p5 &lt;- ggcorrm(<span>data</span> = df,</span></code><code><span>              mapping = aes(color = .corr, fill = .corr),</span></code><code><span>              corr_method = c(<span>'pearson'</span>),</span></code><code><span>              rescale = <span>'by_sd'</span>) +</span></code><code><span>  lotri_heatcircle(alpha = <span>1</span>, color = <span>'grey'</span>) + <span>#下三角区域添加圆形热图</span></span></code><code><span>  utri_corrtext(squeeze = <span>0.6</span>, corr_size = F) +</span></code><code><span>  dia_names(y_pos = <span>0.5</span>, size = <span>5</span>, color = <span>'black'</span>)</span></code><code><span>p5</span></code><code><span><span>#使用内置色板：</span></span></code><code><span>p6 &lt;- p5 +</span></code><code><span>  scale_color_corr(aesthetics = c(<span>"fill"</span>, <span>"color"</span>),</span></code><code><span>                   option = <span>'D'</span>) <span>#提供A-D四种内置渐变配色可</span></span></code><code><span>p6</span></code><code><span><span>#也可自定义渐变配色：</span></span></code><code><span>p7 &lt;- p5 +</span></code><code><span>  scale_colour_gradient2(aesthetics = c(<span>"fill"</span>, <span>"color"</span>),</span></code><code><span>                         limits = c(-<span>1</span>, <span>1</span>),</span></code><code><span>                         low = <span>'#06a7cd'</span>,</span></code><code><span>                         mid = <span>"white"</span>,</span></code><code><span>                         high = <span>'#e74a32'</span>)</span></code><code><span>p7</span></code><code><span><span>#主题参数美化：</span></span></code><code><span>mytheme2 &lt;- theme(</span></code><code><span>  axis.text = element_blank(),</span></code><code><span>  axis.ticks = element_blank(),</span></code><code><span>  strip.text = element_blank(),</span></code><code><span>  legend.text = element_text(size = <span>10</span>),</span></code><code><span>  legend.title = element_text(size = <span>12</span>)</span></code><code><span>  )</span></code><code><span><br></span></code><code><span><br></span></code><code><span>p8 &lt;- p7 + mytheme2</span></code><code><span>p8</span></code><code><span><span>#其它样式组合</span></span></code><code><span><span>##上下三角区域颠倒+添加相关性热图背景色块</span></span></code><code><span>p9 &lt;- ggcorrm(<span>data</span> = df,</span></code><code><span>              corr_method = c(<span>'pearson'</span>),</span></code><code><span>              rescale = <span>'by_sd'</span>) +</span></code><code><span>  utri_heatcircle(alpha = <span>1</span>) +</span></code><code><span>  lotri_heatmap(alpha = <span>0.6</span>) +</span></code><code><span>  lotri_corrtext(nrow = <span>2</span>, squeeze = <span>0.6</span>, corr_size = F) +</span></code><code><span>  dia_names(y_pos = <span>0.5</span>, size = <span>5</span>, color = <span>'black'</span>) +</span></code><code><span>  scale_colour_gradient2(aesthetics = c(<span>"fill"</span>, <span>"color"</span>),</span></code><code><span>                         limits = c(-<span>1</span>, <span>1</span>),</span></code><code><span><br></span></code><code><span><br></span></code><code><span>                         low = <span>'#06a7cd'</span>,</span></code><code><span><br></span></code><code><span><br></span></code><code><span>                         mid = <span>'white'</span>,</span></code><code><span><br></span></code><code><span><br></span></code><code><span>                         high = <span>'#e74a32'</span>) +</span></code><code><span>  mytheme2</span></code><code><span><br></span></code><code><span><br></span></code><code><span>p9</span></code></pre></section><section powered-by="xiumi.us"><section><br></section></section><section powered-by="xiumi.us"><section><img data-ratio="0.45185185185185184" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/frkibkB9ibxnVjBaNaS8r05y2NNYdwDeoSSu6CicV6yO9GL5Xw08oFiafCrADShATUlbcicPYctzXVNqvVBFwP0QhfQ/640?wx_fmt=png&amp;tp=wxpic&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/frkibkB9ibxnVjBaNaS8r05y2NNYdwDeoSSu6CicV6yO9GL5Xw08oFiafCrADShATUlbcicPYctzXVNqvVBFwP0QhfQ/640?wx_fmt=png&amp;tp=wxpic&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"></section></section><section powered-by="xiumi.us"><p><br></p></section><section powered-by="xiumi.us"><section data-tool="markdown编辑器" data-website="https://markdown.com.cn/editor"><pre data-tool="markdown.com.cn编辑器"><code><span>#载入R包</span><br><span>library</span>(ggplot2)<br><span>library</span>(ggcor)<br>data(mtcars) <span>#观察数据类型：数据按竖列储存，需要计算列与列之间的相关性，以r值绘图。默认情况下计算的是一个数据框内部的相关性</span><br>             <span>#我们也可以输入两个数据框，计算两组数据之间的相关性矩阵</span><br>             <span>#默认顺序为列的顺序</span><br><br>colnames(mtcars) <span>#查看数据列名</span><br>quickcor(mtcars) + geom_square() <span>#绘制相关性热图，前者快速计算相关性并绘制网格，后者创建图像形状</span><br>                                 <span>#在不聚类的情况下，热图顺序为列名顺序</span><br>mtcars2&lt;-mtcars[,colnames(mtcars)[c(<span>3</span>,<span>1</span>,<span>2</span>,<span>4</span>,<span>6</span>,<span>5</span>,<span>7</span>,<span>8</span>,<span>11</span>,<span>10</span>,<span>9</span>)]] <span>#随便设置一个顺序，实际应用请自行决定顺序</span><br>quickcor(mtcars2) + geom_square()<br><span></span></code></pre></section></section><section powered-by="xiumi.us"><section powered-by="xiumi.us"><section><img data-ratio="0.42962962962962964" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/frkibkB9ibxnVjBaNaS8r05y2NNYdwDeoS7RLJiaNfvoy5P7icUDwkPcYyfjchiaOic4NfAOmoCv8AFNAxNlKu0ULznA/640?wx_fmt=png&amp;tp=wxpic&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/frkibkB9ibxnVjBaNaS8r05y2NNYdwDeoS7RLJiaNfvoy5P7icUDwkPcYyfjchiaOic4NfAOmoCv8AFNAxNlKu0ULznA/640?wx_fmt=png&amp;tp=wxpic&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"></section></section></section><section powered-by="xiumi.us"><section data-tool="markdown编辑器" data-website="https://markdown.com.cn/editor"><pre data-tool="markdown.com.cn编辑器"><code><span>#自定义一些颜色</span><br>mycolors &lt;- c(<span>"#3b374c"</span>, <span>"#44598e"</span>, <span>"#64a0c0"</span>, <span>"#7ec4b7"</span>, <span>"#deebcd"</span>) <span>#藏青-浅绿</span><br>mycolors &lt;- c(<span>"#073f82"</span>, <span>"#1b71b4"</span>, <span>"#58a4cf"</span>, <span>"#a2cbe3"</span>, <span>"#f2f9fe"</span>) <span>#藏蓝-浅蓝</span><br>mycolors &lt;- c(<span>"#eeecdf"</span>, <span>"#becdd2"</span>, <span>"#6f9ad1"</span>, <span>"#44679f"</span>, <span>"#3f4f71"</span>) <span>#藏蓝-水泥灰</span><br>mycolors &lt;- c(<span>"#492952"</span>, <span>"#82677e"</span>, <span>"white"</span>, <span>"#59829e"</span>, <span>"#1e4668"</span>) <span>#脏紫-脏蓝</span><br>mycolors &lt;- c(<span>"#57121d"</span>, <span>"#d56e5e"</span>, <span>"#eaebea"</span>, <span>"#5390b5"</span>, <span>"#1f294e"</span>) <span>#经典红-蓝</span><br><br><span>#运行代码如果出现Warning，可以忽略，不影响使用</span><br>quickcor(mtcars, <br>         type = c(<span>"lower"</span>, <span>"upper"</span>, <span>"full"</span>)[<span>3</span>], <span>#修改中括号内数值1~3选择不同类型的相关性矩阵</span><br>         cluster = <span>T</span>,  <span>#是否进行聚类，默认值为False ，如果设置为T，那么就无法自定义顺序</span><br>         is.cor = <span>F</span>,  <span>#输入的数据是否是相关性系数结果，默认为F，表示输入的是元素数据</span><br>         circular = <span>F</span>, <span>#默认为F，表示是否转换为环形图，可设置为T</span><br>         grid.colour = <span>"black"</span>, <span>#网格颜色，默认为"grey50"</span><br>         grid.size = <span>0.25</span>,  <span>#网格线条粗细，默认0.25</span><br>         show.diag = <span>T</span>, <span>#是否显示对角线</span><br>         method = <span>"pearson"</span> <span>#默认为皮尔森。 </span><br>         ) + <span>#quickcor还有更多的设置参数请详细阅读R包源码，但多数情况下你不需要知道那么多！用默认的就行</span><br>  <br>  geom_square(colour = <span>"#5a5c5f"</span>, size = <span>0.6</span>, linetype = <span>2</span>) +  <span>#绘制正方形热图，描边粗细、线条类型</span><br>  geom_number(aes(num = r), data = get_data(show.diag = <span>FALSE</span>, abs(r) &gt; <span>0.7</span>), size = <span>2.5</span>, color = <span>"white"</span>)+ <span>#添加r值文字</span><br>  <br>  scale_fill_gradientn(colours = mycolors,  <span>#自定义颜色</span><br>                       breaks = c(-<span>0.6</span>, <span>0</span>, <span>0.6</span>)) +  <span>#自定义刻度值</span><br>  labs(fill = <span>"R(pearson)"</span>)+ <span>#修改图例标题</span><br>  theme(<br>    axis.text.x = element_text(color = c(rep(mycolors[<span>1</span>], <span>5</span>), rep(mycolors[length(mycolors)], <span>6</span>)), <span>#X轴标签颜色</span><br>                               <span>#face = "bold", </span><br>                               size = <span>10</span>), <span>#设置加粗字体和大小</span><br>    axis.text.y = element_text(color = c(rep(mycolors[<span>1</span>], <span>6</span>), rep(mycolors[length(mycolors)], <span>5</span>)), <span>#Y轴标签颜色</span><br>                               <span>#face = "bold", </span><br>                               size = <span>10</span>),   <span>#设置加粗字体和大小</span><br>    legend.text = element_text(size = <span>10</span>) <span>#设置图例标签字体大小</span><br>  )<br></code></pre></section></section><section powered-by="xiumi.us"><img data-ratio="0.4351851851851852" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/frkibkB9ibxnVjBaNaS8r05y2NNYdwDeoS713eCUoMbdcvVFibeQOVWt2ib76xZibMxGpSTeg8icOtGQ77aZ4KIWJia2w/640?wx_fmt=png&amp;tp=wxpic&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/frkibkB9ibxnVjBaNaS8r05y2NNYdwDeoS713eCUoMbdcvVFibeQOVWt2ib76xZibMxGpSTeg8icOtGQ77aZ4KIWJia2w/640?wx_fmt=png&amp;tp=wxpic&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"><br></section><section powered-by="xiumi.us"><section data-tool="markdown编辑器" data-website="https://markdown.com.cn/editor"><pre data-tool="markdown.com.cn编辑器"><code>quickcor(mtcars, <br>         type = c(<span>"lower"</span>, <span>"upper"</span>, <span>"full"</span>)[<span>3</span>], <span>#修改中括号内数值1~3选择不同类型的相关性矩阵</span><br>         cluster = <span>T</span>,  <span>#是否进行聚类，默认值为False ，如果设置为T，那么就无法自定义顺序</span><br>         is.cor = <span>F</span>,  <span>#输入的数据是否是相关性系数结果，默认为F，表示输入的是元素数据</span><br>         circular = <span>F</span>, <span>#默认为F，表示是否转换为环形图，可设置为T</span><br>         grid.colour = <span>"black"</span>, <span>#网格颜色，默认为"grey50"</span><br>         grid.size = <span>0.25</span>,  <span>#网格线条粗细，默认0.25</span><br>         show.diag = <span>T</span>, <span>#是否显示对角线</span><br>         method = <span>"pearson"</span> <span>#默认为皮尔森。 </span><br>) +<br>  <br>  <span>#下面任选一个图形，其他的在代码最前面加#号</span><br>  <span>#geom_square(colour = "#5a5c5f", size = 0.6, linetype = 2) +  #绘制正方形热图，描边粗细、线条类[此处绘制p3的图]</span><br>  geom_circle2(colour = <span>"grey35"</span>, size = <span>0.25</span>, linetype = <span>1</span>)+ <span>#绘制圆形热图 ，描边粗细、线条类型</span><br>  <span>#geom_ellipse2(colour = "#5a5c5f", size = 0.6, linetype = 2)+ #椭圆形热图，描边粗细、线条类型</span><br>  <span>#geom_colour(size = 0.3, linetype = 1)+   #经典热图，描边粗细、线条类型</span><br>  <span>#geom_pie2()+ #绘制饼图</span><br>  <span>#geom_star()+ #绘制五角星热图</span><br>  <br>  <br>  geom_number(aes(num = r), data = get_data(show.diag = <span>FALSE</span>, abs(r) &gt; <span>0.7</span>), size = <span>2.5</span>, color = <span>"white"</span>)+ <span>#添加r值文字</span><br>  scale_fill_gradientn(colours = mycolors,  <span>#自定义颜色</span><br>                       breaks = c(-<span>0.6</span>, <span>0</span>, <span>0.6</span>)) +  <span>#自定义刻度值</span><br>  labs(fill = <span>"R(pearson)"</span>)+ <span>#修改图例标题</span><br>  theme(<br>    axis.text.x = element_text(color = c(rep(mycolors[<span>1</span>], <span>5</span>), rep(mycolors[length(mycolors)], <span>6</span>)), <span>#X轴标签颜色</span><br>                               <span>#face = "bold", </span><br>                               size = <span>10</span>), <span>#设置加粗字体和大小</span><br>    axis.text.y = element_text(color = c(rep(mycolors[<span>1</span>], <span>6</span>), rep(mycolors[length(mycolors)], <span>5</span>)), <span>#Y轴标签颜色</span><br>                               <span>#face = "bold", </span><br>                               size = <span>10</span>),   <span>#设置加粗字体和大小</span><br>    legend.text = element_text(size = <span>10</span>)<br>  )<br><br></code></pre></section></section><section powered-by="xiumi.us"><section powered-by="xiumi.us"><section><img data-ratio="0.9092592592592592" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/frkibkB9ibxnVjBaNaS8r05y2NNYdwDeoS8Y4UTP9iacyTqwLEtVLIbLib1tGqFJ8k9J4ea4zNlcGlby6agYlaEV6w/640?wx_fmt=png&amp;tp=wxpic&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/frkibkB9ibxnVjBaNaS8r05y2NNYdwDeoS8Y4UTP9iacyTqwLEtVLIbLib1tGqFJ8k9J4ea4zNlcGlby6agYlaEV6w/640?wx_fmt=png&amp;tp=wxpic&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"></section></section><p><br></p></section><section powered-by="xiumi.us"><section data-tool="markdown编辑器" data-website="https://markdown.com.cn/editor"><pre data-tool="markdown.com.cn编辑器"><code><span>#通过阅读ggcor包的源码，quickcor快速计算相关性矩阵，但不返还计算结果。一些情况下我们需要保存原始数据。因此我们手动计算</span><br><span>#计算相关性并返还p值，结果储存在列表中，请按自己需要进行保存</span><br>data.cor &lt;- correlate(mtcars,<br>                      cor.test = <span>TRUE</span>, <span>#进行相关性检验</span><br>                      method = <span>"pearson"</span>, <span>#检验方法，"pearson", "kendall", "spearman"</span><br>                      use = <span>"everything"</span>, <span>#缺失值处理方法</span><br>                      p.adjust = <span>FALSE</span>, <span>#是否进行p值校正</span><br>                      p.adjust.method = <span>"holm"</span>, <span>#校正方法[不懂原理及应用的保存默认设置即可]，自定义请详细阅读说明及源码</span><br>) <br><br>data.plot &lt;- as_cor_tbl(data.cor, <span>#相关性矩阵结果</span><br>                        show.diag = <span>TRUE</span>, <span>#是否显示对角线</span><br>                        cluster = <span>TRUE</span>, <span>#是否聚类</span><br>                        cluster.method = <span>"complete"</span> <span>#聚类方法.....</span><br>                        ) <span>#转换为绘图格式</span><br><br><br><span>#绘制p5，新添加交叉标记、置信度星号、斜线纹理</span><br>mycolors &lt;- c(<span>"#3b374c"</span>, <span>"#44598e"</span>, <span>"#64a0c0"</span>, <span>"#7ec4b7"</span>, <span>"#deebcd"</span>) <span>#藏青-浅绿</span><br>quickcor(mtcars, <br>         type = c(<span>"lower"</span>, <span>"upper"</span>, <span>"full"</span>)[<span>3</span>], <span>#修改中括号内数值1~3选择不同类型的相关性矩阵</span><br>         cluster = <span>T</span>,  <span>#是否进行聚类，默认值为False ，如果设置为T，那么就无法自定义顺序</span><br>         is.cor = <span>F</span>,  <span>#输入的数据是否是相关性系数结果，默认为F，表示输入的是元素数据</span><br>         circular = <span>F</span>, <span>#默认为F，表示是否转换为环形图，可设置为T</span><br>         grid.colour = <span>"black"</span>, <span>#网格颜色，默认为"grey50"</span><br>         grid.size = <span>0.25</span>,  <span>#网格线条粗细，默认0.25</span><br>         show.diag = <span>T</span>, <span>#是否显示对角线</span><br>         cor.test = <span>TRUE</span>,<br>         method = <span>"pearson"</span>) +<br>  <br>  <span>#下面任选一个图形，其他的在代码最前面加#号，注意此处多了get_data(type = "lower")，可以设置"lower", "upper", "full"等</span><br>  geom_square(data = get_data(type = <span>"lower"</span>), colour = <span>"#5a5c5f"</span>, size = <span>0.6</span>, linetype = <span>2</span>) +  <span>#绘制正方形热图</span><br>  <span>#geom_circle2(data = get_data(type = "lower"), colour = "grey35", size = 0.25, linetype = 2)+ #绘制圆形热图</span><br>  <span>#geom_ellipse2(data = get_data(type = "lower"), colour = "#5a5c5f", size = 0.6, linetype = 2)+ #椭圆形热图</span><br>  <span>#geom_colour(data = get_data(type = "lower"), colour = "#5a5c5f", size = 0.6, linetype = 2)+   #经典热图</span><br>  <span>#geom_pie2(data = get_data(type = "lower"))+ #绘制饼图</span><br>  <span>#geom_star(data = get_data(type = "lower"))+ #绘制五角星热图</span><br>  geom_shade(data = get_data(type = <span>"lower"</span>), sign = <span>1</span>)+ <span>#添加斜线阴影,sign&gt;0,则在R值大于0的位置添加阴影。反之...</span><br>  geom_mark(data = get_data(type = <span>"upper"</span>, r != <span>1</span>, p.value &lt; <span>0.05</span>, abs(r) &gt;= <span>0.3</span>), <span>#get_data调用dplyr包的filter函数用于过滤</span><br>            size = <span>2</span>  <span>#设置字体大小</span><br>            <span>#aes(colour = r), #设置字体颜色映射</span><br>            <span>#show.legend = F</span><br>  )+<br>  geom_cross(data = get_data(type = <span>"lower"</span>), colour = <span>"orange"</span>)+ <span>#交叉标记，排除不显著的(即右上角空白处对应的位置)</span><br>  <br>  scale_fill_gradientn(colours = mycolors,  <span>#自定义颜色</span><br>                       breaks = c(-<span>0.6</span>, <span>0</span>, <span>0.6</span>)) +  <span>#自定义刻度值</span><br>  labs(fill = <span>"Cor(R)"</span>)+ <span>#修改图例标题</span><br>  theme(<br>    axis.text.x = element_text(color = c(rep(mycolors[<span>1</span>], <span>5</span>), rep(mycolors[length(mycolors)-<span>2</span>], <span>6</span>)), <span>#X轴标签颜色</span><br>                               <span>#face = "bold", </span><br>                               size = <span>10</span>), <span>#设置加粗字体和大小</span><br>    axis.text.y = element_text(color = c(rep(mycolors[<span>1</span>], <span>6</span>), rep(mycolors[length(mycolors)-<span>2</span>], <span>5</span>)), <span>#Y轴标签颜色</span><br>                               <span>#face = "bold", </span><br>                               size = <span>10</span>)   <span>#设置加粗字体和大小</span><br>  )<br><br></code></pre></section></section><section powered-by="xiumi.us"><br></section><section powered-by="xiumi.us"><p><img data-galleryid="" data-ratio="0.7310565635005336" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/RZcOyvRFYZhI5E6o5apoYktemluZhCpZibBt0MiauNeE9Yx4KjDZoKhibZmXbPBOtdzhjKT1icrLNJEu6Ap95ic0TQQ/640?wx_fmt=png" data-type="png" data-w="937" src="https://mmbiz.qpic.cn/mmbiz_png/RZcOyvRFYZhI5E6o5apoYktemluZhCpZibBt0MiauNeE9Yx4KjDZoKhibZmXbPBOtdzhjKT1icrLNJEu6Ap95ic0TQQ/640?wx_fmt=png"></p><p><br></p><p><br></p><p><br></p></section><section powered-by="xiumi.us"><section data-tool="markdown编辑器" data-website="https://markdown.com.cn/editor"><pre data-tool="markdown.com.cn编辑器"><code>mycolors &lt;- c(<span>"#57121d"</span>, <span>"#d56e5e"</span>, <span>"#eaebea"</span>, <span>"#5390b5"</span>, <span>"#1f294e"</span>) <span>#经典红-蓝</span><br>quickcor(mtcars, <br>         type = c(<span>"lower"</span>, <span>"upper"</span>, <span>"full"</span>)[<span>1</span>], <span>#修改中括号内数值1~3选择不同类型的相关性矩阵</span><br>         cluster = <span>T</span>,  <span>#是否进行聚类，默认值为False ，如果设置为T，那么就无法自定义顺序</span><br>         is.cor = <span>F</span>,  <span>#输入的数据是否是相关性系数结果，默认为F，表示输入的是元素数据</span><br>         circular = <span>F</span>, <span>#默认为F，表示是否转换为环形图，可设置为T</span><br>         grid.colour = <span>"black"</span>, <span>#网格颜色，默认为"grey50"</span><br>         grid.size = <span>0.25</span>,  <span>#网格线条粗细，默认0.25</span><br>         show.diag = <span>T</span>, <span>#是否显示对角线</span><br>         cor.test = <span>TRUE</span>,<br>         method = <span>"pearson"</span>) +<br>  geom_square(data = get_data(type = <span>"lower"</span>), colour = <span>"#5a5c5f"</span>, size = <span>0.6</span>, linetype = <span>2</span>) +  <span>#绘制正方形热图</span><br>  geom_shade(data = get_data(type = <span>"lower"</span>), sign = <span>1</span>)+ <span>#添加斜线阴影,sign&gt;0,则在R值大于0的位置添加阴影。反之...</span><br>  geom_cross(data = get_data(type = <span>"lower"</span>), colour = <span>"black"</span>)+ <span>#交叉标记，排除不显著的(即右上角空白处对应的位置)</span><br>  scale_fill_gradientn(colours = mycolors,  <span>#自定义颜色</span><br>                       breaks = c(-<span>0.6</span>, <span>0</span>, <span>0.6</span>)) +  <span>#自定义刻度值</span><br>  labs(fill = <span>"Cor(R)"</span>)+ <span>#修改图例标题</span><br>  theme(<br>    axis.text.x = element_text(color = c(rep(mycolors[<span>1</span>], <span>5</span>), rep(mycolors[length(mycolors)-<span>2</span>], <span>6</span>)), <span>#X轴标签颜色</span><br>                               <span>#face = "bold", </span><br>                               size = <span>10</span>), <span>#设置加粗字体和大小</span><br>    axis.text.y = element_text(color = c(rep(mycolors[<span>1</span>], <span>6</span>), rep(mycolors[length(mycolors)-<span>2</span>], <span>5</span>)), <span>#Y轴标签颜色</span><br>                               <span>#face = "bold", </span><br>                               size = <span>10</span>)   <span>#设置加粗字体和大小</span><br>  )<br><span></span></code></pre></section></section><section powered-by="xiumi.us"><p><br></p><p><br></p><section powered-by="xiumi.us"><section><img data-ratio="0.9092592592592592" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/frkibkB9ibxnVjBaNaS8r05y2NNYdwDeoSSrviaPcAgJgnxcl8Z2TuJ31SYfk4iaePmXUenEDvp8alqWQRTKCLuUlw/640?wx_fmt=png&amp;tp=wxpic&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/frkibkB9ibxnVjBaNaS8r05y2NNYdwDeoSSrviaPcAgJgnxcl8Z2TuJ31SYfk4iaePmXUenEDvp8alqWQRTKCLuUlw/640?wx_fmt=png&amp;tp=wxpic&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"></section></section><section powered-by="xiumi.us"><p><br></p></section></section><section powered-by="xiumi.us"><section data-tool="markdown编辑器" data-website="https://markdown.com.cn/editor"><pre data-tool="markdown.com.cn编辑器"><code>mycolors &lt;- c(<span>"#d28ebe"</span>, <span>"#fb94b1"</span>, <span>"#ffa19b"</span>, <span>"#ffb982"</span>, <span>"#ffd76f"</span>) <span>#粉-金</span><br>quickcor(mtcars, <br>         type = c(<span>"lower"</span>, <span>"upper"</span>, <span>"full"</span>)[<span>3</span>], <span>#修改中括号内数值1~3选择不同类型的相关性矩阵</span><br>         cluster = <span>T</span>,  <span>#是否进行聚类，默认值为False ，如果设置为T，那么就无法自定义顺序</span><br>         is.cor = <span>F</span>,  <span>#输入的数据是否是相关性系数结果，默认为F，表示输入的是元素数据</span><br>         circular = <span>F</span>, <span>#默认为F，表示是否转换为环形图，可设置为T</span><br>         grid.colour = <span>"black"</span>, <span>#网格颜色，默认为"grey50"</span><br>         grid.size = <span>0.25</span>,  <span>#网格线条粗细，默认0.25</span><br>         show.diag = <span>T</span>, <span>#是否显示对角线</span><br>         cor.test = <span>T</span>,<br>         method = <span>"pearson"</span> <span>#默认为皮尔森。 </span><br>) + <span>#quickcor还有更多的设置参数请详细阅读R包源码，但多数情况下你不需要知道那么多！用默认的就行</span><br>  <br>  geom_square(colour = <span>"#5a5c5f"</span>, size = <span>0.6</span>, linetype = <span>2</span>) +  <span>#绘制正方形热图，描边粗细、线条类型</span><br>  geom_mark(r = <span>NA</span>, sig.thres = <span>0.05</span>, size = <span>4</span>, colour = <span>"#52424d"</span>)+<br>  scale_fill_gradientn(colours = mycolors,  <span>#自定义颜色</span><br>                       breaks = c(-<span>0.6</span>, <span>0</span>, <span>0.6</span>)) +  <span>#自定义刻度值</span><br>  labs(fill = <span>"R(pearson)"</span>)+ <span>#修改图例标题</span><br>  theme(<br>    axis.text.x = element_text(color = c(rep(mycolors[<span>1</span>], <span>5</span>), rep(mycolors[length(mycolors)], <span>6</span>)), <span>#X轴标签颜色</span><br>                               <span>#face = "bold", </span><br>                               size = <span>10</span>), <span>#设置加粗字体和大小</span><br>    axis.text.y = element_text(color = c(rep(mycolors[<span>1</span>], <span>6</span>), rep(mycolors[length(mycolors)], <span>5</span>)), <span>#Y轴标签颜色</span><br>                               <span>#face = "bold", </span><br>                               size = <span>10</span>),   <span>#设置加粗字体和大小</span><br>    legend.text = element_text(size = <span>10</span>) <span>#设置图例标签字体大小</span><br>  )<span></span></code></pre></section></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/NSrccQBoNUcktMZbaZx4XQ",target="_blank" rel="noopener noreferrer">原文链接</a>
