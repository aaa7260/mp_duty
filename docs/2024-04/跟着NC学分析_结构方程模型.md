---
title: "跟着NC学分析-结构方程模型"
date: 2024-04-10T00:22:01Z
draft: ["false"]
tags: [
  "fetched",
  "R语言数据分析指南"
]
categories: ["Acdemic"]
---
跟着NC学分析-结构方程模型 by R语言数据分析指南
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><h3 data-tool="mdnice编辑器"><span></span><span><span></span>欢迎关注R语言数据分析指南</span><span></span></h3><blockquote data-tool="mdnice编辑器"><span>❝</span><p>本节来通过NC上的一篇文章分享如何使用R进行结构模型方程分析(SEM),文章中提供有源数据及代码均可中论文中下载，有兴趣的读者可以参考原文。</p><span>❞</span></blockquote><figure data-tool="mdnice编辑器"><img data-imgfileid="100027165" data-ratio="0.4009259259259259" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAY6DwpHibedlDBu7GcRqWHzT2D096yRkGgdb0a8grXy61BffJGr30gzRN0enyZxoOKBV3JcgsXKUqw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAY6DwpHibedlDBu7GcRqWHzT2D096yRkGgdb0a8grXy61BffJGr30gzRN0enyZxoOKBV3JcgsXKUqw/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器">https://www.nature.com/articles/s41467-024-47323-3#Sec13</p><h3 data-tool="mdnice编辑器"><span></span><span><span></span>加载R包</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code><span>library</span>(tidyverse)<br><span>library</span>(lme4)<br>install.packages(<span>"piecewiseSEM"</span>)<br><span>library</span>(piecewiseSEM)<br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span><span></span>piecewiseSEM在线文档</span><span></span></h3><blockquote data-tool="mdnice编辑器"><span>❝</span><p>https://jslefche.github.io/sem_book/https://rstudio-pubs-static.s3.amazonaws.com/63556_e35cc7e2dfb54a5bb551f3fa4b3ec4ae.html</p><span>❞</span></blockquote><pre data-tool="mdnice编辑器"><span></span><code>pSEM &lt;- read.csv(file=<span>"Rawdata.csv"</span>)<br><br>pSEM_model&lt;-psem(<br>  lmer(LabileC1~NP+(<span>1</span>|Block)+(<span>1</span>|Year),data=pSEM),<br>  lmer(MineralN1~NP+(<span>1</span>|Block)+(<span>1</span>|Year),data=pSEM),<br>  lmer(pH1~NP+(<span>1</span>|Block)+(<span>1</span>|Year),data=pSEM),<br>  lmer(Microbialdiversity~pH1+(<span>1</span>|Block)+(<span>1</span>|Year),data=pSEM),<br>  lmer(Nematodediversity1~pH1+Microbialdiversity+(<span>1</span>|Block)+(<span>1</span>|Year),data=pSEM),<br>  lmer(Multifunction~Microbialdiversity+Nematodediversity1+(<span>1</span>|Block)+(<span>1</span>|Year),data=pSEM),<br>  NP%~~%Microbialdiversity,<br>  NP%~~%Nematodediversity1,<br>  NP%~~%Multifunction,<br>  data=pSEM<br>)<br>summary(pSEM_model)<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100027168" data-ratio="0.6" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAY6DwpHibedlDBu7GcRqWHzTfpzg0Ytc4aCt9yRQfjW2wfReWw6RL8v4h8VrNXPLyRAKkzRibcJ9Cgg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAY6DwpHibedlDBu7GcRqWHzTfpzg0Ytc4aCt9yRQfjW2wfReWw6RL8v4h8VrNXPLyRAKkzRibcJ9Cgg/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器">得到分析结果后可本地绘结构方程模型图</p><figure data-tool="mdnice编辑器"><img data-imgfileid="100027166" data-ratio="0.9857723577235772" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAY6DwpHibedlDBu7GcRqWHzTs9PZT2P8sSMPGJYibIGw6pvyeTsqwUSQXmmXBnfrycUAH8Pib6ia0F5xg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="984" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAY6DwpHibedlDBu7GcRqWHzTs9PZT2P8sSMPGJYibIGw6pvyeTsqwUSQXmmXBnfrycUAH8Pib6ia0F5xg/640?wx_fmt=png&amp;from=appmsg"></figure><blockquote data-tool="mdnice编辑器"><span>❝</span><p>使用piecewiseSEM包构建了一个分段结构方程模型（pSEM），该模型由六个线性混合效应模型（lmer模型）和三个协方差关系（用%~~%表示）组成。每个模型都旨在探索特定变量之间的关系，并考虑到实验区块（Block）和年份（Year）带来的潜在随机效应。</p><span>❞</span></blockquote><h4 data-tool="mdnice编辑器"><span></span><span><span></span>线性混合效应模型部分</span><span></span></h4><pre data-tool="mdnice编辑器"><span></span><code>lmer(LabileC1 ~ NP + (1|Block) + (1|Year), data=pSEM)<br><br>该模型探索土壤易分解碳（LabileC1）与土壤养分水平（NP）之间的关系，同时考虑了区块和年份的随机效应。<br></code></pre><pre data-tool="mdnice编辑器"><span></span><code>lmer(Multifunction ~ Microbialdiversity + Nematodediversity1 + (1|Block) + (1|Year), data=pSEM) <br>该模型分析了生态系统的多功能性（Multifunction）与微生物多样性（Microbialdiversity）及线虫多样性（Nematodediversity1）之间的关系，考虑了区块和年份的随机效应。<br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span><span></span>协方差关系部分</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code>NP %~~% Microbialdiversity<br>NP %~~% Nematodediversity1<br>NP %~~% Multifunction<br></code></pre><blockquote data-tool="mdnice编辑器"><span>❝</span><p>表示土壤养分水平（NP）与微生物多样性、线虫多样性和生态系统多功能性之间存在协方差关系，意味着这些变量之间可能存在某种程度的相关性，但不一定是因果关系。</p><span>❞</span></blockquote><blockquote data-tool="mdnice编辑器"><span>❝</span><p>给予长期支持我们的读者们一个特别待遇：购买小编VIP会员文档的读者，<strong>「将自动获得2024年及以后更新的绘图文档代码，无需额外付费」</strong>。目前会员文档(2023+2024)<strong>「已经更新上传了150+案例文档」</strong>，每个案例都附有相应的数据和代码，并配有对应的注释文档，方便大家学习和参考。有需要的朋友欢迎到小编的<strong>「淘宝店铺-R语言数据分析指南」</strong>下单购买<strong>「R数据可视化案例文档」</strong>持续更新中</p><span>❞</span></blockquote><p data-tool="mdnice编辑器"><strong>「2024更新的绘图内容同时包含数据+代码+markdown注释文档+文档清单」</strong></p><h3 data-tool="mdnice编辑器"><span></span><span><span></span>淘宝店铺</span><span></span></h3><p><img data-galleryid="" data-imgfileid="100019415" data-ratio="1.0210420841683367" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/EibnicgwScTAbvhPDLGT8NaialEsht92PTYNJWpmVLfoYGic1uha5FyBrDCibibZCLjiazgvpT1XcdwibfVywD2el0VAgg/640?wx_fmt=jpeg" data-type="jpeg" data-w="998" src="https://mmbiz.qpic.cn/mmbiz_jpg/EibnicgwScTAbvhPDLGT8NaialEsht92PTYNJWpmVLfoYGic1uha5FyBrDCibibZCLjiazgvpT1XcdwibfVywD2el0VAgg/640?wx_fmt=jpeg"></p><figure data-tool="mdnice编辑器"><img data-imgfileid="100027167" data-ratio="0.6175925925925926" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAY6DwpHibedlDBu7GcRqWHzTgmNnicphslmBibc95GJEcXcJvfEgCKRIR1a9zmJ6UyLF5kNAn4yz9hKQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAY6DwpHibedlDBu7GcRqWHzTgmNnicphslmBibc95GJEcXcJvfEgCKRIR1a9zmJ6UyLF5kNAn4yz9hKQ/640?wx_fmt=png&amp;from=appmsg"></figure><h3 data-tool="mdnice编辑器"><span></span><span><span></span>2024年更新案例</span><span></span></h3><p data-tool="mdnice编辑器"><img data-imgfileid="100027164" data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAY6DwpHibedlDBu7GcRqWHzTRib0G3TKdPF3QfmNKrb0iaMg4PeocC0A2a6LRoxUe4Xb1N3w2xiane4pw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAY6DwpHibedlDBu7GcRqWHzTRib0G3TKdPF3QfmNKrb0iaMg4PeocC0A2a6LRoxUe4Xb1N3w2xiane4pw/640?wx_fmt=png&amp;from=appmsg"><img data-imgfileid="100027170" data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAY6DwpHibedlDBu7GcRqWHzTIX7T7iawLV0DJfCV5PmwZkdUJQjVDfgGU46ncnRMmxdvmGbwM4XR7pg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAY6DwpHibedlDBu7GcRqWHzTIX7T7iawLV0DJfCV5PmwZkdUJQjVDfgGU46ncnRMmxdvmGbwM4XR7pg/640?wx_fmt=png&amp;from=appmsg"><img data-imgfileid="100027171" data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAY6DwpHibedlDBu7GcRqWHzT9josIxjhThsWhThmvT040vX8Gj2ibiaP3BNuvkeO5aBjG8dmMR8SxN1Q/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAY6DwpHibedlDBu7GcRqWHzT9josIxjhThsWhThmvT040vX8Gj2ibiaP3BNuvkeO5aBjG8dmMR8SxN1Q/640?wx_fmt=png&amp;from=appmsg"><img data-imgfileid="100027172" data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAY6DwpHibedlDBu7GcRqWHzTN4jKw7afXK1Wg16k9mbQra38oTYBY9tma5twA9uHUl5Ly5ddHraqibA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAY6DwpHibedlDBu7GcRqWHzTN4jKw7afXK1Wg16k9mbQra38oTYBY9tma5twA9uHUl5Ly5ddHraqibA/640?wx_fmt=png&amp;from=appmsg"><img data-imgfileid="100027173" data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAY6DwpHibedlDBu7GcRqWHzT4XQvwyc9QFzebyLtYOJktaA17ff6oHQyibAlsNib98xlicZrWwCgicAIDQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAY6DwpHibedlDBu7GcRqWHzT4XQvwyc9QFzebyLtYOJktaA17ff6oHQyibAlsNib98xlicZrWwCgicAIDQ/640?wx_fmt=png&amp;from=appmsg"><img data-imgfileid="100027169" data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAY6DwpHibedlDBu7GcRqWHzTc3IVqnz2It51ntHpO7v3v03j27kAHQQLaomZPx9pTbelReOawfrHLg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAY6DwpHibedlDBu7GcRqWHzTc3IVqnz2It51ntHpO7v3v03j27kAHQQLaomZPx9pTbelReOawfrHLg/640?wx_fmt=png&amp;from=appmsg"><img data-imgfileid="100027175" data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAY6DwpHibedlDBu7GcRqWHzTXD733WJlrNlNBkuo1icOPHzicvXB6oxBBwdG2WoNApOeWnicrhUy3TBgA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAY6DwpHibedlDBu7GcRqWHzTXD733WJlrNlNBkuo1icOPHzicvXB6oxBBwdG2WoNApOeWnicrhUy3TBgA/640?wx_fmt=png&amp;from=appmsg"><img data-imgfileid="100027174" data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAY6DwpHibedlDBu7GcRqWHzT0Gx0Q8H10efuSXXvNnx1LP1Lf0kfO3WZyonIrYEG2GwpAz2jyskXJA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAY6DwpHibedlDBu7GcRqWHzT0Gx0Q8H10efuSXXvNnx1LP1Lf0kfO3WZyonIrYEG2GwpAz2jyskXJA/640?wx_fmt=png&amp;from=appmsg"><img data-imgfileid="100027177" data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAY6DwpHibedlDBu7GcRqWHzTcSiaSIFUw5Qstqx8RSXgMznqEnXibNBF0HfPOTglAAtBusvUEsuicp4icw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAY6DwpHibedlDBu7GcRqWHzTcSiaSIFUw5Qstqx8RSXgMznqEnXibNBF0HfPOTglAAtBusvUEsuicp4icw/640?wx_fmt=png&amp;from=appmsg"><img data-imgfileid="100027178" data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAY6DwpHibedlDBu7GcRqWHzTOJXibqiaCiboLgIPJPBN83Q52Ro6VrsUlicyibj9y8wtFiaefibtgEteWE62A/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAY6DwpHibedlDBu7GcRqWHzTOJXibqiaCiboLgIPJPBN83Q52Ro6VrsUlicyibj9y8wtFiaefibtgEteWE62A/640?wx_fmt=png&amp;from=appmsg"><img data-imgfileid="100027176" data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAY6DwpHibedlDBu7GcRqWHzTFcfk0XUTEFETPnCvM3S2bm5kKxF7q62iboIsy7n00qKUaicIXnCP8jaw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAY6DwpHibedlDBu7GcRqWHzTFcfk0XUTEFETPnCvM3S2bm5kKxF7q62iboIsy7n00qKUaicIXnCP8jaw/640?wx_fmt=png&amp;from=appmsg"></p><h3 data-tool="mdnice编辑器"><span></span><span><span></span>关注下方公众号下回更新不迷路</span><span></span></h3><section><mp-common-profile data-pluginname="mpprofile" data-id="Mzg3MzQzNTYzMw==" data-headimg="http://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZF0rpeZII9Ltl26VbVagriczTria1fib3XgjwwHEHFjPzkmGpqWDVVHBSzhENictUM2iavAKiaM5lc9USw/0?wx_fmt=png" data-nickname="R语言数据分析指南" data-alias="YanJANtwo" data-signature="R语言重症爱好者，喜欢绘制各种精美的图表，喜欢的小伙伴可以关注我，跟我一起学习" data-from="0" data-is_biz_ban="0"></mp-common-profile></section><p data-tool="mdnice编辑器"><br></p></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/NVJmQXUr7QKp4BSuMfKsZw",target="_blank" rel="noopener noreferrer">原文链接</a>
