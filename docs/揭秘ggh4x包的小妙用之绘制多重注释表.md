---
title: "揭秘ggh4x包的小妙用之绘制多重注释表"
date: 2022-11-01T15:35:21Z
draft: ["false"]
tags: [
  "fetched",
  "R语言数据分析指南"
]
categories: ["Acdemic"]
---
揭秘ggh4x包的小妙用之绘制多重注释表 by R语言数据分析指南
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><h3 data-tool="mdnice编辑器"><span></span><span><span></span>欢迎关注R语言数据分析指南</span><span></span></h3><blockquote data-tool="mdnice编辑器"><span>❝</span><p>最近在帮朋友绘图突发奇想发现<strong>「ggh4x」</strong>包的一个小妙用，今天通过一个文档来分享给大家；<strong>「数据+代码已经上传VIP群，加群的观众老爷请自行下载」</strong></p><span>❞</span></blockquote><blockquote data-tool="mdnice编辑器"><span>❝</span><p><code>有需要学习数据可视化的朋友欢迎加入小编2022年度VIP群</code>，目前群内已经上传公众号文档<strong>「数据+代码约260篇」</strong>，<code>VIP交流群(1)已经500人满员</code>,随着内容不断增多，为了更好的创做内容现在进群需<strong>「付费149元」</strong>,若转发此文档到朋友圈集赞20个可优惠20元，早进早享受；<strong>「一定让你感受到物超所值」</strong></p><span>❞</span></blockquote><h3 data-tool="mdnice编辑器"><span></span><span><span></span>淘宝店铺个性化绘图服务</span><span></span></h3><blockquote data-tool="mdnice编辑器"><span>❝</span><p>最近有部分观众老爷找小编做个性化绘图，为了给观众老爷提供更加优质的服务；小编开通了 <strong>「淘宝店铺(R语言数据分析指南)」</strong> ，有特殊绘图需求的欢迎关注咨询</p><span>❞</span></blockquote><pre data-tool="mdnice编辑器"><span></span><code><span>library</span>(tidyverse)<br><span>library</span>(ggh4x)<br><span>library</span>(magrittr)<br><span>library</span>(openxlsx)<br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span><span></span>加载数据</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code>abund_table&lt;-read.xlsx(<span>"OysterHatcheryMicrobiome_phyladata.xlsx"</span>,sheet=<span>"taxa"</span>, rowNames = <span>TRUE</span>)<br>meta_table&lt;-read.xlsx(<span>"OysterHatcheryMicrobiome_phyladata.xlsx"</span>,sheet=<span>"meta"</span>)<br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span><span></span>定义因子</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code>meta_table$Type &lt;- factor(meta_table$Type,levels =c(<span>"Oyster"</span>,<span>"Swab"</span>,<span>"Water"</span>))<br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span><span></span>数据整合</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code>df &lt;- meta_table %&gt;% select(<span>1</span>,Type,Day,Trial,Group) %&gt;% <br>  filter(Type !=<span>"Water"</span>)<br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span><span></span>定义主题</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code>theme_niwot &lt;- <span>function</span>(){<br>  theme(<br>    strip.background = element_rect(fill=<span>"white"</span>,color=<span>"black"</span>),<br>    panel.spacing = unit(<span>0</span>,<span>"lines"</span>),<br>    panel.border = element_blank(),<br>    strip.text.x = element_text(size=<span>7</span>,color=<span>"black"</span>,face=<span>"bold"</span>),<br>    axis.text.y=element_text(size=<span>8</span>,color=<span>"black"</span>),<br>    axis.title.y = element_text(size=<span>10</span>,color=<span>"black"</span>),<br>    axis.ticks.x = element_blank(),<br>    axis.text.x=element_text(color=<span>"white"</span>),<br>    panel.grid.major=element_blank(),<br>    panel.grid.minor=element_blank(),<br>    panel.background = element_blank())<br>}<br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span><span></span>定义调色版</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code>pal &lt;-c(<span>"#E41A1C"</span>,<span>"#1E90FF"</span>,<span>"#FF8C00"</span>,<span>"#4DAF4A"</span>,<span>"#984EA3"</span>)<br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span><span></span>案例一</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code>df %&gt;% mutate(value=<span>0</span>) %&gt;% <br>  ggplot(aes(Samples,value))+<br>  geom_bar(position=<span>"fill"</span>,stat=<span>"identity"</span>)+<br>  facet_nested(.~Type+Day+Trial+Group,drop=<span>T</span>,scale=<span>"free"</span>,space=<span>"free"</span>)+<br>  labs(x=<span>NULL</span>, y=<span>NULL</span>)+<br>  scale_y_continuous(expand = c(<span>0</span>,<span>0</span>))+<br>  theme_niwot()<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.1906474820143885" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAY2NFX5tbVZlIz4JicfWrmoTLjOQ6NWJe3l8EJpia6vhPURUxOB3ibJyCBhZ2gRKhG7rfHtGj17GpOtw/640?wx_fmt=png" data-type="png" data-w="1112" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAY2NFX5tbVZlIz4JicfWrmoTLjOQ6NWJe3l8EJpia6vhPURUxOB3ibJyCBhZ2gRKhG7rfHtGj17GpOtw/640?wx_fmt=png"></figure><h3 data-tool="mdnice编辑器"><span></span><span><span></span>案例二</span><span></span></h3><blockquote data-tool="mdnice编辑器"><span>❝</span><p><span>上面主要绘制了一个空白表格，如果需要</span>在<span>其中填充上颜色只需要设置</span><strong>「strip」</strong><span>参数即可，可以自定义每一个方块的颜色，这里只示例展示几种颜色</span></p><span>❞</span></blockquote><pre data-tool="mdnice编辑器"><span></span><code>df %&gt;% mutate(value=<span>0</span>) %&gt;% <br>  ggplot(aes(Samples,value))+<br>  geom_bar(position=<span>"fill"</span>,stat=<span>"identity"</span>)+<br>  facet_nested(.~Type+Day+Trial+Group,drop=<span>T</span>,scale=<span>"free"</span>,space=<span>"free"</span>,<br>               strip =strip_nested(background_x = elem_list_rect(fill =pal),by_layer_x = <span>F</span>)<br>  )+<br>  labs(x=<span>NULL</span>, y=<span>NULL</span>)+<br>  scale_y_continuous(expand = c(<span>0</span>,<span>0</span>))+<br>  theme_niwot()<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.1906474820143885" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAY2NFX5tbVZlIz4JicfWrmoTRpRqYGYaiaiclb6agqetzr4vouHPZaHKBoems8F0LDliaRGta8ofMSpFg/640?wx_fmt=png" data-type="png" data-w="1112" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAY2NFX5tbVZlIz4JicfWrmoTRpRqYGYaiaiclb6agqetzr4vouHPZaHKBoems8F0LDliaRGta8ofMSpFg/640?wx_fmt=png"></figure><blockquote data-tool="mdnice编辑器"><span>❝</span><p>本节主要介绍用了<strong>「ggh4x多重分面注释的绘图理念」</strong>来绘制这种表格想法挺新颖的，也许以后在某处会有秒用；喜欢的观众老爷欢迎分享转发；<strong>「当然更推荐大家加入我的VIP交流群」</strong>；如果对小编的VIP不感兴趣的，也希望能转发支持一下，每天都想着分享一些不一样的内容给大家；<strong>「有意加群的观众老爷请备注一下，都挺忙的」</strong></p><span>❞</span></blockquote><h3 data-tool="mdnice编辑器"><span></span><span><span></span>小编微信</span><span></span></h3><p><img data-galleryid="" data-ratio="1" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/EibnicgwScTAaNu6sU2UCYkxFq9ibq75wuaO0lqFoYz1icUo4jh3N2icAWECmibgPvqyReur0FCp7JNKO0icnRAsbO9ug/640?wx_fmt=jpeg" data-type="jpeg" data-w="430" src="https://mmbiz.qpic.cn/mmbiz_jpg/EibnicgwScTAaNu6sU2UCYkxFq9ibq75wuaO0lqFoYz1icUo4jh3N2icAWECmibgPvqyReur0FCp7JNKO0icnRAsbO9ug/640?wx_fmt=jpeg"></p><h3 data-tool="mdnice编辑器"><span></span><span><span></span>关注下方公众号下回更新不迷路</span><span></span></h3><section><mp-common-profile data-pluginname="mpprofile" data-id="Mzg3MzQzNTYzMw==" data-headimg="http://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZF0rpeZII9Ltl26VbVagriczTria1fib3XgjwwHEHFjPzkmGpqWDVVHBSzhENictUM2iavAKiaM5lc9USw/0?wx_fmt=png" data-nickname="R语言数据分析指南" data-alias="YanJANtwo" data-signature="R语言重症爱好者，喜欢绘制各种精美的图表，喜欢的小伙伴可以关注我，跟我一起学习" data-from="0" data-is_biz_ban="0"></mp-common-profile></section></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/rqI7qGjjdzjZfYbfS_huGQ",target="_blank" rel="noopener noreferrer">原文链接</a>
