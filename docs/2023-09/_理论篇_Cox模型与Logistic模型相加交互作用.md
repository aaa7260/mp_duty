---
title: "【理论篇】Cox模型与Logistic模型相加交互作用"
date: 2023-09-17T14:12:55Z
draft: ["false"]
tags: [
  "fetched",
  "临床研究与医学统计"
]
categories: ["Acdemic"]
---
【理论篇】Cox模型与Logistic模型相加交互作用 by 临床研究与医学统计
------
<div><p><br></p><p><img data-ratio="0.29259259259259257" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/Zb9jB9p1cKEGiavdg5SUNKEWbUl9QQ7SakOibj5qLFnXzDEfK2fRzHjAIMHGEqMQGtgM7OHZDoXNREBLqHibeXZUA/640?wx_fmt=jpeg" data-type="jpeg" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_jpg/Zb9jB9p1cKEGiavdg5SUNKEWbUl9QQ7SakOibj5qLFnXzDEfK2fRzHjAIMHGEqMQGtgM7OHZDoXNREBLqHibeXZUA/640?wx_fmt=jpeg"></p><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><p data-tool="mdnice编辑器"><br></p><p data-tool="mdnice编辑器">本章思维导图</p><p data-tool="mdnice编辑器"><img data-ratio="0.463898916967509" data-src="https://mmbiz.qpic.cn/mmbiz_png/Zb9jB9p1cKFvOAFaK3vibgYNiaJXfHTVGdFSPc5osoV7TGOr3RstnxYn99kWoMs3LXUWxdibLaIQEd5yx4y6OxYUQ/640?wx_fmt=png" data-type="png" data-w="554" src="https://mmbiz.qpic.cn/mmbiz_png/Zb9jB9p1cKFvOAFaK3vibgYNiaJXfHTVGdFSPc5osoV7TGOr3RstnxYn99kWoMs3LXUWxdibLaIQEd5yx4y6OxYUQ/640?wx_fmt=png"></p><figure data-tool="mdnice编辑器"></figure><h2 data-tool="mdnice编辑器"><span>背景</span></h2><p data-tool="mdnice编辑器">随着因果推断理论的普及与深化，建模从过去常规的混杂因素调整逐步拓展细分到交互、修饰、中介、工具变量模型。这些概念在科研中的普及，加速了国际流行病学或临床研究越来越多地将交互作用纳入标准化分析流程，于是相加交互作用指标<span><strong>RERI便成为发SCI论文的利器</strong></span>。例如，Ana Isabel 2022年仅仅做了个RERI就发表Lancet public health (PMID: 35487230)。然而，相对流行病文章2007年起就关注RERI，更多的临床文章则是后知后觉。Knol 2009(PMID: 19034025)年指出，绝大多数的队列和病例对照研究交互作用分析不恰当。Wallach 2017(PMID: 28192563)年在JAMA杂志发表61%的RCT研究中亚组异质性（交互作用）仍然没有得到正确的解释。笔者曾在2016年发表了基于SAS宏的相乘相加交互作用促进临床交互分析，但是当时由于版面问题，相乘相加的根本区别及算法SAS代码的演示<strong><span>cox分析</span></strong><strong><span>部分没有印刷正确</span></strong>，为广大读者在做cox交互的时候留下了个深坑。同时，该文中SAS软件对使用者要求较高，文中介绍的excel工具，也没有很好的示例。近年来，R软件的普及使得相加作用分析更为方便，笔者后续将在在本公众号系列文章中一并深入逐个讲解。工欲善其事必先利其器，本章节着重深入介绍相加交互概念与理论，希望能起到抛砖引玉的作用。</p><figure data-tool="mdnice编辑器"><img data-ratio="0.2768670309653916" data-src="https://mmbiz.qpic.cn/mmbiz_png/Zb9jB9p1cKFvOAFaK3vibgYNiaJXfHTVGd3vzbzDocDdKI88oMcq856qMVM380MiagwH5YU7bY3B8QicSteAxqMiaDg/640?wx_fmt=png" data-type="png" data-w="549" src="https://mmbiz.qpic.cn/mmbiz_png/Zb9jB9p1cKFvOAFaK3vibgYNiaJXfHTVGd3vzbzDocDdKI88oMcq856qMVM380MiagwH5YU7bY3B8QicSteAxqMiaDg/640?wx_fmt=png"></figure><h2 data-tool="mdnice编辑器"><span></span><span>1.交互作用的目的：</span></h2><p data-tool="mdnice编辑器">交互分析的主要目的依次递减，有5个：①在资源有限的情况下，识别对某干预受益最大的人群亚组(a0b0/a1b1)，可理解为亚组异质性问题；②在某一暴露因素a不容易施加干预的时候，识别最有可能施加干预的交互协变量b,以降低a的效应；③揭示暴露影响疾病发生的机制；④样本量角度，估算效应量参数(ORa<em>b)，</em>提高评价某暴露因素对结局影响总效应的power；⑤仅从统计学考虑，包含交互项的模型拟合AIC/R2可能更好(y=f(a+b+ab+…多次项))。</p><h2 data-tool="mdnice编辑器"><span></span><span>2.相加优于相乘</span></h2><p data-tool="mdnice编辑器">Rothman详细评价了相加交互与相乘交互的差异。统计建模中一般线性模型交互项(a*b)反映的是因素间相加交互作用(additive interactions，<strong><span>INTA</span></strong>)，而Logistic等广义线性模型反映的是因素间统计学上相乘交互作用(multiplicative interaction，<strong><span>INTM)</span></strong>。文献中常用Logistic回归主效应模型中纳入因素的乘积交互项，并根据乘积项有无意义下结论有无交互作用，其实大部分旧的文献都做的是统计学角度的INTM, 而非具有生物可解释的INTA, 没能准确理解统计建模交互项，错误的将相乘交互等于相加交互。Rothman指出Logistic乘积项反应的仅仅是统计学数据交互，解释只能说具有相乘交互效应；只有在生物机制上病因因素间存在相加交互作用才能解释为生物相加交互效应，即协同或拮抗。</p><h2 data-tool="mdnice编辑器"><span></span><span>3.相加交互公式</span></h2><p data-tool="mdnice编辑器">3.1 变量ab赋值假设多风险因素中研究交互作用两暴露因素AB，OR00表示AB均无暴露即OR00=1，OR10表示A暴露B无暴露，OR01表示A无暴露B暴露，OR11表示AB均暴露。交互是<strong><span>AB</span></strong>同等重要，效应修饰则是探索A主B辅，常简写为<span><strong>EM</strong></span><em>，exposure</em>modifier。本文暂不深入讨论二者区别。</p><figure data-tool="mdnice编辑器"><img data-ratio="0.3898916967509025" data-src="https://mmbiz.qpic.cn/mmbiz_png/Zb9jB9p1cKFvOAFaK3vibgYNiaJXfHTVGd0Z3wBoePJM7ItAKnz9vVK4ge7L6dJFFgZHMvs0JyoVtJQL6RkhFLYg/640?wx_fmt=png" data-type="png" data-w="554" src="https://mmbiz.qpic.cn/mmbiz_png/Zb9jB9p1cKFvOAFaK3vibgYNiaJXfHTVGd0Z3wBoePJM7ItAKnz9vVK4ge7L6dJFFgZHMvs0JyoVtJQL6RkhFLYg/640?wx_fmt=png"></figure><h3 data-tool="mdnice编辑器"><span></span><span>3.2 logistic、cox交互公式</span><span></span></h3><p data-tool="mdnice编辑器">有无统计学或生物学交互作用很大程度上取决于所选择的模型，所以在报告有无交互作用时，需要说明分析所用的模型，是logistic(OR)、log-linear(RR)、还是Cox(HR)模型。通常Logistic等广义线性模型考虑交互项的形式为y= f(a+b+a<em>b)，其中a</em>b反映的是因素间统计学上相乘交互作用INTM。相乘交互作用INTM＝exp(β3)=ORA×B＝OR11/（OR10×OR01）。INTM ≠ INTA。相加交互INTA =OR11，统计学意义需要依靠RERI/ICR、AP、S 这3个指标。<strong><span>交互对比度( interaction contrast ratio，ICR)</span></strong><span>，又名</span><strong><span>相对超危险度比（relative excess risk due to interaction，RERI）</span></strong><span>，归因比(attributable proportion due to interaction，</span><strong><span>AP</span></strong><span>)和交互作用指数(the synergy index，</span><span><strong>S</strong></span><span>)</span>。也有不考虑混杂因素AP*, AP*= ICR/(OR11-1)，但此指标不常用。交互公式总结为：</p><figure data-tool="mdnice编辑器"><img data-ratio="0.7075812274368231" data-src="https://mmbiz.qpic.cn/mmbiz_png/Zb9jB9p1cKFvOAFaK3vibgYNiaJXfHTVGdHDlRQibOVUE483Gp9ks6E4wiaJAE5xMPLDzbkiaRrrC2XiadUsNWv9Z3tA/640?wx_fmt=png" data-type="png" data-w="554" src="https://mmbiz.qpic.cn/mmbiz_png/Zb9jB9p1cKFvOAFaK3vibgYNiaJXfHTVGdHDlRQibOVUE483Gp9ks6E4wiaJAE5xMPLDzbkiaRrrC2XiadUsNWv9Z3tA/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">交互判断定律：<strong><span>AB两因素有相加交互作用，则需要RERI 95%CI、AP 95%CI应该不包含0 (⊄ 0)，S 95%CI应该不包含l；INTM 95%CI不包含1(⊄ 1)有相乘交互作用。</span></strong></p><h3 data-tool="mdnice编辑器"><span></span><span>3.3 RERI 95%CI计算</span><span></span></h3><p data-tool="mdnice编辑器">计算置信区间CI的方法，有Delta法、Wald法、轮廓似然置信区间（profile likelihood confidence intervals，PL）法、MOVER法、variance recovery method和percentile bootstrapping法等。其中Delta法估计置信区间可能会造成假阴性结果，Zou阐述了Wald置信区间法需基于风险比对称的前提， Richardson推荐采用轮廓似然置信区间（profile likelihoodconfidence intervals，PL）为佳，利用Wald的ICR点估计重构ICR95%CI。错误的95%CI计算会导致错误的P值估计。检索文献后，<strong><span>Delta法依然是最经典的方法</span></strong>，绝大部分文章依然引用1992年出处的文献(PMID: 1391139), Delta法的可信区间是以估计值为中心左右对称分布。MOVER法较宽且无法提供S值。Bootstrap法可信区间较窄，也成为Delta法结果不稳定的替代方法，可信区间不以估计值为中心左右对称。</p><figure data-tool="mdnice编辑器"><img data-ratio="0.625" data-src="https://mmbiz.qpic.cn/mmbiz_png/Zb9jB9p1cKFvOAFaK3vibgYNiaJXfHTVGd1y1CdqtTz8722vEcZFiaQicf6EZz0ib8NMl19LCwI9AqSaZ8XjiakrM2tA/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/Zb9jB9p1cKFvOAFaK3vibgYNiaJXfHTVGd1y1CdqtTz8722vEcZFiaQicf6EZz0ib8NMl19LCwI9AqSaZ8XjiakrM2tA/640?wx_fmt=png"></figure><h3 data-tool="mdnice编辑器"><span>3.4多图解释相乘相加方向相悖</span></h3><p data-tool="mdnice编辑器">相乘交互项OR95%CI&lt;1为负相乘，OR95%CI&gt;1为正相乘；相加交互项RERI 95%CI&gt;0为协同作用，&lt;0为拮抗作用。总的来说，其实队列(RR)在做相加交互计算是RR差 RD2-RD1，<span>相乘</span>交互时计算RR的比值比RR2/RR1；纵向生存队列(HR)在做相加交互计算是HR差 RD2-RD1，<span>相乘</span>交互时计算HR的比值比HR2/HR1; 病例对照或横断面(OR)在做<strong><span>相加交互计算是OR差</span></strong> RD2-RD1，<strong><span>相乘互时计算OR的比值比</span></strong>OR2/OR1。</p><p data-tool="mdnice编辑器">有时相乘与相加交互方向相悖，且均P&lt;0.05，此时用生物交互比统计交互解释更加合理。笔者制作了一系列套图说明相乘与相加的背离，相加交互解释更容易理解。</p><p data-tool="mdnice编辑器"><img data-ratio="1.0612244897959184" data-src="https://mmbiz.qpic.cn/mmbiz_png/Zb9jB9p1cKFvOAFaK3vibgYNiaJXfHTVGdTmXjq3gKQ3SmrwFMRYBWBPnClqsdnQFrgRic31vmLYFXKB4ibCib7cqnQ/640?wx_fmt=png" data-type="png" data-w="343" src="https://mmbiz.qpic.cn/mmbiz_png/Zb9jB9p1cKFvOAFaK3vibgYNiaJXfHTVGdTmXjq3gKQ3SmrwFMRYBWBPnClqsdnQFrgRic31vmLYFXKB4ibCib7cqnQ/640?wx_fmt=png"></p><figure data-tool="mdnice编辑器"></figure><figure data-tool="mdnice编辑器"><img data-ratio="0.7111913357400722" data-src="https://mmbiz.qpic.cn/mmbiz_png/Zb9jB9p1cKFvOAFaK3vibgYNiaJXfHTVGdVJh1XyJdK76icxZa0Y71t9Eo7Nvzpf1Tz7vLcOZzOZXO4Iwo71NUUHg/640?wx_fmt=png" data-type="png" data-w="554" src="https://mmbiz.qpic.cn/mmbiz_png/Zb9jB9p1cKFvOAFaK3vibgYNiaJXfHTVGdVJh1XyJdK76icxZa0Y71t9Eo7Nvzpf1Tz7vLcOZzOZXO4Iwo71NUUHg/640?wx_fmt=png"></figure><figure data-tool="mdnice编辑器"><img data-ratio="0.7148014440433214" data-src="https://mmbiz.qpic.cn/mmbiz_png/Zb9jB9p1cKFvOAFaK3vibgYNiaJXfHTVGdJvcSWicibo3ibmX4JxCqXotwMx3dyjoz0O4U9JE4FRxfESBO5ez9cjvJw/640?wx_fmt=png" data-type="png" data-w="554" src="https://mmbiz.qpic.cn/mmbiz_png/Zb9jB9p1cKFvOAFaK3vibgYNiaJXfHTVGdJvcSWicibo3ibmX4JxCqXotwMx3dyjoz0O4U9JE4FRxfESBO5ez9cjvJw/640?wx_fmt=png"></figure><figure data-tool="mdnice编辑器"><img data-ratio="0.3194945848375451" data-src="https://mmbiz.qpic.cn/mmbiz_png/Zb9jB9p1cKFvOAFaK3vibgYNiaJXfHTVGdbicplNClhu1BjJFHregzNTC2LO6NtC0he3Mia02F7QqjGqQxzRLd2RkA/640?wx_fmt=png" data-type="png" data-w="554" src="https://mmbiz.qpic.cn/mmbiz_png/Zb9jB9p1cKFvOAFaK3vibgYNiaJXfHTVGdbicplNClhu1BjJFHregzNTC2LO6NtC0he3Mia02F7QqjGqQxzRLd2RkA/640?wx_fmt=png"></figure><h2 data-tool="mdnice编辑器"><span></span><span>3.5 实例分析</span></h2><p data-tool="mdnice编辑器">以2004年~2014年广东省先天性心脏病监测网数据库[10,11]病例对照资料为例，分析孕母是否被动吸烟(自报围孕期家庭、工作环境任一接触吸烟平均时长在每天15分钟以上且持续一周以上)与家庭人均月收入高低有无相乘和相加交互作用(表1)，抽取部分原始数据进行分析，同时比对Andersson的结果。如表2，可以计算得到OR10=1.383(1.211~1.579)，OR01=1.268(1.160~1.387)，OR11=2.443(2.048~2.914)，INTM =1.393(1.116~1.739)。delta法、Wald法、PL法估计ICR95%CI、AP 95%CI、S 95%CI，交互作用示意图见图1及表3。本例INTM95%CI&gt;1有相乘交互作用，孕母有被动吸烟与家庭人均月收入低有<strong><span>正向相乘交互作用</span></strong>；delta法、Wald法、PL法估计ICR95%CI&gt;0、AP 95%CI&gt;0，S 95%CI&gt;1，孕母有被动吸烟与家庭人均月收入低<strong><span>有协同相加交互作用</span></strong>，家庭人均月收入低孕母人群同时存在被动吸烟时胎儿患先天性心脏病风险显著增加。ICR和S意义相同，AP表示全部病例中可归因于两因素交互作用的病例所占的比例，本例PL法AP95%CI=0.324(0.153~0.519)，说明全部先心病病例中归因于被动吸烟与家庭人均月收入的相加交互作用所引起的病例占32.4％。</p><figure data-tool="mdnice编辑器"><img data-ratio="0.6046511627906976" data-src="https://mmbiz.qpic.cn/mmbiz_png/Zb9jB9p1cKFvOAFaK3vibgYNiaJXfHTVGdIgQiaGzvt7GfQOPqCEpmWYhooy1akgzYSibY4NmUnU0y0QAaQzYKic45Q/640?wx_fmt=png" data-type="png" data-w="559" src="https://mmbiz.qpic.cn/mmbiz_png/Zb9jB9p1cKFvOAFaK3vibgYNiaJXfHTVGdIgQiaGzvt7GfQOPqCEpmWYhooy1akgzYSibY4NmUnU0y0QAaQzYKic45Q/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">图1 相加交互作用示意图</p><figure data-tool="mdnice编辑器"><img data-ratio="0.9435185185185185" data-src="https://mmbiz.qpic.cn/mmbiz_png/Zb9jB9p1cKFvOAFaK3vibgYNiaJXfHTVGdQMyQRfwaVX28ibpiaxT1mkLnF0Z2icc0IfaWFHedTLAxs0am7f1ML9vIw/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/Zb9jB9p1cKFvOAFaK3vibgYNiaJXfHTVGdQMyQRfwaVX28ibpiaxT1mkLnF0Z2icc0IfaWFHedTLAxs0am7f1ML9vIw/640?wx_fmt=png"></figure><h2 data-tool="mdnice编辑器"><span></span><span>3.6 小结</span></h2><blockquote data-tool="mdnice编辑器"><p>1.相加交互作用3指标，RERI、AP、S。</p></blockquote><blockquote data-tool="mdnice编辑器"><p>2.P&lt;0.05时，RERI 95%CI &lt;0 ，可能拮抗作用，RERI 95%CI &gt;0 ，可能协同作用，属于生物学交互;INTM95%CI&lt;1为负相乘，INTM95%CI&gt;1为正相乘。置信区间95%CI经典是delta法，精准是bootstrap法。</p></blockquote><blockquote data-tool="mdnice编辑器"><p>3.临床SCI杂志逐渐纠正统计学相乘交互为生物学相加交互。RERI回答亚组异质性、生物机制更适合。</p></blockquote><p data-tool="mdnice编辑器">参考文献</p><p data-tool="mdnice编辑器">[1]  Rothman KJ, Greenland S, Lash TL. Modern Epidemiology[M]. 3rd. ed. Philadelphia, PA, USA.: Wolters Kluwer, Lippincott Williams &amp; Wilkins; 2008.[2]  Kalilani L, Atashili J. Measuring additive interaction using odds ratios[J]. Epidemiologic Perspectives &amp; Innovations, 2006, 3(1): 5.[3]  Richardson DB, Kaufman JS. Estimation of the relative excess risk due to interaction and associated confidence bounds. Am J Epidemiol. 2009;169(6):756-760. doi: 0.1093/aje/kwn411. Epub 2009 Feb 11.[4]  Nie L, Chu H, Li F, Cole SR. Relative excess risk due to interaction:resampling-based confidence intervals. Epidemiology. 2010;21:552–556. doi: 10.1097/EDE.0b013e3181e09b0b.[5]  Chu H, Nie L, Cole S R. Estimating the relative excess risk due to interaction: a Bayesian approach[J]. Epidemiology, 2011, 22(2): 242-248. doi: 10.1097/EDE.0b013e318208750e.[6]  Andersson T, Alfredsson L, Källberg H, et al. Calculating measures of biological interaction[J]. European journal of epidemiology, 2005, 20(7): 575-579.[7]  Qiu H, Yu I T, Wang X R, et al. Study on the interaction under logistic regression modeling[J]. Zhonghua liu xing bing xue za zhi, 2008, 29(9): 934-937.(in Chinese)邱宏,余德新,王晓蓉,等. Logistic回归模型中交互作用的分析及评价[J]. 中华流行病学杂志, 2008, 29(9): 934-937.[8]  Zou GY. On the estimation of additive interaction by use of the four-by-two table and beyond. Am J Epidemiol. 2008;168(2):212-224. doi: 10.1093/aje/kwn104. Epub 2008 May 28.[9]  VanderWeele T J, Knol M J. A tutorial on interaction[J]. Epidemiologic Methods, 2014, 3(1): 33-72. DOI: 10.1515/em-2013-0005, May 2014.[10] Nie Z Q, Ou Y Q, Chen J M, et al. Risk factors of congenital heart defects in fetal and infants born from 2004 to 2011 in Guangdong[J]. Zhonghua xin xue guan bing za zhi, 2013, 41(8): 704-708. (in Chinese)聂志强,欧艳秋,陈寄梅,等. 2004 至 2011 年广东省胎婴儿先天性心脏病危险因素分析[J]. 中华心血管病杂志, 2013, 41(8): 704-708.[11]  Ou Y, Mai J, Zhuang J et al. Risk factors of different congenital heart defects in Guangdong, China[J]. Pediatric Research. 2015. doi: 10.1038/pr.2015.264. [Epub ahead of print].[12]  Knol M J, VanderWeele T J. Recommendations for presenting analyses of effect modification and interaction[J]. International journal of epidemiology, 2012, 41(2): 514-520. doi: 10.1093/ije/dyr218. Epub 2012 Jan 9.<span></span></p></section><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><blockquote data-tool="mdnice编辑器"><p>原创不易，转载请说明来自本公众号。</p></blockquote></section><p><br></p><p><img data-ratio="0.29259259259259257" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/Zb9jB9p1cKEGiavdg5SUNKEWbUl9QQ7SaJr5cwIvmvaYYcV6LZfk8MWcs9x8ghVibLMdiau4F8UvesIODChVzh7dQ/640?wx_fmt=jpeg" data-type="jpeg" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_jpg/Zb9jB9p1cKEGiavdg5SUNKEWbUl9QQ7SaJr5cwIvmvaYYcV6LZfk8MWcs9x8ghVibLMdiau4F8UvesIODChVzh7dQ/640?wx_fmt=jpeg"></p><p><br></p><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/Xi81nqHY72589lEZY-C_vw",target="_blank" rel="noopener noreferrer">原文链接</a>
