---
title: "端到端的单细胞管道SCP-快速开始"
date: 2023-09-22T15:44:22Z
draft: ["false"]
tags: [
  "fetched",
  "单细胞天地"
]
categories: ["Acdemic"]
---
端到端的单细胞管道SCP-快速开始 by 单细胞天地
------
<div><section data-style-type="5" data-tools="新媒体排版" data-id="2430070"><section data-style-type="5" data-tools="新媒体排版" data-id="2390348"><section><section powered-by="xiumi.us"><section><section><section powered-by="xiumi.us"><section><section><br></section><section><section><section powered-by="xiumi.us"><section><section><p>春风得意马蹄疾，一日看尽长安花</p></section></section></section></section></section></section></section></section><section><section powered-by="xiumi.us"><section><section><img data-ratio="0.8738095238095238" data-src="https://mmbiz.qpic.cn/mmbiz_gif/siaia0BDGJdjSnnb9ibXpFagGPWQ0JjSSTNVBZthROEhicfINuLcxX2Ro3Zb600LJhrzeYIb120tLjSVXEtLn14DwA/640?wx_fmt=gif" data-type="gif" data-w="420" width="100%" src="https://mmbiz.qpic.cn/mmbiz_gif/siaia0BDGJdjSnnb9ibXpFagGPWQ0JjSSTNVBZthROEhicfINuLcxX2Ro3Zb600LJhrzeYIb120tLjSVXEtLn14DwA/640?wx_fmt=gif"></section></section></section></section></section></section></section></section></section><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><blockquote data-tool="mdnice编辑器"><p>作为快速开始，本章将简单展示SCP三个模块（前处理、下游分析、可视化）的大致功能，各模块各函数的使用细节将在后续教程中详细说明。</p></blockquote><section data-tool="mdnice编辑器"><table><thead><tr><th>目录：</th><th><br></th></tr></thead><tbody><tr><td><span>1. 数据探索</span></td><td><span>9. RNA速率分析</span></td></tr><tr><td><span>2. 细胞质控</span></td><td><span>10. 差异表达分析</span></td></tr><tr><td><span>3. 标准的单细胞处理流程</span></td><td><span>11. 富集分析（ORA）</span></td></tr><tr><td><span>4. 批次矫正的单细胞整合处理流程</span></td><td><span>12. 富集分析（GSEA）</span></td></tr><tr><td><span>5. 单细胞数据集间的映射</span></td><td><span>13. 轨迹推断</span></td></tr><tr><td><span>6. 使用Bulk RNA-seq数据进行细胞注释</span></td><td><span>14. 动态特征鉴定</span></td></tr><tr><td><span>7. 使用scRNA-seq数据进行细胞注释</span></td><td><span>15. 交互式的单细胞数据查询网页（SCExplorer）</span></td></tr><tr><td><span>8. PAGA分析</span></td><td><span>16. 一些函数的可视化示例</span></td></tr></tbody></table></section><h2 data-tool="mdnice编辑器"><span></span><span>1、数据探索</span></h2><p data-tool="mdnice编辑器">本章主要使用下采样后的小鼠胚胎E15.5天的胰腺上皮单细胞数据进行分析，可以通过在R中运行<code>?pancreas_sub</code>来查看该示例数据相关信息。</p><p data-tool="mdnice编辑器">该数据中的细胞类型已经被注释，其中<code>pancreas_sub[["CellType"]]</code>为粗分细胞类型，分为胰腺导管细胞（Ductal），内分泌前体细胞（Ngn3 low EP，Ngn3 high EP），前内分泌细胞（Pre-endocrine）和内分泌细胞（Endocrine）五种细胞类型。<code>pancreas_sub[["SubCellType"]]</code>则进一步细分了终末分化的内分泌细胞类型，包括Beta，Alpha，Delta，Epsilon。</p><p data-tool="mdnice编辑器">另外该数据已含有<code>PCA</code>和<code>UMAP</code>坐标信息，以及<code>spliced</code>和<code>unspliced</code>矩阵（可用于RNA速率分析）。</p><pre data-tool="mdnice编辑器"><span></span><code><span>library</span>(SCP)<br><span>library</span>(BiocParallel)<br>register(MulticoreParam(workers = <span>8</span>, progressbar = <span>TRUE</span>))<br><br>data(<span>"pancreas_sub"</span>)<br>print(pancreas_sub)<br><span>#&gt; An object of class Seurat</span><br><span>#&gt; 47874 features across 1000 samples within 3 assays</span><br><span>#&gt; Active assay: RNA (15958 features, 3467 variable features)</span><br><span>#&gt;  2 other assays present: spliced, unspliced</span><br><span>#&gt;  2 dimensional reductions calculated: PCA, UMAP</span><br></code></pre><p data-tool="mdnice编辑器">注意，SCP的多线程策略与Seurat不同，使用<span>BiocParallel</span><sup>[1]</sup>而不是<span>future</span><sup>[2]</sup>。建议使用SCP时不要启用future，否则在一些函数运行上会变慢。</p><p data-tool="mdnice编辑器">这里使用BiocParallel设置了线程数为8，也可以在运行相关函数时手动设置，SCP支持多线程的函数有：</p><ul data-tool="mdnice编辑器"><li><section>RunDEtest</section></li><li><section>RunEnrichment</section></li><li><section>RunGSEA</section></li><li><section>RunDynamicFeatures</section></li><li><section>RunDynamicEnrichment</section></li><li><section>CellScoring</section></li><li><section>panel_fix</section></li></ul><p data-tool="mdnice编辑器">然后可以使用一些函数对数据进行探索性的可视化：</p><pre data-tool="mdnice编辑器"><span></span><code>CellDimPlot(<br>  srt = pancreas_sub, group.by = c(<span>"CellType"</span>, <span>"SubCellType"</span>),<br>  reduction = <span>"UMAP"</span>, theme_use = <span>"theme_blank"</span><br>)<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.5" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSMUQD7AqmtMxTqg6bu8C9LTODS6VnKpovbJJmoaYbia7UpCv2RMYrqsuWdCTujNfVGwlEAQyP4z4w/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSMUQD7AqmtMxTqg6bu8C9LTODS6VnKpovbJJmoaYbia7UpCv2RMYrqsuWdCTujNfVGwlEAQyP4z4w/640?wx_fmt=png"></figure><pre data-tool="mdnice编辑器"><span></span><code>CellDimPlot(<br>  srt = pancreas_sub, group.by = <span>"SubCellType"</span>, stat.by = <span>"Phase"</span>,<br>  reduction = <span>"UMAP"</span>, theme_use = <span>"theme_blank"</span><br>)<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.5" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSMUQD7AqmtMxTqg6bu8C9LIgyImZ3KcsJBWN3vtk1ZVmvXibiarx42NPeqejstGq3Y7baxxrSTOlpg/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSMUQD7AqmtMxTqg6bu8C9LIgyImZ3KcsJBWN3vtk1ZVmvXibiarx42NPeqejstGq3Y7baxxrSTOlpg/640?wx_fmt=png"></figure><pre data-tool="mdnice编辑器"><span></span><code>FeatureDimPlot(<br>  srt = pancreas_sub, features = c(<span>"Sox9"</span>, <span>"Neurog3"</span>, <span>"Fev"</span>, <span>"Rbp4"</span>),<br>  reduction = <span>"UMAP"</span>, theme_use = <span>"theme_blank"</span><br>)<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.5" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSMUQD7AqmtMxTqg6bu8C9LxO28UFkYbSrLI65Uictk1luWBomyhM6aBXJfibaU7rjT80Ny8JykWFDA/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSMUQD7AqmtMxTqg6bu8C9LxO28UFkYbSrLI65Uictk1luWBomyhM6aBXJfibaU7rjT80Ny8JykWFDA/640?wx_fmt=png"></figure><pre data-tool="mdnice编辑器"><span></span><code>FeatureDimPlot(<br>  srt = pancreas_sub, features = c(<span>"Ins1"</span>, <span>"Gcg"</span>, <span>"Sst"</span>, <span>"Ghrl"</span>),<br>  compare_features = <span>TRUE</span>, label = <span>TRUE</span>, label_insitu = <span>TRUE</span>,<br>  reduction = <span>"UMAP"</span>, theme_use = <span>"theme_blank"</span><br>)<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.5" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSMUQD7AqmtMxTqg6bu8C9LeGzuIy73KrYTAvWK4B7NsDhveh6hB664QuWXKtd4Abt926EtftQcWw/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSMUQD7AqmtMxTqg6bu8C9LeGzuIy73KrYTAvWK4B7NsDhveh6hB664QuWXKtd4Abt926EtftQcWw/640?wx_fmt=png"></figure><pre data-tool="mdnice编辑器"><span></span><code>ht &lt;- GroupHeatmap(<br>  srt = pancreas_sub,<br>  features = c(<br>    <span>"Sox9"</span>, <span>"Anxa2"</span>, <span># Ductal</span><br>    <span>"Neurog3"</span>, <span>"Hes6"</span>, <span># EPs</span><br>    <span>"Fev"</span>, <span>"Neurod1"</span>, <span># Pre-endocrine</span><br>    <span>"Rbp4"</span>, <span>"Pyy"</span>, <span># Endocrine</span><br>    <span>"Ins1"</span>, <span>"Gcg"</span>, <span>"Sst"</span>, <span>"Ghrl"</span> <span># Beta, Alpha, Delta, Epsilon</span><br>  ),<br>  group.by = c(<span>"CellType"</span>, <span>"SubCellType"</span>),<br>  heatmap_palette = <span>"YlOrRd"</span>,<br>  cell_annotation = c(<span>"Phase"</span>, <span>"G2M_score"</span>, <span>"Cdh2"</span>),<br>  cell_annotation_palette = c(<span>"Dark2"</span>, <span>"Paired"</span>, <span>"Paired"</span>),<br>  show_row_names = <span>TRUE</span>, row_names_side = <span>"left"</span>,<br>  add_dot = <span>TRUE</span>, add_reticle = <span>TRUE</span><br>)<br>print(ht$plot)<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.5" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSMUQD7AqmtMxTqg6bu8C9LMKvz3PWzicRicT41iaicjFiaqM53vIzmahXDlKRkcz1ceV2iaFPBIAKDHd7w/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSMUQD7AqmtMxTqg6bu8C9LMKvz3PWzicRicT41iaicjFiaqM53vIzmahXDlKRkcz1ceV2iaFPBIAKDHd7w/640?wx_fmt=png"></figure><h2 data-tool="mdnice编辑器"><span></span><span>2、细胞质控</span></h2><p data-tool="mdnice编辑器"><code>RunCellQC</code> 将会采用默认质控策略对各细胞进行质控指标的计算和分类。</p><p data-tool="mdnice编辑器">因为示例数据已无需质控，这里仅作演示：</p><pre data-tool="mdnice编辑器"><span></span><code>pancreas_sub &lt;- RunCellQC(srt = pancreas_sub)<br>CellDimPlot(srt = pancreas_sub, group.by = <span>"CellQC"</span>, reduction = <span>"UMAP"</span>)<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.5" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSMUQD7AqmtMxTqg6bu8C9LSdLQqzAsLI1icbxicltnWw5Eoy0bBvK9Yw2KgPCDQ5ZotJh8WCxB2oRQ/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSMUQD7AqmtMxTqg6bu8C9LSdLQqzAsLI1icbxicltnWw5Eoy0bBvK9Yw2KgPCDQ5ZotJh8WCxB2oRQ/640?wx_fmt=png"></figure><pre data-tool="mdnice编辑器"><span></span><code>CellStatPlot(srt = pancreas_sub, stat.by = <span>"CellQC"</span>, group.by = <span>"CellType"</span>, label = <span>TRUE</span>)<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.5" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSMUQD7AqmtMxTqg6bu8C9LOicvbspSubXh3lOdF2hwGvmsQ4zaDNHaTib5m4khN7Sy199B68y3DYJA/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSMUQD7AqmtMxTqg6bu8C9LOicvbspSubXh3lOdF2hwGvmsQ4zaDNHaTib5m4khN7Sy199B68y3DYJA/640?wx_fmt=png"></figure><pre data-tool="mdnice编辑器"><span></span><code>CellStatPlot(<br>  srt = pancreas_sub,<br>  stat.by = c(<br>    <span>"db_qc"</span>, <span>"outlier_qc"</span>, <span>"umi_qc"</span>, <span>"gene_qc"</span>,<br>    <span>"mito_qc"</span>, <span>"ribo_qc"</span>, <span>"ribo_mito_ratio_qc"</span>, <span>"species_qc"</span><br>  ),<br>  plot_type = <span>"upset"</span>, stat_level = <span>"Fail"</span><br>)<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.5" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSMUQD7AqmtMxTqg6bu8C9LTnR1npguNVV2Sjf6912pHqKxysluDQsdPsOxHALU857Red6uQXSefg/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSMUQD7AqmtMxTqg6bu8C9LTnR1npguNVV2Sjf6912pHqKxysluDQsdPsOxHALU857Red6uQXSefg/640?wx_fmt=png"></figure><h2 data-tool="mdnice编辑器"><span></span><span>3、标准的单细胞数据处理流程</span></h2><p data-tool="mdnice编辑器">对于单个单细胞样本，可以直接运行<code>Standard_SCP</code> 来进行normalization,feature selection, dimension reduction,clustering等标准的单细胞数据处理流程，最终获得细胞分群，降维后坐标等：</p><pre data-tool="mdnice编辑器"><span></span><code>pancreas_sub &lt;- Standard_SCP(srt = pancreas_sub)<br>CellDimPlot(<br>  srt = pancreas_sub, group.by = c(<span>"CellType"</span>, <span>"SubCellType"</span>),<br>  reduction = <span>"StandardUMAP2D"</span>, theme_use = <span>"theme_blank"</span><br>)<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.5" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSMUQD7AqmtMxTqg6bu8C9LjCOP9Cumy1pnIz8ZcWUDLe9GFloHn3hlG7pOicXebw6hlm91ZntvfZg/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSMUQD7AqmtMxTqg6bu8C9LjCOP9Cumy1pnIz8ZcWUDLe9GFloHn3hlG7pOicXebw6hlm91ZntvfZg/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器"><code>Standard_SCP</code>默认还会计算UMAP的三维空间嵌入坐标，可进行3D可视化：</p><pre data-tool="mdnice编辑器"><span></span><code>CellDimPlot3D(srt = pancreas_sub, group.by = <span>"SubCellType"</span>)<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.6428571428571429" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSMUQD7AqmtMxTqg6bu8C9L16UJ4Om5naV89TObXJpJ5unZMr3NjIib6lAcs9Ua2peONleoGichWwNw/640?wx_fmt=png" data-type="png" data-w="700" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSMUQD7AqmtMxTqg6bu8C9L16UJ4Om5naV89TObXJpJ5unZMr3NjIib6lAcs9Ua2peONleoGichWwNw/640?wx_fmt=png"></figure><h2 data-tool="mdnice编辑器"><span></span><span>4、批次矫正的单细胞数据整合处理流程</span></h2><p data-tool="mdnice编辑器">对于具有批次效应的多批次数据，可以使用<code>Integration_SCP</code> 进行批次矫正。</p><p data-tool="mdnice编辑器"><code>Integration_SCP</code> 需要两个设置额外参数：</p><ul data-tool="mdnice编辑器"><li><section><code>batch</code> Seurat对象中用于区分批次信息的meta.data属性</section></li><li><section><code>integration_method</code> 用于矫正的算法，支持Seurat, scVI, MNN, fastMNN,Harmony, Scanorama, BBKNN, CSS, LIGER, Conos,Combat，不作矫正的话可以设置为Uncorrected</section></li></ul><p data-tool="mdnice编辑器">接下以一个下采样后的8个成人胰腺单细胞数据集为例，进行不同算法的批次效应矫正，可以通过在R中运行<code>?panc8_sub</code>来查看该示例数据相关信息：</p><pre data-tool="mdnice编辑器"><span></span><code>data(<span>"panc8_sub"</span>)<br>panc8_sub &lt;- Integration_SCP(srtMerge = panc8_sub, batch = <span>"tech"</span>, integration_method = <span>"Seurat"</span>)<br>CellDimPlot(<br>  srt = panc8_sub, group.by = c(<span>"celltype"</span>, <span>"tech"</span>), reduction = <span>"SeuratUMAP2D"</span>,<br>  title = <span>"Seurat"</span>, theme_use = <span>"theme_blank"</span><br>)<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.5" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSMUQD7AqmtMxTqg6bu8C9LJQFia4vspWtqARcu81TGehxAxLxjxMZz5vfoK8T8GxJoq9oj6QiaCqrw/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSMUQD7AqmtMxTqg6bu8C9LJQFia4vspWtqARcu81TGehxAxLxjxMZz5vfoK8T8GxJoq9oj6QiaCqrw/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">不矫正以及其余批次矫正算法的结果：</p><figure data-tool="mdnice编辑器"><img data-ratio="1.587962962962963" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSMUQD7AqmtMxTqg6bu8C9LShyVp68nDqgTSZp2ia3eEqfSOuuz0ksxiaXia5oZBxBGqaHwdCooFjN0w/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSMUQD7AqmtMxTqg6bu8C9LShyVp68nDqgTSZp2ia3eEqfSOuuz0ksxiaXia5oZBxBGqaHwdCooFjN0w/640?wx_fmt=png"></figure><h2 data-tool="mdnice编辑器"><span></span><span>5、单细胞数据集间的映射</span></h2><p data-tool="mdnice编辑器">到这里已经有了两个胰腺数据集，虽然是分别小鼠和人两个物种，且一个是胚胎胰腺另一个是成人胰腺，但是许多细胞类型是类似的，理论上相同的细胞类型会有近邻关系。</p><p data-tool="mdnice编辑器">所以可以对这两个数据集进行细胞映射，映射前首先需要将小鼠基因名称转换成人基因名称（这里为了简单起见直接首字母大写，但推荐使用<code>GeneConvert</code>进行物种间的基因的ID转换）：</p><pre data-tool="mdnice编辑器"><span></span><code>panc8_rename &lt;- RenameFeatures(srt = panc8_sub, newnames = make.unique(capitalize(rownames(panc8_sub), force_tolower = <span>TRUE</span>)), assays = <span>"RNA"</span>)<br>srt_query &lt;- RunKNNMap(srt_query = pancreas_sub, srt_ref = panc8_rename, ref_umap = <span>"SeuratUMAP2D"</span>)<br>ProjectionPlot(<br>  srt_query = srt_query, srt_ref = panc8_rename,<br>  query_group = <span>"SubCellType"</span>, ref_group = <span>"celltype"</span><br>)<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.5" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSMUQD7AqmtMxTqg6bu8C9Lx95tBaZFsbgLzXMX7GhKP4NTTfUvpStCEiaFPSBrFb86B5PI54bB45A/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSMUQD7AqmtMxTqg6bu8C9Lx95tBaZFsbgLzXMX7GhKP4NTTfUvpStCEiaFPSBrFb86B5PI54bB45A/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">当然，相同物种、相同组织的数据集作细胞映射是最佳的：</p><pre data-tool="mdnice编辑器"><span></span><code>srt_ref &lt;- panc8_sub[, panc8_sub$tech != <span>"smartseq2"</span>]<br>srt_query &lt;- panc8_sub[, panc8_sub$tech == <span>"smartseq2"</span>]<br>srt_query &lt;- RunKNNMap(srt_query = srt_query, srt_ref = srt_ref, ref_umap = <span>"SeuratUMAP2D"</span>)<br>ProjectionPlot(<br>  srt_query = srt_query, srt_ref = srt_ref,<br>  query_group = <span>"celltype"</span>, ref_group = <span>"celltype"</span><br>)<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.5" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSMUQD7AqmtMxTqg6bu8C9LSB2N41caJoXI6QH6cbYiaKgndkibOJlic8byA8OShxp4q4eSM9d8RkJtg/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSMUQD7AqmtMxTqg6bu8C9LSB2N41caJoXI6QH6cbYiaKgndkibOJlic8byA8OShxp4q4eSM9d8RkJtg/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">显然映射结果基本上可以匹配正确的细胞类型，因此很多时候可以利用相同组织已注释的数据集，映射手头的数据，来直观的进行细胞注释。</p><h2 data-tool="mdnice编辑器"><span></span><span>6、使用Bulk RNA-seq数据进行细胞注释</span></h2><p data-tool="mdnice编辑器">细胞注释和细胞映射在背后的计算上是类似的，区别在于前者的目标是明确细胞类型（或其他属性）间的对应关系，而不是空间坐标的邻近关系。</p><p data-tool="mdnice编辑器">SCP准备了人和鼠的参考集<span>scHCL</span><sup>[3]</sup>和<span>scMCA</span><sup>[4]</sup>（行为基因，列为各细胞类型）。我们将<span>scMCA</span><sup>[5]</sup>其视作一个Bulkrna-seq来进行细胞类型注释，并过滤掉小于20个细胞的细胞类型并归为unreliable：</p><pre data-tool="mdnice编辑器"><span></span><code>data(<span>"ref_scMCA"</span>)<br>dim(ref_scMCA)<br><span>#&gt; [1] 3028  894</span><br>pancreas_sub &lt;- RunKNNPredict(srt_query = pancreas_sub, bulk_ref = ref_scMCA, filter_lowfreq = <span>20</span>)<br>CellDimPlot(srt = pancreas_sub, group.by = <span>"KNNPredict_classification"</span>, reduction = <span>"UMAP"</span>, label = <span>TRUE</span>)<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.5" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSMUQD7AqmtMxTqg6bu8C9LhxXnhfXeTdPoecgTWnaFMib6q6MibjmOYw7LxB5wWGxGjTYiaYnxECPZQ/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSMUQD7AqmtMxTqg6bu8C9LhxXnhfXeTdPoecgTWnaFMib6q6MibjmOYw7LxB5wWGxGjTYiaYnxECPZQ/640?wx_fmt=png"></figure><h2 data-tool="mdnice编辑器"><span></span><span>7、使用scRNA-seq数据进行细胞注释</span></h2><p data-tool="mdnice编辑器">利用之前成人胰腺的scRNA-seq数据也可以直接进行注释，注释可在单个细胞层面或整个细胞类型层面进行：</p><pre data-tool="mdnice编辑器"><span></span><code>pancreas_sub &lt;- RunKNNPredict(<br>  srt_query = pancreas_sub, srt_ref = panc8_rename,<br>  ref_group = <span>"celltype"</span>, filter_lowfreq = <span>20</span><br>)<br>CellDimPlot(srt = pancreas_sub, group.by = <span>"KNNPredict_classification"</span>, reduction = <span>"UMAP"</span>, label = <span>TRUE</span>)<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.5" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSMUQD7AqmtMxTqg6bu8C9LguClHXNrgOmn4V71EdJb0usaAict07YlRFFdE0Tk5QCvPKOmHmDIfSg/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSMUQD7AqmtMxTqg6bu8C9LguClHXNrgOmn4V71EdJb0usaAict07YlRFFdE0Tk5QCvPKOmHmDIfSg/640?wx_fmt=png"></figure><pre data-tool="mdnice编辑器"><span></span><code>pancreas_sub &lt;- RunKNNPredict(<br>  srt_query = pancreas_sub, srt_ref = panc8_rename,<br>  query_group = <span>"SubCellType"</span>, ref_group = <span>"celltype"</span>,<br>  return_full_distance_matrix = <span>TRUE</span><br>)<br>CellDimPlot(srt = pancreas_sub, group.by = <span>"KNNPredict_classification"</span>, reduction = <span>"UMAP"</span>, label = <span>TRUE</span>)<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.5" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSMUQD7AqmtMxTqg6bu8C9LtTFEjIRicRNWQSicuFUfG35bxpziawaic9NVnKR7edzYjzy8ZGeibPAuATw/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSMUQD7AqmtMxTqg6bu8C9LtTFEjIRicRNWQSicuFUfG35bxpziawaic9NVnKR7edzYjzy8ZGeibPAuATw/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">在细胞类型注释时，<code>RunKNNPredict</code>会使用距离或相似性指标进行两个数据集的细胞间比较或细胞类型间比较，最终确定细胞类型，这里也可以使用<code>CellCorHeatmap</code>来直接观察细胞类型间的距离或相似性，并标记出前三个最高的相似性值：</p><pre data-tool="mdnice编辑器"><span></span><code>ht &lt;- CellCorHeatmap(<br>  srt_query = pancreas_sub, srt_ref = panc8_rename,<br>  query_group = <span>"SubCellType"</span>, ref_group = <span>"celltype"</span>,<br>  nlabel = <span>3</span>, label_by = <span>"row"</span>,<br>  show_row_names = <span>TRUE</span>, show_column_names = <span>TRUE</span><br>)<br>print(ht$plot)<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.5" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSMUQD7AqmtMxTqg6bu8C9LT8Lf9rwdS33CHs6dJvRFmGic5TSxdMB3LoYbvUS2vmpugevfwWVFUEA/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSMUQD7AqmtMxTqg6bu8C9LT8Lf9rwdS33CHs6dJvRFmGic5TSxdMB3LoYbvUS2vmpugevfwWVFUEA/640?wx_fmt=png"></figure><h2 data-tool="mdnice编辑器"><span></span><span>8、PAGA分析</span></h2><p data-tool="mdnice编辑器">PAGA分析可以推断出细胞群之间的邻近关系或轨迹，建立好SCP的python环境后，直接运行：</p><pre data-tool="mdnice编辑器"><span></span><code>pancreas_sub &lt;- RunPAGA(<br>  srt = pancreas_sub, group_by = <span>"SubCellType"</span>,<br>  linear_reduction = <span>"PCA"</span>, nonlinear_reduction = <span>"UMAP"</span><br>)<br>PAGAPlot(srt = pancreas_sub, reduction = <span>"UMAP"</span>, label = <span>TRUE</span>, label_insitu = <span>TRUE</span>, label_repel = <span>TRUE</span>)<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.5" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSMUQD7AqmtMxTqg6bu8C9LtEtxpoBvxp8Pap3HmRlCp1ichHY9kLKZ2RqJx3PgsotY5CicqkB6DC0Q/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSMUQD7AqmtMxTqg6bu8C9LtEtxpoBvxp8Pap3HmRlCp1ichHY9kLKZ2RqJx3PgsotY5CicqkB6DC0Q/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">注意，PAGA的结果存储在了<code>pancreas_sub@misc$paga</code>中。</p><h2 data-tool="mdnice编辑器"><span></span><span>9、RNA速率分析</span></h2><p data-tool="mdnice编辑器">RNA速率的估计需要Seurat对象含有<code>spliced</code>和<code>unspliced</code>两个assay，可以通过<code>names(pancreas_sub@assays)</code>查看，如果不存在需要使用<span>velocyto</span><sup>[6]</sup>,<span>bustools</span><sup>[7]</sup>或者<span>alevin</span><sup>[8]</sup>来生成矩阵并存入Seurat对象中。</p><p data-tool="mdnice编辑器">在运行<code>RunPAGA</code>或<code>RunSCVELO</code>的过程中，如果使用的是Rstudio，则可以在其plot窗口看到相关的输出结果，运行结束后相关的结果将保存在Seurat对象中。</p><pre data-tool="mdnice编辑器"><span></span><code>pancreas_sub &lt;- RunSCVELO(<br>  srt = pancreas_sub, group_by = <span>"SubCellType"</span>,<br>  linear_reduction = <span>"PCA"</span>, nonlinear_reduction = <span>"UMAP"</span><br>)<br>VelocityPlot(srt = pancreas_sub, reduction = <span>"UMAP"</span>, group_by = <span>"SubCellType"</span>)<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.5" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSMUQD7AqmtMxTqg6bu8C9LJMWCxqXQzOL7DT7xS2ekAwPoRHFcicvVzd8LPtUwJDeCGgVxJVteQJQ/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSMUQD7AqmtMxTqg6bu8C9LJMWCxqXQzOL7DT7xS2ekAwPoRHFcicvVzd8LPtUwJDeCGgVxJVteQJQ/640?wx_fmt=png"></figure><pre data-tool="mdnice编辑器"><span></span><code>VelocityPlot(srt = pancreas_sub, reduction = <span>"UMAP"</span>, plot_type = <span>"stream"</span>)<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.5" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSMUQD7AqmtMxTqg6bu8C9LrXwxGr4CAGRciaIC7lGnLLrZP4tZia40SjztCjKjMenkF1CkBwGMKJDg/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSMUQD7AqmtMxTqg6bu8C9LrXwxGr4CAGRciaIC7lGnLLrZP4tZia40SjztCjKjMenkF1CkBwGMKJDg/640?wx_fmt=png"></figure><h2 data-tool="mdnice编辑器"><span></span><span>10、差异表达分析</span></h2><p data-tool="mdnice编辑器">SCP中的差异分析使用的是<code>RunDEtest</code>，其中主要调用了Seurat的<code>FindMarkers</code>函数，并使用了多线程来完成计算：</p><pre data-tool="mdnice编辑器"><span></span><code>pancreas_sub &lt;- RunDEtest(srt = pancreas_sub, group_by = <span>"CellType"</span>, fc.threshold = <span>1</span>, only.pos = <span>FALSE</span>)<br>VolcanoPlot(srt = pancreas_sub, group_by = <span>"CellType"</span>)<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.5" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSMUQD7AqmtMxTqg6bu8C9LeeV1tzYiav23lJFmME9k0ZP0QZIFTRBP72ibueuEAZYG5u44LNR8hF9g/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSMUQD7AqmtMxTqg6bu8C9LeeV1tzYiav23lJFmME9k0ZP0QZIFTRBP72ibueuEAZYG5u44LNR8hF9g/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">所有的差异分析结果存储在<code>pancreas_sub@tools</code>中，可以进行进一步的筛选出差异具有显著性的基因，并对这些基因注释上转录因子和表面蛋白，最后可视化：</p><pre data-tool="mdnice编辑器"><span></span><code>DEGs &lt;- pancreas_sub@tools$DEtest_CellType$AllMarkers_wilcox<br>DEGs &lt;- DEGs[with(DEGs, avg_log2FC &gt; <span>1</span> &amp; p_val_adj &lt; <span>0.05</span>), ]<br><span># Annotate features with transcription factors and surface proteins</span><br>pancreas_sub &lt;- AnnotateFeatures(pancreas_sub, species = <span>"Mus_musculus"</span>, db = c(<span>"TF"</span>, <span>"CSPA"</span>))<br>ht &lt;- FeatureHeatmap(<br>  srt = pancreas_sub, group.by = <span>"CellType"</span>, features = DEGs$gene, feature_split = DEGs$group1,<br>  species = <span>"Mus_musculus"</span>, db = c(<span>"GO_BP"</span>, <span>"KEGG"</span>, <span>"WikiPathway"</span>), anno_terms = <span>TRUE</span>,<br>  feature_annotation = c(<span>"TF"</span>, <span>"CSPA"</span>), feature_annotation_palcolor = list(c(<span>"gold"</span>, <span>"steelblue"</span>), c(<span>"forestgreen"</span>)),<br>  height = <span>5</span>, width = <span>4</span><br>)<br>print(ht$plot)<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.3333333333333333" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSMUQD7AqmtMxTqg6bu8C9LWUNMrdlibvTCticibJpOLYciau2CerGE89GibiaITpL1PxCNKRrRXRZibSGFw/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSMUQD7AqmtMxTqg6bu8C9LWUNMrdlibvTCticibJpOLYciau2CerGE89GibiaITpL1PxCNKRrRXRZibSGFw/640?wx_fmt=png"></figure><h2 data-tool="mdnice编辑器"><span></span><span>11、富集分析（ORA）</span></h2><p data-tool="mdnice编辑器">上面的热图中同时也做了富集分析，也可以使用<code>RunEnrichment</code>单独进行计算，这里我们筛选出1.5倍foldchange且p_val_adj&lt;0.05的差异基因做富集和不同类型的可视化（默认只显示p.adjust&lt;0.05的显著性富集的事件）：</p><pre data-tool="mdnice编辑器"><span></span><code>pancreas_sub &lt;- RunEnrichment(<br>  srt = pancreas_sub, group_by = <span>"CellType"</span>, db = <span>"GO_BP"</span>, species = <span>"Mus_musculus"</span>,<br>  DE_threshold = <span>"avg_log2FC &gt; log2(1.5) &amp; p_val_adj &lt; 0.05"</span><br>)<br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span>柱形图：</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code>EnrichmentPlot(<br>  srt = pancreas_sub, group_by = <span>"CellType"</span>, group_use = c(<span>"Ductal"</span>, <span>"Endocrine"</span>),<br>  plot_type = <span>"bar"</span><br>)<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.5" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSMUQD7AqmtMxTqg6bu8C9L2YAnic5amoIjChz3eJibka8Ue2IlslUyOtRW443ib2TwA6C3mxJNScNcA/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSMUQD7AqmtMxTqg6bu8C9L2YAnic5amoIjChz3eJibka8Ue2IlslUyOtRW443ib2TwA6C3mxJNScNcA/640?wx_fmt=png"></figure><h3 data-tool="mdnice编辑器"><span></span><span>词云图（事件中的关键词）：</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code>EnrichmentPlot(<br>  srt = pancreas_sub, group_by = <span>"CellType"</span>, group_use = c(<span>"Ductal"</span>, <span>"Endocrine"</span>),<br>  plot_type = <span>"wordcloud"</span><br>)<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.5" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSMUQD7AqmtMxTqg6bu8C9Ls4Duia1TC9RAGPQibmV77fWJRAFOuict6ZhP0uGeUibwv70xr74EpaWZbQ/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSMUQD7AqmtMxTqg6bu8C9Ls4Duia1TC9RAGPQibmV77fWJRAFOuict6ZhP0uGeUibwv70xr74EpaWZbQ/640?wx_fmt=png"></figure><h3 data-tool="mdnice编辑器"><span></span><span>词云图（事件中的关键基因）：</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code>EnrichmentPlot(<br>  srt = pancreas_sub, group_by = <span>"CellType"</span>, group_use = c(<span>"Ductal"</span>, <span>"Endocrine"</span>),<br>  plot_type = <span>"wordcloud"</span>, word_type = <span>"feature"</span><br>)<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.5" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSMUQD7AqmtMxTqg6bu8C9L3BeKUzDnJRZYOVibmicWticymCdgkOUg0FJlGgPTy346qhiar5UHUvYnNg/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSMUQD7AqmtMxTqg6bu8C9L3BeKUzDnJRZYOVibmicWticymCdgkOUg0FJlGgPTy346qhiar5UHUvYnNg/640?wx_fmt=png"></figure><h3 data-tool="mdnice编辑器"><span></span><span>事件-基因网络图：</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code>EnrichmentPlot(<br>  srt = pancreas_sub, group_by = <span>"CellType"</span>, group_use = <span>"Ductal"</span>,<br>  plot_type = <span>"network"</span><br>)<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.5" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSMUQD7AqmtMxTqg6bu8C9L2QJkLHScibQhnVVicTvyGJDoHF4HXFJiccoc1pdvTakPT86m6odUOVZ2g/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSMUQD7AqmtMxTqg6bu8C9L2QJkLHScibQhnVVicTvyGJDoHF4HXFJiccoc1pdvTakPT86m6odUOVZ2g/640?wx_fmt=png"></figure><h3 data-tool="mdnice编辑器"><span></span><span>所有富集事件的enrichmap</span><span></span></h3><p data-tool="mdnice编辑器">注意：需要调整plot窗口，来显示出所有的事件标签</p><pre data-tool="mdnice编辑器"><span></span><code>EnrichmentPlot(<br>  srt = pancreas_sub, group_by = <span>"CellType"</span>, group_use = <span>"Ductal"</span>,<br>  plot_type = <span>"enrichmap"</span><br>)<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.6333333333333333" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSMUQD7AqmtMxTqg6bu8C9LAVvtXlf1QJq0U7oQ9J2jnS5LR2lbwBibWQ8JT4sOlkDMoNe6TWkhBhQ/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSMUQD7AqmtMxTqg6bu8C9LAVvtXlf1QJq0U7oQ9J2jnS5LR2lbwBibWQ8JT4sOlkDMoNe6TWkhBhQ/640?wx_fmt=png"></figure><h3 data-tool="mdnice编辑器"><span></span><span>各组富集事件比较的点图：</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code>EnrichmentPlot(srt = pancreas_sub, group_by = <span>"CellType"</span>, plot_type = <span>"comparison"</span>)<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.6" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSMUQD7AqmtMxTqg6bu8C9LJDqs6eGpPHJJ6kUx7qH0XfWj4TSXVKtjsjcezFfsiaUc2JkCHqUgOmg/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSMUQD7AqmtMxTqg6bu8C9LJDqs6eGpPHJJ6kUx7qH0XfWj4TSXVKtjsjcezFfsiaUc2JkCHqUgOmg/640?wx_fmt=png"></figure><h2 data-tool="mdnice编辑器"><span></span><span>12、富集分析（GSEA）</span></h2><p data-tool="mdnice编辑器">之前运行RunDEtest时fc.threshold为1，也就是foldchange不作为基因的筛选标准，只使用其余标准进行筛选，例如min.pct&gt;0.1。差异检验后可以将p_val_adj&lt; 0.05的所有基因取出，作为候选基因集进行GSEA分析：</p><pre data-tool="mdnice编辑器"><span></span><code>pancreas_sub &lt;- RunGSEA(<br>  srt = pancreas_sub, group_by = <span>"CellType"</span>, db = <span>"GO_BP"</span>, species = <span>"Mus_musculus"</span>,<br>  DE_threshold = <span>"p_val_adj &lt; 0.05"</span><br>)<br>GSEAPlot(srt = pancreas_sub, group_by = <span>"CellType"</span>, group_use = <span>"Endocrine"</span>, id_use = <span>"GO:0007186"</span>)<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.5" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSMUQD7AqmtMxTqg6bu8C9LweKn5Ar4nyrH0LcpsDI4WZF9icpXNMZdQ6O5q4BTic7vuLziaDCtWUMIQ/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSMUQD7AqmtMxTqg6bu8C9LweKn5Ar4nyrH0LcpsDI4WZF9icpXNMZdQ6O5q4BTic7vuLziaDCtWUMIQ/640?wx_fmt=png"></figure><pre data-tool="mdnice编辑器"><span></span><code>GSEAPlot(srt = pancreas_sub, group_by = <span>"CellType"</span>, plot_type = <span>"comparison"</span>)<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.6" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSMUQD7AqmtMxTqg6bu8C9LTzNleasK1AiaichYOHicuIKlP46oViaJ3oppuD4btlHyrEwkUzBw8s2lUg/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSMUQD7AqmtMxTqg6bu8C9LTzNleasK1AiaichYOHicuIKlP46oViaJ3oppuD4btlHyrEwkUzBw8s2lUg/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">ORA富集分析和GSEA富集分析的结果也均存于<code>pancreas_sub@tools</code>中</p><h2 data-tool="mdnice编辑器"><span></span><span>13、轨迹推断</span></h2><p data-tool="mdnice编辑器">SCP支持Slingshot, PAGA, scVelo, Palantir, Monocle2, Monocle3,WOT等轨迹推断方法，不过不论是什么方法都需要基于生物学知识库对算法进行合理的限制，对结果进行合理的裁剪。</p><p data-tool="mdnice编辑器">以slingshot为例进行轨迹推断：</p><pre data-tool="mdnice编辑器"><span></span><code>pancreas_sub &lt;- RunSlingshot(srt = pancreas_sub, group.by = <span>"SubCellType"</span>, reduction = <span>"UMAP"</span>)<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.5" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSMUQD7AqmtMxTqg6bu8C9LpfogqQ7GAeb5vLv8qBkHefibFXSDOTenHPFdBhZ8Vvos5sBsVic7WbYA/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSMUQD7AqmtMxTqg6bu8C9LpfogqQ7GAeb5vLv8qBkHefibFXSDOTenHPFdBhZ8Vvos5sBsVic7WbYA/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">在这里Slingshot推断出了三条发育轨迹/谱系，起点均为Ductal/Ngn3 lowEP细胞群，终点分别指向了三种内分泌细胞群Alpha,Beta以及Delta。分别查看三条轨迹的pseudotime：</p><pre data-tool="mdnice编辑器"><span></span><code>FeatureDimPlot(pancreas_sub,<br>  features = paste0(<span>"Lineage"</span>, <span>1</span>:<span>3</span>),<br>  reduction = <span>"UMAP"</span>, theme_use = <span>"theme_blank"</span><br>)<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.5" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSMUQD7AqmtMxTqg6bu8C9LcfTVtcDLAqqjK099picFgw41Hoiaqic4ShKwV0fNqqfeicSoiaqzpptF2OA/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSMUQD7AqmtMxTqg6bu8C9LcfTVtcDLAqqjK099picFgw41Hoiaqic4ShKwV0fNqqfeicSoiaqzpptF2OA/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">灰色的细胞表示不在对应的发育轨迹，其对应轨迹的<code>pesudotime=NA</code>。</p><p data-tool="mdnice编辑器">轨迹的可视化可以根据这些pesudotime调整：</p><pre data-tool="mdnice编辑器"><span></span><code>CellDimPlot(pancreas_sub,<br>  group.by = <span>"SubCellType"</span>, reduction = <span>"UMAP"</span>,<br>  lineages = paste0(<span>"Lineage"</span>, <span>1</span>:<span>3</span>), lineages_span = <span>0.1</span><br>)<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.5" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSMUQD7AqmtMxTqg6bu8C9LEm25o1Yib9EqrMKsQkhDWByOVJAe5qPvoREaicyuxlHtqYlSmZ914tOw/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSMUQD7AqmtMxTqg6bu8C9LEm25o1Yib9EqrMKsQkhDWByOVJAe5qPvoREaicyuxlHtqYlSmZ914tOw/640?wx_fmt=png"></figure><h2 data-tool="mdnice编辑器"><span></span><span>14、动态特征鉴定</span></h2><p data-tool="mdnice编辑器">对于任意算法得到的轨迹pseudotime，都可以使用<code>RunDynamicFeatures</code>计算出与之相关的动态基因（驱动细胞沿轨迹分化发育的基因）。</p><p data-tool="mdnice编辑器">对于多条轨迹也可以同时计算动态基因并比较：</p><pre data-tool="mdnice编辑器"><span></span><code>pancreas_sub &lt;- RunDynamicFeatures(srt = pancreas_sub, lineages = c(<span>"Lineage1"</span>, <span>"Lineage2"</span>), n_candidates = <span>200</span>)<br>ht &lt;- DynamicHeatmap(<br>  srt = pancreas_sub, lineages = c(<span>"Lineage1"</span>, <span>"Lineage2"</span>),<br>  use_fitted = <span>TRUE</span>, n_split = <span>6</span>, reverse_ht = <span>"Lineage1"</span>,<br>  species = <span>"Mus_musculus"</span>, db = <span>"GO_BP"</span>, anno_terms = <span>TRUE</span>, anno_keys = <span>TRUE</span>, anno_features = <span>TRUE</span>,<br>  heatmap_palette = <span>"viridis"</span>, cell_annotation = <span>"SubCellType"</span>,<br>  separate_annotation = list(<span>"SubCellType"</span>, c(<span>"Nnat"</span>, <span>"Irx1"</span>)), separate_annotation_palette = c(<span>"Paired"</span>, <span>"Set1"</span>),<br>  feature_annotation = c(<span>"TF"</span>, <span>"CSPA"</span>), feature_annotation_palcolor = list(c(<span>"gold"</span>, <span>"steelblue"</span>), c(<span>"forestgreen"</span>)),<br>  pseudotime_label = <span>25</span>, pseudotime_label_color = <span>"red"</span>,<br>  height = <span>5</span>, width = <span>2</span><br>)<br>print(ht$plot)<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.5" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSMUQD7AqmtMxTqg6bu8C9LSY3W0xpzDb1KD3sXylt2GKJwicMMvMD9K4BjY5xmKwBicMpxmspQhtaQ/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSMUQD7AqmtMxTqg6bu8C9LSY3W0xpzDb1KD3sXylt2GKJwicMMvMD9K4BjY5xmKwBicMpxmspQhtaQ/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">或逐一查询基因在轨迹中的动态变化：</p><pre data-tool="mdnice编辑器"><span></span><code>DynamicPlot(<br>  srt = pancreas_sub, lineages = c(<span>"Lineage1"</span>, <span>"Lineage2"</span>), group.by = <span>"SubCellType"</span>,<br>  features = c(<span>"Plk1"</span>, <span>"Hes1"</span>, <span>"Neurod2"</span>, <span>"Ghrl"</span>, <span>"Gcg"</span>, <span>"Ins2"</span>),<br>  compare_lineages = <span>TRUE</span>, compare_features = <span>FALSE</span><br>)<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.5" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSMUQD7AqmtMxTqg6bu8C9LYcHFj0P5d0iaCCPrQCpicQLy7iatAibial7LD1libKuQJTfPebgD6L4FIXlw/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSMUQD7AqmtMxTqg6bu8C9LYcHFj0P5d0iaCCPrQCpicQLy7iatAibial7LD1libKuQJTfPebgD6L4FIXlw/640?wx_fmt=png"></figure><pre data-tool="mdnice编辑器"><span></span><code>FeatureStatPlot(<br>  srt = pancreas_sub, group.by = <span>"SubCellType"</span>, bg.by = <span>"CellType"</span>,<br>  stat.by = c(<span>"Sox9"</span>, <span>"Neurod2"</span>, <span>"Isl1"</span>, <span>"Rbp4"</span>), add_box = <span>TRUE</span>,<br>  comparisons = list(<br>    c(<span>"Ductal"</span>, <span>"Ngn3 low EP"</span>),<br>    c(<span>"Ngn3 high EP"</span>, <span>"Pre-endocrine"</span>),<br>    c(<span>"Alpha"</span>, <span>"Beta"</span>)<br>  )<br>)<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.46111111111111114" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSMUQD7AqmtMxTqg6bu8C9L5OfIWh2ujQlsTAhlrPUfS7ibjmC6bribLxVyWWynpjEiciaMDbWku6euiaw/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSMUQD7AqmtMxTqg6bu8C9L5OfIWh2ujQlsTAhlrPUfS7ibjmC6bribLxVyWWynpjEiciaMDbWku6euiaw/640?wx_fmt=png"></figure><h2 data-tool="mdnice编辑器"><span></span><span>15、交互式的单细胞数据查询网页（SCExplorer）</span></h2><p data-tool="mdnice编辑器">最后通过SCExplorer，可以快速的共享单细胞数据到云端，实现交互式的数据查询：</p><pre data-tool="mdnice编辑器"><span></span><code>PrepareSCExplorer(list(mouse_pancreas = pancreas_sub, human_pancreas = panc8_sub), base_dir = <span>"./SCExplorer"</span>)<br>app &lt;- RunSCExplorer(base_dir = <span>"./SCExplorer"</span>)<br>list.files(<span>"./SCExplorer"</span>) <span># This directory can be used as site directory for Shiny Server.</span><br><br><span>if</span> (interactive()) {<br>  shiny::runApp(app)<br>}<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.4861111111111111" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSMUQD7AqmtMxTqg6bu8C9L3riapUviabdUzcvtHETPaaXq7f1wjrVEBah2mlDaRH6bxfWEEyclgTMA/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSMUQD7AqmtMxTqg6bu8C9L3riapUviabdUzcvtHETPaaXq7f1wjrVEBah2mlDaRH6bxfWEEyclgTMA/640?wx_fmt=png"></figure><figure data-tool="mdnice编辑器"><img data-ratio="0.4925925925925926" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSMUQD7AqmtMxTqg6bu8C9LTc9xrnmWnJgAOGkCicLNWFOL8mkRiaZJmNuGibXg9HEJgVJsDAfp3yKvw/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSMUQD7AqmtMxTqg6bu8C9LTc9xrnmWnJgAOGkCicLNWFOL8mkRiaZJmNuGibXg9HEJgVJsDAfp3yKvw/640?wx_fmt=png"></figure><h2 data-tool="mdnice编辑器"><span></span><span>16、一些函数的可视化示例</span></h2><p data-tool="mdnice编辑器">最后分享几个常用SCP的可视化方法及其示例：</p><p data-tool="mdnice编辑器"><span>CellDimPlot</span><sup>[9]</sup></p><figure data-tool="mdnice编辑器"><img data-ratio="0.48055555555555557" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSMUQD7AqmtMxTqg6bu8C9L1oANcI0VdE6iaN5WV6W7rTnK8TpbCm4NotVpeyybJMeNhiaPcvu2y2NQ/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSMUQD7AqmtMxTqg6bu8C9L1oANcI0VdE6iaN5WV6W7rTnK8TpbCm4NotVpeyybJMeNhiaPcvu2y2NQ/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器"><span>CellStatPlot</span><sup>[10]</sup></p><figure data-tool="mdnice编辑器"><img data-ratio="0.5222222222222223" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSMUQD7AqmtMxTqg6bu8C9LcWyiaAO8L5F5IuTayric7rQqgmib3f37KL2jwRtQf9jnDdaamYzQfYHnw/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSMUQD7AqmtMxTqg6bu8C9LcWyiaAO8L5F5IuTayric7rQqgmib3f37KL2jwRtQf9jnDdaamYzQfYHnw/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器"><span>FeatureStatPlot</span><sup>[11]</sup></p><figure data-tool="mdnice编辑器"><img data-ratio="0.8592592592592593" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSMUQD7AqmtMxTqg6bu8C9LhWsIb8mr6nwsDIWlI5icr5gu7h3iaCu5csdItgXhkhaWzhS9iajcrXQEQ/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSMUQD7AqmtMxTqg6bu8C9LhWsIb8mr6nwsDIWlI5icr5gu7h3iaCu5csdItgXhkhaWzhS9iajcrXQEQ/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器"><span>GroupHeatmap</span><sup>[12]</sup></p><figure data-tool="mdnice编辑器"><img data-ratio="0.9101851851851852" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSMUQD7AqmtMxTqg6bu8C9LSfGqf5c8NdAt5JdzQR1pG83PG3ib9ht5ezbDpyNYLEK4WYhXE5pibTibg/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSMUQD7AqmtMxTqg6bu8C9LSfGqf5c8NdAt5JdzQR1pG83PG3ib9ht5ezbDpyNYLEK4WYhXE5pibTibg/640?wx_fmt=png"></figure><h3 data-tool="mdnice编辑器"><hr><span><span><br></span><span>文中链接</span></span></h3><section data-tool="mdnice编辑器"><span><span>[1]</span><p>BiocParallel: <em>https://bioconductor.org/packages/release/bioc/html/BiocParallel.html</em></p></span><span><span>[2]</span><p>future: <em>https://github.com/HenrikBengtsson/future</em></p></span><span><span>[3]</span><p>scHCL: <em>https://github.com/ggjlab/scHCL</em></p></span><span><span>[4]</span><p>scMCA: <em>https://github.com/ggjlab/scMCA</em></p></span><span><span>[5]</span><p>scMCA: <em>https://github.com/ggjlab/scMCA</em></p></span><span><span>[6]</span><p>velocyto: <em>http://velocyto.org/velocyto.py/index.html</em></p></span><span><span>[7]</span><p>bustools: <em>https://bustools.github.io/BUS_notebooks_R/velocity.html</em></p></span><span><span>[8]</span><p>alevin: <em>https://combine-lab.github.io/alevin-fry-tutorials/2021/alevin-fry-velocity/</em></p></span><span><span>[9]</span><p><span>CellDimPlot</span>: <em>https://zhanghao-njmu.github.io/SCP/reference/CellDimPlot.html</em></p></span><span><span>[10]</span><p><span>CellStatPlot</span>: <em>https://zhanghao-njmu.github.io/SCP/reference/CellStatPlot.html</em></p></span><span><span>[11]</span><p><span>FeatureStatPlot</span>: <em>https://zhanghao-njmu.github.io/SCP/reference/FeatureStatPlot.html</em></p></span><span><span>[12]</span><p><span>GroupHeatmap</span>: <em>https://zhanghao-njmu.github.io/SCP/reference/GroupHeatmap.html</em></p></span></section></section><section><section data-style-type="5" data-tools="新媒体排版" data-id="2440476"><section><section><section><section><img data-ratio="0.9495798319327731" data-src="https://mmbiz.qpic.cn/mmbiz_gif/09gp6SvPE04j3m2v7Hr889icHUyibTOHs8YuUibicl7ibRD0ZwG5pDTjBluRreZvuib1o3BibvLkicYhnA4YW7dQsjn0cA/640?wx_fmt=gif" data-type="gif" data-w="119" data-width="100%" src="https://mmbiz.qpic.cn/mmbiz_gif/09gp6SvPE04j3m2v7Hr889icHUyibTOHs8YuUibicl7ibRD0ZwG5pDTjBluRreZvuib1o3BibvLkicYhnA4YW7dQsjn0cA/640?wx_fmt=gif"></section><section data-brushtype="text">往期回顾</section><section><br></section></section></section></section><section><section data-autoskip="1"><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247516307&amp;idx=1&amp;sn=f5239a1179f17fe5477200e6127e8bab&amp;chksm=ea1c8611dd6b0f07954ac24b18dad02e56f096d7b49f5c3d829cb4e6395b763f78e8ebd3e808&amp;scene=21#wechat_redirect" textvalue="SCP—为单细胞分析设计的端到端解决方案" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2"><span>SCP—为单细胞分析设计的端到端解决方案</span></a></p><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247516039&amp;idx=1&amp;sn=9a706da8bacc5801eae7a03b4ccc5c36&amp;chksm=ea1cb905dd6b3013a30c140a8c919b53cb61ce502b335700dbf17e91f09a70b845379255f99c&amp;scene=21#wechat_redirect" textvalue="端到端的单细胞管道SCP-安装" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2"><span>端到端的单细胞管道SCP-安装</span></a><br></p><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247516100&amp;idx=1&amp;sn=cb578bf6eebe3a6085b7341d26e08a32&amp;chksm=ea1cb946dd6b3050b8f4a25d63ed9fbff2bd1cbc7cf4cc46ccd8fe12ce196dbe8b716885dc24&amp;scene=21#wechat_redirect" textvalue="当 Transformer 遇见单细胞转录组——TOSICA" linktype="text" imgurl="" imgdata="null" data-itemshowtype="11" tab="innerlink" data-linktype="2"><span>当 Transformer 遇见单细胞转录组——TOSICA</span></a><br></p><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247516081&amp;idx=1&amp;sn=c6e00a1cff0613d26918f1df878e5995&amp;chksm=ea1cb933dd6b30255225e5c36324e8e7d571d8572f09cfefabc18f87a2c6a2209393dbc18e91&amp;scene=21#wechat_redirect" textvalue="单细胞分析揭示了葡萄膜黑色素瘤新的进化复杂性" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2"><span>单细胞分析揭示了葡萄膜黑色素瘤新的进化复杂性</span></a><br></p><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247515825&amp;idx=2&amp;sn=5122e66e005b04194ee21569d8c8245f&amp;chksm=ea1cb833dd6b312560d4da99a3ed73c7110d5ce84ae71bb8f9d3ab565de3f077521f0ff04ad0&amp;scene=21#wechat_redirect" textvalue="单细胞测序最好的教程（十）：万能的Transformer与细胞注释" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2"><span>单细胞测序最好的教程（十）：万能的Transformer与细胞注释</span></a><br></p></section></section><hr><p><br></p></section><section data-style-type="5" data-tools="新媒体排版" data-id="2440475"><hr><p><br></p><hr><section><p>如果你对单细胞转录组研究感兴趣，但又不知道如何入门，也许你可以关注一下下面的课程<span></span></p><p><br></p><ul><li><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247524240&amp;idx=1&amp;sn=94c9ef8c3d8080c30c8372d4fb5999ab&amp;chksm=9b4bdf2bac3c563def9232bb78f43bcaa13d7c3442b00cf83aaa32ae98f4500883fa8803fb98&amp;scene=21#wechat_redirect" textvalue="生信入门&amp;数据挖掘线上直播课9月班" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1">生信入门&amp;数据挖掘线上直播课9月班</a></p></li><li><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247524148&amp;idx=1&amp;sn=7806da6feb41a36493c519c1cfc1d3ac&amp;chksm=9b4bdf8fac3c569960369602f1ef26639cb366b250f233b2297d1f059471c0458335bfc0b829&amp;scene=21#wechat_redirect" textvalue="时隔5年，我们的生信技能树VIP学徒继续招生啦" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1">时隔5年，我们的生信技能树VIP学徒继续招生啦</a><br></p></li><li><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247519765&amp;idx=1&amp;sn=ce5a8c8182f854c88043059f8c2cb9ff&amp;chksm=9b4bceaeac3c47b88c19941d43dbb1401f3a92206481a0afc41159927868199643f795d62a7e&amp;scene=21#wechat_redirect" textvalue="千呼万唤始出来的独享生物信息学云服务器" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1">千呼万唤始出来的独享生物信息学云服务器</a></p></li></ul><p><img data-ratio="1" data-src="https://mmbiz.qpic.cn/mmbiz_gif/4TKeL1ZejtlKxOib5kmKX6ic6eX0w0WK5jvhtz9yBRsO3OI4yr6S5iaLNM7AbAeuPDHXMvDdur2DRz9wyiax4lEviag/640?wx_fmt=gif" data-type="gif" data-w="240" src="https://mmbiz.qpic.cn/mmbiz_gif/4TKeL1ZejtlKxOib5kmKX6ic6eX0w0WK5jvhtz9yBRsO3OI4yr6S5iaLNM7AbAeuPDHXMvDdur2DRz9wyiax4lEviag/640?wx_fmt=gif"><br></p><p><img data-ratio="0.05278592375366569" data-src="https://mmbiz.qpic.cn/mmbiz/4TKeL1Zejtlq03ZOSZiaTlic1MxgdKiaxTbOZ7ZSe0Xx1Ca8xF3L6Nyj1FYUajtYrSmRIHyZVSsAve0EAvEicZONpg/640?wx_fmt=jpeg" data-type="other" data-w="341" src="https://mmbiz.qpic.cn/mmbiz/4TKeL1Zejtlq03ZOSZiaTlic1MxgdKiaxTbOZ7ZSe0Xx1Ca8xF3L6Nyj1FYUajtYrSmRIHyZVSsAve0EAvEicZONpg/640?wx_fmt=jpeg"></p><p><strong><span>看完记得顺手点个</span></strong><span><strong><span>“在看”</span></strong></span><strong><span>哦！</span></strong></p></section><section><section data-id="93668"><section><section data-width="95%"><section><section><section data-width="38%"><section><section data-tools="135编辑器" data-id="93668"><section><section data-width="95%"><section><section><section data-width="61.8%"><section><section><section><p><br></p><span><strong data-burshtype="text"><img data-copyright="0" data-cropselx1="0" data-cropselx2="109" data-cropsely1="0" data-cropsely2="109" data-ratio="1" data-src="https://mmbiz.qpic.cn/mmbiz/siaia0BDGJdjRMGrkqo64BGKecYk4akuHpGHVQs7FeOpY7eWbIPGC1tRw5Tw0oEPmx053mR9FTVerWvhuZchIpZw/640?wx_fmt=jpeg" data-type="other" data-w="258" title="qrcode_for_gh_5a3c482ed99f_1280.jpg" src="https://mmbiz.qpic.cn/mmbiz/siaia0BDGJdjRMGrkqo64BGKecYk4akuHpGHVQs7FeOpY7eWbIPGC1tRw5Tw0oEPmx053mR9FTVerWvhuZchIpZw/640?wx_fmt=jpeg"><strong data-burshtype="text">生物</strong><strong data-burshtype="text"> | 单细胞 | 转录组丨资料</strong></strong></span></section><section><span><strong data-burshtype="text">每天都精彩</strong></span></section></section></section><section><section><section><section><section><section><p><span>长按扫码可关注</span></p></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/2IbHV-UB4bJtQnnTobZhzw",target="_blank" rel="noopener noreferrer">原文链接</a>
