---
title: "Nature图表复现｜双轴柱状与折线图"
date: 2023-09-17T14:02:48Z
draft: ["false"]
tags: [
  "fetched",
  "R语言数据分析指南"
]
categories: ["Acdemic"]
---
Nature图表复现｜双轴柱状与折线图 by R语言数据分析指南
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><h3 data-tool="mdnice编辑器"><span></span><span><span></span>欢迎关注R语言数据分析指南</span><span></span></h3><blockquote data-tool="mdnice编辑器"><span>❝</span><p>本节来复现<strong>「nature communications」</strong>中的一张论文图，<strong>「此图不算复杂只是在细节处要做颇多的调整」</strong>。下面小编通过一个案例来进行展示，图形仅供展示用过程仅参考，希望各位观众老爷能够喜欢。数据代码已经整合上传到2023VIP交流群，加群的观众老爷可自行下载，有需要的朋友可关注文末介绍加入VIP交流群</p><span>❞</span></blockquote><h3 data-tool="mdnice编辑器"><span></span><span><span></span>关注下方公众号下回更新不迷路</span><span></span></h3><section><mp-common-profile data-pluginname="mpprofile" data-id="Mzg3MzQzNTYzMw==" data-headimg="http://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZF0rpeZII9Ltl26VbVagriczTria1fib3XgjwwHEHFjPzkmGpqWDVVHBSzhENictUM2iavAKiaM5lc9USw/0?wx_fmt=png" data-nickname="R语言数据分析指南" data-alias="YanJANtwo" data-signature="R语言重症爱好者，喜欢绘制各种精美的图表，喜欢的小伙伴可以关注我，跟我一起学习" data-from="0" data-is_biz_ban="0"></mp-common-profile></section><h3 data-tool="mdnice编辑器"><span></span><span><span></span>论文</span><span></span></h3><figure data-tool="mdnice编辑器"><img data-ratio="0.35648148148148145" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAanhicLJ084WH58vLhCY2Z3Ws94Fa3YmsImjpFIKfkoaxOxPvpVBZQvEX9bQbXV1JNmjDsvic69QrHg/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAanhicLJ084WH58vLhCY2Z3Ws94Fa3YmsImjpFIKfkoaxOxPvpVBZQvEX9bQbXV1JNmjDsvic69QrHg/640?wx_fmt=png"></figure><h3 data-tool="mdnice编辑器"><span></span><span><span></span>论文原图</span><span></span></h3><figure data-tool="mdnice编辑器"><img data-ratio="0.36666666666666664" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAanhicLJ084WH58vLhCY2Z3W280qJFHYY4tIf9TOzhjCbpQhJ74ibCXj4k5UAADG7H0LcibHUvNlicdkw/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAanhicLJ084WH58vLhCY2Z3W280qJFHYY4tIf9TOzhjCbpQhJ74ibCXj4k5UAADG7H0LcibHUvNlicdkw/640?wx_fmt=png"></figure><h3 data-tool="mdnice编辑器"><span></span><span><span></span>图形解读</span><span></span></h3><blockquote data-tool="mdnice编辑器"><span>❝</span><p>此图的绘制不算难，难点在于各部分线条、字体、颜色、间距以及添加辅助刻度条，当然这些设置都可以在theme里面轻松完成，只是过程颇为繁琐。</p><span>❞</span></blockquote><h3 data-tool="mdnice编辑器"><span></span><span><span></span>加载R包</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code><span>library</span>(tidyverse)<br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span><span></span>导入数据</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code>gdp &lt;- read_tsv(<span>"data.tsv"</span>)<br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span><span></span>数据清洗</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code>df &lt;- gdp %&gt;% filter(continent==<span>"Africa"</span>) %&gt;% <br>  select(1,3,4,6) %&gt;% mutate(year=as.character(year))<br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span><span></span>数据可视化</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code>ggplot() +<br>  <span># 使用stat_summary()添加预期寿命（lifeExp）的平均值柱状图</span><br>  stat_summary(data=df, aes(year, lifeExp), fun = <span>"mean"</span>, geom = <span>"bar"</span>, alpha = <span>0.7</span>, fill=<span>"#00A08A"</span>) +<br>  <span># 添加预期寿命（lifeExp）的误差条</span><br>  stat_summary(data=df, aes(year, lifeExp), fun.data = <span>"mean_cl_normal"</span>, geom = <span>"errorbar"</span>, width = <span>.2</span>, color=<span>"#00A08A"</span>) +<br>  <span># 添加人均GDP（gdpPercap）的误差条</span><br>  stat_summary(data=df %&gt;% mutate(gdpPercap=gdpPercap/<span>20</span>), aes(year, gdpPercap), fun = mean, geom = <span>"errorbar"</span>, width=<span>.2</span>, color=<span>"#F98400"</span>,<br>               fun.max = <span>function</span>(x) mean(x) + sd(x) / sqrt(length(x)),<br>               fun.min = <span>function</span>(x) mean(x) - sd(x) / sqrt(length(x))) +<br>  <span># 添加人均GDP（gdpPercap）的平均值点</span><br>  stat_summary(data=df %&gt;% mutate(gdpPercap=gdpPercap/<span>20</span>), aes(year, gdpPercap), fun = <span>"mean"</span>, geom = <span>"point"</span>, size=<span>3</span>, color=<span>"#F98400"</span>) +<br>  <span># 添加人均GDP（gdpPercap）的平均值线</span><br>  stat_summary(data=df %&gt;% mutate(gdpPercap=gdpPercap/<span>20</span>), aes(year, gdpPercap, group=<span>1</span>), fun = <span>"mean"</span>, geom = <span>"line"</span>, color=<span>"#F98400"</span>) +<br>  <span># 设置y轴的比例和标签</span><br>  scale_y_continuous(expand = c(<span>0</span>, <span>1</span>), breaks = scales::pretty_breaks(n = <span>12</span>),<br>                     sec.axis = sec_axis(~. * <span>20</span>, breaks = scales::pretty_breaks(n = <span>12</span>),<br>                                         name = <span>"gdpPercap"</span>)) +<br>  <span># 应用主题</span><br>  theme_test() +<br>  <span># 自定义主题设置</span><br>  theme(panel.background = element_blank(),<br>        axis.ticks.length.x.bottom = unit(-<span>0.05</span>, <span>"in"</span>),<br>        axis.ticks.length.y.left = unit(-<span>0.05</span>, <span>"in"</span>),<br>        axis.ticks.length.y.right = unit(-<span>0.05</span>, <span>"in"</span>),<br>        axis.line.y.left = element_line(color=<span>"#00A08A"</span>),<br>        axis.line.y.right = element_line(color=<span>"#F98400"</span>),<br>        axis.line.x.bottom = element_line(color=<span>"black"</span>),<br>        axis.line.x.top = element_line(color=<span>"grey80"</span>),<br>        axis.text.y.right = element_text(color=<span>"#F98400"</span>, margin = margin(l = <span>5</span>, r = <span>10</span>)),<br>        axis.text.y.left = element_text(color=<span>"#00A08A"</span>, margin = margin(l = <span>10</span>, r = <span>5</span>)),<br>        axis.title.y.left = element_text(color=<span>"#00A08A"</span>, face=<span>"bold"</span>),<br>        axis.title.y.right = element_text(color=<span>"#F98400"</span>, face=<span>"bold"</span>),<br>        axis.title.x.bottom = element_blank())<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.3287037037037037" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAanhicLJ084WH58vLhCY2Z3Wbxy9pVicflHOsk8e9GtM6EKyAwS2LJgmu7yxJ59ZYwKr8LawdibLDXqQ/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAanhicLJ084WH58vLhCY2Z3Wbxy9pVicflHOsk8e9GtM6EKyAwS2LJgmu7yxJ59ZYwKr8LawdibLDXqQ/640?wx_fmt=png"></figure><blockquote data-tool="mdnice编辑器"><span>❝</span><p>本节内容介绍到此结束，过程仅供参考；有需要学习个性化数据可视化的朋友，欢迎到小编的<strong>「淘宝店铺」</strong> <strong>「R语言数据分析指南」</strong>购买<strong>「2023年度会员文档」</strong>同步更新中<strong>「售价149元」</strong>，内容主要包括各种<strong>「高分论文的图表分析复现以及一些个性化图表的绘制」</strong>均包含数据+代码；按照往年数据小编年产出约在150+以上</p><span>❞</span></blockquote><p data-tool="mdnice编辑器">购买后微信发小编订单截图即邀请进新的会员交流群，小编的文档为按年售卖，只包含当年度的<strong>「除系列课程外」</strong>的文档，有需要往年文档的朋友也可下单购买，需要了解更多信息的朋友欢迎交流咨询。</p><h3 data-tool="mdnice编辑器"><span></span><span><span></span>淘宝扫一扫</span><span></span></h3><figure data-tool="mdnice编辑器"><img data-ratio="1.6141479099678457" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAanhicLJ084WH58vLhCY2Z3WTBDL4HOVUUFia6jd5viaGCrL2A3ssLRupKeiaMerBvb0YKthFdgGzdAVA/640?wx_fmt=png" data-type="png" data-w="622" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAanhicLJ084WH58vLhCY2Z3WTBDL4HOVUUFia6jd5viaGCrL2A3ssLRupKeiaMerBvb0YKthFdgGzdAVA/640?wx_fmt=png"></figure><h3 data-tool="mdnice编辑器"><span></span><span><span></span>2023会员群案例展示</span><span></span></h3><p data-tool="mdnice编辑器"><img data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAanhicLJ084WH58vLhCY2Z3WH19k7m7eA98iagCSTibAd5U9CwrYpV7psh9dDwKJMfm82ibeEvoBWIWOw/640?wx_fmt=png" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAanhicLJ084WH58vLhCY2Z3WH19k7m7eA98iagCSTibAd5U9CwrYpV7psh9dDwKJMfm82ibeEvoBWIWOw/640?wx_fmt=png"><img data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAanhicLJ084WH58vLhCY2Z3WEicoAErO5RBLHNUj3doTpNicYI2N9TrbS9Y60bENoA1lO6mibVl0skCag/640?wx_fmt=png" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAanhicLJ084WH58vLhCY2Z3WEicoAErO5RBLHNUj3doTpNicYI2N9TrbS9Y60bENoA1lO6mibVl0skCag/640?wx_fmt=png"><img data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAanhicLJ084WH58vLhCY2Z3WB1O3bI4RU1NWYrjiaXMluv65bVaWSpKWwx0PItmAkuxGo8W3WDUnZIQ/640?wx_fmt=png" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAanhicLJ084WH58vLhCY2Z3WB1O3bI4RU1NWYrjiaXMluv65bVaWSpKWwx0PItmAkuxGo8W3WDUnZIQ/640?wx_fmt=png"><img data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAanhicLJ084WH58vLhCY2Z3WibKxQSY6zWC01js0Jaia2micic6g1JHawtRVuvr8JZuDTDFCLtArcqDP0Q/640?wx_fmt=png" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAanhicLJ084WH58vLhCY2Z3WibKxQSY6zWC01js0Jaia2micic6g1JHawtRVuvr8JZuDTDFCLtArcqDP0Q/640?wx_fmt=png"><img data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAanhicLJ084WH58vLhCY2Z3WVoM2aT0yJvvIKuPljKo0TicwJPenkzUzngZJdR2J7jxQshcmWz4PIKg/640?wx_fmt=png" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAanhicLJ084WH58vLhCY2Z3WVoM2aT0yJvvIKuPljKo0TicwJPenkzUzngZJdR2J7jxQshcmWz4PIKg/640?wx_fmt=png"><img data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAanhicLJ084WH58vLhCY2Z3W6iaibLLMJCb8mbb4Wv9rPmR5p9mq7owG0Kz0ZymaoRguwOU9ZKjOHJWg/640?wx_fmt=png" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAanhicLJ084WH58vLhCY2Z3W6iaibLLMJCb8mbb4Wv9rPmR5p9mq7owG0Kz0ZymaoRguwOU9ZKjOHJWg/640?wx_fmt=png"><img data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAanhicLJ084WH58vLhCY2Z3Wbool3JrgFv5dwdEfxZ6KicArQsXicR07s9QqhUfk4KicbDty6icKs8Ir9w/640?wx_fmt=png" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAanhicLJ084WH58vLhCY2Z3Wbool3JrgFv5dwdEfxZ6KicArQsXicR07s9QqhUfk4KicbDty6icKs8Ir9w/640?wx_fmt=png"><img data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAanhicLJ084WH58vLhCY2Z3WLicM90zIzsbrrIv9WqSqm7s82yVVK1ZL41mxqic3CdFAdeN73RUFUJzA/640?wx_fmt=png" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAanhicLJ084WH58vLhCY2Z3WLicM90zIzsbrrIv9WqSqm7s82yVVK1ZL41mxqic3CdFAdeN73RUFUJzA/640?wx_fmt=png"><img data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAanhicLJ084WH58vLhCY2Z3W9ib3MFuhlmXicafQvFutAPJBjblfelzfkjVpe53Kpao96pYibKvGxIehQ/640?wx_fmt=png" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAanhicLJ084WH58vLhCY2Z3W9ib3MFuhlmXicafQvFutAPJBjblfelzfkjVpe53Kpao96pYibKvGxIehQ/640?wx_fmt=png"></p></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/pLaDhBNRxp3oHl0-ZdBRag",target="_blank" rel="noopener noreferrer">原文链接</a>
