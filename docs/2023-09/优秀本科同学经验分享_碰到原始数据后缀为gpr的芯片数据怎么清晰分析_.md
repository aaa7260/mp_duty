---
title: "优秀本科同学经验分享：碰到原始数据后缀为gpr的芯片数据怎么清晰分析？"
date: 2023-09-04T03:45:52Z
draft: ["false"]
tags: [
  "fetched",
  "生信作曲家"
]
categories: ["Acdemic"]
---
优秀本科同学经验分享：碰到原始数据后缀为gpr的芯片数据怎么清晰分析？ by 生信作曲家
------
<div><section><h3><span>前言</span></h3><blockquote><p><span></span><span>生信作曲家一直致力于构建国内</span><span><strong>和谐、开放、可持续</strong></span><span><strong>的生物信息交流平台</strong>。生信作曲家的目标是<strong>为每个科研人扫清科研路上的一切障碍，让生物信息学人人可做</strong>。目前，生信作曲家已推出</span><span><strong>"</strong><strong>跟着一区文章学通机器学习</strong><strong>"</strong></span><span>，<strong>"</strong><strong>跟着一区文章学通单细胞</strong><strong>"</strong><strong>，Bootstrap，CIBERSORTx, NTP, TICPE，metaVIPER算法</strong></span><span>等多种强力教程，同时也兼具</span><strong><span>GEO数据库</span></strong><span>，</span><span><strong>ICGC数据库</strong></span><span>数据整理等核心入门技术教学，开办</span><span><strong>暑期</strong></span><span><strong>发文计划max,ultra，7天发文A计划</strong><strong>，五一创新发文计划pro</strong></span><span><strong>，生信中秋分享会、小年夜分享会、暑期集训营和冬季集训营</strong>等多次。辅导同学实现纯生信SCI发表硕果累累，帮助同学实现医学事业路上的理想与追求。</span><span></span></p></blockquote><p>今天我们遇到的数据是：<code>GSE45403</code></p><p>GSE45403</p><p>可以看到这是一个双杂交芯片，如果我们直接去<code>Series Matrix File</code>下载矩阵文件，会得到一堆<strong>负值</strong>的表达矩阵 ，这肯定是不正常的，也就是说我们<strong>不能直接</strong>利用这个矩阵做相关的下游分析，那针对这个问题又该如何处理呢？</p><figure><img data-ratio="0.17256637168141592" data-src="https://mmbiz.qpic.cn/mmbiz_png/mo60jlFOtaDTYupQTvnukXBVjmAF7fvibHUgQmn48ldNTFOnLl2prIQp56OCjAknkvnN6HpxOnfSVcxp1RPFcCw/640?wx_fmt=png" data-type="png" data-w="1356" title="" src="https://mmbiz.qpic.cn/mmbiz_png/mo60jlFOtaDTYupQTvnukXBVjmAF7fvibHUgQmn48ldNTFOnLl2prIQp56OCjAknkvnN6HpxOnfSVcxp1RPFcCw/640?wx_fmt=png"></figure><figure><img data-ratio="0.17729257641921398" data-src="https://mmbiz.qpic.cn/mmbiz_png/mo60jlFOtaDTYupQTvnukXBVjmAF7fvibEiazmwqlwfys5PYgEQrQfiaFTwGIIibpLglQcanrzWrHCnmzvp8KmsZjA/640?wx_fmt=png" data-type="png" data-w="1145" title="" src="https://mmbiz.qpic.cn/mmbiz_png/mo60jlFOtaDTYupQTvnukXBVjmAF7fvibEiazmwqlwfys5PYgEQrQfiaFTwGIIibpLglQcanrzWrHCnmzvp8KmsZjA/640?wx_fmt=png"></figure><p><br></p><figure><img data-ratio="0.5725925925925925" data-src="https://mmbiz.qpic.cn/mmbiz_png/mo60jlFOtaDTYupQTvnukXBVjmAF7fvib8MmeJias9SmyTvxo4xfScib80qFyOjPT1YLd6yib5YRKhmGo79hkicIU2Q/640?wx_fmt=png" data-type="png" data-w="1350" title="" src="https://mmbiz.qpic.cn/mmbiz_png/mo60jlFOtaDTYupQTvnukXBVjmAF7fvib8MmeJias9SmyTvxo4xfScib80qFyOjPT1YLd6yib5YRKhmGo79hkicIU2Q/640?wx_fmt=png"></figure><p>既然处理过的不能用，想到这里，那我们就从<strong>原始数据</strong>开始处理。当我们下载<code>GSE45403_RAW.tar</code>的解压处理后会得到这样一堆文件。具体信息是：</p><ul><li><p>后缀为.gpr 的<strong>矩阵</strong>文件</p></li><li><p>后缀为.txt 的<strong>注释</strong>文件</p></li></ul><figure><img data-ratio="0.8160813308687616" data-src="https://mmbiz.qpic.cn/mmbiz_png/mo60jlFOtaDTYupQTvnukXBVjmAF7fvibz34UhBkicf9Bk9aGEdhSRePklxUMNtJaWYdlw6DT2waQEqw2UAlMp8w/640?wx_fmt=png" data-type="png" data-w="1082" title="" src="https://mmbiz.qpic.cn/mmbiz_png/mo60jlFOtaDTYupQTvnukXBVjmAF7fvibz34UhBkicf9Bk9aGEdhSRePklxUMNtJaWYdlw6DT2waQEqw2UAlMp8w/640?wx_fmt=png"></figure><p>这就有点懵逼了，没见过！！！！</p><hr><p>不慌，对于这样的数据，我们可以通过<code>limma</code>包进行处理，最终可以得到一个有利于我们进行下游分析的表达矩阵：</p><ul><li><p>通过<code>limma</code>包的<code>read.maimages</code>批量读取文件</p></li><li><p>标化处理 <code>backgroundCorrect</code>，<code>normalizeBetweenArrays</code></p></li><li><p>通过解压后得到的注释文件，获得基因<strong>Symbol</strong></p></li></ul><h4><span>1. 导入数据并标化</span></h4><pre><code><span>###########################路径准备###################</span><br>rm(list = ls())<span>#清空环境</span><br><span># 指定所以后缀为.gpr文件的路径，方便read.maimages读取</span><br>files &lt;- list.files(<span>"../input_data/GSE45403_RAW/"</span>,<br>                    pattern = <span>".gpr"</span>)<br><br>path &lt;- paste0(<span>"../input_data/GSE45403_RAW/"</span>,<br>               files)<br><br><span>###########################读取文件###################</span><br><span>library</span>(limma)<br>RG=read.maimages(files=path,<span>source</span>=<span>"genepix"</span>) <span>#读取文件</span><br>RG &lt;- backgroundCorrect(RG, method=<span>"normexp"</span>) <span>#背景校正</span><br>MA &lt;- normalizeBetweenArrays(RG) <span>#归一化</span><br>exprSet=as.data.frame(MA$A) <span>#获得表达矩阵</span><br>max(exprSet) <span>#查看下最大值</span><br>boxplot(exprSet)<span>#查看下整体分布</span><br></code></pre><hr><h4><span>2. 修改列命和基因注释</span></h4><figure><img data-ratio="0.4210144927536232" data-src="https://mmbiz.qpic.cn/mmbiz_png/mo60jlFOtaDTYupQTvnukXBVjmAF7fvibYFM0BOcYMs0m7ibnE1MuOZzu4C8RBuo0vxqLZtCxquia9dnFE96MFHicA/640?wx_fmt=png" data-type="png" data-w="1380" title="" src="https://mmbiz.qpic.cn/mmbiz_png/mo60jlFOtaDTYupQTvnukXBVjmAF7fvibYFM0BOcYMs0m7ibnE1MuOZzu4C8RBuo0vxqLZtCxquia9dnFE96MFHicA/640?wx_fmt=png"></figure>{width="462"}<p><br></p><p>这是我们刚才得到的表达矩阵，差点啥？</p><ul><li><p>改下列名基因名</p></li><li><p>基因名</p></li></ul><blockquote><p>注意：这里需要我们<strong>手动做一个分组文件</strong>，方便我们后续操作（也可以通过pData()来获取）。针对这个数据，我做的这样的：</p><figure><img data-ratio="1.397196261682243" data-src="https://mmbiz.qpic.cn/mmbiz_png/mo60jlFOtaDTYupQTvnukXBVjmAF7fviboibdKBV5kYuwiaAKicmicqTz5ZibEgmNOicGb34SbkRsP7ib5l6xMohL1rVvA/640?wx_fmt=png" data-type="png" data-w="428" title="" src="https://mmbiz.qpic.cn/mmbiz_png/mo60jlFOtaDTYupQTvnukXBVjmAF7fviboibdKBV5kYuwiaAKicmicqTz5ZibEgmNOicGb34SbkRsP7ib5l6xMohL1rVvA/640?wx_fmt=png"></figure>{width="175"}<p><br></p></blockquote><pre><code><span>library</span>(tidyverse)<br><br><span># 读取注释信息(解压后得到的后缀为.txt的文件)</span><br>annotation &lt;- data.table::fread(<span>"../input_data/GSE45403_RAW/GPL4133_old_annotations.txt"</span>,data.table = <span>F</span>,skip=<span>'ID'</span>)<br><br><span># 读取分组信息</span><br>group_list &lt;- read.table(<span>"../input_data/group_list.txt"</span>)<br><br><span>#列名注释</span><br>group_list$V1 <br><br><span>############################1. 修改表达矩阵列名##################################</span><br><span># 重改列名</span><br>colnames(exprSet) &lt;- group_list$V1<br></code></pre><h4><span>在经过生信作曲家常见的ID转换方案，就得到了我们心心念念的表达矩阵啦~~~</span></h4><figure><img data-ratio="0.5336658354114713" data-src="https://mmbiz.qpic.cn/mmbiz_png/mo60jlFOtaDTYupQTvnukXBVjmAF7fvibGx9r91icIsiaAE9eEup911ibKqUehev6ncU9KOuZYn0SrMNoRE2khmPZA/640?wx_fmt=png" data-type="png" data-w="1203" title="" src="https://mmbiz.qpic.cn/mmbiz_png/mo60jlFOtaDTYupQTvnukXBVjmAF7fvibGx9r91icIsiaAE9eEup911ibKqUehev6ncU9KOuZYn0SrMNoRE2khmPZA/640?wx_fmt=png"></figure><h3><span>后记</span></h3><p>交流更多，添加管理员 备注 加群</p><p><img data-ratio="1" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/mo60jlFOtaB9Vq4TQbMtR81HOfuhy7jkZsUypgwNYHTiaEFuvXNqI8z2nlDYc7tbrJ4o7W7dAgqRQPp2lDqfLbA/640?wx_fmt=png" data-type="png" data-w="512" src="https://mmbiz.qpic.cn/mmbiz_png/mo60jlFOtaB9Vq4TQbMtR81HOfuhy7jkZsUypgwNYHTiaEFuvXNqI8z2nlDYc7tbrJ4o7W7dAgqRQPp2lDqfLbA/640?wx_fmt=png"></p><p><br></p></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/9ehY6_QjxkLJSsijOmdSiQ",target="_blank" rel="noopener noreferrer">原文链接</a>
