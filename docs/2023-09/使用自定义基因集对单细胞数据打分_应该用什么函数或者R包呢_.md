---
title: "使用自定义基因集对单细胞数据打分，应该用什么函数或者R包呢？"
date: 2023-09-28T04:41:15Z
draft: ["false"]
tags: [
  "fetched",
  "生信菜鸟团"
]
categories: ["Acdemic"]
---
使用自定义基因集对单细胞数据打分，应该用什么函数或者R包呢？ by 生信菜鸟团
------
<div><p cid="n819" mdtype="paragraph"><span md-inline="plain">群里小伙伴在前几天有提到这个问题，想了一下我的确没写过相关的推文，但是我发现相关的推文在微信公众号上还是能搜索到不少的。我来写个总结性的推文吧~</span></p><p cid="n819" mdtype="paragraph"><span md-inline="plain"></span><span md-inline="softbreak"></span><span md-inline="image" data-src="https://hanyue-1313320820.cos.ap-guangzhou.myqcloud.com/202309272013419.png"><img data-ratio="0.39577836411609496" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicMJWTvrSjGs9eDBHEURNqTkRZXbibO0LSeiaHX8JCxC8kAvdT1GOOOKxdsv8Js6tcQmsrjPkKO3bGw/640?wx_fmt=png" data-type="png" data-w="758" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicMJWTvrSjGs9eDBHEURNqTkRZXbibO0LSeiaHX8JCxC8kAvdT1GOOOKxdsv8Js6tcQmsrjPkKO3bGw/640?wx_fmt=png"></span></p><p cid="n820" mdtype="paragraph">使用自定义基因集对单细胞数据打分常常是为了深入分析单细胞数据用到，像由于测序深度不足而导致某些基因表达量低或者是某些基因并没有表达。当然现在有很多文章数据分析用到整合多样本，本身就会产生的批次效应，也需要寻找合适的基因富集方法。<strong>在bulk-RNA-seq中我们也会用到富集的方法（GO, KEGG富集等等），都有异曲同工之处，利用相似原理的算法来计算得到基因之间相互联系的结果。</strong><br></p><p cid="n821" mdtype="paragraph"><span md-inline="plain">目前针对单细胞数据基因集打分有不同的R包和多种函数</span></p><pre spellcheck="false" lang="r " cid="n822" mdtype="fences"><span role="presentation"><span>GSEA</span>、<span>GSVA</span>、<span>ssGSEA</span> <span>#这三个也常常用在bulk转录组的富集分析中</span></span><br><span role="presentation"><span>Pagoda2</span>、<span>Vision</span>、<span>PLAGE</span>、<span>Zscore</span>、<span>Seurat</span>包的<span>AddModuleScore</span>函数、</span><br><span role="presentation"><span>AUCell</span>、<span>UCell</span>和<span>singscore</span></span><br><span role="presentation"><span>scgmt</span>包</span></pre><h4 cid="n823" mdtype="heading"><span md-inline="plain">Pagoda2</span></h4><p cid="n824" mdtype="paragraph"><span md-inline="strong"><strong><span md-inline="url" spellcheck="false">https://github.com/kharchenkolab/pagoda2</span></strong></span></p><p cid="n825" mdtype="paragraph"><span md-inline="plain">一个用于分析和交互式探索大规模单细胞RNA-seq数据集的R包。这些方法经过优化，以快速处理现代scRNAseq数据集，这些数据集既大(大约1e6细胞或更大)又稀疏。该软件包提供了质量控制、过滤、聚类、可视化、差异表达、跨界方面/状态和基因集/通路过度离散分析的方法。</span></p><h4 cid="n826" mdtype="heading"><span md-inline="plain">Vision</span></h4><p cid="n827" mdtype="paragraph"><span md-inline="strong"><strong><span md-inline="url" spellcheck="false">https://github.com/YosefLab/VISION</span></strong></span></p><p cid="n828" mdtype="paragraph"><span md-inline="plain">Functional interpretation of single cell similarity maps | Nature Communications (</span><span md-inline="url" spellcheck="false">https://www.nature.com/articles/s41467-019-12235-0</span><span md-inline="plain">)</span></p><p cid="n829" mdtype="paragraph"><span md-inline="plain">Vision包对基因集打分是通过基因集取平均后，其中所有基因表达来计算的。</span></p><p cid="n830" mdtype="paragraph"><span md-inline="url" spellcheck="false"><a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247507596&amp;idx=1&amp;sn=1bae2446918825f2f171f8eb4ea44d0e&amp;scene=21#wechat_redirect" data-linktype="2">https://mp.weixin.qq.com/s/ohfMH6bUc7wN0EaWrcfN-g</a></span></p><h4 cid="n831" mdtype="heading"><span md-inline="plain">PLAGE、Zscore</span></h4><p cid="n832" mdtype="paragraph"><span md-inline="plain">需要基因表达矩阵归一化成标准数据。</span></p><h4 cid="n833" mdtype="heading"><span md-inline="plain">Seurat包的AddModuleScore函数</span></h4><p cid="n834" mdtype="paragraph"><span md-inline="plain">计算每个程序(集群)在单细胞水平上的平均表达水平，减去控制特征集的聚合表达。所有分析特征基于平均表达式进行分类，并从每个分类中随机选择控制特征。</span></p><h4 cid="n835" mdtype="heading"><span md-inline="plain">AUCell</span></h4><p cid="n836" mdtype="paragraph"><span md-inline="plain">基于单个样本中的基因表达排名,使用曲线下的面积来评估输入基因集是否在单个样本的前5%表达基因内富集。</span></p><h4 cid="n837" mdtype="heading"><span md-inline="plain">UCell</span></h4><p cid="n838" mdtype="paragraph"><span md-inline="plain">也是基于单个样本中的基因表达排名，是一个基于Mann-Whitney U统计量评估单细胞数据集中基因标签的软件包。它可以应用于任何单细胞数据矩阵，并包括与SingleCellExperiment和Seurat对象交互的函数。</span></p><h4 cid="n839" mdtype="heading"><span md-inline="plain">singscore</span></h4><p cid="n840" mdtype="paragraph"><span md-inline="plain">也是一个R包，它实现了Foroutan等人(2018)和Bhuva等人(2020)提出的简单的单样本基因集(或基因标签)评分方法。它使用基于秩的统计分析每个样本的基因表达谱，并在单样本水平上对基因集的表达活动进行评分。</span></p><h4 cid="n841" mdtype="heading"><span md-inline="plain">scgmt包</span></h4><p cid="n842" mdtype="paragraph"><span md-inline="plain">作者原文：</span><span md-inline="strong"><strong><span md-inline="plain">[单细胞基因集合打分方法]</span><span md-inline="url" spellcheck="false"><a href="https://mp.weixin.qq.com/s?__biz=Mzg2MzE4NDg5NQ==&amp;mid=2247485168&amp;idx=1&amp;sn=2936595422a6bf0ed1373b5ba6276d99&amp;scene=21#wechat_redirect" data-linktype="2">https://mp.weixin.qq.com/s/YW5bIhq86jwDPqW-p6-EWA</a></span></strong></span></p><p cid="n843" mdtype="paragraph"><span md-inline="plain">这个R包旨在整合多种基于单细胞秩次的基因集富集分析方法，并将结果整合为标准化格式，以存储在Seurat对象的元数据。</span></p><p cid="n844" mdtype="paragraph"><strong><span>irGSEA包</span></strong></p><p cid="n845" mdtype="paragraph"><span md-inline="plain">除了上述的函数和包之外还有一个考察了多种算法然后选取了基于单个样本的基因表达排名的基因集分析方法：AUCell、UCell和singscore整合成的R包：irGSEA包  </span><span md-inline="url" spellcheck="false">https://github.com/chuiqin/irGSEA/</span></p><p cid="n846" mdtype="paragraph"><span md-inline="strong"><strong><span md-inline="plain">8种方法可视化你的单细胞基因集打分 </span><span md-inline="url" spellcheck="false"><a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247507596&amp;idx=1&amp;sn=1bae2446918825f2f171f8eb4ea44d0e&amp;scene=21#wechat_redirect" data-linktype="2">https://mp.weixin.qq.com/s/ohfMH6bUc7wN0EaWrcfN-g</a></span></strong></span></p><p cid="n847" mdtype="paragraph"><span md-inline="plain">同时该R包也内置了多种可视化的函数。</span></p><p cid="n848" mdtype="paragraph"><span md-inline="plain">##########</span></p><p cid="n848" mdtype="paragraph"><span md-inline="plain">要选择哪个打分函数和R包要根据单细胞数据格式及要求来选择。</span></p><h4 cid="n849" mdtype="heading"><span>在此还没有具体的展示各个包和函数的具体用法，之后如果大家感兴趣的话可以陆续出一下相关的推文。</span></h4><p><span>##########<br></span></p><h3 cid="n850" mdtype="heading"><span md-inline="plain">微信交流群</span></h3><p cid="n851" mdtype="paragraph"><span md-inline="plain">如果你也想参与到群里的讨论中，给我提出一些推文更新建议的话欢迎入群。同时你也可以得到我前期更新的所有数据及代码，在群里我会把代码分享给大家，而且大家可以在群里「提出自己感兴趣的单细胞文献」</span><span md-inline="strong"><strong>我们尽可能优先选择大家的数据集去复现和实战，也欢迎大家在群里分享更多其它资料，咱们一起进步，</strong></span><span md-inline="plain">「比较高级的单细胞分析」**我们也会一起尝试， 相信你肯定是会不虚此行哈。</span></p><p cid="n852" mdtype="paragraph"><span md-inline="plain">附上之前推文的链接 </span><span md-inline="link"><a spellcheck="false" href="https://mp.weixin.qq.com/s?__biz=MzUzMTEwODk0Ng==&amp;mid=2247512238&amp;idx=1&amp;sn=e0c6dc2ea0e089aabb78133e50fb5d7f&amp;scene=21#wechat_redirect" data-linktype="2"><span md-inline="plain">为爱发电不可取（单细胞周更需要你的支持）</span></a></span></p><p cid="n853" mdtype="paragraph"><span md-inline="strong"><strong>「目前群里已经有300多人，所以你想要进群的话就需要添加我的微信，私聊给我发99元的红包，我把你拉进群里。」</strong></span></p><p cid="n854" mdtype="paragraph"><span md-inline="plain">我们这个群是真正的付费交流群，提供数据，代码，学习资料，也会跟大家互动交流，还会坚持进行创作至少一年。如果介意99元的门槛且不认可我们知识分享的理念，</span><span md-inline="strong"><strong>请不要加我好友</strong></span><span md-inline="plain">。。</span></p><p cid="n855" mdtype="paragraph"><span md-inline="image" data-src="https://hanyue-1313320820.cos.ap-guangzhou.myqcloud.com/202307061012474.png"><img data-ratio="1" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicMJWTvrSjGs9eDBHEURNqTh7xgclyNNOZ1zdX2pPY25mGCZtn5Wibpvlvb2qF6EVWWzqbx2FS5tTQ/640?wx_fmt=png" data-type="png" data-w="172" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicMJWTvrSjGs9eDBHEURNqTh7xgclyNNOZ1zdX2pPY25mGCZtn5Wibpvlvb2qF6EVWWzqbx2FS5tTQ/640?wx_fmt=png"></span></p><p cid="n856" mdtype="paragraph"><br></p><p cid="n857" mdtype="paragraph"><br></p><p><br></p><p><mp-style-type data-value="10000"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/HMyeyljR_klbetHu9jdQ7Q",target="_blank" rel="noopener noreferrer">原文链接</a>
