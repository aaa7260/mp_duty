---
title: "复现science/nature相关性热图（文末免费包邮送书）"
date: 2023-09-07T01:44:56Z
draft: ["false"]
tags: [
  "fetched",
  "气象水文科研猫"
]
categories: ["Acdemic"]
---
复现science/nature相关性热图（文末免费包邮送书） by 气象水文科研猫
------
<div><p data-mpa-powered-by="yiban.io"><span><strong><span>一、往期相关性热图推文回顾：</span></strong></span><span><br></span></p><p><span><strong><span>1.</span></strong></span><span><strong><span>《</span></strong></span><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzIwODY3MzIxMQ==&amp;mid=2247491845&amp;idx=1&amp;sn=7dbf6c76c3fc27bb8b84eb41bd2cbe25&amp;chksm=977d21d1a00aa8c7c462cccf2b4b09606c10a67497c3a426b6ee6d9e9a88ff5c18b148a2c0ad&amp;token=46187525&amp;lang=zh_CN&amp;scene=21#wechat_redirect" textvalue="免费开源Python和R成为科研主流" linktype="text" imgurl="" imgdata="null" tab="innerlink" data-linktype="2"><span><strong><span>免费开源Python和R成为科研主流</span></strong></span></a><span><strong><span>》</span></strong></span><span><strong><span><br>2.</span></strong></span><span><strong><span>《</span></strong></span><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzIwODY3MzIxMQ==&amp;mid=2247484625&amp;idx=1&amp;sn=07ccc383e9503c8aedd3540de73cdde2&amp;chksm=977ec405a0094d133795e262bd02ab9de9e2022d9e57d44687883f116ad311cac88a87517a91&amp;token=46187525&amp;lang=zh_CN&amp;scene=21#wechat_redirect" textvalue="又谈ggplot分面地图" linktype="text" imgurl="" imgdata="null" tab="innerlink" data-linktype="2"><span><strong><span>又谈ggplot分面地图</span></strong></span></a><span><strong><span>》</span></strong></span></p><p><span><strong><span>3.</span></strong></span><span><strong><span>《</span></strong></span><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzIwODY3MzIxMQ==&amp;mid=2247485038&amp;idx=1&amp;sn=45da0777aed697585ff52e0d964d2337&amp;chksm=977ec6baa0094facee11f48ba99eea2184aaa21b5846023f524eb4e50ddc700c6c9ed9516af8&amp;token=46187525&amp;lang=zh_CN&amp;scene=21#wechat_redirect" textvalue="R语言克里金插值（四）" linktype="text" imgurl="" imgdata="null" tab="innerlink" data-linktype="2"><span><strong><span>R语言克里金插值（四）</span></strong></span></a><span><strong><span>》</span></strong></span></p><p><span><strong><span>4.</span></strong></span><span><strong><span>《</span></strong></span><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzIwODY3MzIxMQ==&amp;mid=2247485299&amp;idx=1&amp;sn=d70409dc2f2e45b470ab265e814e070f&amp;chksm=977ec7a7a0094eb100fa45b944e75c93d753d3074d391c6b727deb260e1ac363cf91d07a886c&amp;token=46187525&amp;lang=zh_CN&amp;scene=21#wechat_redirect" textvalue="R语言热图（完）" linktype="text" imgurl="" imgdata="null" tab="innerlink" data-linktype="2"><span><strong><span>R语言热图（完）</span></strong></span></a><span><strong><span>》</span></strong></span></p><p><span><strong><span>二、安装使用linkET包</span></strong></span></p><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><pre data-tool="mdnice编辑器"><span></span><code>install.packages(<span>"devtools"</span>)<br>library(devtools)<br>devtools::install_github(<span>"Hy4m/linkET"</span>,force=TRUE)<br>packageVersion(<span>"linkET"</span>)<br>library(linkET)<br><span>## matrix_data</span><br>matrix_data(list(mtcars = mtcars))<br><span>## md_tbl</span><br>matrix_data(list(mtcars = mtcars)) %&gt;% <br>  as_md_tbl()<br><span>## as method</span><br>as_matrix_data(mtcars)<br>as_md_tbl(mtcars)<br><span>## special function for correlation matrix</span><br>correlate(mtcars) %&gt;% <br>  as_matrix_data()<br>correlate(mtcars) %&gt;% <br>  as_md_tbl()<br><span># 1 Heatmap</span><br>library(ggplot2)<br>matrix_data(list(mtcars = mtcars)) %&gt;% <br>  hyplot(aes(fill = mtcars)) +<br>  geom_tile()+<br>  scale_fill_gradientn(colours=rev(rainbow(100))) <br>as_md_tbl(mtcars) %&gt;% <br>  hyplot(aes(size = mtcars)) +<br>  geom_point(shape = 21, fill = NA)<br>correlate(mtcars) %&gt;% <br>  as_md_tbl() %&gt;% <br>  qcorrplot() +<br>  geom_square()+<br>  scale_fill_gradientn(colours=rev(rainbow(100)))<br>library(vegan)<br><span>#&gt; 载入需要的程辑包：permute</span><br><span>#&gt; 载入需要的程辑包：lattice</span><br><span>#&gt; This is vegan 2.5-7</span><br>data(<span>"varespec"</span>)<br>data(<span>"varechem"</span>)<br>correlate(varespec[1:30], varechem) %&gt;% <br>  qcorrplot() +<br>  geom_square() +<br>  scale_fill_gradientn(colours=rev(rainbow(100)))<br>qcorrplot(varespec[1:30], <span>type</span> = <span>"lower"</span>) +<br>  geom_square() +<br>  scale_fill_gradientn(colours=rev(rainbow(100)))<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.9222222222222223" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/VQj38bogwOJAbQotmoicBTBC3PWoQLkLb5c5c3dAuxl0xcCS0x997PmDibW1azKVsvCklOF9I5SibaX3GcLJ567WA/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/VQj38bogwOJAbQotmoicBTBC3PWoQLkLb5c5c3dAuxl0xcCS0x997PmDibW1azKVsvCklOF9I5SibaX3GcLJ567WA/640?wx_fmt=png"></figure><pre data-tool="mdnice编辑器"><span></span><code><span>## you can set your style</span><br>set_corrplot_style()<br>qcorrplot(mtcars) + geom_square()+scale_fill_gradientn(colours=rev(rainbow(100)))<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.850925925925926" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/VQj38bogwOJAbQotmoicBTBC3PWoQLkLb8NYddzibicLBY2k0eosxQQl0hZNvEShgOvR62SGuibF5NBPHs11GE2p5A/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/VQj38bogwOJAbQotmoicBTBC3PWoQLkLb8NYddzibicLBY2k0eosxQQl0hZNvEShgOvR62SGuibF5NBPHs11GE2p5A/640?wx_fmt=png"></figure><pre data-tool="mdnice编辑器"><span></span><code>library(dplyr)<br>data(<span>"varechem"</span>, package = <span>"vegan"</span>)<br>data(<span>"varespec"</span>, package = <span>"vegan"</span>)<br>mantel &lt;- mantel_test(varespec, varechem,spec_select = list(Spec01 = 1:7,Spec02 = 8:18,Spec03 = 19:37,Spec04 = 38:44)) %&gt;% <br>  mutate(rd = cut(r, breaks = c(-Inf, 0.2, 0.4, Inf),labels = c(<span>"&lt; 0.2"</span>, <span>"0.2 - 0.4"</span>, <span>"&gt;= 0.4"</span>)),<br>         pd = cut(p, breaks = c(-Inf, 0.01, 0.05, Inf),labels = c(<span>"&lt; 0.01"</span>, <span>"0.01 - 0.05"</span>, <span>"&gt;= 0.05"</span>)))<br>qcorrplot(correlate(varechem), <span>type</span> = <span>"lower"</span>, diag = FALSE) +<br>  geom_square() +<br>  geom_couple(aes(colour = pd, size = rd),data = mantel,curvature = nice_curvature()) +<br>  scale_fill_gradientn(colours=rev(rainbow(100)))+<br>  scale_size_manual(values = c(0.5, 1, 2)) +<br>  scale_colour_manual(values = color_pal(3)) +<br>  guides(size = guide_legend(title = <span>"Mantel's r"</span>,override.aes = list(colour = <span>"grey35"</span>),order = 2),<br>         colour = guide_legend(title = <span>"Mantel's p"</span>,override.aes = list(size = 3),order = 1),<br>         fill = guide_colorbar(title = <span>"Pearson's r"</span>, order = 3))<br></code></pre><p data-tool="mdnice编辑器"><img data-ratio="0.6268518518518519" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/VQj38bogwOJAbQotmoicBTBC3PWoQLkLbtPJyrzPqOibjUEzel9TwWlicaFzQicmhCcOXflwkPuxQdqliaGTez4gSibg/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/VQj38bogwOJAbQotmoicBTBC3PWoQLkLbtPJyrzPqOibjUEzel9TwWlicaFzQicmhCcOXflwkPuxQdqliaGTez4gSibg/640?wx_fmt=png"><img data-ratio="0.6268518518518519" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/VQj38bogwOJAbQotmoicBTBC3PWoQLkLbFibw0cjmYhgOYk6LvicJxcmvZydSFQoqRrx773XibDcP5sicBxKfDRZe1Q/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/VQj38bogwOJAbQotmoicBTBC3PWoQLkLbFibw0cjmYhgOYk6LvicJxcmvZydSFQoqRrx773XibDcP5sicBxKfDRZe1Q/640?wx_fmt=png"><span></span></p></section><section><span></span></section><hr><section><span><strong><span>三、安装使用ggcor包</span></strong></span></section><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><pre data-tool="mdnice编辑器"><span></span><code><span># install.packages("devtools")</span><br>library(devtools)<br>devtools::install_git(<span>"https://gitee.com/kingjames23/ggcor_1"</span>)<br>library(ggplot2)<br>library(ggcor)<br>set_scale()<br>quickcor(mtcars) + geom_square()+<br>  scale_fill_gradientn(colours=rev(rainbow(100)))<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.9175925925925926" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/VQj38bogwOJAbQotmoicBTBC3PWoQLkLbdWNH0WUOZSq0lwL2LGYTUOyjHTdWWa3x4LxcN7iadiae32I976aOKVpw/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/VQj38bogwOJAbQotmoicBTBC3PWoQLkLbdWNH0WUOZSq0lwL2LGYTUOyjHTdWWa3x4LxcN7iadiae32I976aOKVpw/640?wx_fmt=png"></figure><pre data-tool="mdnice编辑器"><span></span><code>quickcor(mtcars, <span>type</span> = <span>"upper"</span>) + geom_circle2()+<br>  scale_fill_gradientn(colours=rev(rainbow(100)))<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.9157407407407407" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/VQj38bogwOJAbQotmoicBTBC3PWoQLkLbyvrryCCgtMQ44CaDpMbPmfkFIJhIeMfaftxxq3gQRD7L3TmwMgbFbw/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/VQj38bogwOJAbQotmoicBTBC3PWoQLkLbyvrryCCgtMQ44CaDpMbPmfkFIJhIeMfaftxxq3gQRD7L3TmwMgbFbw/640?wx_fmt=png"></figure><pre data-tool="mdnice编辑器"><span></span><code>quickcor(mtcars, cor.test = TRUE) +<br>  geom_square(data = get_data(<span>type</span> = <span>"lower"</span>, show.diag = FALSE)) +<br>  geom_mark(data = get_data(<span>type</span> = <span>"upper"</span>, show.diag = FALSE), size = 2.5) +<br>  geom_abline(slope = -1, intercept = 12)+<br>  scale_fill_gradientn(colours=rev(rainbow(100)))<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.9203703703703704" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/VQj38bogwOJAbQotmoicBTBC3PWoQLkLb4U7nghcDAFqxiaia220ztLLmicEiaIKqxnKWumL9GaZibVVf6K2ZHkZheZQ/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/VQj38bogwOJAbQotmoicBTBC3PWoQLkLb4U7nghcDAFqxiaia220ztLLmicEiaIKqxnKWumL9GaZibVVf6K2ZHkZheZQ/640?wx_fmt=png"></figure><pre data-tool="mdnice编辑器"><span></span><code>library(dplyr)<br><span>#&gt; Warning: package 'dplyr' was built under R version 3.6.2</span><br>data(<span>"varechem"</span>, package = <span>"vegan"</span>)<br>data(<span>"varespec"</span>, package = <span>"vegan"</span>)<br>mantel &lt;- mantel_test(varespec, varechem,<br>                      spec.select = list(Spec01 = 1:7,Spec02 = 8:18,Spec03 = 19:37,Spec04 = 38:44)) %&gt;% <br>  mutate(rd = cut(r, breaks = c(-Inf, 0.2, 0.4, Inf),<br>                  labels = c(<span>"&lt; 0.2"</span>, <span>"0.2 - 0.4"</span>, <span>"&gt;= 0.4"</span>)),<br>         pd = cut(p.value, breaks = c(-Inf, 0.01, 0.05, Inf),<br>                  labels = c(<span>"&lt; 0.01"</span>, <span>"0.01 - 0.05"</span>, <span>"&gt;= 0.05"</span>)))<br>quickcor(varechem, <span>type</span> = <span>"upper"</span>) +<br>  geom_square() +<br>  anno_link(aes(colour = pd, size = rd), data = mantel) +<br>  scale_size_manual(values = c(0.5, 1, 2)) +<br> scale_fill_gradientn(colours=rev(rainbow(100)))+<br>  guides(size = guide_legend(title = <span>"Mantel's r"</span>,override.aes = list(colour = <span>"grey35"</span>), order = 2),<br>         colour = guide_legend(title = <span>"Mantel's p"</span>,override.aes = list(size = 3), order = 1),<br>         fill = guide_colorbar(title = <span>"Pearson's r"</span>, order = 3))<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.6537037037037037" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/VQj38bogwOJAbQotmoicBTBC3PWoQLkLbRAzHocL4ckdZdcxVUAJDicuiczzfOVXPJHPrz3uTRicnZFQRdvaL4ofPQ/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/VQj38bogwOJAbQotmoicBTBC3PWoQLkLbRAzHocL4ckdZdcxVUAJDicuiczzfOVXPJHPrz3uTRicnZFQRdvaL4ofPQ/640?wx_fmt=png"></figure><pre data-tool="mdnice编辑器"><span></span><code>library(ambient)<br>rand_correlate(100, 8) %&gt;% <span>## require ambient packages</span><br>  quickcor(circular = TRUE, cluster = TRUE, open = 45) +<br>  geom_colour(colour = <span>"white"</span>, size = 0.125) +<br>  anno_row_tree() +<br>  anno_col_tree() +<br>  set_p_xaxis() +<br>  set_p_yaxis()+<br>  scale_fill_gradientn(colours=rev(rainbow(100)))<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.9990740740740741" data-src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/VQj38bogwOJAbQotmoicBTBC3PWoQLkLbXAjgnQALRNxHWLJ7K1jGSicYnH1WfEiabpk3aPYtd3oIiax1USeYZTr1A/640?wx_fmt=jpeg" data-type="jpeg" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/VQj38bogwOJAbQotmoicBTBC3PWoQLkLbXAjgnQALRNxHWLJ7K1jGSicYnH1WfEiabpk3aPYtd3oIiax1USeYZTr1A/640?wx_fmt=jpeg"></figure></section><hr><section><strong><span></span></strong></section><section><strong>********<span>*****************************************</span></strong><strong></strong></section><section><span><strong>给大家送本书：</strong></span></section><section><span><strong><span>《</span></strong></span><strong><span>用ChatGPT轻松玩转机器学习与深度学习</span></strong><strong><span>》。</span></strong></section><section><strong>广告语：</strong><span></span></section><p><span>突破传统学习束缚，借助ChatGPT的神奇力量，解锁AI无限可能！</span><p></p></p><p><strong>一句话推荐：</strong><p></p></p><p><span>用ChatGPT突破传统学习束缚，解锁AI无限可能！</span><p></p></p><p><strong>内容简介：</strong><p></p></p><p><span>随着机器学习和深度学习技术的不断发展和进步，它们的复杂性也在不断增强。对于初学者来说，学习这两个领域可能会遇到许多难题和挑战，如理论知识的缺乏、数据处理的困难、算法选择的不确定性等。此时，ChatGPT可以提供强有力的帮助。利用ChatGPT，读者可以更轻松地理解机器学习和深度学习的概念和技术，并解决学习过程中遇到的各种问题和疑惑。此外，ChatGPT还可以为读者提供更多的实用经验和技巧，帮助他们更好地掌握机器学习和深度学习的基本原理和方法。本书主要内容包括</span><span>探索性数据分析、有监督学习（线性回归、SVM、决策树等）、无监督学习（降维、聚类等），以及深度学习的基础原理和应用等。</span><p></p></p><section><span>本书旨在为广大读者提供一个系统全面、易于理解的机器学习和深度学习入门教程。不需要过多的数学背景，只需掌握基本的编程知识即可轻松上手。</span><p></p></section><section><strong>京东购买链接：</strong></section><section><span>https://item.jd.com/14092188.html</span><p></p></section><section><strong>当当购买链接：</strong></section><section><span>http://product.dangdang.com/29610425.html</span><p></p></section><section><strong></strong></section><section><span><strong><span></span></strong></span></section><section><mpcps data-templateid="list" data-traceid="573fcf00-d9e9-4428-a331-8d7814ecc070" data-goodssouce="1" data-pid="101_14092188" data-appuin="3208673211" data-buffer='{"category_id":106,"pid":"101_14092188","biz_uin":"3208673211","trace_id":"573fcf00-d9e9-4428-a331-8d7814ecc070","sku_id":"101_14092188","source_id":2,"source_name":"京东","audit_state":1,"main_img":"https://pcm-img.zhls.qq.com/productcenter-1aa873c5--1018824-7788314505003409608/68805390819082023/bb4d2b0bb585568cc866910bf133039f.jpg","product_name":"用ChatGPT轻松玩转机器学习与深度学习","current_price":6500,"first_category_id":"106","book":{"shop_name":"北京大学出版社京东自营官方旗舰店"},"product_label_name_list":["京东配送"],"select_tag_name_list":[],"templateId":"list","appuin":"3208673211","isNewCpsKOL":1}'></mpcps></section><section><img data-ratio="1" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/VQj38bogwOJAbQotmoicBTBC3PWoQLkLb9a7vhDPv1zJeEwuzKfQS4AnQh8ichlqhxHhibyQuiats1MGqzETBtlRIw/640?wx_fmt=jpeg" data-type="jpeg" data-w="800" src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/VQj38bogwOJAbQotmoicBTBC3PWoQLkLb9a7vhDPv1zJeEwuzKfQS4AnQh8ichlqhxHhibyQuiats1MGqzETBtlRIw/640?wx_fmt=jpeg"></section><hr><section><strong><span>抽奖方式及满足条件：</span></strong></section><section><strong><span>1.关注气象水文科研猫；</span></strong></section><section><strong><span>2.转发本文到朋友圈；</span></strong></section><section><strong><span>3.给本文点【<span>赞</span>】、点【<span>在看</span>】；</span></strong></section><section><strong><span>4.<span>留言区评论点赞最多者。</span></span></strong></section><section><strong><span>同时满足上述4个条件的留言区点赞<span>前4名的</span>读者，</span></strong></section><section><strong><span>每人免费包邮一本：</span></strong></section><section><span><strong><span><strong><span></span></strong><span><strong><span>《</span></strong></span><strong><span>用ChatGPT轻松玩转机器学习与深度学习</span></strong><strong><span>》。</span></strong></span></strong></span></section><section><strong><span>开奖日期：2023年9月7日晚8点。</span></strong></section><hr><section><strong></strong></section><hr><section><strong><span>*****************************************</span></strong></section><section><span><strong><span>欢迎加气象水文科研猫主编微信，</span></strong></span></section><section><span><strong><span>免费加入微信交流群，</span></strong></span></section><section><span><strong><span>获取更多免费代码和科研数据。</span></strong></span></section><section><strong><span>*****************************************</span></strong></section><section><img data-ratio="1.271444082519001" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/VQj38bogwOJG5okcEPbNPoh6U7OibH0K9iaC23cU8JJ2KC0mgP5085YKKGBTaKXicGV8tCykyW757GvIufia9QXmgg/640?wx_fmt=jpeg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" data-type="jpeg" data-w="921" src="https://mmbiz.qpic.cn/mmbiz_jpg/VQj38bogwOJG5okcEPbNPoh6U7OibH0K9iaC23cU8JJ2KC0mgP5085YKKGBTaKXicGV8tCykyW757GvIufia9QXmgg/640?wx_fmt=jpeg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/jZZjBGSbBNNBKHzPDEUBcw",target="_blank" rel="noopener noreferrer">原文链接</a>
