---
title: "超大文本文件如何快速读取以及写入到硬盘"
date: 2023-09-26T16:42:10Z
draft: ["false"]
tags: [
  "fetched",
  "生信技能树"
]
categories: ["Acdemic"]
---
超大文本文件如何快速读取以及写入到硬盘 by 生信技能树
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><blockquote data-tool="mdnice编辑器"><p>如果大家跑过inferCNV这样的肿瘤单细胞拷贝数变异代码，就会发现它这个函数（CreateInfercnvObject），有一个诡异的设置，就是它会自动读取当前工作目录下面的3个文件 ：</p></blockquote><pre data-tool="mdnice编辑器"><span></span><code>expFile=<span>'expFile.txt'</span><br>groupFiles=<span>'groupFiles.txt'</span><br>geneFile=<span>'geneFile.txt'</span><br><br><span># duplicate 'row.names' are not allowed</span><br><span>library</span>(infercnv)<br>infercnv_obj = CreateInfercnvObject(raw_counts_matrix=expFile,<br>                                    annotations_file=groupFiles,<br>                                    delim=<span>"\t"</span>,<br>                                    gene_order_file= geneFile,<br>                                    ref_group_names=c(<span>'ref-1'</span>,<br>                                                      <span>'ref-2'</span>))  <span>## 这个取决于自己的分组信息里面的</span><br> <br></code></pre><p data-tool="mdnice编辑器">这样的话， 我们就不得不把在R里面的变量，写出到硬盘，成为文件。感觉是在使用一个独立的网页工具。。。。</p><p data-tool="mdnice编辑器">如下所示，是我以前的代码；</p><pre data-tool="mdnice编辑器"><span></span><code>dim(dat)<br>expFile=<span>'expFile.txt'</span><br>write.table(dat,file = expFile,sep = <span>'\t'</span>,quote = <span>F</span>) <br>groupFiles=<span>'groupFiles.txt'</span><br>head(groupinfo)<br>write.table(groupinfo,file = groupFiles,sep = <span>'\t'</span>,quote = <span>F</span>,col.names = <span>F</span>,row.names = <span>F</span>)<br>head(geneInfor)<br>geneFile=<span>'geneFile.txt'</span><br>write.table(geneInfor,file = geneFile,sep = <span>'\t'</span>,quote = <span>F</span>,col.names = <span>F</span>,row.names = <span>F</span>)<br><br></code></pre><p data-tool="mdnice编辑器">其中，dat变量是单细胞表达量矩阵，通常是几万个细胞，几万个基因，这样的话，输出的txt文本文件会超级大，非常的耗时！！！是时候改变它了，所以我求助了chatGPT，如果大家不能使用外网的chatGPT，也可以参考我们<strong>通过<a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247523773&amp;idx=1&amp;sn=75c7726c348c16a20ccb5f00ca032379&amp;scene=21#wechat_redirect" data-linktype="2">BioinfoArk提供的中国区chatGPT</a>的查询方式</strong>：</p><p><img data-galleryid="" data-ratio="0.7217391304347827" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wzu034pWOcntWVGsiaa2du85Kmyt4hOfEAxVC1UN0a8WAxLLkmwBKRpMPdNicwTTk4k5qiaWKwyXrKmw/640?wx_fmt=png" data-type="png" data-w="690" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wzu034pWOcntWVGsiaa2du85Kmyt4hOfEAxVC1UN0a8WAxLLkmwBKRpMPdNicwTTk4k5qiaWKwyXrKmw/640?wx_fmt=png"></p><figure data-tool="mdnice编辑器"><figcaption>求助了chatGPT</figcaption></figure><p data-tool="mdnice编辑器">我采纳了它的第一个建议，然后试着对比一下：</p><pre data-tool="mdnice编辑器"><span></span><code><span># 代码段1</span><br>start_time1 &lt;- Sys.time()<br><span># Your code here</span><br>write.table(dat,file = expFile,sep = <span>'\t'</span>,quote = <span>F</span>)<br>end_time1 &lt;- Sys.time()<br>execution_time1 &lt;- end_time1 - start_time1<br><br><span># 代码段2</span><br>start_time2 &lt;- Sys.time()<br><span># Your code here</span><br>  fwrite(dat, file = expFile,  row.names = <span>T</span>,sep = <span>"\t"</span>, quote = <span>FALSE</span>)<br>end_time2 &lt;- Sys.time()<br>execution_time2 &lt;- end_time2 - start_time2<br><br><span># 比较耗时</span><br><span>if</span> (execution_time1 &lt; execution_time2) {<br>  cat(<span>"代码段1执行时间更短："</span>, execution_time1, <span>"\n"</span>)<br>} <span>else</span> <span>if</span> (execution_time1 &gt; execution_time2) {<br>  cat(<span>"代码段2执行时间更短："</span>, execution_time2, <span>"\n"</span>)<br>} <span>else</span> {<br>  cat(<span>"两个代码段执行时间相同："</span>, execution_time1, <span>"\n"</span>)<br>}<br><br><br></code></pre><p data-tool="mdnice编辑器"><span><strong>这个时间层面的提高，数值提高简直是恐怖如斯！！！！</strong></span></p><pre data-tool="mdnice编辑器"><span></span><code>代码段2执行时间更短： 0.392374 <br>&gt; execution_time1<br>Time difference of 1.92164 mins<br></code></pre></section><h4 data-tool="mdnice编辑器">文末友情宣传</h4><p data-tool="mdnice编辑器">强烈建议你推荐给身边的<strong>博士后以及年轻生物学PI</strong>，多一点数据认知，让他们的科研上一个台阶：</p><ul data-tool="mdnice编辑器"><li><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247524930&amp;idx=5&amp;sn=19d5eb52cbba6389c6238cd7943d96c7&amp;chksm=9b4b22f9ac3cabefa5c0436a6e723c3ad447fd67bdd2f9d500043220c5e97e6934b6015977e3&amp;scene=21#wechat_redirect" textvalue="生物信息学马拉松授课（买一得‍五）" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2">生物信息学马拉松授课（买一得五）</a> ，你的生物信息学入门课</section></li><li><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247524148&amp;idx=1&amp;sn=7806da6feb41a36493c519c1cfc1d3ac&amp;chksm=9b4bdf8fac3c569960369602f1ef26639cb366b250f233b2297d1f059471c0458335bfc0b829&amp;scene=21#wechat_redirect" textvalue="时隔5年，我们的生信技能树VIP学徒继续招生啦" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1">时隔5年，我们的生信技能树VIP学徒继续招生啦</a><br></section></li><li><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247522831&amp;idx=2&amp;sn=1744efdf428465425a145ff3a982198b&amp;chksm=9b4bdab4ac3c53a28fbecbbff4f254f470b54a7a20468bb753b295b930315e1ec45bcbabc10b&amp;scene=21#wechat_redirect" textvalue="144线程640Gb内存服务器共享一年‍仍然是仅需800" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1">144线程640Gb内存服务器共享一年仍然是仅需800</a></section></li><li><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247519765&amp;idx=1&amp;sn=ce5a8c8182f854c88043059f8c2cb9ff&amp;chksm=9b4bceaeac3c47b88c19941d43dbb1401f3a92206481a0afc41159927868199643f795d62a7e&amp;scene=21#wechat_redirect" textvalue="千呼万唤始出来的独享生物信息学云服务器" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1">千呼万唤始出来的独享生物信息学云服务器</a></section></li><li><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247519765&amp;idx=1&amp;sn=ce5a8c8182f854c88043059f8c2cb9ff&amp;chksm=9b4bceaeac3c47b88c19941d43dbb1401f3a92206481a0afc41159927868199643f795d62a7e&amp;scene=21#wechat_redirect" textvalue="千呼万唤始出来的独享生物信息学云服务器" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1"></a><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247524275&amp;idx=1&amp;sn=fa592ee29f636f34387491d0fceadd8e&amp;chksm=9b4bdf08ac3c561e0881974b3817beb0a0e514dc1a8df4c34c2b6653da6fa78e09acb03c70c2&amp;scene=21#wechat_redirect" textvalue="生信技能树知识整理实习生又又又开放申请啦" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1">生信技能树知识整理实习生又又又开放申请啦</a></section></li><li><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247524432&amp;idx=1&amp;sn=5b33b0c6807a9e6939c332c58fabff89&amp;chksm=9b4b20ebac3ca9fdb3d8bfaf2bef5552f64eb70e7fae557cc7197fb1a23b3e8bc31b585bf829&amp;scene=21#wechat_redirect" textvalue="生信共享办公室出租" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1">生信共享办公室出租</a></p></li></ul><p><br></p><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/SOqt_MtaqzDQntmoRAr9RQ",target="_blank" rel="noopener noreferrer">原文链接</a>
