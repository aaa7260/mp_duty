---
title: "[会员专享] nature图表复|区域热图绘制"
date: 2023-09-02T22:32:47Z
draft: ["false"]
tags: [
  "fetched",
  "R语言数据分析指南"
]
categories: ["Acdemic"]
---
[会员专享] nature图表复|区域热图绘制 by R语言数据分析指南
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><h3 data-tool="mdnice编辑器"><span></span><span><span></span>欢迎关注R语言数据分析指南</span><span></span></h3><blockquote data-tool="mdnice编辑器"><span>❝</span><p>本节来模仿<strong>「nature」</strong>上的一篇文章来绘制一张局部放大的热图，其主要是通过<strong>「ggmagnify」</strong>包来实现，由于原文没有提供数据小编自己找了一份数据结果仅供参考。下面小编通过一个案例来进行展示，图形仅供展示用，希望各位观众老爷能够喜欢。数据代码已经整合上传到2023VIP交流群，加群的观众老爷可自行下载。</p><span>❞</span></blockquote><h3 data-tool="mdnice编辑器"><span></span><span><span></span>关注下方公众号下回更新不迷路</span><span></span></h3><section><mp-common-profile data-pluginname="mpprofile" data-id="Mzg3MzQzNTYzMw==" data-headimg="http://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZF0rpeZII9Ltl26VbVagriczTria1fib3XgjwwHEHFjPzkmGpqWDVVHBSzhENictUM2iavAKiaM5lc9USw/0?wx_fmt=png" data-nickname="R语言数据分析指南" data-alias="YanJANtwo" data-signature="R语言重症爱好者，喜欢绘制各种精美的图表，喜欢的小伙伴可以关注我，跟我一起学习" data-from="0" data-is_biz_ban="0"></mp-common-profile></section><h3 data-tool="mdnice编辑器"><span></span><span><span></span>论文</span><span></span></h3><figure data-tool="mdnice编辑器"><img data-ratio="0.5768518518518518" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAaIlIzF6yVW4OplvumtpcD2MLZm07tHk8877JsVWfFFzHjLDr3500DnJP0ibUwkgtJakotBvFM8dkA/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAaIlIzF6yVW4OplvumtpcD2MLZm07tHk8877JsVWfFFzHjLDr3500DnJP0ibUwkgtJakotBvFM8dkA/640?wx_fmt=png"></figure><h3 data-tool="mdnice编辑器"><span></span><span><span></span>原文图</span><span></span></h3><figure data-tool="mdnice编辑器"><img data-ratio="0.9064814814814814" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAaIlIzF6yVW4OplvumtpcD26zZVbLeoDtEVzRlX84JiaHnsibeWgx6WhrvDtQhYE96rSkojy7WpQQmg/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAaIlIzF6yVW4OplvumtpcD26zZVbLeoDtEVzRlX84JiaHnsibeWgx6WhrvDtQhYE96rSkojy7WpQQmg/640?wx_fmt=png"></figure><h3 data-tool="mdnice编辑器"><span></span><span><span></span>仿图</span><span></span></h3><figure data-tool="mdnice编辑器"><img data-ratio="0.8675925925925926" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAaIlIzF6yVW4OplvumtpcD2sbjOxDgJOmSSqdpHwrcuZIgcKu0Hs0j1cFC8rM50tf88QUEokyUM5A/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAaIlIzF6yVW4OplvumtpcD2sbjOxDgJOmSSqdpHwrcuZIgcKu0Hs0j1cFC8rM50tf88QUEokyUM5A/640?wx_fmt=png"></figure><h3 data-tool="mdnice编辑器"><span></span><span><span></span>图形解读</span><span></span></h3><blockquote data-tool="mdnice编辑器"><span>❝</span><p>ggmagnify包默认的函数可以很轻松的对选定的区域进行缩放，但是绘制此图难点在于如何只在缩放图中出现需要的Y轴文本，小编无意中想的了一个窍门解决了此问题，有需要的继续往下阅读。</p><span>❞</span></blockquote><h3 data-tool="mdnice编辑器"><span></span><span><span></span>加载R包</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code>install.packages(<span>"ggmagnify"</span>, repos = c(<span>"https://hughjonesd.r-universe.dev"</span>, <br>                                        <span>"https://cloud.r-project.org"</span>))<br><span>library</span>(tidyverse)<br><span>library</span>(readxl)<br><span>library</span>(magrittr)<br><span>library</span>(ggtree)<br><span>library</span>(ggmagnify)<br><span>library</span>(grid)<br><span>library</span>(patchwork)<br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span><span></span>导入数据</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code>df &lt;- read_excel(<span>"F1.xlsx"</span>, sheet = <span>"Fig 1c KEGG module"</span>) %&gt;% <br>  column_to_rownames(var=<span>"...1"</span>)<br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span><span></span>数据清洗</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code>df2 &lt;- df %&gt;% rownames_to_column(var=<span>"ID"</span>) %&gt;% <br>  pivot_longer(-<span>1</span>) %&gt;% <br>  set_colnames(c(<span>"ID"</span>,<span>"name"</span>,<span>"value"</span>))<br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span><span></span>聚类分析</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code>hc &lt;- hclust(dist(t(df))) %&gt;% ggtree() + layout_dendrogram()+<br>  theme_void()<br></code></pre><blockquote data-tool="mdnice编辑器"><span>❝</span><p>有需要学习个性化数据可视化的朋友，欢迎到小编的<strong>「淘宝店铺」</strong> <strong>「R语言数据分析指南」</strong>购买<strong>「2023年度会员文档」</strong>同步更新中<strong>「售价149元」</strong>，内容主要包括各种<strong>「高分论文的图表分析复现以及一些个性化图表的绘制」</strong>均包含数据+代码；按照往年数据小编年产出约在150+以上</p><span>❞</span></blockquote><p data-tool="mdnice编辑器">购买后微信发小编订单截图即邀请进新的会员交流群，小编的文档为按年售卖，只包含当年度的<strong>「除系列课程外」</strong>的文档，有需要往年文档的朋友也可下单购买，需要了解更多信息的朋友欢迎交流咨询。</p><h3 data-tool="mdnice编辑器"><span></span><span><span></span>淘宝扫一扫</span><span></span></h3><figure data-tool="mdnice编辑器"><img data-ratio="1.6141479099678457" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAaIlIzF6yVW4OplvumtpcD28iaAbHrmRNmYsHQPMicIR54scTBkY60AxqJnfCIZQOygGoVPPiaKhWIPw/640?wx_fmt=png" data-type="png" data-w="622" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAaIlIzF6yVW4OplvumtpcD28iaAbHrmRNmYsHQPMicIR54scTBkY60AxqJnfCIZQOygGoVPPiaKhWIPw/640?wx_fmt=png"><p data-class="mbImgTitle">▲ 图片标题</p></figure><h3 data-tool="mdnice编辑器"><span></span><span><span></span>2023会员群案例展示</span><span></span></h3><p><mp-pay-preview-filter data-offset="25"></mp-pay-preview-filter></p></section></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/hYKVC6QliNTixS15RMi9XQ",target="_blank" rel="noopener noreferrer">原文链接</a>
