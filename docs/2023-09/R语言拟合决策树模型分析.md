---
title: "R语言拟合决策树模型分析"
date: 2023-09-07T13:12:19Z
draft: ["false"]
tags: [
  "fetched",
  "R语言数据分析指南"
]
categories: ["Acdemic"]
---
R语言拟合决策树模型分析 by R语言数据分析指南
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><h3 data-tool="mdnice编辑器"><span></span><span><span></span>欢迎关注R语言数据分析指南</span><span></span></h3><blockquote data-tool="mdnice编辑器"><span>❝</span><p>本节来介绍如何使用R语言来进行<strong>「逻辑回归与决策树模型分析」</strong>，下面小编通过一个案例来进行展示，结果仅供展示用，希望各位观众老爷能够喜欢。数据代码已经整合上传到2023VIP交流群，加群的观众老爷可自行下载。</p><span>❞</span></blockquote><h3 data-tool="mdnice编辑器"><span></span><span><span></span>关注下方公众号下回更新不迷路</span><span></span></h3><section><mp-common-profile data-pluginname="mpprofile" data-id="Mzg3MzQzNTYzMw==" data-headimg="http://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZF0rpeZII9Ltl26VbVagriczTria1fib3XgjwwHEHFjPzkmGpqWDVVHBSzhENictUM2iavAKiaM5lc9USw/0?wx_fmt=png" data-nickname="R语言数据分析指南" data-alias="YanJANtwo" data-signature="R语言重症爱好者，喜欢绘制各种精美的图表，喜欢的小伙伴可以关注我，跟我一起学习" data-from="0" data-is_biz_ban="0"></mp-common-profile></section><h3 data-tool="mdnice编辑器"><span></span><span><span></span>加载R包</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code><span>library</span>(tidyverse)<br><span>library</span>(caTools)<br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span><span></span>导入数据</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code>creditcard_data &lt;- read_csv(<span>"creditcard.csv"</span>)<br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span><span></span>数据清洗</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code>creditcard_data$Amount = scale(creditcard_data$Amount) <span># 对Amount列进行标准化处理</span><br>NewData = creditcard_data[, -c(<span>1</span>)]<br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span><span></span>构建模型</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code>set.seed(<span>123</span>) <span># 设置随机种子，以确保可重复性</span><br><span># 使用sample.split函数对数据进行分割，80%用于训练，20%用于测试</span><br>data_sample = sample.split(NewData$Class, SplitRatio = <span>0.80</span>)<br><br>train_data = subset(NewData, data_sample == <span>TRUE</span>) <span># 创建训练数据集</span><br>test_data = subset(NewData, data_sample == <span>FALSE</span>) <span># 创建测试数据集</span><br><br><span># 使用逻辑回归模型进行训练，并将模型存储在Logistic_Model变量中</span><br>Logistic_Model = glm(Class ~ ., test_data, family = binomial())<br>summary(Logistic_Model) <span># 显示逻辑回归模型的摘要信息</span><br>plot(Logistic_Model) <span># 绘制逻辑回归模型的图形</span><br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.7287037037037037" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAaA95VgVZnDAr12YX6GNUJwrhWwFOtUlFNItE9IQ5INKnIWf9sic20r2TOqKm4iaFYTxCadhUV2HG5w/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAaA95VgVZnDAr12YX6GNUJwrhWwFOtUlFNItE9IQ5INKnIWf9sic20r2TOqKm4iaFYTxCadhUV2HG5w/640?wx_fmt=png"></figure><figure data-tool="mdnice编辑器"><img data-ratio="1" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAaA95VgVZnDAr12YX6GNUJwAUKe7JNtqBVB0n8DnmU0cZVwqk4BlEku3KsKWFEeU5mse5DwxjQvpg/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAaA95VgVZnDAr12YX6GNUJwAUKe7JNtqBVB0n8DnmU0cZVwqk4BlEku3KsKWFEeU5mse5DwxjQvpg/640?wx_fmt=png"></figure><figure data-tool="mdnice编辑器"><img data-ratio="1" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAaA95VgVZnDAr12YX6GNUJw6VTYYEbMsgfqcxXC0Cc9WL83ZePJWgRcsjTwJQIk2xrXA25fcZ2m5A/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAaA95VgVZnDAr12YX6GNUJw6VTYYEbMsgfqcxXC0Cc9WL83ZePJWgRcsjTwJQIk2xrXA25fcZ2m5A/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">绘制ROC曲线评估模型有效性</p><pre data-tool="mdnice编辑器"><span></span><code><span>library</span>(pROC)<br>lr.predict &lt;- predict(Logistic_Model,test_data, probability = <span>TRUE</span>)<br>auc.gbm = roc(test_data$Class, lr.predict, plot = <span>TRUE</span>, col = <span>"blue"</span>)<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="1" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAaA95VgVZnDAr12YX6GNUJwJcV1GaMZic2iaYLqf6hKiakxnmXCaBSlDJwoWRCccRKg1BpvAXiciaGtvicg/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAaA95VgVZnDAr12YX6GNUJwJcV1GaMZic2iaYLqf6hKiakxnmXCaBSlDJwoWRCccRKg1BpvAXiciaGtvicg/640?wx_fmt=png"></figure><h3 data-tool="mdnice编辑器"><span></span><span><span></span>构建决策树</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code><span>library</span>(rpart) <br><span># install.packages("rpart.plot")</span><br><span>library</span>(rpart.plot) <span># 用于决策树的可视化</span><br></code></pre><pre data-tool="mdnice编辑器"><span></span><code><span># 使用决策树模型进行训练，并将模型存储在decisionTree_model变量中</span><br>decisionTree_model &lt;- rpart(Class ~ . , creditcard_data, method = <span>'class'</span>)<br><span># 使用决策树模型进行预测，将预测值存储在predicted_val变量中</span><br>predicted_val &lt;- predict(decisionTree_model, creditcard_data, type = <span>'class'</span>)<br><span># 计算预测的概率，并存储在probability变量中</span><br>probability &lt;- predict(decisionTree_model, creditcard_data, type = <span>'prob'</span>)<br>rpart.plot(decisionTree_model) <span># 使用rpart.plot函数绘制决策树模型</span><br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.7287037037037037" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAaA95VgVZnDAr12YX6GNUJwmBE1bDUuQ41LEr7UDUvMMNnOTiawYfwqwncwDYwEXibeSDVMyoKqcicqw/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAaA95VgVZnDAr12YX6GNUJwmBE1bDUuQ41LEr7UDUvMMNnOTiawYfwqwncwDYwEXibeSDVMyoKqcicqw/640?wx_fmt=png"></figure><blockquote data-tool="mdnice编辑器"><span>❝</span><p>本节内容介绍到此结束，有需要学习个性化数据可视化的朋友，欢迎到小编的<strong>「淘宝店铺」</strong> <strong>「R语言数据分析指南」</strong>购买<strong>「2023年度会员文档」</strong>同步更新中<strong>「售价149元」</strong>，内容主要包括各种<strong>「高分论文的图表分析复现以及一些个性化图表的绘制」</strong>均包含数据+代码；按照往年数据小编年产出约在150+以上</p><span>❞</span></blockquote><p data-tool="mdnice编辑器">购买后微信发小编订单截图即邀请进新的会员交流群，小编的文档为按年售卖，只包含当年度的<strong>「除系列课程外」</strong>的文档，有需要往年文档的朋友也可下单购买，需要了解更多信息的朋友欢迎交流咨询。</p><h3 data-tool="mdnice编辑器"><span></span><span><span></span>淘宝扫一扫</span><span></span></h3><figure data-tool="mdnice编辑器"><img data-ratio="1.6141479099678457" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAaA95VgVZnDAr12YX6GNUJwK5pspc3QkanriadziaBRVf5yicfSnLZiasWuyEhFtk1ib1pGg3FRIEtlZww/640?wx_fmt=png" data-type="png" data-w="622" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAaA95VgVZnDAr12YX6GNUJwK5pspc3QkanriadziaBRVf5yicfSnLZiasWuyEhFtk1ib1pGg3FRIEtlZww/640?wx_fmt=png"></figure><h3 data-tool="mdnice编辑器"><span></span><span><span></span>2023会员群案例展示</span><span></span></h3><p data-tool="mdnice编辑器"><img data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAaA95VgVZnDAr12YX6GNUJw0oWxIQ0Lwk08qlycPZOuErHzpgdKEqBSPBJhJJMd1gBLxjfyullG7w/640?wx_fmt=png" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAaA95VgVZnDAr12YX6GNUJw0oWxIQ0Lwk08qlycPZOuErHzpgdKEqBSPBJhJJMd1gBLxjfyullG7w/640?wx_fmt=png"><img data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAaA95VgVZnDAr12YX6GNUJwib8absANcSvjB8RuSYKetrKfichBonzvdVq6bcH3w03WGnw3fArV5QgA/640?wx_fmt=png" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAaA95VgVZnDAr12YX6GNUJwib8absANcSvjB8RuSYKetrKfichBonzvdVq6bcH3w03WGnw3fArV5QgA/640?wx_fmt=png"><img data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAaA95VgVZnDAr12YX6GNUJw3N6icGhcicjJX0bR47db8s87hDOunklT5kPk2GVESTGhF7ase0kEGRrA/640?wx_fmt=png" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAaA95VgVZnDAr12YX6GNUJw3N6icGhcicjJX0bR47db8s87hDOunklT5kPk2GVESTGhF7ase0kEGRrA/640?wx_fmt=png"><img data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAaA95VgVZnDAr12YX6GNUJwF68uDqiaTVVO3OA8VJsymOhKf4VvYiapiavz83uyCoHpzTT0JS3ldzDww/640?wx_fmt=png" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAaA95VgVZnDAr12YX6GNUJwF68uDqiaTVVO3OA8VJsymOhKf4VvYiapiavz83uyCoHpzTT0JS3ldzDww/640?wx_fmt=png"><img data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAaA95VgVZnDAr12YX6GNUJwrU1YicJe9unkqPbibYZWfZibOsNg1ibCxfTrticPcINPRUfwbibL66Ziab4qQ/640?wx_fmt=png" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAaA95VgVZnDAr12YX6GNUJwrU1YicJe9unkqPbibYZWfZibOsNg1ibCxfTrticPcINPRUfwbibL66Ziab4qQ/640?wx_fmt=png"><img data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAaA95VgVZnDAr12YX6GNUJwziclsYW62q0vquOPpjqGRfCRRA9IgHBDc8eQEuoOJibbRdaEzNwfoXng/640?wx_fmt=png" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAaA95VgVZnDAr12YX6GNUJwziclsYW62q0vquOPpjqGRfCRRA9IgHBDc8eQEuoOJibbRdaEzNwfoXng/640?wx_fmt=png"><img data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAaA95VgVZnDAr12YX6GNUJwsAjI2jshe6m2KuaxJl8L2yYkQQSG28jibe5wudVict4CESDzjAwH8QOw/640?wx_fmt=png" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAaA95VgVZnDAr12YX6GNUJwsAjI2jshe6m2KuaxJl8L2yYkQQSG28jibe5wudVict4CESDzjAwH8QOw/640?wx_fmt=png"><img data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAaA95VgVZnDAr12YX6GNUJwW8k5acibhaMWek52v9XS3FHzBib7JK4tpTYyORCsu7nhwfgXlWRodibBA/640?wx_fmt=png" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAaA95VgVZnDAr12YX6GNUJwW8k5acibhaMWek52v9XS3FHzBib7JK4tpTYyORCsu7nhwfgXlWRodibBA/640?wx_fmt=png"><img data-ratio="0.4255555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAaA95VgVZnDAr12YX6GNUJwevkcFzoM0PczLPC1Xrfwd3wUeZnVkkETeZIl4sibembbxjiapkyv7ZEg/640?wx_fmt=png" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAaA95VgVZnDAr12YX6GNUJwevkcFzoM0PczLPC1Xrfwd3wUeZnVkkETeZIl4sibembbxjiapkyv7ZEg/640?wx_fmt=png"></p></section><p><br></p><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/8tzUAXtT5zNO0lLhyhYDlg",target="_blank" rel="noopener noreferrer">原文链接</a>
