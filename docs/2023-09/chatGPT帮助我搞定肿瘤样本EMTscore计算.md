---
title: "chatGPT帮助我搞定肿瘤样本EMTscore计算"
date: 2023-09-22T16:09:20Z
draft: ["false"]
tags: [
  "fetched",
  "生信技能树"
]
categories: ["Acdemic"]
---
chatGPT帮助我搞定肿瘤样本EMTscore计算 by 生信技能树
------
<div><section powered-by="xiumi.us" mp-original-font-size="16" mp-original-line-height="25.600000381469727"><section mp-original-font-size="16" mp-original-line-height="25.600000381469727"><section mp-original-font-size="16" mp-original-line-height="25.600000381469727"><section mp-original-font-size="16" mp-original-line-height="0"><img data-ratio="0.91875" data-type="jpeg" data-w="640" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/cZNhZQ6j4wztsZWIld4dbSAHficyAXWgkicrhjjacU8Ey0UKM56qbSnedHStMqWUfTPQxbqxNTVZy1g59nNW3BSg/640?wx_fmt=jpeg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" src="https://mmbiz.qpic.cn/mmbiz_jpg/cZNhZQ6j4wztsZWIld4dbSAHficyAXWgkicrhjjacU8Ey0UKM56qbSnedHStMqWUfTPQxbqxNTVZy1g59nNW3BSg/640?wx_fmt=jpeg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"></section></section><span title="" opera-tn-ra-cell="_$.pages:0.layers:0.comps:0.title1" mp-original-font-size="16" mp-original-line-height="25.600000381469727"><p mp-original-font-size="16" mp-original-line-height="25.600000381469727"><br mp-original-font-size="16" mp-original-line-height="25.600000381469727"></p></span></section><section mp-original-font-size="16" mp-original-line-height="25.600000381469727"><section powered-by="xiumi.us" mp-original-font-size="16" mp-original-line-height="25.600000381469727"><p mp-original-font-size="16" mp-original-line-height="25.600000381469727"><span><span mp-original-font-size="16" mp-original-line-height="25.600000381469727"><span>我们的生信入门班和数据挖掘线上直播课程已经有了三年多的历史，培养了一波又一</span><span>波优秀的生信人才。本期分享的内容不是课堂上讲的，是学员在完成课程后基于自己的需求探索并分享出来的。</span></span></span></p><p mp-original-font-size="16" mp-original-line-height="25.600000381469727"><span></span></p></section></section></section><section powered-by="xiumi.us" mp-original-font-size="16" mp-original-line-height="25.600000381469727"><section data-tools="新媒体排版" data-id="763890" data-style-type="undefined" mp-original-font-size="16" mp-original-line-height="25.600000381469727"><section placeholder="请输入标题" mp-original-font-size="16" mp-original-line-height="24">肿瘤样本EMTscore 打分</section></section></section><section><section data-support="96编辑器" data-style-id="36948"><section><section><section><section><img data-ratio="1.76" data-type="gif" data-w="25" data-width="100%" data-src="https://mmbiz.qpic.cn/mmbiz_gif/Ljib4So7yuWiaDZltpxGT6tUr1pWG4wnibiaZaATVB5YEDrRazib1400bzGfwnaxlibAyQa9BkLZqI2cVNelicRl1HLmw/640?wx_fmt=gif&amp;wxfrom=5&amp;wx_lazy=1" src="https://mmbiz.qpic.cn/mmbiz_gif/Ljib4So7yuWiaDZltpxGT6tUr1pWG4wnibiaZaATVB5YEDrRazib1400bzGfwnaxlibAyQa9BkLZqI2cVNelicRl1HLmw/640?wx_fmt=gif&amp;wxfrom=5&amp;wx_lazy=1"></section><section><p>(生信技能树优秀学员张俊华)</p></section><section><img data-ratio="1.76" data-type="gif" data-w="25" data-width="100%" data-src="https://mmbiz.qpic.cn/mmbiz_gif/Ljib4So7yuWiaDZltpxGT6tUr1pWG4wnibiaZaATVB5YEDrRazib1400bzGfwnaxlibAyQa9BkLZqI2cVNelicRl1HLmw/640?wx_fmt=gif&amp;wxfrom=5&amp;wx_lazy=1" src="https://mmbiz.qpic.cn/mmbiz_gif/Ljib4So7yuWiaDZltpxGT6tUr1pWG4wnibiaZaATVB5YEDrRazib1400bzGfwnaxlibAyQa9BkLZqI2cVNelicRl1HLmw/640?wx_fmt=gif&amp;wxfrom=5&amp;wx_lazy=1"></section><section><br></section><section><img data-ratio="0.22005208333333334" data-type="png" data-w="768" data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wxx4hMhNqme7v4droav9kKgzNHzLlng2rH6swwhZIQjj6N9xZccDpKeFszaqLiannvjXe1ibALXoYOQ/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wxx4hMhNqme7v4droav9kKgzNHzLlng2rH6swwhZIQjj6N9xZccDpKeFszaqLiannvjXe1ibALXoYOQ/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"></section></section></section></section></section></section><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><p data-tool="mdnice编辑器">马拉松授课线上直播课程，最近的一期是下周一开课哦：</p><section mp-original-font-size="16" mp-original-line-height="26"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247520628&amp;idx=1&amp;sn=8904b3e4baed6d02397b4f6beb089085&amp;chksm=9b4bd1cfac3c58d9ee006daf365931bdfab8d5152ffb5090a2c6227d631e93c52f6656c39cd6&amp;scene=21#wechat_redirect" textvalue="生信入门&amp;数据挖掘线上直播课4月班" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1">生信入门&amp;数据挖掘线上直播课4月班</a></section></section></section><h3 data-tool="mdnice编辑器"><span>1.我的提问</span></h3><p data-tool="mdnice编辑器">不会搜索的医学生，不是生信技能树的优秀学员！</p><p data-tool="mdnice编辑器">这天我需要计算肿瘤样本的EMTscore，于是网上搜索了一下“肿瘤EMTscore计算方法”，推送最多的是健明<span>老师发的这篇帖子：</span><span>http://www.bio-info-trainee.com/8295.html</span></p><p data-tool="mdnice编辑器"><strong>介绍了一篇文章，文章对比了不同EMTscore算法的测评，但是奈何我是一名医学生，你让我学习算法，算<span>了吧！</span></strong><span></span></p><p data-tool="mdnice编辑器">于是转战宝藏群里寻求帮助，回复最快的也是健明老师，如下：</p><figure data-tool="mdnice编辑器"><img data-ratio="2.738888888888889" data-type="jpeg" data-w="1080" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/cZNhZQ6j4wx4ibGTX2jE3q4LL6wa2ecPsTJXpicQJHEQNt8UNlTHZCprc66VO81atLPuzDfEt3sicVOWhv1zqicQkQ/640?wx_fmt=jpeg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" src="https://mmbiz.qpic.cn/mmbiz_jpg/cZNhZQ6j4wx4ibGTX2jE3q4LL6wa2ecPsTJXpicQJHEQNt8UNlTHZCprc66VO81atLPuzDfEt3sicVOWhv1zqicQkQ/640?wx_fmt=jpeg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"></figure><p data-tool="mdnice编辑器">又奈何我没有勇气说我看不懂！那就继续搜索吧！</p><p data-tool="mdnice编辑器">曾老师帖子里推荐的这篇文章中介绍了三种算法，并进行了比较。<strong>好像没有涉及到R包或者现<span>成的函数，我就去问了下Bing，</span></strong><span>它给了我三个答案：</span></p><p data-tool="mdnice编辑器">● http://www.emtome.org/ ###这个链接是一个数据库的链接，大家可以点进去探索一下</p><p data-tool="mdnice编辑器">● https://www.nature.com/articles/s41416-020-01178-9 </p><p data-tool="mdnice编辑器">这个链接是发表在British Journal of Cancer上的文章，正是介绍上面这个数据库的，是一篇一区，9+分的文章，能不能说明上面的这个数据库还是值得探索一下的？感兴趣的小伙伴自己去探索吧。</p><p data-tool="mdnice编辑器">● https://rdrr.io/github/Bozorgui/imogene/man/get_emt_score.html ###这个链接打开后是一个R函数的介绍页面，函数叫做get_emt_score，我又问了一下bing这个函数是干啥的，它告诉我：</p><figure data-tool="mdnice编辑器"><img data-ratio="2.3798882681564244" data-type="png" data-w="358" data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wx4ibGTX2jE3q4LL6wa2ecPsrlYDhhQibffH5ZqWaJyHicbMQVBicpAJzeoH7107VXqTkEKpLiaxeEDjBg/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wx4ibGTX2jE3q4LL6wa2ecPsrlYDhhQibffH5ZqWaJyHicbMQVBicpAJzeoH7107VXqTkEKpLiaxeEDjBg/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"></figure><p data-tool="mdnice编辑器">这就简单了，探索这个函数呗！</p><h3 data-tool="mdnice编辑器"><span>我的探索</span></h3><p data-tool="mdnice编辑器">介绍：</p><blockquote data-tool="mdnice编辑器"><p>get_emt_score是一个R函数，可以用来计算肿瘤的上皮间质转化（EMT）得分。这个函数需要一个包含基因或蛋白表达数据的数值型数据框或矩阵作为输入，然后根据EMT_gene_list中的基因和它们对EMT的影响方向进行加权，最后计算每个样本的EMT得分，并进行均值中心化和标准化.</p></blockquote><p data-tool="mdnice编辑器">先去查看一下帮助文档</p><pre data-tool="mdnice编辑器"><span></span><code><span>##1.1学习函数，先看帮助文档</span><br><span>help</span>(get_emt_score)<br></code></pre><pre data-tool="mdnice编辑器"><span></span><code><span>## No documentation for 'get_emt_score' in specified packages and libraries:</span><br><span>## you could try '??get_emt_score'</span><br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.36875" data-type="png" data-w="480" data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wx4ibGTX2jE3q4LL6wa2ecPszZicdXicx3Bcu6BuknmnQsdk77S9xQTxBeumxUoPXX6gQwELCGK7r63Q/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wx4ibGTX2jE3q4LL6wa2ecPszZicdXicx3Bcu6BuknmnQsdk77S9xQTxBeumxUoPXX6gQwELCGK7r63Q/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"></figure><p data-tool="mdnice编辑器">说是get_emt_score来自于imogimap这个R包：</p><p data-tool="mdnice编辑器">作者就在5天前还在Github上更新了这个R包呢，针不戳！</p><p data-tool="mdnice编辑器">作者的说明和示例链接：https://github.com/korkutlab/imogimap 有兴趣的可以去探索一下。</p><h4 data-tool="mdnice编辑器"><span>根据示例代码安装R包和加载试试</span><span></span></h4><pre data-tool="mdnice编辑器"><span></span><code><span>#1.2 install_github('korkutlab/imogimap')</span><br><br>library(imogimap)<br><br><span>###1.3运行帮助文档中的示例代码</span><br><span>test</span> &lt;- get_emt_score(pdf=sample_mRNA_data)<br>head(<span>test</span>)<br><br><span>##              Tumor_Sample_ID    EMTscore</span><br><span>## TCGA-OR-A5J1    TCGA-OR-A5J1 -0.36354054</span><br><span>## TCGA-OR-A5J2    TCGA-OR-A5J2  0.22618468</span><br><span>## TCGA-OR-A5J3    TCGA-OR-A5J3 -0.25862439</span><br><span>## TCGA-OR-A5J5    TCGA-OR-A5J5 -0.28269131</span><br><span>## TCGA-OR-A5J6    TCGA-OR-A5J6 -0.40581289</span><br><span>## TCGA-OR-A5J7    TCGA-OR-A5J7  0.06495513</span><br></code></pre><p data-tool="mdnice编辑器">是能运行成功的，给出的直接是运行后的结果</p><h4 data-tool="mdnice编辑器"><span>我们来看一下用到的示例数据</span><span></span></h4><p data-tool="mdnice编辑器">查看一下示例数据是什么样的，然后将自己的数据整理成需要的样子就能用了</p><pre data-tool="mdnice编辑器"><span></span><code><span>##1.4查看示例数据</span><br>aa &lt;- sample_mRNA_data<br>head(aa, n = c(5, 4))<br><br><span>##       TCGA-OR-A5J1 TCGA-OR-A5J2 TCGA-OR-A5J3 TCGA-OR-A5J5</span><br><span>## CD27        7.8290      32.8466       6.0198       6.0806</span><br><span>## CD274       1.9212       5.2342       3.5550       3.0984</span><br><span>## CD276    1722.8600    6878.9400    3761.8100    2151.0500</span><br><span>## CD28        4.3228      18.1184       1.7775       4.6476</span><br><span>## CD70        3.3622       1.2079       0.5925      51.8978</span><br></code></pre><p data-tool="mdnice编辑器">示例数据就长上面这样子：看起来像是FPKM或者TPM等这种标准化过后的数据，行是基因，列是样本id。</p><p data-tool="mdnice编辑器">这就简单了，把自己的数据整理一下，交给函数就行了呗！</p><h3 data-tool="mdnice编辑器"><span>2. My data</span></h3><p data-tool="mdnice编辑器">比如这里我用的是TCGA_CESC部分样本的表达量数据，数据下载链接：</p><p data-tool="mdnice编辑器">链接：https://pan.baidu.com/s/1-Krr0XUoFHprCZDfr9RAIw</p><p data-tool="mdnice编辑器">提取码：27zj</p><pre data-tool="mdnice编辑器"><span></span><code><span>###2.1加载数据</span><br>rm(list = ls())<br>load(file = <span>"EMTscore_data.Rdata"</span>)<br><br><span>##要善于查看数据</span><br><span>test</span> &lt;- mydata[1:10,1:10]<span>##行是基因，列是样本id,符合示例数据的样子</span><br>class(mydata)<span>##是数值矩阵，是函数可以接受的形式</span><br><br><span>## [1] "matrix" "array"</span><br><br>head(mydata,n = c(6, 2))<br><br><span>##        TCGA_BI_A0VR_01A_11R_A10U_07 TCGA_BI_A0VS_01A_11R_A10U_07</span><br><span>## MT-CO1                     4107.747                     7158.820</span><br><span>## KRT5                      17100.335                     9978.682</span><br><span>## MT-ND4                     4394.763                     6075.820</span><br><span>## ACTB                       6155.526                     8538.027</span><br><span>## MT-CO3                     4121.420                     3491.540</span><br><span>## KRT17                      2210.063                    10087.605</span><br><br><span>##2.2加载R包</span><br>library(imogimap)<br><br><span>##2.3计算</span><br>emt_score &lt;- get_emt_score(pdf=mydata)<br><br><span>##2.4查看结果</span><br>head(emt_score)<br><br><span>##                                           Tumor_Sample_ID     EMTscore</span><br><span>## TCGA_BI_A0VR_01A_11R_A10U_07 TCGA_BI_A0VR_01A_11R_A10U_07  0.040017811</span><br><span>## TCGA_BI_A0VS_01A_11R_A10U_07 TCGA_BI_A0VS_01A_11R_A10U_07  0.166559936</span><br><span>## TCGA_BI_A20A_01A_11R_A14Y_07 TCGA_BI_A20A_01A_11R_A14Y_07 -0.007191935</span><br><span>## TCGA_C5_A0TN_01A_21R_A14Y_07 TCGA_C5_A0TN_01A_21R_A14Y_07  0.064205527</span><br><span>## TCGA_C5_A1BE_01B_11R_A13Y_07 TCGA_C5_A1BE_01B_11R_A13Y_07 -0.027304791</span><br><span>## TCGA_C5_A1BF_01B_11R_A13Y_07 TCGA_C5_A1BF_01B_11R_A13Y_07  0.466429327</span><br><br>range(emt_score<span>$EMTscore</span>)<br><br><span>## [1] -0.4875358  0.6167771</span><br><br>colnames(emt_score) &lt;- c(<span>"Sample_id"</span>,<span>"EMTscore"</span>)<br></code></pre><h3 data-tool="mdnice编辑器"><span>3. 继续探索</span></h3><p data-tool="mdnice编辑器">虽然这个函数这么简单，但是这个R包应该还有其他内容吧？</p><p data-tool="mdnice编辑器">作者对这个R包的定义如下：</p><blockquote data-tool="mdnice编辑器"><p>The goal of imogimap is to calculate statistical synergy scores based on mRNA expression profiles of multi-sample data to quantify combinatorial effects of single onco-genes or tumor intrinsic onco-genic pathways and immune checkpoints on immune related phenotype in tumor microenvironment.</p></blockquote><blockquote data-tool="mdnice编辑器"><p>imogimap的目标是根据多样本数据的mRNA表达谱计算出统计学上的协同作用分数，以量化单一协同基因或肿瘤内在协同基因途径和免疫检查点对肿瘤微环境中免疫相关表型的组合效应。</p></blockquote><p data-tool="mdnice编辑器">想必作者的R包中还有其他函数，可以进一步探索。</p><p data-tool="mdnice编辑器">R包中还有一部分内置数据，比如EMT_gene_list就是是用于EMTscore</p><p data-tool="mdnice编辑器">计算的77个EMT相关基因列表。</p><p data-tool="mdnice编辑器">如果觉得有用可以借助帮助文档和作者发表的文章继续探索，我就先退下了！</p><h3 data-tool="mdnice编辑器"><span>4. 且慢</span></h3><p data-tool="mdnice编辑器">搞科研怎么能只得到结果就算完，不得证明数据可靠性嘛：</p><p data-tool="mdnice编辑器">好吧，2017Nature发表的文章（doi:10.1038/nature21386）Supplemental Table1 种对我纳入的这部分</p><p data-tool="mdnice编辑器">宫颈癌患者计算了EMTscore，作者对计算方法的描述如下：</p><blockquote data-tool="mdnice编辑器"><p>S12. EMT mRNA Score Analysis Methods The EMT score was computed as previously described[10,21]. Briefly, the EMT score was the value resulting from the difference between the average expression of mesenchymal (M) genes minus the average expression of epithelial (E) genes.All NA values were removed from the calculation.Two-sample t-test and ANOVA were applied to each comparison accordingly. A Cox proportional hazards model was applied to assess whether the EMT score was associated with overall survival.Kalplan-Meier plots (Log-rank test) were used to display the difference between groups (the median value of EMT score of samples).</p></blockquote><p data-tool="mdnice编辑器">好像就是jimmy老师在帖子中说的：</p><blockquote data-tool="mdnice编辑器"><p>总结起来，其实超级简单，就是选取高表达量的EMT基因，然后6个mesenchymal基因的log2 Z scores 值的和，减去6个epithelial 基因的log2 Z scores 值的和，所以这个EMT 打分越高就说明它是mesenchymal的。</p></blockquote><p data-tool="mdnice编辑器">对大佬来说总是超级简单！</p><p data-tool="mdnice编辑器">但是我想说：真的吗？我不信！</p><figure data-tool="mdnice编辑器"><img data-ratio="1.0020833333333334" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/cZNhZQ6j4wx4ibGTX2jE3q4LL6wa2ecPs20YV0cQZNkBbyZWm2jnBJPSnibQG1XVX6fq6tmyicSPMvO5GVErFf9Xw/640?wx_fmt=jpeg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" data-type="jpeg" data-w="480" src="https://mmbiz.qpic.cn/mmbiz_jpg/cZNhZQ6j4wx4ibGTX2jE3q4LL6wa2ecPs20YV0cQZNkBbyZWm2jnBJPSnibQG1XVX6fq6tmyicSPMvO5GVErFf9Xw/640?wx_fmt=jpeg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"><figcaption>image.jpeg</figcaption></figure><p data-tool="mdnice编辑器">这时候才恍然明白，曾老师在群里一开始就告诉我答案了，e和m分开</p><p data-tool="mdnice编辑器">算，就是Nature文章中说的方法嘛，怪我没认真看文章内容！</p><p data-tool="mdnice编辑器">好吧，那我也有始有终，比较一下这个简单的函数计算的EMTscore和大佬们的方法有没有出入</p><h3 data-tool="mdnice编辑器"><span>5. 对比结果</span></h3><pre data-tool="mdnice编辑器"><span></span><code><span>###5.1读取Nature文章的数据</span><br>nn &lt;- read.csv(file = <span>"Nature_Supplemental_Table1.csv"</span>,header = T,row.names = 1)<br><br>nEMT &lt;- data.frame(Sample_id=rownames(nn),nature_EMTscore=nn<span>$SAMP</span>.EMT_score)<br></code></pre><p data-tool="mdnice编辑器">与emt_score合并到一个数据框中进行比较</p><p data-tool="mdnice编辑器">你不会已经忘了emt_score是个什么东西了吧？</p><p data-tool="mdnice编辑器">是前面get_emt_score函数计算得到的EMTscore啊</p><pre data-tool="mdnice编辑器"><span></span><code><span>###5.2检查数据</span><br><span>##是不是要先看一下两个数据的样本是不是一样滴啊？要不然没有比较的意义啊！</span><br>head(nEMT<span>$Sample_id</span>)<br></code></pre><pre data-tool="mdnice编辑器"><span></span><code><span>## [1] "TCGA-BI-A0VR-01A" "TCGA-BI-A0VS-01A" "TCGA-BI-A20A-01A" "TCGA-C5-A0TN-01A"</span><br><span>## [5] "TCGA-C5-A1BE-01B" "TCGA-C5-A1BF-01B"</span><br><br>head(emt_score<span>$Sample_id</span>)<br><br><span>## [1] "TCGA_BI_A0VR_01A_11R_A10U_07" "TCGA_BI_A0VS_01A_11R_A10U_07"</span><br><span>## [3] "TCGA_BI_A20A_01A_11R_A14Y_07" "TCGA_C5_A0TN_01A_21R_A14Y_07"</span><br><span>## [5] "TCGA_C5_A1BE_01B_11R_A13Y_07" "TCGA_C5_A1BF_01B_11R_A13Y_07"</span><br><br><span>##先要调整一下两个数据框的样本id格式</span><br>library(stringr)<br>nEMT<span>$Sample_id</span> &lt;- str_replace_all(nEMT<span>$Sample_id</span>,<span>"-"</span>,<span>"_"</span>);head(nEMT<span>$Sample_id</span>)<br><br><span>## [1] "TCGA_BI_A0VR_01A" "TCGA_BI_A0VS_01A" "TCGA_BI_A20A_01A" "TCGA_C5_A0TN_01A"</span><br><span>## [5] "TCGA_C5_A1BE_01B" "TCGA_C5_A1BF_01B"</span><br><br>emt_score<span>$Sample_id</span> &lt;- str_sub(emt_score<span>$Sample_id</span>,1,16);head(emt_score<span>$Sample_id</span>)<br><br><span>## [1] "TCGA_BI_A0VR_01A" "TCGA_BI_A0VS_01A" "TCGA_BI_A20A_01A" "TCGA_C5_A0TN_01A"</span><br><span>## [5] "TCGA_C5_A1BE_01B" "TCGA_C5_A1BF_01B"</span><br><br>table(nEMT<span>$Sample_id</span> %<span>in</span>% emt_score<span>$Sample_id</span>)<span>##178例样本是同一批</span><br><br><span>## </span><br><span>## TRUE </span><br><span>##  178</span><br><br><span>##这时就可以直接merge了</span><br>how &lt;- merge(emt_score,nEMT,by=<span>"Sample_id"</span>)<br>head(how)<br><br><span>##          Sample_id     EMTscore nature_EMTscore</span><br><span>## 1 TCGA_BI_A0VR_01A  0.040017811          -1.077</span><br><span>## 2 TCGA_BI_A0VS_01A  0.166559936          -0.194</span><br><span>## 3 TCGA_BI_A20A_01A -0.007191935          -1.534</span><br><span>## 4 TCGA_C5_A0TN_01A  0.064205527           0.422</span><br><span>## 5 TCGA_C5_A1BE_01B -0.027304791          -1.935</span><br><span>## 6 TCGA_C5_A1BF_01B  0.466429327           0.130</span><br></code></pre><p data-tool="mdnice编辑器">先看一下两种方法的取值范围</p><pre data-tool="mdnice编辑器"><span></span><code><span>##5.3先看结果的取值范围</span><br>range(how<span>$EMTscore</span>)<br><br><span>## [1] -0.4875358  0.6167771</span><br><br>range(how<span>$nature_EMTscore</span>)<br><br><span>## [1] -3.756  1.152</span><br></code></pre><p data-tool="mdnice编辑器">貌似差别很大哦，但是仔细一想，我们应该看趋势，不应该看取值</p><p data-tool="mdnice编辑器">那么问题又来了，该怎么比较呢？</p><p data-tool="mdnice编辑器">我可真会给自己挖坑啊！</p><p data-tool="mdnice编辑器">再问问Bing吧，它真的很聪明！</p><figure data-tool="mdnice编辑器"><img data-ratio="1.6693548387096775" data-type="png" data-w="372" data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wx4ibGTX2jE3q4LL6wa2ecPs5JSOLicfFRgFibOVLjwsfrh7uHjpUFia5rn3nDw971vPycRTRKH0NsL8Q/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wx4ibGTX2jE3q4LL6wa2ecPs5JSOLicfFRgFibOVLjwsfrh7uHjpUFia5rn3nDw971vPycRTRKH0NsL8Q/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"></figure><p data-tool="mdnice编辑器">又说到了统计方法，好难啊!!!</p><p data-tool="mdnice编辑器">我们选择计算一下相关性系数和绘制折线图看看吧</p><h3 data-tool="mdnice编辑器"><span>探索相关性</span></h3><pre data-tool="mdnice编辑器"><span></span><code><span>##5.4相关性系数和相关性散点图</span><br>cor &lt;- cor.test(how<span>$EMTscore</span>,how<span>$nature_EMTscore</span>);cor<span>##相关性系数为0.629，能说明问题吗？</span><br><br><span>## </span><br><span>##  Pearson's product-moment correlation</span><br><span>## </span><br><span>## data:  how$EMTscore and how$nature_EMTscore</span><br><span>## t = 10.759, df = 176, p-value &lt; 2.2e-16</span><br><span>## alternative hypothesis: true correlation is not equal to 0</span><br><span>## 95 percent confidence interval:</span><br><span>##  0.5320809 0.7110785</span><br><span>## sample estimates:</span><br><span>##       cor </span><br><span>## 0.6298713</span><br><br><span>###画图更直观</span><br>library(ggplot2)<br>library(ggpubr)<br>ggplot(how, aes(x = EMTscore, y = nature_EMTscore)) +<br>  geom_point(aes(colour = <span>"#368ad9"</span>)) +<br>  geom_smooth(method = <span>"lm"</span>)+<br>  stat_cor(method = <span>"pearson"</span>)+<br>  theme_classic()<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.7145833333333333" data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wx4ibGTX2jE3q4LL6wa2ecPsyFoyB63ibG5rwkfcun8kkAZCkIxC66jsWsVXVE23T1wJtMiaS0h6pQMg/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" data-type="png" data-w="480" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wx4ibGTX2jE3q4LL6wa2ecPsyFoyB63ibG5rwkfcun8kkAZCkIxC66jsWsVXVE23T1wJtMiaS0h6pQMg/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"></figure><h5 data-tool="mdnice编辑器">绘制折线图</h5><p data-tool="mdnice编辑器">绘制折线图，需要把两个结果绘制到一张图上哦，先要将数据进行宽长转换</p><pre data-tool="mdnice编辑器"><span></span><code><span>###5.5绘制折线图</span><br>library(tidyr)<br>library(ggplot2)<br><span>###转换数据框为长格式</span><br>colnames(how) <br><br><span>## [1] "Sample_id"       "EMTscore"        "nature_EMTscore"</span><br><br>dd_long &lt;- pivot_longer(how, cols = c(<span>"EMTscore"</span>, <span>"nature_EMTscore"</span>), names_to = <span>"group"</span>, values_to = <span>"score"</span>)<br><br><span>##画图</span><br>ggplot(data = dd_long, <br>       mapping = aes(x = Sample_id, <br>                    y = score, <br>                    group=group,<br>                    linetype = group,<br>                    colour = group, <br>                    shape = group, <br>                    fill = group))+ <br> geom_line() + <br> geom_point() + <span>#绘制线图和点图 </span><br> scale_linetype_manual(values = c(1,2)) +  <span>#自定义线条类型</span><br> scale_color_manual(values = c(<span>'steelblue'</span>,<span>'#e24b24'</span>)) + <span>#自定义颜色</span><br> scale_shape_manual(values = c(21,23)) + <span>#自定义点形状</span><br> scale_fill_manual(values = c(<span>'blue'</span>,<span>'red'</span>)) <span>#自定义点的填充色</span><br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.7148148148148148" data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wx4ibGTX2jE3q4LL6wa2ecPsyONqW4klY4ibRFxfj2xSCADzBnXIYNXPrjFsXibmXoP51miafcicZCuQXg/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wx4ibGTX2jE3q4LL6wa2ecPsyONqW4klY4ibRFxfj2xSCADzBnXIYNXPrjFsXibmXoP51miafcicZCuQXg/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"></figure><p data-tool="mdnice编辑器">大致看起来趋势是一致的，应该是没问题的吧，如有争议，请选择其他方法！</p><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><h3 data-tool="mdnice编辑器"><span></span>这个New bing 整合了chatGPT<span></span></h3><p>看到这里肯定是很多人感兴趣我是如何通过这个New Bing对话模式解决代码编程问题的，其实本质上还是chatGPT，大家很容易搜索到很多相关使用教程，我们这里就不赘述了。但是考虑到昨天很多人还没有来得及进群：<a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247520756&amp;idx=1&amp;sn=ebdf0510a41b450c944bd5befd802d37&amp;chksm=9b4bd14fac3c5859cbd73941bacf599f9e123a79845daf52127bb3703e004fdaae676dbe8b7e&amp;scene=21#wechat_redirect" textvalue="chatGPT在生物信息学的应用讨论组" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2">chatGPT在生物信息学的应用讨论组</a> ，但是确实名额有限，我们开通2群，欢迎感兴趣的小伙伴进来一起讨论如何更好的使用chatGPT辅助我们完成生物信息学数据分析哦。<br></p></section><p data-tool="mdnice编辑器">如果你有chatGPT在日常生物信息学数据处理的案例分享，或者说想体验chatGPT等AI在的神奇之处，我们组建了一个讨论组：</p><p data-tool="mdnice编辑器"><span>前面的200个小伙伴可以扫码自助入群哈！（已经在<span>群：</span><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247520756&amp;idx=1&amp;sn=ebdf0510a41b450c944bd5befd802d37&amp;chksm=9b4bd14fac3c5859cbd73941bacf599f9e123a79845daf52127bb3703e004fdaae676dbe8b7e&amp;scene=21#wechat_redirect" textvalue="chatGPT在生物信息学的应用讨论组" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2">chatGPT在生物信息学的应用讨论组</a><span> 的请不要重复扫码，把机会留给有需要的小伙伴哈</span>）</span></p><p><img data-galleryid="" data-ratio="1.6612903225806452" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/cZNhZQ6j4wx4ibGTX2jE3q4LL6wa2ecPsPoUrZc52O47urgvK2hToRg0e3ib20Xjibk6deH5ztlFAISEPfTuUSdtw/640?wx_fmt=jpeg" data-type="png" data-w="930" src="https://mmbiz.qpic.cn/mmbiz_jpg/cZNhZQ6j4wx4ibGTX2jE3q4LL6wa2ecPsPoUrZc52O47urgvK2hToRg0e3ib20Xjibk6deH5ztlFAISEPfTuUSdtw/640?wx_fmt=jpeg"></p><p data-tool="mdnice编辑器"><span></span></p><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><p data-tool="mdnice编辑器"><strong>如果上面的二维码无法进群</strong>，说明已经满员（200让）了，需要我们生信技能树的官方拉群小助手帮忙拉群哦！！！（免费，但是名额有限，500让，先到先得！！！）<span></span></p><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><p><span><strong><span>长按识别二维码</span></strong></span></p><p><br></p><p><span><strong><span>烦请备注姓名学校单位信息</span></strong></span></p><p><img data-ratio="1.0287769784172662" data-s="300,640" data-type="png" data-w="278" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosickmVcW0l8px8WgmyDMn5eHrkIDyib4m6Q8JqPY9kpCyibaDGD2f0Qv6fofUKc1cf8MHemJ9fX2hiawQ/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosickmVcW0l8px8WgmyDMn5eHrkIDyib4m6Q8JqPY9kpCyibaDGD2f0Qv6fofUKc1cf8MHemJ9fX2hiawQ/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"></p></section></section></section></section></section></section></section></section></section></section></section><ul data-tool="mdnice编辑器"></ul></section><h3 data-tool="mdnice编辑器">  </h3><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/sGQdwgGoySl9pI0Zhx_LSA",target="_blank" rel="noopener noreferrer">原文链接</a>
