---
title: "网页工具可能没必要使用，但它很适合学习底层原理"
date: 2023-09-25T05:19:45Z
draft: ["false"]
tags: [
  "fetched",
  "生信技能树"
]
categories: ["Acdemic"]
---
网页工具可能没必要使用，但它很适合学习底层原理 by 生信技能树
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><blockquote data-tool="mdnice编辑器"><p>最近刷到了生物信息学领域著名期刊NAR的最新文章：《NORMSEQ – a tool for evaluation, selection and visualization of RNA-Seq normalization methods》是一个网页工具，NORMSEQ，它介绍了一些转录组测序表达量矩阵的归一化标准化方法学而且提供了一个在线网页工具给大家使用。</p></blockquote><p data-tool="mdnice编辑器">之所以注意到它，是因为NORMSEQ的流程图画的很吸引眼球：</p><p><img data-galleryid="" data-ratio="0.6083333333333333" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wzu034pWOcntWVGsiaa2du85BKL4TQlos6BuZMCIexOv4ROamn43wPK20dsxrtBSeXFy3LKiciat6Dgw/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wzu034pWOcntWVGsiaa2du85BKL4TQlos6BuZMCIexOv4ROamn43wPK20dsxrtBSeXFy3LKiciat6Dgw/640?wx_fmt=png"></p><figure data-tool="mdnice编辑器"><figcaption>NORMSEQ的流程图</figcaption></figure><p data-tool="mdnice编辑器">它起初是为了解决他们课题组自己的tRNA相关转录组测序表达量矩阵的归一化标准化问题，之前的文章是Quantitative tRNA-sequencing uncovers metazoan tissue-specific tRNA regulation. Nat Commun. 2020 Aug 14;11(1):4104. doi: 10.1038/s41467-020-17879-x. 对应的数据集是GSE141436. 是一个tRNA expression dataset ，里面有  21 different samples from seven mouse tissues ，这样的矩阵确实是超出了我的能力范围：</p><pre data-tool="mdnice编辑器"><span></span><code>GSE141436_293FlpIn_DM_isodecoder_raw_counts.csv.gz 3.0 Kb <br>GSE141436_293FlpIn_isodecoder_raw_counts.csv.gz 12.1 Kb <br>GSE141436_Mouse_tissue_anticodon_raw_counts.csv.gz 3.6 Kb <br>GSE141436_Mouse_tissue_isodecoder_raw_counts.csv.gz 12.9 Kb <br>GSE141436_Mouse_tissue_variant_counts.csv.gz 720.5 Kb <br>GSE141436_Mouse_tissue_variant_counts_DM.csv.gz 136.2 Kb <br></code></pre><p data-tool="mdnice编辑器">现在它也可以针对普通的mRNA的转录组测序表达量矩阵的归一化标准化，提供如下所示：</p><ul data-tool="mdnice编辑器"><li><section>No normalization, just visualization</section></li><li><section>Counts per Million</section></li><li><section>Upper Quartile</section></li><li><section>Median</section></li><li><section>TMM</section></li><li><section>Quantile</section></li><li><section>Remove Unwanted Variation - RUVs</section></li><li><section>Relative Log Expression</section></li></ul><p data-tool="mdnice编辑器">上面的每一个算法都对应着曾经“风靡一时”的普通的mRNA的转录组测序表达量矩阵的归一化标准化：</p><p><img data-galleryid="" data-ratio="0.9564814814814815" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wzu034pWOcntWVGsiaa2du85UOIOcIM0kqlSSib1P90uB6VwtQcGlqHqibCNR9sxksiaDOeicibn8HEDTLw/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wzu034pWOcntWVGsiaa2du85UOIOcIM0kqlSSib1P90uB6VwtQcGlqHqibCNR9sxksiaDOeicibn8HEDTLw/640?wx_fmt=png"></p><figure data-tool="mdnice编辑器"><figcaption>普通的mRNA的转录组测序表达量矩阵的归一化标准化</figcaption></figure><p data-tool="mdnice编辑器">一般来说，我们简化这个普通的mRNA的转录组测序表达量矩阵的归一化标准化，我们最常用的是普通的CPM，就是，比如可以拿它来绘制PCA图：</p><pre data-tool="mdnice编辑器"><span></span><code>colnames(symbol_matrix)<br>symbol_matrix[<span>1</span>:<span>4</span>,<span>1</span>:<span>4</span>] <span>## 基因名字的样品，矩阵</span><br>dat = log2(edgeR::cpm(symbol_matrix)+<span>1</span>)<br>dat[<span>1</span>:<span>4</span>,<span>1</span>:<span>4</span>]<br>boxplot(dat,las=<span>2</span>)<br>table(group_list)<br><br><br>exp=t(dat)<span>#画PCA图时要求是行名时样本名，列名时探针名，因此此时需要转换</span><br>exp=as.data.frame(exp)<span>#将matrix转换为data.frame </span><br><br><span>library</span>(<span>"FactoMineR"</span>)<span>#画主成分分析图需要加载这两个包</span><br><span>library</span>(<span>"factoextra"</span>)  <br><span>#～～～主成分分析图p2～～～</span><br>dat.pca &lt;- PCA(exp , graph = <span>FALSE</span>)<br>this_title &lt;- paste0(pro,<span>'_PCA'</span>)<br>p2 &lt;- fviz_pca_ind(dat.pca,<br>                   geom.ind = <span>"point"</span>,  <span>#c( "point", "text" ), # show points only (nbut not "text")</span><br>                   col.ind = group_list, <span># color by groups</span><br>                   palette = <span>"Dark2"</span>,<br>                   addEllipses = <span>TRUE</span>, <span># Concentration ellipses</span><br>                   legend.title = <span>"Groups"</span>)+<br>  ggtitle(this_title)+ <br>  theme(plot.title = element_text(size=<span>12</span>,hjust = <span>0.5</span>))<br><br></code></pre><p data-tool="mdnice编辑器">实际上也可以首先把它这个普通的mRNA的转录组测序表达量矩阵的归一化标准化，不仅仅是普通的CPM矩阵形式：</p><pre data-tool="mdnice编辑器"><span></span><code><span># 魔幻操作，一键清空</span><br>rm(list = ls()) <br>options(stringsAsFactors = <span>F</span>)<br><span>library</span>(data.table)<br>load(file = <span>'symbol_matrix.Rdata'</span>)<br>symbol_matrix[<span>1</span>:<span>4</span>,<span>1</span>:<span>4</span>]<br><br><span>library</span>(limma)<br><span>library</span>(edgeR)<br><span>library</span>(DESeq2)<br><span>library</span>(ggplot2)<br><br>load(file = <span>'symbol_matrix.Rdata'</span>) <br>symbol_matrix[<span>1</span>:<span>4</span>,<span>1</span>:<span>4</span>]<br>exprSet = symbol_matrix <br>(colData &lt;- data.frame(row.names=colnames(exprSet), <br>                       group_list=group_list) )<br>dds &lt;- DESeqDataSetFromMatrix(countData = exprSet,<br>                              colData = colData,<br>                              design = ~ group_list)<br>dds &lt;- DESeq(dds) <br>dds &lt;- estimateSizeFactors(dds)<br>rld &lt;- rlog(dds, blind=<span>FALSE</span>)<br>levels(rld$group_list) <br>assay(rld)[<span>1</span>:<span>4</span>,<span>1</span>:<span>4</span>] <br><br><span>#画PCA图时要求是行名时样本名，列名时探针名，因此此时需要转换</span><br><span>#将matrix转换为data.frame </span><br>exp=as.data.frame(t(assay(rld)))<br>exp[<span>1</span>:<span>4</span>,<span>1</span>:<span>4</span>]<br><br><span>library</span>(<span>"FactoMineR"</span>)<span>#画主成分分析图需要加载这两个包</span><br><span>library</span>(<span>"factoextra"</span>)  <br><span>#～～～主成分分析图p2～～～</span><br>dat.pca &lt;- PCA(exp , graph = <span>FALSE</span>) <br>p2 &lt;- fviz_pca_ind(dat.pca,<br>                   geom.ind = <span>"point"</span>,  <span>#c( "point", "text" ), # show points only (nbut not "text")</span><br>                   col.ind = group_list, <span># color by groups</span><br>                   palette = <span>"Dark2"</span>,<br>                   addEllipses = <span>TRUE</span>, <span># Concentration ellipses</span><br>                   legend.title = <span>"Groups"</span>)+ <br>  theme(plot.title = element_text(size=<span>12</span>,hjust = <span>0.5</span>)) <br></code></pre><p data-tool="mdnice编辑器">但是从PCA的角度来看，基本上没什么区别，其实就是说前面列出来了的 Counts Per Million (CPM), Upper Quantile (UQ), Median (Med), Trimmed mean of M values (TMM), Quantile (QN), Relative Log Expression (RLE) and Remove Unwanted Variation in its RUVs version ，普通用户其实无需考虑那么多，任选其一即可，比如我就喜欢CPM格式进行后续可视化。</p><p data-tool="mdnice编辑器">不过，仍然是需要值得注意的可能是 批次效应，如果有的话！！！</p><p data-tool="mdnice编辑器">另外，其实我们并不喜欢在线网页工具，需要 uploading a file in <em>txt</em>, <em>csv</em>, <em>tsv</em> or <em>xls</em> formats  然后等网页返回处理好的结果，对我们来说就是首先得把数据从R里面写出来，然后结果再读入R里面，浪费时间。感兴趣的可以读一下它的源代码：</p><ul data-tool="mdnice编辑器"><li><section>NormSeq is freely available for all users at: https://arn.ugr.es/normSeq/</section></li><li><section>the source code is available at https://github.com/cris12gm/normSeq.</section></li></ul><p data-tool="mdnice编辑器">是Python开发的哦！</p></section><h4 data-tool="mdnice编辑器">文末友情宣传</h4><p data-tool="mdnice编辑器">强烈建议你推荐给身边的<strong>博士后以及年轻生物学PI</strong>，多一点数据认知，让他们的科研上一个台阶：</p><ul data-tool="mdnice编辑器"><li><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247524930&amp;idx=5&amp;sn=19d5eb52cbba6389c6238cd7943d96c7&amp;chksm=9b4b22f9ac3cabefa5c0436a6e723c3ad447fd67bdd2f9d500043220c5e97e6934b6015977e3&amp;scene=21#wechat_redirect" textvalue="生物信息学马拉松授课（买一得‍五）" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2">生物信息学马拉松授课（买一得五）</a> ，你的生物信息学入门课</section></li><li><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247524148&amp;idx=1&amp;sn=7806da6feb41a36493c519c1cfc1d3ac&amp;chksm=9b4bdf8fac3c569960369602f1ef26639cb366b250f233b2297d1f059471c0458335bfc0b829&amp;scene=21#wechat_redirect" textvalue="时隔5年，我们的生信技能树VIP学徒继续招生啦" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1">时隔5年，我们的生信技能树VIP学徒继续招生啦</a><br></section></li><li><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247522831&amp;idx=2&amp;sn=1744efdf428465425a145ff3a982198b&amp;chksm=9b4bdab4ac3c53a28fbecbbff4f254f470b54a7a20468bb753b295b930315e1ec45bcbabc10b&amp;scene=21#wechat_redirect" textvalue="144线程640Gb内存服务器共享一年‍仍然是仅需800" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1">144线程640Gb内存服务器共享一年仍然是仅需800</a></section></li><li><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247519765&amp;idx=1&amp;sn=ce5a8c8182f854c88043059f8c2cb9ff&amp;chksm=9b4bceaeac3c47b88c19941d43dbb1401f3a92206481a0afc41159927868199643f795d62a7e&amp;scene=21#wechat_redirect" textvalue="千呼万唤始出来的独享生物信息学云服务器" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1">千呼万唤始出来的独享生物信息学云服务器</a></section></li><li><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247519765&amp;idx=1&amp;sn=ce5a8c8182f854c88043059f8c2cb9ff&amp;chksm=9b4bceaeac3c47b88c19941d43dbb1401f3a92206481a0afc41159927868199643f795d62a7e&amp;scene=21#wechat_redirect" textvalue="千呼万唤始出来的独享生物信息学云服务器" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1"></a><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247524275&amp;idx=1&amp;sn=fa592ee29f636f34387491d0fceadd8e&amp;chksm=9b4bdf08ac3c561e0881974b3817beb0a0e514dc1a8df4c34c2b6653da6fa78e09acb03c70c2&amp;scene=21#wechat_redirect" textvalue="生信技能树知识整理实习生又又又开放申请啦" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1">生信技能树知识整理实习生又又又开放申请啦</a></section></li><li><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247524432&amp;idx=1&amp;sn=5b33b0c6807a9e6939c332c58fabff89&amp;chksm=9b4b20ebac3ca9fdb3d8bfaf2bef5552f64eb70e7fae557cc7197fb1a23b3e8bc31b585bf829&amp;scene=21#wechat_redirect" textvalue="生信共享办公室出租" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1">生信共享办公室出租</a></p></li></ul><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/PEzFXnRZ60gmiRtXqv-zuQ",target="_blank" rel="noopener noreferrer">原文链接</a>
