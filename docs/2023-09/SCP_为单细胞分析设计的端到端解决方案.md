---
title: "SCP—为单细胞分析设计的端到端解决方案"
date: 2023-09-22T15:45:40Z
draft: ["false"]
tags: [
  "fetched",
  "单细胞天地"
]
categories: ["Acdemic"]
---
SCP—为单细胞分析设计的端到端解决方案 by 单细胞天地
------
<div><section data-style-type="5" data-tools="新媒体排版" data-id="2430070"><section data-style-type="5" data-tools="新媒体排版" data-id="2390348"><section><section powered-by="xiumi.us"><section><section><section powered-by="xiumi.us"><section><section><br></section><section><section><section powered-by="xiumi.us"><section><section><p>分享是一种态度</p></section></section></section></section></section></section></section></section><section><section powered-by="xiumi.us"><section><section><img data-ratio="0.8738095238095238" data-src="https://mmbiz.qpic.cn/mmbiz_gif/siaia0BDGJdjSnnb9ibXpFagGPWQ0JjSSTNVBZthROEhicfINuLcxX2Ro3Zb600LJhrzeYIb120tLjSVXEtLn14DwA/640?wx_fmt=gif" data-type="gif" data-w="420" width="100%" src="https://mmbiz.qpic.cn/mmbiz_gif/siaia0BDGJdjSnnb9ibXpFagGPWQ0JjSSTNVBZthROEhicfINuLcxX2Ro3Zb600LJhrzeYIb120tLjSVXEtLn14DwA/640?wx_fmt=gif"></section></section></section></section></section></section></section></section></section><section><section><p><span>书接上文【</span><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247516039&amp;idx=1&amp;sn=9a706da8bacc5801eae7a03b4ccc5c36&amp;chksm=ea1cb905dd6b3013a30c140a8c919b53cb61ce502b335700dbf17e91f09a70b845379255f99c&amp;scene=21#wechat_redirect" textvalue="端到端的单细胞管道SCP-安装" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2"><span>端到端的单细胞管道SCP-安装</span></a><span>】，可能很多读者不清楚SCP可以做什么？这里给大家补一个序言。</span></p></section></section><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><h2 data-tool="mdnice编辑器"><span></span><span>序</span></h2><p data-tool="mdnice编辑器">单细胞时代刷新了微观世界下观察的分辨率，也让科学研究更接近于真相。</p><p data-tool="mdnice编辑器">尽管如此，单细胞也更暴露出了比以往bulk测序研究更多的问题。</p><p data-tool="mdnice编辑器">技术层面上的问题例如基因究竟在一个细胞中表达与否、数据集之间的批次效应如何消除，等等；生物层面上的问题例如如何定义一个细胞类型或状态、细胞从哪来到哪去、基因或细胞之间是如何协同的，等等。</p><p data-tool="mdnice编辑器">然而一旦模糊的界限被打破，就已无法回避。</p><p data-tool="mdnice编辑器">生信的开发领域中已经诞生了大量优秀的算法、软件，来解决上述的各类问题。但如同机器学习领域一样，许多算法存在有限的泛化能力，导致在生信的应用领域中，会在错误的时刻发生错误的调用及解读。</p><p data-tool="mdnice编辑器">作为生信应用研究人员，此时想回答生物学层面的问题就需要同时回答技术层面的问题，这种”既要又要”无疑在迫使生信分析人员转变角色，成为真正的左手技术、右手生物的生信科学家。</p><p data-tool="mdnice编辑器">这里的”技术”强调下，它并不指代编程能力，也不指代算法开发上的能力，而是指一种在”生物信息”角度上对科学的辩证思维：时刻围绕着中心法则构建和完善生物世界观，并对所有生物数据是如何产生的、如何反应生物本身等进行不断的质疑与推断，学习理解常用算法背后的原理及其缺陷，避免让自己陷入黑盒。</p><p data-tool="mdnice编辑器">最终，结合产生数据的技术背景和生物学背景，借助各类工具全方位、多角度的探索数据，才可以在分析中有效推断出微观世界所发生着的各类事件，才可以对上述问题做出更自信的回答。</p><hr data-tool="mdnice编辑器"><h2 data-tool="mdnice编辑器"><span></span><span>SCP (Single-Cell Pipeline)</span></h2><p data-tool="mdnice编辑器">SCP是一个端到端单细胞数据分析管道，可实现数据从下机后的处理、分析、共享和发表的全部工作。管道意味着极简、标准化、模块化，SCP的特点是<span>简洁</span>、<span>全面</span>、<span>高效</span>，让单细胞的科学研究更专注于科学本身。</p><p data-tool="mdnice编辑器">SCP中的所有方法根据分析类型主要分为三个模块，包括了<span>数据预处理模块</span>、<span>下游分析模块</span>和<span>可视化模块</span>。借助<span>reticulate</span><sup>[1]</sup>，SCP也在内部创建了一个python环境环境来整合python相关的工具和方法，让其在R/Rstudio中即可完成调用和结果解析。</p><p data-tool="mdnice编辑器">SCP中的所有方法均围绕Seurat对象（SeuratV4）开发，虽然如此，利用转换函数<code>adata_to_srt()</code>我们依然可以在任意时候从python中的经典的<span>AnnData</span><sup>[2]</sup>对象出发（.h5ad）。</p><figure data-tool="mdnice编辑器"><img data-ratio="0.7296296296296296" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSMUQD7AqmtMxTqg6bu8C9LwMic0Ric3w3MeZuic8m9FqfwxO337Xfw1n93giaMlVWE1RdicrrI06dqKoA/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSMUQD7AqmtMxTqg6bu8C9LwMic0Ric3w3MeZuic8m9FqfwxO337Xfw1n93giaMlVWE1RdicrrI06dqKoA/640?wx_fmt=png"></figure><hr data-tool="mdnice编辑器"><h2 data-tool="mdnice编辑器"><span></span><span>SCP各模块内容</span></h2><h3 data-tool="mdnice编辑器"><span></span><span>前处理：</span><span></span></h3><ul data-tool="mdnice编辑器"><li><section>4种doublets鉴定方法（scDblFinder, scds, Scrublet, DoubletDetection）</section></li><li><section>多种指标下的综合质控（doublets, outlier, umi, gene, mito, ribo,ribo_mito_ratio, species）</section></li><li><section>标准的单细胞处理流程（Normalization, Feature selection, Dimensionreduction, Clustering）</section></li><li><section>11种批次矫正的单细胞整合处理流程（Seurat, scVI, MNN, fastMNN, Harmony,Scanorama, BBKNN, CSS, LIGER, Conos, Combat）</section></li><li><section>5种线性降维和8种非线性降维方法</section></li></ul><figure data-tool="mdnice编辑器"><img data-ratio="0.7194444444444444" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSMUQD7AqmtMxTqg6bu8C9LpVuU18Gusq6gN5WASHpTZ04LmO0oMAic5PmrPLVYLicAmjhV7gGPH7IA/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSMUQD7AqmtMxTqg6bu8C9LpVuU18Gusq6gN5WASHpTZ04LmO0oMAic5PmrPLVYLicAmjhV7gGPH7IA/640?wx_fmt=png"></figure><h3 data-tool="mdnice编辑器"><span></span><span>下游分析：</span><span></span></h3><ul data-tool="mdnice编辑器"><li><section>20多种基因注释数据库、多物种、多基因ID类型的自动构建方法</section></li><li><section>4种差异基因鉴定流程（All, Paired, Conserved, Distrubed）</section></li><li><section>ORA和GSEA两种富集分析方法</section></li><li><section>3种特征打分方法（Seurat, Ucell, AUcell）</section></li><li><section>5种细胞映射方法（KNNMap, PCAMap, SeuratMap, CSSMap,SymphonyMap）和3种细胞自动注释方法（KNNpredict, scmap, SingleR）</section></li><li><section>7种细胞轨迹推断方法（Slingshot, PAGA, scVelo, Palantir, Monocle2,Monocle3, WOT）和基于pseudotime的动态特征鉴定方法</section></li></ul><figure data-tool="mdnice编辑器"><img data-ratio="0.5648148148148148" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSMUQD7AqmtMxTqg6bu8C9L8gAOnnUdaNMoAicicv1EkicPHZqTr9Ane3tFjYicbuzNxfHPPqIOOiaRCmg/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSMUQD7AqmtMxTqg6bu8C9L8gAOnnUdaNMoAicicv1EkicPHZqTr9Ane3tFjYicbuzNxfHPPqIOOiaRCmg/640?wx_fmt=png"></figure><h3 data-tool="mdnice编辑器"><span></span><span>可视化：</span><span></span></h3><ul data-tool="mdnice编辑器"><li><section>200多种离散型和连续型调色板</section></li><li><section>两种常用的绘图主题，分别用于分析和发表</section></li><li><section>图片的后期调整和格栅化方法</section></li><li><section>20多种绘图函数，可绘制上百种图像类型</section></li><li><section>快速构建交互式的单细胞数据查询网页SCExplorer</section></li></ul><figure data-tool="mdnice编辑器"><img data-ratio="0.6231481481481481" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSMUQD7AqmtMxTqg6bu8C9LxyFonExdLLibic73A50mr3aA8KlZb53kD6Rb9LbOGszVwlvFC5IITA5w/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSMUQD7AqmtMxTqg6bu8C9LxyFonExdLLibic73A50mr3aA8KlZb53kD6Rb9LbOGszVwlvFC5IITA5w/640?wx_fmt=png"></figure><hr data-tool="mdnice编辑器"><p data-tool="mdnice编辑器">更多细节将在后面的教程中说明，敬请期待。</p><h3 data-tool="mdnice编辑器"><span><span>文中链接</span></span></h3><section data-tool="mdnice编辑器"><span><span>[1]</span><p>reticulate: <em>https://github.com/rstudio/reticulate/</em></p></span><span><span>[2]</span><p>AnnData: <em>https://github.com/scverse/anndata</em></p></span></section></section><section><section data-style-type="5" data-tools="新媒体排版" data-id="2440476"><section><section><section><section><img data-ratio="0.9495798319327731" data-src="https://mmbiz.qpic.cn/mmbiz_gif/09gp6SvPE04j3m2v7Hr889icHUyibTOHs8YuUibicl7ibRD0ZwG5pDTjBluRreZvuib1o3BibvLkicYhnA4YW7dQsjn0cA/640?wx_fmt=gif" data-type="gif" data-w="119" data-width="100%" src="https://mmbiz.qpic.cn/mmbiz_gif/09gp6SvPE04j3m2v7Hr889icHUyibTOHs8YuUibicl7ibRD0ZwG5pDTjBluRreZvuib1o3BibvLkicYhnA4YW7dQsjn0cA/640?wx_fmt=gif"></section><section data-brushtype="text">往期回顾</section><section><br></section></section></section></section><section><section data-autoskip="1"><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247516100&amp;idx=1&amp;sn=cb578bf6eebe3a6085b7341d26e08a32&amp;chksm=ea1cb946dd6b3050b8f4a25d63ed9fbff2bd1cbc7cf4cc46ccd8fe12ce196dbe8b716885dc24&amp;scene=21#wechat_redirect" textvalue="当 Transformer 遇见单细胞转录组——TOSICA" linktype="text" imgurl="" imgdata="null" data-itemshowtype="11" tab="innerlink" data-linktype="2"><span>当 Transformer 遇见单细胞转录组——TOSICA</span></a><br></p><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247516081&amp;idx=1&amp;sn=c6e00a1cff0613d26918f1df878e5995&amp;chksm=ea1cb933dd6b30255225e5c36324e8e7d571d8572f09cfefabc18f87a2c6a2209393dbc18e91&amp;scene=21#wechat_redirect" textvalue="单细胞分析揭示了葡萄膜黑色素瘤新的进化复杂性" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2"><span>单细胞分析揭示了葡萄膜黑色素瘤新的进化复杂性</span></a><br></p><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247516080&amp;idx=1&amp;sn=e4aa259ef517395c318bfe197f2193f1&amp;chksm=ea1cb932dd6b3024b296661837bfa67dc97f65c56154d32106237f1e9658d4beb936f825d19a&amp;scene=21#wechat_redirect" textvalue="把单细胞技术应用到药物研发需要会这么多高级分析技巧吗？" linktype="text" imgurl="" imgdata="null" data-itemshowtype="8" tab="innerlink" data-linktype="2"><span>把单细胞技术应用到药物研发需要会这么多高级分析技巧吗？</span></a><br></p><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247516039&amp;idx=1&amp;sn=9a706da8bacc5801eae7a03b4ccc5c36&amp;chksm=ea1cb905dd6b3013a30c140a8c919b53cb61ce502b335700dbf17e91f09a70b845379255f99c&amp;scene=21#wechat_redirect" textvalue="端到端的单细胞管道SCP-安装" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2"><span>端到端的单细胞管道SCP-安装</span></a><br></p><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247515825&amp;idx=2&amp;sn=5122e66e005b04194ee21569d8c8245f&amp;chksm=ea1cb833dd6b312560d4da99a3ed73c7110d5ce84ae71bb8f9d3ab565de3f077521f0ff04ad0&amp;scene=21#wechat_redirect" textvalue="单细胞测序最好的教程（十）：万能的Transformer与细胞注释" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2"><span>单细胞测序最好的教程（十）：万能的Transformer与细胞注释</span></a><br></p></section></section><hr><p><br></p></section><section data-style-type="5" data-tools="新媒体排版" data-id="2440475"><hr><p><br></p><hr><section><p>如果你对单细胞转录组研究感兴趣，但又不知道如何入门，也许你可以关注一下下面的课程<span></span></p><p><br></p><ul><li><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247524240&amp;idx=1&amp;sn=94c9ef8c3d8080c30c8372d4fb5999ab&amp;chksm=9b4bdf2bac3c563def9232bb78f43bcaa13d7c3442b00cf83aaa32ae98f4500883fa8803fb98&amp;scene=21#wechat_redirect" textvalue="生信入门&amp;数据挖掘线上直播课9月班" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1">生信入门&amp;数据挖掘线上直播课9月班</a></p></li><li><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247524148&amp;idx=1&amp;sn=7806da6feb41a36493c519c1cfc1d3ac&amp;chksm=9b4bdf8fac3c569960369602f1ef26639cb366b250f233b2297d1f059471c0458335bfc0b829&amp;scene=21#wechat_redirect" textvalue="时隔5年，我们的生信技能树VIP学徒继续招生啦" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1">时隔5年，我们的生信技能树VIP学徒继续招生啦</a><br></p></li><li><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247519765&amp;idx=1&amp;sn=ce5a8c8182f854c88043059f8c2cb9ff&amp;chksm=9b4bceaeac3c47b88c19941d43dbb1401f3a92206481a0afc41159927868199643f795d62a7e&amp;scene=21#wechat_redirect" textvalue="千呼万唤始出来的独享生物信息学云服务器" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1">千呼万唤始出来的独享生物信息学云服务器</a></p></li></ul><p><img data-ratio="1" data-src="https://mmbiz.qpic.cn/mmbiz_gif/4TKeL1ZejtlKxOib5kmKX6ic6eX0w0WK5jvhtz9yBRsO3OI4yr6S5iaLNM7AbAeuPDHXMvDdur2DRz9wyiax4lEviag/640?wx_fmt=gif" data-type="gif" data-w="240" src="https://mmbiz.qpic.cn/mmbiz_gif/4TKeL1ZejtlKxOib5kmKX6ic6eX0w0WK5jvhtz9yBRsO3OI4yr6S5iaLNM7AbAeuPDHXMvDdur2DRz9wyiax4lEviag/640?wx_fmt=gif"><br></p><p><img data-ratio="0.05278592375366569" data-src="https://mmbiz.qpic.cn/mmbiz/4TKeL1Zejtlq03ZOSZiaTlic1MxgdKiaxTbOZ7ZSe0Xx1Ca8xF3L6Nyj1FYUajtYrSmRIHyZVSsAve0EAvEicZONpg/640?wx_fmt=jpeg" data-type="other" data-w="341" src="https://mmbiz.qpic.cn/mmbiz/4TKeL1Zejtlq03ZOSZiaTlic1MxgdKiaxTbOZ7ZSe0Xx1Ca8xF3L6Nyj1FYUajtYrSmRIHyZVSsAve0EAvEicZONpg/640?wx_fmt=jpeg"></p><p><strong><span>看完记得顺手点个</span></strong><span><strong><span>“在看”</span></strong></span><strong><span>哦！</span></strong></p></section><section><section data-id="93668"><section><section data-width="95%"><section><section><section data-width="38%"><section><section data-tools="135编辑器" data-id="93668"><section><section data-width="95%"><section><section><section data-width="61.8%"><section><section><section><p><br></p><span><strong data-burshtype="text"><img data-copyright="0" data-cropselx1="0" data-cropselx2="109" data-cropsely1="0" data-cropsely2="109" data-ratio="1" data-src="https://mmbiz.qpic.cn/mmbiz/siaia0BDGJdjRMGrkqo64BGKecYk4akuHpGHVQs7FeOpY7eWbIPGC1tRw5Tw0oEPmx053mR9FTVerWvhuZchIpZw/640?wx_fmt=jpeg" data-type="other" data-w="258" title="qrcode_for_gh_5a3c482ed99f_1280.jpg" src="https://mmbiz.qpic.cn/mmbiz/siaia0BDGJdjRMGrkqo64BGKecYk4akuHpGHVQs7FeOpY7eWbIPGC1tRw5Tw0oEPmx053mR9FTVerWvhuZchIpZw/640?wx_fmt=jpeg"><strong data-burshtype="text">生物</strong><strong data-burshtype="text"> | 单细胞 | 转录组丨资料</strong></strong></span></section><section><span><strong data-burshtype="text">每天都精彩</strong></span></section></section></section><section><section><section><section><section><section><p><span>长按扫码可关注</span></p></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/ELK7DhcInqQzxqyJc9kt6A",target="_blank" rel="noopener noreferrer">原文链接</a>
