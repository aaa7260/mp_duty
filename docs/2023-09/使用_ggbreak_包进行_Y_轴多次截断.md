---
title: "使用 ggbreak 包进行 Y 轴多次截断"
date: 2023-09-25T00:16:14Z
draft: ["false"]
tags: [
  "fetched",
  "庄闪闪的R语言手册"
]
categories: ["Acdemic"]
---
使用 ggbreak 包进行 Y 轴多次截断 by 庄闪闪的R语言手册
------
<div><p data-mpa-powered-by="yiban.io"><span>点击下方</span><span>公众号</span><span>，回复</span><span>资料分享</span><span>，收获惊喜</span></p><section><mp-common-profile data-pluginname="mpprofile" data-id="MzI1NjUwMjQxMQ==" data-headimg="http://mmbiz.qpic.cn/mmbiz_png/MIcgkkEyTHiaOjUwXredJLzMleuKP97WYf7W4ylibNiaRJlP7icneHRGekYcQEPgTLpIDbibTuuEADhn0Sv4Xqhhf4A/0?wx_fmt=png" data-nickname="庄闪闪的R语言手册" data-alias="Zss_R4ds" data-signature="在读统计博士生，R语言爱好者。来跟着我一起学 R 数据科学，可视化。" data-from="0" data-is_biz_ban="0"></mp-common-profile></section><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><h2 data-tool="mdnice编辑器"><span></span><span>简介</span></h2><p data-tool="mdnice编辑器">最近在科研中需要比较不同模型的预测性能，我们使用相对偏差，均方根误差等来比较结果。此时，可能会得到以下结果：</p><figure data-tool="mdnice编辑器"><img data-ratio="0.8453703703703703" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/MIcgkkEyTHgiaN5FXlxzhONWvTX2lbueQ20j2Ife5b9V6tpicKAiagicsmVcUc1gLicbyFdZLuHNXfY8pOPMDw43EnA/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/MIcgkkEyTHgiaN5FXlxzhONWvTX2lbueQ20j2Ife5b9V6tpicKAiagicsmVcUc1gLicbyFdZLuHNXfY8pOPMDw43EnA/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">上图出现以下问题：</p><ul data-tool="mdnice编辑器"><li><section><p><strong>问题一</strong>：由于经典模型（Normal）在复杂数据中的预测效果不好，会出现预测非常差的情况，从而导致图形Y轴刻度被拉长，可视化效果不佳。</p></section></li><li><section><p><strong>问题二</strong>：相似方法预测结果相同，无法清晰看出之间的差异性。</p></section></li><li><section><p><strong>问题三</strong>：柱状图准确数字未知，只能通过主观方式估计最终结果。</p></section></li></ul><p data-tool="mdnice编辑器">基于以上问题，小编分别做了以下润色工作：</p><ol data-tool="mdnice编辑器"><li><section><p>问题一二可以通过使用 <span>ggbreak 包</span><sup>[1]</sup> 进行多次 Y 轴截断。</p></section></li><li><section><p>添加每个柱状图的准确数值结果来解决问题三。</p></section></li><li><section><p>简单修改图形颜色，删除图例，使其变得更加美观。</p></section></li></ol><p data-tool="mdnice编辑器">最后得到以下图形：</p><figure data-tool="mdnice编辑器"><img data-ratio="0.8531598513011153" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/MIcgkkEyTHgiaN5FXlxzhONWvTX2lbueQ6QR9M6YPRm1xLVJJkfBQca1m41xsiavGA5yicRCsZU8a2JBxOSR1ILMg/640?wx_fmt=png" data-type="png" data-w="1076" src="https://mmbiz.qpic.cn/sz_mmbiz_png/MIcgkkEyTHgiaN5FXlxzhONWvTX2lbueQ6QR9M6YPRm1xLVJJkfBQca1m41xsiavGA5yicRCsZU8a2JBxOSR1ILMg/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">接下来给出可复现的代码供大家参考，读者可以根据自己数据进行调整。</p><h2 data-tool="mdnice编辑器"><span></span><span>使用教程</span></h2><h3 data-tool="mdnice编辑器"><span></span><span>数据产生</span><span></span></h3><p data-tool="mdnice编辑器">为了方便读者复现，小编手动产生一些样例数据：</p><pre data-tool="mdnice编辑器"><span></span><code>com_cost = c(<span>17.64</span>,<span>4.89</span>,<span>5.13</span>,<span>8.43</span>,<span>5.32</span>)<br>com_cost_re = data.frame(<span>"Method"</span> = c(<span>"Normal"</span>,<span>"TS"</span>,<span>"Linear"</span>,<span>"Power"</span>,<span>"Exp"</span>),<span>"Value"</span>= round(com_cost,<span>3</span>))<br>com_cost_re$Method &lt;- factor(com_cost_re$Method, levels = c(<span>"Normal"</span>,<span>"Power"</span>,<span>"Exp"</span>,<span>"Linear"</span>,<span>"TS"</span>))<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.9461077844311377" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/MIcgkkEyTHgiaN5FXlxzhONWvTX2lbueQbhEjwfhrOQeawOWcnVRxZLBicIqicU7P0RZ7zt2YXKMt4wtLQaCz52Pg/640?wx_fmt=png" data-type="png" data-w="334" src="https://mmbiz.qpic.cn/sz_mmbiz_png/MIcgkkEyTHgiaN5FXlxzhONWvTX2lbueQbhEjwfhrOQeawOWcnVRxZLBicIqicU7P0RZ7zt2YXKMt4wtLQaCz52Pg/640?wx_fmt=png"></figure><h3 data-tool="mdnice编辑器"><span></span><span>可视化</span><span></span></h3><p data-tool="mdnice编辑器">首先，对该数据进行可视化，并做了些细节调整。例如：修改配色、添加文本、删除图例等。</p><pre data-tool="mdnice编辑器"><span></span><code>gg1 = ggplot(com_cost_re, aes(x = Method, y = Value)) +<br>  geom_bar(stat = <span>"identity"</span>, aes(fill = Method),alpha = <span>0.8</span>) +<br>  scale_fill_viridis(discrete = <span>T</span>)+ <span># 修改配色</span><br>  geom_text(aes(label = Value), position = position_dodge(width = <span>0.8</span>), <br>            vjust = <span>2</span>, size = <span>4</span>,color = <span>"white"</span>) +  <span># 添加文本</span><br>  coord_cartesian(ylim = c(<span>4</span>,<span>18</span>)) +  <br>  theme_bw() +  <span># 设置主题</span><br>  theme(panel.grid = element_blank(),legend.position = <span>"none"</span>) + <span># 删除图例</span><br>  labs(title = <span>""</span>, x = <span>"Method"</span>, y = <span>"Criteria"</span>)<br>gg1<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.8398148148148148" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/MIcgkkEyTHgiaN5FXlxzhONWvTX2lbueQtwwiaQ6rUaj2Z0e0hLIoj18GvdJGPC3pTHDAgq3NGVlv69P0nib3wZUw/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/MIcgkkEyTHgiaN5FXlxzhONWvTX2lbueQtwwiaQ6rUaj2Z0e0hLIoj18GvdJGPC3pTHDAgq3NGVlv69P0nib3wZUw/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">此时，图形美观度基本完成，接下来使用 ggbreak 包进行多次 Y 轴截断。主要使用 <code>scale_y_break()</code> 函数。</p><blockquote data-tool="mdnice编辑器"><p><strong>注意</strong>：关于  <code>scale_y_break()</code> 的其他参数设置可参考：<span>ggbreak官网教程</span><sup>[2]</sup>，这里不做过多重复介绍。</p></blockquote><pre data-tool="mdnice编辑器"><span></span><code>gg2 = gg1 + scale_y_break(c(<span>5.35</span>, <span>8.34</span>)) + <br>  scale_y_break(c(<span>0</span>, <span>4.7</span>)) + <br>  scale_y_break(c(<span>8.5</span>, <span>17.5</span>)) <br></code></pre><p data-tool="mdnice编辑器">此时得到的结果为：</p><figure data-tool="mdnice编辑器"><img data-ratio="0.8539325842696629" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/MIcgkkEyTHgiaN5FXlxzhONWvTX2lbueQIOFYPcsIPsf3AHiblvjanSqCBjNFVRMLGBEPrZUQGoME6AoexvpUYmw/640?wx_fmt=png" data-type="png" data-w="1068" src="https://mmbiz.qpic.cn/sz_mmbiz_png/MIcgkkEyTHgiaN5FXlxzhONWvTX2lbueQIOFYPcsIPsf3AHiblvjanSqCBjNFVRMLGBEPrZUQGoME6AoexvpUYmw/640?wx_fmt=png"></figure><h2 data-tool="mdnice编辑器"><span></span><span>小编有话说</span></h2><p data-tool="mdnice编辑器">本文主要是小编在科研中存在的一个问题，最终通过一些简单搜索和调包解决问题。供大家参考～</p><h3 data-tool="mdnice编辑器"><span>参考资料</span></h3><section data-tool="mdnice编辑器"><span><span>[1]</span><p>ggbreak 包: <em>https://github.com/YuLab-SMU/ggbreak</em></p></span><span><span>[2]</span><p>ggbreak官网教程: <em>https://cran.r-project.org/web/packages/ggbreak/vignettes/ggbreak.html</em></p></span></section></section><p><img data-backh="709" data-backw="558" data-cropselx1="0" data-cropselx2="558" data-cropsely1="0" data-cropsely2="709" data-ratio="1.2697916666666667" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/MIcgkkEyTHgj3jribWnUVvAj91nGwhZcbNOxiaDnySMIXxC9SWOP2Xo2ZIv8SmGEQ4uUdwwy74uTKYSqRW24qqeg/640?wx_fmt=jpeg" data-type="jpeg" data-w="960" src="https://mmbiz.qpic.cn/mmbiz_jpg/MIcgkkEyTHgj3jribWnUVvAj91nGwhZcbNOxiaDnySMIXxC9SWOP2Xo2ZIv8SmGEQ4uUdwwy74uTKYSqRW24qqeg/640?wx_fmt=jpeg"></p><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><h2 data-tool="mdnice编辑器"><span>相关推荐</span></h2></section><section data-mpa-template="t" data-from="yb-recommend-list"><section data-mpa-template="t" data-from="yb-recommend" data-recommend-article-type="normal" data-recomment-template-id="1" data-recommend-article-id="2247494294_2" data-recommend-article-time="1619395200" data-recommend-article-cover="http://mmbiz.qpic.cn/mmbiz_jpg/MIcgkkEyTHhfSAGMJibPM4rScvfcuTjnzfnJbzXzgMDFiaBgnsNXh7ccXibRpx77pjqIic78oFGl1BBryuFmwtxCpQ/0?wx_fmt=jpeg" data-recommend-article-title="colourpicker包：图形颜色拾取器" data-recommend-article-content-url="http://mp.weixin.qq.com/s?__biz=MzI1NjUwMjQxMQ==&amp;mid=2247494294&amp;idx=2&amp;sn=044737f8652c6256997c689ddaf70d55&amp;chksm=ea271572dd509c64de8b8f6c03ca71e033c2b65823d0096c448ef9508e12898b1e396d3ba46d#rd"><a href="http://mp.weixin.qq.com/s?__biz=MzI1NjUwMjQxMQ==&amp;mid=2247494294&amp;idx=2&amp;sn=044737f8652c6256997c689ddaf70d55&amp;chksm=ea271572dd509c64de8b8f6c03ca71e033c2b65823d0096c448ef9508e12898b1e396d3ba46d&amp;scene=21#wechat_redirect" data-linktype="1"><section data-recommend-type="normal" data-recommend-tid="1" data-mid=""><section data-mid=""><section data-mid=""><span data-positionback="static"><img data-ratio="0.425" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/MIcgkkEyTHhfSAGMJibPM4rScvfcuTjnzfnJbzXzgMDFiaBgnsNXh7ccXibRpx77pjqIic78oFGl1BBryuFmwtxCpQ/640?wx_fmt=jpeg" data-type="jpeg" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_jpg/MIcgkkEyTHhfSAGMJibPM4rScvfcuTjnzfnJbzXzgMDFiaBgnsNXh7ccXibRpx77pjqIic78oFGl1BBryuFmwtxCpQ/640?wx_fmt=jpeg"></span></section><section data-mid=""><p data-recommend-title="t" data-mid="">colourpicker包：图形颜色拾取器</p></section></section></section></a></section><br><section data-mpa-template="t" data-from="yb-recommend" data-recommend-article-type="normal" data-recomment-template-id="1" data-recommend-article-id="2247493762_2" data-recommend-article-time="1617625800" data-recommend-article-cover="http://mmbiz.qpic.cn/mmbiz_jpg/MIcgkkEyTHiaukiad9zWdJwU6ro7mnRYrgKwibVicXMjM0tH8FN1ZFpbALXBRudlsg54niaqF4vvvUuBuYDJg9yWiaKQ/0?wx_fmt=jpeg" data-recommend-article-title="visdat包：助你一眼看穿数据结构和缺失值！" data-recommend-article-content-url="http://mp.weixin.qq.com/s?__biz=MzI1NjUwMjQxMQ==&amp;mid=2247493762&amp;idx=2&amp;sn=f23f6aed22ecf85edc266fd622170043&amp;chksm=ea271766dd509e706c8cb8c367b18feac8cc8e26da740d8562d7a83a35aee3186e316b4d2b0f#rd"><a href="http://mp.weixin.qq.com/s?__biz=MzI1NjUwMjQxMQ==&amp;mid=2247493762&amp;idx=2&amp;sn=f23f6aed22ecf85edc266fd622170043&amp;chksm=ea271766dd509e706c8cb8c367b18feac8cc8e26da740d8562d7a83a35aee3186e316b4d2b0f&amp;scene=21#wechat_redirect" data-linktype="1"><section data-recommend-type="normal" data-recommend-tid="1" data-mid=""><section data-mid=""><section data-mid=""><span data-positionback="static"><img data-ratio="0.9990740740740741" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/MIcgkkEyTHiaukiad9zWdJwU6ro7mnRYrgKwibVicXMjM0tH8FN1ZFpbALXBRudlsg54niaqF4vvvUuBuYDJg9yWiaKQ/640?wx_fmt=jpeg" data-type="jpeg" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_jpg/MIcgkkEyTHiaukiad9zWdJwU6ro7mnRYrgKwibVicXMjM0tH8FN1ZFpbALXBRudlsg54niaqF4vvvUuBuYDJg9yWiaKQ/640?wx_fmt=jpeg"></span></section><section data-mid=""><p data-recommend-title="t" data-mid="">visdat包：助你一眼看穿数据结构和缺失值！</p></section></section></section></a></section><br><section data-mpa-template="t" data-from="yb-recommend" data-recommend-article-type="normal" data-recomment-template-id="1" data-recommend-article-id="2247494569_1" data-recommend-article-time="1619872200" data-recommend-article-cover="http://mmbiz.qpic.cn/mmbiz_jpg/MIcgkkEyTHjBmW0TEkBD0y8MyW3c5HT44NUiarOicWAlt1cs0uHwG7vWABviajKQqXggWYwWRicyr5kEjQA2swicbibQ/0?wx_fmt=jpeg" data-recommend-article-title="report包：助你自动出统计报告！" data-recommend-article-content-url="http://mp.weixin.qq.com/s?__biz=MzI1NjUwMjQxMQ==&amp;mid=2247494569&amp;idx=1&amp;sn=d5bff0f15069c26d42aff0ccdfd7b743&amp;chksm=ea27144ddd509d5b8e874041d9d8ed9ec98582e5aa774b6f7e6514ff4106f123ba47cef0326b#rd"><a href="http://mp.weixin.qq.com/s?__biz=MzI1NjUwMjQxMQ==&amp;mid=2247494569&amp;idx=1&amp;sn=d5bff0f15069c26d42aff0ccdfd7b743&amp;chksm=ea27144ddd509d5b8e874041d9d8ed9ec98582e5aa774b6f7e6514ff4106f123ba47cef0326b&amp;scene=21#wechat_redirect" data-linktype="1"><section data-recommend-type="normal" data-recommend-tid="1" data-mid=""><section data-mid=""><section data-mid=""><span data-positionback="static"><img data-ratio="0.425" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/MIcgkkEyTHjBmW0TEkBD0y8MyW3c5HT44NUiarOicWAlt1cs0uHwG7vWABviajKQqXggWYwWRicyr5kEjQA2swicbibQ/640?wx_fmt=jpeg" data-type="jpeg" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_jpg/MIcgkkEyTHjBmW0TEkBD0y8MyW3c5HT44NUiarOicWAlt1cs0uHwG7vWABviajKQqXggWYwWRicyr5kEjQA2swicbibQ/640?wx_fmt=jpeg"></span></section><section data-mid=""><p data-recommend-title="t" data-mid="">report包：助你自动出统计报告！</p></section></section></section></a></section><br><section data-mpa-template="t" data-from="yb-recommend" data-recommend-article-type="normal" data-recomment-template-id="1" data-recommend-article-id="2247492028_2" data-recommend-article-time="1615811746" data-recommend-article-cover="http://mmbiz.qpic.cn/mmbiz_jpg/MIcgkkEyTHjqYtTRnKYwYP4k7iaZoMibUQSQxY67eMmhUznDVyWESfjutJ9fUmXsvE3EdM3wm8NWk86HPU5ryvNg/0?wx_fmt=jpeg" data-recommend-article-title="reticulate包｜数据科学者的福音" data-recommend-article-content-url="http://mp.weixin.qq.com/s?__biz=MzI1NjUwMjQxMQ==&amp;mid=2247492028&amp;idx=2&amp;sn=a5394f8520895b946e35032cbc39f04a&amp;chksm=ea271e58dd50974e60011d8b0cf90906295157dcba5ad03540eeb302602def5b4cd66bc97445#rd"><a href="http://mp.weixin.qq.com/s?__biz=MzI1NjUwMjQxMQ==&amp;mid=2247492028&amp;idx=2&amp;sn=a5394f8520895b946e35032cbc39f04a&amp;chksm=ea271e58dd50974e60011d8b0cf90906295157dcba5ad03540eeb302602def5b4cd66bc97445&amp;scene=21#wechat_redirect" data-linktype="1"><section data-recommend-type="normal" data-recommend-tid="1" data-mid=""><section data-mid=""><section data-mid=""><span data-positionback="static"><img data-ratio="0.9990740740740741" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/MIcgkkEyTHjqYtTRnKYwYP4k7iaZoMibUQSQxY67eMmhUznDVyWESfjutJ9fUmXsvE3EdM3wm8NWk86HPU5ryvNg/640?wx_fmt=jpeg" data-type="jpeg" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_jpg/MIcgkkEyTHjqYtTRnKYwYP4k7iaZoMibUQSQxY67eMmhUznDVyWESfjutJ9fUmXsvE3EdM3wm8NWk86HPU5ryvNg/640?wx_fmt=jpeg"></span></section><section data-mid=""><p data-recommend-title="t" data-mid="">reticulate包｜数据科学者的福音</p></section></section></section></a></section><br><section data-mpa-template="t" data-from="yb-recommend" data-recommend-article-type="normal" data-recomment-template-id="1" data-recommend-article-id="2247491046_1" data-recommend-article-time="1613997000" data-recommend-article-cover="http://mmbiz.qpic.cn/mmbiz_jpg/MIcgkkEyTHj3iaOBCqwm2KNPdSZiaKSjI4bibXY1FKD5yx2WuByDz7sAUFQKfoeVicbGXjqVz2ib5gnvvyia5ibpzoFMQ/0?wx_fmt=jpeg" data-recommend-article-title="ggThemeAssist包：交互式修改图形主题" data-recommend-article-content-url="http://mp.weixin.qq.com/s?__biz=MzI1NjUwMjQxMQ==&amp;mid=2247491046&amp;idx=1&amp;sn=92b382e77c8c007cca80524d36f258a0&amp;chksm=ea24e202dd536b14bf567d7ed6e076880c6d30109fd3836aaa5df2d75a61a214b6c3c7621667#rd"><section data-recommend-type="normal" data-recommend-tid="1" data-mid=""><section data-mid=""><section data-mid=""><a href="http://mp.weixin.qq.com/s?__biz=MzI1NjUwMjQxMQ==&amp;mid=2247491046&amp;idx=1&amp;sn=92b382e77c8c007cca80524d36f258a0&amp;chksm=ea24e202dd536b14bf567d7ed6e076880c6d30109fd3836aaa5df2d75a61a214b6c3c7621667&amp;scene=21#wechat_redirect" data-linktype="1"><span><img data-ratio="0.42685185185185187" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/MIcgkkEyTHj3iaOBCqwm2KNPdSZiaKSjI4bibXY1FKD5yx2WuByDz7sAUFQKfoeVicbGXjqVz2ib5gnvvyia5ibpzoFMQ/640?wx_fmt=jpeg" data-type="jpeg" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_jpg/MIcgkkEyTHj3iaOBCqwm2KNPdSZiaKSjI4bibXY1FKD5yx2WuByDz7sAUFQKfoeVicbGXjqVz2ib5gnvvyia5ibpzoFMQ/640?wx_fmt=jpeg"></span></a></section></section></section></section></section><p><br></p><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/HvKrRQsKJV4RMREeiixyNQ",target="_blank" rel="noopener noreferrer">原文链接</a>
