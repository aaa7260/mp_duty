---
title: "你的富集结果还用气泡图表示？？"
date: 2023-09-26T16:06:55Z
draft: ["false"]
tags: [
  "fetched",
  "生信技能树"
]
categories: ["Acdemic"]
---
你的富集结果还用气泡图表示？？ by 生信技能树
------
<div><section data-darkmode-bgcolor-16235885275087="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16235885275087="#fff|rgb(255, 255, 255)" data-darkmode-color-16235885275087="rgb(163, 163, 163)" data-darkmode-original-color-16235885275087="#fff|rgb(0, 0, 0)" mp-original-font-size="16" mp-original-line-height="25.600000381469727"><section data-darkmode-bgcolor-16235885275087="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16235885275087="#fff|rgb(255, 255, 255)" data-darkmode-color-16235885275087="rgb(0, 0, 0)" data-darkmode-original-color-16235885275087="#fff|rgb(0, 0, 0)" data-darkmode-bgimage-16235885275087="1" data-style='margin-bottom: -2.6em; margin-left: -2.6em; max-width: 100%; display: inline-block; vertical-align: bottom; border-width: 2px; border-style: solid; width: 5em; height: 5em; border-radius: 100%; overflow: hidden; border-color: rgb(96, 178, 154); background-position: center center; background-repeat: no-repeat; background-size: cover; box-shadow: rgb(0, 0, 0) 0px 0px 0px; background-image: url("https://mmbiz.qpic.cn/mmbiz_jpg/cZNhZQ6j4wztsZWIld4dbSAHficyAXWgkicrhjjacU8Ey0UKM56qbSnedHStMqWUfTPQxbqxNTVZy1g59nNW3BSg/640?wx_fmt=jpeg"); box-sizing: border-box !important; overflow-wrap: break-word !important;' mp-original-font-size="16" mp-original-line-height="25.600000381469727"><section data-darkmode-bgcolor-16235885275087="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16235885275087="#fff|rgb(255, 255, 255)" data-darkmode-color-16235885275087="rgb(0, 0, 0)" data-darkmode-original-color-16235885275087="#fff|rgb(0, 0, 0)" data-darkmode-bgimage-16235885275087="1" mp-original-font-size="16" mp-original-line-height="0"><img data-ratio="0.91875" data-type="jpeg" data-w="640" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/cZNhZQ6j4wztsZWIld4dbSAHficyAXWgkicrhjjacU8Ey0UKM56qbSnedHStMqWUfTPQxbqxNTVZy1g59nNW3BSg/640?wx_fmt=jpeg" src="https://mmbiz.qpic.cn/mmbiz_jpg/cZNhZQ6j4wztsZWIld4dbSAHficyAXWgkicrhjjacU8Ey0UKM56qbSnedHStMqWUfTPQxbqxNTVZy1g59nNW3BSg/640?wx_fmt=jpeg"></section></section><span title="" opera-tn-ra-cell="_$.pages:0.layers:0.comps:0.title1" data-darkmode-bgcolor-16235885275087="rgb(96, 178, 154)" data-darkmode-original-bgcolor-16235885275087="#fff|rgb(255, 255, 255)|rgb(96, 178, 154)" data-darkmode-color-16235885275087="rgb(255,255,255)" data-darkmode-original-color-16235885275087="#fff|rgb(0, 0, 0)|rgb(255,255,255)" mp-original-font-size="16" mp-original-line-height="25.600000381469727"><p data-darkmode-bgcolor-16235885275087="rgb(96, 178, 154)" data-darkmode-original-bgcolor-16235885275087="#fff|rgb(255, 255, 255)|rgb(96, 178, 154)" data-darkmode-color-16235885275087="rgb(255,255,255)" data-darkmode-original-color-16235885275087="#fff|rgb(0, 0, 0)|rgb(255,255,255)" mp-original-font-size="16" mp-original-line-height="25.600000381469727"><br data-darkmode-bgcolor-16235885275087="rgb(96, 178, 154)" data-darkmode-original-bgcolor-16235885275087="#fff|rgb(255, 255, 255)|rgb(96, 178, 154)" data-darkmode-color-16235885275087="rgb(255,255,255)" data-darkmode-original-color-16235885275087="#fff|rgb(0, 0, 0)|rgb(255,255,255)" mp-original-font-size="16" mp-original-line-height="25.600000381469727"></p></span></section><section data-darkmode-bgcolor-16235885275087="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16235885275087="#fff|rgb(255, 255, 255)" data-darkmode-color-16235885275087="rgb(163, 163, 163)" data-darkmode-original-color-16235885275087="#fff|rgb(0, 0, 0)" mp-original-font-size="16" mp-original-line-height="25.600000381469727"><section powered-by="xiumi.us" data-darkmode-bgcolor-16235885275087="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16235885275087="#fff|rgb(255, 255, 255)" data-darkmode-color-16235885275087="rgb(163, 163, 163)" data-darkmode-original-color-16235885275087="#fff|rgb(0, 0, 0)" mp-original-font-size="16" mp-original-line-height="25.600000381469727"><p data-darkmode-bgcolor-16235885275087="rgb(25, 25, 25)" data-darkmode-original-bgcolor-16235885275087="#fff|rgb(255, 255, 255)" data-darkmode-color-16235885275087="rgb(163, 163, 163)" data-darkmode-original-color-16235885275087="#fff|rgb(0, 0, 0)" mp-original-font-size="16" mp-original-line-height="25.600000381469727"><span>连续两次求贤令：</span><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247504128&amp;idx=1&amp;sn=b3a0fa7db41031f53bfbf010e8b2311e&amp;chksm=9b4b91bbac3c18adbdd8ccf1fb10cf7ddc30fea8bc73a86fcc8a1d53521c9bfa2ba21c7aa47e&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1" wah-hotarea="click" mp-original-font-size="16" mp-original-line-height="25.600000381469727"><span>曾经我给你带来了十万用户，但现在祝你倒闭</span></a><span>，以及 </span><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247504576&amp;idx=1&amp;sn=caa7974e4a0d0f86c969f495339dd1a1&amp;chksm=9b4b927bac3c1b6deb33749d8ed23827f8799087a424b0b60c4dae81af81e3a07bcf7f74f388&amp;scene=21#wechat_redirect" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1" wah-hotarea="click" mp-original-font-size="16" mp-original-line-height="25.600000381469727"><span>生信技能树知识整理实习生招募</span></a><span>，让我走大运结识了几位优秀小伙伴！有做ngs实战整理的，也有做临床数据挖掘算法工具介绍的。今天分享的是从本科到硕士研究生都在我们生信技能树实习的萌妹子的笔记：</span><strong></strong></p></section></section><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" mp-original-font-size="16" mp-original-line-height="25.600000381469727"><blockquote data-tool="mdnice编辑器" mp-original-font-size="14.399999618530273" mp-original-line-height="23.040000915527344">下面是笔记原文</blockquote></section><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><figure data-tool="mdnice编辑器"><img data-ratio="1.4194444444444445" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/PsnauFhHibc7hwJT1LA0AIzrUHA40GzKpgiaXoYuo8IECibvZdq1TicdkO5kynIibgthUV8nSFJu9Qfb7o9UPibYzHcA/640?wx_fmt=jpeg" data-type="jpeg" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_jpg/PsnauFhHibc7hwJT1LA0AIzrUHA40GzKpgiaXoYuo8IECibvZdq1TicdkO5kynIibgthUV8nSFJu9Qfb7o9UPibYzHcA/640?wx_fmt=jpeg"></figure><blockquote data-type="2" data-url="" data-author-name="" data-content-utf8-length="30" data-source-title=""><section><section><p data-tool="mdnice编辑器">连CELL都勇升到66.8分了，而我。。。。</p><p data-tool="mdnice编辑器">还是先学会画图把</p></section></section></blockquote><p><br></p><p data-tool="mdnice编辑器">据说，多种R包可以绘制雷达图</p><p data-tool="mdnice编辑器">对ggplot系列函数熟悉的小伙伴可以选择<code><span>ggradar</span></code>和<code><span>echarts4r</span></code></p><p data-tool="mdnice编辑器"><code><span>fmsb</span></code>和<code><span>radarchart</span></code>也同样能实现你的需求</p><p data-tool="mdnice编辑器"><br></p><p data-tool="mdnice编辑器"><strong>🍥下面，从单细胞差异分析入手，直到GO富集分析</strong></p><p><img data-galleryid="" data-ratio="0.42872687704026113" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/PsnauFhHibc7hwJT1LA0AIzrUHA40GzKp0ZicLZ2BOCbARAJhicywbm21EhvVeY6dOaQqMbjxuMNDP0v8JVN9YbOQ/640?wx_fmt=png" data-type="png" data-w="919" src="https://mmbiz.qpic.cn/mmbiz_png/PsnauFhHibc7hwJT1LA0AIzrUHA40GzKp0ZicLZ2BOCbARAJhicywbm21EhvVeY6dOaQqMbjxuMNDP0v8JVN9YbOQ/640?wx_fmt=png"></p><p data-tool="mdnice编辑器"><strong></strong></p><h2 data-tool="mdnice编辑器"><span></span>1.单细胞差异分析</h2><ul data-tool="mdnice编辑器"><li><section><code><span>FindAllMarkers</span></code></section></li></ul><pre data-tool="mdnice编辑器"><span></span><code><span># 6. FindAllMarkers celltype----</span><br>sce<br><span># An object of class Seurat </span><br><span># 25288 features across 13560 samples within 1 assay </span><br><span># Active assay: RNA (25288 features, 2000 variable features)</span><br><span># 4 dimensional reductions calculated: pca, tsne, umap, harmony</span><br>table(sce$celltype)<br><br>Idents(sce) &lt;- <span>"celltype"</span><br>Idents(sce)<br>sce.markers &lt;- FindAllMarkers(sce)<br>save(sce.markers,file = <span>"harmony_celltype.markers.Rdata"</span>)<br>write.csv(sce.markers,file = <span>"harmony_celltype.markers.csv"</span>)<br></code></pre><h2 data-tool="mdnice编辑器"><span></span>2. 挑top100</h2><pre data-tool="mdnice编辑器"><span></span><code>head(harmony_celltype_markers)<br><span>#            p_val    avg_log2FC pct.1 pct.2     p_val_adj         cluster   gene</span><br><span># FCER1A  0.000000e+00   2.016015 0.734 0.126  0.000000e+00 Inflammatory_DC FCER1A</span><br><span># CD1C    0.000000e+00   1.647918 0.503 0.064  0.000000e+00 Inflammatory_DC   CD1C</span><br><span># IL1R2  1.776186e-291   1.655928 0.567 0.099 4.491619e-287 Inflammatory_DC  IL1R2</span><br><span># CD1E   3.616531e-250   1.093357 0.333 0.036 9.145483e-246 Inflammatory_DC   CD1E</span><br><span># NAPSB  3.350806e-242   1.358380 0.521 0.097 8.473517e-238 Inflammatory_DC  NAPSB</span><br><span># NR4A3  5.633118e-232   1.374079 0.625 0.145 1.424503e-227 Inflammatory_DC  NR4A3</span><br><br>sce.markers &lt;- harmony_celltype_markers<br>DT::datatable(sce.markers)<br><span># 对每一个cluster，根据avg_log2FC，取前100个基因</span><br>top100 &lt;- sce.markers %&gt;% group_by(cluster) %&gt;% top_n(<span>100</span>, avg_log2FC)<br>head(top100)<br>dim(top100) <span>#1000    7</span><br></code></pre><h2 data-tool="mdnice编辑器"><span></span>3. GO富集分析</h2><ul data-tool="mdnice编辑器"><li><section><code><span>bitr</span></code>: 转换ID</section></li></ul><pre data-tool="mdnice编辑器"><span></span><code><span># GO富集分析</span><br><span># https://mp.weixin.qq.com/s/z-Kk02I2g8vAESgcGuncUg</span><br><span>library</span>(clusterProfiler)<br><span># 挑选p_val&lt;0.05</span><br>de_genes &lt;- subset(top100, p_val&lt;<span>0.05</span>)<br>length(de_genes$gene) <span># 1000</span><br>head(de_genes)<br><br><span># 转化ID</span><br>entrez_genes &lt;- bitr(de_genes$gene, fromType=<span>"SYMBOL"</span>, <br>                                    toType=<span>"ENTREZID"</span>, <br>                                    OrgDb=<span>"org.Hs.eg.db"</span>) <span># 人</span><br><span>#  5.45% of input gene IDs are fail to map...</span><br><br>head(entrez_genes)<br><span># SYMBOL ENTREZID</span><br><span># 1 FCER1A     2205</span><br><span># 2   CD1C      911</span><br><span># 3  IL1R2     7850</span><br><span># 4   CD1E      913</span><br><span># 5  NAPSB   256236</span><br><span># 6  NR4A3     8013</span><br><br><span># 将原来的SYMBOL 和 ENTREZID 对应起来</span><br>mix &lt;- merge(de_genes,entrez_genes,by.x=<span>"gene"</span>,by.y=<span>"SYMBOL"</span>)<br>dim(mix) <span>#950   8</span><br>head(mix)<br><span>#   gene         p_val avg_log2FC pct.1 pct.2     p_val_adj           cluster ENTREZID</span><br><span># 1   A2M  4.322616e-68  0.4559287 0.402 0.183  1.093103e-63          TREM2_Mf        2</span><br><span># 2   A2M  2.036888e-05  0.5190426 0.210 0.200  5.150881e-01 CCR2- HLA-DRhi C1        2</span><br><span># 3 ABCA6  7.529550e-58  0.7018329 0.127 0.052  1.904073e-53 CCR2- HLA-DRhi C1    23460</span><br><span># 4  ABI3 1.146337e-237  1.3451063 0.489 0.106 2.898856e-233        CD16+ Mono    51225</span><br><span># 5  ABL2  0.000000e+00  1.3000718 0.501 0.180  0.000000e+00 CCR2+ HLA-DRhi C2       27</span><br><span># 6 ACAP1 2.340444e-179  0.9188265 0.333 0.047 5.918515e-175         Mast cell     9744</span><br></code></pre><ul data-tool="mdnice编辑器"><li><section><code><span>merge</span></code> : 整合</section></li><li><section><code><span>split</span></code> : 拆分</section></li><li><section><code><span>compareCluster</span></code> : 富集分析（多个clusters）</section></li></ul><pre data-tool="mdnice编辑器"><span></span><code><span># 整合起来</span><br>de_gene_clusters &lt;- data.frame(ENTREZID=mix$ENTREZID,<br>                               cluster=mix$cluster)<br>table(de_gene_clusters$cluster)<br><span># 只挑选其中3个cluster作富集</span><br>de_gene_clusters &lt;- de_gene_clusters[(de_gene_clusters$cluster == <span>'CCR2- HLA-DRhi C1'</span>|<br>                                      de_gene_clusters$cluster==<span>'CCR2+ HLA-DRhi C2'</span>|<br>                                      de_gene_clusters$cluster== <span>'CCR2+ HLA-DRhi C3'</span>),]<br>table(de_gene_clusters$cluster)<br><span># CCR2- HLA-DRhi C1 CCR2+ HLA-DRhi C2 CCR2+ HLA-DRhi C3 </span><br><span># 96                98                95 </span><br><br><span># 拆分成list</span><br>list_de_gene_clusters &lt;- split(de_gene_clusters$ENTREZID,de_gene_clusters$cluster)<br></code></pre><p data-tool="mdnice编辑器"><br></p><p data-tool="mdnice编辑器">因为我下面可视化是针对某些通路，</p><p data-tool="mdnice编辑器">所以这里<code><span>pvalueCutoff</span></code>,<code><span>qvalueCutoff</span></code>都调的很大，尽可能富集出感兴趣的通路出来</p><pre data-tool="mdnice编辑器"><span></span><code><span># 多个clusters富集分析</span><br>formula_res &lt;- compareCluster(<br>  ENTREZID~cluster, <br>  data=de_gene_clusters, <br>  fun=<span>"enrichGO"</span>, <br>  OrgDb=<span>"org.Hs.eg.db"</span>,<br>  ont = <span>"ALL"</span>, <span># GO富集类型,One of "BP", "MF", and "CC" or "ALL"</span><br>  pAdjustMethod = <span>"BH"</span>,<br>  pvalueCutoff  = <span>1</span>,<br>  qvalueCutoff  =<span>1</span>,<br>  minGSSize = <span>5</span>, <span># 最小的基因富集数量</span><br>  maxGSSize = <span>1000</span>) <span># 最大的基因富集数量</span><br><br>head(formula_res)<br>f=as.data.frame(formula_res)<br>dim(f) <span>#9805   12</span><br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.31961471103327493" data-src="https://mmbiz.qpic.cn/mmbiz_png/PsnauFhHibc7hwJT1LA0AIzrUHA40GzKpKrECTHibtBzxXJI6FMBDfvqCWVPH0BgricjTicg7icZk3Ve55GbyXOMK4w/640?wx_fmt=png" data-type="png" data-w="1142" src="https://mmbiz.qpic.cn/mmbiz_png/PsnauFhHibc7hwJT1LA0AIzrUHA40GzKpKrECTHibtBzxXJI6FMBDfvqCWVPH0BgricjTicg7icZk3Ve55GbyXOMK4w/640?wx_fmt=png"></figure><ul data-tool="mdnice编辑器"><li><section>挑选感兴趣的通路</section></li></ul><pre data-tool="mdnice编辑器"><span></span><code>enrich &lt;- c(<span>"response to oxidative stress"</span>,<br>            <span>"response to endoplasmic reticulum stress"</span>,<br>            <span>"interleukin-10 production"</span>,<br>            <span>'antigen processing and presentation'</span>,<br>            <span>'endocytosis'</span>,<br>            <span>'response to tumor necrosis factor'</span>,<br>            <span>'I-kappaB kinase/NF-kappaB signaling'</span>,<br>            <span>'response to interferon-gamma'</span>,<br>            <span>'cytokine production'</span>,<br>            <span>'leukocyte chemotaxis'</span>)<br>            <br>choose_f &lt;- f[(f$Description %<span>in</span>% enrich),]<br>table(choose_f$Description)<br>df=choose_f<br></code></pre><h2 data-tool="mdnice编辑器"><span></span>4. 气泡图</h2><pre data-tool="mdnice编辑器"><span></span><code>p=ggplot(df,aes(x = cluster, <br>                y = Description, <span># 按照富集度大小排序</span><br>                size = Count,<br>                colour=p.adjust)) +<br>  geom_point(shape = <span>16</span>)+                     <span># 设置点的形状</span><br>  labs(x = <span>"Ratio"</span>, y = <span>"Pathway"</span>)+           <span># 设置x，y轴的名称</span><br>  scale_colour_continuous(                    <span># 设置颜色图例</span><br>    name=<span>"Enrichment"</span>,                        <span># 图例名称</span><br>    low=<span>"#7fcdbb"</span>,                            <span># 设置颜色范围</span><br>    high=<span>"#fc9272"</span>)+<br>  scale_radius(                               <span># 设置点大小图例</span><br>    range=c(<span>5</span>,<span>9</span>),                             <span># 设置点大小的范围</span><br>    name=<span>"Size"</span>)+                             <span># 图例名称</span><br>  guides(<br>    color = guide_colorbar(order = <span>1</span>),        <span># 决定图例的位置顺序</span><br>    size = guide_legend(order = <span>2</span>)<br>  )+theme_bw()                                <span># 设置主题</span><br>p<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.849624060150376" data-src="https://mmbiz.qpic.cn/mmbiz_png/PsnauFhHibc7hwJT1LA0AIzrUHA40GzKpm5FWicTz8iaP27UXwBkaIfYMKSKPUm7CzSRIk9HLyI2MgelJ6Yqqb2CQ/640?wx_fmt=png" data-type="png" data-w="665" src="https://mmbiz.qpic.cn/mmbiz_png/PsnauFhHibc7hwJT1LA0AIzrUHA40GzKpm5FWicTz8iaP27UXwBkaIfYMKSKPUm7CzSRIk9HLyI2MgelJ6Yqqb2CQ/640?wx_fmt=png"></figure><p><br></p><ul data-tool="mdnice编辑器"><li><section>如果名字太长，可以换行显示</section></li></ul><pre data-tool="mdnice编辑器"><span></span><code>p + scale_y_discrete(labels=<span>function</span>(x) str_wrap(x, width=<span>12</span>)) +<br>  scale_x_discrete(labels=<span>function</span>(x) str_wrap(x, width=<span>10</span>)) <span># 名字换行      </span><br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.9964850615114236" data-src="https://mmbiz.qpic.cn/mmbiz_png/PsnauFhHibc7hwJT1LA0AIzrUHA40GzKpe6otDFHvickRpP1icQzw74feL9kj3st25JQzQd2V7aMzrGWLyTGeYKzQ/640?wx_fmt=png" data-type="png" data-w="569" src="https://mmbiz.qpic.cn/mmbiz_png/PsnauFhHibc7hwJT1LA0AIzrUHA40GzKpe6otDFHvickRpP1icQzw74feL9kj3st25JQzQd2V7aMzrGWLyTGeYKzQ/640?wx_fmt=png"></figure><h2 data-tool="mdnice编辑器"><span></span>5. 雷达图</h2><ul data-tool="mdnice编辑器"><li><section><code><span>dcast</span></code> :  先换成短矩阵</section></li></ul><pre data-tool="mdnice编辑器"><span></span><code>ff &lt;- choose_f[,c(<span>"Cluster"</span>,<span>"Description"</span>,<span>"Count"</span>)]<br>head(ff)<br><span>#          Cluster                         Description        Count</span><br><span># 2   CCR2- HLA-DRhi C1                         endocytosis    17</span><br><span># 51  CCR2- HLA-DRhi C1   response to tumor necrosis factor     7</span><br><span># 74  CCR2- HLA-DRhi C1        response to interferon-gamma     5</span><br><span># 93  CCR2- HLA-DRhi C1                leukocyte chemotaxis     6</span><br><span># 128 CCR2- HLA-DRhi C1 antigen processing and presentation     4</span><br><span># 785 CCR2- HLA-DRhi C1        response to oxidative stress     5</span><br><br><span># 长数据换成短数据形式</span><br>dd=dcast(ff,Cluster~Description,value.var = <span>'Count'</span>)<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.1919291338582677" data-src="https://mmbiz.qpic.cn/mmbiz_png/PsnauFhHibc7hwJT1LA0AIzrUHA40GzKpylOMozlkXJD6hK7312QAFy9J0ArzEOAJa01F9jt1z3WxavX4l4UMew/640?wx_fmt=png" data-type="png" data-w="1016" src="https://mmbiz.qpic.cn/mmbiz_png/PsnauFhHibc7hwJT1LA0AIzrUHA40GzKpylOMozlkXJD6hK7312QAFy9J0ArzEOAJa01F9jt1z3WxavX4l4UMew/640?wx_fmt=png"></figure><ul data-tool="mdnice编辑器"><li><section>调整格式</section></li></ul><pre data-tool="mdnice编辑器"><span></span><code>rownames(dd) &lt;- dd[,<span>1</span>]<br>dd &lt;- dd[,-<span>1</span>]<br><br><span># 第一行包含每个变量的最大值</span><br><span># 第二行包含每个变量的最小值</span><br>dd=rbind(rep(<span>20</span>,<span>5</span>) , rep(<span>0</span>,<span>5</span>) , dd)<br><br><span># 变量需要换成数值形式</span><br><span>for</span> (i <span>in</span> <span>1</span>:<span>10</span>) {<br>  <span>#i=1</span><br>  dd[,i] &lt;- as.numeric(dd[,i])<br>  <br>}<br>str(dd)<br><span># 'data.frame': 5 obs. of  10 variables:</span><br><span># $ antigen processing and presentation     : num  20 0 4 1 3</span><br><span># $ cytokine production                     : num  20 0 7 15 17</span><br><span># $ endocytosis                             : num  20 0 17 4 4</span><br><span># $ I-kappaB kinase/NF-kappaB signaling     : num  20 0 1 6 4</span><br><span># $ interleukin-10 production               : num  20 0 1 1 NA</span><br><span># $ leukocyte chemotaxis                    : num  20 0 6 11 10</span><br><span># $ response to endoplasmic reticulum stress: num  20 0 2 6 2</span><br><span># $ response to interferon-gamma            : num  20 0 5 4 3</span><br><span># $ response to oxidative stress            : num  20 0 5 12 8</span><br><span># $ response to tumor necrosis factor       : num  20 0 7 14 3</span><br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.2576374745417515" data-src="https://mmbiz.qpic.cn/mmbiz_png/PsnauFhHibc7hwJT1LA0AIzrUHA40GzKpCToGia4GUJo9G3eOw8sFMEXZJgFicnnzCsnG91fUcmAmhtuN10Sic7h1A/640?wx_fmt=png" data-type="png" data-w="982" src="https://mmbiz.qpic.cn/mmbiz_png/PsnauFhHibc7hwJT1LA0AIzrUHA40GzKpCToGia4GUJo9G3eOw8sFMEXZJgFicnnzCsnG91fUcmAmhtuN10Sic7h1A/640?wx_fmt=png"></figure><ul data-tool="mdnice编辑器"><li><section><code><span>radarchart</span></code> : 终于到画图了</section></li></ul><pre data-tool="mdnice编辑器"><span></span><code><span>library</span>(fmsb)<br>colnames(dd)<br><span># 有些名字太长了，需要调整下距离</span><br><span># https://stackoverflow.com/questions/69306607/how-to-move-radar-chart-spider-chart-labels-in-r-fmsb-for-r-shiny-so-labels-do</span><br>f=c(<span>"antigen processing and presentation"</span> ,<span>"cytokine production"</span> ,                    <br>  <span>"endocytosis"</span> ,<span>"       NF-kappaB <br>  signaling"</span>,     <br>  <span>"interleukin-10 <br>  production"</span> ,<span>"leukocyte chemotaxis"</span> ,                   <br>  <span>"       response to<br>                                  endoplasmic reticulum stress"</span> ,<br>  <span>"           response to <br>              interferon-gamma"</span>,            <br>  <span>"       response to <br>               oxidative stress"</span> ,<br>  <span>"    response to <br>                  tumor necrosis factor"</span> )<br><br><span># https://zhuanlan.zhihu.com/p/363992240</span><br>{cairo_pdf(file = <span>"mouse-heart/fig8_radarchart.pdf"</span>, <br>          width = <span>20</span>,<br>          height = <span>10</span>, <br>          family = <span>"STSong"</span>)<br><span>#?radarchart</span><br>radarchart(dd, <br>           axistype=<span>0</span>, <span># 坐标轴的类型</span><br>           vlcex=<span>2</span>, <span># 标签大小</span><br>           palcex=<span>5</span>, <span># 轴四周字体大小缩放比例</span><br>           pcol=colors_border , <span>#设置颜色</span><br>           pfcol=colors_in , <span># 内部填充色</span><br>           plwd=<span>1.3</span> , <span>#线条粗线</span><br>           plty=<span>1</span>,<span>#虚线，实线</span><br>           vlabels = c(f), <span># 标签</span><br>           pty=<span>32</span>, <span># 点的形状</span><br>           cglcol=<span>"black"</span>, <span># 雷达图网络格颜色</span><br>           cglty=<span>3</span>,  <span>#背景线条虚线，实线</span><br>           cglwd=<span>0.6</span> <span>#背景线条粗细</span><br>)<br><br>legend(x=<span>1.5</span>, y=<span>0.90</span>, legend = rownames(dd[-c(<span>1</span>,<span>2</span>),]), <br>       bty = <span>"n"</span>, <br>       pch=<span>20</span> , <br>       col=colors_border, <br>       text.col = <span>"black"</span>, <br>       cex=<span>1.5</span>, pt.cex=<span>2</span>)<br><br><br>dev.off()<br>}<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="0.667687595712098" data-src="https://mmbiz.qpic.cn/mmbiz_png/PsnauFhHibc7hwJT1LA0AIzrUHA40GzKp4qpDDyPvRk6aiaVPTAnZv3XHpn5XqKgnbKYj6ibBvVfCuAsAicZLK8tzQ/640?wx_fmt=png" data-type="png" data-w="653" src="https://mmbiz.qpic.cn/mmbiz_png/PsnauFhHibc7hwJT1LA0AIzrUHA40GzKp4qpDDyPvRk6aiaVPTAnZv3XHpn5XqKgnbKYj6ibBvVfCuAsAicZLK8tzQ/640?wx_fmt=png"></figure></section><p><br></p><p><span><br></span></p><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><p data-tool="mdnice编辑器"><span>文末友情宣传</span><br></p></section></section><p data-tool="mdnice编辑器">强烈建议你推荐给身边的<strong>博士后以及年轻生物学PI</strong>，多一点数据认知，让他们的科研上一个台阶：</p><ul data-tool="mdnice编辑器"><li><section> <a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247515323&amp;idx=1&amp;sn=3f848867b3daffbca99050bf5287ea3a&amp;chksm=9b4bfc00ac3c7516e2de3045e229a538dd62847e40ee516afed73e966fef6e56feef329d1ee0&amp;scene=21#wechat_redirect" textvalue="数据挖掘（GEO,TCGA,单细胞）2022年暑期班（收官之作）" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" wah-hotarea="click" hasload="1">数据挖掘（GEO,TCGA,单细胞）2022年暑期班（收官之作）</a>，快速了解一些生物信息学应用图表</section></li><li><section> <a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247515331&amp;idx=1&amp;sn=e3d38ffe89d81e82d65e3669314c9ee4&amp;chksm=9b4bfc78ac3c756e78dce53a9c95c67b9a90c2a08df8c2052eea95022bfd105b6e5b0a1bec3c&amp;scene=21#wechat_redirect" textvalue="生信入门课-2022年暑期班（收官之作）" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" wah-hotarea="click" hasload="1">生信入门课-2022年暑期班（收官之作）</a>，你的生物信息学第一课</section></li></ul><p><br></p><p data-tool="mdnice编辑器"><br></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/QbSgYG_y1wsrMqdzGBRrQg",target="_blank" rel="noopener noreferrer">原文链接</a>
