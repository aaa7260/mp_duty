---
title: "3种方法为你的稀有物种建立生物学知识数据库"
date: 2023-09-26T16:05:18Z
draft: ["false"]
tags: [
  "fetched",
  "生信技能树"
]
categories: ["Acdemic"]
---
3种方法为你的稀有物种建立生物学知识数据库 by 生信技能树
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><blockquote data-tool="mdnice编辑器"><p>一般来说，生命科学领域的数据分析方向，除了人和鼠之外的物种，都是稀有物种， 大家很容易从目前有的测序数据的分布可以看出来，这里说的鼠是小鼠，并不是大鼠哈，如果是其他物种，比如拟南芥，水稻，斑马鱼，可能是稍微规范一点的稀有物种，猪马牛羊狗，甚至原核生物就更是难上加难了。</p></blockquote><p data-tool="mdnice编辑器">这里，我们以大鼠为例，演示3种方法为你的稀有物种建立生物学知识数据库，以单细胞数据分析环节的细胞通讯，CellChat为例，可以在：<a href="https://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247508834&amp;idx=1&amp;sn=1e9be2cd1db5b2da7ce0f46c03a00a6a&amp;scene=21#wechat_redirect" data-linktype="2">CellChat学习笔记【一】——通讯网络构建</a>了解它的基础用法，**<code>CellChat</code>** 有一个专门的数据库，叫做<strong>CellChatDB</strong>，这个数据库是 <strong><code>CellChat</code></strong> 的作者们<strong>通过阅读大量文献，手动整理出来的“受体-配体”对</strong>，目前有人、鼠以及斑马鱼的版本。其中</p><ul data-tool="mdnice编辑器"><li><section>人的叫做 <strong>CellChatDB.human</strong>，</section></li><li><section>鼠的叫做 <strong>CellChatDB.mouse</strong>，</section></li><li><section>斑马鱼的叫做 <strong>CellChatDB.zebrafish</strong>。</section></li></ul><p data-tool="mdnice编辑器">这样的话，如果大家做的是稀有物种的单细胞，想使用CellChat来做细胞通讯， 就有点麻烦了。比如大鼠，我们演示3种方法为你的稀有物种建立生物学知识数据库。</p><p><img data-galleryid="" data-ratio="0.6640746500777605" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wx4m7icmkafvWMynImYg3mHRuy4udicSr6UcjDE630WpicEvuUEibjG8Viaoo2q1AmTKfD6ggdTb1O82kw/640?wx_fmt=png" data-type="png" data-w="1286" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wx4m7icmkafvWMynImYg3mHRuy4udicSr6UcjDE630WpicEvuUEibjG8Viaoo2q1AmTKfD6ggdTb1O82kw/640?wx_fmt=png"></p><h3 data-tool="mdnice编辑器"><span></span>首先看看CellChat自带的3个数据库<span></span></h3><p data-tool="mdnice编辑器">每个数据库文件在r里面的都是一个简单的list，所以很容易探索：</p><pre data-tool="mdnice编辑器"><span></span><code><span>library</span>(CellChat)<br><br><br>dbh &lt;- CellChatDB.human <br>lapply(dbh, dim)<br>dbm &lt;- CellChatDB.mouse<br>lapply(dbm, dim)<br>dbz &lt;- CellChatDB.zebrafish<br>lapply(dbz, dim)<br><br>cbind(<br>  do.call(rbind,lapply(dbh, dim)) ,<br>  do.call(rbind,lapply(dbm, dim)),<br>  do.call(rbind,lapply(dbz, dim))<br>)<br></code></pre><p data-tool="mdnice编辑器">如下所示：</p><pre data-tool="mdnice编辑器"><span></span><code>         [,1] [,2]  [,3] [,4]  [,5] [,6]<br>interaction  1939   11  2019   11  2774   11<br>complex       157    4   155    4   267    2<br>cofactor       31   16    32   16    62    5<br>geneInfo    41787    6 45551    6 15778    2<br></code></pre><p data-tool="mdnice编辑器">可以看到人和鼠基本上没有差异，但是斑马鱼的数据库记录就有点迷惑了，它明明是基因数量少了一半，但是通讯数据库记录仍然是差不多，可能是因为细胞通讯是比较保守的行为，在多个物种都是可以互相转化的。</p><p data-tool="mdnice编辑器">我们也可以肉眼去看看数据库里面的记录到底是什么：</p><pre data-tool="mdnice编辑器"><span></span><code>dbh_i = dbh$interaction<br>tail(sort(table(dbh_i$pathway_name)))<br>dbh_p = dbh$complex<br>dbh_f = dbh$cofactor<br><br>dbm_i = dbm$interaction<br>tail(sort(table(dbm_i$pathway_name)))<br>dbm_p = dbm$complex<br>dbm_f = dbm$cofactor<br><br>dbz_i = dbz$interaction<br>tail(sort(table(dbz_i$pathway_name)))<br>dbz_p = dbz$complex<br>dbz_f = dbz$cofactor<br></code></pre><p data-tool="mdnice编辑器">可以看到，这个时候人和鼠基本上没有区别：</p><pre data-tool="mdnice编辑器"><span></span><code>&gt; tail(sort(table(dbh_i<span>$pathway_name</span>)))<br><br>     FGF      CCL      BMP  LAMININ COLLAGEN      WNT <br>      60       66       76      143      187      320 <br><br>&gt; tail(sort(table(dbm_i<span>$pathway_name</span>)))<br><br>     CCL      BMP    MHC-I  LAMININ COLLAGEN      WNT <br>      68       76       88      143      198      320 <br><br>&gt; tail(sort(table(dbz_i<span>$pathway_name</span>)))<br><br>     FGF    TIGIT  LAMININ COLLAGEN      BMP      WNT <br>      81      104      144      170      214      504 <br></code></pre><p data-tool="mdnice编辑器">就是斑马鱼的记录反而是多了一些。。。</p><p data-tool="mdnice编辑器">那，我们选取其中一个肉眼看看吧，比如  SOMATOSTATIN，首先我们看看人和鼠有什么区别：</p><pre data-tool="mdnice编辑器"><span></span><code><br>&gt; dbm_i[dbm_i<span>$pathway_name</span>==<span>'SOMATOSTATIN'</span>,1:4]<br>           interaction_name pathway_name ligand receptor<br>SST_SSTR1         SST_SSTR1 SOMATOSTATIN    Sst    Sstr1<br>SST_SSTR2         SST_SSTR2 SOMATOSTATIN    Sst    Sstr2<br>SST_SSTR3         SST_SSTR3 SOMATOSTATIN    Sst    Sstr3<br>SST_SSTR4         SST_SSTR4 SOMATOSTATIN    Sst    Sstr4<br>SST_SSTR5         SST_SSTR5 SOMATOSTATIN    Sst    Sstr5<br>CORT_SSTR1       CORT_SSTR1 SOMATOSTATIN   Cort    Sstr1<br>CORT_SSTR2       CORT_SSTR2 SOMATOSTATIN   Cort    Sstr2<br>CORT_SSTR3       CORT_SSTR3 SOMATOSTATIN   Cort    Sstr3<br>CORT_SSTR4       CORT_SSTR4 SOMATOSTATIN   Cort    Sstr4<br>CORT_SSTR5       CORT_SSTR5 SOMATOSTATIN   Cort    Sstr5<br><br>&gt; dbm_i[dbm_i<span>$pathway_name</span>==<span>'SOMATOSTATIN'</span>,1:4]<br>           interaction_name pathway_name ligand receptor<br>SST_SSTR1         SST_SSTR1 SOMATOSTATIN    Sst    Sstr1<br>SST_SSTR2         SST_SSTR2 SOMATOSTATIN    Sst    Sstr2<br>SST_SSTR3         SST_SSTR3 SOMATOSTATIN    Sst    Sstr3<br>SST_SSTR4         SST_SSTR4 SOMATOSTATIN    Sst    Sstr4<br>SST_SSTR5         SST_SSTR5 SOMATOSTATIN    Sst    Sstr5<br>CORT_SSTR1       CORT_SSTR1 SOMATOSTATIN   Cort    Sstr1<br>CORT_SSTR2       CORT_SSTR2 SOMATOSTATIN   Cort    Sstr2<br>CORT_SSTR3       CORT_SSTR3 SOMATOSTATIN   Cort    Sstr3<br>CORT_SSTR4       CORT_SSTR4 SOMATOSTATIN   Cort    Sstr4<br>CORT_SSTR5       CORT_SSTR5 SOMATOSTATIN   Cort    Sstr5<br></code></pre><p data-tool="mdnice编辑器">如我们所猜测的，其实人和鼠仅仅是基因名字大小写差异而已。。。。</p><p data-tool="mdnice编辑器">反而是斑马鱼，我肉眼看了看，基因名字太诡异，这里不予考虑吧，听说是果蝇基因名字也很诡异，这样的很多上古时代的诺贝尔奖生物学家所在的领域的知识体系架构都及其的乱。。。</p><p data-tool="mdnice编辑器">既然我们认识了数据库知识架构，现在来看我们的3个方案：</p><h3 data-tool="mdnice编辑器"><span></span>方案1：直接把你的大鼠单细胞表达量矩阵的基因名字修改为人类即可<span></span></h3><p data-tool="mdnice编辑器">前面我们提到的CellChat的对象构建，超级简单：</p><pre data-tool="mdnice编辑器"><span></span><code><span>library</span>(CellChat)<br><span>library</span>(Seurat)<br><span>library</span>(SeuratData)<br>data(<span>"pbmc3k.final"</span>)<br>ct &lt;- GetAssayData(object = pbmc3k.final, slot = <span>'data'</span>)<br>meta &lt;- pbmc3k.final@meta.data<br><span># 这个 ct 是一个稀疏矩阵 </span><br>cellchat &lt;- createCellChat(object = ct,<br>                           meta = meta,<br>                           group.by = <span>'seurat_annotations'</span>)<br></code></pre><p data-tool="mdnice编辑器">如果是大鼠单细胞表达量矩阵，有两个方案，首先是简单粗暴修改为大写基因就是人类基因名字啦；</p><pre data-tool="mdnice编辑器"><span></span><code>rownames(ct) = toupper(rownames(ct) )<br></code></pre><p data-tool="mdnice编辑器">后续的数据分析直接当做是人类单细胞表达量矩阵即可，反正我们也不知道人类和小鼠大鼠的细胞通讯到底差异大不大，数据分析仅仅是启发，并不需要百分比精确。</p><p data-tool="mdnice编辑器">另外一个方案是进行同源基因转化，比如 babelgene和homologene ，我们这里针对 CellChat里面的基因进行举例：</p><pre data-tool="mdnice编辑器"><span></span><code><span># install.packages("babelgene")</span><br><span>library</span>(babelgene)<br>cg = unique(CellChatDB.human$interaction$receptor)<br>length(cg)<br>tmp = orthologs(genes =  cg ,<br>          species = <span>"mouse"</span>)<br>tmp$new = toupper(tmp$symbol) <br>tmp[tmp$human_symbol != tmp$new,c(<span>1</span>,<span>5</span>)]<br> <br></code></pre><p data-tool="mdnice编辑器">可以看到确实是简单粗暴修改为大写基因会有误差；</p><pre data-tool="mdnice编辑器"><span></span><code>&gt; tmp[tmp<span>$human_symbol</span> != tmp<span>$new</span>,c(1,5)]<br>    human_symbol    symbol<br>13         AGTR1    Agtr1a<br>42         CD209    Cd209b<br>45         CD244    Cd244a<br>56          CD55     Cd55b<br>61          CD8B     Cd8b1<br>62         CD8B2     Cd8b1<br></code></pre><p data-tool="mdnice编辑器">但是有误差的基因占比少得可怜。</p><p data-tool="mdnice编辑器">另外一个方法：</p><pre data-tool="mdnice编辑器"><span></span><code><br><span># install.packages('homologene')#R</span><br>library(homologene)<br>tmp &lt;- human2mouse( cg )<br>tmp &lt;- na.omit(tmp) <span>#去除NA值</span><br>dim(tmp)<br>tmp<span>$new</span> = toupper(tmp<span>$mouseGene</span>) <br>tmp[tmp<span>$humanGene</span> != tmp<span>$new</span>,]<br><br></code></pre><p data-tool="mdnice编辑器">也是可以看到误差：</p><pre data-tool="mdnice编辑器"><span></span><code>&gt; tmp[tmp<span>$humanGene</span> != tmp<span>$new</span>,]<br>    humanGene mouseGene humanID   mouseID       new<br>53       IL4R     Il4ra    3566     16190     IL4RA<br>71  TNFRSF10A Tnfrsf10b    8797     21933 TNFRSF10B<br>91     LILRB3      Pirb   11025     18733      PIRB<br>92     LILRB3   Gm14548   11025 100038909   GM14548<br>93     LILRB3     Pira2   11025     18725     PIRA2<br>94     LILRB3     Pira1   11025     18722     PIRA1<br>95     LILRB3   Gm15448   11025 100041146   GM15448<br>96     LILRB3    Lilra6   11025     18726    LILRA6<br>97     LILRB3     Pira6   11025     18729     PIRA6<br>109     AGTR1    Agtr1a     185     11607    AGTR1A<br>247      CD55      Daf2    1604     13137      DAF2<br></code></pre><p data-tool="mdnice编辑器">就很诡异，  CD55     和  Daf2   ，看起来是八竿子打不着的啊，搞小鼠科学研究的那些人就不能低头吗，给人类科学让路，自己那一小撮人开会自己检讨一下自己的基因命名问题，以人类研究为准，身为科学家居然搞不清楚自己搞科学的目的，不应该是造福人类吗？</p><h3 data-tool="mdnice编辑器"><span></span>方案2：修改CellChatDB.human 里面的四个元素<span></span></h3><p data-tool="mdnice编辑器">这样的话，就自己创建了CellChatDB.rat 这个对象，后续就依据它进行细胞通讯。</p><h3 data-tool="mdnice编辑器"><span></span>方案3：阅读大约3万篇文献整理真正的CellChatDB.rat<span></span></h3><p data-tool="mdnice编辑器">肯定是有一些基因在大鼠里面压根就没有人类和小鼠同源，有一些通讯也不可能是跨越物种的，所以就需要阅读大约3万篇文献整理真正的CellChatDB.rat ，能做冷板凳才是真英雄。</p></section><p><br></p><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/d8my3huPx0JWgUmGCX7lzQ",target="_blank" rel="noopener noreferrer">原文链接</a>
