---
title: "既然FPKM是通过Count计算来的，那我们是不是可以把FPKM转换为Count嘞？"
date: 2023-09-15T15:39:52Z
draft: ["false"]
tags: [
  "fetched",
  "生信小白要知道"
]
categories: ["Acdemic"]
---
既然FPKM是通过Count计算来的，那我们是不是可以把FPKM转换为Count嘞？ by 生信小白要知道
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><blockquote data-tool="mdnice编辑器"><p>最近收到很多小伙伴们的询问，数据几经辗转到自己手里，只剩下FPKM了，实在是找不到原始Count矩阵啦，这该怎么办呢？那既然FPKM是通过Count计算来的，那我们是不是可以把FPKM转换为Count嘞？你们好奇不啦！反正我好奇！好奇咱就继续往下看！</p></blockquote><h2 data-tool="mdnice编辑器"><span></span><span>爱情不是你想买~想买~就能买~</span></h2><p data-tool="mdnice编辑器">我们前面在<a href="https://mp.weixin.qq.com/s?__biz=Mzg5NjE1NTc1OA==&amp;mid=2247485287&amp;idx=1&amp;sn=d0b0f11cbf35de361d5c79201dd08dfd&amp;scene=21#wechat_redirect" data-linktype="2">你该如何选择 | Count、RPKM、FPKM、TPM、CPM，再加个 RSEM</a>中已经介绍了几种衡量基因表达水平的计算方式，相信大家也已经了解了自己该如何进行选择！但是呐，天不遂人愿！不是咱想有啥就能有啥！</p><p data-tool="mdnice编辑器">比如下面这两位同病相怜的人儿！<img data-ratio="0.49907407407407406" data-type="png" data-w="1080" data-src="https://mmbiz.qpic.cn/mmbiz_png/QQjtfWKmicLoTZ5u8c6uzyicsaCWP9yqHdEDxmJ3EE1BBDoibK8um6TcAuL9X2iahMJtQkiaLVpfwNyoE3f5R2fOoMg/640?wx_fmt=png" src="https://mmbiz.qpic.cn/mmbiz_png/QQjtfWKmicLoTZ5u8c6uzyicsaCWP9yqHdEDxmJ3EE1BBDoibK8um6TcAuL9X2iahMJtQkiaLVpfwNyoE3f5R2fOoMg/640?wx_fmt=png"></p><p data-tool="mdnice编辑器">如图所示，很多小伙伴都在想，那既然FPKM、TPM这些值都是通过Count计算来的，那我们是不是可以把它们再倒转回去变成Count嘞？</p><p data-tool="mdnice编辑器"><strong>No！大漏特漏！</strong></p><h2 data-tool="mdnice编辑器"><span></span><span>开弓没有回头箭</span></h2><p data-tool="mdnice编辑器">FPKM和TPM是用于表示基因或转录本表达水平的归一化测量值，它们是从原始Count数据计算而来的，但不能直接转换回原始Count矩阵的原因有以下几点：</p><ol data-tool="mdnice编辑器"><li><section><p><strong>归一化信息的丢失</strong>：计算FPKM和TPM时，首先考虑了基因（或转录本）的长度和总读数，然后进行了归一化，以便在不同样本之间进行比较。这个归一化过程引入了信息的变换和估计。在这个过程中，一些原始Count数据的信息可能已经丢失，例如，在考虑基因长度和总读数时，有一定的估计和平滑过程。因此，如果要从FPKM或TPM值反向计算Count数据，需要进行逆向估计，这可能会引入不确定性和误差。</p><blockquote><p>下图简单展示了FPKM和TPM的原理、计算公式、适用场景等，想要详细了解这些基因表达量计算方式及其如何使用的小伙伴们，可以查看：<a href="https://mp.weixin.qq.com/s?__biz=Mzg5NjE1NTc1OA==&amp;mid=2247485287&amp;idx=1&amp;sn=d0b0f11cbf35de361d5c79201dd08dfd&amp;scene=21#wechat_redirect" data-linktype="2">你该如何选择 | Count、RPKM、FPKM、TPM、CPM，再加个 RSEM</a></p><figure><img data-ratio="0.43703703703703706" data-type="png" data-w="1080" data-src="https://mmbiz.qpic.cn/mmbiz_png/QQjtfWKmicLoTZ5u8c6uzyicsaCWP9yqHdutiaPnvx0PWgcGFtCZ9N2TH8vOSTicgVAwiccibMolJv9l5CrLJibOnMneQ/640?wx_fmt=png" src="https://mmbiz.qpic.cn/mmbiz_png/QQjtfWKmicLoTZ5u8c6uzyicsaCWP9yqHdutiaPnvx0PWgcGFtCZ9N2TH8vOSTicgVAwiccibMolJv9l5CrLJibOnMneQ/640?wx_fmt=png"></figure></blockquote></section></li><li><section><p><strong>非线性变换</strong>：FPKM和TPM的计算涉及非线性变换，包括除法和取对数。这些变换使得从FPKM或TPM值反向计算出原始Count数据更加复杂，因为您需要反转这些非线性变换。这不仅需要额外的计算，还会引入进一步的误差。</p></section></li><li><section><p><strong>不同估计方法</strong>：不同的软件和方法可能会使用不同的估算和归一化策略来计算FPKM和TPM。这意味着不同的计算过程可能会导致不同的结果，这进一步增加了反向计算Count数据的难度。</p></section></li></ol><p data-tool="mdnice编辑器">总之呢，虽然理论上可以尝试从FPKM或TPM值中逆向推导出Count数据，但这个过程非常复杂，不仅需要进行逆向估算，还会引入信息丢失和误差等等，所以肯定不建议大家这么做！一般情况下，我们更多地会选择使用FPKM、TPM等归一化后的表达度量来进行分析，因为它们更适合比较不同基因（或转录本）在不同样本中的表达水平。如果需要原始的Count数据，通常是在实验设计和测序过程中保存的原始测序数据中获取的。</p><h2 data-tool="mdnice编辑器"><span></span><span>为什么你行我不行</span></h2><p data-tool="mdnice编辑器"><strong>（本小节小灰小黑请自动过滤）</strong></p><p data-tool="mdnice编辑器"><strong>log2(upper quartile+1) vs. log2(count+1)</strong></p><p data-tool="mdnice编辑器">在上图中，咱们要知道群的小可爱的提问中提到了<code>GEO下载的数据是四分之一矩阵log2</code>，其实就是log2(upper quartile+1)，log2(upper quartile+1)通常是在数据的分位数（特别是上四分位数）上进行的变换。它的目标是减小数据中的离群值对分析的影响，提高数据的稳定性。</p><p data-tool="mdnice编辑器">和上面的FPKM、TPM等一样，从log2(upper quartile+1)到原始Count矩阵的转换大多数情况下也是<strong>不可逆</strong>的。</p><p data-tool="mdnice编辑器">小伙伴们可以注意一下，咱们之前不是在UCSC Xena下载数据嘛，从这里下载的话，它的下面页面会有一个<code>unit</code>的行，它这里会告诉我们数据的单位是什么，可能会有log2(count+1)、log2(FPKM+1)、log2(TPM+1)等等。</p><blockquote data-tool="mdnice编辑器"><p>具体下载步骤详见：<a href="https://mp.weixin.qq.com/s?__biz=Mzg5NjE1NTc1OA==&amp;mid=2247485084&amp;idx=1&amp;sn=9499751c3ca7adf2e679aefd4c0d2c5a&amp;poc_token=HClgA2WjCZ2Yq_NE-zlH4wHCX8DVAOdv4CjTGKSw&amp;scene=21#wechat_redirect" data-linktype="2">看完还不会来揍/找我 | TCGA 与 GTEx 数据库联合分析 | 附完整代码 + 注释</a>的<strong>数据准备</strong>部分。</p></blockquote><figure data-tool="mdnice编辑器"><img data-ratio="0.49907407407407406" data-type="png" data-w="1080" data-src="https://mmbiz.qpic.cn/mmbiz_png/QQjtfWKmicLoTZ5u8c6uzyicsaCWP9yqHdLWxPMiak1lEELl86RXwnkPt4DCZBlRIRrBgw7XLibtASanYyIaVQVJkA/640?wx_fmt=png" src="https://mmbiz.qpic.cn/mmbiz_png/QQjtfWKmicLoTZ5u8c6uzyicsaCWP9yqHdLWxPMiak1lEELl86RXwnkPt4DCZBlRIRrBgw7XLibtASanYyIaVQVJkA/640?wx_fmt=png"></figure><p data-tool="mdnice编辑器">比如上图中显示的是log2(count+1)，这里要注意，这个log2(count+1)想要转换回原始的Count矩阵就是可以的哟！因为它用的就是Count去进行的log2，这个变换是可逆的。要将log2(count+1)转换为原始计数矩阵，我们可以使用以下逆变换公式：</p><p data-tool="mdnice编辑器">原始计数 = 2^(log2(count+1)) - 1</p><p data-tool="mdnice编辑器">这个公式将log2(count+1)的值反向转换回原始计数值。需要注意的是，逆变换后的原始计数可能会包含小数，因为log2(count+1)的变换通常会引入小数部分，而原始计数通常是整数。如果你需要整数计数，可以选择向上或向下取整。</p><p data-tool="mdnice编辑器"><span>还有下面这几种形式：</span></p><p><img data-galleryid="" data-ratio="0.3731481481481482" data-s="300,640" data-type="png" data-w="1080" data-src="https://mmbiz.qpic.cn/mmbiz_png/QQjtfWKmicLq9qa7DIVlHSoenMHZg52ekGQiamutUe3RVezK7xAyicXV1C0r6uphGicCZreRbUXejHB2iadzwhxFHkw/640?wx_fmt=png" src="https://mmbiz.qpic.cn/mmbiz_png/QQjtfWKmicLq9qa7DIVlHSoenMHZg52ekGQiamutUe3RVezK7xAyicXV1C0r6uphGicCZreRbUXejHB2iadzwhxFHkw/640?wx_fmt=png"></p><p data-tool="mdnice编辑器"><span></span></p><p data-tool="mdnice编辑器">其实log2(upper quartile+1)、log2(FPKM+1)、log2(TPM+1)、log2(TPM+0.001)等等等等，它们都是常见的基因表达数据的转换形式，虽然有所不同，但还是有相似之处滴！但它们和log2(count+1)比 差别可就大了！那咱们现在就以log2(upper quartile+1)为例给大家介绍一下它们到底哪里不一样！</p><ol data-tool="mdnice编辑器"><li><section><strong>上四分位数方法和计数方法的区别</strong>：</section></li></ol><ul><li><section>log2(upper quartile+1)通常是在数据的分位数（特别是上四分位数）上进行的变换。它的目标是减小数据中的离群值对分析的影响，提高数据的稳定性。</section></li><li><section>log2(count+1)通常是在原始计数数据上进行的变换，其中count代表基因的原始表达计数。它的目标是对数据进行归一化，减小数据中的变异性，使不同样本之间更容易进行比较。</section></li></ul><li><section><strong>可逆性的区别</strong>：</section></li><ul><li><section>log2(upper quartile+1)的转换是不可逆的，因为上四分位数方法涉及到数据的统计摘要（分位数）和归一化。</section></li><li><section>log2(count+1)通常是可逆的，因为它只涉及对原始计数进行对数变换，可以使用逆变换来还原原始计数。</section></li></ul><li><section><strong>应用领域的区别</strong>：</section></li><ul><li><section>log2(upper quartile+1)通常用于RNA-seq数据的预处理，以减小离群值的影响，提高数据的稳定性，通常在差异表达分析之前使用。</section></li><li><section>log2(count+1)通常用于归一化RNA-seq数据，以便进行比较和分析，通常在数据分析的初期使用。</section></li></ul><p data-tool="mdnice编辑器">其实有时候，就算没有原始Count矩阵，咱也不要慌！FPKM、TPM等数据也是可以进行后续分析的！无非就是需要选择适当的工具方法！<strong>后面我们会出从Count转换到FPKM、TPM等的方法步骤！</strong></p><p data-tool="mdnice编辑器">条条大路通罗马！大家不要怕！</p><p data-tool="mdnice编辑器">车到山前必有路！大家不要哭！<span></span></p><p data-tool="mdnice编辑器">如果我的分享对你有一点点用的话，欢迎<span>关注点赞在看转发分享</span>阿巴阿巴阿巴！这可是我的第一原动力！<br></p><p data-tool="mdnice编辑器">蟹蟹你们的喜欢和支持！（好像又到了吃螃蟹的季节）</p><section><mp-common-profile data-pluginname="mp-common-profile" data-from="0" data-id="Mzg5NjE1NTc1OA==" data-alias="Bioidiot" data-headimg="http://mmbiz.qpic.cn/mmbiz_png/QQjtfWKmicLpicdicvWNnpcaTbejCVgKe4FsicHqo48FOkqJTkziaengudibCF8AW86uyjgee0pxhmhM8JoylYDkSXug/0?wx_fmt=png" data-nickname="生信小白要知道" data-signature="主打小白保姆级教程，因为自己淋过雨，所以想给大家撑把伞！ 记录从小白到现在小灰的过程，希望以后可以成为小黑！"></mp-common-profile></section><h1 data-tool="mdnice编辑器"><span></span><span>参考资料</span></h1><p data-tool="mdnice编辑器"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=Mzg5NjE1NTc1OA==&amp;mid=2247485287&amp;idx=1&amp;sn=d0b0f11cbf35de361d5c79201dd08dfd&amp;chksm=c0042e66f773a77022693b54e33c1caee185671d2a6295781d85ba4a2da0e7b4122a4726c533&amp;scene=21#wechat_redirect" textvalue="你该如何选择 | Count、RPKM、FPKM、TPM、CPM，再加个 RSEM" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2">你该如何选择 | Count、RPKM、FPKM、TPM、CPM，再加个 RSEM</a><br></p></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/B_-oNkcyU8gGTQZk1mXmTg",target="_blank" rel="noopener noreferrer">原文链接</a>
